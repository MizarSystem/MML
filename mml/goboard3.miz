:: Properties of Go-Board - Part III
::  by Jaros{\l}aw Kotowicz and Yatsuka Nakamura
::
:: Received August 24, 1992
:: Copyright (c) 1992 Association of Mizar Users

environ

 vocabularies PRE_TOPC, EUCLID, FINSEQ_1, GOBOARD1, RELAT_1, TOPREAL1,
      FINSEQ_4, BOOLE, MATRIX_1, FUNCT_1, ABSVALUE, ARYTM_1, MCART_1, TREES_1,
      INCSP_1, SEQM_3, ORDINAL2, ARYTM;
 notations TARSKI, XBOOLE_0, ZFMISC_1, SUBSET_1, NUMBERS, XCMPLX_0, COMPLEX1,
      NAT_1, RELAT_1, FUNCT_1, PARTFUN1, FINSEQ_1, PRE_TOPC, FINSEQ_4,
      STRUCT_0, MATRIX_1, EUCLID, TOPREAL1, GOBOARD1, XXREAL_0;
 constructors PARTFUN1, XXREAL_0, NAT_1, COMPLEX1, FINSEQ_4, TOPREAL1,
      GOBOARD1;
 registrations XBOOLE_0, ORDINAL1, RELSET_1, XXREAL_0, XREAL_0, NAT_1,
      MEMBERED, STRUCT_0, EUCLID, SEQ_1, INT_1, VALUED_0;
 requirements REAL, NUMERALS, SUBSET, BOOLE, ARITHM;
 definitions TARSKI, TOPREAL1, XBOOLE_0;
 theorems TARSKI, REAL_1, NAT_1, ZFMISC_1, FUNCT_1, FINSEQ_1, ABSVALUE,
      FINSEQ_3, REAL_2, MATRIX_1, EUCLID, TOPREAL1, TOPREAL3, GOBOARD1,
      GOBOARD2, FINSEQ_4, PARTFUN2, INT_1, XBOOLE_0, XBOOLE_1, XREAL_1,
      COMPLEX1, XXREAL_0, PARTFUN1, ORDINAL1;
 schemes NAT_1, FINSEQ_4, GOBOARD2;

begin

 reserve p,p1,p2,q for Point of TOP-REAL 2,
         f,g,g1,g2 for FinSequence of TOP-REAL 2,
         n,m,i,j,k for Element of NAT,
         G for Go-board,
         x for set;

Lm1:
now let f,k;
    assume A1: len f=k+1;
    assume k<>0;
    then A2: 0<k & k<=k+1 by NAT_1:11;
    then 0+1<=k & k<=len f & k+1 <= len f by A1,NAT_1:13;
then A3: k in dom f by FINSEQ_3:27;
A4: len (f|k)=k by A1,A2,FINSEQ_1:80;
A5: dom(f|k)=Seg len(f|k) by FINSEQ_1:def 3;
   assume A6:f is unfolded;
  thus f|k is unfolded
   proof set f1 = f|k;
   let n be Nat; assume
A7: 1<=n & n+2 <= len f1;
    reconsider n as Element of NAT by ORDINAL1:def 13;
    n in dom f1 & n+1 in dom f1 & n+2 in dom f1 & n+1+1=n+(1+1)
       by A7,GOBOARD2:4;
then A8: LSeg(f1,n)=LSeg(f,n) & LSeg(f1,n+1)=LSeg(f,n+1) &
     f1/.(n+1)=f/.(n+1) by A3,A4,A5,FINSEQ_4:86,TOPREAL3:24;
      len f1 <= len f by A1,A2,FINSEQ_1:80;
  then n+2 <= len f by A7,XXREAL_0:2;
  hence thesis by A6,A7,A8,TOPREAL1:def 8;
 end;
end;

theorem Th1:
(for n st n in dom f ex i,j st [i,j] in Indices G & f/.n=G*(i,j)) &
 f is one-to-one unfolded s.n.c. special
implies
ex g st g is_sequence_on G & g is one-to-one unfolded s.n.c. special &
 L~f = L~g & f/.1 = g/.1 & f/.len f = g/.len g & len f <= len g
proof
defpred P[Element of NAT] means for f st len f = $1 &
 (for n st n in dom f ex i,j st [i,j] in Indices G & f/.n=G*(i,j)) &
  f is one-to-one unfolded s.n.c. special
 ex g st g is_sequence_on G &
  g is one-to-one unfolded s.n.c. special &
  L~f=L~g & f/.1=g/.1 & f/.len f=g/.len g & len f<=len g;
A1: P[0]
 proof let f such that
  A2: len f=0 &
  (for n st n in dom f ex i,j st [i,j] in Indices G & f/.n=G*(i,j)) &
  f is one-to-one unfolded s.n.c. special;
  take g=f;
      f= {} by A2,FINSEQ_1:25;
   then for n holds n in dom g & n+1 in dom g implies (
    for m,k,i,j st [m,k] in Indices G & [i,j] in Indices G & g/.n=G*(m,k) &
       g/.(n+1)=G*(i,j) holds abs(m-i)+abs(k-j)=1) by FINSEQ_1:26;
  hence thesis by A2,GOBOARD1:def 11;
 end;
A3: for k st P[k] holds P[k+1]
 proof let k such that
  A4: P[k];
  let f such that
A5: len f=k+1 and
A6: for n st n in dom f ex i,j st [i,j] in Indices G & f/.n=G*(i,j) and
A7: f is one-to-one and
A8: f is unfolded and
A9: f is s.n.c. and
A10: f is special;
   per cases;
   suppose k=0;
    then A11: dom f = {1} by A5,FINSEQ_1:4,def 3;
    take g=f;
         now let n; assume
          n in dom g & n+1 in dom g;
      then n=1 & n+1=1 by A11,TARSKI:def 1;
      hence for i1,i2,j1,j2 be Element of NAT st [i1,i2] in Indices G &
      [j1,j2] in Indices G &
       g/.n=G*(i1,i2) & g/.(n+1)=G*(j1,j2) holds abs(i1-j1)+abs(i2-j2)=1;
     end;
    hence g is_sequence_on G by A6,GOBOARD1:def 11;
    thus g is one-to-one unfolded s.n.c. special &
     L~f=L~g & f/.1=g/.1 & f/.len f=g/.len g & len f<=len g by A7,A8,A9,A10;
   end;
   suppose A12: k<>0;
    then A13: 0<k & k<=k+1 by NAT_1:11;
    then A14: 0+1<=k & k<=len f & k+1 <= len f by A5,NAT_1:13;
then A15: k in dom f by FINSEQ_3:27;
A16: len (f|k)=k by A5,A13,FINSEQ_1:80;
A17: dom(f|k)=Seg len(f|k) by FINSEQ_1:def 3;
A18: k in Seg k by A14,FINSEQ_1:3;
A19: 1 in Seg k by A14,FINSEQ_1:3;
    set f1=f|k;
    A20: now let n; assume A21: n in dom f1;
       then n in dom f by A15,A16,A17,FINSEQ_4:86;
      then consider i,j such that
      A22: [i,j] in Indices G & f/.n=G*(i,j) by A6;
      take i,j;
      thus [i,j] in Indices G & f1/.n=G*(i,j)
       by A15,A16,A17,A21,A22,FINSEQ_4:86;
     end;
        f1 = f|Seg k by FINSEQ_1:def 15;
    then A23: f1 is one-to-one by A7,FUNCT_1:84;
    A24: f1 is unfolded by A5,A8,A12,Lm1;
    A25: f1 is s.n.c. by A9,GOBOARD2:12;
        f1 is special
     proof let n be Nat; assume
      A26: 1<=n & n+1 <= len f1;
      then n in dom f1 & n+1 in dom f1 by GOBOARD2:3;
      then A27: f1/.n=f/.n & f1/.(n+1)=f/.(n+1) by A15,A16,A17,FINSEQ_4:86;
          len f1 <=len f by A5,A13,FINSEQ_1:80;
      then n+1 <= len f by A26,XXREAL_0:2;
      hence (f1/.n)`1=(f1/.(n+1))`1 or (f1/.n)`2=(f1/.(n+1))`2
       by A10,A26,A27,TOPREAL1:def 7;
     end;
    then consider g1 such that
A28: g1 is_sequence_on G and
A29: g1 is one-to-one and
A30: g1 is unfolded and
A31: g1 is s.n.c. and
A32: g1 is special and
A33: L~g1=L~f1 and
A34: g1/.1=f1/.1 and
A35: g1/.len g1=f1/.len f1 and
A36: len f1<=len g1 by A4,A16,A20,A23,A24,A25;
    A37: k=1 implies L~g1={} & rng g1 = {f/.k}
     proof assume A38: k=1;
      hence L~g1={} by A16,A33,TOPREAL1:28;
then A39:  (len g1=1 or len g1=0) & 1<=len g1
           by A5,A36,A38,FINSEQ_1:80,TOPREAL1:28;
then A40:  len g1 in dom g1 by FINSEQ_3:27;
      A41: g1/.len g1=f/.k by A15,A16,A18,A35,FINSEQ_4:86;
      then f/.k in rng g1 by A40,PARTFUN2:4;
      then A42: {f/.k} c= rng g1 by ZFMISC_1:37;
          rng g1 c= {f/.k}
       proof let x; assume x in rng g1; then consider n such that
        A43: n in dom g1 & g1/.n=x by PARTFUN2:4;
            n in Seg len g1 by A43,FINSEQ_1:def 3;
        then n=len g1 by A39,FINSEQ_1:4,TARSKI:def 1;
        hence x in {f/.k} by A41,A43,TARSKI:def 1;
       end;
      hence rng g1={f/.k} by A42,XBOOLE_0:def 10;
     end;
    A44: 1<k implies rng g1 c= L~f1
     proof assume 1<k; then 1+1<=k by NAT_1:13;
      then A45: 2<=len g1 by A16,A36,XXREAL_0:2;
      let x; assume x in rng g1;
      then consider n such that
      A46: n in dom g1 & g1/.n=x by PARTFUN2:4;
      thus x in L~f1 by A33,A45,A46,GOBOARD1:16;
     end;
    consider i1,i2 be Element of NAT such that
    A47: [i1,i2] in Indices G & f/.k=G*(i1,i2) by A6,A15;
        1<=len f by A14,XXREAL_0:2;
    then A48: k+1 in dom f by A5,FINSEQ_3:27;
    then consider j1,j2 be Element of NAT such that
    A49: [j1,j2] in Indices G & f/.(k+1)=G*(j1,j2) by A6;
    A50: Indices G = [:dom G,Seg width G:] by MATRIX_1:def 5;
    then A51: i1 in dom G & i2 in Seg width G &
        j1 in dom G & j2 in Seg width G by A47,A49,ZFMISC_1:106;
    A52:dom G = Seg len G by FINSEQ_1:def 3;
    A53: (for n st n in dom g1 ex m,k st [m,k] in Indices G &
    g1/.n=G*(m,k)) &
    for n st n in dom g1 & n+1 in dom g1 holds
     for m,k,i,j st [m,k] in Indices G &
     [i,j] in Indices G & g1/.n = G*(m,k) &
      g1/.(n+1) = G*(i,j) holds abs(m-i)+abs(k-j) = 1 by A28,GOBOARD1:def 11;
    reconsider l1 = Line(G,i1), c1 = Col(G,i2) as FinSequence of TOP-REAL 2;
    set x1 = X_axis(l1), y1 = Y_axis(l1),
        x2 = X_axis(c1), y2 = Y_axis(c1);
A54:  x1 is constant by A51,GOBOARD1:def 6;
A55:  y1 is increasing by A51,GOBOARD1:def 8;
A56:  x2 is increasing by A51,GOBOARD1:def 9;
A57:  y2 is constant by A51,GOBOARD1:def 7;
A58: dom x1=Seg len x1 by FINSEQ_1:def 3;
A59: dom y1=Seg len y1 by FINSEQ_1:def 3;
A60: len y1=len l1 by GOBOARD1:def 4;
A61: len x1=len l1 by GOBOARD1:def 3;
A62: len l1=width G by MATRIX_1:def 8;
then A63:Seg width G = dom l1 by FINSEQ_1:def 3;
A64: dom x2= Seg len x2 by FINSEQ_1:def 3;
A65: dom y2=Seg len y2 by FINSEQ_1:def 3;
A66: len x2=len c1 by GOBOARD1:def 3;
then A67: dom c1 = Seg len x2 by FINSEQ_1:def 3
            .= dom x2 by FINSEQ_1:def 3;
A68: len y2=len c1 by GOBOARD1:def 4;
A69: len c1 = len G by MATRIX_1:def 9;
then A70: dom c1 = Seg len G by FINSEQ_1:def 3
           .= dom G by FINSEQ_1:def 3;
         now per cases by A10,A15,A47,A48,A49,GOBOARD2:16;
     suppose A71: i1=j1;
      set ppi = G*(i1,i2), pj = G*(i1,j2);
           now per cases by XXREAL_0:1;
       case A72: i2>j2;
        then reconsider l=i2-j2 as Element of NAT by INT_1:18;
        A73: now let n; assume n in Seg l;
          then A74: 1<=n & n<=l & 0<=j2 by FINSEQ_1:3;
           l<=i2 by XREAL_1:45;
          then n<=i2 by A74,XXREAL_0:2;
          then reconsider w=i2-n as Element of NAT by INT_1:18;
              0<=n & i2-l<=i2-n by A74,REAL_1:92;
          then i2-n<=i2 & i2<=width G & j2<=w & 1<=j2
            by A51,FINSEQ_1:3,XREAL_1:45;
          then 1<=w & w<=width G by XXREAL_0:2;
          then w in Seg width G by FINSEQ_1:3;
          hence i2-n is Element of NAT & [i1,i2-n] in Indices G &
          i2-n in Seg width G
          by A50,A51,ZFMISC_1:106;
         end;
         defpred P1[Element of NAT,set] means for m st m=i2-$1
         holds $2=G*(i1,m);
        A75: now let n; assume n in Seg l;
          then reconsider m=i2-n as Element of NAT by A73;
          take p=G*(i1,m);
          thus P1[n,p];
         end;
        consider g2 such that
        A76: len g2=l & for n st n in Seg l holds P1[n,g2/.n]
         from FINSEQ_4:sch 1(A75);
A77:    dom g2 = Seg l by A76,FINSEQ_1:def 3;
        take g=g1^g2;
             now let n; assume A78: n in dom g2;
          then reconsider m=i2-n as Element of NAT by A73,A77;
          take k=i1,m;
          thus [k,m] in Indices G & g2/.n=G*(k,m) by A73,A76,A77,A78;
         end;
        then A79: for n st n in dom g ex i,j st [i,j] in Indices G & g/.n=G*
             (i,j) by A53,GOBOARD1:39;
        A80: now let n; assume
A81:      n in dom g2 & n+1 in dom g2;
          then A82: [i1,i2-n] in Indices G
           & [i1,i2-(n+1)] in Indices G by A73,A77;
          reconsider m1=i2-n ,m2=i2-(n+1) as Element of NAT by A73,A77,A81;
          A83: g2/.n=G*(i1,m1) & g2/.(n+1)=G*(i1,m2) by A76,A77,A81;
          let l1,l2,l3,l4 be Element of NAT; assume
              [l1,l2] in Indices G & [l3,l4] in Indices G & g2/.n=G*(l1,l2) &
           g2/.(n+1)=G*(l3,l4);
           then l1=i1 & l2=m1 & l3=i1 & l4=m2 by A82,A83,GOBOARD1:21;
          hence abs(l1-l3)+abs(l2-l4)= 0+abs(i2-n-(i2-(n+1))) by ABSVALUE:7
           .= 1 by ABSVALUE:def 1;
         end;
          now let l1,l2,l3,l4 be Element of NAT; assume
          A84: [l1,l2] in Indices G & [l3,l4] in Indices G &
          g1/.len g1=G*(l1,l2) &
          g2/.1=G*(l3,l4) & len g1 in dom g1 & 1 in dom g2;
          then A85: [i1,i2-1] in Indices G &
          f1/.len f1=f/.k by A15,A16,A18,A73,A77,FINSEQ_4:86;
          reconsider m1=i2-1 as Element of NAT by A73,A77,A84;
              g2/.1=G*(i1,m1) by A76,A77,A84;
           then l1=i1 & l2=i2 & l3=i1 & l4=m1
            by A35,A47,A84,A85,GOBOARD1:21;
          hence abs(l1-l3)+abs(l2-l4)=0+abs(i2-(i2-1)) by ABSVALUE:7
          .=1 by ABSVALUE:def 1;
         end;
        then for n st n in dom g & n+1 in dom g holds
         for m,k,i,j st [m,k] in Indices G & [i,j] in Indices G &
         g/.n=G*(m,k) &
          g/.(n+1)=G*(i,j) holds abs(m-i)+abs(k-j)=1 by A53,A80,GOBOARD1:40;
        hence g is_sequence_on G by A79,GOBOARD1:def 11;
     set lk={w where w is Point of TOP-REAL 2: w`1=ppi`1 & pj`2<=w`2 & w`2<=
ppi`2};
            l1/.i2=l1.i2 & l1/.j2 = l1.j2 by A51,A63,PARTFUN1:def 8;
        then A86: l1/.i2=ppi & l1/.j2=pj by A51,MATRIX_1:def 8;
        then A87: y1.i2=ppi`2 & y1.j2=pj`2 & x1.i2=ppi`1 & x1.j2=pj`1 & l=len
g2
          by A51,A58,A59,A60,A61,A62,A76,GOBOARD1:def 3,def 4;
   then A88: pj`2<ppi`2 & ppi`1=pj`1 & ppi=|[ppi`1,ppi`2]| & pj=|[pj`1,pj`2]|
        by A51,A54,A55,A58,A59,A60,A61,A62,A72,EUCLID:57,GOBOARD1:def 1,def 2;
        A89: LSeg(f,k)=LSeg(pj,ppi) by A14,A47,A49,A71,TOPREAL1:def 5
        .= lk by A88,TOPREAL3:15;
        A90: LSeg(f,k)=LSeg(ppi,pj) by A14,A47,A49,A71,TOPREAL1:def 5;
             now let n,m; assume
          A91: n in dom g2 & m in dom g2 & n<>m;
          then A92: [i1,i2-n] in Indices G& [i1,i2-m] in Indices G by A73,A77;
          reconsider n1=i2-n, m1=i2-m as Element of NAT by A73,A77,A91;
          A93: g2/.n=G*(i1,n1) & g2/.m=G*(i1,m1) by A76,A77,A91;
          assume g2/.n=g2/.m;
          then n1=m1 by A92,A93,GOBOARD1:21;
          hence contradiction by A91;
         end;
         then for n,m st n in dom g2 & m in dom g2 &
         g2/.n = g2/.m holds n = m;
then A94:     g2 is one-to-one & dom g2=Seg len g2 by FINSEQ_1:def 3
,PARTFUN2:16;
        A95: not f/.k in rng g2
         proof assume f/.k in rng g2;
          then consider n such that
          A96: n in dom g2 & g2/.n=f/.k by PARTFUN2:4;
          A97: [i1,i2-n] in Indices G by A73,A76,A94,A96;
          reconsider n1=i2-n as Element of NAT by A73,A76,A94,A96;
              g2/.n=G*(i1,n1) & 0+1<=n by A76,A94,A96,FINSEQ_1:3;
           then n1=i2 & 0<n by A47,A96,A97,GOBOARD1:21;
          hence contradiction;
         end;
        A98: now let n,p; assume
          A99: n in dom g2 & g2/.n=p;
          then A100: P1[n,g2/.n] &
          1<=n & n<=len g2& i2-n in Seg width G by A73,A76,A94,FINSEQ_3:27;
          reconsider n1=i2-n as Element of NAT by A73,A77,A99;
          set pn = G*(i1,n1);
              l1/.n1=l1.n1 by A63,A100,PARTFUN1:def 8;
          then A101: g2/.n=pn & l1/.n1=pn & 0<=n & i2-len g2<=n1
            by A100,MATRIX_1:def 8,REAL_1:92;
          then A102: x1.n1=pn`1 & x1.n1=x1.i2 & y1.n1=pn`2 & n1<=i2 & j2<=n1
           by A51,A54,A58,A59,A60,A61,A62,A76,A100,GOBOARD1:def 2,def 3,def 4
,REAL_2:173;
          hence p`1=ppi`1 & pj`2<=p`2 & p`2<=ppi`2
            by A51,A55,A59,A60,A62,A87,A99,A100,A101,GOBOARD2:18;
              dom l1 = Seg len l1 by FINSEQ_1:def 3;
          hence p in rng l1
          by A62,A99,A100,A101,PARTFUN2:4;
           n1<i2 by A100,XREAL_1:46;
          hence p`2<ppi`2 by A51,A55,A59,A60,A62,A87,A99,A100,A101,A102,
GOBOARD1:def 1;
         end;
        A103: now let n,m,p,q; assume
          A104: n in dom g2 & m in dom g2 & n<m & g2/.n=p & g2/.m=q;
          then A105: P1[n,g2/.n] & i2-n in Seg width G &
              P1[m,g2/.m] & i2-m in Seg width G by A73,A76,A77;
          reconsider n1=i2-n, m1=i2-m as Element of NAT by A73,A77,A104;
          set pn = G*(i1,n1), pm = G*(i1,m1);
              l1/.n1=l1.n1 & l1/.m1 = l1.m1 by A63,A105,PARTFUN1:def 8;
          then A106: g2/.n=pn & l1/.n1=pn & g2/.m=pm & l1/.m1=pm & m1<n1
            by A104,A105,MATRIX_1:def 8,REAL_1:92;
          then y1.n1=pn`2 & y1.m1=pm`2 by A59,A60,A62,A105,GOBOARD1:def 4;
          hence q`2<p`2 by A55,A59,A60,A62,A104,A105,A106,GOBOARD1:def 1;
         end;
        A107: rng g2 c= LSeg(f,k)
         proof let x; assume x in rng g2;
          then consider n such that
          A108: n in dom g2 & g2/.n=x by PARTFUN2:4;
          reconsider n1=i2-n as Element of NAT by A73,A76,A94,A108;
          set pn = G*(i1,n1);
          A109: g2/.n=pn by A76,A94,A108;
          then pn`1=ppi`1 & pj`2<=pn`2 & pn`2<=ppi`2 by A98,A108;
          hence x in LSeg(f,k) by A89,A108,A109;
         end;
            rng g1 /\ rng g2 = {}
         proof consider x being Element of rng g1 /\ rng g2;
          assume not thesis;
          then A110: x in rng g1 & x in rng g2 by XBOOLE_0:def 3;
               now per cases by A14,REAL_1:def 5;
           suppose k=1;
            hence contradiction by A37,A95,A110,TARSKI:def 1;
           end;
           suppose 1<k;
            then x in L~f1 /\ LSeg(f,k) & L~f1 /\ LSeg(f,k)={f/.k}
             by A5,A8,A9,A44,A107,A110,GOBOARD2:9,XBOOLE_0:def 3;
            hence contradiction by A95,A110,TARSKI:def 1;
           end;
           end;
          hence contradiction;
         end;
        then rng g1 misses rng g2 by XBOOLE_0:def 7;
        hence g is one-to-one by A29,A94,FINSEQ_3:98;
        A111: for n st 1<=n & n+2 <= len g2 holds
             LSeg(g2,n) /\ LSeg(g2,n+1) = {g2/.(n+1)}
         proof let n; assume
          A112: 1<=n & n+2 <= len g2;
          then A113: n in dom g2 & n+1 in dom g2 & n+2 in dom g2 by GOBOARD2:4;
          then g2/.n in rng g2 & g2/.(n+1) in rng g2 &
          g2/.(n+2) in rng g2 by PARTFUN2:4;
then A114: g2/.n in lk & g2/.(n+1) in lk & g2/.(n+2) in lk by A89,A107;
          then consider u be Point of TOP-REAL 2 such that
          A115: g2/.n=u & u`1=ppi`1 & pj`2<=u`2 & u`2<=ppi`2;
          consider u1 be Point of TOP-REAL 2 such that
          A116: g2/.(n+1)=u1 & u1`1=ppi`1 & pj`2<=u1`2 & u1`2<=ppi`2 by A114;
          consider u2 be Point of TOP-REAL 2 such that
          A117: g2/.(n+2)=u2 & u2`1=ppi`1 & pj`2<=u2`2 & u2`2<=ppi`2 by A114;
          set lg = {w where w is Point of TOP-REAL 2:
                     w`1=ppi`1 & u2`2<=w`2 & w`2<=u`2};
          A118: n+(1+1) = n+1+1;
              n+1 <= n+2 by XREAL_1:8;
           then n+1 <= len g2 by A112,XXREAL_0:2;
then A119:      LSeg(g2,n)=LSeg(u,u1) by A112,A115,A116,TOPREAL1:def 5;
              1 <= n+1 by NAT_1:11;
then A120:      LSeg(g2,n+1)=LSeg(u1,u2) by A112,A116,A117,A118,TOPREAL1:def 5;
              n<n+1 & n+1<n+1+1 & n+1+1=n+(1+1) by NAT_1:13;
          then A121: u2`2<u1`2 & u1`2<u`2 by A103,A113,A115,A116,A117;
          then A122: u2`2<=u1`2 & u1`2<=u`2 & u2`2<u`2 by XXREAL_0:2;
          A123: u1 in lg & u=|[u`1,u`2]| & u2=|[u2`1,u2`2]| by A116,A121,
EUCLID:57;
          then LSeg(g2/.n,g2/.(n+2))=lg by A115,A117,A122,TOPREAL3:15;
          hence thesis by A115,A116,A117,A119,A120,A123,TOPREAL1:14;
         end;
        thus g is unfolded
         proof let n be Nat; assume
          A124: 1<=n & n+2 <= len g;
then A125:     n+1+1<=len g;
          A126: 1 <= n+1 by NAT_1:11;
          A127: n<=n+1 & n+1<=n+1+1 by NAT_1:11;
then A128:      n+1 <= len g by A124,XXREAL_0:2;
A129:      n+(1+1)=n+1+1;
A130:      len g=len g1+len g2 by FINSEQ_1:35;
               n+2-len g1 = n-len g1 +2;
          then A131: n-len g1 + 2 <= len g2 by A124,A130,XREAL_1:22;
A132:       n+1+1 = n+(1+1);
           per cases;
           suppose A133: n+2 <= len g1;
        then n in dom g1 & n+1 in dom g1 & n+2 in dom g1 & n+(1+1)=n+1+1
              by A124,GOBOARD2:4;
            then LSeg(g1,n)=LSeg(g,n) & LSeg(g1,n+1)=LSeg(g,n+1) &
            g/.(n+1)=g1/.(n+1) by FINSEQ_4:83,TOPREAL3:25;
            hence thesis by A30,A124,A133,TOPREAL1:def 8;
           end;
           suppose len g1 < n+2;
            then len g1+1<=n+2 by NAT_1:13;
            then A134: len g1<=n+2-1 by XREAL_1:21;
                 now per cases;
             suppose A135: len g1=n+1;
                   now assume A136: k=1;
                    1<len g1 by A124,A135,NAT_1:13;
                then 1+1<=len g1 by NAT_1:13;
                hence contradiction by A37,A136,TOPREAL1:29;
               end;
              then A137: 1<k & LSeg(g1,n) c= L~f1
                 by A14,A33,REAL_1:def 5,TOPREAL3:26;
              then A138: L~f1 /\ LSeg(f,k)={f/.k} by A5,A8,A9,GOBOARD2:9;
                  1<=n+1 by NAT_1:11;
              then A139: n in dom g1 & n+1 in dom g1
              by A124,A127,A135,FINSEQ_3:27;
              then A140: LSeg(g,n)=LSeg(g1,n) by TOPREAL3:25;
              A141: g/.(n+1)=f1/.len f1 by A35,A135,A139,FINSEQ_4:83
              .= ppi by A15,A16,A18,A47,FINSEQ_4:86;
                A142: 1<=len g-len g1 by A125,A135,XREAL_1:21;
              then A143: g/.(n+2)=g2/.1 by A129,A130,A135,GOBOARD2:5;
                  1 in dom g2 by A130,A142,FINSEQ_3:27;
              then A144: g2/.1 in rng g2 by PARTFUN2:4;
              then g2/.1 in lk by A89,A107;
              then consider u1 be Point of TOP-REAL 2 such that
              A145: g2/.1=u1 & u1`1=ppi`1 & pj`2<=u1`2 & u1`2<=ppi`2;
                  ppi in LSeg(ppi,pj) by TOPREAL1:6;
              then LSeg(ppi,u1) c= LSeg(f,k) & LSeg(g,n+1)=LSeg(ppi,u1)
                by A90,A107,A124,A126,A132,A141,A143,A144,A145,TOPREAL1:12
,def 5;
              then A146: LSeg(g,n) /\ LSeg(g,n+1) c= {g/.(n+1)}
               by A47,A137,A138,A140,A141,XBOOLE_1:27;
                  g/.(n+1) in LSeg(g,n) & g/.(n+1) in LSeg(g,n+1)
                by A124,A126,A128,A132,TOPREAL1:27;
              then g/.(n+1) in LSeg(g,n) /\ LSeg(g,n+1) by XBOOLE_0:def 3;
              then {g/.(n+1)} c= LSeg(g,n) /\ LSeg(g,n+1) by ZFMISC_1:37;
              hence thesis by A146,XBOOLE_0:def 10;
             end;
             suppose len g1<>n+1; then len g1<n+1 by A134,REAL_1:def 5;
              then A147: len g1<=n by NAT_1:13;
              then reconsider n1=n-len g1 as Element of NAT by INT_1:18;
                   now per cases;
               suppose A148: len g1=n;
                    1<=len g1 by A14,A16,A36,XXREAL_0:2;
                then len g1 in dom g1 by FINSEQ_3:27;
                then A149: g/.n=f1/.len f1 by A35,A148,FINSEQ_4:83
                .= ppi by A15,A16,A18,A47,FINSEQ_4:86;
                    1 <= len g2 by A128,A130,A148,XREAL_1:8;
                then A150: g/.(n+1)=g2/.1 by A148,GOBOARD2:5;
                    2 <= len g2 by A124,A130,A148,XREAL_1:8;
                then A151: g/.(n+2)=g2/.2 by A148,GOBOARD2:5;
                A152: 0+2<=len g2 by A124,A130,A148,XREAL_1:8;
                then 1<=len g2 by XXREAL_0:2;
                then A153: 1 in dom g2 & 2 in dom g2 by A152,FINSEQ_3:27;
                then g2/.1 in rng g2 & g2/.2 in rng g2 by PARTFUN2:4;
                then A154: g2/.1 in lk & g2/.2 in lk by A89,A107;
                then consider u1 be Point of TOP-REAL 2 such that
                A155: g2/.1=u1 & u1`1=ppi`1 & pj`2<=u1`2 & u1`2<=ppi`2;
                consider u2 be Point of TOP-REAL 2 such that
          A156: g2/.2=u2 & u2`1=ppi`1 & pj`2<=u2`2 & u2`2<=ppi`2 by A154;
                A157: u2`2<u1`2 by A103,A153,A155,A156;
                then A158: u2`2<=u1`2 & u2`2<ppi`2 & u2=|[u2`1,u2`2]|
                  by A155,EUCLID:57,XXREAL_0:2;
                set lg = {w where w is Point of TOP-REAL 2 :
                          w`1=ppi`1 & u2`2<=w`2 & w`2<=ppi`2};
                A159: u1 in lg by A155,A157;
A160:            LSeg(g,n)=LSeg(ppi,u1)
                 by A124,A128,A149,A150,A155,TOPREAL1:def 5;
A161:            LSeg(g,n+1)=LSeg(u1,u2)
                 by A124,A126,A132,A150,A151,A155,A156,TOPREAL1:def 5;
                    LSeg(ppi,g2/.2)=lg by A88,A156,A158,TOPREAL3:15;
                hence thesis by A150,A155,A156,A159,A160,A161,TOPREAL1:14;
               end;
               suppose len g1<>n;
then A162:              len g1<n by A147,REAL_1:def 5;
               n1 + len g1 = n;
then A163:            LSeg(g,n)=LSeg(g2,n1) by A128,A162,GOBOARD2:10;
A164:            len g1<n+1 by A127,A162,XXREAL_0:2;
A165:            len g1+1<=n by A162,NAT_1:13;
A166:            n+1 = n1+1+len g1;
A167:             1<=n1+1 by NAT_1:11;
                    n1 + 1 + len g1 = n + 1;
then A168:              n1+1 <= len g2 by A128,A130,XREAL_1:8;
A169:             LSeg(g,n+1)=LSeg(g2,n1+1) by A125,A164,A166,GOBOARD2:10;
A170:             g/.(n+1)=g2/.(n1+1) by A166,A167,A168,GOBOARD2:5;
                    1<=n1 by A165,XREAL_1:21;
                hence thesis by A111,A131,A163,A169,A170;
               end;
               end;
              hence thesis;
             end;
             end;
            hence thesis;
         end;
         end;
               for n,m st m>n+1 & n in dom g2 & n+1 in dom g2 & m in dom g2 &
           m+1 in dom g2 holds LSeg(g2,n) misses LSeg(g2,m)
         proof let n,m; assume that
          A171: m>n+1 and
          A172: n in dom g2 & n+1 in dom g2 & m in dom g2 & m+1 in dom g2 and
          A173: LSeg(g2,n) /\ LSeg(g2,m) <> {};
          A174: 1 <= n & n+1 <= len g2 & 1 <= m & m+1<=
 len g2 by A172,FINSEQ_3:27;
          reconsider p1=g2/.n, p2=g2/.(n+1), q1=g2/.m, q2=g2/.(m+1)
           as Point of TOP-REAL 2;
          set lp = {w where w is Point of TOP-REAL 2: w`1=ppi`1 &
                         p2`2<=w`2 & w`2<=p1`2},
              lq = {w where w is Point of TOP-REAL 2: w`1=ppi`1 &
                         q2`2<=w`2 & w`2<=q1`2};
               m<m+1 & n<n+1 by NAT_1:13;
           then A175: p2`2<p1`2 & q2`2<q1`2 & p1`1=ppi`1 & p2`1=ppi`1 & q1`1=
ppi`1 &
           q2`1=ppi`1 & p1=|[p1`1,p1`2]| & q1=|[q1`1,q1`2]| &
           p2=|[p2`1,p2`2]| &
           q2=|[q2`1,q2`2]| by A98,A103,A172,EUCLID:57;
           A176: LSeg(g2,n) = LSeg(p2,p1) by A174,TOPREAL1:def 5
           .=lp by A175,TOPREAL3:15;
           A177: LSeg(g2,m) = LSeg(q2,q1) by A174,TOPREAL1:def 5
           .=lq by A175,TOPREAL3:15;
           consider x being Element of LSeg(g2,n) /\ LSeg(g2,m);
           A178: x in LSeg(g2,n) & x in LSeg(g2,m) by A173,XBOOLE_0:def 3;
then A179:         ex tn be Point of TOP-REAL 2
               st tn=x & tn`1=ppi`1 & p2`2<=tn`2 & tn`2<=p1`2 by A176;
A180:         ex tm be Point of TOP-REAL 2 st
              tm=x & tm`1=ppi`1 & q2`2<=tm`2 & tm`2<=q1`2 by A177,A178;
                q1`2<p2`2 by A103,A171,A172;
            hence contradiction by A179,A180,XXREAL_0:2;
         end;
then A181:    g2 is s.n.c. by GOBOARD2:6;
        A182: L~g2 c= LSeg(f,k)
         proof
          set ls={LSeg(g2,m): 1<=m & m+1 <= len g2}; let x; assume
              x in L~g2;
          then consider X be set such that
          A183: x in X & X in ls by TARSKI:def 4;
          consider m such that
          A184: X=LSeg(g2,m) & 1<=m & m+1 <= len g2 by A183;
               m in dom g2 & m+1 in dom g2 by A184,GOBOARD2:3;
          then A185: g2/.m in rng g2 & g2/.(m+1) in rng g2 by PARTFUN2:4;
          reconsider q1=g2/.m, q2=g2/.(m+1) as Point of TOP-REAL 2;
          A186: LSeg(q1,q2) c= LSeg(ppi,pj) by A90,A107,A185,TOPREAL1:12;
              LSeg(g2,m)=LSeg(q1,q2) by A184,TOPREAL1:def 5;
          hence thesis by A90,A183,A184,A186;
         end;
        A187: not f/.k in L~g2
         proof set ls={LSeg(g2,m): 1<=m & m+1 <= len g2}; assume
              f/.k in L~g2;
          then consider X be set such that
          A188: f/.k in X & X in ls by TARSKI:def 4;
          consider m such that
          A189: X=LSeg(g2,m) & 1<=m & m+1 <= len g2 by A188;
          A190: m in dom g2 & m+1 in dom g2 & m<m+1
          by A189,GOBOARD2:3,NAT_1:13;
          reconsider q1=g2/.m, q2=g2/.(m+1) as Point of TOP-REAL 2;
          set lq={w where w is Point of TOP-REAL 2: w`1=ppi`1 &
                       q2`2<=w`2 & w`2<=q1`2};
          A191: q1`1=ppi`1 & q2`1=ppi`1 & q2`2<q1`2 & q1=|[q1`1,q1`2]|
          & q2=|[q2`1,q2`2]| by A98,A103,A190,EUCLID:57;
              LSeg(g2,m)=LSeg(q2,q1) by A189,TOPREAL1:def 5
          .=lq by A191,TOPREAL3:15;
          then ex p st p=f/.k & p`1=ppi`1 & q2`2<=p`2 & p`2<=q1`2 by A188,A189
;
          hence contradiction by A47,A98,A190;
         end;
        A192: L~g1 /\ L~g2 = {}
         proof
           per cases;
           suppose k=1; hence thesis by A37;
           end;
           suppose k<>1; then 1<k by A14,REAL_1:def 5;
            then L~g1 /\ LSeg(f,k)={f/.k} by A5,A8,A9,A33,GOBOARD2:9;
            then A193: L~g1 /\ L~g2 c= {f/.k} by A182,XBOOLE_1:26;
                 now consider x being Element of L~g1 /\ L~g2;
              assume L~g1 /\ L~g2 <> {};
              then x in {f/.k} & x in L~g2 by A193,TARSKI:def 3,XBOOLE_0:def 3
;
              hence contradiction by A187,TARSKI:def 1;
             end;
            hence thesis;
         end;
         end;
            for n,m st m>n+1 & n in dom g & n+1 in dom g &
        m in dom g & m+1 in dom g holds LSeg(g,n) misses LSeg(g,m)
         proof let n,m; assume that
          A194: m>n+1 and
          A195: n in dom g & n+1 in dom g & m in dom g & m+1 in dom g;
          A196: 1<=n & 1<=n+1 & n+1<=len g & 1<=m & 1<=m+1 &
          m+1<=len g & n<=n+1 & m<=m+1 & len g=len g1+len g2
            by A195,FINSEQ_1:35,FINSEQ_3:27,NAT_1:11;
          set l1 = {LSeg(g1,i): 1<=i & i+1 <= len g1},
              l2 = {LSeg(g2,j): 1<=j & j+1 <= len g2};
              j2+1<=i2 by A72,NAT_1:13;
          then A197: 1<=l by XREAL_1:21;
          then A198: 1 in dom g2 by A76,FINSEQ_3:27;
          reconsider qq=g2/.1 as Point of TOP-REAL 2;
          set ql={z where z is Point of TOP-REAL 2: z`1=ppi`1 &
                     qq`2<=z`2 & z`2<=ppi`2};
          A199: 1<=len g1 by A14,A16,A36,XXREAL_0:2;
           then len g1 in dom g1 & dom g1 c= dom g by FINSEQ_1:39,FINSEQ_3:27;
          then A200: g/.len g1=g1/.len g1 by FINSEQ_4:83
             .= ppi by A15,A16,A18,A35,A47,FINSEQ_4:86;
          A201: len g1<len g1 +1 & len g1+1<=len g
            by A76,A196,A197,NAT_1:13,XREAL_1:9;
          A202: g/.(len g1+1)=qq by A76,A197,GOBOARD2:5;
          A203: qq`1=ppi`1 & pj`2<=qq`2 & qq`2<ppi`2 & qq=|[qq`1,qq`2]|
           by A98,A198,EUCLID:57;
    A204: LSeg(g,len g1)=LSeg(qq,ppi) by A199,A200,A201,A202,TOPREAL1:def 5
           .= ql by A88,A203,TOPREAL3:15;
            A205: n+1<=m+1 by A194,A196,XXREAL_0:2;
                 now per cases;
             suppose A206: m+1<=len g1;
              then A207: m<=len g1 & n+1<=len g1 by A196,A205,XXREAL_0:2;
              then n<=len g1 by A196,XXREAL_0:2;
              then n in dom g1 & n+1 in dom g1 & m in dom g1 & m+1 in dom g1
               by A196,A206,A207,FINSEQ_3:27;
              then LSeg(g,n)=LSeg(g1,n) & LSeg(g,m)=LSeg(g1,m) by TOPREAL3:25;
              hence thesis by A31,A194,TOPREAL1:def 9;
             end;
             suppose len g1<m+1;
              then A208: len g1<=m by NAT_1:13;
              then reconsider m1=m-len g1 as Element of NAT by INT_1:18;
                   now per cases;
               suppose A209: m=len g1;
                     now assume A210: k=1;
                      1<len g1 by A194,A196,A209,XXREAL_0:2;
                  then 1+1<=len g1 by NAT_1:13;
                  hence contradiction by A37,A210,TOPREAL1:29;
                 end;
                then 1<k by A14,REAL_1:def 5;
                then A211: L~f1 /\ LSeg(f,k) ={f/.k}
                 by A5,A8,A9,GOBOARD2:9;
                    n<=len g1 by A194,A196,A209,XXREAL_0:2;
                then A212: n in dom g1 & n+1 in dom g1
                by A194,A196,A209,FINSEQ_3:27;
                then A213: LSeg(g,n)=LSeg(g1,n) by TOPREAL3:25;
                then LSeg(g,n) in l1 by A194,A196,A209;
                then A214: LSeg(g,n) c= L~f1 by A33,ZFMISC_1:92;
                    LSeg(g,m) c= LSeg(f,k)
                 proof let x; assume x in LSeg(g,m);
                  then consider px be Point of TOP-REAL 2 such that
                  A215: px=x & px`1=ppi`1 & qq`2<=px`2 & px`2<=
ppi`2 by A204,A209;
                      pj`2<=px`2 by A203,A215,XXREAL_0:2;
                  hence thesis by A89,A215;
                 end;
                then A216: LSeg(g,n) /\ LSeg(g,m) c= {f/.k}
                 by A211,A214,XBOOLE_1:27;
                     now consider x being Element of LSeg(g,n) /\ LSeg(g,m);
                  assume LSeg(g,n)/\ LSeg(g,m)<>{};
                  then A217: x in LSeg(g,n) & x in {f/.k}
                  by A216,TARSKI:def 3,XBOOLE_0:def 3;
                  then A218: x=f/.k by TARSKI:def 1;
                      f/.k=g1/.len g1 by A15,A16,A18,A35,FINSEQ_4:86;
                  hence contradiction
                  by A29,A30,A31,A194,A209,A212,A213,A217,A218,GOBOARD2:7;
                 end;
                hence thesis by XBOOLE_0:def 7;
               end;
               suppose
               m<>len g1;
                then A219: len g1<m & m+1 = m1+1 +len g1
                 by A208,REAL_1:def 5;
                    m = m1+len g1;
                then A220: LSeg(g,m)=LSeg(g2,m1) by A196,A219,GOBOARD2:10;
                    m1+1<=len g2 & len g1+1<=
m by A196,A219,NAT_1:13,XREAL_1:8;
                then A221: 1<=m1 & m1+1 <= len g2 by XREAL_1:21;
                then LSeg(g,m) in l2 by A220;
                then A222: LSeg(g,m) c= L~g2 by ZFMISC_1:92;
                     now per cases;
                 suppose A223: n+1<=len g1;
                  then n<=len g1 by A196,XXREAL_0:2;
                  then n in dom g1 & n+1 in dom g1 by A196,A223,FINSEQ_3:27;
                   then LSeg(g,n)=LSeg(g1,n) by TOPREAL3:25;
                  then LSeg(g,n) in l1 by A196,A223;
                  then LSeg(g,n) c= L~g1 by ZFMISC_1:92;
                  then LSeg(g,n) /\ LSeg(g,m) c= {} by A192,A222,XBOOLE_1:27;
                  then LSeg(g,n) /\ LSeg(g,m) = {} by XBOOLE_1:3;
                  hence thesis by XBOOLE_0:def 7;
                 end;
                 suppose len g1<n+1;
                  then A224: len g1<=n by NAT_1:13;
                  then reconsider n1=n-len g1 as Element of NAT by INT_1:18;
A225:               n - len g1 + 1 = n + 1 - len g1;
A226:               n = n1 + len g1;
                       now per cases;
                   suppose A227: len g1=n;
                         now consider x being Element of LSeg(g,n) /\ LSeg(g,m)
;
                      assume LSeg(g,n) /\ LSeg(g,m)<>{};
                      then A228: x in LSeg(g,n) & x in LSeg(g,m)
                      by XBOOLE_0:def 3;
then A229:                      ex qx be Point of TOP-REAL 2 st
               qx=x & qx`1=ppi`1 & qq`2<=qx`2 & qx`2<=ppi`2 by A204,A227;
                      A230: m1 in dom g2 & m1+1 in dom g2 & m1<m1+1
                        by A221,GOBOARD2:3,NAT_1:13;
                      reconsider q1=g2/.m1, q2=g2/.(m1+1)
                       as Point of TOP-REAL 2;
                      set q1l={v where v is Point of TOP-REAL 2: v`1=ppi`1 &
                                 q2`2<=v`2 & v`2<=q1`2};
A231: q1`1=ppi`1 & q2`1=ppi`1 & q2`2<q1`2 & q1=|[q1`1,q1`2]|&
                      q2=|[q2`1,q2`2]| by A98,A103,A230,EUCLID:57;
                          m1 > n1 + 1 & n1 + 1 >=
 1 by A194,A225,NAT_1:11,XREAL_1:11;
then A232:                   m1 > 1 by XXREAL_0:2;
                          LSeg(g2,m1)=LSeg(q2,q1) by A221,TOPREAL1:def 5
                      .=q1l by A231,TOPREAL3:15;
then A233:                      ex qy be Point of TOP-REAL 2 st
 qy=x & qy`1=ppi`1 & q2`2<=qy`2 & qy`2<=q1`2 by A220,A228;
                          q1`2 < qq`2 by A103,A198,A230,A232;
                      hence contradiction by A229,A233,XXREAL_0:2;
                     end;
                    hence thesis by XBOOLE_0:def 7;
                   end;
                   suppose n<>len g1;
                    then len g1<n by A224,REAL_1:def 5;
                    then LSeg(g,n)=LSeg(g2,n1) & m1>n1+1
                     by A194,A196,A225,A226,GOBOARD2:10,XREAL_1:11;
                    hence thesis by A181,A220,TOPREAL1:def 9;
                   end;
                   end;
                  hence thesis;
                 end;
                 end;
                hence thesis;
               end;
               end;
              hence thesis;
             end;
             end;
            hence thesis;
         end;
        hence g is s.n.c. by GOBOARD2:6;
        A234: g2 is special
         proof let n be Nat;
         set p = g2/.n, q = g2/.(n+1);
         assume 1<=n & n+1 <= len g2;
          then n in dom g2 & n+1 in dom g2 by GOBOARD2:3;
          then p`1=ppi`1 & q`1=ppi`1 by A98;
          hence p`1=q`1 or p`2=q`2;
         end;
             now set p=g1/.len g1, q=g2/.1;
              j2+1<=i2 by A72,NAT_1:13;
          then 1<=l by XREAL_1:21;
          then 1 in dom g2 by A77,FINSEQ_1:3;
           then q`1=ppi`1 by A98;
          hence p`1=q`1 or p`2=q`2
           by A15,A16,A18,A35,A47,FINSEQ_4:86;
         end;
        hence g is special by A32,A234,GOBOARD2:13;
        thus L~g=L~f
         proof
          set lg = {LSeg(g,i): 1<=i & i+1 <= len g},
              lf = {LSeg(f,j): 1<=j & j+1 <= len f};
          A235: len g = len g1 + len g2 by FINSEQ_1:35;
          A236: now let j; assume
            A237: len g1<=j & j<=len g;
            then reconsider w = j-len g1 as Element of NAT by INT_1:18;
            let p such that
            A238: p=g/.j;
                 now per cases;
             suppose A239: j=len g1;
                  1<=len g1 by A14,A16,A36,XXREAL_0:2;
              then len g1 in dom g1 by FINSEQ_3:27;
              then A240: g/.len g1 = f1/.len f1 by A35,FINSEQ_4:83
              .= G*(i1,i2) by A15,A16,A18,A47,FINSEQ_4:86;
              hence p`1=G*(i1,i2)`1 by A238,A239;
              thus G*(i1,j2)`2<=p`2 & p`2<=G*(i1,i2)`2 by A51,A55,A59,A60,A62
,A72,A87,A238,A239,A240,GOBOARD1:def 1;
                   dom l1 = Seg len l1 by FINSEQ_1:def 3;
              hence p in rng l1 by A51,A62,A86,A238,A239,A240,PARTFUN2:4;
             end;
             suppose j<>len g1;
           then len g1 < j by A237,REAL_1:def 5;
then len g1 + 1<=j by NAT_1:13;
then A241:           1<=w & w<=len g2 by A235,A237,XREAL_1:21,22;
               w + len g1 = j;
              then A242: g/.j=g2/.w by A241,GOBOARD2:5;
                  w in dom g2 by A241,FINSEQ_3:27;
              hence p`1=ppi`1 & pj`2<=p`2 & p`2<=
ppi`2 & p in rng l1 by A98,A238,A242;
             end;
             end;
            hence p`1=ppi`1 & pj`2<=p`2 & p`2<=ppi`2 & p in rng l1;
           end;
          thus L~g c= L~f
           proof let x; assume x in L~g;
            then consider X be set such that
            A243: x in X & X in lg by TARSKI:def 4;
            consider i such that
            A244: X=LSeg(g,i) & 1<=i & i+1 <= len g by A243;
             per cases;
             suppose A245: i+1 <= len g1;
              then i<=i+1 & i+1<=len g1 by NAT_1:11;
              then 1<=i & i<=len g1 & 1<=i+1 & i+1<=len g1 by A244,XXREAL_0:2;
              then i in dom g1 & i+1 in dom g1 by FINSEQ_3:27;
              then X=LSeg(g1,i) by A244,TOPREAL3:25;
              then X in {LSeg(g1,j): 1<=j & j+1 <= len g1} by A244,A245;
              then x in L~f1 & L~f1 c= L~f by A33,A243,TARSKI:def 4,TOPREAL3:27
;
              hence thesis;
             end;
             suppose A246: i+1 > len g1;
              then A247: len g1<=i & i<=i+1 & i+1<=len g by A244,NAT_1:13;
              A248: 1<=i+1 & len g1<=i+1 & i<=len g by A244,A246,NAT_1:13;
              reconsider q1=g/.i, q2=g/.(i+1) as Point of TOP-REAL 2;
              A249: q1`1=ppi`1 & pj`2<=q1`2 & q1`2<=ppi`2 & q2`1=ppi`1 & pj`2<=
q2`2 &
                  q2`2<=ppi`2 by A236,A247,A248;
              then A250: q1=|[q1`1,q1`2]| & q2=|[q1`1,q2`2]| by EUCLID:57;
              A251: LSeg(g,i)=LSeg(q2,q1) by A244,TOPREAL1:def 5;
                   now per cases by XXREAL_0:1;
               suppose q1`2>q2`2;
                then LSeg(g,i)={p2: p2`1=q1`1 & q2`2<=p2`2 & p2`2<=q1`2}
                  by A250,A251,TOPREAL3:15;
                then consider p2 such that
                A252: p2=x & p2`1=q1`1 & q2`2<=p2`2 & p2`2<=q1`2 by A243,A244;
                    pj`2<=p2`2 & p2`2<=ppi`2 by A249,A252,XXREAL_0:2;
                then x in LSeg(f,k) & LSeg(f,k) in lf by A14,A89,A249,A252;
                hence thesis by TARSKI:def 4;
               end;
               suppose q1`2=q2`2;
                then LSeg(g,i)={q1} by A250,A251,TOPREAL1:7;
                then x=q1 by A243,A244,TARSKI:def 1;
                then x in LSeg(f,k) & LSeg(f,k) in lf by A14,A89,A249;
                hence thesis by TARSKI:def 4;
               end;
               suppose q1`2<q2`2;
                then LSeg(g,i)= {p1: p1`1=q1`1 & q1`2<=p1`2 & p1`2<=q2`2}
                  by A250,A251,TOPREAL3:15;
                then consider p2 such that
                A253: p2=x & p2`1=q1`1 & q1`2<=p2`2 & p2`2<=q2`2 by A243,A244;
                    pj`2<=p2`2 & p2`2<=ppi`2 by A249,A253,XXREAL_0:2;
                then x in LSeg(f,k) & LSeg(f,k) in lf by A14,A89,A249,A253;
                hence thesis by TARSKI:def 4;
               end;
               end;
              hence thesis;
           end;
           end;
          let x; assume x in L~f;
          then A254: x in L~f1 \/ LSeg(f,k) by A5,A12,GOBOARD2:8;
           per cases by A254,XBOOLE_0:def 2;
           suppose x in L~f1; then x in L~g1 & L~g1 c= L~g
            by A33,GOBOARD2:11;
            hence x in L~g;
           end;
           suppose x in LSeg(f,k);
            then consider p1 such that
            A255: p1=x & p1`1=ppi`1 & pj`2<=p1`2 & p1`2<=ppi`2 by A89;
            defpred P2[Nat] means
            len g1<=$1 & $1<=len g & for q st q=g/.$1 holds q`2>=p1`2;
            A256: now
              reconsider n=len g1 as Nat;
              take n;
              thus P2[n]
              proof
               thus len g1<=n & n<=len g by A235,REAL_2:173;
               let q such that
               A257: q=g/.n;
                   1<=len g1 by A14,A16,A36,XXREAL_0:2;
               then len g1 in dom g1 by FINSEQ_3:27;
               then q=f1/.len f1 by A35,A257,FINSEQ_4:83
               .=G*(i1,i2) by A15,A16,A18,A47,FINSEQ_4:86;
               hence p1`2<=q`2 by A255;
              end;
             end;
            A258: for n be Nat holds P2[n] implies n<=len g;
            consider ma be Nat such that
            A259: P2[ma] & for n be Nat st P2[n] holds n<=ma from NAT_1:sch 6
(A258,A256);
reconsider ma as Element of NAT by ORDINAL1:def 13;
                 now per cases;
             suppose A260: ma=len g;
                  j2+1<=i2 by A72,NAT_1:13;
              then A261: 1<=l & l=len g2 by A76,XREAL_1:21;
              then A262: l in dom g2 & i2-l=j2 by FINSEQ_3:27;
              then A263: g/.ma=g2/.l by A76,A235,A260,FINSEQ_4:84
               .= pj by A76,A77,A262;
              then p1`2<=pj`2 by A259;
              then A264: p1`2=pj`2 by A255,XXREAL_0:1;
              A265: ma-1<=len g & len g1+1<=ma
                by A235,A260,A261,XREAL_1:9,45;
              then A266: len g1<=ma-1 & 0<=len g1 by XREAL_1:21;
then           0+1<=ma by XREAL_1:21;
              then reconsider m1=ma-1 as Element of NAT by INT_1:18;
                  1<=len g1 by A14,A16,A36,XXREAL_0:2;
              then A267: 1<=m1 by A266,XXREAL_0:2;
              reconsider q=g/.m1 as Point of TOP-REAL 2;
              A268: q`1=ppi`1 & pj`2<=q`2 & q=|[q`1,q`2]| & m1+1=ma
               by A236,A265,A266,EUCLID:57;
              then A269: LSeg(g,m1)=LSeg(pj,q)
               by A260,A263,A267,TOPREAL1:def 5;
              set lq={e where e is Point of TOP-REAL 2: e`1=ppi`1 & pj`2<=e`2 &
                      e`2<=q`2};
               LSeg(g,m1)=lq by A88,A268,A269,TOPREAL3:15;
              then p1 in LSeg(g,m1) & LSeg(g,m1) in lg
              by A255,A260,A264,A267,A268;
              hence x in L~g by A255,TARSKI:def 4;
             end;
             suppose ma<>len g;
              then ma<len g by A259,REAL_1:def 5;
              then A270: ma+1<=len g & k<=ma & ma<=ma+1
                by A16,A36,A259,NAT_1:13,XXREAL_0:2;
              A271: 1<=ma & len g1<=ma+1 by A14,A16,A36,A259,NAT_1:13;
              reconsider qa=g/.ma, qa1=g/.(ma+1) as Point of TOP-REAL 2;
              A272: p1`2<=qa`2 by A259;
               A273: now assume p1`2<=qa1`2;
                 then for q holds q=g/.(ma+1) implies p1`2<=q`2;
                then ma+1<=ma by A259,A270,A271;
                hence contradiction by REAL_2:174;
               end;
              then A274: qa1`2<qa`2 & qa1`2<=p1`2 & p1`2<=qa`2 &
        qa`1=ppi`1 & qa1 `1 = ppi`1 by A236,A259,A270,A271,A272,XXREAL_0:2;
              set lma = {p2: p2`1=ppi`1 & qa1`2<=p2`2 & p2`2<=qa`2};
              A275: qa=|[qa`1,qa`2]| & qa1=|[qa1 `1, qa1 `2]| by EUCLID:57;
                  LSeg(g,ma)=LSeg(qa1,qa) by A270,A271,TOPREAL1:def 5
              .= lma by A274,A275,TOPREAL3:15;
              then x in LSeg(g,ma) & LSeg(g,ma) in lg by A255,A270,A271,A272
,A273;
              hence x in L~g by TARSKI:def 4;
             end;
             end;
            hence x in L~g;
         end;
         end;
            1<=len g1 by A14,A16,A36,XXREAL_0:2;
        then 1 in dom g1 by FINSEQ_3:27;
        hence g/.1=f1/.1 by A34,FINSEQ_4:83
        .=f/.1 by A15,A19,FINSEQ_4:86;
            j2+1<=i2 by A72,NAT_1:13;
        then A276: 1<=l by XREAL_1:21;
         then A277: l in dom g2 & len g=len g1 + len g2 & len g2 = l
         by A77,FINSEQ_1:3,35,def 3;
         reconsider m1=i2-l as Element of NAT;
         thus g/.len g=g2/.l by A277,FINSEQ_4:84
         .=G*(i1,m1) by A76,A77,A277
         .=f/.len f by A5,A49,A71;
         thus len f<=len g by A5,A16,A36,A276,A277,XREAL_1:9;
       end;
       case A278: i2=j2;
            k<>k+1;
        hence contradiction by A7,A15,A47,A48,A49,A71,A278,PARTFUN2:17;
       end;
       case A279: i2<j2;
        then reconsider l=j2-i2 as Element of NAT by INT_1:18;
        deffunc F(Element of NAT) = G*(i1,i2+$1);
        consider g2 such that
        A280: len g2=l & for n st n in dom g2 holds g2/.n=F(n) from
GOBOARD2:sch 1;
        take g=g1^g2;
        A281: now let n; assume n in Seg l;
          then A282: 1<=n & n<=l by FINSEQ_1:3;
          then n<=n+i2 & i2+n<=l+i2 by NAT_1:11,XREAL_1:9;
          then n<=i2+n & i2+n<=j2 & j2<=width G
           by A51,FINSEQ_1:3;
          then 1<=i2+n & i2+n<=width G by A282,XXREAL_0:2;
          hence i2+n in Seg width G by FINSEQ_1:3;
          hence [i1,i2+n] in Indices G by A50,A51,ZFMISC_1:106;
         end;
        A283: dom g2 = Seg len g2 by FINSEQ_1:def 3;
             now let n such that A284: n in dom g2;
          take m=i1,k=i2+n;
          thus [m,k] in Indices G & g2/.n=G*(m,k) by A280,A281,A283,A284;
         end;
        then A285: for n st n in dom g ex i,j st [i,j] in Indices G &
        g/.n=G*(i,j) by A53,GOBOARD1:39;
        A286: now let n; assume
              n in dom g2 & n+1 in dom g2;
          then A287: g2/.n=G*(i1,i2+n) & [i1,i2+n] in Indices G &
          g2/.(n+1)=G*(i1,i2+(n+1)) &
          [i1,i2+(n+1)] in Indices G by A280,A281,A283;
          let l1,l2,l3,l4 be Element of NAT; assume
              [l1,l2] in Indices G & [l3,l4] in Indices G & g2/.n=G*(l1,l2) &
          g2/.(n+1)=G*(l3,l4);
           then l1=i1 & l2=i2+n & l3=i1 & l4=i2+(n+1) by A287,GOBOARD1:21;
          hence abs(l1-l3)+abs(l2-l4)= 0+abs(i2+n-(i2+(n+1))) by ABSVALUE:7
          .= abs(-1)
          .= abs(1) by COMPLEX1:138
          .= 1 by ABSVALUE:def 1;
         end;
          now let l1,l2,l3,l4 be Element of NAT; assume
A288: [l1,l2] in Indices G & [l3,l4] in Indices G & g1/.len g1=G*(l1,l2) &
          g2/.1=G*(l3,l4) & len g1 in dom g1 & 1 in dom g2;
          then g2/.1=G*
(i1,i2+1) & [i1,i2+1] in Indices G & f1/.len f1=f/.k
            by A15,A16,A18,A280,A281,A283,FINSEQ_4:86;
           then l1=i1 & l2=i2 & l3=i1 & l4=i2+1 by A35,A47,A288,GOBOARD1:21;
          hence abs(l1-l3)+abs(l2-l4)=0+abs(i2-(i2+1)) by ABSVALUE:7
          .=abs(i2-i2+-1)
          .=abs(1) by COMPLEX1:138
          .=1 by ABSVALUE:def 1;
         end;
        then for n st n in dom g & n+1 in dom g holds
         for m,k,i,j st [m,k] in Indices G &
         [i,j] in Indices G & g/.n=G*(m,k) &
          g/.(n+1)=G*(i,j) holds abs(m-i)+abs(k-j)=1 by A53,A286,GOBOARD1:40;
        hence g is_sequence_on G by A285,GOBOARD1:def 11;
        set
        lk={w where w is Point of TOP-REAL 2: w`1=ppi`1 & ppi`2<=w`2 & w`2<=
pj`2};
            l1/.i2=l1.i2 & l1/.j2=l1.j2 by A51,A63,PARTFUN1:def 8;
        then A289: l1/.i2=ppi & l1/.j2=pj by A51,MATRIX_1:def 8;
        then A290: y1.i2=ppi`2 & y1.j2=pj`2 & x1.i2=ppi`1 & x1.j2=pj`1
          by A51,A58,A59,A60,A61,A62,GOBOARD1:def 3,def 4;
        then A291: ppi`2<pj`2 & ppi`1=pj`1 & ppi=|[ppi`1,ppi`2]| & pj=|[pj`1,pj
`2]|
        by A51,A54,A55,A58,A59,A60,A61,A62,A279,EUCLID:57,GOBOARD1:def 1,def 2;
        A292: LSeg(f,k)=LSeg(ppi,pj) by A14,A47,A49,A71,TOPREAL1:def 5
        .= lk by A291,TOPREAL3:15;
        A293: LSeg(f,k)=LSeg(ppi,pj) by A14,A47,A49,A71,TOPREAL1:def 5;
             now let n,m; assume
          A294: n in dom g2 & m in dom g2 & n<>m;
          then A295: g2/.n=G*(i1,i2+n) & g2/.m=G*(i1,i2+m) & [i1,i2+n] in
Indices G &
          [i1,i2+m] in Indices G by A280,A281,A283;
          assume g2/.n=g2/.m;
          then i2+n=i2+m by A295,GOBOARD1:21;
          hence contradiction by A294;
         end;
         then for n,m st n in dom g2 & m in dom g2 &
         g2/.n = g2/.m holds n = m;
        then A296: g2 is one-to-one by PARTFUN2:16;
        A297: not f/.k in rng g2
         proof assume f/.k in rng g2;
          then consider n such that
          A298: n in dom g2 & g2/.n=f/.k by PARTFUN2:4;
          dom g2 = Seg len g2 by FINSEQ_1:def 3;
          then g2/.n=G*(i1,i2+n) & [i1,i2+n] in Indices G
            by A280,A281,A298;
           then i2+n=i2 & 0<n by A47,A298,FINSEQ_3:27,GOBOARD1:21;
          hence contradiction;
         end;
        A299: now let n,p; assume
          A300: n in dom g2 & g2/.n=p;
          then A301: g2/.n=G*(i1,i2+n) & 1<=n & n<=len g2
& i2+n in Seg width G by A280,A281,A283,FINSEQ_1:3;
          set n1=i2+n;
          set pn = G*(i1,n1);
              l1/.n1=l1.n1 by A63,A301,PARTFUN1:def 8;
          then A302: g2/.n=pn & l1/.n1=pn & 0<=n & n1<=i2+len g2
            by A301,MATRIX_1:def 8,XREAL_1:9;
          then A303: x1.n1=pn`1 & x1.n1=x1.i2 & y1.n1=pn`2 & n1<=j2 & i2<=n1
           by A51,A54,A58,A59,A60,A61,A62,A280,A301,GOBOARD1:def 2,def 3,def 4
,REAL_2:173;
          hence p`1=ppi`1 & ppi`2<=p`2 & p`2<=pj`2
            by A51,A55,A59,A60,A62,A290,A300,A301,GOBOARD2:18;
               dom l1 = Seg len l1 by FINSEQ_1:def 3;
          hence p in rng l1
          by A62,A300,A301,A302,PARTFUN2:4;
           i2<n1 by A301,REAL_2:174;
          hence p`2>ppi`2 by A51,A55,A59,A60,A62,A290,A300,A301,A303,
GOBOARD1:def 1;
         end;
        A304: now let n,m,p,q; assume
          A305: n in dom g2 & m in dom g2 & n<m & g2/.n=p & g2/.m=q;
          then A306: g2/.n=G*(i1,i2+n) & i2+n in Seg width G &
              g2/.m=G*(i1,i2+m) & i2+m in Seg width G by A280,A281,A283;
          set n1=i2+n, m1=i2+m;
          set pn = G*(i1,n1),
              pm = G*(i1,m1);
              l1/.n1=l1.n1 & l1/.m1 = l1.m1 by A63,A306,PARTFUN1:def 8;
          then A307: l1/.n1=pn & l1/.m1=pm & n1<m1
            by A305,A306,MATRIX_1:def 8,XREAL_1:10;
          then y1.n1=pn`2 & y1.m1=pm`2 by A59,A60,A62,A306,GOBOARD1:def 4;
          hence p`2<q`2 by A55,A59,A60,A62,A305,A306,A307,GOBOARD1:def 1;
         end;
        A308: rng g2 c= LSeg(f,k)
         proof let x; assume x in rng g2;
          then consider n such that
          A309: n in dom g2 & g2/.n=x by PARTFUN2:4;
          A310: g2/.n=G*(i1,i2+n) by A280,A309;
          set pn = G*(i1,(i2+n));
              pn`1=ppi`1 & ppi`2<=pn`2 & pn`2<=pj`2 by A299,A309,A310;
          hence x in LSeg(f,k) by A292,A309,A310;
         end;
            rng g1 /\ rng g2 = {}
         proof consider x being Element of rng g1 /\ rng g2;
          assume not thesis;
          then A311: x in rng g1 & x in rng g2 by XBOOLE_0:def 3;
               now per cases by A14,REAL_1:def 5;
           suppose k=1;
            hence contradiction by A37,A297,A311,TARSKI:def 1;
           end;
           suppose 1<k;
            then x in L~f1 /\ LSeg(f,k) & L~f1 /\ LSeg(f,k)={f/.k}
             by A5,A8,A9,A44,A308,A311,GOBOARD2:9,XBOOLE_0:def 3;
            hence contradiction by A297,A311,TARSKI:def 1;
           end;
           end;
          hence contradiction;
         end;
        then rng g1 misses rng g2 by XBOOLE_0:def 7;
        hence g is one-to-one by A29,A296,FINSEQ_3:98;
        A312: for n st 1<=n & n+2 <= len g2 holds
             LSeg(g2,n) /\ LSeg(g2,n+1) = {g2/.(n+1)}
         proof let n; assume
          A313: 1<=n & n+2 <= len g2;
          then A314: n in dom g2 & n+1 in dom g2 & n+2 in dom g2 by GOBOARD2:4;
          then g2/.n in rng g2 & g2/.(n+1) in rng g2 &
          g2/.(n+2) in rng g2 by PARTFUN2:4;
          then A315: g2/.n in lk & g2/.(n+1) in lk &
          g2/.(n+2) in lk by A292,A308;
          then consider u be Point of TOP-REAL 2 such that
          A316: g2/.n=u & u`1=ppi`1 & ppi`2<=u`2 & u`2<=pj`2;
          consider u1 be Point of TOP-REAL 2 such that
          A317: g2/.(n+1)=u1 & u1`1=ppi`1 & ppi`2<=u1`2 & u1`2<=pj`2 by A315;
          consider u2 be Point of TOP-REAL 2 such that
          A318: g2/.(n+2)=u2 & u2`1=ppi`1 & ppi`2<=u2`2 & u2`2<=pj`2 by A315;
          set lg = {w where w is Point of TOP-REAL 2:
                     w`1=ppi`1 & u`2<=w`2 & w`2<=u2`2};
          A319: 1<= n+1 by NAT_1:11;
          A320: n+1+1 = n+(1+1);
              n+1 <= n+2 by XREAL_1:8;
          then n+1 <= len g2 by A313,XXREAL_0:2;
          then A321: LSeg(g2,n)=LSeg(u,u1) & LSeg(g2,n+1)=LSeg(u1,u2) &
          LSeg(g2/.n,g2/.(n+2))=LSeg(u,u2)
           by A313,A316,A317,A318,A319,A320,TOPREAL1:def 5;
              n<n+1 & n+1<n+1+1 & n+1+1=n+(1+1) by NAT_1:13;
          then A322: u1`2<u2`2 & u`2<u1`2 by A304,A314,A316,A317,A318;
          then A323: u1`2<=u2`2 & u`2<=u1`2 & u`2<u2`2 by XXREAL_0:2;
          A324: u1 in lg & u=|[u`1,u`2]| & u2=|[u2`1,u2`2]| by A317,A322,
EUCLID:57;
          then LSeg(g2/.n,g2/.(n+2))=lg by A316,A318,A323,TOPREAL3:15;
          hence thesis by A317,A321,A324,TOPREAL1:14;
         end;
        thus g is unfolded
         proof let n be Nat; assume
          A325: 1<=n & n+2 <= len g;
then A326:           n+1+1<=len g;
          A327: 1<= n+1 by NAT_1:11;
          A328: n<=n+1 & n+1<=n+1+1 by NAT_1:11;
then A329:      n+1 <= len g by A325,XXREAL_0:2;
A330:      n+(1+1)=n+1+1;
A331:      len g=len g1+len g2 by FINSEQ_1:35;
               n+2-len g1 = n-len g1 +2;
          then A332: n-len g1 + 2 <= len g2 by A325,A331,XREAL_1:22;
           per cases;
           suppose A333: n+2 <= len g1;
          then n in dom g1 & n+1 in dom g1 & n+2 in dom g1 & n+(1+1)=n+1+1
              by A325,GOBOARD2:4;
            then LSeg(g1,n)=LSeg(g,n) & LSeg(g1,n+1)=LSeg(g,n+1) &
            g/.(n+1)=g1/.(n+1) by FINSEQ_4:83,TOPREAL3:25;
            hence thesis by A30,A325,A333,TOPREAL1:def 8;
           end;
           suppose len g1 < n+2;
            then len g1+1<=n+2 by NAT_1:13;
            then A334: len g1<=n+2-1 by XREAL_1:21;
                 now per cases;
             suppose A335: len g1=n+1;
                   now assume A336: k=1;
                    1<len g1 by A325,A335,NAT_1:13;
                then 1+1<=len g1 by NAT_1:13;
                hence contradiction by A37,A336,TOPREAL1:29;
               end;
              then A337: 1<k & LSeg(g1,n) c= L~f1
                 by A14,A33,REAL_1:def 5,TOPREAL3:26;
              then A338: L~f1 /\ LSeg(f,k)={f/.k} by A5,A8,A9,GOBOARD2:9;
                  1<=n+1 by NAT_1:11;
        then A339: n in dom g1 & n+1 in dom g1 by A325,A328,A335,FINSEQ_3:27;
              then A340: LSeg(g,n)=LSeg(g1,n) by TOPREAL3:25;
              A341: g/.(n+1)=f1/.len f1
               by A35,A335,A339,FINSEQ_4:83
              .= ppi by A15,A16,A18,A47,FINSEQ_4:86;
                A342: 1<=len g-len g1 by A326,A335,XREAL_1:21;
              then A343: g/.(n+2)=g2/.1 by A330,A331,A335,GOBOARD2:5;
                  1 in dom g2 by A331,A342,FINSEQ_3:27;
              then A344: g2/.1 in rng g2 by PARTFUN2:4;
              then g2/.1 in lk by A292,A308;
              then consider u1 be Point of TOP-REAL 2 such that
              A345: g2/.1=u1 & u1`1=ppi`1 & ppi`2<=u1`2 & u1`2<=pj`2;
                  ppi in LSeg(ppi,pj) by TOPREAL1:6;
              then LSeg(ppi,u1) c= LSeg(f,k) & LSeg(g,n+1)=LSeg(ppi,u1)
                by A293,A308,A325,A327,A330,A341,A343,A344,A345,TOPREAL1:12
,def 5;
              then A346: LSeg(g,n) /\ LSeg(g,n+1) c= {g/.(n+1)}
               by A47,A337,A338,A340,A341,XBOOLE_1:27;
                  g/.(n+1) in LSeg(g,n) & g/.(n+1) in LSeg(g,n+1)
                by A325,A327,A329,A330,TOPREAL1:27;
              then g/.(n+1) in LSeg(g,n) /\ LSeg(g,n+1) by XBOOLE_0:def 3;
              then {g/.(n+1)} c= LSeg(g,n) /\ LSeg(g,n+1) by ZFMISC_1:37;
              hence thesis by A346,XBOOLE_0:def 10;
             end;
             suppose len g1<>n+1; then len g1<n+1 by A334,REAL_1:def 5;
              then A347: len g1<=n by NAT_1:13;
              then reconsider n1=n-len g1 as Element of NAT by INT_1:18;
                   now per cases;
               suppose A348: len g1=n;
                    1<=len g1 by A14,A16,A36,XXREAL_0:2;
                then len g1 in dom g1 by FINSEQ_3:27;
                then A349: g/.n=f1/.len f1 by A35,A348,FINSEQ_4:83
                .= ppi by A15,A16,A18,A47,FINSEQ_4:86;
A350:             2 <= len g2 by A325,A331,A348,XREAL_1:8;
                then 1 <= len g2 by XXREAL_0:2;
                then A351: g/.(n+1)=g2/.1 by A348,GOBOARD2:5;
                A352: g/.(n+2)=g2/.2 by A348,A350,GOBOARD2:5;
                     1<=len g2 by A350,XXREAL_0:2;
                then A353: 1 in dom g2 & 2 in dom g2 by A350,FINSEQ_3:27;
                then g2/.1 in rng g2 & g2/.2 in rng g2 by PARTFUN2:4;
                then A354: g2/.1 in lk & g2/.2 in lk by A292,A308;
                then consider u1 be Point of TOP-REAL 2 such that
                A355: g2/.1=u1 & u1`1=ppi`1 & ppi`2<=u1`2 & u1`2<=pj`2;
                consider u2 be Point of TOP-REAL 2 such that
          A356: g2/.2=u2 & u2`1=ppi`1 & ppi`2<=u2`2 & u2`2<=pj`2 by A354;
                A357: u1`2<u2`2 by A304,A353,A355,A356;
                then A358: u1`2<=u2`2 & ppi`2<u2`2 & u2=|[u2`1,u2`2]|
                  by A355,EUCLID:57,XXREAL_0:2;
                set lg = {w where w is Point of TOP-REAL 2 :
                          w`1=ppi`1 & ppi`2<=w`2 & w`2<=u2`2};
                A359: u1 in lg by A355,A357;
                A360: LSeg(g,n)=LSeg(ppi,u1) & LSeg(g,n+1)=LSeg(u1,u2)
               by A325,A327,A329,A330,A349,A351,A352,A355,A356,TOPREAL1:def 5;
                    u1 in LSeg(ppi,u2) by A291,A356,A358,A359,TOPREAL3:15;
                hence thesis by A351,A355,A360,TOPREAL1:14;
               end;
               suppose len g1<>n;
then A361:              len g1<n by A347,REAL_1:def 5;
                    n1 + len g1 = n;
then A362:            LSeg(g,n)=LSeg(g2,n1) by A329,A361,GOBOARD2:10;
A363:            len g1<n+1 by A328,A361,XXREAL_0:2;
A364:            len g1+1<=n by A361,NAT_1:13;
A365:             n1+1+len g1 = n+1;
A366:             1<=n1+1 by NAT_1:11;
                    n1+1<=len g2 by A329,A331,A365,XREAL_1:8;
                then LSeg(g,n+1)=LSeg(g2,n1+1)& g/.(n+1)=g2/.(n1+1) & 1<=n1
                  by A326,A363,A364,A365,A366,GOBOARD2:5,10,XREAL_1:21;
                hence thesis by A312,A332,A362;
               end;
               end;
              hence thesis;
             end;
             end;
            hence thesis;
         end;
         end;
             for n,m st m>n+1 & n in dom g2 & n+1 in dom g2 & m in dom g2 &
         m+1 in dom g2 holds LSeg(g2,n) misses LSeg(g2,m)
         proof let n,m; assume that
          A367: m>n+1 and
          A368: n in dom g2 & n+1 in dom g2 & m in dom g2 & m+1 in dom g2 and
          A369: LSeg(g2,n) /\ LSeg(g2,m) <> {};
          A370: 1 <= n & n+1 <= len g2 & 1 <= m & m+1<=
 len g2 by A368,FINSEQ_3:27;
          reconsider p1=g2/.n, p2=g2/.(n+1), q1=g2/.m, q2=g2/.(m+1)
           as Point of TOP-REAL 2;
          set lp = {w where w is Point of TOP-REAL 2: w`1=ppi`1 &
                         p1`2<=w`2 & w`2<=p2`2},
              lq = {w where w is Point of TOP-REAL 2: w`1=ppi`1 &
                         q1`2<=w`2 & w`2<=q2`2};
               m<m+1 & n<n+1 by NAT_1:13;
           then A371: p1`2<p2`2 & q1`2<q2`2 & p1`1=ppi`1 & p2`1=ppi`1 & q1`1=
ppi`1 &
           q2`1=ppi`1 & p1=|[p1`1,p1`2]| & q1=|[q1`1,q1`2]| &
           p2=|[p2`1,p2`2]| &
           q2=|[q2`1,q2`2]| by A299,A304,A368,EUCLID:57;
           A372: LSeg(g2,n) = LSeg(p1,p2) by A370,TOPREAL1:def 5
           .=lp by A371,TOPREAL3:15;
           A373: LSeg(g2,m) = LSeg(q1,q2) by A370,TOPREAL1:def 5
           .=lq by A371,TOPREAL3:15;
           consider x being Element of LSeg(g2,n) /\ LSeg(g2,m);
           A374: x in LSeg(g2,n) & x in LSeg(g2,m) by A369,XBOOLE_0:def 3;
then A375:           ex tn be Point of TOP-REAL 2 st
 tn=x & tn`1=ppi`1 & p1`2<=tn`2 & tn`2<=p2`2 by A372;
A376:           ex tm be Point of TOP-REAL 2 st
 tm=x & tm`1=ppi`1 & q1`2<=tm`2 & tm`2<=q2`2 by A373,A374;
                p2`2<q1`2 by A304,A367,A368;
            hence contradiction by A375,A376,XXREAL_0:2;
         end;
then A377:    g2 is s.n.c. by GOBOARD2:6;
        A378: L~g2 c= LSeg(f,k)
         proof
          set ls={LSeg(g2,m): 1<=m & m+1 <= len g2}; let x; assume
              x in L~g2;
          then consider X be set such that
          A379: x in X & X in ls by TARSKI:def 4;
          consider m such that
          A380: X=LSeg(g2,m) & 1<=m & m+1 <= len g2 by A379;
               m in dom g2 & m+1 in dom g2 by A380,GOBOARD2:3;
          then A381: g2/.m in rng g2 & g2/.(m+1) in rng g2
           by PARTFUN2:4;
          reconsider q1=g2/.m, q2=g2/.(m+1) as Point of TOP-REAL 2;
          A382: LSeg(q1,q2) c= LSeg(ppi,pj) by A293,A308,A381,TOPREAL1:12;
              LSeg(g2,m)=LSeg(q1,q2) by A380,TOPREAL1:def 5;
          hence thesis by A293,A379,A380,A382;
         end;
        A383: not f/.k in L~g2
         proof set ls={LSeg(g2,m): 1<=m & m+1 <= len g2}; assume
              f/.k in L~g2;
          then consider X be set such that
          A384: f/.k in X & X in ls by TARSKI:def 4;
          consider m such that
          A385: X=LSeg(g2,m) & 1<=m & m+1 <= len g2 by A384;
          A386: m in dom g2 & m+1 in dom g2 &
          m<m+1 by A385,GOBOARD2:3,NAT_1:13;
          reconsider q1=g2/.m, q2=g2/.(m+1) as Point of TOP-REAL 2;
          set lq={w where w is Point of TOP-REAL 2: w`1=ppi`1 &
                       q1`2<=w`2 & w`2<=q2`2};
          A387: q1`1=ppi`1 & q2`1=ppi`1 & q1`2<q2`2 & q1=|[q1`1,q1`2]|
          & q2=|[q2`1,q2`2]| by A299,A304,A386,EUCLID:57;
              LSeg(g2,m)=LSeg(q1,q2) by A385,TOPREAL1:def 5
          .=lq by A387,TOPREAL3:15;
          then ex p st p=f/.k & p`1=ppi`1 & q1`2<=p`2 & p`2<=q2`2 by A384,A385
;
          hence contradiction by A47,A299,A386;
         end;
        A388: L~g1 /\ L~g2 = {}
         proof
           per cases;
           suppose k=1; hence thesis by A37;
           end;
           suppose k<>1; then 1<k by A14,REAL_1:def 5;
            then L~g1 /\ LSeg(f,k)={f/.k} by A5,A8,A9,A33,GOBOARD2:9;
            then A389: L~g1 /\ L~g2 c= {f/.k} by A378,XBOOLE_1:26;
                 now consider x being Element of L~g1 /\ L~g2;
              assume L~g1 /\ L~g2 <> {};
              then x in {f/.k} & x in L~g2 by A389,TARSKI:def 3,XBOOLE_0:def 3
;
              hence contradiction by A383,TARSKI:def 1;
             end;
            hence thesis;
         end;
         end;
            for n,m st m>n+1 & n in dom g &
        n+1 in dom g & m in dom g & m+1 in dom g
         holds LSeg(g,n) misses LSeg(g,m)
         proof let n,m; assume that
          A390: m>n+1 and
          A391: n in dom g & n+1 in dom g & m in dom g & m+1 in dom g;
          A392: 1<=n & 1<=n+1 & n+1<=len g & 1<=m & 1<=m+1 &
          m+1<=len g & n<=n+1 & m<=m+1 & len g=len g1+len g2
            by A391,FINSEQ_1:35,FINSEQ_3:27,NAT_1:11;
          set l1 = {LSeg(g1,i): 1<=i & i+1 <= len g1},
              l2 = {LSeg(g2,j): 1<=j & j+1 <= len g2};
              i2+1<=j2 by A279,NAT_1:13;
          then A393: 1<=l by XREAL_1:21;
          then A394: 1 in dom g2 by A280,FINSEQ_3:27;
          reconsider qq=g2/.1 as Point of TOP-REAL 2;
          set ql={z where z is Point of TOP-REAL 2: z`1=ppi`1 &
                     ppi`2<=z`2 & z`2<=qq`2};
          A395: 1<=len g1 by A14,A16,A36,XXREAL_0:2;
           then len g1 in dom g1 & dom g1 c= dom g by FINSEQ_1:39,FINSEQ_3:27;
          then A396: g/.len g1=g1/.len g1 by FINSEQ_4:83
             .= ppi by A15,A16,A18,A35,A47,FINSEQ_4:86;
          A397: len g1<len g1 +1 & len g1+1<=len g
            by A280,A392,A393,NAT_1:13,XREAL_1:9;
          A398: g/.(len g1+1)=qq by A280,A393,GOBOARD2:5;
          A399: qq`1=ppi`1 & qq`2<=pj`2 & qq`2>ppi`2 & qq=|[qq`1,qq`2]|
           by A299,A394,EUCLID:57;
    A400: LSeg(g,len g1)=LSeg(ppi,qq) by A395,A396,A397,A398,TOPREAL1:def 5
           .= ql by A291,A399,TOPREAL3:15;
            A401: n+1<=m+1 by A390,A392,XXREAL_0:2;
                 now per cases;
             suppose A402: m+1<=len g1;
              then A403: m<=len g1 & n+1<=len g1 by A392,A401,XXREAL_0:2;
              then n<=len g1 by A392,XXREAL_0:2;
              then n in dom g1 & n+1 in dom g1 & m in dom g1 & m+1 in dom g1
               by A392,A402,A403,FINSEQ_3:27;
              then LSeg(g,n)=LSeg(g1,n) & LSeg(g,m)=LSeg(g1,m)
               by TOPREAL3:25;
              hence thesis by A31,A390,TOPREAL1:def 9;
             end;
             suppose len g1<m+1;
              then A404: len g1<=m by NAT_1:13;
              then reconsider m1=m-len g1 as Element of NAT by INT_1:18;
                   now per cases;
               suppose A405: m=len g1;
                     now assume A406: k=1;
                      1<len g1 by A390,A392,A405,XXREAL_0:2;
                  then 1+1<=len g1 by NAT_1:13;
                  hence contradiction by A37,A406,TOPREAL1:29;
                 end;
                then 1<k by A14,REAL_1:def 5;
                then A407: L~f1 /\ LSeg(f,k) ={f/.k} by A5,A8,A9,GOBOARD2:9;
                    n<=len g1 by A390,A392,A405,XXREAL_0:2;
                then A408: n in dom g1 & n+1 in dom g1
                by A390,A392,A405,FINSEQ_3:27;
                then A409: LSeg(g,n)=LSeg(g1,n) by TOPREAL3:25;
                then LSeg(g,n) in l1 by A390,A392,A405;
                then A410: LSeg(g,n) c= L~f1 by A33,ZFMISC_1:92;
                    LSeg(g,m) c= LSeg(f,k)
                 proof let x; assume x in LSeg(g,m);
                  then consider px be Point of TOP-REAL 2 such that
          A411: px=x & px`1=ppi`1 & ppi`2<=px`2 & px`2<= qq`2 by A400,A405;
                      pj`2>=px`2 by A399,A411,XXREAL_0:2;
                  hence thesis by A292,A411;
                 end;
                then A412: LSeg(g,n) /\ LSeg(g,m) c= {f/.k}
                 by A407,A410,XBOOLE_1:27;
                     now consider x being Element of LSeg(g,n)/\ LSeg(g,m);
                  assume LSeg(g,n)/\ LSeg(g,m)<>{};
                  then A413: x in LSeg(g,n) & x in {f/.k}
                  by A412,TARSKI:def 3,XBOOLE_0:def 3;
                  then A414: x=f/.k by TARSKI:def 1;
                      f/.k=g1/.len g1 by A15,A16,A18,A35,FINSEQ_4:86;
                  hence contradiction by A29,A30,A31,A390,A405,A408,A409,A413
,A414,GOBOARD2:7;
                 end;
                hence thesis by XBOOLE_0:def 7;
               end;
               suppose
               m<>len g1;
                then A415: len g1<m & m+1=m1+1+len g1
                 by A404,REAL_1:def 5;
                    m = m1+len g1;
                then A416: LSeg(g,m)=LSeg(g2,m1) by A392,A415,GOBOARD2:10;
                    m1+1<=len g2 & len g1+1<=
m by A392,A415,NAT_1:13,XREAL_1:8;
                then A417: 1<=m1 & m1+1 <= len g2 by XREAL_1:21;
                then LSeg(g,m) in l2 by A416;
                then A418: LSeg(g,m) c= L~g2 by ZFMISC_1:92;
                     now per cases;
                 suppose A419: n+1<=len g1;
                  then n<=len g1 by A392,XXREAL_0:2;
                  then n in dom g1 & n+1 in dom g1 by A392,A419,FINSEQ_3:27;
                   then LSeg(g,n)=LSeg(g1,n) by TOPREAL3:25;
                  then LSeg(g,n) in l1 by A392,A419;
                  then LSeg(g,n) c= L~g1 by ZFMISC_1:92;
                  then LSeg(g,n) /\ LSeg(g,m) c= {} by A388,A418,XBOOLE_1:27;
                  then LSeg(g,n) /\ LSeg(g,m) = {} by XBOOLE_1:3;
                  hence thesis by XBOOLE_0:def 7;
                 end;
                 suppose len g1<n+1;
                  then A420: len g1<=n by NAT_1:13;
                  then reconsider n1=n-len g1 as Element of NAT by INT_1:18;
A421:               n - len g1 + 1 = n + 1 - len g1;
A422:               n = n1 + len g1;
                       now per cases;
                   suppose A423: len g1=n;
                         now consider x being
                      Element of LSeg(g,n) /\ LSeg(g,m);
                      assume LSeg(g,n) /\ LSeg(g,m)<>{};
                then A424: x in LSeg(g,n) & x in LSeg(g,m) by XBOOLE_0:def 3;
then A425:                      ex qx be Point of TOP-REAL 2 st
                      qx=x & qx`1=ppi`1 & ppi`2<=qx`2 & qx`2<=qq`2
                      by A400,A423;
                      A426: m1 in dom g2 & m1+1 in dom g2 & m1<m1+1
                        by A417,GOBOARD2:3,NAT_1:13;
                      reconsider q1=g2/.m1, q2=g2/.(m1+1)
                       as Point of TOP-REAL 2;
                      set q1l={v where v is Point of TOP-REAL 2: v`1=ppi`1 &
                      q1`2<=v`2 & v`2<=q2`2};
A427: q1`1=ppi`1 & q2`1=ppi`1 & q1`2<q2`2 & q1=|[q1`1,q1`2]|&
                      q2=|[q2`1,q2`2]| by A299,A304,A426,EUCLID:57;
                          m1 > n1 + 1 & n1 + 1 >=
 1 by A390,A421,NAT_1:11,XREAL_1:11;
then A428:                   m1 > 1 by XXREAL_0:2;
                          LSeg(g2,m1)=LSeg(q1,q2) by A417,TOPREAL1:def 5
                      .=q1l by A427,TOPREAL3:15;
then A429:                      ex qy be Point of TOP-REAL 2 st
 qy=x & qy`1=ppi`1 & q1`2<=qy`2 & qy`2<=q2`2 by A416,A424;
                          qq`2 < q1`2 by A304,A394,A426,A428;
                      hence contradiction by A425,A429,XXREAL_0:2;
                     end;
                    hence thesis by XBOOLE_0:def 7;
                   end;
                   suppose n<>len g1;
                    then len g1<n by A420,REAL_1:def 5;
                    then LSeg(g,n)=LSeg(g2,n1) & m1>n1+1
                     by A390,A392,A421,A422,GOBOARD2:10,XREAL_1:11;
                    hence thesis by A377,A416,TOPREAL1:def 9;
                   end;
                   end;
                  hence thesis;
                 end;
                 end;
                hence thesis;
               end;
               end;
              hence thesis;
             end;
             end;
            hence thesis;
         end;
        hence g is s.n.c. by GOBOARD2:6;
        A430: g2 is special
         proof let n be Nat;
          set p = g2/.n, q = g2/.(n+1);
         assume 1<=n & n+1 <= len g2;
          then n in dom g2 & n+1 in dom g2 by GOBOARD2:3;
          then p`1=ppi`1 & q`1=ppi`1 by A299;
          hence p`1=q`1 or p`2=q`2;
         end;
             now
          set p=g1/.len g1, q=g2/.1;
              i2+1<=j2 by A279,NAT_1:13;
          then 1<=l by XREAL_1:21;
          then 1 in dom g2 by A280,FINSEQ_3:27;
           then q`1=ppi`1 by A299;
          hence p`1=q`1 or p`2=q`2 by A15,A16,A18,A35,A47,FINSEQ_4:86;
         end;
        hence g is special by A32,A430,GOBOARD2:13;
        thus L~g=L~f
         proof
          set lg = {LSeg(g,i): 1<=i & i+1 <= len g},
              lf = {LSeg(f,j): 1<=j & j+1 <= len f};
          A431: len g = len g1 + len g2 by FINSEQ_1:35;
          A432: now let j; assume
            A433: len g1<=j & j<=len g;
            then reconsider w = j-len g1 as Element of NAT by INT_1:18;
            let p such that
            A434: p=g/.j;
             per cases;
             suppose A435: j=len g1;
                  1<=len g1 by A14,A16,A36,XXREAL_0:2;
              then len g1 in dom g1 by FINSEQ_3:27;
              then A436: g/.len g1 = f1/.len f1 by A35,FINSEQ_4:83
              .= G*(i1,i2) by A15,A16,A18,A47,FINSEQ_4:86;
              hence p`1=G*(i1,i2)`1 by A434,A435;
              thus G*(i1,i2)`2<=p`2 & p`2<=G*
(i1,j2)`2 by A51,A55,A59,A60,A62,A279,A290,A434,A435,A436,GOBOARD1:def 1;
                   dom l1 = Seg len l1 by FINSEQ_1:def 3;
              hence p in rng l1 by A51,A62,A289,A434,A435,A436,PARTFUN2:4;
             end;
             suppose j<>len g1;
then A437:           len g1 < j by A433,REAL_1:def 5;
A438:           j = w + len g1;
                   len g1 + 1<=j by A437,NAT_1:13;
then A439:           1<=w & w<=len g2 by A431,A433,XREAL_1:21,22;
then A440:          g/.j=g2/.w by A438,GOBOARD2:5;
                  w in dom g2 by A439,FINSEQ_3:27;
              hence p`1=ppi`1 & ppi`2<=p`2 & p`2<=
              pj`2 & p in rng l1 by A299,A434,A440;
           end;
           end;
          thus L~g c= L~f
           proof let x; assume x in L~g;
            then consider X be set such that
            A441: x in X & X in lg by TARSKI:def 4;
            consider i such that
            A442: X=LSeg(g,i) & 1<=i & i+1 <= len g by A441;
             per cases;
             suppose A443: i+1 <= len g1;
              then i<=i+1 & i+1<=len g1 by NAT_1:11;
              then 1<=i & i<=len g1 & 1<=i+1 & i+1<=len g1 by A442,XXREAL_0:2;
              then i in dom g1 & i+1 in dom g1 by FINSEQ_3:27;
              then X=LSeg(g1,i) by A442,TOPREAL3:25;
              then X in {LSeg(g1,j): 1<=j & j+1 <= len g1} by A442,A443;
              then x in L~f1 & L~f1 c= L~f by A33,A441,TARSKI:def 4,TOPREAL3:27
;
              hence thesis;
             end;
             suppose A444: i+1 > len g1;
              then A445: len g1<=i & i<=i+1 & i+1<=len g by A442,NAT_1:13;
              A446: 1<=i+1 & len g1<=i+1 & i<=len g by A442,A444,NAT_1:13;
              reconsider q1=g/.i, q2=g/.(i+1) as Point of TOP-REAL 2;
        A447: q1`1=ppi`1 & ppi`2<=q1`2 & q1`2<=pj`2 & q2`1=ppi`1 & ppi`2<=
q2`2 &
                  q2`2<=pj`2 by A432,A445,A446;
              then A448: q1=|[q1`1,q1`2]| & q2=|[q1`1,q2`2]| by EUCLID:57;
              A449: LSeg(g,i)=LSeg(q2,q1) by A442,TOPREAL1:def 5;
                   now per cases by XXREAL_0:1;
               suppose q1`2>q2`2;
                then LSeg(g,i)={p2: p2`1=q1`1 & q2`2<=p2`2 & p2`2<=q1`2}
                  by A448,A449,TOPREAL3:15;
                then consider p2 such that
                A450: p2=x & p2`1=q1`1 & q2`2<=p2`2 & p2`2<=q1`2 by A441,A442;
                    ppi`2<=p2`2 & p2`2<=pj`2 by A447,A450,XXREAL_0:2;
                then x in LSeg(f,k) & LSeg(f,k) in lf by A14,A292,A447,A450;
                hence thesis by TARSKI:def 4;
               end;
               suppose q1`2=q2`2;
                then LSeg(g,i)={q1} by A448,A449,TOPREAL1:7;
                then x=q1 by A441,A442,TARSKI:def 1;
                then x in LSeg(f,k) & LSeg(f,k) in lf by A14,A292,A447;
                hence thesis by TARSKI:def 4;
               end;
               suppose q1`2<q2`2;
                then LSeg(g,i)= {p1: p1`1=q1`1 & q1`2<=p1`2 & p1`2<=q2`2}
                  by A448,A449,TOPREAL3:15;
                then consider p2 such that
                A451: p2=x & p2`1=q1`1 & q1`2<=p2`2 & p2`2<=q2`2 by A441,A442;
                    ppi`2<=p2`2 & p2`2<=pj`2 by A447,A451,XXREAL_0:2;
                then x in LSeg(f,k) & LSeg(f,k) in lf by A14,A292,A447,A451;
                hence thesis by TARSKI:def 4;
               end;
               end;
              hence thesis;
           end;
           end;
          let x; assume x in L~f;
          then A452: x in L~f1 \/ LSeg(f,k) by A5,A12,GOBOARD2:8;
               now per cases by A452,XBOOLE_0:def 2;
           suppose x in L~f1; then x in L~g1 & L~g1 c= L~g
            by A33,GOBOARD2:11;
            hence x in L~g;
           end;
           suppose x in LSeg(f,k);
            then consider p1 such that
            A453: p1=x & p1`1=ppi`1 & ppi`2<=p1`2 & p1`2<=pj`2 by A292;
            defpred P2[Nat] means
            len g1<=$1 & $1<=len g & for q st q=g/.$1 holds q`2<=p1`2;
            A454: now reconsider n=len g1 as Nat;
              take n;
              thus P2[n]
              proof
               thus len g1<=n & n<=len g by A431,REAL_2:173;
               let q such that
               A455: q=g/.n;
                   1<=len g1 by A14,A16,A36,XXREAL_0:2;
               then len g1 in dom g1 by FINSEQ_3:27;
               then q=f1/.len f1
                by A35,A455,FINSEQ_4:83
               .=G*(i1,i2) by A15,A16,A18,A47,FINSEQ_4:86;
               hence q`2<=p1`2 by A453;
              end;
             end;
            A456: for n be Nat holds P2[n] implies n<=len g;
            consider ma be Nat such that
            A457: P2[ma] & for n be Nat st P2[n] holds n<=ma from NAT_1:sch 6
(A456,A454);
reconsider ma as Element of NAT by ORDINAL1:def 13;
                 now per cases;
             suppose A458: ma=len g;
                  i2+1<=j2 by A279,NAT_1:13;
              then A459: 1<=l by XREAL_1:21;
              then A460: l in dom g2 & i2+l=j2 by A280,FINSEQ_3:27;
              then A461: g/.ma=g2/.l by A280,A431,A458,FINSEQ_4:84
               .= pj by A280,A460;
              then pj`2<=p1`2 by A457;
              then A462: p1`2=pj`2 by A453,XXREAL_0:1;
              A463: ma-1<=len g & len g1+1<=ma
                by A280,A431,A458,A459,XREAL_1:9,45;
              then A464: len g1<=ma-1 & 0<=len g1 by XREAL_1:21;
then           0+1<=ma by XREAL_1:21;
              then reconsider m1=ma-1 as Element of NAT by INT_1:18;
                  1<=len g1 by A14,A16,A36,XXREAL_0:2;
              then A465: 1<=m1 by A464,XXREAL_0:2;
              reconsider q=g/.m1 as Point of TOP-REAL 2;
              A466: q`1=ppi`1 & q`2<=pj`2 & q=|[q`1,q`2]| & m1+1=ma
               by A432,A463,A464,EUCLID:57;
              then A467: LSeg(g,m1)=LSeg(q,pj)
               by A458,A461,A465,TOPREAL1:def 5;
              set lq={e where e is Point of TOP-REAL 2: e`1=ppi`1 & q`2<=e`2 &
                      e`2<=pj`2};
               LSeg(g,m1)=lq by A291,A466,A467,TOPREAL3:15;
              then p1 in LSeg(g,m1) & LSeg(g,m1) in lg
              by A453,A458,A462,A465,A466;
              hence x in L~g by A453,TARSKI:def 4;
             end;
             suppose ma<>len g;
              then ma<len g by A457,REAL_1:def 5;
              then A468: ma+1<=len g & k<=ma & ma<=ma+1
                by A16,A36,A457,NAT_1:13,XXREAL_0:2;
              A469: 1<=ma & len g1<=ma+1 by A14,A16,A36,A457,NAT_1:13;
              reconsider qa=g/.ma, qa1=g/.(ma+1) as Point of TOP-REAL 2;
              A470: qa`2<=p1`2 by A457;
               A471: now assume qa1`2<=p1`2;
                 then for q holds q=g/.(ma+1) implies q`2<=p1`2;
                then ma+1<=ma by A457,A468,A469;
                hence contradiction by REAL_2:174;
               end;
              then A472: qa`2<qa1`2 & qa`2<=p1`2 & p1`2<=qa1`2 &
              qa`1=ppi`1 & qa1 `1 = ppi`1
              by A432,A457,A468,A469,A470,XXREAL_0:2;
              set lma = {p2: p2`1=ppi`1 & qa`2<=p2`2 & p2`2<=qa1`2};
              A473: qa=|[qa`1,qa`2]| & qa1=|[qa1 `1, qa1 `2]| by EUCLID:57;
                  LSeg(g,ma)=LSeg(qa,qa1) by A468,A469,TOPREAL1:def 5
              .= lma by A472,A473,TOPREAL3:15;
              then x in LSeg(g,ma) & LSeg(g,ma) in lg by A453,A468,A469,A470
,A471;
              hence x in L~g by TARSKI:def 4;
             end;
             end;
            hence x in L~g;
           end;
           end;
          hence x in L~g;
         end;
            1<=len g1 by A14,A16,A36,XXREAL_0:2;
        then 1 in dom g1 by FINSEQ_3:27;
        hence g/.1=f1/.1 by A34,FINSEQ_4:83
        .=f/.1 by A15,A19,FINSEQ_4:86;
            i2+1<=j2 by A279,NAT_1:13;
        then A474: 1<=l by XREAL_1:21;
        then A475: l in dom g2 & len g=len g1 + l by A280,FINSEQ_1:35
,FINSEQ_3:27;
        hence g/.len g=g2/.l by FINSEQ_4:84
        .=G*(i1,i2+l) by A280,A475
        .=f/.len f by A5,A49,A71;
        thus len f<=len g by A5,A16,A36,A474,A475,XREAL_1:9;
        end;
        end;
       hence thesis;
     end;
     suppose A476: i2=j2;
      set ppi = G*(i1,i2), pj = G*(j1,i2);
           now per cases by XXREAL_0:1;
       case A477: i1>j1;
        then reconsider l=i1-j1 as Element of NAT by INT_1:18;
        A478: now let n; assume n in Seg l;
          then A479: 1<=n & n<=l & 0<=j1 by FINSEQ_1:3;
           l<=i1 by XREAL_1:45;
          then n<=i1 by A479,XXREAL_0:2;
          then reconsider w=i1-n as Element of NAT by INT_1:18;
              0<=n & i1-l<=i1-n by A479,REAL_1:92;
          then i1-n<=i1 & i1<=len G & j1<=w & 1<=j1
            by A51,FINSEQ_3:27,XREAL_1:45;
          then 1<=w & w<=len G by XXREAL_0:2;
          then w in dom G by FINSEQ_3:27;
          hence i1-n is Element of NAT & [i1-n,i2] in Indices G & i1-n in dom G
            by A50,A51,ZFMISC_1:106;
         end;
         defpred P1[Element of NAT,set] means for m st m=i1-$1
         holds $2=G*(m,i2);
        A480: now let n; assume n in Seg l;
          then reconsider m=i1-n as Element of NAT by A478;
          take p=G*(m,i2);
          thus P1[n,p];
         end;
        consider g2 such that
        A481: len g2 = l & for n st n in Seg l holds P1[n,g2/.n]
         from FINSEQ_4:sch 1(A480);
A482:     dom g2=Seg l by A481,FINSEQ_1:def 3;
        take g=g1^g2;
             now let n; assume A483: n in dom g2;
          then reconsider m=i1-n as Element of NAT by A478,A482;
          take m,k=i2;
          thus [m,k] in Indices G & g2/.n=G*(m,k) by A478,A481,A482,A483;
         end;
        then A484: for n st n in dom g ex i,j st [i,j] in Indices G &
        g/.n=G*(i,j) by A53,GOBOARD1:39;
        A485: now let n; assume
A486:          n in dom g2 & n+1 in dom g2;
          then A487: [i1-n,i2] in Indices G
           & [i1-(n+1),i2] in Indices G by A478,A482;
          reconsider m1=i1-n ,m2=i1-(n+1) as Element of NAT by A478,A482,A486;
          A488: g2/.n=G*(m1,i2) & g2/.(n+1)=G*(m2,i2) by A481,A482,A486;
          let l1,l2,l3,l4 be Element of NAT; assume
              [l1,l2] in Indices G & [l3,l4] in Indices G & g2/.n=G*(l1,l2) &
           g2/.(n+1)=G*(l3,l4);
           then l1=m1 & l2=i2 & l3=m2 & l4=i2 by A487,A488,GOBOARD1:21;
          hence abs(l1-l3)+abs(l2-l4)= abs(i1-n-(i1-(n+1)))+0 by ABSVALUE:7
           .= 1 by ABSVALUE:def 1;
         end;
          now let l1,l2,l3,l4 be Element of NAT; assume
A489: [l1,l2] in Indices G & [l3,l4] in Indices G & g1/.len g1=G*(l1,l2) &
          g2/.1=G*(l3,l4) & len g1 in dom g1 & 1 in dom g2;
          then A490: [i1-1,i2] in Indices G
           & f1/.len f1=f/.k by A15,A16,A18,A478,A482,FINSEQ_4:86;
          reconsider m1=i1-1 as Element of NAT by A478,A482,A489;
              g2/.1=G*(m1,i2) by A481,A482,A489;
           then l1=i1 & l2=i2 & l3=m1 & l4=i2
            by A35,A47,A489,A490,GOBOARD1:21;
          hence abs(l1-l3)+abs(l2-l4)=abs(i1-(i1-1))+0 by ABSVALUE:7
          .=1 by ABSVALUE:def 1;
         end;
        then for n st n in dom g & n+1 in dom g holds
         for m,k,i,j st [m,k] in Indices G &
         [i,j] in Indices G & g/.n=G*(m,k) &
          g/.(n+1)=G*(i,j) holds abs(m-i)+abs(k-j)=1 by A53,A485,GOBOARD1:40;
        hence g is_sequence_on G by A484,GOBOARD1:def 11;
        set
        lk={w where w is Point of TOP-REAL 2: w`2=ppi`2 & pj`1<=w`1 & w`1<=
ppi`1};
            c1/.i1=c1.i1 & c1/.j1=c1.j1 by A51,A70,PARTFUN1:def 8;
        then A491: c1/.i1=ppi & c1/.j1=pj by A51,MATRIX_1:def 9;
        then A492: y2.i1=ppi`2 & y2.j1=pj`2 & x2.i1=ppi`1 & x2.j1=pj`1 & len g2
=l
          by A51,A52,A64,A65,A66,A68,A69,A481,GOBOARD1:def 3,def 4;
        then A493: pj`1<ppi`1 & ppi`2=pj`2 & ppi=|[ppi`1,ppi`2]| & pj=|[pj`1,pj
`2]|
        by A51,A52,A56,A57,A64,A65,A66,A68,A69,A477,EUCLID:57,GOBOARD1:def 1
,def 2;
        A494: LSeg(f,k)=LSeg(pj,ppi) by A14,A47,A49,A476,TOPREAL1:def 5
        .= lk by A493,TOPREAL3:16;
        A495: LSeg(f,k)=LSeg(ppi,pj) by A14,A47,A49,A476,TOPREAL1:def 5;
             now let n,m; assume
          A496: n in dom g2 & m in dom g2 & n<>m;
          then A497: [i1-n,i2] in Indices G& [i1-m,i2] in Indices G by A478
,A482;
          reconsider n1=i1-n, m1=i1-m as Element of NAT by A478,A482,A496;
          A498: g2/.n=G*(n1,i2) & g2/.m=G*(m1,i2) by A481,A482,A496;
          assume g2/.n=g2/.m;
          then n1=m1 by A497,A498,GOBOARD1:21;
          hence contradiction by A496;
         end;
         then for n,m st n in dom g2 & m in dom g2 &
         g2/.n = g2/.m holds n = m;
then A499: g2 is one-to-one & Seg len g2=dom g2 by FINSEQ_1:def 3,PARTFUN2:16;
        A500: not f/.k in rng g2
         proof assume f/.k in rng g2;
          then consider n such that
          A501: n in dom g2 & g2/.n=f/.k by PARTFUN2:4;
          A502: [i1-n,i2] in Indices G
            by A478,A481,A499,A501;
          reconsider n1=i1-n as Element of NAT by A478,A481,A499,A501;
              g2/.n=G*(n1,i2) & 0+1<=n by A481,A499,A501,FINSEQ_1:3;
           then n1=i1 & 0<n by A47,A501,A502,GOBOARD1:21;
          hence contradiction;
         end;
        A503: now let n,p; assume
          A504: n in dom g2 & g2/.n=p;
          then A505: P1[n,g2/.n] &
          1<=n & n<=len g2& i1-n in dom G by A478,A481,A499,FINSEQ_1:3;
          reconsider n1=i1-n as Element of NAT by A478,A482,A504;
          set pn = G*(n1,i2);
              c1/.n1=c1.n1 by A70,A505,PARTFUN1:def 8;
          then A506: g2/.n=pn & c1/.n1=pn & 0<=n & i1-len g2<=n1
            by A505,MATRIX_1:def 9,REAL_1:92;
          then A507: y2.n1=pn`2 & y2.n1=y2.i1 & x2.n1=pn`1 & n1<=i1 & j1<=n1
           by A51,A52,A57,A64,A65,A66,A68,A69,A481,A505,GOBOARD1:def 2,def 3
,def 4,REAL_2:173;
          hence p`2=ppi`2 & pj`1<=p`1 & p`1<=ppi`1
            by A51,A52,A56,A64,A66,A69,A492,A504,A505,A506,GOBOARD2:18;
          thus p in rng c1 by A70,A504,A505,A506,PARTFUN2:4;
           n1<i1 by A505,XREAL_1:46;
          hence p`1<ppi`1
           by A51,A52,A56,A64,A66,A69,A492,A504,A505,A506,A507,GOBOARD1:def 1;
         end;
        A508: now let n,m,p,q; assume
          A509: n in dom g2 & m in dom g2 & n<m & g2/.n=p & g2/.m=q;
          then A510: P1[n,g2/.n] & i1-n in dom G &
              P1[m,g2/.m] & i1-m in dom G by A478,A481,A482;
          reconsider n1=i1-n, m1=i1-m as Element of NAT by A478,A482,A509;
          set pn = G*(n1,i2), pm = G*(m1,i2);
              c1/.n1=c1.n1 & c1/.m1 = c1.m1 by A70,A510,PARTFUN1:def 8;
          then A511: g2/.n=pn & c1/.n1=pn & g2/.m=pm & c1/.m1=pm & m1<n1
            by A509,A510,MATRIX_1:def 9,REAL_1:92;
          then x2.n1=pn`1 & x2.m1=pm`1 by A67,A70,A510,GOBOARD1:def 3;
          hence q`1<p`1 by A56,A67,A70,A509,A510,A511,GOBOARD1:def 1;
         end;
        A512: rng g2 c= LSeg(f,k)
         proof let x; assume x in rng g2;
          then consider n such that
          A513: n in dom g2 & g2/.n=x by PARTFUN2:4;
          reconsider n1=i1-n as Element of NAT by A478,A481,A499,A513;
          set pn = G*(n1,i2);
          A514: g2/.n=pn by A481,A499,A513;
          then pn`2=ppi`2 & pj`1<=pn`1 & pn`1<=ppi`1 by A503,A513;
          hence x in LSeg(f,k) by A494,A513,A514;
         end;
            rng g1 /\ rng g2 = {}
         proof consider x being Element of rng g1 /\ rng g2;
          assume not thesis;
          then A515: x in rng g1 & x in rng g2 by XBOOLE_0:def 3;
               now per cases by A14,REAL_1:def 5;
           suppose k=1;
            hence contradiction by A37,A500,A515,TARSKI:def 1;
           end;
           suppose 1<k;
            then x in L~f1 /\ LSeg(f,k) & L~f1 /\ LSeg(f,k)={f/.k}
             by A5,A8,A9,A44,A512,A515,GOBOARD2:9,XBOOLE_0:def 3;
            hence contradiction by A500,A515,TARSKI:def 1;
           end;
           end;
          hence contradiction;
         end;
        then rng g1 misses rng g2 by XBOOLE_0:def 7;
        hence g is one-to-one
         by A29,A499,FINSEQ_3:98;
        A516: for n st 1<=n & n+2 <= len g2 holds
             LSeg(g2,n) /\ LSeg(g2,n+1) = {g2/.(n+1)}
         proof let n; assume
          A517: 1<=n & n+2 <= len g2;
          then A518: n in dom g2 & n+1 in dom g2 & n+2 in dom g2 by GOBOARD2:4;
          then g2/.n in rng g2 & g2/.(n+1) in rng g2 &
          g2/.(n+2) in rng g2 by PARTFUN2:4;
          then A519: g2/.n in lk & g2/.(n+1) in lk &
          g2/.(n+2) in lk by A494,A512;
          then consider u be Point of TOP-REAL 2 such that
          A520: g2/.n=u & u`2=ppi`2 & pj`1<=u`1 & u`1<=ppi`1;
          consider u1 be Point of TOP-REAL 2 such that
          A521: g2/.(n+1)=u1 & u1`2=ppi`2 & pj`1<=u1`1 & u1`1<=ppi`1 by A519;
          consider u2 be Point of TOP-REAL 2 such that
          A522: g2/.(n+2)=u2 & u2`2=ppi`2 & pj`1<=u2`1 & u2`1<=ppi`1 by A519;
          set lg = {w where w is Point of TOP-REAL 2:
                     w`2=ppi`2 & u2`1<=w`1 & w`1<=u`1};
          A523: 1<= n+1 by NAT_1:11;
          A524: n+1+1 = n+(1+1);
              n+1 <= n+2 by XREAL_1:8;
          then n+1 <= len g2 by A517,XXREAL_0:2;
          then A525: LSeg(g2,n)=LSeg(u,u1) & LSeg(g2,n+1)=LSeg(u1,u2) &
          LSeg(g2/.n,g2/.(n+2))=LSeg(u,u2)
           by A517,A520,A521,A522,A523,A524,TOPREAL1:def 5;
              n<n+1 & n+1<n+1+1 & n+1+1=n+(1+1) by NAT_1:13;
          then A526: u2`1<u1`1 & u1`1<u`1 by A508,A518,A520,A521,A522;
          then A527: u2`1<=u1`1 & u1`1<=u`1 & u2`1<u`1 by XXREAL_0:2;
          A528: u1 in lg & u=|[u`1,u`2]| & u2=|[u2`1,u2`2]| by A521,A526,
EUCLID:57;
          then LSeg(g2/.n,g2/.(n+2))=lg by A520,A522,A527,TOPREAL3:16;
          hence thesis by A521,A525,A528,TOPREAL1:14;
         end;
        thus g is unfolded
         proof let n be Nat; assume
          A529: 1<=n & n+2 <= len g;
then A530:           n+1+1<=len g;
          A531: 1 <= n+1 by NAT_1:11;
          A532: n<=n+1 & n+1<=n+1+1 by NAT_1:11;
then A533:      n+1 <= len g by A529,XXREAL_0:2;
A534:      n+(1+1)=n+1+1;
A535:      len g=len g1+len g2 by FINSEQ_1:35;
               n+2-len g1 = n-len g1 +2;
          then A536: n-len g1 + 2 <= len g2 by A529,A535,XREAL_1:22;
           per cases;
           suppose A537: n+2 <= len g1;
        then n in dom g1 & n+1 in dom g1 & n+2 in dom g1 & n+(1+1)=n+1+1
              by A529,GOBOARD2:4;
            then LSeg(g1,n)=LSeg(g,n) & LSeg(g1,n+1)=LSeg(g,n+1) &
            g/.(n+1)=g1/.(n+1) by FINSEQ_4:83,TOPREAL3:25;
            hence thesis by A30,A529,A537,TOPREAL1:def 8;
           end;
           suppose len g1 < n+2;
            then len g1+1<=n+2 by NAT_1:13;
            then A538: len g1<=n+2-1 by XREAL_1:21;
             thus thesis
             proof per cases;
             suppose A539: len g1=n+1;
                   now assume A540: k=1;
                    1<len g1 by A529,A539,NAT_1:13;
                then 1+1<=len g1 by NAT_1:13;
                hence contradiction by A37,A540,TOPREAL1:29;
               end;
              then A541: 1<k & LSeg(g1,n) c= L~f1
                 by A14,A33,REAL_1:def 5,TOPREAL3:26;
              then A542: L~f1 /\ LSeg(f,k)={f/.k}
               by A5,A8,A9,GOBOARD2:9;
                  1<=n+1 by NAT_1:11;
              then A543: n in dom g1 & n+1 in dom g1
              by A529,A532,A539,FINSEQ_3:27;
              then A544: LSeg(g,n)=LSeg(g1,n) by TOPREAL3:25;
              A545: g/.(n+1)=f1/.len f1
               by A35,A539,A543,FINSEQ_4:83
              .= ppi by A15,A16,A18,A47,FINSEQ_4:86;
                  1 <= len g2 by A529,A534,A535,A539,XREAL_1:8;
              then A546: g/.(n+2)=g2/.1 by A534,A539,GOBOARD2:5;
                  1<=len g-len g1 by A530,A539,XREAL_1:21;
              then 1 in dom g2 by A535,FINSEQ_3:27;
              then A547: g2/.1 in rng g2 by PARTFUN2:4;
              then g2/.1 in lk by A494,A512;
              then consider u1 be Point of TOP-REAL 2 such that
              A548: g2/.1=u1 & u1`2=ppi`2 & pj`1<=u1`1 & u1`1<=ppi`1;
                  ppi in LSeg(ppi,pj) by TOPREAL1:6;
              then LSeg(ppi,u1) c= LSeg(f,k) & LSeg(g,n+1)=LSeg(ppi,u1)
                by A495,A512,A529,A531,A534,A545,A546,A547,A548,TOPREAL1:12
,def 5;
              then A549: LSeg(g,n) /\ LSeg(g,n+1) c= {g/.(n+1)}
               by A47,A541,A542,A544,A545,XBOOLE_1:27;
                  g/.(n+1) in LSeg(g,n) & g/.(n+1) in LSeg(g,n+1)
                by A529,A531,A533,A534,TOPREAL1:27;
              then g/.(n+1) in LSeg(g,n) /\ LSeg(g,n+1) by XBOOLE_0:def 3;
              then {g/.(n+1)} c= LSeg(g,n) /\ LSeg(g,n+1) by ZFMISC_1:37;
              hence thesis by A549,XBOOLE_0:def 10;
             end;
             suppose len g1<>n+1; then len g1<n+1 by A538,REAL_1:def 5;
              then A550: len g1<=n by NAT_1:13;
              then reconsider n1=n-len g1 as Element of NAT by INT_1:18;
              thus thesis
               proof per cases;
               suppose A551: len g1=n;
                    1<=len g1 by A14,A16,A36,XXREAL_0:2;
                then len g1 in dom g1 by FINSEQ_3:27;
                then A552: g/.n=f1/.len f1 by A35,A551,FINSEQ_4:83
                .= ppi by A15,A16,A18,A47,FINSEQ_4:86;
A553:             2 <= len g2 by A529,A535,A551,XREAL_1:8;
                then 1<= len g2 by XXREAL_0:2;
                then A554: g/.(n+1)=g2/.1 by A551,GOBOARD2:5;
                A555: g/.(n+2)=g2/.2 by A551,A553,GOBOARD2:5;
                    1<=len g2 by A553,XXREAL_0:2;
                then A556: 1 in dom g2 & 2 in dom g2 by A553,FINSEQ_3:27;
                then g2/.1 in rng g2 & g2/.2 in rng g2 by PARTFUN2:4;
                then A557: g2/.1 in lk & g2/.2 in lk by A494,A512;
                then consider u1 be Point of TOP-REAL 2 such that
                A558: g2/.1=u1 & u1`2=ppi`2 & pj`1<=u1`1 & u1`1<=ppi`1;
                consider u2 be Point of TOP-REAL 2 such that
                A559:
                g2/.2=u2 & u2`2=ppi`2 & pj`1<=u2`1 & u2`1<=ppi`1 by A557;
                A560: u2`1<u1`1 by A508,A556,A558,A559;
                then A561: u2`1<=u1`1 & u2`1<ppi`1 & u2=|[u2`1,u2`2]|
                  by A558,EUCLID:57,XXREAL_0:2;
                set lg = {w where w is Point of TOP-REAL 2 :
                          w`2=ppi`2 & u2`1<=w`1 & w`1<=ppi`1};
                A562: u1 in lg by A558,A560;
          A563: LSeg(ppi,g2/.2)=LSeg(ppi,u2) & LSeg(g,n)=LSeg(ppi,u1) &
                LSeg(g,n+1)=LSeg(u1,u2)
               by A529,A531,A533,A534,A552,A554,A555,A558,A559,TOPREAL1:def 5;
                    LSeg(ppi,g2/.2)=lg by A493,A559,A561,TOPREAL3:16;
                hence thesis by A554,A558,A562,A563,TOPREAL1:14;
               end;
               suppose len g1<>n;
then A564:              len g1<n by A550,REAL_1:def 5;
                    n1 + len g1 = n;
then A565:            LSeg(g,n)=LSeg(g2,n1) by A533,A564,GOBOARD2:10;
A566:            len g1<n+1 by A532,A564,XXREAL_0:2;
A567:            len g1+1<=n by A564,NAT_1:13;
A568:            n+1 = n1+1+len g1;
A569:             1<=n1+1 by NAT_1:11;
                  n1 + 1 + len g1 = n + 1;
                then n1+1 <= len g2 by A533,A535,XREAL_1:8;
                then LSeg(g,n+1)=LSeg(g2,n1+1)& g/.(n+1)=g2/.(n1+1) & 1<=n1
                  by A530,A566,A567,A568,A569,GOBOARD2:5,10,XREAL_1:21;
                hence thesis by A516,A536,A565;
               end;
               end;
             end;
             end;
         end;
         end;
               for n,m st m>n+1 & n in dom g2 & n+1 in dom g2 & m in dom g2 &
           m+1 in dom g2 holds LSeg(g2,n) misses LSeg(g2,m)
         proof let n,m; assume that
          A570: m>n+1 and
          A571: n in dom g2 & n+1 in dom g2 & m in dom g2 & m+1 in dom g2 and
          A572: LSeg(g2,n) /\ LSeg(g2,m) <> {};
          A573: 1 <= n & n+1 <= len g2 & 1 <= m & m+1<=
 len g2 by A571,FINSEQ_3:27;
          reconsider p1=g2/.n, p2=g2/.(n+1), q1=g2/.m, q2=g2/.(m+1)
           as Point of TOP-REAL 2;
          set lp = {w where w is Point of TOP-REAL 2: w`2=ppi`2 &
                         p2`1<=w`1 & w`1<=p1`1},
              lq = {w where w is Point of TOP-REAL 2: w`2=ppi`2 &
                         q2`1<=w`1 & w`1<=q1`1};
               m<m+1 & n<n+1 by NAT_1:13;
           then A574: p2`1<p1`1 & q2`1<q1`1 & p1`2=ppi`2 & p2`2=ppi`2 & q1`2=
ppi`2 &
           q2`2=ppi`2 & p1=|[p1`1,p1`2]| & q1=|[q1`1,q1`2]| &
           p2=|[p2`1,p2`2]| &
           q2=|[q2`1,q2`2]| by A503,A508,A571,EUCLID:57;
           A575: LSeg(g2,n) = LSeg(p2,p1) by A573,TOPREAL1:def 5
           .=lp by A574,TOPREAL3:16;
           A576: LSeg(g2,m) = LSeg(q2,q1) by A573,TOPREAL1:def 5
           .=lq by A574,TOPREAL3:16;
           consider x being Element of LSeg(g2,n) /\ LSeg(g2,m);
           A577: x in LSeg(g2,n) & x in LSeg(g2,m) by A572,XBOOLE_0:def 3;
then A578:           ex tn be Point of TOP-REAL 2 st
               tn=x & tn`2=ppi`2 & p2`1<=tn`1 & tn`1<=p1`1 by A575;
A579:           ex tm be Point of TOP-REAL 2 st
               tm=x & tm`2=ppi`2 & q2`1<=tm`1 & tm`1<=q1`1 by A576,A577;
                q1`1<p2`1 by A508,A570,A571;
            hence contradiction by A578,A579,XXREAL_0:2;
         end;
then A580:    g2 is s.n.c. by GOBOARD2:6;
        A581: L~g2 c= LSeg(f,k)
         proof
          set ls={LSeg(g2,m): 1<=m & m+1 <= len g2}; let x; assume
              x in L~g2;
          then consider X be set such that
          A582: x in X & X in ls by TARSKI:def 4;
          consider m such that
          A583: X=LSeg(g2,m) & 1<=m & m+1 <= len g2 by A582;
               m in dom g2 & m+1 in dom g2 by A583,GOBOARD2:3;
          then A584: g2/.m in rng g2 & g2/.(m+1) in rng g2
           by PARTFUN2:4;
          reconsider q1=g2/.m, q2=g2/.(m+1) as Point of TOP-REAL 2;
          A585: LSeg(q1,q2) c= LSeg(ppi,pj) by A495,A512,A584,TOPREAL1:12;
              LSeg(g2,m)=LSeg(q1,q2) by A583,TOPREAL1:def 5;
          hence thesis by A495,A582,A583,A585;
         end;
        A586: not f/.k in L~g2
         proof set ls={LSeg(g2,m): 1<=m & m+1 <= len g2}; assume
              f/.k in L~g2;
          then consider X be set such that
          A587: f/.k in X & X in ls by TARSKI:def 4;
          consider m such that
          A588: X=LSeg(g2,m) & 1<=m & m+1 <= len g2 by A587;
          A589: m in dom g2 & m+1 in dom g2 &
          m<m+1 by A588,GOBOARD2:3,NAT_1:13;
          reconsider q1=g2/.m, q2=g2/.(m+1) as Point of TOP-REAL 2;
          set lq={w where w is Point of TOP-REAL 2: w`2=ppi`2 &
                       q2`1<=w`1 & w`1<=q1`1};
          A590: q1`2=ppi`2 & q2`2=ppi`2 & q2`1<q1`1 & q1=|[q1`1,q1`2]|
          & q2=|[q2`1,q2`2]| by A503,A508,A589,EUCLID:57;
              LSeg(g2,m)=LSeg(q2,q1) by A588,TOPREAL1:def 5
          .=lq by A590,TOPREAL3:16;
          then ex p st p=f/.k & p`2=ppi`2 & q2`1<=p`1 & p`1<=q1`1 by A587,A588
;
          hence contradiction by A47,A503,A589;
         end;
        A591: L~g1 /\ L~g2 = {}
         proof
           per cases;
           suppose k=1; hence thesis by A37;
           end;
           suppose k<>1; then 1<k by A14,REAL_1:def 5;
            then L~g1 /\ LSeg(f,k)={f/.k}
             by A5,A8,A9,A33,GOBOARD2:9;
            then A592: L~g1 /\ L~g2 c= {f/.k} by A581,XBOOLE_1:26;
                 now consider x being Element of L~g1 /\ L~g2;
              assume L~g1 /\ L~g2 <> {};
              then x in {f/.k} & x in L~g2 by A592,TARSKI:def 3,XBOOLE_0:def 3
;
              hence contradiction by A586,TARSKI:def 1;
             end;
            hence thesis;
         end;
         end;
            for n,m st m>n+1 & n in dom g & n+1 in dom g &
        m in dom g & m+1 in dom g
         holds LSeg(g,n) misses LSeg(g,m)
         proof let n,m; assume that
          A593: m>n+1 and
          A594: n in dom g & n+1 in dom g & m in dom g & m+1 in dom g;
          A595: 1<=n & 1<=n+1 & n+1<=len g & 1<=m & 1<=m+1 &
          m+1<=len g & n<=n+1 & m<=m+1 & len g=len g1+len g2
            by A594,FINSEQ_1:35,FINSEQ_3:27,NAT_1:11;
          set l1 = {LSeg(g1,i): 1<=i & i+1 <= len g1},
              l2 = {LSeg(g2,j): 1<=j & j+1 <= len g2};
              j1+1<=i1 by A477,NAT_1:13;
          then A596: 1<=l by XREAL_1:21;
          then A597: 1 in dom g2 by A481,FINSEQ_3:27;
          reconsider qq=g2/.1 as Point of TOP-REAL 2;
          set ql={z where z is Point of TOP-REAL 2: z`2=ppi`2 &
                     qq`1<=z`1 & z`1<=ppi`1};
          A598: 1<=len g1 by A14,A16,A36,XXREAL_0:2;
           then len g1 in dom g1 & dom g1 c= dom g by FINSEQ_1:39,FINSEQ_3:27;
          then A599: g/.len g1=g1/.len g1 by FINSEQ_4:83
             .= ppi by A15,A16,A18,A35,A47,FINSEQ_4:86;
          A600: len g1<len g1 +1 & len g1+1<=len g
            by A481,A595,A596,NAT_1:13,XREAL_1:9;
          A601: g/.(len g1+1)=qq by A481,A596,GOBOARD2:5;
          A602: qq`2=ppi`2 & pj`1<=qq`1 & qq`1<ppi`1 & qq=|[qq`1,qq`2]|
           by A503,A597,EUCLID:57;
    A603: LSeg(g,len g1)=LSeg(qq,ppi) by A598,A599,A600,A601,TOPREAL1:def 5
           .= ql by A493,A602,TOPREAL3:16;
            A604: n+1<=m+1 by A593,A595,XXREAL_0:2;
                 now per cases;
             suppose A605: m+1<=len g1;
              then A606: m<=len g1 & n+1<=len g1 by A595,A604,XXREAL_0:2;
              then n<=len g1 by A595,XXREAL_0:2;
              then n in dom g1 & n+1 in dom g1 & m in dom g1 & m+1 in dom g1
               by A595,A605,A606,FINSEQ_3:27;
              then LSeg(g,n)=LSeg(g1,n) & LSeg(g,m)=LSeg(g1,m)
               by TOPREAL3:25;
              hence thesis by A31,A593,TOPREAL1:def 9;
             end;
             suppose len g1<m+1;
              then A607: len g1<=m by NAT_1:13;
              then reconsider m1=m-len g1 as Element of NAT by INT_1:18;
                   now per cases;
               suppose A608: m=len g1;
                     now assume A609: k=1;
                      1<len g1 by A593,A595,A608,XXREAL_0:2;
                  then 1+1<=len g1 by NAT_1:13;
                  hence contradiction by A37,A609,TOPREAL1:29;
                 end;
                then 1<k by A14,REAL_1:def 5;
                then A610: L~f1 /\ LSeg(f,k) ={f/.k}
                 by A5,A8,A9,GOBOARD2:9;
                    n<=len g1 by A593,A595,A608,XXREAL_0:2;
                then A611: n in dom g1 & n+1 in dom g1
                by A593,A595,A608,FINSEQ_3:27;
                then A612: LSeg(g,n)=LSeg(g1,n) by TOPREAL3:25;
                then LSeg(g,n) in l1 by A593,A595,A608;
                then A613: LSeg(g,n) c= L~f1
                 by A33,ZFMISC_1:92;
                    LSeg(g,m) c= LSeg(f,k)
                 proof let x; assume x in LSeg(g,m);
                  then consider px be Point of TOP-REAL 2 such that
                  A614: px=x & px`2=ppi`2 & qq`1<=px`1 & px`1<=
ppi`1 by A603,A608;
                      pj`1<=px`1 by A602,A614,XXREAL_0:2;
                  hence thesis by A494,A614;
                 end;
                then A615: LSeg(g,n) /\ LSeg(g,m) c= {f/.k}
                 by A610,A613,XBOOLE_1:27;
                     now consider x being Element of LSeg(g,n)/\ LSeg(g,m);
                  assume
                    LSeg(g,n)/\ LSeg(g,m)<>{};
                  then A616: x in LSeg(g,n) & x in {f/.k}
                  by A615,TARSKI:def 3,XBOOLE_0:def 3;
                  then A617: x=f/.k by TARSKI:def 1;
                      f/.k=g1/.len g1
                   by A15,A16,A18,A35,FINSEQ_4:86;
                  hence contradiction
                  by A29,A30,A31,A593,A608,A611,A612,A616,A617,GOBOARD2:7;
                 end;
                hence thesis by XBOOLE_0:def 7;
               end;
               suppose
               m<>len g1;
                then A618: len g1<m & m+1=m1+1+len g1
                 by A607,REAL_1:def 5;
                    m = m1+len g1;
                then A619: LSeg(g,m)=LSeg(g2,m1) by A595,A618,GOBOARD2:10;
                    m1+1<=len g2 & len g1+1<=
m by A595,A618,NAT_1:13,XREAL_1:8;
                then A620: 1<=m1 & m1+1 <= len g2 by XREAL_1:21;
                then LSeg(g,m) in l2 by A619;
                then A621: LSeg(g,m) c= L~g2 by ZFMISC_1:92;
                     now per cases;
                 suppose A622: n+1<=len g1;
                  then n<=len g1 by A595,XXREAL_0:2;
                  then n in dom g1 & n+1 in dom g1 by A595,A622,FINSEQ_3:27;
                   then LSeg(g,n)=LSeg(g1,n) by TOPREAL3:25;
                  then LSeg(g,n) in l1 by A595,A622;
                  then LSeg(g,n) c= L~g1 by ZFMISC_1:92;
                  then LSeg(g,n) /\ LSeg(g,m) c= {} by A591,A621,XBOOLE_1:27;
                  then LSeg(g,n) /\ LSeg(g,m) = {} by XBOOLE_1:3;
                  hence thesis by XBOOLE_0:def 7;
                 end;
                 suppose len g1<n+1;
                  then A623: len g1<=n by NAT_1:13;
                  then reconsider n1=n-len g1 as Element of NAT by INT_1:18;
A624:               n - len g1 + 1 = n + 1 - len g1;
A625:               n = n1 + len g1;
                       now per cases;
                   suppose A626: len g1=n;
                         now consider x being
                      Element of LSeg(g,n) /\ LSeg(g,m);
                      assume
                        LSeg(g,n) /\ LSeg(g,m)<>{};
                      then A627: x in LSeg(g,n) & x in LSeg(g,m)
                      by XBOOLE_0:def 3;
then A628:                    ex qx be Point of TOP-REAL 2 st
                         qx=x & qx`2=ppi`2 & qq`1<=qx`1 & qx`1<=
ppi`1 by A603,A626;
                      A629: m1 in dom g2 & m1+1 in dom g2 & m1<m1+1
                        by A620,GOBOARD2:3,NAT_1:13;
                      reconsider q1=g2/.m1, q2=g2/.(m1+1)
                       as Point of TOP-REAL 2;
                      set q1l={v where v is Point of TOP-REAL 2: v`2=ppi`2 &
                                 q2`1<=v`1 & v`1<=q1`1};
A630:       q1`2=ppi`2 & q2`2=ppi`2 & q2`1<q1`1 & q1=|[q1`1,q1`2]|&
                      q2=|[q2`1,q2`2]| by A503,A508,A629,EUCLID:57;
                          m1 > n1 + 1 & n1 + 1 >=
 1 by A593,A624,NAT_1:11,XREAL_1:11;
then A631:                   m1 > 1 by XXREAL_0:2;
                          LSeg(g2,m1)=LSeg(q2,q1) by A620,TOPREAL1:def 5
                      .=q1l by A630,TOPREAL3:16;
then A632:                      ex qy be Point of TOP-REAL 2 st
                          qy=x & qy`2=ppi`2 & q2`1<=qy`1 & qy`1<=
q1`1 by A619,A627;
                          q1`1 < qq`1 by A508,A597,A629,A631;
                      hence contradiction by A628,A632,XXREAL_0:2;
                     end;
                    hence thesis by XBOOLE_0:def 7;
                   end;
                   suppose n<>len g1;
                    then len g1<n by A623,REAL_1:def 5;
                    then LSeg(g,n)=LSeg(g2,n1) & m1>n1+1
                     by A593,A595,A624,A625,GOBOARD2:10,XREAL_1:11;
                    hence thesis by A580,A619,TOPREAL1:def 9;
                   end;
                   end;
                  hence thesis;
                 end;
                 end;
                hence thesis;
               end;
               end;
              hence thesis;
             end;
             end;
            hence thesis;
         end;
        hence g is s.n.c. by GOBOARD2:6;
        A633: g2 is special
        proof let n be Nat;
         set p = g2/.n, q = g2/.(n+1);
        assume
               1<=n & n+1 <= len g2;
          then n in dom g2 & n+1 in dom g2 by GOBOARD2:3;
          then p`2=ppi`2 & q`2=ppi`2 by A503;
          hence p`1=q`1 or p`2=q`2;
         end;
             now
          set p=g1/.len g1, q=g2/.1;
              j1+1<=i1 by A477,NAT_1:13;
          then 1<=l by XREAL_1:21;
          then 1 in dom g2 by A482,FINSEQ_1:3;
           then q`2=ppi`2 by A503;
          hence p`1=q`1 or p`2=q`2
           by A15,A16,A18,A35,A47,FINSEQ_4:86;
         end;
        hence g is special by A32,A633,GOBOARD2:13;
        thus L~g=L~f
         proof
          set lg = {LSeg(g,i): 1<=i & i+1 <= len g},
              lf = {LSeg(f,j): 1<=j & j+1 <= len f};
          A634: len g = len g1 + len g2 by FINSEQ_1:35;
          A635: now let j; assume
            A636: len g1<=j & j<=len g;
            then reconsider w = j-len g1 as Element of NAT by INT_1:18;
            let p such that
            A637: p=g/.j;
             per cases;
             suppose A638: j=len g1;
                  1<=len g1 by A14,A16,A36,XXREAL_0:2;
              then len g1 in dom g1 by FINSEQ_3:27;
              then A639: g/.len g1 = f1/.len f1 by A35,FINSEQ_4:83
              .= G*(i1,i2) by A15,A16,A18,A47,FINSEQ_4:86;
              hence p`2=G*(i1,i2)`2 by A637,A638;
              thus G*(j1,i2)`1<=p`1 & p`1<=G*
              (i1,i2)`1 by A51,A52,A56,A64,A66,A69,A477,A492,A637,A638,A639,
GOBOARD1:def 1;
                  Seg len c1 = dom c1 by FINSEQ_1:def 3;
              hence p in rng c1 by A51,A52,A69,A491,A637,A638,A639,PARTFUN2:4;
             end;
             suppose j<>len g1;
then A640:           len g1 < j by A636,REAL_1:def 5;
A641:           j = w + len g1;
                   len g1 + 1<=j by A640,NAT_1:13;
              then A642:           1<=w & w<=len g2 by A634,A636,XREAL_1:21,22;
then A643:          g/.j=g2/.w by A641,GOBOARD2:5;
                  w in dom g2 by A642,FINSEQ_3:27;
              hence p`2=ppi`2 & pj`1<=p`1 & p`1<=
              ppi`1 & p in rng c1 by A503,A637,A643;
           end;
           end;
          thus L~g c= L~f
           proof let x; assume x in L~g;
            then consider X be set such that
            A644: x in X & X in lg by TARSKI:def 4;
            consider i such that
            A645: X=LSeg(g,i) & 1<=i & i+1 <= len g by A644;
             per cases;
             suppose A646: i+1 <= len g1;
              then i<=i+1 & i+1<=len g1 by NAT_1:11;
              then 1<=i & i<=len g1 & 1<=i+1 & i+1<=len g1 by A645,XXREAL_0:2;
              then i in dom g1 & i+1 in dom g1 by FINSEQ_3:27;
              then X=LSeg(g1,i) by A645,TOPREAL3:25;
              then X in {LSeg(g1,j): 1<=j & j+1 <= len g1} by A645,A646;
              then x in L~f1 & L~f1 c= L~f by A33,A644,TARSKI:def 4,TOPREAL3:27
;
              hence thesis;
             end;
             suppose A647: i+1 > len g1;
              then A648: len g1<=i & i<=i+1 & i+1<=len g by A645,NAT_1:13;
                A649: 1<=i+1 & len g1<=i+1 & i<=len g by A645,A647,NAT_1:13;
              reconsider q1=g/.i, q2=g/.(i+1) as Point of TOP-REAL 2;
              A650: q1`2=ppi`2 & pj`1<=q1`1 & q1`1<=ppi`1 & q2`2=ppi`2 & pj`1<=
q2`1 &
              q2`1<=ppi`1 by A635,A648,A649;
              then A651: q1=|[q1`1,q1`2]| & q2=|[q2`1,q1`2]| by EUCLID:57;
              A652: LSeg(g,i)=LSeg(q2,q1) by A645,TOPREAL1:def 5;
                   now per cases by XXREAL_0:1;
               suppose q1`1>q2`1;
                then LSeg(g,i)={p2: p2`2=q1`2 & q2`1<=p2`1 & p2`1<=q1`1}
                  by A651,A652,TOPREAL3:16;
                then consider p2 such that
                A653: p2=x & p2`2=q1`2 & q2`1<=p2`1 & p2`1<=q1`1 by A644,A645;
                    pj`1<=p2`1 & p2`1<=ppi`1 by A650,A653,XXREAL_0:2;
                then x in LSeg(f,k) & LSeg(f,k) in lf by A14,A494,A650,A653;
                hence thesis by TARSKI:def 4;
               end;
               suppose q1`1=q2`1;
                then LSeg(g,i)={q1} by A651,A652,TOPREAL1:7;
                then x=q1 by A644,A645,TARSKI:def 1;
                then x in LSeg(f,k) & LSeg(f,k) in lf by A14,A494,A650;
                hence thesis by TARSKI:def 4;
               end;
               suppose q1`1<q2`1;
                then LSeg(g,i)= {p1: p1`2=q1`2 & q1`1<=p1`1 & p1`1<=q2`1}
                  by A651,A652,TOPREAL3:16;
                then consider p2 such that
                A654: p2=x & p2`2=q1`2 & q1`1<=p2`1 & p2`1<=q2`1 by A644,A645;
                    pj`1<=p2`1 & p2`1<=ppi`1 by A650,A654,XXREAL_0:2;
                then x in LSeg(f,k) & LSeg(f,k) in lf by A14,A494,A650,A654;
                hence thesis by TARSKI:def 4;
               end;
               end;
              hence thesis;
           end;
           end;
          let x; assume x in L~f;
          then A655: x in L~f1 \/ LSeg(f,k) by A5,A12,GOBOARD2:8;
           per cases by A655,XBOOLE_0:def 2;
           suppose x in L~f1; then x in L~g1 & L~g1 c= L~g
            by A33,GOBOARD2:11;
            hence x in L~g;
           end;
           suppose x in LSeg(f,k);
            then consider p1 such that
            A656: p1=x & p1`2=ppi`2 & pj`1<=p1`1 & p1`1<=ppi`1 by A494;
            defpred P2[Nat] means
            len g1<=$1 & $1<=len g & for q st q=g/.$1 holds q`1>=p1`1;
            A657: now
              reconsider n=len g1 as Nat;
              take n;
              thus P2[n]
              proof
               thus len g1<=n & n<=len g by A634,REAL_2:173;
               let q such that
               A658: q=g/.n;
                   1<=len g1 by A14,A16,A36,XXREAL_0:2;
               then len g1 in dom g1 by FINSEQ_3:27;
               then q=f1/.len f1
                by A35,A658,FINSEQ_4:83
               .=G*(i1,i2) by A15,A16,A18,A47,FINSEQ_4:86;
               hence p1`1<=q`1 by A656;
              end;
             end;
            A659: for n be Nat holds P2[n] implies n<=len g;
            consider ma be Nat such that
            A660: P2[ma] & for n be Nat st P2[n] holds n<=ma from NAT_1:sch 6
(A659,A657);
reconsider ma as Element of NAT by ORDINAL1:def 13;
                 now per cases;
             suppose A661: ma=len g;
                  j1+1<=i1 by A477,NAT_1:13;
              then A662: 1<=l & l=len g2 by A481,XREAL_1:21;
              then A663: l in dom g2 & i1-l=j1 by FINSEQ_3:27;
              then A664: g/.ma=g2/.l by A481,A634,A661,FINSEQ_4:84
               .= pj by A481,A482,A663;
              then p1`1<=pj`1 by A660;
              then A665: p1`1=pj`1 by A656,XXREAL_0:1;
              A666: ma-1<=len g & len g1+1<=ma
                by A634,A661,A662,XREAL_1:9,45;
              then A667: len g1<=ma-1 & 0<=len g1 by XREAL_1:21;
then           0+1<=ma by XREAL_1:21;
              then reconsider m1=ma-1 as Element of NAT by INT_1:18;
                  1<=len g1 by A14,A16,A36,XXREAL_0:2;
              then A668: 1<=m1 by A667,XXREAL_0:2;
              reconsider q=g/.m1 as Point of TOP-REAL 2;
              A669: q`2=ppi`2 & pj`1<=q`1 & q=|[q`1,q`2]| & m1+1=ma
               by A635,A666,A667,EUCLID:57;
              then A670: LSeg(g,m1)=LSeg(pj,q)
               by A661,A664,A668,TOPREAL1:def 5;
              set lq={e where e is Point of TOP-REAL 2: e`2=ppi`2 & pj`1<=e`1 &
                      e`1<=q`1};
               LSeg(g,m1)=lq by A493,A669,A670,TOPREAL3:16;
              then p1 in LSeg(g,m1) & LSeg(g,m1) in lg
              by A656,A661,A665,A668,A669;
              hence x in L~g by A656,TARSKI:def 4;
             end;
             suppose ma<>len g;
              then ma<len g by A660,REAL_1:def 5;
              then A671: ma+1<=len g & k<=ma & ma<=ma+1
                by A16,A36,A660,NAT_1:13,XXREAL_0:2;
              A672: 1<=ma & len g1<=ma+1 by A14,A16,A36,A660,NAT_1:13;
              reconsider qa=g/.ma, qa1=g/.(ma+1) as Point of TOP-REAL 2;
              A673: p1`1<=qa`1 by A660;
               A674: now assume p1`1<=qa1`1;
                 then for q holds q=g/.(ma+1) implies p1`1<=q`1;
                then ma+1<=ma by A660,A671,A672;
                hence contradiction by REAL_2:174;
               end;
              then A675: qa1`1<qa`1 & qa1`1<=p1`1 & p1`1<=qa`1 &
              qa`2=ppi`2 & qa1 `2 = ppi`2
              by A635,A660,A671,A672,A673,XXREAL_0:2;
              set lma = {p2: p2`2=ppi`2 & qa1`1<=p2`1 & p2`1<=qa`1};
              A676: qa=|[qa`1,qa`2]| & qa1=|[qa1 `1, qa1 `2]| by EUCLID:57;
                  LSeg(g,ma)=LSeg(qa1,qa) by A671,A672,TOPREAL1:def 5
              .= lma by A675,A676,TOPREAL3:16;
              then x in LSeg(g,ma) & LSeg(g,ma) in lg by A656,A671,A672,A673
,A674;
              hence x in L~g by TARSKI:def 4;
             end;
             end;
            hence x in L~g;
         end;
         end;
            1<=len g1 by A14,A16,A36,XXREAL_0:2;
        then 1 in dom g1 by FINSEQ_3:27;
        hence g/.1=f1/.1
         by A34,FINSEQ_4:83
        .=f/.1 by A15,A19,FINSEQ_4:86;
            j1+1<=i1 by A477,NAT_1:13;
        then A677: 1<=l by XREAL_1:21;
        then A678: l in dom g2 & len g=len g1 + len g2 & len g2 = l
         by A482,FINSEQ_1:3,35,def 3;
        reconsider m1=i1-l as Element of NAT;
        thus g/.len g=g2/.l by A678,FINSEQ_4:84
        .=G*(m1,i2) by A481,A482,A678
        .=f/.len f by A5,A49,A476;
        thus len f<=len g by A5,A16,A36,A677,A678,XREAL_1:9;
       end;
       case A679: i1=j1;
            k<>k+1;
        hence contradiction by A7,A15,A47,A48,A49,A476,A679,PARTFUN2:17;
       end;
       case A680: i1<j1;
        then reconsider l=j1-i1 as Element of NAT by INT_1:18;
        deffunc F(Element of NAT) = G*(i1+$1,i2);
        consider g2 such that
        A681: len g2 = l & for n st n in dom g2 holds g2/.n = F(n)
          from GOBOARD2:sch 1;
A682:    Seg l = dom g2 by A681,FINSEQ_1:def 3;
        take g=g1^g2;
        A683: now let n; assume n in Seg l;
          then A684: 1<=n & n<=l by FINSEQ_1:3;
          then n<=n+i1 & i1+n<=l+i1 by NAT_1:11,XREAL_1:9;
          then n<=i1+n & i1+n<=j1 & j1<=len G by A51,FINSEQ_3:27;
          then 1<=i1+n & i1+n<=len G by A684,XXREAL_0:2;
          hence i1+n in dom G by FINSEQ_3:27;
          hence [i1+n,i2] in Indices G by A50,A51,ZFMISC_1:106;
         end;
        A685: Seg len g2 = dom g2 by FINSEQ_1:def 3;
             now let n such that A686: n in dom g2;
          take m=i1+n,k=i2;
          thus [m,k] in Indices G & g2/.n=G*(m,k) by A681,A683,A685,A686;
         end;
        then A687: for n st n in dom g ex i,j st [i,j] in Indices G &
        g/.n=G*(i,j) by A53,GOBOARD1:39;
        A688: now let n; assume
              n in dom g2 & n+1 in dom g2;
          then A689: g2/.n=G*(i1+n,i2) & [i1+n,i2] in Indices G &
          g2/.(n+1)=G*(i1+(n+1),i2) & [i1+(n+1),i2] in Indices G
          by A681,A683,A685;
          let l1,l2,l3,l4 be Element of NAT; assume
              [l1,l2] in Indices G & [l3,l4] in Indices G & g2/.n=G*(l1,l2) &
           g2/.(n+1)=G*(l3,l4);
           then l1=i1+n & l2=i2 & l3=i1+(n+1) & l4=i2 by A689,GOBOARD1:21;
          hence abs(l1-l3)+abs(l2-l4)= abs(i1+n-(i1+(n+1)))+0 by ABSVALUE:7
           .= abs(-1)
           .= abs(1) by COMPLEX1:138
           .= 1 by ABSVALUE:def 1;
         end;
          now let l1,l2,l3,l4 be Element of NAT; assume
          A690: [l1,l2] in Indices G & [l3,l4] in Indices G & g1/.len g1=G*(l1,
l2) &
          g2/.1=G*(l3,l4) & len g1 in dom g1 & 1 in dom g2;
          then g2/.1=G*
(i1+1,i2) & [i1+1,i2] in Indices G & f1/.len f1=f/.k
            by A15,A16,A18,A681,A683,A685,FINSEQ_4:86;
           then l1=i1 & l2=i2 & l3=i1+1 & l4=i2 by A35,A47,A690,GOBOARD1:21;
          hence abs(l1-l3)+abs(l2-l4)=abs(i1-(i1+1))+0 by ABSVALUE:7
          .=abs(i1-i1+-1)
          .=abs(1) by COMPLEX1:138
          .=1 by ABSVALUE:def 1;
         end;
        then for n st n in dom g & n+1 in dom g holds
         for m,k,i,j st [m,k] in Indices G &
         [i,j] in Indices G & g/.n=G*(m,k) &
          g/.(n+1)=G*(i,j) holds abs(m-i)+abs(k-j)=1 by A53,A688,GOBOARD1:40;
        hence g is_sequence_on G by A687,GOBOARD1:def 11;
        set
        lk={w where w is Point of TOP-REAL 2: w`2=ppi`2 & ppi`1<=w`1 & w`1<=
pj`1};
            c1/.i1=c1.i1 & c1/.j1=c1.j1 by A51,A70,PARTFUN1:def 8;
        then A691: c1/.i1=ppi & c1/.j1=pj by A51,MATRIX_1:def 9;
        then A692: y2.i1=ppi`2 & y2.j1=pj`2 & x2.i1=ppi`1 & x2.j1=pj`1
          by A51,A64,A65,A66,A67,A68,A70,GOBOARD1:def 3,def 4;
        then A693: ppi`1<pj`1 & ppi`2=pj`2 &
        ppi=|[ppi`1,ppi`2]| & pj=|[pj`1,pj`2]|
        by A51,A56,A57,A64,A65,A66,A67,A68,A70,A680,EUCLID:57,GOBOARD1:def 1
,def 2;
        A694: LSeg(f,k)=LSeg(ppi,pj) by A14,A47,A49,A476,TOPREAL1:def 5
        .= lk by A693,TOPREAL3:16;
        A695: LSeg(f,k)=LSeg(ppi,pj) by A14,A47,A49,A476,TOPREAL1:def 5;
             now let n,m; assume
          A696: n in dom g2 & m in dom g2 & n<>m;
          then A697: g2/.n=G*(i1+n,i2) & g2/.m=G*(i1+m,i2) & [i1+n,i2] in
Indices G &
          [i1+m,i2] in Indices G by A681,A683,A685;
          assume g2/.n=g2/.m;
          then i1+n=i1+m by A697,GOBOARD1:21;
          hence contradiction by A696;
         end;
         then for n,m st n in dom g2 & m in dom g2 &
         g2/.n = g2/.m holds n = m;
        then A698: g2 is one-to-one by PARTFUN2:16;
        A699: not f/.k in rng g2
         proof assume f/.k in rng g2;
          then consider n such that
          A700: n in dom g2 & g2/.n=f/.k by PARTFUN2:4;
           g2/.n=G*(i1+n,i2) & [i1+n,i2] in Indices G
            by A681,A682,A683,A700;
           then i1+n=i1 & 0<n by A47,A700,FINSEQ_3:27,GOBOARD1:21;
          hence contradiction;
         end;
        A701: now let n,p; assume
          A702: n in dom g2 & g2/.n=p;
          then A703: g2/.n=G*(i1+n,i2) & 1<=n & n<=len g2 & i1+n in dom G
           by A681,A683,A685,FINSEQ_3:27;
          set n1=i1+n;
          set pn = G*(n1,i2);
              c1/.n1=c1.n1 by A70,A703,PARTFUN1:def 8;
          then A704: g2/.n=pn & c1/.n1=pn & 0<=n & n1<=i1+len g2
            by A703,MATRIX_1:def 9,XREAL_1:9;
          then A705: y2.n1=pn`2 & y2.n1=y2.i1 & x2.n1=pn`1 & n1<=j1 & i1<=n1
          by A51,A57,A64,A65,A66,A67,A68,A70,A681,A703,GOBOARD1:def 2,def 3
,def 4,REAL_2:173;
          hence p`2=ppi`2 & ppi`1<=p`1 & p`1<=pj`1
            by A51,A56,A67,A70,A692,A702,A703,GOBOARD2:18;
          thus p in rng c1 by A70,A702,A703,A704,PARTFUN2:4;
           i1<n1 by A703,REAL_2:174;
          hence p`1>ppi`1 by A51,A56,A67,A70,A692,A702,A703,A705,GOBOARD1:def 1
;
         end;
        A706: now let n,m,p,q; assume
          A707: n in dom g2 & m in dom g2 & n<m & g2/.n=p & g2/.m=q;
          then A708: g2/.n=G*(i1+n,i2) & i1+n in dom G &
              g2/.m=G*(i1+m,i2) & i1+m in dom G by A681,A683,A685;
          set n1=i1+n, m1=i1+m;
          set pn = G*(n1,i2),
              pm = G*(m1,i2);
              c1/.n1=c1.n1 & c1/.m1 = c1.m1 by A70,A708,PARTFUN1:def 8;
          then A709: c1/.n1=pn & c1/.m1=pm & n1<m1
            by A707,A708,MATRIX_1:def 9,XREAL_1:10;
          then x2.n1=pn`1 & x2.m1=pm`1 by A67,A70,A708,GOBOARD1:def 3;
          hence p`1<q`1 by A56,A67,A70,A707,A708,A709,GOBOARD1:def 1;
         end;
        A710: rng g2 c= LSeg(f,k)
         proof let x; assume x in rng g2;
          then consider n such that
          A711: n in dom g2 & g2/.n=x by PARTFUN2:4;
          A712: g2/.n=G*(i1+n,i2) by A681,A711;
          set pn = G*((i1+n),i2);
              pn`2=ppi`2 & ppi`1<=pn`1 & pn`1<=pj`1 by A701,A711,A712;
          hence x in LSeg(f,k) by A694,A711,A712;
         end;
            rng g1 /\ rng g2 = {}
         proof consider x being Element of rng g1 /\ rng g2;
          assume not thesis;
          then A713: x in rng g1 & x in rng g2 by XBOOLE_0:def 3;
               now per cases by A14,REAL_1:def 5;
           suppose k=1;
            hence contradiction by A37,A699,A713,TARSKI:def 1;
           end;
           suppose 1<k;
            then x in L~f1 /\ LSeg(f,k) & L~f1 /\ LSeg(f,k)={f/.k}
             by A5,A8,A9,A44,A710,A713,GOBOARD2:9,XBOOLE_0:def 3;
            hence contradiction by A699,A713,TARSKI:def 1;
           end;
           end;
          hence contradiction;
         end;
        then rng g1 misses rng g2 by XBOOLE_0:def 7;
        hence g is one-to-one by A29,A698,FINSEQ_3:98;
        A714: for n st 1<=n & n+2 <= len g2 holds
             LSeg(g2,n) /\ LSeg(g2,n+1) = {g2/.(n+1)}
         proof let n; assume
          A715:1<=n & n+2 <= len g2;
          then A716: n in dom g2 & n+1 in dom g2 & n+2 in dom g2 by GOBOARD2:4;
          then g2/.n in rng g2 & g2/.(n+1) in rng g2 &
          g2/.(n+2) in rng g2 by PARTFUN2:4;
          then A717: g2/.n in lk & g2/.(n+1) in lk &
          g2/.(n+2) in lk by A694,A710;
          then consider u be Point of TOP-REAL 2 such that
          A718: g2/.n=u & u`2=ppi`2 & ppi`1<=u`1 & u`1<=pj`1;
          consider u1 be Point of TOP-REAL 2 such that
          A719: g2/.(n+1)=u1 & u1`2=ppi`2 & ppi`1<=u1`1 & u1`1<=pj`1 by A717;
          consider u2 be Point of TOP-REAL 2 such that
          A720: g2/.(n+2)=u2 & u2`2=ppi`2 & ppi`1<=u2`1 & u2`1<=pj`1 by A717;
          set lg = {w where w is Point of TOP-REAL 2:
                     w`2=ppi`2 & u`1<=w`1 & w`1<=u2`1};
          A721: 1<= n+1 by NAT_1:11;
          A722: n+1+1 = n+(1+1);
              n+1 <= n+2 by XREAL_1:8;
          then n+1 <= len g2 by A715,XXREAL_0:2;
          then A723: LSeg(g2,n)=LSeg(u,u1) & LSeg(g2,n+1)=LSeg(u1,u2) &
          LSeg(g2/.n,g2/.(n+2))=LSeg(u,u2)
           by A715,A718,A719,A720,A721,A722,TOPREAL1:def 5;
              n<n+1 & n+1<n+1+1 & n+1+1=n+(1+1) by NAT_1:13;
          then A724: u1`1<u2`1 & u`1<u1`1 by A706,A716,A718,A719,A720;
          then A725: u1`1<=u2`1 & u`1<=u1`1 & u`1<u2`1 by XXREAL_0:2;
          A726: u1 in lg & u=|[u`1,u`2]| & u2=|[u2`1,u2`2]| by A719,A724,
EUCLID:57;
          then LSeg(g2/.n,g2/.(n+2))=lg by A718,A720,A725,TOPREAL3:16;
          hence thesis by A719,A723,A726,TOPREAL1:14;
         end;
        thus g is unfolded
         proof let n be Nat; assume
          A727: 1<=n & n+2 <= len g;
then A728:           n+1+1<=len g;
          A729: 1<= n+1 by NAT_1:11;
          A730: n<=n+1 & n+1<=n+1+1 by NAT_1:11;
then A731:      n+1 <= len g by A727,XXREAL_0:2;
A732:      n+(1+1)=n+1+1;
A733:      len g=len g1+len g2 by FINSEQ_1:35;
               n+2-len g1 = n-len g1 +2;
          then A734: n-len g1 + 2 <= len g2 by A727,A733,XREAL_1:22;
           per cases;
           suppose A735: n+2 <= len g1;
        then n in dom g1 & n+1 in dom g1 & n+2 in dom g1 & n+(1+1)=n+1+1
              by A727,GOBOARD2:4;
            then LSeg(g1,n)=LSeg(g,n) & LSeg(g1,n+1)=LSeg(g,n+1) &
            g/.(n+1)=g1/.(n+1) by FINSEQ_4:83,TOPREAL3:25;
            hence thesis by A30,A727,A735,TOPREAL1:def 8;
           end;
           suppose len g1 < n+2;
            then len g1+1<=n+2 by NAT_1:13;
            then A736: len g1<=n+2-1 by XREAL_1:21;
                 now per cases;
             suppose A737: len g1=n+1;
                   now assume A738: k=1;
                    1<len g1 by A727,A737,NAT_1:13;
                then 1+1<=len g1 by NAT_1:13;
                hence contradiction by A37,A738,TOPREAL1:29;
               end;
              then A739: 1<k & LSeg(g1,n) c= L~f1
                 by A14,A33,REAL_1:def 5,TOPREAL3:26;
              then A740: L~f1 /\ LSeg(f,k)={f/.k} by A5,A8,A9,GOBOARD2:9;
                  1<=n+1 by NAT_1:11;
              then A741: n in dom g1 & n+1 in dom g1
              by A727,A730,A737,FINSEQ_3:27;
              then A742: LSeg(g,n)=LSeg(g1,n) by TOPREAL3:25;
              A743: g/.(n+1)=f1/.len f1 by A35,A737,A741,FINSEQ_4:83
              .= ppi by A15,A16,A18,A47,FINSEQ_4:86;
                  n+2 = 1+len g1 & 1 <= len g2 by A727,A732,A733,A737,XREAL_1:8
;
              then A744: g/.(n+2)=g2/.1 by GOBOARD2:5;
                  1<=len g-len g1 by A728,A737,XREAL_1:21;
              then 1 in dom g2 by A733,FINSEQ_3:27;
              then A745: g2/.1 in rng g2 by PARTFUN2:4;
              then g2/.1 in lk by A694,A710;
              then consider u1 be Point of TOP-REAL 2 such that
              A746: g2/.1=u1 & u1`2=ppi`2 & ppi`1<=u1`1 & u1`1<=pj`1;
                  ppi in LSeg(ppi,pj) by TOPREAL1:6;
              then LSeg(ppi,u1) c= LSeg(f,k) & LSeg(g,n+1)=LSeg(ppi,u1)
                by A695,A710,A727,A729,A732,A743,A744,A745,A746,TOPREAL1:12
,def 5;
              then A747: LSeg(g,n) /\ LSeg(g,n+1) c= {g/.(n+1)}
               by A47,A739,A740,A742,A743,XBOOLE_1:27;
                  g/.(n+1) in LSeg(g,n) & g/.(n+1) in LSeg(g,n+1)
                by A727,A729,A731,A732,TOPREAL1:27;
              then g/.(n+1) in LSeg(g,n) /\ LSeg(g,n+1) by XBOOLE_0:def 3;
              then {g/.(n+1)} c= LSeg(g,n) /\ LSeg(g,n+1) by ZFMISC_1:37;
              hence thesis by A747,XBOOLE_0:def 10;
             end;
             suppose len g1<>n+1; then len g1<n+1 by A736,REAL_1:def 5;
              then A748: len g1<=n by NAT_1:13;
              then reconsider n1=n-len g1 as Element of NAT by INT_1:18;
                   now per cases;
               suppose A749: len g1=n;
                    1<=len g1 by A14,A16,A36,XXREAL_0:2;
                then len g1 in dom g1 by FINSEQ_3:27;
                then A750: g/.n=f1/.len f1 by A35,A749,FINSEQ_4:83
                .= ppi by A15,A16,A18,A47,FINSEQ_4:86;
A751:             2 <= len g2 by A727,A733,A749,XREAL_1:8;
                then 1 <= len g2 by XXREAL_0:2;
                then A752: g/.(n+1)=g2/.1 by A749,GOBOARD2:5;
                A753: g/.(n+2)=g2/.2 by A749,A751,GOBOARD2:5;
                     1<=len g2 by A751,XXREAL_0:2;
                then A754: 1 in dom g2 & 2 in dom g2 by A751,FINSEQ_3:27;
                then g2/.1 in rng g2 & g2/.2 in rng g2 by PARTFUN2:4;
                then A755: g2/.1 in lk & g2/.2 in lk by A694,A710;
                then consider u1 be Point of TOP-REAL 2 such that
                A756: g2/.1=u1 & u1`2=ppi`2 & ppi`1<=u1`1 & u1`1<=pj`1;
                consider u2 be Point of TOP-REAL 2 such that
          A757: g2/.2=u2 & u2`2=ppi`2 & ppi`1<=u2`1 & u2`1<=pj`1 by A755;
                A758: u1`1<u2`1 by A706,A754,A756,A757;
                then A759: u1`1<=u2`1 & ppi`1<u2`1 & u2=|[u2`1,u2`2]|
                  by A756,EUCLID:57,XXREAL_0:2;
                set lg = {w where w is Point of TOP-REAL 2 :
                          w`2=ppi`2 & ppi`1<=w`1 & w`1<=u2`1};
                A760: u1 in lg by A756,A758;
                A761: LSeg(g,n)=LSeg(ppi,u1) & LSeg(g,n+1)=LSeg(u1,u2)
             by A727,A729,A731,A732,A750,A752,A753,A756,A757,TOPREAL1:def 5;
                    u1 in LSeg(ppi,u2) by A693,A757,A759,A760,TOPREAL3:16;
                hence thesis by A752,A756,A761,TOPREAL1:14;
               end;
               suppose len g1<>n;
then A762:              len g1<n by A748,REAL_1:def 5;
                    n1 + len g1 = n;
then A763:            LSeg(g,n)=LSeg(g2,n1) by A731,A762,GOBOARD2:10;
A764:            len g1<n+1 by A730,A762,XXREAL_0:2;
A765:            len g1+1<=n by A762,NAT_1:13;
A766:            n+1 = n1+1+len g1;
A767:             1<=n1+1 by NAT_1:11;
                    n1+1<=len g2 by A731,A733,A766,XREAL_1:8;
                then LSeg(g,n+1)=LSeg(g2,n1+1)& g/.(n+1)=g2/.(n1+1) & 1<=n1
                  by A728,A764,A765,A766,A767,GOBOARD2:5,10,XREAL_1:21;
                hence thesis by A714,A734,A763;
               end;
               end;
              hence thesis;
             end;
             end;
            hence thesis;
         end;
         end;
               for n,m st m>n+1 & n in dom g2 & n+1 in dom g2 & m in dom g2 &
           m+1 in dom g2 holds LSeg(g2,n) misses LSeg(g2,m)
         proof let n,m; assume that
          A768: m>n+1 and
          A769: n in dom g2 & n+1 in dom g2 & m in dom g2 & m+1 in dom g2 and
          A770: LSeg(g2,n) /\ LSeg(g2,m) <> {};
          A771: 1 <= n & n+1 <= len g2 & 1 <= m & m+1<=
 len g2 by A769,FINSEQ_3:27;
          reconsider p1=g2/.n, p2=g2/.(n+1), q1=g2/.m, q2=g2/.(m+1)
           as Point of TOP-REAL 2;
          set lp = {w where w is Point of TOP-REAL 2: w`2=ppi`2 &
                         p1`1<=w`1 & w`1<=p2`1},
              lq = {w where w is Point of TOP-REAL 2: w`2=ppi`2 &
                         q1`1<=w`1 & w`1<=q2`1};
               m<m+1 & n<n+1 by NAT_1:13;
           then A772: p1`1<p2`1 & q1`1<q2`1 & p1`2=ppi`2 & p2`2=ppi`2 & q1`2=
ppi`2 &
           q2`2=ppi`2 & p1=|[p1`1,p1`2]| & q1=|[q1`1,q1`2]| &
           p2=|[p2`1,p2`2]| &
           q2=|[q2`1,q2`2]| by A701,A706,A769,EUCLID:57;
           A773: LSeg(g2,n) = LSeg(p1,p2) by A771,TOPREAL1:def 5
           .=lp by A772,TOPREAL3:16;
           A774: LSeg(g2,m) = LSeg(q1,q2) by A771,TOPREAL1:def 5
           .=lq by A772,TOPREAL3:16;
           consider x being Element of LSeg(g2,n) /\ LSeg(g2,m);
           A775: x in LSeg(g2,n) & x in LSeg(g2,m) by A770,XBOOLE_0:def 3;
then A776:           ex tn be Point of TOP-REAL 2 st
 tn=x & tn`2=ppi`2 & p1`1<=tn`1 & tn`1<=p2`1 by A773;
A777:           ex tm be Point of TOP-REAL 2 st
 tm=x & tm`2=ppi`2 & q1`1<=tm`1 & tm`1<=q2`1 by A774,A775;
                p2`1<q1`1 by A706,A768,A769;
            hence contradiction by A776,A777,XXREAL_0:2;
         end;
then A778:    g2 is s.n.c. by GOBOARD2:6;
        A779: L~g2 c= LSeg(f,k)
         proof
          set ls={LSeg(g2,m): 1<=m & m+1 <= len g2}; let x; assume
              x in L~g2;
          then consider X be set such that
          A780: x in X & X in ls by TARSKI:def 4;
          consider m such that
          A781: X=LSeg(g2,m) & 1<=m & m+1 <= len g2 by A780;
               m in dom g2 & m+1 in dom g2 by A781,GOBOARD2:3;
          then A782: g2/.m in rng g2 & g2/.(m+1) in rng g2 by PARTFUN2:4;
          reconsider q1=g2/.m, q2=g2/.(m+1) as Point of TOP-REAL 2;
          A783: LSeg(q1,q2) c= LSeg(ppi,pj) by A695,A710,A782,TOPREAL1:12;
              LSeg(g2,m)=LSeg(q1,q2) by A781,TOPREAL1:def 5;
          hence thesis by A695,A780,A781,A783;
         end;
        A784: not f/.k in L~g2
         proof set ls={LSeg(g2,m): 1<=m & m+1 <= len g2}; assume
              f/.k in L~g2;
          then consider X be set such that
          A785: f/.k in X & X in ls by TARSKI:def 4;
          consider m such that
          A786: X=LSeg(g2,m) & 1<=m & m+1 <= len g2 by A785;
          A787: m in dom g2 & m+1 in dom g2 & m<m+1
          by A786,GOBOARD2:3,NAT_1:13;
          reconsider q1=g2/.m, q2=g2/.(m+1) as Point of TOP-REAL 2;
          set lq={w where w is Point of TOP-REAL 2: w`2=ppi`2 &
                       q1`1<=w`1 & w`1<=q2`1};
          A788: q1`2=ppi`2 & q2`2=ppi`2 & q1`1<q2`1 & q1=|[q1`1,q1`2]|
          & q2=|[q2`1,q2`2]| by A701,A706,A787,EUCLID:57;
              LSeg(g2,m)=LSeg(q1,q2) by A786,TOPREAL1:def 5
          .=lq by A788,TOPREAL3:16;
          then ex p st p=f/.k & p`2=ppi`2 & q1`1<=p`1 & p`1<=q2`1 by A785,A786
;
          hence contradiction by A47,A701,A787;
         end;
        A789: L~g1 /\ L~g2 = {}
         proof per cases;
           suppose k=1; hence thesis by A37;
           end;
           suppose k<>1; then 1<k by A14,REAL_1:def 5;
            then L~g1 /\ LSeg(f,k)={f/.k}
             by A5,A8,A9,A33,GOBOARD2:9;
             then A790: L~g1 /\ L~g2 c= {f/.k} by A779,XBOOLE_1:26;
                 now consider x being Element of L~g1 /\ L~g2;
              assume L~g1 /\ L~g2 <> {};
              then x in {f/.k} & x in L~g2 by A790,TARSKI:def 3,XBOOLE_0:def 3
;
              hence contradiction by A784,TARSKI:def 1;
             end;
            hence thesis;
         end;
         end;
            for n,m st m>n+1 & n in dom g & n+1 in dom g &
        m in dom g & m+1 in dom g
         holds LSeg(g,n) misses LSeg(g,m)
         proof let n,m; assume that
          A791: m>n+1 and
          A792: n in dom g & n+1 in dom g & m in dom g & m+1 in dom g;
          A793: 1<=n & 1<=n+1 & n+1<=len g & 1<=m & 1<=m+1 &
          m+1<=len g & n<=n+1 & m<=m+1 & len g=len g1+len g2
            by A792,FINSEQ_1:35,FINSEQ_3:27,NAT_1:11;
          set l1 = {LSeg(g1,i): 1<=i & i+1 <= len g1},
              l2 = {LSeg(g2,j): 1<=j & j+1 <= len g2};
              i1+1<=j1 by A680,NAT_1:13;
          then A794: 1<=l by XREAL_1:21;
          then A795: 1 in dom g2 by A681,FINSEQ_3:27;
          reconsider qq=g2/.1 as Point of TOP-REAL 2;
          set ql={z where z is Point of TOP-REAL 2: z`2=ppi`2 &
                     ppi`1<=z`1 & z`1<=qq`1};
          A796: 1<=len g1 by A14,A16,A36,XXREAL_0:2;
           then len g1 in dom g1 & dom g1 c= dom g by FINSEQ_1:39,FINSEQ_3:27;
          then A797: g/.len g1=g1/.len g1 by FINSEQ_4:83
             .= ppi by A15,A16,A18,A35,A47,FINSEQ_4:86;
          A798: len g1<len g1 +1 & len g1+1<=len g
            by A681,A793,A794,NAT_1:13,XREAL_1:9;
          A799: g/.(len g1+1)=qq by A681,A794,GOBOARD2:5;
          A800: qq`2=ppi`2 & qq`1<=pj`1 & qq`1>ppi`1 & qq=|[qq`1,qq`2]|
           by A701,A795,EUCLID:57;
          A801: LSeg(g,len g1)=LSeg(ppi,qq)
          by A796,A797,A798,A799,TOPREAL1:def 5
           .= ql by A693,A800,TOPREAL3:16;
            A802: n+1<=m+1 by A791,A793,XXREAL_0:2;
                 now per cases;
             suppose A803: m+1<=len g1;
              then A804: m<=len g1 & n+1<=len g1 by A793,A802,XXREAL_0:2;
              then n<=len g1 by A793,XXREAL_0:2;
              then n in dom g1 & n+1 in dom g1 & m in dom g1 & m+1 in dom g1
               by A793,A803,A804,FINSEQ_3:27;
              then LSeg(g,n)=LSeg(g1,n) & LSeg(g,m)=LSeg(g1,m) by TOPREAL3:25;
              hence thesis by A31,A791,TOPREAL1:def 9;
             end;
             suppose len g1<m+1;
              then A805: len g1<=m by NAT_1:13;
              then reconsider m1=m-len g1 as Element of NAT by INT_1:18;
                   now per cases;
               suppose A806: m=len g1;
                     now assume A807: k=1;
                      1<len g1 by A791,A793,A806,XXREAL_0:2;
                  then 1+1<=len g1 by NAT_1:13;
                  hence contradiction by A37,A807,TOPREAL1:29;
                 end;
                then 1<k by A14,REAL_1:def 5;
                then A808: L~f1 /\ LSeg(f,k) ={f/.k}
                 by A5,A8,A9,GOBOARD2:9;
                    n<=len g1 by A791,A793,A806,XXREAL_0:2;
                then A809: n in dom g1 & n+1 in dom g1
                by A791,A793,A806,FINSEQ_3:27;
                then A810: LSeg(g,n)=LSeg(g1,n) by TOPREAL3:25;
                then LSeg(g,n) in l1 by A791,A793,A806;
                then A811: LSeg(g,n) c= L~f1
                 by A33,ZFMISC_1:92;
                    LSeg(g,m) c= LSeg(f,k)
                 proof let x; assume x in LSeg(g,m);
                  then consider px be Point of TOP-REAL 2 such that
            A812: px=x & px`2=ppi`2 & ppi`1<=px`1 & px`1<=qq`1 by A801,A806;
                      pj`1>=px`1 by A800,A812,XXREAL_0:2;
                  hence thesis by A694,A812;
                 end;
                then A813: LSeg(g,n) /\ LSeg(g,m) c= {f/.k}
                 by A808,A811,XBOOLE_1:27;
                     now consider x being Element of LSeg(g,n)/\ LSeg(g,m);
                  assume
                    LSeg(g,n)/\ LSeg(g,m)<>{};
                  then A814: x in LSeg(g,n) & x in {f/.k}
                  by A813,TARSKI:def 3,XBOOLE_0:def 3;
                  then A815: x=f/.k by TARSKI:def 1;
                      f/.k=g1/.len g1
                   by A15,A16,A18,A35,FINSEQ_4:86;
                  hence contradiction by A29,A30,A31,A791,A806,A809,A810,A814
,A815,GOBOARD2:7;
                 end;
                hence thesis by XBOOLE_0:def 7;
               end;
               suppose
               m<>len g1;
                then A816: len g1<m & m+1=m1+1+len g1
                 by A805,REAL_1:def 5;
                    m = m1+len g1;
                then A817: LSeg(g,m)=LSeg(g2,m1) by A793,A816,GOBOARD2:10;
                    m1+1<=len g2 & len g1+1<=
m by A793,A816,NAT_1:13,XREAL_1:8;
                then A818: 1<=m1 & m1+1 <= len g2 by XREAL_1:21;
                then LSeg(g,m) in l2 by A817;
                then A819: LSeg(g,m) c= L~g2 by ZFMISC_1:92;
                     now per cases;
                 suppose A820: n+1<=len g1;
                  then n<=len g1 by A793,XXREAL_0:2;
                  then n in dom g1 & n+1 in dom g1 by A793,A820,FINSEQ_3:27;
                   then LSeg(g,n)=LSeg(g1,n) by TOPREAL3:25;
                  then LSeg(g,n) in l1 by A793,A820;
                  then LSeg(g,n) c= L~g1 by ZFMISC_1:92;
                  then LSeg(g,n) /\ LSeg(g,m) c= {} by A789,A819,XBOOLE_1:27;
                  then LSeg(g,n) /\ LSeg(g,m) = {} by XBOOLE_1:3;
                  hence thesis by XBOOLE_0:def 7;
                 end;
                 suppose len g1<n+1;
                  then A821: len g1<=n by NAT_1:13;
                  then reconsider n1=n-len g1 as Element of NAT by INT_1:18;
A822:               n - len g1 + 1 = n + 1 - len g1;
A823:               n = n1 + len g1;
                       now per cases;
                   suppose A824: len g1=n;
                         now consider x being
                      Element of LSeg(g,n) /\ LSeg(g,m);
                      assume
                        LSeg(g,n) /\ LSeg(g,m)<>{};
                      then A825: x in LSeg(g,n) & x in LSeg(g,m)
                      by XBOOLE_0:def 3;
then A826:                      ex qx be Point of TOP-REAL 2 st
                       qx=x & qx`2=ppi`2 & ppi`1<=qx`1 & qx`1<=qq`1
                       by A801,A824;
                      A827: m1 in dom g2 & m1+1 in dom g2 & m1<m1+1
                        by A818,GOBOARD2:3,NAT_1:13;
                      reconsider q1=g2/.m1, q2=g2/.(m1+1)
                       as Point of TOP-REAL 2;
                      set q1l={v where v is Point of TOP-REAL 2: v`2=ppi`2 &
                                 q1`1<=v`1 & v`1<=q2`1};
                      A828: q1`2=ppi`2 & q2`2=ppi`2 & q1`1<q2`1 & q1=|[q1`1,q1
`2]|&
                      q2=|[q2`1,q2`2]| by A701,A706,A827,EUCLID:57;
                          m1 > n1 + 1 & n1 + 1 >=
 1 by A791,A822,NAT_1:11,XREAL_1:11;
then A829:                   m1 > 1 by XXREAL_0:2;
                          LSeg(g2,m1)=LSeg(q1,q2) by A818,TOPREAL1:def 5
                      .=q1l by A828,TOPREAL3:16;
then A830:                   ex qy be Point of TOP-REAL 2 st
                       qy=x & qy`2=ppi`2 & q1`1<=qy`1 & qy`1<=q2`1
                       by A817,A825;
                          qq`1<q1`1 by A706,A795,A827,A829;
                      hence contradiction by A826,A830,XXREAL_0:2;
                     end;
                    hence thesis by XBOOLE_0:def 7;
                   end;
                   suppose n<>len g1;
                    then len g1<n by A821,REAL_1:def 5;
                    then LSeg(g,n)=LSeg(g2,n1) & m1>n1+1
                     by A791,A793,A822,A823,GOBOARD2:10,XREAL_1:11;
                    hence thesis by A778,A817,TOPREAL1:def 9;
                   end;
                   end;
                  hence thesis;
                 end;
                 end;
                hence thesis;
               end;
               end;
              hence thesis;
             end;
             end;
            hence thesis;
         end;
        hence g is s.n.c. by GOBOARD2:6;
        A831: g2 is special
         proof let n be Nat;
          set p = g2/.n, q = g2/.(n+1);
         assume 1<=n & n+1 <= len g2;
          then n in dom g2 & n+1 in dom g2 by GOBOARD2:3;
          then p`2=ppi`2 & q`2=ppi`2 by A701;
          hence p`1=q`1 or p`2=q`2;
         end;
             now
          set p=g1/.len g1, q=g2/.1;
              i1+1<=j1 by A680,NAT_1:13;
          then 1<=l by XREAL_1:21;
          then 1 in dom g2 by A681,FINSEQ_3:27;
           then q`2=ppi`2 by A701;
          hence p`1=q`1 or p`2=q`2 by A15,A16,A18,A35,A47,FINSEQ_4:86;
         end;
        hence g is special by A32,A831,GOBOARD2:13;
        thus L~g=L~f
         proof
          set lg = {LSeg(g,i): 1<=i & i+1 <= len g},
              lf = {LSeg(f,j): 1<=j & j+1 <= len f};
          A832: len g = len g1 + len g2 by FINSEQ_1:35;
          A833: now let j; assume
            A834: len g1<=j & j<=len g;
            then reconsider w = j-len g1 as Element of NAT by INT_1:18;
            let p such that
            A835: p=g/.j;
                 now per cases;
             suppose A836: j=len g1;
                  1<=len g1 by A14,A16,A36,XXREAL_0:2;
              then len g1 in dom g1 by FINSEQ_3:27;
              then A837: g/.len g1 = f1/.len f1 by A35,FINSEQ_4:83
              .= G*(i1,i2) by A15,A16,A18,A47,FINSEQ_4:86;
              hence p`2=G*(i1,i2)`2 by A835,A836;
              thus G*(i1,i2)`1<=p`1 & p`1<=G*
(j1,i2)`1 by A51,A56,A67,A70,A680,A692,A835,A836,A837,GOBOARD1:def 1;
              thus p in rng c1 by A51,A70,A691,A835,A836,A837,PARTFUN2:4;
             end;
             suppose j<>len g1;
then A838:           len g1 < j by A834,REAL_1:def 5;
A839:           j = w + len g1;
                   len g1 + 1 <= j by A838,NAT_1:13;
then A840:           1<=w & w<=len g2 by A832,A834,XREAL_1:21,22;
then A841:          g/.j=g2/.w by A839,GOBOARD2:5;
                  w in dom g2 by A840,FINSEQ_3:27;
              hence p`2=ppi`2 & ppi`1<=p`1 & p`1<=
pj`1 & p in rng c1 by A701,A835,A841;
             end;
             end;
            hence p`2=ppi`2 & ppi`1<=p`1 & p`1<=pj`1 & p in rng c1;
           end;
          thus L~g c= L~f
           proof let x; assume x in L~g;
            then consider X be set such that
            A842: x in X & X in lg by TARSKI:def 4;
            consider i such that
            A843: X=LSeg(g,i) & 1<=i & i+1 <= len g by A842;
                 now per cases;
             suppose A844: i+1 <= len g1;
              then i<=i+1 & i+1<=len g1 by NAT_1:11;
              then 1<=i & i<=len g1 & 1<=i+1 & i+1<=len g1 by A843,XXREAL_0:2;
              then i in dom g1 & i+1 in dom g1 by FINSEQ_3:27;
              then X=LSeg(g1,i) by A843,TOPREAL3:25;
              then X in {LSeg(g1,j): 1<=j & j+1 <= len g1} by A843,A844;
              then x in L~f1 & L~f1 c= L~f by A33,A842,TARSKI:def 4,TOPREAL3:27
;
              hence thesis;
             end;
             suppose A845: i+1 > len g1;
              then A846: len g1<=i & i<=i+1 & i+1<=len g by A843,NAT_1:13;
              A847: 1<=i+1 & len g1<=i+1 & i<=len g by A843,A845,NAT_1:13;
              reconsider q1=g/.i, q2=g/.(i+1) as Point of TOP-REAL 2;
              A848: q1`2=ppi`2 & ppi`1<=q1`1 & q1`1<=pj`1 & q2`2=ppi`2 &
              ppi`1<= q2`1 &
              q2`1<=pj`1 by A833,A846,A847;
              then A849: q1=|[q1`1,q1`2]| & q2=|[q2`1,q1`2]| by EUCLID:57;
              A850: LSeg(g,i)=LSeg(q2,q1) by A843,TOPREAL1:def 5;
                   now per cases by XXREAL_0:1;
               suppose q1`1>q2`1;
                then LSeg(g,i)={p2: p2`2=q1`2 & q2`1<=p2`1 & p2`1<=q1`1}
                  by A849,A850,TOPREAL3:16;
                then consider p2 such that
                A851: p2=x & p2`2=q1`2 & q2`1<=p2`1 & p2`1<=q1`1 by A842,A843;
                    ppi`1<=p2`1 & p2`1<=pj`1 by A848,A851,XXREAL_0:2;
                then x in LSeg(f,k) & LSeg(f,k) in lf by A14,A694,A848,A851;
                hence thesis by TARSKI:def 4;
               end;
               suppose q1`1=q2`1;
                then LSeg(g,i)={q1} by A849,A850,TOPREAL1:7;
                then x=q1 by A842,A843,TARSKI:def 1;
                then x in LSeg(f,k) & LSeg(f,k) in lf by A14,A694,A848;
                hence thesis by TARSKI:def 4;
               end;
               suppose q1`1<q2`1;
                then LSeg(g,i)= {p1: p1`2=q1`2 & q1`1<=p1`1 & p1`1<=q2`1}
                  by A849,A850,TOPREAL3:16;
                then consider p2 such that
                A852: p2=x & p2`2=q1`2 & q1`1<=p2`1 & p2`1<=q2`1 by A842,A843;
                    ppi`1<=p2`1 & p2`1<=pj`1 by A848,A852,XXREAL_0:2;
                then x in LSeg(f,k) & LSeg(f,k) in lf by A14,A694,A848,A852;
                hence thesis by TARSKI:def 4;
               end;
               end;
              hence thesis;
             end;
             end;
            hence thesis;
           end;
          let x; assume x in L~f;
          then A853: x in L~f1 \/ LSeg(f,k) by A5,A12,GOBOARD2:8;
               now per cases by A853,XBOOLE_0:def 2;
           suppose x in L~f1; then x in L~g1 & L~g1 c= L~g
            by A33,GOBOARD2:11;
            hence x in L~g;
           end;
           suppose x in LSeg(f,k);
            then consider p1 such that
            A854: p1=x & p1`2=ppi`2 & ppi`1<=p1`1 & p1`1<=pj`1 by A694;
            defpred P2[Nat] means
            len g1<=$1 & $1<=len g & for q st q=g/.$1 holds q`1<=p1`1;
            A855: now
              reconsider n=len g1 as Nat;
              take n;
              thus P2[n]
              proof
               thus len g1<=n & n<=len g by A832,REAL_2:173;
               let q such that
               A856: q=g/.n;
                   1<=len g1 by A14,A16,A36,XXREAL_0:2;
               then len g1 in dom g1 by FINSEQ_3:27;
               then q=f1/.len f1 by A35,A856,FINSEQ_4:83
               .=G*(i1,i2) by A15,A16,A18,A47,FINSEQ_4:86;
               hence q`1<=p1`1 by A854;
              end;
             end;
            A857: for n be Nat holds P2[n] implies n<=len g;
            consider ma be Nat such that
            A858: P2[ma] & for n be Nat st P2[n] holds n<=ma from NAT_1:sch 6
(A857,A855);
reconsider ma as Element of NAT by ORDINAL1:def 13;
                 now per cases;
             suppose A859: ma=len g;
                  i1+1<=j1 by A680,NAT_1:13;
              then A860: 1<=l by XREAL_1:21;
              then A861: l in dom g2 & i1+l=j1 by A681,FINSEQ_3:27;
              then A862: g/.ma=g2/.l by A681,A832,A859,FINSEQ_4:84
               .= pj by A681,A861;
              then pj`1<=p1`1 by A858;
              then A863: p1`1=pj`1 by A854,XXREAL_0:1;
              A864: ma-1<=len g & len g1+1<=ma
                by A681,A832,A859,A860,XREAL_1:9,45;
              then A865: len g1<=ma-1 & 0<=len g1 by XREAL_1:21;
then           0+1<=ma by XREAL_1:21;
              then reconsider m1=ma-1 as Element of NAT by INT_1:18;
                  1<=len g1 by A14,A16,A36,XXREAL_0:2;
              then A866: 1<=m1 by A865,XXREAL_0:2;
              reconsider q=g/.m1 as Point of TOP-REAL 2;
              A867: q`2=ppi`2 & q`1<=pj`1 & q=|[q`1,q`2]| & m1+1=ma
               by A833,A864,A865,EUCLID:57;
              then A868: LSeg(g,m1)=LSeg(q,pj)
               by A859,A862,A866,TOPREAL1:def 5;
              set lq={e where e is Point of TOP-REAL 2: e`2=ppi`2 & q`1<=e`1 &
                      e`1<=pj`1};
               LSeg(g,m1)=lq by A693,A867,A868,TOPREAL3:16;
              then p1 in LSeg(g,m1) & LSeg(g,m1) in lg
                by A854,A859,A863,A866,A867;
              hence x in L~g by A854,TARSKI:def 4;
             end;
             suppose ma<>len g;
              then ma<len g by A858,REAL_1:def 5;
              then A869: ma+1<=len g & k<=ma & ma<=ma+1
                by A16,A36,A858,NAT_1:13,XXREAL_0:2;
              A870: 1<=ma & len g1<=ma+1
                by A14,A16,A36,A858,NAT_1:13;
              reconsider qa=g/.ma, qa1=g/.(ma+1) as Point of TOP-REAL 2;
              A871: qa`1<=p1`1 by A858;
               A872: now assume qa1`1<=p1`1;
                 then for q holds q=g/.(ma+1) implies q`1<=p1`1;
                then ma+1<=ma by A858,A869,A870;
                hence contradiction by REAL_2:174;
               end;
              then A873: qa`1<qa1`1 & qa`1<=p1`1 & p1`1<=qa1`1 &
              qa`2=ppi`2 & qa1 `2 = ppi`2 by A833,A858,A869,A870,A871,
XXREAL_0:2
;
              set lma = {p2: p2`2=ppi`2 & qa`1<=p2`1 & p2`1<=qa1`1};
              A874: qa=|[qa`1,qa`2]| & qa1=|[qa1 `1, qa1 `2]| by EUCLID:57;
                  LSeg(g,ma)=LSeg(qa,qa1) by A869,A870,TOPREAL1:def 5
              .= lma by A873,A874,TOPREAL3:16;
              then x in LSeg(g,ma) & LSeg(g,ma) in lg by A854,A869,A870,A871
,A872;
              hence x in L~g by TARSKI:def 4;
             end;
             end;
            hence x in L~g;
           end;
           end;
          hence x in L~g;
         end;
            1<=len g1 by A14,A16,A36,XXREAL_0:2;
        then 1 in dom g1 by FINSEQ_3:27;
        hence g/.1=f1/.1 by A34,FINSEQ_4:83
        .=f/.1 by A15,A19,FINSEQ_4:86;
            i1+1<=j1 by A680,NAT_1:13;
        then A875: 1<=l by XREAL_1:21;
        then A876: l in dom g2 & len g=len g1 + l by A681,FINSEQ_1:35
,FINSEQ_3:27;
        hence g/.len g=g2/.l by FINSEQ_4:84
        .=G*(i1+l,i2) by A681,A876
        .=f/.len f by A5,A49,A476;
        thus len f<=len g by A5,A16,A36,A875,A876,XREAL_1:9;
       end;
       end;
      hence thesis;
     end;
     end;
    hence thesis;
 end;
 end;
      for k holds P[k] from NAT_1:sch 1(A1,A3);
 hence thesis;
end;

theorem
    (for n st n in dom f ex i,j st [i,j] in Indices G &
f/.n=G*(i,j)) & f is_S-Seq implies
ex g st g is_sequence_on G & g is_S-Seq & L~f = L~g & f/.1 = g/.1 &
        f/.len f = g/.len g & len f<=len g
 proof assume that
  A1: for n st n in dom f ex i,j st [i,j] in Indices G & f/.n=G*(i,j) and
  A2: f is_S-Seq;
  A3: f is one-to-one & 2<=len f & f is unfolded s.n.c. special
         by A2,TOPREAL1:def 10;
  then consider g such that
  A4: g is_sequence_on G and
  A5: g is one-to-one unfolded s.n.c. special &
  L~f = L~g & f/.1 = g/.1 & f/.len f = g/.len g & len f <= len g by A1,Th1;
  take g;
  thus g is_sequence_on G by A4;
      2<=len g by A3,A5,XXREAL_0:2;
  hence g is_S-Seq by A5,TOPREAL1:def 10;
  thus thesis by A5;
 end;
