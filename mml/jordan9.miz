:: Cages, external aproximation of Jordan's curve
::  by Czes{\l}aw Byli\'nski and Mariusz \.Zynel
::
:: Received June 22, 1999
:: Copyright (c) 1999 Association of Mizar Users

environ

 vocabularies FINSEQ_1, BOOLE, PRE_TOPC, RELAT_2, CONNSP_1, RELAT_1, FINSEQ_5,
      ARYTM_1, GOBOARD1, EUCLID, MATRIX_1, ABSVALUE, GOBRD13, FUNCT_1,
      TOPREAL1, RFINSEQ, GOBOARD5, TOPS_1, TREES_1, SPPOL_1, MCART_1, TARSKI,
      SUBSET_1, SEQM_3, GOBOARD9, COMPTS_1, JORDAN8, PSCOMP_1, GROUP_1,
      ARYTM_3, SPRECT_2, CARD_1, PCOMPS_1, METRIC_1, JORDAN9, FINSEQ_4, ARYTM;
 notations TARSKI, XBOOLE_0, SUBSET_1, GOBOARD5, ORDINAL1, NUMBERS, XREAL_0,
      REAL_1, NAT_1, BINARITH, RELAT_1, FUNCT_1, FUNCT_2, COMPLEX1, CARD_1,
      CARD_4, FINSEQ_1, FINSEQ_2, FINSEQ_4, FINSEQ_5, RFINSEQ, STRUCT_0,
      XXREAL_0, MATRIX_1, METRIC_1, PRE_TOPC, TOPS_1, COMPTS_1, CONNSP_1,
      PCOMPS_1, EUCLID, TOPREAL1, GOBOARD1, SPPOL_1, PSCOMP_1, SPRECT_2,
      GOBOARD9, JORDAN8, GOBRD13;
 constructors REAL_1, FINSEQ_4, CARD_4, RFINSEQ, BINARITH, TOPS_1, CONNSP_1,
      COMPTS_1, SPPOL_1, PSCOMP_1, REALSET2, SPRECT_2, GOBOARD9, JORDAN8,
      GOBRD13, NAT_1, SETFAM_1, XXREAL_0;
 registrations PSCOMP_1, RELSET_1, FINSEQ_1, SPPOL_2, REVROT_1, SPRECT_1,
      SPRECT_2, XREAL_0, GOBOARD9, JORDAN8, GOBRD13, EUCLID, NAT_1, MEMBERED,
      XXREAL_0;
 requirements REAL, NUMERALS, SUBSET, BOOLE, ARITHM;
 definitions TARSKI, GOBOARD1, GOBOARD5, GOBRD13, XBOOLE_0, PSCOMP_1;
 theorems NAT_1, FINSEQ_1, GOBOARD1, FINSEQ_4, EUCLID, FINSEQ_3, REAL_1,
      REAL_2, HEINE, SPPOL_2, TARSKI, JORDAN3, PSCOMP_1, FINSEQ_5, FINSEQ_6,
      CQC_THE1, GOBOARD7, TOPREAL1, BINARITH, JORDAN5B, GOBOARD5, SPRECT_2,
      SPPOL_1, ABSVALUE, FUNCT_1, FUNCT_2, GOBOARD9, RELAT_1, FINSEQ_2,
      UNIFORM1, SUBSET_1, GOBRD11, JORDAN4, GOBOARD2, SPRECT_3, CARD_1,
      RFINSEQ, GOBOARD6, TOPREAL3, TOPMETR, TOPS_1, JORDAN8, GOBRD13, SPRECT_4,
      CONNSP_1, PARTFUN2, RELSET_1, SPRECT_1, XBOOLE_0, XBOOLE_1, XREAL_0,
      XCMPLX_1, XREAL_1, NEWTON, XXREAL_0;
 schemes NAT_1, LATTICE5;

begin :: Generalities

reserve i,j,k,n for Nat,
  D for non empty set,
  f, g for FinSequence of D;

Lm1: for n st 1 <= n holds n-'1+2 = n+1
proof
  let n;
  assume 1 <= n;
  hence n-'1+2 = n+2-'1 by BINARITH:56
            .= n+1+1 - 1 by BINARITH:55
            .= n+1;
end;

canceled 2;

theorem Th3:
  for T being non empty TopSpace
  for B,C1,C2,D being Subset of T st B is connected & C1 is_a_component_of D &
    C2 is_a_component_of D & B meets C1 & B meets C2 & B c= D
    holds C1 = C2
proof
  let T be non empty TopSpace;
  let B,C1,C2,D be Subset of T;
  assume that
A1:  B is connected and
A2:  C1 is_a_component_of D and
A3:  C2 is_a_component_of D and
A4:  B meets C1 and
A5:  B meets C2 and
A6:  B c= D;
A7:  B c= C1 by A1,A2,A4,A6,GOBOARD9:6;
A8:  B c= C2 by A1,A3,A5,A6,GOBOARD9:6;
     B <> {} by A4,XBOOLE_1:65;
 then C1 meets C2 by A7,A8,XBOOLE_1:68;
 hence C1 = C2 by A2,A3,GOBOARD9:3;
end;

theorem Th4:
  (for n holds f|n = g|n) implies f = g
proof
  assume
A1:  for n holds f|n = g|n;
A2: now assume
A3:  len f <> len g;
   per cases by A3,REAL_1:def 5;
    suppose
A4:    len f < len g;
      then f|len g = f & g|len g = g by FINSEQ_1:79;
     hence contradiction by A1,A4;
    end;
    suppose
A5:    len g < len f;
      then f|len f = f & g|len f = g by FINSEQ_1:79;
     hence contradiction by A1,A5;
  end;
  end;
     f|len f = f & g|len g = g by FINSEQ_1:79;
 hence thesis by A1,A2;
end;

theorem Th5:
  n in dom f implies
   ex k st k in dom Rev f & n+k = len f+1 & f/.n = (Rev f)/.k
proof
  assume
A1: n in dom f;
  then A2: 1 <= n & n <= len f by FINSEQ_3:27;
    take k = len f+1-'n;
        n <= len f+1 by A2,SPPOL_1:5;
  then A3: k+n = len f+1 by BINARITH:53;
  then A4: k+n-'1 = len f by BINARITH:39;
        n+1 <= len f+1 by A2,XREAL_1:8;
  then A5: 1 <= k by SPRECT_3:8;
        k+1 <= k+n by A2,XREAL_1:8;
    then k+1-'1 <= k+n -'1 by JORDAN3:5;
    then k <= len f by A4,BINARITH:39;
    then k in dom f by A5,FINSEQ_3:27;
    hence thesis by A1,A3,FINSEQ_5:60,69;
end;

theorem Th6:
  n in dom Rev f implies
   ex k st k in dom f & n+k = len f+1 & (Rev f)/.n = f/.k
proof
  assume
      n in dom Rev f;
  then n in dom f by FINSEQ_5:60;
  then consider k such that
A1: k in dom Rev f and
A2: n+k = len f+1 and
        f/.n = (Rev f)/.k by Th5;
A3: len f = len Rev f & dom f = dom Rev f by FINSEQ_5:60,def 3;
  then (Rev f)/.n = f/.k by A1,A2,FINSEQ_5:69;
  hence thesis by A1,A2,A3;
end;

begin :: Go-board preliminaries

reserve G for Go-board,
  f, g for FinSequence of TOP-REAL 2,
  p for Point of TOP-REAL 2,
  r, s for Real,
  x for set;

theorem Th7:
  for D being non empty set
  for G being Matrix of D
  for f being FinSequence of D holds
  f is_sequence_on G iff Rev f is_sequence_on G
proof
  let D be non empty set;
  let G be Matrix of D;
  let f be FinSequence of D;
  hereby
    assume
  A1: f is_sequence_on G;
  A2:for n st n in dom Rev f ex i,j st [i,j] in
 Indices G & (Rev f)/.n = G*(i,j)
  proof
    let n;
    assume n in dom Rev f;
    then consider k such that
  A3: k in dom f and
          n+k = len f+1 and
  A4: (Rev f)/.n = f/.k by Th6;
    consider i,j such that
  A5: [i,j] in Indices G and
  A6: f/.k = G*(i,j) by A1,A3,GOBOARD1:def 11;
    take i,j;
    thus thesis by A4,A5,A6;
  end;
      for n st n in dom Rev f & n+1 in dom Rev f holds
    for m,k,i,j being Nat st [m,k] in Indices G & [i,j] in Indices G &
                     (Rev f)/.n = G*(m,k) & (Rev f)/.(n+1) = G*(i,j) holds
      abs(m-i)+abs(k-j) = 1
  proof
    let n such that
  A7: n in dom Rev f and
  A8: n+1 in dom Rev f;
    let m,k,i,j be Nat such that
  A9: [m,k] in Indices G and
  A10: [i,j] in Indices G and
  A11: (Rev f)/.n = G*(m,k) and
  A12: (Rev f)/.(n+1) = G*(i,j);
    consider l being Nat such that
  A13: l in dom f and
  A14: n+l = len f+1 and
  A15: (Rev f)/.n = f/.l by A7,Th6;
    consider l' being Nat such that
  A16: l' in dom f and
  A17: n+1+l' = len f+1 and
  A18: (Rev f)/.(n+1) = f/.l' by A8,Th6;
        n+(1+l') = n+l by A14,A17;
then A19: l'+1 = l;
        abs(i-m) = abs(m-i) & abs(j-k) = abs(k-j) by UNIFORM1:13;
    hence abs(m-i)+abs(k-j) = 1
            by A1,A9,A10,A11,A12,A13,A15,A16,A18,A19,GOBOARD1:def 11;
  end;
    hence Rev f is_sequence_on G by A2,GOBOARD1:def 11;
  end;
  assume
A20: Rev f is_sequence_on G;
  A21:for n st n in dom f ex i,j st [i,j] in Indices G & f/.n = G*(i,j)
  proof
    let n;
    assume n in dom f;
    then consider k such that
  A22: k in dom Rev f and
          n+k = len f+1 and
  A23: f/.n = (Rev f)/.k by Th5;
    consider i,j such that
  A24: [i,j] in Indices G and
  A25: (Rev f)/.k = G*(i,j) by A20,A22,GOBOARD1:def 11;
    take i,j;
    thus thesis by A23,A24,A25;
  end;

      for n st n in dom f & n+1 in dom f holds
    for m,k,i,j being Nat st [m,k] in Indices G & [i,j] in Indices G &
                     f/.n = G*(m,k) & f/.(n+1) = G*(i,j) holds
      abs(m-i)+abs(k-j) = 1
  proof
    let n such that
  A26: n in dom f and
  A27: n+1 in dom f;
    let m,k,i,j be Nat such that
  A28: [m,k] in Indices G and
  A29: [i,j] in Indices G and
  A30: f/.n = G*(m,k) and
  A31: f/.(n+1) = G*(i,j);
    consider l being Nat such that
  A32: l in dom Rev f and
  A33: n+l = len f+1 and
  A34: f/.n = (Rev f)/.l by A26,Th5;

    consider l' being Nat such that
  A35: l' in dom Rev f and
  A36: n+1+l' = len f+1 and
  A37: f/.(n+1) = (Rev f)/.l' by A27,Th5;
        n+(1+l') = n+l by A33,A36;
then A38: l'+1 = l;
        abs(i-m) = abs(m-i) & abs(j-k) = abs(k-j) by UNIFORM1:13;
    hence abs(m-i)+abs(k-j) = 1
        by A20,A28,A29,A30,A31,A32,A34,A35,A37,A38,GOBOARD1:def 11;
  end;
  hence f is_sequence_on G by A21,GOBOARD1:def 11;
end;

theorem Th8:
  for G being Matrix of TOP-REAL 2
  for f being FinSequence of TOP-REAL 2 holds
  f is_sequence_on G & 1 <= k & k <= len f implies f/.k in Values G
proof
  let G be Matrix of TOP-REAL 2;
  let f be FinSequence of TOP-REAL 2;
  assume that
A1: f is_sequence_on G and
A2: 1 <= k and
A3: k <= len f;
A4: k in dom f by A2,A3,FINSEQ_3:27;
  then f/.k = f.k by FINSEQ_4:def 4;
then A5: f/.k in rng f by A4,FUNCT_1:def 5;
      rng f c= Values G by A1,GOBRD13:9;
  hence f/.k in Values G by A5;
end;

Lm2:
  f is_sequence_on G & 1 <= k & k <= len f implies
   ex i,j being Nat st [i,j] in Indices G & f/.k = G*(i,j)
proof
  assume that
A1: f is_sequence_on G and
A2: 1 <= k & k <= len f;
      k in dom f by A2,FINSEQ_3:27;
  then consider i,j such that
A3: [i,j] in Indices G & f/.k = G*(i,j) by A1,GOBOARD1:def 11;
   take i,j;
   thus thesis by A3;
end;

theorem Th9:
  n <= len f & x in L~(f/^n)
    implies
   ex i being Nat st n+1 <= i & i+1 <= len f & x in LSeg(f,i)
proof
  assume that
A1: n <= len f and
A2: x in L~(f/^n);
  consider j such that
A3: 1 <= j and
A4: j+1 <= len(f/^n) and
A5: x in LSeg(f/^n,j) by A2,SPPOL_2:13;
A6:  j+1 <= len f - n by A1,A4,RFINSEQ:def 2;
  take n+j;
      j+1 <= len f - n by A1,A4,RFINSEQ:def 2;
  then n+(j+1) <= len f by XREAL_1:21;
  hence thesis by A3,A5,A6,XREAL_1:8,SPPOL_2:5;
end;

theorem Th10:
  f is_sequence_on G & 1 <= k & k+1 <= len f
    implies
   f/.k in left_cell(f,k,G) & f/.k in right_cell(f,k,G)
proof
  assume that
A1: f is_sequence_on G and
A2: 1 <= k & k+1 <= len f;
  set p = f/.k;
      LSeg(f,k) = LSeg(f/.k, f/.(k+1)) by A2,TOPREAL1:def 5;
  then p in LSeg(f,k) by TOPREAL1:6;
  then p in left_cell(f,k,G) /\ right_cell(f,k,G) by A1,A2,GOBRD13:30;
  hence thesis by XBOOLE_0:def 3;
end;

theorem Th11:
  f is_sequence_on G & 1 <= k & k+1 <= len f
    implies
   Int left_cell(f,k,G) <> {} & Int right_cell(f,k,G) <> {}
proof
  assume that
A1: f is_sequence_on G and
A2: 1 <= k and
A3: k+1 <= len f;

  consider i1,j1,i2,j2 being Nat such that
A4: [i1,j1] in Indices G and
A5: f/.k = G*(i1,j1) and
A6: [i2,j2] in Indices G and
A7: f/.(k+1) = G*(i2,j2) and
A8: i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
      i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A1,A2,A3,JORDAN8:6;

A9: i1+1 > i1 & j1+1 > j1 & i2+1 > i2 & j2+1 > j2 by NAT_1:38;
A10: i1 <= len G & j1 <= width G by A4,GOBOARD5:1;
A11: i2 <= len G & j2 <= width G by A6,GOBOARD5:1;
A12: i1-'1 <= len G & j1-'1 <= width G by A10,JORDAN3:7;
A13: i2-'1 <= len G & j2-'1 <= width G by A11,JORDAN3:7;

  per cases by A8;
  suppose
  A14: i1 = i2 & j1+1 = j2;
  then A15: right_cell(f,k,G) = cell(G,i1,j1)
       by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
        left_cell(f,k,G) = cell(G,i1-'1,j1)
       by A1,A2,A3,A4,A5,A6,A7,A9,A14,GOBRD13:def 3;
    hence thesis by A10,A12,A15,GOBOARD9:17;

  end;
  suppose
  A16: i1+1 = i2 & j1 = j2;
  then A17: right_cell(f,k,G) = cell(G,i1,j1-'1)
        by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
        left_cell(f,k,G) = cell(G,i1,j1)
        by A1,A2,A3,A4,A5,A6,A7,A9,A16,GOBRD13:def 3;
    hence thesis by A10,A12,A17,GOBOARD9:17;

  end;
  suppose
  A18: i1 = i2+1 & j1 = j2;
  then A19: right_cell(f,k,G) = cell(G,i2,j2)
        by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
        left_cell(f,k,G) = cell(G,i2,j2-'1)
        by A1,A2,A3,A4,A5,A6,A7,A9,A18,GOBRD13:def 3;
    hence thesis by A11,A13,A19,GOBOARD9:17;

  end;
  suppose
  A20: i1 = i2 & j1 = j2+1;
  then A21: right_cell(f,k,G) = cell(G,i1-'1,j2)
        by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
        left_cell(f,k,G) = cell(G,i1,j2)
        by A1,A2,A3,A4,A5,A6,A7,A9,A20,GOBRD13:def 3;
    hence thesis by A10,A11,A12,A21,GOBOARD9:17;
end;
end;

theorem Th12:
  f is_sequence_on G & 1 <= k & k+1 <= len f
    implies
   Int left_cell(f,k,G) is connected & Int right_cell(f,k,G) is connected
proof
  assume that
A1: f is_sequence_on G and
A2: 1 <= k and
A3: k+1 <= len f;

  consider i1,j1,i2,j2 being Nat such that
A4: [i1,j1] in Indices G and
A5: f/.k = G*(i1,j1) and
A6: [i2,j2] in Indices G and
A7: f/.(k+1) = G*(i2,j2) and
A8: i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
      i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A1,A2,A3,JORDAN8:6;

A9: i1+1 > i1 & j1+1 > j1 & i2+1 > i2 & j2+1 > j2 by NAT_1:38;
A10: i1 <= len G & j1 <= width G by A4,GOBOARD5:1;
A11: i2 <= len G & j2 <= width G by A6,GOBOARD5:1;
A12: i1-'1 <= len G & j1-'1 <= width G by A10,JORDAN3:7;
A13: i2-'1 <= len G & j2-'1 <= width G by A11,JORDAN3:7;

  per cases by A8;
  suppose
  A14: i1 = i2 & j1+1 = j2;
  then A15: right_cell(f,k,G) = cell(G,i1,j1)
       by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
        left_cell(f,k,G) = cell(G,i1-'1,j1)
       by A1,A2,A3,A4,A5,A6,A7,A9,A14,GOBRD13:def 3;
    hence thesis by A10,A12,A15,GOBOARD9:21;

  end;
  suppose
  A16: i1+1 = i2 & j1 = j2;
  then A17: right_cell(f,k,G) = cell(G,i1,j1-'1)
        by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
        left_cell(f,k,G) = cell(G,i1,j1)
        by A1,A2,A3,A4,A5,A6,A7,A9,A16,GOBRD13:def 3;
    hence thesis by A10,A12,A17,GOBOARD9:21;

  end;
  suppose
  A18: i1 = i2+1 & j1 = j2;
  then A19: right_cell(f,k,G) = cell(G,i2,j2)
        by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
        left_cell(f,k,G) = cell(G,i2,j2-'1)
        by A1,A2,A3,A4,A5,A6,A7,A9,A18,GOBRD13:def 3;
    hence thesis by A11,A13,A19,GOBOARD9:21;

  end;
  suppose
  A20: i1 = i2 & j1 = j2+1;
  then A21: right_cell(f,k,G) = cell(G,i1-'1,j2)
        by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
        left_cell(f,k,G) = cell(G,i1,j2)
        by A1,A2,A3,A4,A5,A6,A7,A9,A20,GOBRD13:def 3;
    hence thesis by A10,A11,A12,A21,GOBOARD9:21;
end;
end;

theorem Th13:
  f is_sequence_on G & 1 <= k & k+1 <= len f
    implies
   Cl Int left_cell(f,k,G) = left_cell(f,k,G) &
     Cl Int right_cell(f,k,G) = right_cell(f,k,G)
proof
  assume that
A1: f is_sequence_on G and
A2: 1 <= k and
A3: k+1 <= len f;

  consider i1,j1,i2,j2 being Nat such that
A4: [i1,j1] in Indices G and
A5: f/.k = G*(i1,j1) and
A6: [i2,j2] in Indices G and
A7: f/.(k+1) = G*(i2,j2) and
A8: i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
      i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A1,A2,A3,JORDAN8:6;

A9: i1+1 > i1 & j1+1 > j1 & i2+1 > i2 & j2+1 > j2 by NAT_1:38;
A10: i1 <= len G & j1 <= width G by A4,GOBOARD5:1;
A11: i2 <= len G & j2 <= width G by A6,GOBOARD5:1;
A12: i1-'1 <= len G & j1-'1 <= width G by A10,JORDAN3:7;
A13: i2-'1 <= len G & j2-'1 <= width G by A11,JORDAN3:7;

  per cases by A8;
  suppose
  A14: i1 = i2 & j1+1 = j2;
  then A15: right_cell(f,k,G) = cell(G,i1,j1)
       by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
        left_cell(f,k,G) = cell(G,i1-'1,j1)
       by A1,A2,A3,A4,A5,A6,A7,A9,A14,GOBRD13:def 3;
    hence thesis by A10,A12,A15,GOBRD11:35;

  end;
  suppose
  A16: i1+1 = i2 & j1 = j2;
  then A17: right_cell(f,k,G) = cell(G,i1,j1-'1)
        by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
        left_cell(f,k,G) = cell(G,i1,j1)
        by A1,A2,A3,A4,A5,A6,A7,A9,A16,GOBRD13:def 3;
    hence thesis by A10,A12,A17,GOBRD11:35;

  end;
  suppose
  A18: i1 = i2+1 & j1 = j2;
  then A19: right_cell(f,k,G) = cell(G,i2,j2)
        by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
        left_cell(f,k,G) = cell(G,i2,j2-'1)
        by A1,A2,A3,A4,A5,A6,A7,A9,A18,GOBRD13:def 3;
    hence thesis by A11,A13,A19,GOBRD11:35;

  end;
  suppose
  A20: i1 = i2 & j1 = j2+1;
  then A21: right_cell(f,k,G) = cell(G,i1-'1,j2)
        by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
        left_cell(f,k,G) = cell(G,i1,j2)
        by A1,A2,A3,A4,A5,A6,A7,A9,A20,GOBRD13:def 3;
    hence thesis by A10,A11,A12,A21,GOBRD11:35;
end;
end;

theorem Th14:
  f is_sequence_on G & LSeg(f,k) is horizontal
    implies
   ex j st 1 <= j & j <= width G & for p st p in
 LSeg(f,k) holds p`2 = G*(1,j)`2
proof
  assume that
A1: f is_sequence_on G and
A2: LSeg(f,k) is horizontal;
 per cases;
 suppose
A3: 1 <= k & k+1 <= len f;
      k <= k+1 by NAT_1:29;
  then k <= len f by A3,XXREAL_0:2;
  then consider i,j such that
A4: [i,j] in Indices G and
A5: f/.k = G*(i,j) by A1,A3,Lm2;
 take j;
 thus
A6: 1 <= j & j <= width G by A4,GOBOARD5:1;
 let p;
A7: 1 <= i & i <= len G by A4,GOBOARD5:1;
A8: f/.k in LSeg(f,k) by A3,TOPREAL1:27;
 assume p in LSeg(f,k);
 hence p`2 = (f/.k)`2 by A2,A8,SPPOL_1:def 2
          .= G*(1,j)`2 by A5,A6,A7,GOBOARD5:2;
 end;
 suppose
A9: not(1 <= k & k+1 <= len f);
 take 1;
      width G <> 0 by GOBOARD1:def 5;
 hence 1 <= 1 & 1 <= width G by NAT_1:39;
 thus thesis by A9,TOPREAL1:def 5;
end;
end;

theorem Th15:
  f is_sequence_on G & LSeg(f,k) is vertical
    implies
   ex i st 1 <= i & i <= len G & for p st p in LSeg(f,k) holds p`1 = G*(i,1)`1
proof
  assume that
A1: f is_sequence_on G and
A2: LSeg(f,k) is vertical;
 per cases;
 suppose
A3: 1 <= k & k+1 <= len f;
      k <= k+1 by NAT_1:29;
  then k <= len f by A3,XXREAL_0:2;
  then consider i,j such that
A4: [i,j] in Indices G and
A5: f/.k = G*(i,j) by A1,A3,Lm2;
 take i;
 thus
A6: 1 <= i & i <= len G by A4,GOBOARD5:1;
 let p;
A7: 1 <= j & j <= width G by A4,GOBOARD5:1;
A8: f/.k in LSeg(f,k) by A3,TOPREAL1:27;
 assume p in LSeg(f,k);
 hence p`1 = (f/.k)`1 by A2,A8,SPPOL_1:def 3
          .= G*(i,1)`1 by A5,A6,A7,GOBOARD5:3;
 end;
 suppose
A9: not(1 <= k & k+1 <= len f);
 take 1;
      0 <> len G by GOBOARD1:def 5;
 hence 1 <= 1 & 1 <= len G by NAT_1:39;
 thus thesis by A9,TOPREAL1:def 5;
end;
end;

theorem Th16:
  f is_sequence_on G & f is special & i <= len G & j <= width G
    implies
   Int cell(G,i,j) misses L~f
proof
  assume that
A1: f is_sequence_on G and
A2: f is special and
A3: i <= len G and
A4: j <= width G;
 assume Int cell(G,i,j) meets L~f;
 then consider x being set such that
A5: x in Int cell(G,i,j) and
A6: x in L~f by XBOOLE_0:3;
      L~f = union { LSeg(f,k) : 1 <= k & k+1 <= len f } by TOPREAL1:def 6;
  then consider X being set such that
A7: x in X and
A8: X in { LSeg(f,k) : 1 <= k & k+1 <= len f } by A6,TARSKI:def 4;
  consider k such that
A9: X = LSeg(f,k) and
        1 <= k & k+1 <= len f by A8;
  reconsider p = x as Point of TOP-REAL 2 by A7,A9;
A10: Int cell(G,i,j)
           = Int(v_strip(G,i) /\ h_strip(G,j))
          .= Int v_strip(G,i) /\ Int h_strip(G,j) by TOPS_1:46;
 per cases by A2,SPPOL_1:41;
 suppose LSeg(f,k) is horizontal;
  then consider j0 being Nat such that
A11: 1 <= j0 & j0 <= width G and
A12: for p being Point of TOP-REAL 2
       st p in LSeg(f,k) holds p`2 = G*(1,j0)`2 by A1,Th14;
       now assume
A13: p in Int h_strip(G,j);
A14: j0 > j implies j0 >= j+1 by NAT_1:38;
    per cases by A14,REAL_1:def 5;
    suppose
A15:    j0 < j;
      then j >= 1 by A11,XXREAL_0:2;
      then A16:    p`2 > G*(1,j)`2 by A4,A13,GOBOARD6:30;
          0 <> len G by GOBOARD1:def 5;
      then 1 <= len G by NAT_1:39;
      then G*(1,j)`2 > G*(1,j0)`2 by A4,A11,A15,GOBOARD5:5;
     hence contradiction by A7,A9,A12,A16;
    end;
    suppose j0 = j;
      then p`2 > G*(1,j0)`2 by A11,A13,GOBOARD6:30;
     hence contradiction by A7,A9,A12;
    end;
    suppose
A17:    j0 > j+1;
      then j+1 <= width G by A11,XXREAL_0:2;
      then j < width G by NAT_1:38;
      then A18:    p`2 < G*(1,j+1)`2 by A13,GOBOARD6:31;
          0 <> len G by GOBOARD1:def 5;
      then 1 <= len G & j+1 >= 1 by NAT_1:39;
      then G*(1,j+1)`2 < G*(1,j0)`2 by A11,A17,GOBOARD5:5;
     hence contradiction by A7,A9,A12,A18;
    end;
    suppose
A19:   j0 = j+1;
      then j < width G by A11,NAT_1:38;
      then p`2 < G*(1,j0)`2 by A13,A19,GOBOARD6:31;
     hence contradiction by A7,A9,A12;
   end;
   end;
 hence contradiction by A5,A10,XBOOLE_0:def 3;
 end;
 suppose LSeg(f,k) is vertical;
  then consider i0 being Nat such that
A20: 1 <= i0 & i0 <= len G and
A21: for p being Point of TOP-REAL 2
  st p in LSeg(f,k) holds p`1 = G*(i0,1)`1 by A1,Th15;
       now assume
A22: p in Int v_strip(G,i);
A23: i0 > i implies i0 >= i+1 by NAT_1:38;
    per cases by A23,REAL_1:def 5;
    suppose
A24:    i0 < i;
      then i >= 1 by A20,XXREAL_0:2;
      then A25:    p`1 > G*(i,1)`1 by A3,A22,GOBOARD6:32;
          0 <> width G by GOBOARD1:def 5;
      then 1 <= width G by NAT_1:39;
      then G*(i,1)`1 > G*(i0,1)`1 by A3,A20,A24,GOBOARD5:4;
     hence contradiction by A7,A9,A21,A25;
    end;
    suppose i0 = i;
      then p`1 > G*(i0,1)`1 by A20,A22,GOBOARD6:32;
     hence contradiction by A7,A9,A21;
    end;
    suppose
A26:    i0 > i+1;
      then i+1 <= len G by A20,XXREAL_0:2;
      then i < len G by NAT_1:38;
      then A27:    p`1 < G*(i+1,1)`1 by A22,GOBOARD6:33;
          0 <> width G by GOBOARD1:def 5;
      then 1 <= width G & i+1 >= 1 by NAT_1:39;
      then G*(i+1,1)`1 < G*(i0,1)`1 by A20,A26,GOBOARD5:4;
     hence contradiction by A7,A9,A21,A27;
    end;
    suppose
A28:   i0 = i+1;
      then i < len G by A20,NAT_1:38;
      then p`1 < G*(i0,1)`1 by A22,A28,GOBOARD6:33;
     hence contradiction by A7,A9,A21;
   end;
   end;
 hence contradiction by A5,A10,XBOOLE_0:def 3;
end;
end;

theorem Th17:
  f is_sequence_on G & f is special & 1 <= k & k+1 <= len f
    implies
   Int left_cell(f,k,G) misses L~f & Int right_cell(f,k,G) misses L~f
proof
  assume that
A1: f is_sequence_on G & f is special and
A2: 1 <= k and
A3: k+1 <= len f;

  consider i1,j1,i2,j2 being Nat such that
A4: [i1,j1] in Indices G and
A5: f/.k = G*(i1,j1) and
A6: [i2,j2] in Indices G and
A7: f/.(k+1) = G*(i2,j2) and
A8: i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
      i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A1,A2,A3,JORDAN8:6;

A9: i1+1 > i1 & j1+1 > j1 & i2+1 > i2 & j2+1 > j2 by NAT_1:38;
A10: i1 <= len G & j1 <= width G by A4,GOBOARD5:1;
A11: i2 <= len G & j2 <= width G by A6,GOBOARD5:1;
A12: i1-'1 <= len G & j1-'1 <= width G by A10,JORDAN3:7;
A13: i2-'1 <= len G & j2-'1 <= width G by A11,JORDAN3:7;

  per cases by A8;
  suppose
  A14: i1 = i2 & j1+1 = j2;
  then A15: right_cell(f,k,G) = cell(G,i1,j1)
       by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
        left_cell(f,k,G) = cell(G,i1-'1,j1)
       by A1,A2,A3,A4,A5,A6,A7,A9,A14,GOBRD13:def 3;
    hence thesis by A1,A10,A12,A15,Th16;

  end;
  suppose
  A16: i1+1 = i2 & j1 = j2;
  then A17: right_cell(f,k,G) = cell(G,i1,j1-'1)
        by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
        left_cell(f,k,G) = cell(G,i1,j1)
        by A1,A2,A3,A4,A5,A6,A7,A9,A16,GOBRD13:def 3;
    hence thesis by A1,A10,A12,A17,Th16;

  end;
  suppose
  A18: i1 = i2+1 & j1 = j2;
  then A19: right_cell(f,k,G) = cell(G,i2,j2)
        by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
        left_cell(f,k,G) = cell(G,i2,j2-'1)
        by A1,A2,A3,A4,A5,A6,A7,A9,A18,GOBRD13:def 3;
    hence thesis by A1,A11,A13,A19,Th16;

  end;
  suppose
  A20: i1 = i2 & j1 = j2+1;
  then A21: right_cell(f,k,G) = cell(G,i1-'1,j2)
        by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
        left_cell(f,k,G) = cell(G,i1,j2)
        by A1,A2,A3,A4,A5,A6,A7,A9,A20,GOBRD13:def 3;
    hence thesis by A1,A10,A11,A12,A21,Th16;
end;
end;

theorem Th18:
  1 <= i & i+1 <= len G & 1 <= j & j+1 <= width G
    implies
   G*(i,j)`1 = G*(i,j+1)`1 & G*(i,j)`2 = G*(i+1,j)`2 &
     G*(i+1,j+1)`1 = G*(i+1,j)`1 & G*(i+1,j+1)`2 = G*(i,j+1)`2
proof
  assume that
A1: 1 <= i and
A2: i+1 <= len G and
A3: 1 <= j and
A4: j+1 <= width G;

A5: i < len G by A2,NAT_1:38;
A6: j < width G by A4,NAT_1:38;
A7: 1 <= i+1 by NAT_1:29;
A8: 1 <= j+1 by NAT_1:29;
  thus G*(i,j)`1 = G*(i,1)`1 by A1,A3,A5,A6,GOBOARD5:3
                .= G*(i,j+1)`1 by A1,A4,A5,A8,GOBOARD5:3;
  thus G*(i,j)`2 = G*(1,j)`2 by A1,A3,A5,A6,GOBOARD5:2
                .= G*(i+1,j)`2 by A2,A3,A6,A7,GOBOARD5:2;
  thus G*(i+1,j+1)`1 = G*(i+1,1)`1 by A2,A4,A7,A8,GOBOARD5:3
                    .= G*(i+1,j)`1 by A2,A3,A6,A7,GOBOARD5:3;
  thus G*(i+1,j+1)`2 = G*(1,j+1)`2 by A2,A4,A7,A8,GOBOARD5:2
                    .= G*(i,j+1)`2 by A1,A4,A5,A8,GOBOARD5:2;
end;

theorem Th19:
  for i,j being Nat st 1 <= i & i+1 <= len G & 1 <= j & j+1 <= width G
    holds
   p in cell(G,i,j) iff
     G*(i,j)`1 <= p`1 & p`1 <= G*(i+1,j)`1 & G*(i,j)`2 <= p`2 & p`2 <=
 G*(i,j+1)`2
proof
  let i,j be Nat such that
A1: 1 <= i & i+1 <= len G and
A2: 1 <= j & j+1 <= width G;

A3: i < len G by A1,NAT_1:38;
A4: j < width G by A2,NAT_1:38;
then A5: v_strip(G,i) = { |[r,s]| : G*(i,j)`1 <= r & r <= G*(i+1,j)`1 } by A1
,A2,A3,GOBOARD5:9;
A6: h_strip(G,j) = { |[r,s]| : G*(i,j)`2 <= s & s <= G*(i,j+1)`2 } by A1,A2,A3
,A4,GOBOARD5:6;
  hereby
    assume p in cell(G,i,j);
    then p in v_strip(G,i) /\ h_strip(G,j);
  then A7: p in v_strip(G,i) & p in h_strip(G,j) by XBOOLE_0:def 3;
     then ex r,s st |[r,s]| = p & G*(i,j)`1 <= r & r <= G*(i+1,j)`1 by A5;
    hence G*(i,j)`1 <= p`1 & p`1 <= G*(i+1,j)`1 by EUCLID:56;
         ex r,s st |[r,s]| = p & G*(i,j)`2 <= s & s <= G*(i,j+1)`2 by A6,A7;
    hence G*(i,j)`2 <= p`2 & p`2 <= G*(i,j+1)`2 by EUCLID:56;
  end;
  assume that
A8: G*(i,j)`1 <= p`1 & p`1 <= G*(i+1,j)`1 and
A9: G*(i,j)`2 <= p`2 & p`2 <= G*(i,j+1)`2;

A10: p = |[p`1,p`2]| by EUCLID:57;
then A11: p in v_strip(G,i) by A5,A8;
      p in h_strip(G,j) by A6,A9,A10;
  then p in v_strip(G,i) /\ h_strip(G,j) by A11,XBOOLE_0:def 3;
  hence thesis;
end;

theorem
      1 <= i & i+1 <= len G & 1 <= j & j+1 <= width G
    implies
   cell(G,i,j) = { |[r,s]| : G*(i,j)`1 <= r & r <= G*(i+1,j)`1 &
     G*(i,j)`2 <= s & s <= G*(i,j+1)`2 }
proof
  assume that
A1: 1 <= i & i+1 <= len G and
A2: 1 <= j & j+1 <= width G;

  set A = { |[r,s]| : G*(i,j)`1 <= r & r <= G*(i+1,j)`1 &
    G*(i,j)`2 <= s & s <= G*(i,j+1)`2 };

      now
    let p be set;
    assume
  A3: p in cell(G,i,j);
    then reconsider q=p as Point of TOP-REAL 2;
  A4: p = |[q`1,q`2]| by EUCLID:57;
        G*(i,j)`1 <= q`1 & q`1 <= G*(i+1,j)`1 & G*(i,j)`2 <= q`2 & q`2 <=
 G*(i,j+1)`2
      by A1,A2,A3,Th19;
    hence p in A by A4;
  end;
  hence cell(G,i,j) c= A by TARSKI:def 3;

      now
    let p be set;
    assume p in A;
    then consider r,s such that
  A5: |[r,s]| = p and
  A6: G*(i,j)`1 <= r & r <= G*(i+1,j)`1 and
  A7: G*(i,j)`2 <= s & s <= G*(i,j+1)`2;
    reconsider q=p as Point of TOP-REAL 2 by A5;
        r = q`1 & s = q`2 by A5,EUCLID:56;
    hence p in cell(G,i,j) by A1,A2,A6,A7,Th19;
  end;
  hence A c= cell(G,i,j) by TARSKI:def 3;
end;

theorem Th21:
  1 <= i & i+1 <= len G & 1 <= j & j+1 <= width G &
    p in Values G & p in cell(G,i,j)
      implies
   p = G*(i,j) or p = G*(i,j+1) or p = G*(i+1,j+1) or p = G*(i+1,j)
proof
  assume that
A1: 1 <= i and
A2: i+1 <= len G and
A3: 1 <= j and
A4: j+1 <= width G and
A5: p in Values G and
A6: p in cell(G,i,j);

A7: Values G = { G*(k,l) where k,l is Nat: [k,l] in Indices G } by GOBRD13:7;
A8: i < len G by A2,NAT_1:38;
A9: j < width G by A4,NAT_1:38;
A10: 1 <= i+1 by NAT_1:29;
A11: 1 <= j+1 by NAT_1:29;

  consider k,l being Nat such that
A12: p = G*(k,l) and
A13: [k,l] in Indices G by A5,A7;
A14: 1 <= k & k <= len G & 1 <= l & l <= width G by A13,GOBOARD5:1;
A15: now
    assume
A16:  k <> i & k <> i+1;
    per cases by A16,NAT_1:27;
    suppose
          k < i;
      then G*(k,l)`1 < G*(i,l)`1 by A8,A14,GOBOARD5:4;
      then G*(k,l)`1 < G*(i,1)`1 by A1,A8,A14,GOBOARD5:3;
      then G*(k,l)`1 < G*(i,j)`1 by A1,A3,A8,A9,GOBOARD5:3;
      hence contradiction by A1,A2,A3,A4,A6,A12,Th19;
    end;
    suppose
          i+1 < k;
      then G*(i+1,l)`1 < G*(k,l)`1 by A10,A14,GOBOARD5:4;
      then G*(i+1,1)`1 < G*(k,l)`1 by A2,A10,A14,GOBOARD5:3;
      then G*(i+1,j)`1 < G*(k,l)`1 by A2,A3,A9,A10,GOBOARD5:3;
      hence contradiction by A1,A2,A3,A4,A6,A12,Th19;
  end;
  end;
      now
    assume
A17: l <> j & l <> j+1;
    per cases by A17,NAT_1:27;
    suppose
          l < j;
      then G*(k,l)`2 < G*(k,j)`2 by A9,A14,GOBOARD5:5;
      then G*(k,l)`2 < G*(1,j)`2 by A3,A9,A14,GOBOARD5:2;
      then G*(k,l)`2 < G*(i,j)`2 by A1,A3,A8,A9,GOBOARD5:2;
      hence contradiction by A1,A2,A3,A4,A6,A12,Th19;
    end;
    suppose
          j+1 < l;
      then G*(k,j+1)`2 < G*(k,l)`2 by A11,A14,GOBOARD5:5;
      then G*(1,j+1)`2 < G*(k,l)`2 by A4,A11,A14,GOBOARD5:2;
      then G*(i,j+1)`2 < G*(k,l)`2 by A1,A4,A8,A11,GOBOARD5:2;
      hence contradiction by A1,A2,A3,A4,A6,A12,Th19;
  end;
  end;
  hence thesis by A12,A15;
end;

theorem Th22:
  1 <= i & i+1 <= len G & 1 <= j & j+1 <= width G
    implies
   G*(i,j) in cell(G,i,j) & G*(i,j+1) in cell(G,i,j) &
     G*(i+1,j+1) in cell(G,i,j) & G*(i+1,j) in cell(G,i,j)
proof
  assume that
A1: 1 <= i and
A2: i+1 <= len G and
A3: 1 <= j and
A4: j+1 <= width G;
A5: i < i+1 & j < j+1 by NAT_1:38;
A6: i < len G by A2,NAT_1:38;
A7: j < width G by A4,NAT_1:38;

then A8: G*(i,j)`1 <= G*(i+1,j)`1 by A1,A2,A3,A5,GOBOARD5:4;
      G*(i,j)`2 <= G*(i,j+1)`2 by A1,A3,A4,A5,A6,GOBOARD5:5;
  hence G*(i,j) in cell(G,i,j) by A1,A2,A3,A4,A8,Th19;

A9: G*(i,j)`1 = G*(i,j+1)`1 by A1,A2,A3,A4,Th18;
then A10: G*(i,j+1)`1 <= G*(i+1,j)`1 by A1,A2,A3,A5,A7,GOBOARD5:4;
      G*(i,j)`2 <= G*(i,j+1)`2 by A1,A3,A4,A5,A6,GOBOARD5:5;
  hence G*(i,j+1) in cell(G,i,j) by A1,A2,A3,A4,A9,A10,Th19;

A11: G*(i+1,j+1)`1 = G*(i+1,j)`1 by A1,A2,A3,A4,Th18;
then A12: G*(i,j)`1 <= G*(i+1,j+1)`1 by A1,A2,A3,A5,A7,GOBOARD5:4;
A13: G*(i+1,j+1)`2 = G*(i,j+1)`2 by A1,A2,A3,A4,Th18;
  then G*(i,j)`2 <= G*(i+1,j+1)`2 by A1,A3,A4,A5,A6,GOBOARD5:5;
  hence G*(i+1,j+1) in cell(G,i,j) by A1,A2,A3,A4,A11,A12,A13,Th19;

A14: G*(i,j)`1 <= G*(i+1,j)`1 by A1,A2,A3,A5,A7,GOBOARD5:4;
A15: G*(i,j)`2 = G*(i+1,j)`2 by A1,A2,A3,A4,Th18;
  then G*(i+1,j)`2 <= G*(i,j+1)`2 by A1,A3,A4,A5,A6,GOBOARD5:5;
  hence G*(i+1,j) in cell(G,i,j) by A1,A2,A3,A4,A14,A15,Th19;
end;

theorem Th23:
  1 <= i & i+1 <= len G & 1 <= j & j+1 <= width G &
    p in Values G & p in cell(G,i,j)
      implies
   p is_extremal_in cell(G,i,j)
proof
  assume that
A1: 1 <= i and
A2: i+1 <= len G and
A3: 1 <= j and
A4: j+1 <= width G and
A5: p in Values G and
A6: p in cell(G,i,j);
      for a,b being Point of TOP-REAL 2 st p in
 LSeg(a,b) & LSeg(a,b) c= cell(G,i,j)
    holds p = a or p = b
  proof
    let a,b be Point of TOP-REAL 2 such that
  A7: p in LSeg(a,b) and
  A8: LSeg(a,b) c= cell(G,i,j);
    assume
  A9: a <> p & b <> p;
  A10: a in LSeg(a,b) & b in LSeg(a,b) by TOPREAL1:6;
    per cases by A1,A2,A3,A4,A5,A6,Th21;
    suppose
    A11: p = G*(i,j);
    then A12: p`1 <= a`1 & p`2 <= a`2 by A1,A2,A3,A4,A8,A10,Th19;
    A13: p`1 <= b`1 & p`2 <= b`2 by A1,A2,A3,A4,A8,A10,A11,Th19;
          now
        per cases;
        suppose
              a`1 <= b`1 & a`2 <= b`2;
          then a`1 <= p`1 & a`2 <= p`2 by A7,TOPREAL1:9,10;
          then a`1 = p`1 & a`2 = p`2 by A12,REAL_1:def 5;
          hence contradiction by A9,TOPREAL3:11;
        end;
        suppose
              a`1 <= b`1 & b`2 < a`2;
          then a`1 <= p`1 & b`2 <= p`2 by A7,TOPREAL1:9,10;
        then A14: a`1 = p`1 & b`2 = p`2 by A12,A13,REAL_1:def 5;
          then a`2 <> p`2 by A9,TOPREAL3:11;
          then LSeg(a,b) is vertical by A7,A10,A14,SPPOL_1:39;
          then a`1 = b`1 by SPPOL_1:37;
          hence contradiction by A9,A14,TOPREAL3:11;
        end;
        suppose
              b`1 < a`1 & a`2 <= b`2;
          then b`1 <= p`1 & a`2 <= p`2 by A7,TOPREAL1:9,10;
        then A15: b`1 = p`1 & a`2 = p`2 by A12,A13,REAL_1:def 5;
          then b`2 <> p`2 by A9,TOPREAL3:11;
          then LSeg(a,b) is vertical by A7,A10,A15,SPPOL_1:39;
          then a`1 = b`1 by SPPOL_1:37;
          hence contradiction by A9,A15,TOPREAL3:11;
        end;
        suppose
              b`1 < a`1 & b`2 < a`2;
          then b`1 <= p`1 & b`2 <= p`2 by A7,TOPREAL1:9,10;
          then b`1 = p`1 & b`2 = p`2 by A13,REAL_1:def 5;
          hence contradiction by A9,TOPREAL3:11;
      end;
      end;
      hence contradiction;

    end;
    suppose
    A16: p = G*(i,j+1);
    then A17: p`1 = G*(i,j)`1 by A1,A2,A3,A4,Th18;
    then A18: p`1 <= a`1 & a`2 <= p`2 by A1,A2,A3,A4,A8,A10,A16,Th19;
    A19: p`1 <= b`1 & b`2 <= p`2 by A1,A2,A3,A4,A8,A10,A16,A17,Th19;
          now
        per cases;
        suppose
              a`1 <= b`1 & a`2 <= b`2;
          then a`1 <= p`1 & p`2 <= b`2 by A7,TOPREAL1:9,10;
        then A20: a`1 = p`1 & b`2 = p`2 by A18,A19,REAL_1:def 5;
          then a`2 <> p`2 by A9,TOPREAL3:11;
          then LSeg(a,b) is vertical by A7,A10,A20,SPPOL_1:39;
          then a`1 = b`1 by SPPOL_1:37;
          hence contradiction by A9,A20,TOPREAL3:11;
        end;
        suppose
              a`1 <= b`1 & b`2 < a`2;
          then a`1 <= p`1 & p`2 <= a`2 by A7,TOPREAL1:9,10;
          then a`1 = p`1 & a`2 = p`2 by A18,REAL_1:def 5;
          hence contradiction by A9,TOPREAL3:11;
        end;
        suppose
              b`1 < a`1 & a`2 <= b`2;
          then b`1 <= p`1 & p`2 <= b`2 by A7,TOPREAL1:9,10;
          then b`1 = p`1 & b`2 = p`2 by A19,REAL_1:def 5;
          hence contradiction by A9,TOPREAL3:11;
        end;
        suppose
              b`1 < a`1 & b`2 < a`2;
          then b`1 <= p`1 & p`2 <= a`2 by A7,TOPREAL1:9,10;
        then A21: b`1 = p`1 & a`2 = p`2 by A18,A19,REAL_1:def 5;
          then b`2 <> p`2 by A9,TOPREAL3:11;
          then LSeg(a,b) is vertical by A7,A10,A21,SPPOL_1:39;
          then a`1 = b`1 by SPPOL_1:37;
          hence contradiction by A9,A21,TOPREAL3:11;
      end;
      end;
      hence contradiction;

    end;
    suppose
          p = G*(i+1,j+1);
    then A22: p`1 = G*(i+1,j)`1 & p`2 = G*(i,j+1)`2 by A1,A2,A3,A4,Th18;
    then A23: a`1 <= p`1 & a`2 <= p`2 by A1,A2,A3,A4,A8,A10,Th19;
    A24: b`1 <= p`1 & b`2 <= p`2 by A1,A2,A3,A4,A8,A10,A22,Th19;
          now
        per cases;
        suppose
              a`1 <= b`1 & a`2 <= b`2;
          then p`1 <= b`1 & p`2 <= b`2 by A7,TOPREAL1:9,10;
          then b`1 = p`1 & b`2 = p`2 by A24,REAL_1:def 5;
          hence contradiction by A9,TOPREAL3:11;
        end;
        suppose
              a`1 <= b`1 & b`2 < a`2;
          then p`1 <= b`1 & p`2 <= a`2 by A7,TOPREAL1:9,10;
        then A25: b`1 = p`1 & a`2 = p`2 by A23,A24,REAL_1:def 5;
          then b`2 <> p`2 by A9,TOPREAL3:11;
          then LSeg(a,b) is vertical by A7,A10,A25,SPPOL_1:39;
          then a`1 = b`1 by SPPOL_1:37;
          hence contradiction by A9,A25,TOPREAL3:11;
        end;
        suppose
              b`1 < a`1 & a`2 <= b`2;
          then p`1 <= a`1 & p`2 <= b`2 by A7,TOPREAL1:9,10;
        then A26: a`1 = p`1 & b`2 = p`2 by A23,A24,REAL_1:def 5;
          then a`2 <> p`2 by A9,TOPREAL3:11;
          then LSeg(a,b) is vertical by A7,A10,A26,SPPOL_1:39;
          then a`1 = b`1 by SPPOL_1:37;
          hence contradiction by A9,A26,TOPREAL3:11;
        end;
        suppose
              b`1 < a`1 & b`2 < a`2;
          then p`1 <= a`1 & p`2 <= a`2 by A7,TOPREAL1:9,10;
          then a`1 = p`1 & a`2 = p`2 by A23,REAL_1:def 5;
          hence contradiction by A9,TOPREAL3:11;
      end;
      end;
      hence contradiction;
    end;
    suppose
    A27: p = G*(i+1,j);
    then A28: p`2 = G*(i,j)`2 by A1,A2,A3,A4,Th18;
    then A29: a`1 <= p`1 & p`2 <= a`2 by A1,A2,A3,A4,A8,A10,A27,Th19;
    A30: b`1 <= p`1 & p`2 <= b`2 by A1,A2,A3,A4,A8,A10,A27,A28,Th19;
          now
        per cases;
        suppose
              a`1 <= b`1 & a`2 <= b`2;
          then p`1 <= b`1 & a`2 <= p`2 by A7,TOPREAL1:9,10;
        then A31: b`1 = p`1 & a`2 = p`2 by A29,A30,REAL_1:def 5;
          then b`2 <> p`2 by A9,TOPREAL3:11;
          then LSeg(a,b) is vertical by A7,A10,A31,SPPOL_1:39;
          then a`1 = b`1 by SPPOL_1:37;
          hence contradiction by A9,A31,TOPREAL3:11;
        end;
        suppose
              a`1 <= b`1 & b`2 < a`2;
          then p`1 <= b`1 & b`2 <= p`2 by A7,TOPREAL1:9,10;
          then b`1 = p`1 & b`2 = p`2 by A30,REAL_1:def 5;
          hence contradiction by A9,TOPREAL3:11;
        end;
        suppose
              b`1 < a`1 & a`2 <= b`2;
          then p`1 <= a`1 & a`2 <= p`2 by A7,TOPREAL1:9,10;
          then a`1 = p`1 & a`2 = p`2 by A29,REAL_1:def 5;
          hence contradiction by A9,TOPREAL3:11;
        end;
        suppose
              b`1 < a`1 & b`2 < a`2;
          then p`1 <= a`1 & b`2 <= p`2 by A7,TOPREAL1:9,10;
        then A32: a`1 = p`1 & b`2 = p`2 by A29,A30,REAL_1:def 5;
          then a`2 <> p`2 by A9,TOPREAL3:11;
          then LSeg(a,b) is vertical by A7,A10,A32,SPPOL_1:39;
          then a`1 = b`1 by SPPOL_1:37;
          hence contradiction by A9,A32,TOPREAL3:11;
      end;
      end;
      hence contradiction;
  end;
  end;
  hence thesis by A6,SPPOL_1:def 1;
end;

theorem Th24:
  2 <= len G & 2 <= width G & f is_sequence_on G & 1 <= k & k+1 <= len f
    implies
   ex i,j st 1 <= i & i+1 <= len G & 1 <= j & j+1 <= width G &
     LSeg(f,k) c= cell(G,i,j)
proof
  assume that
A1: 2 <= len G and
A2: 2 <= width G and
A3: f is_sequence_on G and
A4: 1 <= k and
A5: k+1 <= len f;

A6: LSeg(f,k) = LSeg(f/.k, f/.(k+1)) by A4,A5,TOPREAL1:def 5;

  consider i1,j1,i2,j2 being Nat such that
A7: [i1,j1] in Indices G and
A8: f/.k = G*(i1,j1) and
A9: [i2,j2] in Indices G and
A10: f/.(k+1) = G*(i2,j2) and
A11: i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or i1 = i2+1 & j1 = j2 or
      i1 = i2 & j1 = j2+1 by A3,A4,A5,JORDAN8:6;
A12: 1 <= i1 & i1 <= len G & 1 <= j1 & j1 <= width G by A7,GOBOARD5:1;
A13: 1 <= i2 & i2 <= len G & 1 <= j2 & j2 <= width G by A9,GOBOARD5:1;

  per cases by A11;
  suppose
  A14: i1 = i2 & j1+1 = j2;
  then A15: j1 < width G by A13,SPPOL_1:5;
        now
      per cases by A12,REAL_1:def 5;
      suppose
            i1 < len G;
      then A16: i1+1 <= len G by NAT_1:38;
        take i1,j1;
            LSeg(f,k) c= cell(G,i1,j1) by A6,A8,A10,A12,A14,A15,GOBOARD5:20;
        hence thesis by A12,A13,A14,A16;
      end;
      suppose
      A17: i1 = len G;
        take i1'=i1-'1,j1;
            2-1 <= 2-'1 & 2-'1 <= i1' by A1,A17,BINARITH:def 3,JORDAN3:5;
      then A18: 1 <= i1' by XXREAL_0:2;
      A19: i1'+1 = i1 by A12,BINARITH:53;
           then i1' < len G by A12,NAT_1:38;
        then LSeg(f,k) c= cell(G,i1',j1) by A6,A8,A10,A12,A14,A15,A19,
GOBOARD5:19;
        hence thesis by A12,A13,A14,A18,A19;
    end;
    end;
    hence thesis;
  end;
  suppose
  A20: i1+1 = i2 & j1 = j2;
  then A21: i1 < len G by A13,SPPOL_1:5;
        now
      per cases by A12,REAL_1:def 5;
      suppose
            j1 < width G;
      then A22: j1+1 <= width G by NAT_1:38;
        take i1,j1;
            LSeg(f,k) c= cell(G,i1,j1) by A6,A8,A10,A12,A20,A21,GOBOARD5:23;
        hence thesis by A12,A13,A20,A22;
      end;
      suppose
      A23: j1 = width G;
        take i1,j1'=j1-'1;
            2-1 <= 2-'1 & 2-'1 <= j1' by A2,A23,BINARITH:def 3,JORDAN3:5;
      then A24: 1 <= j1' by XXREAL_0:2;
      A25: j1'+1=j1 by A12,BINARITH:53;
      then j1' < width G by A23,NAT_1:38;
        then LSeg(f,k) c= cell(G,i1,j1') by A6,A8,A10,A12,A20,A21,A25,
GOBOARD5:22;
        hence thesis by A12,A13,A20,A24,A25;
    end;
    end;
    hence thesis;
  end;
  suppose
  A26: i1 = i2+1 & j1 = j2;
  then A27: i2 < len G by A12,SPPOL_1:5;
        now
      per cases by A12,REAL_1:def 5;
      suppose
            j1 < width G;
      then A28: j1+1 <= width G by NAT_1:38;
        take i2,j1;
            LSeg(f,k) c= cell(G,i2,j1) by A6,A8,A10,A13,A26,A27,GOBOARD5:23;
        hence thesis by A12,A13,A26,A28;
      end;
      suppose
      A29: j1 = width G;
        take i2,j1'=j1-'1;
            2-1 <= 2-'1 & 2-'1 <= j1' by A2,A29,BINARITH:def 3,JORDAN3:5;
      then A30: 1 <= j1' by XXREAL_0:2;
      A31: j1'+1=j1 by A12,BINARITH:53;
      then j1' < width G by A29,NAT_1:38;
        then LSeg(f,k) c= cell(G,i2,j1') by A6,A8,A10,A13,A26,A27,A31,
GOBOARD5:22;
        hence thesis by A12,A13,A26,A30,A31;
    end;
    end;
    hence thesis;
  end;
  suppose
  A32: i1 = i2 & j1 = j2+1;
  then A33: j2 < width G by A12,SPPOL_1:5;
        now
      per cases by A12,REAL_1:def 5;
      suppose
            i1 < len G;
      then A34: i1+1 <= len G by NAT_1:38;
        take i1,j2;
            LSeg(f,k) c= cell(G,i1,j2) by A6,A8,A10,A13,A32,A33,GOBOARD5:20;
        hence thesis by A12,A13,A32,A34;
      end;
      suppose
      A35: i1 = len G;
        take i1'=i1-'1,j2;
            2-1 <= 2-'1 & 2-'1 <= i1' by A1,A35,BINARITH:def 3,JORDAN3:5;
      then A36: 1 <= i1' by XXREAL_0:2;
      A37: i1'+1 = i1 by A12,BINARITH:53;
           then i1' < len G by A12,NAT_1:38;
        then LSeg(f,k) c= cell(G,i1',j2) by A6,A8,A10,A13,A32,A33,A37,
GOBOARD5:19;
        hence thesis by A12,A13,A32,A36,A37;
    end;
    end;
    hence thesis;
end;
end;

theorem Th25:
  2 <= len G & 2 <= width G & f is_sequence_on G & 1 <= k & k+1 <= len f &
    p in Values G & p in LSeg(f,k)
      implies
   p = f/.k or p = f/.(k+1)
proof
  assume that
A1: 2 <= len G and
A2: 2 <= width G and
A3: f is_sequence_on G and
A4: 1 <= k and
A5: k+1 <= len f and
A6: p in Values G and
A7: p in LSeg(f,k);

  consider i,j such that
A8: 1 <= i & i+1 <= len G and
A9: 1 <= j & j+1 <= width G and
A10: LSeg(f,k) c= cell(G,i,j) by A1,A2,A3,A4,A5,Th24;
A11: LSeg(f,k) = LSeg(f/.k, f/.(k+1)) by A4,A5,TOPREAL1:def 5;
      p is_extremal_in cell(G,i,j) by A6,A7,A8,A9,A10,Th23;
  hence thesis by A7,A10,A11,SPPOL_1:def 1;
end;

theorem
      [i,j] in Indices G & 1 <= k & k <= width G implies G*(i,j)`1 <= G*
(len G,k)`1
proof
  assume that
A1: [i,j] in Indices G and
A2: 1 <= k & k <= width G;
A3: 1 <= i & i <= len G & 1 <= j & j <= width G by A1,GOBOARD5:1;
then A4: G*(i,j)`1 = G*(i,1)`1 by GOBOARD5:3
             .= G*(i,k)`1 by A2,A3,GOBOARD5:3;
      i < len G or i = len G by A3,REAL_1:def 5;
 hence thesis by A2,A3,A4,GOBOARD5:4;
end;

theorem
      [i,j] in Indices G & 1 <= k & k <= len G implies G*(i,j)`2 <= G*
(k,width G)`2
proof
  assume that
A1: [i,j] in Indices G and
A2: 1 <= k & k <= len G;
A3: 1 <= i & i <= len G & 1 <= j & j <= width G by A1,GOBOARD5:1;
then A4: G*(i,j)`2 = G*(1,j)`2 by GOBOARD5:2
             .= G*(k,j)`2 by A2,A3,GOBOARD5:2;
      j < width G or j = width G by A3,REAL_1:def 5;
 hence thesis by A2,A3,A4,GOBOARD5:5;
end;

theorem Th28:
  f is_sequence_on G & f is special & L~g c= L~f & 1 <= k & k+1 <= len f
    implies
   for A being Subset of TOP-REAL 2 st
    A = right_cell(f,k,G)\L~g or A = left_cell(f,k,G)\L~g holds A is connected
proof
  assume that
A1: f is_sequence_on G & f is special & L~g c= L~f and
A2: 1 <= k and
A3: k+1 <= len f;
  let A be Subset of TOP-REAL 2 such that
A4: A = right_cell(f,k,G)\L~g or A = left_cell(f,k,G)\L~g;

  per cases by A4;
  suppose
  A5: A = right_cell(f,k,G)\L~g;

then A6: A = right_cell(f,k,G) /\ (L~g)` by SUBSET_1:32;
A7: A c= right_cell(f,k,G) by A5,XBOOLE_1:36;

  A8: Int right_cell(f,k,G) is connected by A1,A2,A3,Th12;
        Int right_cell(f,k,G) misses L~f by A1,A2,A3,Th17;
    then Int right_cell(f,k,G) misses L~g by A1,XBOOLE_1:63;
  then A9: Int right_cell(f,k,G) c= (L~g)` by SUBSET_1:43;
        Int right_cell(f,k,G) c= right_cell(f,k,G) by TOPS_1:44;
  then A10: Int right_cell(f,k,G) c= A by A6,A9,XBOOLE_1:19;
        A c= Cl Int right_cell(f,k,G) by A1,A2,A3,A7,Th13;
  hence A is connected by A8,A10,CONNSP_1:19;

  end;
  suppose
  A11: A = left_cell(f,k,G)\L~g;

then A12: A = left_cell(f,k,G) /\ (L~g)` by SUBSET_1:32;
A13: A c= left_cell(f,k,G) by A11,XBOOLE_1:36;

  A14: Int left_cell(f,k,G) is connected by A1,A2,A3,Th12;
        Int left_cell(f,k,G) misses L~f by A1,A2,A3,Th17;
    then Int left_cell(f,k,G) misses L~g by A1,XBOOLE_1:63;
  then A15: Int left_cell(f,k,G) c= (L~g)` by SUBSET_1:43;
        Int left_cell(f,k,G) c= left_cell(f,k,G) by TOPS_1:44;
  then A16: Int left_cell(f,k,G) c= A by A12,A15,XBOOLE_1:19;
        A c= Cl Int left_cell(f,k,G) by A1,A2,A3,A13,Th13;
  hence A is connected by A14,A16,CONNSP_1:19;
end;
end;

theorem Th29:
  for f being non constant standard special_circular_sequence st
    f is_sequence_on G
  for k st 1 <= k & k+1 <= len f
    holds
   right_cell(f,k,G)\L~f c= RightComp f & left_cell(f,k,G)\L~f c= LeftComp f
proof
  let f be non constant standard special_circular_sequence such that
A1: f is_sequence_on G;
  let k such that
A2: 1 <= k & k+1 <= len f;

  set rc = right_cell(f,k,G)\L~f;
A3: rc = right_cell(f,k,G) /\ (L~f)` by SUBSET_1:32;
A4: rc c= right_cell(f,k,G) by XBOOLE_1:36;
      right_cell(f,k,G) c= right_cell(f,k) by A1,A2,GOBRD13:34;
  then rc c= right_cell(f,k) by A4,XBOOLE_1:1;
then A5: Int rc c= Int right_cell(f,k) by TOPS_1:48;
      Int right_cell(f,k) c= RightComp f by A2,GOBOARD9:28;
then A6: Int rc c= RightComp f by A5,XBOOLE_1:1;
A7: Int right_cell(f,k,G) <> {} by A1,A2,Th11;
A8:  Int right_cell(f,k,G) misses L~f by A1,A2,Th17;
A9: Int right_cell(f,k,G) c= right_cell(f,k,G) by TOPS_1:44;
      rc \/ L~f = right_cell(f,k,G) \/ L~f by XBOOLE_1:39;
  then right_cell(f,k,G) c= rc \/ L~f by XBOOLE_1:7;
then Int right_cell(f,k,G) c= rc \/ L~f by A9,XBOOLE_1:1;
then A10: Int right_cell(f,k,G) c= rc by A8,XBOOLE_1:73;
  then Int Int right_cell(f,k,G) c= Int rc by TOPS_1:48;
  then Int right_cell(f,k,G) c= Int rc by TOPS_1:45;
then A11: rc meets Int rc by A7,A10,XBOOLE_1:68;
  A12: rc is connected by A1,A2,Th28;
  A13: RightComp f is_a_component_of (L~f)` by GOBOARD9:def 2;
      rc c= (L~f)` by A3,XBOOLE_1:17;
  hence right_cell(f,k,G)\L~f c= RightComp f by A6,A11,A12,A13,GOBOARD9:6;
  set lc = left_cell(f,k,G)\L~f;
A14: lc = left_cell(f,k,G) /\ (L~f)` by SUBSET_1:32;
A15: lc c= left_cell(f,k,G) by XBOOLE_1:36;
      left_cell(f,k,G) c= left_cell(f,k) by A1,A2,GOBRD13:34;
  then lc c= left_cell(f,k) by A15,XBOOLE_1:1;
then A16: Int lc c= Int left_cell(f,k) by TOPS_1:48;
      Int left_cell(f,k) c= LeftComp f by A2,GOBOARD9:24;
then A17: Int lc c= LeftComp f by A16,XBOOLE_1:1;
A18: Int left_cell(f,k,G) <> {} by A1,A2,Th11;
A19:  Int left_cell(f,k,G) misses L~f by A1,A2,Th17;
A20: Int left_cell(f,k,G) c= left_cell(f,k,G) by TOPS_1:44;
      lc \/ L~f = left_cell(f,k,G) \/ L~f by XBOOLE_1:39;
  then left_cell(f,k,G) c= lc \/ L~f by XBOOLE_1:7;
then Int left_cell(f,k,G) c= lc \/ L~f by A20,XBOOLE_1:1;
then A21: Int left_cell(f,k,G) c= lc by A19,XBOOLE_1:73;
  then Int Int left_cell(f,k,G) c= Int lc by TOPS_1:48;
  then Int left_cell(f,k,G) c= Int lc by TOPS_1:45;
then A22: lc meets Int lc by A18,A21,XBOOLE_1:68;
  A23: lc is connected by A1,A2,Th28;
  A24: LeftComp f is_a_component_of (L~f)` by GOBOARD9:def 1;
      lc c= (L~f)` by A14,XBOOLE_1:17;
  hence left_cell(f,k,G)\L~f c= LeftComp f by A17,A22,A23,A24,GOBOARD9:6;
end;

begin :: Cages

reserve
  C for compact non vertical non horizontal non empty Subset of TOP-REAL 2,
  l, m, i1, i2, j1, j2 for Nat;

theorem Th30:
  ex i st 1 <= i & i+1 <= len Gauge(C,n) &
    N-min C in cell(Gauge(C,n),i,width Gauge(C,n)-'1) &
      N-min C <> Gauge(C,n)*(i,width Gauge(C,n)-'1)
proof
 set G = Gauge(C,n);
A1: len G = width G by JORDAN8:def 1;
 defpred P[Nat]
   means 1 <= $1 & $1 < len G & G*($1,(width G)-'1)`1 < (N-min C)`1;
A2:  for k st P[k] holds k <= len G;
A3:  len G = 2|^n+3 & len G = width G by JORDAN8:def 1;
A4:  len G >= 4 by JORDAN8:13;
then A5:  1 < len G by XXREAL_0:2;
then A6:  1 <= (len G)-'1 by JORDAN3:12;
A7:  (len G)-'1 <= len G by BINARITH:52;
      (NW-corner C)`1 <= (N-min C)`1 by PSCOMP_1:97;
then A8:  W-bound C <= (N-min C)`1 by EUCLID:56;
A9:  2 <= len G by A4,XXREAL_0:2;
      G*(2,(width G)-'1)`1 = W-bound C by A1,A6,A7,JORDAN8:14;
  then G*(1,(width G)-'1)`1 < W-bound C by A3,A6,A7,A9,GOBOARD5:4;
  then G*(1,(width G)-'1)`1 < (N-min C)`1 by A8,XXREAL_0:2;
then A10:  ex k st P[k] by A5;
    ex i st P[i] & for n st P[n] holds n <= i from NAT_1:sch 6(A2,A10);
  then consider i such that
A11:  1 <= i & i < len G and
A12:  G*(i,(width G)-'1)`1 < (N-min C)`1 and
A13:  for n st P[n] holds n <= i;
 take i;
 thus 1 <= i & i+1 <= len G by A11,NAT_1:38;
A14:  LSeg(G*(i,(width G)-'1),G*(i+1,(width G)-'1)) c= cell(G,i,(width G)-'1)
      by A3,A6,A7,A11,GOBOARD5:23;
A15:  i+1 <= len G by A11,NAT_1:38;
A16:  1 <= i+1 by NAT_1:37;
     (N-min C)`2 = N-bound C by EUCLID:56;
then A17:  G*(i,(width G)-'1)`2 = (N-min C)`2 & (N-min C)`2 = G*
(i+1,(width G)-'1)`2
      by A1,A11,A15,A16,JORDAN8:17;
      now assume i+1 = len G;
   then len G-'1 = i by BINARITH:39;
then A18:   G*(i,(width G)-'1)`1 = E-bound C by A1,A6,A7,JORDAN8:15;
       (NE-corner C)`1 >= (N-min C)`1 by PSCOMP_1:97;
   hence contradiction by A12,A18,EUCLID:56;
  end;
 then i+1 < len G & i < i+1 by A15,NAT_1:38,REAL_1:def 5;
 then (N-min C)`1 <= G*(i+1,(width G)-'1)`1 by A13,A16;
 then N-min C in LSeg(G*(i,(width G)-'1),G*(i+1,(width G)-'1))
   by A12,A17,GOBOARD7:9;
 hence N-min C in cell(G,i,(width G)-'1) by A14;
 thus N-min C <> G*(i,(width G)-'1) by A12;
end;

theorem Th31:
  1 <= i1 & i1+1 <= len Gauge(C,n) &
     N-min C in cell(Gauge(C,n),i1,width Gauge(C,n)-'1) &
       N-min C <> Gauge(C,n)*(i1,width Gauge(C,n)-'1) &
    1 <= i2 & i2+1 <= len Gauge(C,n) &
      N-min C in cell(Gauge(C,n),i2,width Gauge(C,n)-'1) &
        N-min C <> Gauge(C,n)*(i2,width Gauge(C,n)-'1)
    implies
   i1 = i2
proof
  set G = Gauge(C,n), j = width G-'1;
  assume that
A1:  1 <= i1 & i1+1 <= len G and
A2:  N-min C in cell(G,i1,j) and
A3:  N-min C <> G*(i1,j) and
A4:  1 <= i2 & i2+1 <= len G and
A5:  N-min C in cell(G,i2,j) and
A6:  N-min C <> G*(i2,j) and
A7:  i1 <> i2;
A8: i1 < len G & i2 < len G & len G = width G by A1,A4,JORDAN8:def 1,NAT_1:38;
A9:  cell(G,i1,j) meets cell(G,i2,j) by A2,A5,XBOOLE_0:3;
A10:  len G = 2|^n+3 & len G = width G by JORDAN8:def 1;
A11:  2|^n >= n+1 by HEINE:7;
   then len G >= n+1+3 by A10,XREAL_1:8;
   then len G >= 1+ (n+3) & 1+ (n+3) > 1+0 by XREAL_1:8;
then A12:  len G > 1 by XXREAL_0:2;
   then len G >= 1+1 by NAT_1:38;
then A13:  1 <= j by A8,JORDAN5B:2;
A14:  j+1 = len G by A8,A12,BINARITH:53;
then A15:  j < len G by NAT_1:38;
A16:  (N-min C)`2 = N-bound C by EUCLID:56;
 per cases by A7,REAL_1:def 5;
  suppose
A17:   i1 < i2;
then A18:   i2-'i1+i1 = i2 by BINARITH:53;
     then i2-'i1 <= 1 by A8,A9,A13,A15,JORDAN8:10;
     then i2-'i1 < 1 or i2-'i1 = 1 by REAL_1:def 5;
     then i2-'i1 = 0 or i2-'i1 = 1 by NAT_1:39;
    then cell(G,i1,j) /\ cell(G,i2,j) = LSeg(G*(i2,j),G*(i2,j+1))
        by A8,A13,A15,A17,A18,GOBOARD5:26;
    then A19:  N-min C in LSeg(G*(i2,j),G*(i2,j+1)) by A2,A5,XBOOLE_0:def 3;
A20:  [i2,j] in Indices G by A4,A8,A13,A15,GOBOARD7:10;
        1 <= j+1 by NAT_1:37;
then A21:  [i2,j+1] in Indices G by A4,A8,A14,GOBOARD7:10;
     set x = (W-bound C)+(((E-bound C)-(W-bound C))/(2|^n))*(i2-2);
     set y1 = (S-bound C)+(((N-bound C)-(S-bound C))/(2|^n))*(j-2);
     set y2 = (S-bound C)+(((N-bound C)-(S-bound C))/(2|^n))*(j-1);
A22:   j+1-(1+1) = j-1;
A23:   G*(i2,j) = |[x,y1]| by A20,JORDAN8:def 1;
      G*(i2,j+1) = |[x,y2]| by A21,A22,JORDAN8:def 1;
then A24:  G*(i2,j)`1 = x & G*(i2,j+1)`1 = x by A23,EUCLID:56;
     then LSeg(G*(i2,j),G*(i2,j+1)) is vertical by SPPOL_1:37;
then A25:  (N-min C)`1 = G*(i2,j)`1 by A19,SPPOL_1:64;
A26:   2|^n > 0 by A11;
         j = (2|^n+(2+1))-'1 by A10
      .= (2|^n+2+1)-'1
      .= (2|^n+2) by BINARITH:39;
     then (((N-bound C)-(S-bound C))/(2|^n))*(j-2) = (N-bound C)-(S-bound C)
       by A26,XCMPLX_1:88;
   hence contradiction by A6,A16,A23,A24,A25,EUCLID:57;
  end;
  suppose
A27:   i2 < i1;
then A28:   i1-'i2+i2 = i1 by BINARITH:53;
     then i1-'i2 <= 1 by A8,A9,A13,A15,JORDAN8:10;
     then i1-'i2 < 1 or i1-'i2 = 1 by REAL_1:def 5;
     then i1-'i2 = 0 or i1-'i2 = 1 by NAT_1:39;
    then cell(G,i2,j) /\ cell(G,i1,j) = LSeg(G*(i1,j),G*(i1,j+1))
        by A8,A13,A15,A27,A28,GOBOARD5:26;
    then A29:  N-min C in LSeg(G*(i1,j),G*(i1,j+1)) by A2,A5,XBOOLE_0:def 3;
A30:  [i1,j] in Indices G by A1,A8,A13,A15,GOBOARD7:10;
        1 <= j+1 by NAT_1:37;
then A31:  [i1,j+1] in Indices G by A1,A8,A14,GOBOARD7:10;
     set x = (W-bound C)+(((E-bound C)-(W-bound C))/(2|^n))*(i1-2);
     set y1 = (S-bound C)+(((N-bound C)-(S-bound C))/(2|^n))*(j-2);
     set y2 = (S-bound C)+(((N-bound C)-(S-bound C))/(2|^n))*(j-1);
A32:   j+1-(1+1) = j-1;
A33:   G*(i1,j) = |[x,y1]| by A30,JORDAN8:def 1;
      G*(i1,j+1) = |[x,y2]| by A31,A32,JORDAN8:def 1;
then A34:  G*(i1,j)`1 = x & G*(i1,j+1)`1 = x by A33,EUCLID:56;
    then LSeg(G*(i1,j),G*(i1,j+1)) is vertical by SPPOL_1:37;
then A35:  (N-min C)`1 = G*(i1,j)`1 by A29,SPPOL_1:64;
A36:   2|^n > 0 by A11;
         j = (2|^n+(2+1))-'1 by A10
      .= (2|^n+2+1)-'1
      .= (2|^n+2) by BINARITH:39;
     then (((N-bound C)-(S-bound C))/(2|^n))*(j-2) = (N-bound C)-(S-bound C)
       by A36,XCMPLX_1:88;
   hence contradiction by A3,A16,A33,A34,A35,EUCLID:57;
end;
end;

theorem Th32:
  for f being standard non constant special_circular_sequence
    st f is_sequence_on Gauge(C,n) &
      (for k st 1 <= k & k+1 <= len f
         holds
        left_cell(f,k,Gauge(C,n)) misses C &
          right_cell(f,k,Gauge(C,n)) meets C) &
      (ex i st 1 <= i & i+1 <= len Gauge(C,n) &
        f/.1 = Gauge(C,n)*(i,width Gauge(C,n)) &
          f/.2 = Gauge(C,n)*(i+1,width Gauge(C,n)) &
            N-min C in cell(Gauge(C,n),i,width Gauge(C,n)-'1) &
              N-min C <> Gauge(C,n)*(i,width Gauge(C,n)-'1))
  holds
 N-min L~f = f/.1
proof
  set G = Gauge(C,n);
  let f be standard non constant special_circular_sequence such that
A1: f is_sequence_on G and
A2: for k st 1 <= k & k+1 <= len f
       holds left_cell(f,k,G) misses C & right_cell(f,k,G) meets C;
  given i' being Nat such that
A3:    1 <= i' & i'+1 <= len G and
A4:    f/.1 = G*(i',width G) and
A5:    f/.2 = G*(i'+1,width G) and
A6:    N-min C in cell(G,i',width G-'1) and
A7:    N-min C <> G*(i',width G-'1);
A8: i' < len G & len G = width G by A3,JORDAN8:def 1,NAT_1:38;
     len f > 4 by GOBOARD7:36;
then A9: len f >= 2 by XXREAL_0:2;
A10:  len G = 2|^n+3 & len G = width G by JORDAN8:def 1;
    then len G >= 3 by NAT_1:37;
then A11:  1 < len G by XXREAL_0:2;
     set W = W-bound C, S = S-bound C, E = E-bound C, N = N-bound C;
         N-min L~f in rng f by SPRECT_2:43;
     then consider m such that
A12:    m in dom f and
A13:    f.m = N-min L~f by FINSEQ_2:11;
A14:    f/.m = f.m by A12,FINSEQ_4:def 4;
A15:    (N-min L~f)`2 = N-bound L~f by EUCLID:56;
A16:    2|^n > 0 by NEWTON:102;
         N > S by JORDAN8:12;
     then N-S > 0 by XREAL_1:52;
then A17:    (N-S)/(2|^n) > 0 by A16,REAL_2:127;
A18:    1 <= m & m <= len f by A12,FINSEQ_3:27;
     consider i,j such that
A19:     [i,j] in Indices G and
A20:     f/.m = G*(i,j) by A1,A12,GOBOARD1:def 11;
A21:     1 <= i & i <= len G & 1 <= j & j <= width G by A19,GOBOARD5:1;
         G*(i,j) = |[W+((E-W)/(2|^n))*(i-2), S+((N-S)/(2|^n))*(j-2)]|
       by A19,JORDAN8:def 1;
then A22:     S+((N-S)/(2|^n))*(j-2) = N-bound L~f by A13,A14,A15,A20,EUCLID:56
;
         1 in dom f by FINSEQ_5:6;
     then A23:    f/.1 in L~f by A9,GOBOARD1:16;
then A24:    N-bound L~f >= (f/.1)`2 by PSCOMP_1:71;
         G*(i',j)`2 = G*(1,j)`2 & G*(i,j)`2 = G*
(1,j)`2 by A3,A8,A21,GOBOARD5:2;
     then G*(i,j)`2 <= G*(i',len G)`2 by A3,A8,A21,SPRECT_3:24;
then A25:    N-bound L~f = (f/.1)`2 by A4,A8,A13,A14,A15,A20,A24,XXREAL_0:1;
         [i',len G] in Indices G by A3,A8,A11,GOBOARD7:10;
     then G*(i',len G)=|[W+((E-W)/(2|^n))*(i'-2),S+((N-S)/(2|^n))*(len G-2)]|
      by JORDAN8:def 1;
     then S+((N-S)/(2|^n))*(len G-2) = N-bound L~f by A4,A8,A25,EUCLID:56;
     then ((N-S)/(2|^n))*(j-2) = ((N-S)/(2|^n))*(len G-2) by A22;
     then len G-2 = j-2 by A17,XCMPLX_1:5;
then A26:    len G = j;
A27:    (NW-corner C)`1 = W & (NE-corner C)`1 = E &
         (NW-corner C)`2 = N & (NE-corner C)`2 = N by EUCLID:56;
A28:    G*(i',len G)`1 = G*(i',1)`1 by A3,A8,A21,A26,GOBOARD5:3;
A29:    G*(i,len G)`1 = G*(i,1)`1 by A21,A26,GOBOARD5:3;
A30:    (NW-corner L~f)`1 = W-bound L~f & (NE-corner L~f)`1 = E-bound L~f &
         (NW-corner L~f)`2 = N-bound L~f & (NE-corner L~f)`2 = N-bound L~f
          by EUCLID:56;
         W-bound L~f <= (f/.1)`1 & (f/.1)`1 <= E-bound L~f by A23,PSCOMP_1:71;
     then f/.1 in LSeg(NW-corner L~f, NE-corner L~f) by A25,A30,GOBOARD7:9;
     then f/.1 in LSeg(NW-corner L~f, NE-corner L~f) /\ L~f
       by A23,XBOOLE_0:def 3;
     then f/.1 in N-most L~f;
then A31:    (N-min L~f)`1 <= (f/.1)`1 by PSCOMP_1:98;
A32:    1 <= len G-'1 by A11,JORDAN3:12;
then A33:    len G-'1 < len G by JORDAN3:14;
A34:    len G-'1+1 = len G by A11,BINARITH:53;
     then N-min C in { |[r',s']| where r',s' is Real:
               G*(i',1)`1 <= r' & r' <= G*(i'+1,1)`1 &
                   G*(1,len G-'1)`2 <= s' & s' <= G*(1,len G)`2 }
         by A3,A6,A8,A32,A33,GOBRD11:32;
     then consider r',s' being Real such that
A35:    N-min C = |[r',s']| and
A36:    G*(i',1)`1 <= r' & r' <= G*(i'+1,1)`1 and
            G*(1,len G-'1)`2 <= s' & s' <= G*(1,len G)`2;
A37:    (f/.1)`1 <= (N-min C)`1 by A4,A8,A28,A35,A36,EUCLID:56;
then A38:    (N-min L~f)`1 <= (N-min C)`1 by A31,XXREAL_0:2;
A39:    G*(i',len G-'1)`1 = G*(i',1)`1 by A3,A8,A32,A33,GOBOARD5:3;
A40:    N-min C = |[(N-min C)`1,(N-min C)`2]| by EUCLID:57;
A41:    G*(i',len G-'1) = |[G*(i',len G-'1)`1,G*(i',len G-'1)`2]|
          by EUCLID:57;
A42:    (N-min C)`2 = N by EUCLID:56;
       G*(i',len G-'1)`2 = N by A3,A8,JORDAN8:17;
then A43:    G*(i',len G-'1)`1 < (N-min C)`1
         by A4,A7,A8,A28,A37,A39,A40,A41,A42,REAL_1:def 5;
A44: i <= i' by A3,A4,A8,A13,A14,A20,A21,A26,A31,GOBOARD5:4;
     then A45:    i < len G by A8,XXREAL_0:2;
then A46:   i+1 <= len G by NAT_1:38;
     per cases by A18,REAL_1:def 5;
     suppose m = len f;
       hence N-min L~f = f/.1 by A13,A14,FINSEQ_6:def 1;
     end;
     suppose m < len f;
then A47:    m+1 <= len f by NAT_1:38;
then A48:    right_cell(f,m,G) meets C by A2,A18;
      then consider p being set such that
A49:     p in right_cell(f,m,G) & p in C by XBOOLE_0:3;
      reconsider p as Point of TOP-REAL 2 by A49;
      consider i1,j1,i2,j2 being Nat such that
A50:     [i1,j1] in Indices G & f/.m = G*(i1,j1) and
A51:     [i2,j2] in Indices G & f/.(m+1) = G*(i2,j2) and
A52:     i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
        i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A1,A18,A47,JORDAN8:6;
A53:     1 <= i2 & i2 <= len G & 1 <= j2 & j2 <= len G by A10,A51,GOBOARD5:1;
A54:     (N-min C)`2 = N by EUCLID:56;
then A55:     p`2 <= (N-min C)`2 by A49,PSCOMP_1:71;
A56:     G*(1,len G-'1)`2 = N by A11,JORDAN8:17;
A57:     G*(1,len G-'1)`2 < G*(1,len G)`2 by A10,A11,A32,A33,GOBOARD5:5;
A58:     W <= p`1 & p`1 <= E by A49,PSCOMP_1:71;
         now per cases by A19,A20,A26,A50,A52,GOBOARD1:21;
      suppose i = i2 & len G+1 = j2;
       hence N-min L~f = f/.1 by A53,NAT_1:38;
      end;
      suppose i+1 = i2 & len G = j2;
then A59:     right_cell(f,m,G) = cell(G,i,len G-'1)
           by A1,A18,A19,A20,A26,A47,A51,GOBRD13:25;
A60:     cell(G,i,len G-'1) = {|[r,s]| : G*(i,1)`1 <= r & r <= G*(i+1,1)`1 &
           G*(1,len G-'1)`2 <= s & s <= G*(1,len G-'1+1)`2 }
          by A10,A21,A32,A33,A45,GOBRD11:32;
       then consider r,s such that
A61:     p = |[r,s]| and
A62:     G*(i,1)`1 <= r & r <= G*(i+1,1)`1 and
A63:     G*(1,len G-'1)`2 <= s & s <= G*(1,len G-'1+1)`2 by A49,A59;
A64:     p`1 = r & p`2 = s by A61,EUCLID:56;
       then p`2 = N by A54,A55,A56,A63,XXREAL_0:1;
       then p in LSeg(NW-corner C, NE-corner C) by A27,A58,GOBOARD7:9;
       then p in LSeg(NW-corner C, NE-corner C) /\ C
         by A49,XBOOLE_0:def 3;
       then p in N-most C;
       then (N-min C)`1 <= p`1 by PSCOMP_1:98;
         then (N-min C)`1 <= G*(i+1,1)`1 by A62,A64,XXREAL_0:2;
       then A65:     N-min C in cell(G,i,width G-'1)
               by A8,A13,A14,A20,A26,A29,A34,A38,A40,A54,A56,A57,A60;
           N-min C <> G*(i,len G-'1) by A8,A21,A32,A33,A43,A44,SPRECT_3:25;
       hence N-min L~f = f/.1
          by A3,A4,A6,A7,A8,A13,A14,A20,A21,A26,A46,A65,Th31;
      end;
      suppose
A66:     i = i2+1 & len G = j2;
then A67:     right_cell(f,m,G) = cell(G,i2,len G)
           by A1,A18,A19,A20,A26,A47,A51,GOBRD13:27;
           i2 < len G by A21,A66,NAT_1:38;
       hence N-min L~f = f/.1 by A48,A67,JORDAN8:18;
      end;
      suppose
A68:     i = i2 & len G = j2+1;
then A69:     j2 = len G-'1 by BINARITH:39;
then A70:     right_cell(f,m,G) = cell(G,i-'1,len G-'1)
          by A1,A18,A19,A20,A26,A47,A51,A68,GOBRD13:29;
           now assume
A71:      m = 1;
           1 <= i'+1 & i'+1<= len G by A3,NAT_1:38;
       then G*(i',len G)`2 = G*(1,len G)`2 & G*(i'+1,len G)`2 = G*
(1,len G)`2 by A3,A8,A11,GOBOARD5:2;
        hence contradiction
         by A4,A5,A8,A20,A21,A26,A32,A33,A51,A68,A69,A71,GOBOARD5:5;
       end;
       then m > 1 by A18,REAL_1:def 5;
then A72:   m-'1 >= 1 by JORDAN3:12;
A73:   m-'1+1 = m by A18,BINARITH:53;
           m-'1 <= m by BINARITH:52;
then A74:   m-'1 <= len f by A18,XXREAL_0:2;
       consider i1',j1',i2',j2' being Nat such that
A75:     [i1',j1'] in Indices G & f/.(m-'1) = G*(i1',j1') and
A76:     [i2',j2'] in Indices G & f/.m = G*(i2',j2') and
A77:     i1' = i2' & j1'+1 = j2' or i1'+1 = i2' & j1' = j2' or
          i1' = i2'+1 & j1' = j2' or i1' = i2' & j1' = j2'+1
           by A1,A18,A72,A73,JORDAN8:6;
A78:     1 <= i1' & i1' <= len G & 1 <= j1' &
           j1' <= len G by A10,A75,GOBOARD5:1;
           now per cases by A19,A20,A26,A76,A77,GOBOARD1:21;
        suppose
A79:        i1' = i & j1'+1 = len G;
         then j1' = len G-'1 by BINARITH:39;
         then left_cell(f,m-'1,G) = cell(G,i-'1,len G-'1)
           by A1,A18,A19,A20,A26,A72,A73,A75,A79,GOBRD13:22;
         hence contradiction by A2,A18,A48,A70,A72,A73;
        end;
        suppose
A80:     i1'+1 = i & j1' = len G;
         then i1' < i by NAT_1:38;
then A81:     (f/.(m-'1))`1 < (f/.m)`1 by A20,A21,A26,A75,A78,A80,GOBOARD5:4;
A82:     G*(i1',j)`2 = G*(1,j)`2 & G*(i,j)`2 = G*(1,j)`2
           by A21,A78,GOBOARD5:2;
             m-'1 in dom f by A72,A74,FINSEQ_3:27;
then A83:     f/.(m-'1) in L~f by A9,GOBOARD1:16;
         then W-bound L~f <= (f/.(m-'1))`1 &
           (f/.(m-'1))`1 <= E-bound L~f by PSCOMP_1:71;
         then f/.(m-'1) in LSeg(NW-corner L~f, NE-corner L~f)
          by A13,A14,A15,A20,A26,A30,A75,A80,A82,GOBOARD7:9;
         then f/.(m-'1) in LSeg(NW-corner L~f, NE-corner L~f) /\ L~f
          by A83,XBOOLE_0:def 3;
         then f/.(m-'1) in N-most L~f;
         hence contradiction by A13,A14,A81,PSCOMP_1:98;
        end;
        suppose i1' = i+1 & j1' = len G;
         then right_cell(f,m-'1,G) = cell(G,i,len G)
           by A1,A18,A19,A20,A26,A72,A73,A75,GOBRD13:27;
         then cell(G,i,len G) meets C by A2,A18,A72,A73;
         hence contradiction by A21,JORDAN8:18;
        end;
        suppose i1' = i & j1' = len G+1;
         then len G+1 <= len G+0 by A10,A75,GOBOARD5:1;
         hence contradiction by XREAL_1:8;
       end;
       end;
       hence N-min L~f = f/.1;
     end;
     end;
     hence N-min L~f = f/.1;
end;
end;

definition
  let C be compact non vertical non horizontal non empty Subset of TOP-REAL 2;
  let n be Nat;
  assume
A1:    C is connected;
  func Cage(C,n) -> clockwise_oriented
    (standard non constant special_circular_sequence) means
:Def1:
  it is_sequence_on Gauge(C,n) &
    (ex i st 1 <= i & i+1 <= len Gauge(C,n) &
      it/.1 = Gauge(C,n)*(i,width Gauge(C,n)) &
        it/.2 = Gauge(C,n)*(i+1,width Gauge(C,n)) &
          N-min C in cell(Gauge(C,n),i,width Gauge(C,n)-'1) &
            N-min C <> Gauge(C,n)*(i,width Gauge(C,n)-'1)) &
    for k st 1 <= k & k+2 <= len it holds
      (front_left_cell(it,k,Gauge(C,n)) misses C &
        front_right_cell(it,k,Gauge(C,n)) misses C
          implies
         it turns_right k,Gauge(C,n)) &
      (front_left_cell(it,k,Gauge(C,n)) misses C &
        front_right_cell(it,k,Gauge(C,n)) meets C
          implies
         it goes_straight k,Gauge(C,n)) &
      (front_left_cell(it,k,Gauge(C,n)) meets C
        implies
       it turns_left k,Gauge(C,n));
existence
proof
   set G = Gauge(C,n);
   set W = W-bound C, E = E-bound C, S = S-bound C, N = N-bound C;
A2:   len G = 2|^n+3 & len G = width G by JORDAN8:def 1;
   defpred P[Nat,set,set] means
      ($1 = 0 implies
        ex i st 1 <= i & i+1 <= len G &
             N-min C in cell(G,i,width G-'1) & N-min C <> G*(i,width G-'1) &
            $3 = <*G*(i,width G)*>) &
      ($1 = 1 implies
         ex i st 1 <= i & i+1 <= len G &
             N-min C in cell(G,i,width G-'1) & N-min C <> G*(i,width G-'1) &
            $3 = <*G*(i,width G),G*(i+1,width G)*>) &
      ($1 > 1 & $2 is FinSequence of TOP-REAL 2 implies
        for f being FinSequence of TOP-REAL 2 st $2 = f holds
         (len f = $1 implies
          (f is_sequence_on G & right_cell(f,len f-'1,G) meets C implies
           (front_left_cell(f,(len f)-'1,G) misses C &
              front_right_cell(f,(len f)-'1,G) misses C
             implies ex i,j st
                f^<*G*(i,j)*> turns_right (len f)-'1,G &
              $3 = f^<*G*(i,j)*>) &
           (front_left_cell(f,(len f)-'1,G) misses C &
              front_right_cell(f,(len f)-'1,G) meets C
             implies ex i,j st
               f^<*G*(i,j)*> goes_straight (len f)-'1,G &
              $3 = f^<*G*(i,j)*>) &
           (front_left_cell(f,(len f)-'1,G) meets C
             implies ex i,j st
               f^<*G*(i,j)*> turns_left (len f)-'1,G &
              $3 = f^<*G*(i,j)*>)) &
          (not f is_sequence_on G or right_cell(f,len f-'1,G) misses C
           implies $3 = f^<*G*(1,1)*>)) &
         (len f <> $1 implies $3 = {})) &
       ($1 > 1 & $2 is not FinSequence of TOP-REAL 2 implies $3 = {});
A3:  for k being Nat, x being set ex y being set st P[k,x,y]
   proof
    let k be Nat, x be set;
    consider m being Nat such that
A4:   1 <= m & m+1 <= len G and
A5:   N-min C in cell(G,m,width G-'1) &
        N-min C <> G*(m,width G-'1) by Th30;
    per cases by CQC_THE1:2;
    suppose
A6:    k=0;
     take <*G*(m,width G)*>;
     thus thesis by A4,A5,A6;
    end;
    suppose
A7:    k = 1;
     take <*G*(m,width G),G*(m+1,width G)*>;
     thus thesis by A4,A5,A7;
    end;
    suppose that
A8:    k > 1 and
A9:    x is FinSequence of TOP-REAL 2;
     reconsider f = x as FinSequence of TOP-REAL 2 by A9;
     thus thesis
     proof per cases;
      suppose
A10:      len f = k;
       thus thesis
        proof per cases;
         suppose
A11:         f is_sequence_on G & right_cell(f,len f-'1,G) meets C;
A12:         1 <= (len f)-'1 by A8,A10,JORDAN3:12;
A13:         (len f) -'1 +1 = len f by A8,A10,BINARITH:53;
         then consider i1,j1,i2,j2 being Nat such that
A14:         [i1,j1] in Indices G & f/.((len f) -'1) = G*(i1,j1) and
A15:         [i2,j2] in Indices G & f/.((len f) -'1+1) = G*(i2,j2) and
A16:         i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
             i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A11,A12,JORDAN8:6;
A17:        1 <= i1 & i1 <= len G & 1 <= j1 & j1 <= width G by A14,GOBOARD5:1;
A18:        1 <= i2 & i2 <= len G & 1 <= j2 & j2 <= width G by A15,GOBOARD5:1;
A19:       i1-'1 <= len G & j1-'1 <= width G by A17,JORDAN3:7;
A20:        1 <= i2+1 & 1 <= j2+1 by NAT_1:37;
A21:       i2-'1 <= len G & j2-'1 <= width G by A18,JORDAN3:7;
               (len f)-'1 <= len f by BINARITH:52;
then A22:        (len f)-'1 in dom f & (len f)-'1+1 in dom f
              by A8,A10,A12,A13,FINSEQ_3:27;
A23:        (len f)-'1+(1+1) = (len f)+1 by A13;
          thus thesis
          proof per cases;
           suppose
A24:          front_left_cell(f,(len f)-'1,G) misses C &
              front_right_cell(f,(len f)-'1,G) misses C;
            thus thesis
             proof per cases by A16;
              suppose
A25:              i1 = i2 & j1+1 = j2;
               take f1 = f^<*G*(i2+1,j2)*>;
                   now
                take i=i2+1 ,j=j2;
                thus f1 turns_right (len f)-'1,G
                 proof let i1',j1',i2',j2' be Nat;
                  assume that
A26:                 [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A27:                 f1/.((len f)-'1) = G*(i1',j1') &
                    f1/.((len f)-'1+1) = G*(i2',j2');
                      f/.((len f)-'1) = G*(i1',j1') &
               f/.((len f)-'1+1) = G*(i2',j2') by A22,A27,FINSEQ_4:83;
then A28:                 i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                     by A14,A15,A26,GOBOARD1:21;
                  per cases by A16,A28;
                  case i1' = i2' & j1'+1 = j2';
                      now assume i2+1 > len G;
                   then i2+1 <= (len G)+1 & (len G)+1 <= i2+1
                    by A18,XREAL_1:8,NAT_1:38;
                   then i2+1 = (len G)+1 by XXREAL_0:1;
                   then i2 = len G;
                   then cell(G,len G,j1) meets C
                    by A11,A12,A13,A14,A15,A25,GOBRD13:23;
                   hence contradiction by A2,A17,JORDAN8:19;
                  end;
                  hence [i2'+1,j2'] in Indices G by A18,A20,A28,GOBOARD7:10;
                  thus thesis by A23,A28,FINSEQ_4:82;
                 end;
                 case i1'+1 = i2' & j1' = j2';
                  hence thesis by A25,A28;
                 end;
                 case i1' = i2'+1 & j1' = j2';
                  hence thesis by A25,A28;
                 end;
                 case
A29:               i1' = i2' & j1' = j2'+1;
                  thus thesis by A25,A28,A29;
                 end;
                 end;
               end;
               hence thesis by A8,A10,A11,A24;
              end;
              suppose
A30:             i1+1 = i2 & j1 = j2;
               take f1 = f^<*G*(i2,j2-'1)*>;
                   now
                take i=i2 ,j=j2-'1;
                thus f1 turns_right (len f)-'1,G
                 proof let i1',j1',i2',j2' be Nat;
                  assume that
A31:                 [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A32:                 f1/.((len f)-'1) = G*(i1',j1') &
                    f1/.((len f)-'1+1) = G*(i2',j2');
                      f/.((len f)-'1) = G*(i1',j1') &
            f/.((len f)-'1+1) = G*(i2',j2') by A22,A32,FINSEQ_4:83;
then A33:                 i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                     by A14,A15,A31,GOBOARD1:21;
                  per cases by A16,A33;
                  case i1' = i2' & j1'+1 = j2';
                   hence thesis by A30,A33;
                  end;
                  case i1'+1 = i2' & j1' = j2';
                      now assume j2-'1 < 1;
                   then j2-'1 = 0 by NAT_1:39;
                   then j2 <= 1 by BINARITH:54;
                   then j2 = 1 by A18,XXREAL_0:1;
                   then cell(G,i1,1-'1) meets C
                    by A11,A12,A13,A14,A15,A30,GOBRD13:25;
                   then cell(G,i1,0) meets C by BINARITH:51;
                   hence contradiction by A17,JORDAN8:20;
                  end;
                  hence [i2',j2'-'1] in Indices G by A18,A21,A33,GOBOARD7:10;
                  thus f1/.((len f)-'1+2) = G*(i2',j2'-'1)
                         by A23,A33,FINSEQ_4:82;
                  end;
                  case
A34:                i1' = i2'+1 & j1' = j2';
                  thus thesis by A30,A33,A34;
                  end;
                  case i1' = i2' & j1' = j2'+1;
                   hence thesis by A30,A33;
                 end;
                 end;
               end;
               hence thesis by A8,A10,A11,A24;
              end;
              suppose
A35:             i1 = i2+1 & j1 = j2;
               take f1 = f^<*G*(i2,j2+1)*>;
                   now
                take i=i2 ,j=j2+1;
                thus f1 turns_right (len f)-'1,G
                 proof let i1',j1',i2',j2' be Nat;
                  assume that
A36:                 [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A37:                 f1/.((len f)-'1) = G*(i1',j1') &
                    f1/.((len f)-'1+1) = G*(i2',j2');
                      f/.((len f)-'1) = G*(i1',j1') &
               f/.((len f)-'1+1) = G*(i2',j2') by A22,A37,FINSEQ_4:83;
then A38:                 i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                     by A14,A15,A36,GOBOARD1:21;
                  per cases by A16,A38;
                  case i1' = i2' & j1'+1 = j2';
                   hence thesis by A35,A38;
                  end;
                  case
A39:                i1'+1 = i2' & j1' = j2';
                  thus thesis by A35,A38,A39;
                  end;
                  case i1' = i2'+1 & j1' = j2';
                      now assume j2+1 > len G;
                   then j2+1 <= (len G)+1 & (len G)+1 <= j2+1
                     by A2,A18,XREAL_1:8,NAT_1:38;
                   then j2+1 = (len G)+1 by XXREAL_0:1;
                   then j2 = len G;
                   then cell(G,i2,len G) meets C
                    by A11,A12,A13,A14,A15,A35,GOBRD13:27;
                   hence contradiction by A18,JORDAN8:18;
                  end;
                  hence [i2',j2'+1] in Indices G by A2,A18,A20,A38,GOBOARD7:10
;
                  thus f1/.((len f)-'1+2) = G*(i2',j2'+1)
                      by A23,A38,FINSEQ_4:82;
                  end;
                  case i1' = i2' & j1' = j2'+1;
                   hence thesis by A35,A38;
                 end;
                 end;
               end;
               hence thesis by A8,A10,A11,A24;
              end;
              suppose
A40:             i1 = i2 & j1 = j2+1;
               take f1 = f^<*G*(i2-'1,j2)*>;
                   now
                take i=i2-'1 ,j=j2;
                thus f1 turns_right (len f)-'1,G
                 proof let i1',j1',i2',j2' be Nat;
                  assume that
A41:                 [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A42:                 f1/.((len f)-'1) = G*(i1',j1') &
                    f1/.((len f)-'1+1) = G*(i2',j2');
                      f/.((len f)-'1) = G*(i1',j1') &
               f/.((len f)-'1+1) = G*(i2',j2') by A22,A42,FINSEQ_4:83;
then A43:                 i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                     by A14,A15,A41,GOBOARD1:21;
                  per cases by A16,A43;
                  case
A44:                i1' = i2' & j1'+1 = j2';
                  thus thesis by A40,A43,A44;
                  end;
                  case i1'+1 = i2' & j1' = j2';
                   hence thesis by A40,A43;
                  end;
                  case i1' = i2'+1 & j1' = j2';
                   hence thesis by A40,A43;
                  end;
                  case i1' = i2' & j1' = j2'+1;
                      now assume i2-'1 < 1;
                   then i2-'1 = 0 by NAT_1:39;
                   then i2 <= 1 by BINARITH:54;
                   then i2 = 1 by A18,XXREAL_0:1;
                   then cell(G,1-'1,j2) meets C
                    by A11,A12,A13,A14,A15,A40,GOBRD13:29;
                   then cell(G,0,j2) meets C by BINARITH:51;
                   hence contradiction by A2,A18,JORDAN8:21;
                  end;
                  hence [i2'-'1,j2'] in Indices G by A18,A21,A43,GOBOARD7:10;
                  thus f1/.((len f)-'1+2) = G*(i2'-'1,j2')
                              by A23,A43,FINSEQ_4:82;
                 end;
                 end;
               end;
               hence thesis by A8,A10,A11,A24;
             end;
             end;
           end;
           suppose
A45:          front_left_cell(f,(len f)-'1,G) misses C &
               front_right_cell(f,(len f)-'1,G) meets C;
            thus thesis
             proof per cases by A16;
              suppose
A46:              i1 = i2 & j1+1 = j2;
               take f1 = f^<*G*(i2,j2+1)*>;
                   now
                take i=i2 ,j=j2+1;
                thus f1 goes_straight (len f)-'1,G
                 proof let i1',j1',i2',j2' be Nat;
                  assume that
A47:                 [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A48:                 f1/.((len f)-'1) = G*(i1',j1') &
                    f1/.((len f)-'1+1) = G*(i2',j2');
                      f/.((len f)-'1) = G*(i1',j1') &
             f/.((len f)-'1+1) = G*(i2',j2') by A22,A48,FINSEQ_4:83;
then A49:                 i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                     by A14,A15,A47,GOBOARD1:21;
                  per cases by A16,A49;
                  case i1' = i2' & j1'+1 = j2';
                      now assume j2+1 > len G;
                   then j2+1 <= (len G)+1 & (len G)+1 <= j2+1
                     by A2,A18,XREAL_1:8,NAT_1:38;
                   then j2+1 = (len G)+1 by XXREAL_0:1;
                   then j2 = len G;
                   then cell(G,i1,len G) meets C
                    by A11,A12,A13,A14,A15,A45,A46,GOBRD13:36;
                   hence contradiction by A17,JORDAN8:18;
                  end;
                  hence [i2',j2'+1] in Indices G by A2,A18,A20,A49,GOBOARD7:10
;
                  thus f1/.((len f)-'1+2) = G*(i2',j2'+1)
                            by A23,A49,FINSEQ_4:82;
                  end;
                  case i1'+1 = i2' & j1' = j2';
                   hence thesis by A46,A49;
                  end;
                  case i1' = i2'+1 & j1' = j2';
                   hence thesis by A46,A49;
                  end;
                  case
A50:                i1' = i2' & j1' = j2'+1;
                  thus thesis by A46,A49,A50;
                 end;
                 end;
               end;
               hence thesis by A8,A10,A11,A45;
              end;
              suppose
A51:             i1+1 = i2 & j1 = j2;
               take f1 = f^<*G*(i2+1,j2)*>;
                   now
                take i=i2+1 ,j=j2;
                thus f1 goes_straight (len f)-'1,G
                 proof let i1',j1',i2',j2' be Nat;
                  assume that
A52:                 [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A53:                 f1/.((len f)-'1) = G*(i1',j1') &
                    f1/.((len f)-'1+1) = G*(i2',j2');
                      f/.((len f)-'1) = G*(i1',j1') &
                 f/.((len f)-'1+1) = G*(i2',j2') by A22,A53,FINSEQ_4:83;
then A54:                 i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                     by A14,A15,A52,GOBOARD1:21;
                  per cases by A16,A54;
                  case i1' = i2' & j1'+1 = j2';
                   hence thesis by A51,A54;
                  end;
                  case i1'+1 = i2' & j1' = j2';
                      now assume i2+1 > len G;
                   then i2+1 <= (len G)+1 & (len G)+1 <= i2+1
                     by A18,XREAL_1:8,NAT_1:38;
                   then i2+1 = (len G)+1 by XXREAL_0:1;
                   then i2 = len G;
                   then cell(G,len G,j1-'1) meets C
                     by A11,A12,A13,A14,A15,A45,A51,GOBRD13:38;
                   hence contradiction by A2,A19,JORDAN8:19;
                  end;
                  hence [i2'+1,j2'] in Indices G by A18,A20,A54,GOBOARD7:10;
                  thus f1/.((len f)-'1+2) = G*(i2'+1,j2')
                           by A23,A54,FINSEQ_4:82;
                  end;
                  case
A55:                i1' = i2'+1 & j1' = j2';
                  thus thesis by A51,A54,A55;
                  end;
                  case i1' = i2' & j1' = j2'+1;
                   hence thesis by A51,A54;
                 end;
                 end;
               end;
               hence thesis by A8,A10,A11,A45;
              end;
              suppose
A56:             i1 = i2+1 & j1 = j2;
               take f1 = f^<*G*(i2-'1,j2)*>;
                   now
                take i=i2-'1 ,j=j2;
                thus f1 goes_straight (len f)-'1,G
                 proof let i1',j1',i2',j2' be Nat;
                  assume that
A57:                 [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A58:                 f1/.((len f)-'1) = G*(i1',j1') &
                    f1/.((len f)-'1+1) = G*(i2',j2');
                      f/.((len f)-'1) = G*(i1',j1') &
                f/.((len f)-'1+1) = G*(i2',j2') by A22,A58,FINSEQ_4:83;
then A59:                 i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                     by A14,A15,A57,GOBOARD1:21;
                  per cases by A16,A59;
                  case i1' = i2' & j1'+1 = j2';
                   hence thesis by A56,A59;
                  end;
                  case
A60:                i1'+1 = i2' & j1' = j2';
                  thus thesis by A56,A59,A60;
                  end;
                  case i1' = i2'+1 & j1' = j2';
                      now assume i2-'1 < 1;
                   then i2-'1 = 0 by NAT_1:39;
                   then i2 <= 1 by BINARITH:54;
                   then i2 = 1 by A18,XXREAL_0:1;
                   then cell(G,1-'1,j1) meets C
                    by A11,A12,A13,A14,A15,A45,A56,GOBRD13:40;
                   then cell(G,0,j1) meets C by BINARITH:51;
                   hence contradiction by A2,A17,JORDAN8:21;
                  end;
                  hence [i2'-'1,j2'] in Indices G by A18,A21,A59,GOBOARD7:10;
                  thus f1/.((len f)-'1+2) = G*(i2'-'1,j2')
                            by A23,A59,FINSEQ_4:82;
                  end;
                  case i1' = i2' & j1' = j2'+1;
                   hence thesis by A56,A59;
                 end;
                 end;
               end;
               hence thesis by A8,A10,A11,A45;
              end;
              suppose
A61:             i1 = i2 & j1 = j2+1;
               take f1 = f^<*G*(i2,j2-'1)*>;
                   now
                take i=i2 ,j=j2-'1;
                thus f1 goes_straight (len f)-'1,G
                 proof let i1',j1',i2',j2' be Nat;
                  assume that
A62:                 [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A63:                 f1/.((len f)-'1) = G*(i1',j1') &
                    f1/.((len f)-'1+1) = G*(i2',j2');
                      f/.((len f)-'1) = G*(i1',j1') &
                f/.((len f)-'1+1) = G*(i2',j2') by A22,A63,FINSEQ_4:83;
then A64:                 i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                     by A14,A15,A62,GOBOARD1:21;
                  per cases by A16,A64;
                  case
A65:                i1' = i2' & j1'+1 = j2';
                  thus thesis by A61,A64,A65;
                  end;
                  case i1'+1 = i2' & j1' = j2';
                   hence thesis by A61,A64;
                  end;
                  case i1' = i2'+1 & j1' = j2';
                   hence thesis by A61,A64;
                  end;
                  case i1' = i2' & j1' = j2'+1;
                      now assume j2-'1 < 1;
                   then j2-'1 = 0 by NAT_1:39;
                   then j2 <= 1 by BINARITH:54;
                   then j2 = 1 by A18,XXREAL_0:1;
                   then cell(G,i1-'1,1-'1) meets C
                     by A11,A12,A13,A14,A15,A45,A61,GOBRD13:42;
                   then cell(G,i1-'1,0) meets C by BINARITH:51;
                   hence contradiction by A19,JORDAN8:20;
                  end;
                  hence [i2',j2'-'1] in Indices G by A18,A21,A64,GOBOARD7:10;
                  thus f1/.((len f)-'1+2) = G*(i2',j2'-'1)
                            by A23,A64,FINSEQ_4:82;
                 end;
                 end;
               end;
               hence thesis by A8,A10,A11,A45;
             end;
             end;
           end;
           suppose
A66:          front_left_cell(f,(len f)-'1,G) meets C;
            thus thesis
             proof per cases by A16;
              suppose
A67:              i1 = i2 & j1+1 = j2;
               take f1 = f^<*G*(i2-'1,j2)*>;
                   now
                take i=i2-'1 ,j=j2;
                thus f1 turns_left (len f)-'1,G
                 proof let i1',j1',i2',j2' be Nat;
                  assume that
A68:                 [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A69:                 f1/.((len f)-'1) = G*(i1',j1') &
                    f1/.((len f)-'1+1) = G*(i2',j2');
                      f/.((len f)-'1) = G*(i1',j1') &
               f/.((len f)-'1+1) = G*(i2',j2') by A22,A69,FINSEQ_4:83;
then A70:                 i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                     by A14,A15,A68,GOBOARD1:21;
                  per cases by A16,A70;
                  case i1' = i2' & j1'+1 = j2';
                      now assume i2-'1 < 1;
                   then i2-'1 = 0 by NAT_1:39;
                   then i2 <= 1 by BINARITH:54;
                   then i2 = 1 by A18,XXREAL_0:1;
                   then cell(G,1-'1,j2) meets C
                    by A11,A12,A13,A14,A15,A66,A67,GOBRD13:35;
                   then cell(G,0,j2) meets C by BINARITH:51;
                   hence contradiction by A2,A18,JORDAN8:21;
                  end;
                  hence [i2'-'1,j2'] in Indices G by A18,A21,A70,GOBOARD7:10;
                  thus f1/.((len f)-'1+2) = G*(i2'-'1,j2')
                            by A23,A70,FINSEQ_4:82;
                  end;
                  case i1'+1 = i2' & j1' = j2';
                   hence thesis by A67,A70;
                  end;
                  case i1' = i2'+1 & j1' = j2';
                   hence thesis by A67,A70;
                  end;
                  case
A71:                i1' = i2' & j1' = j2'+1;
                  thus thesis by A67,A70,A71;
                 end;
                 end;
               end;
               hence thesis by A8,A10,A11,A66;
              end;
              suppose
A72:             i1+1 = i2 & j1 = j2;
               take f1 = f^<*G*(i2,j2+1)*>;
                   now
                take i=i2 ,j=j2+1;
                thus f1 turns_left (len f)-'1,G
                 proof let i1',j1',i2',j2' be Nat;
                  assume that
A73:                 [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A74:                 f1/.((len f)-'1) = G*(i1',j1') &
                    f1/.((len f)-'1+1) = G*(i2',j2');
                      f/.((len f)-'1) = G*(i1',j1') &
                f/.((len f)-'1+1) = G*(i2',j2') by A22,A74,FINSEQ_4:83;
then A75:                 i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                     by A14,A15,A73,GOBOARD1:21;
                  per cases by A16,A75;
                  case i1' = i2' & j1'+1 = j2';
                   hence thesis by A72,A75;
                  end;
                  case i1'+1 = i2' & j1' = j2';
                      now assume j2+1 > len G;
                   then j2+1 <= (len G)+1 & (len G)+1 <= j2+1
                      by A2,A18,XREAL_1:8,NAT_1:38;
                   then j2+1 = (len G)+1 by XXREAL_0:1;
                   then j2 = len G;
                   then cell(G,i2,len G) meets C
                     by A11,A12,A13,A14,A15,A66,A72,GOBRD13:37;
                   hence contradiction by A18,JORDAN8:18;
                  end;
                  hence [i2',j2'+1] in Indices G by A2,A18,A20,A75,GOBOARD7:10
;
                  thus f1/.((len f)-'1+2) = G*(i2',j2'+1)
                            by A23,A75,FINSEQ_4:82;
                  end;
                  case
A76:                i1' = i2'+1 & j1' = j2';
                  thus thesis by A72,A75,A76;
                  end;
                  case i1' = i2' & j1' = j2'+1;
                   hence thesis by A72,A75;
                 end;
                 end;
               end;
               hence thesis by A8,A10,A11,A66;
              end;
              suppose
A77:             i1 = i2+1 & j1 = j2;
               take f1 = f^<*G*(i2,j2-'1)*>;
                   now
                take i=i2 ,j=j2-'1;
                thus f1 turns_left (len f)-'1,G
                 proof let i1',j1',i2',j2' be Nat;
                  assume that
A78:                 [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A79:                 f1/.((len f)-'1) = G*(i1',j1') &
                    f1/.((len f)-'1+1) = G*(i2',j2');
                      f/.((len f)-'1) = G*(i1',j1') &
               f/.((len f)-'1+1) = G*(i2',j2') by A22,A79,FINSEQ_4:83;
then A80:                 i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                     by A14,A15,A78,GOBOARD1:21;
                  per cases by A16,A80;
                  case i1' = i2' & j1'+1 = j2';
                   hence thesis by A77,A80;
                  end;
                  case
A81:                i1'+1 = i2' & j1' = j2';
                  thus thesis by A77,A80,A81;
                  end;
                  case i1' = i2'+1 & j1' = j2';
                      now assume j2-'1 < 1;
                   then j2-'1 = 0 by NAT_1:39;
                   then j2 <= 1 by BINARITH:54;
                   then j2 = 1 by A18,XXREAL_0:1;
                   then cell(G,i2-'1,1-'1) meets C
                     by A11,A12,A13,A14,A15,A66,A77,GOBRD13:39;
                   then cell(G,i2-'1,0) meets C by BINARITH:51;
                   hence contradiction by A21,JORDAN8:20;
                  end;
                  hence [i2',j2'-'1] in Indices G by A18,A21,A80,GOBOARD7:10;
                  thus f1/.((len f)-'1+2) = G*(i2',j2'-'1)
                            by A23,A80,FINSEQ_4:82;
                  end;
                  case i1' = i2' & j1' = j2'+1;
                   hence thesis by A77,A80;
                 end;
                 end;
               end;
               hence thesis by A8,A10,A11,A66;
              end;
              suppose
A82:             i1 = i2 & j1 = j2+1;
               take f1 = f^<*G*(i2+1,j2)*>;
                   now
                take i=i2+1 ,j=j2;
                thus f1 turns_left (len f)-'1,G
                 proof let i1',j1',i2',j2' be Nat;
                  assume that
A83:                 [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A84:                 f1/.((len f)-'1) = G*(i1',j1') &
                    f1/.((len f)-'1+1) = G*(i2',j2');
                      f/.((len f)-'1) = G*(i1',j1') &
                f/.((len f)-'1+1) = G*(i2',j2') by A22,A84,FINSEQ_4:83;
then A85:                 i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                     by A14,A15,A83,GOBOARD1:21;
                  per cases by A16,A85;
                  case
A86:                  i1' = i2' & j1'+1 = j2';
                  thus thesis by A82,A85,A86;
                  end;
                  case i1'+1 = i2' & j1' = j2';
                   hence thesis by A82,A85;
                  end;
                  case i1' = i2'+1 & j1' = j2';
                   hence thesis by A82,A85;
                  end;
                  case i1' = i2' & j1' = j2'+1;
                      now assume i2+1 > len G;
                   then i2+1 <= (len G)+1 & (len G)+1 <= i2+1
                    by A18,XREAL_1:8,NAT_1:38;
                   then i2+1 = (len G)+1 by XXREAL_0:1;
                   then i2 = len G;
                   then cell(G,len G,j2-'1) meets C
                     by A11,A12,A13,A14,A15,A66,A82,GOBRD13:41;
                   hence contradiction by A2,A21,JORDAN8:19;
                  end;
                  hence [i2'+1,j2'] in Indices G by A18,A20,A85,GOBOARD7:10;
                  thus f1/.((len f)-'1+2) = G*(i2'+1,j2')
                            by A23,A85,FINSEQ_4:82;
                 end;
                 end;
               end;
               hence thesis by A8,A10,A11,A66;
             end;
             end;
          end;
          end;
         end;
         suppose
A87:         not f is_sequence_on G or right_cell(f,len f-'1,G) misses C;
          take f^<*G*(1,1)*>;
          thus thesis by A8,A10,A87;
       end;
       end;
      end;
      suppose
A88:      len f <> k;
       take {};
       thus thesis by A8,A88;
     end;
     end;
    end;
    suppose
A89:    k > 1 & x is not FinSequence of TOP-REAL 2;
     take {};
     thus thesis by A89;
   end;
   end;
  consider F being Function such that
A90:   dom F = NAT and
A91:   F.0 = {} and
A92:   for k being Element of NAT holds P[k,F.k,F.(k+1)] from LATTICE5:sch 1
(A3);
defpred P[Nat] means F.$1 is FinSequence of TOP-REAL 2;
A93:   {} = <*>(the carrier of TOP-REAL 2);
then A94:  P[0] by A91;
A95:  for k st P[k] holds P[k+1]
   proof let k such that
A96:   F.k is FinSequence of TOP-REAL 2;
A97:   P[k,F.k,F.(k+1)] by A92;
    per cases by CQC_THE1:2;
     suppose k = 0;
      hence F.(k+1) is FinSequence of TOP-REAL 2 by A97;
     end;
     suppose k = 1;
      hence F.(k+1) is FinSequence of TOP-REAL 2 by A97;
     end;
     suppose
A98:     k > 1;
      thus thesis
      proof
        reconsider f = F.k as FinSequence of TOP-REAL 2 by A96;
       per cases;
        suppose
A99:        len f = k;
          thus thesis
          proof per cases;
           suppose f is_sequence_on G & right_cell(f,len f-'1,G) meets C
;
            then (front_left_cell(f,(len f)-'1,G) misses C &
              front_right_cell(f,(len f)-'1,G) misses C
             implies ex i,j st
                 f^<*G*(i,j)*> turns_right (len f)-'1,G &
               F.(k+1) = f^<*G*(i,j)*>) &
            (front_left_cell(f,(len f)-'1,G) misses C &
              front_right_cell(f,(len f)-'1,G) meets C
             implies ex i,j st
                 f^<*G*(i,j)*> goes_straight (len f)-'1,G &
               F.(k+1) = f^<*G*(i,j)*>) &
            (front_left_cell(f,(len f)-'1,G) meets C
             implies ex i,j st
                 f^<*G*(i,j)*> turns_left (len f)-'1,G &
               F.(k+1) = f^<*G*(i,j)*>) by A92,A98,A99;
            hence F.(k+1) is FinSequence of TOP-REAL 2;
           end;
           suppose
A100:           not f is_sequence_on G or right_cell(f,len f-'1,G) misses C;
                 f^<*G*(1,1)*> is FinSequence of TOP-REAL 2;
            hence F.(k+1) is FinSequence of TOP-REAL 2
             by A92,A98,A99,A100;
          end;
          end;
        end;
        suppose len f <> k;
         hence F.(k+1) is FinSequence of TOP-REAL 2 by A92,A93,A98;
      end;
      end;
   end;
   end;

A101:  for k holds P[k] from NAT_1:sch 1(A94,A95);
       rng F c= (the carrier of TOP-REAL 2)*
    proof let y be set;
     assume y in rng F;
     then ex x being set st x in dom F & F.x = y by FUNCT_1:def 5;
     then y is FinSequence of TOP-REAL 2 by A90,A101;
     hence thesis by FINSEQ_1:def 11;
    end;
  then reconsider F as Function of NAT,(the carrier of TOP-REAL 2)*
   by A90,FUNCT_2:def 1,RELSET_1:11;
   defpred P[Nat] means len(F.$1) = $1;
A102:  P[0] by A91,FINSEQ_1:25;
A103:  for k st P[k] holds P[k+1]
    proof let k such that
A104:   len(F.k) = k;
A105:   P[k,F.k,F.(k+1)] by A92;
     per cases by CQC_THE1:2;
     suppose k = 0;
      hence thesis by A105,FINSEQ_1:56;
     end;
     suppose k = 1;
      hence thesis by A105,FINSEQ_1:61;
     end;
     suppose
A106:     k > 1;
      thus thesis
      proof per cases;
       suppose
         F.k is_sequence_on G & right_cell(F.k,len(F.k)-'1,G) meets C;
            then (front_left_cell(F.k,(len(F.k))-'1,G) misses C &
              front_right_cell(F.k,(len(F.k))-'1,G) misses C
             implies ex i,j st
                 (F.k)^<*G*(i,j)*> turns_right (len(F.k))-'1,G &
               F.(k+1) = (F.k)^<*G*(i,j)*>) &
            (front_left_cell(F.k,(len(F.k))-'1,G) misses C &
              front_right_cell(F.k,(len(F.k))-'1,G) meets C
             implies ex i,j st
                 (F.k)^<*G*(i,j)*> goes_straight (len(F.k))-'1,G &
               F.(k+1) = (F.k)^<*G*(i,j)*>) &
            (front_left_cell(F.k,(len(F.k))-'1,G) meets C
             implies ex i,j st
                 (F.k)^<*G*(i,j)*> turns_left (len(F.k))-'1,G &
               F.(k+1) = (F.k)^<*G*(i,j)*>) by A92,A104,A106;
            hence thesis by A104,FINSEQ_2:19;
       end;
       suppose
            not F.k is_sequence_on G or right_cell(F.k,len(F.k)-'1,G) misses C;
        then F.(k+1) = (F.k)^<*G*(1,1)*> by A92,A104,A106;
        hence thesis by A104,FINSEQ_2:19;
      end;
      end;
    end;
    end;

A107:   for k holds P[k] from NAT_1:sch 1(A102,A103);
defpred P[Nat] means
F.$1 is_sequence_on G &
      for m st 1 <= m & m+1 <= len(F.$1)
       holds left_cell(F.$1,m,G) misses C & right_cell(F.$1,m,G) meets C;
A108:
  P[0] proof
        (for n st n in dom(F.0) ex i,j st [i,j] in Indices G &
      (F.0)/.n = G*(i,j)) &
    (for n st n in dom(F.0) & n+1 in dom(F.0) holds
      for m,k,i,j st [m,k] in Indices G & [i,j] in Indices G &
                    (F.0)/.n = G*(m,k) & (F.0)/.(n+1) = G*(i,j) holds
      abs(m-i)+abs(k-j) = 1) by A91,RELAT_1:60;
   hence F.0 is_sequence_on G by GOBOARD1:def 11;
   let m; assume
A109:  1 <= m & m+1 <= len(F.0);
       1 <= m+1 by NAT_1:37;
   then 1 <= len(F.0) by A109,XXREAL_0:2;
   then 1 <= 0 by A91,FINSEQ_1:25;
   hence left_cell(F.0,m,G) misses C &
           right_cell(F.0,m,G) meets C;
  end;
A110: now let k such that
A111:   F.k is_sequence_on G and
A112:   for m st 1 <= m & m+1 <= len(F.k)
        holds left_cell(F.k,m,G) misses C &
            right_cell(F.k,m,G) meets C and
A113:   k > 1;
     let i1,j1,i2,j2 be Nat such that
A114:   [i1,j1] in Indices G & (F.k)/.((len(F.k)) -'1) = G*(i1,j1) and
A115:   [i2,j2] in Indices G & (F.k)/.len(F.k) = G*(i2,j2);
A116:   len(F.k) = k by A107;
then A117:   1 <= (len(F.k))-'1 by A113,JORDAN3:12;
A118:   (len(F.k)) -'1 +1 = len(F.k) by A113,A116,BINARITH:53;
then A119:  left_cell(F.k,(len(F.k))-'1,G) misses C &
       right_cell(F.k,(len(F.k))-'1,G) meets C by A112,A117;
A120:   1 <= i1 & i1 <= len G & 1 <= j1 & j1 <= width G by A114,GOBOARD5:1;
A121:   1 <= i2 & i2 <= len G & 1 <= j2 & j2 <= width G by A115,GOBOARD5:1;
A122:  i1-'1 <= len G & j1-'1 <= width G by A120,JORDAN3:7;
A123:   1 <= i2+1 & 1 <= j2+1 by NAT_1:37;
A124:  i2-'1 <= len G & j2-'1 <= width G by A121,JORDAN3:7;
     hereby assume
A125:     i1 = i2 & j1+1 = j2;
           now assume i2+1 > len G;
        then i2+1 <= (len G)+1 & (len G)+1 <= i2+1 by A121,XREAL_1:8,NAT_1:38;
        then i2+1 = (len G)+1 by XXREAL_0:1;
        then i2 = len G;
        then cell(G,len G,j1) meets C
          by A111,A114,A115,A117,A118,A119,A125,GOBRD13:23;
        hence contradiction by A2,A120,JORDAN8:19;
       end;
      hence [i2+1,j2] in Indices G by A121,A123,GOBOARD7:10;
     end;
     hereby assume
A126:     i1+1 = i2 & j1 = j2;
           now assume j2-'1 < 1;
        then j2-'1 = 0 by NAT_1:39;
        then j2 <= 1 by BINARITH:54;
        then j2 = 1 by A121,XXREAL_0:1;
        then cell(G,i1,1-'1) meets C by A111,A114,A115,A117,A118,A119,A126,
GOBRD13:25;
        then cell(G,i1,0) meets C by BINARITH:51;
        hence contradiction by A120,JORDAN8:20;
       end;
      hence [i2,j2-'1] in Indices G by A121,A124,GOBOARD7:10;
     end;
     hereby assume
A127:     i1 = i2+1 & j1 = j2;
           now assume j2+1 > len G;
        then j2+1 <= (len G)+1 & (len G)+1 <=
 j2+1 by A2,A121,XREAL_1:8,NAT_1:38;
        then j2+1 = (len G)+1 by XXREAL_0:1;
        then j2 = len G;
        then cell(G,i2,len G) meets C by A111,A114,A115,A117,A118,A119,A127,
GOBRD13:27;
        hence contradiction by A121,JORDAN8:18;
       end;
      hence [i2,j2+1] in Indices G by A2,A121,A123,GOBOARD7:10;
     end;
     hereby assume
A128:     i1 = i2 & j1 = j2+1;
           now assume i2-'1 < 1;
        then i2-'1 = 0 by NAT_1:39;
        then i2 <= 1 by BINARITH:54;
        then i2 = 1 by A121,XXREAL_0:1;
        then cell(G,1-'1,j2) meets C by A111,A114,A115,A117,A118,A119,A128,
GOBRD13:29;
        then cell(G,0,j2) meets C by BINARITH:51;
        hence contradiction by A2,A121,JORDAN8:21;
       end;
      hence [i2-'1,j2] in Indices G by A121,A124,GOBOARD7:10;
     end;
     hereby assume that
A129:     front_right_cell(F.k,(len(F.k))-'1,G) meets C and
A130:     i1 = i2 & j1+1 = j2;
           now assume j2+1 > len G;
        then j2+1 <= (len G)+1 & (len G)+1 <=
 j2+1 by A2,A121,XREAL_1:8,NAT_1:38;
        then j2+1 = (len G)+1 by XXREAL_0:1;
        then j2 = len G;
        then cell(G,i1,len G) meets C by A111,A114,A115,A117,A118,A129,A130,
GOBRD13:36;
        hence contradiction by A120,JORDAN8:18;
       end;
      hence [i2,j2+1] in Indices G by A2,A121,A123,GOBOARD7:10;
     end;
     hereby assume that
A131:     front_right_cell(F.k,(len(F.k))-'1,G) meets C and
A132:     i1+1 = i2 & j1 = j2;
           now assume i2+1 > len G;
        then i2+1 <= (len G)+1 & (len G)+1 <= i2+1 by A121,XREAL_1:8,NAT_1:38;
        then i2+1 = (len G)+1 by XXREAL_0:1;
        then i2 = len G;
        then cell(G,len G,j1-'1) meets C
         by A111,A114,A115,A117,A118,A131,A132,GOBRD13:38;
        hence contradiction by A2,A122,JORDAN8:19;
       end;
      hence [i2+1,j2] in Indices G by A121,A123,GOBOARD7:10;
     end;
     hereby assume that
A133:     front_right_cell(F.k,(len(F.k))-'1,G) meets C and
A134:     i1 = i2+1 & j1 = j2;
           now assume i2-'1 < 1;
        then i2-'1 = 0 by NAT_1:39;
        then i2 <= 1 by BINARITH:54;
        then i2 = 1 by A121,XXREAL_0:1;
        then cell(G,1-'1,j1) meets C by A111,A114,A115,A117,A118,A133,A134,
GOBRD13:40;
        then cell(G,0,j1) meets C by BINARITH:51;
        hence contradiction by A2,A120,JORDAN8:21;
       end;
      hence [i2-'1,j2] in Indices G by A121,A124,GOBOARD7:10;
     end;
     hereby assume that
A135:     front_right_cell(F.k,(len(F.k))-'1,G) meets C and
A136:     i1 = i2 & j1 = j2+1;
           now assume j2-'1 < 1;
        then j2-'1 = 0 by NAT_1:39;
        then j2 <= 1 by BINARITH:54;
        then j2 = 1 by A121,XXREAL_0:1;
        then cell(G,i1-'1,1-'1) meets C
           by A111,A114,A115,A117,A118,A135,A136,GOBRD13:42;
        then cell(G,i1-'1,0) meets C by BINARITH:51;
        hence contradiction by A122,JORDAN8:20;
       end;
      hence [i2,j2-'1] in Indices G by A121,A124,GOBOARD7:10;
     end;
     hereby assume that
A137:     front_left_cell(F.k,(len(F.k))-'1,G) meets C and
A138:     i1 = i2 & j1+1 = j2;
           now assume i2-'1 < 1;
        then i2-'1 = 0 by NAT_1:39;
        then i2 <= 1 by BINARITH:54;
        then i2 = 1 by A121,XXREAL_0:1;
        then cell(G,1-'1,j2) meets C by A111,A114,A115,A117,A118,A137,A138,
GOBRD13:35;
        then cell(G,0,j2) meets C by BINARITH:51;
        hence contradiction by A2,A121,JORDAN8:21;
       end;
      hence [i2-'1,j2] in Indices G by A121,A124,GOBOARD7:10;
     end;
     hereby assume that
A139:     front_left_cell(F.k,(len(F.k))-'1,G) meets C and
A140:     i1+1 = i2 & j1 = j2;
           now assume j2+1 > len G;
        then j2+1 <= (len G)+1 & (len G)+1 <=
 j2+1 by A2,A121,XREAL_1:8,NAT_1:38;
        then j2+1 = (len G)+1 by XXREAL_0:1;
        then j2 = len G;
        then cell(G,i2,len G) meets C by A111,A114,A115,A117,A118,A139,A140,
GOBRD13:37;
        hence contradiction by A121,JORDAN8:18;
       end;
      hence [i2,j2+1] in Indices G by A2,A121,A123,GOBOARD7:10;
     end;
     hereby assume that
A141:     front_left_cell(F.k,(len(F.k))-'1,G) meets C and
A142:     i1 = i2+1 & j1 = j2;
           now assume j2-'1 < 1;
        then j2-'1 = 0 by NAT_1:39;
        then j2 <= 1 by BINARITH:54;
        then j2 = 1 by A121,XXREAL_0:1;
        then cell(G,i2-'1,1-'1) meets C
           by A111,A114,A115,A117,A118,A141,A142,GOBRD13:39;
        then cell(G,i2-'1,0) meets C by BINARITH:51;
        hence contradiction by A124,JORDAN8:20;
       end;
      hence [i2,j2-'1] in Indices G by A121,A124,GOBOARD7:10;
     end;
     hereby assume that
A143:     front_left_cell(F.k,(len(F.k))-'1,G) meets C and
A144:     i1 = i2 & j1 = j2+1;
           now assume i2+1 > len G;
        then i2+1 <= (len G)+1 & (len G)+1 <= i2+1 by A121,XREAL_1:8,NAT_1:38;
        then i2+1 = (len G)+1 by XXREAL_0:1;
        then i2 = len G;
        then cell(G,len G,j2-'1) meets C
         by A111,A114,A115,A117,A118,A143,A144,GOBRD13:41;
        hence contradiction by A2,A124,JORDAN8:19;
       end;
      hence [i2+1,j2] in Indices G by A121,A123,GOBOARD7:10;
     end;
    end;
A145: for k st P[k] holds P[k+1]
   proof let k such that
A146:   F.k is_sequence_on G and
A147:   for m st 1 <= m & m+1 <= len(F.k)
        holds left_cell(F.k,m,G) misses C & right_cell(F.k,m,G) meets C;
A148:   len(F.k) = k by A107;
A149:   len(F.(k+1)) = k+1 by A107;
A150:   1 <= len G by A2,NAT_1:37;
A151:   2|^n > 0 by NEWTON:102;
    per cases by CQC_THE1:2;
    suppose
A152:   k = 0; then consider i such that
A153:   1 <= i & i+1 <= len G and
            N-min C in cell(G,i,width G-'1) & N-min C <> G*(i,width G-'1) and
A154:   F.(k+1) = <*G*(i,width G)*> by A92;
          i < len G by A153,NAT_1:38;
then A155:   [i,len G] in Indices G by A2,A150,A153,GOBOARD7:10;
A156:   now let l;
       assume l in dom(F.(k+1));
       then 1 <= l & l <= 1 by A149,A152,FINSEQ_3:27;
       then l = 1 by XXREAL_0:1;
       then (F.(k+1))/.l = G*(i,width G) by A154,FINSEQ_4:25;
       hence ex i,j st [i,j] in Indices G & (F.(k+1))/.l = G*
(i,j) by A2,A155;
      end;
         now let l;
      assume l in dom(F.(k+1)) & l+1 in dom(F.(k+1));
      then 1 <= l & l <= 1 & 1 <= l+1 & l+1 <= 1 by A149,A152,FINSEQ_3:27;
      then l = 1 & 1 = l+1 by XXREAL_0:1;
      hence for i1,j1,i2,j2 st [i1,j1] in Indices G & [i2,j2] in Indices G &
                    (F.(k+1))/.l = G*(i1,j1) & (F.(k+1))/.(l+1) = G*(i2,j2)
       holds abs(i1-i2)+abs(j1-j2) = 1;
     end;
     hence F.(k+1) is_sequence_on G by A156,GOBOARD1:def 11;
     let m;
     assume
A157:   1 <= m & m+1 <= len(F.(k+1));
         1 <= m+1 by NAT_1:37;
     then m+1 = 0+1 by A149,A152,A157,XXREAL_0:1;
     then m = 0;
     hence left_cell(F.(k+1),m,G) misses C &
              right_cell(F.(k+1),m,G) meets C by A157;
    end;
    suppose
A158:   k = 1; then consider i such that
A159:   1 <= i & i+1 <= len G and
A160:   N-min C in cell(G,i,width G-'1) & N-min C <> G*(i,width G-'1) and
A161:   F.(k+1) = <*G*(i,width G),G*(i+1,width G)*> by A92;
A162:   (F.(k+1))/.1 = G*(i,width G) & (F.(k+1))/.2 = G*(i+1,width G)
        by A161,FINSEQ_4:26;
A163:  i < len G & 1 <= i+1 & i+1 <= len G by A159,NAT_1:38;
then A164:   [i,len G] in Indices G & [i+1,len G] in Indices G
        by A2,A150,A159,GOBOARD7:10;
A165:   now let l;
       assume A166: l in dom(F.(k+1));
       then 1 <= l & l <= 2 by A149,A158,FINSEQ_3:27;
       then l = 0 or l = 1 or l = 2 by CQC_THE1:3;
       hence ex i,j st [i,j] in Indices G & (F.(k+1))/.l = G*(i,j)
         by A2,A162,A164,A166,FINSEQ_3:27;
      end;
         now let l;
      assume A167: l in dom(F.(k+1)) & l+1 in dom(F.(k+1));
      then 1 <= l & l <= 2 & 1 <= l+1 & l+1 <= 2 by A149,A158,FINSEQ_3:27;
      then A168: l = 0 or l = 1 or l = 2 by CQC_THE1:3;
      let i1,j1,i2,j2 such that
A169:      [i1,j1] in Indices G & [i2,j2] in Indices G &
        (F.(k+1))/.l = G*(i1,j1) & (F.(k+1))/.(l+1) = G*(i2,j2);
           i1 = i & j1 = len G & i2 = i+1 & j2 = len G
         by A2,A149,A158,A162,A164,A167,A168,A169,FINSEQ_3:27,GOBOARD1:21;
      then abs(i2-i1) = 1 & abs(j1-j2) = 0 by ABSVALUE:def 1;
      hence abs(i1-i2)+abs(j1-j2) = 1 by UNIFORM1:13;
     end;
     hence
A170:    F.(k+1) is_sequence_on G by A165,GOBOARD1:def 11;
     let m;
     assume
A171:   1 <= m & m+1 <= len(F.(k+1));
     then 1+1 <= m+1 by XREAL_1:8;
     then m+1 = 1+1 by A149,A158,A171,XXREAL_0:1;
then A172:  m = 1;
A173:  i < i+1 & i+1 < (i+1)+1 by NAT_1:38;
then A174:   left_cell(F.(k+1),m,G) = cell(G,i,len G)
        by A2,A162,A164,A170,A171,A172,GOBRD13:def 3;
         now assume left_cell(F.(k+1),m,G) meets C;
      then consider p being set such that
A175:     p in cell(G,i,len G) & p in C by A174,XBOOLE_0:3;
      reconsider p as Point of TOP-REAL 2 by A175;
       reconsider p as Element of TOP-REAL 2;
          cell(G,i,len G) = { |[r,s]|: G*(i,1)`1 <= r & r <= G*(i+1,1)`1 &
                                  G*(1,len G)`2 <= s }
       by A2,A159,A163,GOBRD11:31;
      then consider r,s such that
A176:     p = |[r,s]| and
            G*(i,1)`1 <= r & r <= G*(i+1,1)`1 and
A177:     G*(1,len G)`2 <= s by A175;
          [1,len G] in Indices G by A2,A150,GOBOARD7:10;
then A178:     G*
(1,len G) = |[W+((E-W)/(2|^n))*(1-2),S+((N-S)/(2|^n))*((len G)-2)]|
         by JORDAN8:def 1;
       (len G) - 2 = 2|^n+1 by A2;
       then A179: ((N-S)/(2|^n))*((len G)-2)
           = ((N-S)/(2|^n))*(2|^n+1)
          .= ((N-S)/(2|^n))*(2|^n)+((N-S)/(2|^n))*1
          .= (N-S)+(N-S)/(2|^n) by A151,XCMPLX_1:88;
A180:     G*(1,len G)`2 = S+((N-S)/(2|^n))*((len G)-2) by A178,EUCLID:56;
           N > S by JORDAN8:12;
       then N-S > S-S by XREAL_1:11;
       then (N-S)/(2|^n) > 0 by A151,REAL_2:127;
       then N+0 < N+(N-S)/(2|^n) by XREAL_1:8;
then A181:     N < s by A177,A179,A180,XXREAL_0:2;
           p`2 <= N by A175,PSCOMP_1:71;
      hence contradiction by A176,A181,EUCLID:56;
     end;
     hence left_cell(F.(k+1),m,G) misses C;
A182:   N-min C in C by SPRECT_1:13;
         N-min C in right_cell(F.(k+1),m,G)
      by A2,A160,A162,A164,A170,A171,A172,A173,GOBRD13:def 2;
     hence right_cell(F.(k+1),m,G) meets C by A182,XBOOLE_0:3;
    end;
    suppose
A183:   k > 1;
    then k > 0;
then A184:   F.k is non empty by A148,FINSEQ_1:25;
A185:   1 <= (len(F.k))-'1 by A148,A183,JORDAN3:12;
A186:   (len(F.k)) -'1 +1 = len(F.k) by A148,A183,BINARITH:53;
     then consider i1,j1,i2,j2 being Nat such that
A187:   [i1,j1] in Indices G & (F.k)/.((len(F.k)) -'1) = G*(i1,j1) and
A188:   [i2,j2] in Indices G & (F.k)/.len(F.k) = G*(i2,j2) and
          i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
        i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A146,A185,JORDAN8:6;
A189:   1 <= i2 & i2 <= len G & 1 <= j2 & j2 <= width G by A188,GOBOARD5:1;
          (len(F.k))-'1 <= len(F.k) by BINARITH:52;
then A190:  (len(F.k))-'1 in dom(F.k) & len(F.k) in dom(F.k)
        by A148,A183,A185,FINSEQ_3:27;
A191:  (len(F.k))-'1+(1+1) = (len(F.k))+1 by A186;
A192:  left_cell(F.k,(len(F.k))-'1,G) misses C &
       right_cell(F.k,(len(F.k))-'1,G) meets C by A147,A185,A186;
A193: i1 = i2 & j1+1 = j2 implies [i2+1,j2] in Indices G by A110,A146,A147,A183
,A187,A188;
A194: i1+1 = i2 & j1 = j2 implies [i2,j2-'1] in Indices G by A110,A146,A147
,A183,A187,A188;
A195: i1 = i2+1 & j1 = j2 implies [i2,j2+1] in Indices G by A110,A146,A147,A183
,A187,A188;
A196: i1 = i2 & j1 = j2+1 implies [i2-'1,j2] in Indices G by A110,A146,A147
,A183,A187,A188;
A197: front_right_cell(F.k,(len(F.k))-'1,G) meets C &
     i1 = i2 & j1+1 = j2 implies [i2,j2+1] in Indices G by A110,A146,A147,A183
,A187,A188;
A198: front_right_cell(F.k,(len(F.k))-'1,G) meets C &
     i1+1 = i2 & j1 = j2 implies [i2+1,j2] in Indices G by A110,A146,A147,A183
,A187,A188;
A199: front_right_cell(F.k,(len(F.k))-'1,G) meets C &
     i1 = i2+1 & j1 = j2 implies [i2-'1,j2] in Indices G by A110,A146,A147,A183
,A187,A188;
A200: front_right_cell(F.k,(len(F.k))-'1,G) meets C &
     i1 = i2 & j1 = j2+1 implies [i2,j2-'1] in Indices G by A110,A146,A147,A183
,A187,A188;
A201: front_left_cell(F.k,(len(F.k))-'1,G) meets C &
     i1 = i2 & j1+1 = j2 implies [i2-'1,j2] in Indices G by A110,A146,A147,A183
,A187,A188;
A202: front_left_cell(F.k,(len(F.k))-'1,G) meets C &
     i1+1 = i2 & j1 = j2 implies [i2,j2+1] in Indices G by A110,A146,A147,A183
,A187,A188;
A203: front_left_cell(F.k,(len(F.k))-'1,G) meets C &
     i1 = i2+1 & j1 = j2 implies [i2,j2-'1] in Indices G by A110,A146,A147,A183
,A187,A188;
A204: front_left_cell(F.k,(len(F.k))-'1,G) meets C &
     i1 = i2 & j1 = j2+1 implies [i2+1,j2] in Indices G by A110,A146,A147,A183
,A187,A188;
   thus
A205: F.(k+1) is_sequence_on G
      proof
       per cases;
       suppose front_left_cell(F.k,(len(F.k))-'1,G) misses C &
            front_right_cell(F.k,(len(F.k))-'1,G) misses C;
        then consider i,j such that
A206:       (F.k)^<*G*(i,j)*> turns_right (len(F.k))-'1,G and
A207:       F.(k+1) = (F.k)^<*G*(i,j)*> by A92,A146,A148,A183,A192;
        thus thesis
         proof set f = (F.k)^<*G*(i,j)*>;
A208:       f/.(len(F.k)-'1) = G*(i1,j1) & f/.len(F.k) = G*(i2,j2)
           by A187,A188,A190,FINSEQ_4:83;
A209:        f/.(len(F.k)+1) = G*(i,j) by FINSEQ_4:82;
          per cases by A186,A187,A188,A191,A206,A208,GOBRD13:def 6;
          suppose that
A210:         i1 = i2 & j1+1 = j2 and
A211:         f/.(len(F.k)+1) = G*(i2+1,j2);
               now let i1',j1',i2',j2' be Nat;
            assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
                (F.k)/.len(F.k) = G*(i1',j1') & G*(i2+1,j2) = G*(i2',j2');
             then i2 = i1' & j2 = j1' & i2+1 = i2' & j2 = j2'
                by A188,A193,A210,GOBOARD1:21;
             then abs(i2'-i1') = 1 & abs(j2'-j1') = 0 by ABSVALUE:def 1;
            hence abs(i2'-i1')+abs(j2'-j1') = 1;
           end;
           hence F.(k+1) is_sequence_on G by A146,A184,A193,A207,A209,A210,A211
,JORDAN8:9;
          end;
          suppose that
A212:          i1+1 = i2 & j1 = j2 and
A213:          f/.(len(F.k)+1) = G*(i2,j2-'1);
               now let i1',j1',i2',j2' be Nat;
            assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
              (F.k)/.len(F.k) = G*(i1',j1') & G*(i2,j2-'1) = G*
(i2',j2');
then A214:           i2 = i1' & j2 = j1' & i2 = i2' & j2-'1 = j2'
                by A188,A194,A212,GOBOARD1:21;
             then j1'-j2' = j2-(j2-1) by A189,BINARITH:50;
             then abs(i2'-i1') = 0 & abs(j1'-j2') = 1 by A214,ABSVALUE:def 1;
            hence abs(i2'-i1')+abs(j2'-j1') = 1 by UNIFORM1:13;
           end;
           hence F.(k+1) is_sequence_on G by A146,A184,A194,A207,A209,A212,A213
,JORDAN8:9;
          end;
          suppose that
A215:          i1 = i2+1 & j1 = j2 and
A216:          f/.(len(F.k)+1) = G*(i2,j2+1);
               now let i1',j1',i2',j2' be Nat;
            assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
                (F.k)/.len(F.k) = G*(i1',j1') & G*(i2,j2+1) = G*(i2',j2');
             then i2 = i1' & j2 = j1' & i2 = i2' & j2+1 = j2'
                by A188,A195,A215,GOBOARD1:21;
             then abs(i2'-i1') = 0 & abs(j2'-j1') = 1 by ABSVALUE:def 1;
            hence abs(i2'-i1')+abs(j2'-j1') = 1;
           end;
           hence F.(k+1) is_sequence_on G by A146,A184,A195,A207,A209,A215,A216
,JORDAN8:9;
          end;
          suppose that
A217:          i1 = i2 & j1 = j2+1 and
A218:          f/.(len(F.k)+1) = G*(i2-'1,j2);
               now let i1',j1',i2',j2' be Nat;
            assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
              (F.k)/.len(F.k) = G*(i1',j1') & G*(i2-'1,j2) = G*
(i2',j2');
then A219:           i2 = i1' & j2 = j1' & i2-'1 = i2' & j2 = j2'
                by A188,A196,A217,GOBOARD1:21;
             then i1'-i2' = i2-(i2-1) by A189,BINARITH:50;
             then abs(j2'-j1') = 0 & abs(i1'-i2') = 1 by A219,ABSVALUE:def 1;
            hence abs(i2'-i1')+abs(j2'-j1') = 1 by UNIFORM1:13;
           end;
           hence F.(k+1) is_sequence_on G by A146,A184,A196,A207,A209,A217,A218
,JORDAN8:9;
         end;
         end;
       end;
       suppose
A220:       front_left_cell(F.k,(len(F.k))-'1,G) misses C &
             front_right_cell(F.k,(len(F.k))-'1,G) meets C;
        then consider i,j such that
A221:       (F.k)^<*G*(i,j)*> goes_straight (len(F.k))-'1,G and
A222:       F.(k+1) = (F.k)^<*G*(i,j)*> by A92,A146,A148,A183,A192;
        thus thesis
         proof set f = (F.k)^<*G*(i,j)*>;
A223:       f/.(len(F.k)-'1) = G*(i1,j1) & f/.len(F.k) = G*(i2,j2)
           by A187,A188,A190,FINSEQ_4:83;
A224:        f/.(len(F.k)+1) = G*(i,j) by FINSEQ_4:82;
          per cases by A186,A187,A188,A191,A221,A223,GOBRD13:def 8;
          suppose that
A225:         i1 = i2 & j1+1 = j2 and
A226:         f/.(len(F.k)+1) = G*(i2,j2+1);
               now let i1',j1',i2',j2' be Nat;
            assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
                (F.k)/.len(F.k) = G*(i1',j1') & G*(i2,j2+1) = G*(i2',j2');
             then i2 = i1' & j2 = j1' & i2 = i2' & j2+1 = j2'
                by A188,A197,A220,A225,GOBOARD1:21;
             then abs(i2'-i1') = 0 & abs(j2'-j1') = 1 by ABSVALUE:def 1;
            hence abs(i2'-i1')+abs(j2'-j1') = 1;
           end;
          hence F.(k+1) is_sequence_on G by A146,A184,A197,A220,A222,A224,A225
,A226,JORDAN8:9;
          end;
          suppose that
A227:          i1+1 = i2 & j1 = j2 and
A228:          f/.(len(F.k)+1) = G*(i2+1,j2);
               now let i1',j1',i2',j2' be Nat;
            assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
              (F.k)/.len(F.k) = G*(i1',j1') & G*(i2+1,j2) = G*
(i2',j2');
              then i2 = i1' & j2 = j1' & i2+1 = i2' & j2 = j2'
                by A188,A198,A220,A227,GOBOARD1:21;
             then abs(i2'-i1') = 1 & abs(j2'-j1') = 0 by ABSVALUE:def 1;
            hence abs(i2'-i1')+abs(j2'-j1') = 1;
           end;
          hence F.(k+1) is_sequence_on G by A146,A184,A198,A220,A222,A224,A227
,A228,JORDAN8:9;
          end;
          suppose that
A229:          i1 = i2+1 & j1 = j2 and
A230:          f/.(len(F.k)+1) = G*(i2-'1,j2);
               now let i1',j1',i2',j2' be Nat;
            assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
                (F.k)/.len(F.k) = G*(i1',j1') & G*(i2-'1,j2) = G*(i2',j2');
             then A231:           i2 = i1' & j2 = j1' & i2-'1 = i2' & j2 = j2'
                by A188,A199,A220,A229,GOBOARD1:21;
             then i1'-i2' = i2-(i2-1) by A189,BINARITH:50;
             then abs(j2'-j1') = 0 & abs(i1'-i2') = 1 by A231,ABSVALUE:def 1;
            hence abs(i2'-i1')+abs(j2'-j1') = 1 by UNIFORM1:13;
           end;
          hence F.(k+1) is_sequence_on G by A146,A184,A199,A220,A222,A224,A229
,A230,JORDAN8:9;
          end;
          suppose that
A232:          i1 = i2 & j1 = j2+1 and
A233:          f/.(len(F.k)+1) = G*(i2,j2-'1);
               now let i1',j1',i2',j2' be Nat;
            assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
              (F.k)/.len(F.k) = G*(i1',j1') & G*(i2,j2-'1) = G*
(i2',j2');
then A234:           i2 = i1' & j2 = j1' & i2 = i2' & j2-'1 = j2'
                by A188,A200,A220,A232,GOBOARD1:21;
             then j1'-j2' = j2-(j2-1) by A189,BINARITH:50;
             then abs(i2'-i1') = 0 & abs(j1'-j2') = 1 by A234,ABSVALUE:def 1;
            hence abs(i2'-i1')+abs(j2'-j1') = 1 by UNIFORM1:13;
           end;
          hence F.(k+1) is_sequence_on G by A146,A184,A200,A220,A222,A224,A232
,A233,JORDAN8:9;
         end;
         end;
       end;
       suppose
A235:       front_left_cell(F.k,(len(F.k))-'1,G) meets C;
        then consider i,j such that
A236:       (F.k)^<*G*(i,j)*> turns_left (len(F.k))-'1,G and
A237:       F.(k+1) = (F.k)^<*G*(i,j)*> by A92,A146,A148,A183,A192;
        thus thesis
         proof set f = (F.k)^<*G*(i,j)*>;
A238:       f/.(len(F.k)-'1) = G*(i1,j1) & f/.len(F.k) = G*(i2,j2)
           by A187,A188,A190,FINSEQ_4:83;
A239:        f/.(len(F.k)+1) = G*(i,j) by FINSEQ_4:82;
          per cases by A186,A187,A188,A191,A236,A238,GOBRD13:def 7;
          suppose that
A240:         i1 = i2 & j1+1 = j2 and
A241:         f/.(len(F.k)+1) = G*(i2-'1,j2);
               now let i1',j1',i2',j2' be Nat;
            assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
                (F.k)/.len(F.k) = G*(i1',j1') & G*(i2-'1,j2) = G*(i2',j2');
             then A242:           i2 = i1' & j2 = j1' & i2-'1 = i2' & j2 = j2'
                by A188,A201,A235,A240,GOBOARD1:21;
             then i1'-i2' = i2-(i2-1) by A189,BINARITH:50;
             then abs(j2'-j1') = 0 & abs(i1'-i2') = 1 by A242,ABSVALUE:def 1;
            hence abs(i2'-i1')+abs(j2'-j1') = 1 by UNIFORM1:13;
           end;
          hence F.(k+1) is_sequence_on G by A146,A184,A201,A235,A237,A239,A240
,A241,JORDAN8:9;
          end;
          suppose that
A243:          i1+1 = i2 & j1 = j2 and
A244:          f/.(len(F.k)+1) = G*(i2,j2+1);
               now let i1',j1',i2',j2' be Nat;
            assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
              (F.k)/.len(F.k) = G*(i1',j1') & G*(i2,j2+1) = G*
(i2',j2');
              then i2 = i1' & j2 = j1' & i2 = i2' & j2+1 = j2'
                by A188,A202,A235,A243,GOBOARD1:21;
             then abs(i2'-i1') = 0 & abs(j2'-j1') = 1 by ABSVALUE:def 1;
            hence abs(i2'-i1')+abs(j2'-j1') = 1;
           end;
          hence F.(k+1) is_sequence_on G by A146,A184,A202,A235,A237,A239,A243
,A244,JORDAN8:9;
          end;
          suppose that
A245:          i1 = i2+1 & j1 = j2 and
A246:          f/.(len(F.k)+1) = G*(i2,j2-'1);
               now let i1',j1',i2',j2' be Nat;
            assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
                (F.k)/.len(F.k) = G*(i1',j1') & G*(i2,j2-'1) = G*(i2',j2');
             then A247:           i2 = i1' & j2 = j1' & i2 = i2' & j2-'1 = j2'
                by A188,A203,A235,A245,GOBOARD1:21;
             then j1'-j2' = j2-(j2-1) by A189,BINARITH:50;
             then abs(i2'-i1') = 0 & abs(j1'-j2') = 1 by A247,ABSVALUE:def 1;
            hence abs(i2'-i1')+abs(j2'-j1') = 1 by UNIFORM1:13;
           end;
          hence F.(k+1) is_sequence_on G by A146,A184,A203,A235,A237,A239,A245
,A246,JORDAN8:9;
          end;
          suppose that
A248:          i1 = i2 & j1 = j2+1 and
A249:          f/.(len(F.k)+1) = G*(i2+1,j2);
               now let i1',j1',i2',j2' be Nat;
            assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
              (F.k)/.len(F.k) = G*(i1',j1') & G*(i2+1,j2) = G*
(i2',j2');
              then i2 = i1' & j2 = j1' & i2+1 = i2' & j2 = j2'
                by A188,A204,A235,A248,GOBOARD1:21;
             then abs(i2'-i1') = 1 & abs(j2'-j1') = 0 by ABSVALUE:def 1;
            hence abs(i2'-i1')+abs(j2'-j1') = 1;
           end;
          hence F.(k+1) is_sequence_on G by A146,A184,A204,A235,A237,A239,A248
,A249,JORDAN8:9;
         end;
         end;
      end;
      end;
     let m such that
A250:    1 <= m & m+1 <= len(F.(k+1));
         now
     per cases;
      suppose m+1 = len(F.(k+1));
then A251:    m = len(F.k) by A148,A149;
A252:    (i2-'1)+1 = i2 by A189,BINARITH:53;
A253:    (j2-'1)+1 = j2 by A189,BINARITH:53;
       thus thesis
        proof per cases;
         suppose
A254:        front_left_cell(F.k,(len(F.k))-'1,G) misses C &
            front_right_cell(F.k,(len(F.k))-'1,G) misses C;
          then consider i,j such that
A255:        (F.k)^<*G*(i,j)*> turns_right (len(F.k))-'1,G and
A256:        F.(k+1) = (F.k)^<*G*(i,j)*> by A92,A146,A148,A183,A192;
A257:        (F.(k+1))/.(len(F.k)-'1) = G*(i1,j1) & (F.(k+1))/.len(F.k) = G*
(i2,j2)
            by A187,A188,A190,A256,FINSEQ_4:83;
              now per cases by A186,A187,A188,A191,A255,A256,A257,GOBRD13:def 6
;
           suppose that
A258:           i1 = i2 & j1+1 = j2 and
A259:           (F.(k+1))/.((len(F.k))+1) = G*(i2+1,j2);
                 front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i1,j2)
               by A146,A185,A186,A187,A188,A258,GOBRD13:36;
            hence left_cell(F.(k+1),m,G) misses C
               by A188,A193,A205,A250,A251,A254,A257,A258,A259,GOBRD13:24;
                 j2-'1 = j1 & cell(G,i1,j1) meets C
               by A146,A185,A186,A187,A188,A192,A258,BINARITH:39,GOBRD13:23;
            hence right_cell(F.(k+1),m,G) meets C
               by A188,A193,A205,A250,A251,A257,A258,A259,GOBRD13:25;
           end;
           suppose that
A260:           i1+1 = i2 & j1 = j2 and
A261:           (F.(k+1))/.((len(F.k))+1) = G*(i2,j2-'1);
                 front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i2,j2-'1)
               by A146,A185,A186,A187,A188,A260,GOBRD13:38;
            hence left_cell(F.(k+1),m,G) misses C
               by A188,A194,A205,A250,A251,A253,A254,A257,A260,A261,GOBRD13:28;
                 i2-'1 = i1 & cell(G,i1,j1-'1) meets C
               by A146,A185,A186,A187,A188,A192,A260,BINARITH:39,GOBRD13:25;
            hence right_cell(F.(k+1),m,G) meets C
               by A188,A194,A205,A250,A251,A253,A257,A260,A261,GOBRD13:29;
           end;
           suppose that
A262:           i1 = i2+1 & j1 = j2 and
A263:           (F.(k+1))/.((len(F.k))+1) = G*(i2,j2+1);
                 front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i2-'1,j2)
               by A146,A185,A186,A187,A188,A262,GOBRD13:40;
            hence left_cell(F.(k+1),m,G) misses C
               by A188,A195,A205,A250,A251,A254,A257,A262,A263,GOBRD13:22;
                 cell(G,i2,j2) meets C
               by A146,A185,A186,A187,A188,A192,A262,GOBRD13:27;
            hence right_cell(F.(k+1),m,G) meets C
               by A188,A195,A205,A250,A251,A257,A262,A263,GOBRD13:23;
           end;
           suppose that
A264:           i1 = i2 & j1 = j2+1 and
A265:           (F.(k+1))/.((len(F.k))+1) = G*(i2-'1,j2);
                 front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i2-'1,j2-'1)
               by A146,A185,A186,A187,A188,A264,GOBRD13:42;
            hence left_cell(F.(k+1),m,G) misses C
              by A188,A196,A205,A250,A251,A252,A254,A257,A264,A265,GOBRD13:26;
                 cell(G,i2-'1,j2) meets C
              by A146,A185,A186,A187,A188,A192,A264,GOBRD13:29;
            hence right_cell(F.(k+1),m,G) meets C
             by A188,A196,A205,A250,A251,A252,A257,A264,A265,GOBRD13:27;
          end;
          end;
          hence thesis;
         end;
         suppose
A266:        front_left_cell(F.k,(len(F.k))-'1,G) misses C &
             front_right_cell(F.k,(len(F.k))-'1,G) meets C;
          then consider i,j such that
A267:        (F.k)^<*G*(i,j)*> goes_straight (len(F.k))-'1,G and
A268:        F.(k+1) = (F.k)^<*G*(i,j)*> by A92,A146,A148,A183,A192;
A269:        (F.(k+1))/.(len(F.k)-'1) = G*(i1,j1) & (F.(k+1))/.len(F.k)
                      = G*(i2,j2)
            by A187,A188,A190,A268,FINSEQ_4:83;
              now per cases by A186,A187,A188,A191,A267,A268,A269,GOBRD13:def 8
;
           suppose that
A270:           i1 = i2 & j1+1 = j2 and
A271:           (F.(k+1))/.(len(F.k)+1) = G*(i2,j2+1);
                 front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i1-'1,j2)
               by A146,A185,A186,A187,A188,A270,GOBRD13:35;
             hence left_cell(F.(k+1),m,G) misses C
               by A188,A197,A205,A250,A251,A266,A269,A270,A271,GOBRD13:22;
                front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i1,j2)
               by A146,A185,A186,A187,A188,A270,GOBRD13:36;
            hence right_cell(F.(k+1),m,G) meets C
               by A188,A197,A205,A250,A251,A266,A269,A270,A271,GOBRD13:23;
           end;
           suppose that
A272:           i1+1 = i2 & j1 = j2 and
A273:           (F.(k+1))/.(len(F.k)+1) = G*(i2+1,j2);
                 front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i2,j2)
               by A146,A185,A186,A187,A188,A272,GOBRD13:37;
            hence left_cell(F.(k+1),m,G) misses C
               by A188,A198,A205,A250,A251,A266,A269,A272,A273,GOBRD13:24;
                 front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i2,j2-'1)
               by A146,A185,A186,A187,A188,A272,GOBRD13:38;
            hence right_cell(F.(k+1),m,G) meets C
               by A188,A198,A205,A250,A251,A266,A269,A272,A273,GOBRD13:25;
           end;
           suppose that
A274:          i1 = i2+1 & j1 = j2 and
A275:          (F.(k+1))/.(len(F.k)+1) = G*(i2-'1,j2);
                 front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i2-'1,j2-'1)
               by A146,A185,A186,A187,A188,A274,GOBRD13:39;
            hence left_cell(F.(k+1),m,G) misses C
               by A188,A199,A205,A250,A251,A252,A266,A269,A274,A275,GOBRD13:26;
                 front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i2-'1,j2)
               by A146,A185,A186,A187,A188,A274,GOBRD13:40;
            hence right_cell(F.(k+1),m,G) meets C
               by A188,A199,A205,A250,A251,A252,A266,A269,A274,A275,GOBRD13:27;
           end;
           suppose that
A276:          i1 = i2 & j1 = j2+1 and
A277:          (F.(k+1))/.(len(F.k)+1) = G*(i2,j2-'1);
                 front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i2,j2-'1)
               by A146,A185,A186,A187,A188,A276,GOBRD13:41;
            hence left_cell(F.(k+1),m,G) misses C
               by A188,A200,A205,A250,A251,A253,A266,A269,A276,A277,GOBRD13:28;
                 front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i2-'1,j2-'1)
               by A146,A185,A186,A187,A188,A276,GOBRD13:42;
            hence right_cell(F.(k+1),m,G) meets C
               by A188,A200,A205,A250,A251,A253,A266,A269,A276,A277,GOBRD13:29;
          end;
          end;
          hence thesis;
         end;
         suppose
A278:        front_left_cell(F.k,(len(F.k))-'1,G) meets C;
          then consider i,j such that
A279:        (F.k)^<*G*(i,j)*> turns_left (len(F.k))-'1,G and
A280:        F.(k+1) = (F.k)^<*G*(i,j)*> by A92,A146,A148,A183,A192;
A281:        (F.(k+1))/.(len(F.k)-'1) = G*(i1,j1) & (F.(k+1))/.len(F.k) = G*
(i2,j2)
             by A187,A188,A190,A280,FINSEQ_4:83;
              now per cases by A186,A187,A188,A191,A279,A280,A281,GOBRD13:def 7
;
           suppose that
A282:           i1 = i2 & j1+1 = j2 and
A283:           (F.(k+1))/.(len(F.k)+1) = G*(i2-'1,j2);
                 j2-'1 = j1 &
             cell(G,i1-'1,j1) misses C
               by A146,A185,A186,A187,A188,A192,A282,BINARITH:39,GOBRD13:22;
            hence left_cell(F.(k+1),m,G) misses C
               by A188,A201,A205,A250,A251,A252,A278,A281,A282,A283,GOBRD13:26;
                 front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i1-'1,j2)
               by A146,A185,A186,A187,A188,A282,GOBRD13:35;
            hence right_cell(F.(k+1),m,G) meets C
               by A188,A201,A205,A250,A251,A252,A278,A281,A282,A283,GOBRD13:27;
           end;
           suppose that
A284:           i1+1 = i2 & j1 = j2 and
A285:           (F.(k+1))/.(len(F.k)+1) = G*(i2,j2+1);
                 i2-'1 = i1 & cell(G,i1,j1) misses C
               by A146,A185,A186,A187,A188,A192,A284,BINARITH:39,GOBRD13:24;
             hence left_cell(F.(k+1),m,G) misses C
               by A188,A202,A205,A250,A251,A278,A281,A284,A285,GOBRD13:22;
                 front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i2,j2)
               by A146,A185,A186,A187,A188,A284,GOBRD13:37;
            hence right_cell(F.(k+1),m,G) meets C
               by A188,A202,A205,A250,A251,A278,A281,A284,A285,GOBRD13:23;
           end;
           suppose that
A286:           i1 = i2+1 & j1 = j2 and
A287:           (F.(k+1))/.(len(F.k)+1) = G*(i2,j2-'1);
                 cell(G,i2,j2-'1) misses C
               by A146,A185,A186,A187,A188,A192,A286,GOBRD13:26;
            hence left_cell(F.(k+1),m,G) misses C
               by A188,A203,A205,A250,A251,A253,A278,A281,A286,A287,GOBRD13:28;
                 front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i2-'1,j2-'1)
               by A146,A185,A186,A187,A188,A286,GOBRD13:39;
            hence right_cell(F.(k+1),m,G) meets C
               by A188,A203,A205,A250,A251,A253,A278,A281,A286,A287,GOBRD13:29;
           end;
           suppose that
A288:           i1 = i2 & j1 = j2+1 and
A289:           (F.(k+1))/.(len(F.k)+1) = G*(i2+1,j2);
                 cell(G,i2,j2) misses C by A146,A185,A186,A187,A188,A192,A288,
GOBRD13:28;
            hence left_cell(F.(k+1),m,G) misses C
               by A188,A204,A205,A250,A251,A278,A281,A288,A289,GOBRD13:24;
                 front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i2,j2-'1)
               by A146,A185,A186,A187,A188,A288,GOBRD13:41;
            hence right_cell(F.(k+1),m,G) meets C
               by A188,A204,A205,A250,A251,A278,A281,A288,A289,GOBRD13:25;
          end;
          end;
          hence thesis;
       end;
       end;
      end;
      suppose m+1 <> len(F.(k+1));
       then m+1 < len(F.(k+1)) by A250,REAL_1:def 5;
       then A290:     m+1 <= len(F.k)by A148,A149,NAT_1:38;
       then consider i1,j1,i2,j2 being Nat such that
A291:     [i1,j1] in Indices G & (F.k)/.m = G*(i1,j1) and
A292:     [i2,j2] in Indices G & (F.k)/.(m+1) = G*(i2,j2) and
A293:      i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
          i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A146,A250,JORDAN8:6;
A294:    1 <= m+1 by NAT_1:37;
            m <= len(F.k) by A290,NAT_1:38;
then A295:    m in dom(F.k) & m+1 in dom(F.k) by A250,A290,A294,FINSEQ_3:27;
A296:     left_cell(F.k,m,G) misses C & right_cell(F.k,m,G) meets C
         by A147,A250,A290;
           now per cases;
         suppose
              front_left_cell(F.k,(len(F.k))-'1,G) misses C &
            front_right_cell(F.k,(len(F.k))-'1,G) misses C;
          then consider i,j such that
               (F.k)^<*G*(i,j)*> turns_right (len(F.k))-'1,G and
A297:        F.(k+1) = (F.k)^<*G*(i,j)*> by A92,A146,A148,A183,A192;
          take i,j;
          thus F.(k+1) = (F.k)^<*G*(i,j)*> by A297;
         end;
         suppose
               front_left_cell(F.k,(len(F.k))-'1,G) misses C &
             front_right_cell(F.k,(len(F.k))-'1,G) meets C;
          then consider i,j such that
               (F.k)^<*G*(i,j)*> goes_straight (len(F.k))-'1,G and
A298:        F.(k+1) = (F.k)^<*G*(i,j)*> by A92,A146,A148,A183,A192;
          take i,j;
          thus F.(k+1) = (F.k)^<*G*(i,j)*> by A298;
         end;
         suppose
              front_left_cell(F.k,(len(F.k))-'1,G) meets C;
          then consider i,j such that
               (F.k)^<*G*(i,j)*> turns_left (len(F.k))-'1,G and
A299:        F.(k+1) = (F.k)^<*G*(i,j)*> by A92,A146,A148,A183,A192;
          take i,j;
          thus F.(k+1) = (F.k)^<*G*(i,j)*> by A299;
       end;
       end;
       then consider i,j such that
A300:      F.(k+1) = (F.k)^<*G*(i,j)*>;
A301:      (F.(k+1))/.m = G*(i1,j1) & (F.(k+1))/.(m+1) = G*(i2,j2)
            by A291,A292,A295,A300,FINSEQ_4:83;
           now per cases by A293;
        suppose
A302:        i1 = i2 & j1+1 = j2;
          then left_cell(F.k,m,G) = cell(G,i1-'1,j1) &
            right_cell(F.k,m,G) = cell(G,i1,j1)
           by A146,A250,A290,A291,A292,GOBRD13:22,23;
         hence thesis by A205,A250,A291,A292,A296,A301,A302,GOBRD13:22,23;
        end;
        suppose
A303:        i1+1 = i2 & j1 = j2;
          then left_cell(F.k,m,G) = cell(G,i1,j1) &
            right_cell(F.k,m,G) = cell(G,i1,j1-'1)
           by A146,A250,A290,A291,A292,GOBRD13:24,25;
         hence thesis by A205,A250,A291,A292,A296,A301,A303,GOBRD13:24,25;
        end;
        suppose
A304:        i1 = i2+1 & j1 = j2;
          then left_cell(F.k,m,G) = cell(G,i2,j2-'1) &
            right_cell(F.k,m,G) = cell(G,i2,j2)
           by A146,A250,A290,A291,A292,GOBRD13:26,27;
         hence thesis by A205,A250,A291,A292,A296,A301,A304,GOBRD13:26,27;
        end;
        suppose
A305:        i1 = i2 & j1 = j2+1;
          then left_cell(F.k,m,G) = cell(G,i2,j2) &
            right_cell(F.k,m,G) = cell(G,i1-'1,j2)
           by A146,A250,A290,A291,A292,GOBRD13:28,29;
         hence thesis by A205,A250,A291,A292,A296,A301,A305,GOBRD13:28,29;
       end;
       end;
       hence thesis;
     end;
     end;
    hence thesis;
   end;
   end;

A306: for k holds P[k] from NAT_1:sch 1(A108,A145);
A307: for k,i1,i2,j1,j2 st k > 1 &
        [i1,j1] in Indices G & (F.k)/.((len(F.k)) -'1) = G*(i1,j1) &
        [i2,j2] in Indices G & (F.k)/.len(F.k) = G*(i2,j2)
      holds
       (front_left_cell(F.k,(len(F.k))-'1,G) misses C &
          front_right_cell(F.k,(len(F.k))-'1,G) misses C
         implies F.(k+1) turns_right (len(F.k))-'1,G &
          (i1 = i2 & j1+1 = j2 implies [i2+1,j2] in Indices G &
            F.(k+1) = (F.k)^<*G*(i2+1,j2)*>) &
          (i1+1 = i2 & j1 = j2 implies [i2,j2-'1] in Indices G &
            F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>) &
          (i1 = i2+1 & j1 = j2 implies [i2,j2+1] in Indices G &
            F.(k+1) = (F.k)^<*G*(i2,j2+1)*>)&
          (i1 = i2 & j1 = j2+1 implies [i2-'1,j2] in Indices G &
            F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>)) &
       (front_left_cell(F.k,(len(F.k))-'1,G) misses C &
          front_right_cell(F.k,(len(F.k))-'1,G) meets C
         implies F.(k+1) goes_straight (len(F.k))-'1,G &
          (i1 = i2 & j1+1 = j2 implies [i2,j2+1] in Indices G &
            F.(k+1) = (F.k)^<*G*(i2,j2+1)*>) &
          (i1+1 = i2 & j1 = j2 implies [i2+1,j2] in Indices G &
            F.(k+1) = (F.k)^<*G*(i2+1,j2)*>) &
          (i1 = i2+1 & j1 = j2 implies [i2-'1,j2] in Indices G &
            F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>)&
          (i1 = i2 & j1 = j2+1 implies [i2,j2-'1] in Indices G &
            F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>)) &
       (front_left_cell(F.k,(len(F.k))-'1,G) meets C
         implies F.(k+1) turns_left (len(F.k))-'1,G &
          (i1 = i2 & j1+1 = j2 implies [i2-'1,j2] in Indices G &
            F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>) &
          (i1+1 = i2 & j1 = j2 implies [i2,j2+1] in Indices G &
            F.(k+1) = (F.k)^<*G*(i2,j2+1)*>) &
          (i1 = i2+1 & j1 = j2 implies [i2,j2-'1] in Indices G &
            F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>)&
          (i1 = i2 & j1 = j2+1 implies [i2+1,j2] in Indices G &
            F.(k+1) = (F.k)^<*G*(i2+1,j2)*>))
  proof let k,i1,i2,j1,j2 such that
A308:  k > 1 and
A309:  [i1,j1] in Indices G & (F.k)/.((len(F.k)) -'1) = G*(i1,j1) and
A310:  [i2,j2] in Indices G & (F.k)/.len(F.k) = G*(i2,j2);
A311:  (len(F.k))-'1 <= len(F.k) by BINARITH:52;
A312:   F.k is_sequence_on G by A306;
A313:   len(F.k) = k by A107;
then A314:  1 <= (len(F.k))-'1 by A308,JORDAN3:12;
A315:  (len(F.k)) -'1 +1 = len(F.k) by A308,A313,BINARITH:53;
then A316: right_cell(F.k,(len(F.k))-'1,G) meets C by A306,A314;
A317: (len(F.k))-'1 in dom(F.k) & len(F.k) in dom(F.k)
       by A308,A311,A313,A314,FINSEQ_3:27;
A318: (len(F.k))-'1+(1+1) = (len(F.k))+1 by A315;
A319: i1+1 > i1 & i2+1 > i2 & j1+1 > j1 & j2+1 > j2 by NAT_1:38;
    hereby assume
          front_left_cell(F.k,(len(F.k))-'1,G) misses C &
        front_right_cell(F.k,(len(F.k))-'1,G) misses C;
     then consider i,j such that
A320:   (F.k)^<*G*(i,j)*> turns_right (len(F.k))-'1,G and
A321:   F.(k+1) = (F.k)^<*G*(i,j)*> by A92,A308,A312,A313,A316;
A322:   (F.(k+1))/.(len(F.k)-'1) = G*(i1,j1) & (F.(k+1))/.len(F.k) = G*
(i2,j2)
        by A309,A310,A317,A321,FINSEQ_4:83;
A323:   (F.(k+1))/.(len(F.k)+1) = G*(i,j) by A321,FINSEQ_4:82;
     thus
        F.(k+1) turns_right (len(F.k))-'1,G by A320,A321;
     thus i1 = i2 & j1+1 = j2 implies
      [i2+1,j2] in Indices G &
       F.(k+1) = (F.k)^<*G*(i2+1,j2)*>
       by A309,A310,A315,A318,A319,A320,A321,A322,A323,GOBRD13:def 6;
    thus i1+1 = i2 & j1 = j2 implies
       [i2,j2-'1] in Indices G &
       F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>
       by A309,A310,A315,A318,A319,A320,A321,A322,A323,GOBRD13:def 6;
     thus i1 = i2+1 & j1 = j2 implies
      [i2,j2+1] in Indices G &
      F.(k+1) = (F.k)^<*G*(i2,j2+1)*>
       by A309,A310,A315,A318,A319,A320,A321,A322,A323,GOBRD13:def 6;
     thus i1 = i2 & j1 = j2+1 implies
      [i2-'1,j2] in Indices G &
      F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>
       by A309,A310,A315,A318,A319,A320,A321,A322,A323,GOBRD13:def 6;
   end;
   hereby assume
          front_left_cell(F.k,(len(F.k))-'1,G) misses C &
        front_right_cell(F.k,(len(F.k))-'1,G) meets C;
    then consider i,j such that
A324:   (F.k)^<*G*(i,j)*> goes_straight (len(F.k))-'1,G and
A325:   F.(k+1) = (F.k)^<*G*(i,j)*> by A92,A308,A312,A313,A316;
A326:   (F.(k+1))/.(len(F.k)-'1) = G*(i1,j1) & (F.(k+1))/.len(F.k) = G*
(i2,j2)
        by A309,A310,A317,A325,FINSEQ_4:83;
A327:   (F.(k+1))/.(len(F.k)+1) = G*(i,j) by A325,FINSEQ_4:82;
    thus
      F.(k+1) goes_straight (len(F.k))-'1,G by A324,A325;
    thus i1 = i2 & j1+1 = j2 implies
      [i2,j2+1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2+1)*>
       by A309,A310,A315,A318,A319,A324,A325,A326,A327,GOBRD13:def 8;
    thus i1+1 = i2 & j1 = j2 implies
      [i2+1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2+1,j2)*>
       by A309,A310,A315,A318,A319,A324,A325,A326,A327,GOBRD13:def 8;
    thus i1 = i2+1 & j1 = j2 implies
      [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>
       by A309,A310,A315,A318,A319,A324,A325,A326,A327,GOBRD13:def 8;
    thus i1 = i2 & j1 = j2+1 implies
      [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>
       by A309,A310,A315,A318,A319,A324,A325,A326,A327,GOBRD13:def 8;
   end;
   assume
          front_left_cell(F.k,(len(F.k))-'1,G) meets C;
   then consider i,j such that
A328:   (F.k)^<*G*(i,j)*> turns_left (len(F.k))-'1,G and
A329:   F.(k+1) = (F.k)^<*G*(i,j)*> by A92,A308,A312,A313,A316;
A330:   (F.(k+1))/.(len(F.k)-'1) = G*(i1,j1) & (F.(k+1))/.len(F.k) = G*
(i2,j2)
        by A309,A310,A317,A329,FINSEQ_4:83;
A331:   (F.(k+1))/.(len(F.k)+1) = G*(i,j) by A329,FINSEQ_4:82;
   thus
      F.(k+1) turns_left (len(F.k))-'1,G by A328,A329;
   thus i1 = i2 & j1+1 = j2 implies
    [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>
       by A309,A310,A315,A318,A319,A328,A329,A330,A331,GOBRD13:def 7;
   thus i1+1 = i2 & j1 = j2 implies
    [i2,j2+1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2+1)*>
       by A309,A310,A315,A318,A319,A328,A329,A330,A331,GOBRD13:def 7;
   thus i1 = i2+1 & j1 = j2 implies
    [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>
       by A309,A310,A315,A318,A319,A328,A329,A330,A331,GOBRD13:def 7;
   thus i1 = i2 & j1 = j2+1 implies
    [i2+1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2+1,j2)*>
       by A309,A310,A315,A318,A319,A328,A329,A330,A331,GOBRD13:def 7;
 end;

A332:
  for k holds ex i,j st [i,j] in Indices G & F.(k+1) = (F.k)^<*G*(i,j)*>
   proof let k;
A333:  F.k is_sequence_on G by A306;
A334:  len(F.k) = k by A107;
A335:  len G = 2|^n+3 & len G = width G by JORDAN8:def 1;
        len G >= 4 by JORDAN8:13;
    then A336:    1 < len G by XXREAL_0:2;
    per cases by REAL_1:def 5;
    suppose k < 1;
then A337:   k = 0 by NAT_1:39;
     consider i such that
A338:      1 <= i & i+1 <= len G and
            N-min C in cell(G,i,width G-'1) & N-min C <> G*(i,width G-'1) and
A339:    F.(0+1) = <*G*(i,width G)*> by A92;
      take i, j = width G;
          i < len G by A338,NAT_1:38;
      hence [i,j] in Indices G by A335,A336,A338,GOBOARD7:10;
      thus thesis by A91,A337,A339,FINSEQ_1:47;
    end;
    suppose
A340:   k = 1;
     consider i such that
A341:    1 <= i & i+1 <= len G and
A342:    N-min C in cell(G,i,width G-'1) & N-min C <> G*(i,width G-'1) and
A343:    F.(0+1) = <*G*(i,width G)*> by A92;
     consider i' being Nat such that
A344:    1 <= i' & i'+1 <= len G &
       N-min C in cell(G,i',width G-'1) & N-min C <> G*(i',width G-'1) and
A345:    F.(1+1) = <*G*(i',width G),G*(i'+1,width G)*> by A92;

A346:    i = i' by A341,A342,A344,Th31;
     take i+1,j = width G;
         1 <= i+1 & i+1 <= len G by A341,NAT_1:38;
     hence [i+1,j] in Indices G by A335,A336,GOBOARD7:10;
     thus thesis by A340,A343,A345,A346,FINSEQ_1:def 9;
    end;
    suppose
A347:   k > 1;
then A348:   1 <= (len(F.k))-'1 by A334,JORDAN3:12;
          (len(F.k)) -'1 +1 = len(F.k) by A334,A347,BINARITH:53;
     then consider i1,j1,i2,j2 being Nat such that
A349:   [i1,j1] in Indices G & (F.k)/.((len(F.k)) -'1) = G*(i1,j1) and
A350:   [i2,j2] in Indices G & (F.k)/.len(F.k) = G*(i2,j2) and
A351:   i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
        i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A333,A348,JORDAN8:6;
         now per cases;
       suppose
A352:       front_left_cell(F.k,(len(F.k))-'1,G) misses C &
          front_right_cell(F.k,(len(F.k))-'1,G) misses C;
             now per cases by A351;
          suppose i1 = i2 & j1+1 = j2;
           then [i2+1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2+1,j2)*>
             by A307,A347,A349,A350,A352;
            hence thesis;
          end;
          suppose i1+1 = i2 & j1 = j2;
           then [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>
             by A307,A347,A349,A350,A352;
            hence thesis;
          end;
          suppose i1 = i2+1 & j1 = j2;
           then [i2,j2+1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2+1)*>
             by A307,A347,A349,A350,A352;
            hence thesis;
          end;
          suppose i1 = i2 & j1 = j2+1;
           then [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>
             by A307,A347,A349,A350,A352;
            hence thesis;
         end;
         end;
        hence thesis;
       end;
       suppose
A353:       front_left_cell(F.k,(len(F.k))-'1,G) misses C &
          front_right_cell(F.k,(len(F.k))-'1,G) meets C;
             now per cases by A351;
          suppose i1 = i2 & j1+1 = j2;
           then [i2,j2+1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2+1)*>
             by A307,A347,A349,A350,A353;
            hence thesis;
          end;
          suppose i1+1 = i2 & j1 = j2;
           then [i2+1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2+1,j2)*>
             by A307,A347,A349,A350,A353;
            hence thesis;
          end;
          suppose i1 = i2+1 & j1 = j2;
           then [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>
             by A307,A347,A349,A350,A353;
            hence thesis;
          end;
          suppose i1 = i2 & j1 = j2+1;
           then [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>
             by A307,A347,A349,A350,A353;
            hence thesis;
         end;
         end;
        hence thesis;
       end;
       suppose
A354:       front_left_cell(F.k,(len(F.k))-'1,G) meets C;
             now per cases by A351;
          suppose i1 = i2 & j1+1 = j2;
           then [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>
             by A307,A347,A349,A350,A354;
            hence thesis;
          end;
          suppose i1+1 = i2 & j1 = j2;
           then [i2,j2+1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2+1)*>
             by A307,A347,A349,A350,A354;
            hence thesis;
          end;
          suppose i1 = i2+1 & j1 = j2;
           then [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>
             by A307,A347,A349,A350,A354;
            hence thesis;
          end;
          suppose i1 = i2 & j1 = j2+1;
           then [i2+1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2+1,j2)*>
             by A307,A347,A349,A350,A354;
            hence thesis;
         end;
         end;
        hence thesis;
     end;
     end;
     hence thesis;
   end;
   end;
defpred P[Nat] means  for m st m <= $1 holds (F.$1)|m = F.m;
A355: P[0]
   proof let m;
    assume
A356:  m <= 0;
    (F.0)|0 = (F.0)|m by A356,XXREAL_0:1;
    hence thesis by A91,A356,XXREAL_0:1;
   end;
A357: for k st P[k] holds P[k+1]
   proof let k such that
A358:   for m st m <= k holds (F.k)|m = F.m;
    let m such that
A359:   m <= k+1;
    per cases by A359,REAL_1:def 5;
    suppose m < k+1;
then A360:    m <= k by NAT_1:38;
A361:    len(F.k) = k by A107;
     consider i,j such that
           [i,j] in Indices G and
A362:    F.(k+1) = F.k^<*G*(i,j)*> by A332;
         (F.(k+1))|m = (F.k)|m by A360,A361,A362,FINSEQ_5:25;
     hence (F.(k+1))|m = F.m by A358,A360;
    end;
    suppose
A363:    m = k+1;
         len(F.(k+1)) = k+1 by A107;
     hence (F.(k+1))|m = F.m by A363,FINSEQ_1:79;
   end;
   end;

A364: for k holds P[k] from NAT_1:sch 1(A355,A357);
A365: for k st k > 1 holds
       (front_left_cell(F.k,k-'1,Gauge(C,n)) misses C &
          front_right_cell(F.k,k-'1,Gauge(C,n)) misses C
         implies F.(k+1) turns_right k-'1,Gauge(C,n)) &
       (front_left_cell(F.k,k-'1,Gauge(C,n)) misses C &
          front_right_cell(F.k,k-'1,Gauge(C,n)) meets C
         implies F.(k+1) goes_straight k-'1,Gauge(C,n)) &
       (front_left_cell(F.k,k-'1,Gauge(C,n)) meets C
         implies F.(k+1) turns_left k-'1,Gauge(C,n))
   proof
     let k such that
A366:  k > 1;
A367:  F.k is_sequence_on G by A306;
A368:  len(F.k) = k by A107;
then A369:  1 <= (len(F.k))-'1 by A366,JORDAN3:12;
        (len(F.k)) -'1 +1 = len(F.k) by A366,A368,BINARITH:53;
    then ex i1,j1,i2,j2 being Nat st
         [i1,j1] in Indices G & (F.k)/.((len(F.k)) -'1) = G*(i1,j1) &
         [i2,j2] in Indices G & (F.k)/.len(F.k) = G*(i2,j2) &
         (i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
      i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1) by A367,A369,JORDAN8:6;
    hence thesis by A307,A366,A368;
   end;
   defpred P[Nat] means F.$1 is unfolded;
       len(F.0) = 0 by A91,FINSEQ_1:25;
then A370: P[0] by SPPOL_2:27;
A371: for k st P[k] holds P[k+1]
   proof let k such that
A372:  F.k is unfolded;
A373:  F.k is_sequence_on G by A306;
    per cases;
    suppose k <= 1;
     then k+1 <= 1+1 by XREAL_1:8;
     then len(F.(k+1)) <= 2 by A107;
     hence F.(k+1) is unfolded by SPPOL_2:27;
    end;
    suppose
A374:   k > 1;
    set m = k-'1;
A375:   1 <= m by A374,JORDAN3:12;
A376:   m+1 = k by A374,BINARITH:53;
A377:   len(F.k) = k by A107;
     then consider i1,j1,i2,j2 being Nat such that
A378:   [i1,j1] in Indices G & (F.k)/.m = G*(i1,j1) and
A379:   [i2,j2] in Indices G & (F.k)/.len(F.k) = G*(i2,j2) and
A380:   i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
        i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A373,A375,A376,JORDAN8:6;
A381:  1 <= i1 & i1 <= len G & 1 <= j1 & j1 <= width G by A378,GOBOARD5:1;
A382:  1 <= i2 & i2 <= len G & 1 <= j2 & j2 <= width G by A379,GOBOARD5:1;
then A383:  (i2-'1)+1 = i2 by BINARITH:53;
A384:  (j2-'1)+1 = j2 by A382,BINARITH:53;
A385:   LSeg(F.k,m) = LSeg(G*(i1,j1),G*(i2,j2)) by A375,A376,A377,A378,A379,
TOPREAL1:def 5;
        now per cases;
     suppose
A386:     front_left_cell(F.k,(len(F.k))-'1,G) misses C &
          front_right_cell(F.k,(len(F.k))-'1,G) misses C;
          now per cases by A380;
       suppose
A387:       i1 = i2 & j1+1 = j2;
then A388:       [i2+1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2+1,j2)*>
           by A307,A374,A377,A378,A379,A386;
         then i2+1 <= len G by GOBOARD5:1;
         then LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G*
(i2+1,j2)) = {(F.k)/.len(F.k)}
          by A379,A381,A382,A385,A387,GOBOARD7:17;
        hence F.(k+1) is unfolded by A372,A376,A377,A388,SPPOL_2:31;
       end;
       suppose
A389:       i1+1 = i2 & j1 = j2;
then A390:       [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>
           by A307,A374,A377,A378,A379,A386;
         then 1 <= j2-'1 &
          LSeg((F.k)/.len(F.k),G*(i2,j2-'1))=LSeg(G*(i2,j2-'1),
          (F.k)/.len(F.k)) by GOBOARD5:1;
         then LSeg(F.k,m) /\
 LSeg((F.k)/.len(F.k),G*(i2,j2-'1)) = {(F.k)/.len(F.k)}
           by A379,A381,A382,A384,A385,A389,GOBOARD7:18;
        hence F.(k+1) is unfolded by A372,A376,A377,A390,SPPOL_2:31;
       end;
       suppose
A391:       i1 = i2+1 & j1 = j2;
then A392:       [i2,j2+1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2+1)*>
           by A307,A374,A377,A378,A379,A386;
         then j2+1 <= width G by GOBOARD5:1;
         then LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G*
(i2,j2+1)) = {(F.k)/.len(F.k)}
          by A379,A381,A382,A385,A391,GOBOARD7:19;
        hence F.(k+1) is unfolded by A372,A376,A377,A392,SPPOL_2:31;
       end;
       suppose
A393:       i1 = i2 & j1 = j2+1;
then A394:       [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>
           by A307,A374,A377,A378,A379,A386;
         then 1 <= i2-'1 by GOBOARD5:1;
         then LSeg(F.k,m) /\
 LSeg((F.k)/.len(F.k),G*(i2-'1,j2)) = {(F.k)/.len(F.k)}
          by A379,A381,A382,A383,A385,A393,GOBOARD7:20;
        hence F.(k+1) is unfolded by A372,A376,A377,A394,SPPOL_2:31;
      end;
      end;
      hence F.(k+1) is unfolded;
     end;
     suppose
A395:     front_left_cell(F.k,(len(F.k))-'1,G) misses C &
              front_right_cell(F.k,(len(F.k))-'1,G) meets C;
          now per cases by A380;
       suppose
A396:       i1 = i2 & j1+1 = j2;
then A397:       [i2,j2+1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2+1)*>
           by A307,A374,A377,A378,A379,A395;
         then 1 <= j2+1 & j2+1 <= width G & j2+1 = j1+(1+1)
          by A396,GOBOARD5:1;
         then LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G*
(i2,j2+1)) = {(F.k)/.len(F.k)}
          by A379,A381,A385,A396,GOBOARD7:15;
        hence F.(k+1) is unfolded by A372,A376,A377,A397,SPPOL_2:31;
       end;
       suppose
A398:       i1+1 = i2 & j1 = j2;
then A399:       [i2+1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2+1,j2)*>
           by A307,A374,A377,A378,A379,A395;
         then 1 <= i2+1 & i2+1 <= len G & i2+1 = i1+(1+1)
          by A398,GOBOARD5:1;
         then LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G*
(i2+1,j2)) = {(F.k)/.len(F.k)}
          by A379,A381,A385,A398,GOBOARD7:16;
        hence F.(k+1) is unfolded by A372,A376,A377,A399,SPPOL_2:31;
       end;
       suppose
A400:       i1 = i2+1 & j1 = j2;
then A401:       [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>
           by A307,A374,A377,A378,A379,A395;
         then 1 <= i2-'1 & i2-'1+1+1 = i2-'1+(1+1) by GOBOARD5:1;
         then LSeg(F.k,m) /\
 LSeg((F.k)/.len(F.k),G*(i2-'1,j2)) = {(F.k)/.len(F.k)}
          by A379,A381,A383,A385,A400,GOBOARD7:16;
        hence F.(k+1) is unfolded by A372,A376,A377,A401,SPPOL_2:31;
       end;
       suppose
A402:       i1 = i2 & j1 = j2+1;
then A403:       [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>
           by A307,A374,A377,A378,A379,A395;
         then 1 <= j2-'1 & j2-'1+1+1 = j2-'1+(1+1)
          by GOBOARD5:1;
         then LSeg(F.k,m) /\
 LSeg((F.k)/.len(F.k),G*(i2,j2-'1)) = {(F.k)/.len(F.k)}
          by A379,A381,A384,A385,A402,GOBOARD7:15;
        hence F.(k+1) is unfolded by A372,A376,A377,A403,SPPOL_2:31;
      end;
      end;
      hence F.(k+1) is unfolded;
     end;
     suppose
A404:     front_left_cell(F.k,(len(F.k))-'1,G) meets C;
          now per cases by A380;
       suppose
A405:       i1 = i2 & j1+1 = j2;
then A406:       [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>
           by A307,A374,A377,A378,A379,A404;
         then 1 <= i2-'1 &
         LSeg((F.k)/.len(F.k),G*(i2-'1,j2))=LSeg(G*(i2-'1,j2),
         (F.k)/.len(F.k)) by GOBOARD5:1;
         then LSeg(F.k,m) /\
 LSeg((F.k)/.len(F.k),G*(i2-'1,j2)) = {(F.k)/.len(F.k)}
          by A379,A381,A382,A383,A385,A405,GOBOARD7:18;
        hence F.(k+1) is unfolded by A372,A376,A377,A406,SPPOL_2:31;
       end;
       suppose
A407:       i1+1 = i2 & j1 = j2;
then A408:       [i2,j2+1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2+1)*>
           by A307,A374,A377,A378,A379,A404;
         then 1 <= j2+1 & j2+1 <= width G by GOBOARD5:1;
         then LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G*
(i2,j2+1)) = {(F.k)/.len(F.k)}
          by A379,A381,A382,A385,A407,GOBOARD7:20;
        hence F.(k+1) is unfolded by A372,A376,A377,A408,SPPOL_2:31;
       end;
       suppose
A409:       i1 = i2+1 & j1 = j2;
then A410:       [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>
           by A307,A374,A377,A378,A379,A404;
         then 1 <= j2-'1 &
         LSeg((F.k)/.len(F.k),G*(i2,j2-'1))=LSeg(G*(i2,j2-'1),
         (F.k)/.len(F.k)) by GOBOARD5:1;
         then LSeg(F.k,m) /\
 LSeg((F.k)/.len(F.k),G*(i2,j2-'1)) = {(F.k)/.len(F.k)}
          by A379,A381,A382,A384,A385,A409,GOBOARD7:17;
        hence F.(k+1) is unfolded by A372,A376,A377,A410,SPPOL_2:31;
       end;
       suppose
A411:       i1 = i2 & j1 = j2+1;
then A412:       [i2+1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2+1,j2)*>
           by A307,A374,A377,A378,A379,A404;
         then 1 <= i2+1 & i2+1 <= len G &
         LSeg((F.k)/.len(F.k),G*(i2+1,j2))=LSeg(G*
(i2+1,j2),(F.k)/.len(F.k))
          by GOBOARD5:1;
         then LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G*
(i2+1,j2)) = {(F.k)/.len(F.k)}
          by A379,A381,A382,A385,A411,GOBOARD7:19;
        hence F.(k+1) is unfolded by A372,A376,A377,A412,SPPOL_2:31;
      end;
      end;
      hence F.(k+1) is unfolded;
    end;
    end;
    hence F.(k+1) is unfolded;
   end;
   end;

A413: for k holds P[k] from NAT_1:sch 1(A370,A371);
defpred Q[Nat] means
$1 >= 1 & ex m st m in dom(F.$1) &
m <> len(F.$1) & (F.$1)/.m = (F.$1)/.len(F.$1);
  now assume
A414:   for k st k >= 1 holds
        for m st m in dom(F.k) & m <> len(F.k)
         holds (F.k)/.m <> (F.k)/.len(F.k);
         defpred P[Nat] means F.$1 is one-to-one;
A415:    P[0] by A91;
A416:    for k st P[k] holds P[k+1]
     proof let k; assume
A417:    F.k is one-to-one;
          now let n,m such that
A418:     n in dom(F.(k+1)) & m in dom(F.(k+1)) and
A419:     (F.(k+1))/.n = (F.(k+1))/.m;
       consider i,j such that
            [i,j] in Indices G and
A420:     F.(k+1) = (F.k)^<*G*(i,j)*> by A332;
A421:     1 <= n & n <= len(F.(k+1)) & 1 <= m & m <= len(F.(k+1))
         by A418,FINSEQ_3:27;
A422:     len(F.k) = k & len(F.(k+1)) = k+1 by A107;
A423:     1 <= k+1 by NAT_1:37;
       per cases by A421,A422,NAT_1:26;
        suppose n <= k & m <= k;
then A424:        n in dom(F.k) & m in dom(F.k) by A421,A422,FINSEQ_3:27;
         then (F.(k+1))/.n = (F.k)/.n & (F.(k+1))/.m = (F.k)/.m
          by A420,FINSEQ_4:83;
         hence n = m by A417,A419,A424,PARTFUN2:17;
        end;
        suppose n = k+1 & m <= k;
         hence n = m by A414,A418,A419,A422,A423;
        end;
        suppose n <= k & m = k+1;
         hence n = m by A414,A418,A419,A422,A423;
        end;
        suppose n = k+1 & m = k+1;
         hence n = m;
      end;
      end;
      hence F.(k+1) is one-to-one by PARTFUN2:16;
     end;
A425:   for k holds P[k] from NAT_1:sch 1(A415,A416);
A426:   for k holds card rng(F.k) = k
     proof let k;
          F.k is one-to-one by A425;
      hence card rng(F.k) = len(F.k) by FINSEQ_4:77
                         .= k by A107;
     end;
    set k = (len G)*(width G)+1;
A427:   k > (len G)*(width G) by NAT_1:38;
A428:   card Values G <= (len G)*(width G) by GOBRD13:8;
        F.k is_sequence_on G by A306;
    then rng(F.k) c= Values G by GOBRD13:9;
    then card rng(F.k) <= card Values G by CARD_1:80;
    then card rng(F.k) <= (len G)*(width G) by A428,XXREAL_0:2;
    hence contradiction by A426,A427;
   end; then A429: ex k st Q[k];
   consider k such that
A430:  Q[k] and
A431:  for l st Q[l] holds k <= l from NAT_1:sch 5(A429);

   consider m such that
A432:  m in dom(F.k) and
A433:  m <> len(F.k) and
A434:  (F.k)/.m = (F.k)/.len(F.k) by A430;
A435:  len(F.k) = k by A107;
      0<k by A430;
  then reconsider f = F.k as non empty FinSequence of TOP-REAL 2 by A435,
FINSEQ_1:25;
A436: f is_sequence_on G by A306;
A437: 1 <= m & m <= len f by A432,FINSEQ_3:27;
then A438: m < len f by A433,REAL_1:def 5;
   then 1 < len f by A437,XXREAL_0:2;
then A439: len f >= 1+1 by NAT_1:38;
  then reconsider f as non constant special unfolded non empty
    FinSequence of TOP-REAL 2 by A413,A436,JORDAN8:7,8;
  set g = f/^(m-'1);
A440: m+1 <= len f by A438,NAT_1:38;
      m-'1 <= m & m < m+1 by JORDAN3:7,NAT_1:38;
  then m-'1 < m+1 by XXREAL_0:2;
then A441: m-'1 < len f by A440,XXREAL_0:2;
then A442: len g = len f - (m-'1) by RFINSEQ:def 2;
  then (m-'1)-(m-'1) < len g by A441,XREAL_1:11;
  then reconsider g as non empty FinSequence of TOP-REAL 2 by FINSEQ_1:25;
      1 in dom g by FINSEQ_5:6;
then A443:  g/.1 = f/.(m-'1+1) by FINSEQ_5:30
           .= f/.m by A437,BINARITH:53;
      len g in dom g by FINSEQ_5:6;
then A444:  g/.len g = f/.(m-'1+len g) by FINSEQ_5:30
                .= f/.len f by A442;
A445: g is_sequence_on G by A436,JORDAN8:5;
then A446: g is standard by JORDAN8:7;
A447: for i st 1 <= i & i < len g & 1 <= j & j < len g & g/.i = g/.j
      holds i = j
   proof let i such that
A448:  1 <= i & i < len g and
A449:  1 <= j & j < len g and
A450:  g/.i = g/.j and
A451:  i <> j;
         i in dom g by A448,FINSEQ_3:27;
then A452:  g/.i = f/.(m-'1+i) by FINSEQ_5:30;
         j in dom g by A449,FINSEQ_3:27;
then A453:  g/.j = f/.(m-'1+j) by FINSEQ_5:30;
    per cases by A451,REAL_1:def 5;
    suppose
A454:    i < j;
     set l = m-'1+j, m'= m-'1+i;
A455:    m' < l by A454,XREAL_1:8;
A456:    l < k by A435,A442,A449,XREAL_1:22;
then A457:    f|l = F.l by A364;
         0+j <= l by XREAL_1:8;
then A458:    1 <= l by A449,XXREAL_0:2;
A459:    len(F.l) = l by A107;
         0+i <= m' by XREAL_1:8;
     then 1 <= m' by A448,XXREAL_0:2;
then A460:    m' in dom(F.l) by A455,A459,FINSEQ_3:27;
then A461:    (F.l)/.m' = f/.m' by A457,FINSEQ_4:85;
         l in dom(F.l) by A458,A459,FINSEQ_3:27;
     then (F.l)/.l = f/.l by A457,FINSEQ_4:85;
     hence contradiction by A431,A450,A452,A453,A455,A456,A458,A459,A460,A461;
    end;
    suppose
A462:    j < i;
     set l = m-'1+i, m'= m-'1+j;
A463:    m' < l by A462,XREAL_1:8;
A464:    l < k by A435,A442,A448,XREAL_1:22;
then A465:    f|l = F.l by A364;
         0+i <= l by XREAL_1:8;
then A466:    1 <= l by A448,XXREAL_0:2;
A467:    len(F.l) = l by A107;
         0+j <= m' by XREAL_1:8;
     then 1 <= m' by A449,XXREAL_0:2;
then A468:    m' in dom(F.l) by A463,A467,FINSEQ_3:27;
then A469:    (F.l)/.m' = f/.m' by A465,FINSEQ_4:85;
         l in dom(F.l) by A466,A467,FINSEQ_3:27;
     then (F.l)/.l = f/.l by A465,FINSEQ_4:85;
     hence contradiction by A431,A450,A452,A453,A463,A464,A466,A467,A468,A469;
   end;
   end;
A470: for i st 1 < i & i < j & j <= len g holds g/.i <> g/.j
   proof let i such that
A471:   1 < i and
A472:   i < j and
A473:   j <= len g and
A474:   g/.i = g/.j;
A475:   1 < j by A471,A472,XXREAL_0:2;
A476:   i < len g by A472,A473,XXREAL_0:2;
then A477:   1 < len g by A471,XXREAL_0:2;
    per cases;
    suppose j <> len g;
     then j < len g by A473,REAL_1:def 5;
     hence contradiction by A447,A471,A472,A474,A475,A476;
    end;
    suppose j = len g;
     hence contradiction by A434,A443,A444,A447,A471,A472,A474,A477;
   end;
   end;
A478: for i st 1 <= i & i < j & j < len g holds g/.i <> g/.j
   proof let i such that
A479:   1 <= i and
A480:   i < j and
A481:   j < len g and
A482:   g/.i = g/.j;
A483:   1 < j by A479,A480,XXREAL_0:2;
        i < len g by A480,A481,XXREAL_0:2;
    hence contradiction by A447,A479,A480,A481,A482,A483;
   end;
A484: for i st 1 <= i & i+1 <= len f
       holds right_cell(f,i,G) = Cl Int right_cell(f,i,G)
   proof let i such that
A485:    1 <= i & i+1 <= len f;
     consider i1,j1,i2,j2 such that
A486:    [i1,j1] in Indices G and
A487:    f/.i = G*(i1,j1) and
A488:    [i2,j2] in Indices G and
A489:    f/.(i+1) = G*(i2,j2) and
A490:    i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
        i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A436,A485,JORDAN8:6;
A491:    1 <= i1 & i1 <= len G & 1 <= j1 & j1 <= width G by A486,GOBOARD5:1;
A492:    1 <= i2 & i2 <= len G & 1 <= j2 & j2 <= width G by A488,GOBOARD5:1;
A493:    i1+1 > i1 & j1+1 > j1 & i2+1 > i2 & j2+1 > j2 by NAT_1:38;
    per cases by A490;
    suppose
          i1 = i2 & j1+1 = j2;
     then right_cell(f,i,G) = cell(G,i1,j1)
      by A436,A485,A486,A487,A488,A489,A493,GOBRD13:def 2;
     hence thesis by A491,GOBRD11:35;
    end;
    suppose
A494:   i1+1 = i2 & j1 = j2;
A495:   j1-'1 <= width G by A491,JORDAN3:7;
         right_cell(f,i,G) = cell(G,i1,j1-'1)
      by A436,A485,A486,A487,A488,A489,A493,A494,GOBRD13:def 2;
     hence thesis by A491,A495,GOBRD11:35;
    end;
    suppose
          i1 = i2+1 & j1 = j2;
     then right_cell(f,i,G) = cell(G,i2,j2)
      by A436,A485,A486,A487,A488,A489,A493,GOBRD13:def 2;
     hence thesis by A492,GOBRD11:35;
    end;
    suppose
A496:   i1 = i2 & j1 = j2+1;
A497:   i1-'1 <= len G by A491,JORDAN3:7;
         right_cell(f,i,G) = cell(G,i1-'1,j2)
      by A436,A485,A486,A487,A488,A489,A493,A496,GOBRD13:def 2;
     hence thesis by A492,A497,GOBRD11:35;
   end;
   end;
A498: g is s.c.c.
   proof
    let i,j such that
A499:   i+1 < j and
A500:   i > 1 & j < len g or j+1 < len g;
A501:   j <= j+1 by NAT_1:37;
then A502:  i+1 < j+1 by A499,XXREAL_0:2;
A503:   1 <= i+1 by NAT_1:37;
A504:   1 < j by A499,NAT_1:37;
       i < j by A499,NAT_1:38;
then A505:    i < j+1 by A501,XXREAL_0:2;
    per cases by A500,NAT_1:39;
    suppose
A506:    i > 1 & j < len g;
then A507:    i+1 < len g by A499,XXREAL_0:2;
then A508:    LSeg(g,i) = LSeg(g/.i,g/.(i+1)) by A506,TOPREAL1:def 5;
A509:   1 < i+1 by A506,NAT_1:38;
A510:    i < len g by A507,NAT_1:38;
     consider i1,j1,i2,j2 such that
A511:    [i1,j1] in Indices G and
A512:    g/.i = G*(i1,j1) and
A513:    [i2,j2] in Indices G and
A514:    g/.(i+1) = G*(i2,j2) and
A515:    i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
        i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A445,A506,A507,JORDAN8:6;
A516:    1 <= i1 & i1 <= len G & 1 <= j1 & j1 <= width G by A511,GOBOARD5:1;
A517:    1 <= i2 & i2 <= len G & 1 <= j2 & j2 <= width G by A513,GOBOARD5:1;
A518:    j+1 <= len g by A506,NAT_1:38;
then A519:    LSeg(g,j) = LSeg(g/.j,g/.(j+1)) by A504,TOPREAL1:def 5;
     consider i1',j1',i2',j2' being Nat such that
A520:    [i1',j1'] in Indices G and
A521:    g/.j = G*(i1',j1') and
A522:    [i2',j2'] in Indices G and
A523:    g/.(j+1) = G*(i2',j2') and
A524:    i1' = i2' & j1'+1 = j2' or i1'+1 = i2' & j1' = j2' or
        i1' = i2'+1 & j1' = j2' or i1' = i2' & j1' = j2'+1
         by A445,A504,A518,JORDAN8:6;
A525:    1 <= i1' & i1' <= len G & 1 <= j1' & j1' <= width G by A520,GOBOARD5:1
;
A526:    1 <= i2' & i2' <= len G & 1 <= j2' & j2' <= width G by A522,GOBOARD5:1
;
     assume
A527:  LSeg(g,i) meets LSeg(g,j);
          now per cases by A515,A524;
       suppose
A528:      i1 = i2 & j1+1 = j2 & i1' = i2' & j1'+1 = j2';
then A529:      i1 = i1' by A508,A512,A514,A516,A517,A519,A521,A523,A525,A526
,A527,GOBOARD7:21;
             j1 = j1' or j1 = j1'+1 or j1+1 = j1'
           by A508,A512,A514,A516,A517,A519,A521,A523,A525,A526,A527,A528,
GOBOARD7:24;
        hence contradiction
           by A447,A470,A499,A501,A503,A504,A505,A506,A507,A510,A512,A514,A518
,A521,A523,A528,A529;
       end;
       suppose
A530:      i1 = i2 & j1+1 = j2 & i1'+1 = i2' & j1' = j2';
         then i1 = i1' & j1 = j1' or i1 = i1' & j1+1 = j1' or
              i1 = i1'+1 & j1 = j1' or i1 = i1'+1 & j1+1 = j1'
          by A508,A512,A514,A516,A517,A519,A521,A523,A525,A526,A527,GOBOARD7:23
;
        hence contradiction
            by A447,A470,A499,A502,A504,A505,A506,A509,A510,A512,A514,A518,A521
,A523,A530;
       end;
       suppose
A531:      i1 = i2 & j1+1 = j2 & i1' = i2'+1 & j1' = j2';
         then i1 = i2' & j1' = j1 or i1 = i2' & j1+1 = j1' or
          i1 = i2'+1 & j1' = j1 or i1 = i2'+1 & j1+1 = j1'
            by A508,A512,A514,A516,A517,A519,A521,A523,A525,A526,A527,
GOBOARD7:23;
        hence contradiction
         by A447,A470,A499,A502,A504,A505,A506,A509,A510,A512,A514,A518,A521
,A523,A531;
       end;
       suppose
A532:      i1 = i2 & j1+1 = j2 & i1' = i2' & j1' = j2'+1;
then A533:      i1 = i1' by A508,A512,A514,A516,A517,A519,A521,A523,A525,A526
,A527,GOBOARD7:21;
            j1 = j2' or j1 = j2'+1 or j1+1 = j2'
              by A508,A512,A514,A516,A517,A519,A521,A523,A525,A526,A527,A532,
GOBOARD7:24;
        hence contradiction by A447,A470,A499,A502,A504,A506,A509,A510,A512
,A514,A518,A521,A523,A532,A533;
       end;
       suppose
A534:      i1+1 = i2 & j1 = j2 & i1' = i2' & j1'+1 = j2';
        then i1' = i1 & j1 = j1' or i1' = i1 & j1'+1 = j1 or
         i1' = i1+1 & j1 = j1' or i1' = i1+1 & j1'+1 = j1
            by A508,A512,A514,A516,A517,A519,A521,A523,A525,A526,A527,
GOBOARD7:23;
        hence contradiction
            by A447,A470,A499,A502,A504,A505,A506,A509,A510,A512,A514,A518,A521
,A523,A534;
       end;
       suppose
A535:      i1+1 = i2 & j1 = j2 & i1'+1 = i2' & j1' = j2';
then A536:      j1 = j1' by A508,A512,A514,A516,A517,A519,A521,A523,A525,A526
,A527,GOBOARD7:22;
            i1 = i1' or i1 = i1'+1 or i1+1 = i1'
         by A508,A512,A514,A516,A517,A519,A521,A523,A525,A526,A527,A535,
GOBOARD7:25;
        hence contradiction
         by A447,A470,A499,A501,A503,A504,A505,A506,A507,A510,A512,A514,A518
,A521,A523,A535,A536;
       end;
       suppose
A537:      i1+1 = i2 & j1 = j2 & i1' = i2'+1 & j1' = j2';
then A538:      j1 = j1' by A508,A512,A514,A516,A517,A519,A521,A523,A525,A526
,A527,GOBOARD7:22;
            i1 = i2' or i1 = i2'+1 or i1+1 = i2'
         by A508,A512,A514,A516,A517,A519,A521,A523,A525,A526,A527,A537,
GOBOARD7:25;
        hence contradiction
         by A447,A470,A502,A504,A505,A506,A509,A510,A512,A514,A518,A521,A523
,A537,A538;
       end;
       suppose
A539:      i1+1 = i2 & j1 = j2 & i1' = i2' & j1' = j2'+1;
         then i1' = i1 & j1 = j2' or i1' = i1 & j2'+1 = j1 or
              i1' = i1+1 & j1 = j2' or i1' = i1+1 & j2'+1 = j1
             by A508,A512,A514,A516,A517,A519,A521,A523,A525,A526,A527,
GOBOARD7:23;
        hence contradiction
         by A447,A470,A499,A502,A504,A505,A506,A509,A510,A512,A514,A518,A521
,A523,A539;
       end;
       suppose
A540:      i1 = i2+1 & j1 = j2 & i1' = i2' & j1'+1 = j2';
         then i1' = i2 & j1' = j1 or i1' = i2 & j1'+1 = j1 or
              i1' = i2+1 & j1' = j1 or i1' = i2+1 & j1'+1 = j1
          by A508,A512,A514,A516,A517,A519,A521,A523,A525,A526,A527,GOBOARD7:23
;
        hence contradiction
         by A447,A470,A499,A502,A504,A505,A506,A509,A510,A512,A514,A518,A521
,A523,A540;
       end;
       suppose
A541:      i1 = i2+1 & j1 = j2 & i1'+1 = i2' & j1' = j2';
then A542:      j1 = j1' by A508,A512,A514,A516,A517,A519,A521,A523,A525,A526
,A527,GOBOARD7:22;
             i2 = i1' or i2 = i1'+1 or i2+1 = i1'
            by A508,A512,A514,A516,A517,A519,A521,A523,A525,A526,A527,A541,
GOBOARD7:25;
        hence contradiction
          by A447,A470,A499,A502,A504,A506,A509,A510,A512,A514,A518,A521,A523
,A541,A542;
       end;
       suppose
A543:      i1 = i2+1 & j1 = j2 & i1' = i2'+1 & j1' = j2';
then A544:      j1 = j1' by A508,A512,A514,A516,A517,A519,A521,A523,A525,A526
,A527,GOBOARD7:22;
             i2 = i2' or i2 = i2'+1 or i2+1 = i2'
           by A508,A512,A514,A516,A517,A519,A521,A523,A525,A526,A527,A543,
GOBOARD7:25;
        hence contradiction by A470,A499,A502,A505,A506,A509,A512,A514,A518
,A521,A523,A543,A544;
       end;
       suppose
A545:      i1 = i2+1 & j1 = j2 & i1' = i2' & j1' = j2'+1;
         then i1' = i2 & j2' = j1 or i1' = i2 & j2'+1 = j1 or
         i1' = i2+1 & j2' = j1 or i1' = i2+1 & j2'+1 = j1
           by A508,A512,A514,A516,A517,A519,A521,A523,A525,A526,A527,
GOBOARD7:23;
        hence contradiction
          by A447,A470,A499,A502,A504,A505,A506,A509,A510,A512,A514,A518,A521
,A523,A545;
       end;
       suppose
A546:      i1 = i2 & j1 = j2+1 & i1' = i2' & j1'+1 = j2';
then A547:      i1 = i1' by A508,A512,A514,A516,A517,A519,A521,A523,A525,A526
,A527,GOBOARD7:21;
             j2 = j1' or j2 = j1'+1 or j2+1 = j1'
           by A508,A512,A514,A516,A517,A519,A521,A523,A525,A526,A527,A546,
GOBOARD7:24;
        hence contradiction
          by A447,A470,A499,A502,A504,A506,A509,A510,A512,A514,A518,A521,A523
,A546,A547;
       end;
       suppose
A548:      i1 = i2 & j1 = j2+1 & i1'+1 = i2' & j1' = j2';
         then i1 = i1' & j2 = j1' or i1 = i1' & j2+1 = j1' or
             i1 = i1'+1 & j2 = j1' or i1 = i1'+1 & j2+1 = j1'
          by A508,A512,A514,A516,A517,A519,A521,A523,A525,A526,A527,GOBOARD7:23
;
        hence contradiction
          by A447,A470,A499,A502,A504,A505,A506,A509,A510,A512,A514,A518,A521
,A523,A548;
       end;
       suppose
A549:      i1 = i2 & j1 = j2+1 & i1' = i2'+1 & j1' = j2';
         then i1 = i2' & j2 = j1' or i1 = i2' & j2+1 = j1' or
             i1 = i2'+1 & j2 = j1' or i1 = i2'+1 & j2+1 = j1'
          by A508,A512,A514,A516,A517,A519,A521,A523,A525,A526,A527,GOBOARD7:23
;
        hence contradiction
          by A447,A470,A499,A502,A504,A505,A506,A509,A510,A512,A514,A518,A521
,A523,A549;
       end;
       suppose
A550:      i1 = i2 & j1 = j2+1 & i1' = i2' & j1' = j2'+1;
then A551:      i1 = i1' by A508,A512,A514,A516,A517,A519,A521,A523,A525,A526
,A527,GOBOARD7:21;
             j2 = j2' or j2 = j2'+1 or j2+1 = j2'
           by A508,A512,A514,A516,A517,A519,A521,A523,A525,A526,A527,A550,
GOBOARD7:24;
        hence contradiction by A470,A499,A502,A505,A506,A509,A512,A514,A518
,A521,A523,A550,A551;
      end;
      end;
     hence contradiction;
    end;
    suppose i = 0 & j+1 < len g;
     then LSeg(g,i) = {} by TOPREAL1:def 5;
     hence LSeg(g,i) misses LSeg(g,j) by XBOOLE_1:65;
    end;
    suppose
A552:   1 <= i & j+1 < len g;
then A553:   i+1 < len g by A502,XXREAL_0:2;
then A554:    LSeg(g,i) = LSeg(g/.i,g/.(i+1)) by A552,TOPREAL1:def 5;
A555:   1 < i+1 by A552,NAT_1:38;
A556:    i < len g by A553,NAT_1:38;
A557:   j < len g by A552,NAT_1:37;
     consider i1,j1,i2,j2 such that
A558:    [i1,j1] in Indices G and
A559:    g/.i = G*(i1,j1) and
A560:    [i2,j2] in Indices G and
A561:    g/.(i+1) = G*(i2,j2) and
A562:    i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
        i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A445,A552,A553,JORDAN8:6;
A563:    1 <= i1 & i1 <= len G & 1 <= j1 & j1 <= width G by A558,GOBOARD5:1;
A564:    1 <= i2 & i2 <= len G & 1 <= j2 & j2 <= width G by A560,GOBOARD5:1;
A565:    LSeg(g,j) = LSeg(g/.j,g/.(j+1)) by A504,A552,TOPREAL1:def 5;
     consider i1',j1',i2',j2' being Nat such that
A566:    [i1',j1'] in Indices G and
A567:    g/.j = G*(i1',j1') and
A568:    [i2',j2'] in Indices G and
A569:    g/.(j+1) = G*(i2',j2') and
A570:    i1' = i2' & j1'+1 = j2' or i1'+1 = i2' & j1' = j2' or
        i1' = i2'+1 & j1' = j2' or i1' = i2' & j1' = j2'+1
         by A445,A504,A552,JORDAN8:6;
A571:    1 <= i1' & i1' <= len G & 1 <= j1' & j1' <= width G by A566,GOBOARD5:1
;
A572:    1 <= i2' & i2' <= len G & 1 <= j2' & j2' <= width G by A568,GOBOARD5:1
;
     assume
A573: LSeg(g,i) meets LSeg(g,j);
          now per cases by A562,A570;
       suppose
A574:      i1 = i2 & j1+1 = j2 & i1' = i2' & j1'+1 = j2';
then A575:      i1 = i1' by A554,A559,A561,A563,A564,A565,A567,A569,A571,A572
,A573,GOBOARD7:21;
             j1 = j1' or j1 = j1'+1 or j1+1 = j1'
           by A554,A559,A561,A563,A564,A565,A567,A569,A571,A572,A573,A574,
GOBOARD7:24;
        hence contradiction by A478,A499,A502,A503,A505,A552,A557,A559,A561
,A567,A569,A574,A575;
       end;
       suppose
A576:      i1 = i2 & j1+1 = j2 & i1'+1 = i2' & j1' = j2';
         then i1 = i1' & j1 = j1' or i1 = i1' & j1+1 = j1' or
            i1 = i1'+1 & j1 = j1' or i1 = i1'+1 & j1+1 = j1'
           by A554,A559,A561,A563,A564,A565,A567,A569,A571,A572,A573,
GOBOARD7:23;
        hence contradiction
           by A447,A478,A499,A502,A504,A505,A552,A555,A556,A557,A559,A561,A567
,A569,A576;
       end;
       suppose
A577:      i1 = i2 & j1+1 = j2 & i1' = i2'+1 & j1' = j2';
         then i1 = i2' & j1' = j1 or i1 = i2' & j1+1 = j1' or
              i1 = i2'+1 & j1' = j1 or i1 = i2'+1 & j1+1 = j1'
           by A554,A559,A561,A563,A564,A565,A567,A569,A571,A572,A573,
GOBOARD7:23;
        hence contradiction
           by A447,A478,A499,A502,A504,A505,A552,A555,A556,A557,A559,A561,A567
,A569,A577;
       end;
       suppose
A578:      i1 = i2 & j1+1 = j2 & i1' = i2' & j1' = j2'+1;
then A579:      i1 = i1' by A554,A559,A561,A563,A564,A565,A567,A569,A571,A572
,A573,GOBOARD7:21;
             j1 = j2' or j1 = j2'+1 or j1+1 = j2'
           by A554,A559,A561,A563,A564,A565,A567,A569,A571,A572,A573,A578,
GOBOARD7:24;
        hence contradiction by A447,A470,A499,A502,A504,A552,A555,A556,A557
,A559,A561,A567,A569,A578,A579;
       end;
       suppose
A580:      i1+1 = i2 & j1 = j2 & i1' = i2' & j1'+1 = j2';
         then i1' = i1 & j1 = j1' or i1' = i1 & j1'+1 = j1 or
              i1' = i1+1 & j1 = j1' or i1' = i1+1 & j1'+1 = j1
           by A554,A559,A561,A563,A564,A565,A567,A569,A571,A572,A573,
GOBOARD7:23;
        hence contradiction by A447,A478,A499,A502,A503,A504,A505,A552,A556
,A557,A559,A561,A567,A569,A580;
       end;
       suppose
A581:      i1+1 = i2 & j1 = j2 & i1'+1 = i2' & j1' = j2';
then A582:      j1 = j1' by A554,A559,A561,A563,A564,A565,A567,A569,A571,A572
,A573,GOBOARD7:22;
             i1 = i1' or i1 = i1'+1 or i1+1 = i1'
           by A554,A559,A561,A563,A564,A565,A567,A569,A571,A572,A573,A581,
GOBOARD7:25;
        hence contradiction by A478,A499,A502,A503,A505,A552,A557,A559,A561
,A567,A569,A581,A582;
       end;
       suppose
A583:      i1+1 = i2 & j1 = j2 & i1' = i2'+1 & j1' = j2';
then A584:      j1 = j1' by A554,A559,A561,A563,A564,A565,A567,A569,A571,A572
,A573,GOBOARD7:22;
             i1 = i2' or i1 = i2'+1 or i1+1 = i2'
           by A554,A559,A561,A563,A564,A565,A567,A569,A571,A572,A573,A583,
GOBOARD7:25;
        hence contradiction by A447,A478,A502,A504,A505,A552,A555,A556,A557
,A559,A561,A567,A569,A583,A584;
       end;
       suppose
A585:      i1+1 = i2 & j1 = j2 & i1' = i2' & j1' = j2'+1;
         then i1' = i1 & j1 = j2' or i1' = i1 & j2'+1 = j1 or
              i1' = i1+1 & j1 = j2' or i1' = i1+1 & j2'+1 = j1
           by A554,A559,A561,A563,A564,A565,A567,A569,A571,A572,A573,
GOBOARD7:23;
        hence contradiction by A447,A478,A499,A502,A504,A505,A552,A555,A556
,A557,A559,A561,A567,A569,A585;
       end;
       suppose
A586:      i1 = i2+1 & j1 = j2 & i1' = i2' & j1'+1 = j2';
         then i1' = i2 & j1' = j1 or i1' = i2 & j1'+1 = j1 or
              i1' = i2+1 & j1' = j1 or i1' = i2+1 & j1'+1 = j1
          by A554,A559,A561,A563,A564,A565,A567,A569,A571,A572,A573,GOBOARD7:23
;
        hence contradiction by A447,A478,A499,A502,A504,A505,A552,A555,A556
,A557,A559,A561,A567,A569,A586;
       end;
       suppose
A587:      i1 = i2+1 & j1 = j2 & i1'+1 = i2' & j1' = j2';
then A588:      j1 = j1' by A554,A559,A561,A563,A564,A565,A567,A569,A571,A572
,A573,GOBOARD7:22;
             i2 = i1' or i2 = i1'+1 or i2+1 = i1'
            by A554,A559,A561,A563,A564,A565,A567,A569,A571,A572,A573,A587,
GOBOARD7:25;
        hence contradiction by A447,A470,A499,A502,A504,A552,A555,A556,A557
,A559,A561,A567,A569,A587,A588;
       end;
       suppose
A589:      i1 = i2+1 & j1 = j2 & i1' = i2'+1 & j1' = j2';
then A590:      j1 = j1' by A554,A559,A561,A563,A564,A565,A567,A569,A571,A572
,A573,GOBOARD7:22;
             i2 = i2' or i2 = i2'+1 or i2+1 = i2'
           by A554,A559,A561,A563,A564,A565,A567,A569,A571,A572,A573,A589,
GOBOARD7:25;
        hence contradiction by A478,A499,A502,A505,A552,A555,A557,A559,A561
,A567,A569,A589,A590;
       end;
       suppose
A591:      i1 = i2+1 & j1 = j2 & i1' = i2' & j1' = j2'+1;
         then i1' = i2 & j2' = j1 or i1' = i2 & j2'+1 = j1 or
              i1' = i2+1 & j2' = j1 or i1' = i2+1 & j2'+1 = j1
            by A554,A559,A561,A563,A564,A565,A567,A569,A571,A572,A573,
GOBOARD7:23;
        hence contradiction by A447,A478,A499,A502,A504,A505,A552,A555,A556
,A557,A559,A561,A567,A569,A591;
       end;
       suppose
A592:      i1 = i2 & j1 = j2+1 & i1' = i2' & j1'+1 = j2';
then A593:      i1 = i1' by A554,A559,A561,A563,A564,A565,A567,A569,A571,A572
,A573,GOBOARD7:21;
             j2 = j1' or j2 = j1'+1 or j2+1 = j1'
           by A554,A559,A561,A563,A564,A565,A567,A569,A571,A572,A573,A592,
GOBOARD7:24;
        hence contradiction by A447,A470,A499,A502,A504,A552,A555,A556,A557
,A559,A561,A567,A569,A592,A593;
       end;
       suppose
A594:      i1 = i2 & j1 = j2+1 & i1'+1 = i2' & j1' = j2';
         then i1 = i1' & j2 = j1' or i1 = i1' & j2+1 = j1' or
              i1 = i1'+1 & j2 = j1' or i1 = i1'+1 & j2+1 = j1'
           by A554,A559,A561,A563,A564,A565,A567,A569,A571,A572,A573,
GOBOARD7:23;
        hence contradiction by A447,A478,A499,A502,A504,A505,A552,A555,A556
,A557,A559,A561,A567,A569,A594;
       end;
       suppose
A595:      i1 = i2 & j1 = j2+1 & i1' = i2'+1 & j1' = j2';
         then i1 = i2' & j2 = j1' or i1 = i2' & j2+1 = j1' or
              i1 = i2'+1 & j2 = j1' or i1 = i2'+1 & j2+1 = j1'
           by A554,A559,A561,A563,A564,A565,A567,A569,A571,A572,A573,
GOBOARD7:23;
        hence contradiction by A447,A478,A499,A502,A504,A505,A552,A555,A556
,A557,A559,A561,A567,A569,A595;
       end;
       suppose
A596:      i1 = i2 & j1 = j2+1 & i1' = i2' & j1' = j2'+1;
then A597:      i1 = i1' by A554,A559,A561,A563,A564,A565,A567,A569,A571,A572
,A573,GOBOARD7:21;
             j2 = j2' or j2 = j2'+1 or j2+1 = j2'
           by A554,A559,A561,A563,A564,A565,A567,A569,A571,A572,A573,A596,
GOBOARD7:24;
        hence contradiction by A478,A499,A502,A505,A552,A555,A557,A559,A561
,A567,A569,A596,A597;
      end;
      end;
     hence contradiction;
   end;
   end;
      m+1-(m-'1) <= len g by A440,A442,XREAL_1:11;
  then A598: m+1-(m-1) <= len g by A437,BINARITH:50;
  then A599: 1+m-m+1 <= len g;
      g is non constant
   proof
    take 1,2;
    thus
A600:   1 in dom g by FINSEQ_5:6;
    thus
A601:   2 in dom g by A598,FINSEQ_3:27;
    then g/.1 <> g/.(1+1) by A446,A600,GOBOARD7:31;
    then g.1 <> g/.(1+1) by A600,FINSEQ_4:def 4;
    hence g.1 <> g.2 by A601,FINSEQ_4:def 4;
   end;
  then reconsider g as standard non constant special_circular_sequence
   by A434,A443,A444,A445,A498,FINSEQ_6:def 1,JORDAN8:7;
      now
    assume m <> 1;
     then A602:  1 < m by A437,REAL_1:def 5;
A603:  LeftComp g is_a_component_of (L~g)` &
       RightComp g is_a_component_of (L~g)` by GOBOARD9:def 1,def 2;
    reconsider Lg' = (L~g)` as Subset of TOP-REAL 2;

A604:   C c= Lg'
    proof
     let c be set;
     assume that
A605:   c in C and
A606:   not c in Lg';
     reconsider c as Point of TOP-REAL 2 by A605;
         c in L~g by A606,SUBSET_1:50;
     then consider i such that
A607:   1 <= i & i+1 <= len g and
A608:   c in LSeg(g/.i,g/.(i+1)) by SPPOL_2:14;
         i in dom g & i+1 in dom g by A607,GOBOARD2:3;
then A609:   g/.i = f/.(i+(m-'1)) & g/.(i+1) = f/.(i+1+(m-'1)) by FINSEQ_5:30;
A610:   1 <= i+(m-'1) by A607,NAT_1:37;
   i+1+(m-'1) = i+(m-'1)+1;
     then A611: i+(m-'1)+1 <= (len g)+(m-'1) by A607,XREAL_1:8;
then A612:   i+(m-'1)+1 <= len f by A442;
      c in LSeg(f,i+(m-'1)) by A442,A608,A609,A610,A611,TOPREAL1:def 5;
     then c in left_cell(f,i+(m-'1),G) /\ right_cell(f,i+(m-'1),G)
      by A436,A610,A612,GOBRD13:30;
     then c in left_cell(f,i+(m-'1),G) by XBOOLE_0:def 3;
     then left_cell(f,i+(m-'1),G) meets C by A605,XBOOLE_0:3;
     hence contradiction by A306,A610,A612;
    end;
A613:   TOP-REAL 2 = TopSpaceMetr (Euclid 2) by EUCLID:def 8;
        L~g is closed by SPPOL_1:49;
    then (L~g)` is open by TOPS_1:29;
then A614:  (L~g)` = Int (L~g)` by TOPS_1:55;

A615: for j,k st 1 <= j & j <= k holds (F.k)/.j = (F.j)/.j
  proof
    let j,k;
    assume that
  A616: 1 <= j and
  A617: j <= k;
  A618: (F.k)|j = F.j by A364,A617;
          j <= len(F.k) by A107,A617;
  then len(F.k|j) = j by FINSEQ_1:80;
      then j in dom((F.k)|j) by A616,FINSEQ_3:27;
      hence thesis by A618,FINSEQ_4:85;
  end;

A619:  L~g c= L~f by JORDAN3:75;

A620: for n st 1 <= n & n <= m-'1 holds not f/.n in L~g
  proof
    let n such that
  A621: 1 <= n and
  A622: n <= m-'1;
  A623: n <= len f by A441,A622,XXREAL_0:2;

    set p = f/.n;
    assume p in L~g;
    then consider j such that
  A624: m-'1+1 <= j and
  A625: j+1 <= len f and
  A626: p in LSeg(f,j) by A441,Th9;

  A627: n < m-'1+1 by A622,NAT_1:38;
  then A628: n < j by A624,XXREAL_0:2;

  A629: m-'1+1=m by A437,BINARITH:53;
  then A630: 1 < j by A602,A624,XXREAL_0:2;
  A631: j < k by A435,A625,NAT_1:38;
 A632: 2 <= len G & 2 <= width G by A2,NAT_1:37;
A633: p in Values G by A436,A621,A623,Th8;
    per cases by A436,A625,A626,A630,A632,A633,Th25;
    suppose
    A634: p = f/.j;
          n <= len(F.j) by A107,A628;
    then A635: n in dom(F.j) by A621,FINSEQ_3:27;
    A636: n <> len(F.j) by A107,A624,A627;
          (F.j)/.n = (F.n)/.n by A615,A621,A628
              .= p by A435,A615,A621,A623
              .= (F.j)/.j by A615,A630,A631,A634
              .= (F.j)/.len(F.j) by A107;
      hence contradiction by A431,A630,A631,A635,A636;

    end;
    suppose
    A637: p = f/.(j+1);
          now
        per cases by A435,A625,REAL_1:def 5;
        suppose
        A638: j+1 = k;
              n <= len(F.m) by A107,A627,A629;
        then A639: n in dom(F.m) by A621,FINSEQ_3:27;
        A640: n <> len(F.m) by A107,A627,A629;
              (F.m)/.n = (F.n)/.n by A615,A621,A627,A629
                  .= (F.k)/.k by A435,A615,A621,A623,A637,A638
                  .= (F.m)/.m by A434,A435,A437,A615
                  .= (F.m)/.len(F.m) by A107;
          hence contradiction by A431,A435,A437,A438,A639,A640;
        end;
        suppose
        A641: j+1 < k;
          set l = j+1;
        A642: 1 <= l by NAT_1:29;
          A643: n < n+1 & n+1 < l by A628,XREAL_1:8,XREAL_1:31;
        then A644: n < l by XXREAL_0:2;
          then n <= len(F.l) by A107;
        then A645: n in dom(F.l) by A621,FINSEQ_3:27;
        A646: n <> len(F.l) by A107,A643;
              (F.l)/.n = (F.n)/.n by A615,A621,A644
                  .= p by A435,A615,A621,A623
                  .= (F.l)/.l by A615,A637,A641,A642
                  .= (F.l)/.len(F.l) by A107;
          hence contradiction by A431,A641,A642,A645,A646;
      end;
      end;
      hence contradiction;
  end;
  end;

A647: for h being standard non constant special_circular_sequence st L~h c= L~f
    for Comp being Subset of TOP-REAL 2 st Comp is_a_component_of (L~h)`
    for n st 1 <= n & n+1 <= len f & f/.n in Comp & not f/.n in L~h
      holds
     C meets Comp
  proof
    let h be standard non constant special_circular_sequence such that
  A648: L~h c= L~f;
    let Comp be Subset of TOP-REAL 2 such that
  A649: Comp is_a_component_of (L~h)`;
    let n such that
  A650: 1 <= n & n+1 <= len f and
  A651: f/.n in Comp and
  A652: not f/.n in L~h;

    reconsider rc = right_cell(f,n,G)\L~h as Subset of TOP-REAL 2;
  A653: rc c= right_cell(f,n,G) by XBOOLE_1:36;
  A654: rc = right_cell(f,n,G) /\ (L~h)` by SUBSET_1:32;

  A655: rc meets C
  proof
        right_cell(f,n,G) meets C by A306,A650;
    then consider p being set such that
  A656: p in right_cell(f,n,G) & p in C by XBOOLE_0:3;
    reconsider p as Element of TOP-REAL 2 by A656;
        now take a = p;
        now
      assume p in L~h;
      then consider j such that
    A657: 1 <= j and
    A658: j+1 <= len f and
    A659: p in LSeg(f,j) by A648,SPPOL_2:13;
          p in
 left_cell(f,j,G) /\ right_cell(f,j,G) by A436,A657,A658,A659,GOBRD13:30;
    then A660: p in left_cell(f,j,G) by XBOOLE_0:def 3;
          left_cell(f,j,G) misses C by A306,A657,A658;
      hence contradiction by A656,A660,XBOOLE_0:3;
    end;
    hence a in rc by A656,XBOOLE_0:def 4;
    thus a in C by A656;
  end; hence thesis by XBOOLE_0:3; end;

  A661: Int right_cell(f,n,G) is connected by A436,A650,Th12;
        Int right_cell(f,n,G) misses L~f by A436,A650,Th17;
    then Int right_cell(f,n,G) misses L~h by A648,XBOOLE_1:63;
  then A662: Int right_cell(f,n,G) c= (L~h)` by SUBSET_1:43;
        Int right_cell(f,n,G) c= right_cell(f,n,G) by TOPS_1:44;
  then A663: Int right_cell(f,n,G) c= rc by A654,A662,XBOOLE_1:19;
        rc c= Cl Int right_cell(f,n,G) by A436,A650,A653,Th13;
  then A664: rc is connected by A661,A663,CONNSP_1:19;
        f/.n in right_cell(f,n,G) by A436,A650,Th10;
    then f/.n in rc by A652,XBOOLE_0:def 4;
  then A665: rc meets Comp by A651,XBOOLE_0:3;
        rc c= (L~h)` by A654,XBOOLE_1:17;
    then rc c= Comp by A649,A664,A665,GOBOARD9:6;
    hence C meets Comp by A655,XBOOLE_1:63;
  end;

A666:
 C meets RightComp Rev g
  proof
    set rg=Rev g;

  A667: rg is_sequence_on G by A445,Th7;

  A668: 1+1 <= len rg by A598,FINSEQ_5:def 3;
    then 1+1-'1 <= len rg-'1 by JORDAN3:5;
  then A669: 1 <= len rg -'1 by BINARITH:39;
        1 < len rg by A668,NAT_1:38;
  then A670: len rg -'1+1 = len rg by BINARITH:53;

    set p = rg/.1, q = rg/.2;
    set a = f/.(m-'1);
    set l = (m-'1)+(len g-'1);

  A671: p = f/.m by A434,A444,FINSEQ_5:68;
  A672: m-'1+1 = m by A437,BINARITH:53;
  then A673: 1 <= m-'1 by A602,NAT_1:38;

        1+1-'1 <= len g-'1 by A598,JORDAN3:5;
  then A674: 1 <= len g-'1 by BINARITH:39;
        1+1 - 1 <= len g - 1 by A598,XREAL_1:11;
  then A675: 0 <= len g - 1;
A676: 1 - 1 < m - 1 by A602,XREAL_1:11;
        l = m+(len g -'1)-'1 by A437,BINARITH:56
     .= (len g -'1)+m - 1 by A674,BINARITH:55
     .= (len g - 1)+m - 1 by A675,BINARITH:def 3
     .= ((k - (m - 1)) - 1)+m - 1 by A435,A442,A676,BINARITH:def 3
     .= k - 1;
  then A677: k = l+1;
  then A678: l < k by XREAL_1:31;
        len g-'1 <= l by NAT_1:29;
  then A679: 1 <= l by A674,XXREAL_0:2;
        len g-'1 <= len g by JORDAN3:7;
  then A680: len g-'1 in dom g by A674,FINSEQ_3:27;
        1 <= len g by A599,SPPOL_1:5;
  then A681: len g-'1+2 = len g+1 by Lm1;
  then A682: q = g/.(len g-'1) by A680,FINSEQ_5:69
       .= f/.l by A680,FINSEQ_5:30;
  A683: right_cell(f,m-'1,G) meets C by A306,A437,A672,A673;
  A684: right_cell(f,l,G) meets C by A306,A435,A677,A679;

        not a in L~g by A620,A673;
  then A685: not a in L~rg by SPPOL_2:22;

  A686: m-'1+2 = m+1 by A437,Lm1;

  A687: m-'1 <= l by NAT_1:29;
    then m-'1 <= len(F.l) by A107;
  then A688: m-'1 in dom(F.l) by A673,FINSEQ_3:27;
        (m-'1)+1 <= l by A674,XREAL_1:8;
    then m-'1 < l by NAT_1:38;
  then A689: m-'1 <> len(F.l) by A107;

    consider p1,p2,q1,q2 being Nat such that
  A690: [p1,p2] in Indices G and
  A691: p = G*(p1,p2) and
  A692: [q1,q2] in Indices G and
  A693: q = G*(q1,q2) and
  A694: p1 = q1 & p2+1 = q2 or p1+1 = q1 & p2 = q2 or
        p1 = q1+1 & p2 = q2 or p1 = q1 & p2 = q2+1 by A667,A668,JORDAN8:6;

  A695: 1 <= p1 & p1 <= len G & 1 <= p2 & p2 <= width G by A690,GOBOARD5:1;

    per cases by A694;
    suppose
    A696: p1 = q1 & p2+1 = q2;
      consider a1,a2,p'1,p'2 being Nat such that
    A697: [a1,a2] in Indices G and
    A698: a = G*(a1,a2) and
    A699: [p'1,p'2] in Indices G and
    A700: p = G*(p'1,p'2) and
    A701: a1 = p'1 & a2+1 = p'2 or a1+1 = p'1 & a2 = p'2 or
          a1 = p'1+1 & a2 = p'2 or a1 = p'1 & a2 = p'2+1
            by A436,A437,A671,A672,A673,JORDAN8:6;
    A702: 1 <= a1 & a1 <= len G & 1 <= a2 & a2 <= width G by A697,GOBOARD5:1;

      thus thesis
      proof
        per cases by A701;
        suppose
              a1 = p'1 & a2+1 = p'2;
        then A703: a1 = p1 & a2+1 = p2 by A690,A691,A699,A700,GOBOARD1:21;
        A704: F.m is_sequence_on G by A306;
        A705: m-'1+1 <= len (F.m) by A107,A672;
        A706: m-'1 <= m by A672,NAT_1:29;
        A707: F.k|(m+1)=F.(m+1) by A364,A435,A440;
A708:      p2+1 > a2+1 & a2+1 > a2 by A703,NAT_1:38;
        A709: f/.(m-'1) = (F.(m-'1))/.(m-'1) by A435,A441,A615,A673
                     .= (F.m)/.(m-'1) by A615,A673,A706;
        A710: f/.(m-'1+1) = (F.m)/.m by A435,A437,A615,A672;
              right_cell(f,l,G) = cell(G,p1-'1,p2)
                 by A434,A435,A436,A671,A677,A679,A682,A690,A691,A692,A693,A696
,GOBRD13:29
            .= front_left_cell(F.m,m-'1,G) by A671,A672,A673,A690,A691,A697
,A698,A703,A704,A705,A709,A710,GOBRD13:35;
          then F.(m+1) turns_left m-'1,G by A365,A602,A684;
          then f turns_left m-'1,G by A440,A673,A686,A707,GOBRD13:45;
        then A711: f/.(m+1) = G*(p1-'1,p2) & [p1-'1,p2] in Indices G
            by A671,A672,A686,A690,A691,A697,A698,A708,GOBRD13:def 7;
        then A712: 1 <= p1-'1 & p1-'1 <= len G by GOBOARD5:1;

          set rc = right_cell(rg,len rg-'1,G)\L~rg;
        A713: rc c= RightComp rg by A667,A669,A670,Th29;
        A714: p2-'1 = a2 & p1-'1+1 = p1 by A695,A703,BINARITH:53,BINARITH:39;
        A715: 2 in dom g by A598,FINSEQ_3:27;
               len rg-'1+2 = len g +1 by A681,FINSEQ_5:def 3;
        then A716: rg/.(len rg-'1) = g/.2 by A715,FINSEQ_5:69
                           .= f/.(m+1) by A686,A715,FINSEQ_5:30;
            p = g/.1 by A434,A443,A444,FINSEQ_5:68
              .= rg/.len g by FINSEQ_5:68
              .= rg/.len rg by FINSEQ_5:def 3;
          then right_cell(rg,len rg-'1,G) = cell(G,p1-'1,a2)
            by A667,A669,A670,A690,A691,A711,A714,A716,GOBRD13:25;
          then a in right_cell(rg,len rg-'1,G)
            by A695,A698,A702,A703,A712,A714,Th22;
then A717:       a in rc by A685,XBOOLE_0:def 4;
        A718: L~rg c= L~f by A619,SPPOL_2:22;
              RightComp rg is_a_component_of (L~rg)` by GOBOARD9:def 2;
          hence C meets RightComp Rev g by A437,A647,A672,A673,A685,A713,A717
,A718;

        end;
        suppose
          A719: a1+1 = p'1 & a2 = p'2;
        then A720: a1+1 = p1 & a2 = p2 by A690,A691,A699,A700,GOBOARD1:21;
        then q1-'1 = a1 by A696,BINARITH:39;
          then right_cell(f,l,G) = cell(G,a1,a2)
                 by A434,A435,A436,A671,A677,A679,A682,A690,A691,A692,A693,A696
,A720,GOBRD13:29
            .= left_cell(f,m-'1,G)
                 by A436,A437,A671,A672,A673,A697,A698,A699,A700,A719,
GOBRD13:24;
          hence C meets RightComp Rev g by A306,A437,A672,A673,A684;

        end;
        suppose
              a1 = p'1+1 & a2 = p'2;
        then a1 = p1+1 & a2 = p2 by A690,A691,A699,A700,GOBOARD1:21;
          then right_cell(f,m-'1,G) = cell(G,p1,p2)
                 by A436,A437,A671,A672,A673,A690,A691,A697,A698,GOBRD13:27
            .= left_cell(f,l,G)
                 by A434,A435,A436,A671,A677,A679,A682,A690,A691,A692,A693,A696
,GOBRD13:28;
          hence C meets RightComp Rev g by A306,A435,A677,A679,A683;

        end;
        suppose
              a1 = p'1 & a2 = p'2+1;
        then A721: a1 = q1 & a2 = q2 by A690,A691,A696,A699,A700,GOBOARD1:21;
              (F.l)/.(m-'1) = (F.(m-'1))/.(m-'1) by A615,A673,A687
                     .= q by A435,A441,A615,A673,A693,A698,A721
                     .= (F.l)/.l by A615,A678,A679,A682
                     .= (F.l)/.len(F.l) by A107;
          hence C meets RightComp Rev g by A431,A678,A679,A688,A689;
      end;
      end;

    end;
    suppose
    A722: p1+1 = q1 & p2 = q2;
      consider a1,a2,p'1,p'2 being Nat such that
    A723: [a1,a2] in Indices G and
    A724: a = G*(a1,a2) and
    A725: [p'1,p'2] in Indices G and
    A726: p = G*(p'1,p'2) and
    A727: a1 = p'1 & a2+1 = p'2 or a1+1 = p'1 & a2 = p'2 or
          a1 = p'1+1 & a2 = p'2 or a1 = p'1 & a2 = p'2+1
            by A436,A437,A671,A672,A673,JORDAN8:6;
    A728: 1 <= a1 & a1 <= len G & 1 <= a2 & a2 <= width G by A723,GOBOARD5:1;

      thus thesis
      proof
        per cases by A727;
        suppose
          A729: a1 = p'1 & a2+1 = p'2;
        then A730: a1 = p1 & a2+1 = p2 by A690,A691,A725,A726,GOBOARD1:21;
        then A731: q2-'1 = a2 by A722,BINARITH:39;
              right_cell(f,m-'1,G) = cell(G,a1,a2)
                 by A436,A437,A671,A672,A673,A723,A724,A725,A726,A729,
GOBRD13:23
            .= left_cell(f,l,G)
                by A434,A435,A436,A671,A677,A679,A682,A690,A691,A692,A693,A722
,A730,A731,GOBRD13:26;
          hence C meets RightComp Rev g by A306,A435,A677,A679,A683;

        end;
        suppose
              a1+1 = p'1 & a2 = p'2;
        then A732: a1+1 = p1 & a2 = p2 by A690,A691,A725,A726,GOBOARD1:21;
        A733: F.m is_sequence_on G by A306;
        A734: m-'1+1 <= len (F.m) by A107,A672;
        A735: m-'1 <= m by A672,NAT_1:29;
        A736: F.k|(m+1)=F.(m+1) by A364,A435,A440;
A737:      a1 < a1+1 & p1 < p1+1 by XREAL_1:31;
        A738: f/.(m-'1) = (F.(m-'1))/.(m-'1) by A435,A441,A615,A673
                     .= (F.m)/.(m-'1) by A615,A673,A735;
        A739: f/.(m-'1+1) = (F.m)/.m by A435,A437,A615,A672;
              right_cell(f,l,G) = cell(G,p1,p2)
                 by A434,A435,A436,A671,A677,A679,A682,A690,A691,A692,A693,A722
,GOBRD13:27
            .= front_left_cell(F.m,m-'1,G) by A671,A672,A673,A690,A691,A723
,A724,A732,A733,A734,A738,A739,GOBRD13:37;
          then F.(m+1) turns_left m-'1,G by A365,A602,A684;
          then f turns_left m-'1,G by A440,A673,A686,A736,GOBRD13:45;
        then A740: f/.(m+1) = G*(p1,p2+1) & [p1,p2+1] in Indices G
            by A671,A672,A686,A690,A691,A723,A724,A732,A737,GOBRD13:def 7;
        then A741: p2+1 <= width G by GOBOARD5:1;

          set rc = right_cell(rg,len rg-'1,G)\L~rg;
        A742: rc c= RightComp rg by A667,A669,A670,Th29;
        A743: a1 = p1-'1 by A732,BINARITH:39;
        A744: 2 in dom g by A598,FINSEQ_3:27;
               len rg-'1+2 = len g +1 by A681,FINSEQ_5:def 3;
        then A745: rg/.(len rg-'1) = g/.2 by A744,FINSEQ_5:69
                           .= f/.(m+1) by A686,A744,FINSEQ_5:30;
               p = g/.1 by A434,A443,A444,FINSEQ_5:68
              .= rg/.len g by FINSEQ_5:68
              .= rg/.len rg by FINSEQ_5:def 3;
          then right_cell(rg,len rg-'1,G) = cell(G,p1-'1,a2)
            by A667,A669,A670,A690,A691,A732,A740,A745,GOBRD13:29;
          then a in right_cell(rg,len rg-'1,G)
            by A695,A724,A728,A732,A741,A743,Th22;
then A746:       a in rc by A685,XBOOLE_0:def 4;
        A747: L~rg c= L~f by A619,SPPOL_2:22;
              RightComp rg is_a_component_of (L~rg)` by GOBOARD9:def 2;
          hence C meets RightComp Rev g by A437,A647,A672,A673,A685,A742,A746
,A747;

        end;
        suppose
              a1 = p'1+1 & a2 = p'2;
        then A748: a1 = q1 & a2 = q2 by A690,A691,A722,A725,A726,GOBOARD1:21;
              (F.l)/.(m-'1) = (F.(m-'1))/.(m-'1) by A615,A673,A687
                     .= q by A435,A441,A615,A673,A693,A724,A748
                     .= (F.l)/.l by A615,A678,A679,A682
                     .= (F.l)/.len(F.l) by A107;
          hence C meets RightComp Rev g by A431,A678,A679,A688,A689;

        end;
        suppose
              a1 = p'1 & a2 = p'2+1;
        then A749: a1 = p1 & a2 = p2+1 by A690,A691,A725,A726,GOBOARD1:21;
              right_cell(f,l,G) = cell(G,p1,p2)
                 by A434,A435,A436,A671,A677,A679,A682,A690,A691,A692,A693,A722
,GOBRD13:27
            .= left_cell(f,m-'1,G)
                 by A436,A437,A671,A672,A673,A690,A691,A723,A724,A749,
GOBRD13:28;
          hence C meets RightComp Rev g by A306,A437,A672,A673,A684;
      end;
      end;

    end;
    suppose
    A750: p1 = q1+1 & p2 = q2;
      consider a1,a2,p'1,p'2 being Nat such that
    A751: [a1,a2] in Indices G and
    A752: a = G*(a1,a2) and
    A753: [p'1,p'2] in Indices G and
    A754: p = G*(p'1,p'2) and
    A755: a1 = p'1 & a2+1 = p'2 or a1+1 = p'1 & a2 = p'2 or
          a1 = p'1+1 & a2 = p'2 or a1 = p'1 & a2 = p'2+1
            by A436,A437,A671,A672,A673,JORDAN8:6;
    A756: 1 <= a1 & a1 <= len G & 1 <= a2 & a2 <= width G by A751,GOBOARD5:1;

      thus thesis
      proof
        per cases by A755;
        suppose
          A757: a1 = p'1 & a2+1 = p'2;
        then A758: a1 = p1 & a2+1 = p2 by A690,A691,A753,A754,GOBOARD1:21;
        then A759: q1 = a1-'1 by A750,BINARITH:39;
        A760: q2-'1 = a2 by A750,A758,BINARITH:39;
              right_cell(f,l,G) = cell(G,q1,q2-'1)
              by A434,A435,A436,A671,A677,A679,A682,A690,A691,A692,A693,A750,
GOBRD13:25
            .= left_cell(f,m-'1,G)
              by A436,A437,A671,A672,A673,A751,A752,A753,A754,A757,A759,A760,
GOBRD13:22;
          hence C meets RightComp Rev g by A306,A437,A672,A673,A684;

        end;
        suppose
              a1+1 = p'1 & a2 = p'2;
          then a1+1 = p1 & a2 = p2 by A690,A691,A753,A754,GOBOARD1:21;
        then A761: a1 = q1 & a2 = q2 by A750;
              (F.l)/.(m-'1) = (F.(m-'1))/.(m-'1) by A615,A673,A687
                     .= q by A435,A441,A615,A673,A693,A752,A761
                     .= (F.l)/.l by A615,A678,A679,A682
                     .= (F.l)/.len(F.l) by A107;
          hence C meets RightComp Rev g by A431,A678,A679,A688,A689;

        end;
        suppose
              a1 = p'1+1 & a2 = p'2;
        then A762: a1 = p1+1 & a2 = p2 by A690,A691,A753,A754,GOBOARD1:21;
        A763: p1-'1 = q1 by A750,BINARITH:39;
        A764: F.m is_sequence_on G by A306;
        A765: m-'1+1 <= len (F.m) by A107,A672;
        A766: m-'1 <= m by A672,NAT_1:29;
        A767: F.k|(m+1)=F.(m+1) by A364,A435,A440;
               p1+1>p1 by XREAL_1:31;
        then A768: a2+1 > p2 & a1+1 > p1 & a2 < p2+1 by A762,NAT_1:38;
        A769: f/.(m-'1) = (F.(m-'1))/.(m-'1) by A435,A441,A615,A673
                     .= (F.m)/.(m-'1) by A615,A673,A766;
        A770: f/.(m-'1+1) = (F.m)/.m by A435,A437,A615,A672;
              right_cell(f,l,G) = cell(G,q1,q2-'1)
                 by A434,A435,A436,A671,A677,A679,A682,A690,A691,A692,A693,A750
,GOBRD13:25
            .= front_left_cell(F.m,m-'1,G) by A671,A672,A673,A690,A691,A750
,A751,A752,A762,A763,A764,A765,A769,A770,GOBRD13:39
;
          then F.(m+1) turns_left m-'1,G by A365,A602,A684;
          then f turns_left m-'1,G by A440,A673,A686,A767,GOBRD13:45;
        then A771: f/.(m+1) = G*(p1,p2-'1) & [p1,p2-'1] in Indices G
            by A671,A672,A686,A690,A691,A751,A752,A768,GOBRD13:def 7;
        then A772: 1 <= p2-'1 & p2-'1 <= width G by GOBOARD5:1;

          set rc = right_cell(rg,len rg-'1,G)\L~rg;
        A773: rc c= RightComp rg by A667,A669,A670,Th29;
        A774: p2-'1+1 = p2 by A695,BINARITH:53;
        A775: 2 in dom g by A598,FINSEQ_3:27;
               len rg-'1+2 = len g +1 by A681,FINSEQ_5:def 3;
        then A776: rg/.(len rg-'1) = g/.2 by A775,FINSEQ_5:69
                           .= f/.(m+1) by A686,A775,FINSEQ_5:30;
                p = g/.1 by A434,A443,A444,FINSEQ_5:68
              .= rg/.len g by FINSEQ_5:68
              .= rg/.len rg by FINSEQ_5:def 3;
          then right_cell(rg,len rg-'1,G) = cell(G,p1,p2-'1)
            by A667,A669,A670,A690,A691,A771,A774,A776,GOBRD13:23;
          then a in right_cell(rg,len rg-'1,G)
            by A695,A752,A756,A762,A772,A774,Th22;
then A777:       a in rc by A685,XBOOLE_0:def 4;
        A778: L~rg c= L~f by A619,SPPOL_2:22;
              RightComp rg is_a_component_of (L~rg)` by GOBOARD9:def 2;
          hence C meets RightComp Rev g by A437,A647,A672,A673,A685,A773,A777
,A778;

        end;
        suppose
              a1 = p'1 & a2 = p'2+1;
        then A779: a1 = p1 & a2 = p2+1 by A690,A691,A753,A754,GOBOARD1:21;
        then q1 = a1-'1 by A750,BINARITH:39;
          then right_cell(f,m-'1,G) = cell(G,q1,q2)
                 by A436,A437,A671,A672,A673,A690,A691,A750,A751,A752,A779,
GOBRD13:29
            .= left_cell(f,l,G)
                 by A434,A435,A436,A671,A677,A679,A682,A690,A691,A692,A693,A750
,GOBRD13:24;
          hence C meets RightComp Rev g by A306,A435,A677,A679,A683;
      end;
      end;

    end;
    suppose
    A780: p1 = q1 & p2 = q2+1;
      consider a1,a2,p'1,p'2 being Nat such that
    A781: [a1,a2] in Indices G and
    A782: a = G*(a1,a2) and
    A783: [p'1,p'2] in Indices G and
    A784: p = G*(p'1,p'2) and
    A785: a1 = p'1 & a2+1 = p'2 or a1+1 = p'1 & a2 = p'2 or
          a1 = p'1+1 & a2 = p'2 or a1 = p'1 & a2 = p'2+1
            by A436,A437,A671,A672,A673,JORDAN8:6;
    A786: 1 <= a1 & a1 <= len G & 1 <= a2 & a2 <= width G by A781,GOBOARD5:1;

      thus thesis
      proof
        per cases by A785;
        suppose
              a1 = p'1 & a2+1 = p'2;
          then a1 = p1 & a2+1 = p2 by A690,A691,A783,A784,GOBOARD1:21;
        then A787: a1 = q1 & a2 = q2 by A780;
              (F.l)/.(m-'1) = (F.(m-'1))/.(m-'1) by A615,A673,A687
                     .= q by A435,A441,A615,A673,A693,A782,A787
                     .= (F.l)/.l by A615,A678,A679,A682
                     .= (F.l)/.len(F.l) by A107;
          hence C meets RightComp Rev g by A431,A678,A679,A688,A689;

        end;
        suppose
          A788: a1+1 = p'1 & a2 = p'2;
        then A789: a1+1 = p1 & a2 = p2 by A690,A691,A783,A784,GOBOARD1:21;
        then A790: a1 = q1-'1 by A780,BINARITH:39;
        A791: a2-'1 = q2 by A780,A789,BINARITH:39;
              right_cell(f,m-'1,G) = cell(G,a1,a2-'1)
                 by A436,A437,A671,A672,A673,A781,A782,A783,A784,A788,
GOBRD13:25
            .= left_cell(f,l,G)
                by A434,A435,A436,A671,A677,A679,A682,A690,A691,A692,A693,A780
,A790,A791,GOBRD13:22;
          hence C meets RightComp Rev g by A306,A435,A677,A679,A683;

        end;
        suppose
              a1 = p'1+1 & a2 = p'2;
        then A792: a1 = p1+1 & a2 = p2 by A690,A691,A783,A784,GOBOARD1:21;
        then A793: a2-'1 = q2 by A780,BINARITH:39;
              right_cell(f,l,G) = cell(G,q1,q2)
                 by A434,A435,A436,A671,A677,A679,A682,A690,A691,A692,A693,A780
,GOBRD13:23
            .= left_cell(f,m-'1,G)
                 by A436,A437,A671,A672,A673,A690,A691,A780,A781,A782,A792,A793
,GOBRD13:26;
          hence C meets RightComp Rev g by A306,A437,A672,A673,A684;

        end;
        suppose
              a1 = p'1 & a2 = p'2+1;
        then A794: a1 = p1 & a2 = p2+1 by A690,A691,A783,A784,GOBOARD1:21;
        A795: p2-'1 = q2 by A780,BINARITH:39;
        A796: F.m is_sequence_on G by A306;
        A797: m-'1+1 <= len (F.m) by A107,A672;
        A798: m-'1 <= m by A672,NAT_1:29;
        A799: F.k|(m+1)=F.(m+1) by A364,A435,A440;
A800:      a2+1>p2+1 & p2+1>p2 by A794,NAT_1:38;
        A801: f/.(m-'1) = (F.(m-'1))/.(m-'1) by A435,A441,A615,A673
                     .= (F.m)/.(m-'1) by A615,A673,A798;
        A802: f/.(m-'1+1) = (F.m)/.m by A435,A437,A615,A672;
              right_cell(f,l,G) = cell(G,q1,q2)
                 by A434,A435,A436,A671,A677,A679,A682,A690,A691,A692,A693,A780
,GOBRD13:23
            .= front_left_cell(F.m,m-'1,G) by A671,A672,A673,A690,A691,A780
,A781,A782,A794,A795,A796,A797,A801,A802,GOBRD13:41
;
          then F.(m+1) turns_left m-'1,G by A365,A602,A684;
          then f turns_left m-'1,G by A440,A673,A686,A799,GOBRD13:45;
        then A803: f/.(m+1) = G*(p1+1,p2) & [p1+1,p2] in Indices G
            by A671,A672,A686,A690,A691,A781,A782,A800,GOBRD13:def 7;
        then A804: p1+1 <= len G by GOBOARD5:1;

          set rc = right_cell(rg,len rg-'1,G)\L~rg;
        A805: rc c= RightComp rg by A667,A669,A670,Th29;
        A806: 2 in dom g by A598,FINSEQ_3:27;
               len rg-'1+2 = len g +1 by A681,FINSEQ_5:def 3;
        then A807: rg/.(len rg-'1) = g/.2 by A806,FINSEQ_5:69
                           .= f/.(m+1) by A686,A806,FINSEQ_5:30;
            p = g/.1 by A434,A443,A444,FINSEQ_5:68
              .= rg/.len g by FINSEQ_5:68
              .= rg/.len rg by FINSEQ_5:def 3;
          then right_cell(rg,len rg-'1,G) = cell(G,p1,p2)
            by A667,A669,A670,A690,A691,A803,A807,GOBRD13:27;
          then a in right_cell(rg,len rg-'1,G)
            by A695,A782,A786,A794,A804,Th22;
then A808:       a in rc by A685,XBOOLE_0:def 4;
        A809: L~rg c= L~f by A619,SPPOL_2:22;
              RightComp rg is_a_component_of (L~rg)` by GOBOARD9:def 2;
          hence C meets RightComp Rev g by A437,A647,A672,A673,A685,A805,A808
,A809;
      end;
      end;
  end;
  end;
A810: C meets RightComp g
   proof
        right_cell(f,m,G) meets C by A306,A437,A440;
    then consider p being set such that
A811:  p in right_cell(f,m,G) & p in C by XBOOLE_0:3;
    reconsider p as Element of TOP-REAL 2 by A811;
        now take a = p;
    thus a in C by A811;
    reconsider u = p as Element of Euclid 2 by TOPREAL3:13;
    consider r being real number such that
A812:   r > 0 and
A813:   Ball(u,r) c= (L~g)` by A604,A614,A811,GOBOARD6:8;
    reconsider r as Real by XREAL_0:def 1;
A814:   p in Ball(u,r) by A812,GOBOARD6:4;
    reconsider B = Ball(u,r) as non empty Subset of TOP-REAL 2
       by A613,A812,GOBOARD6:4,TOPMETR:16;
A815:   B is connected by SPRECT_3:17;
        right_cell(g,1,G) c= right_cell(g,1) by A445,A599,GOBRD13:34;
then A816:   Int right_cell(g,1,G) c= Int right_cell(g,1) by TOPS_1:48;
        Int right_cell(g,1) c= RightComp g by A599,GOBOARD9:28;
    then Int right_cell(g,1,G) c= RightComp g by A816,XBOOLE_1:1;
    then Int right_cell(f,m-'1+1,G) c= RightComp g by A436,A441,A599,GOBRD13:33
;
    then A817:  Int right_cell(f,m,G) c= RightComp g by A437,BINARITH:53;
A818:   right_cell(f,m,G) = Cl Int right_cell(f,m,G) by A437,A440,A484;
        B is open by GOBOARD6:6;
then A819:   Int right_cell(f,m,G) meets B by A811,A814,A818,TOPS_1:39;
A820:   p in B by A812,GOBOARD6:4;
        B c= RightComp g by A603,A813,A815,A817,A819,GOBOARD9:6;
    hence a in RightComp g by A820;
   end; hence thesis by XBOOLE_0:3; end;
        C meets LeftComp g by A666,GOBOARD9:27;
    then LeftComp g = RightComp g by A1,A603,A604,A810,Th3;
    hence contradiction by SPRECT_4:7;
  end;
then A821: g = f/^0 by BINARITH:51
      .= f by FINSEQ_5:31;
A822:
  now
   consider i such that
A823:   1 <= i & i+1 <= len G and
A824:   N-min C in cell(G,i,width G-'1) & N-min C <> G*(i,width G-'1) and
A825:   F.(1+1) = <*G*(i,width G),G*(i+1,width G)*> by A92;
   take i;
   thus 1 <= i & i+1 <= len G by A823;
A826:  f|2 = F.2 by A364,A435,A439;
A827:  len(f|2) = 2 by A439,FINSEQ_1:80;
   then 1 in dom(f|2) by FINSEQ_3:27;
   hence f/.1 = (f|2)/.1 by FINSEQ_4:85
               .= G*(i,width G) by A825,A826,FINSEQ_4:26;
       2 in dom(f|2) by A827,FINSEQ_3:27;
   hence f/.2 = (f|2)/.2 by FINSEQ_4:85
               .= G*(i+1,width G) by A825,A826,FINSEQ_4:26;
   thus N-min C in cell(G,i,width G-'1) & N-min C <> G*
(i,width G-'1) by A824;
  end;
  reconsider f as standard non constant special_circular_sequence by A821;
      f is clockwise_oriented
  proof
        len G >= 3 by A2,NAT_1:37;
then A828:  1 < len G by XXREAL_0:2;
     for k st 1 <= k & k+1 <= len f
      holds left_cell(f,k,G) misses C & right_cell(f,k,G) meets C by A306;
    then A829:   N-min L~f = f/.1 by A436,A822,Th32;
        f/.2 in LSeg(f/.1,f/.(1+1)) by TOPREAL1:6;
then A830:  f/.2 in L~f by A439,SPPOL_2:15;
    consider i such that
A831:  1 <= i & i+1 <= len G and
A832:  f/.1 = G*(i,width G) and
A833:  f/.2 = G*(i+1,width G) and
           N-min C in cell(G,i,width G-'1) & N-min C <> G*(i,width G-'1) by
A822;
A834:  (NW-corner L~f)`2 = (NE-corner L~f)`2 by PSCOMP_1:82;
A835:  (NE-corner L~f)`2 = N-bound L~f & (N-min L~f)`2 = N-bound L~f
        by EUCLID:56;
          i < len G by A831,NAT_1:38;
then A836:  G*(i,width G)`2 = G*(1,width G)`2 by A2,A828,A831,GOBOARD5:2;
          1 <= i+1 by NAT_1:37;
then A837:   G*(i+1,width G)`2 = G*(1,width G)`2 by A2,A828,A831,GOBOARD5:2;
        (NW-corner L~f)`1 = W-bound L~f & (NE-corner L~f)`1 = E-bound L~f
       by EUCLID:56;
    then (NW-corner L~f)`1 <= (f/.2)`1 & (f/.2)`1 <= (NE-corner L~f)`1
       by A830,PSCOMP_1:71;
    then f/.2 in LSeg(NW-corner L~f, NE-corner L~f)
     by A829,A832,A833,A834,A835,A836,A837,GOBOARD7:9;
    then f/.2 in LSeg(NW-corner L~f, NE-corner L~f) /\ L~f by A830,
XBOOLE_0:def 3;
    then f/.2 in N-most L~f;
    hence thesis by A829,SPRECT_2:34;
   end;
  then reconsider f as
   clockwise_oriented (standard non constant special_circular_sequence);
  take f;
  thus f is_sequence_on G by A306;
  thus ex i st 1 <= i & i+1 <= len G &
    f/.1 = G*(i,width G) & f/.2 = G*(i+1,width G) &
     N-min C in cell(G,i,width G-'1) & N-min C <> G*(i,width G-'1) by A822;
   let m such that
A838:  1 <= m & m+2 <= len f;
       m+1 < m+2 by XREAL_1:8;
then A839:  m+1 <= len f by A838,XXREAL_0:2;
then A840:  f|(m+1) = F.(m+1) by A364,A435;
A841:  m = m+1-'1 by BINARITH:39;
A842:  m+1 > 1 by A838,NAT_1:38;
A843:  front_left_cell(F.(m+1),m,G) = front_left_cell(f,m,G) &
       front_right_cell(F.(m+1),m,G) = front_right_cell(f,m,G)
        by A436,A838,A839,A840,GOBRD13:43;
A844:  F.(m+1+1) = f|(m+1+1) by A364,A435,A838;
   hereby assume front_left_cell(f,m,G) misses C &
          front_right_cell(f,m,G) misses C;
     then F.(m+1+1) turns_right m,G by A365,A841,A842,A843;
    hence f turns_right m,G by A838,A844,GOBRD13:44;
   end;
   hereby assume front_left_cell(f,m,G) misses C &
          front_right_cell(f,m,G) meets C;
    then F.(m+1+1) goes_straight m,G by A365,A841,A842,A843;
    hence f goes_straight m,G by A838,A844,GOBRD13:46;
   end;
   assume front_left_cell(f,m,G) meets C;
    then F.(m+1+1) turns_left m,G by A365,A841,A842,A843;
   hence f turns_left m,G by A838,A844,GOBRD13:45;
 end;
uniqueness
proof
  let f1,f2 be clockwise_oriented
     (standard non constant special_circular_sequence)
   such that
A845:   f1 is_sequence_on Gauge(C,n);
    given i1 such that
A846:   1 <= i1 & i1+1 <= len Gauge(C,n) and
A847:   f1/.1 = Gauge(C,n)*(i1,width Gauge(C,n)) &
      f1/.2 = Gauge(C,n)*(i1+1,width Gauge(C,n)) and
A848:   N-min C in cell(Gauge(C,n),i1,width Gauge(C,n)-'1) and
A849:   N-min C <> Gauge(C,n)*(i1,width Gauge(C,n)-'1);
   assume that
A850: for k st 1 <= k & k+2 <= len f1 holds
      (front_left_cell(f1,k,Gauge(C,n)) misses C &
         front_right_cell(f1,k,Gauge(C,n)) misses C
       implies f1 turns_right k,Gauge(C,n)) &
      (front_left_cell(f1,k,Gauge(C,n)) misses C &
        front_right_cell(f1,k,Gauge(C,n)) meets C
       implies f1 goes_straight k,Gauge(C,n)) &
      (front_left_cell(f1,k,Gauge(C,n)) meets C
       implies f1 turns_left k,Gauge(C,n)) and
A851:   f2 is_sequence_on Gauge(C,n);
   given i2 such that
A852:   1 <= i2 & i2+1 <= len Gauge(C,n) and
A853:   f2/.1 = Gauge(C,n)*(i2,width Gauge(C,n)) &
      f2/.2 = Gauge(C,n)*(i2+1,width Gauge(C,n)) and
A854:   N-min C in cell(Gauge(C,n),i2,width Gauge(C,n)-'1) and
A855:   N-min C <> Gauge(C,n)*(i2,width Gauge(C,n)-'1);
   assume
A856: for k st 1 <= k & k+2 <= len f2 holds
      (front_left_cell(f2,k,Gauge(C,n)) misses C &
         front_right_cell(f2,k,Gauge(C,n)) misses C
       implies f2 turns_right k,Gauge(C,n)) &
      (front_left_cell(f2,k,Gauge(C,n)) misses C &
        front_right_cell(f2,k,Gauge(C,n)) meets C
       implies f2 goes_straight k,Gauge(C,n)) &
      (front_left_cell(f2,k,Gauge(C,n)) meets C
       implies f2 turns_left k,Gauge(C,n));
       defpred P[Nat] means f1|$1 = f2|$1;
A857:  P[0];
A858: for k st P[k] holds P[k+1]
     proof let k such that
A859:    f1|k = f2|k;
A860:    f1|1 = <*f1/.1*> & f2|1 = <*f2/.1*> by FINSEQ_5:23;
A861:    i1 = i2 by A846,A848,A849,A852,A854,A855,Th31;
A862:    len f1 > 4 & len f2 > 4 by GOBOARD7:36;
      per cases by CQC_THE1:2;
      suppose k = 0;
       hence f1|(k+1) = f2|(k+1) by A846,A847,A848,A849,A852,A853,A854,A855
,A860,Th31;
      end;
      suppose
A863:      k = 1;
           len f1 > 2 & len f2 > 2 by A862,XXREAL_0:2;
       then f1|2 = <*f1/.1,f1/.2*> & f2|2 = <*f2/.1,f2/.2*>
        by JORDAN8:1;
       hence f1|(k+1) = f2|(k+1) by A847,A853,A861,A863;
      end;
      suppose
A864:      k > 1;
A865:      f1/.1 = f1/.len f1 & f2/.1 = f2/.len f2 by FINSEQ_6:def 1;
           now
        per cases;
        suppose
A866:       len f1 > k;
         set m = k-'1;
A867:       1 <= m by A864,JORDAN3:12;
then A868:       m+1 = k by JORDAN3:6;
A869:      now assume
A870:        len f2 <= k;
then A871:        f2 = f2|k by FINSEQ_1:79;
          then 1 in dom(f2|k) by FINSEQ_5:6;
then A872:        (f1|k)/.1 = f1/.1 by A859,FINSEQ_4:85;
              len f2 in dom(f2|k) by A871,FINSEQ_5:6;
then A873:        (f1|k)/.len f2 = f1/.len f2 by A859,FINSEQ_4:85;
            1 < len f2 & len f2 <= len f1 by A859,A862,A871,XXREAL_0:2
,FINSEQ_5:18
;
          hence contradiction by A859,A865,A866,A870,A871,A872,A873,GOBOARD7:40
;
         end;
then A874:       k+1 <= len f2 by NAT_1:38;
A875:       k+1 <= len f1 by A866,NAT_1:38;
A876:    front_left_cell(f1,m,Gauge(C,n))= front_left_cell(f1|k,m,Gauge(C,n))
              by A845,A866,A867,A868,GOBRD13:43;
A877:       front_right_cell(f1,m,Gauge(C,n))
              = front_right_cell(f1|k,m,Gauge(C,n))
              by A845,A866,A867,A868,GOBRD13:43;
A878:       front_left_cell(f2,m,Gauge(C,n))
              = front_left_cell(f2|k,m,Gauge(C,n))
              by A851,A867,A868,A869,GOBRD13:43;
A879:       front_right_cell(f2,m,Gauge(C,n))
              = front_right_cell(f2|k,m,Gauge(C,n))
              by A851,A867,A868,A869,GOBRD13:43;
A880:      m+(1+1) = k+1 by A868;
             now per cases;
          suppose front_left_cell(f1,m,Gauge(C,n)) misses C &
             front_right_cell(f1,m,Gauge(C,n)) misses C;
           then f1 turns_right m,Gauge(C,n) & f2 turns_right m,Gauge(C,n)
            by A850,A856,A859,A867,A874,A875,A876,A877,A878,A879,A880;
          hence f1|(k+1) = f2|(k+1) by A851,A859,A864,A874,A875,GOBRD13:47;
         end;
         suppose front_left_cell(f1,m,Gauge(C,n)) misses C &
              front_right_cell(f1,m,Gauge(C,n)) meets C;
            then f1 goes_straight m,Gauge(C,n) & f2 goes_straight m,Gauge(C,n)
             by A850,A856,A859,A867,A874,A875,A876,A877,A878,A879,A880;
            hence f1|(k+1) = f2|(k+1) by A851,A859,A864,A874,A875,GOBRD13:49;
         end;
         suppose front_left_cell(f1,m,Gauge(C,n)) meets C;
           then f1 turns_left m,Gauge(C,n) & f2 turns_left m,Gauge(C,n)
             by A850,A856,A859,A867,A874,A875,A876,A878,A880;
           hence f1|(k+1) = f2|(k+1) by A851,A859,A864,A874,A875,GOBRD13:48;
         end;
         end;
         hence f1|(k+1) = f2|(k+1);
        end;
        suppose
A881:       k >= len f1;
then A882:       f1 = f1|k by FINSEQ_1:79;
         then 1 in dom(f1|k) by FINSEQ_5:6;
then A883:       (f2|k)/.1 = f2/.1 by A859,FINSEQ_4:85;
             len f1 in dom(f1|k) by A882,FINSEQ_5:6;
then A884:       (f2|k)/.len f1 = f2/.len f1 by A859,FINSEQ_4:85;
             1 < len f1 & len f1 <= len f2 by A859,A862,A882,XXREAL_0:2
,FINSEQ_5:18
;
then A885:       len f2 = len f1 by A859,A865,A882,A883,A884,GOBOARD7:40;
A886:        k+1 > len f1 by A881,NAT_1:38;
         hence f1|(k+1) = f1 by FINSEQ_1:79
                       .= f2 by A859,A881,A882,A885,FINSEQ_1:79
                       .= f2|(k+1) by A885,A886,FINSEQ_1:79;
        end;
        end;
       hence f1|(k+1) = f2|(k+1);
     end;
     end;
       for k holds P[k] from NAT_1:sch 1(A857,A858);
   hence f1 = f2 by Th4;
 end;
end;

theorem Th33:
  C is connected & 1 <= k & k+1 <= len Cage(C,n)
    implies
   left_cell(Cage(C,n),k,Gauge(C,n)) misses C &
     right_cell(Cage(C,n),k,Gauge(C,n)) meets C
proof
  set G = Gauge(C,n), f = Cage(C,n);
  set W = W-bound C, E = E-bound C, S = S-bound C, N = N-bound C;
  assume
A1:  C is connected;
then A2:  f is_sequence_on G by Def1;
defpred P[Nat] means
for m st 1 <= m & m+1 <= len(f|$1)
       holds left_cell(f|$1,m,G) misses C & right_cell(f|$1,m,G) meets C;
A3:P[0] by FINSEQ_1:25;
A4:   len G = 2|^n+3 & len G = width G by JORDAN8:def 1;
A5: for k st P[k] holds P[k+1]
         proof let k such that
A6:   for m st 1 <= m & m+1 <= len(f|k)
        holds left_cell(f|k,m,G) misses C & right_cell(f|k,m,G) meets C;
    per cases;
    suppose
A7:    k >= len f;
     then k+1 >= len f by NAT_1:37;
     then f|k = f & f|(k+1) = f by A7,FINSEQ_1:79;
     hence thesis by A6;
    end;
    suppose
A8:   k < len f;
then A9:  k+1 <= len f by NAT_1:38;
A10:   f|k is_sequence_on G by A2,GOBOARD1:38;
A11:  f|(k+1) is_sequence_on G by A2,GOBOARD1:38;
     consider i such that
A12:   1 <= i & i+1 <= len G and
A13:   f/.1 = G*(i,width G) and
A14:   f/.2 = G*(i+1,width G) and
A15:   N-min C in cell(G,i,width G-'1) & N-min C <> G*(i,width G-'1)
         by A1,Def1;
A16:   len(f|k) = k by A8,FINSEQ_1:80;
A17:   len(f|(k+1)) = k+1 by A9,FINSEQ_1:80;
A18:   1 <= len G by A4,NAT_1:37;
         2|^n >= n+1 & n+1 >= 1 by HEINE:7,NAT_1:37;
then A19:   2|^n > 0;
     let m such that
A20:  1 <= m & m+1 <= len(f|(k+1));
        now per cases by CQC_THE1:2;
    suppose
A21:   k = 0;
         1 <= m+1 by NAT_1:37;
     then m+1 = 0+1 by A17,A20,A21,XXREAL_0:1;
     then m = 0;
     hence left_cell(f|(k+1),m,G) misses C &
              right_cell(f|(k+1),m,G) meets C by A20;
    end;
    suppose
A22:   k = 1;
then f|(k+1) = <*G*(i,width G),G*(i+1,width G)*> by A9,A13,A14,JORDAN8:1;
then A23:   (f|(k+1))/.1 = G*(i,width G) & (f|(k+1))/.2 = G*(i+1,width G)
        by FINSEQ_4:26;
A24:  i < len G & 1 <= i+1 & i+1 <= len G by A12,NAT_1:38;
then A25:   [i,len G] in Indices G & [i+1,len G] in Indices G
        by A4,A12,A18,GOBOARD7:10;
         1+1 <= m+1 by A20,XREAL_1:8;
     then m+1 = 1+1 by A17,A20,A22,XXREAL_0:1;
then A26:   m = 1;
A27:     i < i+1 & i+1 < (i+1)+1 by NAT_1:38;
then A28:   left_cell(f|(k+1),m,G) = cell(G,i,len G)
        by A4,A11,A20,A23,A25,A26,GOBRD13:def 3;
         now assume left_cell(f|(k+1),m,G) meets C;
      then consider p being set such that
A29:     p in cell(G,i,len G) & p in C by A28,XBOOLE_0:3;
       reconsider p as Element of TOP-REAL 2 by A29;
          cell(G,i,len G) = { |[r,s]|: G*(i,1)`1 <= r & r <= G*(i+1,1)`1 &
                                  G*(1,len G)`2 <= s }
       by A4,A12,A24,GOBRD11:31;
      then consider r,s such that
A30:     p = |[r,s]| and
            G*(i,1)`1 <= r & r <= G*(i+1,1)`1 and
A31:     G*(1,len G)`2 <= s by A29;
          [1,len G] in Indices G by A4,A18,GOBOARD7:10;
then A32:     G*(1,len G) = |[W+((E-W)/(2|^n))*(1-2),S+((N-S)/(2|^n))*((len G)-
2)]|
         by JORDAN8:def 1;
       (len G) - 2 = 2|^n+1 by A4;
       then A33: ((N-S)/(2|^n))*((len G)-2)
           = ((N-S)/(2|^n))*(2|^n+1)
          .= ((N-S)/(2|^n))*(2|^n)+((N-S)/(2|^n))*1
          .= (N-S)+(N-S)/(2|^n) by A19,XCMPLX_1:88;
A34:     G*(1,len G)`2 = S+((N-S)/(2|^n))*((len G)-2) by A32,EUCLID:56;
           N > S by JORDAN8:12;
       then N-S > S-S by XREAL_1:11;
       then (N-S)/(2|^n) > 0 by A19,REAL_2:127;
       then N+0 < N+(N-S)/(2|^n) by XREAL_1:8;
then A35:     N < s by A31,A33,A34,XXREAL_0:2;
           p`2 <= N by A29,PSCOMP_1:71;
      hence contradiction by A30,A35,EUCLID:56;
     end;
     hence left_cell(f|(k+1),m,G) misses C;
A36:   N-min C in C by SPRECT_1:13;
         N-min C in right_cell(f|(k+1),m,G)
      by A4,A11,A15,A20,A23,A25,A26,A27,GOBRD13:def 2;
     hence right_cell(f|(k+1),m,G) meets C by A36,XBOOLE_0:3;
    end;
    suppose
A37:   k > 1;
then A38:   1 <= (len(f|k))-'1 by A16,JORDAN3:12;
A39:   (len(f|k)) -'1 +1 = len(f|k) by A16,A37,BINARITH:53;
         now per cases;
      suppose A40: m+1 = len(f|(k+1));
then A41:    m = len(f|k) by A16,A17;
A42:     len(f|k) <= len f by FINSEQ_5:18;
            now
         consider i1,j1,i2,j2 being Nat such that
A43:       [i1,j1] in Indices G & f/.((len(f|k)) -'1) = G*(i1,j1) and
A44:       [i2,j2] in Indices G & f/.len(f|k) = G*(i2,j2) and
              i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
           i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1
            by A2,A8,A16,A38,A39,JORDAN8:6;
A45:      1 <= i2 & i2 <= len G & 1 <= j2 & j2 <= width G by A44,GOBOARD5:1;
A46:      (len(f|k))-'1+(1+1) = (len(f|k))+1 by A39;
A47:      (i2-'1)+1 = i2 by A45,BINARITH:53;
A48:       (j2-'1)+1 = j2 by A45,BINARITH:53;
              left_cell(f|k,(len(f|k))-'1,G) misses C &
            right_cell(f|k,(len(f|k))-'1,G) meets C by A6,A38,A39;
then A49:      left_cell(f,(len(f|k))-'1,G) misses C &
           right_cell(f,(len(f|k))-'1,G) meets C
 by A2,A16,A38,A39,A42,GOBRD13:32;
         per cases;
         suppose
A50:        front_left_cell(f,(len(f|k))-'1,G) misses C &
            front_right_cell(f,(len(f|k))-'1,G) misses C;
          then A51:        f turns_right (len(f|k))-'1,G by A1,A9,A16,A38,A46,
Def1;
              now per cases by A39,A43,A44,A46,A51,GOBRD13:def 6;
           suppose that
A52:           i1 = i2 & j1+1 = j2 and
A53:           [i2+1,j2] in Indices G and
A54:           f/.((len(f|k))+1) = G*(i2+1,j2);
                 front_right_cell(f,(len(f|k))-'1,G) = cell(G,i1,j2)
               by A2,A38,A39,A42,A43,A44,A52,GOBRD13:36;
            then left_cell(f,m,G) misses C
               by A2,A9,A16,A20,A41,A44,A50,A52,A53,A54,GOBRD13:24;
            hence left_cell(f|(k+1),m,G) misses C
              by A2,A9,A17,A20,A40,GOBRD13:32;
                 j2-'1 = j1 & cell(G,i1,j1) meets C
               by A2,A38,A39,A42,A43,A44,A49,A52,BINARITH:39,GOBRD13:23;
            then right_cell(f,m,G) meets C
               by A2,A9,A16,A20,A41,A44,A52,A53,A54,GOBRD13:25;
            hence right_cell(f|(k+1),m,G) meets C
              by A2,A9,A17,A20,A40,GOBRD13:32;
           end;
           suppose that
A55:           i1+1 = i2 & j1 = j2 and
A56:           [i2,j2-'1] in Indices G and
A57:           f/.((len(f|k))+1) = G*(i2,j2-'1);
                 front_right_cell(f,(len(f|k))-'1,G) = cell(G,i2,j2-'1)
               by A2,A38,A39,A42,A43,A44,A55,GOBRD13:38;
            then left_cell(f,m,G) misses C
               by A2,A9,A16,A20,A41,A44,A48,A50,A56,A57,GOBRD13:28;
            hence left_cell(f|(k+1),m,G) misses C
               by A2,A9,A17,A20,A40,GOBRD13:32;
                 i2-'1 = i1 & cell(G,i1,j1-'1) meets C
               by A2,A38,A39,A42,A43,A44,A49,A55,BINARITH:39,GOBRD13:25;
            then right_cell(f,m,G) meets C
               by A2,A9,A16,A20,A41,A44,A48,A55,A56,A57,GOBRD13:29;
            hence right_cell(f|(k+1),m,G) meets C
               by A2,A9,A17,A20,A40,GOBRD13:32;
           end;
           suppose that
A58:           i1 = i2+1 & j1 = j2 and
A59:           [i2,j2+1] in Indices G and
A60:           f/.((len(f|k))+1) = G*(i2,j2+1);
                 front_right_cell(f,(len(f|k))-'1,G) = cell(G,i2-'1,j2)
               by A2,A38,A39,A42,A43,A44,A58,GOBRD13:40;
            then left_cell(f,m,G) misses C
               by A2,A9,A16,A20,A41,A44,A50,A59,A60,GOBRD13:22;
            hence left_cell(f|(k+1),m,G) misses C
               by A2,A9,A17,A20,A40,GOBRD13:32;
                 cell(G,i2,j2) meets C
               by A2,A38,A39,A42,A43,A44,A49,A58,GOBRD13:27;
            then right_cell(f,m,G) meets C
               by A2,A9,A16,A20,A41,A44,A59,A60,GOBRD13:23;
            hence right_cell(f|(k+1),m,G) meets C
               by A2,A9,A17,A20,A40,GOBRD13:32;
           end;
           suppose that
A61:           i1 = i2 & j1 = j2+1 and
A62:           [i2-'1,j2] in Indices G and
A63:           f/.((len(f|k))+1) = G*(i2-'1,j2);
                 front_right_cell(f,(len(f|k))-'1,G) = cell(G,i2-'1,j2-'1)
               by A2,A38,A39,A42,A43,A44,A61,GOBRD13:42;
            then left_cell(f,m,G) misses C
              by A2,A9,A16,A20,A41,A44,A47,A50,A62,A63,GOBRD13:26;
            hence left_cell(f|(k+1),m,G) misses C
              by A2,A9,A17,A20,A40,GOBRD13:32;
                 cell(G,i2-'1,j2) meets C by A2,A38,A39,A42,A43,A44,A49,A61,
GOBRD13:29;
            then right_cell(f,m,G) meets C
             by A2,A9,A16,A20,A41,A44,A47,A62,A63,GOBRD13:27;
            hence right_cell(f|(k+1),m,G) meets C
             by A2,A9,A17,A20,A40,GOBRD13:32;
          end;
          end;
          hence thesis;
         end;
         suppose
A64:        front_left_cell(f,(len(f|k))-'1,G) misses C &
             front_right_cell(f,(len(f|k))-'1,G) meets C;
            then A65:        f goes_straight (len(f|k))-'1,G by A1,A9,A16,A38
,A46,Def1;
              now per cases by A39,A43,A44,A46,A65,GOBRD13:def 8;
           suppose that
A66:           i1 = i2 & j1+1 = j2 and
A67:           [i2,j2+1] in Indices G and
A68:           f/.(len(f|k)+1) = G*(i2,j2+1);
                 front_left_cell(f,(len(f|k))-'1,G) = cell(G,i1-'1,j2)
               by A2,A38,A39,A42,A43,A44,A66,GOBRD13:35;
             then left_cell(f,m,G) misses C
               by A2,A9,A16,A20,A41,A44,A64,A66,A67,A68,GOBRD13:22;
             hence left_cell(f|(k+1),m,G) misses C
               by A2,A9,A17,A20,A40,GOBRD13:32;
                front_right_cell(f,(len(f|k))-'1,G) = cell(G,i1,j2)
               by A2,A38,A39,A42,A43,A44,A66,GOBRD13:36;
            then right_cell(f,m,G) meets C
               by A2,A9,A16,A20,A41,A44,A64,A66,A67,A68,GOBRD13:23;
            hence right_cell(f|(k+1),m,G) meets C
               by A2,A9,A17,A20,A40,GOBRD13:32;
           end;
           suppose that
A69:           i1+1 = i2 & j1 = j2 and
A70:           [i2+1,j2] in Indices G and
A71:           f/.(len(f|k)+1) = G*(i2+1,j2);
                 front_left_cell(f,(len(f|k))-'1,G) = cell(G,i2,j2)
               by A2,A38,A39,A42,A43,A44,A69,GOBRD13:37;
            then left_cell(f,m,G) misses C
               by A2,A9,A16,A20,A41,A44,A64,A70,A71,GOBRD13:24;
            hence left_cell(f|(k+1),m,G) misses C
               by A2,A9,A17,A20,A40,GOBRD13:32;
                 front_right_cell(f,(len(f|k))-'1,G) = cell(G,i2,j2-'1)
               by A2,A38,A39,A42,A43,A44,A69,GOBRD13:38;
            then right_cell(f,m,G) meets C
               by A2,A9,A16,A20,A41,A44,A64,A70,A71,GOBRD13:25;
            hence right_cell(f|(k+1),m,G) meets C
               by A2,A9,A17,A20,A40,GOBRD13:32;
           end;
           suppose that
A72:          i1 = i2+1 & j1 = j2 and
A73:          [i2-'1,j2] in Indices G and
A74:          f/.(len(f|k)+1) = G*(i2-'1,j2);
                 front_left_cell(f,(len(f|k))-'1,G) = cell(G,i2-'1,j2-'1)
               by A2,A38,A39,A42,A43,A44,A72,GOBRD13:39;
            then left_cell(f,m,G) misses C
               by A2,A9,A16,A20,A41,A44,A47,A64,A73,A74,GOBRD13:26;
            hence left_cell(f|(k+1),m,G) misses C
               by A2,A9,A17,A20,A40,GOBRD13:32;
                 front_right_cell(f,(len(f|k))-'1,G) = cell(G,i2-'1,j2)
               by A2,A38,A39,A42,A43,A44,A72,GOBRD13:40;
            then right_cell(f,m,G) meets C
               by A2,A9,A16,A20,A41,A44,A47,A64,A73,A74,GOBRD13:27;
            hence right_cell(f|(k+1),m,G) meets C
               by A2,A9,A17,A20,A40,GOBRD13:32;
           end;
           suppose that
A75:          i1 = i2 & j1 = j2+1 and
A76:          [i2,j2-'1] in Indices G and
A77:          f/.(len(f|k)+1) = G*(i2,j2-'1);
                 front_left_cell(f,(len(f|k))-'1,G) = cell(G,i2,j2-'1)
               by A2,A38,A39,A42,A43,A44,A75,GOBRD13:41;
            then left_cell(f,m,G) misses C
               by A2,A9,A16,A20,A41,A44,A48,A64,A76,A77,GOBRD13:28;
            hence left_cell(f|(k+1),m,G) misses C
               by A2,A9,A17,A20,A40,GOBRD13:32;
                 front_right_cell(f,(len(f|k))-'1,G) = cell(G,i2-'1,j2-'1)
               by A2,A38,A39,A42,A43,A44,A75,GOBRD13:42;
            then right_cell(f,m,G) meets C
               by A2,A9,A16,A20,A41,A44,A48,A64,A76,A77,GOBRD13:29;
            hence right_cell(f|(k+1),m,G) meets C
               by A2,A9,A17,A20,A40,GOBRD13:32;
          end;
          end;
          hence thesis;
         end;
         suppose
A78:        front_left_cell(f,(len(f|k))-'1,G) meets C;
then A79:        f turns_left (len(f|k))-'1,G by A1,A9,A16,A38,A46,Def1;
              now per cases by A39,A43,A44,A46,A79,GOBRD13:def 7;
           suppose that
A80:           i1 = i2 & j1+1 = j2 and
A81:           [i2-'1,j2] in Indices G and
A82:           f/.(len(f|k)+1) = G*(i2-'1,j2);
                 j2-'1 = j1 &
             cell(G,i1-'1,j1) misses C
               by A2,A38,A39,A42,A43,A44,A49,A80,BINARITH:39,GOBRD13:22;
            then left_cell(f,m,G) misses C
               by A2,A9,A16,A20,A41,A44,A47,A80,A81,A82,GOBRD13:26;
            hence left_cell(f|(k+1),m,G) misses C
               by A2,A9,A17,A20,A40,GOBRD13:32;
                 front_left_cell(f,(len(f|k))-'1,G) = cell(G,i1-'1,j2)
               by A2,A38,A39,A42,A43,A44,A80,GOBRD13:35;
            then right_cell(f,m,G) meets C
               by A2,A9,A16,A20,A41,A44,A47,A78,A80,A81,A82,GOBRD13:27;
            hence right_cell(f|(k+1),m,G) meets C
               by A2,A9,A17,A20,A40,GOBRD13:32;
           end;
           suppose that
A83:           i1+1 = i2 & j1 = j2 and
A84:           [i2,j2+1] in Indices G and
A85:           f/.(len(f|k)+1) = G*(i2,j2+1);
                 i2-'1 = i1 & cell(G,i1,j1) misses C
               by A2,A38,A39,A42,A43,A44,A49,A83,BINARITH:39,GOBRD13:24;
             then left_cell(f,m,G) misses C
               by A2,A9,A16,A20,A41,A44,A83,A84,A85,GOBRD13:22;
             hence left_cell(f|(k+1),m,G) misses C
               by A2,A9,A17,A20,A40,GOBRD13:32;
                 front_left_cell(f,(len(f|k))-'1,G) = cell(G,i2,j2)
               by A2,A38,A39,A42,A43,A44,A83,GOBRD13:37;
            then right_cell(f,m,G) meets C
               by A2,A9,A16,A20,A41,A44,A78,A84,A85,GOBRD13:23;
            hence right_cell(f|(k+1),m,G) meets C
               by A2,A9,A17,A20,A40,GOBRD13:32;
           end;
           suppose that
A86:           i1 = i2+1 & j1 = j2 and
A87:           [i2,j2-'1] in Indices G and
A88:           f/.(len(f|k)+1) = G*(i2,j2-'1);
                 cell(G,i2,j2-'1) misses C
               by A2,A38,A39,A42,A43,A44,A49,A86,GOBRD13:26;
            then left_cell(f,m,G) misses C
               by A2,A9,A16,A20,A41,A44,A48,A87,A88,GOBRD13:28;
            hence left_cell(f|(k+1),m,G) misses C
               by A2,A9,A17,A20,A40,GOBRD13:32;
                 front_left_cell(f,(len(f|k))-'1,G) = cell(G,i2-'1,j2-'1)
               by A2,A38,A39,A42,A43,A44,A86,GOBRD13:39;
            then right_cell(f,m,G) meets C
               by A2,A9,A16,A20,A41,A44,A48,A78,A87,A88,GOBRD13:29;
            hence right_cell(f|(k+1),m,G) meets C
               by A2,A9,A17,A20,A40,GOBRD13:32;
           end;
           suppose that
A89:           i1 = i2 & j1 = j2+1 and
A90:           [i2+1,j2] in Indices G and
A91:           f/.(len(f|k)+1) = G*(i2+1,j2);
                 cell(G,i2,j2) misses C
              by A2,A38,A39,A42,A43,A44,A49,A89,GOBRD13:28;
            then left_cell(f,m,G) misses C
               by A2,A9,A16,A20,A41,A44,A90,A91,GOBRD13:24;
            hence left_cell(f|(k+1),m,G) misses C
               by A2,A9,A17,A20,A40,GOBRD13:32;
                 front_left_cell(f,(len(f|k))-'1,G) = cell(G,i2,j2-'1)
               by A2,A38,A39,A42,A43,A44,A89,GOBRD13:41;
            then right_cell(f,m,G) meets C
               by A2,A9,A16,A20,A41,A44,A78,A90,A91,GOBRD13:25;
            hence right_cell(f|(k+1),m,G) meets C
               by A2,A9,A17,A20,A40,GOBRD13:32;
          end;
          end;
         hence thesis;
        end;
        end;
       hence thesis;
      end;
      suppose m+1 <> len(f|(k+1));
       then m+1 < len(f|(k+1)) by A20,REAL_1:def 5;
       then A92:     m+1 <= len(f|k)by A16,A17,NAT_1:38;
       then consider i1,j1,i2,j2 being Nat such that
A93:     [i1,j1] in Indices G & (f|k)/.m = G*(i1,j1) and
A94:     [i2,j2] in Indices G & (f|k)/.(m+1) = G*(i2,j2) and
A95:      i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
          i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A10,A20,JORDAN8:6;
A96:    1 <= m+1 by NAT_1:37;
            m <= len(f|k) by A92,NAT_1:38;
then A97:    m in dom(f|k) & m+1 in dom(f|k) by A20,A92,A96,FINSEQ_3:27;
A98:     left_cell(f|k,m,G) misses C & right_cell(f|k,m,G) meets C
         by A6,A20,A92;
         f|(k+1) = (f|k)^<*f/.(k+1)*> by A9,JORDAN8:2;
then A99:      (f|(k+1))/.m = G*(i1,j1) & (f|(k+1))/.(m+1) = G*(i2,j2)
            by A93,A94,A97,FINSEQ_4:83;
           now per cases by A95;
        suppose
A100:        i1 = i2 & j1+1 = j2;
          then left_cell(f|k,m,G) = cell(G,i1-'1,j1) &
            right_cell(f|k,m,G) = cell(G,i1,j1)
           by A10,A20,A92,A93,A94,GOBRD13:22,23;
         hence thesis by A11,A20,A93,A94,A98,A99,A100,GOBRD13:22,23;
        end;
        suppose
A101:        i1+1 = i2 & j1 = j2;
          then left_cell(f|k,m,G) = cell(G,i1,j1) &
            right_cell(f|k,m,G) = cell(G,i1,j1-'1)
           by A10,A20,A92,A93,A94,GOBRD13:24,25;
         hence thesis by A11,A20,A93,A94,A98,A99,A101,GOBRD13:24,25;
        end;
        suppose
A102:        i1 = i2+1 & j1 = j2;
          then left_cell(f|k,m,G) = cell(G,i2,j2-'1) &
            right_cell(f|k,m,G) = cell(G,i2,j2)
           by A10,A20,A92,A93,A94,GOBRD13:26,27;
         hence thesis by A11,A20,A93,A94,A98,A99,A102,GOBRD13:26,27;
        end;
        suppose
A103:        i1 = i2 & j1 = j2+1;
          then left_cell(f|k,m,G) = cell(G,i2,j2) &
            right_cell(f|k,m,G) = cell(G,i1-'1,j2)
           by A10,A20,A92,A93,A94,GOBRD13:28,29;
         hence thesis by A11,A20,A93,A94,A98,A99,A103,GOBRD13:28,29;
       end;
       end;
       hence thesis;
     end;
     end;
     hence thesis;
    end;
    end;
    hence thesis;
   end;
   end;
A104: for k holds P[k]
     from NAT_1:sch 1(A3,A5);
      f|len f = f by FINSEQ_1:79;
  hence thesis by A104;
end;

theorem
      C is connected implies N-min L~Cage(C,n) = (Cage(C,n))/.1
proof
 set f = Cage(C,n);
 assume
A1: C is connected;
then A2: f is_sequence_on Gauge(C,n) &
 (ex i st 1 <= i & i+1 <= len Gauge(C,n) &
          f/.1 = Gauge(C,n)*(i,width Gauge(C,n)) &
          f/.2 = Gauge(C,n)*(i+1,width Gauge(C,n)) &
          N-min C in cell(Gauge(C,n),i,width Gauge(C,n)-'1) &
          N-min C <> Gauge(C,n)*(i,width Gauge(C,n)-'1)) by Def1;
      for k st 1 <= k & k+1 <= len f
    holds left_cell(f,k,Gauge(C,n)) misses C &
          right_cell(f,k,Gauge(C,n)) meets C by A1,Th33;
  hence thesis by A2,Th32;
end;
