:: Cages, external approximation of Jordan's curve
::  by Czes{\l}aw Byli\'nski and Mariusz \.Zynel
::
:: Received June 22, 1999
:: Copyright (c) 1999 Association of Mizar Users

environ

 vocabularies FINSEQ_1, BOOLE, PRE_TOPC, RELAT_2, CONNSP_1, RELAT_1, FINSEQ_5,
      ARYTM_1, GOBOARD1, EUCLID, MATRIX_1, ABSVALUE, GOBRD13, FUNCT_1,
      TOPREAL1, RFINSEQ, GOBOARD5, TOPS_1, TREES_1, SPPOL_1, MCART_1, TARSKI,
      SUBSET_1, SEQM_3, GOBOARD9, COMPTS_1, JORDAN8, PSCOMP_1, GROUP_1,
      ARYTM_3, SPRECT_2, CARD_1, PCOMPS_1, METRIC_1, JORDAN9, FINSEQ_4, ARYTM;
 notations TARSKI, XBOOLE_0, SUBSET_1, GOBOARD5, ORDINAL1, CARD_1, NUMBERS,
      XCMPLX_0, XREAL_0, REAL_1, NAT_1, NAT_D, RELAT_1, FUNCT_1, PARTFUN1,
      FUNCT_2, COMPLEX1, FINSEQ_1, FINSEQ_2, FINSEQ_4, FINSEQ_5, NEWTON,
      RFINSEQ, STRUCT_0, XXREAL_0, MATRIX_1, METRIC_1, PRE_TOPC, TOPS_1,
      COMPTS_1, CONNSP_1, PCOMPS_1,
      RLTOPSP1, EUCLID, TOPREAL1, GOBOARD1, SPPOL_1,
      PSCOMP_1, SPRECT_2, GOBOARD9, JORDAN8, GOBRD13;
 constructors PARTFUN1, XXREAL_0, REAL_1, NAT_1, FINSEQ_4, NEWTON, RFINSEQ,
      NAT_D, TOPS_1, CONNSP_1, COMPTS_1, REALSET2, SPPOL_1, PSCOMP_1, GOBOARD9,
      SPRECT_2, JORDAN8, GOBRD13, RELSET_1, FUNCSDOM, RLTOPSP1;
 registrations XBOOLE_0, RELAT_1, FUNCT_1, ORDINAL1, XXREAL_0, XREAL_0, NAT_1,
      MEMBERED, FINSEQ_1, STRUCT_0, EUCLID, SPPOL_2, PSCOMP_1, GOBOARD9,
      SPRECT_1, SPRECT_2, JORDAN8, GOBRD13, NEWTON, FINSET_1;
 requirements REAL, NUMERALS, SUBSET, BOOLE, ARITHM;
 definitions TARSKI, GOBOARD1, GOBOARD5, GOBRD13, XBOOLE_0, PSCOMP_1;
 theorems NAT_1, FINSEQ_1, GOBOARD1, FINSEQ_4, EUCLID, FINSEQ_3, SPPOL_2,
      TARSKI, JORDAN3, PSCOMP_1, FINSEQ_5, FINSEQ_6, GOBOARD7, TOPREAL1,
      JORDAN5B, GOBOARD5, SPRECT_2, SPPOL_1, ABSVALUE, FUNCT_1, FUNCT_2,
      GOBOARD9, FINSEQ_2, UNIFORM1, SUBSET_1, GOBRD11, GOBOARD2, SPRECT_3,
      CARD_1, RFINSEQ, GOBOARD6, TOPREAL3, TOPMETR, TOPS_1, JORDAN8, GOBRD13,
      SPRECT_4, CONNSP_1, PARTFUN2, RELSET_1, SPRECT_1, XBOOLE_0, XBOOLE_1,
      XREAL_0, XCMPLX_1, XREAL_1, NEWTON, XXREAL_0, ORDINAL1, PARTFUN1,
      MATRIX_1, NAT_D, RLTOPSP1;
 schemes NAT_1, RECDEF_1;

begin :: Generalities

reserve i,j,k,n for Element of NAT,
  D for non empty set,
  f, g for FinSequence of D;

Lm1: for n st 1 <= n holds n-'1+2 = n+1
proof
  let n;
  assume 1 <= n;
  hence n-'1+2 = n+2-'1 by NAT_D:38
    .= n+1+1 - 1 by NAT_D:37
    .= n+1;
end;

canceled 2;

theorem Th3:
  for T being non empty TopSpace
  for B,C1,C2,D being Subset of T st B is connected & C1 is_a_component_of D &
  C2 is_a_component_of D & B meets C1 & B meets C2 & B c= D holds C1 = C2
proof
  let T be non empty TopSpace;
  let B,C1,C2,D be Subset of T;
  assume that
A1: B is connected and
A2: C1 is_a_component_of D and
A3: C2 is_a_component_of D and
A4: B meets C1 and
A5: B meets C2 and
A6: B c= D;
A7: B c= C1 by A1,A2,A4,A6,GOBOARD9:6;
A8: B c= C2 by A1,A3,A5,A6,GOBOARD9:6;
  B <> {} by A4,XBOOLE_1:65;
  hence thesis by A2,A3,A7,A8,GOBOARD9:3,XBOOLE_1:68;
end;

theorem Th4:
  (for n holds f|n = g|n) implies f = g
proof
  assume
A1: for n holds f|n = g|n;
A2: now
    assume
A3: len f <> len g;
    per cases by A3,XXREAL_0:1;
    suppose
A4:   len f < len g;
      then f|len g = f & g|len g = g by FINSEQ_1:79;
      hence contradiction by A1,A4;
    end;
    suppose
A5:   len g < len f;
      then f|len f = f & g|len f = g by FINSEQ_1:79;
      hence contradiction by A1,A5;
    end;
  end;
  f|len f = f & g|len g = g by FINSEQ_1:79;
  hence thesis by A1,A2;
end;

theorem Th5:
  n in dom f implies
  ex k st k in dom Rev f & n+k = len f+1 & f/.n = (Rev f)/.k
proof
  assume
A1: n in dom f;
  then
A2: 1 <= n & n <= len f by FINSEQ_3:27;
  take k = len f+1-'n;
  n <= len f+1 by A2,XREAL_1:147;
  then
A3: k+n = len f+1 by XREAL_1:237;
  then
A4: k+n-'1 = len f by NAT_D:34;
  n+1 <= len f+1 by A2,XREAL_1:8;
  then
A5: 1 <= k by NAT_D:55;
  k+1 <= k+n by A2,XREAL_1:8;
  then k+1-'1 <= k+n -'1 by NAT_D:42;
  then k <= len f by A4,NAT_D:34;
  then k in dom f by A5,FINSEQ_3:27;
  hence thesis by A1,A3,FINSEQ_5:60,69;
end;

theorem Th6:
  n in dom Rev f implies
  ex k st k in dom f & n+k = len f+1 & (Rev f)/.n = f/.k
proof
  assume n in dom Rev f;
  then n in dom f by FINSEQ_5:60;
  then consider k such that
A1: k in dom Rev f and
A2: n+k = len f+1 and f/.n = (Rev f)/.k by Th5;
A3: len f = len Rev f & dom f = dom Rev f by FINSEQ_5:60,def 3;
  then (Rev f)/.n = f/.k by A1,A2,FINSEQ_5:69;
  hence thesis by A1,A2,A3;
end;

begin :: Go-board preliminaries

reserve G for Go-board,
  f, g for FinSequence of TOP-REAL 2,
  p for Point of TOP-REAL 2,
  r, s for Real,
  x for set;

theorem Th7:
  for D being non empty set for G being Matrix of D
  for f being FinSequence of D holds
  f is_sequence_on G iff Rev f is_sequence_on G
proof
  let D be non empty set;
  let G be Matrix of D;
  let f be FinSequence of D;
  hereby
    assume
A1: f is_sequence_on G;
A2: for n st n in dom Rev f ex i,j st [i,j] in
    Indices G & (Rev f)/.n = G*(i,j)
    proof
      let n;
      assume n in dom Rev f;
      then consider k such that
A3:   k in dom f and n+k = len f+1 and
A4:   (Rev f)/.n = f/.k by Th6;
      consider i,j such that
A5:   [i,j] in Indices G and
A6:   f/.k = G*(i,j) by A1,A3,GOBOARD1:def 11;
      take i,j;
      thus thesis by A4,A5,A6;
    end;
    for n st n in dom Rev f & n+1 in dom Rev f holds
    for m,k,i,j being Element of NAT
    st [m,k] in Indices G & [i,j] in Indices G &
    (Rev f)/.n = G*(m,k) & (Rev f)/.(n+1) = G*(i,j) holds
    abs(m-i)+abs(k-j) = 1
    proof
      let n such that
A7:   n in dom Rev f and
A8:   n+1 in dom Rev f;
      let m,k,i,j be Element of NAT such that
A9:   [m,k] in Indices G and
A10:  [i,j] in Indices G and
A11:  (Rev f)/.n = G*(m,k) and
A12:  (Rev f)/.(n+1) = G*(i,j);
      consider l being Element of NAT such that
A13:  l in dom f and
A14:  n+l = len f+1 and
A15:  (Rev f)/.n = f/.l by A7,Th6;
      consider l' being Element of NAT such that
A16:  l' in dom f and
A17:  n+1+l' = len f+1 and
A18:  (Rev f)/.(n+1) = f/.l' by A8,Th6;
A19:  n+(1+l') = n+l by A14,A17;
      abs(i-m) = abs(m-i) & abs(j-k) = abs(k-j) by UNIFORM1:13;
      hence thesis
      by A1,A9,A10,A11,A12,A13,A15,A16,A18,A19,GOBOARD1:def 11;
    end;
    hence Rev f is_sequence_on G by A2,GOBOARD1:def 11;
  end;
  assume
A20: Rev f is_sequence_on G;
A21: for n st n in dom f ex i,j st [i,j] in Indices G & f/.n = G*(i,j)
  proof
    let n;
    assume n in dom f;
    then consider k such that
A22: k in dom Rev f and n+k = len f+1 and
A23: f/.n = (Rev f)/.k by Th5;
    consider i,j such that
A24: [i,j] in Indices G and
A25: (Rev f)/.k = G*(i,j) by A20,A22,GOBOARD1:def 11;
    take i,j;
    thus thesis by A23,A24,A25;
  end;
  for n st n in dom f & n+1 in dom f holds for m,k,i,j being Element of NAT
  st [m,k] in Indices G & [i,j] in Indices G &
  f/.n = G*(m,k) & f/.(n+1) = G*(i,j) holds abs(m-i)+abs(k-j) = 1
  proof
    let n such that
A26: n in dom f and
A27: n+1 in dom f;
    let m,k,i,j be Element of NAT such that
A28: [m,k] in Indices G and
A29: [i,j] in Indices G and
A30: f/.n = G*(m,k) and
A31: f/.(n+1) = G*(i,j);
    consider l being Element of NAT such that
A32: l in dom Rev f and
A33: n+l = len f+1 and
A34: f/.n = (Rev f)/.l by A26,Th5;
    consider l' being Element of NAT such that
A35: l' in dom Rev f and
A36: n+1+l' = len f+1 and
A37: f/.(n+1) = (Rev f)/.l' by A27,Th5;
A38: n+(1+l') = n+l by A33,A36;
    abs(i-m) = abs(m-i) & abs(j-k) = abs(k-j) by UNIFORM1:13;
    hence thesis
    by A20,A28,A29,A30,A31,A32,A34,A35,A37,A38,GOBOARD1:def 11;
  end;
  hence thesis by A21,GOBOARD1:def 11;
end;

theorem Th8:
  for G being Matrix of TOP-REAL 2 for f being FinSequence of TOP-REAL 2 holds
  f is_sequence_on G & 1 <= k & k <= len f implies f/.k in Values G
proof
  let G be Matrix of TOP-REAL 2;
  let f be FinSequence of TOP-REAL 2;
  assume that
A1: f is_sequence_on G and
A2: 1 <= k and
A3: k <= len f;
A4: k in dom f by A2,A3,FINSEQ_3:27;
  then f/.k = f.k by PARTFUN1:def 8;
  then
A5: f/.k in rng f by A4,FUNCT_1:def 5;
  rng f c= Values G by A1,GOBRD13:9;
  hence thesis by A5;
end;

Lm2: f is_sequence_on G & 1 <= k & k <= len f implies
ex i,j being Element of NAT st [i,j] in Indices G & f/.k = G*(i,j)
proof
  assume that
A1: f is_sequence_on G and
A2: 1 <= k & k <= len f;
  k in dom f by A2,FINSEQ_3:27;
  then consider i,j such that
A3: [i,j] in Indices G & f/.k = G*(i,j) by A1,GOBOARD1:def 11;
  take i,j;
  thus thesis by A3;
end;

theorem Th9:
  n <= len f & x in L~(f/^n) implies
  ex i being Element of NAT st n+1 <= i & i+1 <= len f & x in LSeg(f,i)
proof
  assume that
A1: n <= len f and
A2: x in L~(f/^n);
  consider j such that
A3: 1 <= j and
A4: j+1 <= len(f/^n) and
A5: x in LSeg(f/^n,j) by A2,SPPOL_2:13;
A6: j+1 <= len f - n by A1,A4,RFINSEQ:def 2;
  take n+j;
  j+1 <= len f - n by A1,A4,RFINSEQ:def 2;
  then n+(j+1) <= len f by XREAL_1:21;
  hence thesis by A3,A5,A6,SPPOL_2:5,XREAL_1:8;
end;

theorem Th10:
  f is_sequence_on G & 1 <= k & k+1 <= len f implies
  f/.k in left_cell(f,k,G) & f/.k in right_cell(f,k,G)
proof
  assume that
A1: f is_sequence_on G and
A2: 1 <= k & k+1 <= len f;
  set p = f/.k;
  LSeg(f,k) = LSeg(f/.k, f/.(k+1)) by A2,TOPREAL1:def 5;
  then p in LSeg(f,k) by RLTOPSP1:69;
  then p in left_cell(f,k,G) /\ right_cell(f,k,G) by A1,A2,GOBRD13:30;
  hence thesis by XBOOLE_0:def 4;
end;

theorem Th11:
  f is_sequence_on G & 1 <= k & k+1 <= len f implies
  Int left_cell(f,k,G) <> {} & Int right_cell(f,k,G) <> {}
proof
  assume that
A1: f is_sequence_on G and
A2: 1 <= k and
A3: k+1 <= len f;
  consider i1,j1,i2,j2 being Element of NAT such that
A4: [i1,j1] in Indices G and
A5: f/.k = G*(i1,j1) and
A6: [i2,j2] in Indices G and
A7: f/.(k+1) = G*(i2,j2) and
A8: i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
  i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A1,A2,A3,JORDAN8:6;
A9: i1+1 > i1 & j1+1 > j1 & i2+1 > i2 & j2+1 > j2 by NAT_1:13;
A10: i1 <= len G & j1 <= width G by A4,MATRIX_1:39;
A11: i2 <= len G & j2 <= width G by A6,MATRIX_1:39;
A12: i1-'1 <= len G & j1-'1 <= width G by A10,NAT_D:44;
A13: i2-'1 <= len G & j2-'1 <= width G by A11,NAT_D:44;
  per cases by A8;
  suppose
A14: i1 = i2 & j1+1 = j2;
    then
A15: right_cell(f,k,G) = cell(G,i1,j1)
    by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
    left_cell(f,k,G) = cell(G,i1-'1,j1)
    by A1,A2,A3,A4,A5,A6,A7,A9,A14,GOBRD13:def 3;
    hence thesis by A10,A12,A15,GOBOARD9:17;
  end;
  suppose
A16: i1+1 = i2 & j1 = j2;
    then
A17: right_cell(f,k,G) = cell(G,i1,j1-'1)
    by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
    left_cell(f,k,G) = cell(G,i1,j1)
    by A1,A2,A3,A4,A5,A6,A7,A9,A16,GOBRD13:def 3;
    hence thesis by A10,A12,A17,GOBOARD9:17;
  end;
  suppose
A18: i1 = i2+1 & j1 = j2;
    then
A19: right_cell(f,k,G) = cell(G,i2,j2)
    by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
    left_cell(f,k,G) = cell(G,i2,j2-'1)
    by A1,A2,A3,A4,A5,A6,A7,A9,A18,GOBRD13:def 3;
    hence thesis by A11,A13,A19,GOBOARD9:17;
  end;
  suppose
A20: i1 = i2 & j1 = j2+1;
    then
A21: right_cell(f,k,G) = cell(G,i1-'1,j2)
    by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
    left_cell(f,k,G) = cell(G,i1,j2)
    by A1,A2,A3,A4,A5,A6,A7,A9,A20,GOBRD13:def 3;
    hence thesis by A10,A11,A12,A21,GOBOARD9:17;
  end;
end;

theorem Th12:
  f is_sequence_on G & 1 <= k & k+1 <= len f implies
  Int left_cell(f,k,G) is connected & Int right_cell(f,k,G) is connected
proof
  assume that
A1: f is_sequence_on G and
A2: 1 <= k and
A3: k+1 <= len f;
  consider i1,j1,i2,j2 being Element of NAT such that
A4: [i1,j1] in Indices G and
A5: f/.k = G*(i1,j1) and
A6: [i2,j2] in Indices G and
A7: f/.(k+1) = G*(i2,j2) and
A8: i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
  i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A1,A2,A3,JORDAN8:6;
A9: i1+1 > i1 & j1+1 > j1 & i2+1 > i2 & j2+1 > j2 by NAT_1:13;
A10: i1 <= len G & j1 <= width G by A4,MATRIX_1:39;
A11: i2 <= len G & j2 <= width G by A6,MATRIX_1:39;
A12: i1-'1 <= len G & j1-'1 <= width G by A10,NAT_D:44;
A13: i2-'1 <= len G & j2-'1 <= width G by A11,NAT_D:44;
  per cases by A8;
  suppose
A14: i1 = i2 & j1+1 = j2;
    then
A15: right_cell(f,k,G) = cell(G,i1,j1)
    by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
    left_cell(f,k,G) = cell(G,i1-'1,j1)
    by A1,A2,A3,A4,A5,A6,A7,A9,A14,GOBRD13:def 3;
    hence thesis by A10,A12,A15,GOBOARD9:21;
  end;
  suppose
A16: i1+1 = i2 & j1 = j2;
    then
A17: right_cell(f,k,G) = cell(G,i1,j1-'1)
    by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
    left_cell(f,k,G) = cell(G,i1,j1)
    by A1,A2,A3,A4,A5,A6,A7,A9,A16,GOBRD13:def 3;
    hence thesis by A10,A12,A17,GOBOARD9:21;
  end;
  suppose
A18: i1 = i2+1 & j1 = j2;
    then
A19: right_cell(f,k,G) = cell(G,i2,j2)
    by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
    left_cell(f,k,G) = cell(G,i2,j2-'1)
    by A1,A2,A3,A4,A5,A6,A7,A9,A18,GOBRD13:def 3;
    hence thesis by A11,A13,A19,GOBOARD9:21;
  end;
  suppose
A20: i1 = i2 & j1 = j2+1;
    then
A21: right_cell(f,k,G) = cell(G,i1-'1,j2)
    by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
    left_cell(f,k,G) = cell(G,i1,j2)
    by A1,A2,A3,A4,A5,A6,A7,A9,A20,GOBRD13:def 3;
    hence thesis by A10,A11,A12,A21,GOBOARD9:21;
  end;
end;

theorem Th13:
  f is_sequence_on G & 1 <= k & k+1 <= len f implies
  Cl Int left_cell(f,k,G) = left_cell(f,k,G) &
  Cl Int right_cell(f,k,G) = right_cell(f,k,G)
proof
  assume that
A1: f is_sequence_on G and
A2: 1 <= k and
A3: k+1 <= len f;
  consider i1,j1,i2,j2 being Element of NAT such that
A4: [i1,j1] in Indices G and
A5: f/.k = G*(i1,j1) and
A6: [i2,j2] in Indices G and
A7: f/.(k+1) = G*(i2,j2) and
A8: i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
  i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A1,A2,A3,JORDAN8:6;
A9: i1+1 > i1 & j1+1 > j1 & i2+1 > i2 & j2+1 > j2 by NAT_1:13;
A10: i1 <= len G & j1 <= width G by A4,MATRIX_1:39;
A11: i2 <= len G & j2 <= width G by A6,MATRIX_1:39;
A12: i1-'1 <= len G & j1-'1 <= width G by A10,NAT_D:44;
A13: i2-'1 <= len G & j2-'1 <= width G by A11,NAT_D:44;
  per cases by A8;
  suppose
A14: i1 = i2 & j1+1 = j2;
    then
A15: right_cell(f,k,G) = cell(G,i1,j1)
    by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
    left_cell(f,k,G) = cell(G,i1-'1,j1)
    by A1,A2,A3,A4,A5,A6,A7,A9,A14,GOBRD13:def 3;
    hence thesis by A10,A12,A15,GOBRD11:35;
  end;
  suppose
A16: i1+1 = i2 & j1 = j2;
    then
A17: right_cell(f,k,G) = cell(G,i1,j1-'1)
    by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
    left_cell(f,k,G) = cell(G,i1,j1)
    by A1,A2,A3,A4,A5,A6,A7,A9,A16,GOBRD13:def 3;
    hence thesis by A10,A12,A17,GOBRD11:35;
  end;
  suppose
A18: i1 = i2+1 & j1 = j2;
    then
A19: right_cell(f,k,G) = cell(G,i2,j2)
    by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
    left_cell(f,k,G) = cell(G,i2,j2-'1)
    by A1,A2,A3,A4,A5,A6,A7,A9,A18,GOBRD13:def 3;
    hence thesis by A11,A13,A19,GOBRD11:35;
  end;
  suppose
A20: i1 = i2 & j1 = j2+1;
    then
A21: right_cell(f,k,G) = cell(G,i1-'1,j2)
    by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
    left_cell(f,k,G) = cell(G,i1,j2)
    by A1,A2,A3,A4,A5,A6,A7,A9,A20,GOBRD13:def 3;
    hence thesis by A10,A11,A12,A21,GOBRD11:35;
  end;
end;

theorem Th14:
  f is_sequence_on G & LSeg(f,k) is horizontal implies
  ex j st 1 <= j & j <= width G & for p st p in
  LSeg(f,k) holds p`2 = G*(1,j)`2
proof
  assume that
A1: f is_sequence_on G and
A2: LSeg(f,k) is horizontal;
  per cases;
  suppose
A3: 1 <= k & k+1 <= len f;
    k <= k+1 by NAT_1:11;
    then k <= len f by A3,XXREAL_0:2;
    then consider i,j such that
A4: [i,j] in Indices G and
A5: f/.k = G*(i,j) by A1,A3,Lm2;
    take j; thus
A6: 1 <= j & j <= width G by A4,MATRIX_1:39;
    let p;
A7: 1 <= i & i <= len G by A4,MATRIX_1:39;
A8: f/.k in LSeg(f,k) by A3,TOPREAL1:27;
    assume p in LSeg(f,k);
    hence p`2 = (f/.k)`2 by A2,A8,SPPOL_1:def 2
      .= G*(1,j)`2 by A5,A6,A7,GOBOARD5:2;
  end;
  suppose
A9: not(1 <= k & k+1 <= len f);
    take 1;
    width G <> 0 by GOBOARD1:def 5;
    hence 1 <= 1 & 1 <= width G by NAT_1:14;
    thus thesis by A9,TOPREAL1:def 5;
  end;
end;

theorem Th15:
  f is_sequence_on G & LSeg(f,k) is vertical implies
  ex i st 1 <= i & i <= len G & for p st p in LSeg(f,k) holds p`1 = G*(i,1)`1
proof
  assume that
A1: f is_sequence_on G and
A2: LSeg(f,k) is vertical;
  per cases;
  suppose
A3: 1 <= k & k+1 <= len f;
    k <= k+1 by NAT_1:11;
    then k <= len f by A3,XXREAL_0:2;
    then consider i,j such that
A4: [i,j] in Indices G and
A5: f/.k = G*(i,j) by A1,A3,Lm2;
    take i; thus
A6: 1 <= i & i <= len G by A4,MATRIX_1:39;
    let p;
A7: 1 <= j & j <= width G by A4,MATRIX_1:39;
A8: f/.k in LSeg(f,k) by A3,TOPREAL1:27;
    assume p in LSeg(f,k);
    hence p`1 = (f/.k)`1 by A2,A8,SPPOL_1:def 3
      .= G*(i,1)`1 by A5,A6,A7,GOBOARD5:3;
  end;
  suppose
A9: not(1 <= k & k+1 <= len f);
    take 1;
    0 <> len G by GOBOARD1:def 5;
    hence 1 <= 1 & 1 <= len G by NAT_1:14;
    thus thesis by A9,TOPREAL1:def 5;
  end;
end;

theorem Th16:
  f is_sequence_on G & f is special & i <= len G & j <= width G implies
  Int cell(G,i,j) misses L~f
proof
  assume that
A1: f is_sequence_on G and
A2: f is special and
A3: i <= len G and
A4: j <= width G;
  assume Int cell(G,i,j) meets L~f;
  then consider x being set such that
A5: x in Int cell(G,i,j) and
A6: x in L~f by XBOOLE_0:3;
  L~f = union { LSeg(f,k) : 1 <= k & k+1 <= len f } by TOPREAL1:def 6;
  then consider X being set such that
A7: x in X and
A8: X in { LSeg(f,k) : 1 <= k & k+1 <= len f } by A6,TARSKI:def 4;
  consider k such that
A9: X = LSeg(f,k) and 1 <= k & k+1 <= len f by A8;
  reconsider p = x as Point of TOP-REAL 2 by A7,A9;
A10: Int cell(G,i,j) = Int v_strip(G,i) /\ Int h_strip(G,j) by TOPS_1:46;
  per cases by A2,SPPOL_1:41;
  suppose LSeg(f,k) is horizontal;
    then consider j0 being Element of NAT such that
A11: 1 <= j0 & j0 <= width G and
A12: for p being Point of TOP-REAL 2
    st p in LSeg(f,k) holds p`2 = G*(1,j0)`2 by A1,Th14;
    now
      assume
A13:  p in Int h_strip(G,j);
A14:  j0 > j implies j0 >= j+1 by NAT_1:13;
      per cases by A14,XXREAL_0:1;
      suppose
A15:    j0 < j;
        then j >= 1 by A11,XXREAL_0:2;
        then
A16:    p`2 > G*(1,j)`2 by A4,A13,GOBOARD6:30;
        0 <> len G by GOBOARD1:def 5;
        then 1 <= len G by NAT_1:14;
        then G*(1,j)`2 > G*(1,j0)`2 by A4,A11,A15,GOBOARD5:5;
        hence contradiction by A7,A9,A12,A16;
      end;
      suppose j0 = j;
        then p`2 > G*(1,j0)`2 by A11,A13,GOBOARD6:30;
        hence contradiction by A7,A9,A12;
      end;
      suppose
A17:    j0 > j+1;
        then j+1 <= width G by A11,XXREAL_0:2;
        then j < width G by NAT_1:13;
        then
A18:    p`2 < G*(1,j+1)`2 by A13,GOBOARD6:31;
        0 <> len G by GOBOARD1:def 5;
        then 1 <= len G & j+1 >= 1 by NAT_1:14;
        then G*(1,j+1)`2 < G*(1,j0)`2 by A11,A17,GOBOARD5:5;
        hence contradiction by A7,A9,A12,A18;
      end;
      suppose
A19:    j0 = j+1;
        then j < width G by A11,NAT_1:13;
        then p`2 < G*(1,j0)`2 by A13,A19,GOBOARD6:31;
        hence contradiction by A7,A9,A12;
      end;
    end;
    hence contradiction by A5,A10,XBOOLE_0:def 4;
  end;
  suppose LSeg(f,k) is vertical;
    then consider i0 being Element of NAT such that
A20: 1 <= i0 & i0 <= len G and
A21: for p being Point of TOP-REAL 2
    st p in LSeg(f,k) holds p`1 = G*(i0,1)`1 by A1,Th15;
    now
      assume
A22:  p in Int v_strip(G,i);
A23:  i0 > i implies i0 >= i+1 by NAT_1:13;
      per cases by A23,XXREAL_0:1;
      suppose
A24:    i0 < i;
        then i >= 1 by A20,XXREAL_0:2;
        then
A25:    p`1 > G*(i,1)`1 by A3,A22,GOBOARD6:32;
        0 <> width G by GOBOARD1:def 5;
        then 1 <= width G by NAT_1:14;
        then G*(i,1)`1 > G*(i0,1)`1 by A3,A20,A24,GOBOARD5:4;
        hence contradiction by A7,A9,A21,A25;
      end;
      suppose i0 = i;
        then p`1 > G*(i0,1)`1 by A20,A22,GOBOARD6:32;
        hence contradiction by A7,A9,A21;
      end;
      suppose
A26:    i0 > i+1;
        then i+1 <= len G by A20,XXREAL_0:2;
        then i < len G by NAT_1:13;
        then
A27:    p`1 < G*(i+1,1)`1 by A22,GOBOARD6:33;
        0 <> width G by GOBOARD1:def 5;
        then 1 <= width G & i+1 >= 1 by NAT_1:14;
        then G*(i+1,1)`1 < G*(i0,1)`1 by A20,A26,GOBOARD5:4;
        hence contradiction by A7,A9,A21,A27;
      end;
      suppose
A28:    i0 = i+1;
        then i < len G by A20,NAT_1:13;
        then p`1 < G*(i0,1)`1 by A22,A28,GOBOARD6:33;
        hence contradiction by A7,A9,A21;
      end;
    end;
    hence contradiction by A5,A10,XBOOLE_0:def 4;
  end;
end;

theorem Th17:
  f is_sequence_on G & f is special & 1 <= k & k+1 <= len f implies
  Int left_cell(f,k,G) misses L~f & Int right_cell(f,k,G) misses L~f
proof
  assume that
A1: f is_sequence_on G & f is special and
A2: 1 <= k and
A3: k+1 <= len f;
  consider i1,j1,i2,j2 being Element of NAT such that
A4: [i1,j1] in Indices G and
A5: f/.k = G*(i1,j1) and
A6: [i2,j2] in Indices G and
A7: f/.(k+1) = G*(i2,j2) and
A8: i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
  i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A1,A2,A3,JORDAN8:6;
A9: i1+1 > i1 & j1+1 > j1 & i2+1 > i2 & j2+1 > j2 by NAT_1:13;
A10: i1 <= len G & j1 <= width G by A4,MATRIX_1:39;
A11: i2 <= len G & j2 <= width G by A6,MATRIX_1:39;
A12: i1-'1 <= len G & j1-'1 <= width G by A10,NAT_D:44;
A13: i2-'1 <= len G & j2-'1 <= width G by A11,NAT_D:44;
  per cases by A8;
  suppose
A14: i1 = i2 & j1+1 = j2;
    then
A15: right_cell(f,k,G) = cell(G,i1,j1)
    by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
    left_cell(f,k,G) = cell(G,i1-'1,j1)
    by A1,A2,A3,A4,A5,A6,A7,A9,A14,GOBRD13:def 3;
    hence thesis by A1,A10,A12,A15,Th16;
  end;
  suppose
A16: i1+1 = i2 & j1 = j2;
    then
A17: right_cell(f,k,G) = cell(G,i1,j1-'1)
    by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
    left_cell(f,k,G) = cell(G,i1,j1)
    by A1,A2,A3,A4,A5,A6,A7,A9,A16,GOBRD13:def 3;
    hence thesis by A1,A10,A12,A17,Th16;
  end;
  suppose
A18: i1 = i2+1 & j1 = j2;
    then
A19: right_cell(f,k,G) = cell(G,i2,j2)
    by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
    left_cell(f,k,G) = cell(G,i2,j2-'1)
    by A1,A2,A3,A4,A5,A6,A7,A9,A18,GOBRD13:def 3;
    hence thesis by A1,A11,A13,A19,Th16;
  end;
  suppose
A20: i1 = i2 & j1 = j2+1;
    then
A21: right_cell(f,k,G) = cell(G,i1-'1,j2)
    by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
    left_cell(f,k,G) = cell(G,i1,j2)
    by A1,A2,A3,A4,A5,A6,A7,A9,A20,GOBRD13:def 3;
    hence thesis by A1,A10,A11,A12,A21,Th16;
  end;
end;

theorem Th18:
  1 <= i & i+1 <= len G & 1 <= j & j+1 <= width G implies
  G*(i,j)`1 = G*(i,j+1)`1 & G*(i,j)`2 = G*(i+1,j)`2 &
  G*(i+1,j+1)`1 = G*(i+1,j)`1 & G*(i+1,j+1)`2 = G*(i,j+1)`2
proof
  assume that
A1: 1 <= i and
A2: i+1 <= len G and
A3: 1 <= j and
A4: j+1 <= width G;
A5: i < len G by A2,NAT_1:13;
A6: j < width G by A4,NAT_1:13;
A7: 1 <= i+1 by NAT_1:11;
A8: 1 <= j+1 by NAT_1:11;
  thus G*(i,j)`1 = G*(i,1)`1 by A1,A3,A5,A6,GOBOARD5:3
    .= G*(i,j+1)`1 by A1,A4,A5,A8,GOBOARD5:3;
  thus G*(i,j)`2 = G*(1,j)`2 by A1,A3,A5,A6,GOBOARD5:2
    .= G*(i+1,j)`2 by A2,A3,A6,A7,GOBOARD5:2;
  thus G*(i+1,j+1)`1 = G*(i+1,1)`1 by A2,A4,A7,A8,GOBOARD5:3
    .= G*(i+1,j)`1 by A2,A3,A6,A7,GOBOARD5:3;
  thus G*(i+1,j+1)`2 = G*(1,j+1)`2 by A2,A4,A7,A8,GOBOARD5:2
    .= G*(i,j+1)`2 by A1,A4,A5,A8,GOBOARD5:2;
end;

theorem Th19:
  for i,j being Element of NAT
  st 1 <= i & i+1 <= len G & 1 <= j & j+1 <= width G holds
  p in cell(G,i,j) iff
  G*(i,j)`1 <= p`1 & p`1 <= G*(i+1,j)`1 & G*(i,j)`2 <= p`2 & p`2 <=
  G*(i,j+1)`2
proof
  let i,j be Element of NAT such that
A1: 1 <= i & i+1 <= len G and
A2: 1 <= j & j+1 <= width G;
A3: i < len G by A1,NAT_1:13;
A4: j < width G by A2,NAT_1:13;
  then
A5: v_strip(G,i) = { |[r,s]| : G*(i,j)`1 <= r & r <= G*(i+1,j)`1 } by A1,A2,A3,
GOBOARD5:9;
A6: h_strip(G,j) = { |[r,s]| : G*(i,j)`2 <= s & s <= G*(i,j+1)`2 } by A1,A2,A3
,A4,GOBOARD5:6;
  hereby
    assume p in cell(G,i,j);
    then
A7: p in v_strip(G,i) & p in h_strip(G,j) by XBOOLE_0:def 4;
    then ex r,s st |[r,s]| = p & G*(i,j)`1 <= r & r <= G*(i+1,j)`1 by A5;
    hence G*(i,j)`1 <= p`1 & p`1 <= G*(i+1,j)`1 by EUCLID:56;
    ex r,s st |[r,s]| = p & G*(i,j)`2 <= s & s <= G*(i,j+1)`2 by A6,A7;
    hence G*(i,j)`2 <= p`2 & p`2 <= G*(i,j+1)`2 by EUCLID:56;
  end;
  assume that
A8: G*(i,j)`1 <= p`1 & p`1 <= G*(i+1,j)`1 and
A9: G*(i,j)`2 <= p`2 & p`2 <= G*(i,j+1)`2;
A10: p = |[p`1,p`2]| by EUCLID:57;
  then
A11: p in v_strip(G,i) by A5,A8;
  p in h_strip(G,j) by A6,A9,A10;
  hence thesis by A11,XBOOLE_0:def 4;
end;

theorem
  1 <= i & i+1 <= len G & 1 <= j & j+1 <= width G implies
  cell(G,i,j) = { |[r,s]| : G*(i,j)`1 <= r & r <= G*(i+1,j)`1 &
  G*(i,j)`2 <= s & s <= G*(i,j+1)`2 }
proof
  assume that
A1: 1 <= i & i+1 <= len G and
A2: 1 <= j & j+1 <= width G;
  set A = { |[r,s]| : G*(i,j)`1 <= r & r <= G*(i+1,j)`1 &
  G*(i,j)`2 <= s & s <= G*(i,j+1)`2 };
  now
    let p be set;
    assume
A3: p in cell(G,i,j);
    then reconsider q=p as Point of TOP-REAL 2;
A4: p = |[q`1,q`2]| by EUCLID:57;
    G*(i,j)`1 <= q`1 & q`1 <= G*(i+1,j)`1 & G*(i,j)`2 <= q`2 & q`2 <=
    G*(i,j+1)`2 by A1,A2,A3,Th19;
    hence p in A by A4;
  end;
  hence cell(G,i,j) c= A by TARSKI:def 3;
  now
    let p be set;
    assume p in A;
    then consider r,s such that
A5: |[r,s]| = p and
A6: G*(i,j)`1 <= r & r <= G*(i+1,j)`1 and
A7: G*(i,j)`2 <= s & s <= G*(i,j+1)`2;
    reconsider q=p as Point of TOP-REAL 2 by A5;
    r = q`1 & s = q`2 by A5,EUCLID:56;
    hence p in cell(G,i,j) by A1,A2,A6,A7,Th19;
  end;
  hence thesis by TARSKI:def 3;
end;

theorem Th21:
  1 <= i & i+1 <= len G & 1 <= j & j+1 <= width G &
  p in Values G & p in cell(G,i,j) implies
  p = G*(i,j) or p = G*(i,j+1) or p = G*(i+1,j+1) or p = G*(i+1,j)
proof
  assume that
A1: 1 <= i and
A2: i+1 <= len G and
A3: 1 <= j and
A4: j+1 <= width G and
A5: p in Values G and
A6: p in cell(G,i,j);
A7: Values G = { G*(k,l) where k,l is Element of NAT: [k,l] in Indices G }
  by GOBRD13:7;
A8: i < len G by A2,NAT_1:13;
A9: j < width G by A4,NAT_1:13;
A10: 1 <= i+1 by NAT_1:11;
A11: 1 <= j+1 by NAT_1:11;
  consider k,l being Element of NAT such that
A12: p = G*(k,l) and
A13: [k,l] in Indices G by A5,A7;
A14: 1 <= k & k <= len G & 1 <= l & l <= width G by A13,MATRIX_1:39;
A15: now
    assume
A16: k <> i & k <> i+1;
    per cases by A16,NAT_1:9;
    suppose k < i;
      then G*(k,l)`1 < G*(i,l)`1 by A8,A14,GOBOARD5:4;
      then G*(k,l)`1 < G*(i,1)`1 by A1,A8,A14,GOBOARD5:3;
      then G*(k,l)`1 < G*(i,j)`1 by A1,A3,A8,A9,GOBOARD5:3;
      hence contradiction by A1,A2,A3,A4,A6,A12,Th19;
    end;
    suppose i+1 < k;
      then G*(i+1,l)`1 < G*(k,l)`1 by A10,A14,GOBOARD5:4;
      then G*(i+1,1)`1 < G*(k,l)`1 by A2,A10,A14,GOBOARD5:3;
      then G*(i+1,j)`1 < G*(k,l)`1 by A2,A3,A9,A10,GOBOARD5:3;
      hence contradiction by A1,A2,A3,A4,A6,A12,Th19;
    end;
  end;
  now
    assume
A17: l <> j & l <> j+1;
    per cases by A17,NAT_1:9;
    suppose l < j;
      then G*(k,l)`2 < G*(k,j)`2 by A9,A14,GOBOARD5:5;
      then G*(k,l)`2 < G*(1,j)`2 by A3,A9,A14,GOBOARD5:2;
      then G*(k,l)`2 < G*(i,j)`2 by A1,A3,A8,A9,GOBOARD5:2;
      hence contradiction by A1,A2,A3,A4,A6,A12,Th19;
    end;
    suppose j+1 < l;
      then G*(k,j+1)`2 < G*(k,l)`2 by A11,A14,GOBOARD5:5;
      then G*(1,j+1)`2 < G*(k,l)`2 by A4,A11,A14,GOBOARD5:2;
      then G*(i,j+1)`2 < G*(k,l)`2 by A1,A4,A8,A11,GOBOARD5:2;
      hence contradiction by A1,A2,A3,A4,A6,A12,Th19;
    end;
  end;
  hence thesis by A12,A15;
end;

theorem Th22:
  1 <= i & i+1 <= len G & 1 <= j & j+1 <= width G implies
  G*(i,j) in cell(G,i,j) & G*(i,j+1) in cell(G,i,j) &
  G*(i+1,j+1) in cell(G,i,j) & G*(i+1,j) in cell(G,i,j)
proof
  assume that
A1: 1 <= i and
A2: i+1 <= len G and
A3: 1 <= j and
A4: j+1 <= width G;
A5: i < i+1 & j < j+1 by NAT_1:13;
A6: i < len G by A2,NAT_1:13;
A7: j < width G by A4,NAT_1:13;
  then
A8: G*(i,j)`1 <= G*(i+1,j)`1 by A1,A2,A3,A5,GOBOARD5:4;
  G*(i,j)`2 <= G*(i,j+1)`2 by A1,A3,A4,A5,A6,GOBOARD5:5;
  hence G*(i,j) in cell(G,i,j) by A1,A2,A3,A4,A8,Th19;
A9: G*(i,j)`1 = G*(i,j+1)`1 by A1,A2,A3,A4,Th18;
  then
A10: G*(i,j+1)`1 <= G*(i+1,j)`1 by A1,A2,A3,A5,A7,GOBOARD5:4;
  G*(i,j)`2 <= G*(i,j+1)`2 by A1,A3,A4,A5,A6,GOBOARD5:5;
  hence G*(i,j+1) in cell(G,i,j) by A1,A2,A3,A4,A9,A10,Th19;
A11: G*(i+1,j+1)`1 = G*(i+1,j)`1 by A1,A2,A3,A4,Th18;
  then
A12: G*(i,j)`1 <= G*(i+1,j+1)`1 by A1,A2,A3,A5,A7,GOBOARD5:4;
A13: G*(i+1,j+1)`2 = G*(i,j+1)`2 by A1,A2,A3,A4,Th18;
  then G*(i,j)`2 <= G*(i+1,j+1)`2 by A1,A3,A4,A5,A6,GOBOARD5:5;
  hence G*(i+1,j+1) in cell(G,i,j) by A1,A2,A3,A4,A11,A12,A13,Th19;
A14: G*(i,j)`1 <= G*(i+1,j)`1 by A1,A2,A3,A5,A7,GOBOARD5:4;
A15: G*(i,j)`2 = G*(i+1,j)`2 by A1,A2,A3,A4,Th18;
  then G*(i+1,j)`2 <= G*(i,j+1)`2 by A1,A3,A4,A5,A6,GOBOARD5:5;
  hence thesis by A1,A2,A3,A4,A14,A15,Th19;
end;

theorem Th23:
  1 <= i & i+1 <= len G & 1 <= j & j+1 <= width G &
  p in Values G & p in cell(G,i,j) implies p is_extremal_in cell(G,i,j)
proof
  assume that
A1: 1 <= i and
A2: i+1 <= len G and
A3: 1 <= j and
A4: j+1 <= width G and
A5: p in Values G and
A6: p in cell(G,i,j);
  for a,b being Point of TOP-REAL 2 st p in
  LSeg(a,b) & LSeg(a,b) c= cell(G,i,j) holds p = a or p = b
  proof
    let a,b be Point of TOP-REAL 2 such that
A7: p in LSeg(a,b) and
A8: LSeg(a,b) c= cell(G,i,j);
    assume
A9: a <> p & b <> p;
A10: a in LSeg(a,b) & b in LSeg(a,b) by RLTOPSP1:69;
    per cases by A1,A2,A3,A4,A5,A6,Th21;
    suppose
A11:  p = G*(i,j);
      then
A12:  p`1 <= a`1 & p`2 <= a`2 by A1,A2,A3,A4,A8,A10,Th19;
A13:  p`1 <= b`1 & p`2 <= b`2 by A1,A2,A3,A4,A8,A10,A11,Th19;
      now
        per cases;
        suppose a`1 <= b`1 & a`2 <= b`2;
          then a`1 <= p`1 & a`2 <= p`2 by A7,TOPREAL1:9,10;
          then a`1 = p`1 & a`2 = p`2 by A12,XXREAL_0:1;
          hence contradiction by A9,TOPREAL3:11;
        end;
        suppose a`1 <= b`1 & b`2 < a`2;
          then a`1 <= p`1 & b`2 <= p`2 by A7,TOPREAL1:9,10;
          then
A14:      a`1 = p`1 & b`2 = p`2 by A12,A13,XXREAL_0:1;
          then a`2 <> p`2 by A9,TOPREAL3:11;
          then LSeg(a,b) is vertical by A7,A10,A14,SPPOL_1:39;
          then a`1 = b`1 by SPPOL_1:37;
          hence contradiction by A9,A14,TOPREAL3:11;
        end;
        suppose b`1 < a`1 & a`2 <= b`2;
          then b`1 <= p`1 & a`2 <= p`2 by A7,TOPREAL1:9,10;
          then
A15:      b`1 = p`1 & a`2 = p`2 by A12,A13,XXREAL_0:1;
          then b`2 <> p`2 by A9,TOPREAL3:11;
          then LSeg(a,b) is vertical by A7,A10,A15,SPPOL_1:39;
          then a`1 = b`1 by SPPOL_1:37;
          hence contradiction by A9,A15,TOPREAL3:11;
        end;
        suppose b`1 < a`1 & b`2 < a`2;
          then b`1 <= p`1 & b`2 <= p`2 by A7,TOPREAL1:9,10;
          then b`1 = p`1 & b`2 = p`2 by A13,XXREAL_0:1;
          hence contradiction by A9,TOPREAL3:11;
        end;
      end;
      hence contradiction;
    end;
    suppose
A16:  p = G*(i,j+1);
      then
A17:  p`1 = G*(i,j)`1 by A1,A2,A3,A4,Th18;
      then
A18:  p`1 <= a`1 & a`2 <= p`2 by A1,A2,A3,A4,A8,A10,A16,Th19;
A19:  p`1 <= b`1 & b`2 <= p`2 by A1,A2,A3,A4,A8,A10,A16,A17,Th19;
      now
        per cases;
        suppose a`1 <= b`1 & a`2 <= b`2;
          then a`1 <= p`1 & p`2 <= b`2 by A7,TOPREAL1:9,10;
          then
A20:      a`1 = p`1 & b`2 = p`2 by A18,A19,XXREAL_0:1;
          then a`2 <> p`2 by A9,TOPREAL3:11;
          then LSeg(a,b) is vertical by A7,A10,A20,SPPOL_1:39;
          then a`1 = b`1 by SPPOL_1:37;
          hence contradiction by A9,A20,TOPREAL3:11;
        end;
        suppose a`1 <= b`1 & b`2 < a`2;
          then a`1 <= p`1 & p`2 <= a`2 by A7,TOPREAL1:9,10;
          then a`1 = p`1 & a`2 = p`2 by A18,XXREAL_0:1;
          hence contradiction by A9,TOPREAL3:11;
        end;
        suppose b`1 < a`1 & a`2 <= b`2;
          then b`1 <= p`1 & p`2 <= b`2 by A7,TOPREAL1:9,10;
          then b`1 = p`1 & b`2 = p`2 by A19,XXREAL_0:1;
          hence contradiction by A9,TOPREAL3:11;
        end;
        suppose b`1 < a`1 & b`2 < a`2;
          then b`1 <= p`1 & p`2 <= a`2 by A7,TOPREAL1:9,10;
          then
A21:      b`1 = p`1 & a`2 = p`2 by A18,A19,XXREAL_0:1;
          then b`2 <> p`2 by A9,TOPREAL3:11;
          then LSeg(a,b) is vertical by A7,A10,A21,SPPOL_1:39;
          then a`1 = b`1 by SPPOL_1:37;
          hence contradiction by A9,A21,TOPREAL3:11;
        end;
      end;
      hence contradiction;
    end;
    suppose p = G*(i+1,j+1);
      then
A22:  p`1 = G*(i+1,j)`1 & p`2 = G*(i,j+1)`2 by A1,A2,A3,A4,Th18;
      then
A23:  a`1 <= p`1 & a`2 <= p`2 by A1,A2,A3,A4,A8,A10,Th19;
A24:  b`1 <= p`1 & b`2 <= p`2 by A1,A2,A3,A4,A8,A10,A22,Th19;
      now
        per cases;
        suppose a`1 <= b`1 & a`2 <= b`2;
          then p`1 <= b`1 & p`2 <= b`2 by A7,TOPREAL1:9,10;
          then b`1 = p`1 & b`2 = p`2 by A24,XXREAL_0:1;
          hence contradiction by A9,TOPREAL3:11;
        end;
        suppose a`1 <= b`1 & b`2 < a`2;
          then p`1 <= b`1 & p`2 <= a`2 by A7,TOPREAL1:9,10;
          then
A25:      b`1 = p`1 & a`2 = p`2 by A23,A24,XXREAL_0:1;
          then b`2 <> p`2 by A9,TOPREAL3:11;
          then LSeg(a,b) is vertical by A7,A10,A25,SPPOL_1:39;
          then a`1 = b`1 by SPPOL_1:37;
          hence contradiction by A9,A25,TOPREAL3:11;
        end;
        suppose b`1 < a`1 & a`2 <= b`2;
          then p`1 <= a`1 & p`2 <= b`2 by A7,TOPREAL1:9,10;
          then
A26:      a`1 = p`1 & b`2 = p`2 by A23,A24,XXREAL_0:1;
          then a`2 <> p`2 by A9,TOPREAL3:11;
          then LSeg(a,b) is vertical by A7,A10,A26,SPPOL_1:39;
          then a`1 = b`1 by SPPOL_1:37;
          hence contradiction by A9,A26,TOPREAL3:11;
        end;
        suppose b`1 < a`1 & b`2 < a`2;
          then p`1 <= a`1 & p`2 <= a`2 by A7,TOPREAL1:9,10;
          then a`1 = p`1 & a`2 = p`2 by A23,XXREAL_0:1;
          hence contradiction by A9,TOPREAL3:11;
        end;
      end;
      hence contradiction;
    end;
    suppose
A27:  p = G*(i+1,j);
      then
A28:  p`2 = G*(i,j)`2 by A1,A2,A3,A4,Th18;
      then
A29:  a`1 <= p`1 & p`2 <= a`2 by A1,A2,A3,A4,A8,A10,A27,Th19;
A30:  b`1 <= p`1 & p`2 <= b`2 by A1,A2,A3,A4,A8,A10,A27,A28,Th19;
      now
        per cases;
        suppose a`1 <= b`1 & a`2 <= b`2;
          then p`1 <= b`1 & a`2 <= p`2 by A7,TOPREAL1:9,10;
          then
A31:      b`1 = p`1 & a`2 = p`2 by A29,A30,XXREAL_0:1;
          then b`2 <> p`2 by A9,TOPREAL3:11;
          then LSeg(a,b) is vertical by A7,A10,A31,SPPOL_1:39;
          then a`1 = b`1 by SPPOL_1:37;
          hence contradiction by A9,A31,TOPREAL3:11;
        end;
        suppose a`1 <= b`1 & b`2 < a`2;
          then p`1 <= b`1 & b`2 <= p`2 by A7,TOPREAL1:9,10;
          then b`1 = p`1 & b`2 = p`2 by A30,XXREAL_0:1;
          hence contradiction by A9,TOPREAL3:11;
        end;
        suppose b`1 < a`1 & a`2 <= b`2;
          then p`1 <= a`1 & a`2 <= p`2 by A7,TOPREAL1:9,10;
          then a`1 = p`1 & a`2 = p`2 by A29,XXREAL_0:1;
          hence contradiction by A9,TOPREAL3:11;
        end;
        suppose b`1 < a`1 & b`2 < a`2;
          then p`1 <= a`1 & b`2 <= p`2 by A7,TOPREAL1:9,10;
          then
A32:      a`1 = p`1 & b`2 = p`2 by A29,A30,XXREAL_0:1;
          then a`2 <> p`2 by A9,TOPREAL3:11;
          then LSeg(a,b) is vertical by A7,A10,A32,SPPOL_1:39;
          then a`1 = b`1 by SPPOL_1:37;
          hence contradiction by A9,A32,TOPREAL3:11;
        end;
      end;
      hence contradiction;
    end;
  end;
  hence thesis by A6,SPPOL_1:def 1;
end;

theorem Th24:
  2 <= len G & 2 <= width G & f is_sequence_on G & 1 <= k & k+1 <= len f
  implies ex i,j st 1 <= i & i+1 <= len G & 1 <= j & j+1 <= width G &
  LSeg(f,k) c= cell(G,i,j)
proof
  assume that
A1: 2 <= len G and
A2: 2 <= width G and
A3: f is_sequence_on G and
A4: 1 <= k and
A5: k+1 <= len f;
A6: LSeg(f,k) = LSeg(f/.k, f/.(k+1)) by A4,A5,TOPREAL1:def 5;
  consider i1,j1,i2,j2 being Element of NAT such that
A7: [i1,j1] in Indices G and
A8: f/.k = G*(i1,j1) and
A9: [i2,j2] in Indices G and
A10: f/.(k+1) = G*(i2,j2) and
A11: i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or i1 = i2+1 & j1 = j2 or
  i1 = i2 & j1 = j2+1 by A3,A4,A5,JORDAN8:6;
A12: 1 <= i1 & i1 <= len G & 1 <= j1 & j1 <= width G by A7,MATRIX_1:39;
A13: 1 <= i2 & i2 <= len G & 1 <= j2 & j2 <= width G by A9,MATRIX_1:39;
  per cases by A11;
  suppose
A14: i1 = i2 & j1+1 = j2;
    then
A15: j1 < width G by A13,XREAL_1:147;
    now
      per cases by A12,XXREAL_0:1;
      suppose i1 < len G;
        then
A16:    i1+1 <= len G by NAT_1:13;
        take i1,j1;
        LSeg(f,k) c= cell(G,i1,j1) by A6,A8,A10,A12,A14,A15,GOBOARD5:20;
        hence thesis by A12,A13,A14,A16;
      end;
      suppose
A17:    i1 = len G;
        take i1'=i1-'1,j1;
        2-1 <= 2-'1 & 2-'1 <= i1' by A1,A17,NAT_D:42,XREAL_0:def 2;
        then
A18:    1 <= i1' by XXREAL_0:2;
A19:    i1'+1 = i1 by A12,XREAL_1:237;
        then i1' < len G by A12,NAT_1:13;
        then LSeg(f,k) c= cell(G,i1',j1) by A6,A8,A10,A12,A14,A15,A19,
GOBOARD5:19;
        hence thesis by A12,A13,A14,A18,A19;
      end;
    end;
    hence thesis;
  end;
  suppose
A20: i1+1 = i2 & j1 = j2;
    then
A21: i1 < len G by A13,XREAL_1:147;
    now
      per cases by A12,XXREAL_0:1;
      suppose j1 < width G;
        then
A22:    j1+1 <= width G by NAT_1:13;
        take i1,j1;
        LSeg(f,k) c= cell(G,i1,j1) by A6,A8,A10,A12,A20,A21,GOBOARD5:23;
        hence thesis by A12,A13,A20,A22;
      end;
      suppose
A23:    j1 = width G;
        take i1,j1'=j1-'1;
        2-1 <= 2-'1 & 2-'1 <= j1' by A2,A23,NAT_D:42,XREAL_0:def 2;
        then
A24:    1 <= j1' by XXREAL_0:2;
A25:    j1'+1=j1 by A12,XREAL_1:237;
        then j1' < width G by A23,NAT_1:13;
        then LSeg(f,k) c= cell(G,i1,j1') by A6,A8,A10,A12,A20,A21,A25,
GOBOARD5:22;
        hence thesis by A12,A13,A20,A24,A25;
      end;
    end;
    hence thesis;
  end;
  suppose
A26: i1 = i2+1 & j1 = j2;
    then
A27: i2 < len G by A12,XREAL_1:147;
    now
      per cases by A12,XXREAL_0:1;
      suppose j1 < width G;
        then
A28:    j1+1 <= width G by NAT_1:13;
        take i2,j1;
        LSeg(f,k) c= cell(G,i2,j1) by A6,A8,A10,A13,A26,A27,GOBOARD5:23;
        hence thesis by A12,A13,A26,A28;
      end;
      suppose
A29:    j1 = width G;
        take i2,j1'=j1-'1;
        2-1 <= 2-'1 & 2-'1 <= j1' by A2,A29,NAT_D:42,XREAL_0:def 2;
        then
A30:    1 <= j1' by XXREAL_0:2;
A31:    j1'+1=j1 by A12,XREAL_1:237;
        then j1' < width G by A29,NAT_1:13;
        then LSeg(f,k) c= cell(G,i2,j1') by A6,A8,A10,A13,A26,A27,A31,
GOBOARD5:22;
        hence thesis by A12,A13,A26,A30,A31;
      end;
    end;
    hence thesis;
  end;
  suppose
A32: i1 = i2 & j1 = j2+1;
    then
A33: j2 < width G by A12,XREAL_1:147;
    now
      per cases by A12,XXREAL_0:1;
      suppose i1 < len G;
        then
A34:    i1+1 <= len G by NAT_1:13;
        take i1,j2;
        LSeg(f,k) c= cell(G,i1,j2) by A6,A8,A10,A13,A32,A33,GOBOARD5:20;
        hence thesis by A12,A13,A32,A34;
      end;
      suppose
A35:    i1 = len G;
        take i1'=i1-'1,j2;
        2-1 <= 2-'1 & 2-'1 <= i1' by A1,A35,NAT_D:42,XREAL_0:def 2;
        then
A36:    1 <= i1' by XXREAL_0:2;
A37:    i1'+1 = i1 by A12,XREAL_1:237;
        then i1' < len G by A12,NAT_1:13;
        then LSeg(f,k) c= cell(G,i1',j2) by A6,A8,A10,A13,A32,A33,A37,
GOBOARD5:19;
        hence thesis by A12,A13,A32,A36,A37;
      end;
    end;
    hence thesis;
  end;
end;

theorem Th25:
  2 <= len G & 2 <= width G & f is_sequence_on G & 1 <= k & k+1 <= len f &
  p in Values G & p in LSeg(f,k) implies p = f/.k or p = f/.(k+1)
proof
  assume that
A1: 2 <= len G and
A2: 2 <= width G and
A3: f is_sequence_on G and
A4: 1 <= k and
A5: k+1 <= len f and
A6: p in Values G and
A7: p in LSeg(f,k);
  consider i,j such that
A8: 1 <= i & i+1 <= len G and
A9: 1 <= j & j+1 <= width G and
A10: LSeg(f,k) c= cell(G,i,j) by A1,A2,A3,A4,A5,Th24;
A11: LSeg(f,k) = LSeg(f/.k, f/.(k+1)) by A4,A5,TOPREAL1:def 5;
  p is_extremal_in cell(G,i,j) by A6,A7,A8,A9,A10,Th23;
  hence thesis by A7,A10,A11,SPPOL_1:def 1;
end;

theorem
  [i,j] in Indices G & 1 <= k & k <= width G implies G*(i,j)`1 <= G*
  (len G,k)`1
proof
  assume that
A1: [i,j] in Indices G and
A2: 1 <= k & k <= width G;
A3: 1 <= i & i <= len G & 1 <= j & j <= width G by A1,MATRIX_1:39;
  then
A4: G*(i,j)`1 = G*(i,1)`1 by GOBOARD5:3
    .= G*(i,k)`1 by A2,A3,GOBOARD5:3;
  i < len G or i = len G by A3,XXREAL_0:1;
  hence thesis by A2,A3,A4,GOBOARD5:4;
end;

theorem
  [i,j] in Indices G & 1 <= k & k <= len G implies G*(i,j)`2 <= G*
  (k,width G)`2
proof
  assume that
A1: [i,j] in Indices G and
A2: 1 <= k & k <= len G;
A3: 1 <= i & i <= len G & 1 <= j & j <= width G by A1,MATRIX_1:39;
  then
A4: G*(i,j)`2 = G*(1,j)`2 by GOBOARD5:2
    .= G*(k,j)`2 by A2,A3,GOBOARD5:2;
  j < width G or j = width G by A3,XXREAL_0:1;
  hence thesis by A2,A3,A4,GOBOARD5:5;
end;

theorem Th28:
  f is_sequence_on G & f is special & L~g c= L~f & 1 <= k & k+1 <= len f
  implies for A being Subset of TOP-REAL 2 st
  A = right_cell(f,k,G)\L~g or A = left_cell(f,k,G)\L~g holds A is connected
proof
  assume that
A1: f is_sequence_on G & f is special & L~g c= L~f and
A2: 1 <= k and
A3: k+1 <= len f;
  let A be Subset of TOP-REAL 2 such that
A4: A = right_cell(f,k,G)\L~g or A = left_cell(f,k,G)\L~g;
  per cases by A4;
  suppose
A5: A = right_cell(f,k,G)\L~g;
    then
A6: A = right_cell(f,k,G) /\ (L~g)` by SUBSET_1:32;
A7: A c= right_cell(f,k,G) by A5,XBOOLE_1:36;
A8: Int right_cell(f,k,G) is connected by A1,A2,A3,Th12;
    Int right_cell(f,k,G) misses L~f by A1,A2,A3,Th17;
    then Int right_cell(f,k,G) misses L~g by A1,XBOOLE_1:63;
    then
A9: Int right_cell(f,k,G) c= (L~g)` by SUBSET_1:43;
A10: Int right_cell(f,k,G) c= right_cell(f,k,G) by TOPS_1:44;
    A c= Cl Int right_cell(f,k,G) by A1,A2,A3,A7,Th13;
    hence thesis by A6,A8,A9,A10,CONNSP_1:19,XBOOLE_1:19;
  end;
  suppose
A11: A = left_cell(f,k,G)\L~g;
    then
A12: A = left_cell(f,k,G) /\ (L~g)` by SUBSET_1:32;
A13: A c= left_cell(f,k,G) by A11,XBOOLE_1:36;
A14: Int left_cell(f,k,G) is connected by A1,A2,A3,Th12;
    Int left_cell(f,k,G) misses L~f by A1,A2,A3,Th17;
    then Int left_cell(f,k,G) misses L~g by A1,XBOOLE_1:63;
    then
A15: Int left_cell(f,k,G) c= (L~g)` by SUBSET_1:43;
A16: Int left_cell(f,k,G) c= left_cell(f,k,G) by TOPS_1:44;
    A c= Cl Int left_cell(f,k,G) by A1,A2,A3,A13,Th13;
    hence thesis by A12,A14,A15,A16,CONNSP_1:19,XBOOLE_1:19;
  end;
end;

theorem Th29:
  for f being non constant standard special_circular_sequence st
  f is_sequence_on G for k st 1 <= k & k+1 <= len f holds
  right_cell(f,k,G)\L~f c= RightComp f & left_cell(f,k,G)\L~f c= LeftComp f
proof
  let f be non constant standard special_circular_sequence such that
A1: f is_sequence_on G;
  let k such that
A2: 1 <= k & k+1 <= len f;
  set rc = right_cell(f,k,G)\L~f;
A3: rc = right_cell(f,k,G) /\ (L~f)` by SUBSET_1:32;
A4: rc c= right_cell(f,k,G) by XBOOLE_1:36;
  right_cell(f,k,G) c= right_cell(f,k) by A1,A2,GOBRD13:34;
  then rc c= right_cell(f,k) by A4,XBOOLE_1:1;
  then
A5: Int rc c= Int right_cell(f,k) by TOPS_1:48;
  Int right_cell(f,k) c= RightComp f by A2,GOBOARD9:28;
  then
A6: Int rc c= RightComp f by A5,XBOOLE_1:1;
A7: Int right_cell(f,k,G) <> {} by A1,A2,Th11;
A8: Int right_cell(f,k,G) misses L~f by A1,A2,Th17;
A9: Int right_cell(f,k,G) c= right_cell(f,k,G) by TOPS_1:44;
  rc \/ L~f = right_cell(f,k,G) \/ L~f by XBOOLE_1:39;
  then right_cell(f,k,G) c= rc \/ L~f by XBOOLE_1:7;
  then
A10: Int right_cell(f,k,G) c= rc \/ L~f by A9,XBOOLE_1:1;
  then
A11: Int right_cell(f,k,G) c= rc by A8,XBOOLE_1:73;
  Int Int right_cell(f,k,G) c= Int rc by A8,A10,TOPS_1:48,XBOOLE_1:73;
  then
A12: rc meets Int rc by A7,A11,XBOOLE_1:68;
A13: rc is connected by A1,A2,Th28;
A14: RightComp f is_a_component_of (L~f)` by GOBOARD9:def 2;
  rc c= (L~f)` by A3,XBOOLE_1:17;
  hence right_cell(f,k,G)\L~f c= RightComp f by A6,A12,A13,A14,GOBOARD9:6;
  set lc = left_cell(f,k,G)\L~f;
A15: lc = left_cell(f,k,G) /\ (L~f)` by SUBSET_1:32;
A16: lc c= left_cell(f,k,G) by XBOOLE_1:36;
  left_cell(f,k,G) c= left_cell(f,k) by A1,A2,GOBRD13:34;
  then lc c= left_cell(f,k) by A16,XBOOLE_1:1;
  then
A17: Int lc c= Int left_cell(f,k) by TOPS_1:48;
  Int left_cell(f,k) c= LeftComp f by A2,GOBOARD9:24;
  then
A18: Int lc c= LeftComp f by A17,XBOOLE_1:1;
A19: Int left_cell(f,k,G) <> {} by A1,A2,Th11;
A20: Int left_cell(f,k,G) misses L~f by A1,A2,Th17;
A21: Int left_cell(f,k,G) c= left_cell(f,k,G) by TOPS_1:44;
  lc \/ L~f = left_cell(f,k,G) \/ L~f by XBOOLE_1:39;
  then left_cell(f,k,G) c= lc \/ L~f by XBOOLE_1:7;
  then
A22: Int left_cell(f,k,G) c= lc \/ L~f by A21,XBOOLE_1:1;
  then
A23: Int left_cell(f,k,G) c= lc by A20,XBOOLE_1:73;
  Int Int left_cell(f,k,G) c= Int lc by A20,A22,TOPS_1:48,XBOOLE_1:73;
  then
A24: lc meets Int lc by A19,A23,XBOOLE_1:68;
A25: lc is connected by A1,A2,Th28;
A26: LeftComp f is_a_component_of (L~f)` by GOBOARD9:def 1;
  lc c= (L~f)` by A15,XBOOLE_1:17;
  hence thesis by A18,A24,A25,A26,GOBOARD9:6;
end;

begin :: Cages

reserve
  C for compact non vertical non horizontal non empty Subset of TOP-REAL 2,
  l, m, i1, i2, j1, j2 for Element of NAT;

theorem Th30:
  for n being Nat ex i st 1 <= i & i+1 <= len Gauge(C,n) &
  N-min C in cell(Gauge(C,n),i,width Gauge(C,n)-'1) &
  N-min C <> Gauge(C,n)*(i,width Gauge(C,n)-'1)
proof
  let n be Nat;
A1: n in NAT by ORDINAL1:def 13;
  set G = Gauge(C,n);
A2: len G = width G by JORDAN8:def 1;
  defpred P[Nat]
  means 1 <= $1 & $1 < len G & G*($1,(width G)-'1)`1 < (N-min C)`1;
A3: for k be Nat st P[k] holds k <= len G;
A4: len G = 2|^n+3 & len G = width G by JORDAN8:def 1;
A5: len G >= 4 by JORDAN8:13;
  then
A6: 1 < len G by XXREAL_0:2;
  then
A7: 1 <= (len G)-'1 by NAT_D:49;
A8: (len G)-'1 <= len G by NAT_D:35;
  (NW-corner C)`1 <= (N-min C)`1 by PSCOMP_1:97;
  then
A9: W-bound C <= (N-min C)`1 by EUCLID:56;
A10: 2 <= len G by A5,XXREAL_0:2;
  G*(2,(width G)-'1)`1 = W-bound C by A1,A2,A7,JORDAN8:14,NAT_D:35;
  then G*(1,(width G)-'1)`1 < W-bound C by A4,A7,A8,A10,GOBOARD5:4;
  then G*(1,(width G)-'1)`1 < (N-min C)`1 by A9,XXREAL_0:2;
  then
A11: ex k be Nat st P[k] by A6;
  ex i being Nat st P[i] &
  for n be Nat st P[n] holds n <= i from NAT_1:sch 6(A3,A11);
  then consider i being Nat such that
A12: 1 <= i & i < len G and
A13: G*(i,(width G)-'1)`1 < (N-min C)`1 and
A14: for n be Nat st P[n] holds n <= i;
  reconsider i as Element of NAT by ORDINAL1:def 13;
  take i;
  thus 1 <= i & i+1 <= len G by A12,NAT_1:13;
A15: LSeg(G*(i,(width G)-'1),G*(i+1,(width G)-'1)) c= cell(G,i,(width G)-'1)
  by A4,A7,A12,GOBOARD5:23,NAT_D:35;
A16: i+1 <= len G by A12,NAT_1:13;
A17: 1 <= i+1 by NAT_1:12;
  (N-min C)`2 = N-bound C by EUCLID:56;
  then
A18: G*(i,(width G)-'1)`2 = (N-min C)`2 & (N-min C)`2 = G*
  (i+1,(width G)-'1)`2 by A1,A2,A12,A16,JORDAN8:17,NAT_1:12;
  now
    assume i+1 = len G;
    then len G-'1 = i by NAT_D:34;
    then
A19: G*(i,(width G)-'1)`1 = E-bound C by A1,A2,A7,JORDAN8:15,NAT_D:35;
    (NE-corner C)`1 >= (N-min C)`1 by PSCOMP_1:97;
    hence contradiction by A13,A19,EUCLID:56;
  end;
  then i+1 < len G & i < i+1 by A16,NAT_1:13,XXREAL_0:1;
  then (N-min C)`1 <= G*(i+1,(width G)-'1)`1 by A14,A17;
  then N-min C in LSeg(G*(i,(width G)-'1),G*(i+1,(width G)-'1))
  by A13,A18,GOBOARD7:9;
  hence N-min C in cell(G,i,(width G)-'1) by A15;
  thus thesis by A13;
end;

theorem Th31:
  for n, i1, i2 being Nat holds 1 <= i1 & i1+1 <= len Gauge(C,n) &
  N-min C in cell(Gauge(C,n),i1,width Gauge(C,n)-'1) &
  N-min C <> Gauge(C,n)*(i1,width Gauge(C,n)-'1) &
  1 <= i2 & i2+1 <= len Gauge(C,n) &
  N-min C in cell(Gauge(C,n),i2,width Gauge(C,n)-'1) &
  N-min C <> Gauge(C,n)*(i2,width Gauge(C,n)-'1) implies i1 = i2
proof
  let n, i1, i2 be Nat;
A1: i1 in NAT & i2 in NAT by ORDINAL1:def 13;
  set G = Gauge(C,n), j = width G-'1;
  assume that
A2: 1 <= i1 & i1+1 <= len G and
A3: N-min C in cell(G,i1,j) and
A4: N-min C <> G*(i1,j) and
A5: 1 <= i2 & i2+1 <= len G and
A6: N-min C in cell(G,i2,j) and
A7: N-min C <> G*(i2,j) and
A8: i1 <> i2;
A9: i1 < len G & i2 < len G & len G = width G by A2,A5,JORDAN8:def 1,NAT_1:13;
A10: cell(G,i1,j) meets cell(G,i2,j) by A3,A6,XBOOLE_0:3;
A11: len G = 2|^n+3 & len G = width G by JORDAN8:def 1;
A12: 2|^n >= n+1 by NEWTON:104;
  then len G >= n+1+3 by A11,XREAL_1:8;
  then
A13: len G >= 1+ (n+3) & 1+ (n+3) > 1+0 by XREAL_1:8;
  then len G > 1 by XXREAL_0:2;
  then
A14: len G >= 1+1 by NAT_1:13;
  then
A15: 1 <= j by A9,JORDAN5B:2;
A16: j+1 = len G by A9,A13,XREAL_1:237,XXREAL_0:2;
  then
A17: j < len G by NAT_1:13;
  per cases by A8,XXREAL_0:1;
  suppose
A18: i1 < i2;
    then
A19: i2-'i1+i1 = i2 by XREAL_1:237;
    then i2-'i1 <= 1 by A1,A9,A10,A15,A17,JORDAN8:10;
    then i2-'i1 < 1 or i2-'i1 = 1 by XXREAL_0:1;
    then i2-'i1 = 0 or i2-'i1 = 1 by NAT_1:14;
    then cell(G,i1,j) /\ cell(G,i2,j) = LSeg(G*(i2,j),G*(i2,j+1))
    by A1,A9,A14,A17,A18,A19,GOBOARD5:26,JORDAN5B:2;
    then
A20: N-min C in LSeg(G*(i2,j),G*(i2,j+1)) by A3,A6,XBOOLE_0:def 4;
A21: [i2,j] in Indices G by A5,A9,A15,A17,MATRIX_1:37;
    1 <= j+1 by NAT_1:12;
    then
A22: [i2,j+1] in Indices G by A5,A9,A16,MATRIX_1:37;
    set x = (W-bound C)+(((E-bound C)-(W-bound C))/(2|^n))*(i2-2);
    set y1 = (S-bound C)+(((N-bound C)-(S-bound C))/(2|^n))*(j-2);
    set y2 = (S-bound C)+(((N-bound C)-(S-bound C))/(2|^n))*(j-1);
A23: j+1-(1+1) = j-1;
A24: G*(i2,j) = |[x,y1]| by A21,JORDAN8:def 1;
    G*(i2,j+1) = |[x,y2]| by A22,A23,JORDAN8:def 1;
    then
A25: G*(i2,j)`1 = x & G*(i2,j+1)`1 = x by A24,EUCLID:56;
    then LSeg(G*(i2,j),G*(i2,j+1)) is vertical by SPPOL_1:37;
    then
A26: (N-min C)`1 = G*(i2,j)`1 by A20,SPPOL_1:64;
    j = (2|^n+2+1)-'1 by A11
      .= (2|^n+2) by NAT_D:34;
    then (((N-bound C)-(S-bound C))/(2|^n))*(j-2) = (N-bound C)-(S-bound C)
    by A12,XCMPLX_1:88;
    hence contradiction by A7,A24,A25,A26,EUCLID:56;
  end;
  suppose
A27: i2 < i1;
    then
A28: i1-'i2+i2 = i1 by XREAL_1:237;
    then i1-'i2 <= 1 by A1,A9,A10,A15,A17,JORDAN8:10;
    then i1-'i2 < 1 or i1-'i2 = 1 by XXREAL_0:1;
    then i1-'i2 = 0 or i1-'i2 = 1 by NAT_1:14;
    then cell(G,i2,j) /\ cell(G,i1,j) = LSeg(G*(i1,j),G*(i1,j+1))
    by A1,A9,A14,A17,A27,A28,GOBOARD5:26,JORDAN5B:2;
    then
A29: N-min C in LSeg(G*(i1,j),G*(i1,j+1)) by A3,A6,XBOOLE_0:def 4;
A30: [i1,j] in Indices G by A2,A9,A15,A17,MATRIX_1:37;
    1 <= j+1 by NAT_1:12;
    then
A31: [i1,j+1] in Indices G by A2,A9,A16,MATRIX_1:37;
    set x = (W-bound C)+(((E-bound C)-(W-bound C))/(2|^n))*(i1-2);
    set y1 = (S-bound C)+(((N-bound C)-(S-bound C))/(2|^n))*(j-2);
    set y2 = (S-bound C)+(((N-bound C)-(S-bound C))/(2|^n))*(j-1);
A32: j+1-(1+1) = j-1;
A33: G*(i1,j) = |[x,y1]| by A30,JORDAN8:def 1;
    G*(i1,j+1) = |[x,y2]| by A31,A32,JORDAN8:def 1;
    then
A34: G*(i1,j)`1 = x & G*(i1,j+1)`1 = x by A33,EUCLID:56;
    then LSeg(G*(i1,j),G*(i1,j+1)) is vertical by SPPOL_1:37;
    then
A35: (N-min C)`1 = G*(i1,j)`1 by A29,SPPOL_1:64;
    j = (2|^n+2+1)-'1 by A11
      .= (2|^n+2) by NAT_D:34;
    then (((N-bound C)-(S-bound C))/(2|^n))*(j-2) = (N-bound C)-(S-bound C)
    by A12,XCMPLX_1:88;
    hence contradiction by A4,A33,A34,A35,EUCLID:56;
  end;
end;

theorem Th32:
  for n being Nat for f being standard non constant special_circular_sequence
  st f is_sequence_on Gauge(C,n) & (for k st 1 <= k & k+1 <= len f holds
  left_cell(f,k,Gauge(C,n)) misses C & right_cell(f,k,Gauge(C,n)) meets C) &
  (ex i st 1 <= i & i+1 <= len Gauge(C,n) &
  f/.1 = Gauge(C,n)*(i,width Gauge(C,n)) &
  f/.2 = Gauge(C,n)*(i+1,width Gauge(C,n)) &
  N-min C in cell(Gauge(C,n),i,width Gauge(C,n)-'1) &
  N-min C <> Gauge(C,n)*(i,width Gauge(C,n)-'1)) holds N-min L~f = f/.1
proof
  let n be Nat;
  set G = Gauge(C,n);
  let f be standard non constant special_circular_sequence such that
A1: f is_sequence_on G and
A2: for k st 1 <= k & k+1 <= len f
  holds left_cell(f,k,G) misses C & right_cell(f,k,G) meets C;
  given i' being Element of NAT such that
A3: 1 <= i' & i'+1 <= len G and
A4: f/.1 = G*(i',width G) and
A5: f/.2 = G*(i'+1,width G) and
A6: N-min C in cell(G,i',width G-'1) and
A7: N-min C <> G*(i',width G-'1);
A8: i' < len G & len G = width G by A3,JORDAN8:def 1,NAT_1:13;
A9: len f > 4 by GOBOARD7:36;
A10: len G = 2|^n+3 & len G = width G by JORDAN8:def 1;
  then
A11: len G >= 3 by NAT_1:12;
  then
A12: 1 < len G by XXREAL_0:2;
  set W = W-bound C, S = S-bound C, E = E-bound C, N = N-bound C;
  N-min L~f in rng f by SPRECT_2:43;
  then consider m being Nat such that
A13: m in dom f and
A14: f.m = N-min L~f by FINSEQ_2:11;
  reconsider m as Element of NAT by ORDINAL1:def 13;
A15: f/.m = f.m by A13,PARTFUN1:def 8;
A16: (N-min L~f)`2 = N-bound L~f by EUCLID:56;
A17: 2|^n > 0 by NEWTON:102;
  N > S by JORDAN8:12;
  then N-S > 0 by XREAL_1:52;
  then
A18: (N-S)/(2|^n) > 0 by A17,XREAL_1:141;
A19: 1 <= m & m <= len f by A13,FINSEQ_3:27;
  consider i,j such that
A20: [i,j] in Indices G and
A21: f/.m = G*(i,j) by A1,A13,GOBOARD1:def 11;
A22: 1 <= i & i <= len G & 1 <= j & j <= width G by A20,MATRIX_1:39;
  G*(i,j) = |[W+((E-W)/(2|^n))*(i-2), S+((N-S)/(2|^n))*(j-2)]|
  by A20,JORDAN8:def 1;
  then
A23: S+((N-S)/(2|^n))*(j-2) = N-bound L~f by A14,A15,A16,A21,EUCLID:56;
  1 in dom f by FINSEQ_5:6;
  then
A24: f/.1 in L~f by A9,GOBOARD1:16,XXREAL_0:2;
  then
A25: N-bound L~f >= (f/.1)`2 by PSCOMP_1:71;
  G*(i',j)`2 = G*(1,j)`2 & G*(i,j)`2 = G* (1,j)`2 by A3,A8,A22,GOBOARD5:2;
  then G*(i,j)`2 <= G*(i',len G)`2 by A3,A8,A22,SPRECT_3:24;
  then
A26: N-bound L~f = (f/.1)`2 by A4,A8,A14,A15,A16,A21,A25,XXREAL_0:1;
  [i',len G] in Indices G by A3,A8,A12,MATRIX_1:37;
  then G*(i',len G)=|[W+((E-W)/(2|^n))*(i'-2),S+((N-S)/(2|^n))*(len G-2)]|
  by JORDAN8:def 1;
  then S+((N-S)/(2|^n))*(len G-2) = N-bound L~f by A4,A8,A26,EUCLID:56;
  then
A27: len G-2 = j-2 by A18,A23,XCMPLX_1:5;
A28: (NW-corner C)`1 = W & (NE-corner C)`1 = E &
  (NW-corner C)`2 = N & (NE-corner C)`2 = N by EUCLID:56;
A29: G*(i',len G)`1 = G*(i',1)`1 by A3,A8,A22,A27,GOBOARD5:3;
A30: G*(i,len G)`1 = G*(i,1)`1 by A22,A27,GOBOARD5:3;
A31: (NW-corner L~f)`1 = W-bound L~f & (NE-corner L~f)`1 = E-bound L~f &
  (NW-corner L~f)`2 = N-bound L~f & (NE-corner L~f)`2 = N-bound L~f
  by EUCLID:56;
  W-bound L~f <= (f/.1)`1 & (f/.1)`1 <= E-bound L~f by A24,PSCOMP_1:71;
  then f/.1 in LSeg(NW-corner L~f, NE-corner L~f) by A26,A31,GOBOARD7:9;
  then f/.1 in LSeg(NW-corner L~f, NE-corner L~f) /\ L~f
  by A24,XBOOLE_0:def 4;
  then
A32: (N-min L~f)`1 <= (f/.1)`1 by PSCOMP_1:98;
A33: 1 <= len G-'1 by A12,NAT_D:49;
  then
A34: len G-'1 < len G by NAT_D:51;
A35: len G-'1+1 = len G by A11,XREAL_1:237,XXREAL_0:2;
  then N-min C in { |[r',s']| where r',s' is Real:
  G*(i',1)`1 <= r' & r' <= G*(i'+1,1)`1 &
  G*(1,len G-'1)`2 <= s' & s' <= G*(1,len G)`2 }
  by A3,A6,A8,A33,A34,GOBRD11:32;
  then consider r',s' being Real such that
A36: N-min C = |[r',s']| and
A37: G*(i',1)`1 <= r' & r' <= G*(i'+1,1)`1 and
  G*(1,len G-'1)`2 <= s' & s' <= G*(1,len G)`2;
A38: (f/.1)`1 <= (N-min C)`1 by A4,A8,A29,A36,A37,EUCLID:56;
  then
A39: (N-min L~f)`1 <= (N-min C)`1 by A32,XXREAL_0:2;
A40: G*(i',len G-'1)`1 = G*(i',1)`1 by A3,A8,A33,A34,GOBOARD5:3;
A41: N-min C = |[(N-min C)`1,(N-min C)`2]| by EUCLID:57;
A42: G*(i',len G-'1) = |[G*(i',len G-'1)`1,G*(i',len G-'1)`2]| by EUCLID:57;
A43: (N-min C)`2 = N by EUCLID:56;
A44: n in NAT by ORDINAL1:def 13;
  then G*(i',len G-'1)`2 = N by A3,A8,JORDAN8:17;
  then
A45: G*(i',len G-'1)`1 < (N-min C)`1
  by A4,A7,A8,A29,A38,A40,A41,A42,A43,XXREAL_0:1;
A46: i <= i' by A3,A4,A8,A14,A15,A21,A22,A27,A32,GOBOARD5:4;
  then
A47: i < len G by A8,XXREAL_0:2;
  then
A48: i+1 <= len G by NAT_1:13;
  per cases by A19,XXREAL_0:1;
  suppose m = len f;
    hence thesis by A14,A15,FINSEQ_6:def 1;
  end;
  suppose m < len f;
    then
A49: m+1 <= len f by NAT_1:13;
    then
A50: right_cell(f,m,G) meets C by A2,A19;
    then consider p being set such that
A51: p in right_cell(f,m,G) & p in C by XBOOLE_0:3;
    reconsider p as Point of TOP-REAL 2 by A51;
    consider i1,j1,i2,j2 being Element of NAT such that
A52: [i1,j1] in Indices G & f/.m = G*(i1,j1) and
A53: [i2,j2] in Indices G & f/.(m+1) = G*(i2,j2) and
A54: i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
    i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A1,A19,A49,JORDAN8:6;
A55: 1 <= i2 & i2 <= len G & 1 <= j2 & j2 <= len G by A10,A53,MATRIX_1:39;
A56: (N-min C)`2 = N by EUCLID:56;
    then
A57: p`2 <= (N-min C)`2 by A51,PSCOMP_1:71;
A58: G*(1,len G-'1)`2 = N by A12,A44,JORDAN8:17;
A59: G*(1,len G-'1)`2 < G*(1,len G)`2 by A10,A12,A33,A34,GOBOARD5:5;
A60: W <= p`1 & p`1 <= E by A51,PSCOMP_1:71;
    now per cases by A20,A21,A27,A52,A54,GOBOARD1:21;
      suppose i = i2 & len G+1 = j2;
        hence thesis by A55,NAT_1:13;
      end;
      suppose i+1 = i2 & len G = j2;
        then
A61:    right_cell(f,m,G) = cell(G,i,len G-'1)
        by A1,A19,A20,A21,A27,A49,A53,GOBRD13:25;
A62:    cell(G,i,len G-'1) = {|[r,s]| : G*(i,1)`1 <= r & r <= G*(i+1,1)`1 &
        G*(1,len G-'1)`2 <= s & s <= G*(1,len G-'1+1)`2 }
        by A10,A22,A33,A34,A47,GOBRD11:32;
        then consider r,s such that
A63:    p = |[r,s]| and
A64:    G*(i,1)`1 <= r & r <= G*(i+1,1)`1 and
A65:    G*(1,len G-'1)`2 <= s & s <= G*(1,len G-'1+1)`2 by A51,A61;
A66:    p`1 = r & p`2 = s by A63,EUCLID:56;
        then p`2 = N by A56,A57,A58,A65,XXREAL_0:1;
        then p in LSeg(NW-corner C, NE-corner C) by A28,A60,GOBOARD7:9;
        then p in LSeg(NW-corner C, NE-corner C) /\ C by A51,XBOOLE_0:def 4;
        then (N-min C)`1 <= p`1 by PSCOMP_1:98;
        then (N-min C)`1 <= G*(i+1,1)`1 by A64,A66,XXREAL_0:2;
        then
A67:    N-min C in cell(G,i,width G-'1)
        by A8,A14,A15,A21,A27,A30,A35,A39,A41,A56,A58,A59,A62;
        N-min C <> G*(i,len G-'1) by A8,A22,A33,A34,A45,A46,SPRECT_3:25;
        hence thesis
        by A3,A4,A6,A7,A8,A14,A15,A21,A22,A27,A48,A67,Th31;
      end;
      suppose
A68:    i = i2+1 & len G = j2;
        then
A69:    right_cell(f,m,G) = cell(G,i2,len G)
        by A1,A19,A20,A21,A27,A49,A53,GOBRD13:27;
        i2 < len G by A22,A68,NAT_1:13;
        hence thesis by A50,A69,JORDAN8:18;
      end;
      suppose
A70:    i = i2 & len G = j2+1;
        then
A71:    j2 = len G-'1 by NAT_D:34;
        then
A72:    right_cell(f,m,G) = cell(G,i-'1,len G-'1)
        by A1,A19,A20,A21,A27,A49,A53,A70,GOBRD13:29;
        now
          assume
A73:      m = 1;
          1 <= i'+1 & i'+1<= len G by A3,NAT_1:13;
          then G*(i',len G)`2 = G*(1,len G)`2 & G*(i'+1,len G)`2 = G*
          (1,len G)`2 by A3,A8,A12,GOBOARD5:2;
          hence contradiction
          by A4,A5,A8,A21,A22,A27,A33,A34,A53,A70,A71,A73,GOBOARD5:5;
        end;
        then m > 1 by A19,XXREAL_0:1;
        then
A74:    m-'1 >= 1 by NAT_D:49;
A75:    m-'1+1 = m by A19,XREAL_1:237;
        m-'1 <= m by NAT_D:35;
        then
A76:    m-'1 <= len f by A19,XXREAL_0:2;
        consider i1',j1',i2',j2' being Element of NAT such that
A77:    [i1',j1'] in Indices G & f/.(m-'1) = G*(i1',j1') and
A78:    [i2',j2'] in Indices G & f/.m = G*(i2',j2') and
A79:    i1' = i2' & j1'+1 = j2' or i1'+1 = i2' & j1' = j2' or
        i1' = i2'+1 & j1' = j2' or i1' = i2' & j1' = j2'+1
        by A1,A19,A74,A75,JORDAN8:6;
A80:    1 <= i1' & i1' <= len G & 1 <= j1' &
        j1' <= len G by A10,A77,MATRIX_1:39;
        now per cases by A20,A21,A27,A78,A79,GOBOARD1:21;
          suppose
A81:        i1' = i & j1'+1 = len G;
            then j1' = len G-'1 by NAT_D:34;
            then left_cell(f,m-'1,G) = cell(G,i-'1,len G-'1)
            by A1,A19,A20,A21,A27,A74,A75,A77,A81,GOBRD13:22;
            hence contradiction by A2,A19,A50,A72,A74,A75;
          end;
          suppose
A82:        i1'+1 = i & j1' = len G;
            then i1' < i by NAT_1:13;
            then
A83:        (f/.(m-'1))`1 < (f/.m)`1 by A21,A22,A27,A77,A80,A82,GOBOARD5:4;
A84:        G*(i1',j)`2 = G*(1,j)`2 & G*(i,j)`2 = G*(1,j)`2
            by A22,A80,GOBOARD5:2;
            m-'1 in dom f by A74,A76,FINSEQ_3:27;
            then
A85:        f/.(m-'1) in L~f by A9,GOBOARD1:16,XXREAL_0:2;
            then W-bound L~f <= (f/.(m-'1))`1 &
            (f/.(m-'1))`1 <= E-bound L~f by PSCOMP_1:71;
            then f/.(m-'1) in LSeg(NW-corner L~f, NE-corner L~f)
            by A14,A15,A16,A21,A27,A31,A77,A82,A84,GOBOARD7:9;
            then f/.(m-'1) in LSeg(NW-corner L~f, NE-corner L~f) /\ L~f
            by A85,XBOOLE_0:def 4;
            hence contradiction by A14,A15,A83,PSCOMP_1:98;
          end;
          suppose i1' = i+1 & j1' = len G;
            then right_cell(f,m-'1,G) = cell(G,i,len G)
            by A1,A19,A20,A21,A27,A74,A75,A77,GOBRD13:27;
            then cell(G,i,len G) meets C by A2,A19,A74,A75;
            hence contradiction by A22,JORDAN8:18;
          end;
          suppose i1' = i & j1' = len G+1;
            then len G+1 <= len G+0 by A10,A77,MATRIX_1:39;
            hence contradiction by XREAL_1:8;
          end;
        end;
        hence thesis;
      end;
    end;
    hence thesis;
  end;
end;

definition
  let C be compact non vertical non horizontal non empty Subset of TOP-REAL 2;
  let n be Nat;
  assume
A1: C is connected;
  func Cage(C,n) -> clockwise_oriented
  (standard non constant special_circular_sequence) means
  :Def1:
  it is_sequence_on Gauge(C,n) & (ex i st 1 <= i & i+1 <= len Gauge(C,n) &
  it/.1 = Gauge(C,n)*(i,width Gauge(C,n)) &
  it/.2 = Gauge(C,n)*(i+1,width Gauge(C,n)) &
  N-min C in cell(Gauge(C,n),i,width Gauge(C,n)-'1) &
  N-min C <> Gauge(C,n)*(i,width Gauge(C,n)-'1)) &
  for k st 1 <= k & k+2 <= len it holds
  (front_left_cell(it,k,Gauge(C,n)) misses C &
  front_right_cell(it,k,Gauge(C,n)) misses C implies
  it turns_right k,Gauge(C,n)) & (front_left_cell(it,k,Gauge(C,n)) misses C &
  front_right_cell(it,k,Gauge(C,n)) meets C implies
  it goes_straight k,Gauge(C,n)) & (front_left_cell(it,k,Gauge(C,n)) meets C
  implies it turns_left k,Gauge(C,n));
  existence
  proof
    set G = Gauge(C,n);
    set W = W-bound C, E = E-bound C, S = S-bound C, N = N-bound C;
A2: len G = 2|^n+3 & len G = width G by JORDAN8:def 1;
    defpred P[Element of NAT,set,set] means ($1 = 0 implies
    ex i st 1 <= i & i+1 <= len G &
    N-min C in cell(G,i,width G-'1) & N-min C <> G*(i,width G-'1) &
    $3 = <*G*(i,width G)*>) & ($1 = 1 implies ex i st 1 <= i & i+1 <= len G &
    N-min C in cell(G,i,width G-'1) & N-min C <> G*(i,width G-'1) &
    $3 = <*G*(i,width G),G*(i+1,width G)*>) &
    ($1 > 1 & $2 is FinSequence of TOP-REAL 2 implies
    for f being FinSequence of TOP-REAL 2 st $2 = f holds (len f = $1 implies
    (f is_sequence_on G & right_cell(f,len f-'1,G) meets C implies
    (front_left_cell(f,(len f)-'1,G) misses C &
    front_right_cell(f,(len f)-'1,G) misses C implies ex i,j st
    f^<*G*(i,j)*> turns_right (len f)-'1,G & $3 = f^<*G*(i,j)*>) &
    (front_left_cell(f,(len f)-'1,G) misses C &
    front_right_cell(f,(len f)-'1,G) meets C implies ex i,j st
    f^<*G*(i,j)*> goes_straight (len f)-'1,G & $3 = f^<*G*(i,j)*>) &
    (front_left_cell(f,(len f)-'1,G) meets C implies ex i,j st
    f^<*G*(i,j)*> turns_left (len f)-'1,G & $3 = f^<*G*(i,j)*>)) &
    (not f is_sequence_on G or right_cell(f,len f-'1,G) misses C
    implies $3 = f^<*G*(1,1)*>)) & (len f <> $1 implies $3 = {})) &
    ($1 > 1 & $2 is not FinSequence of TOP-REAL 2 implies $3 = {});
A3: for k being Element of NAT, x being set ex y being set st P[k,x,y]
    proof
      let k be Element of NAT, x be set;
      consider m being Element of NAT such that
A4:   1 <= m & m+1 <= len G and
A5:   N-min C in cell(G,m,width G-'1) & N-min C <> G*(m,width G-'1) by Th30;
      per cases by NAT_1:26;
      suppose
A6:     k=0;
        take <*G*(m,width G)*>;
        thus thesis by A4,A5,A6;
      end;
      suppose
A7:     k = 1;
        take <*G*(m,width G),G*(m+1,width G)*>;
        thus thesis by A4,A5,A7;
      end;
      suppose that
A8:     k > 1 and
A9:     x is FinSequence of TOP-REAL 2;
        reconsider f = x as FinSequence of TOP-REAL 2 by A9;
        thus thesis
        proof per cases;
          suppose
A10:        len f = k;
            thus thesis
            proof per cases;
              suppose
A11:            f is_sequence_on G & right_cell(f,len f-'1,G) meets C;
A12:            1 <= (len f)-'1 by A8,A10,NAT_D:49;
A13:            (len f) -'1 +1 = len f by A8,A10,XREAL_1:237;
                then consider i1,j1,i2,j2 being Element of NAT such that
A14:            [i1,j1] in Indices G & f/.((len f) -'1) = G*(i1,j1) and
A15:            [i2,j2] in Indices G & f/.((len f) -'1+1) = G*(i2,j2) and
A16:            i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or

i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A11,A12,JORDAN8:6;
A17:            1

<= i1 & i1 <= len G & 1 <= j1 & j1 <= width G by A14,MATRIX_1:39;
A18:            1

<= i2 & i2 <= len G & 1 <= j2 & j2 <= width G by A15,MATRIX_1:39;
A19:            1 <= i2+1 & 1 <= j2+1 by NAT_1:12;
A20:            i2-'1 <= len G & j2-'1 <= width G by A18,NAT_D:44;
                (len f)-'1 <= len f by NAT_D:35;
                then
A21:            (len f)-'1 in dom f & (len f)-'1+1 in dom f
                by A8,A10,A12,A13,FINSEQ_3:27;
A22:            (len f)-'1+(1+1) = (len f)+1 by A13;
                thus thesis
                proof per cases;
                  suppose
A23:                front_left_cell(f,(len f)-'1,G) misses C &
                    front_right_cell(f,(len f)-'1,G) misses C;
                    thus thesis
                    proof per cases by A16;
                      suppose
A24:                    i1 = i2 & j1+1 = j2;
                        take f1 = f^<*G*(i2+1,j2)*>;
                        now
                          take i=i2+1 ,j=j2;
                          thus f1 turns_right (len f)-'1,G
                          proof
                            let i1',j1',i2',j2' be Element of NAT;
                            assume that
A25:                        [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A26:                        f1/.((len f)-'1) = G*(i1',j1') &
                            f1/.((len f)-'1+1) = G*(i2',j2');
                            f/.((len f)-'1) = G*(i1',j1') &

f/.((len f)-'1+1) = G*(i2',j2') by A21,A26,FINSEQ_4:83;
                            then
A27:                        i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                            by A14,A15,A25,GOBOARD1:21;
                            per cases by A16,A27;
                            case i1' = i2' & j1'+1 = j2';
                              now
                                assume i2+1 > len G;
                                then i2+1 <= (len G)+1 & (len G)+1 <= i2+1
                                by A18,NAT_1:13,XREAL_1:8;
                                then i2+1 = (len G)+1 by XXREAL_0:1;
                                then cell(G,len G,j1) meets C
                                by A11,A12,A13,A14,A15,A24,GOBRD13:23;
                                hence contradiction by A2,A17,JORDAN8:19;
                              end;

hence [i2'+1,j2'] in Indices G by A18,A19,A27,MATRIX_1:37;
                              thus thesis by A22,A27,FINSEQ_4:82;
                            end;
                            case i1'+1 = i2' & j1' = j2';
                              hence thesis by A24,A27;
                            end;
                            case i1' = i2'+1 & j1' = j2';
                              hence thesis by A24,A27;
                            end;
                            case i1' = i2' & j1' = j2'+1;
                              hence thesis by A24,A27;
                            end;
                          end;
                        end;
                        hence thesis by A8,A10,A11,A23;
                      end;
                      suppose
A28:                    i1+1 = i2 & j1 = j2;
                        take f1 = f^<*G*(i2,j2-'1)*>;
                        now
                          take i=i2,j=j2-'1;
                          thus f1 turns_right (len f)-'1,G
                          proof
                            let i1',j1',i2',j2' be Element of NAT;
                            assume that
A29:                        [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A30:                        f1/.((len f)-'1) = G*(i1',j1') &
                            f1/.((len f)-'1+1) = G*(i2',j2');
                            f/.((len f)-'1) = G*(i1',j1') &

f/.((len f)-'1+1) = G*(i2',j2') by A21,A30,FINSEQ_4:83;
                            then
A31:                        i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                            by A14,A15,A29,GOBOARD1:21;
                            per cases by A16,A31;
                            case i1' = i2' & j1'+1 = j2';
                              hence thesis by A28,A31;
                            end;
                            case i1'+1 = i2' & j1' = j2';
                              now
                                assume j2-'1 < 1;
                                then j2 <= 1 by NAT_1:14,NAT_D:36;
                                then j2 = 1 by A18,XXREAL_0:1;
                                then cell(G,i1,1-'1) meets C
                                by A11,A12,A13,A14,A15,A28,GOBRD13:25;
                                then cell(G,i1,0) meets C by XREAL_1:234;
                                hence contradiction by A17,JORDAN8:20;
                              end;

hence [i2',j2'-'1] in Indices G by A18,A20,A31,MATRIX_1:37;
                              thus thesis
                              by A22,A31,FINSEQ_4:82;
                            end;
                            case i1' = i2'+1 & j1' = j2';
                              hence thesis by A28,A31;
                            end;
                            case i1' = i2' & j1' = j2'+1;
                              hence thesis by A28,A31;
                            end;
                          end;
                        end;
                        hence thesis by A8,A10,A11,A23;
                      end;
                      suppose
A32:                    i1 = i2+1 & j1 = j2;
                        take f1 = f^<*G*(i2,j2+1)*>;
                        now
                          take i=i2,j=j2+1;
                          thus f1 turns_right (len f)-'1,G
                          proof
                            let i1',j1',i2',j2' be Element of NAT;
                            assume that
A33:                        [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A34:                        f1/.((len f)-'1) = G*(i1',j1') &
                            f1/.((len f)-'1+1) = G*(i2',j2');
                            f/.((len f)-'1) = G*(i1',j1') &

f/.((len f)-'1+1) = G*(i2',j2') by A21,A34,FINSEQ_4:83;
                            then
A35:                        i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                            by A14,A15,A33,GOBOARD1:21;
                            per cases by A16,A35;
                            case i1' = i2' & j1'+1 = j2';
                              hence thesis by A32,A35;
                            end;
                            case i1'+1 = i2' & j1' = j2';
                              hence thesis by A32,A35;
                            end;
                            case i1' = i2'+1 & j1' = j2';
                              now
                                assume j2+1 > len G;
                                then j2+1 <= (len G)+1 & (len G)+1 <= j2+1
                                by A2,A18,NAT_1:13,XREAL_1:8;
                                then j2+1 = (len G)+1 by XXREAL_0:1;
                                then cell(G,i2,len G) meets C
                                by A11,A12,A13,A14,A15,A32,GOBRD13:27;
                                hence contradiction by A18,JORDAN8:18;
                              end;

hence [i2',j2'+1] in Indices G by A2,A18,A19,A35,MATRIX_1:37;
                              thus thesis
                              by A22,A35,FINSEQ_4:82;
                            end;
                            case i1' = i2' & j1' = j2'+1;
                              hence thesis by A32,A35;
                            end;
                          end;
                        end;
                        hence thesis by A8,A10,A11,A23;
                      end;
                      suppose
A36:                    i1 = i2 & j1 = j2+1;
                        take f1 = f^<*G*(i2-'1,j2)*>;
                        now
                          take i=i2-'1 ,j=j2;
                          thus f1 turns_right (len f)-'1,G
                          proof
                            let i1',j1',i2',j2' be Element of NAT;
                            assume that
A37:                        [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A38:                        f1/.((len f)-'1) = G*(i1',j1') &
                            f1/.((len f)-'1+1) = G*(i2',j2');
                            f/.((len f)-'1) = G*(i1',j1') &

f/.((len f)-'1+1) = G*(i2',j2') by A21,A38,FINSEQ_4:83;
                            then
A39:                        i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                            by A14,A15,A37,GOBOARD1:21;
                            per cases by A16,A39;
                            case i1' = i2' & j1'+1 = j2';
                              hence thesis by A36,A39;
                            end;
                            case i1'+1 = i2' & j1' = j2';
                              hence thesis by A36,A39;
                            end;
                            case i1' = i2'+1 & j1' = j2';
                              hence thesis by A36,A39;
                            end;
                            case i1' = i2' & j1' = j2'+1;
                              now
                                assume i2-'1 < 1;
                                then i2 <= 1 by NAT_1:14,NAT_D:36;
                                then i2 = 1 by A18,XXREAL_0:1;
                                then cell(G,1-'1,j2) meets C
                                by A11,A12,A13,A14,A15,A36,GOBRD13:29;
                                then cell(G,0,j2) meets C by XREAL_1:234;
                                hence contradiction by A2,A18,JORDAN8:21;
                              end;

hence [i2'-'1,j2'] in Indices G by A18,A20,A39,MATRIX_1:37;
                              thus thesis
                              by A22,A39,FINSEQ_4:82;
                            end;
                          end;
                        end;
                        hence thesis by A8,A10,A11,A23;
                      end;
                    end;
                  end;
                  suppose
A40:                front_left_cell(f,(len f)-'1,G) misses C &
                    front_right_cell(f,(len f)-'1,G) meets C;
                    thus thesis
                    proof per cases by A16;
                      suppose
A41:                    i1 = i2 & j1+1 = j2;
                        take f1 = f^<*G*(i2,j2+1)*>;
                        now
                          take i=i2,j=j2+1;
                          thus f1 goes_straight (len f)-'1,G
                          proof
                            let i1',j1',i2',j2' be Element of NAT;
                            assume that
A42:                        [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A43:                        f1/.((len f)-'1) = G*(i1',j1') &
                            f1/.((len f)-'1+1) = G*(i2',j2');
                            f/.((len f)-'1) = G*(i1',j1') &

f/.((len f)-'1+1) = G*(i2',j2') by A21,A43,FINSEQ_4:83;
                            then
A44:                        i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                            by A14,A15,A42,GOBOARD1:21;
                            per cases by A16,A44;
                            case i1' = i2' & j1'+1 = j2';
                              now
                                assume j2+1 > len G;
                                then j2+1 <= (len G)+1 & (len G)+1 <= j2+1
                                by A2,A18,NAT_1:13,XREAL_1:8;
                                then j2+1 = (len G)+1 by XXREAL_0:1;
                                then cell(G,i1,len G) meets C
                                by A11,A12,A13,A14,A15,A40,A41,GOBRD13:36;
                                hence contradiction by A17,JORDAN8:18;
                              end;

hence [i2',j2'+1] in Indices G by A2,A18,A19,A44,MATRIX_1:37;
                              thus thesis
                              by A22,A44,FINSEQ_4:82;
                            end;
                            case i1'+1 = i2' & j1' = j2';
                              hence thesis by A41,A44;
                            end;
                            case i1' = i2'+1 & j1' = j2';
                              hence thesis by A41,A44;
                            end;
                            case i1' = i2' & j1' = j2'+1;
                              hence thesis by A41,A44;
                            end;
                          end;
                        end;
                        hence thesis by A8,A10,A11,A40;
                      end;
                      suppose
A45:                    i1+1 = i2 & j1 = j2;
                        take f1 = f^<*G*(i2+1,j2)*>;
                        now
                          take i=i2+1 ,j=j2;
                          thus f1 goes_straight (len f)-'1,G
                          proof
                            let i1',j1',i2',j2' be Element of NAT;
                            assume that
A46:                        [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A47:                        f1/.((len f)-'1) = G*(i1',j1') &
                            f1/.((len f)-'1+1) = G*(i2',j2');
                            f/.((len f)-'1) = G*(i1',j1') &

f/.((len f)-'1+1) = G*(i2',j2') by A21,A47,FINSEQ_4:83;
                            then
A48:                        i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                            by A14,A15,A46,GOBOARD1:21;
                            per cases by A16,A48;
                            case i1' = i2' & j1'+1 = j2';
                              hence thesis by A45,A48;
                            end;
                            case i1'+1 = i2' & j1' = j2';
                              now
                                assume i2+1 > len G;
                                then i2+1 <= (len G)+1 & (len G)+1 <= i2+1
                                by A18,NAT_1:13,XREAL_1:8;
                                then i2+1 = (len G)+1 by XXREAL_0:1;
                                then cell(G,len G,j1-'1) meets C
                                by A11,A12,A13,A14,A15,A40,A45,GOBRD13:38;

hence contradiction by A2,A17,JORDAN8:19,NAT_D:44;
                              end;

hence [i2'+1,j2'] in Indices G by A18,A19,A48,MATRIX_1:37;
                              thus thesis
                              by A22,A48,FINSEQ_4:82;
                            end;
                            case i1' = i2'+1 & j1' = j2';
                              hence thesis by A45,A48;
                            end;
                            case i1' = i2' & j1' = j2'+1;
                              hence thesis by A45,A48;
                            end;
                          end;
                        end;
                        hence thesis by A8,A10,A11,A40;
                      end;
                      suppose
A49:                    i1 = i2+1 & j1 = j2;
                        take f1 = f^<*G*(i2-'1,j2)*>;
                        now
                          take i=i2-'1 ,j=j2;
                          thus f1 goes_straight (len f)-'1,G
                          proof
                            let i1',j1',i2',j2' be Element of NAT;
                            assume that
A50:                        [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A51:                        f1/.((len f)-'1) = G*(i1',j1') &
                            f1/.((len f)-'1+1) = G*(i2',j2');
                            f/.((len f)-'1) = G*(i1',j1') &

f/.((len f)-'1+1) = G*(i2',j2') by A21,A51,FINSEQ_4:83;
                            then
A52:                        i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                            by A14,A15,A50,GOBOARD1:21;
                            per cases by A16,A52;
                            case i1' = i2' & j1'+1 = j2';
                              hence thesis by A49,A52;
                            end;
                            case i1'+1 = i2' & j1' = j2';
                              hence thesis by A49,A52;
                            end;
                            case i1' = i2'+1 & j1' = j2';
                              now
                                assume i2-'1 < 1;
                                then i2 <= 1 by NAT_1:14,NAT_D:36;
                                then i2 = 1 by A18,XXREAL_0:1;
                                then cell(G,1-'1,j1) meets C
                                by A11,A12,A13,A14,A15,A40,A49,GOBRD13:40;
                                then cell(G,0,j1) meets C by XREAL_1:234;
                                hence contradiction by A2,A17,JORDAN8:21;
                              end;

hence [i2'-'1,j2'] in Indices G by A18,A20,A52,MATRIX_1:37;
                              thus thesis
                              by A22,A52,FINSEQ_4:82;
                            end;
                            case i1' = i2' & j1' = j2'+1;
                              hence thesis by A49,A52;
                            end;
                          end;
                        end;
                        hence thesis by A8,A10,A11,A40;
                      end;
                      suppose
A53:                    i1 = i2 & j1 = j2+1;
                        take f1 = f^<*G*(i2,j2-'1)*>;
                        now
                          take i=i2,j=j2-'1;
                          thus f1 goes_straight (len f)-'1,G
                          proof
                            let i1',j1',i2',j2' be Element of NAT;
                            assume that
A54:                        [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A55:                        f1/.((len f)-'1) = G*(i1',j1') &
                            f1/.((len f)-'1+1) = G*(i2',j2');
                            f/.((len f)-'1) = G*(i1',j1') &

f/.((len f)-'1+1) = G*(i2',j2') by A21,A55,FINSEQ_4:83;
                            then
A56:                        i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                            by A14,A15,A54,GOBOARD1:21;
                            per cases by A16,A56;
                            case i1' = i2' & j1'+1 = j2';
                              hence thesis by A53,A56;
                            end;
                            case i1'+1 = i2' & j1' = j2';
                              hence thesis by A53,A56;
                            end;
                            case i1' = i2'+1 & j1' = j2';
                              hence thesis by A53,A56;
                            end;
                            case i1' = i2' & j1' = j2'+1;
                              now
                                assume j2-'1 < 1;
                                then j2 <= 1 by NAT_1:14,NAT_D:36;
                                then j2 = 1 by A18,XXREAL_0:1;
                                then cell(G,i1-'1,1-'1) meets C
                                by A11,A12,A13,A14,A15,A40,A53,GOBRD13:42;
                                then cell(G,i1-'1,0) meets C by XREAL_1:234;

hence contradiction by A17,JORDAN8:20,NAT_D:44;
                              end;

hence [i2',j2'-'1] in Indices G by A18,A20,A56,MATRIX_1:37;
                              thus thesis
                              by A22,A56,FINSEQ_4:82;
                            end;
                          end;
                        end;
                        hence thesis by A8,A10,A11,A40;
                      end;
                    end;
                  end;
                  suppose
A57:                front_left_cell(f,(len f)-'1,G) meets C;
                    thus thesis
                    proof per cases by A16;
                      suppose
A58:                    i1 = i2 & j1+1 = j2;
                        take f1 = f^<*G*(i2-'1,j2)*>;
                        now
                          take i=i2-'1 ,j=j2;
                          thus f1 turns_left (len f)-'1,G
                          proof
                            let i1',j1',i2',j2' be Element of NAT;
                            assume that
A59:                        [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A60:                        f1/.((len f)-'1) = G*(i1',j1') &
                            f1/.((len f)-'1+1) = G*(i2',j2');
                            f/.((len f)-'1) = G*(i1',j1') &

f/.((len f)-'1+1) = G*(i2',j2') by A21,A60,FINSEQ_4:83;
                            then
A61:                        i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                            by A14,A15,A59,GOBOARD1:21;
                            per cases by A16,A61;
                            case i1' = i2' & j1'+1 = j2';
                              now
                                assume i2-'1 < 1;
                                then i2 <= 1 by NAT_1:14,NAT_D:36;
                                then i2 = 1 by A18,XXREAL_0:1;
                                then cell(G,1-'1,j2) meets C
                                by A11,A12,A13,A14,A15,A57,A58,GOBRD13:35;
                                then cell(G,0,j2) meets C by XREAL_1:234;
                                hence contradiction by A2,A18,JORDAN8:21;
                              end;

hence [i2'-'1,j2'] in Indices G by A18,A20,A61,MATRIX_1:37;
                              thus thesis
                              by A22,A61,FINSEQ_4:82;
                            end;
                            case i1'+1 = i2' & j1' = j2';
                              hence thesis by A58,A61;
                            end;
                            case i1' = i2'+1 & j1' = j2';
                              hence thesis by A58,A61;
                            end;
                            case i1' = i2' & j1' = j2'+1;
                              hence thesis by A58,A61;
                            end;
                          end;
                        end;
                        hence thesis by A8,A10,A11,A57;
                      end;
                      suppose
A62:                    i1+1 = i2 & j1 = j2;
                        take f1 = f^<*G*(i2,j2+1)*>;
                        now
                          take i=i2,j=j2+1;
                          thus f1 turns_left (len f)-'1,G
                          proof
                            let i1',j1',i2',j2' be Element of NAT;
                            assume that
A63:                        [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A64:                        f1/.((len f)-'1) = G*(i1',j1') &
                            f1/.((len f)-'1+1) = G*(i2',j2');
                            f/.((len f)-'1) = G*(i1',j1') &

f/.((len f)-'1+1) = G*(i2',j2') by A21,A64,FINSEQ_4:83;
                            then
A65:                        i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                            by A14,A15,A63,GOBOARD1:21;
                            per cases by A16,A65;
                            case i1' = i2' & j1'+1 = j2';
                              hence thesis by A62,A65;
                            end;
                            case i1'+1 = i2' & j1' = j2';
                              now
                                assume j2+1 > len G;
                                then j2+1 <= (len G)+1 & (len G)+1 <= j2+1
                                by A2,A18,NAT_1:13,XREAL_1:8;
                                then j2+1 = (len G)+1 by XXREAL_0:1;
                                then cell(G,i2,len G) meets C
                                by A11,A12,A13,A14,A15,A57,A62,GOBRD13:37;
                                hence contradiction by A18,JORDAN8:18;
                              end;

hence [i2',j2'+1] in Indices G by A2,A18,A19,A65,MATRIX_1:37;
                              thus thesis
                              by A22,A65,FINSEQ_4:82;
                            end;
                            case i1' = i2'+1 & j1' = j2';
                              hence thesis by A62,A65;
                            end;
                            case i1' = i2' & j1' = j2'+1;
                              hence thesis by A62,A65;
                            end;
                          end;
                        end;
                        hence thesis by A8,A10,A11,A57;
                      end;
                      suppose
A66:                    i1 = i2+1 & j1 = j2;
                        take f1 = f^<*G*(i2,j2-'1)*>;
                        now
                          take i=i2,j=j2-'1;
                          thus f1 turns_left (len f)-'1,G
                          proof
                            let i1',j1',i2',j2' be Element of NAT;
                            assume that
A67:                        [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A68:                        f1/.((len f)-'1) = G*(i1',j1') &
                            f1/.((len f)-'1+1) = G*(i2',j2');
                            f/.((len f)-'1) = G*(i1',j1') &

f/.((len f)-'1+1) = G*(i2',j2') by A21,A68,FINSEQ_4:83;
                            then
A69:                        i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                            by A14,A15,A67,GOBOARD1:21;
                            per cases by A16,A69;
                            case i1' = i2' & j1'+1 = j2';
                              hence thesis by A66,A69;
                            end;
                            case i1'+1 = i2' & j1' = j2';
                              hence thesis by A66,A69;
                            end;
                            case i1' = i2'+1 & j1' = j2';
                              now
                                assume j2-'1 < 1;
                                then j2 <= 1 by NAT_1:14,NAT_D:36;
                                then j2 = 1 by A18,XXREAL_0:1;
                                then cell(G,i2-'1,1-'1) meets C
                                by A11,A12,A13,A14,A15,A57,A66,GOBRD13:39;
                                then cell(G,i2-'1,0) meets C by XREAL_1:234;

hence contradiction by A18,JORDAN8:20,NAT_D:44;
                              end;

hence [i2',j2'-'1] in Indices G by A18,A20,A69,MATRIX_1:37;
                              thus thesis
                              by A22,A69,FINSEQ_4:82;
                            end;
                            case i1' = i2' & j1' = j2'+1;
                              hence thesis by A66,A69;
                            end;
                          end;
                        end;
                        hence thesis by A8,A10,A11,A57;
                      end;
                      suppose
A70:                    i1 = i2 & j1 = j2+1;
                        take f1 = f^<*G*(i2+1,j2)*>;
                        now
                          take i=i2+1 ,j=j2;
                          thus f1 turns_left (len f)-'1,G
                          proof
                            let i1',j1',i2',j2' be Element of NAT;
                            assume that
A71:                        [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A72:                        f1/.((len f)-'1) = G*(i1',j1') &
                            f1/.((len f)-'1+1) = G*(i2',j2');
                            f/.((len f)-'1) = G*(i1',j1') &

f/.((len f)-'1+1) = G*(i2',j2') by A21,A72,FINSEQ_4:83;
                            then
A73:                        i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                            by A14,A15,A71,GOBOARD1:21;
                            per cases by A16,A73;
                            case i1' = i2' & j1'+1 = j2';
                              hence thesis by A70,A73;
                            end;
                            case i1'+1 = i2' & j1' = j2';
                              hence thesis by A70,A73;
                            end;
                            case i1' = i2'+1 & j1' = j2';
                              hence thesis by A70,A73;
                            end;
                            case i1' = i2' & j1' = j2'+1;
                              now
                                assume i2+1 > len G;
                                then i2+1 <= (len G)+1 & (len G)+1 <= i2+1
                                by A18,NAT_1:13,XREAL_1:8;
                                then i2+1 = (len G)+1 by XXREAL_0:1;
                                then cell(G,len G,j2-'1) meets C
                                by A11,A12,A13,A14,A15,A57,A70,GOBRD13:41;

hence contradiction by A2,A18,JORDAN8:19,NAT_D:44;
                              end;

hence [i2'+1,j2'] in Indices G by A18,A19,A73,MATRIX_1:37;
                              thus thesis
                              by A22,A73,FINSEQ_4:82;
                            end;
                          end;
                        end;
                        hence thesis by A8,A10,A11,A57;
                      end;
                    end;
                  end;
                end;
              end;
              suppose
A74:            not f is_sequence_on G or right_cell(f,len f-'1,G) misses C;
                take f^<*G*(1,1)*>;
                thus thesis by A8,A10,A74;
              end;
            end;
          end;
          suppose
A75:        len f <> k;
            take {};
            thus thesis by A8,A75;
          end;
        end;
      end;
      suppose
A76:    k > 1 & x is not FinSequence of TOP-REAL 2;
        take {};
        thus thesis by A76;
      end;
    end;
    consider F being Function such that
A77: dom F = NAT and
A78: F.0 = {} and
A79: for k being Element of NAT holds P[k,F.k,F.(k+1)] from RECDEF_1:sch 1
    (A3);
    defpred P[Element of NAT] means F.$1 is FinSequence of TOP-REAL 2;
A80: {} = <*>(the carrier of TOP-REAL 2);
    then
A81: P[0] by A78;
A82: for k st P[k] holds P[k+1]
    proof
      let k such that
A83:  F.k is FinSequence of TOP-REAL 2;
A84:  P[k,F.k,F.(k+1)] by A79;
      per cases by NAT_1:26;
      suppose k = 0;
        hence thesis by A84;
      end;
      suppose k = 1;
        hence thesis by A84;
      end;
      suppose
A85:    k > 1;
        thus thesis
        proof
          reconsider f = F.k as FinSequence of TOP-REAL 2 by A83;
          per cases;
          suppose
A86:        len f = k;
            thus thesis
            proof per cases;
              suppose f is_sequence_on G & right_cell(f,len f-'1,G) meets C;
                then (front_left_cell(f,(len f)-'1,G) misses C &
                front_right_cell(f,(len f)-'1,G) misses C implies ex i,j st
                f^<*G*(i,j)*> turns_right (len f)-'1,G &
                F.(k+1) = f^<*G*(i,j)*>) &
                (front_left_cell(f,(len f)-'1,G) misses C &
                front_right_cell(f,(len f)-'1,G) meets C implies ex i,j st
                f^<*G*(i,j)*> goes_straight (len f)-'1,G &
                F.(k+1) = f^<*G*(i,j)*>) &
                (front_left_cell(f,(len f)-'1,G) meets C implies ex i,j st
                f^<*G*(i,j)*> turns_left (len f)-'1,G &
                F.(k+1) = f^<*G*(i,j)*>) by A79,A85,A86;
                hence thesis;
              end;
              suppose
A87:            not f is_sequence_on G or right_cell(f,len f-'1,G) misses C;
                f^<*G*(1,1)*> is FinSequence of TOP-REAL 2;
                hence thesis by A79,A85,A86,A87;
              end;
            end;
          end;
          suppose len f <> k;
            hence thesis by A79,A80,A85;
          end;
        end;
      end;
    end;
A88: for k holds P[k] from NAT_1:sch 1(A81,A82);
    rng F c= (the carrier of TOP-REAL 2)*
    proof
      let y be set;
      assume y in rng F;
      then ex x being set st x in dom F & F.x = y by FUNCT_1:def 5;
      then y is FinSequence of TOP-REAL 2 by A77,A88;
      hence thesis by FINSEQ_1:def 11;
    end;
    then reconsider F as Function of NAT,(the carrier of TOP-REAL 2)*
    by A77,FUNCT_2:def 1,RELSET_1:11;
    defpred P[Element of NAT] means len(F.$1) = $1;
A89: P[0] by A78,CARD_1:47;
A90: for k st P[k] holds P[k+1]
    proof
      let k such that
A91:  len(F.k) = k;
A92:  P[k,F.k,F.(k+1)] by A79;
      per cases by NAT_1:26;
      suppose k = 0;
        hence thesis by A92,FINSEQ_1:56;
      end;
      suppose k = 1;
        hence thesis by A92,FINSEQ_1:61;
      end;
      suppose
A93:    k > 1;
        thus thesis
        proof per cases;
          suppose
            F.k is_sequence_on G & right_cell(F.k,len(F.k)-'1,G) meets C;
            then (front_left_cell(F.k,(len(F.k))-'1,G) misses C &
            front_right_cell(F.k,(len(F.k))-'1,G) misses C implies ex i,j st
            (F.k)^<*G*(i,j)*> turns_right (len(F.k))-'1,G &
            F.(k+1) = (F.k)^<*G*(i,j)*>) &
            (front_left_cell(F.k,(len(F.k))-'1,G) misses C &
            front_right_cell(F.k,(len(F.k))-'1,G) meets C implies ex i,j st
            (F.k)^<*G*(i,j)*> goes_straight (len(F.k))-'1,G &
            F.(k+1) = (F.k)^<*G*(i,j)*>) &
            (front_left_cell(F.k,(len(F.k))-'1,G) meets C implies ex i,j st
            (F.k)^<*G*(i,j)*> turns_left (len(F.k))-'1,G &
            F.(k+1) = (F.k)^<*G*(i,j)*>) by A79,A91,A93;
            hence thesis by A91,FINSEQ_2:19;
          end;
          suppose
            not F.k is_sequence_on G or right_cell(F.k,len(F.k)-'1,G) misses
            C;
            then F.(k+1) = (F.k)^<*G*(1,1)*> by A79,A91,A93;
            hence thesis by A91,FINSEQ_2:19;
          end;
        end;
      end;
    end;
A94: for k holds P[k] from NAT_1:sch 1(A89,A90);
    defpred P[Element of NAT] means F.$1 is_sequence_on G &
    for m st 1 <= m & m+1 <= len(F.$1)
    holds left_cell(F.$1,m,G) misses C & right_cell(F.$1,m,G) meets C;
A95: P[0]
    proof
      (for n st n in dom(F.0) ex i,j st [i,j] in Indices G &
      (F.0)/.n = G*(i,j)) & (for n st n in dom(F.0) & n+1 in dom(F.0) holds
      for m,k,i,j st [m,k] in Indices G & [i,j] in Indices G &
      (F.0)/.n = G*(m,k) & (F.0)/.(n+1) = G*(i,j) holds
      abs(m-i)+abs(k-j) = 1) by A78;
      hence F.0 is_sequence_on G by GOBOARD1:def 11;
      let m;
      assume 1 <= m & m+1 <= len(F.0);
      hence thesis by A78,CARD_1:47;
    end;
A96: now
      let k such that
A97:  F.k is_sequence_on G and
A98:  for m st 1 <= m & m+1 <= len(F.k) holds left_cell(F.k,m,G) misses C &
      right_cell(F.k,m,G) meets C and
A99:  k > 1;
      let i1,j1,i2,j2 be Element of NAT such that
A100: [i1,j1] in Indices G & (F.k)/.((len(F.k)) -'1) = G*(i1,j1) and
A101: [i2,j2] in Indices G & (F.k)/.len(F.k) = G*(i2,j2);
A102: len(F.k) = k by A94;
      then
A103: 1 <= (len(F.k))-'1 by A99,NAT_D:49;
A104: (len(F.k)) -'1 +1 = len(F.k) by A99,A102,XREAL_1:237;
      then
A105: left_cell(F.k,(len(F.k))-'1,G) misses C &
      right_cell(F.k,(len(F.k))-'1,G) meets C by A98,A103;
A106: 1 <= i1 & i1 <= len G & 1 <= j1 & j1 <= width G by A100,MATRIX_1:39;
A107: 1 <= i2 & i2 <= len G & 1 <= j2 & j2 <= width G by A101,MATRIX_1:39;
A108: 1 <= i2+1 & 1 <= j2+1 by NAT_1:12;
A109: i2-'1 <= len G & j2-'1 <= width G by A107,NAT_D:44;
      hereby
        assume
A110:   i1 = i2 & j1+1 = j2;
        now
          assume i2+1 > len G;

then i2+1 <= (len G)+1 & (len G)+1 <= i2+1 by A107,NAT_1:13,XREAL_1:8;
          then i2+1 = (len G)+1 by XXREAL_0:1;
          then cell(G,len G,j1) meets C
          by A97,A100,A101,A103,A104,A105,A110,GOBRD13:23;
          hence contradiction by A2,A106,JORDAN8:19;
        end;
        hence [i2+1,j2] in Indices G by A107,A108,MATRIX_1:37;
      end;
      hereby
        assume
A111:   i1+1 = i2 & j1 = j2;
        now
          assume j2-'1 < 1;
          then j2 <= 1 by NAT_1:14,NAT_D:36;
          then j2 = 1 by A107,XXREAL_0:1;
          then cell(G,i1,1-'1) meets C by A97,A100,A101,A103,A104,A105,A111,
GOBRD13:25;
          then cell(G,i1,0) meets C by XREAL_1:234;
          hence contradiction by A106,JORDAN8:20;
        end;
        hence [i2,j2-'1] in Indices G by A107,A109,MATRIX_1:37;
      end;
      hereby
        assume
A112:   i1 = i2+1 & j1 = j2;
        now
          assume j2+1 > len G;
          then j2+1 <= (len G)+1 & (len G)+1 <=
          j2+1 by A2,A107,NAT_1:13,XREAL_1:8;
          then j2+1 = (len G)+1 by XXREAL_0:1;
          then cell(G,i2,len G) meets C by A97,A100,A101,A103,A104,A105,A112,
GOBRD13:27;
          hence contradiction by A107,JORDAN8:18;
        end;
        hence [i2,j2+1] in Indices G by A2,A107,A108,MATRIX_1:37;
      end;
      hereby
        assume
A113:   i1 = i2 & j1 = j2+1;
        now
          assume i2-'1 < 1;
          then i2 <= 1 by NAT_1:14,NAT_D:36;
          then i2 = 1 by A107,XXREAL_0:1;
          then cell(G,1-'1,j2) meets C by A97,A100,A101,A103,A104,A105,A113,
GOBRD13:29;
          then cell(G,0,j2) meets C by XREAL_1:234;
          hence contradiction by A2,A107,JORDAN8:21;
        end;
        hence [i2-'1,j2] in Indices G by A107,A109,MATRIX_1:37;
      end;
      hereby
        assume that
A114:   front_right_cell(F.k,(len(F.k))-'1,G) meets C and
A115:   i1 = i2 & j1+1 = j2;
        now
          assume j2+1 > len G;
          then j2+1 <= (len G)+1 & (len G)+1 <=
          j2+1 by A2,A107,NAT_1:13,XREAL_1:8;
          then j2+1 = (len G)+1 by XXREAL_0:1;
          then cell(G,i1,len G) meets C by A97,A100,A101,A103,A104,A114,A115,
GOBRD13:36;
          hence contradiction by A106,JORDAN8:18;
        end;
        hence [i2,j2+1] in Indices G by A2,A107,A108,MATRIX_1:37;
      end;
      hereby
        assume that
A116:   front_right_cell(F.k,(len(F.k))-'1,G) meets C and
A117:   i1+1 = i2 & j1 = j2;
        now
          assume i2+1 > len G;

then i2+1 <= (len G)+1 & (len G)+1 <= i2+1 by A107,NAT_1:13,XREAL_1:8;
          then i2+1 = (len G)+1 by XXREAL_0:1;
          then cell(G,len G,j1-'1) meets C
          by A97,A100,A101,A103,A104,A116,A117,GOBRD13:38;
          hence contradiction by A2,A106,JORDAN8:19,NAT_D:44;
        end;
        hence [i2+1,j2] in Indices G by A107,A108,MATRIX_1:37;
      end;
      hereby
        assume that
A118:   front_right_cell(F.k,(len(F.k))-'1,G) meets C and
A119:   i1 = i2+1 & j1 = j2;
        now
          assume i2-'1 < 1;
          then i2 <= 1 by NAT_1:14,NAT_D:36;
          then i2 = 1 by A107,XXREAL_0:1;
          then cell(G,1-'1,j1) meets C by A97,A100,A101,A103,A104,A118,A119,
GOBRD13:40;
          then cell(G,0,j1) meets C by XREAL_1:234;
          hence contradiction by A2,A106,JORDAN8:21;
        end;
        hence [i2-'1,j2] in Indices G by A107,A109,MATRIX_1:37;
      end;
      hereby
        assume that
A120:   front_right_cell(F.k,(len(F.k))-'1,G) meets C and
A121:   i1 = i2 & j1 = j2+1;
        now
          assume j2-'1 < 1;
          then j2 <= 1 by NAT_1:14,NAT_D:36;
          then j2 = 1 by A107,XXREAL_0:1;
          then cell(G,i1-'1,1-'1) meets C
          by A97,A100,A101,A103,A104,A120,A121,GOBRD13:42;
          then cell(G,i1-'1,0) meets C by XREAL_1:234;
          hence contradiction by A106,JORDAN8:20,NAT_D:44;
        end;
        hence [i2,j2-'1] in Indices G by A107,A109,MATRIX_1:37;
      end;
      hereby
        assume that
A122:   front_left_cell(F.k,(len(F.k))-'1,G) meets C and
A123:   i1 = i2 & j1+1 = j2;
        now
          assume i2-'1 < 1;
          then i2 <= 1 by NAT_1:14,NAT_D:36;
          then i2 = 1 by A107,XXREAL_0:1;
          then cell(G,1-'1,j2) meets C by A97,A100,A101,A103,A104,A122,A123,
GOBRD13:35;
          then cell(G,0,j2) meets C by XREAL_1:234;
          hence contradiction by A2,A107,JORDAN8:21;
        end;
        hence [i2-'1,j2] in Indices G by A107,A109,MATRIX_1:37;
      end;
      hereby
        assume that
A124:   front_left_cell(F.k,(len(F.k))-'1,G) meets C and
A125:   i1+1 = i2 & j1 = j2;
        now
          assume j2+1 > len G;
          then j2+1 <= (len G)+1 & (len G)+1 <=
          j2+1 by A2,A107,NAT_1:13,XREAL_1:8;
          then j2+1 = (len G)+1 by XXREAL_0:1;
          then cell(G,i2,len G) meets C by A97,A100,A101,A103,A104,A124,A125,
GOBRD13:37;
          hence contradiction by A107,JORDAN8:18;
        end;
        hence [i2,j2+1] in Indices G by A2,A107,A108,MATRIX_1:37;
      end;
      hereby
        assume that
A126:   front_left_cell(F.k,(len(F.k))-'1,G) meets C and
A127:   i1 = i2+1 & j1 = j2;
        now
          assume j2-'1 < 1;
          then j2 <= 1 by NAT_1:14,NAT_D:36;
          then j2 = 1 by A107,XXREAL_0:1;
          then cell(G,i2-'1,1-'1) meets C
          by A97,A100,A101,A103,A104,A126,A127,GOBRD13:39;
          then cell(G,i2-'1,0) meets C by XREAL_1:234;
          hence contradiction by A107,JORDAN8:20,NAT_D:44;
        end;
        hence [i2,j2-'1] in Indices G by A107,A109,MATRIX_1:37;
      end;
      hereby
        assume that
A128:   front_left_cell(F.k,(len(F.k))-'1,G) meets C and
A129:   i1 = i2 & j1 = j2+1;
        now
          assume i2+1 > len G;

then i2+1 <= (len G)+1 & (len G)+1 <= i2+1 by A107,NAT_1:13,XREAL_1:8;
          then i2+1 = (len G)+1 by XXREAL_0:1;
          then cell(G,len G,j2-'1) meets C
          by A97,A100,A101,A103,A104,A128,A129,GOBRD13:41;
          hence contradiction by A2,A107,JORDAN8:19,NAT_D:44;
        end;
        hence [i2+1,j2] in Indices G by A107,A108,MATRIX_1:37;
      end;
    end;
A130: for k st P[k] holds P[k+1]
    proof
      let k such that
A131: F.k is_sequence_on G and
A132: for m st 1 <= m & m+1 <= len(F.k)
      holds left_cell(F.k,m,G) misses C & right_cell(F.k,m,G) meets C;
A133: len(F.k) = k by A94;
A134: len(F.(k+1)) = k+1 by A94;
A135: 1 <= len G by A2,NAT_1:12;
A136: 2|^n > 0 by NEWTON:102;
      per cases by NAT_1:26;
      suppose
A137:   k = 0;
        then consider i such that
A138:   1 <= i & i+1 <= len G and
        N-min C in cell(G,i,width G-'1) & N-min C <> G*(i,width G-'1) and
A139:   F.(k+1) = <*G*(i,width G)*> by A79;
        i < len G by A138,NAT_1:13;
        then
A140:   [i,len G] in Indices G by A2,A135,A138,MATRIX_1:37;
A141:   now
          let l;
          assume l in dom(F.(k+1));
          then 1 <= l & l <= 1 by A134,A137,FINSEQ_3:27;
          then l = 1 by XXREAL_0:1;
          hence ex i,j st [i,j] in Indices G & (F.(k+1))/.l = G*
          (i,j) by A2,A139,A140,FINSEQ_4:25;
        end;
        now
          let l;
          assume l in dom(F.(k+1)) & l+1 in dom(F.(k+1));
          then 1 <= l & l <= 1 & 1 <= l+1 & l+1 <= 1 by A134,A137,FINSEQ_3:27;
          then l = 1 & 1 = l+1 by XXREAL_0:1;

hence for i1,j1,i2,j2 st [i1,j1] in Indices G & [i2,j2] in Indices G &
          (F.(k+1))/.l = G*(i1,j1) & (F.(k+1))/.(l+1) = G*(i2,j2)
          holds abs(i1-i2)+abs(j1-j2) = 1;
        end;
        hence F.(k+1) is_sequence_on G by A141,GOBOARD1:def 11;
        let m;
        assume
A142:   1 <= m & m+1 <= len(F.(k+1));
        1 <= m+1 by NAT_1:12;
        then m+1 = 0+1 by A134,A137,A142,XXREAL_0:1;
        hence thesis by A142;
      end;
      suppose
A143:   k = 1;
        then consider i such that
A144:   1 <= i & i+1 <= len G and
A145:   N-min C in cell(G,i,width G-'1) & N-min C <> G*(i,width G-'1) and
A146:   F.(k+1) = <*G*(i,width G),G*(i+1,width G)*> by A79;
A147:   (F.(k+1))/.1 = G*(i,width G) & (F.(k+1))/.2 = G*(i+1,width G)
        by A146,FINSEQ_4:26;
A148:   i < len G & 1 <= i+1 & i+1 <= len G by A144,NAT_1:13;
        then
A149:   [i,len G] in Indices G & [i+1,len G] in Indices G
        by A2,A135,A144,MATRIX_1:37;
A150:   now
          let l;
          assume
A151:     l in dom(F.(k+1));
          then 1 <= l & l <= 2 by A134,A143,FINSEQ_3:27;
          then l = 0 or l = 1 or l = 2 by NAT_1:27;
          hence ex i,j st [i,j] in Indices G & (F.(k+1))/.l = G*(i,j)
          by A2,A147,A149,A151,FINSEQ_3:27;
        end;
        now
          let l;
          assume
A152:     l in dom(F.(k+1)) & l+1 in dom(F.(k+1));
          then 1 <= l & l <= 2 & 1 <= l+1 & l+1 <= 2 by A134,A143,FINSEQ_3:27;
          then
A153:     l = 0 or l = 1 or l = 2 by NAT_1:27;
          let i1,j1,i2,j2 such that
A154:     [i1,j1] in Indices G & [i2,j2] in Indices G &
          (F.(k+1))/.l = G*(i1,j1) & (F.(k+1))/.(l+1) = G*(i2,j2);
          i1 = i & j1 = len G & i2 = i+1 & j2 = len G
          by A2,A134,A143,A147,A149,A152,A153,A154,FINSEQ_3:27,GOBOARD1:21;
          then abs(i2-i1) = 1 & abs(j1-j2) = 0 by ABSVALUE:def 1;
          hence abs(i1-i2)+abs(j1-j2) = 1 by UNIFORM1:13;
        end;
        hence
A155:   F.(k+1) is_sequence_on G by A150,GOBOARD1:def 11;
        let m;
        assume
A156:   1 <= m & m+1 <= len(F.(k+1));
        then 1+1 <= m+1 by XREAL_1:8;
        then
A157:   m+1 = 1+1 by A134,A143,A156,XXREAL_0:1;
A158:   i < i+1 & i+1 < (i+1)+1 by NAT_1:13;
        then
A159:   left_cell(F.(k+1),m,G) = cell(G,i,len G)
        by A2,A147,A149,A155,A156,A157,GOBRD13:def 3;
        now
          assume left_cell(F.(k+1),m,G) meets C;
          then consider p being set such that
A160:     p in cell(G,i,len G) & p in C by A159,XBOOLE_0:3;
          reconsider p as Point of TOP-REAL 2 by A160;
          reconsider p as Element of TOP-REAL 2;
          cell(G,i,len G) = { |[r,s]|: G*(i,1)`1 <= r & r <= G*(i+1,1)`1 &
          G*(1,len G)`2 <= s } by A2,A144,A148,GOBRD11:31;
          then consider r,s such that
A161:     p = |[r,s]| and G*(i,1)`1 <= r & r <= G*(i+1,1)`1 and
A162:     G*(1,len G)`2 <= s by A160;
          [1,len G] in Indices G by A2,A135,MATRIX_1:37;
          then
A163:     G*
          (1,len G) = |[W+((E-W)/(2|^n))*(1-2),S+((N-S)/(2|^n))*((len G)-2)]|
          by JORDAN8:def 1;
A164:     ((N-S)/(2|^n))*((len G)-2)
          = ((N-S)/(2|^n))*(2|^n)+((N-S)/(2|^n))*1 by A2
            .= (N-S)+(N-S)/(2|^n) by A136,XCMPLX_1:88;
A165:     G*(1,len G)`2 = S+((N-S)/(2|^n))*((len G)-2) by A163,EUCLID:56;
          N > S by JORDAN8:12;
          then N-S > S-S by XREAL_1:11;
          then (N-S)/(2|^n) > 0 by A136,XREAL_1:141;
          then N+0 < N+(N-S)/(2|^n) by XREAL_1:8;
          then
A166:     N < s by A162,A164,A165,XXREAL_0:2;
          p`2 <= N by A160,PSCOMP_1:71;
          hence contradiction by A161,A166,EUCLID:56;
        end;
        hence left_cell(F.(k+1),m,G) misses C;
A167:   N-min C in C by SPRECT_1:13;
        N-min C in right_cell(F.(k+1),m,G)
        by A2,A145,A147,A149,A155,A156,A157,A158,GOBRD13:def 2;
        hence thesis by A167,XBOOLE_0:3;
      end;
      suppose
A168:   k > 1;
        then
A169:   F.k is non empty by A133,CARD_1:47;
A170:   1 <= (len(F.k))-'1 by A133,A168,NAT_D:49;
A171:   (len(F.k)) -'1 +1 = len(F.k) by A133,A168,XREAL_1:237;
        then consider i1,j1,i2,j2 being Element of NAT such that
A172:   [i1,j1] in Indices G & (F.k)/.((len(F.k)) -'1) = G*(i1,j1) and
A173:   [i2,j2] in Indices G & (F.k)/.len(F.k) = G*(i2,j2) and
        i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
        i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A131,A170,JORDAN8:6;
A174:   1 <= i2 & i2 <= len G & 1 <= j2 & j2 <= width G by A173,MATRIX_1:39;
        (len(F.k))-'1 <= len(F.k) by NAT_D:35;
        then
A175:   (len(F.k))-'1 in dom(F.k) & len(F.k) in dom(F.k)
        by A133,A168,A170,FINSEQ_3:27;
A176:   (len(F.k))-'1+(1+1) = (len(F.k))+1 by A171;
A177:   left_cell(F.k,(len(F.k))-'1,G) misses C &
        right_cell(F.k,(len(F.k))-'1,G) meets C by A132,A170,A171;
A178:   i1
        = i2 & j1+1 = j2 implies [i2+1,j2] in Indices G by A96,A131,A132,A168
,A172,A173;
A179:   i1
        +1 = i2 & j1 = j2 implies [i2,j2-'1] in Indices G by A96,A131,A132,A168
,A172,A173;
A180:   i1
        = i2+1 & j1 = j2 implies [i2,j2+1] in Indices G by A96,A131,A132,A168
,A172,A173;
A181:   i1
        = i2 & j1 = j2+1 implies [i2-'1,j2] in Indices G by A96,A131,A132,A168
,A172,A173;
A182:   front_right_cell(F.k,(len(F.k))-'1,G) meets C &

i1 = i2 & j1+1 = j2 implies [i2,j2+1] in Indices G by A96,A131,A132,A168,A172
,A173;
A183:   front_right_cell(F.k,(len(F.k))-'1,G) meets C &

i1+1 = i2 & j1 = j2 implies [i2+1,j2] in Indices G by A96,A131,A132,A168,A172
,A173;
A184:   front_right_cell(F.k,(len(F.k))-'1,G) meets C &

i1 = i2+1 & j1 = j2 implies [i2-'1,j2] in Indices G by A96,A131,A132,A168,A172
,A173;
A185:   front_right_cell(F.k,(len(F.k))-'1,G) meets C &

i1 = i2 & j1 = j2+1 implies [i2,j2-'1] in Indices G by A96,A131,A132,A168,A172
,A173;
A186:   front_left_cell(F.k,(len(F.k))-'1,G) meets C &

i1 = i2 & j1+1 = j2 implies [i2-'1,j2] in Indices G by A96,A131,A132,A168,A172
,A173;
A187:   front_left_cell(F.k,(len(F.k))-'1,G) meets C &

i1+1 = i2 & j1 = j2 implies [i2,j2+1] in Indices G by A96,A131,A132,A168,A172
,A173;
A188:   front_left_cell(F.k,(len(F.k))-'1,G) meets C &

i1 = i2+1 & j1 = j2 implies [i2,j2-'1] in Indices G by A96,A131,A132,A168,A172
,A173;
A189:   front_left_cell(F.k,(len(F.k))-'1,G) meets C &

i1 = i2 & j1 = j2+1 implies [i2+1,j2] in Indices G by A96,A131,A132,A168,A172
,A173; thus
A190:   F.(k+1) is_sequence_on G
        proof
          per cases;
          suppose front_left_cell(F.k,(len(F.k))-'1,G) misses C &
            front_right_cell(F.k,(len(F.k))-'1,G) misses C;
            then consider i,j such that
A191:       (F.k)^<*G*(i,j)*> turns_right (len(F.k))-'1,G and
A192:       F.(k+1) = (F.k)^<*G*(i,j)*> by A79,A131,A133,A168,A177;
            thus thesis
            proof
              set f = (F.k)^<*G*(i,j)*>;
A193:         f/.(len(F.k)-'1) = G*(i1,j1) & f/.len(F.k) = G*(i2,j2)
              by A172,A173,A175,FINSEQ_4:83;
A194:         f/.(len(F.k)+1) = G*(i,j) by FINSEQ_4:82;
              per cases by A171,A172,A173,A176,A191,A193,GOBRD13:def 6;
              suppose that
A195:           i1 = i2 & j1+1 = j2 and
A196:           f/.(len(F.k)+1) = G*(i2+1,j2);
                now
                  let i1',j1',i2',j2' be Element of NAT;
                  assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
                  (F.k)/.len(F.k) = G*(i1',j1') & G*(i2+1,j2) = G*(i2',j2');
                  then i2 = i1' & j2 = j1' & i2+1 = i2' & j2 = j2'
                  by A173,A178,A195,GOBOARD1:21;
                  then abs(i2'-i1') = 1 & abs(j2'-j1') = 0 by ABSVALUE:def 1;
                  hence abs(i2'-i1')+abs(j2'-j1') = 1;
                end;

hence thesis by A131,A169,A178,A192,A194,A195,A196,JORDAN8:9;
              end;
              suppose that
A197:           i1+1 = i2 & j1 = j2 and
A198:           f/.(len(F.k)+1) = G*(i2,j2-'1);
                now
                  let i1',j1',i2',j2' be Element of NAT;
                  assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
                  (F.k)/.len(F.k) = G*(i1',j1') & G*(i2,j2-'1) = G* (i2',j2');
                  then
A199:             i2 = i1' & j2 = j1' & i2 = i2' & j2-'1 = j2'
                  by A173,A179,A197,GOBOARD1:21;
                  then j1'-j2' = j2-(j2-1) by A174,XREAL_1:235;

then abs(i2'-i1') = 0 & abs(j1'-j2') = 1 by A199,ABSVALUE:def 1;
                  hence abs(i2'-i1')+abs(j2'-j1') = 1 by UNIFORM1:13;
                end;

hence thesis by A131,A169,A179,A192,A194,A197,A198,JORDAN8:9;
              end;
              suppose that
A200:           i1 = i2+1 & j1 = j2 and
A201:           f/.(len(F.k)+1) = G*(i2,j2+1);
                now
                  let i1',j1',i2',j2' be Element of NAT;
                  assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
                  (F.k)/.len(F.k) = G*(i1',j1') & G*(i2,j2+1) = G*(i2',j2');
                  then i2 = i1' & j2 = j1' & i2 = i2' & j2+1 = j2'
                  by A173,A180,A200,GOBOARD1:21;
                  then abs(i2'-i1') = 0 & abs(j2'-j1') = 1 by ABSVALUE:def 1;
                  hence abs(i2'-i1')+abs(j2'-j1') = 1;
                end;

hence thesis by A131,A169,A180,A192,A194,A200,A201,JORDAN8:9;
              end;
              suppose that
A202:           i1 = i2 & j1 = j2+1 and
A203:           f/.(len(F.k)+1) = G*(i2-'1,j2);
                now
                  let i1',j1',i2',j2' be Element of NAT;
                  assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
                  (F.k)/.len(F.k) = G*(i1',j1') & G*(i2-'1,j2) = G* (i2',j2');
                  then
A204:             i2 = i1' & j2 = j1' & i2-'1 = i2' & j2 = j2'
                  by A173,A181,A202,GOBOARD1:21;
                  then i1'-i2' = i2-(i2-1) by A174,XREAL_1:235;

then abs(j2'-j1') = 0 & abs(i1'-i2') = 1 by A204,ABSVALUE:def 1;
                  hence abs(i2'-i1')+abs(j2'-j1') = 1 by UNIFORM1:13;
                end;

hence thesis by A131,A169,A181,A192,A194,A202,A203,JORDAN8:9;
              end;
            end;
          end;
          suppose
A205:       front_left_cell(F.k,(len(F.k))-'1,G) misses C &
            front_right_cell(F.k,(len(F.k))-'1,G) meets C;
            then consider i,j such that
A206:       (F.k)^<*G*(i,j)*> goes_straight (len(F.k))-'1,G and
A207:       F.(k+1) = (F.k)^<*G*(i,j)*> by A79,A131,A133,A168,A177;
            thus thesis
            proof
              set f = (F.k)^<*G*(i,j)*>;
A208:         f/.(len(F.k)-'1) = G*(i1,j1) & f/.len(F.k) = G*(i2,j2)
              by A172,A173,A175,FINSEQ_4:83;
A209:         f/.(len(F.k)+1) = G*(i,j) by FINSEQ_4:82;
              per cases by A171,A172,A173,A176,A206,A208,GOBRD13:def 8;
              suppose that
A210:           i1 = i2 & j1+1 = j2 and
A211:           f/.(len(F.k)+1) = G*(i2,j2+1);
                now
                  let i1',j1',i2',j2' be Element of NAT;
                  assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
                  (F.k)/.len(F.k) = G*(i1',j1') & G*(i2,j2+1) = G*(i2',j2');
                  then i2 = i1' & j2 = j1' & i2 = i2' & j2+1 = j2'
                  by A173,A182,A205,A210,GOBOARD1:21;
                  then abs(i2'-i1') = 0 & abs(j2'-j1') = 1 by ABSVALUE:def 1;
                  hence abs(i2'-i1')+abs(j2'-j1') = 1;
                end;

hence thesis by A131,A169,A182,A205,A207,A209,A210,A211,JORDAN8:9;
              end;
              suppose that
A212:           i1+1 = i2 & j1 = j2 and
A213:           f/.(len(F.k)+1) = G*(i2+1,j2);
                now
                  let i1',j1',i2',j2' be Element of NAT;
                  assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
                  (F.k)/.len(F.k) = G*(i1',j1') & G*(i2+1,j2) = G* (i2',j2');
                  then i2 = i1' & j2 = j1' & i2+1 = i2' & j2 = j2'
                  by A173,A183,A205,A212,GOBOARD1:21;
                  then abs(i2'-i1') = 1 & abs(j2'-j1') = 0 by ABSVALUE:def 1;
                  hence abs(i2'-i1')+abs(j2'-j1') = 1;
                end;

hence thesis by A131,A169,A183,A205,A207,A209,A212,A213,JORDAN8:9;
              end;
              suppose that
A214:           i1 = i2+1 & j1 = j2 and
A215:           f/.(len(F.k)+1) = G*(i2-'1,j2);
                now
                  let i1',j1',i2',j2' be Element of NAT;
                  assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
                  (F.k)/.len(F.k) = G*(i1',j1') & G*(i2-'1,j2) = G*(i2',j2');
                  then
A216:             i2 = i1' & j2 = j1' & i2-'1 = i2' & j2 = j2'
                  by A173,A184,A205,A214,GOBOARD1:21;
                  then i1'-i2' = i2-(i2-1) by A174,XREAL_1:235;

then abs(j2'-j1') = 0 & abs(i1'-i2') = 1 by A216,ABSVALUE:def 1;
                  hence abs(i2'-i1')+abs(j2'-j1') = 1 by UNIFORM1:13;
                end;

hence thesis by A131,A169,A184,A205,A207,A209,A214,A215,JORDAN8:9;
              end;
              suppose that
A217:           i1 = i2 & j1 = j2+1 and
A218:           f/.(len(F.k)+1) = G*(i2,j2-'1);
                now
                  let i1',j1',i2',j2' be Element of NAT;
                  assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
                  (F.k)/.len(F.k) = G*(i1',j1') & G*(i2,j2-'1) = G* (i2',j2');
                  then
A219:             i2 = i1' & j2 = j1' & i2 = i2' & j2-'1 = j2'
                  by A173,A185,A205,A217,GOBOARD1:21;
                  then j1'-j2' = j2-(j2-1) by A174,XREAL_1:235;

then abs(i2'-i1') = 0 & abs(j1'-j2') = 1 by A219,ABSVALUE:def 1;
                  hence abs(i2'-i1')+abs(j2'-j1') = 1 by UNIFORM1:13;
                end;

hence thesis by A131,A169,A185,A205,A207,A209,A217,A218,JORDAN8:9;
              end;
            end;
          end;
          suppose
A220:       front_left_cell(F.k,(len(F.k))-'1,G) meets C;
            then consider i,j such that
A221:       (F.k)^<*G*(i,j)*> turns_left (len(F.k))-'1,G and
A222:       F.(k+1) = (F.k)^<*G*(i,j)*> by A79,A131,A133,A168,A177;
            thus thesis
            proof
              set f = (F.k)^<*G*(i,j)*>;
A223:         f/.(len(F.k)-'1) = G*(i1,j1) & f/.len(F.k) = G*(i2,j2)
              by A172,A173,A175,FINSEQ_4:83;
A224:         f/.(len(F.k)+1) = G*(i,j) by FINSEQ_4:82;
              per cases by A171,A172,A173,A176,A221,A223,GOBRD13:def 7;
              suppose that
A225:           i1 = i2 & j1+1 = j2 and
A226:           f/.(len(F.k)+1) = G*(i2-'1,j2);
                now
                  let i1',j1',i2',j2' be Element of NAT;
                  assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
                  (F.k)/.len(F.k) = G*(i1',j1') & G*(i2-'1,j2) = G*(i2',j2');
                  then
A227:             i2 = i1' & j2 = j1' & i2-'1 = i2' & j2 = j2'
                  by A173,A186,A220,A225,GOBOARD1:21;
                  then i1'-i2' = i2-(i2-1) by A174,XREAL_1:235;

then abs(j2'-j1') = 0 & abs(i1'-i2') = 1 by A227,ABSVALUE:def 1;
                  hence abs(i2'-i1')+abs(j2'-j1') = 1 by UNIFORM1:13;
                end;

hence thesis by A131,A169,A186,A220,A222,A224,A225,A226,JORDAN8:9;
              end;
              suppose that
A228:           i1+1 = i2 & j1 = j2 and
A229:           f/.(len(F.k)+1) = G*(i2,j2+1);
                now
                  let i1',j1',i2',j2' be Element of NAT;
                  assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
                  (F.k)/.len(F.k) = G*(i1',j1') & G*(i2,j2+1) = G* (i2',j2');
                  then i2 = i1' & j2 = j1' & i2 = i2' & j2+1 = j2'
                  by A173,A187,A220,A228,GOBOARD1:21;
                  then abs(i2'-i1') = 0 & abs(j2'-j1') = 1 by ABSVALUE:def 1;
                  hence abs(i2'-i1')+abs(j2'-j1') = 1;
                end;

hence thesis by A131,A169,A187,A220,A222,A224,A228,A229,JORDAN8:9;
              end;
              suppose that
A230:           i1 = i2+1 & j1 = j2 and
A231:           f/.(len(F.k)+1) = G*(i2,j2-'1);
                now
                  let i1',j1',i2',j2' be Element of NAT;
                  assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
                  (F.k)/.len(F.k) = G*(i1',j1') & G*(i2,j2-'1) = G*(i2',j2');
                  then
A232:             i2 = i1' & j2 = j1' & i2 = i2' & j2-'1 = j2'
                  by A173,A188,A220,A230,GOBOARD1:21;
                  then j1'-j2' = j2-(j2-1) by A174,XREAL_1:235;

then abs(i2'-i1') = 0 & abs(j1'-j2') = 1 by A232,ABSVALUE:def 1;
                  hence abs(i2'-i1')+abs(j2'-j1') = 1 by UNIFORM1:13;
                end;

hence thesis by A131,A169,A188,A220,A222,A224,A230,A231,JORDAN8:9;
              end;
              suppose that
A233:           i1 = i2 & j1 = j2+1 and
A234:           f/.(len(F.k)+1) = G*(i2+1,j2);
                now
                  let i1',j1',i2',j2' be Element of NAT;
                  assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
                  (F.k)/.len(F.k) = G*(i1',j1') & G*(i2+1,j2) = G* (i2',j2');
                  then i2 = i1' & j2 = j1' & i2+1 = i2' & j2 = j2'
                  by A173,A189,A220,A233,GOBOARD1:21;
                  then abs(i2'-i1') = 1 & abs(j2'-j1') = 0 by ABSVALUE:def 1;
                  hence abs(i2'-i1')+abs(j2'-j1') = 1;
                end;

hence thesis by A131,A169,A189,A220,A222,A224,A233,A234,JORDAN8:9;
              end;
            end;
          end;
        end;
        let m such that
A235:   1 <= m & m+1 <= len(F.(k+1));
        now
          per cases;
          suppose
A236:       m+1 = len(F.(k+1));
A237:       (i2-'1)+1 = i2 by A174,XREAL_1:237;
A238:       (j2-'1)+1 = j2 by A174,XREAL_1:237;
            thus thesis
            proof per cases;
              suppose
A239:           front_left_cell(F.k,(len(F.k))-'1,G) misses C &
                front_right_cell(F.k,(len(F.k))-'1,G) misses C;
                then consider i,j such that
A240:           (F.k)^<*G*(i,j)*> turns_right (len(F.k))-'1,G and
A241:           F.(k+1) = (F.k)^<*G*(i,j)*> by A79,A131,A133,A168,A177;
A242:           (F.(k+1))/.(len(F.k)-'1) = G*(i1,j1) & (F.(k+1))/.len(F.k) = G*
                (i2,j2) by A172,A173,A175,A241,FINSEQ_4:83;
                now per cases by A171,A172,A173,A176,A240,A241,A242,
GOBRD13:def 6;
                  suppose that
A243:               i1 = i2 & j1+1 = j2 and
A244:               (F.(k+1))/.((len(F.k))+1) = G*(i2+1,j2);
                    front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i1,j2)
                    by A131,A170,A171,A172,A173,A243,GOBRD13:36;
                    hence left_cell(F.(k+1),m,G) misses C
                    by A133,A134,A173,A178,A190,A235,A236,A239,A242,A243,A244,
GOBRD13:24;
                    j2-'1 = j1 & cell(G,i1,j1) meets C

by A131,A170,A171,A172,A173,A177,A243,GOBRD13:23,NAT_D:34;
                    hence right_cell(F.(k+1),m,G) meets C

by A133,A134,A173,A178,A190,A235,A236,A242,A243,A244,GOBRD13:25;
                  end;
                  suppose that
A245:               i1+1 = i2 & j1 = j2 and
A246:               (F.(k+1))/.((len(F.k))+1) = G*(i2,j2-'1);
                    front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i2,j2-'1)
                    by A131,A170,A171,A172,A173,A245,GOBRD13:38;
                    hence left_cell(F.(k+1),m,G) misses C

by A133,A134,A173,A179,A190,A235,A236,A238,A239,A242,A245,A246,GOBRD13:28;
                    i2-'1 = i1 & cell(G,i1,j1-'1) meets C

by A131,A170,A171,A172,A173,A177,A245,GOBRD13:25,NAT_D:34;
                    hence right_cell(F.(k+1),m,G) meets C
                    by A133,A134,A173,A179,A190,A235,A236,A238,A242,A245,A246,
GOBRD13:29;
                  end;
                  suppose that
A247:               i1 = i2+1 & j1 = j2 and
A248:               (F.(k+1))/.((len(F.k))+1) = G*(i2,j2+1);
                    front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i2-'1,j2)
                    by A131,A170,A171,A172,A173,A247,GOBRD13:40;
                    hence left_cell(F.(k+1),m,G) misses C
                    by A133,A134,A173,A180,A190,A235,A236,A239,A242,A247,A248,
GOBRD13:22;
                    cell(G,i2,j2) meets C
                    by A131,A170,A171,A172,A173,A177,A247,GOBRD13:27;
                    hence right_cell(F.(k+1),m,G) meets C

by A133,A134,A173,A180,A190,A235,A236,A242,A247,A248,GOBRD13:23;
                  end;
                  suppose that
A249:               i1 = i2 & j1 = j2+1 and
A250:               (F.(k+1))/.((len(F.k))+1) = G*(i2-'1,j2);
                    front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i2-'1,j2-'1
                    ) by A131,A170,A171,A172,A173,A249,GOBRD13:42;
                    hence left_cell(F.(k+1),m,G) misses C

by A133,A134,A173,A181,A190,A235,A236,A237,A239,A242,A249,A250,GOBRD13:26;
                    cell(G,i2-'1,j2) meets C
                    by A131,A170,A171,A172,A173,A177,A249,GOBRD13:29;
                    hence right_cell(F.(k+1),m,G) meets C
                    by A133,A134,A173,A181,A190,A235,A236,A237,A242,A249,A250,
GOBRD13:27;
                  end;
                end;
                hence thesis;
              end;
              suppose
A251:           front_left_cell(F.k,(len(F.k))-'1,G) misses C &
                front_right_cell(F.k,(len(F.k))-'1,G) meets C;
                then consider i,j such that
A252:           (F.k)^<*G*(i,j)*> goes_straight (len(F.k))-'1,G and
A253:           F.(k+1) = (F.k)^<*G*(i,j)*> by A79,A131,A133,A168,A177;
A254:           (F.(k+1))/.(len(F.k)-'1) = G*(i1,j1) & (F.(k+1))/.len(F.k)
                = G*(i2,j2) by A172,A173,A175,A253,FINSEQ_4:83;
                now per cases by A171,A172,A173,A176,A252,A253,A254,
GOBRD13:def 8;
                  suppose that
A255:               i1 = i2 & j1+1 = j2 and
A256:               (F.(k+1))/.(len(F.k)+1) = G*(i2,j2+1);
                    front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i1-'1,j2)
                    by A131,A170,A171,A172,A173,A255,GOBRD13:35;
                    hence left_cell(F.(k+1),m,G) misses C
                    by A133,A134,A173,A182,A190,A235,A236,A251,A254,A255,A256,
GOBRD13:22;
                    front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i1,j2)
                    by A131,A170,A171,A172,A173,A255,GOBRD13:36;
                    hence right_cell(F.(k+1),m,G) meets C
                    by A133,A134,A173,A182,A190,A235,A236,A251,A254,A255,A256,
GOBRD13:23;
                  end;
                  suppose that
A257:               i1+1 = i2 & j1 = j2 and
A258:               (F.(k+1))/.(len(F.k)+1) = G*(i2+1,j2);
                    front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i2,j2)
                    by A131,A170,A171,A172,A173,A257,GOBRD13:37;
                    hence left_cell(F.(k+1),m,G) misses C
                    by A133,A134,A173,A183,A190,A235,A236,A251,A254,A257,A258,
GOBRD13:24;
                    front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i2,j2-'1)
                    by A131,A170,A171,A172,A173,A257,GOBRD13:38;
                    hence right_cell(F.(k+1),m,G) meets C
                    by A133,A134,A173,A183,A190,A235,A236,A251,A254,A257,A258,
GOBRD13:25;
                  end;
                  suppose that
A259:               i1 = i2+1 & j1 = j2 and
A260:               (F.(k+1))/.(len(F.k)+1) = G*(i2-'1,j2);
                    front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i2-'1,j2-'1)
                    by A131,A170,A171,A172,A173,A259,GOBRD13:39;
                    hence left_cell(F.(k+1),m,G) misses C

by A133,A134,A173,A184,A190,A235,A236,A237,A251,A254,A259,A260,GOBRD13:26;
                    front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i2-'1,j2)
                    by A131,A170,A171,A172,A173,A259,GOBRD13:40;
                    hence right_cell(F.(k+1),m,G) meets C

by A133,A134,A173,A184,A190,A235,A236,A237,A251,A254,A259,A260,GOBRD13:27;
                  end;
                  suppose that
A261:               i1 = i2 & j1 = j2+1 and
A262:               (F.(k+1))/.(len(F.k)+1) = G*(i2,j2-'1);
                    front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i2,j2-'1)
                    by A131,A170,A171,A172,A173,A261,GOBRD13:41;
                    hence left_cell(F.(k+1),m,G) misses C

by A133,A134,A173,A185,A190,A235,A236,A238,A251,A254,A261,A262,GOBRD13:28;
                    front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i2-'1,j2-'1
                    ) by A131,A170,A171,A172,A173,A261,GOBRD13:42;
                    hence right_cell(F.(k+1),m,G) meets C

by A133,A134,A173,A185,A190,A235,A236,A238,A251,A254,A261,A262,GOBRD13:29;
                  end;
                end;
                hence thesis;
              end;
              suppose
A263:           front_left_cell(F.k,(len(F.k))-'1,G) meets C;
                then consider i,j such that
A264:           (F.k)^<*G*(i,j)*> turns_left (len(F.k))-'1,G and
A265:           F.(k+1) = (F.k)^<*G*(i,j)*> by A79,A131,A133,A168,A177;
A266:           (F.(k+1))/.(len(F.k)-'1) = G*(i1,j1) & (F.(k+1))/.len(F.k) = G*
                (i2,j2) by A172,A173,A175,A265,FINSEQ_4:83;
                now per cases by A171,A172,A173,A176,A264,A265,A266,
GOBRD13:def 7;
                  suppose that
A267:               i1 = i2 & j1+1 = j2 and
A268:               (F.(k+1))/.(len(F.k)+1) = G*(i2-'1,j2);
                    j2-'1 = j1 & cell(G,i1-'1,j1) misses C

by A131,A170,A171,A172,A173,A177,A267,GOBRD13:22,NAT_D:34;
                    hence left_cell(F.(k+1),m,G) misses C

by A133,A134,A173,A186,A190,A235,A236,A237,A263,A266,A267,A268,GOBRD13:26;
                    front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i1-'1,j2)
                    by A131,A170,A171,A172,A173,A267,GOBRD13:35;
                    hence right_cell(F.(k+1),m,G) meets C

by A133,A134,A173,A186,A190,A235,A236,A237,A263,A266,A267,A268,GOBRD13:27;
                  end;
                  suppose that
A269:               i1+1 = i2 & j1 = j2 and
A270:               (F.(k+1))/.(len(F.k)+1) = G*(i2,j2+1);
                    i2-'1 = i1 & cell(G,i1,j1) misses C

by A131,A170,A171,A172,A173,A177,A269,GOBRD13:24,NAT_D:34;
                    hence left_cell(F.(k+1),m,G) misses C
                    by A133,A134,A173,A187,A190,A235,A236,A263,A266,A269,A270,
GOBRD13:22;
                    front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i2,j2)
                    by A131,A170,A171,A172,A173,A269,GOBRD13:37;
                    hence right_cell(F.(k+1),m,G) meets C
                    by A133,A134,A173,A187,A190,A235,A236,A263,A266,A269,A270,
GOBRD13:23;
                  end;
                  suppose that
A271:               i1 = i2+1 & j1 = j2 and
A272:               (F.(k+1))/.(len(F.k)+1) = G*(i2,j2-'1);
                    cell(G,i2,j2-'1) misses C
                    by A131,A170,A171,A172,A173,A177,A271,GOBRD13:26;
                    hence left_cell(F.(k+1),m,G) misses C

by A133,A134,A173,A188,A190,A235,A236,A238,A263,A266,A271,A272,GOBRD13:28;
                    front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i2-'1,j2-'1)
                    by A131,A170,A171,A172,A173,A271,GOBRD13:39;
                    hence right_cell(F.(k+1),m,G) meets C

by A133,A134,A173,A188,A190,A235,A236,A238,A263,A266,A271,A272,GOBRD13:29;
                  end;
                  suppose that
A273:               i1 = i2 & j1 = j2+1 and
A274:               (F.(k+1))/.(len(F.k)+1) = G*(i2+1,j2);

cell(G,i2,j2) misses C by A131,A170,A171,A172,A173,A177,A273,GOBRD13:28;
                    hence left_cell(F.(k+1),m,G) misses C
                    by A133,A134,A173,A189,A190,A235,A236,A263,A266,A273,A274,
GOBRD13:24;
                    front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i2,j2-'1)
                    by A131,A170,A171,A172,A173,A273,GOBRD13:41;
                    hence right_cell(F.(k+1),m,G) meets C
                    by A133,A134,A173,A189,A190,A235,A236,A263,A266,A273,A274,
GOBRD13:25;
                  end;
                end;
                hence thesis;
              end;
            end;
          end;
          suppose m+1 <> len(F.(k+1));
            then m+1 < len(F.(k+1)) by A235,XXREAL_0:1;
            then
A275:       m+1 <= len(F.k)by A133,A134,NAT_1:13;
            then consider i1,j1,i2,j2 being Element of NAT such that
A276:       [i1,j1] in Indices G & (F.k)/.m = G*(i1,j1) and
A277:       [i2,j2] in Indices G & (F.k)/.(m+1) = G*(i2,j2) and
A278:       i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
            i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A131,A235,JORDAN8:6;
A279:       1 <= m+1 by NAT_1:12;
            m <= len(F.k) by A275,NAT_1:13;
            then
A280:       m in dom(F.k) & m+1 in dom(F.k) by A235,A275,A279,FINSEQ_3:27;
A281:       left_cell(F.k,m,G) misses C & right_cell(F.k,m,G) meets C
            by A132,A235,A275;
            now per cases;
              suppose front_left_cell(F.k,(len(F.k))-'1,G) misses C &
                front_right_cell(F.k,(len(F.k))-'1,G) misses C;
                then consider i,j such that
                (F.k)^<*G*(i,j)*> turns_right (len(F.k))-'1,G and
A282:           F.(k+1) = (F.k)^<*G*(i,j)*> by A79,A131,A133,A168,A177;
                take i,j;
                thus F.(k+1) = (F.k)^<*G*(i,j)*> by A282;
              end;
              suppose front_left_cell(F.k,(len(F.k))-'1,G) misses C &
                front_right_cell(F.k,(len(F.k))-'1,G) meets C;
                then consider i,j such that
                (F.k)^<*G*(i,j)*> goes_straight (len(F.k))-'1,G and
A283:           F.(k+1) = (F.k)^<*G*(i,j)*> by A79,A131,A133,A168,A177;
                take i,j;
                thus F.(k+1) = (F.k)^<*G*(i,j)*> by A283;
              end;
              suppose front_left_cell(F.k,(len(F.k))-'1,G) meets C;
                then consider i,j such that
                (F.k)^<*G*(i,j)*> turns_left (len(F.k))-'1,G and
A284:           F.(k+1) = (F.k)^<*G*(i,j)*> by A79,A131,A133,A168,A177;
                take i,j;
                thus F.(k+1) = (F.k)^<*G*(i,j)*> by A284;
              end;
            end;
            then consider i,j such that
A285:       F.(k+1) = (F.k)^<*G*(i,j)*>;
A286:       (F.(k+1))/.m = G*(i1,j1) & (F.(k+1))/.(m+1) = G*(i2,j2)
            by A276,A277,A280,A285,FINSEQ_4:83;
            now per cases by A278;
              suppose
A287:           i1 = i2 & j1+1 = j2;
                then left_cell(F.k,m,G) = cell(G,i1-'1,j1) &
                right_cell(F.k,m,G) = cell(G,i1,j1)
                by A131,A235,A275,A276,A277,GOBRD13:22,23;

hence thesis by A190,A235,A276,A277,A281,A286,A287,GOBRD13:22,23;
              end;
              suppose
A288:           i1+1 = i2 & j1 = j2;
                then left_cell(F.k,m,G) = cell(G,i1,j1) &
                right_cell(F.k,m,G) = cell(G,i1,j1-'1)
                by A131,A235,A275,A276,A277,GOBRD13:24,25;

hence thesis by A190,A235,A276,A277,A281,A286,A288,GOBRD13:24,25;
              end;
              suppose
A289:           i1 = i2+1 & j1 = j2;
                then left_cell(F.k,m,G) = cell(G,i2,j2-'1) &
                right_cell(F.k,m,G) = cell(G,i2,j2)
                by A131,A235,A275,A276,A277,GOBRD13:26,27;

hence thesis by A190,A235,A276,A277,A281,A286,A289,GOBRD13:26,27;
              end;
              suppose
A290:           i1 = i2 & j1 = j2+1;
                then left_cell(F.k,m,G) = cell(G,i2,j2) &
                right_cell(F.k,m,G) = cell(G,i1-'1,j2)
                by A131,A235,A275,A276,A277,GOBRD13:28,29;

hence thesis by A190,A235,A276,A277,A281,A286,A290,GOBRD13:28,29;
              end;
            end;
            hence thesis;
          end;
        end;
        hence thesis;
      end;
    end;
A291: for k holds P[k] from NAT_1:sch 1(A95,A130);
A292: for k,i1,i2,j1,j2 st k > 1 &
    [i1,j1] in Indices G & (F.k)/.((len(F.k)) -'1) = G*(i1,j1) &
    [i2,j2] in Indices G & (F.k)/.len(F.k) = G*(i2,j2) holds
    (front_left_cell(F.k,(len(F.k))-'1,G) misses C &
    front_right_cell(F.k,(len(F.k))-'1,G) misses C
    implies F.(k+1) turns_right (len(F.k))-'1,G &
    (i1 = i2 & j1+1 = j2 implies [i2+1,j2] in Indices G &
    F.(k+1) = (F.k)^<*G*(i2+1,j2)*>) &
    (i1+1 = i2 & j1 = j2 implies [i2,j2-'1] in Indices G &
    F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>) &
    (i1 = i2+1 & j1 = j2 implies [i2,j2+1] in Indices G &
    F.(k+1) = (F.k)^<*G*(i2,j2+1)*>)&
    (i1 = i2 & j1 = j2+1 implies [i2-'1,j2] in Indices G &
    F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>)) &
    (front_left_cell(F.k,(len(F.k))-'1,G) misses C &
    front_right_cell(F.k,(len(F.k))-'1,G) meets C
    implies F.(k+1) goes_straight (len(F.k))-'1,G &
    (i1 = i2 & j1+1 = j2 implies [i2,j2+1] in Indices G &
    F.(k+1) = (F.k)^<*G*(i2,j2+1)*>) &
    (i1+1 = i2 & j1 = j2 implies [i2+1,j2] in Indices G &
    F.(k+1) = (F.k)^<*G*(i2+1,j2)*>) &
    (i1 = i2+1 & j1 = j2 implies [i2-'1,j2] in Indices G &
    F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>)&
    (i1 = i2 & j1 = j2+1 implies [i2,j2-'1] in Indices G &
    F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>)) &
    (front_left_cell(F.k,(len(F.k))-'1,G) meets C
    implies F.(k+1) turns_left (len(F.k))-'1,G &
    (i1 = i2 & j1+1 = j2 implies [i2-'1,j2] in Indices G &
    F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>) &
    (i1+1 = i2 & j1 = j2 implies [i2,j2+1] in Indices G &
    F.(k+1) = (F.k)^<*G*(i2,j2+1)*>) &
    (i1 = i2+1 & j1 = j2 implies [i2,j2-'1] in Indices G &
    F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>)&
    (i1 = i2 & j1 = j2+1 implies [i2+1,j2] in Indices G &
    F.(k+1) = (F.k)^<*G*(i2+1,j2)*>))
    proof
      let k,i1,i2,j1,j2 such that
A293: k > 1 and
A294: [i1,j1] in Indices G & (F.k)/.((len(F.k)) -'1) = G*(i1,j1) and
A295: [i2,j2] in Indices G & (F.k)/.len(F.k) = G*(i2,j2);
A296: (len(F.k))-'1 <= len(F.k) by NAT_D:35;
A297: F.k is_sequence_on G by A291;
A298: len(F.k) = k by A94;
      then
A299: 1 <= (len(F.k))-'1 by A293,NAT_D:49;
A300: (len(F.k)) -'1 +1 = len(F.k) by A293,A298,XREAL_1:237;
      then
A301: right_cell(F.k,(len(F.k))-'1,G) meets C by A291,A299;
A302: (len(F.k))-'1 in dom(F.k) & len(F.k) in dom(F.k)
      by A293,A296,A298,A299,FINSEQ_3:27;
A303: (len(F.k))-'1+(1+1) = (len(F.k))+1 by A300;
A304: i1+1 > i1 & i2+1 > i2 & j1+1 > j1 & j2+1 > j2 by NAT_1:13;
      hereby
        assume front_left_cell(F.k,(len(F.k))-'1,G) misses C &
        front_right_cell(F.k,(len(F.k))-'1,G) misses C;
        then consider i,j such that
A305:   (F.k)^<*G*(i,j)*> turns_right (len(F.k))-'1,G and
A306:   F.(k+1) = (F.k)^<*G*(i,j)*> by A79,A293,A297,A298,A301;
A307:   (F.(k+1))/.(len(F.k)-'1) = G*(i1,j1) & (F.(k+1))/.len(F.k) = G*
        (i2,j2) by A294,A295,A302,A306,FINSEQ_4:83;
A308:   (F.(k+1))/.(len(F.k)+1) = G*(i,j) by A306,FINSEQ_4:82; thus
        F.(k+1) turns_right (len(F.k))-'1,G by A305,A306;
        thus i1 = i2 & j1+1 = j2 implies [i2+1,j2] in Indices G &
        F.(k+1) = (F.k)^<*G*(i2+1,j2)*>
        by A294,A295,A300,A303,A304,A305,A306,A307,A308,GOBRD13:def 6;
        thus i1+1 = i2 & j1 = j2 implies [i2,j2-'1] in Indices G &
        F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>
        by A294,A295,A300,A303,A304,A305,A306,A307,A308,GOBRD13:def 6;
        thus i1 = i2+1 & j1 = j2 implies [i2,j2+1] in Indices G &
        F.(k+1) = (F.k)^<*G*(i2,j2+1)*>
        by A294,A295,A300,A303,A304,A305,A306,A307,A308,GOBRD13:def 6;
        thus i1 = i2 & j1 = j2+1 implies [i2-'1,j2] in Indices G &
        F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>
        by A294,A295,A300,A303,A304,A305,A306,A307,A308,GOBRD13:def 6;
      end;
      hereby
        assume front_left_cell(F.k,(len(F.k))-'1,G) misses C &
        front_right_cell(F.k,(len(F.k))-'1,G) meets C;
        then consider i,j such that
A309:   (F.k)^<*G*(i,j)*> goes_straight (len(F.k))-'1,G and
A310:   F.(k+1) = (F.k)^<*G*(i,j)*> by A79,A293,A297,A298,A301;
A311:   (F.(k+1))/.(len(F.k)-'1) = G*(i1,j1) & (F.(k+1))/.len(F.k) = G*
        (i2,j2) by A294,A295,A302,A310,FINSEQ_4:83;
A312:   (F.(k+1))/.(len(F.k)+1) = G*(i,j) by A310,FINSEQ_4:82; thus
        F.(k+1) goes_straight (len(F.k))-'1,G by A309,A310;
        thus i1 = i2 & j1+1 = j2 implies
        [i2,j2+1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2+1)*>
        by A294,A295,A300,A303,A304,A309,A310,A311,A312,GOBRD13:def 8;
        thus i1+1 = i2 & j1 = j2 implies
        [i2+1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2+1,j2)*>
        by A294,A295,A300,A303,A304,A309,A310,A311,A312,GOBRD13:def 8;
        thus i1 = i2+1 & j1 = j2 implies
        [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>
        by A294,A295,A300,A303,A304,A309,A310,A311,A312,GOBRD13:def 8;
        thus i1 = i2 & j1 = j2+1 implies
        [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>
        by A294,A295,A300,A303,A304,A309,A310,A311,A312,GOBRD13:def 8;
      end;
      assume front_left_cell(F.k,(len(F.k))-'1,G) meets C;
      then consider i,j such that
A313: (F.k)^<*G*(i,j)*> turns_left (len(F.k))-'1,G and
A314: F.(k+1) = (F.k)^<*G*(i,j)*> by A79,A293,A297,A298,A301;
A315: (F.(k+1))/.(len(F.k)-'1) = G*(i1,j1) & (F.(k+1))/.len(F.k) = G* (i2,j2)
      by A294,A295,A302,A314,FINSEQ_4:83;
A316: (F.(k+1))/.(len(F.k)+1) = G*(i,j) by A314,FINSEQ_4:82; thus
      F.(k+1) turns_left (len(F.k))-'1,G by A313,A314;
      thus i1 = i2 & j1+1 = j2 implies
      [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>
      by A294,A295,A300,A303,A304,A313,A314,A315,A316,GOBRD13:def 7;
      thus i1+1 = i2 & j1 = j2 implies
      [i2,j2+1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2+1)*>
      by A294,A295,A300,A303,A304,A313,A314,A315,A316,GOBRD13:def 7;
      thus i1 = i2+1 & j1 = j2 implies
      [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>
      by A294,A295,A300,A303,A304,A313,A314,A315,A316,GOBRD13:def 7;
      thus thesis
      by A294,A295,A300,A303,A304,A313,A314,A315,A316,GOBRD13:def 7;
    end;
A317: for k holds ex i,j st [i,j] in Indices G & F.(k+1) = (F.k)^<*G*(i,j)*>
    proof
      let k;
A318: F.k is_sequence_on G by A291;
A319: len(F.k) = k by A94;
A320: len G = 2|^n+3 & len G = width G by JORDAN8:def 1;
      len G >= 4 by JORDAN8:13;
      then
A321: 1 < len G by XXREAL_0:2;
      per cases by XXREAL_0:1;
      suppose k < 1;
        then
A322:   k = 0 by NAT_1:14;
        consider i such that
A323:   1 <= i & i+1 <= len G and
        N-min C in cell(G,i,width G-'1) & N-min C <> G*(i,width G-'1) and
A324:   F.(0+1) = <*G*(i,width G)*> by A79;
        take i, j = width G;
        i < len G by A323,NAT_1:13;
        hence [i,j] in Indices G by A320,A321,A323,MATRIX_1:37;
        thus thesis by A78,A322,A324,FINSEQ_1:47;
      end;
      suppose
A325:   k = 1;
        consider i such that
A326:   1 <= i & i+1 <= len G and
A327:   N-min C in cell(G,i,width G-'1) & N-min C <> G*(i,width G-'1) and
A328:   F.(0+1) = <*G*(i,width G)*> by A79;
        consider i' being Element of NAT such that
A329:   1 <= i' & i'+1 <= len G &
        N-min C in cell(G,i',width G-'1) & N-min C <> G*(i',width G-'1) and
A330:   F.(1+1) = <*G*(i',width G),G*(i'+1,width G)*> by A79;
A331:   i = i' by A326,A327,A329,Th31;
        take i+1,j = width G;
        1 <= i+1 & i+1 <= len G by A326,NAT_1:13;
        hence [i+1,j] in Indices G by A320,A321,MATRIX_1:37;
        thus thesis by A325,A328,A330,A331,FINSEQ_1:def 9;
      end;
      suppose
A332:   k > 1;
        then
A333:   1 <= (len(F.k))-'1 by A319,NAT_D:49;
        (len(F.k)) -'1 +1 = len(F.k) by A319,A332,XREAL_1:237;
        then consider i1,j1,i2,j2 being Element of NAT such that
A334:   [i1,j1] in Indices G & (F.k)/.((len(F.k)) -'1) = G*(i1,j1) and
A335:   [i2,j2] in Indices G & (F.k)/.len(F.k) = G*(i2,j2) and
A336:   i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
        i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A318,A333,JORDAN8:6;
        now per cases;
          suppose
A337:       front_left_cell(F.k,(len(F.k))-'1,G) misses C &
            front_right_cell(F.k,(len(F.k))-'1,G) misses C;
            now per cases by A336;
              suppose i1 = i2 & j1+1 = j2;
                then [i2+1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2+1,j2)*>
                by A292,A332,A334,A335,A337;
                hence thesis;
              end;
              suppose i1+1 = i2 & j1 = j2;
                then [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2-'1)
                *> by A292,A332,A334,A335,A337;
                hence thesis;
              end;
              suppose i1 = i2+1 & j1 = j2;
                then [i2,j2+1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2+1)*>
                by A292,A332,A334,A335,A337;
                hence thesis;
              end;
              suppose i1 = i2 & j1 = j2+1;
                then [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2-'1,j2)
                *> by A292,A332,A334,A335,A337;
                hence thesis;
              end;
            end;
            hence thesis;
          end;
          suppose
A338:       front_left_cell(F.k,(len(F.k))-'1,G) misses C &
            front_right_cell(F.k,(len(F.k))-'1,G) meets C;
            now per cases by A336;
              suppose i1 = i2 & j1+1 = j2;
                then [i2,j2+1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2+1)*>
                by A292,A332,A334,A335,A338;
                hence thesis;
              end;
              suppose i1+1 = i2 & j1 = j2;
                then [i2+1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2+1,j2)*>
                by A292,A332,A334,A335,A338;
                hence thesis;
              end;
              suppose i1 = i2+1 & j1 = j2;
                then [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2-'1,j2)
                *> by A292,A332,A334,A335,A338;
                hence thesis;
              end;
              suppose i1 = i2 & j1 = j2+1;
                then [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2-'1)
                *> by A292,A332,A334,A335,A338;
                hence thesis;
              end;
            end;
            hence thesis;
          end;
          suppose
A339:       front_left_cell(F.k,(len(F.k))-'1,G) meets C;
            now per cases by A336;
              suppose i1 = i2 & j1+1 = j2;
                then [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2-'1,j2)
                *> by A292,A332,A334,A335,A339;
                hence thesis;
              end;
              suppose i1+1 = i2 & j1 = j2;
                then [i2,j2+1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2+1)*>
                by A292,A332,A334,A335,A339;
                hence thesis;
              end;
              suppose i1 = i2+1 & j1 = j2;
                then [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2-'1)
                *> by A292,A332,A334,A335,A339;
                hence thesis;
              end;
              suppose i1 = i2 & j1 = j2+1;
                then [i2+1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2+1,j2)*>
                by A292,A332,A334,A335,A339;
                hence thesis;
              end;
            end;
            hence thesis;
          end;
        end;
        hence thesis;
      end;
    end;
    defpred P[Element of NAT] means for m st m <= $1 holds (F.$1)|m = F.m;
A340: P[0]
    proof
      let m;
      assume
A341: m <= 0;
      then (F.0)|0 = (F.0)|m;
      hence thesis by A78,A341;
    end;
A342: for k st P[k] holds P[k+1]
    proof
      let k such that
A343: for m st m <= k holds (F.k)|m = F.m;
      let m such that
A344: m <= k+1;
      per cases by A344,XXREAL_0:1;
      suppose m < k+1;
        then
A345:   m <= k by NAT_1:13;
A346:   len(F.k) = k by A94;
        consider i,j such that [i,j] in Indices G and
A347:   F.(k+1) = F.k^<*G*(i,j)*> by A317;
        (F.(k+1))|m = (F.k)|m by A345,A346,A347,FINSEQ_5:25;
        hence thesis by A343,A345;
      end;
      suppose
A348:   m = k+1;
        len(F.(k+1)) = k+1 by A94;
        hence thesis by A348,FINSEQ_1:79;
      end;
    end;
A349: for k holds P[k] from NAT_1:sch 1(A340,A342);
A350: for k st k > 1 holds (front_left_cell(F.k,k-'1,Gauge(C,n)) misses C &
    front_right_cell(F.k,k-'1,Gauge(C,n)) misses C
    implies F.(k+1) turns_right k-'1,Gauge(C,n)) &
    (front_left_cell(F.k,k-'1,Gauge(C,n)) misses C &
    front_right_cell(F.k,k-'1,Gauge(C,n)) meets C
    implies F.(k+1) goes_straight k-'1,Gauge(C,n)) &
    (front_left_cell(F.k,k-'1,Gauge(C,n)) meets C
    implies F.(k+1) turns_left k-'1,Gauge(C,n))
    proof
      let k such that
A351: k > 1;
A352: F.k is_sequence_on G by A291;
A353: len(F.k) = k by A94;
      then
A354: 1 <= (len(F.k))-'1 by A351,NAT_D:49;
      (len(F.k)) -'1 +1 = len(F.k) by A351,A353,XREAL_1:237;
      then ex i1,j1,i2,j2 being Element of NAT st
      [i1,j1] in Indices G & (F.k)/.((len(F.k)) -'1) = G*(i1,j1) &
      [i2,j2] in Indices G & (F.k)/.len(F.k) = G*(i2,j2) &
      (i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
      i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1) by A352,A354,JORDAN8:6;
      hence thesis by A292,A351,A353;
    end;
    defpred P[Element of NAT] means F.$1 is unfolded;
    len(F.0) = 0 by A78,CARD_1:47;
    then
A355: P[0] by SPPOL_2:27;
A356: for k st P[k] holds P[k+1]
    proof
      let k such that
A357: F.k is unfolded;
A358: F.k is_sequence_on G by A291;
      per cases;
      suppose k <= 1;
        then k+1 <= 1+1 by XREAL_1:8;
        then len(F.(k+1)) <= 2 by A94;
        hence thesis by SPPOL_2:27;
      end;
      suppose
A359:   k > 1;
        set m = k-'1;
A360:   1 <= m by A359,NAT_D:49;
A361:   m+1 = k by A359,XREAL_1:237;
A362:   len(F.k) = k by A94;
        then consider i1,j1,i2,j2 being Element of NAT such that
A363:   [i1,j1] in Indices G & (F.k)/.m = G*(i1,j1) and
A364:   [i2,j2] in Indices G & (F.k)/.len(F.k) = G*(i2,j2) and
A365:   i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
        i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A358,A360,A361,JORDAN8:6;
A366:   1 <= i1 & i1 <= len G & 1 <= j1 & j1 <= width G by A363,MATRIX_1:39;
A367:   1 <= i2 & i2 <= len G & 1 <= j2 & j2 <= width G by A364,MATRIX_1:39;
        then
A368:   (i2-'1)+1 = i2 by XREAL_1:237;
A369:   (j2-'1)+1 = j2 by A367,XREAL_1:237;
A370:   LSeg(F.k,m) = LSeg(G*(i1,j1),G*(i2,j2)) by A360,A361,A362,A363,A364,
TOPREAL1:def 5;
        now per cases;
          suppose
A371:       front_left_cell(F.k,(len(F.k))-'1,G) misses C &
            front_right_cell(F.k,(len(F.k))-'1,G) misses C;
            now per cases by A365;
              suppose
A372:           i1 = i2 & j1+1 = j2;
                then
A373:           [i2+1,j2] in Indices G & F.(k+1) = (F.k)^ <*G*(i2+1,j2)*>
                by A292,A359,A362,A363,A364,A371;
                then i2+1 <= len G by MATRIX_1:39;
                then LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G*
                (i2+1,j2)) = {(F.k)/.len(F.k)}
                by A364,A366,A367,A370,A372,GOBOARD7:17;
                hence thesis by A357,A361,A362,A373,SPPOL_2:31;
              end;
              suppose
A374:           i1+1 = i2 & j1 = j2;
                then
A375:           [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^ <*G*(i2,j2-'1)*>
                by A292,A359,A362,A363,A364,A371;
                then 1 <= j2-'1 &
                LSeg((F.k)/.len(F.k),G*(i2,j2-'1))=LSeg(G*(i2,j2-'1),
                (F.k)/.len(F.k)) by MATRIX_1:39;
                then LSeg(F.k,m) /\
                LSeg((F.k)/.len(F.k),G*(i2,j2-'1)) = {(F.k)/.len(F.k)}
                by A364,A366,A367,A369,A370,A374,GOBOARD7:18;
                hence thesis by A357,A361,A362,A375,SPPOL_2:31;
              end;
              suppose
A376:           i1 = i2+1 & j1 = j2;
                then
A377:           [i2,j2+1] in Indices G & F.(k+1) = (F.k)^ <*G*(i2,j2+1)*>
                by A292,A359,A362,A363,A364,A371;
                then j2+1 <= width G by MATRIX_1:39;
                then LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G*
                (i2,j2+1)) = {(F.k)/.len(F.k)}
                by A364,A366,A367,A370,A376,GOBOARD7:19;
                hence thesis by A357,A361,A362,A377,SPPOL_2:31;
              end;
              suppose
A378:           i1 = i2 & j1 = j2+1;
                then
A379:           [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^ <*G*(i2-'1,j2)*>
                by A292,A359,A362,A363,A364,A371;
                then 1 <= i2-'1 by MATRIX_1:39;
                then LSeg(F.k,m) /\
                LSeg((F.k)/.len(F.k),G*(i2-'1,j2)) = {(F.k)/.len(F.k)}
                by A364,A366,A367,A368,A370,A378,GOBOARD7:20;
                hence thesis by A357,A361,A362,A379,SPPOL_2:31;
              end;
            end;
            hence thesis;
          end;
          suppose
A380:       front_left_cell(F.k,(len(F.k))-'1,G) misses C &
            front_right_cell(F.k,(len(F.k))-'1,G) meets C;
            now per cases by A365;
              suppose
A381:           i1 = i2 & j1+1 = j2;
                then
A382:           [i2,j2+1] in Indices G & F.(k+1) = (F.k)^ <*G*(i2,j2+1)*>
                by A292,A359,A362,A363,A364,A380;
                then 1 <= j2+1 & j2+1 <= width G & j2+1 = j1+(1+1)
                by A381,MATRIX_1:39;
                then LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G*
                (i2,j2+1)) = {(F.k)/.len(F.k)}
                by A364,A366,A370,A381,GOBOARD7:15;
                hence thesis by A357,A361,A362,A382,SPPOL_2:31;
              end;
              suppose
A383:           i1+1 = i2 & j1 = j2;
                then
A384:           [i2+1,j2] in Indices G & F.(k+1) = (F.k)^ <*G*(i2+1,j2)*>
                by A292,A359,A362,A363,A364,A380;
                then 1 <= i2+1 & i2+1 <= len G & i2+1 = i1+(1+1)
                by A383,MATRIX_1:39;
                then LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G*
                (i2+1,j2)) = {(F.k)/.len(F.k)}
                by A364,A366,A370,A383,GOBOARD7:16;
                hence thesis by A357,A361,A362,A384,SPPOL_2:31;
              end;
              suppose
A385:           i1 = i2+1 & j1 = j2;
                then
A386:           [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^ <*G*(i2-'1,j2)*>
                by A292,A359,A362,A363,A364,A380;
                then 1 <= i2-'1 & i2-'1+1+1 = i2-'1+(1+1) by MATRIX_1:39;
                then LSeg(F.k,m) /\
                LSeg((F.k)/.len(F.k),G*(i2-'1,j2)) = {(F.k)/.len(F.k)}
                by A364,A366,A368,A370,A385,GOBOARD7:16;
                hence thesis by A357,A361,A362,A386,SPPOL_2:31;
              end;
              suppose
A387:           i1 = i2 & j1 = j2+1;
                then
A388:           [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^ <*G*(i2,j2-'1)*>
                by A292,A359,A362,A363,A364,A380;
                then 1 <= j2-'1 & j2-'1+1+1 = j2-'1+(1+1) by MATRIX_1:39;
                then LSeg(F.k,m) /\
                LSeg((F.k)/.len(F.k),G*(i2,j2-'1)) = {(F.k)/.len(F.k)}
                by A364,A366,A369,A370,A387,GOBOARD7:15;
                hence thesis by A357,A361,A362,A388,SPPOL_2:31;
              end;
            end;
            hence thesis;
          end;
          suppose
A389:       front_left_cell(F.k,(len(F.k))-'1,G) meets C;
            now per cases by A365;
              suppose
A390:           i1 = i2 & j1+1 = j2;
                then
A391:           [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^ <*G*(i2-'1,j2)*>
                by A292,A359,A362,A363,A364,A389;
                then 1 <= i2-'1 &
                LSeg((F.k)/.len(F.k),G*(i2-'1,j2))=LSeg(G*(i2-'1,j2),
                (F.k)/.len(F.k)) by MATRIX_1:39;
                then LSeg(F.k,m) /\
                LSeg((F.k)/.len(F.k),G*(i2-'1,j2)) = {(F.k)/.len(F.k)}
                by A364,A366,A367,A368,A370,A390,GOBOARD7:18;
                hence thesis by A357,A361,A362,A391,SPPOL_2:31;
              end;
              suppose
A392:           i1+1 = i2 & j1 = j2;
                then
A393:           [i2,j2+1] in Indices G & F.(k+1) = (F.k)^ <*G*(i2,j2+1)*>
                by A292,A359,A362,A363,A364,A389;
                then 1 <= j2+1 & j2+1 <= width G by MATRIX_1:39;
                then LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G*
                (i2,j2+1)) = {(F.k)/.len(F.k)}
                by A364,A366,A367,A370,A392,GOBOARD7:20;
                hence thesis by A357,A361,A362,A393,SPPOL_2:31;
              end;
              suppose
A394:           i1 = i2+1 & j1 = j2;
                then
A395:           [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^ <*G*(i2,j2-'1)*>
                by A292,A359,A362,A363,A364,A389;
                then 1 <= j2-'1 &
                LSeg((F.k)/.len(F.k),G*(i2,j2-'1))=LSeg(G*(i2,j2-'1),
                (F.k)/.len(F.k)) by MATRIX_1:39;
                then LSeg(F.k,m) /\
                LSeg((F.k)/.len(F.k),G*(i2,j2-'1)) = {(F.k)/.len(F.k)}
                by A364,A366,A367,A369,A370,A394,GOBOARD7:17;
                hence thesis by A357,A361,A362,A395,SPPOL_2:31;
              end;
              suppose
A396:           i1 = i2 & j1 = j2+1;
                then
A397:           [i2+1,j2] in Indices G & F.(k+1) = (F.k)^ <*G*(i2+1,j2)*>
                by A292,A359,A362,A363,A364,A389;
                then 1 <= i2+1 & i2+1 <= len G &
                LSeg((F.k)/.len(F.k),G*(i2+1,j2))=LSeg(G*
                (i2+1,j2),(F.k)/.len(F.k)) by MATRIX_1:39;
                then LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G*
                (i2+1,j2)) = {(F.k)/.len(F.k)}
                by A364,A366,A367,A370,A396,GOBOARD7:19;
                hence thesis by A357,A361,A362,A397,SPPOL_2:31;
              end;
            end;
            hence thesis;
          end;
        end;
        hence thesis;
      end;
    end;
A398: for k holds P[k] from NAT_1:sch 1(A355,A356);
    defpred Q[Nat] means ex w being Element of NAT st w = $1 &
    $1 >= 1 & ex m st m in dom(F.w) &
    m <> len(F.w) & (F.w)/.m = (F.w)/.len(F.w);
    now
      assume
A399: for k st k >= 1 holds for m st m in dom(F.k) & m <> len(F.k)
      holds (F.k)/.m <> (F.k)/.len(F.k);
      defpred P[Element of NAT] means F.$1 is one-to-one;
A400: P[0] by A78;
A401: for k st P[k] holds P[k+1]
      proof
        let k;
        assume
A402:   F.k is one-to-one;
        now
          let n,m such that
A403:     n in dom(F.(k+1)) & m in dom(F.(k+1)) and
A404:     (F.(k+1))/.n = (F.(k+1))/.m;
          consider i,j such that [i,j] in Indices G and
A405:     F.(k+1) = (F.k)^<*G*(i,j)*> by A317;
A406:     1 <= n & n <= len(F.(k+1)) & 1 <= m & m <= len(F.(k+1))
          by A403,FINSEQ_3:27;
A407:     len(F.k) = k & len(F.(k+1)) = k+1 by A94;
          per cases by A406,A407,NAT_1:8;
          suppose n <= k & m <= k;
            then
A408:       n in dom(F.k) & m in dom(F.k) by A406,A407,FINSEQ_3:27;
            then (F.(k+1))/.n = (F.k)/.n & (F.(k+1))/.m = (F.k)/.m
            by A405,FINSEQ_4:83;
            hence n = m by A402,A404,A408,PARTFUN2:17;
          end;
          suppose n = k+1 & m <= k;
            hence n = m by A399,A403,A404,A407,NAT_1:12;
          end;
          suppose n <= k & m = k+1;
            hence n = m by A399,A403,A404,A407,NAT_1:12;
          end;
          suppose n = k+1 & m = k+1;
            hence n = m;
          end;
        end;
        hence thesis by PARTFUN2:16;
      end;
A409: for k holds P[k] from NAT_1:sch 1(A400,A401);
A410: for k holds card rng(F.k) = k
      proof
        let k;
        F.k is one-to-one by A409;
        hence card rng(F.k) = len(F.k) by FINSEQ_4:77
          .= k by A94;
      end;
      set k = (len G)*(width G)+1;
A411: k > (len G)*(width G) by NAT_1:13;
A412: card Values G <= (len G)*(width G) by GOBRD13:8;
      F.k is_sequence_on G by A291;
      then card rng(F.k) <= card Values G by GOBRD13:9,NAT_1:44;
      then card rng(F.k) <= (len G)*(width G) by A412,XXREAL_0:2;
      hence contradiction by A410,A411;
    end;
    then
A413: ex k be Nat st Q[k];
    consider k be Nat such that
A414: Q[k] and
A415: for l be Nat st Q[l] holds k <= l from NAT_1:sch 5(A413);
    reconsider k as Element of NAT by ORDINAL1:def 13;
    consider w being Element of NAT such that
A416: w = k and k >= 1 and
A417: ex m st m in dom(F.w) & m <> len(F.w) & (F.w)/.m = (F.w)/.len(F.w)
    by A414;
    consider m such that
A418: m in dom(F.k) and
A419: m <> len(F.k) and
A420: (F.k)/.m = (F.k)/.len(F.k) by A416,A417;
A421: len(F.k) = k by A94;
    reconsider f = F.k as non empty FinSequence of TOP-REAL 2 by A414;
A422: f is_sequence_on G by A291;
A423: 1 <= m & m <= len f by A418,FINSEQ_3:27;
    then
A424: m < len f by A419,XXREAL_0:1;
    then 1 < len f by A423,XXREAL_0:2;
    then
A425: len f >= 1+1 by NAT_1:13;
    then reconsider f as non constant special unfolded non empty
    FinSequence of TOP-REAL 2 by A398,A422,JORDAN8:7,8;
    set g = f/^(m-'1);
A426: m+1 <= len f by A424,NAT_1:13;
    m-'1 <= m & m < m+1 by NAT_1:13,NAT_D:44;
    then m-'1 < m+1 by XXREAL_0:2;
    then
A427: m-'1 < len f by A426,XXREAL_0:2;
    then
A428: len g = len f - (m-'1) by RFINSEQ:def 2;
    then (m-'1)-(m-'1) < len g by A427,XREAL_1:11;
    then reconsider g as non empty FinSequence of TOP-REAL 2
     by CARD_1:47;
    1 in dom g by FINSEQ_5:6;
    then
A429: g/.1 = f/.(m-'1+1) by FINSEQ_5:30
      .= f/.m by A423,XREAL_1:237;
    len g in dom g by FINSEQ_5:6;
    then
A430: g/.len g = f/.(m-'1+len g) by FINSEQ_5:30
      .= f/.len f by A428;
A431: g is_sequence_on G by A422,JORDAN8:5;
    then
A432: g is standard by JORDAN8:7;
A433: for i st 1 <= i & i < len g & 1 <= j & j < len g & g/.i = g/.j
    holds i = j
    proof
      let i such that
A434: 1 <= i & i < len g and
A435: 1 <= j & j < len g and
A436: g/.i = g/.j and
A437: i <> j;
A438: i in dom g by A434,FINSEQ_3:27;
      then
A439: g/.i = f/.(m-'1+i) by FINSEQ_5:30;
A440: j in dom g by A435,FINSEQ_3:27;
      then
A441: g/.j = f/.(m-'1+j) by FINSEQ_5:30;
      per cases by A437,XXREAL_0:1;
      suppose
A442:   i < j;
        set l = m-'1+j, m'= m-'1+i;
A443:   m' < l by A442,XREAL_1:8;
A444:   l < k by A421,A428,A435,XREAL_1:22;
        then
A445:   f|l = F.l by A349;
        0+j <= l by XREAL_1:8;
        then
A446:   1 <= l by A435,XXREAL_0:2;
A447:   len(F.l) = l by A94;
        0+i <= m' by XREAL_1:8;
        then 1 <= m' by A434,XXREAL_0:2;
        then
A448:   m' in dom(F.l) by A443,A447,FINSEQ_3:27;
        then
A449:   (F.l)/.m' = f/.m' by A445,FINSEQ_4:85;
        l in dom(F.l) by A446,A447,FINSEQ_3:27;
        then (F.l)/.l = f/.l by A445,FINSEQ_4:85;

hence contradiction by A415,A436,A439,A440,A443,A444,A446,A447,A448,A449,
FINSEQ_5:30;
      end;
      suppose
A450:   j < i;
        set l = m-'1+i, m'= m-'1+j;
A451:   m' < l by A450,XREAL_1:8;
A452:   l < k by A421,A428,A434,XREAL_1:22;
        then
A453:   f|l = F.l by A349;
        0+i <= l by XREAL_1:8;
        then
A454:   1 <= l by A434,XXREAL_0:2;
A455:   len(F.l) = l by A94;
        0+j <= m' by XREAL_1:8;
        then 1 <= m' by A435,XXREAL_0:2;
        then
A456:   m' in dom(F.l) by A451,A455,FINSEQ_3:27;
        then
A457:   (F.l)/.m' = f/.m' by A453,FINSEQ_4:85;
        l in dom(F.l) by A454,A455,FINSEQ_3:27;
        then (F.l)/.l = f/.l by A453,FINSEQ_4:85;

hence contradiction by A415,A436,A438,A441,A451,A452,A454,A455,A456,A457,
FINSEQ_5:30;
      end;
    end;
A458: for i st 1 < i & i < j & j <= len g holds g/.i <> g/.j
    proof
      let i such that
A459: 1 < i and
A460: i < j and
A461: j <= len g and
A462: g/.i = g/.j;
A463: 1 < j by A459,A460,XXREAL_0:2;
A464: i < len g by A460,A461,XXREAL_0:2;
      then
A465: 1 < len g by A459,XXREAL_0:2;
      per cases;
      suppose j <> len g;
        then j < len g by A461,XXREAL_0:1;
        hence contradiction by A433,A459,A460,A462,A463,A464;
      end;
      suppose j = len g;
        hence contradiction by A420,A429,A430,A433,A459,A460,A462,A465;
      end;
    end;
A466: for i st 1 <= i & i < j & j < len g holds g/.i <> g/.j
    proof
      let i such that
A467: 1 <= i and
A468: i < j and
A469: j < len g and
A470: g/.i = g/.j;
A471: 1 < j by A467,A468,XXREAL_0:2;
      i < len g by A468,A469,XXREAL_0:2;
      hence contradiction by A433,A467,A468,A469,A470,A471;
    end;
A472: for i st 1 <= i & i+1 <= len f
    holds right_cell(f,i,G) = Cl Int right_cell(f,i,G)
    proof
      let i such that
A473: 1 <= i & i+1 <= len f;
      consider i1,j1,i2,j2 such that
A474: [i1,j1] in Indices G and
A475: f/.i = G*(i1,j1) and
A476: [i2,j2] in Indices G and
A477: f/.(i+1) = G*(i2,j2) and
A478: i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
      i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A422,A473,JORDAN8:6;
A479: 1 <= i1 & i1 <= len G & 1 <= j1 & j1 <= width G by A474,MATRIX_1:39;
A480: 1 <= i2 & i2 <= len G & 1 <= j2 & j2 <= width G by A476,MATRIX_1:39;
A481: i1+1 > i1 & j1+1 > j1 & i2+1 > i2 & j2+1 > j2 by NAT_1:13;
      per cases by A478;
      suppose i1 = i2 & j1+1 = j2;
        then right_cell(f,i,G) = cell(G,i1,j1)
        by A422,A473,A474,A475,A476,A477,A481,GOBRD13:def 2;
        hence thesis by A479,GOBRD11:35;
      end;
      suppose
A482:   i1+1 = i2 & j1 = j2;
A483:   j1-'1 <= width G by A479,NAT_D:44;
        right_cell(f,i,G) = cell(G,i1,j1-'1)
        by A422,A473,A474,A475,A476,A477,A481,A482,GOBRD13:def 2;
        hence thesis by A479,A483,GOBRD11:35;
      end;
      suppose i1 = i2+1 & j1 = j2;
        then right_cell(f,i,G) = cell(G,i2,j2)
        by A422,A473,A474,A475,A476,A477,A481,GOBRD13:def 2;
        hence thesis by A480,GOBRD11:35;
      end;
      suppose
A484:   i1 = i2 & j1 = j2+1;
A485:   i1-'1 <= len G by A479,NAT_D:44;
        right_cell(f,i,G) = cell(G,i1-'1,j2)
        by A422,A473,A474,A475,A476,A477,A481,A484,GOBRD13:def 2;
        hence thesis by A480,A485,GOBRD11:35;
      end;
    end;
A486: g is s.c.c.
    proof
      let i,j such that
A487: i+1 < j and
A488: i > 1 & j < len g or j+1 < len g;
A489: j <= j+1 by NAT_1:12;
      then
A490: i+1 < j+1 by A487,XXREAL_0:2;
A491: 1 <= i+1 by NAT_1:12;
A492: 1 < j by A487,NAT_1:12;
      i < j by A487,NAT_1:13;
      then
A493: i < j+1 by A489,XXREAL_0:2;
      per cases by A488,NAT_1:14;
      suppose
A494:   i > 1 & j < len g;
        then
A495:   i+1 < len g by A487,XXREAL_0:2;
        then
A496:   LSeg(g,i) = LSeg(g/.i,g/.(i+1)) by A494,TOPREAL1:def 5;
A497:   1 < i+1 by A494,NAT_1:13;
A498:   i < len g by A495,NAT_1:13;
        consider i1,j1,i2,j2 such that
A499:   [i1,j1] in Indices G and
A500:   g/.i = G*(i1,j1) and
A501:   [i2,j2] in Indices G and
A502:   g/.(i+1) = G*(i2,j2) and
A503:   i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
        i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A431,A494,A495,JORDAN8:6;
A504:   1 <= i1 & i1 <= len G & 1 <= j1 & j1 <= width G by A499,MATRIX_1:39;
A505:   1 <= i2 & i2 <= len G & 1 <= j2 & j2 <= width G by A501,MATRIX_1:39;
A506:   j+1 <= len g by A494,NAT_1:13;
        then
A507:   LSeg(g,j) = LSeg(g/.j,g/.(j+1)) by A492,TOPREAL1:def 5;
        consider i1',j1',i2',j2' being Element of NAT such that
A508:   [i1',j1'] in Indices G and
A509:   g/.j = G*(i1',j1') and
A510:   [i2',j2'] in Indices G and
A511:   g/.(j+1) = G*(i2',j2') and
A512:   i1' = i2' & j1'+1 = j2' or i1'+1 = i2' & j1' = j2' or
        i1' = i2'+1 & j1' = j2' or i1' = i2' & j1' = j2'+1
        by A431,A492,A506,JORDAN8:6;
A513:   1 <= i1' & i1' <= len G & 1 <= j1' & j1' <= width G
 by A508,MATRIX_1:39;
A514:   1 <= i2' & i2' <= len G & 1 <= j2' & j2' <= width G
 by A510,MATRIX_1:39;
        assume
A515:   LSeg(g,i) meets LSeg(g,j);
        now per cases by A503,A512;
          suppose
A516:       i1 = i2 & j1+1 = j2 & i1' = i2' & j1'+1 = j2';
            then
A517:       i1 = i1' by A496,A500,A502,A504,A505,A507,A509,A511,A513,A514,A515,
GOBOARD7:21;
            j1 = j1' or j1 = j1'+1 or j1+1 = j1'
            by A496,A500,A502,A504,A505,A507,A509,A511,A513,A514,A515,A516,
GOBOARD7:24;
            hence contradiction
            by A433,A458,A487,A489,A491,A492,A493,A494,A495,A498,A500,A502,A506
,A509,A511,A516,A517;
          end;
          suppose
A518:       i1 = i2 & j1+1 = j2 & i1'+1 = i2' & j1' = j2';
            then i1 = i1' & j1 = j1' or i1 = i1' & j1+1 = j1' or
            i1 = i1'+1 & j1 = j1' or i1 = i1'+1 & j1+1 = j1'

by A496,A500,A502,A504,A505,A507,A509,A511,A513,A514,A515,GOBOARD7:23;
            hence contradiction
            by A433,A458,A487,A490,A492,A493,A494,A497,A498,A500,A502,A506,A509
,A511,A518;
          end;
          suppose
A519:       i1 = i2 & j1+1 = j2 & i1' = i2'+1 & j1' = j2';
            then i1 = i2' & j1' = j1 or i1 = i2' & j1+1 = j1' or
            i1 = i2'+1 & j1' = j1 or i1 = i2'+1 & j1+1 = j1'
            by A496,A500,A502,A504,A505,A507,A509,A511,A513,A514,A515,
GOBOARD7:23;
            hence contradiction
            by A433,A458,A487,A490,A492,A493,A494,A497,A498,A500,A502,A506,A509
,A511,A519;
          end;
          suppose
A520:       i1 = i2 & j1+1 = j2 & i1' = i2' & j1' = j2'+1;
            then
A521:       i1 = i1' by A496,A500,A502,A504,A505,A507,A509,A511,A513,A514,A515,
GOBOARD7:21;
            j1 = j2' or j1 = j2'+1 or j1+1 = j2'
            by A496,A500,A502,A504,A505,A507,A509,A511,A513,A514,A515,A520,
GOBOARD7:24;
            hence contradiction by A433,A458,A487,A490,A492,A494,A497,A498,A500
,A502,A506,A509,A511,A520,A521;
          end;
          suppose
A522:       i1+1 = i2 & j1 = j2 & i1' = i2' & j1'+1 = j2';
            then i1' = i1 & j1 = j1' or i1' = i1 & j1'+1 = j1 or
            i1' = i1+1 & j1 = j1' or i1' = i1+1 & j1'+1 = j1
            by A496,A500,A502,A504,A505,A507,A509,A511,A513,A514,A515,
GOBOARD7:23;
            hence contradiction
            by A433,A458,A487,A490,A492,A493,A494,A497,A498,A500,A502,A506,A509
,A511,A522;
          end;
          suppose
A523:       i1+1 = i2 & j1 = j2 & i1'+1 = i2' & j1' = j2';
            then
A524:       j1 = j1' by A496,A500,A502,A504,A505,A507,A509,A511,A513,A514,A515,
GOBOARD7:22;
            i1 = i1' or i1 = i1'+1 or i1+1 = i1'
            by A496,A500,A502,A504,A505,A507,A509,A511,A513,A514,A515,A523,
GOBOARD7:25;
            hence contradiction
            by A433,A458,A487,A489,A491,A492,A493,A494,A495,A498,A500,A502,A506
,A509,A511,A523,A524;
          end;
          suppose
A525:       i1+1 = i2 & j1 = j2 & i1' = i2'+1 & j1' = j2';
            then
A526:       j1 = j1' by A496,A500,A502,A504,A505,A507,A509,A511,A513,A514,A515,
GOBOARD7:22;
            i1 = i2' or i1 = i2'+1 or i1+1 = i2'
            by A496,A500,A502,A504,A505,A507,A509,A511,A513,A514,A515,A525,
GOBOARD7:25;
            hence contradiction
            by A433,A458,A490,A492,A493,A494,A497,A498,A500,A502,A506,A509,A511
,A525,A526;
          end;
          suppose
A527:       i1+1 = i2 & j1 = j2 & i1' = i2' & j1' = j2'+1;
            then i1' = i1 & j1 = j2' or i1' = i1 & j2'+1 = j1 or
            i1' = i1+1 & j1 = j2' or i1' = i1+1 & j2'+1 = j1
            by A496,A500,A502,A504,A505,A507,A509,A511,A513,A514,A515,
GOBOARD7:23;
            hence contradiction
            by A433,A458,A487,A490,A492,A493,A494,A497,A498,A500,A502,A506,A509
,A511,A527;
          end;
          suppose
A528:       i1 = i2+1 & j1 = j2 & i1' = i2' & j1'+1 = j2';
            then i1' = i2 & j1' = j1 or i1' = i2 & j1'+1 = j1 or
            i1' = i2+1 & j1' = j1 or i1' = i2+1 & j1'+1 = j1

by A496,A500,A502,A504,A505,A507,A509,A511,A513,A514,A515,GOBOARD7:23;
            hence contradiction
            by A433,A458,A487,A490,A492,A493,A494,A497,A498,A500,A502,A506,A509
,A511,A528;
          end;
          suppose
A529:       i1 = i2+1 & j1 = j2 & i1'+1 = i2' & j1' = j2';
            then
A530:       j1 = j1' by A496,A500,A502,A504,A505,A507,A509,A511,A513,A514,A515,
GOBOARD7:22;
            i2 = i1' or i2 = i1'+1 or i2+1 = i1'
            by A496,A500,A502,A504,A505,A507,A509,A511,A513,A514,A515,A529,
GOBOARD7:25;
            hence contradiction
            by A433,A458,A487,A490,A492,A494,A497,A498,A500,A502,A506,A509,A511
,A529,A530;
          end;
          suppose
A531:       i1 = i2+1 & j1 = j2 & i1' = i2'+1 & j1' = j2';
            then
A532:       j1 = j1' by A496,A500,A502,A504,A505,A507,A509,A511,A513,A514,A515,
GOBOARD7:22;
            i2 = i2' or i2 = i2'+1 or i2+1 = i2'
            by A496,A500,A502,A504,A505,A507,A509,A511,A513,A514,A515,A531,
GOBOARD7:25;
            hence contradiction by A458,A487,A490,A493,A494,A497,A500,A502,A506
,A509,A511,A531,A532;
          end;
          suppose
A533:       i1 = i2+1 & j1 = j2 & i1' = i2' & j1' = j2'+1;
            then i1' = i2 & j2' = j1 or i1' = i2 & j2'+1 = j1 or
            i1' = i2+1 & j2' = j1 or i1' = i2+1 & j2'+1 = j1
            by A496,A500,A502,A504,A505,A507,A509,A511,A513,A514,A515,
GOBOARD7:23;
            hence contradiction
            by A433,A458,A487,A490,A492,A493,A494,A497,A498,A500,A502,A506,A509
,A511,A533;
          end;
          suppose
A534:       i1 = i2 & j1 = j2+1 & i1' = i2' & j1'+1 = j2';
            then
A535:       i1 = i1' by A496,A500,A502,A504,A505,A507,A509,A511,A513,A514,A515,
GOBOARD7:21;
            j2 = j1' or j2 = j1'+1 or j2+1 = j1'
            by A496,A500,A502,A504,A505,A507,A509,A511,A513,A514,A515,A534,
GOBOARD7:24;
            hence contradiction
            by A433,A458,A487,A490,A492,A494,A497,A498,A500,A502,A506,A509,A511
,A534,A535;
          end;
          suppose
A536:       i1 = i2 & j1 = j2+1 & i1'+1 = i2' & j1' = j2';
            then i1 = i1' & j2 = j1' or i1 = i1' & j2+1 = j1' or
            i1 = i1'+1 & j2 = j1' or i1 = i1'+1 & j2+1 = j1'

by A496,A500,A502,A504,A505,A507,A509,A511,A513,A514,A515,GOBOARD7:23;
            hence contradiction
            by A433,A458,A487,A490,A492,A493,A494,A497,A498,A500,A502,A506,A509
,A511,A536;
          end;
          suppose
A537:       i1 = i2 & j1 = j2+1 & i1' = i2'+1 & j1' = j2';
            then i1 = i2' & j2 = j1' or i1 = i2' & j2+1 = j1' or
            i1 = i2'+1 & j2 = j1' or i1 = i2'+1 & j2+1 = j1'

by A496,A500,A502,A504,A505,A507,A509,A511,A513,A514,A515,GOBOARD7:23;
            hence contradiction
            by A433,A458,A487,A490,A492,A493,A494,A497,A498,A500,A502,A506,A509
,A511,A537;
          end;
          suppose
A538:       i1 = i2 & j1 = j2+1 & i1' = i2' & j1' = j2'+1;
            then
A539:       i1 = i1' by A496,A500,A502,A504,A505,A507,A509,A511,A513,A514,A515,
GOBOARD7:21;
            j2 = j2' or j2 = j2'+1 or j2+1 = j2'
            by A496,A500,A502,A504,A505,A507,A509,A511,A513,A514,A515,A538,
GOBOARD7:24;
            hence contradiction by A458,A487,A490,A493,A494,A497,A500,A502,A506
,A509,A511,A538,A539;
          end;
        end;
        hence contradiction;
      end;
      suppose i = 0 & j+1 < len g;
        then LSeg(g,i) = {} by TOPREAL1:def 5;
        hence thesis by XBOOLE_1:65;
      end;
      suppose
A540:   1 <= i & j+1 < len g;
        then
A541:   i+1 < len g by A490,XXREAL_0:2;
        then
A542:   LSeg(g,i) = LSeg(g/.i,g/.(i+1)) by A540,TOPREAL1:def 5;
A543:   1 < i+1 by A540,NAT_1:13;
A544:   i < len g by A541,NAT_1:13;
A545:   j < len g by A540,NAT_1:12;
        consider i1,j1,i2,j2 such that
A546:   [i1,j1] in Indices G and
A547:   g/.i = G*(i1,j1) and
A548:   [i2,j2] in Indices G and
A549:   g/.(i+1) = G*(i2,j2) and
A550:   i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
        i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A431,A540,A541,JORDAN8:6;
A551:   1 <= i1 & i1 <= len G & 1 <= j1 & j1 <= width G by A546,MATRIX_1:39;
A552:   1 <= i2 & i2 <= len G & 1 <= j2 & j2 <= width G by A548,MATRIX_1:39;
A553:   LSeg(g,j) = LSeg(g/.j,g/.(j+1)) by A492,A540,TOPREAL1:def 5;
        consider i1',j1',i2',j2' being Element of NAT such that
A554:   [i1',j1'] in Indices G and
A555:   g/.j = G*(i1',j1') and
A556:   [i2',j2'] in Indices G and
A557:   g/.(j+1) = G*(i2',j2') and
A558:   i1' = i2' & j1'+1 = j2' or i1'+1 = i2' & j1' = j2' or
        i1' = i2'+1 & j1' = j2' or i1' = i2' & j1' = j2'+1
        by A431,A492,A540,JORDAN8:6;
A559:   1 <= i1' & i1' <= len G & 1 <= j1' & j1' <= width G
 by A554,MATRIX_1:39;
A560:   1 <= i2' & i2' <= len G & 1 <= j2' & j2' <= width G
 by A556,MATRIX_1:39;
        assume
A561:   LSeg(g,i) meets LSeg(g,j);
        now per cases by A550,A558;
          suppose
A562:       i1 = i2 & j1+1 = j2 & i1' = i2' & j1'+1 = j2';
            then
A563:       i1 = i1' by A542,A547,A549,A551,A552,A553,A555,A557,A559,A560,A561,
GOBOARD7:21;
            j1 = j1' or j1 = j1'+1 or j1+1 = j1'
            by A542,A547,A549,A551,A552,A553,A555,A557,A559,A560,A561,A562,
GOBOARD7:24;
            hence contradiction by A466,A487,A490,A491,A493,A540,A545,A547,A549
,A555,A557,A562,A563;
          end;
          suppose
A564:       i1 = i2 & j1+1 = j2 & i1'+1 = i2' & j1' = j2';
            then i1 = i1' & j1 = j1' or i1 = i1' & j1+1 = j1' or
            i1 = i1'+1 & j1 = j1' or i1 = i1'+1 & j1+1 = j1'
            by A542,A547,A549,A551,A552,A553,A555,A557,A559,A560,A561,
GOBOARD7:23;
            hence contradiction
            by A433,A466,A487,A490,A492,A493,A540,A543,A544,A545,A547,A549,A555
,A557,A564;
          end;
          suppose
A565:       i1 = i2 & j1+1 = j2 & i1' = i2'+1 & j1' = j2';
            then i1 = i2' & j1' = j1 or i1 = i2' & j1+1 = j1' or
            i1 = i2'+1 & j1' = j1 or i1 = i2'+1 & j1+1 = j1'
            by A542,A547,A549,A551,A552,A553,A555,A557,A559,A560,A561,
GOBOARD7:23;
            hence contradiction
            by A433,A466,A487,A490,A492,A493,A540,A543,A544,A545,A547,A549,A555
,A557,A565;
          end;
          suppose
A566:       i1 = i2 & j1+1 = j2 & i1' = i2' & j1' = j2'+1;
            then
A567:       i1 = i1' by A542,A547,A549,A551,A552,A553,A555,A557,A559,A560,A561,
GOBOARD7:21;
            j1 = j2' or j1 = j2'+1 or j1+1 = j2'
            by A542,A547,A549,A551,A552,A553,A555,A557,A559,A560,A561,A566,
GOBOARD7:24;
            hence contradiction by A433,A458,A487,A490,A492,A540,A543,A544,A545
,A547,A549,A555,A557,A566,A567;
          end;
          suppose
A568:       i1+1 = i2 & j1 = j2 & i1' = i2' & j1'+1 = j2';
            then i1' = i1 & j1 = j1' or i1' = i1 & j1'+1 = j1 or
            i1' = i1+1 & j1 = j1' or i1' = i1+1 & j1'+1 = j1
            by A542,A547,A549,A551,A552,A553,A555,A557,A559,A560,A561,
GOBOARD7:23;
            hence contradiction by A433,A466,A487,A490,A491,A492,A493,A540,A544
,A545,A547,A549,A555,A557,A568;
          end;
          suppose
A569:       i1+1 = i2 & j1 = j2 & i1'+1 = i2' & j1' = j2';
            then
A570:       j1 = j1' by A542,A547,A549,A551,A552,A553,A555,A557,A559,A560,A561,
GOBOARD7:22;
            i1 = i1' or i1 = i1'+1 or i1+1 = i1'
            by A542,A547,A549,A551,A552,A553,A555,A557,A559,A560,A561,A569,
GOBOARD7:25;
            hence contradiction by A466,A487,A490,A491,A493,A540,A545,A547,A549
,A555,A557,A569,A570;
          end;
          suppose
A571:       i1+1 = i2 & j1 = j2 & i1' = i2'+1 & j1' = j2';
            then
A572:       j1 = j1' by A542,A547,A549,A551,A552,A553,A555,A557,A559,A560,A561,
GOBOARD7:22;
            i1 = i2' or i1 = i2'+1 or i1+1 = i2'
            by A542,A547,A549,A551,A552,A553,A555,A557,A559,A560,A561,A571,
GOBOARD7:25;
            hence contradiction by A433,A466,A490,A492,A493,A540,A543,A544,A545
,A547,A549,A555,A557,A571,A572;
          end;
          suppose
A573:       i1+1 = i2 & j1 = j2 & i1' = i2' & j1' = j2'+1;
            then i1' = i1 & j1 = j2' or i1' = i1 & j2'+1 = j1 or
            i1' = i1+1 & j1 = j2' or i1' = i1+1 & j2'+1 = j1
            by A542,A547,A549,A551,A552,A553,A555,A557,A559,A560,A561,
GOBOARD7:23;
            hence contradiction by A433,A466,A487,A490,A492,A493,A540,A543,A544
,A545,A547,A549,A555,A557,A573;
          end;
          suppose
A574:       i1 = i2+1 & j1 = j2 & i1' = i2' & j1'+1 = j2';
            then i1' = i2 & j1' = j1 or i1' = i2 & j1'+1 = j1 or
            i1' = i2+1 & j1' = j1 or i1' = i2+1 & j1'+1 = j1

by A542,A547,A549,A551,A552,A553,A555,A557,A559,A560,A561,GOBOARD7:23;
            hence contradiction by A433,A466,A487,A490,A492,A493,A540,A543,A544
,A545,A547,A549,A555,A557,A574;
          end;
          suppose
A575:       i1 = i2+1 & j1 = j2 & i1'+1 = i2' & j1' = j2';
            then
A576:       j1 = j1' by A542,A547,A549,A551,A552,A553,A555,A557,A559,A560,A561,
GOBOARD7:22;
            i2 = i1' or i2 = i1'+1 or i2+1 = i1'
            by A542,A547,A549,A551,A552,A553,A555,A557,A559,A560,A561,A575,
GOBOARD7:25;
            hence contradiction by A433,A458,A487,A490,A492,A540,A543,A544,A545
,A547,A549,A555,A557,A575,A576;
          end;
          suppose
A577:       i1 = i2+1 & j1 = j2 & i1' = i2'+1 & j1' = j2';
            then
A578:       j1 = j1' by A542,A547,A549,A551,A552,A553,A555,A557,A559,A560,A561,
GOBOARD7:22;
            i2 = i2' or i2 = i2'+1 or i2+1 = i2'
            by A542,A547,A549,A551,A552,A553,A555,A557,A559,A560,A561,A577,
GOBOARD7:25;
            hence contradiction by A466,A487,A490,A493,A540,A543,A545,A547,A549
,A555,A557,A577,A578;
          end;
          suppose
A579:       i1 = i2+1 & j1 = j2 & i1' = i2' & j1' = j2'+1;
            then i1' = i2 & j2' = j1 or i1' = i2 & j2'+1 = j1 or
            i1' = i2+1 & j2' = j1 or i1' = i2+1 & j2'+1 = j1
            by A542,A547,A549,A551,A552,A553,A555,A557,A559,A560,A561,
GOBOARD7:23;
            hence contradiction by A433,A466,A487,A490,A492,A493,A540,A543,A544
,A545,A547,A549,A555,A557,A579;
          end;
          suppose
A580:       i1 = i2 & j1 = j2+1 & i1' = i2' & j1'+1 = j2';
            then
A581:       i1 = i1' by A542,A547,A549,A551,A552,A553,A555,A557,A559,A560,A561,
GOBOARD7:21;
            j2 = j1' or j2 = j1'+1 or j2+1 = j1'
            by A542,A547,A549,A551,A552,A553,A555,A557,A559,A560,A561,A580,
GOBOARD7:24;
            hence contradiction by A433,A458,A487,A490,A492,A540,A543,A544,A545
,A547,A549,A555,A557,A580,A581;
          end;
          suppose
A582:       i1 = i2 & j1 = j2+1 & i1'+1 = i2' & j1' = j2';
            then i1 = i1' & j2 = j1' or i1 = i1' & j2+1 = j1' or
            i1 = i1'+1 & j2 = j1' or i1 = i1'+1 & j2+1 = j1'
            by A542,A547,A549,A551,A552,A553,A555,A557,A559,A560,A561,
GOBOARD7:23;
            hence contradiction by A433,A466,A487,A490,A492,A493,A540,A543,A544
,A545,A547,A549,A555,A557,A582;
          end;
          suppose
A583:       i1 = i2 & j1 = j2+1 & i1' = i2'+1 & j1' = j2';
            then i1 = i2' & j2 = j1' or i1 = i2' & j2+1 = j1' or
            i1 = i2'+1 & j2 = j1' or i1 = i2'+1 & j2+1 = j1'
            by A542,A547,A549,A551,A552,A553,A555,A557,A559,A560,A561,
GOBOARD7:23;
            hence contradiction by A433,A466,A487,A490,A492,A493,A540,A543,A544
,A545,A547,A549,A555,A557,A583;
          end;
          suppose
A584:       i1 = i2 & j1 = j2+1 & i1' = i2' & j1' = j2'+1;
            then
A585:       i1 = i1' by A542,A547,A549,A551,A552,A553,A555,A557,A559,A560,A561,
GOBOARD7:21;
            j2 = j2' or j2 = j2'+1 or j2+1 = j2'
            by A542,A547,A549,A551,A552,A553,A555,A557,A559,A560,A561,A584,
GOBOARD7:24;
            hence contradiction by A466,A487,A490,A493,A540,A543,A545,A547,A549
,A555,A557,A584,A585;
          end;
        end;
        hence contradiction;
      end;
    end;
    m+1-(m-'1) <= len g by A426,A428,XREAL_1:11;
    then
A586: m+1-(m-1) <= len g by A423,XREAL_1:235;
    then
A587: 1+m-m+1 <= len g;
    g is non constant
    proof
      take 1,2; thus
A588: 1 in dom g by FINSEQ_5:6; thus
A589: 2 in dom g by A586,FINSEQ_3:27;
      then g/.1 <> g/.(1+1) by A432,A588,GOBOARD7:31;
      then g.1 <> g/.(1+1) by A588,PARTFUN1:def 8;
      hence thesis by A589,PARTFUN1:def 8;
    end;
    then reconsider g as standard non constant special_circular_sequence
    by A420,A429,A430,A431,A486,FINSEQ_6:def 1,JORDAN8:7;
    now
      assume m <> 1;
      then
A590: 1 < m by A423,XXREAL_0:1;
A591: LeftComp g is_a_component_of (L~g)` &
      RightComp g is_a_component_of (L~g)` by GOBOARD9:def 1,def 2;
      reconsider Lg' = (L~g)` as Subset of TOP-REAL 2;
A592: C c= Lg'
      proof
        let c be set;
        assume that
A593:   c in C and
A594:   not c in Lg';
        reconsider c as Point of TOP-REAL 2 by A593;
        c in L~g by A594,SUBSET_1:50;
        then consider i such that
A595:   1 <= i & i+1 <= len g and
A596:   c in LSeg(g/.i,g/.(i+1)) by SPPOL_2:14;
        i in dom g & i+1 in dom g by A595,GOBOARD2:3;
        then
A597:   g/.i = f/.(i+(m-'1)) & g/.(i+1) = f/.(i+1+(m-'1)) by FINSEQ_5:30;
A598:   1 <= i+(m-'1) by A595,NAT_1:12;
        i+1+(m-'1) = i+(m-'1)+1;
        then
A599:   i+(m-'1)+1 <= (len g)+(m-'1) by A595,XREAL_1:8;
        then c in LSeg(f,i+(m-'1)) by A428,A596,A597,A598,TOPREAL1:def 5;
        then c in left_cell(f,i+(m-'1),G) /\ right_cell(f,i+(m-'1),G)
        by A422,A428,A598,A599,GOBRD13:30;
        then c in left_cell(f,i+(m-'1),G) by XBOOLE_0:def 4;
        then left_cell(f,i+(m-'1),G) meets C by A593,XBOOLE_0:3;
        hence contradiction by A291,A428,A598,A599;
      end;
A600: the TopStruct of TOP-REAL 2 = TopSpaceMetr (Euclid 2) by EUCLID:def 8;
      L~g is closed by SPPOL_1:49;
      then (L~g)` is open by TOPS_1:29;
      then
A601: (L~g)` = Int (L~g)` by TOPS_1:55;
A602: for j,k st 1 <= j & j <= k holds (F.k)/.j = (F.j)/.j
      proof
        let j,k;
        assume that
A603:   1 <= j and
A604:   j <= k;
A605:   (F.k)|j = F.j by A349,A604;
        j <= len(F.k) by A94,A604;
        then len(F.k|j) = j by FINSEQ_1:80;
        then j in dom((F.k)|j) by A603,FINSEQ_3:27;
        hence thesis by A605,FINSEQ_4:85;
      end;
A606: L~g c= L~f by JORDAN3:75;
A607: for n st 1 <= n & n <= m-'1 holds not f/.n in L~g
      proof
        let n such that
A608:   1 <= n and
A609:   n <= m-'1;
A610:   n <= len f by A427,A609,XXREAL_0:2;
        set p = f/.n;
        assume p in L~g;
        then consider j such that
A611:   m-'1+1 <= j and
A612:   j+1 <= len f and
A613:   p in LSeg(f,j) by A427,Th9;
A614:   n < m-'1+1 by A609,NAT_1:13;
        then
A615:   n < j by A611,XXREAL_0:2;
A616:   m-'1+1=m by A423,XREAL_1:237;
        then
A617:   1 < j by A590,A611,XXREAL_0:2;
A618:   j < k by A421,A612,NAT_1:13;
A619:   2 <= len G & 2 <= width G by A2,NAT_1:12;
A620:   p in Values G by A422,A608,A610,Th8;
        per cases by A422,A612,A613,A617,A619,A620,Th25;
        suppose
A621:     p = f/.j;
          n <= len(F.j) by A94,A615;
          then
A622:     n in dom(F.j) by A608,FINSEQ_3:27;
A623:     n <> len(F.j) by A94,A611,A614;
          (F.j)/.n = (F.n)/.n by A602,A608,A615
            .= p by A421,A602,A608,A610
            .= (F.j)/.j by A602,A617,A618,A621
            .= (F.j)/.len(F.j) by A94;
          hence contradiction by A415,A617,A618,A622,A623;
        end;
        suppose
A624:     p = f/.(j+1);
          now
            per cases by A421,A612,XXREAL_0:1;
            suppose
A625:         j+1 = k;
              n <= len(F.m) by A94,A614,A616;
              then
A626:         n in dom(F.m) by A608,FINSEQ_3:27;
A627:         n <> len(F.m) by A94,A614,A616;
              (F.m)/.n = (F.n)/.n by A602,A608,A614,A616
                .= (F.k)/.k by A421,A602,A608,A610,A624,A625
                .= (F.m)/.m by A420,A421,A423,A602
                .= (F.m)/.len(F.m) by A94;
              hence contradiction by A415,A421,A423,A424,A626,A627;
            end;
            suppose
A628:         j+1 < k;
              set l = j+1;
A629:         1 <= l by NAT_1:11;
A630:         n < n+1 & n+1 < l by A615,XREAL_1:8,31;
              then
A631:         n < l by XXREAL_0:2;
              then n <= len(F.l) by A94;
              then
A632:         n in dom(F.l) by A608,FINSEQ_3:27;
A633:         n <> len(F.l) by A94,A630;
              (F.l)/.n = (F.n)/.n by A602,A608,A631
                .= p by A421,A602,A608,A610
                .= (F.l)/.l by A602,A624,A628,A629
                .= (F.l)/.len(F.l) by A94;
              hence contradiction by A415,A628,A632,A633,NAT_1:11;
            end;
          end;
          hence contradiction;
        end;
      end;
A634: for h being standard non constant special_circular_sequence st L~h c= L~f
      for Comp being Subset of TOP-REAL 2 st Comp is_a_component_of (L~h)`
      for n st 1 <= n & n+1 <= len f & f/.n in Comp & not f/.n in L~h holds
      C meets Comp
      proof
        let h be standard non constant special_circular_sequence such that
A635:   L~h c= L~f;
        let Comp be Subset of TOP-REAL 2 such that
A636:   Comp is_a_component_of (L~h)`;
        let n such that
A637:   1 <= n & n+1 <= len f and
A638:   f/.n in Comp and
A639:   not f/.n in L~h;
        reconsider rc = right_cell(f,n,G)\L~h as Subset of TOP-REAL 2;
A640:   rc c= right_cell(f,n,G) by XBOOLE_1:36;
A641:   rc = right_cell(f,n,G) /\ (L~h)` by SUBSET_1:32;
A642:   rc meets C
        proof
          right_cell(f,n,G) meets C by A291,A637;
          then consider p being set such that
A643:     p in right_cell(f,n,G) & p in C by XBOOLE_0:3;
          reconsider p as Element of TOP-REAL 2 by A643;
          now
            take a = p;
            now
              assume p in L~h;
              then consider j such that
A644:         1 <= j and
A645:         j+1 <= len f and
A646:         p in LSeg(f,j) by A635,SPPOL_2:13;
              p in

left_cell(f,j,G) /\ right_cell(f,j,G) by A422,A644,A645,A646,GOBRD13:30;
              then
A647:         p in left_cell(f,j,G) by XBOOLE_0:def 4;
              left_cell(f,j,G) misses C by A291,A644,A645;
              hence contradiction by A643,A647,XBOOLE_0:3;
            end;
            hence a in rc by A643,XBOOLE_0:def 5;
            thus a in C by A643;
          end;
          hence thesis by XBOOLE_0:3;
        end;
A648:   Int right_cell(f,n,G) is connected by A422,A637,Th12;
        Int right_cell(f,n,G) misses L~f by A422,A637,Th17;
        then Int right_cell(f,n,G) misses L~h by A635,XBOOLE_1:63;
        then
A649:   Int right_cell(f,n,G) c= (L~h)` by SUBSET_1:43;
A650:   Int right_cell(f,n,G) c= right_cell(f,n,G) by TOPS_1:44;
        rc c= Cl Int right_cell(f,n,G) by A422,A637,A640,Th13;
        then
A651:   rc is connected by A641,A648,A649,A650,CONNSP_1:19,XBOOLE_1:19;
        f/.n in right_cell(f,n,G) by A422,A637,Th10;
        then f/.n in rc by A639,XBOOLE_0:def 5;
        then
A652:   rc meets Comp by A638,XBOOLE_0:3;
        rc c= (L~h)` by A641,XBOOLE_1:17;
        then rc c= Comp by A636,A651,A652,GOBOARD9:6;
        hence thesis by A642,XBOOLE_1:63;
      end;
A653: C meets RightComp Rev g
      proof
        set rg=Rev g;
A654:   rg is_sequence_on G by A431,Th7;
A655:   1+1 <= len rg by A586,FINSEQ_5:def 3;
        then 1+1-'1 <= len rg-'1 by NAT_D:42;
        then
A656:   1 <= len rg -'1 by NAT_D:34;
        1 < len rg by A655,NAT_1:13;
        then
A657:   len rg -'1+1 = len rg by XREAL_1:237;
        set p = rg/.1, q = rg/.2;
        set a = f/.(m-'1);
        set l = (m-'1)+(len g-'1);
A658:   p = f/.m by A420,A430,FINSEQ_5:68;
A659:   m-'1+1 = m by A423,XREAL_1:237;
        then
A660:   1 <= m-'1 by A590,NAT_1:13;
        1+1-'1 <= len g-'1 by A586,NAT_D:42;
        then
A661:   1 <= len g-'1 by NAT_D:34;
A662:   1+1 - 1 <= len g - 1 by A586,XREAL_1:11;
A663:   1 - 1 < m - 1 by A590,XREAL_1:11;
        l = m+(len g -'1)-'1 by A423,NAT_D:38
          .= (len g -'1)+m - 1 by A661,NAT_D:37
          .= (len g - 1)+m - 1 by A662,XREAL_0:def 2
          .= ((k - (m - 1)) - 1)+m - 1 by A421,A428,A663,XREAL_0:def 2
          .= k - 1;
        then
A664:   k = l+1;
        then
A665:   l < k by XREAL_1:31;
        len g-'1 <= l by NAT_1:11;
        then
A666:   1 <= l by A661,XXREAL_0:2;
        len g-'1 <= len g by NAT_D:44;
        then
A667:   len g-'1 in dom g by A661,FINSEQ_3:27;
        1 <= len g by A587,XREAL_1:147;
        then
A668:   len g-'1+2 = len g+1 by Lm1;
        then
A669:   q = g/.(len g-'1) by A667,FINSEQ_5:69
          .= f/.l by A667,FINSEQ_5:30;
A670:   right_cell(f,m-'1,G) meets C by A291,A423,A659,A660;
A671:   right_cell(f,l,G) meets C by A291,A421,A664,A666;
        not a in L~g by A607,A660;
        then
A672:   not a in L~rg by SPPOL_2:22;
A673:   m-'1+2 = m+1 by A423,Lm1;
        m-'1 <= l by NAT_1:11;
        then m-'1 <= len(F.l) by A94;
        then
A674:   m-'1 in dom(F.l) by A660,FINSEQ_3:27;
        (m-'1)+1 <= l by A661,XREAL_1:8;
        then m-'1 < l by NAT_1:13;
        then
A675:   m-'1 <> len(F.l) by A94;
        consider p1,p2,q1,q2 being Element of NAT such that
A676:   [p1,p2] in Indices G and
A677:   p = G*(p1,p2) and
A678:   [q1,q2] in Indices G and
A679:   q = G*(q1,q2) and
A680:   p1 = q1 & p2+1 = q2 or p1+1 = q1 & p2 = q2 or
        p1 = q1+1 & p2 = q2 or p1 = q1 & p2 = q2+1 by A654,A655,JORDAN8:6;
A681:   1 <= p1 & p1 <= len G & 1 <= p2 & p2 <= width G by A676,MATRIX_1:39;
        per cases by A680;
        suppose
A682:     p1 = q1 & p2+1 = q2;
          consider a1,a2,p'1,p'2 being Element of NAT such that
A683:     [a1,a2] in Indices G and
A684:     a = G*(a1,a2) and
A685:     [p'1,p'2] in Indices G and
A686:     p = G*(p'1,p'2) and
A687:     a1 = p'1 & a2+1 = p'2 or a1+1 = p'1 & a2 = p'2 or
          a1 = p'1+1 & a2 = p'2 or a1 = p'1 & a2 = p'2+1
          by A422,A423,A658,A659,A660,JORDAN8:6;
A688:     1 <= a1 & a1 <= len G & 1 <= a2 & a2 <= width G by A683,MATRIX_1:39;
          thus thesis
          proof
            per cases by A687;
            suppose a1 = p'1 & a2+1 = p'2;
              then
A689:         a1 = p1 & a2+1 = p2 by A676,A677,A685,A686,GOBOARD1:21;
A690:         F.m is_sequence_on G by A291;
A691:         m-'1+1 <= len (F.m) by A94,A659;
A692:         m-'1 <= m by A659,NAT_1:11;
A693:         F.k|(m+1)=F.(m+1) by A349,A421,A426;
A694:         p2+1 > a2+1 & a2+1 > a2 by A689,NAT_1:13;
A695:         f/.(m-'1) = (F.(m-'1))/.(m-'1) by A421,A427,A602,A660
                .= (F.m)/.(m-'1) by A602,A660,A692;
A696:         f/.(m-'1+1) = (F.m)/.m by A421,A423,A602,A659;
              right_cell(f,l,G) = cell(G,p1-'1,p2)
              by A420,A421,A422,A658,A664,A666,A669,A676,A677,A678,A679,A682,
GOBRD13:29
                .= front_left_cell(F.m,m-'1,G) by A658,A659,A660,A676,A677,A683
,A684,A689,A690,A691,A695,A696,GOBRD13:35;
              then F.(m+1) turns_left m-'1,G by A350,A590,A671;
              then f turns_left m-'1,G by A426,A660,A673,A693,GOBRD13:45;
              then
A697:         f/.(m+1) = G*(p1-'1,p2) & [p1-'1,p2] in Indices G
              by A658,A659,A673,A676,A677,A683,A684,A694,GOBRD13:def 7;
              then
A698:         1 <= p1-'1 & p1-'1 <= len G by MATRIX_1:39;
              set rc = right_cell(rg,len rg-'1,G)\L~rg;
A699:         rc c= RightComp rg by A654,A656,A657,Th29;
A700:         p2-'1 = a2 & p1-'1+1 = p1 by A681,A689,NAT_D:34,XREAL_1:237;
A701:         2 in dom g by A586,FINSEQ_3:27;
              len rg-'1+2 = len g +1 by A668,FINSEQ_5:def 3;
              then
A702:         rg/.(len rg-'1) = g/.2 by A701,FINSEQ_5:69
                .= f/.(m+1) by A673,A701,FINSEQ_5:30;
              p = g/.1 by A420,A429,A430,FINSEQ_5:68
                .= rg/.len g by FINSEQ_5:68
                .= rg/.len rg by FINSEQ_5:def 3;
              then right_cell(rg,len rg-'1,G) = cell(G,p1-'1,a2)
              by A654,A656,A657,A676,A677,A697,A700,A702,GOBRD13:25;
              then a in right_cell(rg,len rg-'1,G)
              by A681,A684,A688,A689,A698,A700,Th22;
              then
A703:         a in rc by A672,XBOOLE_0:def 5;
A704:         L~rg c= L~f by A606,SPPOL_2:22;
              RightComp rg is_a_component_of (L~rg)` by GOBOARD9:def 2;

hence thesis by A423,A634,A659,A660,A672,A699,A703,A704;
            end;
            suppose
A705:         a1+1 = p'1 & a2 = p'2;
              then
A706:         a1+1 = p1 & a2 = p2 by A676,A677,A685,A686,GOBOARD1:21;
              then q1-'1 = a1 by A682,NAT_D:34;
              then right_cell(f,l,G) = cell(G,a1,a2)
              by A420,A421,A422,A658,A664,A666,A669,A676,A677,A678,A679,A682
,A706,GOBRD13:29
                .= left_cell(f,m-'1,G)
              by A422,A423,A658,A659,A660,A683,A684,A685,A686,A705,GOBRD13:24;
              hence thesis by A291,A423,A659,A660,A671;
            end;
            suppose a1 = p'1+1 & a2 = p'2;
              then a1 = p1+1 & a2 = p2 by A676,A677,A685,A686,GOBOARD1:21;
              then right_cell(f,m-'1,G) = cell(G,p1,p2)
              by A422,A423,A658,A659,A660,A676,A677,A683,A684,GOBRD13:27
                .= left_cell(f,l,G)
              by A420,A421,A422,A658,A664,A666,A669,A676,A677,A678,A679,A682,
GOBRD13:28;
              hence thesis by A291,A421,A664,A666,A670;
            end;
            suppose a1 = p'1 & a2 = p'2+1;
              then
A707:         a1 = q1 & a2 = q2 by A676,A677,A682,A685,A686,GOBOARD1:21;
              (F.l)/.(m-'1) = (F.(m-'1))/.(m-'1) by A602,A660,NAT_1:11
                .= q by A421,A427,A602,A660,A679,A684,A707
                .= (F.l)/.l by A602,A665,A666,A669
                .= (F.l)/.len(F.l) by A94;
              hence thesis by A415,A665,A666,A674,A675;
            end;
          end;
        end;
        suppose
A708:     p1+1 = q1 & p2 = q2;
          consider a1,a2,p'1,p'2 being Element of NAT such that
A709:     [a1,a2] in Indices G and
A710:     a = G*(a1,a2) and
A711:     [p'1,p'2] in Indices G and
A712:     p = G*(p'1,p'2) and
A713:     a1 = p'1 & a2+1 = p'2 or a1+1 = p'1 & a2 = p'2 or
          a1 = p'1+1 & a2 = p'2 or a1 = p'1 & a2 = p'2+1
          by A422,A423,A658,A659,A660,JORDAN8:6;
A714:     1 <= a1 & a1 <= len G & 1 <= a2 & a2 <= width G by A709,MATRIX_1:39;
          thus thesis
          proof
            per cases by A713;
            suppose
A715:         a1 = p'1 & a2+1 = p'2;
              then
A716:         a1 = p1 & a2+1 = p2 by A676,A677,A711,A712,GOBOARD1:21;
              then
A717:         q2-'1 = a2 by A708,NAT_D:34;
              right_cell(f,m-'1,G) = cell(G,a1,a2)
              by A422,A423,A658,A659,A660,A709,A710,A711,A712,A715,GOBRD13:23
                .= left_cell(f,l,G)
              by A420,A421,A422,A658,A664,A666,A669,A676,A677,A678,A679,A708
,A716,A717,GOBRD13:26;
              hence thesis by A291,A421,A664,A666,A670;
            end;
            suppose a1+1 = p'1 & a2 = p'2;
              then
A718:         a1+1 = p1 & a2 = p2 by A676,A677,A711,A712,GOBOARD1:21;
A719:         F.m is_sequence_on G by A291;
A720:         m-'1+1 <= len (F.m) by A94,A659;
A721:         m-'1 <= m by A659,NAT_1:11;
A722:         F.k|(m+1)=F.(m+1) by A349,A421,A426;
A723:         a1 < a1+1 & p1 < p1+1 by XREAL_1:31;
A724:         f/.(m-'1) = (F.(m-'1))/.(m-'1) by A421,A427,A602,A660
                .= (F.m)/.(m-'1) by A602,A660,A721;
A725:         f/.(m-'1+1) = (F.m)/.m by A421,A423,A602,A659;
              right_cell(f,l,G) = cell(G,p1,p2)
              by A420,A421,A422,A658,A664,A666,A669,A676,A677,A678,A679,A708,
GOBRD13:27
                .= front_left_cell(F.m,m-'1,G) by A658,A659,A660,A676,A677,A709
,A710,A718,A719,A720,A724,A725,GOBRD13:37;
              then F.(m+1) turns_left m-'1,G by A350,A590,A671;
              then f turns_left m-'1,G by A426,A660,A673,A722,GOBRD13:45;
              then
A726:         f/.(m+1) = G*(p1,p2+1) & [p1,p2+1] in Indices G
              by A658,A659,A673,A676,A677,A709,A710,A718,A723,GOBRD13:def 7;
              then
A727:         p2+1 <= width G by MATRIX_1:39;
              set rc = right_cell(rg,len rg-'1,G)\L~rg;
A728:         rc c= RightComp rg by A654,A656,A657,Th29;
A729:         a1 = p1-'1 by A718,NAT_D:34;
A730:         2 in dom g by A586,FINSEQ_3:27;
              len rg-'1+2 = len g +1 by A668,FINSEQ_5:def 3;
              then
A731:         rg/.(len rg-'1) = g/.2 by A730,FINSEQ_5:69
                .= f/.(m+1) by A673,A730,FINSEQ_5:30;
              p = g/.1 by A420,A429,A430,FINSEQ_5:68
                .= rg/.len g by FINSEQ_5:68
                .= rg/.len rg by FINSEQ_5:def 3;
              then right_cell(rg,len rg-'1,G) = cell(G,p1-'1,a2)
              by A654,A656,A657,A676,A677,A718,A726,A731,GOBRD13:29;
              then a in right_cell(rg,len rg-'1,G)
              by A681,A710,A714,A718,A727,A729,Th22;
              then
A732:         a in rc by A672,XBOOLE_0:def 5;
A733:         L~rg c= L~f by A606,SPPOL_2:22;
              RightComp rg is_a_component_of (L~rg)` by GOBOARD9:def 2;

hence thesis by A423,A634,A659,A660,A672,A728,A732,A733;
            end;
            suppose a1 = p'1+1 & a2 = p'2;
              then
A734:         a1 = q1 & a2 = q2 by A676,A677,A708,A711,A712,GOBOARD1:21;
              (F.l)/.(m-'1) = (F.(m-'1))/.(m-'1) by A602,A660,NAT_1:11
                .= q by A421,A427,A602,A660,A679,A710,A734
                .= (F.l)/.l by A602,A665,A666,A669
                .= (F.l)/.len(F.l) by A94;
              hence thesis by A415,A665,A666,A674,A675;
            end;
            suppose a1 = p'1 & a2 = p'2+1;
              then
A735:         a1 = p1 & a2 = p2+1 by A676,A677,A711,A712,GOBOARD1:21;
              right_cell(f,l,G) = cell(G,p1,p2)
              by A420,A421,A422,A658,A664,A666,A669,A676,A677,A678,A679,A708,
GOBRD13:27
                .= left_cell(f,m-'1,G)
              by A422,A423,A658,A659,A660,A676,A677,A709,A710,A735,GOBRD13:28;
              hence thesis by A291,A423,A659,A660,A671;
            end;
          end;
        end;
        suppose
A736:     p1 = q1+1 & p2 = q2;
          consider a1,a2,p'1,p'2 being Element of NAT such that
A737:     [a1,a2] in Indices G and
A738:     a = G*(a1,a2) and
A739:     [p'1,p'2] in Indices G and
A740:     p = G*(p'1,p'2) and
A741:     a1 = p'1 & a2+1 = p'2 or a1+1 = p'1 & a2 = p'2 or
          a1 = p'1+1 & a2 = p'2 or a1 = p'1 & a2 = p'2+1
          by A422,A423,A658,A659,A660,JORDAN8:6;
A742:     1 <= a1 & a1 <= len G & 1 <= a2 & a2 <= width G by A737,MATRIX_1:39;
          thus thesis
          proof
            per cases by A741;
            suppose
A743:         a1 = p'1 & a2+1 = p'2;
              then
A744:         a1 = p1 & a2+1 = p2 by A676,A677,A739,A740,GOBOARD1:21;
              then
A745:         q1 = a1-'1 by A736,NAT_D:34;
A746:         q2-'1 = a2 by A736,A744,NAT_D:34;
              right_cell(f,l,G) = cell(G,q1,q2-'1)
              by A420,A421,A422,A658,A664,A666,A669,A676,A677,A678,A679,A736,
GOBRD13:25
                .= left_cell(f,m-'1,G)
              by A422,A423,A658,A659,A660,A737,A738,A739,A740,A743,A745,A746,
GOBRD13:22;
              hence thesis by A291,A423,A659,A660,A671;
            end;
            suppose a1+1 = p'1 & a2 = p'2;
              then
A747:         a1+1 = p1 & a2 = p2 by A676,A677,A739,A740,GOBOARD1:21;
              (F.l)/.(m-'1) = (F.(m-'1))/.(m-'1) by A602,A660,NAT_1:11
                .= q by A421,A427,A602,A660,A679,A736,A738,A747
                .= (F.l)/.l by A602,A665,A666,A669
                .= (F.l)/.len(F.l) by A94;
              hence thesis by A415,A665,A666,A674,A675;
            end;
            suppose a1 = p'1+1 & a2 = p'2;
              then
A748:         a1 = p1+1 & a2 = p2 by A676,A677,A739,A740,GOBOARD1:21;
A749:         p1-'1 = q1 by A736,NAT_D:34;
A750:         F.m is_sequence_on G by A291;
A751:         m-'1+1 <= len (F.m) by A94,A659;
A752:         m-'1 <= m by A659,NAT_1:11;
A753:         F.k|(m+1)=F.(m+1) by A349,A421,A426;
              p1+1>p1 by XREAL_1:31;
              then
A754:         a2+1 > p2 & a1+1 > p1 & a2 < p2+1 by A748,NAT_1:13;
A755:         f/.(m-'1) = (F.(m-'1))/.(m-'1) by A421,A427,A602,A660
                .= (F.m)/.(m-'1) by A602,A660,A752;
A756:         f/.(m-'1+1) = (F.m)/.m by A421,A423,A602,A659;
              right_cell(f,l,G) = cell(G,q1,q2-'1)
              by A420,A421,A422,A658,A664,A666,A669,A676,A677,A678,A679,A736,
GOBRD13:25
                .= front_left_cell(F.m,m-'1,G) by A658,A659,A660,A676,A677,A736
,A737,A738,A748,A749,A750,A751,A755,A756,GOBRD13:39;
              then F.(m+1) turns_left m-'1,G by A350,A590,A671;
              then f turns_left m-'1,G by A426,A660,A673,A753,GOBRD13:45;
              then
A757:         f/.(m+1) = G*(p1,p2-'1) & [p1,p2-'1] in Indices G
              by A658,A659,A673,A676,A677,A737,A738,A754,GOBRD13:def 7;
              then
A758:         1 <= p2-'1 & p2-'1 <= width G by MATRIX_1:39;
              set rc = right_cell(rg,len rg-'1,G)\L~rg;
A759:         rc c= RightComp rg by A654,A656,A657,Th29;
A760:         p2-'1+1 = p2 by A681,XREAL_1:237;
A761:         2 in dom g by A586,FINSEQ_3:27;
              len rg-'1+2 = len g +1 by A668,FINSEQ_5:def 3;
              then
A762:         rg/.(len rg-'1) = g/.2 by A761,FINSEQ_5:69
                .= f/.(m+1) by A673,A761,FINSEQ_5:30;
              p = g/.1 by A420,A429,A430,FINSEQ_5:68
                .= rg/.len g by FINSEQ_5:68
                .= rg/.len rg by FINSEQ_5:def 3;
              then right_cell(rg,len rg-'1,G) = cell(G,p1,p2-'1)
              by A654,A656,A657,A676,A677,A757,A760,A762,GOBRD13:23;
              then a in right_cell(rg,len rg-'1,G)
              by A681,A738,A742,A748,A758,A760,Th22;
              then
A763:         a in rc by A672,XBOOLE_0:def 5;
A764:         L~rg c= L~f by A606,SPPOL_2:22;
              RightComp rg is_a_component_of (L~rg)` by GOBOARD9:def 2;

hence thesis by A423,A634,A659,A660,A672,A759,A763,A764;
            end;
            suppose a1 = p'1 & a2 = p'2+1;
              then
A765:         a1 = p1 & a2 = p2+1 by A676,A677,A739,A740,GOBOARD1:21;
              then q1 = a1-'1 by A736,NAT_D:34;
              then right_cell(f,m-'1,G) = cell(G,q1,q2)
              by A422,A423,A658,A659,A660,A676,A677,A736,A737,A738,A765,
GOBRD13:29
                .= left_cell(f,l,G)
              by A420,A421,A422,A658,A664,A666,A669,A676,A677,A678,A679,A736,
GOBRD13:24;
              hence thesis by A291,A421,A664,A666,A670;
            end;
          end;
        end;
        suppose
A766:     p1 = q1 & p2 = q2+1;
          consider a1,a2,p'1,p'2 being Element of NAT such that
A767:     [a1,a2] in Indices G and
A768:     a = G*(a1,a2) and
A769:     [p'1,p'2] in Indices G and
A770:     p = G*(p'1,p'2) and
A771:     a1 = p'1 & a2+1 = p'2 or a1+1 = p'1 & a2 = p'2 or
          a1 = p'1+1 & a2 = p'2 or a1 = p'1 & a2 = p'2+1
          by A422,A423,A658,A659,A660,JORDAN8:6;
A772:     1 <= a1 & a1 <= len G & 1 <= a2 & a2 <= width G by A767,MATRIX_1:39;
          thus thesis
          proof
            per cases by A771;
            suppose a1 = p'1 & a2+1 = p'2;
              then
A773:         a1 = p1 & a2+1 = p2 by A676,A677,A769,A770,GOBOARD1:21;
              (F.l)/.(m-'1) = (F.(m-'1))/.(m-'1) by A602,A660,NAT_1:11
                .= q by A421,A427,A602,A660,A679,A766,A768,A773
                .= (F.l)/.l by A602,A665,A666,A669
                .= (F.l)/.len(F.l) by A94;
              hence thesis by A415,A665,A666,A674,A675;
            end;
            suppose
A774:         a1+1 = p'1 & a2 = p'2;
              then
A775:         a1+1 = p1 & a2 = p2 by A676,A677,A769,A770,GOBOARD1:21;
              then
A776:         a1 = q1-'1 by A766,NAT_D:34;
A777:         a2-'1 = q2 by A766,A775,NAT_D:34;
              right_cell(f,m-'1,G) = cell(G,a1,a2-'1)
              by A422,A423,A658,A659,A660,A767,A768,A769,A770,A774,GOBRD13:25
                .= left_cell(f,l,G)
              by A420,A421,A422,A658,A664,A666,A669,A676,A677,A678,A679,A766
,A776,A777,GOBRD13:22;
              hence thesis by A291,A421,A664,A666,A670;
            end;
            suppose a1 = p'1+1 & a2 = p'2;
              then
A778:         a1 = p1+1 & a2 = p2 by A676,A677,A769,A770,GOBOARD1:21;
              then
A779:         a2-'1 = q2 by A766,NAT_D:34;
              right_cell(f,l,G) = cell(G,q1,q2)
              by A420,A421,A422,A658,A664,A666,A669,A676,A677,A678,A679,A766,
GOBRD13:23
                .= left_cell(f,m-'1,G)
              by A422,A423,A658,A659,A660,A676,A677,A766,A767,A768,A778,A779,
GOBRD13:26;
              hence thesis by A291,A423,A659,A660,A671;
            end;
            suppose a1 = p'1 & a2 = p'2+1;
              then
A780:         a1 = p1 & a2 = p2+1 by A676,A677,A769,A770,GOBOARD1:21;
A781:         p2-'1 = q2 by A766,NAT_D:34;
A782:         F.m is_sequence_on G by A291;
A783:         m-'1+1 <= len (F.m) by A94,A659;
A784:         m-'1 <= m by A659,NAT_1:11;
A785:         F.k|(m+1)=F.(m+1) by A349,A421,A426;
A786:         a2+1>p2+1 & p2+1>p2 by A780,NAT_1:13;
A787:         f/.(m-'1) = (F.(m-'1))/.(m-'1) by A421,A427,A602,A660
                .= (F.m)/.(m-'1) by A602,A660,A784;
A788:         f/.(m-'1+1) = (F.m)/.m by A421,A423,A602,A659;
              right_cell(f,l,G) = cell(G,q1,q2)
              by A420,A421,A422,A658,A664,A666,A669,A676,A677,A678,A679,A766,
GOBRD13:23
                .= front_left_cell(F.m,m-'1,G) by A658,A659,A660,A676,A677,A766
,A767,A768,A780,A781,A782,A783,A787,A788,GOBRD13:41;
              then F.(m+1) turns_left m-'1,G by A350,A590,A671;
              then f turns_left m-'1,G by A426,A660,A673,A785,GOBRD13:45;
              then
A789:         f/.(m+1) = G*(p1+1,p2) & [p1+1,p2] in Indices G
              by A658,A659,A673,A676,A677,A767,A768,A786,GOBRD13:def 7;
              then
A790:         p1+1 <= len G by MATRIX_1:39;
              set rc = right_cell(rg,len rg-'1,G)\L~rg;
A791:         rc c= RightComp rg by A654,A656,A657,Th29;
A792:         2 in dom g by A586,FINSEQ_3:27;
              len rg-'1+2 = len g +1 by A668,FINSEQ_5:def 3;
              then
A793:         rg/.(len rg-'1) = g/.2 by A792,FINSEQ_5:69
                .= f/.(m+1) by A673,A792,FINSEQ_5:30;
              p = g/.1 by A420,A429,A430,FINSEQ_5:68
                .= rg/.len g by FINSEQ_5:68
                .= rg/.len rg by FINSEQ_5:def 3;
              then right_cell(rg,len rg-'1,G) = cell(G,p1,p2)
              by A654,A656,A657,A676,A677,A789,A793,GOBRD13:27;
              then a in right_cell(rg,len rg-'1,G)
              by A681,A768,A772,A780,A790,Th22;
              then
A794:         a in rc by A672,XBOOLE_0:def 5;
A795:         L~rg c= L~f by A606,SPPOL_2:22;
              RightComp rg is_a_component_of (L~rg)` by GOBOARD9:def 2;

hence thesis by A423,A634,A659,A660,A672,A791,A794,A795;
            end;
          end;
        end;
      end;
A796: C meets RightComp g
      proof
        right_cell(f,m,G) meets C by A291,A423,A426;
        then consider p being set such that
A797:   p in right_cell(f,m,G) & p in C by XBOOLE_0:3;
        reconsider p as Element of TOP-REAL 2 by A797;
        now
          take a = p;
          thus a in C by A797;
          reconsider u = p as Element of Euclid 2 by TOPREAL3:13;
          consider r being real number such that
A798:     r > 0 and
A799:     Ball(u,r) c= (L~g)` by A592,A601,A797,GOBOARD6:8;
          reconsider r as Real by XREAL_0:def 1;
A800:     p in Ball(u,r) by A798,GOBOARD6:4;
          reconsider B = Ball(u,r) as non empty Subset of TOP-REAL 2
          by A600,A798,GOBOARD6:4,TOPMETR:16;
A801:     B is connected by SPRECT_3:17;
          right_cell(g,1,G) c= right_cell(g,1) by A431,A587,GOBRD13:34;
          then
A802:     Int right_cell(g,1,G) c= Int right_cell(g,1) by TOPS_1:48;
          Int right_cell(g,1) c= RightComp g by A587,GOBOARD9:28;
          then Int right_cell(g,1,G) c= RightComp g by A802,XBOOLE_1:1;

then Int right_cell(f,m-'1+1,G) c= RightComp g by A422,A427,A587,GOBRD13:33;
          then
A803:     Int right_cell(f,m,G) c= RightComp g by A423,XREAL_1:237;
A804:     right_cell(f,m,G) = Cl Int right_cell(f,m,G) by A423,A426,A472;
          B is open by GOBOARD6:6;
          then
A805:     Int right_cell(f,m,G) meets B by A797,A800,A804,TOPS_1:39;
A806:     p in B by A798,GOBOARD6:4;
          B c= RightComp g by A591,A799,A801,A803,A805,GOBOARD9:6;
          hence a in RightComp g by A806;
        end;
        hence thesis by XBOOLE_0:3;
      end;
      C meets LeftComp g by A653,GOBOARD9:27;
      hence contradiction by A1,A591,A592,A796,Th3,SPRECT_4:7;
    end;
    then
A807: g = f/^0 by XREAL_1:234
      .= f by FINSEQ_5:31;
A808: now
      consider i such that
A809: 1 <= i & i+1 <= len G and
A810: N-min C in cell(G,i,width G-'1) & N-min C <> G*(i,width G-'1) and
A811: F.(1+1) = <*G*(i,width G),G*(i+1,width G)*> by A79;
      take i;
      thus 1 <= i & i+1 <= len G by A809;
A812: f|2 = F.2 by A349,A421,A425;
A813: len(f|2) = 2 by A425,FINSEQ_1:80;
      then 1 in dom(f|2) by FINSEQ_3:27;
      hence f/.1 = (f|2)/.1 by FINSEQ_4:85
        .= G*(i,width G) by A811,A812,FINSEQ_4:26;
      2 in dom(f|2) by A813,FINSEQ_3:27;
      hence f/.2 = (f|2)/.2 by FINSEQ_4:85
        .= G*(i+1,width G) by A811,A812,FINSEQ_4:26;
      thus N-min C in cell(G,i,width G-'1) & N-min C <> G*
      (i,width G-'1) by A810;
    end;
    reconsider f as standard non constant special_circular_sequence by A807;
    f is clockwise_oriented
    proof
      len G >= 3 by A2,NAT_1:12;
      then
A814: 1 < len G by XXREAL_0:2;
      for k st 1 <= k & k+1 <= len f
      holds left_cell(f,k,G) misses C & right_cell(f,k,G) meets C by A291;
      then
A815: N-min L~f = f/.1 by A422,A808,Th32;
      f/.2 in LSeg(f/.1,f/.(1+1)) by RLTOPSP1:69;
      then
A816: f/.2 in L~f by A425,SPPOL_2:15;
      consider i such that
A817: 1 <= i & i+1 <= len G and
A818: f/.1 = G*(i,width G) and
A819: f/.2 = G*(i+1,width G) and
      N-min C in cell(G,i,width G-'1) & N-min C <> G*(i,width G-'1) by A808;
A820: (NW-corner L~f)`2 = (NE-corner L~f)`2 by PSCOMP_1:82;
A821: (NE-corner L~f)`2 = N-bound L~f & (N-min L~f)`2 = N-bound L~f
      by EUCLID:56;
      i < len G by A817,NAT_1:13;
      then
A822: G*(i,width G)`2 = G*(1,width G)`2 by A2,A814,A817,GOBOARD5:2;
      1 <= i+1 by NAT_1:12;
      then
A823: G*(i+1,width G)`2 = G*(1,width G)`2 by A2,A814,A817,GOBOARD5:2;
      (NW-corner L~f)`1 = W-bound L~f & (NE-corner L~f)`1 = E-bound L~f
      by EUCLID:56;
      then (NW-corner L~f)`1 <= (f/.2)`1 & (f/.2)`1 <= (NE-corner L~f)`1
      by A816,PSCOMP_1:71;
      then f/.2 in LSeg(NW-corner L~f, NE-corner L~f)
      by A815,A818,A819,A820,A821,A822,A823,GOBOARD7:9;
      then f/.2 in LSeg(NW-corner L~f, NE-corner L~f) /\ L~f by A816,
XBOOLE_0:def 4;
      hence thesis by A815,SPRECT_2:34;
    end;
    then reconsider f as
    clockwise_oriented (standard non constant special_circular_sequence);
    take f;
    thus f is_sequence_on G by A291;
    thus ex i st 1 <= i & i+1 <= len G &
    f/.1 = G*(i,width G) & f/.2 = G*(i+1,width G) &
    N-min C in cell(G,i,width G-'1) & N-min C <> G*(i,width G-'1) by A808;
    let m such that
A824: 1 <= m & m+2 <= len f;
A825: m+1 < m+2 by XREAL_1:8;
    then
A826: m+1 <= len f by A824,XXREAL_0:2;
A827: f|(m+1) = F.(m+1) by A349,A421,A824,A825,XXREAL_0:2;
A828: m = m+1-'1 by NAT_D:34;
A829: m+1 > 1 by A824,NAT_1:13;
A830: front_left_cell(F.(m+1),m,G) = front_left_cell(f,m,G) &
    front_right_cell(F.(m+1),m,G) = front_right_cell(f,m,G)
    by A422,A824,A826,A827,GOBRD13:43;
A831: F.(m+1+1) = f|(m+1+1) by A349,A421,A824;
    hereby
      assume front_left_cell(f,m,G) misses C &
      front_right_cell(f,m,G) misses C;
      then F.(m+1+1) turns_right m,G by A350,A828,A829,A830;
      hence f turns_right m,G by A824,A831,GOBRD13:44;
    end;
    hereby
      assume front_left_cell(f,m,G) misses C &
      front_right_cell(f,m,G) meets C;
      then F.(m+1+1) goes_straight m,G by A350,A828,A829,A830;
      hence f goes_straight m,G by A824,A831,GOBRD13:46;
    end;
    assume front_left_cell(f,m,G) meets C;
    then F.(m+1+1) turns_left m,G by A350,A828,A829,A830;
    hence thesis by A824,A831,GOBRD13:45;
  end;
  uniqueness
  proof
    let f1,f2 be clockwise_oriented
    (standard non constant special_circular_sequence) such that
A832: f1 is_sequence_on Gauge(C,n);
    given i1 such that
A833: 1 <= i1 & i1+1 <= len Gauge(C,n) and
A834: f1/.1 = Gauge(C,n)*(i1,width Gauge(C,n)) &
    f1/.2 = Gauge(C,n)*(i1+1,width Gauge(C,n)) and
A835: N-min C in cell(Gauge(C,n),i1,width Gauge(C,n)-'1) and
A836: N-min C <> Gauge(C,n)*(i1,width Gauge(C,n)-'1);
    assume that
A837: for k st 1 <= k & k+2 <= len f1 holds
    (front_left_cell(f1,k,Gauge(C,n)) misses C &
    front_right_cell(f1,k,Gauge(C,n)) misses C
    implies f1 turns_right k,Gauge(C,n)) &
    (front_left_cell(f1,k,Gauge(C,n)) misses C &
    front_right_cell(f1,k,Gauge(C,n)) meets C
    implies f1 goes_straight k,Gauge(C,n)) &
    (front_left_cell(f1,k,Gauge(C,n)) meets C
    implies f1 turns_left k,Gauge(C,n)) and
A838: f2 is_sequence_on Gauge(C,n);
    given i2 such that
A839: 1 <= i2 & i2+1 <= len Gauge(C,n) and
A840: f2/.1 = Gauge(C,n)*(i2,width Gauge(C,n)) &
    f2/.2 = Gauge(C,n)*(i2+1,width Gauge(C,n)) and
A841: N-min C in cell(Gauge(C,n),i2,width Gauge(C,n)-'1) and
A842: N-min C <> Gauge(C,n)*(i2,width Gauge(C,n)-'1);
    assume
A843: for k st 1 <= k & k+2 <= len f2 holds
    (front_left_cell(f2,k,Gauge(C,n)) misses C &
    front_right_cell(f2,k,Gauge(C,n)) misses C
    implies f2 turns_right k,Gauge(C,n)) &
    (front_left_cell(f2,k,Gauge(C,n)) misses C &
    front_right_cell(f2,k,Gauge(C,n)) meets C
    implies f2 goes_straight k,Gauge(C,n)) &
    (front_left_cell(f2,k,Gauge(C,n)) meets C
    implies f2 turns_left k,Gauge(C,n));
    defpred P[Element of NAT] means f1|$1 = f2|$1;
A844: P[0];
A845: for k st P[k] holds P[k+1]
    proof
      let k such that
A846: f1|k = f2|k;
A847: f1|1 = <*f1/.1*> & f2|1 = <*f2/.1*> by FINSEQ_5:23;
A848: i1 = i2 by A833,A835,A836,A839,A841,A842,Th31;
A849: len f1 > 4 & len f2 > 4 by GOBOARD7:36;
      per cases by NAT_1:26;
      suppose k = 0;
        hence thesis by A833,A834,A835,A836,A839,A840,A841,A842,A847,Th31;
      end;
      suppose
A850:   k = 1;
        f1|2 = <*f1/.1,f1/.2*> & f2|2 = <*f2/.1,f2/.2*>
        by A849,JORDAN8:1,XXREAL_0:2;
        hence thesis by A834,A840,A848,A850;
      end;
      suppose
A851:   k > 1;
A852:   f1/.1 = f1/.len f1 & f2/.1 = f2/.len f2 by FINSEQ_6:def 1;
        now
          per cases;
          suppose
A853:       len f1 > k;
            set m = k-'1;
A854:       1 <= m by A851,NAT_D:49;
            then
A855:       m+1 = k by NAT_D:43;
A856:       now
              assume
A857:         len f2 <= k;
              then
A858:         f2 = f2|k by FINSEQ_1:79;
              then
A859:         1 in dom(f2|k) by FINSEQ_5:6;
              len f2 in dom(f2|k) by A858,FINSEQ_5:6;
              then
A860:         (f1|k)/.len f2 = f1/.len f2 by A846,FINSEQ_4:85;
              1 < len f2 & len f2 <= len f1 by A846,A849,A858,FINSEQ_5:18
,XXREAL_0:2;

hence contradiction by A846,A852,A853,A857,A858,A859,A860,FINSEQ_4:85
,GOBOARD7:40;
            end;
            then
A861:       k+1 <= len f2 by NAT_1:13;
A862:       k+1 <= len f1 by A853,NAT_1:13;
A863:       front_left_cell
            (f1,m,Gauge(C,n))= front_left_cell(f1|k,m,Gauge(C,n))
            by A832,A853,A854,A855,GOBRD13:43;
A864:       front_right_cell(f1,m,Gauge(C,n))
            = front_right_cell(f1|k,m,Gauge(C,n))
            by A832,A853,A854,A855,GOBRD13:43;
A865:       front_left_cell(f2,m,Gauge(C,n))
            = front_left_cell(f2|k,m,Gauge(C,n))
            by A838,A854,A855,A856,GOBRD13:43;
A866:       front_right_cell(f2,m,Gauge(C,n))
            = front_right_cell(f2|k,m,Gauge(C,n))
            by A838,A854,A855,A856,GOBRD13:43;
A867:       m+(1+1) = k+1 by A855;
            now per cases;
              suppose front_left_cell(f1,m,Gauge(C,n)) misses C &
                front_right_cell(f1,m,Gauge(C,n)) misses C;
                then f1 turns_right m,Gauge(C,n) & f2 turns_right m,Gauge(C,n)
                by A837,A843,A846,A854,A861,A862,A863,A864,A865,A866,A867;

hence thesis by A838,A846,A851,A861,A862,GOBRD13:47;
              end;
              suppose front_left_cell(f1,m,Gauge(C,n)) misses C &
                front_right_cell(f1,m,Gauge(C,n)) meets C;

then f1 goes_straight m,Gauge(C,n) & f2 goes_straight m,Gauge(C,n)
                by A837,A843,A846,A854,A861,A862,A863,A864,A865,A866,A867;

hence thesis by A838,A846,A851,A861,A862,GOBRD13:49;
              end;
              suppose front_left_cell(f1,m,Gauge(C,n)) meets C;
                then f1 turns_left m,Gauge(C,n) & f2 turns_left m,Gauge(C,n)
                by A837,A843,A846,A854,A861,A862,A863,A865,A867;

hence thesis by A838,A846,A851,A861,A862,GOBRD13:48;
              end;
            end;
            hence thesis;
          end;
          suppose
A868:       k >= len f1;
            then
A869:       f1 = f1|k by FINSEQ_1:79;
            then
A870:       1 in dom(f1|k) by FINSEQ_5:6;
            len f1 in dom(f1|k) by A869,FINSEQ_5:6;
            then
A871:       (f2|k)/.len f1 = f2/.len f1 by A846,FINSEQ_4:85;
            1 < len f1 & len f1 <= len f2 by A846,A849,A869,FINSEQ_5:18
,XXREAL_0:2;
            then
A872:       len f2 = len f1 by A846,A852,A869,A870,A871,FINSEQ_4:85,GOBOARD7:40
            ;
A873:       k+1 > len f1 by A868,NAT_1:13;
            hence f1|(k+1) = f1 by FINSEQ_1:79
              .= f2 by A846,A868,A869,A872,FINSEQ_1:79
              .= f2|(k+1) by A872,A873,FINSEQ_1:79;
          end;
        end;
        hence thesis;
      end;
    end;
    for k holds P[k] from NAT_1:sch 1(A844,A845);
    hence thesis by Th4;
  end;
end;

theorem Th33:
  C is connected & 1 <= k & k+1 <= len Cage(C,n) implies
  left_cell(Cage(C,n),k,Gauge(C,n)) misses C &
  right_cell(Cage(C,n),k,Gauge(C,n)) meets C
proof
  set G = Gauge(C,n), f = Cage(C,n);
  set W = W-bound C, E = E-bound C, S = S-bound C, N = N-bound C;
  assume
A1: C is connected;
  then
A2: f is_sequence_on G by Def1;
  defpred P[Element of NAT] means for m st 1 <= m & m+1 <= len(f|$1)
  holds left_cell(f|$1,m,G) misses C & right_cell(f|$1,m,G) meets C;
A3: P[0] by CARD_1:47;
A4: len G = 2|^n+3 & len G = width G by JORDAN8:def 1;
A5: for k st P[k] holds P[k+1]
  proof
    let k such that
A6: for m st 1 <= m & m+1 <= len(f|k)
    holds left_cell(f|k,m,G) misses C & right_cell(f|k,m,G) meets C;
    per cases;
    suppose k >= len f;
      then f|k = f & f|(k+1) = f by FINSEQ_1:79,NAT_1:12;
      hence thesis by A6;
    end;
    suppose
A7:   k < len f;
      then
A8:   k+1 <= len f by NAT_1:13;
A9:   f|k is_sequence_on G by A2,GOBOARD1:38;
A10:  f|(k+1) is_sequence_on G by A2,GOBOARD1:38;
      consider i such that
A11:  1 <= i & i+1 <= len G and
A12:  f/.1 = G*(i,width G) and
A13:  f/.2 = G*(i+1,width G) and
A14:  N-min C in cell(G,i,width G-'1) & N-min C <> G*(i,width G-'1)
      by A1,Def1;
A15:  len(f|k) = k by A7,FINSEQ_1:80;
A16:  len(f|(k+1)) = k+1 by A8,FINSEQ_1:80;
A17:  1 <= len G by A4,NAT_1:12;
A18:  2|^n >= n+1 & n+1 >= 1 by NAT_1:12,NEWTON:104;
      let m such that
A19:  1 <= m & m+1 <= len(f|(k+1));
      now per cases by NAT_1:26;
        suppose
A20:      k = 0;
          1 <= m+1 by NAT_1:12;
          then m+1 = 0+1 by A16,A19,A20,XXREAL_0:1;
          hence thesis by A19;
        end;
        suppose
A21:      k = 1;

then f|(k+1) = <*G*(i,width G),G*(i+1,width G)*> by A8,A12,A13,JORDAN8:1;
          then
A22:      (f|(k+1))/.1 = G*(i,width G) & (f|(k+1))/.2 = G*(i+1, width G)
          by FINSEQ_4:26;
A23:      i < len G & 1 <= i+1 & i+1 <= len G by A11,NAT_1:13;
          then
A24:      [i,len G] in Indices G & [i+1,len G] in Indices G
          by A4,A11,A17,MATRIX_1:37;
          1+1 <= m+1 by A19,XREAL_1:8;
          then
A25:      m+1 = 1+1 by A16,A19,A21,XXREAL_0:1;
A26:      i < i+1 & i+1 < (i+1)+1 by NAT_1:13;
          then
A27:      left_cell(f|(k+1),m,G) = cell(G,i,len G)
          by A4,A10,A19,A22,A24,A25,GOBRD13:def 3;
          now
            assume left_cell(f|(k+1),m,G) meets C;
            then consider p being set such that
A28:        p in cell(G,i,len G) & p in C by A27,XBOOLE_0:3;
            reconsider p as Element of TOP-REAL 2 by A28;
            cell(G,i,len G) = { |[r,s]|: G*(i,1)`1 <= r & r <= G*(i+1,1)`1 &
            G*(1,len G)`2 <= s } by A4,A11,A23,GOBRD11:31;
            then consider r,s such that
A29:        p = |[r,s]| and G*(i,1)`1 <= r & r <= G*(i+1,1)`1 and
A30:        G*(1,len G)`2 <= s by A28;
            [1,len G] in Indices G by A4,A17,MATRIX_1:37;
            then
A31:        G*(1,len G) = |[W+((E-W)/(2|^n))*(1-2),S+((N-S)/(2 |^n))*((len G)-
            2)]| by JORDAN8:def 1;
A32:        ((N-S)/(2|^n))*((len G)-2)
            = ((N-S)/(2|^n))*(2|^n)+((N-S)/(2|^n))*1 by A4
              .= (N-S)+(N-S)/(2|^n) by A18,XCMPLX_1:88;
A33:        G*(1,len G)`2 = S+((N-S)/(2|^n))*((len G)-2) by A31,EUCLID:56;
            N > S by JORDAN8:12;
            then N-S > S-S by XREAL_1:11;
            then (N-S)/(2|^n) > 0 by A18,XREAL_1:141;
            then N+0 < N+(N-S)/(2|^n) by XREAL_1:8;
            then
A34:        N < s by A30,A32,A33,XXREAL_0:2;
            p`2 <= N by A28,PSCOMP_1:71;
            hence contradiction by A29,A34,EUCLID:56;
          end;
          hence left_cell(f|(k+1),m,G) misses C;
A35:      N-min C in C by SPRECT_1:13;
          N-min C in right_cell(f|(k+1),m,G)
          by A4,A10,A14,A19,A22,A24,A25,A26,GOBRD13:def 2;
          hence right_cell(f|(k+1),m,G) meets C by A35,XBOOLE_0:3;
        end;
        suppose
A36:      k > 1;
          then
A37:      1 <= (len(f|k))-'1 by A15,NAT_D:49;
A38:      (len(f|k)) -'1 +1 = len(f|k) by A15,A36,XREAL_1:237;
          now per cases;
            suppose
A39:          m+1 = len(f|(k+1));
A40:          len(f|k) <= len f by FINSEQ_5:18;
              now
                consider i1,j1,i2,j2 being Element of NAT such that
A41:            [i1,j1] in Indices G & f/.((len(f|k)) -'1) = G*(i1,j1) and
A42:            [i2,j2] in Indices G & f/.len(f|k) = G*(i2,j2) and
                i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
                i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1
                by A2,A7,A15,A37,A38,JORDAN8:6;
A43:            1

<= i2 & i2 <= len G & 1 <= j2 & j2 <= width G by A42,MATRIX_1:39;
A44:            (len(f|k))-'1+(1+1) = (len(f|k))+1 by A38;
A45:            (i2-'1)+1 = i2 by A43,XREAL_1:237;
A46:            (j2-'1)+1 = j2 by A43,XREAL_1:237;
                left_cell(f|k,(len(f|k))-'1,G) misses C &
                right_cell(f|k,(len(f|k))-'1,G) meets C by A6,A37,A38;
                then
A47:            left_cell(f,(len(f|k))-'1,G) misses C &
                right_cell(f,(len(f|k))-'1,G) meets C
                by A2,A15,A37,A38,A40,GOBRD13:32;
                per cases;
                suppose
A48:              front_left_cell(f,(len(f|k))-'1,G) misses C &
                  front_right_cell(f,(len(f|k))-'1,G) misses C;
                  then
A49:              f turns_right (len(f|k))-'1,G by A1,A8,A15,A37,A44,Def1;
                  now per cases by A38,A41,A42,A44,A49,GOBRD13:def 6;
                    suppose that
A50:                  i1 = i2 & j1+1 = j2 and
A51:                  [i2+1,j2] in Indices G and
A52:                  f/.((len(f|k))+1) = G*(i2+1,j2);
                      front_right_cell(f,(len(f|k))-'1,G) = cell(G,i1,j2)
                      by A2,A37,A38,A40,A41,A42,A50,GOBRD13:36;
                      then left_cell(f,m,G) misses C
                      by A2,A8,A15,A16,A19,A39,A42,A48,A50,A51,A52,GOBRD13:24;
                      hence left_cell(f|(k+1),m,G) misses C
                      by A2,A8,A16,A19,A39,GOBRD13:32;
                      j2-'1 = j1 & cell(G,i1,j1) meets C
                      by A2,A37,A38,A40,A41,A42,A47,A50,GOBRD13:23,NAT_D:34;
                      then right_cell(f,m,G) meets C
                      by A2,A8,A15,A16,A19,A39,A42,A50,A51,A52,GOBRD13:25;
                      hence right_cell(f|(k+1),m,G) meets C
                      by A2,A8,A16,A19,A39,GOBRD13:32;
                    end;
                    suppose that
A53:                  i1+1 = i2 & j1 = j2 and
A54:                  [i2,j2-'1] in Indices G and
A55:                  f/.((len(f|k))+1) = G*(i2,j2-'1);
                      front_right_cell(f,(len(f|k))-'1,G) = cell(G,i2,j2-'1)
                      by A2,A37,A38,A40,A41,A42,A53,GOBRD13:38;
                      then left_cell(f,m,G) misses C
                      by A2,A8,A15,A16,A19,A39,A42,A46,A48,A54,A55,GOBRD13:28;
                      hence left_cell(f|(k+1),m,G) misses C
                      by A2,A8,A16,A19,A39,GOBRD13:32;
                      i2-'1 = i1 & cell(G,i1,j1-'1) meets C
                      by A2,A37,A38,A40,A41,A42,A47,A53,GOBRD13:25,NAT_D:34;
                      then right_cell(f,m,G) meets C
                      by A2,A8,A15,A16,A19,A39,A42,A46,A53,A54,A55,GOBRD13:29;
                      hence right_cell(f|(k+1),m,G) meets C
                      by A2,A8,A16,A19,A39,GOBRD13:32;
                    end;
                    suppose that
A56:                  i1 = i2+1 & j1 = j2 and
A57:                  [i2,j2+1] in Indices G and
A58:                  f/.((len(f|k))+1) = G*(i2,j2+1);
                      front_right_cell(f,(len(f|k))-'1,G) = cell(G,i2-'1,j2)
                      by A2,A37,A38,A40,A41,A42,A56,GOBRD13:40;
                      then left_cell(f,m,G) misses C
                      by A2,A8,A15,A16,A19,A39,A42,A48,A57,A58,GOBRD13:22;
                      hence left_cell(f|(k+1),m,G) misses C
                      by A2,A8,A16,A19,A39,GOBRD13:32;
                      cell(G,i2,j2) meets C
                      by A2,A37,A38,A40,A41,A42,A47,A56,GOBRD13:27;
                      then right_cell(f,m,G) meets C
                      by A2,A8,A15,A16,A19,A39,A42,A57,A58,GOBRD13:23;
                      hence right_cell(f|(k+1),m,G) meets C
                      by A2,A8,A16,A19,A39,GOBRD13:32;
                    end;
                    suppose that
A59:                  i1 = i2 & j1 = j2+1 and
A60:                  [i2-'1,j2] in Indices G and
A61:                  f/.((len(f|k))+1) = G*(i2-'1,j2);
                      front_right_cell(f,(len(f|k))-'1,G) = cell(G,i2-'1,j2-'1
                      ) by A2,A37,A38,A40,A41,A42,A59,GOBRD13:42;
                      then left_cell(f,m,G) misses C
                      by A2,A8,A15,A16,A19,A39,A42,A45,A48,A60,A61,GOBRD13:26;
                      hence left_cell(f|(k+1),m,G) misses C
                      by A2,A8,A16,A19,A39,GOBRD13:32;

cell(G,i2-'1,j2) meets C by A2,A37,A38,A40,A41,A42,A47,A59,GOBRD13:29;
                      then right_cell(f,m,G) meets C
                      by A2,A8,A15,A16,A19,A39,A42,A45,A60,A61,GOBRD13:27;
                      hence right_cell(f|(k+1),m,G) meets C
                      by A2,A8,A16,A19,A39,GOBRD13:32;
                    end;
                  end;
                  hence thesis;
                end;
                suppose
A62:              front_left_cell(f,(len(f|k))-'1,G) misses C &
                  front_right_cell(f,(len(f|k))-'1,G) meets C;
                  then
A63:              f goes_straight (len(f|k))-'1,G by A1,A8,A15,A37,A44,Def1;
                  now per cases by A38,A41,A42,A44,A63,GOBRD13:def 8;
                    suppose that
A64:                  i1 = i2 & j1+1 = j2 and
A65:                  [i2,j2+1] in Indices G and
A66:                  f/.(len(f|k)+1) = G*(i2,j2+1);
                      front_left_cell(f,(len(f|k))-'1,G) = cell(G,i1-'1,j2)
                      by A2,A37,A38,A40,A41,A42,A64,GOBRD13:35;
                      then left_cell(f,m,G) misses C
                      by A2,A8,A15,A16,A19,A39,A42,A62,A64,A65,A66,GOBRD13:22;
                      hence left_cell(f|(k+1),m,G) misses C
                      by A2,A8,A16,A19,A39,GOBRD13:32;
                      front_right_cell(f,(len(f|k))-'1,G) = cell(G,i1,j2)
                      by A2,A37,A38,A40,A41,A42,A64,GOBRD13:36;
                      then right_cell(f,m,G) meets C
                      by A2,A8,A15,A16,A19,A39,A42,A62,A64,A65,A66,GOBRD13:23;
                      hence right_cell(f|(k+1),m,G) meets C
                      by A2,A8,A16,A19,A39,GOBRD13:32;
                    end;
                    suppose that
A67:                  i1+1 = i2 & j1 = j2 and
A68:                  [i2+1,j2] in Indices G and
A69:                  f/.(len(f|k)+1) = G*(i2+1,j2);
                      front_left_cell(f,(len(f|k))-'1,G) = cell(G,i2,j2)
                      by A2,A37,A38,A40,A41,A42,A67,GOBRD13:37;
                      then left_cell(f,m,G) misses C
                      by A2,A8,A15,A16,A19,A39,A42,A62,A68,A69,GOBRD13:24;
                      hence left_cell(f|(k+1),m,G) misses C
                      by A2,A8,A16,A19,A39,GOBRD13:32;
                      front_right_cell(f,(len(f|k))-'1,G) = cell(G,i2,j2-'1)
                      by A2,A37,A38,A40,A41,A42,A67,GOBRD13:38;
                      then right_cell(f,m,G) meets C
                      by A2,A8,A15,A16,A19,A39,A42,A62,A68,A69,GOBRD13:25;
                      hence right_cell(f|(k+1),m,G) meets C
                      by A2,A8,A16,A19,A39,GOBRD13:32;
                    end;
                    suppose that
A70:                  i1 = i2+1 & j1 = j2 and
A71:                  [i2-'1,j2] in Indices G and
A72:                  f/.(len(f|k)+1) = G*(i2-'1,j2);
                      front_left_cell(f,(len(f|k))-'1,G) = cell(G,i2-'1,j2-'1)
                      by A2,A37,A38,A40,A41,A42,A70,GOBRD13:39;
                      then left_cell(f,m,G) misses C
                      by A2,A8,A15,A16,A19,A39,A42,A45,A62,A71,A72,GOBRD13:26;
                      hence left_cell(f|(k+1),m,G) misses C
                      by A2,A8,A16,A19,A39,GOBRD13:32;
                      front_right_cell(f,(len(f|k))-'1,G) = cell(G,i2-'1,j2)
                      by A2,A37,A38,A40,A41,A42,A70,GOBRD13:40;
                      then right_cell(f,m,G) meets C
                      by A2,A8,A15,A16,A19,A39,A42,A45,A62,A71,A72,GOBRD13:27;
                      hence right_cell(f|(k+1),m,G) meets C
                      by A2,A8,A16,A19,A39,GOBRD13:32;
                    end;
                    suppose that
A73:                  i1 = i2 & j1 = j2+1 and
A74:                  [i2,j2-'1] in Indices G and
A75:                  f/.(len(f|k)+1) = G*(i2,j2-'1);
                      front_left_cell(f,(len(f|k))-'1,G) = cell(G,i2,j2-'1)
                      by A2,A37,A38,A40,A41,A42,A73,GOBRD13:41;
                      then left_cell(f,m,G) misses C
                      by A2,A8,A15,A16,A19,A39,A42,A46,A62,A74,A75,GOBRD13:28;
                      hence left_cell(f|(k+1),m,G) misses C
                      by A2,A8,A16,A19,A39,GOBRD13:32;
                      front_right_cell(f,(len(f|k))-'1,G) = cell(G,i2-'1,j2-'1
                      ) by A2,A37,A38,A40,A41,A42,A73,GOBRD13:42;
                      then right_cell(f,m,G) meets C
                      by A2,A8,A15,A16,A19,A39,A42,A46,A62,A74,A75,GOBRD13:29;
                      hence right_cell(f|(k+1),m,G) meets C
                      by A2,A8,A16,A19,A39,GOBRD13:32;
                    end;
                  end;
                  hence thesis;
                end;
                suppose
A76:              front_left_cell(f,(len(f|k))-'1,G) meets C;
                  then
A77:              f turns_left (len(f|k))-'1,G by A1,A8,A15,A37,A44,Def1;
                  now per cases by A38,A41,A42,A44,A77,GOBRD13:def 7;
                    suppose that
A78:                  i1 = i2 & j1+1 = j2 and
A79:                  [i2-'1,j2] in Indices G and
A80:                  f/.(len(f|k)+1) = G*(i2-'1,j2);
                      j2-'1 = j1 & cell(G,i1-'1,j1) misses C
                      by A2,A37,A38,A40,A41,A42,A47,A78,GOBRD13:22,NAT_D:34;
                      then left_cell(f,m,G) misses C
                      by A2,A8,A15,A16,A19,A39,A42,A45,A78,A79,A80,GOBRD13:26;
                      hence left_cell(f|(k+1),m,G) misses C
                      by A2,A8,A16,A19,A39,GOBRD13:32;
                      front_left_cell(f,(len(f|k))-'1,G) = cell(G,i1-'1,j2)
                      by A2,A37,A38,A40,A41,A42,A78,GOBRD13:35;
                      then right_cell(f,m,G) meets C

by A2,A8,A15,A16,A19,A39,A42,A45,A76,A78,A79,A80,GOBRD13:27;
                      hence right_cell(f|(k+1),m,G) meets C
                      by A2,A8,A16,A19,A39,GOBRD13:32;
                    end;
                    suppose that
A81:                  i1+1 = i2 & j1 = j2 and
A82:                  [i2,j2+1] in Indices G and
A83:                  f/.(len(f|k)+1) = G*(i2,j2+1);
                      i2-'1 = i1 & cell(G,i1,j1) misses C
                      by A2,A37,A38,A40,A41,A42,A47,A81,GOBRD13:24,NAT_D:34;
                      then left_cell(f,m,G) misses C
                      by A2,A8,A15,A16,A19,A39,A42,A81,A82,A83,GOBRD13:22;
                      hence left_cell(f|(k+1),m,G) misses C
                      by A2,A8,A16,A19,A39,GOBRD13:32;
                      front_left_cell(f,(len(f|k))-'1,G) = cell(G,i2,j2)
                      by A2,A37,A38,A40,A41,A42,A81,GOBRD13:37;
                      then right_cell(f,m,G) meets C
                      by A2,A8,A15,A16,A19,A39,A42,A76,A82,A83,GOBRD13:23;
                      hence right_cell(f|(k+1),m,G) meets C
                      by A2,A8,A16,A19,A39,GOBRD13:32;
                    end;
                    suppose that
A84:                  i1 = i2+1 & j1 = j2 and
A85:                  [i2,j2-'1] in Indices G and
A86:                  f/.(len(f|k)+1) = G*(i2,j2-'1);
                      cell(G,i2,j2-'1) misses C
                      by A2,A37,A38,A40,A41,A42,A47,A84,GOBRD13:26;
                      then left_cell(f,m,G) misses C
                      by A2,A8,A15,A16,A19,A39,A42,A46,A85,A86,GOBRD13:28;
                      hence left_cell(f|(k+1),m,G) misses C
                      by A2,A8,A16,A19,A39,GOBRD13:32;
                      front_left_cell(f,(len(f|k))-'1,G) = cell(G,i2-'1,j2-'1)
                      by A2,A37,A38,A40,A41,A42,A84,GOBRD13:39;
                      then right_cell(f,m,G) meets C
                      by A2,A8,A15,A16,A19,A39,A42,A46,A76,A85,A86,GOBRD13:29;
                      hence right_cell(f|(k+1),m,G) meets C
                      by A2,A8,A16,A19,A39,GOBRD13:32;
                    end;
                    suppose that
A87:                  i1 = i2 & j1 = j2+1 and
A88:                  [i2+1,j2] in Indices G and
A89:                  f/.(len(f|k)+1) = G*(i2+1,j2);
                      cell(G,i2,j2) misses C
                      by A2,A37,A38,A40,A41,A42,A47,A87,GOBRD13:28;
                      then left_cell(f,m,G) misses C
                      by A2,A8,A15,A16,A19,A39,A42,A88,A89,GOBRD13:24;
                      hence left_cell(f|(k+1),m,G) misses C
                      by A2,A8,A16,A19,A39,GOBRD13:32;
                      front_left_cell(f,(len(f|k))-'1,G) = cell(G,i2,j2-'1)
                      by A2,A37,A38,A40,A41,A42,A87,GOBRD13:41;
                      then right_cell(f,m,G) meets C
                      by A2,A8,A15,A16,A19,A39,A42,A76,A88,A89,GOBRD13:25;
                      hence right_cell(f|(k+1),m,G) meets C
                      by A2,A8,A16,A19,A39,GOBRD13:32;
                    end;
                  end;
                  hence thesis;
                end;
              end;
              hence thesis;
            end;
            suppose m+1 <> len(f|(k+1));
              then m+1 < len(f|(k+1)) by A19,XXREAL_0:1;
              then
A90:          m+1 <= len(f|k)by A15,A16,NAT_1:13;
              then consider i1,j1,i2,j2 being Element of NAT such that
A91:          [i1,j1] in Indices G & (f|k)/.m = G*(i1,j1) and
A92:          [i2,j2] in Indices G & (f|k)/.(m+1) = G*(i2,j2) and
A93:          i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
              i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A9,A19,JORDAN8:6;
A94:          1 <= m+1 by NAT_1:12;
              m <= len(f|k) by A90,NAT_1:13;
              then
A95:          m in dom(f|k) & m+1 in dom(f|k) by A19,A90,A94,FINSEQ_3:27;
A96:          left_cell(f|k,m,G) misses C & right_cell(f|k,m,G) meets C
              by A6,A19,A90;
              f|(k+1) = (f|k)^<*f/.(k+1)*> by A8,JORDAN8:2;
              then
A97:          (f|(k+1))/.m = G*(i1,j1) & (f|(k+1))/.(m+1) = G*(i2,j2)
              by A91,A92,A95,FINSEQ_4:83;
              now per cases by A93;
                suppose
A98:              i1 = i2 & j1+1 = j2;
                  then left_cell(f|k,m,G) = cell(G,i1-'1,j1) &
                  right_cell(f|k,m,G) = cell(G,i1,j1)
                  by A9,A19,A90,A91,A92,GOBRD13:22,23;
                  hence thesis by A10,A19,A91,A92,A96,A97,A98,GOBRD13:22,23;
                end;
                suppose
A99:              i1+1 = i2 & j1 = j2;
                  then left_cell(f|k,m,G) = cell(G,i1,j1) &
                  right_cell(f|k,m,G) = cell(G,i1,j1-'1)
                  by A9,A19,A90,A91,A92,GOBRD13:24,25;
                  hence thesis by A10,A19,A91,A92,A96,A97,A99,GOBRD13:24,25;
                end;
                suppose
A100:             i1 = i2+1 & j1 = j2;
                  then left_cell(f|k,m,G) = cell(G,i2,j2-'1) &
                  right_cell(f|k,m,G) = cell(G,i2,j2)
                  by A9,A19,A90,A91,A92,GOBRD13:26,27;
                  hence thesis by A10,A19,A91,A92,A96,A97,A100,GOBRD13:26,27;
                end;
                suppose
A101:             i1 = i2 & j1 = j2+1;
                  then left_cell(f|k,m,G) = cell(G,i2,j2) &
                  right_cell(f|k,m,G) = cell(G,i1-'1,j2)
                  by A9,A19,A90,A91,A92,GOBRD13:28,29;
                  hence thesis by A10,A19,A91,A92,A96,A97,A101,GOBRD13:28,29;
                end;
              end;
              hence thesis;
            end;
          end;
          hence thesis;
        end;
      end;
      hence thesis;
    end;
  end;
A102: for k holds P[k] from NAT_1:sch 1(A3,A5);
  f|len f = f by FINSEQ_1:79;
  hence thesis by A102;
end;

theorem
  C is connected implies N-min L~Cage(C,n) = (Cage(C,n))/.1
proof
  set f = Cage(C,n);
  assume
A1: C is connected;
  then
A2: f is_sequence_on Gauge(C,n) & (ex i st 1 <= i & i+1 <= len Gauge(C,n ) &
  f/.1 = Gauge(C,n)*(i,width Gauge(C,n)) &
  f/.2 = Gauge(C,n)*(i+1,width Gauge(C,n)) &
  N-min C in cell(Gauge(C,n),i,width Gauge(C,n)-'1) &
  N-min C <> Gauge(C,n)*(i,width Gauge(C,n)-'1)) by Def1;
  for k st 1 <= k & k+1 <= len f holds left_cell(f,k,Gauge(C,n)) misses C &
  right_cell(f,k,Gauge(C,n)) meets C by A1,Th33;
  hence thesis by A2,Th32;
end;

