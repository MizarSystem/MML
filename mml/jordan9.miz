:: Cages, external approximation of Jordan's curve
::  by Czes{\l}aw Byli\'nski and Mariusz \.Zynel
::
:: Received June 22, 1999
:: Copyright (c) 1999 Association of Mizar Users

environ

 vocabularies NUMBERS, SUBSET_1, XBOOLE_0, FINSEQ_1, XXREAL_0, ARYTM_1,
      ARYTM_3, PRE_TOPC, RELAT_2, CONNSP_1, TARSKI, RELAT_1, FINSEQ_5,
      PARTFUN1, GOBOARD1, EUCLID, REAL_1, MATRIX_1, COMPLEX1, GOBRD13, FUNCT_1,
      TOPREAL1, RFINSEQ, RLTOPSP1, GOBOARD5, TOPS_1, TREES_1, SPPOL_1, MCART_1,
      CARD_1, GOBOARD9, RCOMP_1, NAT_1, JORDAN8, PSCOMP_1, NEWTON, SPRECT_2,
      ORDINAL4, STRUCT_0, PCOMPS_1, XREAL_0, ORDINAL1, METRIC_1, JORDAN9;
 notations TARSKI, XBOOLE_0, SUBSET_1, GOBOARD5, ORDINAL1, CARD_1, NUMBERS,
      XCMPLX_0, XREAL_0, REAL_1, NAT_1, NAT_D, RELAT_1, FUNCT_1, PARTFUN1,
      FUNCT_2, COMPLEX1, FINSEQ_1, FINSEQ_2, FINSEQ_4, FINSEQ_5, NEWTON,
      RFINSEQ, STRUCT_0, XXREAL_0, MATRIX_1, METRIC_1, PRE_TOPC, TOPS_1,
      COMPTS_1, CONNSP_1, PCOMPS_1, RLTOPSP1, EUCLID, TOPREAL1, GOBOARD1,
      SPPOL_1, PSCOMP_1, SPRECT_2, GOBOARD9, JORDAN8, GOBRD13;
 constructors PARTFUN1, XXREAL_0, REAL_1, NAT_1, FINSEQ_4, NEWTON, RFINSEQ,
      NAT_D, TOPS_1, CONNSP_1, COMPTS_1, REALSET2, SPPOL_1, PSCOMP_1, GOBOARD9,
      SPRECT_2, JORDAN8, GOBRD13, RELSET_1, FUNCSDOM, RLTOPSP1, PCOMPS_1;
 registrations RELAT_1, FUNCT_1, ORDINAL1, XXREAL_0, XREAL_0, NAT_1, MEMBERED,
      FINSEQ_1, STRUCT_0, EUCLID, SPPOL_2, PSCOMP_1, GOBOARD9, SPRECT_1,
      SPRECT_2, JORDAN8, GOBRD13, NEWTON, FINSET_1;
 requirements REAL, NUMERALS, SUBSET, BOOLE, ARITHM;
 definitions TARSKI, GOBOARD1, GOBOARD5, GOBRD13, XBOOLE_0, PSCOMP_1, SEQM_3;
 theorems NAT_1, FINSEQ_1, GOBOARD1, FINSEQ_4, EUCLID, FINSEQ_3, SPPOL_2,
      TARSKI, JORDAN3, PSCOMP_1, FINSEQ_5, FINSEQ_6, GOBOARD7, TOPREAL1,
      JORDAN5B, GOBOARD5, SPRECT_2, SPPOL_1, ABSVALUE, FUNCT_1, FUNCT_2,
      GOBOARD9, FINSEQ_2, UNIFORM1, SUBSET_1, GOBRD11, SPRECT_3,
      CARD_1, RFINSEQ, GOBOARD6, TOPREAL3, TOPMETR, TOPS_1, JORDAN8, GOBRD13,
      SPRECT_4, CONNSP_1, PARTFUN2, RELSET_1, SPRECT_1, XBOOLE_0, XBOOLE_1,
      XREAL_0, XCMPLX_1, XREAL_1, NEWTON, XXREAL_0, ORDINAL1, PARTFUN1,
      MATRIX_1, NAT_D, RLTOPSP1, SEQ_4;
 schemes NAT_1, RECDEF_1;

begin :: Generalities

reserve i,j,k,n for Element of NAT,
  D for non empty set,
  f, g for FinSequence of D;

Lm1: for n st 1 <= n holds n-'1+2 = n+1
proof
  let n;
  assume
  1 <= n;
  hence n-'1+2 = n+2-'1 by NAT_D:38
    .= n+1+1 - 1 by NAT_D:37
    .= n+1;
end;

canceled 2;

theorem Th3:
  for T being non empty TopSpace for B,C1,C2,D being Subset of T st
B is connected & C1 is_a_component_of D & C2 is_a_component_of D & B meets C1 &
  B meets C2 & B c= D holds C1 = C2
proof
  let T be non empty TopSpace;
  let B,C1,C2,D be Subset of T;
  assume that
A1: B is connected and
A2: C1 is_a_component_of D & C2 is_a_component_of D and
A3: B meets C1 and
A4: B meets C2 & B c= D;
A5: B <> {} by A3,XBOOLE_1:65;
  B c= C1 & B c= C2 by A1,A2,A3,A4,GOBOARD9:6;
  hence thesis by A2,A5,GOBOARD9:3,XBOOLE_1:68;
end;

theorem Th4:
  (for n holds f|n = g|n) implies f = g
proof
  assume
A1: for n holds f|n = g|n;
A2: now
    assume
A3: len f <> len g;
    per cases by A3,XXREAL_0:1;
    suppose
A4:   len f < len g;
A5:   g|len g = g by FINSEQ_1:79;
      f|len g = f by A4,FINSEQ_1:79;
      hence contradiction by A1,A4,A5;
    end;
    suppose
A6:   len g < len f;
      then f|len f = f & g|len f = g by FINSEQ_1:79;
      hence contradiction by A1,A6;
    end;
  end;
  f|len f = f & g|len g = g by FINSEQ_1:79;
  hence thesis by A1,A2;
end;

theorem Th5:
  n in dom f implies ex k st k in dom Rev f & n+k = len f+1 & f/.n
  = (Rev f)/.k
proof
  assume
A1: n in dom f;
  take k = len f+1-'n;
  1 <= n by A1,FINSEQ_3:27;
  then k+1 <= k+n by XREAL_1:8;
  then
A2: k+1-'1 <= k+n -'1 by NAT_D:42;
A3: n <= len f by A1,FINSEQ_3:27;
  then n+1 <= len f+1 by XREAL_1:8;
  then
A4: 1 <= k by NAT_D:55;
  n <= len f+1 by A3,XREAL_1:147;
  then
A5: k+n = len f+1 by XREAL_1:237;
  then k+n-'1 = len f by NAT_D:34;
  then k <= len f by A2,NAT_D:34;
  then k in dom f by A4,FINSEQ_3:27;
  hence thesis by A1,A5,FINSEQ_5:60,69;
end;

theorem Th6:
  n in dom Rev f implies ex k st k in dom f & n+k = len f+1 & (Rev
  f)/.n = f/.k
proof
  assume
  n in dom Rev f;
  then n in dom f by FINSEQ_5:60;
  then consider k such that
A1: k in dom Rev f & n+k = len f+1 and
  f/.n = (Rev f)/.k by Th5;
A2: dom f = dom Rev f by FINSEQ_5:60;
  then (Rev f)/.n = f/.k by A1,FINSEQ_5:69;
  hence thesis by A1,A2;
end;

begin :: Go-board preliminaries

reserve G for Go-board,
  f, g for FinSequence of TOP-REAL 2,
  p for Point of
  TOP-REAL 2,
  r, s for Real,
  x for set;

theorem Th7:
  for D being non empty set for G being Matrix of D for f being
  FinSequence of D holds f is_sequence_on G iff Rev f is_sequence_on G
proof
  let D be non empty set;
  let G be Matrix of D;
  let f be FinSequence of D;
  hereby
    assume
A1: f is_sequence_on G;
A2: for n st n in dom Rev f & n+1 in dom Rev f holds for m,k,i,j being
Element of NAT st [m,k] in Indices G & [i,j] in Indices G & (Rev f)/.n = G*(m,k
    ) & (Rev f)/.(n+1) = G*(i,j) holds abs(m-i)+abs(k-j) = 1
    proof
      let n such that
A3:   n in dom Rev f and
A4:   n+1 in dom Rev f;
      consider l being Element of NAT such that
A5:   l in dom f and
A6:   n+l = len f+1 and
A7:   (Rev f)/.n = f/.l by A3,Th6;
      let m,k,i,j be Element of NAT such that
A8:   [m,k] in Indices G & [i,j] in Indices G & (Rev f)/.n = G*(m,k)
      & (Rev f)/.(n+1) = G*(i,j);
A9:   abs(i-m) = abs(m-i) & abs(j-k) = abs(k-j) by UNIFORM1:13;
      consider l9 being Element of NAT such that
A10:  l9 in dom f and
A11:  n+1+l9 = len f+1 and
A12:  (Rev f)/.(n+1) = f/.l9 by A4,Th6;
      n+(1+l9) = n+l by A6,A11;
      hence thesis by A1,A8,A5,A7,A10,A12,A9,GOBOARD1:def 11;
    end;
    for n st n in dom Rev f ex i,j st [i,j] in Indices G & (Rev f)/.n = G*
    (i,j)
    proof
      let n;
      assume
      n in dom Rev f;
      then consider k such that
A13:  k in dom f and
      n+k = len f+1 and
A14:  (Rev f)/.n = f/.k by Th6;
      consider i,j such that
A15:  [i,j] in Indices G & f/.k = G*(i,j) by A1,A13,GOBOARD1:def 11;
      take i,j;
      thus thesis by A14,A15;
    end;
    hence Rev f is_sequence_on G by A2,GOBOARD1:def 11;
  end;
  assume
A16: Rev f is_sequence_on G;
A17: for n st n in dom f & n+1 in dom f holds for m,k,i,j being Element of
NAT st [m,k] in Indices G & [i,j] in Indices G & f/.n = G*(m,k) & f/.(n+1) = G*
  (i,j) holds abs(m-i)+abs(k-j) = 1
  proof
    let n such that
A18: n in dom f and
A19: n+1 in dom f;
    consider l being Element of NAT such that
A20: l in dom Rev f and
A21: n+l = len f+1 and
A22: f/.n = (Rev f)/.l by A18,Th5;
    let m,k,i,j be Element of NAT such that
A23: [m,k] in Indices G & [i,j] in Indices G & f/.n = G*(m,k) & f/.(n+
    1) = G*(i,j);
A24: abs(i-m) = abs(m-i) & abs(j-k) = abs(k-j) by UNIFORM1:13;
    consider l9 being Element of NAT such that
A25: l9 in dom Rev f and
A26: n+1+l9 = len f+1 and
A27: f/.(n+1) = (Rev f)/.l9 by A19,Th5;
    n+(1+l9) = n+l by A21,A26;
    hence thesis by A16,A23,A20,A22,A25,A27,A24,GOBOARD1:def 11;
  end;
  for n st n in dom f ex i,j st [i,j] in Indices G & f/.n = G*(i,j)
  proof
    let n;
    assume
    n in dom f;
    then consider k such that
A28: k in dom Rev f and
    n+k = len f+1 and
A29: f/.n = (Rev f)/.k by Th5;
    consider i,j such that
A30: [i,j] in Indices G & (Rev f)/.k = G*(i,j) by A16,A28,GOBOARD1:def 11;
    take i,j;
    thus thesis by A29,A30;
  end;
  hence thesis by A17,GOBOARD1:def 11;
end;

theorem Th8:
  for G being Matrix of TOP-REAL 2 for f being FinSequence of
  TOP-REAL 2 holds f is_sequence_on G & 1 <= k & k <= len f implies f/.k in
  Values G
proof
  let G be Matrix of TOP-REAL 2;
  let f be FinSequence of TOP-REAL 2;
  assume that
A1: f is_sequence_on G and
A2: 1 <= k & k <= len f;
A3: k in dom f by A2,FINSEQ_3:27;
  then f/.k = f.k by PARTFUN1:def 8;
  then
A4: f/.k in rng f by A3,FUNCT_1:def 5;
  rng f c= Values G by A1,GOBRD13:9;
  hence thesis by A4;
end;

Lm2: f is_sequence_on G & 1 <= k & k <= len f implies ex i,j being Element of
NAT st [i,j] in Indices G & f/.k = G*(i,j)

proof
  assume that
A1: f is_sequence_on G and
A2: 1 <= k & k <= len f;
  k in dom f by A2,FINSEQ_3:27;
  then consider i,j such that
A3: [i,j] in Indices G & f/.k = G*(i,j) by A1,GOBOARD1:def 11;
  take i,j;
  thus thesis by A3;
end;

theorem Th9:
  n <= len f & x in L~(f/^n) implies ex i being Element of NAT st n
  +1 <= i & i+1 <= len f & x in LSeg(f,i)
proof
  assume that
A1: n <= len f and
A2: x in L~(f/^n);
  consider j such that
A3: 1 <= j and
A4: j+1 <= len(f/^n) and
A5: x in LSeg(f/^n,j) by A2,SPPOL_2:13;
  j+1 <= len f - n by A1,A4,RFINSEQ:def 2;
  then
A6: n+(j+1) <= len f by XREAL_1:21;
  take n+j;
  j+1 <= len f - n by A1,A4,RFINSEQ:def 2;
  hence thesis by A3,A5,A6,SPPOL_2:5,XREAL_1:8;
end;

theorem Th10:
  f is_sequence_on G & 1 <= k & k+1 <= len f implies f/.k in
  left_cell(f,k,G) & f/.k in right_cell(f,k,G)
proof
  assume that
A1: f is_sequence_on G and
A2: 1 <= k & k+1 <= len f;
  set p = f/.k;
  LSeg(f,k) = LSeg(f/.k, f/.(k+1)) by A2,TOPREAL1:def 5;
  then p in LSeg(f,k) by RLTOPSP1:69;
  then p in left_cell(f,k,G) /\ right_cell(f,k,G) by A1,A2,GOBRD13:30;
  hence thesis by XBOOLE_0:def 4;
end;

theorem Th11:
  f is_sequence_on G & 1 <= k & k+1 <= len f implies Int left_cell
  (f,k,G) <> {} & Int right_cell(f,k,G) <> {}
proof
  assume
A1: f is_sequence_on G & 1 <= k & k+1 <= len f;
  then consider i1,j1,i2,j2 being Element of NAT such that
A2: [i1,j1] in Indices G and
A3: f/.k = G*(i1,j1) and
A4: [i2,j2] in Indices G and
A5: f/.(k+1) = G*(i2,j2) and
A6: i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or i1 = i2+1 & j1 = j2 or
  i1 = i2 & j1 = j2+1 by JORDAN8:6;
A7: i2 <= len G by A4,MATRIX_1:39;
A8: i1 <= len G by A2,MATRIX_1:39;
  then
A9: i1-'1 <= len G by NAT_D:44;
A10: j2 <= width G by A4,MATRIX_1:39;
  then
A11: j2-'1 <= width G by NAT_D:44;
A12: j1+1 > j1 & j2+1 > j2 by NAT_1:13;
A13: j1 <= width G by A2,MATRIX_1:39;
  then
A14: j1-'1 <= width G by NAT_D:44;
A15: i1+1 > i1 & i2+1 > i2 by NAT_1:13;
  per cases by A6;
  suppose
    i1 = i2 & j1+1 = j2;
    then right_cell(f,k,G) = cell(G,i1,j1) & left_cell(f,k,G) = cell(G,i1-'1,
    j1) by A1,A2,A3,A4,A5,A12,GOBRD13:def 2,def 3;
    hence thesis by A8,A13,A9,GOBOARD9:17;
  end;
  suppose
    i1+1 = i2 & j1 = j2;
    then right_cell(f,k,G) = cell(G,i1,j1-'1) & left_cell(f,k,G) = cell(G,i1,
    j1) by A1,A2,A3,A4,A5,A15,GOBRD13:def 2,def 3;
    hence thesis by A8,A13,A14,GOBOARD9:17;
  end;
  suppose
    i1 = i2+1 & j1 = j2;
    then
    right_cell(f,k,G) = cell(G,i2,j2) & left_cell(f,k,G) = cell(G,i2,j2-'
    1) by A1,A2,A3,A4,A5,A15,GOBRD13:def 2,def 3;
    hence thesis by A7,A10,A11,GOBOARD9:17;
  end;
  suppose
    i1 = i2 & j1 = j2+1;
    then right_cell(f,k,G) = cell(G,i1-'1,j2) & left_cell(f,k,G) = cell(G,i1,
    j2) by A1,A2,A3,A4,A5,A12,GOBRD13:def 2,def 3;
    hence thesis by A8,A10,A9,GOBOARD9:17;
  end;
end;

theorem Th12:
  f is_sequence_on G & 1 <= k & k+1 <= len f implies Int left_cell
  (f,k,G) is connected & Int right_cell(f,k,G) is connected
proof
  assume
A1: f is_sequence_on G & 1 <= k & k+1 <= len f;
  then consider i1,j1,i2,j2 being Element of NAT such that
A2: [i1,j1] in Indices G and
A3: f/.k = G*(i1,j1) and
A4: [i2,j2] in Indices G and
A5: f/.(k+1) = G*(i2,j2) and
A6: i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or i1 = i2+1 & j1 = j2 or
  i1 = i2 & j1 = j2+1 by JORDAN8:6;
A7: i2 <= len G by A4,MATRIX_1:39;
A8: i1 <= len G by A2,MATRIX_1:39;
  then
A9: i1-'1 <= len G by NAT_D:44;
A10: j2 <= width G by A4,MATRIX_1:39;
  then
A11: j2-'1 <= width G by NAT_D:44;
A12: j1+1 > j1 & j2+1 > j2 by NAT_1:13;
A13: j1 <= width G by A2,MATRIX_1:39;
  then
A14: j1-'1 <= width G by NAT_D:44;
A15: i1+1 > i1 & i2+1 > i2 by NAT_1:13;
  per cases by A6;
  suppose
    i1 = i2 & j1+1 = j2;
    then right_cell(f,k,G) = cell(G,i1,j1) & left_cell(f,k,G) = cell(G,i1-'1,
    j1) by A1,A2,A3,A4,A5,A12,GOBRD13:def 2,def 3;
    hence thesis by A8,A13,A9,GOBOARD9:21;
  end;
  suppose
    i1+1 = i2 & j1 = j2;
    then right_cell(f,k,G) = cell(G,i1,j1-'1) & left_cell(f,k,G) = cell(G,i1,
    j1) by A1,A2,A3,A4,A5,A15,GOBRD13:def 2,def 3;
    hence thesis by A8,A13,A14,GOBOARD9:21;
  end;
  suppose
    i1 = i2+1 & j1 = j2;
    then
    right_cell(f,k,G) = cell(G,i2,j2) & left_cell(f,k,G) = cell(G,i2,j2-'
    1) by A1,A2,A3,A4,A5,A15,GOBRD13:def 2,def 3;
    hence thesis by A7,A10,A11,GOBOARD9:21;
  end;
  suppose
    i1 = i2 & j1 = j2+1;
    then right_cell(f,k,G) = cell(G,i1-'1,j2) & left_cell(f,k,G) = cell(G,i1,
    j2) by A1,A2,A3,A4,A5,A12,GOBRD13:def 2,def 3;
    hence thesis by A8,A10,A9,GOBOARD9:21;
  end;
end;

theorem Th13:
  f is_sequence_on G & 1 <= k & k+1 <= len f implies Cl Int
left_cell(f,k,G) = left_cell(f,k,G) & Cl Int right_cell(f,k,G) = right_cell(f,k
  ,G)
proof
  assume
A1: f is_sequence_on G & 1 <= k & k+1 <= len f;
  then consider i1,j1,i2,j2 being Element of NAT such that
A2: [i1,j1] in Indices G and
A3: f/.k = G*(i1,j1) and
A4: [i2,j2] in Indices G and
A5: f/.(k+1) = G*(i2,j2) and
A6: i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or i1 = i2+1 & j1 = j2 or
  i1 = i2 & j1 = j2+1 by JORDAN8:6;
A7: i2 <= len G by A4,MATRIX_1:39;
A8: i1 <= len G by A2,MATRIX_1:39;
  then
A9: i1-'1 <= len G by NAT_D:44;
A10: j2 <= width G by A4,MATRIX_1:39;
  then
A11: j2-'1 <= width G by NAT_D:44;
A12: j1+1 > j1 & j2+1 > j2 by NAT_1:13;
A13: j1 <= width G by A2,MATRIX_1:39;
  then
A14: j1-'1 <= width G by NAT_D:44;
A15: i1+1 > i1 & i2+1 > i2 by NAT_1:13;
  per cases by A6;
  suppose
    i1 = i2 & j1+1 = j2;
    then right_cell(f,k,G) = cell(G,i1,j1) & left_cell(f,k,G) = cell(G,i1-'1,
    j1) by A1,A2,A3,A4,A5,A12,GOBRD13:def 2,def 3;
    hence thesis by A8,A13,A9,GOBRD11:35;
  end;
  suppose
    i1+1 = i2 & j1 = j2;
    then right_cell(f,k,G) = cell(G,i1,j1-'1) & left_cell(f,k,G) = cell(G,i1,
    j1) by A1,A2,A3,A4,A5,A15,GOBRD13:def 2,def 3;
    hence thesis by A8,A13,A14,GOBRD11:35;
  end;
  suppose
    i1 = i2+1 & j1 = j2;
    then
    right_cell(f,k,G) = cell(G,i2,j2) & left_cell(f,k,G) = cell(G,i2,j2-'
    1) by A1,A2,A3,A4,A5,A15,GOBRD13:def 2,def 3;
    hence thesis by A7,A10,A11,GOBRD11:35;
  end;
  suppose
    i1 = i2 & j1 = j2+1;
    then right_cell(f,k,G) = cell(G,i1-'1,j2) & left_cell(f,k,G) = cell(G,i1,
    j2) by A1,A2,A3,A4,A5,A12,GOBRD13:def 2,def 3;
    hence thesis by A8,A10,A9,GOBRD11:35;
  end;
end;

theorem Th14:
  f is_sequence_on G & LSeg(f,k) is horizontal implies ex j st 1
  <= j & j <= width G & for p st p in LSeg(f,k) holds p`2 = G*(1,j)`2
proof
  assume that
A1: f is_sequence_on G and
A2: LSeg(f,k) is horizontal;
  per cases;
  suppose
A3: 1 <= k & k+1 <= len f;
    k <= k+1 by NAT_1:11;
    then k <= len f by A3,XXREAL_0:2;
    then consider i,j such that
A4: [i,j] in Indices G and
A5: f/.k = G*(i,j) by A1,A3,Lm2;
    take j;
    thus
A6: 1 <= j & j <= width G by A4,MATRIX_1:39;
A7: f/.k in LSeg(f,k) by A3,TOPREAL1:27;
    let p;
A8: 1 <= i & i <= len G by A4,MATRIX_1:39;
    assume
    p in LSeg(f,k);
    hence p`2 = (f/.k)`2 by A2,A7,SPPOL_1:def 2
      .= G*(1,j)`2 by A5,A6,A8,GOBOARD5:2;
  end;
  suppose
A9: not(1 <= k & k+1 <= len f);
    take 1;
    width G <> 0 by GOBOARD1:def 5;
    hence 1 <= 1 & 1 <= width G by NAT_1:14;
    thus thesis by A9,TOPREAL1:def 5;
  end;
end;

theorem Th15:
  f is_sequence_on G & LSeg(f,k) is vertical implies ex i st 1 <=
  i & i <= len G & for p st p in LSeg(f,k) holds p`1 = G*(i,1)`1
proof
  assume that
A1: f is_sequence_on G and
A2: LSeg(f,k) is vertical;
  per cases;
  suppose
A3: 1 <= k & k+1 <= len f;
    k <= k+1 by NAT_1:11;
    then k <= len f by A3,XXREAL_0:2;
    then consider i,j such that
A4: [i,j] in Indices G and
A5: f/.k = G*(i,j) by A1,A3,Lm2;
    take i;
    thus
A6: 1 <= i & i <= len G by A4,MATRIX_1:39;
A7: f/.k in LSeg(f,k) by A3,TOPREAL1:27;
    let p;
A8: 1 <= j & j <= width G by A4,MATRIX_1:39;
    assume
    p in LSeg(f,k);
    hence p`1 = (f/.k)`1 by A2,A7,SPPOL_1:def 3
      .= G*(i,1)`1 by A5,A6,A8,GOBOARD5:3;
  end;
  suppose
A9: not(1 <= k & k+1 <= len f);
    take 1;
    0 <> len G by GOBOARD1:def 5;
    hence 1 <= 1 & 1 <= len G by NAT_1:14;
    thus thesis by A9,TOPREAL1:def 5;
  end;
end;

theorem Th16:
  f is_sequence_on G & f is special & i <= len G & j <= width G
  implies Int cell(G,i,j) misses L~f
proof
  assume that
A1: f is_sequence_on G and
A2: f is special and
A3: i <= len G and
A4: j <= width G;
A5: Int cell(G,i,j) = Int v_strip(G,i) /\ Int h_strip(G,j) by TOPS_1:46;
  assume
  Int cell(G,i,j) meets L~f;
  then consider x being set such that
A6: x in Int cell(G,i,j) and
A7: x in L~f by XBOOLE_0:3;
  L~f = union { LSeg(f,k) : 1 <= k & k+1 <= len f } by TOPREAL1:def 6;
  then consider X being set such that
A8: x in X and
A9: X in { LSeg(f,k) : 1 <= k & k+1 <= len f } by A7,TARSKI:def 4;
  consider k such that
A10: X = LSeg(f,k) and
  1 <= k and
  k+1 <= len f by A9;
  reconsider p = x as Point of TOP-REAL 2 by A8,A10;
  per cases by A2,SPPOL_1:41;
  suppose
    LSeg(f,k) is horizontal;
    then consider j0 being Element of NAT such that
A11: 1 <= j0 and
A12: j0 <= width G and
A13: for p being Point of TOP-REAL 2 st p in LSeg(f,k) holds p`2 = G*(
    1,j0)`2 by A1,Th14;
    now
A14:  j0 > j implies j0 >= j+1 by NAT_1:13;
      assume
A15:  p in Int h_strip(G,j);
      per cases by A14,XXREAL_0:1;
      suppose
A16:    j0 < j;
        0 <> len G by GOBOARD1:def 5;
        then 1 <= len G by NAT_1:14;
        then
A17:    G*(1,j)`2 > G*(1,j0)`2 by A4,A11,A16,GOBOARD5:5;
        j >= 1 by A11,A16,XXREAL_0:2;
        then p`2 > G*(1,j)`2 by A4,A15,GOBOARD6:30;
        hence contradiction by A8,A10,A13,A17;
      end;
      suppose
        j0 = j;
        then p`2 > G*(1,j0)`2 by A11,A12,A15,GOBOARD6:30;
        hence contradiction by A8,A10,A13;
      end;
      suppose
A18:    j0 > j+1;
        then j+1 <= width G by A12,XXREAL_0:2;
        then j < width G by NAT_1:13;
        then
A19:    p`2 < G*(1,j+1)`2 by A15,GOBOARD6:31;
        0 <> len G by GOBOARD1:def 5;
        then
A20:    1 <= len G by NAT_1:14;
        j+1 >= 1 by NAT_1:14;
        then G*(1,j+1)`2 < G*(1,j0)`2 by A12,A18,A20,GOBOARD5:5;
        hence contradiction by A8,A10,A13,A19;
      end;
      suppose
A21:    j0 = j+1;
        then j < width G by A12,NAT_1:13;
        then p`2 < G*(1,j0)`2 by A15,A21,GOBOARD6:31;
        hence contradiction by A8,A10,A13;
      end;
    end;
    hence contradiction by A6,A5,XBOOLE_0:def 4;
  end;
  suppose
    LSeg(f,k) is vertical;
    then consider i0 being Element of NAT such that
A22: 1 <= i0 and
A23: i0 <= len G and
A24: for p being Point of TOP-REAL 2 st p in LSeg(f,k) holds p`1 = G*(
    i0,1)`1 by A1,Th15;
    now
A25:  i0 > i implies i0 >= i+1 by NAT_1:13;
      assume
A26:  p in Int v_strip(G,i);
      per cases by A25,XXREAL_0:1;
      suppose
A27:    i0 < i;
        0 <> width G by GOBOARD1:def 5;
        then 1 <= width G by NAT_1:14;
        then
A28:    G*(i,1)`1 > G*(i0,1)`1 by A3,A22,A27,GOBOARD5:4;
        i >= 1 by A22,A27,XXREAL_0:2;
        then p`1 > G*(i,1)`1 by A3,A26,GOBOARD6:32;
        hence contradiction by A8,A10,A24,A28;
      end;
      suppose
        i0 = i;
        then p`1 > G*(i0,1)`1 by A22,A23,A26,GOBOARD6:32;
        hence contradiction by A8,A10,A24;
      end;
      suppose
A29:    i0 > i+1;
        then i+1 <= len G by A23,XXREAL_0:2;
        then i < len G by NAT_1:13;
        then
A30:    p`1 < G*(i+1,1)`1 by A26,GOBOARD6:33;
        0 <> width G by GOBOARD1:def 5;
        then
A31:    1 <= width G by NAT_1:14;
        i+1 >= 1 by NAT_1:14;
        then G*(i+1,1)`1 < G*(i0,1)`1 by A23,A29,A31,GOBOARD5:4;
        hence contradiction by A8,A10,A24,A30;
      end;
      suppose
A32:    i0 = i+1;
        then i < len G by A23,NAT_1:13;
        then p`1 < G*(i0,1)`1 by A26,A32,GOBOARD6:33;
        hence contradiction by A8,A10,A24;
      end;
    end;
    hence contradiction by A6,A5,XBOOLE_0:def 4;
  end;
end;

theorem Th17:
  f is_sequence_on G & f is special & 1 <= k & k+1 <= len f
  implies Int left_cell(f,k,G) misses L~f & Int right_cell(f,k,G) misses L~f
proof
  assume that
A1: f is_sequence_on G and
A2: f is special and
A3: 1 <= k & k+1 <= len f;
  consider i1,j1,i2,j2 being Element of NAT such that
A4: [i1,j1] in Indices G and
A5: f/.k = G*(i1,j1) and
A6: [i2,j2] in Indices G and
A7: f/.(k+1) = G*(i2,j2) and
A8: i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or i1 = i2+1 & j1 = j2 or
  i1 = i2 & j1 = j2+1 by A1,A3,JORDAN8:6;
A9: i2 <= len G by A6,MATRIX_1:39;
A10: i1 <= len G by A4,MATRIX_1:39;
  then
A11: i1-'1 <= len G by NAT_D:44;
A12: j2 <= width G by A6,MATRIX_1:39;
  then
A13: j2-'1 <= width G by NAT_D:44;
A14: j1+1 > j1 & j2+1 > j2 by NAT_1:13;
A15: j1 <= width G by A4,MATRIX_1:39;
  then
A16: j1-'1 <= width G by NAT_D:44;
A17: i1+1 > i1 & i2+1 > i2 by NAT_1:13;
  per cases by A8;
  suppose
    i1 = i2 & j1+1 = j2;
    then right_cell(f,k,G) = cell(G,i1,j1) & left_cell(f,k,G) = cell(G,i1-'1,
    j1) by A1,A3,A4,A5,A6,A7,A14,GOBRD13:def 2,def 3;
    hence thesis by A1,A2,A10,A15,A11,Th16;
  end;
  suppose
    i1+1 = i2 & j1 = j2;
    then right_cell(f,k,G) = cell(G,i1,j1-'1) & left_cell(f,k,G) = cell(G,i1,
    j1) by A1,A3,A4,A5,A6,A7,A17,GOBRD13:def 2,def 3;
    hence thesis by A1,A2,A10,A15,A16,Th16;
  end;
  suppose
    i1 = i2+1 & j1 = j2;
    then
    right_cell(f,k,G) = cell(G,i2,j2) & left_cell(f,k,G) = cell(G,i2,j2-'
    1) by A1,A3,A4,A5,A6,A7,A17,GOBRD13:def 2,def 3;
    hence thesis by A1,A2,A9,A12,A13,Th16;
  end;
  suppose
    i1 = i2 & j1 = j2+1;
    then right_cell(f,k,G) = cell(G,i1-'1,j2) & left_cell(f,k,G) = cell(G,i1,
    j2) by A1,A3,A4,A5,A6,A7,A14,GOBRD13:def 2,def 3;
    hence thesis by A1,A2,A10,A12,A11,Th16;
  end;
end;

theorem Th18:
  1 <= i & i+1 <= len G & 1 <= j & j+1 <= width G implies G*(i,j)
`1 = G*(i,j+1)`1 & G*(i,j)`2 = G*(i+1,j)`2 & G*(i+1,j+1)`1 = G*(i+1,j)`1 & G*(i
  +1,j+1)`2 = G*(i,j+1)`2
proof
  assume that
A1: 1 <= i and
A2: i+1 <= len G and
A3: 1 <= j and
A4: j+1 <= width G;
A5: j < width G by A4,NAT_1:13;
A6: 1 <= j+1 by NAT_1:11;
A7: i < len G by A2,NAT_1:13;
  hence G*(i,j)`1 = G*(i,1)`1 by A1,A3,A5,GOBOARD5:3
    .= G*(i,j+1)`1 by A1,A4,A7,A6,GOBOARD5:3;
A8: 1 <= i+1 by NAT_1:11;
  thus G*(i,j)`2 = G*(1,j)`2 by A1,A3,A7,A5,GOBOARD5:2
    .= G*(i+1,j)`2 by A2,A3,A5,A8,GOBOARD5:2;
  thus G*(i+1,j+1)`1 = G*(i+1,1)`1 by A2,A4,A8,A6,GOBOARD5:3
    .= G*(i+1,j)`1 by A2,A3,A5,A8,GOBOARD5:3;
  thus G*(i+1,j+1)`2 = G*(1,j+1)`2 by A2,A4,A8,A6,GOBOARD5:2
    .= G*(i,j+1)`2 by A1,A4,A7,A6,GOBOARD5:2;
end;

theorem Th19:
  for i,j being Element of NAT st 1 <= i & i+1 <= len G & 1 <= j &
j+1 <= width G holds p in cell(G,i,j) iff G*(i,j)`1 <= p`1 & p`1 <= G*(i+1,j)`1
  & G*(i,j)`2 <= p`2 & p`2 <= G*(i,j+1)`2
proof
  let i,j be Element of NAT such that
A1: 1 <= i and
A2: i+1 <= len G and
A3: 1 <= j and
A4: j+1 <= width G;
A5: i < len G & j < width G by A2,A4,NAT_1:13;
  then
A6: h_strip(G,j) = { |[r,s]| : G*(i,j)`2 <= s & s <= G*(i,j+1)`2 } by A1,A3,
GOBOARD5:6;
A7: v_strip(G,i) = { |[r,s]| : G*(i,j)`1 <= r & r <= G*(i+1,j)`1 } by A1,A3,A5,
GOBOARD5:9;
  hereby
    assume
A8: p in cell(G,i,j);
    then p in v_strip(G,i) by XBOOLE_0:def 4;
    then ex r,s st |[r,s]| = p & G*(i,j)`1 <= r & r <= G*(i+1,j)`1 by A7;
    hence G*(i,j)`1 <= p`1 & p`1 <= G*(i+1,j)`1 by EUCLID:56;
    p in h_strip(G,j) by A8,XBOOLE_0:def 4;
    then ex r,s st |[r,s]| = p & G*(i,j)`2 <= s & s <= G*(i,j+1)`2 by A6;
    hence G*(i,j)`2 <= p`2 & p`2 <= G*(i,j+1)`2 by EUCLID:56;
  end;
  assume that
A9: G*(i,j)`1 <= p`1 & p`1 <= G*(i+1,j)`1 and
A10: G*(i,j)`2 <= p`2 & p`2 <= G*(i,j+1)`2;
A11: p = |[p`1,p`2]| by EUCLID:57;
  then
A12: p in h_strip(G,j) by A6,A10;
  p in v_strip(G,i) by A7,A9,A11;
  hence thesis by A12,XBOOLE_0:def 4;
end;

theorem
  1 <= i & i+1 <= len G & 1 <= j & j+1 <= width G implies cell(G,i,j) =
{ |[r,s]| : G*(i,j)`1 <= r & r <= G*(i+1,j)`1 & G*(i,j)`2 <= s & s <= G*(i,j+1)
  `2 }
proof
  set A = { |[r,s]| : G*(i,j)`1 <= r & r <= G*(i+1,j)`1 & G*(i,j)`2 <= s & s
  <= G*(i,j+1)`2 };
  assume
A1: 1 <= i & i+1 <= len G & 1 <= j & j+1 <= width G;
  now
    let p be set;
    assume
A2: p in cell(G,i,j);
    then reconsider q=p as Point of TOP-REAL 2;
A3: G*(i,j)`2 <= q`2 & q`2 <= G*(i,j+1)`2 by A1,A2,Th19;
A4: p = |[q`1,q`2]| by EUCLID:57;
    G*(i,j)`1 <= q`1 & q`1 <= G*(i+1,j)`1 by A1,A2,Th19;
    hence p in A by A4,A3;
  end;
  hence cell(G,i,j) c= A by TARSKI:def 3;
  now
    let p be set;
    assume
    p in A;
    then consider r,s such that
A5: |[r,s]| = p and
A6: G*(i,j)`1 <= r & r <= G*(i+1,j)`1 & G*(i,j)`2 <= s & s <= G*(i,j+
    1)`2;
    reconsider q=p as Point of TOP-REAL 2 by A5;
    r = q`1 & s = q`2 by A5,EUCLID:56;
    hence p in cell(G,i,j) by A1,A6,Th19;
  end;
  hence thesis by TARSKI:def 3;
end;

theorem Th21:
  1 <= i & i+1 <= len G & 1 <= j & j+1 <= width G & p in Values G
& p in cell(G,i,j) implies p = G*(i,j) or p = G*(i,j+1) or p = G*(i+1,j+1) or p
  = G*(i+1,j)
proof
  assume that
A1: 1 <= i and
A2: i+1 <= len G and
A3: 1 <= j and
A4: j+1 <= width G and
A5: p in Values G and
A6: p in cell(G,i,j);
A7: Values G = { G*(k,l) where k,l is Element of NAT: [k,l] in Indices G }
  by GOBRD13:7;
A8: i < len G by A2,NAT_1:13;
A9: j < width G by A4,NAT_1:13;
  consider k,l being Element of NAT such that
A10: p = G*(k,l) and
A11: [k,l] in Indices G by A5,A7;
A12: 1 <= k by A11,MATRIX_1:39;
A13: l <= width G by A11,MATRIX_1:39;
A14: 1 <= l by A11,MATRIX_1:39;
A15: k <= len G by A11,MATRIX_1:39;
A16: 1 <= j+1 by NAT_1:11;
A17: now
    assume
A18: l <> j & l <> j+1;
    per cases by A18,NAT_1:9;
    suppose
      l < j;
      then G*(k,l)`2 < G*(k,j)`2 by A9,A12,A15,A14,GOBOARD5:5;
      then G*(k,l)`2 < G*(1,j)`2 by A3,A9,A12,A15,GOBOARD5:2;
      then G*(k,l)`2 < G*(i,j)`2 by A1,A3,A8,A9,GOBOARD5:2;
      hence contradiction by A1,A2,A3,A4,A6,A10,Th19;
    end;
    suppose
      j+1 < l;
      then G*(k,j+1)`2 < G*(k,l)`2 by A16,A12,A15,A13,GOBOARD5:5;
      then G*(1,j+1)`2 < G*(k,l)`2 by A4,A16,A12,A15,GOBOARD5:2;
      then G*(i,j+1)`2 < G*(k,l)`2 by A1,A4,A8,A16,GOBOARD5:2;
      hence contradiction by A1,A2,A3,A4,A6,A10,Th19;
    end;
  end;
A19: 1 <= i+1 by NAT_1:11;
  now
    assume
A20: k <> i & k <> i+1;
    per cases by A20,NAT_1:9;
    suppose
      k < i;
      then G*(k,l)`1 < G*(i,l)`1 by A8,A12,A14,A13,GOBOARD5:4;
      then G*(k,l)`1 < G*(i,1)`1 by A1,A8,A14,A13,GOBOARD5:3;
      then G*(k,l)`1 < G*(i,j)`1 by A1,A3,A8,A9,GOBOARD5:3;
      hence contradiction by A1,A2,A3,A4,A6,A10,Th19;
    end;
    suppose
      i+1 < k;
      then G*(i+1,l)`1 < G*(k,l)`1 by A19,A15,A14,A13,GOBOARD5:4;
      then G*(i+1,1)`1 < G*(k,l)`1 by A2,A19,A14,A13,GOBOARD5:3;
      then G*(i+1,j)`1 < G*(k,l)`1 by A2,A3,A9,A19,GOBOARD5:3;
      hence contradiction by A1,A2,A3,A4,A6,A10,Th19;
    end;
  end;
  hence thesis by A10,A17;
end;

theorem Th22:
  1 <= i & i+1 <= len G & 1 <= j & j+1 <= width G implies G*(i,j)
in cell(G,i,j) & G*(i,j+1) in cell(G,i,j) & G*(i+1,j+1) in cell(G,i,j) & G*(i+1
  ,j) in cell(G,i,j)
proof
  assume that
A1: 1 <= i and
A2: i+1 <= len G and
A3: 1 <= j and
A4: j+1 <= width G;
A5: i < i+1 & j < width G by A4,NAT_1:13;
  then
A6: G*(i,j)`1 <= G*(i+1,j)`1 by A1,A2,A3,GOBOARD5:4;
A7: G*(i,j)`1 <= G*(i+1,j)`1 by A1,A2,A3,A5,GOBOARD5:4;
A8: j < j+1 & i < len G by A2,NAT_1:13;
  then
A9: G*(i,j)`2 <= G*(i,j+1)`2 by A1,A3,A4,GOBOARD5:5;
A10: G*(i+1,j+1)`1 = G*(i+1,j)`1 by A1,A2,A3,A4,Th18;
  then
A11: G*(i,j)`1 <= G*(i+1,j+1)`1 by A1,A2,A3,A5,GOBOARD5:4;
  G*(i,j)`2 <= G*(i,j+1)`2 by A1,A3,A4,A8,GOBOARD5:5;
  hence G*(i,j) in cell(G,i,j) by A1,A2,A3,A4,A6,Th19;
A12: G*(i,j)`1 = G*(i,j+1)`1 by A1,A2,A3,A4,Th18;
  then G*(i,j+1)`1 <= G*(i+1,j)`1 by A1,A2,A3,A5,GOBOARD5:4;
  hence G*(i,j+1) in cell(G,i,j) by A1,A2,A3,A4,A12,A9,Th19;
A13: G*(i+1,j+1)`2 = G*(i,j+1)`2 by A1,A2,A3,A4,Th18;
  then G*(i,j)`2 <= G*(i+1,j+1)`2 by A1,A3,A4,A8,GOBOARD5:5;
  hence G*(i+1,j+1) in cell(G,i,j) by A1,A2,A3,A4,A10,A11,A13,Th19;
A14: G*(i,j)`2 = G*(i+1,j)`2 by A1,A2,A3,A4,Th18;
  then G*(i+1,j)`2 <= G*(i,j+1)`2 by A1,A3,A4,A8,GOBOARD5:5;
  hence thesis by A1,A2,A3,A4,A7,A14,Th19;
end;

theorem Th23:
  1 <= i & i+1 <= len G & 1 <= j & j+1 <= width G & p in Values G
  & p in cell(G,i,j) implies p is_extremal_in cell(G,i,j)
proof
  assume that
A1: 1 <= i & i+1 <= len G & 1 <= j & j+1 <= width G and
A2: p in Values G and
A3: p in cell(G,i,j);
  for a,b being Point of TOP-REAL 2 st p in LSeg(a,b) & LSeg(a,b) c= cell(
  G,i,j) holds p = a or p = b
  proof
    let a,b be Point of TOP-REAL 2 such that
A4: p in LSeg(a,b) and
A5: LSeg(a,b) c= cell(G,i,j);
A6: a in LSeg(a,b) by RLTOPSP1:69;
A7: b in LSeg(a,b) by RLTOPSP1:69;
    assume that
A8: a <> p and
A9: b <> p;
    per cases by A1,A2,A3,Th21;
    suppose
A10:  p = G*(i,j);
      then
A11:  p`2 <= b`2 by A1,A5,A7,Th19;
A12:  p`1 <= a`1 by A1,A5,A6,A10,Th19;
A13:  p`1 <= b`1 by A1,A5,A7,A10,Th19;
A14:  p`2 <= a`2 by A1,A5,A6,A10,Th19;
      now
        per cases;
        suppose
A15:      a`1 <= b`1 & a`2 <= b`2;
          then a`2 <= p`2 by A4,TOPREAL1:10;
          then
A16:      a`2 = p`2 by A14,XXREAL_0:1;
          a`1 <= p`1 by A4,A15,TOPREAL1:9;
          then a`1 = p`1 by A12,XXREAL_0:1;
          hence contradiction by A8,A16,TOPREAL3:11;
        end;
        suppose
A17:      a`1 <= b`1 & b`2 < a`2;
          then b`2 <= p`2 by A4,TOPREAL1:10;
          then
A18:      b`2 = p`2 by A11,XXREAL_0:1;
A19:      a`1 <= p`1 by A4,A17,TOPREAL1:9;
          then
A20:      a`1 = p`1 by A12,XXREAL_0:1;
          then a`2 <> p`2 by A8,TOPREAL3:11;
          then LSeg(a,b) is vertical by A4,A6,A12,A19,SPPOL_1:39,XXREAL_0:1;
          then a`1 = b`1 by SPPOL_1:37;
          hence contradiction by A9,A20,A18,TOPREAL3:11;
        end;
        suppose
A21:      b`1 < a`1 & a`2 <= b`2;
          then a`2 <= p`2 by A4,TOPREAL1:10;
          then
A22:      a`2 = p`2 by A14,XXREAL_0:1;
A23:      b`1 <= p`1 by A4,A21,TOPREAL1:9;
          then
A24:      b`1 = p`1 by A13,XXREAL_0:1;
          then b`2 <> p`2 by A9,TOPREAL3:11;
          then LSeg(a,b) is vertical by A4,A7,A13,A23,SPPOL_1:39,XXREAL_0:1;
          then a`1 = b`1 by SPPOL_1:37;
          hence contradiction by A8,A24,A22,TOPREAL3:11;
        end;
        suppose
A25:      b`1 < a`1 & b`2 < a`2;
          then b`2 <= p`2 by A4,TOPREAL1:10;
          then
A26:      b`2 = p`2 by A11,XXREAL_0:1;
          b`1 <= p`1 by A4,A25,TOPREAL1:9;
          then b`1 = p`1 by A13,XXREAL_0:1;
          hence contradiction by A9,A26,TOPREAL3:11;
        end;
      end;
      hence contradiction;
    end;
    suppose
A27:  p = G*(i,j+1);
      then
A28:  b`2 <= p`2 by A1,A5,A7,Th19;
A29:  p`1 = G*(i,j)`1 by A1,A27,Th18;
      then
A30:  p`1 <= a`1 by A1,A5,A6,Th19;
A31:  p`1 <= b`1 by A1,A5,A7,A29,Th19;
A32:  a`2 <= p`2 by A1,A5,A6,A27,Th19;
      now
        per cases;
        suppose
A33:      a`1 <= b`1 & a`2 <= b`2;
          then p`2 <= b`2 by A4,TOPREAL1:10;
          then
A34:      b`2 = p`2 by A28,XXREAL_0:1;
A35:      a`1 <= p`1 by A4,A33,TOPREAL1:9;
          then
A36:      a`1 = p`1 by A30,XXREAL_0:1;
          then a`2 <> p`2 by A8,TOPREAL3:11;
          then LSeg(a,b) is vertical by A4,A6,A30,A35,SPPOL_1:39,XXREAL_0:1;
          then a`1 = b`1 by SPPOL_1:37;
          hence contradiction by A9,A36,A34,TOPREAL3:11;
        end;
        suppose
A37:      a`1 <= b`1 & b`2 < a`2;
          then p`2 <= a`2 by A4,TOPREAL1:10;
          then
A38:      a`2 = p`2 by A32,XXREAL_0:1;
          a`1 <= p`1 by A4,A37,TOPREAL1:9;
          then a`1 = p`1 by A30,XXREAL_0:1;
          hence contradiction by A8,A38,TOPREAL3:11;
        end;
        suppose
A39:      b`1 < a`1 & a`2 <= b`2;
          then p`2 <= b`2 by A4,TOPREAL1:10;
          then
A40:      b`2 = p`2 by A28,XXREAL_0:1;
          b`1 <= p`1 by A4,A39,TOPREAL1:9;
          then b`1 = p`1 by A31,XXREAL_0:1;
          hence contradiction by A9,A40,TOPREAL3:11;
        end;
        suppose
A41:      b`1 < a`1 & b`2 < a`2;
          then p`2 <= a`2 by A4,TOPREAL1:10;
          then
A42:      a`2 = p`2 by A32,XXREAL_0:1;
A43:      b`1 <= p`1 by A4,A41,TOPREAL1:9;
          then
A44:      b`1 = p`1 by A31,XXREAL_0:1;
          then b`2 <> p`2 by A9,TOPREAL3:11;
          then LSeg(a,b) is vertical by A4,A7,A31,A43,SPPOL_1:39,XXREAL_0:1;
          then a`1 = b`1 by SPPOL_1:37;
          hence contradiction by A8,A44,A42,TOPREAL3:11;
        end;
      end;
      hence contradiction;
    end;
    suppose
A45:  p = G*(i+1,j+1);
      then
A46:  p`1 = G*(i+1,j)`1 by A1,Th18;
      then
A47:  a`1 <= p`1 by A1,A5,A6,Th19;
A48:  p`2 = G*(i,j+1)`2 by A1,A45,Th18;
      then
A49:  b`2 <= p`2 by A1,A5,A7,Th19;
A50:  b`1 <= p`1 by A1,A5,A7,A46,Th19;
A51:  a`2 <= p`2 by A1,A5,A6,A48,Th19;
      now
        per cases;
        suppose
A52:      a`1 <= b`1 & a`2 <= b`2;
          then p`2 <= b`2 by A4,TOPREAL1:10;
          then
A53:      b`2 = p`2 by A49,XXREAL_0:1;
          p`1 <= b`1 by A4,A52,TOPREAL1:9;
          then b`1 = p`1 by A50,XXREAL_0:1;
          hence contradiction by A9,A53,TOPREAL3:11;
        end;
        suppose
A54:      a`1 <= b`1 & b`2 < a`2;
          then p`2 <= a`2 by A4,TOPREAL1:10;
          then
A55:      a`2 = p`2 by A51,XXREAL_0:1;
A56:      p`1 <= b`1 by A4,A54,TOPREAL1:9;
          then
A57:      b`1 = p`1 by A50,XXREAL_0:1;
          then b`2 <> p`2 by A9,TOPREAL3:11;
          then LSeg(a,b) is vertical by A4,A7,A50,A56,SPPOL_1:39,XXREAL_0:1;
          then a`1 = b`1 by SPPOL_1:37;
          hence contradiction by A8,A57,A55,TOPREAL3:11;
        end;
        suppose
A58:      b`1 < a`1 & a`2 <= b`2;
          then p`2 <= b`2 by A4,TOPREAL1:10;
          then
A59:      b`2 = p`2 by A49,XXREAL_0:1;
A60:      p`1 <= a`1 by A4,A58,TOPREAL1:9;
          then
A61:      a`1 = p`1 by A47,XXREAL_0:1;
          then a`2 <> p`2 by A8,TOPREAL3:11;
          then LSeg(a,b) is vertical by A4,A6,A47,A60,SPPOL_1:39,XXREAL_0:1;
          then a`1 = b`1 by SPPOL_1:37;
          hence contradiction by A9,A61,A59,TOPREAL3:11;
        end;
        suppose
A62:      b`1 < a`1 & b`2 < a`2;
          then p`2 <= a`2 by A4,TOPREAL1:10;
          then
A63:      a`2 = p`2 by A51,XXREAL_0:1;
          p`1 <= a`1 by A4,A62,TOPREAL1:9;
          then a`1 = p`1 by A47,XXREAL_0:1;
          hence contradiction by A8,A63,TOPREAL3:11;
        end;
      end;
      hence contradiction;
    end;
    suppose
A64:  p = G*(i+1,j);
      then
A65:  p`2 = G*(i,j)`2 by A1,Th18;
      then
A66:  p`2 <= b`2 by A1,A5,A7,Th19;
A67:  a`1 <= p`1 by A1,A5,A6,A64,Th19;
A68:  b`1 <= p`1 by A1,A5,A7,A64,Th19;
A69:  p`2 <= a`2 by A1,A5,A6,A65,Th19;
      now
        per cases;
        suppose
A70:      a`1 <= b`1 & a`2 <= b`2;
          then a`2 <= p`2 by A4,TOPREAL1:10;
          then
A71:      a`2 = p`2 by A69,XXREAL_0:1;
A72:      p`1 <= b`1 by A4,A70,TOPREAL1:9;
          then
A73:      b`1 = p`1 by A68,XXREAL_0:1;
          then b`2 <> p`2 by A9,TOPREAL3:11;
          then LSeg(a,b) is vertical by A4,A7,A68,A72,SPPOL_1:39,XXREAL_0:1;
          then a`1 = b`1 by SPPOL_1:37;
          hence contradiction by A8,A73,A71,TOPREAL3:11;
        end;
        suppose
A74:      a`1 <= b`1 & b`2 < a`2;
          then b`2 <= p`2 by A4,TOPREAL1:10;
          then
A75:      b`2 = p`2 by A66,XXREAL_0:1;
          p`1 <= b`1 by A4,A74,TOPREAL1:9;
          then b`1 = p`1 by A68,XXREAL_0:1;
          hence contradiction by A9,A75,TOPREAL3:11;
        end;
        suppose
A76:      b`1 < a`1 & a`2 <= b`2;
          then a`2 <= p`2 by A4,TOPREAL1:10;
          then
A77:      a`2 = p`2 by A69,XXREAL_0:1;
          p`1 <= a`1 by A4,A76,TOPREAL1:9;
          then a`1 = p`1 by A67,XXREAL_0:1;
          hence contradiction by A8,A77,TOPREAL3:11;
        end;
        suppose
A78:      b`1 < a`1 & b`2 < a`2;
          then b`2 <= p`2 by A4,TOPREAL1:10;
          then
A79:      b`2 = p`2 by A66,XXREAL_0:1;
A80:      p`1 <= a`1 by A4,A78,TOPREAL1:9;
          then
A81:      a`1 = p`1 by A67,XXREAL_0:1;
          then a`2 <> p`2 by A8,TOPREAL3:11;
          then LSeg(a,b) is vertical by A4,A6,A67,A80,SPPOL_1:39,XXREAL_0:1;
          then a`1 = b`1 by SPPOL_1:37;
          hence contradiction by A9,A81,A79,TOPREAL3:11;
        end;
      end;
      hence contradiction;
    end;
  end;
  hence thesis by A3,SPPOL_1:def 1;
end;

theorem Th24:
  2 <= len G & 2 <= width G & f is_sequence_on G & 1 <= k & k+1 <=
len f implies ex i,j st 1 <= i & i+1 <= len G & 1 <= j & j+1 <= width G & LSeg(
  f,k) c= cell(G,i,j)
proof
  assume that
A1: 2 <= len G and
A2: 2 <= width G and
A3: f is_sequence_on G and
A4: 1 <= k & k+1 <= len f;
  consider i1,j1,i2,j2 being Element of NAT such that
A5: [i1,j1] in Indices G and
A6: f/.k = G*(i1,j1) and
A7: [i2,j2] in Indices G and
A8: f/.(k+1) = G*(i2,j2) and
A9: i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or i1 = i2+1 & j1 = j2
  or i1 = i2 & j1 = j2+1 by A3,A4,JORDAN8:6;
A10: LSeg(f,k) = LSeg(f/.k, f/.(k+1)) by A4,TOPREAL1:def 5;
A11: 1 <= i2 by A7,MATRIX_1:39;
A12: 1 <= i1 by A5,MATRIX_1:39;
A13: 1 <= j2 by A7,MATRIX_1:39;
A14: 1 <= j1 by A5,MATRIX_1:39;
A15: i2 <= len G by A7,MATRIX_1:39;
A16: i1 <= len G by A5,MATRIX_1:39;
A17: j2 <= width G by A7,MATRIX_1:39;
A18: j1 <= width G by A5,MATRIX_1:39;
  per cases by A9;
  suppose
A19: i1 = i2 & j1+1 = j2;
    then
A20: j1 < width G by A17,XREAL_1:147;
    now
      per cases by A16,XXREAL_0:1;
      suppose
A21:    i1 < len G;
        take i1,j1;
A22:    i1+1 <= len G by A21,NAT_1:13;
        LSeg(f,k) c= cell(G,i1,j1) by A10,A6,A8,A12,A16,A14,A17,A19,GOBOARD5:20
,XREAL_1:147;
        hence thesis by A12,A14,A17,A19,A22;
      end;
      suppose
A23:    i1 = len G;
        take i19=i1-'1,j1;
        2-1 <= 2-'1 & 2-'1 <= i19 by A1,A23,NAT_D:42,XREAL_0:def 2;
        then
A24:    1 <= i19 by XXREAL_0:2;
A25:    i19+1 = i1 by A12,XREAL_1:237;
        then i19 < len G by A16,NAT_1:13;
        then LSeg(f,k) c= cell(G,i19,j1) by A10,A6,A8,A14,A19,A20,A25,
GOBOARD5:19;
        hence thesis by A16,A14,A17,A19,A24,A25;
      end;
    end;
    hence thesis;
  end;
  suppose
A26: i1+1 = i2 & j1 = j2;
    then
A27: i1 < len G by A15,XREAL_1:147;
    now
      per cases by A18,XXREAL_0:1;
      suppose
A28:    j1 < width G;
        take i1,j1;
A29:    j1+1 <= width G by A28,NAT_1:13;
        LSeg(f,k) c= cell(G,i1,j1) by A10,A6,A8,A12,A14,A18,A15,A26,GOBOARD5:23
,XREAL_1:147;
        hence thesis by A12,A14,A15,A26,A29;
      end;
      suppose
A30:    j1 = width G;
        take i1,j19=j1-'1;
        2-1 <= 2-'1 & 2-'1 <= j19 by A2,A30,NAT_D:42,XREAL_0:def 2;
        then
A31:    1 <= j19 by XXREAL_0:2;
A32:    j19+1=j1 by A14,XREAL_1:237;
        then j19 < width G by A30,NAT_1:13;
        then LSeg(f,k) c= cell(G,i1,j19) by A10,A6,A8,A12,A26,A27,A32,
GOBOARD5:22;
        hence thesis by A12,A18,A15,A26,A31,A32;
      end;
    end;
    hence thesis;
  end;
  suppose
A33: i1 = i2+1 & j1 = j2;
    then
A34: i2 < len G by A16,XREAL_1:147;
    now
      per cases by A18,XXREAL_0:1;
      suppose
A35:    j1 < width G;
        take i2,j1;
A36:    j1+1 <= width G by A35,NAT_1:13;
        LSeg(f,k) c= cell(G,i2,j1) by A10,A6,A8,A16,A11,A13,A17,A33,GOBOARD5:23
,XREAL_1:147;
        hence thesis by A16,A14,A11,A33,A36;
      end;
      suppose
A37:    j1 = width G;
        take i2,j19=j1-'1;
        2-1 <= 2-'1 & 2-'1 <= j19 by A2,A37,NAT_D:42,XREAL_0:def 2;
        then
A38:    1 <= j19 by XXREAL_0:2;
A39:    j19+1=j1 by A14,XREAL_1:237;
        then j19 < width G by A37,NAT_1:13;
        then LSeg(f,k) c= cell(G,i2,j19) by A10,A6,A8,A11,A33,A34,A39,
GOBOARD5:22;
        hence thesis by A16,A18,A11,A33,A38,A39;
      end;
    end;
    hence thesis;
  end;
  suppose
A40: i1 = i2 & j1 = j2+1;
    then
A41: j2 < width G by A18,XREAL_1:147;
    now
      per cases by A16,XXREAL_0:1;
      suppose
A42:    i1 < len G;
        take i1,j2;
A43:    i1+1 <= len G by A42,NAT_1:13;
        LSeg(f,k) c= cell(G,i1,j2) by A10,A6,A8,A18,A11,A15,A13,A40,GOBOARD5:20
,XREAL_1:147;
        hence thesis by A12,A18,A13,A40,A43;
      end;
      suppose
A44:    i1 = len G;
        take i19=i1-'1,j2;
        2-1 <= 2-'1 & 2-'1 <= i19 by A1,A44,NAT_D:42,XREAL_0:def 2;
        then
A45:    1 <= i19 by XXREAL_0:2;
A46:    i19+1 = i1 by A12,XREAL_1:237;
        then i19 < len G by A16,NAT_1:13;
        then LSeg(f,k) c= cell(G,i19,j2) by A10,A6,A8,A13,A40,A41,A46,
GOBOARD5:19;
        hence thesis by A16,A18,A13,A40,A45,A46;
      end;
    end;
    hence thesis;
  end;
end;

theorem Th25:
  2 <= len G & 2 <= width G & f is_sequence_on G & 1 <= k & k+1 <=
  len f & p in Values G & p in LSeg(f,k) implies p = f/.k or p = f/.(k+1)
proof
  assume that
A1: 2 <= len G & 2 <= width G & f is_sequence_on G and
A2: 1 <= k & k+1 <= len f and
A3: p in Values G and
A4: p in LSeg(f,k);
A5: LSeg(f,k) = LSeg(f/.k, f/.(k+1)) by A2,TOPREAL1:def 5;
  consider i,j such that
A6: 1 <= i & i+1 <= len G & 1 <= j & j+1 <= width G and
A7: LSeg(f,k) c= cell(G,i,j) by A1,A2,Th24;
  p is_extremal_in cell(G,i,j) by A3,A4,A6,A7,Th23;
  hence thesis by A4,A7,A5,SPPOL_1:def 1;
end;

theorem
  [i,j] in Indices G & 1 <= k & k <= width G implies G*(i,j)`1 <= G* (
  len G,k)`1
proof
  assume that
A1: [i,j] in Indices G and
A2: 1 <= k & k <= width G;
A3: 1 <= i by A1,MATRIX_1:39;
A4: i <= len G by A1,MATRIX_1:39;
  then
A5: i < len G or i = len G by XXREAL_0:1;
  1 <= j & j <= width G by A1,MATRIX_1:39;
  then G*(i,j)`1 = G*(i,1)`1 by A3,A4,GOBOARD5:3
    .= G*(i,k)`1 by A2,A3,A4,GOBOARD5:3;
  hence thesis by A2,A3,A5,GOBOARD5:4;
end;

theorem
  [i,j] in Indices G & 1 <= k & k <= len G implies G*(i,j)`2 <= G* (k,
  width G)`2
proof
  assume that
A1: [i,j] in Indices G and
A2: 1 <= k & k <= len G;
A3: 1 <= j by A1,MATRIX_1:39;
A4: j <= width G by A1,MATRIX_1:39;
  then
A5: j < width G or j = width G by XXREAL_0:1;
  1 <= i & i <= len G by A1,MATRIX_1:39;
  then G*(i,j)`2 = G*(1,j)`2 by A3,A4,GOBOARD5:2
    .= G*(k,j)`2 by A2,A3,A4,GOBOARD5:2;
  hence thesis by A2,A3,A5,GOBOARD5:5;
end;

theorem Th28:
  f is_sequence_on G & f is special & L~g c= L~f & 1 <= k & k+1 <=
len f implies for A being Subset of TOP-REAL 2 st A = right_cell(f,k,G)\L~g or
  A = left_cell(f,k,G)\L~g holds A is connected
proof
  assume that
A1: f is_sequence_on G and
A2: f is special and
A3: L~g c= L~f and
A4: 1 <= k & k+1 <= len f;
  let A be Subset of TOP-REAL 2 such that
A5: A = right_cell(f,k,G)\L~g or A = left_cell(f,k,G)\L~g;
  per cases by A5;
  suppose
A6: A = right_cell(f,k,G)\L~g;
    Int right_cell(f,k,G) misses L~f by A1,A2,A4,Th17;
    then Int right_cell(f,k,G) misses L~g by A3,XBOOLE_1:63;
    then
A7: Int right_cell(f,k,G) c= (L~g)` by SUBSET_1:43;
    A c= right_cell(f,k,G) by A6,XBOOLE_1:36;
    then
A8: A c= Cl Int right_cell(f,k,G) by A1,A4,Th13;
A9: A = right_cell(f,k,G) /\ (L~g)` by A6,SUBSET_1:32;
    Int right_cell(f,k,G) is connected & Int right_cell(f,k,G) c=
    right_cell(f,k,G) by A1,A4,Th12,TOPS_1:44;
    hence thesis by A9,A7,A8,CONNSP_1:19,XBOOLE_1:19;
  end;
  suppose
A10: A = left_cell(f,k,G)\L~g;
    Int left_cell(f,k,G) misses L~f by A1,A2,A4,Th17;
    then Int left_cell(f,k,G) misses L~g by A3,XBOOLE_1:63;
    then
A11: Int left_cell(f,k,G) c= (L~g)` by SUBSET_1:43;
    A c= left_cell(f,k,G) by A10,XBOOLE_1:36;
    then
A12: A c= Cl Int left_cell(f,k,G) by A1,A4,Th13;
A13: A = left_cell(f,k,G) /\ (L~g)` by A10,SUBSET_1:32;
    Int left_cell(f,k,G) is connected & Int left_cell(f,k,G) c= left_cell
    (f,k,G) by A1,A4,Th12,TOPS_1:44;
    hence thesis by A13,A11,A12,CONNSP_1:19,XBOOLE_1:19;
  end;
end;

theorem Th29:
  for f being non constant standard special_circular_sequence st f
is_sequence_on G for k st 1 <= k & k+1 <= len f holds right_cell(f,k,G)\L~f c=
  RightComp f & left_cell(f,k,G)\L~f c= LeftComp f
proof
  let f be non constant standard special_circular_sequence such that
A1: f is_sequence_on G;
  let k such that
A2: 1 <= k & k+1 <= len f;
A3: Int right_cell(f,k,G) <> {} by A1,A2,Th11;
  set rc = right_cell(f,k,G)\L~f;
  rc \/ L~f = right_cell(f,k,G) \/ L~f by XBOOLE_1:39;
  then
  Int right_cell(f,k,G) c= right_cell(f,k,G) & right_cell(f,k,G) c= rc \/
  L~f by TOPS_1:44,XBOOLE_1:7;
  then
A4: Int right_cell(f,k,G) c= rc \/ L~f by XBOOLE_1:1;
  set lc = left_cell(f,k,G)\L~f;
  rc = right_cell(f,k,G) /\ (L~f)` by SUBSET_1:32;
  then
A5: RightComp f is_a_component_of (L~f)` & rc c= (L~f)` by GOBOARD9:def 2
,XBOOLE_1:17;
  rc c= right_cell(f,k,G) & right_cell(f,k,G) c= right_cell(f,k) by A1,A2,
GOBRD13:34,XBOOLE_1:36;
  then rc c= right_cell(f,k) by XBOOLE_1:1;
  then
A6: Int rc c= Int right_cell(f,k) by TOPS_1:48;
  Int right_cell(f,k) c= RightComp f by A2,GOBOARD9:28;
  then
A7: Int rc c= RightComp f by A6,XBOOLE_1:1;
  Int right_cell(f,k,G) misses L~f by A1,A2,Th17;
  then
A8: Int Int right_cell(f,k,G) c= Int rc by A4,TOPS_1:48,XBOOLE_1:73;
  Int right_cell(f,k,G) c= rc by A1,A2,A4,Th17,XBOOLE_1:73;
  then
A9: rc meets Int rc by A3,A8,XBOOLE_1:68;
  rc is connected by A1,A2,Th28;
  hence right_cell(f,k,G)\L~f c= RightComp f by A7,A9,A5,GOBOARD9:6;
  lc = left_cell(f,k,G) /\ (L~f)` by SUBSET_1:32;
  then
A10: LeftComp f is_a_component_of (L~f)` & lc c= (L~f)` by GOBOARD9:def 1
,XBOOLE_1:17;
  lc \/ L~f = left_cell(f,k,G) \/ L~f by XBOOLE_1:39;
  then
  Int left_cell(f,k,G) c= left_cell(f,k,G) & left_cell(f,k,G) c= lc \/ L~
  f by TOPS_1:44,XBOOLE_1:7;
  then
A11: Int left_cell(f,k,G) c= lc \/ L~f by XBOOLE_1:1;
  lc c= left_cell(f,k,G) & left_cell(f,k,G) c= left_cell(f,k) by A1,A2,
GOBRD13:34,XBOOLE_1:36;
  then lc c= left_cell(f,k) by XBOOLE_1:1;
  then
A12: Int lc c= Int left_cell(f,k) by TOPS_1:48;
  Int left_cell(f,k) c= LeftComp f by A2,GOBOARD9:24;
  then
A13: Int lc c= LeftComp f by A12,XBOOLE_1:1;
A14: Int left_cell(f,k,G) <> {} by A1,A2,Th11;
  Int left_cell(f,k,G) misses L~f by A1,A2,Th17;
  then
A15: Int Int left_cell(f,k,G) c= Int lc by A11,TOPS_1:48,XBOOLE_1:73;
  Int left_cell(f,k,G) c= lc by A1,A2,A11,Th17,XBOOLE_1:73;
  then
A16: lc meets Int lc by A14,A15,XBOOLE_1:68;
  lc is connected by A1,A2,Th28;
  hence thesis by A13,A16,A10,GOBOARD9:6;
end;

begin :: Cages

reserve C for compact non vertical non horizontal non empty Subset of TOP-REAL
  2,
  l, m, i1, i2, j1, j2 for Element of NAT;

theorem Th30:
  for n being Nat ex i st 1 <= i & i+1 <= len Gauge(C,n) & N-min C
  in cell(Gauge(C,n),i,width Gauge(C,n)-'1) & N-min C <> Gauge(C,n)*(i,width
  Gauge(C,n)-'1)
proof
  let n be Nat;
  set G = Gauge(C,n);
  defpred P[Nat] means 1 <= $1 & $1 < len G & G*($1,(width G)-'1)`1 < (N-min C
  )`1;
A1: for k be Nat st P[k] holds k <= len G;
A2: len G = width G by JORDAN8:def 1;
  (NW-corner C)`1 <= (N-min C)`1 by PSCOMP_1:97;
  then
A3: W-bound C <= (N-min C)`1 by EUCLID:56;
A4: len G >= 4 by JORDAN8:13;
  then
A5: (len G)-'1 <= len G & 2 <= len G by NAT_D:35,XXREAL_0:2;
A6: 1 < len G by A4,XXREAL_0:2;
  then
A7: 1 <= (len G)-'1 by NAT_D:49;
A8: n in NAT & len G = width G by JORDAN8:def 1,ORDINAL1:def 13;
  then G*(2,(width G)-'1)`1 = W-bound C by A7,JORDAN8:14,NAT_D:35;
  then G*(1,(width G)-'1)`1 < W-bound C by A2,A7,A5,GOBOARD5:4;
  then G*(1,(width G)-'1)`1 < (N-min C)`1 by A3,XXREAL_0:2;
  then
A9: ex k be Nat st P[k] by A6;
  ex i being Nat st P[i] & for n be Nat st P[n] holds n <= i from NAT_1:
  sch 6(A1,A9);
  then consider i being Nat such that
A10: 1 <= i and
A11: i < len G and
A12: G*(i,(width G)-'1)`1 < (N-min C)`1 and
A13: for n be Nat st P[n] holds n <= i;
  reconsider i as Element of NAT by ORDINAL1:def 13;
A14: 1 <= i+1 & i < i+1 by NAT_1:12,13;
A15: (N-min C)`2 = N-bound C by EUCLID:56;
A16: i+1 <= len G by A11,NAT_1:13;
  then
A17: (N-min C)`2 = G* (i+1,(width G)-'1)`2 by A8,A15,JORDAN8:17,NAT_1:12;
  now
    assume
    i+1 = len G;
    then len G-'1 = i by NAT_D:34;
    then
A18: G*(i,(width G)-'1)`1 = E-bound C by A8,A7,JORDAN8:15,NAT_D:35;
    (NE-corner C)`1 >= (N-min C)`1 by PSCOMP_1:97;
    hence contradiction by A12,A18,EUCLID:56;
  end;
  then i+1 < len G by A16,XXREAL_0:1;
  then
A19: (N-min C)`1 <= G*(i+1,(width G)-'1)`1 by A13,A14;
  G*(i,(width G)-'1)`2 = (N-min C)`2 by A8,A10,A11,A15,JORDAN8:17;
  then
A20: N-min C in LSeg(G*(i,(width G)-'1),G*(i+1,(width G)-'1)) by A12,A17,A19,
GOBOARD7:9;
  take i;
  thus 1 <= i & i+1 <= len G by A10,A11,NAT_1:13;
  LSeg(G*(i,(width G)-'1),G*(i+1,(width G)-'1)) c= cell(G,i,(width G)-'1)
  by A2,A7,A10,A11,GOBOARD5:23,NAT_D:35;
  hence N-min C in cell(G,i,(width G)-'1) by A20;
  thus thesis by A12;
end;

theorem Th31:
  for n, i1, i2 being Nat holds 1 <= i1 & i1+1 <= len Gauge(C,n) &
N-min C in cell(Gauge(C,n),i1,width Gauge(C,n)-'1) & N-min C <> Gauge(C,n)*(i1,
width Gauge(C,n)-'1) & 1 <= i2 & i2+1 <= len Gauge(C,n) & N-min C in cell(Gauge
(C,n),i2,width Gauge(C,n)-'1) & N-min C <> Gauge(C,n)*(i2,width Gauge(C,n)-'1)
  implies i1 = i2
proof
  let n, i1, i2 be Nat;
A1: i1 in NAT by ORDINAL1:def 13;
  set G = Gauge(C,n), j = width G-'1;
A2: i2 in NAT by ORDINAL1:def 13;
A3: 2|^n >= n+1 by NEWTON:104;
A4: 1+ (n+3) > 1+0 by XREAL_1:8;
A5: len G = width G by JORDAN8:def 1;
A6: len G = 2|^n+3 by JORDAN8:def 1;
  then
A7: len G >= n+1+3 by A3,XREAL_1:8;
  then len G > 1 by A4,XXREAL_0:2;
  then
A8: len G >= 1+1 by NAT_1:13;
  then
A9: 1 <= j by A5,JORDAN5B:2;
A10: j+1 = len G by A5,A7,A4,XREAL_1:237,XXREAL_0:2;
  then
A11: j < len G by NAT_1:13;
  assume that
A12: 1 <= i1 and
A13: i1+1 <= len G and
A14: N-min C in cell(G,i1,j) and
A15: N-min C <> G*(i1,j) and
A16: 1 <= i2 and
A17: i2+1 <= len G and
A18: N-min C in cell(G,i2,j) and
A19: N-min C <> G*(i2,j) and
A20: i1 <> i2;
A21: cell(G,i1,j) meets cell(G,i2,j) by A14,A18,XBOOLE_0:3;
A22: i1 < len G by A13,NAT_1:13;
A23: i2 < len G by A17,NAT_1:13;
  per cases by A20,XXREAL_0:1;
  suppose
A24: i1 < i2;
    then
A25: i2-'i1+i1 = i2 by XREAL_1:237;
    then i2-'i1 <= 1 by A1,A23,A5,A21,A9,A11,JORDAN8:10;
    then i2-'i1 < 1 or i2-'i1 = 1 by XXREAL_0:1;
    then i2-'i1 = 0 or i2-'i1 = 1 by NAT_1:14;
    then cell(G,i1,j) /\ cell(G,i2,j) = LSeg(G*(i2,j),G*(i2,j+1)) by A1,A22,A5
,A8,A11,A24,A25,GOBOARD5:26,JORDAN5B:2;
    then
A26: N-min C in LSeg(G*(i2,j),G*(i2,j+1)) by A14,A18,XBOOLE_0:def 4;
    1 <= j+1 by NAT_1:12;
    then
A27: [i2,j+1] in Indices G by A16,A23,A5,A10,MATRIX_1:37;
    set y2 = (S-bound C)+(((N-bound C)-(S-bound C))/(2|^n))*(j-1);
    set y1 = (S-bound C)+(((N-bound C)-(S-bound C))/(2|^n))*(j-2);
    set x = (W-bound C)+(((E-bound C)-(W-bound C))/(2|^n))*(i2-2);
    j = (2|^n+2+1)-'1 by A6,JORDAN8:def 1
      .= (2|^n+2) by NAT_D:34;
    then
A28: (((N-bound C)-(S-bound C))/(2|^n))*(j-2) = (N-bound C)-(S-bound C) by A3,
XCMPLX_1:88;
    [i2,j] in Indices G by A16,A23,A5,A9,A11,MATRIX_1:37;
    then
A29: G*(i2,j) = |[x,y1]| by JORDAN8:def 1;
    then
A30: G*(i2,j)`1 = x by EUCLID:56;
    j+1-(1+1) = j-1;
    then G*(i2,j+1) = |[x,y2]| by A27,JORDAN8:def 1;
    then G*(i2,j+1)`1 = x by EUCLID:56;
    then LSeg(G*(i2,j),G*(i2,j+1)) is vertical by A30,SPPOL_1:37;
    then (N-min C)`1 = G*(i2,j)`1 by A26,SPPOL_1:64;
    hence contradiction by A19,A29,A30,A28,EUCLID:56;
  end;
  suppose
A31: i2 < i1;
    then
A32: i1-'i2+i2 = i1 by XREAL_1:237;
    then i1-'i2 <= 1 by A2,A22,A5,A21,A9,A11,JORDAN8:10;
    then i1-'i2 < 1 or i1-'i2 = 1 by XXREAL_0:1;
    then i1-'i2 = 0 or i1-'i2 = 1 by NAT_1:14;
    then cell(G,i2,j) /\ cell(G,i1,j) = LSeg(G*(i1,j),G*(i1,j+1)) by A2,A23,A5
,A8,A11,A31,A32,GOBOARD5:26,JORDAN5B:2;
    then
A33: N-min C in LSeg(G*(i1,j),G*(i1,j+1)) by A14,A18,XBOOLE_0:def 4;
    1 <= j+1 by NAT_1:12;
    then
A34: [i1,j+1] in Indices G by A12,A22,A5,A10,MATRIX_1:37;
    set y2 = (S-bound C)+(((N-bound C)-(S-bound C))/(2|^n))*(j-1);
    set y1 = (S-bound C)+(((N-bound C)-(S-bound C))/(2|^n))*(j-2);
    set x = (W-bound C)+(((E-bound C)-(W-bound C))/(2|^n))*(i1-2);
    j = (2|^n+2+1)-'1 by A6,JORDAN8:def 1
      .= (2|^n+2) by NAT_D:34;
    then
A35: (((N-bound C)-(S-bound C))/(2|^n))*(j-2) = (N-bound C)-(S-bound C) by A3,
XCMPLX_1:88;
    [i1,j] in Indices G by A12,A22,A5,A9,A11,MATRIX_1:37;
    then
A36: G*(i1,j) = |[x,y1]| by JORDAN8:def 1;
    then
A37: G*(i1,j)`1 = x by EUCLID:56;
    j+1-(1+1) = j-1;
    then G*(i1,j+1) = |[x,y2]| by A34,JORDAN8:def 1;
    then G*(i1,j+1)`1 = x by EUCLID:56;
    then LSeg(G*(i1,j),G*(i1,j+1)) is vertical by A37,SPPOL_1:37;
    then (N-min C)`1 = G*(i1,j)`1 by A33,SPPOL_1:64;
    hence contradiction by A15,A36,A37,A35,EUCLID:56;
  end;
end;

theorem Th32:
  for n being Nat for f being standard non constant
special_circular_sequence st f is_sequence_on Gauge(C,n) & (for k st 1 <= k & k
+1 <= len f holds left_cell(f,k,Gauge(C,n)) misses C & right_cell(f,k,Gauge(C,n
  )) meets C) & (ex i st 1 <= i & i+1 <= len Gauge(C,n) & f/.1 = Gauge(C,n)*(i,
width Gauge(C,n)) & f/.2 = Gauge(C,n)*(i+1,width Gauge(C,n)) & N-min C in cell(
Gauge(C,n),i,width Gauge(C,n)-'1) & N-min C <> Gauge(C,n)*(i,width Gauge(C,n)-'
  1)) holds N-min L~f = f/.1
proof
  let n be Nat;
  set G = Gauge(C,n);
  let f be standard non constant special_circular_sequence such that
A1: f is_sequence_on G and
A2: for k st 1 <= k & k+1 <= len f holds left_cell(f,k,G) misses C &
  right_cell(f,k,G) meets C;
  N-min L~f in rng f by SPRECT_2:43;
  then consider m being Nat such that
A3: m in dom f and
A4: f.m = N-min L~f by FINSEQ_2:11;
  reconsider m as Element of NAT by ORDINAL1:def 13;
  consider i,j such that
A5: [i,j] in Indices G and
A6: f/.m = G*(i,j) by A1,A3,GOBOARD1:def 11;
A7: f/.m = f.m by A3,PARTFUN1:def 8;
A8: (N-min L~f)`2 = N-bound L~f by EUCLID:56;
  set W = W-bound C, S = S-bound C, E = E-bound C, N = N-bound C;
  given i9 being Element of NAT such that
A9: 1 <= i9 and
A10: i9+1 <= len G and
A11: f/.1 = G*(i9,width G) and
A12: f/.2 = G*(i9+1,width G) and
A13: N-min C in cell(G,i9,width G-'1) and
A14: N-min C <> G*(i9,width G-'1);
A15: G*(i9,len G-'1) = |[G*(i9,len G-'1)`1,G*(i9,len G-'1)`2]| & (N-min C)`2
  = N by EUCLID:56,57;
  G*(i,j) = |[W+((E-W)/(2|^n))*(i-2), S+((N-S)/(2|^n))*(j-2)]| by A5,
JORDAN8:def 1;
  then
A16: S+((N-S)/(2|^n))*(j-2) = N-bound L~f by A4,A7,A8,A6,EUCLID:56;
  N > S by JORDAN8:12;
  then 2|^n > 0 & N-S > 0 by NEWTON:102,XREAL_1:52;
  then
A17: (N-S)/(2|^n) > 0 by XREAL_1:141;
A18: (NW-corner L~f)`1 = W-bound L~f & (NE-corner L~f)`1 = E-bound L~f by
EUCLID:56;
A19: 1 <= i by A5,MATRIX_1:39;
A20: (NW-corner L~f)`2 = N-bound L~f & (NE-corner L~f)`2 = N-bound L~f by
EUCLID:56;
A21: m <= len f by A3,FINSEQ_3:27;
A22: 1 <= j by A5,MATRIX_1:39;
  len G = 2|^n+3 by JORDAN8:def 1;
  then
A23: len G >= 3 by NAT_1:12;
  then
A24: 1 < len G by XXREAL_0:2;
  then
A25: 1 <= len G-'1 by NAT_D:49;
  then
A26: len G-'1 < len G by NAT_D:51;
A27: i <= len G by A5,MATRIX_1:39;
A28: j <= width G by A5,MATRIX_1:39;
  then
A29: G*(i,j)`2 = G* (1,j)`2 by A19,A27,A22,GOBOARD5:2;
A30: len f > 4 by GOBOARD7:36;
  1 in dom f by FINSEQ_5:6;
  then
A31: f/.1 in L~f by A30,GOBOARD1:16,XXREAL_0:2;
  then
A32: N-bound L~f >= (f/.1)`2 by PSCOMP_1:71;
A33: len G = width G by JORDAN8:def 1;
A34: i9 < len G by A10,NAT_1:13;
  then G*(i9,j)`2 = G*(1,j)`2 by A9,A22,A28,GOBOARD5:2;
  then G*(i,j)`2 <= G*(i9,len G)`2 by A9,A34,A33,A22,A28,A29,SPRECT_3:24;
  then
A35: N-bound L~f = (f/.1)`2 by A11,A33,A4,A7,A8,A6,A32,XXREAL_0:1;
  [i9,len G] in Indices G by A9,A34,A33,A24,MATRIX_1:37;
  then G*(i9,len G)=|[W+((E-W)/(2|^n))*(i9-2),S+((N-S)/(2|^n))*(len G-2)]| by
JORDAN8:def 1;
  then S+((N-S)/(2|^n))*(len G-2) = N-bound L~f by A11,A33,A35,EUCLID:56;
  then
A36: len G-2 = j-2 by A17,A16,XCMPLX_1:5;
  then
A37: G*(i9,len G)`1 = G*(i9,1)`1 by A9,A34,A33,A22,GOBOARD5:3;
  W-bound L~f <= (f/.1)`1 & (f/.1)`1 <= E-bound L~f by A31,PSCOMP_1:71;
  then f/.1 in LSeg(NW-corner L~f, NE-corner L~f) by A35,A18,A20,GOBOARD7:9;
  then f/.1 in LSeg(NW-corner L~f, NE-corner L~f) /\ L~f by A31,XBOOLE_0:def 4;
  then
A38: (N-min L~f)`1 <= (f/.1)`1 by PSCOMP_1:98;
  then
A39: i <= i9 by A9,A11,A33,A4,A7,A6,A27,A22,A36,GOBOARD5:4;
  then
A40: i < len G by A34,XXREAL_0:2;
  then
A41: i+1 <= len G by NAT_1:13;
A42: len G-'1+1 = len G by A23,XREAL_1:237,XXREAL_0:2;
  then
  N-min C in { |[r9,s9]| where r9,s9 is Real: G*(i9,1)`1 <= r9 & r9 <= G*
(i9+1,1)`1 & G*(1,len G-'1)`2 <= s9 & s9 <= G*(1,len G)`2 } by A9,A13,A34,A33
,A25,A26,GOBRD11:32;
  then
  ex r9,s9 being Real st N-min C = |[r9,s9]| & G*(i9,1)`1 <= r9 & r9 <= G*
  (i9+1,1)`1 & G*(1,len G-'1)`2 <= s9 & s9 <= G*(1,len G)`2;
  then
A43: (f/.1)`1 <= (N-min C)`1 by A11,A33,A37,EUCLID:56;
  then
A44: (N-min L~f)`1 <= (N-min C)`1 by A38,XXREAL_0:2;
A45: 1 <= m by A3,FINSEQ_3:27;
A46: n in NAT by ORDINAL1:def 13;
  then
A47: G*(i9,len G-'1)`2 = N by A9,A34,JORDAN8:17;
A48: N-min C = |[(N-min C)`1,(N-min C)`2]| by EUCLID:57;
A49: (NW-corner C)`2 = N & (NE-corner C)`2 = N by EUCLID:56;
A50: (NW-corner C)`1 = W & (NE-corner C)`1 = E by EUCLID:56;
A51: len G = width G by JORDAN8:def 1;
  G*(i9,len G-'1)`1 = G*(i9,1)`1 by A9,A34,A33,A25,A26,GOBOARD5:3;
  then
A52: G*(i9,len G-'1)`1 < (N-min C)`1 by A11,A14,A33,A37,A43,A48,A15,A47,
XXREAL_0:1;
A53: G*(i,len G)`1 = G*(i,1)`1 by A19,A27,A22,A28,A36,GOBOARD5:3;
  per cases by A21,XXREAL_0:1;
  suppose
    m = len f;
    hence thesis by A4,A7,FINSEQ_6:def 1;
  end;
  suppose
    m < len f;
    then
A54: m+1 <= len f by NAT_1:13;
    then consider i1,j1,i2,j2 being Element of NAT such that
A55: [i1,j1] in Indices G & f/.m = G*(i1,j1) and
A56: [i2,j2] in Indices G and
A57: f/.(m+1) = G*(i2,j2) and
A58: i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or i1 = i2+1 & j1 = j2
    or i1 = i2 & j1 = j2+1 by A1,A45,JORDAN8:6;
A59: right_cell(f,m,G) meets C by A2,A45,A54;
    then consider p being set such that
A60: p in right_cell(f,m,G) and
A61: p in C by XBOOLE_0:3;
    reconsider p as Point of TOP-REAL 2 by A60;
A62: W <= p`1 & p`1 <= E by A61,PSCOMP_1:71;
A63: (N-min C)`2 = N by EUCLID:56;
    then
A64: p`2 <= (N-min C)`2 by A61,PSCOMP_1:71;
A65: G*(1,len G-'1)`2 < G*(1,len G)`2 by A51,A24,A25,A26,GOBOARD5:5;
A66: G*(1,len G-'1)`2 = N by A24,A46,JORDAN8:17;
A67: j2 <= len G by A51,A56,MATRIX_1:39;
    now
      per cases by A5,A6,A36,A55,A58,GOBOARD1:21;
      suppose
        i = i2 & len G+1 = j2;
        hence thesis by A67,NAT_1:13;
      end;
      suppose
A68:    i+1 = i2 & len G = j2;
A69:    cell(G,i,len G-'1) = {|[r,s]| : G*(i,1)`1 <= r & r <= G*(i+1,1)`1
& G*(1,len G-'1)`2 <= s & s <= G*(1,len G-'1+1)`2 } by A51,A19,A25,A26,A40,
GOBRD11:32;
        right_cell(f,m,G) = cell(G,i,len G-'1) by A1,A45,A5,A6,A36,A54,A56,A57
,A68,GOBRD13:25;
        then consider r,s such that
A70:    p = |[r,s]| and
        G*(i,1)`1 <= r and
A71:    r <= G*(i+1,1)`1 and
A72:    G*(1,len G-'1)`2 <= s and
        s <= G*(1,len G-'1+1)`2 by A60,A69;
        p`2 = s by A70,EUCLID:56;
        then p`2 = N by A63,A64,A66,A72,XXREAL_0:1;
        then p in LSeg(NW-corner C, NE-corner C) by A50,A49,A62,GOBOARD7:9;
        then p in LSeg(NW-corner C, NE-corner C) /\ C by A61,XBOOLE_0:def 4;
        then
A73:    (N-min C)`1 <= p`1 by PSCOMP_1:98;
        p`1 = r by A70,EUCLID:56;
        then (N-min C)`1 <= G*(i+1,1)`1 by A71,A73,XXREAL_0:2;
        then
A74:    N-min C in cell(G,i,width G-'1) by A33,A4,A7,A6,A36,A53,A42,A44,A48,A63
,A66,A65,A69;
        N-min C <> G*(i,len G-'1) by A34,A33,A19,A25,A26,A52,A39,SPRECT_3:25;
        hence thesis by A9,A10,A11,A13,A14,A33,A4,A7,A6,A19,A36,A41,A74,Th31;
      end;
      suppose
        i = i2+1 & len G = j2;
        then right_cell(f,m,G) = cell(G,i2,len G) & i2 < len G by A1,A45,A5,A6
,A27,A36,A54,A56,A57,GOBRD13:27,NAT_1:13;
        hence thesis by A2,A45,A54,JORDAN8:18;
      end;
      suppose
A75:    i = i2 & len G = j2+1;
        then
A76:    j2 = len G-'1 by NAT_D:34;
        then
A77:    right_cell(f,m,G) = cell(G,i-'1,len G-'1) by A1,A45,A5,A6,A36,A54,A56
,A57,A75,GOBRD13:29;
        m-'1 <= m by NAT_D:35;
        then
A78:    m-'1 <= len f by A21,XXREAL_0:2;
        now
          1 <= i9+1 by A9,NAT_1:13;
          then
A79:      G*(i9+1,len G)`2 = G* (1,len G)`2 by A10,A33,A24,GOBOARD5:2;
          assume
A80:      m = 1;
          G*(i9,len G)`2 = G*(1,len G)`2 by A9,A34,A33,A24,GOBOARD5:2;
          hence contradiction by A11,A12,A33,A6,A19,A27,A36,A25,A26,A57,A75,A76
,A80,A79,GOBOARD5:5;
        end;
        then m > 1 by A45,XXREAL_0:1;
        then
A81:    m-'1 >= 1 by NAT_D:49;
A82:    m-'1+1 = m by A45,XREAL_1:237;
        then consider i19,j19,i29,j29 being Element of NAT such that
A83:    [i19,j19] in Indices G and
A84:    f/.(m-'1) = G*(i19,j19) and
A85:    [i29,j29] in Indices G & f/.m = G*(i29,j29) &( i19 = i29 &
j19+1 = j29 or i19+1 = i29 & j19 = j29 or i19 = i29+1 & j19 = j29 or i19 = i29
        & j19 = j29+1) by A1,A21,A81,JORDAN8:6;
A86:    1 <= i19 by A83,MATRIX_1:39;
A87:    i19 <= len G by A83,MATRIX_1:39;
        now
          per cases by A5,A6,A36,A85,GOBOARD1:21;
          suppose
A88:        i19 = i & j19+1 = len G;
            then j19 = len G-'1 by NAT_D:34;
            then left_cell(f,m-'1,G) = cell(G,i-'1,len G-'1) by A1,A21,A5,A6
,A36,A81,A82,A83,A84,A88,GOBRD13:22;
            hence contradiction by A2,A21,A59,A77,A81,A82;
          end;
          suppose
A89:        i19+1 = i & j19 = len G;
A90:        G*(i19,j)`2 = G*(1,j)`2 & G*(i,j)`2 = G*(1,j)`2 by A19,A27,A22,A28
,A86,A87,GOBOARD5:2;
            m-'1 in dom f by A81,A78,FINSEQ_3:27;
            then
A91:        f/.(m-'1) in L~f by A30,GOBOARD1:16,XXREAL_0:2;
            then W-bound L~f <= (f/.(m-'1))`1 & (f/.(m-'1))`1 <= E-bound L~f
            by PSCOMP_1:71;
            then f/.(m-'1) in LSeg(NW-corner L~f, NE-corner L~f) by A4,A7,A8,A6
,A36,A18,A20,A84,A89,A90,GOBOARD7:9;
            then
A92:        f/.(m-'1) in LSeg(NW-corner L~f, NE-corner L~f) /\ L~f by A91,
XBOOLE_0:def 4;
            i19 < i by A89,NAT_1:13;
            then (f/.(m-'1))`1 < (f/.m)`1 by A6,A27,A22,A28,A36,A84,A86,A89,
GOBOARD5:4;
            hence contradiction by A4,A7,A92,PSCOMP_1:98;
          end;
          suppose
            i19 = i+1 & j19 = len G;
            then right_cell(f,m-'1,G) = cell(G,i,len G) by A1,A21,A5,A6,A36,A81
,A82,A83,A84,GOBRD13:27;
            hence contradiction by A2,A21,A27,A81,A82,JORDAN8:18;
          end;
          suppose
            i19 = i & j19 = len G+1;
            then len G+1 <= len G+0 by A51,A83,MATRIX_1:39;
            hence contradiction by XREAL_1:8;
          end;
        end;
        hence thesis;
      end;
    end;
    hence thesis;
  end;
end;

definition
  let C be compact non vertical non horizontal non empty Subset of TOP-REAL 2;
  let n be Nat;
  assume
A1: C is connected;
  func Cage(C,n) -> clockwise_oriented (standard non constant
  special_circular_sequence) means
  :Def1:
  it is_sequence_on Gauge(C,n) & (ex i st
1 <= i & i+1 <= len Gauge(C,n) & it/.1 = Gauge(C,n)*(i,width Gauge(C,n)) & it/.
  2 = Gauge(C,n)*(i+1,width Gauge(C,n)) & N-min C in cell(Gauge(C,n),i,width
Gauge(C,n)-'1) & N-min C <> Gauge(C,n)*(i,width Gauge(C,n)-'1)) & for k st 1 <=
  k & k+2 <= len it holds (front_left_cell(it,k,Gauge(C,n)) misses C &
front_right_cell(it,k,Gauge(C,n)) misses C implies it turns_right k,Gauge(C,n))
& (front_left_cell(it,k,Gauge(C,n)) misses C & front_right_cell(it,k,Gauge(C,n)
) meets C implies it goes_straight k,Gauge(C,n)) & (front_left_cell(it,k,Gauge(
  C,n)) meets C implies it turns_left k,Gauge(C,n));
  existence
  proof
    set W = W-bound C, E = E-bound C, S = S-bound C, N = N-bound C;
    set G = Gauge(C,n);
    defpred P[Element of NAT,set,set] means ($1 = 0 implies ex i st 1 <= i & i
+1 <= len G & N-min C in cell(G,i,width G-'1) & N-min C <> G*(i,width G-'1) &
$3 = <*G*(i,width G)*>) & ($1 = 1 implies ex i st 1 <= i & i+1 <= len G & N-min
C in cell(G,i,width G-'1) & N-min C <> G*(i,width G-'1) & $3 = <*G*(i,width G),
G*(i+1,width G)*>) & ($1 > 1 & $2 is FinSequence of TOP-REAL 2 implies for f
    being FinSequence of TOP-REAL 2 st $2 = f holds (len f = $1 implies (f
is_sequence_on G & right_cell(f,len f-'1,G) meets C implies (front_left_cell(f,
(len f)-'1,G) misses C & front_right_cell(f,(len f)-'1,G) misses C implies ex i
    ,j st f^<*G*(i,j)*> turns_right (len f)-'1,G & $3 = f^<*G*(i,j)*>) & (
    front_left_cell(f,(len f)-'1,G) misses C & front_right_cell(f,(len f)-'1,G)
meets C implies ex i,j st f^<*G*(i,j)*> goes_straight (len f)-'1,G & $3 = f^<*G
*(i,j)*>) & (front_left_cell(f,(len f)-'1,G) meets C implies ex i,j st f^<*G*(i
,j)*> turns_left (len f)-'1,G & $3 = f^<*G*(i,j)*>)) & (not f is_sequence_on G
or right_cell(f,len f-'1,G) misses C implies $3 = f^<*G*(1,1)*>)) & (len f <>
$1 implies $3 = {})) & ($1 > 1 & $2 is not FinSequence of TOP-REAL 2 implies $3
    = {});
A2: len G = width G by JORDAN8:def 1;
A3: for k being Element of NAT, x being set ex y being set st P[k,x,y]
    proof
      let k be Element of NAT, x be set;
      consider m being Element of NAT such that
A4:   1 <= m & m+1 <= len G & N-min C in cell(G,m,width G-'1) & N-min
      C <> G*(m,width G-'1) by Th30;
      per cases by NAT_1:26;
      suppose
A5:     k=0;
        take <*G*(m,width G)*>;
        thus thesis by A4,A5;
      end;
      suppose
A6:     k = 1;
        take <*G*(m,width G),G*(m+1,width G)*>;
        thus thesis by A4,A6;
      end;
      suppose that
A7:     k > 1 and
A8:     x is FinSequence of TOP-REAL 2;
        reconsider f = x as FinSequence of TOP-REAL 2 by A8;
        thus thesis
        proof
          per cases;
          suppose
A9:         len f = k;
            thus thesis
            proof
              per cases;
              suppose
A10:            f is_sequence_on G & right_cell(f,len f-'1,G) meets C;
A11:            (len f) -'1 +1 = len f by A7,A9,XREAL_1:237;
                then
A12:            (len f)-'1+(1+1) = (len f)+1;
A13:            (len f)-'1+1 in dom f by A7,A9,A11,FINSEQ_3:27;
A14:            1 <= (len f)-'1 by A7,A9,NAT_D:49;
                then consider i1,j1,i2,j2 being Element of NAT such that
A15:            [i1,j1] in Indices G and
A16:            f/.((len f) -'1) = G*(i1,j1) and
A17:            [i2,j2] in Indices G and
A18:            f/.((len f) -'1+1) = G*(i2,j2) and
A19:            i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or i1 = i2
                +1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A10,A11,JORDAN8:6;
A20:            i1 <= len G by A15,MATRIX_1:39;
A21:            1 <= j2+1 by NAT_1:12;
A22:            1 <= i2 by A17,MATRIX_1:39;
A23:            j1 <= width G by A15,MATRIX_1:39;
A24:            1 <= i2+1 by NAT_1:12;
A25:            1 <= j2 by A17,MATRIX_1:39;
                (len f)-'1 <= len f by NAT_D:35;
                then
A26:            (len f)-'1 in dom f by A14,FINSEQ_3:27;
A27:            j2 <= width G by A17,MATRIX_1:39;
                then
A28:            j2-'1 <= width G by NAT_D:44;
A29:            i2 <= len G by A17,MATRIX_1:39;
                then
A30:            i2-'1 <= len G by NAT_D:44;
                thus thesis
                proof
                  per cases;
                  suppose
A31:                front_left_cell(f,(len f)-'1,G) misses C &
                    front_right_cell(f,(len f)-'1,G) misses C;
                    thus thesis
                    proof
                      per cases by A19;
                      suppose
A32:                    i1 = i2 & j1+1 = j2;
                        take f1 = f^<*G*(i2+1,j2)*>;
                        now
                          take i=i2+1 ,j=j2;
                          thus f1 turns_right (len f)-'1,G
                          proof
                            let i19,j19,i29,j29 be Element of NAT;
                            assume that
A33:                        [i19,j19] in Indices G and
A34:                        [i29,j29] in Indices G and
A35:                        f1/.((len f)-'1) = G*(i19,j19) and
A36:                        f1/.((len f)-'1+1) = G*(i29,j29);
A37:                        f/.((len f)-'1) = G*(i19,j19) by A26,A35,
FINSEQ_4:83;
                            then
A38:                        i1 = i19 by A15,A16,A33,GOBOARD1:21;
A39:                        j1 = j19 by A15,A16,A33,A37,GOBOARD1:21;
A40:                        f/.((len f)-'1+1) = G*(i29,j29) by A13,A36,
FINSEQ_4:83;
                            then
A41:                        i2 = i29 by A17,A18,A34,GOBOARD1:21;
A42:                        j2 = j29 by A17,A18,A34,A40,GOBOARD1:21;
                            per cases by A15,A16,A19,A33,A37,A41,A42,
GOBOARD1:21;
                            case
                              i19 = i29 & j19+1 = j29;
                              now
                                assume
                                i2+1 > len G;
                                then
A43:                            (len G)+1 <= i2+1 by NAT_1:13;
                                i2+1 <= (len G)+1 by A29,XREAL_1:8;
                                then i2+1 = (len G)+1 by A43,XXREAL_0:1;
                                then cell(G,len G,j1) meets C by A10,A14,A11
,A15,A16,A17,A18,A32,GOBRD13:23;
                                hence contradiction by A2,A23,JORDAN8:19;
                              end;
                              hence
                              [i29+1,j29] in Indices G by A25,A27,A24,A41,A42,
MATRIX_1:37;
                              thus thesis by A12,A41,A42,FINSEQ_4:82;
                            end;
                            case
                              i19+1 = i29 & j19 = j29;
                              hence thesis by A32,A38,A41;
                            end;
                            case
                              i19 = i29+1 & j19 = j29;
                              hence thesis by A32,A38,A41;
                            end;
                            case
                              i19 = i29 & j19 = j29+1;
                              hence thesis by A32,A39,A42;
                            end;
                          end;
                        end;
                        hence thesis by A7,A9,A10,A31;
                      end;
                      suppose
A44:                    i1+1 = i2 & j1 = j2;
                        take f1 = f^<*G*(i2,j2-'1)*>;
                        now
                          take i=i2,j=j2-'1;
                          thus f1 turns_right (len f)-'1,G
                          proof
                            let i19,j19,i29,j29 be Element of NAT;
                            assume that
A45:                        [i19,j19] in Indices G and
A46:                        [i29,j29] in Indices G and
A47:                        f1/.((len f)-'1) = G*(i19,j19) and
A48:                        f1/.((len f)-'1+1) = G*(i29,j29);
A49:                        f/.((len f)-'1+1) = G*(i29,j29) by A13,A48,
FINSEQ_4:83;
                            then
A50:                        i2 = i29 by A17,A18,A46,GOBOARD1:21;
A51:                        f/.((len f)-'1) = G*(i19,j19) by A26,A47,
FINSEQ_4:83;
                            then
A52:                        i1 = i19 by A15,A16,A45,GOBOARD1:21;
A53:                        j2 = j29 by A17,A18,A46,A49,GOBOARD1:21;
                            per cases by A15,A16,A19,A45,A51,A50,A53,
GOBOARD1:21;
                            case
                              i19 = i29 & j19+1 = j29;
                              hence thesis by A44,A52,A50;
                            end;
                            case
                              i19+1 = i29 & j19 = j29;
                              now
                                assume
                                j2-'1 < 1;
                                then j2 <= 1 by NAT_1:14,NAT_D:36;
                                then j2 = 1 by A25,XXREAL_0:1;
                                then cell(G,i1,1-'1) meets C by A10,A14,A11,A15
,A16,A17,A18,A44,GOBRD13:25;
                                then cell(G,i1,0) meets C by XREAL_1:234;
                                hence contradiction by A20,JORDAN8:20;
                              end;
                              hence [i29,j29-'1] in Indices G by A22,A29,A28
,A50,A53,MATRIX_1:37;
                              thus thesis by A12,A50,A53,FINSEQ_4:82;
                            end;
                            case
                              i19 = i29+1 & j19 = j29;
                              hence thesis by A44,A52,A50;
                            end;
                            case
                              i19 = i29 & j19 = j29+1;
                              hence thesis by A44,A52,A50;
                            end;
                          end;
                        end;
                        hence thesis by A7,A9,A10,A31;
                      end;
                      suppose
A54:                    i1 = i2+1 & j1 = j2;
                        take f1 = f^<*G*(i2,j2+1)*>;
                        now
                          take i=i2,j=j2+1;
                          thus f1 turns_right (len f)-'1,G
                          proof
                            let i19,j19,i29,j29 be Element of NAT;
                            assume that
A55:                        [i19,j19] in Indices G and
A56:                        [i29,j29] in Indices G and
A57:                        f1/.((len f)-'1) = G*(i19,j19) and
A58:                        f1/.((len f)-'1+1) = G*(i29,j29);
A59:                        f/.((len f)-'1+1) = G*(i29,j29) by A13,A58,
FINSEQ_4:83;
                            then
A60:                        i2 = i29 by A17,A18,A56,GOBOARD1:21;
A61:                        f/.((len f)-'1) = G*(i19,j19) by A26,A57,
FINSEQ_4:83;
                            then
A62:                        i1 = i19 by A15,A16,A55,GOBOARD1:21;
A63:                        j2 = j29 by A17,A18,A56,A59,GOBOARD1:21;
                            per cases by A15,A16,A19,A55,A61,A60,A63,
GOBOARD1:21;
                            case
                              i19 = i29 & j19+1 = j29;
                              hence thesis by A54,A62,A60;
                            end;
                            case
                              i19+1 = i29 & j19 = j29;
                              hence thesis by A54,A62,A60;
                            end;
                            case
                              i19 = i29+1 & j19 = j29;
                              now
                                assume
                                j2+1 > len G;
                                then
A64:                            (len G)+1 <= j2+1 by NAT_1:13;
                                j2+1 <= (len G)+1 by A2,A27,XREAL_1:8;
                                then j2+1 = (len G)+1 by A64,XXREAL_0:1;
                                then cell(G,i2,len G) meets C by A10,A14,A11
,A15,A16,A17,A18,A54,GOBRD13:27;
                                hence contradiction by A29,JORDAN8:18;
                              end;
                              hence
                              [i29,j29+1] in Indices G by A2,A22,A29,A21,A60
,A63,MATRIX_1:37;
                              thus thesis by A12,A60,A63,FINSEQ_4:82;
                            end;
                            case
                              i19 = i29 & j19 = j29+1;
                              hence thesis by A54,A62,A60;
                            end;
                          end;
                        end;
                        hence thesis by A7,A9,A10,A31;
                      end;
                      suppose
A65:                    i1 = i2 & j1 = j2+1;
                        take f1 = f^<*G*(i2-'1,j2)*>;
                        now
                          take i=i2-'1 ,j=j2;
                          thus f1 turns_right (len f)-'1,G
                          proof
                            let i19,j19,i29,j29 be Element of NAT;
                            assume that
A66:                        [i19,j19] in Indices G and
A67:                        [i29,j29] in Indices G and
A68:                        f1/.((len f)-'1) = G*(i19,j19) and
A69:                        f1/.((len f)-'1+1) = G*(i29,j29);
A70:                        f/.((len f)-'1) = G*(i19,j19) by A26,A68,
FINSEQ_4:83;
                            then
A71:                        i1 = i19 by A15,A16,A66,GOBOARD1:21;
A72:                        j1 = j19 by A15,A16,A66,A70,GOBOARD1:21;
A73:                        f/.((len f)-'1+1) = G*(i29,j29) by A13,A69,
FINSEQ_4:83;
                            then
A74:                        i2 = i29 by A17,A18,A67,GOBOARD1:21;
A75:                        j2 = j29 by A17,A18,A67,A73,GOBOARD1:21;
                            per cases by A15,A16,A19,A66,A70,A74,A75,
GOBOARD1:21;
                            case
                              i19 = i29 & j19+1 = j29;
                              hence thesis by A65,A72,A75;
                            end;
                            case
                              i19+1 = i29 & j19 = j29;
                              hence thesis by A65,A71,A74;
                            end;
                            case
                              i19 = i29+1 & j19 = j29;
                              hence thesis by A65,A71,A74;
                            end;
                            case
                              i19 = i29 & j19 = j29+1;
                              now
                                assume
                                i2-'1 < 1;
                                then i2 <= 1 by NAT_1:14,NAT_D:36;
                                then i2 = 1 by A22,XXREAL_0:1;
                                then cell(G,1-'1,j2) meets C by A10,A14,A11,A15
,A16,A17,A18,A65,GOBRD13:29;
                                then cell(G,0,j2) meets C by XREAL_1:234;
                                hence contradiction by A2,A27,JORDAN8:21;
                              end;
                              hence [i29-'1,j29] in Indices G by A25,A27,A30
,A74,A75,MATRIX_1:37;
                              thus thesis by A12,A74,A75,FINSEQ_4:82;
                            end;
                          end;
                        end;
                        hence thesis by A7,A9,A10,A31;
                      end;
                    end;
                  end;
                  suppose
A76:                front_left_cell(f,(len f)-'1,G) misses C &
                    front_right_cell(f,(len f)-'1,G) meets C;
                    thus thesis
                    proof
                      per cases by A19;
                      suppose
A77:                    i1 = i2 & j1+1 = j2;
                        take f1 = f^<*G*(i2,j2+1)*>;
                        now
                          take i=i2,j=j2+1;
                          thus f1 goes_straight (len f)-'1,G
                          proof
                            let i19,j19,i29,j29 be Element of NAT;
                            assume that
A78:                        [i19,j19] in Indices G and
A79:                        [i29,j29] in Indices G and
A80:                        f1/.((len f)-'1) = G*(i19,j19) and
A81:                        f1/.((len f)-'1+1) = G*(i29,j29);
A82:                        f/.((len f)-'1) = G*(i19,j19) by A26,A80,
FINSEQ_4:83;
                            then
A83:                        i1 = i19 by A15,A16,A78,GOBOARD1:21;
A84:                        j1 = j19 by A15,A16,A78,A82,GOBOARD1:21;
A85:                        f/.((len f)-'1+1) = G*(i29,j29) by A13,A81,
FINSEQ_4:83;
                            then
A86:                        i2 = i29 by A17,A18,A79,GOBOARD1:21;
A87:                        j2 = j29 by A17,A18,A79,A85,GOBOARD1:21;
                            per cases by A15,A16,A19,A78,A82,A86,A87,
GOBOARD1:21;
                            case
                              i19 = i29 & j19+1 = j29;
                              now
                                assume
                                j2+1 > len G;
                                then
A88:                            (len G)+1 <= j2+1 by NAT_1:13;
                                j2+1 <= (len G)+1 by A2,A27,XREAL_1:8;
                                then j2+1 = (len G)+1 by A88,XXREAL_0:1;
                                then cell(G,i1,len G) meets C by A10,A14,A11
,A15,A16,A17,A18,A76,A77,GOBRD13:36;
                                hence contradiction by A20,JORDAN8:18;
                              end;
                              hence
                              [i29,j29+1] in Indices G by A2,A22,A29,A21,A86
,A87,MATRIX_1:37;
                              thus thesis by A12,A86,A87,FINSEQ_4:82;
                            end;
                            case
                              i19+1 = i29 & j19 = j29;
                              hence thesis by A77,A83,A86;
                            end;
                            case
                              i19 = i29+1 & j19 = j29;
                              hence thesis by A77,A83,A86;
                            end;
                            case
                              i19 = i29 & j19 = j29+1;
                              hence thesis by A77,A84,A87;
                            end;
                          end;
                        end;
                        hence thesis by A7,A9,A10,A76;
                      end;
                      suppose
A89:                    i1+1 = i2 & j1 = j2;
                        take f1 = f^<*G*(i2+1,j2)*>;
                        now
                          take i=i2+1 ,j=j2;
                          thus f1 goes_straight (len f)-'1,G
                          proof
                            let i19,j19,i29,j29 be Element of NAT;
                            assume that
A90:                        [i19,j19] in Indices G and
A91:                        [i29,j29] in Indices G and
A92:                        f1/.((len f)-'1) = G*(i19,j19) and
A93:                        f1/.((len f)-'1+1) = G*(i29,j29);
A94:                        f/.((len f)-'1+1) = G*(i29,j29) by A13,A93,
FINSEQ_4:83;
                            then
A95:                        i2 = i29 by A17,A18,A91,GOBOARD1:21;
A96:                        f/.((len f)-'1) = G*(i19,j19) by A26,A92,
FINSEQ_4:83;
                            then
A97:                        i1 = i19 by A15,A16,A90,GOBOARD1:21;
A98:                        j2 = j29 by A17,A18,A91,A94,GOBOARD1:21;
                            per cases by A15,A16,A19,A90,A96,A95,A98,
GOBOARD1:21;
                            case
                              i19 = i29 & j19+1 = j29;
                              hence thesis by A89,A97,A95;
                            end;
                            case
                              i19+1 = i29 & j19 = j29;
                              now
                                assume
                                i2+1 > len G;
                                then
A99:                            (len G)+1 <= i2+1 by NAT_1:13;
                                i2+1 <= (len G)+1 by A29,XREAL_1:8;
                                then i2+1 = (len G)+1 by A99,XXREAL_0:1;
                                then cell(G,len G,j1-'1) meets C by A10,A14,A11
,A15,A16,A17,A18,A76,A89,GOBRD13:38;
                                hence contradiction by A2,A23,JORDAN8:19
,NAT_D:44;
                              end;
                              hence [i29+1,j29] in Indices G by A25,A27,A24,A95
,A98,MATRIX_1:37;
                              thus thesis by A12,A95,A98,FINSEQ_4:82;
                            end;
                            case
                              i19 = i29+1 & j19 = j29;
                              hence thesis by A89,A97,A95;
                            end;
                            case
                              i19 = i29 & j19 = j29+1;
                              hence thesis by A89,A97,A95;
                            end;
                          end;
                        end;
                        hence thesis by A7,A9,A10,A76;
                      end;
                      suppose
A100:                   i1 = i2+1 & j1 = j2;
                        take f1 = f^<*G*(i2-'1,j2)*>;
                        now
                          take i=i2-'1 ,j=j2;
                          thus f1 goes_straight (len f)-'1,G
                          proof
                            let i19,j19,i29,j29 be Element of NAT;
                            assume that
A101:                       [i19,j19] in Indices G and
A102:                       [i29,j29] in Indices G and
A103:                       f1/.((len f)-'1) = G*(i19,j19) and
A104:                       f1/.((len f)-'1+1) = G*(i29,j29);
A105:                       f/.((len f)-'1+1) = G*(i29,j29) by A13,A104,
FINSEQ_4:83;
                            then
A106:                       i2 = i29 by A17,A18,A102,GOBOARD1:21;
A107:                       f/.((len f)-'1) = G*(i19,j19) by A26,A103,
FINSEQ_4:83;
                            then
A108:                       i1 = i19 by A15,A16,A101,GOBOARD1:21;
A109:                       j2 = j29 by A17,A18,A102,A105,GOBOARD1:21;
                            per cases by A15,A16,A19,A101,A107,A106,A109,
GOBOARD1:21;
                            case
                              i19 = i29 & j19+1 = j29;
                              hence thesis by A100,A108,A106;
                            end;
                            case
                              i19+1 = i29 & j19 = j29;
                              hence thesis by A100,A108,A106;
                            end;
                            case
                              i19 = i29+1 & j19 = j29;
                              now
                                assume
                                i2-'1 < 1;
                                then i2 <= 1 by NAT_1:14,NAT_D:36;
                                then i2 = 1 by A22,XXREAL_0:1;
                                then cell(G,1-'1,j1) meets C by A10,A14,A11,A15
,A16,A17,A18,A76,A100,GOBRD13:40;
                                then cell(G,0,j1) meets C by XREAL_1:234;
                                hence contradiction by A2,A23,JORDAN8:21;
                              end;
                              hence [i29-'1,j29] in Indices G by A25,A27,A30
,A106,A109,MATRIX_1:37;
                              thus thesis by A12,A106,A109,FINSEQ_4:82;
                            end;
                            case
                              i19 = i29 & j19 = j29+1;
                              hence thesis by A100,A108,A106;
                            end;
                          end;
                        end;
                        hence thesis by A7,A9,A10,A76;
                      end;
                      suppose
A110:                   i1 = i2 & j1 = j2+1;
                        take f1 = f^<*G*(i2,j2-'1)*>;
                        now
                          take i=i2,j=j2-'1;
                          thus f1 goes_straight (len f)-'1,G
                          proof
                            let i19,j19,i29,j29 be Element of NAT;
                            assume that
A111:                       [i19,j19] in Indices G and
A112:                       [i29,j29] in Indices G and
A113:                       f1/.((len f)-'1) = G*(i19,j19) and
A114:                       f1/.((len f)-'1+1) = G*(i29,j29);
A115:                       f/.((len f)-'1) = G*(i19,j19) by A26,A113,
FINSEQ_4:83;
                            then
A116:                       i1 = i19 by A15,A16,A111,GOBOARD1:21;
A117:                       j1 = j19 by A15,A16,A111,A115,GOBOARD1:21;
A118:                       f/.((len f)-'1+1) = G*(i29,j29) by A13,A114,
FINSEQ_4:83;
                            then
A119:                       i2 = i29 by A17,A18,A112,GOBOARD1:21;
A120:                       j2 = j29 by A17,A18,A112,A118,GOBOARD1:21;
                            per cases by A15,A16,A19,A111,A115,A119,A120,
GOBOARD1:21;
                            case
                              i19 = i29 & j19+1 = j29;
                              hence thesis by A110,A117,A120;
                            end;
                            case
                              i19+1 = i29 & j19 = j29;
                              hence thesis by A110,A116,A119;
                            end;
                            case
                              i19 = i29+1 & j19 = j29;
                              hence thesis by A110,A116,A119;
                            end;
                            case
                              i19 = i29 & j19 = j29+1;
                              now
                                assume
                                j2-'1 < 1;
                                then j2 <= 1 by NAT_1:14,NAT_D:36;
                                then j2 = 1 by A25,XXREAL_0:1;
                                then cell(G,i1-'1,1-'1) meets C by A10,A14,A11
,A15,A16,A17,A18,A76,A110,GOBRD13:42;
                                then cell(G,i1-'1,0) meets C by XREAL_1:234;
                                hence contradiction by A20,JORDAN8:20,NAT_D:44;
                              end;
                              hence [i29,j29-'1] in Indices G by A22,A29,A28
,A119,A120,MATRIX_1:37;
                              thus thesis by A12,A119,A120,FINSEQ_4:82;
                            end;
                          end;
                        end;
                        hence thesis by A7,A9,A10,A76;
                      end;
                    end;
                  end;
                  suppose
A121:               front_left_cell(f,(len f)-'1,G) meets C;
                    thus thesis
                    proof
                      per cases by A19;
                      suppose
A122:                   i1 = i2 & j1+1 = j2;
                        take f1 = f^<*G*(i2-'1,j2)*>;
                        now
                          take i=i2-'1 ,j=j2;
                          thus f1 turns_left (len f)-'1,G
                          proof
                            let i19,j19,i29,j29 be Element of NAT;
                            assume that
A123:                       [i19,j19] in Indices G and
A124:                       [i29,j29] in Indices G and
A125:                       f1/.((len f)-'1) = G*(i19,j19) and
A126:                       f1/.((len f)-'1+1) = G*(i29,j29);
A127:                       f/.((len f)-'1) = G*(i19,j19) by A26,A125,
FINSEQ_4:83;
                            then
A128:                       i1 = i19 by A15,A16,A123,GOBOARD1:21;
A129:                       j1 = j19 by A15,A16,A123,A127,GOBOARD1:21;
A130:                       f/.((len f)-'1+1) = G*(i29,j29) by A13,A126,
FINSEQ_4:83;
                            then
A131:                       i2 = i29 by A17,A18,A124,GOBOARD1:21;
A132:                       j2 = j29 by A17,A18,A124,A130,GOBOARD1:21;
                            per cases by A15,A16,A19,A123,A127,A131,A132,
GOBOARD1:21;
                            case
                              i19 = i29 & j19+1 = j29;
                              now
                                assume
                                i2-'1 < 1;
                                then i2 <= 1 by NAT_1:14,NAT_D:36;
                                then i2 = 1 by A22,XXREAL_0:1;
                                then cell(G,1-'1,j2) meets C by A10,A14,A11,A15
,A16,A17,A18,A121,A122,GOBRD13:35;
                                then cell(G,0,j2) meets C by XREAL_1:234;
                                hence contradiction by A2,A27,JORDAN8:21;
                              end;
                              hence [i29-'1,j29] in Indices G by A25,A27,A30
,A131,A132,MATRIX_1:37;
                              thus thesis by A12,A131,A132,FINSEQ_4:82;
                            end;
                            case
                              i19+1 = i29 & j19 = j29;
                              hence thesis by A122,A128,A131;
                            end;
                            case
                              i19 = i29+1 & j19 = j29;
                              hence thesis by A122,A128,A131;
                            end;
                            case
                              i19 = i29 & j19 = j29+1;
                              hence thesis by A122,A129,A132;
                            end;
                          end;
                        end;
                        hence thesis by A7,A9,A10,A121;
                      end;
                      suppose
A133:                   i1+1 = i2 & j1 = j2;
                        take f1 = f^<*G*(i2,j2+1)*>;
                        now
                          take i=i2,j=j2+1;
                          thus f1 turns_left (len f)-'1,G
                          proof
                            let i19,j19,i29,j29 be Element of NAT;
                            assume that
A134:                       [i19,j19] in Indices G and
A135:                       [i29,j29] in Indices G and
A136:                       f1/.((len f)-'1) = G*(i19,j19) and
A137:                       f1/.((len f)-'1+1) = G*(i29,j29);
A138:                       f/.((len f)-'1+1) = G*(i29,j29) by A13,A137,
FINSEQ_4:83;
                            then
A139:                       i2 = i29 by A17,A18,A135,GOBOARD1:21;
A140:                       f/.((len f)-'1) = G*(i19,j19) by A26,A136,
FINSEQ_4:83;
                            then
A141:                       i1 = i19 by A15,A16,A134,GOBOARD1:21;
A142:                       j2 = j29 by A17,A18,A135,A138,GOBOARD1:21;
                            per cases by A15,A16,A19,A134,A140,A139,A142,
GOBOARD1:21;
                            case
                              i19 = i29 & j19+1 = j29;
                              hence thesis by A133,A141,A139;
                            end;
                            case
                              i19+1 = i29 & j19 = j29;
                              now
                                assume
                                j2+1 > len G;
                                then
A143:                           (len G)+1 <= j2+1 by NAT_1:13;
                                j2+1 <= (len G)+1 by A2,A27,XREAL_1:8;
                                then j2+1 = (len G)+1 by A143,XXREAL_0:1;
                                then cell(G,i2,len G) meets C by A10,A14,A11
,A15,A16,A17,A18,A121,A133,GOBRD13:37;
                                hence contradiction by A29,JORDAN8:18;
                              end;
                              hence
                              [i29,j29+1] in Indices G by A2,A22,A29,A21,A139
,A142,MATRIX_1:37;
                              thus thesis by A12,A139,A142,FINSEQ_4:82;
                            end;
                            case
                              i19 = i29+1 & j19 = j29;
                              hence thesis by A133,A141,A139;
                            end;
                            case
                              i19 = i29 & j19 = j29+1;
                              hence thesis by A133,A141,A139;
                            end;
                          end;
                        end;
                        hence thesis by A7,A9,A10,A121;
                      end;
                      suppose
A144:                   i1 = i2+1 & j1 = j2;
                        take f1 = f^<*G*(i2,j2-'1)*>;
                        now
                          take i=i2,j=j2-'1;
                          thus f1 turns_left (len f)-'1,G
                          proof
                            let i19,j19,i29,j29 be Element of NAT;
                            assume that
A145:                       [i19,j19] in Indices G and
A146:                       [i29,j29] in Indices G and
A147:                       f1/.((len f)-'1) = G*(i19,j19) and
A148:                       f1/.((len f)-'1+1) = G*(i29,j29);
A149:                       f/.((len f)-'1+1) = G*(i29,j29) by A13,A148,
FINSEQ_4:83;
                            then
A150:                       i2 = i29 by A17,A18,A146,GOBOARD1:21;
A151:                       f/.((len f)-'1) = G*(i19,j19) by A26,A147,
FINSEQ_4:83;
                            then
A152:                       i1 = i19 by A15,A16,A145,GOBOARD1:21;
A153:                       j2 = j29 by A17,A18,A146,A149,GOBOARD1:21;
                            per cases by A15,A16,A19,A145,A151,A150,A153,
GOBOARD1:21;
                            case
                              i19 = i29 & j19+1 = j29;
                              hence thesis by A144,A152,A150;
                            end;
                            case
                              i19+1 = i29 & j19 = j29;
                              hence thesis by A144,A152,A150;
                            end;
                            case
                              i19 = i29+1 & j19 = j29;
                              now
                                assume
                                j2-'1 < 1;
                                then j2 <= 1 by NAT_1:14,NAT_D:36;
                                then j2 = 1 by A25,XXREAL_0:1;
                                then cell(G,i2-'1,1-'1) meets C by A10,A14,A11
,A15,A16,A17,A18,A121,A144,GOBRD13:39;
                                then cell(G,i2-'1,0) meets C by XREAL_1:234;
                                hence contradiction by A29,JORDAN8:20,NAT_D:44;
                              end;
                              hence [i29,j29-'1] in Indices G by A22,A29,A28
,A150,A153,MATRIX_1:37;
                              thus thesis by A12,A150,A153,FINSEQ_4:82;
                            end;
                            case
                              i19 = i29 & j19 = j29+1;
                              hence thesis by A144,A152,A150;
                            end;
                          end;
                        end;
                        hence thesis by A7,A9,A10,A121;
                      end;
                      suppose
A154:                   i1 = i2 & j1 = j2+1;
                        take f1 = f^<*G*(i2+1,j2)*>;
                        now
                          take i=i2+1 ,j=j2;
                          thus f1 turns_left (len f)-'1,G
                          proof
                            let i19,j19,i29,j29 be Element of NAT;
                            assume that
A155:                       [i19,j19] in Indices G and
A156:                       [i29,j29] in Indices G and
A157:                       f1/.((len f)-'1) = G*(i19,j19) and
A158:                       f1/.((len f)-'1+1) = G*(i29,j29);
A159:                       f/.((len f)-'1) = G*(i19,j19) by A26,A157,
FINSEQ_4:83;
                            then
A160:                       i1 = i19 by A15,A16,A155,GOBOARD1:21;
A161:                       j1 = j19 by A15,A16,A155,A159,GOBOARD1:21;
A162:                       f/.((len f)-'1+1) = G*(i29,j29) by A13,A158,
FINSEQ_4:83;
                            then
A163:                       i2 = i29 by A17,A18,A156,GOBOARD1:21;
A164:                       j2 = j29 by A17,A18,A156,A162,GOBOARD1:21;
                            per cases by A15,A16,A19,A155,A159,A163,A164,
GOBOARD1:21;
                            case
                              i19 = i29 & j19+1 = j29;
                              hence thesis by A154,A161,A164;
                            end;
                            case
                              i19+1 = i29 & j19 = j29;
                              hence thesis by A154,A160,A163;
                            end;
                            case
                              i19 = i29+1 & j19 = j29;
                              hence thesis by A154,A160,A163;
                            end;
                            case
                              i19 = i29 & j19 = j29+1;
                              now
                                assume
                                i2+1 > len G;
                                then
A165:                           (len G)+1 <= i2+1 by NAT_1:13;
                                i2+1 <= (len G)+1 by A29,XREAL_1:8;
                                then i2+1 = (len G)+1 by A165,XXREAL_0:1;
                                then cell(G,len G,j2-'1) meets C by A10,A14,A11
,A15,A16,A17,A18,A121,A154,GOBRD13:41;
                                hence contradiction by A2,A27,JORDAN8:19
,NAT_D:44;
                              end;
                              hence [i29+1,j29] in Indices G by A25,A27,A24
,A163,A164,MATRIX_1:37;
                              thus thesis by A12,A163,A164,FINSEQ_4:82;
                            end;
                          end;
                        end;
                        hence thesis by A7,A9,A10,A121;
                      end;
                    end;
                  end;
                end;
              end;
              suppose
A166:           not f is_sequence_on G or right_cell(f,len f-'1,G)
                misses C;
                take f^<*G*(1,1)*>;
                thus thesis by A7,A9,A166;
              end;
            end;
          end;
          suppose
A167:       len f <> k;
            take {};
            thus thesis by A7,A167;
          end;
        end;
      end;
      suppose
A168:   k > 1 & x is not FinSequence of TOP-REAL 2;
        take {};
        thus thesis by A168;
      end;
    end;
    consider F being Function such that
A169: dom F = NAT and
A170: F.0 = {} and
A171: for k being Element of NAT holds P[k,F.k,F.(k+1)] from RECDEF_1:
    sch 1 (A3);
    defpred P[Element of NAT] means F.$1 is FinSequence of TOP-REAL 2;
A172: {} = <*>(the carrier of TOP-REAL 2);
A173: for k st P[k] holds P[k+1]
    proof
      let k such that
A174: F.k is FinSequence of TOP-REAL 2;
A175: P[k,F.k,F.(k+1)] by A171;
      per cases by NAT_1:26;
      suppose
        k = 0;
        hence thesis by A175;
      end;
      suppose
        k = 1;
        hence thesis by A175;
      end;
      suppose
A176:   k > 1;
        thus thesis
        proof
          reconsider f = F.k as FinSequence of TOP-REAL 2 by A174;
          per cases;
          suppose
A177:       len f = k;
            thus thesis
            proof
              per cases;
              suppose
A178:           f is_sequence_on G & right_cell(f,len f-'1,G) meets
                C;
                then
A179:           front_left_cell(f,(len f)-'1,G) meets C implies ex i,j
st f^<*G*(i,j) *> turns_left (len f)-'1,G & F.(k+1) = f^<*G*(i,j)*> by A171
,A176,A177;
A180:           front_left_cell(f,(len f)-'1,G) misses C &
front_right_cell(f,(len f) -'1,G) meets C implies ex i,j st f^<*G*(i,j)*>
goes_straight (len f)-'1,G & F.( k+1) = f^<*G*(i,j)*> by A171,A176,A177,A178;
                front_left_cell(f,(len f)-'1,G) misses C &
front_right_cell(f,(len f) -'1,G) misses C implies ex i,j st f^<*G*(i,j)*>
turns_right (len f)-'1,G & F.(k +1) = f^<*G*(i,j)*> by A171,A176,A177,A178;
                hence thesis by A180,A179;
              end;
              suppose
A181:           not f is_sequence_on G or right_cell(f,len f-'1,G)
                misses C;
                f^<*G*(1,1)*> is FinSequence of TOP-REAL 2;
                hence thesis by A171,A176,A177,A181;
              end;
            end;
          end;
          suppose
            len f <> k;
            hence thesis by A171,A172,A176;
          end;
        end;
      end;
    end;
A182: P[0] by A170,A172;
A183: for k holds P[k] from NAT_1:sch 1(A182,A173);
    rng F c= (the carrier of TOP-REAL 2)*
    proof
      let y be set;
      assume
      y in rng F;
      then ex x being set st x in dom F & F.x = y by FUNCT_1:def 5;
      then y is FinSequence of TOP-REAL 2 by A169,A183;
      hence thesis by FINSEQ_1:def 11;
    end;
    then reconsider F as Function of NAT,(the carrier of TOP-REAL 2)* by A169,
FUNCT_2:def 1,RELSET_1:11;
    defpred P[Element of NAT] means len(F.$1) = $1;
A184: for k st P[k] holds P[k+1]
    proof
      let k such that
A185: len(F.k) = k;
A186: P[k,F.k,F.(k+1)] by A171;
      per cases by NAT_1:26;
      suppose
        k = 0;
        hence thesis by A186,FINSEQ_1:56;
      end;
      suppose
        k = 1;
        hence thesis by A186,FINSEQ_1:61;
      end;
      suppose
A187:   k > 1;
        thus thesis
        proof
          per cases;
          suppose
A188:       F.k is_sequence_on G & right_cell(F.k,len(F.k)-'1,G)
            meets C;
            then
A189:       front_left_cell(F.k,(len(F.k))-'1,G) meets C implies ex i,j
st (F.k)^ <*G*(i,j)*> turns_left (len(F.k))-'1,G & F.(k+1) = (F.k)^<*G*(i,j)*>
            by A171,A185,A187;
A190:       front_left_cell(F.k,(len(F.k))-'1,G) misses C &
front_right_cell(F.k, (len(F.k))-'1,G) meets C implies ex i,j st (F.k)^<*G*(i,j
)*> goes_straight (len (F.k))-'1,G & F.(k+1) = (F.k)^<*G*(i,j)*> by A171,A185
,A187,A188;
            front_left_cell(F.k,(len(F.k))-'1,G) misses C &
front_right_cell(F.k, (len(F.k))-'1,G) misses C implies ex i,j st (F.k)^<*G*(i,
j)*> turns_right (len( F.k))-'1,G & F.(k+1) = (F.k)^<*G*(i,j)*> by A171,A185
,A187,A188;
            hence thesis by A185,A190,A189,FINSEQ_2:19;
          end;
          suppose
            not F.k is_sequence_on G or right_cell(F.k,len(F.k)-'1,G
            ) misses C;
            then F.(k+1) = (F.k)^<*G*(1,1)*> by A171,A185,A187;
            hence thesis by A185,FINSEQ_2:19;
          end;
        end;
      end;
    end;
A191: P[0] by A170,CARD_1:47;
A192: for k holds P[k] from NAT_1:sch 1(A191,A184);
A193: now
      let k such that
A194: F.k is_sequence_on G and
A195: for m st 1 <= m & m+1 <= len(F.k) holds left_cell(F.k,m,G)
      misses C & right_cell(F.k,m,G) meets C and
A196: k > 1;
      len(F.k) = k by A192;
      then
A197: 1 <= (len(F.k))-'1 & (len(F.k)) -'1 +1 = len(F.k) by A196,NAT_D:49
,XREAL_1:237;
      then
A198: right_cell(F.k,(len(F.k))-'1,G) meets C by A195;
      let i1,j1,i2,j2 be Element of NAT such that
A199: [i1,j1] in Indices G and
A200: (F.k)/.((len(F.k)) -'1) = G*(i1,j1) and
A201: [i2,j2] in Indices G and
A202: (F.k)/.len(F.k) = G*(i2,j2);
A203: i2 <= len G by A201,MATRIX_1:39;
A204: 1 <= i2+1 by NAT_1:12;
A205: 1 <= j2 by A201,MATRIX_1:39;
A206: j2 <= width G by A201,MATRIX_1:39;
A207: j1 <= width G by A199,MATRIX_1:39;
      hereby
        assume
A208:   i1 = i2 & j1+1 = j2;
        now
          assume
          i2+1 > len G;
          then
A209:     (len G)+1 <= i2+1 by NAT_1:13;
          i2+1 <= (len G)+1 by A203,XREAL_1:8;
          then i2+1 = (len G)+1 by A209,XXREAL_0:1;
          then cell(G,len G,j1) meets C by A194,A199,A200,A201,A202,A197,A198
,A208,GOBRD13:23;
          hence contradiction by A2,A207,JORDAN8:19;
        end;
        hence [i2+1,j2] in Indices G by A205,A206,A204,MATRIX_1:37;
      end;
A210: i1 <= len G by A199,MATRIX_1:39;
A211: 1 <= i2 by A201,MATRIX_1:39;
A212: j2-'1 <= width G by A206,NAT_D:44;
      hereby
        assume
A213:   i1+1 = i2 & j1 = j2;
        now
          assume
          j2-'1 < 1;
          then j2 <= 1 by NAT_1:14,NAT_D:36;
          then j2 = 1 by A205,XXREAL_0:1;
          then cell(G,i1,1-'1) meets C by A194,A199,A200,A201,A202,A197,A198
,A213,GOBRD13:25;
          then cell(G,i1,0) meets C by XREAL_1:234;
          hence contradiction by A210,JORDAN8:20;
        end;
        hence [i2,j2-'1] in Indices G by A211,A203,A212,MATRIX_1:37;
      end;
A214: 1 <= j2+1 by NAT_1:12;
      hereby
        assume
A215:   i1 = i2+1 & j1 = j2;
        now
          assume
          j2+1 > len G;
          then
A216:     (len G)+1 <= j2+1 by NAT_1:13;
          j2+1 <= (len G)+1 by A2,A206,XREAL_1:8;
          then j2+1 = (len G)+1 by A216,XXREAL_0:1;
          then cell(G,i2,len G) meets C by A194,A199,A200,A201,A202,A197,A198
,A215,GOBRD13:27;
          hence contradiction by A203,JORDAN8:18;
        end;
        hence [i2,j2+1] in Indices G by A2,A211,A203,A214,MATRIX_1:37;
      end;
A217: i2-'1 <= len G by A203,NAT_D:44;
      hereby
        assume
A218:   i1 = i2 & j1 = j2+1;
        now
          assume
          i2-'1 < 1;
          then i2 <= 1 by NAT_1:14,NAT_D:36;
          then i2 = 1 by A211,XXREAL_0:1;
          then cell(G,1-'1,j2) meets C by A194,A199,A200,A201,A202,A197,A198
,A218,GOBRD13:29;
          then cell(G,0,j2) meets C by XREAL_1:234;
          hence contradiction by A2,A206,JORDAN8:21;
        end;
        hence [i2-'1,j2] in Indices G by A205,A206,A217,MATRIX_1:37;
      end;
      hereby
        assume
A219:   front_right_cell(F.k,(len(F.k))-'1,G) meets C & i1 = i2 & j1
        +1 = j2;
        now
          assume
          j2+1 > len G;
          then
A220:     (len G)+1 <= j2+1 by NAT_1:13;
          j2+1 <= (len G)+1 by A2,A206,XREAL_1:8;
          then j2+1 = (len G)+1 by A220,XXREAL_0:1;
          then cell(G,i1,len G) meets C by A194,A199,A200,A201,A202,A197,A219,
GOBRD13:36;
          hence contradiction by A210,JORDAN8:18;
        end;
        hence [i2,j2+1] in Indices G by A2,A211,A203,A214,MATRIX_1:37;
      end;
      hereby
        assume
A221:   front_right_cell(F.k,(len(F.k))-'1,G) meets C & i1+1 = i2 &
        j1 = j2;
        now
          assume
          i2+1 > len G;
          then
A222:     (len G)+1 <= i2+1 by NAT_1:13;
          i2+1 <= (len G)+1 by A203,XREAL_1:8;
          then i2+1 = (len G)+1 by A222,XXREAL_0:1;
          then cell(G,len G,j1-'1) meets C by A194,A199,A200,A201,A202,A197
,A221,GOBRD13:38;
          hence contradiction by A2,A207,JORDAN8:19,NAT_D:44;
        end;
        hence [i2+1,j2] in Indices G by A205,A206,A204,MATRIX_1:37;
      end;
      hereby
        assume
A223:   front_right_cell(F.k,(len(F.k))-'1,G) meets C & i1 = i2+1 &
        j1 = j2;
        now
          assume
          i2-'1 < 1;
          then i2 <= 1 by NAT_1:14,NAT_D:36;
          then i2 = 1 by A211,XXREAL_0:1;
          then cell(G,1-'1,j1) meets C by A194,A199,A200,A201,A202,A197,A223,
GOBRD13:40;
          then cell(G,0,j1) meets C by XREAL_1:234;
          hence contradiction by A2,A207,JORDAN8:21;
        end;
        hence [i2-'1,j2] in Indices G by A205,A206,A217,MATRIX_1:37;
      end;
      hereby
        assume
A224:   front_right_cell(F.k,(len(F.k))-'1,G) meets C & i1 = i2 & j1
        = j2+1;
        now
          assume
          j2-'1 < 1;
          then j2 <= 1 by NAT_1:14,NAT_D:36;
          then j2 = 1 by A205,XXREAL_0:1;
          then cell(G,i1-'1,1-'1) meets C by A194,A199,A200,A201,A202,A197,A224
,GOBRD13:42;
          then cell(G,i1-'1,0) meets C by XREAL_1:234;
          hence contradiction by A210,JORDAN8:20,NAT_D:44;
        end;
        hence [i2,j2-'1] in Indices G by A211,A203,A212,MATRIX_1:37;
      end;
      hereby
        assume
A225:   front_left_cell(F.k,(len(F.k))-'1,G) meets C & i1 = i2 & j1+
        1 = j2;
        now
          assume
          i2-'1 < 1;
          then i2 <= 1 by NAT_1:14,NAT_D:36;
          then i2 = 1 by A211,XXREAL_0:1;
          then cell(G,1-'1,j2) meets C by A194,A199,A200,A201,A202,A197,A225,
GOBRD13:35;
          then cell(G,0,j2) meets C by XREAL_1:234;
          hence contradiction by A2,A206,JORDAN8:21;
        end;
        hence [i2-'1,j2] in Indices G by A205,A206,A217,MATRIX_1:37;
      end;
      hereby
        assume
A226:   front_left_cell(F.k,(len(F.k))-'1,G) meets C & i1+1 = i2 &
        j1 = j2;
        now
          assume
          j2+1 > len G;
          then
A227:     (len G)+1 <= j2+1 by NAT_1:13;
          j2+1 <= (len G)+1 by A2,A206,XREAL_1:8;
          then j2+1 = (len G)+1 by A227,XXREAL_0:1;
          then cell(G,i2,len G) meets C by A194,A199,A200,A201,A202,A197,A226,
GOBRD13:37;
          hence contradiction by A203,JORDAN8:18;
        end;
        hence [i2,j2+1] in Indices G by A2,A211,A203,A214,MATRIX_1:37;
      end;
      hereby
        assume
A228:   front_left_cell(F.k,(len(F.k))-'1,G) meets C & i1 = i2+1 &
        j1 = j2;
        now
          assume
          j2-'1 < 1;
          then j2 <= 1 by NAT_1:14,NAT_D:36;
          then j2 = 1 by A205,XXREAL_0:1;
          then cell(G,i2-'1,1-'1) meets C by A194,A199,A200,A201,A202,A197,A228
,GOBRD13:39;
          then cell(G,i2-'1,0) meets C by XREAL_1:234;
          hence contradiction by A203,JORDAN8:20,NAT_D:44;
        end;
        hence [i2,j2-'1] in Indices G by A211,A203,A212,MATRIX_1:37;
      end;
      hereby
        assume
A229:   front_left_cell(F.k,(len(F.k))-'1,G) meets C & i1 = i2 & j1
        = j2+1;
        now
          assume
          i2+1 > len G;
          then
A230:     (len G)+1 <= i2+1 by NAT_1:13;
          i2+1 <= (len G)+1 by A203,XREAL_1:8;
          then i2+1 = (len G)+1 by A230,XXREAL_0:1;
          then cell(G,len G,j2-'1) meets C by A194,A199,A200,A201,A202,A197
,A229,GOBRD13:41;
          hence contradiction by A2,A206,JORDAN8:19,NAT_D:44;
        end;
        hence [i2+1,j2] in Indices G by A205,A206,A204,MATRIX_1:37;
      end;
    end;
    defpred P[Element of NAT] means F.$1 is_sequence_on G & for m st 1 <= m &
    m+1 <= len(F.$1) holds left_cell(F.$1,m,G) misses C & right_cell(F.$1,m,G)
    meets C;
A231: len G = 2|^n+3 by JORDAN8:def 1;
A232: for k st P[k] holds P[k+1]
    proof
A233: 2|^n > 0 by NEWTON:102;
A234: 1 <= len G by A231,NAT_1:12;
      let k such that
A235: F.k is_sequence_on G and
A236: for m st 1 <= m & m+1 <= len(F.k) holds left_cell(F.k,m,G)
      misses C & right_cell(F.k,m,G) meets C;
A237: len(F.k) = k by A192;
A238: len(F.(k+1)) = k+1 by A192;
      per cases by NAT_1:26;
      suppose
A239:   k = 0;
        then consider i such that
A240:   1 <= i and
A241:   i+1 <= len G and
        N-min C in cell(G,i,width G-'1) and
        N-min C <> G*(i,width G-'1) and
A242:   F.(k+1) = <*G*(i,width G)*> by A171;
        i < len G by A241,NAT_1:13;
        then
A243:   [i,len G] in Indices G by A2,A234,A240,MATRIX_1:37;
A244:   now
          let l;
          assume
          l in dom(F.(k+1));
          then 1 <= l & l <= 1 by A238,A239,FINSEQ_3:27;
          then l = 1 by XXREAL_0:1;
          hence ex i,j st [i,j] in Indices G & (F.(k+1))/.l = G* (i,j) by A2
,A242,A243,FINSEQ_4:25;
        end;
        now
          let l;
          assume that
A245:     l in dom(F.(k+1)) and
A246:     l+1 in dom(F.(k+1));
          1 <= l & l <= 1 by A238,A239,A245,FINSEQ_3:27;
          then l = 1 by XXREAL_0:1;
          hence for i1,j1,i2,j2 st [i1,j1] in Indices G & [i2,j2] in Indices G
& (F.(k+1))/.l = G*(i1,j1) & (F.(k+1))/.(l+1) = G*(i2,j2) holds abs(i1-i2)+abs(
          j1-j2) = 1 by A238,A239,A246,FINSEQ_3:27;
        end;
        hence F.(k+1) is_sequence_on G by A244,GOBOARD1:def 11;
        let m;
        assume that
A247:   1 <= m and
A248:   m+1 <= len(F.(k+1));
        1 <= m+1 by NAT_1:12;
        then m+1 = 0+1 by A238,A239,A248,XXREAL_0:1;
        hence thesis by A247;
      end;
      suppose
A249:   k = 1;
        then consider i such that
A250:   1 <= i and
A251:   i+1 <= len G and
A252:   N-min C in cell(G,i,width G-'1) and
        N-min C <> G*(i,width G-'1) and
A253:   F.(k+1) = <*G*(i,width G),G*(i+1,width G)*> by A171;
A254:   i < len G by A251,NAT_1:13;
        then
A255:   [i,len G] in Indices G by A2,A234,A250,MATRIX_1:37;
        1 <= i+1 by A250,NAT_1:13;
        then
A256:   [i+1,len G] in Indices G by A2,A234,A251,MATRIX_1:37;
A257:   (F.(k+1))/.1 = G*(i,width G) & (F.(k+1))/.2 = G*(i+1,width G) by A253,
FINSEQ_4:26;
A258:   now
          let l;
          assume that
A259:     l in dom(F.(k+1)) and
A260:     l+1 in dom(F.(k+1));
          l <= 2 by A238,A249,A259,FINSEQ_3:27;
          then
A261:     l = 0 or l = 1 or l = 2 by NAT_1:27;
          let i1,j1,i2,j2 such that
A262:     [i1,j1] in Indices G & [i2,j2] in Indices G & (F.(k+1))/.l
          = G*(i1,j1) & (F.(k+1))/.(l+1) = G*(i2,j2);
          j1 = len G & j2 = len G by A2,A238,A249,A257,A255,A256,A259,A260,A261
,A262,FINSEQ_3:27,GOBOARD1:21;
          then
A263:     abs(j1-j2) = 0 by ABSVALUE:def 1;
          i1 = i & i2 = i+1 by A2,A238,A249,A257,A255,A256,A259,A260,A261,A262,
FINSEQ_3:27,GOBOARD1:21;
          then abs(i2-i1) = 1 by ABSVALUE:def 1;
          hence abs(i1-i2)+abs(j1-j2) = 1 by A263,UNIFORM1:13;
        end;
        now
          let l;
          assume
A264:     l in dom(F.(k+1));
          then l <= 2 by A238,A249,FINSEQ_3:27;
          then l = 0 or l = 1 or l = 2 by NAT_1:27;
          hence ex i,j st [i,j] in Indices G & (F.(k+1))/.l = G*(i,j) by A2
,A257,A255,A256,A264,FINSEQ_3:27;
        end;
        hence
A265:   F.(k+1) is_sequence_on G by A258,GOBOARD1:def 11;
A266:   i < i+1 & i+1 < (i+1)+1 by NAT_1:13;
        let m;
        assume that
A267:   1 <= m and
A268:   m+1 <= len(F.(k+1));
        1+1 <= m+1 by A267,XREAL_1:8;
        then
A269:   m+1 = 1+1 by A238,A249,A268,XXREAL_0:1;
        then
A270:   left_cell(F.(k+1),m,G) = cell(G,i,len G) by A2,A257,A255,A256,A265,A268
,A266,GOBRD13:def 3;
        now
          N > S by JORDAN8:12;
          then N-S > S-S by XREAL_1:11;
          then (N-S)/(2|^n) > 0 by A233,XREAL_1:141;
          then
A271:     N+0 < N+(N-S)/(2|^n) by XREAL_1:8;
          [1,len G] in Indices G by A2,A234,MATRIX_1:37;
          then G* (1,len G) = |[W+((E-W)/(2|^n))*(1-2),S+((N-S)/(2|^n))*((len
          G)-2)]| by JORDAN8:def 1;
          then
A272:     G*(1,len G)`2 = S+((N-S)/(2|^n))*((len G)-2) by EUCLID:56;
A273:     cell(G,i,len G) = { |[r,s]|: G*(i,1)`1 <= r & r <= G*(i+1,1)`1
          & G*(1,len G)`2 <= s } by A2,A250,A254,GOBRD11:31;
          assume
          left_cell(F.(k+1),m,G) meets C;
          then consider p being set such that
A274:     p in cell(G,i,len G) and
A275:     p in C by A270,XBOOLE_0:3;
          reconsider p as Point of TOP-REAL 2 by A274;
          reconsider p as Element of TOP-REAL 2;
A276:     p`2 <= N by A275,PSCOMP_1:71;
          consider r,s such that
A277:     p = |[r,s]| and
          G*(i,1)`1 <= r and
          r <= G*(i+1,1)`1 and
A278:     G*(1,len G)`2 <= s by A274,A273;
          ((N-S)/(2|^n))*((len G)-2) = ((N-S)/(2|^n))*(2|^n)+((N-S)/(2|^
          n))*1 by A231
            .= (N-S)+(N-S)/(2|^n) by A233,XCMPLX_1:88;
          then N < s by A278,A272,A271,XXREAL_0:2;
          hence contradiction by A277,A276,EUCLID:56;
        end;
        hence left_cell(F.(k+1),m,G) misses C;
        N-min C in C & N-min C in right_cell(F.(k+1),m,G) by A2,A252,A257,A255
,A256,A265,A268,A269,A266,GOBRD13:def 2,SPRECT_1:13;
        hence thesis by XBOOLE_0:3;
      end;
      suppose
A279:   k > 1;
        then
A280:   len(F.k) in dom(F.k) by A237,FINSEQ_3:27;
A281:   (len(F.k)) -'1 +1 = len(F.k) by A237,A279,XREAL_1:237;
        then
A282:   (len(F.k))-'1+(1+1) = (len(F.k))+1;
A283:   1 <= (len(F.k))-'1 by A237,A279,NAT_D:49;
        then consider i1,j1,i2,j2 being Element of NAT such that
A284:   [i1,j1] in Indices G and
A285:   (F.k)/.((len(F.k)) -'1) = G*(i1,j1) and
A286:   [i2,j2] in Indices G and
A287:   (F.k)/.len(F.k) = G*(i2,j2) and
        i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or i1 = i2+1 & j1 = j2
        or i1 = i2 & j1 = j2+1 by A235,A281,JORDAN8:6;
A288:   i1 = i2 & j1+1 = j2 implies [i2+1,j2] in Indices G by A193,A235,A236
,A279,A284,A285,A286,A287;
A289:   front_left_cell(F.k,(len(F.k))-'1,G) meets C & i1 = i2+1 & j1 =
j2 implies [i2,j2-'1] in Indices G by A193,A235,A236,A279,A284,A285,A286,A287;
A290:   front_left_cell(F.k,(len(F.k))-'1,G) meets C & i1+1 = i2 & j1 =
j2 implies [i2,j2+1] in Indices G by A193,A235,A236,A279,A284,A285,A286,A287;
A291:   front_left_cell(F.k,(len(F.k))-'1,G) meets C & i1 = i2 & j1+1 =
j2 implies [i2-'1,j2] in Indices G by A193,A235,A236,A279,A284,A285,A286,A287;
A292:   front_right_cell(F.k,(len(F.k))-'1,G) meets C & i1 = i2 & j1 =
j2+1 implies [i2,j2-'1] in Indices G by A193,A235,A236,A279,A284,A285,A286,A287
;
A293:   i1 = i2+1 & j1 = j2 implies [i2,j2+1] in Indices G by A193,A235,A236
,A279,A284,A285,A286,A287;
A294:   i1 +1 = i2 & j1 = j2 implies [i2,j2-'1] in Indices G by A193,A235,A236
,A279,A284,A285,A286,A287;
A295:   1 <= j2 by A286,MATRIX_1:39;
A296:   right_cell(F.k,(len(F.k))-'1,G) meets C by A236,A283,A281;
A297:   front_right_cell(F.k,(len(F.k))-'1,G) meets C & i1 = i2+1 & j1 =
j2 implies [i2-'1,j2] in Indices G by A193,A235,A236,A279,A284,A285,A286,A287;
A298:   front_right_cell(F.k,(len(F.k))-'1,G) meets C & i1+1 = i2 & j1 =
j2 implies [i2+1,j2] in Indices G by A193,A235,A236,A279,A284,A285,A286,A287;
A299:   front_right_cell(F.k,(len(F.k))-'1,G) meets C & i1 = i2 & j1+1 =
j2 implies [i2,j2+1] in Indices G by A193,A235,A236,A279,A284,A285,A286,A287;
A300:   i1 = i2 & j1 = j2+1 implies [i2-'1,j2] in Indices G by A193,A235,A236
,A279,A284,A285,A286,A287;
A301:   front_left_cell(F.k,(len(F.k))-'1,G) meets C & i1 = i2 & j1 = j2
+1 implies [i2+1,j2] in Indices G by A193,A235,A236,A279,A284,A285,A286,A287;
        (len(F.k))-'1 <= len(F.k) by NAT_D:35;
        then
A302:   (len(F.k))-'1 in dom(F.k) by A283,FINSEQ_3:27;
A303:   1 <= i2 by A286,MATRIX_1:39;
        thus
A304:   F.(k+1) is_sequence_on G
        proof
          per cases;
          suppose
            front_left_cell(F.k,(len(F.k))-'1,G) misses C &
            front_right_cell(F.k,(len(F.k))-'1,G) misses C;
            then consider i,j such that
A305:       (F.k)^<*G*(i,j)*> turns_right (len(F.k))-'1,G and
A306:       F.(k+1) = (F.k)^<*G*(i,j)*> by A171,A235,A237,A279,A296;
            thus thesis
            proof
              set f = (F.k)^<*G*(i,j)*>;
A307:         f/.(len(F.k)+1) = G*(i,j) by FINSEQ_4:82;
A308:         f/.(len(F.k)-'1) = G*(i1,j1) & f/.len(F.k) = G*(i2,j2) by A285
,A287,A302,A280,FINSEQ_4:83;
              per cases by A281,A284,A286,A282,A305,A308,GOBRD13:def 6;
              suppose that
A309:           i1 = i2 & j1+1 = j2 and
A310:           f/.(len(F.k)+1) = G*(i2+1,j2);
                now
                  let i19,j19,i29,j29 be Element of NAT;
                  assume
A311:             [i19,j19] in Indices G & [i29,j29] in Indices G &
                  (F.k)/.len(F.k) = G* (i19,j19) & G*(i2+1,j2) = G*(i29,j29);
                  then j2 = j19 & j2 = j29 by A286,A287,A288,A309,GOBOARD1:21;
                  then
A312:             abs(j29-j19) = 0 by ABSVALUE:def 1;
                  i2 = i19 & i2+1 = i29 by A286,A287,A288,A309,A311,GOBOARD1:21
;
                  hence abs(i29-i19)+abs(j29-j19) = 1 by A312,ABSVALUE:def 1;
                end;
                hence thesis by A235,A237,A279,A288,A306,A307,A309,A310,
CARD_1:47,JORDAN8:9;
              end;
              suppose that
A313:           i1+1 = i2 & j1 = j2 and
A314:           f/.(len(F.k)+1) = G*(i2,j2-'1);
                now
                  let i19,j19,i29,j29 be Element of NAT;
                  assume
A315:             [i19,j19] in Indices G & [i29,j29] in Indices G &
                  (F.k)/.len(F.k) = G* (i19,j19) & G*(i2,j2-'1) = G* (i29,j29);
                  then j2 = j19 & j2-'1 = j29 by A286,A287,A294,A313,
GOBOARD1:21;
                  then j19-j29 = j2-(j2-1) by A295,XREAL_1:235;
                  then
A316:             abs(j19-j29) = 1 by ABSVALUE:def 1;
                  i2 = i19 & i2 = i29 by A286,A287,A294,A313,A315,GOBOARD1:21;
                  then abs(i29-i19) = 0 by ABSVALUE:def 1;
                  hence abs(i29-i19)+abs(j29-j19) = 1 by A316,UNIFORM1:13;
                end;
                hence thesis by A235,A237,A279,A294,A306,A307,A313,A314,
CARD_1:47,JORDAN8:9;
              end;
              suppose that
A317:           i1 = i2+1 & j1 = j2 and
A318:           f/.(len(F.k)+1) = G*(i2,j2+1);
                now
                  let i19,j19,i29,j29 be Element of NAT;
                  assume
A319:             [i19,j19] in Indices G & [i29,j29] in Indices G &
                  (F.k)/.len(F.k) = G* (i19,j19) & G*(i2,j2+1) = G*(i29,j29);
                  then i2 = i19 & i2 = i29 by A286,A287,A293,A317,GOBOARD1:21;
                  then
A320:             abs(i29-i19) = 0 by ABSVALUE:def 1;
                  j2 = j19 & j2+1 = j29 by A286,A287,A293,A317,A319,GOBOARD1:21
;
                  hence abs(i29-i19)+abs(j29-j19) = 1 by A320,ABSVALUE:def 1;
                end;
                hence thesis by A235,A237,A279,A293,A306,A307,A317,A318,
CARD_1:47,JORDAN8:9;
              end;
              suppose that
A321:           i1 = i2 & j1 = j2+1 and
A322:           f/.(len(F.k)+1) = G*(i2-'1,j2);
                now
                  let i19,j19,i29,j29 be Element of NAT;
                  assume
A323:             [i19,j19] in Indices G & [i29,j29] in Indices G &
                  (F.k)/.len(F.k) = G* (i19,j19) & G*(i2-'1,j2) = G* (i29,j29);
                  then i2 = i19 & i2-'1 = i29 by A286,A287,A300,A321,
GOBOARD1:21;
                  then i19-i29 = i2-(i2-1) by A303,XREAL_1:235;
                  then
A324:             abs(i19-i29) = 1 by ABSVALUE:def 1;
                  j2 = j19 & j2 = j29 by A286,A287,A300,A321,A323,GOBOARD1:21;
                  then abs(j29-j19) = 0 by ABSVALUE:def 1;
                  hence abs(i29-i19)+abs(j29-j19) = 1 by A324,UNIFORM1:13;
                end;
                hence thesis by A235,A237,A279,A300,A306,A307,A321,A322,
CARD_1:47,JORDAN8:9;
              end;
            end;
          end;
          suppose
A325:       front_left_cell(F.k,(len(F.k))-'1,G) misses C &
            front_right_cell(F.k,(len(F.k))-'1,G) meets C;
            then consider i,j such that
A326:       (F.k)^<*G*(i,j)*> goes_straight (len(F.k))-'1,G and
A327:       F.(k+1) = (F.k)^<*G*(i,j)*> by A171,A235,A237,A279,A296;
            thus thesis
            proof
              set f = (F.k)^<*G*(i,j)*>;
A328:         f/.(len(F.k)+1) = G*(i,j) by FINSEQ_4:82;
A329:         f/.(len(F.k)-'1) = G*(i1,j1) & f/.len(F.k) = G*(i2,j2) by A285
,A287,A302,A280,FINSEQ_4:83;
              per cases by A281,A284,A286,A282,A326,A329,GOBRD13:def 8;
              suppose that
A330:           i1 = i2 & j1+1 = j2 and
A331:           f/.(len(F.k)+1) = G*(i2,j2+1);
                now
                  let i19,j19,i29,j29 be Element of NAT;
                  assume
A332:             [i19,j19] in Indices G & [i29,j29] in Indices G &
                  (F.k)/.len(F.k) = G* (i19,j19) & G*(i2,j2+1) = G*(i29,j29);
                  then i2 = i19 & i2 = i29 by A286,A287,A299,A325,A330,
GOBOARD1:21;
                  then
A333:             abs(i29-i19) = 0 by ABSVALUE:def 1;
                  j2 = j19 & j2+1 = j29 by A286,A287,A299,A325,A330,A332,
GOBOARD1:21;
                  hence abs(i29-i19)+abs(j29-j19) = 1 by A333,ABSVALUE:def 1;
                end;
                hence thesis by A235,A237,A279,A299,A325,A327,A328,A330,A331,
CARD_1:47,JORDAN8:9;
              end;
              suppose that
A334:           i1+1 = i2 & j1 = j2 and
A335:           f/.(len(F.k)+1) = G*(i2+1,j2);
                now
                  let i19,j19,i29,j29 be Element of NAT;
                  assume
A336:             [i19,j19] in Indices G & [i29,j29] in Indices G &
                  (F.k)/.len(F.k) = G* (i19,j19) & G*(i2+1,j2) = G* (i29,j29);
                  then j2 = j19 & j2 = j29 by A286,A287,A298,A325,A334,
GOBOARD1:21;
                  then
A337:             abs(j29-j19) = 0 by ABSVALUE:def 1;
                  i2 = i19 & i2+1 = i29 by A286,A287,A298,A325,A334,A336,
GOBOARD1:21;
                  hence abs(i29-i19)+abs(j29-j19) = 1 by A337,ABSVALUE:def 1;
                end;
                hence thesis by A235,A237,A279,A298,A325,A327,A328,A334,A335,
CARD_1:47,JORDAN8:9;
              end;
              suppose that
A338:           i1 = i2+1 & j1 = j2 and
A339:           f/.(len(F.k)+1) = G*(i2-'1,j2);
                now
                  let i19,j19,i29,j29 be Element of NAT;
                  assume
A340:             [i19,j19] in Indices G & [i29,j29] in Indices G &
                  (F.k)/.len(F.k) = G* (i19,j19) & G*(i2-'1,j2) = G*(i29,j29);
                  then i2 = i19 & i2-'1 = i29 by A286,A287,A297,A325,A338,
GOBOARD1:21;
                  then i19-i29 = i2-(i2-1) by A303,XREAL_1:235;
                  then
A341:             abs(i19-i29) = 1 by ABSVALUE:def 1;
                  j2 = j19 & j2 = j29 by A286,A287,A297,A325,A338,A340,
GOBOARD1:21;
                  then abs(j29-j19) = 0 by ABSVALUE:def 1;
                  hence abs(i29-i19)+abs(j29-j19) = 1 by A341,UNIFORM1:13;
                end;
                hence thesis by A235,A237,A279,A297,A325,A327,A328,A338,A339,
CARD_1:47,JORDAN8:9;
              end;
              suppose that
A342:           i1 = i2 & j1 = j2+1 and
A343:           f/.(len(F.k)+1) = G*(i2,j2-'1);
                now
                  let i19,j19,i29,j29 be Element of NAT;
                  assume
A344:             [i19,j19] in Indices G & [i29,j29] in Indices G &
                  (F.k)/.len(F.k) = G* (i19,j19) & G*(i2,j2-'1) = G* (i29,j29);
                  then j2 = j19 & j2-'1 = j29 by A286,A287,A292,A325,A342,
GOBOARD1:21;
                  then j19-j29 = j2-(j2-1) by A295,XREAL_1:235;
                  then
A345:             abs(j19-j29) = 1 by ABSVALUE:def 1;
                  i2 = i19 & i2 = i29 by A286,A287,A292,A325,A342,A344,
GOBOARD1:21;
                  then abs(i29-i19) = 0 by ABSVALUE:def 1;
                  hence abs(i29-i19)+abs(j29-j19) = 1 by A345,UNIFORM1:13;
                end;
                hence thesis by A235,A237,A279,A292,A325,A327,A328,A342,A343,
CARD_1:47,JORDAN8:9;
              end;
            end;
          end;
          suppose
A346:       front_left_cell(F.k,(len(F.k))-'1,G) meets C;
            then consider i,j such that
A347:       (F.k)^<*G*(i,j)*> turns_left (len(F.k))-'1,G and
A348:       F.(k+1) = (F.k)^<*G*(i,j)*> by A171,A235,A237,A279,A296;
            thus thesis
            proof
              set f = (F.k)^<*G*(i,j)*>;
A349:         f/.(len(F.k)+1) = G*(i,j) by FINSEQ_4:82;
A350:         f/.(len(F.k)-'1) = G*(i1,j1) & f/.len(F.k) = G*(i2,j2) by A285
,A287,A302,A280,FINSEQ_4:83;
              per cases by A281,A284,A286,A282,A347,A350,GOBRD13:def 7;
              suppose that
A351:           i1 = i2 & j1+1 = j2 and
A352:           f/.(len(F.k)+1) = G*(i2-'1,j2);
                now
                  let i19,j19,i29,j29 be Element of NAT;
                  assume
A353:             [i19,j19] in Indices G & [i29,j29] in Indices G &
                  (F.k)/.len(F.k) = G* (i19,j19) & G*(i2-'1,j2) = G*(i29,j29);
                  then i2 = i19 & i2-'1 = i29 by A286,A287,A291,A346,A351,
GOBOARD1:21;
                  then i19-i29 = i2-(i2-1) by A303,XREAL_1:235;
                  then
A354:             abs(i19-i29) = 1 by ABSVALUE:def 1;
                  j2 = j19 & j2 = j29 by A286,A287,A291,A346,A351,A353,
GOBOARD1:21;
                  then abs(j29-j19) = 0 by ABSVALUE:def 1;
                  hence abs(i29-i19)+abs(j29-j19) = 1 by A354,UNIFORM1:13;
                end;
                hence thesis by A235,A237,A279,A291,A346,A348,A349,A351,A352,
CARD_1:47,JORDAN8:9;
              end;
              suppose that
A355:           i1+1 = i2 & j1 = j2 and
A356:           f/.(len(F.k)+1) = G*(i2,j2+1);
                now
                  let i19,j19,i29,j29 be Element of NAT;
                  assume
A357:             [i19,j19] in Indices G & [i29,j29] in Indices G &
                  (F.k)/.len(F.k) = G* (i19,j19) & G*(i2,j2+1) = G* (i29,j29);
                  then i2 = i19 & i2 = i29 by A286,A287,A290,A346,A355,
GOBOARD1:21;
                  then
A358:             abs(i29-i19) = 0 by ABSVALUE:def 1;
                  j2 = j19 & j2+1 = j29 by A286,A287,A290,A346,A355,A357,
GOBOARD1:21;
                  hence abs(i29-i19)+abs(j29-j19) = 1 by A358,ABSVALUE:def 1;
                end;
                hence thesis by A235,A237,A279,A290,A346,A348,A349,A355,A356,
CARD_1:47,JORDAN8:9;
              end;
              suppose that
A359:           i1 = i2+1 & j1 = j2 and
A360:           f/.(len(F.k)+1) = G*(i2,j2-'1);
                now
                  let i19,j19,i29,j29 be Element of NAT;
                  assume
A361:             [i19,j19] in Indices G & [i29,j29] in Indices G &
                  (F.k)/.len(F.k) = G* (i19,j19) & G*(i2,j2-'1) = G*(i29,j29);
                  then j2 = j19 & j2-'1 = j29 by A286,A287,A289,A346,A359,
GOBOARD1:21;
                  then j19-j29 = j2-(j2-1) by A295,XREAL_1:235;
                  then
A362:             abs(j19-j29) = 1 by ABSVALUE:def 1;
                  i2 = i19 & i2 = i29 by A286,A287,A289,A346,A359,A361,
GOBOARD1:21;
                  then abs(i29-i19) = 0 by ABSVALUE:def 1;
                  hence abs(i29-i19)+abs(j29-j19) = 1 by A362,UNIFORM1:13;
                end;
                hence thesis by A235,A237,A279,A289,A346,A348,A349,A359,A360,
CARD_1:47,JORDAN8:9;
              end;
              suppose that
A363:           i1 = i2 & j1 = j2+1 and
A364:           f/.(len(F.k)+1) = G*(i2+1,j2);
                now
                  let i19,j19,i29,j29 be Element of NAT;
                  assume
A365:             [i19,j19] in Indices G & [i29,j29] in Indices G &
                  (F.k)/.len(F.k) = G* (i19,j19) & G*(i2+1,j2) = G* (i29,j29);
                  then j2 = j19 & j2 = j29 by A286,A287,A301,A346,A363,
GOBOARD1:21;
                  then
A366:             abs(j29-j19) = 0 by ABSVALUE:def 1;
                  i2 = i19 & i2+1 = i29 by A286,A287,A301,A346,A363,A365,
GOBOARD1:21;
                  hence abs(i29-i19)+abs(j29-j19) = 1 by A366,ABSVALUE:def 1;
                end;
                hence thesis by A235,A237,A279,A301,A346,A348,A349,A363,A364,
CARD_1:47,JORDAN8:9;
              end;
            end;
          end;
        end;
        let m such that
A367:   1 <= m and
A368:   m+1 <= len(F.(k+1));
A369:   left_cell(F.k,(len(F.k))-'1,G) misses C by A236,A283,A281;
        now
          per cases;
          suppose
A370:       m+1 = len(F.(k+1));
A371:       (j2-'1)+1 = j2 by A295,XREAL_1:237;
A372:       (i2-'1)+1 = i2 by A303,XREAL_1:237;
            thus thesis
            proof
              per cases;
              suppose
A373:           front_left_cell(F.k,(len(F.k))-'1,G) misses C &
                front_right_cell(F.k,(len(F.k))-'1,G) misses C;
                then
A374:           ex i,j st (F.k)^<*G*(i,j)*> turns_right (len(F.k))-'1,G &
                F.(k+1) = (F.k)^<*G*(i,j)*> by A171,A235,A237,A279,A296;
                then
A375:           (F.(k+1))/.len(F.k) = G* (i2,j2) by A287,A280,FINSEQ_4:83;
A376:           (F.(k+1))/.(len(F.k)-'1) = G*(i1,j1) by A285,A302,A374,
FINSEQ_4:83;
                now
                  per cases by A281,A284,A286,A282,A374,A376,A375,GOBRD13:def 6
;
                  suppose that
A377:               i1 = i2 & j1+1 = j2 and
A378:               (F.(k+1))/.((len(F.k))+1) = G*(i2+1,j2);
                    front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i1,j2
                    ) by A235,A283,A281,A284,A285,A286,A287,A377,GOBRD13:36;
                    hence left_cell(F.(k+1),m,G) misses C by A237,A238,A286
,A288,A304,A367,A370,A373,A375,A377,A378,GOBRD13:24;
                    j2-'1 = j1 & cell(G,i1,j1) meets C by A235,A283,A281,A284
,A285,A286,A287,A296,A377,GOBRD13:23,NAT_D:34;
                    hence right_cell(F.(k+1),m,G) meets C by A237,A238,A286
,A288,A304,A367,A370,A375,A377,A378,GOBRD13:25;
                  end;
                  suppose that
A379:               i1+1 = i2 & j1 = j2 and
A380:               (F.(k+1))/.((len(F.k))+1) = G*(i2,j2-'1);
                    front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i2,j2
                    -'1) by A235,A283,A281,A284,A285,A286,A287,A379,GOBRD13:38;
                    hence left_cell(F.(k+1),m,G) misses C by A237,A238,A286
,A294,A304,A367,A370,A371,A373,A375,A379,A380,GOBRD13:28;
                    i2-'1 = i1 & cell(G,i1,j1-'1) meets C by A235,A283,A281
,A284,A285,A286,A287,A296,A379,GOBRD13:25,NAT_D:34;
                    hence right_cell(F.(k+1),m,G) meets C by A237,A238,A286
,A294,A304,A367,A370,A371,A375,A379,A380,GOBRD13:29;
                  end;
                  suppose that
A381:               i1 = i2+1 & j1 = j2 and
A382:               (F.(k+1))/.((len(F.k))+1) = G*(i2,j2+1);
                    front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i2-'1
                    ,j2) by A235,A283,A281,A284,A285,A286,A287,A381,GOBRD13:40;
                    hence left_cell(F.(k+1),m,G) misses C by A237,A238,A286
,A293,A304,A367,A370,A373,A375,A381,A382,GOBRD13:22;
                    cell(G,i2,j2) meets C by A235,A283,A281,A284,A285,A286,A287
,A296,A381,GOBRD13:27;
                    hence right_cell(F.(k+1),m,G) meets C by A237,A238,A286
,A293,A304,A367,A370,A375,A381,A382,GOBRD13:23;
                  end;
                  suppose that
A383:               i1 = i2 & j1 = j2+1 and
A384:               (F.(k+1))/.((len(F.k))+1) = G*(i2-'1,j2);
                    front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i2-'1
,j2-'1 ) by A235,A283,A281,A284,A285,A286,A287,A383,GOBRD13:42;
                    hence left_cell(F.(k+1),m,G) misses C by A237,A238,A286
,A300,A304,A367,A370,A372,A373,A375,A383,A384,GOBRD13:26;
                    cell(G,i2-'1,j2) meets C by A235,A283,A281,A284,A285,A286
,A287,A296,A383,GOBRD13:29;
                    hence right_cell(F.(k+1),m,G) meets C by A237,A238,A286
,A300,A304,A367,A370,A372,A375,A383,A384,GOBRD13:27;
                  end;
                end;
                hence thesis;
              end;
              suppose
A385:           front_left_cell(F.k,(len(F.k))-'1,G) misses C &
                front_right_cell(F.k,(len(F.k))-'1,G) meets C;
                then
A386:           ex i,j st (F.k)^<*G*(i,j)*> goes_straight (len(F.k))-'1,G
                & F.(k+1) = (F.k)^<*G*(i,j)*> by A171,A235,A237,A279,A296;
                then
A387:           (F.(k+1))/.len(F.k) = G*(i2,j2) by A287,A280,FINSEQ_4:83;
A388:           (F.(k+1))/.(len(F.k)-'1) = G*(i1,j1) by A285,A302,A386,
FINSEQ_4:83;
                now
                  per cases by A281,A284,A286,A282,A386,A388,A387,GOBRD13:def 8
;
                  suppose that
A389:               i1 = i2 & j1+1 = j2 and
A390:               (F.(k+1))/.(len(F.k)+1) = G*(i2,j2+1);
                    front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i1-'1,
                    j2) by A235,A283,A281,A284,A285,A286,A287,A389,GOBRD13:35;
                    hence left_cell(F.(k+1),m,G) misses C by A237,A238,A286
,A299,A304,A367,A370,A385,A387,A389,A390,GOBRD13:22;
                    front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i1,j2
                    ) by A235,A283,A281,A284,A285,A286,A287,A389,GOBRD13:36;
                    hence right_cell(F.(k+1),m,G) meets C by A237,A238,A286
,A299,A304,A367,A370,A385,A387,A389,A390,GOBRD13:23;
                  end;
                  suppose that
A391:               i1+1 = i2 & j1 = j2 and
A392:               (F.(k+1))/.(len(F.k)+1) = G*(i2+1,j2);
                    front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i2,j2)
                    by A235,A283,A281,A284,A285,A286,A287,A391,GOBRD13:37;
                    hence left_cell(F.(k+1),m,G) misses C by A237,A238,A286
,A298,A304,A367,A370,A385,A387,A391,A392,GOBRD13:24;
                    front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i2,j2
                    -'1) by A235,A283,A281,A284,A285,A286,A287,A391,GOBRD13:38;
                    hence right_cell(F.(k+1),m,G) meets C by A237,A238,A286
,A298,A304,A367,A370,A385,A387,A391,A392,GOBRD13:25;
                  end;
                  suppose that
A393:               i1 = i2+1 & j1 = j2 and
A394:               (F.(k+1))/.(len(F.k)+1) = G*(i2-'1,j2);
                    front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i2-'1,
j2-'1) by A235,A283,A281,A284,A285,A286,A287,A393,GOBRD13:39;
                    hence left_cell(F.(k+1),m,G) misses C by A237,A238,A286
,A297,A304,A367,A370,A372,A385,A387,A393,A394,GOBRD13:26;
                    front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i2-'1
                    ,j2) by A235,A283,A281,A284,A285,A286,A287,A393,GOBRD13:40;
                    hence right_cell(F.(k+1),m,G) meets C by A237,A238,A286
,A297,A304,A367,A370,A372,A385,A387,A393,A394,GOBRD13:27;
                  end;
                  suppose that
A395:               i1 = i2 & j1 = j2+1 and
A396:               (F.(k+1))/.(len(F.k)+1) = G*(i2,j2-'1);
                    front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i2,j2
                    -'1) by A235,A283,A281,A284,A285,A286,A287,A395,GOBRD13:41;
                    hence left_cell(F.(k+1),m,G) misses C by A237,A238,A286
,A292,A304,A367,A370,A371,A385,A387,A395,A396,GOBRD13:28;
                    front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i2-'1
,j2-'1 ) by A235,A283,A281,A284,A285,A286,A287,A395,GOBRD13:42;
                    hence right_cell(F.(k+1),m,G) meets C by A237,A238,A286
,A292,A304,A367,A370,A371,A385,A387,A395,A396,GOBRD13:29;
                  end;
                end;
                hence thesis;
              end;
              suppose
A397:           front_left_cell(F.k,(len(F.k))-'1,G) meets C;
                then
A398:           ex i,j st (F.k)^<*G*(i,j)*> turns_left (len(F.k))-'1,G &
                F.(k+1) = (F.k)^<*G*(i,j)*> by A171,A235,A237,A279,A296;
                then
A399:           (F.(k+1))/.len(F.k) = G* (i2,j2) by A287,A280,FINSEQ_4:83;
A400:           (F.(k+1))/.(len(F.k)-'1) = G*(i1,j1) by A285,A302,A398,
FINSEQ_4:83;
                now
                  per cases by A281,A284,A286,A282,A398,A400,A399,GOBRD13:def 7
;
                  suppose that
A401:               i1 = i2 & j1+1 = j2 and
A402:               (F.(k+1))/.(len(F.k)+1) = G*(i2-'1,j2);
                    j2-'1 = j1 & cell(G,i1-'1,j1) misses C by A235,A283,A281
,A284,A285,A286,A287,A369,A401,GOBRD13:22,NAT_D:34;
                    hence left_cell(F.(k+1),m,G) misses C by A237,A238,A286
,A291,A304,A367,A370,A372,A397,A399,A401,A402,GOBRD13:26;
                    front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i1-'1,
                    j2) by A235,A283,A281,A284,A285,A286,A287,A401,GOBRD13:35;
                    hence right_cell(F.(k+1),m,G) meets C by A237,A238,A286
,A291,A304,A367,A370,A372,A397,A399,A401,A402,GOBRD13:27;
                  end;
                  suppose that
A403:               i1+1 = i2 & j1 = j2 and
A404:               (F.(k+1))/.(len(F.k)+1) = G*(i2,j2+1);
                    i2-'1 = i1 & cell(G,i1,j1) misses C by A235,A283,A281,A284
,A285,A286,A287,A369,A403,GOBRD13:24,NAT_D:34;
                    hence left_cell(F.(k+1),m,G) misses C by A237,A238,A286
,A290,A304,A367,A370,A397,A399,A403,A404,GOBRD13:22;
                    front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i2,j2)
                    by A235,A283,A281,A284,A285,A286,A287,A403,GOBRD13:37;
                    hence right_cell(F.(k+1),m,G) meets C by A237,A238,A286
,A290,A304,A367,A370,A397,A399,A403,A404,GOBRD13:23;
                  end;
                  suppose that
A405:               i1 = i2+1 & j1 = j2 and
A406:               (F.(k+1))/.(len(F.k)+1) = G*(i2,j2-'1);
                    cell(G,i2,j2-'1) misses C by A235,A283,A281,A284,A285,A286
,A287,A369,A405,GOBRD13:26;
                    hence left_cell(F.(k+1),m,G) misses C by A237,A238,A286
,A289,A304,A367,A370,A371,A397,A399,A405,A406,GOBRD13:28;
                    front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i2-'1,
j2-'1) by A235,A283,A281,A284,A285,A286,A287,A405,GOBRD13:39;
                    hence right_cell(F.(k+1),m,G) meets C by A237,A238,A286
,A289,A304,A367,A370,A371,A397,A399,A405,A406,GOBRD13:29;
                  end;
                  suppose that
A407:               i1 = i2 & j1 = j2+1 and
A408:               (F.(k+1))/.(len(F.k)+1) = G*(i2+1,j2);
                    cell(G,i2,j2) misses C by A235,A283,A281,A284,A285,A286
,A287,A369,A407,GOBRD13:28;
                    hence left_cell(F.(k+1),m,G) misses C by A237,A238,A286
,A301,A304,A367,A370,A397,A399,A407,A408,GOBRD13:24;
                    front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i2,j2
                    -'1) by A235,A283,A281,A284,A285,A286,A287,A407,GOBRD13:41;
                    hence right_cell(F.(k+1),m,G) meets C by A237,A238,A286
,A301,A304,A367,A370,A397,A399,A407,A408,GOBRD13:25;
                  end;
                end;
                hence thesis;
              end;
            end;
          end;
          suppose
            m+1 <> len(F.(k+1));
            then m+1 < len(F.(k+1)) by A368,XXREAL_0:1;
            then
A409:       m+1 <= len(F.k)by A237,A238,NAT_1:13;
            then consider i1,j1,i2,j2 being Element of NAT such that
A410:       [i1,j1] in Indices G and
A411:       (F.k)/.m = G*(i1,j1) and
A412:       [i2,j2] in Indices G and
A413:       (F.k)/.(m+1) = G*(i2,j2) and
A414:       i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or i1 = i2+1
            & j1 = j2 or i1 = i2 & j1 = j2+1 by A235,A367,JORDAN8:6;
A415:       left_cell(F.k,m,G) misses C & right_cell(F.k,m,G) meets C by A236
,A367,A409;
A416:       now
              per cases;
              suppose
                front_left_cell(F.k,(len(F.k))-'1,G) misses C &
                front_right_cell(F.k,(len(F.k))-'1,G) misses C;
                then consider i,j such that
                (F.k)^<*G*(i,j)*> turns_right (len(F.k))-'1,G and
A417:           F.(k+1) = (F.k)^<*G*(i,j)*> by A171,A235,A237,A279,A296;
                take i,j;
                thus F.(k+1) = (F.k)^<*G*(i,j)*> by A417;
              end;
              suppose
                front_left_cell(F.k,(len(F.k))-'1,G) misses C &
                front_right_cell(F.k,(len(F.k))-'1,G) meets C;
                then consider i,j such that
                (F.k)^<*G*(i,j)*> goes_straight (len(F.k))-'1,G and
A418:           F.(k+1) = (F.k)^<*G*(i,j)*> by A171,A235,A237,A279,A296;
                take i,j;
                thus F.(k+1) = (F.k)^<*G*(i,j)*> by A418;
              end;
              suppose
                front_left_cell(F.k,(len(F.k))-'1,G) meets C;
                then consider i,j such that
                (F.k)^<*G*(i,j)*> turns_left (len(F.k))-'1,G and
A419:           F.(k+1) = (F.k)^<*G*(i,j)*> by A171,A235,A237,A279,A296;
                take i,j;
                thus F.(k+1) = (F.k)^<*G*(i,j)*> by A419;
              end;
            end;
            1 <= m+1 by NAT_1:12;
            then m+1 in dom(F.k) by A409,FINSEQ_3:27;
            then
A420:       (F.(k+1))/.(m+1) = G*(i2,j2) by A413,A416,FINSEQ_4:83;
            m <= len(F.k) by A409,NAT_1:13;
            then m in dom(F.k) by A367,FINSEQ_3:27;
            then
A421:       (F.(k+1))/.m = G*(i1,j1) by A411,A416,FINSEQ_4:83;
            now
              per cases by A414;
              suppose
A422:           i1 = i2 & j1+1 = j2;
                then left_cell(F.k,m,G) = cell(G,i1-'1,j1) & right_cell(F.k,m
,G) = cell(G,i1,j1) by A235,A367,A409,A410,A411,A412,A413,GOBRD13:22,23;
                hence thesis by A304,A367,A368,A410,A412,A415,A421,A420,A422,
GOBRD13:22,23;
              end;
              suppose
A423:           i1+1 = i2 & j1 = j2;
                then left_cell(F.k,m,G) = cell(G,i1,j1) & right_cell(F.k,m,G)
= cell(G,i1,j1-'1) by A235,A367,A409,A410,A411,A412,A413,GOBRD13:24,25;
                hence thesis by A304,A367,A368,A410,A412,A415,A421,A420,A423,
GOBRD13:24,25;
              end;
              suppose
A424:           i1 = i2+1 & j1 = j2;
                then left_cell(F.k,m,G) = cell(G,i2,j2-'1) & right_cell(F.k,m
,G) = cell(G,i2,j2) by A235,A367,A409,A410,A411,A412,A413,GOBRD13:26,27;
                hence thesis by A304,A367,A368,A410,A412,A415,A421,A420,A424,
GOBRD13:26,27;
              end;
              suppose
A425:           i1 = i2 & j1 = j2+1;
                then left_cell(F.k,m,G) = cell(G,i2,j2) & right_cell(F.k,m,G)
= cell(G,i1-'1,j2) by A235,A367,A409,A410,A411,A412,A413,GOBRD13:28,29;
                hence thesis by A304,A367,A368,A410,A412,A415,A421,A420,A425,
GOBRD13:28,29;
              end;
            end;
            hence thesis;
          end;
        end;
        hence thesis;
      end;
    end;
    defpred Q[Nat] means ex w being Element of NAT st w = $1 & $1 >= 1 & ex m
    st m in dom(F.w) & m <> len(F.w) & (F.w)/.m = (F.w)/.len(F.w);
A426: P[0]
    proof
      ( for n st n in dom(F.0) ex i,j st [i,j] in Indices G & (F.0)/.n =
G*(i,j))& for n st n in dom(F.0) & n+1 in dom(F.0) holds for m,k,i,j st [m,k]
in Indices G & [i,j] in Indices G & (F.0)/.n = G*(m,k) & (F.0)/.(n+1) = G*(i,j)
      holds abs( m-i)+abs(k-j) = 1 by A170;
      hence F.0 is_sequence_on G by GOBOARD1:def 11;
      let m;
      assume that
      1 <= m and
A427: m+1 <= len(F.0);
      thus thesis by A170,A427,CARD_1:47;
    end;
A428: for k holds P[k] from NAT_1:sch 1(A426,A232);
A429: for k,i1,i2,j1,j2 st k > 1 & [i1,j1] in Indices G & (F.k)/.((len(F.k
)) -'1) = G*(i1,j1) & [i2,j2] in Indices G & (F.k)/.len(F.k) = G*(i2,j2) holds
(front_left_cell(F.k,(len(F.k))-'1,G) misses C & front_right_cell(F.k,(len(F.k)
)-'1,G) misses C implies F.(k+1) turns_right (len(F.k))-'1,G & (i1 = i2 & j1+1
= j2 implies [i2+1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2+1,j2)*>) & (i1+1
= i2 & j1 = j2 implies [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2-'1)
*>) & (i1 = i2+1 & j1 = j2 implies [i2,j2+1] in Indices G & F.(k+1) = (F.k)^<*G
*(i2,j2+1)*>)& (i1 = i2 & j1 = j2+1 implies [i2-'1,j2] in Indices G & F.(k+1) =
    (F.k)^<*G*(i2-'1,j2)*>)) & (front_left_cell(F.k,(len(F.k))-'1,G) misses C &
front_right_cell(F.k,(len(F.k))-'1,G) meets C implies F.(k+1) goes_straight (
len(F.k))-'1,G & (i1 = i2 & j1+1 = j2 implies [i2,j2+1] in Indices G & F.(k+1)
= (F.k)^<*G*(i2,j2+1)*>) & (i1+1 = i2 & j1 = j2 implies [i2+1,j2] in Indices G
& F.(k+1) = (F.k)^<*G*(i2+1,j2)*>) & (i1 = i2+1 & j1 = j2 implies [i2-'1,j2] in
Indices G & F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>)& (i1 = i2 & j1 = j2+1 implies [i2
,j2-'1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>)) & (front_left_cell(F.
k,(len(F.k))-'1,G) meets C implies F.(k+1) turns_left (len(F.k))-'1,G & (i1 =
i2 & j1+1 = j2 implies [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2-'1,j2)
*>) & (i1+1 = i2 & j1 = j2 implies [i2,j2+1] in Indices G & F.(k+1) = (F.k)^<*G
*(i2,j2+1)*>) & (i1 = i2+1 & j1 = j2 implies [i2,j2-'1] in Indices G & F.(k+1)
= (F.k)^<*G*(i2,j2-'1)*>)& (i1 = i2 & j1 = j2+1 implies [i2+1,j2] in Indices G
    & F.(k+1) = (F.k)^<*G*(i2+1,j2)*>))
    proof
      let k,i1,i2,j1,j2 such that
A430: k > 1 and
A431: [i1,j1] in Indices G and
A432: (F.k)/.((len(F.k)) -'1) = G*(i1,j1) and
A433: [i2,j2] in Indices G and
A434: (F.k)/.len(F.k) = G*(i2,j2);
A435: len(F.k) = k by A192;
      then
A436: (len(F.k)) -'1 +1 = len(F.k) by A430,XREAL_1:237;
      then
A437: (len(F.k))-'1+(1+1) = (len(F.k))+1;
A438: 1 <= (len(F.k))-'1 by A430,A435,NAT_D:49;
      then
A439: right_cell(F.k,(len(F.k))-'1,G) meets C by A428,A436;
      (len(F.k))-'1 <= len(F.k) by NAT_D:35;
      then
A440: (len(F.k))-'1 in dom(F.k) by A438,FINSEQ_3:27;
A441: j1+1 > j1 & j2+1 > j2 by NAT_1:13;
A442: F.k is_sequence_on G by A428;
A443: i1+1 > i1 & i2+1 > i2 by NAT_1:13;
A444: len(F.k) in dom(F.k) by A430,A435,FINSEQ_3:27;
      hereby
        assume
        front_left_cell(F.k,(len(F.k))-'1,G) misses C &
        front_right_cell(F.k,(len(F. k))-'1,G) misses C;
        then consider i,j such that
A445:   (F.k)^<*G*(i,j)*> turns_right (len(F.k))-'1,G and
A446:   F.(k+1) = (F.k)^<*G*(i,j)*> by A171,A430,A442,A435,A439;
        thus F.(k+1) turns_right (len(F.k))-'1,G by A445,A446;
A447:   (F.(k+1))/.(len(F.k)+1) = G*(i,j) by A446,FINSEQ_4:82;
A448:   (F.(k+1))/.(len(F.k)-'1) = G*(i1,j1) & (F.(k+1))/.len(F.k) = G*
        (i2,j2) by A432,A434,A440,A444,A446,FINSEQ_4:83;
        hence
        i1 = i2 & j1+1 = j2 implies [i2+1,j2] in Indices G & F.(k+1) = (F
.k)^<*G*(i2+1,j2)*> by A431,A433,A436,A437,A441,A445,A446,A447,GOBRD13:def 6;
        thus i1+1 = i2 & j1 = j2 implies [i2,j2-'1] in Indices G & F.(k+1) = (
F.k)^<*G*(i2,j2-'1)*> by A431,A433,A436,A437,A443,A445,A446,A448,A447,
GOBRD13:def 6;
        thus i1 = i2+1 & j1 = j2 implies [i2,j2+1] in Indices G & F.(k+1) = (F
.k)^<*G*(i2,j2+1)*> by A431,A433,A436,A437,A443,A445,A446,A448,A447,
GOBRD13:def 6;
        thus i1 = i2 & j1 = j2+1 implies [i2-'1,j2] in Indices G & F.(k+1) = (
F.k)^<*G*(i2-'1,j2)*> by A431,A433,A436,A437,A441,A445,A446,A448,A447,
GOBRD13:def 6;
      end;
      hereby
        assume
        front_left_cell(F.k,(len(F.k))-'1,G) misses C &
        front_right_cell(F.k,(len(F. k))-'1,G) meets C;
        then consider i,j such that
A449:   (F.k)^<*G*(i,j)*> goes_straight (len(F.k))-'1,G and
A450:   F.(k+1) = (F.k)^<*G*(i,j)*> by A171,A430,A442,A435,A439;
        thus F.(k+1) goes_straight (len(F.k))-'1,G by A449,A450;
A451:   (F.(k+1))/.(len(F.k)+1) = G*(i,j) by A450,FINSEQ_4:82;
A452:   (F.(k+1))/.(len(F.k)-'1) = G*(i1,j1) & (F.(k+1))/.len(F.k) = G*
        (i2,j2) by A432,A434,A440,A444,A450,FINSEQ_4:83;
        hence
        i1 = i2 & j1+1 = j2 implies [i2,j2+1] in Indices G & F.(k+1) = (F
.k)^<*G*(i2,j2+1)*> by A431,A433,A436,A437,A441,A449,A450,A451,GOBRD13:def 8;
        thus i1+1 = i2 & j1 = j2 implies [i2+1,j2] in Indices G & F.(k+1) = (F
.k)^<*G*(i2+1,j2)*> by A431,A433,A436,A437,A443,A449,A450,A452,A451,
GOBRD13:def 8;
        thus i1 = i2+1 & j1 = j2 implies [i2-'1,j2] in Indices G & F.(k+1) = (
F.k)^<*G*(i2-'1,j2)*> by A431,A433,A436,A437,A443,A449,A450,A452,A451,
GOBRD13:def 8;
        thus i1 = i2 & j1 = j2+1 implies [i2,j2-'1] in Indices G & F.(k+1) = (
F.k)^<*G*(i2,j2-'1)*> by A431,A433,A436,A437,A441,A449,A450,A452,A451,
GOBRD13:def 8;
      end;
      assume
      front_left_cell(F.k,(len(F.k))-'1,G) meets C;
      then consider i,j such that
A453: (F.k)^<*G*(i,j)*> turns_left (len(F.k))-'1,G and
A454: F.(k+1) = (F.k)^<*G*(i,j)*> by A171,A430,A442,A435,A439;
A455: (F.(k+1))/.len(F.k) = G* (i2,j2) by A434,A444,A454,FINSEQ_4:83;
      thus F.(k+1) turns_left (len(F.k))-'1,G by A453,A454;
A456: (F.(k+1))/.(len(F.k)+1) = G*(i,j) by A454,FINSEQ_4:82;
A457: (F.(k+1))/.(len(F.k)-'1) = G*(i1,j1) by A432,A440,A454,FINSEQ_4:83;
      hence
      i1 = i2 & j1+1 = j2 implies [i2-'1,j2] in Indices G & F.(k+1) = (F.
      k)^<*G*(i2-'1,j2)*> by A431,A433,A436,A437,A441,A453,A454,A455,A456,
GOBRD13:def 7;
      thus i1+1 = i2 & j1 = j2 implies [i2,j2+1] in Indices G & F.(k+1) = (F.k
)^<*G*(i2,j2+1)*> by A431,A433,A436,A437,A443,A453,A454,A457,A455,A456,
GOBRD13:def 7;
      thus i1 = i2+1 & j1 = j2 implies [i2,j2-'1] in Indices G & F.(k+1) = (F.
      k)^<*G*(i2,j2-'1)*> by A431,A433,A436,A437,A443,A453,A454,A457,A455,A456,
GOBRD13:def 7;
      thus thesis by A431,A433,A436,A437,A441,A453,A454,A457,A455,A456,
GOBRD13:def 7;
    end;
A458: for k st k > 1 holds (front_left_cell(F.k,k-'1,Gauge(C,n)) misses C
& front_right_cell(F.k,k-'1,Gauge(C,n)) misses C implies F.(k+1) turns_right k
    -'1,Gauge(C,n)) & (front_left_cell(F.k,k-'1,Gauge(C,n)) misses C &
front_right_cell(F.k,k-'1,Gauge(C,n)) meets C implies F.(k+1) goes_straight k-'
1,Gauge(C,n)) & (front_left_cell(F.k,k-'1,Gauge(C,n)) meets C implies F.(k+1)
    turns_left k-'1,Gauge(C,n))
    proof
      let k such that
A459: k > 1;
A460: F.k is_sequence_on G by A428;
A461: len(F.k) = k by A192;
      then 1 <= (len(F.k))-'1 & (len(F.k)) -'1 +1 = len(F.k) by A459,NAT_D:49
,XREAL_1:237;
      then ex i1,j1,i2,j2 being Element of NAT st [i1,j1] in Indices G & (F.k
)/.((len(F.k)) -'1) = G*(i1,j1) & [i2,j2] in Indices G & (F.k)/.len(F.k) = G*(
i2,j2) & (i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or i1 = i2+1 & j1 = j2 or
      i1 = i2 & j1 = j2+1) by A460,JORDAN8:6;
      hence thesis by A429,A459,A461;
    end;
    defpred P[Element of NAT] means for m st m <= $1 holds (F.$1)|m = F.m;
A462: P[0]
    proof
      let m;
      assume
A463: m <= 0;
      then (F.0)|0 = (F.0)|m;
      hence thesis by A170,A463;
    end;
A464: for k holds ex i,j st [i,j] in Indices G & F.(k+1) = (F.k)^<*G*(i,j)
    *>
    proof
      let k;
A465: F.k is_sequence_on G by A428;
A466: len(F.k) = k by A192;
      len G >= 4 by JORDAN8:13;
      then
A467: len G = width G & 1 < len G by JORDAN8:def 1,XXREAL_0:2;
      per cases by XXREAL_0:1;
      suppose
A468:   k < 1;
        consider i such that
A469:   1 <= i and
A470:   i+1 <= len G and
        N-min C in cell(G,i,width G-'1) and
        N-min C <> G*(i,width G-'1) and
A471:   F.(0+1) = <*G*(i,width G)*> by A171;
        take i, j = width G;
        i < len G by A470,NAT_1:13;
        hence [i,j] in Indices G by A467,A469,MATRIX_1:37;
        k = 0 by A468,NAT_1:14;
        hence thesis by A170,A471,FINSEQ_1:47;
      end;
      suppose
A472:   k = 1;
        consider i such that
A473:   1 <= i and
A474:   i+1 <= len G and
A475:   N-min C in cell(G,i,width G-'1) & N-min C <> G*(i,width G-'1
        ) and
A476:   F.(0+1) = <*G*(i,width G)*> by A171;
        take i+1,j = width G;
        1 <= i+1 by A473,NAT_1:13;
        hence [i+1,j] in Indices G by A467,A474,MATRIX_1:37;
        consider i9 being Element of NAT such that
A477:   1 <= i9 & i9+1 <= len G & N-min C in cell(G,i9,width G-'1) &
        N-min C <> G*(i9,width G-'1) and
A478:   F.(1+1) = <*G*(i9,width G),G*(i9+1,width G)*> by A171;
        i = i9 by A473,A474,A475,A477,Th31;
        hence thesis by A472,A476,A478,FINSEQ_1:def 9;
      end;
      suppose
A479:   k > 1;
        then 1 <= (len(F.k))-'1 & (len(F.k)) -'1 +1 = len(F.k) by A466,NAT_D:49
,XREAL_1:237;
        then consider i1,j1,i2,j2 being Element of NAT such that
A480:   [i1,j1] in Indices G & (F.k)/.((len(F.k)) -'1) = G*(i1,j1) &
        [i2,j2] in Indices G & (F.k)/.len(F.k) = G*(i2,j2) and
A481:   i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or i1 = i2+1 & j1
        = j2 or i1 = i2 & j1 = j2+1 by A465,JORDAN8:6;
        now
          per cases;
          suppose
A482:       front_left_cell(F.k,(len(F.k))-'1,G) misses C &
            front_right_cell(F.k,(len(F.k))-'1,G) misses C;
            now
              per cases by A481;
              suppose
                i1 = i2 & j1+1 = j2;
                then [i2+1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2+1,j2)*>
                by A429,A479,A480,A482;
                hence thesis;
              end;
              suppose
                i1+1 = i2 & j1 = j2;
                then [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2-'1)
                *> by A429,A479,A480,A482;
                hence thesis;
              end;
              suppose
                i1 = i2+1 & j1 = j2;
                then [i2,j2+1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2+1)*>
                by A429,A479,A480,A482;
                hence thesis;
              end;
              suppose
                i1 = i2 & j1 = j2+1;
                then [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2-'1,j2)
                *> by A429,A479,A480,A482;
                hence thesis;
              end;
            end;
            hence thesis;
          end;
          suppose
A483:       front_left_cell(F.k,(len(F.k))-'1,G) misses C &
            front_right_cell(F.k,(len(F.k))-'1,G) meets C;
            now
              per cases by A481;
              suppose
                i1 = i2 & j1+1 = j2;
                then [i2,j2+1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2+1)*>
                by A429,A479,A480,A483;
                hence thesis;
              end;
              suppose
                i1+1 = i2 & j1 = j2;
                then [i2+1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2+1,j2)*>
                by A429,A479,A480,A483;
                hence thesis;
              end;
              suppose
                i1 = i2+1 & j1 = j2;
                then [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2-'1,j2)
                *> by A429,A479,A480,A483;
                hence thesis;
              end;
              suppose
                i1 = i2 & j1 = j2+1;
                then [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2-'1)
                *> by A429,A479,A480,A483;
                hence thesis;
              end;
            end;
            hence thesis;
          end;
          suppose
A484:       front_left_cell(F.k,(len(F.k))-'1,G) meets C;
            now
              per cases by A481;
              suppose
                i1 = i2 & j1+1 = j2;
                then [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2-'1,j2)
                *> by A429,A479,A480,A484;
                hence thesis;
              end;
              suppose
                i1+1 = i2 & j1 = j2;
                then [i2,j2+1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2+1)*>
                by A429,A479,A480,A484;
                hence thesis;
              end;
              suppose
                i1 = i2+1 & j1 = j2;
                then [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2-'1)
                *> by A429,A479,A480,A484;
                hence thesis;
              end;
              suppose
                i1 = i2 & j1 = j2+1;
                then [i2+1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2+1,j2)*>
                by A429,A479,A480,A484;
                hence thesis;
              end;
            end;
            hence thesis;
          end;
        end;
        hence thesis;
      end;
    end;
A485: for k st P[k] holds P[k+1]
    proof
      let k such that
A486: for m st m <= k holds (F.k)|m = F.m;
      let m such that
A487: m <= k+1;
      per cases by A487,XXREAL_0:1;
      suppose
        m < k+1;
        then
A488:   m <= k by NAT_1:13;
        len(F.k) = k & ex i,j st [i,j] in Indices G & F.(k+1) = F.k^<*G*
        (i,j)*> by A192,A464;
        then (F.(k+1))|m = (F.k)|m by A488,FINSEQ_5:25;
        hence thesis by A486,A488;
      end;
      suppose
A489:   m = k+1;
        len(F.(k+1)) = k+1 by A192;
        hence thesis by A489,FINSEQ_1:79;
      end;
    end;
A490: for k holds P[k] from NAT_1:sch 1(A462,A485);
    defpred P[Element of NAT] means F.$1 is unfolded;
A491: for k st P[k] holds P[k+1]
    proof
      let k such that
A492: F.k is unfolded;
A493: F.k is_sequence_on G by A428;
      per cases;
      suppose
        k <= 1;
        then k+1 <= 1+1 by XREAL_1:8;
        then len(F.(k+1)) <= 2 by A192;
        hence thesis by SPPOL_2:27;
      end;
      suppose
A494:   k > 1;
        set m = k-'1;
A495:   m+1 = k by A494,XREAL_1:237;
A496:   len(F.k) = k by A192;
A497:   1 <= m by A494,NAT_D:49;
        then consider i1,j1,i2,j2 being Element of NAT such that
A498:   [i1,j1] in Indices G and
A499:   (F.k)/.m = G*(i1,j1) and
A500:   [i2,j2] in Indices G and
A501:   (F.k)/.len(F.k) = G*(i2,j2) and
A502:   i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or i1 = i2+1 & j1
        = j2 or i1 = i2 & j1 = j2+1 by A493,A495,A496,JORDAN8:6;
A503:   LSeg(F.k,m) = LSeg(G*(i1,j1),G*(i2,j2)) by A497,A495,A496,A499,A501,
TOPREAL1:def 5;
A504:   1 <= j2 by A500,MATRIX_1:39;
        then
A505:   (j2-'1)+1 = j2 by XREAL_1:237;
A506:   1 <= j1 by A498,MATRIX_1:39;
A507:   1 <= i2 by A500,MATRIX_1:39;
        then
A508:   (i2-'1)+1 = i2 by XREAL_1:237;
A509:   i1 <= len G by A498,MATRIX_1:39;
A510:   j2 <= width G by A500,MATRIX_1:39;
A511:   1 <= i1 by A498,MATRIX_1:39;
A512:   j1 <= width G by A498,MATRIX_1:39;
A513:   i2 <= len G by A500,MATRIX_1:39;
        now
          per cases;
          suppose
A514:       front_left_cell(F.k,(len(F.k))-'1,G) misses C &
            front_right_cell(F.k,(len(F.k))-'1,G) misses C;
            now
              per cases by A502;
              suppose
A515:           i1 = i2 & j1+1 = j2;
                then [i2+1,j2] in Indices G by A429,A494,A496,A498,A499,A500
,A501,A514;
                then i2+1 <= len G by MATRIX_1:39;
                then
A516:           LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G* (i2+1,j2)) = {(F.
                k)/.len(F.k)} by A501,A511,A506,A510,A503,A515,GOBOARD7:17;
                F.(k+1) = (F.k)^ <*G*(i2+1,j2)*> by A429,A494,A496,A498,A499
,A500,A501,A514,A515;
                hence thesis by A492,A495,A496,A516,SPPOL_2:31;
              end;
              suppose
A517:           i1+1 = i2 & j1 = j2;
                then [i2,j2-'1] in Indices G by A429,A494,A496,A498,A499,A500
,A501,A514;
                then 1 <= j2-'1 by MATRIX_1:39;
                then
A518:           LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G*(i2,j2-'1)) = {(F.
k)/.len(F.k)} by A501,A511,A512,A513,A505,A503,A517,GOBOARD7:18;
                F.(k+1) = (F.k)^ <*G*(i2,j2-'1)*> by A429,A494,A496,A498,A499
,A500,A501,A514,A517;
                hence thesis by A492,A495,A496,A518,SPPOL_2:31;
              end;
              suppose
A519:           i1 = i2+1 & j1 = j2;
                then [i2,j2+1] in Indices G by A429,A494,A496,A498,A499,A500
,A501,A514;
                then j2+1 <= width G by MATRIX_1:39;
                then
A520:           LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G* (i2,j2+1)) = {(F.
                k)/.len(F.k)} by A501,A509,A506,A507,A503,A519,GOBOARD7:19;
                F.(k+1) = (F.k)^ <*G*(i2,j2+1)*> by A429,A494,A496,A498,A499
,A500,A501,A514,A519;
                hence thesis by A492,A495,A496,A520,SPPOL_2:31;
              end;
              suppose
A521:           i1 = i2 & j1 = j2+1;
                then [i2-'1,j2] in Indices G by A429,A494,A496,A498,A499,A500
,A501,A514;
                then 1 <= i2-'1 by MATRIX_1:39;
                then
A522:           LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G*(i2-'1,j2)) = {(F.
k)/.len(F.k)} by A501,A509,A512,A504,A508,A503,A521,GOBOARD7:20;
                F.(k+1) = (F.k)^ <*G*(i2-'1,j2)*> by A429,A494,A496,A498,A499
,A500,A501,A514,A521;
                hence thesis by A492,A495,A496,A522,SPPOL_2:31;
              end;
            end;
            hence thesis;
          end;
          suppose
A523:       front_left_cell(F.k,(len(F.k))-'1,G) misses C &
            front_right_cell(F.k,(len(F.k))-'1,G) meets C;
            now
              per cases by A502;
              suppose
A524:           i1 = i2 & j1+1 = j2;
                then [i2,j2+1] in Indices G by A429,A494,A496,A498,A499,A500
,A501,A523;
                then
A525:           j2+1 <= width G by MATRIX_1:39;
                j2+1 = j1+(1+1) by A524;
                then
A526:           LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G* (i2,j2+1)) = {(F.
k)/.len(F.k)} by A501,A511,A509,A506,A503,A524,A525,GOBOARD7:15;
                F.(k+1) = (F.k)^ <*G*(i2,j2+1)*> by A429,A494,A496,A498,A499
,A500,A501,A523,A524;
                hence thesis by A492,A495,A496,A526,SPPOL_2:31;
              end;
              suppose
A527:           i1+1 = i2 & j1 = j2;
                then [i2+1,j2] in Indices G by A429,A494,A496,A498,A499,A500
,A501,A523;
                then
A528:           i2+1 <= len G by MATRIX_1:39;
                i2+1 = i1+(1+1) by A527;
                then
A529:           LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G* (i2+1,j2)) = {(F.
k)/.len(F.k)} by A501,A511,A506,A512,A503,A527,A528,GOBOARD7:16;
                F.(k+1) = (F.k)^ <*G*(i2+1,j2)*> by A429,A494,A496,A498,A499
,A500,A501,A523,A527;
                hence thesis by A492,A495,A496,A529,SPPOL_2:31;
              end;
              suppose
A530:           i1 = i2+1 & j1 = j2;
                then [i2-'1,j2] in Indices G by A429,A494,A496,A498,A499,A500
,A501,A523;
                then
A531:           1 <= i2-'1 by MATRIX_1:39;
                i2-'1+1+1 = i2-'1+(1+1);
                then
A532:           LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G*(i2-'1,j2)) = {(F.
k)/.len(F.k)} by A501,A509,A506,A512,A508,A503,A530,A531,GOBOARD7:16;
                F.(k+1) = (F.k)^ <*G*(i2-'1,j2)*> by A429,A494,A496,A498,A499
,A500,A501,A523,A530;
                hence thesis by A492,A495,A496,A532,SPPOL_2:31;
              end;
              suppose
A533:           i1 = i2 & j1 = j2+1;
                then [i2,j2-'1] in Indices G by A429,A494,A496,A498,A499,A500
,A501,A523;
                then
A534:           1 <= j2-'1 by MATRIX_1:39;
                j2-'1+1+1 = j2-'1+(1+1);
                then
A535:           LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G*(i2,j2-'1)) = {(F.
k)/.len(F.k)} by A501,A511,A509,A512,A505,A503,A533,A534,GOBOARD7:15;
                F.(k+1) = (F.k)^ <*G*(i2,j2-'1)*> by A429,A494,A496,A498,A499
,A500,A501,A523,A533;
                hence thesis by A492,A495,A496,A535,SPPOL_2:31;
              end;
            end;
            hence thesis;
          end;
          suppose
A536:       front_left_cell(F.k,(len(F.k))-'1,G) meets C;
            now
              per cases by A502;
              suppose
A537:           i1 = i2 & j1+1 = j2;
                then [i2-'1,j2] in Indices G by A429,A494,A496,A498,A499,A500
,A501,A536;
                then 1 <= i2-'1 by MATRIX_1:39;
                then
A538:           LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G*(i2-'1,j2)) = {(F.
k)/.len(F.k)} by A501,A509,A506,A510,A508,A503,A537,GOBOARD7:18;
                F.(k+1) = (F.k)^ <*G*(i2-'1,j2)*> by A429,A494,A496,A498,A499
,A500,A501,A536,A537;
                hence thesis by A492,A495,A496,A538,SPPOL_2:31;
              end;
              suppose
A539:           i1+1 = i2 & j1 = j2;
                then [i2,j2+1] in Indices G by A429,A494,A496,A498,A499,A500
,A501,A536;
                then j2+1 <= width G by MATRIX_1:39;
                then
A540:           LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G* (i2,j2+1)) = {(F.
                k)/.len(F.k)} by A501,A511,A506,A513,A503,A539,GOBOARD7:20;
                F.(k+1) = (F.k)^ <*G*(i2,j2+1)*> by A429,A494,A496,A498,A499
,A500,A501,A536,A539;
                hence thesis by A492,A495,A496,A540,SPPOL_2:31;
              end;
              suppose
A541:           i1 = i2+1 & j1 = j2;
                then [i2,j2-'1] in Indices G by A429,A494,A496,A498,A499,A500
,A501,A536;
                then 1 <= j2-'1 by MATRIX_1:39;
                then
A542:           LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G*(i2,j2-'1)) = {(F.
k)/.len(F.k)} by A501,A509,A512,A507,A505,A503,A541,GOBOARD7:17;
                F.(k+1) = (F.k)^ <*G*(i2,j2-'1)*> by A429,A494,A496,A498,A499
,A500,A501,A536,A541;
                hence thesis by A492,A495,A496,A542,SPPOL_2:31;
              end;
              suppose
A543:           i1 = i2 & j1 = j2+1;
                then [i2+1,j2] in Indices G by A429,A494,A496,A498,A499,A500
,A501,A536;
                then i2+1 <= len G by MATRIX_1:39;
                then
A544:           LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G* (i2+1,j2)) = {(F.
                k)/.len(F.k)} by A501,A511,A512,A504,A503,A543,GOBOARD7:19;
                F.(k+1) = (F.k)^ <*G*(i2+1,j2)*> by A429,A494,A496,A498,A499
,A500,A501,A536,A543;
                hence thesis by A492,A495,A496,A544,SPPOL_2:31;
              end;
            end;
            hence thesis;
          end;
        end;
        hence thesis;
      end;
    end;
    now
      defpred P[Element of NAT] means F.$1 is one-to-one;
      assume
A545: for k st k >= 1 holds for m st m in dom(F.k) & m <> len(F.k)
      holds (F.k)/.m <> (F.k)/.len(F.k);
A546: for k st P[k] holds P[k+1]
      proof
        let k;
        assume
A547:   F.k is one-to-one;
        now
          let n,m such that
A548:     n in dom(F.(k+1)) and
A549:     m in dom(F.(k+1)) and
A550:     (F.(k+1))/.n = (F.(k+1))/.m;
A551:     n <= len(F.(k+1)) & m <= len(F.(k+1)) by A548,A549,FINSEQ_3:27;
A552:     1 <= m by A549,FINSEQ_3:27;
A553:     1 <= n by A548,FINSEQ_3:27;
A554:     ex i,j st [i,j] in Indices G & F.(k+1) = (F.k)^<*G*(i,j) *> by A464;
A555:     len(F.k) = k by A192;
A556:     len(F.(k+1)) = k+1 by A192;
          per cases by A551,A556,NAT_1:8;
          suppose
A557:       n <= k & m <= k;
            then
A558:       m in dom(F.k) by A552,A555,FINSEQ_3:27;
            then
A559:       (F.(k+1))/.m = (F.k)/.m by A554,FINSEQ_4:83;
A560:       n in dom(F.k) by A553,A555,A557,FINSEQ_3:27;
            then (F.(k+1))/.n = (F.k)/.n by A554,FINSEQ_4:83;
            hence n = m by A547,A550,A560,A558,A559,PARTFUN2:17;
          end;
          suppose
            n = k+1 & m <= k;
            hence n = m by A545,A549,A550,A556,NAT_1:12;
          end;
          suppose
            n <= k & m = k+1;
            hence n = m by A545,A548,A550,A556,NAT_1:12;
          end;
          suppose
            n = k+1 & m = k+1;
            hence n = m;
          end;
        end;
        hence thesis by PARTFUN2:16;
      end;
A561: P[0] by A170;
A562: for k holds P[k] from NAT_1:sch 1(A561,A546);
A563: for k holds card rng(F.k) = k
      proof
        let k;
        F.k is one-to-one by A562;
        hence card rng(F.k) = len(F.k) by FINSEQ_4:77
          .= k by A192;
      end;
      set k = (len G)*(width G)+1;
      F.k is_sequence_on G by A428;
      then card Values G <= (len G)*(width G) & card rng(F.k) <= card Values
      G by GOBRD13:8,9,NAT_1:44;
      then k > (len G)*(width G) & card rng(F.k) <= (len G)*(width G) by
NAT_1:13,XXREAL_0:2;
      hence contradiction by A563;
    end;
    then
A564: ex k be Nat st Q[k];
    consider k be Nat such that
A565: Q[k] and
A566: for l be Nat st Q[l] holds k <= l from NAT_1:sch 5(A564);
    reconsider k as Element of NAT by ORDINAL1:def 13;
    consider m such that
A567: m in dom(F.k) and
A568: m <> len(F.k) and
A569: (F.k)/.m = (F.k)/.len(F.k) by A565;
A570: 1 <= m by A567,FINSEQ_3:27;
    reconsider f = F.k as non empty FinSequence of TOP-REAL 2 by A565;
A571: f is_sequence_on G by A428;
A572: m <= len f by A567,FINSEQ_3:27;
    then
A573: m < len f by A568,XXREAL_0:1;
    then 1 < len f by A570,XXREAL_0:2;
    then
A574: len f >= 1+1 by NAT_1:13;
A575: P[0] by A170,CARD_1:47,SPPOL_2:27;
    for k holds P[k] from NAT_1:sch 1(A575,A491);
    then reconsider
    f as non constant special unfolded non empty FinSequence of
    TOP-REAL 2 by A571,A574,JORDAN8:7,8;
A576: m+1 <= len f by A573,NAT_1:13;
    set g = f/^(m-'1);
    m-'1 <= m by NAT_D:44;
    then m-'1 < m+1 by NAT_1:13;
    then
A577: m-'1 < len f by A576,XXREAL_0:2;
    then
A578: len g = len f - (m-'1) by RFINSEQ:def 2;
    then (m-'1)-(m-'1) < len g by A577,XREAL_1:11;
    then reconsider g as non empty FinSequence of TOP-REAL 2 by CARD_1:47;
    len g in dom g by FINSEQ_5:6;
    then
A579: g/.len g = f/.(m-'1+len g) by FINSEQ_5:30
      .= f/.len f by A578;
A580: len(F.k) = k by A192;
A581: for i st 1 <= i & i < len g & 1 <= j & j < len g & g/.i = g/.j
    holds i = j
    proof
      let i such that
A582: 1 <= i and
A583: i < len g and
A584: 1 <= j and
A585: j < len g and
A586: g/.i = g/.j and
A587: i <> j;
A588: i in dom g by A582,A583,FINSEQ_3:27;
      then
A589: g/.i = f/.(m-'1+i) by FINSEQ_5:30;
A590: j in dom g by A584,A585,FINSEQ_3:27;
      then
A591: g/.j = f/.(m-'1+j) by FINSEQ_5:30;
      per cases by A587,XXREAL_0:1;
      suppose
A592:   i < j;
        set l = m-'1+j, m9= m-'1+i;
A593:   m9 < l by A592,XREAL_1:8;
A594:   len(F.l) = l by A192;
A595:   l < k by A580,A578,A585,XREAL_1:22;
        then
A596:   f|l = F.l by A490;
        0+j <= l by XREAL_1:8;
        then
A597:   1 <= l by A584,XXREAL_0:2;
        then l in dom(F.l) by A594,FINSEQ_3:27;
        then
A598:   (F.l)/.l = f/.l by A596,FINSEQ_4:85;
        0+i <= m9 by XREAL_1:8;
        then 1 <= m9 by A582,XXREAL_0:2;
        then
A599:   m9 in dom(F.l) by A593,A594,FINSEQ_3:27;
        then (F.l)/.m9 = f/.m9 by A596,FINSEQ_4:85;
        hence contradiction by A566,A586,A589,A590,A593,A595,A597,A594,A599
,A598,FINSEQ_5:30;
      end;
      suppose
A600:   j < i;
        set l = m-'1+i, m9= m-'1+j;
A601:   m9 < l by A600,XREAL_1:8;
A602:   len(F.l) = l by A192;
A603:   l < k by A580,A578,A583,XREAL_1:22;
        then
A604:   f|l = F.l by A490;
        0+i <= l by XREAL_1:8;
        then
A605:   1 <= l by A582,XXREAL_0:2;
        then l in dom(F.l) by A602,FINSEQ_3:27;
        then
A606:   (F.l)/.l = f/.l by A604,FINSEQ_4:85;
        0+j <= m9 by XREAL_1:8;
        then 1 <= m9 by A584,XXREAL_0:2;
        then
A607:   m9 in dom(F.l) by A601,A602,FINSEQ_3:27;
        then (F.l)/.m9 = f/.m9 by A604,FINSEQ_4:85;
        hence contradiction by A566,A586,A588,A591,A601,A603,A605,A602,A607
,A606,FINSEQ_5:30;
      end;
    end;
A608: now
      consider i such that
A609: 1 <= i & i+1 <= len G and
A610: N-min C in cell(G,i,width G-'1) & N-min C <> G*(i,width G-'1) and
A611: F.(1+1) = <*G*(i,width G),G*(i+1,width G)*> by A171;
      take i;
      thus 1 <= i & i+1 <= len G by A609;
A612: f|2 = F.2 by A490,A580,A574;
A613: len(f|2) = 2 by A574,FINSEQ_1:80;
      then 1 in dom(f|2) by FINSEQ_3:27;
      hence f/.1 = (f|2)/.1 by FINSEQ_4:85
        .= G*(i,width G) by A611,A612,FINSEQ_4:26;
      2 in dom(f|2) by A613,FINSEQ_3:27;
      hence f/.2 = (f|2)/.2 by FINSEQ_4:85
        .= G*(i+1,width G) by A611,A612,FINSEQ_4:26;
      thus N-min C in cell(G,i,width G-'1) & N-min C <> G* (i,width G-'1) by
A610;
    end;
    1 in dom g by FINSEQ_5:6;
    then
A614: g/.1 = f/.(m-'1+1) by FINSEQ_5:30
      .= f/.m by A570,XREAL_1:237;
A615: for i st 1 < i & i < j & j <= len g holds g/.i <> g/.j
    proof
      let i such that
A616: 1 < i and
A617: i < j and
A618: j <= len g and
A619: g/.i = g/.j;
A620: 1 < j by A616,A617,XXREAL_0:2;
A621: i < len g by A617,A618,XXREAL_0:2;
      then
A622: 1 < len g by A616,XXREAL_0:2;
      per cases;
      suppose
        j <> len g;
        then j < len g by A618,XXREAL_0:1;
        hence contradiction by A581,A616,A617,A619,A620,A621;
      end;
      suppose
        j = len g;
        hence contradiction by A569,A614,A579,A581,A616,A617,A619,A622;
      end;
    end;
    m+1-(m-'1) <= len g by A576,A578,XREAL_1:11;
    then
A623: m+1-(m-1) <= len g by A570,XREAL_1:235;
    then
A624: 1+m-m+1 <= len g;
A625: g is_sequence_on G by A428,JORDAN8:5;
    then
A626: g is standard by JORDAN8:7;
A627: g is non constant
    proof
      take 1,2;
      thus
A628: 1 in dom g by FINSEQ_5:6;
      thus
A629: 2 in dom g by A623,FINSEQ_3:27;
      then g/.1 <> g/.(1+1) by A626,FINSEQ_5:6,GOBOARD7:31;
      then g.1 <> g/.(1+1) by A628,PARTFUN1:def 8;
      hence thesis by A629,PARTFUN1:def 8;
    end;
A630: for i st 1 <= i & i < j & j < len g holds g/.i <> g/.j
    proof
      let i such that
A631: 1 <= i & i < j & j < len g and
A632: g/.i = g/.j;
      1 < j & i < len g by A631,XXREAL_0:2;
      hence contradiction by A581,A631,A632;
    end;
    g is s.c.c.
    proof
      let i,j such that
A633: i+1 < j and
A634: i > 1 & j < len g or j+1 < len g;
A635: 1 < j by A633,NAT_1:12;
A636: 1 <= i+1 by NAT_1:12;
A637: j <= j+1 by NAT_1:12;
      then
A638: i+1 < j+1 by A633,XXREAL_0:2;
      i < j by A633,NAT_1:13;
      then
A639: i < j+1 by A637,XXREAL_0:2;
      per cases by A634,NAT_1:14;
      suppose
A640:   i > 1 & j < len g;
        then
A641:   j+1 <= len g by NAT_1:13;
        then
A642:   LSeg(g,j) = LSeg(g/.j,g/.(j+1)) by A635,TOPREAL1:def 5;
        consider i19,j19,i29,j29 being Element of NAT such that
A643:   [i19,j19] in Indices G and
A644:   g/.j = G*(i19,j19) and
A645:   [i29,j29] in Indices G and
A646:   g/.(j+1) = G*(i29,j29) and
A647:   i19 = i29 & j19+1 = j29 or i19+1 = i29 & j19 = j29 or i19 =
i29+1 & j19 = j29 or i19 = i29 & j19 = j29+1 by A625,A635,A641,JORDAN8:6;
A648:   1 <= i19 by A643,MATRIX_1:39;
A649:   j29 <= width G by A645,MATRIX_1:39;
A650:   1 <= i29 by A645,MATRIX_1:39;
A651:   i19 <= len G by A643,MATRIX_1:39;
A652:   1 <= j29 by A645,MATRIX_1:39;
A653:   j19 <= width G by A643,MATRIX_1:39;
A654:   i29 <= len G by A645,MATRIX_1:39;
A655:   1 <= j19 by A643,MATRIX_1:39;
A656:   i+1 < len g by A633,A640,XXREAL_0:2;
        then
A657:   LSeg(g,i) = LSeg(g/.i,g/.(i+1)) by A640,TOPREAL1:def 5;
A658:   i < len g by A656,NAT_1:13;
        consider i1,j1,i2,j2 such that
A659:   [i1,j1] in Indices G and
A660:   g/.i = G*(i1,j1) and
A661:   [i2,j2] in Indices G and
A662:   g/.(i+1) = G*(i2,j2) and
A663:   i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or i1 = i2+1 &
        j1 = j2 or i1 = i2 & j1 = j2+1 by A625,A640,A656,JORDAN8:6;
A664:   1 <= i1 by A659,MATRIX_1:39;
A665:   j2 <= width G by A661,MATRIX_1:39;
A666:   j1 <= width G by A659,MATRIX_1:39;
A667:   1 <= j2 by A661,MATRIX_1:39;
A668:   1 <= j1 by A659,MATRIX_1:39;
A669:   i2 <= len G by A661,MATRIX_1:39;
A670:   i1 <= len G by A659,MATRIX_1:39;
A671:   1 < i+1 by A640,NAT_1:13;
        assume
A672:   LSeg(g,i) meets LSeg(g,j);
A673:   1 <= i2 by A661,MATRIX_1:39;
        now
          per cases by A663,A647;
          suppose
A674:       i1 = i2 & j1+1 = j2 & i19 = i29 & j19+1 = j29;
            then
A675:       j1 = j19 or j1 = j19+1 or j1+1 = j19 by A657,A660,A662,A664,A670
,A668,A665,A642,A644,A646,A648,A651,A655,A649,A672,GOBOARD7:24;
            i1 = i19 by A657,A660,A662,A664,A670,A668,A665,A642,A644,A646,A648
,A651,A655,A649,A672,A674,GOBOARD7:21;
            hence contradiction by A581,A615,A633,A637,A636,A635,A639,A640,A656
,A658,A660,A662,A641,A644,A646,A674,A675;
          end;
          suppose
A676:       i1 = i2 & j1+1 = j2 & i19+1 = i29 & j19 = j29;
            then i1 = i19 & j1 = j19 or i1 = i19 & j1+1 = j19 or i1 = i19+1
& j1 = j19 or i1 = i19+1 & j1+1 = j19 by A657,A660,A662,A664,A670,A668,A665
,A642,A644,A646,A648,A655,A653,A654,A672,GOBOARD7:23;
            hence contradiction by A581,A615,A633,A638,A635,A639,A640,A671,A658
,A660,A662,A641,A644,A646,A676;
          end;
          suppose
A677:       i1 = i2 & j1+1 = j2 & i19 = i29+1 & j19 = j29;
            then i1 = i29 & j19 = j1 or i1 = i29 & j1+1 = j19 or i1 = i29+1
& j19 = j1 or i1 = i29+1 & j1+1 = j19 by A657,A660,A662,A664,A670,A668,A665
,A642,A644,A646,A651,A655,A653,A650,A672,GOBOARD7:23;
            hence contradiction by A581,A615,A633,A638,A635,A639,A640,A671,A658
,A660,A662,A641,A644,A646,A677;
          end;
          suppose
A678:       i1 = i2 & j1+1 = j2 & i19 = i29 & j19 = j29+1;
            then
A679:       j1 = j29 or j1 = j29+1 or j1+1 = j29 by A657,A660,A662,A664,A670
,A668,A665,A642,A644,A646,A648,A651,A653,A652,A672,GOBOARD7:24;
            i1 = i19 by A657,A660,A662,A664,A670,A668,A665,A642,A644,A646,A648
,A651,A653,A652,A672,A678,GOBOARD7:21;
            hence contradiction by A581,A615,A633,A638,A635,A640,A671,A658,A660
,A662,A641,A644,A646,A678,A679;
          end;
          suppose
A680:       i1+1 = i2 & j1 = j2 & i19 = i29 & j19+1 = j29;
            then i19 = i1 & j1 = j19 or i19 = i1 & j19+1 = j1 or i19 = i1+1
& j1 = j19 or i19 = i1+1 & j19+1 = j1 by A657,A660,A662,A664,A668,A666,A669
,A642,A644,A646,A648,A651,A655,A649,A672,GOBOARD7:23;
            hence contradiction by A581,A615,A633,A638,A635,A639,A640,A671,A658
,A660,A662,A641,A644,A646,A680;
          end;
          suppose
A681:       i1+1 = i2 & j1 = j2 & i19+1 = i29 & j19 = j29;
            then
A682:       i1 = i19 or i1 = i19+1 or i1+1 = i19 by A657,A660,A662,A664,A668
,A666,A669,A642,A644,A646,A648,A655,A653,A654,A672,GOBOARD7:25;
            j1 = j19 by A657,A660,A662,A664,A668,A666,A669,A642,A644,A646,A648
,A655,A653,A654,A672,A681,GOBOARD7:22;
            hence contradiction by A581,A615,A633,A637,A636,A635,A639,A640,A656
,A658,A660,A662,A641,A644,A646,A681,A682;
          end;
          suppose
A683:       i1+1 = i2 & j1 = j2 & i19 = i29+1 & j19 = j29;
            then
A684:       i1 = i29 or i1 = i29+1 or i1+1 = i29 by A657,A660,A662,A664,A668
,A666,A669,A642,A644,A646,A651,A655,A653,A650,A672,GOBOARD7:25;
            j1 = j19 by A657,A660,A662,A664,A668,A666,A669,A642,A644,A646,A651
,A655,A653,A650,A672,A683,GOBOARD7:22;
            hence contradiction by A581,A615,A638,A635,A639,A640,A671,A658,A660
,A662,A641,A644,A646,A683,A684;
          end;
          suppose
A685:       i1+1 = i2 & j1 = j2 & i19 = i29 & j19 = j29+1;
            then i19 = i1 & j1 = j29 or i19 = i1 & j29+1 = j1 or i19 = i1+1
& j1 = j29 or i19 = i1+1 & j29+1 = j1 by A657,A660,A662,A664,A668,A666,A669
,A642,A644,A646,A648,A651,A653,A652,A672,GOBOARD7:23;
            hence contradiction by A581,A615,A633,A638,A635,A639,A640,A671,A658
,A660,A662,A641,A644,A646,A685;
          end;
          suppose
A686:       i1 = i2+1 & j1 = j2 & i19 = i29 & j19+1 = j29;
            then i19 = i2 & j19 = j1 or i19 = i2 & j19+1 = j1 or i19 = i2+1
& j19 = j1 or i19 = i2+1 & j19+1 = j1 by A657,A660,A662,A670,A668,A666,A673
,A642,A644,A646,A648,A651,A655,A649,A672,GOBOARD7:23;
            hence contradiction by A581,A615,A633,A638,A635,A639,A640,A671,A658
,A660,A662,A641,A644,A646,A686;
          end;
          suppose
A687:       i1 = i2+1 & j1 = j2 & i19+1 = i29 & j19 = j29;
            then
A688:       i2 = i19 or i2 = i19+1 or i2+1 = i19 by A657,A660,A662,A670,A668
,A666,A673,A642,A644,A646,A648,A655,A653,A654,A672,GOBOARD7:25;
            j1 = j19 by A657,A660,A662,A670,A668,A666,A673,A642,A644,A646,A648
,A655,A653,A654,A672,A687,GOBOARD7:22;
            hence contradiction by A581,A615,A633,A638,A635,A640,A671,A658,A660
,A662,A641,A644,A646,A687,A688;
          end;
          suppose
A689:       i1 = i2+1 & j1 = j2 & i19 = i29+1 & j19 = j29;
            then
A690:       i2 = i29 or i2 = i29+1 or i2+1 = i29 by A657,A660,A662,A670,A668
,A666,A673,A642,A644,A646,A651,A655,A653,A650,A672,GOBOARD7:25;
            j1 = j19 by A657,A660,A662,A670,A668,A666,A673,A642,A644,A646,A651
,A655,A653,A650,A672,A689,GOBOARD7:22;
            hence contradiction by A615,A633,A638,A639,A640,A671,A660,A662,A641
,A644,A646,A689,A690;
          end;
          suppose
A691:       i1 = i2+1 & j1 = j2 & i19 = i29 & j19 = j29+1;
            then i19 = i2 & j29 = j1 or i19 = i2 & j29+1 = j1 or i19 = i2+1
& j29 = j1 or i19 = i2+1 & j29+1 = j1 by A657,A660,A662,A670,A668,A666,A673
,A642,A644,A646,A648,A651,A653,A652,A672,GOBOARD7:23;
            hence contradiction by A581,A615,A633,A638,A635,A639,A640,A671,A658
,A660,A662,A641,A644,A646,A691;
          end;
          suppose
A692:       i1 = i2 & j1 = j2+1 & i19 = i29 & j19+1 = j29;
            then
A693:       j2 = j19 or j2 = j19+1 or j2+1 = j19 by A657,A660,A662,A664,A670
,A666,A667,A642,A644,A646,A648,A651,A655,A649,A672,GOBOARD7:24;
            i1 = i19 by A657,A660,A662,A664,A670,A666,A667,A642,A644,A646,A648
,A651,A655,A649,A672,A692,GOBOARD7:21;
            hence contradiction by A581,A615,A633,A638,A635,A640,A671,A658,A660
,A662,A641,A644,A646,A692,A693;
          end;
          suppose
A694:       i1 = i2 & j1 = j2+1 & i19+1 = i29 & j19 = j29;
            then i1 = i19 & j2 = j19 or i1 = i19 & j2+1 = j19 or i1 = i19+1
& j2 = j19 or i1 = i19+1 & j2+1 = j19 by A657,A660,A662,A664,A670,A666,A667
,A642,A644,A646,A648,A655,A653,A654,A672,GOBOARD7:23;
            hence contradiction by A581,A615,A633,A638,A635,A639,A640,A671,A658
,A660,A662,A641,A644,A646,A694;
          end;
          suppose
A695:       i1 = i2 & j1 = j2+1 & i19 = i29+1 & j19 = j29;
            then i1 = i29 & j2 = j19 or i1 = i29 & j2+1 = j19 or i1 = i29+1
& j2 = j19 or i1 = i29+1 & j2+1 = j19 by A657,A660,A662,A664,A670,A666,A667
,A642,A644,A646,A651,A655,A653,A650,A672,GOBOARD7:23;
            hence contradiction by A581,A615,A633,A638,A635,A639,A640,A671,A658
,A660,A662,A641,A644,A646,A695;
          end;
          suppose
A696:       i1 = i2 & j1 = j2+1 & i19 = i29 & j19 = j29+1;
            then
A697:       j2 = j29 or j2 = j29+1 or j2+1 = j29 by A657,A660,A662,A664,A670
,A666,A667,A642,A644,A646,A648,A651,A653,A652,A672,GOBOARD7:24;
            i1 = i19 by A657,A660,A662,A664,A670,A666,A667,A642,A644,A646,A648
,A651,A653,A652,A672,A696,GOBOARD7:21;
            hence contradiction by A615,A633,A638,A639,A640,A671,A660,A662,A641
,A644,A646,A696,A697;
          end;
        end;
        hence contradiction;
      end;
      suppose
        i = 0 & j+1 < len g;
        then LSeg(g,i) = {} by TOPREAL1:def 5;
        hence thesis by XBOOLE_1:65;
      end;
      suppose
A698:   1 <= i & j+1 < len g;
        then
A699:   i+1 < len g by A638,XXREAL_0:2;
        then
A700:   LSeg(g,i) = LSeg(g/.i,g/.(i+1)) by A698,TOPREAL1:def 5;
A701:   i < len g by A699,NAT_1:13;
        consider i1,j1,i2,j2 such that
A702:   [i1,j1] in Indices G and
A703:   g/.i = G*(i1,j1) and
A704:   [i2,j2] in Indices G and
A705:   g/.(i+1) = G*(i2,j2) and
A706:   i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or i1 = i2+1 &
        j1 = j2 or i1 = i2 & j1 = j2+1 by A625,A698,A699,JORDAN8:6;
A707:   1 <= i1 by A702,MATRIX_1:39;
A708:   j2 <= width G by A704,MATRIX_1:39;
A709:   j1 <= width G by A702,MATRIX_1:39;
A710:   1 <= j2 by A704,MATRIX_1:39;
A711:   1 <= j1 by A702,MATRIX_1:39;
A712:   i2 <= len G by A704,MATRIX_1:39;
A713:   i1 <= len G by A702,MATRIX_1:39;
A714:   1 < i+1 by A698,NAT_1:13;
        assume
A715:   LSeg(g,i) meets LSeg(g,j);
        consider i19,j19,i29,j29 being Element of NAT such that
A716:   [i19,j19] in Indices G and
A717:   g/.j = G*(i19,j19) and
A718:   [i29,j29] in Indices G and
A719:   g/.(j+1) = G*(i29,j29) and
A720:   i19 = i29 & j19+1 = j29 or i19+1 = i29 & j19 = j29 or i19 =
i29+1 & j19 = j29 or i19 = i29 & j19 = j29+1 by A625,A635,A698,JORDAN8:6;
A721:   1 <= i19 by A716,MATRIX_1:39;
A722:   j29 <= width G by A718,MATRIX_1:39;
A723:   1 <= i29 by A718,MATRIX_1:39;
A724:   i19 <= len G by A716,MATRIX_1:39;
A725:   1 <= j29 by A718,MATRIX_1:39;
A726:   j19 <= width G by A716,MATRIX_1:39;
A727:   i29 <= len G by A718,MATRIX_1:39;
A728:   1 <= j19 by A716,MATRIX_1:39;
A729:   j < len g by A698,NAT_1:12;
A730:   LSeg(g,j) = LSeg(g/.j,g/.(j+1)) by A635,A698,TOPREAL1:def 5;
A731:   1 <= i2 by A704,MATRIX_1:39;
        now
          per cases by A706,A720;
          suppose
A732:       i1 = i2 & j1+1 = j2 & i19 = i29 & j19+1 = j29;
            then
A733:       j1 = j19 or j1 = j19+1 or j1+1 = j19 by A700,A703,A705,A707,A713
,A711,A708,A730,A717,A719,A721,A724,A728,A722,A715,GOBOARD7:24;
            i1 = i19 by A700,A703,A705,A707,A713,A711,A708,A730,A717,A719,A721
,A724,A728,A722,A715,A732,GOBOARD7:21;
            hence contradiction by A630,A633,A638,A636,A639,A698,A729,A703,A705
,A717,A719,A732,A733;
          end;
          suppose
A734:       i1 = i2 & j1+1 = j2 & i19+1 = i29 & j19 = j29;
            then i1 = i19 & j1 = j19 or i1 = i19 & j1+1 = j19 or i1 = i19+1
& j1 = j19 or i1 = i19+1 & j1+1 = j19 by A700,A703,A705,A707,A713,A711,A708
,A730,A717,A719,A721,A728,A726,A727,A715,GOBOARD7:23;
            hence contradiction by A581,A630,A633,A638,A635,A639,A698,A714,A701
,A729,A703,A705,A717,A719,A734;
          end;
          suppose
A735:       i1 = i2 & j1+1 = j2 & i19 = i29+1 & j19 = j29;
            then i1 = i29 & j19 = j1 or i1 = i29 & j1+1 = j19 or i1 = i29+1
& j19 = j1 or i1 = i29+1 & j1+1 = j19 by A700,A703,A705,A707,A713,A711,A708
,A730,A717,A719,A724,A728,A726,A723,A715,GOBOARD7:23;
            hence contradiction by A581,A630,A633,A638,A635,A639,A698,A714,A701
,A729,A703,A705,A717,A719,A735;
          end;
          suppose
A736:       i1 = i2 & j1+1 = j2 & i19 = i29 & j19 = j29+1;
            then
A737:       j1 = j29 or j1 = j29+1 or j1+1 = j29 by A700,A703,A705,A707,A713
,A711,A708,A730,A717,A719,A721,A724,A726,A725,A715,GOBOARD7:24;
            i1 = i19 by A700,A703,A705,A707,A713,A711,A708,A730,A717,A719,A721
,A724,A726,A725,A715,A736,GOBOARD7:21;
            hence contradiction by A581,A615,A633,A638,A635,A698,A714,A701,A729
,A703,A705,A717,A719,A736,A737;
          end;
          suppose
A738:       i1+1 = i2 & j1 = j2 & i19 = i29 & j19+1 = j29;
            then i19 = i1 & j1 = j19 or i19 = i1 & j19+1 = j1 or i19 = i1+1
& j1 = j19 or i19 = i1+1 & j19+1 = j1 by A700,A703,A705,A707,A711,A709,A712
,A730,A717,A719,A721,A724,A728,A722,A715,GOBOARD7:23;
            hence contradiction by A581,A630,A633,A638,A636,A635,A639,A698,A701
,A729,A703,A705,A717,A719,A738;
          end;
          suppose
A739:       i1+1 = i2 & j1 = j2 & i19+1 = i29 & j19 = j29;
            then
A740:       i1 = i19 or i1 = i19+1 or i1+1 = i19 by A700,A703,A705,A707,A711
,A709,A712,A730,A717,A719,A721,A728,A726,A727,A715,GOBOARD7:25;
            j1 = j19 by A700,A703,A705,A707,A711,A709,A712,A730,A717,A719,A721
,A728,A726,A727,A715,A739,GOBOARD7:22;
            hence contradiction by A630,A633,A638,A636,A639,A698,A729,A703,A705
,A717,A719,A739,A740;
          end;
          suppose
A741:       i1+1 = i2 & j1 = j2 & i19 = i29+1 & j19 = j29;
            then
A742:       i1 = i29 or i1 = i29+1 or i1+1 = i29 by A700,A703,A705,A707,A711
,A709,A712,A730,A717,A719,A724,A728,A726,A723,A715,GOBOARD7:25;
            j1 = j19 by A700,A703,A705,A707,A711,A709,A712,A730,A717,A719,A724
,A728,A726,A723,A715,A741,GOBOARD7:22;
            hence contradiction by A581,A630,A638,A635,A639,A698,A714,A701,A729
,A703,A705,A717,A719,A741,A742;
          end;
          suppose
A743:       i1+1 = i2 & j1 = j2 & i19 = i29 & j19 = j29+1;
            then i19 = i1 & j1 = j29 or i19 = i1 & j29+1 = j1 or i19 = i1+1
& j1 = j29 or i19 = i1+1 & j29+1 = j1 by A700,A703,A705,A707,A711,A709,A712
,A730,A717,A719,A721,A724,A726,A725,A715,GOBOARD7:23;
            hence contradiction by A581,A630,A633,A638,A635,A639,A698,A714,A701
,A729,A703,A705,A717,A719,A743;
          end;
          suppose
A744:       i1 = i2+1 & j1 = j2 & i19 = i29 & j19+1 = j29;
            then i19 = i2 & j19 = j1 or i19 = i2 & j19+1 = j1 or i19 = i2+1
& j19 = j1 or i19 = i2+1 & j19+1 = j1 by A700,A703,A705,A713,A711,A709,A731
,A730,A717,A719,A721,A724,A728,A722,A715,GOBOARD7:23;
            hence contradiction by A581,A630,A633,A638,A635,A639,A698,A714,A701
,A729,A703,A705,A717,A719,A744;
          end;
          suppose
A745:       i1 = i2+1 & j1 = j2 & i19+1 = i29 & j19 = j29;
            then
A746:       i2 = i19 or i2 = i19+1 or i2+1 = i19 by A700,A703,A705,A713,A711
,A709,A731,A730,A717,A719,A721,A728,A726,A727,A715,GOBOARD7:25;
            j1 = j19 by A700,A703,A705,A713,A711,A709,A731,A730,A717,A719,A721
,A728,A726,A727,A715,A745,GOBOARD7:22;
            hence contradiction by A581,A615,A633,A638,A635,A698,A714,A701,A729
,A703,A705,A717,A719,A745,A746;
          end;
          suppose
A747:       i1 = i2+1 & j1 = j2 & i19 = i29+1 & j19 = j29;
            then
A748:       i2 = i29 or i2 = i29+1 or i2+1 = i29 by A700,A703,A705,A713,A711
,A709,A731,A730,A717,A719,A724,A728,A726,A723,A715,GOBOARD7:25;
            j1 = j19 by A700,A703,A705,A713,A711,A709,A731,A730,A717,A719,A724
,A728,A726,A723,A715,A747,GOBOARD7:22;
            hence contradiction by A630,A633,A638,A639,A698,A714,A729,A703,A705
,A717,A719,A747,A748;
          end;
          suppose
A749:       i1 = i2+1 & j1 = j2 & i19 = i29 & j19 = j29+1;
            then i19 = i2 & j29 = j1 or i19 = i2 & j29+1 = j1 or i19 = i2+1
& j29 = j1 or i19 = i2+1 & j29+1 = j1 by A700,A703,A705,A713,A711,A709,A731
,A730,A717,A719,A721,A724,A726,A725,A715,GOBOARD7:23;
            hence contradiction by A581,A630,A633,A638,A635,A639,A698,A714,A701
,A729,A703,A705,A717,A719,A749;
          end;
          suppose
A750:       i1 = i2 & j1 = j2+1 & i19 = i29 & j19+1 = j29;
            then
A751:       j2 = j19 or j2 = j19+1 or j2+1 = j19 by A700,A703,A705,A707,A713
,A709,A710,A730,A717,A719,A721,A724,A728,A722,A715,GOBOARD7:24;
            i1 = i19 by A700,A703,A705,A707,A713,A709,A710,A730,A717,A719,A721
,A724,A728,A722,A715,A750,GOBOARD7:21;
            hence contradiction by A581,A615,A633,A638,A635,A698,A714,A701,A729
,A703,A705,A717,A719,A750,A751;
          end;
          suppose
A752:       i1 = i2 & j1 = j2+1 & i19+1 = i29 & j19 = j29;
            then i1 = i19 & j2 = j19 or i1 = i19 & j2+1 = j19 or i1 = i19+1
& j2 = j19 or i1 = i19+1 & j2+1 = j19 by A700,A703,A705,A707,A713,A709,A710
,A730,A717,A719,A721,A728,A726,A727,A715,GOBOARD7:23;
            hence contradiction by A581,A630,A633,A638,A635,A639,A698,A714,A701
,A729,A703,A705,A717,A719,A752;
          end;
          suppose
A753:       i1 = i2 & j1 = j2+1 & i19 = i29+1 & j19 = j29;
            then i1 = i29 & j2 = j19 or i1 = i29 & j2+1 = j19 or i1 = i29+1
& j2 = j19 or i1 = i29+1 & j2+1 = j19 by A700,A703,A705,A707,A713,A709,A710
,A730,A717,A719,A724,A728,A726,A723,A715,GOBOARD7:23;
            hence contradiction by A581,A630,A633,A638,A635,A639,A698,A714,A701
,A729,A703,A705,A717,A719,A753;
          end;
          suppose
A754:       i1 = i2 & j1 = j2+1 & i19 = i29 & j19 = j29+1;
            then
A755:       j2 = j29 or j2 = j29+1 or j2+1 = j29 by A700,A703,A705,A707,A713
,A709,A710,A730,A717,A719,A721,A724,A726,A725,A715,GOBOARD7:24;
            i1 = i19 by A700,A703,A705,A707,A713,A709,A710,A730,A717,A719,A721
,A724,A726,A725,A715,A754,GOBOARD7:21;
            hence contradiction by A630,A633,A638,A639,A698,A714,A729,A703,A705
,A717,A719,A754,A755;
          end;
        end;
        hence contradiction;
      end;
    end;
    then reconsider
    g as standard non constant special_circular_sequence by A569,A614,A579,A625
,A627,FINSEQ_6:def 1,JORDAN8:7;
A756: for i st 1 <= i & i+1 <= len f holds right_cell(f,i,G) = Cl Int
    right_cell(f,i,G)
    proof
      let i such that
A757: 1 <= i & i+1 <= len f;
      consider i1,j1,i2,j2 such that
A758: [i1,j1] in Indices G and
A759: f/.i = G*(i1,j1) and
A760: [i2,j2] in Indices G and
A761: f/.(i+1) = G*(i2,j2) and
A762: i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or i1 = i2+1 & j1
      = j2 or i1 = i2 & j1 = j2+1 by A571,A757,JORDAN8:6;
A763: i1 <= len G by A758,MATRIX_1:39;
A764: j2 <= width G by A760,MATRIX_1:39;
A765: j1 <= width G by A758,MATRIX_1:39;
A766: j1+1 > j1 & j2+1 > j2 by NAT_1:13;
A767: i2 <= len G by A760,MATRIX_1:39;
A768: i1+1 > i1 & i2+1 > i2 by NAT_1:13;
      per cases by A762;
      suppose
        i1 = i2 & j1+1 = j2;
        then right_cell(f,i,G) = cell(G,i1,j1) by A571,A757,A758,A759,A760,A761
,A766,GOBRD13:def 2;
        hence thesis by A763,A765,GOBRD11:35;
      end;
      suppose
A769:   i1+1 = i2 & j1 = j2;
A770:   j1-'1 <= width G by A765,NAT_D:44;
        right_cell(f,i,G) = cell(G,i1,j1-'1) by A571,A757,A758,A759,A760,A761
,A768,A769,GOBRD13:def 2;
        hence thesis by A763,A770,GOBRD11:35;
      end;
      suppose
        i1 = i2+1 & j1 = j2;
        then right_cell(f,i,G) = cell(G,i2,j2) by A571,A757,A758,A759,A760,A761
,A768,GOBRD13:def 2;
        hence thesis by A767,A764,GOBRD11:35;
      end;
      suppose
A771:   i1 = i2 & j1 = j2+1;
A772:   i1-'1 <= len G by A763,NAT_D:44;
        right_cell(f,i,G) = cell(G,i1-'1,j2) by A571,A757,A758,A759,A760,A761
,A766,A771,GOBRD13:def 2;
        hence thesis by A764,A772,GOBRD11:35;
      end;
    end;
    now
A773: for h being standard non constant special_circular_sequence st L~
h c= L~f for Comp being Subset of TOP-REAL 2 st Comp is_a_component_of (L~h)`
for n st 1 <= n & n+1 <= len f & f/.n in Comp & not f/.n in L~h holds C meets
      Comp
      proof
        let h be standard non constant special_circular_sequence such that
A774:   L~h c= L~f;
        let Comp be Subset of TOP-REAL 2 such that
A775:   Comp is_a_component_of (L~h)`;
        let n such that
A776:   1 <= n & n+1 <= len f and
A777:   f/.n in Comp and
A778:   not f/.n in L~h;
        reconsider rc = right_cell(f,n,G)\L~h as Subset of TOP-REAL 2;
        f/.n in right_cell(f,n,G) by A571,A776,Th10;
        then f/.n in rc by A778,XBOOLE_0:def 5;
        then
A779:   rc meets Comp by A777,XBOOLE_0:3;
A780:   rc meets C
        proof
          right_cell(f,n,G) meets C by A428,A776;
          then consider p being set such that
A781:     p in right_cell(f,n,G) and
A782:     p in C by XBOOLE_0:3;
          reconsider p as Element of TOP-REAL 2 by A781;
          now
            take a = p;
            now
              assume
              p in L~h;
              then consider j such that
A783:         1 <= j & j+1 <= len f and
A784:         p in LSeg(f,j) by A774,SPPOL_2:13;
              p in left_cell(f,j,G) /\ right_cell(f,j,G) by A428,A783,A784,
GOBRD13:30;
              then
A785:         p in left_cell(f,j,G) by XBOOLE_0:def 4;
              left_cell(f,j,G) misses C by A428,A783;
              hence contradiction by A782,A785,XBOOLE_0:3;
            end;
            hence a in rc by A781,XBOOLE_0:def 5;
            thus a in C by A782;
          end;
          hence thesis by XBOOLE_0:3;
        end;
        Int right_cell(f,n,G) misses L~f by A571,A776,Th17;
        then Int right_cell(f,n,G) misses L~h by A774,XBOOLE_1:63;
        then
A786:   Int right_cell(f,n,G) c= (L~h)` by SUBSET_1:43;
A787:   rc = right_cell(f,n,G) /\ (L~h)` by SUBSET_1:32;
        then
A788:   rc c= (L~h)` by XBOOLE_1:17;
        rc c= right_cell(f,n,G) by XBOOLE_1:36;
        then
A789:   Int right_cell(f,n,G) c= right_cell(f,n,G) & rc c= Cl Int
        right_cell(f,n,G) by A571,A776,Th13,TOPS_1:44;
        Int right_cell(f,n,G) is connected by A571,A776,Th12;
        then rc is connected by A787,A786,A789,CONNSP_1:19,XBOOLE_1:19;
        then rc c= Comp by A775,A779,A788,GOBOARD9:6;
        hence thesis by A780,XBOOLE_1:63;
      end;
      L~g is closed by SPPOL_1:49;
      then (L~g)` is open by TOPS_1:29;
      then
A790: (L~g)` = Int (L~g)` by TOPS_1:55;
A791: L~g c= L~f by JORDAN3:75;
A792: for j,k st 1 <= j & j <= k holds (F.k)/.j = (F.j)/.j
      proof
        let j,k;
        assume that
A793:   1 <= j and
A794:   j <= k;
        j <= len(F.k) by A192,A794;
        then len(F.k|j) = j by FINSEQ_1:80;
        then
A795:   j in dom((F.k)|j) by A793,FINSEQ_3:27;
        (F.k)|j = F.j by A490,A794;
        hence thesis by A795,FINSEQ_4:85;
      end;
      assume
      m <> 1;
      then
A796: 1 < m by A570,XXREAL_0:1;
A797: for n st 1 <= n & n <= m-'1 holds not f/.n in L~g
      proof
A798:   2 <= len G by A231,NAT_1:12;
        let n such that
A799:   1 <= n and
A800:   n <= m-'1;
        set p = f/.n;
A801:   n <= len f by A577,A800,XXREAL_0:2;
        then
A802:   p in Values G by A428,A799,Th8;
        assume
        p in L~g;
        then consider j such that
A803:   m-'1+1 <= j and
A804:   j+1 <= len f and
A805:   p in LSeg(f,j) by A577,Th9;
A806:   j < k by A580,A804,NAT_1:13;
A807:   n < m-'1+1 by A800,NAT_1:13;
        then
A808:   n < j by A803,XXREAL_0:2;
A809:   m-'1+1=m by A570,XREAL_1:237;
        then
A810:   1 < j by A796,A803,XXREAL_0:2;
        per cases by A2,A428,A804,A805,A810,A798,A802,Th25;
        suppose
A811:     p = f/.j;
A812:     n <> len(F.j) by A192,A803,A807;
          n <= len(F.j) by A192,A808;
          then
A813:     n in dom(F.j) by A799,FINSEQ_3:27;
          (F.j)/.n = (F.n)/.n by A792,A799,A808
            .= p by A580,A792,A799,A801
            .= (F.j)/.j by A792,A810,A806,A811
            .= (F.j)/.len(F.j) by A192;
          hence contradiction by A566,A810,A806,A813,A812;
        end;
        suppose
A814:     p = f/.(j+1);
          now
            per cases by A580,A804,XXREAL_0:1;
            suppose
A815:         j+1 = k;
A816:         n <> len(F.m) by A192,A807,A809;
              n <= len(F.m) by A192,A807,A809;
              then
A817:         n in dom(F.m) by A799,FINSEQ_3:27;
              (F.m)/.n = (F.n)/.n by A792,A799,A807,A809
                .= (F.k)/.k by A580,A792,A799,A801,A814,A815
                .= (F.m)/.m by A569,A580,A570,A572,A792
                .= (F.m)/.len(F.m) by A192;
              hence contradiction by A566,A580,A570,A573,A817,A816;
            end;
            suppose
A818:         j+1 < k;
              set l = j+1;
A819:         1 <= l by NAT_1:11;
A820:         n < n+1 & n+1 < l by A808,XREAL_1:8,31;
              then
A821:         n <> len(F.l) by A192;
A822:         n < l by A820,XXREAL_0:2;
              then n <= len(F.l) by A192;
              then
A823:         n in dom(F.l) by A799,FINSEQ_3:27;
              (F.l)/.n = (F.n)/.n by A792,A799,A822
                .= p by A580,A792,A799,A801
                .= (F.l)/.l by A792,A814,A818,A819
                .= (F.l)/.len(F.l) by A192;
              hence contradiction by A566,A818,A823,A821,NAT_1:11;
            end;
          end;
          hence contradiction;
        end;
      end;
      C meets RightComp Rev g
      proof
        1 <= len g by A624,XREAL_1:147;
        then
A824:   len g-'1+2 = len g+1 by Lm1;
A825:   1 - 1 < m - 1 by A796,XREAL_1:11;
A826:   m-'1+2 = m+1 by A570,Lm1;
        set l = (m-'1)+(len g-'1);
        set a = f/.(m-'1);
        set rg=Rev g;
        set p = rg/.1, q = rg/.2;
A827:   1+1 - 1 <= len g - 1 by A623,XREAL_1:11;
        1+1-'1 <= len g-'1 by A623,NAT_D:42;
        then
A828:   1 <= len g-'1 by NAT_D:34;
        then (m-'1)+1 <= l by XREAL_1:8;
        then m-'1 < l by NAT_1:13;
        then
A829:   m-'1 <> len(F.l) by A192;
A830:   1+1 <= len rg by A623,FINSEQ_5:def 3;
        then 1+1-'1 <= len rg-'1 by NAT_D:42;
        then
A831:   1 <= len rg -'1 by NAT_D:34;
        1 < len rg by A830,NAT_1:13;
        then
A832:   len rg -'1+1 = len rg by XREAL_1:237;
A833:   rg is_sequence_on G by A625,Th7;
        then consider p1,p2,q1,q2 being Element of NAT such that
A834:   [p1,p2] in Indices G and
A835:   p = G*(p1,p2) and
A836:   [q1,q2] in Indices G and
A837:   q = G*(q1,q2) and
A838:   p1 = q1 & p2+1 = q2 or p1+1 = q1 & p2 = q2 or p1 = q1+1 &
        p2 = q2 or p1 = q1 & p2 = q2+1 by A830,JORDAN8:6;
A839:   1 <= p1 by A834,MATRIX_1:39;
A840:   p2 <= width G by A834,MATRIX_1:39;
A841:   p1 <= len G by A834,MATRIX_1:39;
A842:   1 <= p2 by A834,MATRIX_1:39;
A843:   p = f/.m by A569,A579,FINSEQ_5:68;
        len g-'1 <= len g by NAT_D:44;
        then
A844:   len g-'1 in dom g by A828,FINSEQ_3:27;
        then
A845:   q = g/.(len g-'1) by A824,FINSEQ_5:69
          .= f/.l by A844,FINSEQ_5:30;
        l = m+(len g -'1)-'1 by A570,NAT_D:38
          .= (len g -'1)+m - 1 by A828,NAT_D:37
          .= (len g - 1)+m - 1 by A827,XREAL_0:def 2
          .= ((k - (m - 1)) - 1)+m - 1 by A580,A578,A825,XREAL_0:def 2
          .= k - 1;
        then
A846:   k = l+1;
        then
A847:   l < k by XREAL_1:31;
        len g-'1 <= l by NAT_1:11;
        then
A848:   1 <= l by A828,XXREAL_0:2;
        then
A849:   right_cell(f,l,G) meets C by A428,A580,A846;
A850:   m-'1+1 = m by A570,XREAL_1:237;
        then
A851:   1 <= m-'1 by A796,NAT_1:13;
        then
A852:   right_cell(f,m-'1,G) meets C by A428,A572,A850;
        m-'1 <= l by NAT_1:11;
        then m-'1 <= len(F.l) by A192;
        then
A853:   m-'1 in dom(F.l) by A851,FINSEQ_3:27;
        not a in L~g by A797,A851;
        then
A854:   not a in L~rg by SPPOL_2:22;
        per cases by A838;
        suppose
A855:     p1 = q1 & p2+1 = q2;
          consider a1,a2,p91,p92 being Element of NAT such that
A856:     [a1,a2] in Indices G and
A857:     a = G*(a1,a2) and
A858:     [p91,p92] in Indices G & p = G*(p91,p92) and
A859:     a1 = p91 & a2+1 = p92 or a1+1 = p91 & a2 = p92 or a1 =
p91+1 & a2 = p92 or a1 = p91 & a2 = p92+1 by A571,A572,A843,A850,A851,JORDAN8:6
;
A860:     1 <= a2 by A856,MATRIX_1:39;
          thus thesis
          proof
            per cases by A859;
            suppose
A861:         a1 = p91 & a2+1 = p92;
A862:         m-'1+1 <= len (F.m) & f/.(m-'1+1) = (F.m)/.m by A192,A580,A570
,A572,A792,A850;
A863:         F.k|(m+1)=F.(m+1) by A490,A580,A576;
A864:         a1 = p1 by A834,A835,A858,A861,GOBOARD1:21;
A865:         m-'1 <= m by A850,NAT_1:11;
A866:         f/.(m-'1) = (F.(m-'1))/.(m-'1) by A580,A577,A792,A851
                .= (F.m)/.(m-'1) by A792,A851,A865;
A867:         2 in dom g by A623,FINSEQ_3:27;
A868:         a2+1 = p2 by A834,A835,A858,A861,GOBOARD1:21;
              then
A869:         p2-'1 = a2 by NAT_D:34;
              right_cell(f,l,G) = cell(G,p1-'1,p2) by A428,A569,A580,A843,A846
,A848,A845,A834,A835,A836,A837,A855,GOBRD13:29
                .= front_left_cell(F.m,m-'1,G) by A428,A843,A850,A851,A834,A835
,A856,A857,A864,A868,A866,A862,GOBRD13:35;
              then F.(m+1) turns_left m-'1,G by A458,A796,A849;
              then
A870:         a2+1 > a2 & f turns_left m-'1,G by A851,A826,A863,GOBRD13:45
,NAT_1:13;
              len rg-'1+2 = len g +1 by A824,FINSEQ_5:def 3;
              then
A871:         rg/.(len rg-'1) = g/.2 by A867,FINSEQ_5:69
                .= f/.(m+1) by A826,A867,FINSEQ_5:30;
A872:         p = g/.1 by A569,A614,A579,FINSEQ_5:68
                .= rg/.len g by FINSEQ_5:68
                .= rg/.len rg by FINSEQ_5:def 3;
              set rc = right_cell(rg,len rg-'1,G)\L~rg;
A873:         RightComp rg is_a_component_of (L~rg)` by GOBOARD9:def 2;
A874:         p1-'1+1 = p1 by A839,XREAL_1:237;
A875:         p2+1 > a2+1 by A868,NAT_1:13;
              then
A876:         [p1-'1,p2] in Indices G by A843,A850,A834,A835,A856,A857,A870,
GOBRD13:def 7;
              then
A877:         1 <= p1-'1 by MATRIX_1:39;
              f/.(m+1) = G*(p1-'1,p2) by A843,A850,A826,A834,A835,A856,A857
,A875,A870,GOBRD13:def 7;
              then right_cell(rg,len rg-'1,G) = cell(G,p1-'1,a2) by A833,A831
,A832,A834,A835,A876,A869,A874,A871,A872,GOBRD13:25;
              then a in right_cell(rg,len rg-'1,G) by A841,A840,A857,A860,A864
,A868,A877,A874,Th22;
              then
A878:         a in rc by A854,XBOOLE_0:def 5;
              rc c= RightComp rg & L~rg c= L~f by A791,A833,A831,A832,Th29,
SPPOL_2:22;
              hence thesis by A572,A773,A850,A851,A854,A878,A873;
            end;
            suppose
A879:         a1+1 = p91 & a2 = p92;
              then a1+1 = p1 by A834,A835,A858,GOBOARD1:21;
              then
A880:         q1-'1 = a1 by A855,NAT_D:34;
              a2 = p2 by A834,A835,A858,A879,GOBOARD1:21;
              then right_cell(f,l,G) = cell(G,a1,a2) by A428,A569,A580,A843
,A846,A848,A845,A834,A835,A836,A837,A855,A880,GOBRD13:29
                .= left_cell(f,m-'1,G) by A428,A572,A843,A850,A851,A856,A857
,A858,A879,GOBRD13:24;
              hence thesis by A428,A572,A850,A851,A849;
            end;
            suppose
              a1 = p91+1 & a2 = p92;
              then a1 = p1+1 & a2 = p2 by A834,A835,A858,GOBOARD1:21;
              then right_cell(f,m-'1,G) = cell(G,p1,p2) by A428,A572,A843,A850
,A851,A834,A835,A856,A857,GOBRD13:27
                .= left_cell(f,l,G) by A428,A569,A580,A843,A846,A848,A845,A834
,A835,A836,A837,A855,GOBRD13:28;
              hence thesis by A428,A580,A846,A848,A852;
            end;
            suppose
              a1 = p91 & a2 = p92+1;
              then
A881:         a1 = q1 & a2 = q2 by A834,A835,A855,A858,GOBOARD1:21;
              (F.l)/.(m-'1) = (F.(m-'1))/.(m-'1) by A792,A851,NAT_1:11
                .= q by A580,A577,A792,A851,A837,A857,A881
                .= (F.l)/.l by A792,A847,A848,A845
                .= (F.l)/.len(F.l) by A192;
              hence thesis by A566,A847,A848,A853,A829;
            end;
          end;
        end;
        suppose
A882:     p1+1 = q1 & p2 = q2;
          consider a1,a2,p91,p92 being Element of NAT such that
A883:     [a1,a2] in Indices G and
A884:     a = G*(a1,a2) and
A885:     [p91,p92] in Indices G & p = G*(p91,p92) and
A886:     a1 = p91 & a2+1 = p92 or a1+1 = p91 & a2 = p92 or a1 =
p91+1 & a2 = p92 or a1 = p91 & a2 = p92+1 by A571,A572,A843,A850,A851,JORDAN8:6
;
A887:     1 <= a1 by A883,MATRIX_1:39;
          thus thesis
          proof
            per cases by A886;
            suppose
A888:         a1 = p91 & a2+1 = p92;
              then a2+1 = p2 by A834,A835,A885,GOBOARD1:21;
              then
A889:         q2-'1 = a2 by A882,NAT_D:34;
A890:         a1 = p1 by A834,A835,A885,A888,GOBOARD1:21;
              right_cell(f,m-'1,G) = cell(G,a1,a2) by A428,A572,A843,A850,A851
,A883,A884,A885,A888,GOBRD13:23
                .= left_cell(f,l,G) by A428,A569,A580,A843,A846,A848,A845,A834
,A835,A836,A837,A882,A890,A889,GOBRD13:26;
              hence thesis by A428,A580,A846,A848,A852;
            end;
            suppose
A891:         a1+1 = p91 & a2 = p92;
A892:         m-'1 <= m by A850,NAT_1:11;
A893:         f/.(m-'1) = (F.(m-'1))/.(m-'1) by A580,A577,A792,A851
                .= (F.m)/.(m-'1) by A792,A851,A892;
A894:         2 in dom g by A623,FINSEQ_3:27;
              len rg-'1+2 = len g +1 by A824,FINSEQ_5:def 3;
              then
A895:         rg/.(len rg-'1) = g/.2 by A894,FINSEQ_5:69
                .= f/.(m+1) by A826,A894,FINSEQ_5:30;
A896:         p = g/.1 by A569,A614,A579,FINSEQ_5:68
                .= rg/.len g by FINSEQ_5:68
                .= rg/.len rg by FINSEQ_5:def 3;
A897:         a2 = p2 by A834,A835,A885,A891,GOBOARD1:21;
A898:         m-'1+1 <= len (F.m) & f/.(m-'1+1) = (F.m)/.m by A192,A580,A570
,A572,A792,A850;
A899:         F.k|(m+1)=F.(m+1) by A490,A580,A576;
              set rc = right_cell(rg,len rg-'1,G)\L~rg;
A900:         a1 < a1+1 & p1 < p1+1 by XREAL_1:31;
A901:         a1+1 = p1 by A834,A835,A885,A891,GOBOARD1:21;
              then
A902:         a1 = p1-'1 by NAT_D:34;
              right_cell(f,l,G) = cell(G,p1,p2) by A428,A569,A580,A843,A846
,A848,A845,A834,A835,A836,A837,A882,GOBRD13:27
                .= front_left_cell(F.m,m-'1,G) by A428,A843,A850,A851,A834,A835
,A883,A884,A901,A897,A893,A898,GOBRD13:37;
              then F.(m+1) turns_left m-'1,G by A458,A796,A849;
              then
A903:         f turns_left m-'1,G by A851,A826,A899,GOBRD13:45;
              then
A904:         [p1,p2+1] in Indices G by A843,A850,A834,A835,A883,A884,A901,A900
,GOBRD13:def 7;
              then
A905:         p2+1 <= width G by MATRIX_1:39;
              f/.(m+1) = G*(p1,p2+1) by A843,A850,A826,A834,A835,A883,A884,A901
,A900,A903,GOBRD13:def 7;
              then right_cell(rg,len rg-'1,G) = cell(G,p1-'1,a2) by A833,A831
,A832,A834,A835,A897,A904,A895,A896,GOBRD13:29;
              then a in right_cell(rg,len rg-'1,G) by A841,A842,A884,A887,A901
,A897,A905,A902,Th22;
              then
A906:         a in rc by A854,XBOOLE_0:def 5;
A907:         RightComp rg is_a_component_of (L~rg)` by GOBOARD9:def 2;
              rc c= RightComp rg & L~rg c= L~f by A791,A833,A831,A832,Th29,
SPPOL_2:22;
              hence thesis by A572,A773,A850,A851,A854,A906,A907;
            end;
            suppose
              a1 = p91+1 & a2 = p92;
              then
A908:         a1 = q1 & a2 = q2 by A834,A835,A882,A885,GOBOARD1:21;
              (F.l)/.(m-'1) = (F.(m-'1))/.(m-'1) by A792,A851,NAT_1:11
                .= q by A580,A577,A792,A851,A837,A884,A908
                .= (F.l)/.l by A792,A847,A848,A845
                .= (F.l)/.len(F.l) by A192;
              hence thesis by A566,A847,A848,A853,A829;
            end;
            suppose
              a1 = p91 & a2 = p92+1;
              then
A909:         a1 = p1 & a2 = p2+1 by A834,A835,A885,GOBOARD1:21;
              right_cell(f,l,G) = cell(G,p1,p2) by A428,A569,A580,A843,A846
,A848,A845,A834,A835,A836,A837,A882,GOBRD13:27
                .= left_cell(f,m-'1,G) by A428,A572,A843,A850,A851,A834,A835
,A883,A884,A909,GOBRD13:28;
              hence thesis by A428,A572,A850,A851,A849;
            end;
          end;
        end;
        suppose
A910:     p1 = q1+1 & p2 = q2;
          consider a1,a2,p91,p92 being Element of NAT such that
A911:     [a1,a2] in Indices G and
A912:     a = G*(a1,a2) and
A913:     [p91,p92] in Indices G & p = G*(p91,p92) and
A914:     a1 = p91 & a2+1 = p92 or a1+1 = p91 & a2 = p92 or a1 =
p91+1 & a2 = p92 or a1 = p91 & a2 = p92+1 by A571,A572,A843,A850,A851,JORDAN8:6
;
A915:     a1 <= len G by A911,MATRIX_1:39;
          thus thesis
          proof
            per cases by A914;
            suppose
A916:         a1 = p91 & a2+1 = p92;
              then a2+1 = p2 by A834,A835,A913,GOBOARD1:21;
              then
A917:         q2-'1 = a2 by A910,NAT_D:34;
              a1 = p1 by A834,A835,A913,A916,GOBOARD1:21;
              then
A918:         q1 = a1-'1 by A910,NAT_D:34;
              right_cell(f,l,G) = cell(G,q1,q2-'1) by A428,A569,A580,A843,A846
,A848,A845,A834,A835,A836,A837,A910,GOBRD13:25
                .= left_cell(f,m-'1,G) by A428,A572,A843,A850,A851,A911,A912
,A913,A916,A918,A917,GOBRD13:22;
              hence thesis by A428,A572,A850,A851,A849;
            end;
            suppose
              a1+1 = p91 & a2 = p92;
              then
A919:         a1+1 = p1 & a2 = p2 by A834,A835,A913,GOBOARD1:21;
              (F.l)/.(m-'1) = (F.(m-'1))/.(m-'1) by A792,A851,NAT_1:11
                .= q by A580,A577,A792,A851,A837,A910,A912,A919
                .= (F.l)/.l by A792,A847,A848,A845
                .= (F.l)/.len(F.l) by A192;
              hence thesis by A566,A847,A848,A853,A829;
            end;
            suppose
A920:         a1 = p91+1 & a2 = p92;
A921:         p = g/.1 by A569,A614,A579,FINSEQ_5:68
                .= rg/.len g by FINSEQ_5:68
                .= rg/.len rg by FINSEQ_5:def 3;
A922:         a1 = p1+1 by A834,A835,A913,A920,GOBOARD1:21;
              p1+1>p1 by XREAL_1:31;
              then
A923:         a1+1 > p1 by A922,NAT_1:13;
A924:         m-'1 <= m by A850,NAT_1:11;
A925:         f/.(m-'1) = (F.(m-'1))/.(m-'1) by A580,A577,A792,A851
                .= (F.m)/.(m-'1) by A792,A851,A924;
A926:         2 in dom g by A623,FINSEQ_3:27;
              len rg-'1+2 = len g +1 by A824,FINSEQ_5:def 3;
              then
A927:         rg/.(len rg-'1) = g/.2 by A926,FINSEQ_5:69
                .= f/.(m+1) by A826,A926,FINSEQ_5:30;
A928:         F.k|(m+1)=F.(m+1) by A490,A580,A576;
              set rc = right_cell(rg,len rg-'1,G)\L~rg;
A929:         RightComp rg is_a_component_of (L~rg)` by GOBOARD9:def 2;
A930:         p2-'1+1 = p2 by A842,XREAL_1:237;
A931:         f/.(m-'1+1) = (F.m)/.m by A580,A570,A572,A792,A850;
A932:         p1-'1 = q1 & m-'1+1 <= len (F.m) by A192,A850,A910,NAT_D:34;
A933:         a2 = p2 by A834,A835,A913,A920,GOBOARD1:21;
              right_cell(f,l,G) = cell(G,q1,q2-'1) by A428,A569,A580,A843,A846
,A848,A845,A834,A835,A836,A837,A910,GOBRD13:25
                .= front_left_cell(F.m,m-'1,G) by A428,A843,A850,A851,A834,A835
,A910,A911,A912,A922,A933,A932,A925,A931,GOBRD13:39;
              then F.(m+1) turns_left m-'1,G by A458,A796,A849;
              then
A934:         f turns_left m-'1,G by A851,A826,A928,GOBRD13:45;
A935:         a2+1 > p2 by A933,NAT_1:13;
              then
A936:         [p1,p2-'1] in Indices G by A843,A850,A834,A835,A911,A912,A933
,A923,A934,GOBRD13:def 7;
              then
A937:         1 <= p2-'1 by MATRIX_1:39;
              f/.(m+1) = G*(p1,p2-'1) by A843,A850,A826,A834,A835,A911,A912
,A933,A935,A923,A934,GOBRD13:def 7;
              then right_cell(rg,len rg-'1,G) = cell(G,p1,p2-'1) by A833,A831
,A832,A834,A835,A936,A930,A927,A921,GOBRD13:23;
              then a in right_cell(rg,len rg-'1,G) by A839,A840,A912,A915,A922
,A933,A937,A930,Th22;
              then
A938:         a in rc by A854,XBOOLE_0:def 5;
              rc c= RightComp rg & L~rg c= L~f by A791,A833,A831,A832,Th29,
SPPOL_2:22;
              hence thesis by A572,A773,A850,A851,A854,A938,A929;
            end;
            suppose
A939:         a1 = p91 & a2 = p92+1;
              then a1 = p1 by A834,A835,A913,GOBOARD1:21;
              then
A940:         q1 = a1-'1 by A910,NAT_D:34;
              a2 = p2+1 by A834,A835,A913,A939,GOBOARD1:21;
              then right_cell(f,m-'1,G) = cell(G,q1,q2) by A428,A572,A843,A850
,A851,A910,A911,A912,A913,A939,A940,GOBRD13:29
                .= left_cell(f,l,G) by A428,A569,A580,A843,A846,A848,A845,A834
,A835,A836,A837,A910,GOBRD13:24;
              hence thesis by A428,A580,A846,A848,A852;
            end;
          end;
        end;
        suppose
A941:     p1 = q1 & p2 = q2+1;
          consider a1,a2,p91,p92 being Element of NAT such that
A942:     [a1,a2] in Indices G and
A943:     a = G*(a1,a2) and
A944:     [p91,p92] in Indices G & p = G*(p91,p92) and
A945:     a1 = p91 & a2+1 = p92 or a1+1 = p91 & a2 = p92 or a1 =
p91+1 & a2 = p92 or a1 = p91 & a2 = p92+1 by A571,A572,A843,A850,A851,JORDAN8:6
;
A946:     a2 <= width G by A942,MATRIX_1:39;
          thus thesis
          proof
            per cases by A945;
            suppose
              a1 = p91 & a2+1 = p92;
              then
A947:         a1 = p1 & a2+1 = p2 by A834,A835,A944,GOBOARD1:21;
              (F.l)/.(m-'1) = (F.(m-'1))/.(m-'1) by A792,A851,NAT_1:11
                .= q by A580,A577,A792,A851,A837,A941,A943,A947
                .= (F.l)/.l by A792,A847,A848,A845
                .= (F.l)/.len(F.l) by A192;
              hence thesis by A566,A847,A848,A853,A829;
            end;
            suppose
A948:         a1+1 = p91 & a2 = p92;
              then a2 = p2 by A834,A835,A944,GOBOARD1:21;
              then
A949:         a2-'1 = q2 by A941,NAT_D:34;
              a1+1 = p1 by A834,A835,A944,A948,GOBOARD1:21;
              then
A950:         a1 = q1-'1 by A941,NAT_D:34;
              right_cell(f,m-'1,G) = cell(G,a1,a2-'1) by A428,A572,A843,A850
,A851,A942,A943,A944,A948,GOBRD13:25
                .= left_cell(f,l,G) by A428,A569,A580,A843,A846,A848,A845,A834
,A835,A836,A837,A941,A950,A949,GOBRD13:22;
              hence thesis by A428,A580,A846,A848,A852;
            end;
            suppose
A951:         a1 = p91+1 & a2 = p92;
              then a2 = p2 by A834,A835,A944,GOBOARD1:21;
              then
A952:         a2-'1 = q2 by A941,NAT_D:34;
A953:         a1 = p1+1 by A834,A835,A944,A951,GOBOARD1:21;
              right_cell(f,l,G) = cell(G,q1,q2) by A428,A569,A580,A843,A846
,A848,A845,A834,A835,A836,A837,A941,GOBRD13:23
                .= left_cell(f,m-'1,G) by A428,A572,A843,A850,A851,A941,A942
,A943,A944,A951,A953,A952,GOBRD13:26;
              hence thesis by A428,A572,A850,A851,A849;
            end;
            suppose
A954:         a1 = p91 & a2 = p92+1;
              set rc = right_cell(rg,len rg-'1,G)\L~rg;
A955:         RightComp rg is_a_component_of (L~rg)` by GOBOARD9:def 2;
A956:         2 in dom g by A623,FINSEQ_3:27;
              len rg-'1+2 = len g +1 by A824,FINSEQ_5:def 3;
              then
A957:         rg/.(len rg-'1) = g/.2 by A956,FINSEQ_5:69
                .= f/.(m+1) by A826,A956,FINSEQ_5:30;
A958:         p = g/.1 by A569,A614,A579,FINSEQ_5:68
                .= rg/.len g by FINSEQ_5:68
                .= rg/.len rg by FINSEQ_5:def 3;
A959:         a1 = p1 by A834,A835,A944,A954,GOBOARD1:21;
A960:         m-'1 <= m by A850,NAT_1:11;
A961:         f/.(m-'1) = (F.(m-'1))/.(m-'1) by A580,A577,A792,A851
                .= (F.m)/.(m-'1) by A792,A851,A960;
A962:         p2-'1 = q2 & m-'1+1 <= len (F.m) by A192,A850,A941,NAT_D:34;
A963:         f/.(m-'1+1) = (F.m)/.m by A580,A570,A572,A792,A850;
A964:         F.k|(m+1)=F.(m+1) by A490,A580,A576;
A965:         a2 = p2+1 by A834,A835,A944,A954,GOBOARD1:21;
              right_cell(f,l,G) = cell(G,q1,q2) by A428,A569,A580,A843,A846
,A848,A845,A834,A835,A836,A837,A941,GOBRD13:23
                .= front_left_cell(F.m,m-'1,G) by A428,A843,A850,A851,A834,A835
,A941,A942,A943,A959,A965,A962,A961,A963,GOBRD13:41;
              then F.(m+1) turns_left m-'1,G by A458,A796,A849;
              then
A966:         p2+1>p2 & f turns_left m-'1,G by A851,A826,A964,GOBRD13:45
,NAT_1:13;
A967:         a2+1>p2+1 by A965,NAT_1:13;
              then
A968:         [p1+1,p2] in Indices G by A843,A850,A834,A835,A942,A943,A966,
GOBRD13:def 7;
              then
A969:         p1+1 <= len G by MATRIX_1:39;
              f/.(m+1) = G*(p1+1,p2) by A843,A850,A826,A834,A835,A942,A943,A967
,A966,GOBRD13:def 7;
              then right_cell(rg,len rg-'1,G) = cell(G,p1,p2) by A833,A831,A832
,A834,A835,A968,A957,A958,GOBRD13:27;
              then a in right_cell(rg,len rg-'1,G) by A839,A842,A943,A946,A959
,A965,A969,Th22;
              then
A970:         a in rc by A854,XBOOLE_0:def 5;
              rc c= RightComp rg & L~rg c= L~f by A791,A833,A831,A832,Th29,
SPPOL_2:22;
              hence thesis by A572,A773,A850,A851,A854,A970,A955;
            end;
          end;
        end;
      end;
      then
A971: LeftComp g is_a_component_of (L~g)` & C meets LeftComp g by GOBOARD9:27
,def 1;
      reconsider Lg9 = (L~g)` as Subset of TOP-REAL 2;
A972: RightComp g is_a_component_of (L~g)` by GOBOARD9:def 2;
A973: C c= Lg9
      proof
        let c be set;
        assume that
A974:   c in C and
A975:   not c in Lg9;
        reconsider c as Point of TOP-REAL 2 by A974;
        consider i such that
A976:   1 <= i and
A977:   i+1 <= len g and
A978:   c in LSeg(g/.i,g/.(i+1)) by A975,SPPOL_2:14,SUBSET_1:50;
A979:   1 <= i+(m-'1) by A976,NAT_1:12;
        i+1 in dom g by A976,A977,SEQ_4:151;
        then
A980:   g/.(i+1) = f/.(i+1+(m-'1)) by FINSEQ_5:30;
        i+1+(m-'1) = i+(m-'1)+1;
        then
A981:   i+(m-'1)+1 <= (len g)+(m-'1) by A977,XREAL_1:8;
        i in dom g by A976,A977,SEQ_4:151;
        then g/.i = f/.(i+(m-'1)) by FINSEQ_5:30;
        then c in LSeg(f,i+(m-'1)) by A578,A978,A980,A979,A981,TOPREAL1:def 5;
        then c in left_cell(f,i+(m-'1),G) /\ right_cell(f,i+(m-'1),G) by A428
,A578,A979,A981,GOBRD13:30;
        then c in left_cell(f,i+(m-'1),G) by XBOOLE_0:def 4;
        then left_cell(f,i+(m-'1),G) meets C by A974,XBOOLE_0:3;
        hence contradiction by A428,A578,A979,A981;
      end;
A982: the TopStruct of TOP-REAL 2 = TopSpaceMetr (Euclid 2) by EUCLID:def 8;
      C meets RightComp g
      proof
        right_cell(f,m,G) meets C by A428,A570,A576;
        then consider p being set such that
A983:   p in right_cell(f,m,G) and
A984:   p in C by XBOOLE_0:3;
        reconsider p as Element of TOP-REAL 2 by A983;
        now
          reconsider u = p as Element of Euclid 2 by TOPREAL3:13;
          take a = p;
          thus a in C by A984;
          consider r being real number such that
A985:     r > 0 and
A986:     Ball(u,r) c= (L~g)` by A973,A790,A984,GOBOARD6:8;
          reconsider r as Real by XREAL_0:def 1;
A987:     p in Ball(u,r) by A985,GOBOARD6:4;
          reconsider B = Ball(u,r) as non empty Subset of TOP-REAL 2 by A982
,A985,GOBOARD6:4,TOPMETR:16;
A988:     p in B by A985,GOBOARD6:4;
          right_cell(f,m,G) = Cl Int right_cell(f,m,G) & B is open by A570,A576
,A756,GOBOARD6:6;
          then
A989:     Int right_cell(f,m,G) meets B by A983,A987,TOPS_1:39;
          Int right_cell(g,1,G) c= Int right_cell(g,1) & Int right_cell
          (g,1) c= RightComp g by A625,A624,GOBOARD9:28,GOBRD13:34,TOPS_1:48;
          then Int right_cell(g,1,G) c= RightComp g by XBOOLE_1:1;
          then Int right_cell(f,m-'1+1,G) c= RightComp g by A571,A577,A624,
GOBRD13:33;
          then B is connected & Int right_cell(f,m,G) c= RightComp g by A570,
SPRECT_3:17,XREAL_1:237;
          then B c= RightComp g by A972,A986,A989,GOBOARD9:6;
          hence a in RightComp g by A988;
        end;
        hence thesis by XBOOLE_0:3;
      end;
      hence contradiction by A1,A972,A973,A971,Th3,SPRECT_4:7;
    end;
    then g = f/^0 by XREAL_1:234
      .= f by FINSEQ_5:31;
    then reconsider f as standard non constant special_circular_sequence;
    f is clockwise_oriented
    proof
      f/.2 in LSeg(f/.1,f/.(1+1)) by RLTOPSP1:69;
      then
A990: f/.2 in L~f by A574,SPPOL_2:15;
      (NW-corner L~f)`1 = W-bound L~f by EUCLID:56;
      then
A991: (NW-corner L~f)`1 <= (f/.2)`1 by A990,PSCOMP_1:71;
      len G >= 3 by A231,NAT_1:12;
      then
A992: 1 < len G by XXREAL_0:2;
      (NE-corner L~f)`1 = E-bound L~f by EUCLID:56;
      then
A993: (f/.2)`1 <= (NE-corner L~f)`1 by A990,PSCOMP_1:71;
      for k st 1 <= k & k+1 <= len f holds left_cell(f,k,G) misses C &
      right_cell(f,k,G) meets C by A428;
      then
A994: N-min L~f = f/.1 by A571,A608,Th32;
      consider i such that
A995: 1 <= i and
A996: i+1 <= len G and
A997: f/.1 = G*(i,width G) & f/.2 = G*(i+1,width G) and
      N-min C in cell(G,i,width G-'1) and
      N-min C <> G*(i,width G-'1) by A608;
      i < len G by A996,NAT_1:13;
      then
A998: (N-min L~f)`2 = N-bound L~f & G*(i,width G)`2 = G*(1,width G)`2
      by A2,A992,A995,EUCLID:56,GOBOARD5:2;
      1 <= i+1 by NAT_1:12;
      then
A999: G*(i+1,width G)`2 = G*(1,width G)`2 by A2,A992,A996,GOBOARD5:2;
      (NW-corner L~f)`2 = (NE-corner L~f)`2 & (NE-corner L~f)`2 =
      N-bound L~f by EUCLID:56,PSCOMP_1:82;
      then f/.2 in LSeg(NW-corner L~f, NE-corner L~f) by A994,A997,A998,A999
,A991,A993,GOBOARD7:9;
      then f/.2 in LSeg(NW-corner L~f, NE-corner L~f) /\ L~f by A990,
XBOOLE_0:def 4;
      hence thesis by A994,SPRECT_2:34;
    end;
    then reconsider f as clockwise_oriented (standard non constant
    special_circular_sequence);
    take f;
    thus f is_sequence_on G by A428;
    thus ex i st 1 <= i & i+1 <= len G & f/.1 = G*(i,width G) & f/.2 = G*(i+1,
    width G) & N-min C in cell(G,i,width G-'1) & N-min C <> G*(i,width G-'1)
by A608;
    let m such that
A1000: 1 <= m and
A1001: m+2 <= len f;
A1002: F.(m+1+1) = f|(m+1+1) by A490,A580,A1001;
A1003: m+1 < m+2 by XREAL_1:8;
    then
A1004: f|(m+1) = F.(m+1) by A490,A580,A1001,XXREAL_0:2;
A1005: m+1 <= len f by A1001,A1003,XXREAL_0:2;
    then
A1006: front_left_cell(F.(m+1),m,G) = front_left_cell(f,m,G) by A571,A1000
,A1004,GOBRD13:43;
A1007: m = m+1-'1 & m+1 > 1 by A1000,NAT_1:13,NAT_D:34;
A1008: front_right_cell(F.(m+1),m,G) = front_right_cell(f,m,G) by A571,A1000
,A1005,A1004,GOBRD13:43;
    hereby
      assume
      front_left_cell(f,m,G) misses C & front_right_cell(f,m,G)
      misses C;
      then F.(m+1+1) turns_right m,G by A458,A1007,A1006,A1008;
      hence f turns_right m,G by A1000,A1001,A1002,GOBRD13:44;
    end;
    hereby
      assume
      front_left_cell(f,m,G) misses C & front_right_cell(f,m,G)
      meets C;
      then F.(m+1+1) goes_straight m,G by A458,A1007,A1006,A1008;
      hence f goes_straight m,G by A1000,A1001,A1002,GOBRD13:46;
    end;
    assume
    front_left_cell(f,m,G) meets C;
    then F.(m+1+1) turns_left m,G by A458,A1007,A1006;
    hence thesis by A1000,A1001,A1002,GOBRD13:45;
  end;
  uniqueness
  proof
    let f1,f2 be clockwise_oriented (standard non constant
    special_circular_sequence) such that
A1009: f1 is_sequence_on Gauge(C,n);
    defpred P[Element of NAT] means f1|$1 = f2|$1;
    given i1 such that
A1010: 1 <= i1 & i1+1 <= len Gauge(C,n) and
A1011: f1/.1 = Gauge(C,n)*(i1,width Gauge(C,n)) and
A1012: f1/.2 = Gauge(C,n)*(i1+1,width Gauge(C,n)) and
A1013: N-min C in cell(Gauge(C,n),i1,width Gauge(C,n)-'1) & N-min C <>
    Gauge(C,n)*( i1,width Gauge(C,n)-'1);
    assume that
A1014: for k st 1 <= k & k+2 <= len f1 holds (front_left_cell(f1,k,
Gauge(C,n)) misses C & front_right_cell(f1,k,Gauge(C,n)) misses C implies f1
    turns_right k,Gauge(C,n)) & (front_left_cell(f1,k,Gauge(C,n)) misses C &
front_right_cell(f1,k,Gauge(C,n)) meets C implies f1 goes_straight k,Gauge(C,n)
) & (front_left_cell(f1,k,Gauge(C,n)) meets C implies f1 turns_left k,Gauge(C,n
    )) and
A1015: f2 is_sequence_on Gauge(C,n);
    given i2 such that
A1016: 1 <= i2 & i2+1 <= len Gauge(C,n) and
A1017: f2/.1 = Gauge(C,n)*(i2,width Gauge(C,n)) and
A1018: f2/.2 = Gauge(C,n)*(i2+1,width Gauge(C,n)) and
A1019: N-min C in cell(Gauge(C,n),i2,width Gauge(C,n)-'1) & N-min C <>
    Gauge(C,n)*( i2,width Gauge(C,n)-'1);
    assume
A1020: for k st 1 <= k & k+2 <= len f2 holds (front_left_cell(f2,k,
Gauge(C,n)) misses C & front_right_cell(f2,k,Gauge(C,n)) misses C implies f2
    turns_right k,Gauge(C,n)) & (front_left_cell(f2,k,Gauge(C,n)) misses C &
front_right_cell(f2,k,Gauge(C,n)) meets C implies f2 goes_straight k,Gauge(C,n)
) & (front_left_cell(f2,k,Gauge(C,n)) meets C implies f2 turns_left k,Gauge(C,n
    ));
A1021: for k st P[k] holds P[k+1]
    proof
A1022: len f1 > 4 by GOBOARD7:36;
A1023: f1|1 = <*f1/.1*> & f2|1 = <*f2/.1*> by FINSEQ_5:23;
A1024: i1 = i2 & len f2 > 4 by A1010,A1013,A1016,A1019,Th31,GOBOARD7:36;
      let k such that
A1025: f1|k = f2|k;
      per cases by NAT_1:26;
      suppose
        k = 0;
        hence thesis by A1010,A1011,A1013,A1016,A1017,A1019,A1023,Th31;
      end;
      suppose
A1026:  k = 1;
        f1|2 = <*f1/.1,f1/.2*> by A1022,FINSEQ_5:84,XXREAL_0:2;
        hence thesis by A1011,A1012,A1017,A1018,A1024,A1026,FINSEQ_5:84
,XXREAL_0:2;
      end;
      suppose
A1027:  k > 1;
A1028:  f1/.1 = f1/.len f1 & f2/.1 = f2/.len f2 by FINSEQ_6:def 1;
        now
          per cases;
          suppose
A1029:      len f1 > k;
            set m = k-'1;
A1030:      1 <= m by A1027,NAT_D:49;
            then
A1031:      m+1 = k by NAT_D:43;
            then
A1032:      front_left_cell (f1,m,Gauge(C,n))= front_left_cell(f1|k,m,
            Gauge(C,n)) by A1009,A1029,A1030,GOBRD13:43;
A1033:      m+(1+1) = k+1 by A1031;
A1034:      k+1 <= len f1 by A1029,NAT_1:13;
A1035:      now
A1036:        1 < len f2 by GOBOARD7:36,XXREAL_0:2;
              assume
A1037:        len f2 <= k;
              then
A1038:        f2 = f2|k by FINSEQ_1:79;
              then len f2 in dom(f2|k) by FINSEQ_5:6;
              then
A1039:        (f1|k)/.len f2 = f1/.len f2 by A1025,FINSEQ_4:85;
              1 in dom(f2|k) & len f2 <= len f1 by A1025,A1038,FINSEQ_5:6,18;
              hence
              contradiction by A1025,A1028,A1029,A1037,A1038,A1039,A1036,
FINSEQ_4:85,GOBOARD7:40;
            end;
            then
A1040:      k+1 <= len f2 by NAT_1:13;
A1041:      front_right_cell(f2,m,Gauge(C,n)) = front_right_cell(f2|k,m
            ,Gauge(C,n)) by A1015,A1030,A1031,A1035,GOBRD13:43;
A1042:      front_left_cell(f2,m,Gauge(C,n)) = front_left_cell(f2|k,m,
            Gauge(C,n)) by A1015,A1030,A1031,A1035,GOBRD13:43;
A1043:      front_right_cell(f1,m,Gauge(C,n)) = front_right_cell(f1|k,m
            ,Gauge(C,n)) by A1009,A1029,A1030,A1031,GOBRD13:43;
            now
              per cases;
              suppose
                front_left_cell(f1,m,Gauge(C,n)) misses C &
                front_right_cell(f1,m,Gauge(C,n)) misses C;
                then f1 turns_right m,Gauge(C,n) & f2 turns_right m,Gauge(C,
n) by A1014,A1020,A1025,A1030,A1040,A1034,A1032,A1043,A1042,A1041,A1033;
                hence thesis by A1015,A1025,A1027,A1040,A1034,GOBRD13:47;
              end;
              suppose
                front_left_cell(f1,m,Gauge(C,n)) misses C &
                front_right_cell(f1,m,Gauge(C,n)) meets C;
                then f1 goes_straight m,Gauge(C,n) & f2 goes_straight m,
Gauge(C,n) by A1014,A1020,A1025,A1030,A1040,A1034,A1032,A1043,A1042,A1041,A1033
;
                hence thesis by A1015,A1025,A1027,A1040,A1034,GOBRD13:49;
              end;
              suppose
                front_left_cell(f1,m,Gauge(C,n)) meets C;
                then f1 turns_left m,Gauge(C,n) & f2 turns_left m,Gauge(C,n)
                by A1014,A1020,A1025,A1030,A1040,A1034,A1032,A1042,A1033;
                hence thesis by A1015,A1025,A1027,A1040,A1034,GOBRD13:48;
              end;
            end;
            hence thesis;
          end;
          suppose
A1044:      k >= len f1;
A1045:      1 < len f1 by GOBOARD7:36,XXREAL_0:2;
A1046:      f1 = f1|k by A1044,FINSEQ_1:79;
            then len f1 in dom(f1|k) by FINSEQ_5:6;
            then
A1047:      (f2|k)/.len f1 = f2/.len f1 by A1025,FINSEQ_4:85;
            1 in dom(f1|k) & len f1 <= len f2 by A1025,A1046,FINSEQ_5:6,18;
            then
A1048:      len f2 = len f1 by A1025,A1028,A1046,A1047,A1045,FINSEQ_4:85
,GOBOARD7:40;
A1049:      k+1 > len f1 by A1044,NAT_1:13;
            hence f1|(k+1) = f1 by FINSEQ_1:79
              .= f2 by A1025,A1044,A1046,A1048,FINSEQ_1:79
              .= f2|(k+1) by A1048,A1049,FINSEQ_1:79;
          end;
        end;
        hence thesis;
      end;
    end;
A1050: P[0];
    for k holds P[k] from NAT_1:sch 1(A1050,A1021);
    hence thesis by Th4;
  end;
end;

theorem Th33:
  C is connected & 1 <= k & k+1 <= len Cage(C,n) implies left_cell
(Cage(C,n),k,Gauge(C,n)) misses C & right_cell(Cage(C,n),k,Gauge(C,n)) meets C
proof
  set G = Gauge(C,n), f = Cage(C,n);
  set W = W-bound C, E = E-bound C, S = S-bound C, N = N-bound C;
  defpred P[Element of NAT] means for m st 1 <= m & m+1 <= len(f|$1) holds
  left_cell(f|$1,m,G) misses C & right_cell(f|$1,m,G) meets C;
A1: len G = width G by JORDAN8:def 1;
  assume
A2: C is connected;
  then
A3: f is_sequence_on G by Def1;
A4: len G = 2|^n+3 by JORDAN8:def 1;
A5: for k st P[k] holds P[k+1]
  proof
    let k such that
A6: for m st 1 <= m & m+1 <= len(f|k) holds left_cell(f|k,m,G) misses
    C & right_cell(f|k,m,G) meets C;
    per cases;
    suppose
      k >= len f;
      then f|k = f & f|(k+1) = f by FINSEQ_1:79,NAT_1:12;
      hence thesis by A6;
    end;
    suppose
A7:   k < len f;
      then
A8:   len(f|k) = k by FINSEQ_1:80;
A9:   1 <= len G by A4,NAT_1:12;
A10:  f|k is_sequence_on G by A3,GOBOARD1:38;
A11:  f|(k+1) is_sequence_on G by A3,GOBOARD1:38;
      consider i such that
A12:  1 <= i and
A13:  i+1 <= len G and
A14:  f/.1 = G*(i,width G) & f/.2 = G*(i+1,width G) and
A15:  N-min C in cell(G,i,width G-'1) and
      N-min C <> G*(i,width G-'1) by A2,Def1;
      let m such that
A16:  1 <= m and
A17:  m+1 <= len(f|(k+1));
A18:  k+1 <= len f by A7,NAT_1:13;
      then
A19:  len(f|(k+1)) = k+1 by FINSEQ_1:80;
A20:  2|^n >= n+1 by NEWTON:104;
      now
        per cases by NAT_1:26;
        suppose
A21:      k = 0;
          1 <= m+1 by NAT_1:12;
          then m+1 = 0+1 by A19,A17,A21,XXREAL_0:1;
          hence thesis by A16;
        end;
        suppose
A22:      k = 1;
          1+1 <= m+1 by A16,XREAL_1:8;
          then
A23:      m+1 = 1+1 by A19,A17,A22,XXREAL_0:1;
          f|(k+1) = <*G*(i,width G),G*(i+1,width G)*> by A18,A14,A22,
FINSEQ_5:84;
          then
A24:      (f|(k+1))/.1 = G*(i,width G) & (f|(k+1))/.2 = G*(i+1, width G)
          by FINSEQ_4:26;
          1 <= i+1 by A12,NAT_1:13;
          then
A25:      [i+1,len G] in Indices G by A1,A13,A9,MATRIX_1:37;
A26:      i < len G by A13,NAT_1:13;
          then
A27:      [i,len G] in Indices G by A1,A12,A9,MATRIX_1:37;
A28:      i < i+1 & i+1 < (i+1)+1 by NAT_1:13;
          then
A29:      left_cell(f|(k+1),m,G) = cell(G,i,len G) by A1,A11,A17,A24,A27,A25
,A23,GOBRD13:def 3;
          now
            N > S by JORDAN8:12;
            then N-S > S-S by XREAL_1:11;
            then (N-S)/(2|^n) > 0 by A20,XREAL_1:141;
            then
A30:        N+0 < N+(N-S)/(2|^n) by XREAL_1:8;
            assume
            left_cell(f|(k+1),m,G) meets C;
            then consider p being set such that
A31:        p in cell(G,i,len G) and
A32:        p in C by A29,XBOOLE_0:3;
            reconsider p as Element of TOP-REAL 2 by A31;
A33:        p`2 <= N by A32,PSCOMP_1:71;
            [1,len G] in Indices G by A1,A9,MATRIX_1:37;
            then G*(1,len G) = |[W+((E-W)/(2|^n))*(1-2),S+((N-S)/(2 |^n))*((
            len G)- 2)]| by JORDAN8:def 1;
            then
A34:        G*(1,len G)`2 = S+((N-S)/(2|^n))*((len G)-2) by EUCLID:56;
            cell(G,i,len G) = { |[r,s]|: G*(i,1)`1 <= r & r <= G*(i+1,1)
            `1 & G*(1,len G)`2 <= s } by A1,A12,A26,GOBRD11:31;
            then consider r,s such that
A35:        p = |[r,s]| and
            G*(i,1)`1 <= r and
            r <= G*(i+1,1)`1 and
A36:        G*(1,len G)`2 <= s by A31;
            ((N-S)/(2|^n))*((len G)-2) = ((N-S)/(2|^n))*(2|^n)+((N-S)/(2
            |^n))*1 by A4
              .= (N-S)+(N-S)/(2|^n) by A20,XCMPLX_1:88;
            then N < s by A36,A34,A30,XXREAL_0:2;
            hence contradiction by A35,A33,EUCLID:56;
          end;
          hence left_cell(f|(k+1),m,G) misses C;
          N-min C in C & N-min C in right_cell(f|(k+1),m,G) by A1,A11,A15,A17
,A24,A27,A25,A23,A28,GOBRD13:def 2,SPRECT_1:13;
          hence right_cell(f|(k+1),m,G) meets C by XBOOLE_0:3;
        end;
        suppose
A37:      k > 1;
          then
A38:      (len(f|k)) -'1 +1 = len(f|k) by A8,XREAL_1:237;
A39:      1 <= (len(f|k))-'1 by A8,A37,NAT_D:49;
          now
            per cases;
            suppose
A40:          m+1 = len(f|(k+1));
A41:          len(f|k) <= len f by FINSEQ_5:18;
              now
                left_cell(f|k,(len(f|k))-'1,G) misses C by A6,A39,A38;
                then
A42:            left_cell(f,(len(f|k))-'1,G) misses C by A3,A8,A39,A38,A41,
GOBRD13:32;
A43:            (len(f|k))-'1+(1+1) = (len(f|k))+1 by A38;
                right_cell(f|k,(len(f|k))-'1,G) meets C by A6,A39,A38;
                then
A44:            right_cell(f,(len(f|k))-'1,G) meets C by A3,A8,A39,A38,A41,
GOBRD13:32;
                consider i1,j1,i2,j2 being Element of NAT such that
A45:            [i1,j1] in Indices G & f/.((len(f|k)) -'1) = G*(i1,j1
                ) and
A46:            [i2,j2] in Indices G and
A47:            f/.len(f|k) = G*(i2,j2) and
                i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or i1 = i2+1 &
                j1 = j2 or i1 = i2 & j1 = j2+1 by A3,A7,A8,A39,A38,JORDAN8:6;
                1 <= i2 by A46,MATRIX_1:39;
                then
A48:            (i2-'1)+1 = i2 by XREAL_1:237;
                1 <= j2 by A46,MATRIX_1:39;
                then
A49:            (j2-'1)+1 = j2 by XREAL_1:237;
                per cases;
                suppose
A50:              front_left_cell(f,(len(f|k))-'1,G) misses C &
                  front_right_cell(f,(len(f|k))-'1,G) misses C;
                  then
A51:              f turns_right (len(f|k))-'1,G by A2,A18,A8,A39,A43,Def1;
                  now
                    per cases by A38,A45,A46,A47,A43,A51,GOBRD13:def 6;
                    suppose that
A52:                  i1 = i2 & j1+1 = j2 and
A53:                  [i2+1,j2] in Indices G & f/.((len(f|k))+1) = G*
                      (i2+1,j2);
                      front_right_cell(f,(len(f|k))-'1,G) = cell(G,i1,j2)
                      by A3,A39,A38,A41,A45,A46,A47,A52,GOBRD13:36;
                      then
                      left_cell(f,m,G) misses C by A3,A18,A8,A19,A16,A40,A46
,A47,A50,A52,A53,GOBRD13:24;
                      hence left_cell(f|(k+1),m,G) misses C by A3,A18,A19,A16
,A40,GOBRD13:32;
                      j2-'1 = j1 & cell(G,i1,j1) meets C by A3,A39,A38,A41,A45
,A46,A47,A44,A52,GOBRD13:23,NAT_D:34;
                      then
                      right_cell(f,m,G) meets C by A3,A18,A8,A19,A16,A40,A46
,A47,A52,A53,GOBRD13:25;
                      hence right_cell(f|(k+1),m,G) meets C by A3,A18,A19,A16
,A40,GOBRD13:32;
                    end;
                    suppose that
A54:                  i1+1 = i2 & j1 = j2 and
A55:                  [i2,j2-'1] in Indices G & f/.((len(f|k))+1) = G
                      *(i2,j2-'1);
                      front_right_cell(f,(len(f|k))-'1,G) = cell(G,i2,j2
                      -'1) by A3,A39,A38,A41,A45,A46,A47,A54,GOBRD13:38;
                      then
                      left_cell(f,m,G) misses C by A3,A18,A8,A19,A16,A40,A46
,A47,A49,A50,A55,GOBRD13:28;
                      hence left_cell(f|(k+1),m,G) misses C by A3,A18,A19,A16
,A40,GOBRD13:32;
                      i2-'1 = i1 & cell(G,i1,j1-'1) meets C by A3,A39,A38,A41
,A45,A46,A47,A44,A54,GOBRD13:25,NAT_D:34;
                      then
                      right_cell(f,m,G) meets C by A3,A18,A8,A19,A16,A40,A46
,A47,A49,A54,A55,GOBRD13:29;
                      hence right_cell(f|(k+1),m,G) meets C by A3,A18,A19,A16
,A40,GOBRD13:32;
                    end;
                    suppose that
A56:                  i1 = i2+1 & j1 = j2 and
A57:                  [i2,j2+1] in Indices G & f/.((len(f|k))+1) = G*
                      (i2,j2+1);
                      front_right_cell(f,(len(f|k))-'1,G) = cell(G,i2-'1,
                      j2) by A3,A39,A38,A41,A45,A46,A47,A56,GOBRD13:40;
                      then
                      left_cell(f,m,G) misses C by A3,A18,A8,A19,A16,A40,A46
,A47,A50,A57,GOBRD13:22;
                      hence left_cell(f|(k+1),m,G) misses C by A3,A18,A19,A16
,A40,GOBRD13:32;
                      cell(G,i2,j2) meets C by A3,A39,A38,A41,A45,A46,A47,A44
,A56,GOBRD13:27;
                      then
                      right_cell(f,m,G) meets C by A3,A18,A8,A19,A16,A40,A46
,A47,A57,GOBRD13:23;
                      hence right_cell(f|(k+1),m,G) meets C by A3,A18,A19,A16
,A40,GOBRD13:32;
                    end;
                    suppose that
A58:                  i1 = i2 & j1 = j2+1 and
A59:                  [i2-'1,j2] in Indices G & f/.((len(f|k))+1) = G
                      *(i2-'1,j2);
                      front_right_cell(f,(len(f|k))-'1,G) = cell(G,i2-'1,
                      j2-'1 ) by A3,A39,A38,A41,A45,A46,A47,A58,GOBRD13:42;
                      then left_cell(f,m,G) misses C by A3,A18,A8,A19,A16,A40
,A46,A47,A48,A50,A59,GOBRD13:26;
                      hence left_cell(f|(k+1),m,G) misses C by A3,A18,A19,A16
,A40,GOBRD13:32;
                      cell(G,i2-'1,j2) meets C by A3,A39,A38,A41,A45,A46,A47
,A44,A58,GOBRD13:29;
                      then right_cell(f,m,G) meets C by A3,A18,A8,A19,A16,A40
,A46,A47,A48,A59,GOBRD13:27;
                      hence right_cell(f|(k+1),m,G) meets C by A3,A18,A19,A16
,A40,GOBRD13:32;
                    end;
                  end;
                  hence thesis;
                end;
                suppose
A60:              front_left_cell(f,(len(f|k))-'1,G) misses C &
                  front_right_cell(f,(len(f|k))-'1,G) meets C;
                  then
A61:              f goes_straight (len(f|k))-'1,G by A2,A18,A8,A39,A43,Def1;
                  now
                    per cases by A38,A45,A46,A47,A43,A61,GOBRD13:def 8;
                    suppose that
A62:                  i1 = i2 & j1+1 = j2 and
A63:                  [i2,j2+1] in Indices G & f/.(len(f|k)+1) = G*(
                      i2,j2+1);
                      front_left_cell(f,(len(f|k))-'1,G) = cell(G,i1-'1,
                      j2) by A3,A39,A38,A41,A45,A46,A47,A62,GOBRD13:35;
                      then left_cell(f,m,G) misses C by A3,A18,A8,A19,A16,A40
,A46,A47,A60,A62,A63,GOBRD13:22;
                      hence left_cell(f|(k+1),m,G) misses C by A3,A18,A19,A16
,A40,GOBRD13:32;
                      front_right_cell(f,(len(f|k))-'1,G) = cell(G,i1,j2
                      ) by A3,A39,A38,A41,A45,A46,A47,A62,GOBRD13:36;
                      then right_cell(f,m,G) meets C by A3,A18,A8,A19,A16,A40
,A46,A47,A60,A62,A63,GOBRD13:23;
                      hence right_cell(f|(k+1),m,G) meets C by A3,A18,A19,A16
,A40,GOBRD13:32;
                    end;
                    suppose that
A64:                  i1+1 = i2 & j1 = j2 and
A65:                  [i2+1,j2] in Indices G & f/.(len(f|k)+1) = G*(
                      i2+1,j2);
                      front_left_cell(f,(len(f|k))-'1,G) = cell(G,i2,j2)
                      by A3,A39,A38,A41,A45,A46,A47,A64,GOBRD13:37;
                      then left_cell(f,m,G) misses C by A3,A18,A8,A19,A16,A40
,A46,A47,A60,A65,GOBRD13:24;
                      hence left_cell(f|(k+1),m,G) misses C by A3,A18,A19,A16
,A40,GOBRD13:32;
                      front_right_cell(f,(len(f|k))-'1,G) = cell(G,i2,j2
                      -'1) by A3,A39,A38,A41,A45,A46,A47,A64,GOBRD13:38;
                      then right_cell(f,m,G) meets C by A3,A18,A8,A19,A16,A40
,A46,A47,A60,A65,GOBRD13:25;
                      hence right_cell(f|(k+1),m,G) meets C by A3,A18,A19,A16
,A40,GOBRD13:32;
                    end;
                    suppose that
A66:                  i1 = i2+1 & j1 = j2 and
A67:                  [i2-'1,j2] in Indices G & f/.(len(f|k)+1) = G*
                      (i2-'1,j2);
                      front_left_cell(f,(len(f|k))-'1,G) = cell(G,i2-'1,
                      j2-'1) by A3,A39,A38,A41,A45,A46,A47,A66,GOBRD13:39;
                      then left_cell(f,m,G) misses C by A3,A18,A8,A19,A16,A40
,A46,A47,A48,A60,A67,GOBRD13:26;
                      hence left_cell(f|(k+1),m,G) misses C by A3,A18,A19,A16
,A40,GOBRD13:32;
                      front_right_cell(f,(len(f|k))-'1,G) = cell(G,i2-'1
                      ,j2) by A3,A39,A38,A41,A45,A46,A47,A66,GOBRD13:40;
                      then right_cell(f,m,G) meets C by A3,A18,A8,A19,A16,A40
,A46,A47,A48,A60,A67,GOBRD13:27;
                      hence right_cell(f|(k+1),m,G) meets C by A3,A18,A19,A16
,A40,GOBRD13:32;
                    end;
                    suppose that
A68:                  i1 = i2 & j1 = j2+1 and
A69:                  [i2,j2-'1] in Indices G & f/.(len(f|k)+1) = G*
                      (i2,j2-'1);
                      front_left_cell(f,(len(f|k))-'1,G) = cell(G,i2,j2
                      -'1) by A3,A39,A38,A41,A45,A46,A47,A68,GOBRD13:41;
                      then left_cell(f,m,G) misses C by A3,A18,A8,A19,A16,A40
,A46,A47,A49,A60,A69,GOBRD13:28;
                      hence left_cell(f|(k+1),m,G) misses C by A3,A18,A19,A16
,A40,GOBRD13:32;
                      front_right_cell(f,(len(f|k))-'1,G) = cell(G,i2-'1
                      ,j2-'1 ) by A3,A39,A38,A41,A45,A46,A47,A68,GOBRD13:42;
                      then right_cell(f,m,G) meets C by A3,A18,A8,A19,A16,A40
,A46,A47,A49,A60,A69,GOBRD13:29;
                      hence right_cell(f|(k+1),m,G) meets C by A3,A18,A19,A16
,A40,GOBRD13:32;
                    end;
                  end;
                  hence thesis;
                end;
                suppose
A70:              front_left_cell(f,(len(f|k))-'1,G) meets C;
                  then
A71:              f turns_left (len(f|k))-'1,G by A2,A18,A8,A39,A43,Def1;
                  now
                    per cases by A38,A45,A46,A47,A43,A71,GOBRD13:def 7;
                    suppose that
A72:                  i1 = i2 & j1+1 = j2 and
A73:                  [i2-'1,j2] in Indices G & f/.(len(f|k)+1) = G*
                      (i2-'1,j2);
                      j2-'1 = j1 & cell(G,i1-'1,j1) misses C by A3,A39,A38,A41
,A45,A46,A47,A42,A72,GOBRD13:22,NAT_D:34;
                      then left_cell(f,m,G) misses C by A3,A18,A8,A19,A16,A40
,A46,A47,A48,A72,A73,GOBRD13:26;
                      hence left_cell(f|(k+1),m,G) misses C by A3,A18,A19,A16
,A40,GOBRD13:32;
                      front_left_cell(f,(len(f|k))-'1,G) = cell(G,i1-'1,
                      j2) by A3,A39,A38,A41,A45,A46,A47,A72,GOBRD13:35;
                      then right_cell(f,m,G) meets C by A3,A18,A8,A19,A16,A40
,A46,A47,A48,A70,A72,A73,GOBRD13:27;
                      hence right_cell(f|(k+1),m,G) meets C by A3,A18,A19,A16
,A40,GOBRD13:32;
                    end;
                    suppose that
A74:                  i1+1 = i2 & j1 = j2 and
A75:                  [i2,j2+1] in Indices G & f/.(len(f|k)+1) = G*(
                      i2,j2+1);
                      i2-'1 = i1 & cell(G,i1,j1) misses C by A3,A39,A38,A41,A45
,A46,A47,A42,A74,GOBRD13:24,NAT_D:34;
                      then left_cell(f,m,G) misses C by A3,A18,A8,A19,A16,A40
,A46,A47,A74,A75,GOBRD13:22;
                      hence left_cell(f|(k+1),m,G) misses C by A3,A18,A19,A16
,A40,GOBRD13:32;
                      front_left_cell(f,(len(f|k))-'1,G) = cell(G,i2,j2)
                      by A3,A39,A38,A41,A45,A46,A47,A74,GOBRD13:37;
                      then right_cell(f,m,G) meets C by A3,A18,A8,A19,A16,A40
,A46,A47,A70,A75,GOBRD13:23;
                      hence right_cell(f|(k+1),m,G) meets C by A3,A18,A19,A16
,A40,GOBRD13:32;
                    end;
                    suppose that
A76:                  i1 = i2+1 & j1 = j2 and
A77:                  [i2,j2-'1] in Indices G & f/.(len(f|k)+1) = G*
                      (i2,j2-'1);
                      cell(G,i2,j2-'1) misses C by A3,A39,A38,A41,A45,A46,A47
,A42,A76,GOBRD13:26;
                      then left_cell(f,m,G) misses C by A3,A18,A8,A19,A16,A40
,A46,A47,A49,A77,GOBRD13:28;
                      hence left_cell(f|(k+1),m,G) misses C by A3,A18,A19,A16
,A40,GOBRD13:32;
                      front_left_cell(f,(len(f|k))-'1,G) = cell(G,i2-'1,
                      j2-'1) by A3,A39,A38,A41,A45,A46,A47,A76,GOBRD13:39;
                      then right_cell(f,m,G) meets C by A3,A18,A8,A19,A16,A40
,A46,A47,A49,A70,A77,GOBRD13:29;
                      hence right_cell(f|(k+1),m,G) meets C by A3,A18,A19,A16
,A40,GOBRD13:32;
                    end;
                    suppose that
A78:                  i1 = i2 & j1 = j2+1 and
A79:                  [i2+1,j2] in Indices G & f/.(len(f|k)+1) = G*(
                      i2+1,j2);
                      cell(G,i2,j2) misses C by A3,A39,A38,A41,A45,A46,A47,A42
,A78,GOBRD13:28;
                      then left_cell(f,m,G) misses C by A3,A18,A8,A19,A16,A40
,A46,A47,A79,GOBRD13:24;
                      hence left_cell(f|(k+1),m,G) misses C by A3,A18,A19,A16
,A40,GOBRD13:32;
                      front_left_cell(f,(len(f|k))-'1,G) = cell(G,i2,j2
                      -'1) by A3,A39,A38,A41,A45,A46,A47,A78,GOBRD13:41;
                      then right_cell(f,m,G) meets C by A3,A18,A8,A19,A16,A40
,A46,A47,A70,A79,GOBRD13:25;
                      hence right_cell(f|(k+1),m,G) meets C by A3,A18,A19,A16
,A40,GOBRD13:32;
                    end;
                  end;
                  hence thesis;
                end;
              end;
              hence thesis;
            end;
            suppose
              m+1 <> len(f|(k+1));
              then m+1 < len(f|(k+1)) by A17,XXREAL_0:1;
              then
A80:          m+1 <= len(f|k)by A8,A19,NAT_1:13;
              then consider i1,j1,i2,j2 being Element of NAT such that
A81:          [i1,j1] in Indices G and
A82:          (f|k)/.m = G*(i1,j1) and
A83:          [i2,j2] in Indices G and
A84:          (f|k)/.(m+1) = G*(i2,j2) and
A85:          i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or i1 = i2+
              1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A10,A16,JORDAN8:6;
A86:          left_cell(f|k,m,G) misses C & right_cell(f|k,m,G) meets C
              by A6,A16,A80;
A87:          f|(k+1) = (f|k)^<*f/.(k+1)*> by A18,FINSEQ_5:85;
              1 <= m+1 by NAT_1:12;
              then m+1 in dom(f|k) by A80,FINSEQ_3:27;
              then
A88:          (f|(k+1))/.(m+1) = G*(i2,j2) by A84,A87,FINSEQ_4:83;
              m <= len(f|k) by A80,NAT_1:13;
              then m in dom(f|k) by A16,FINSEQ_3:27;
              then
A89:          (f|(k+1))/.m = G*(i1,j1) by A82,A87,FINSEQ_4:83;
              now
                per cases by A85;
                suppose
A90:              i1 = i2 & j1+1 = j2;
                  then left_cell(f|k,m,G) = cell(G,i1-'1,j1) & right_cell(f|k
,m,G) = cell(G,i1,j1) by A10,A16,A80,A81,A82,A83,A84,GOBRD13:22,23;
                  hence thesis by A11,A16,A17,A81,A83,A86,A89,A88,A90,
GOBRD13:22,23;
                end;
                suppose
A91:              i1+1 = i2 & j1 = j2;
                  then left_cell(f|k,m,G) = cell(G,i1,j1) & right_cell(f|k,m,
G) = cell(G,i1,j1-'1) by A10,A16,A80,A81,A82,A83,A84,GOBRD13:24,25;
                  hence thesis by A11,A16,A17,A81,A83,A86,A89,A88,A91,
GOBRD13:24,25;
                end;
                suppose
A92:              i1 = i2+1 & j1 = j2;
                  then left_cell(f|k,m,G) = cell(G,i2,j2-'1) & right_cell(f|k
,m,G) = cell(G,i2,j2) by A10,A16,A80,A81,A82,A83,A84,GOBRD13:26,27;
                  hence thesis by A11,A16,A17,A81,A83,A86,A89,A88,A92,
GOBRD13:26,27;
                end;
                suppose
A93:              i1 = i2 & j1 = j2+1;
                  then left_cell(f|k,m,G) = cell(G,i2,j2) & right_cell(f|k,m,
G) = cell(G,i1-'1,j2) by A10,A16,A80,A81,A82,A83,A84,GOBRD13:28,29;
                  hence thesis by A11,A16,A17,A81,A83,A86,A89,A88,A93,
GOBRD13:28,29;
                end;
              end;
              hence thesis;
            end;
          end;
          hence thesis;
        end;
      end;
      hence thesis;
    end;
  end;
A94: f|len f = f by FINSEQ_1:79;
A95: P[0] by CARD_1:47;
  for k holds P[k] from NAT_1:sch 1(A95,A5);
  hence thesis by A94;
end;

theorem
  C is connected implies N-min L~Cage(C,n) = (Cage(C,n))/.1
proof
  set f = Cage(C,n);
  assume
A1: C is connected;
  then
A2: for k st 1 <= k & k+1 <= len f holds left_cell(f,k,Gauge(C,n)) misses C
  & right_cell(f,k,Gauge(C,n)) meets C by Th33;
  f is_sequence_on Gauge(C,n) & ex i st 1 <= i & i+1 <= len Gauge(C,n ) &
f/.1 = Gauge(C,n)*(i,width Gauge(C,n)) & f/.2 = Gauge(C,n)*(i+1,width Gauge(C,n
)) & N-min C in cell(Gauge( C,n),i,width Gauge(C,n)-'1) & N-min C <> Gauge(C,n)
  *(i, width Gauge(C,n)-'1) by A1,Def1;
  hence thesis by A2,Th32;
end;

