:: Cages, external approximation of Jordan's curve
::  by Czes{\l}aw Byli\'nski and Mariusz \.Zynel
::
:: Received June 22, 1999
:: Copyright (c) 1999 Association of Mizar Users

environ

 vocabularies FINSEQ_1, BOOLE, PRE_TOPC, RELAT_2, CONNSP_1, RELAT_1, FINSEQ_5,
      ARYTM_1, GOBOARD1, EUCLID, MATRIX_1, ABSVALUE, GOBRD13, FUNCT_1,
      TOPREAL1, RFINSEQ, GOBOARD5, TOPS_1, TREES_1, SPPOL_1, MCART_1, TARSKI,
      SUBSET_1, SEQM_3, GOBOARD9, COMPTS_1, JORDAN8, PSCOMP_1, GROUP_1,
      ARYTM_3, SPRECT_2, CARD_1, PCOMPS_1, METRIC_1, JORDAN9, FINSEQ_4, ARYTM;
 notations TARSKI, XBOOLE_0, SUBSET_1, GOBOARD5, ORDINAL1, CARD_1, NUMBERS,
      XCMPLX_0, XREAL_0, REAL_1, NAT_1, BINARITH, RELAT_1, FUNCT_1, PARTFUN1,
      FUNCT_2, COMPLEX1, FINSEQ_1, FINSEQ_2, FINSEQ_4, FINSEQ_5, NEWTON,
      RFINSEQ, STRUCT_0, XXREAL_0, MATRIX_1, METRIC_1, PRE_TOPC, TOPS_1,
      COMPTS_1, CONNSP_1, PCOMPS_1, EUCLID, TOPREAL1, GOBOARD1, SPPOL_1,
      PSCOMP_1, SPRECT_2, GOBOARD9, JORDAN8, GOBRD13;
 constructors PARTFUN1, XXREAL_0, REAL_1, NAT_1, FINSEQ_4, NEWTON, RFINSEQ,
      BINARITH, TOPS_1, CONNSP_1, COMPTS_1, REALSET2, SPPOL_1, PSCOMP_1,
      GOBOARD9, SPRECT_2, JORDAN8, GOBRD13, VALUED_1, SEQ_1;
 registrations XBOOLE_0, RELAT_1, FUNCT_1, ORDINAL1, XXREAL_0, XREAL_0, NAT_1,
      MEMBERED, FINSEQ_1, STRUCT_0, EUCLID, SPPOL_2, PSCOMP_1, GOBOARD9,
      SPRECT_1, SPRECT_2, JORDAN8, GOBRD13, NEWTON, VALUED_1, FUNCT_2;
 requirements REAL, NUMERALS, SUBSET, BOOLE, ARITHM;
 definitions TARSKI, GOBOARD1, GOBOARD5, GOBRD13, XBOOLE_0, PSCOMP_1, VALUED_1;
 theorems NAT_1, FINSEQ_1, GOBOARD1, FINSEQ_4, EUCLID, FINSEQ_3, REAL_1,
      REAL_2, SPPOL_2, TARSKI, JORDAN3, PSCOMP_1, FINSEQ_5, FINSEQ_6, GOBOARD7,
      TOPREAL1, BINARITH, JORDAN5B, GOBOARD5, SPRECT_2, SPPOL_1, ABSVALUE,
      FUNCT_1, FUNCT_2, GOBOARD9, RELAT_1, FINSEQ_2, UNIFORM1, SUBSET_1,
      GOBRD11, GOBOARD2, SPRECT_3, CARD_1, RFINSEQ, GOBOARD6, TOPREAL3,
      TOPMETR, TOPS_1, JORDAN8, GOBRD13, SPRECT_4, CONNSP_1, PARTFUN2,
      RELSET_1, SPRECT_1, XBOOLE_0, XBOOLE_1, XREAL_0, XCMPLX_1, XREAL_1,
      NEWTON, XXREAL_0, ORDINAL1, PARTFUN1;
 schemes NAT_1, LATTICE5;

begin :: Generalities

reserve i,j,k,n for Element of NAT,
  D for non empty set,
  f, g for FinSequence of D;

Lm1: for n st 1 <= n holds n-'1+2 = n+1
proof
  let n;
  assume 1 <= n;
  hence n-'1+2 = n+2-'1 by BINARITH:56
            .= n+1+1 - 1 by BINARITH:55
            .= n+1;
end;

canceled 2;

theorem Th3:
  for T being non empty TopSpace
  for B,C1,C2,D being Subset of T st B is connected & C1 is_a_component_of D &
    C2 is_a_component_of D & B meets C1 & B meets C2 & B c= D
    holds C1 = C2
proof
  let T be non empty TopSpace;
  let B,C1,C2,D be Subset of T;
  assume that
A1:  B is connected and
A2:  C1 is_a_component_of D and
A3:  C2 is_a_component_of D and
A4:  B meets C1 and
A5:  B meets C2 and
A6:  B c= D;
A7:  B c= C1 by A1,A2,A4,A6,GOBOARD9:6;
A8:  B c= C2 by A1,A3,A5,A6,GOBOARD9:6;
      B <> {} by A4,XBOOLE_1:65;
 then C1 meets C2 by A7,A8,XBOOLE_1:68;
 hence C1 = C2 by A2,A3,GOBOARD9:3;
end;

theorem Th4:
  (for n holds f|n = g|n) implies f = g
proof
  assume
A1:  for n holds f|n = g|n;
A2: now assume
A3:  len f <> len g;
   per cases by A3,REAL_1:def 5;
    suppose
A4:    len f < len g;
      then f|len g = f & g|len g = g by FINSEQ_1:79;
     hence contradiction by A1,A4;
    end;
    suppose
A5:    len g < len f;
      then f|len f = f & g|len f = g by FINSEQ_1:79;
     hence contradiction by A1,A5;
  end;
  end;
      f|len f = f & g|len g = g by FINSEQ_1:79;
 hence thesis by A1,A2;
end;

theorem Th5:
  n in dom f implies
   ex k st k in dom Rev f & n+k = len f+1 & f/.n = (Rev f)/.k
proof
  assume
A1: n in dom f;
  then A2: 1 <= n & n <= len f by FINSEQ_3:27;
    take k = len f+1-'n;
         n <= len f+1 by A2,SPPOL_1:5;
  then A3: k+n = len f+1 by BINARITH:53;
  then A4: k+n-'1 = len f by BINARITH:39;
         n+1 <= len f+1 by A2,XREAL_1:8;
  then A5: 1 <= k by BINARITH:73;
         k+1 <= k+n by A2,XREAL_1:8;
    then k+1-'1 <= k+n -'1 by BINARITH:60;
    then k <= len f by A4,BINARITH:39;
    then k in dom f by A5,FINSEQ_3:27;
    hence thesis by A1,A3,FINSEQ_5:60,69;
end;

theorem Th6:
  n in dom Rev f implies
   ex k st k in dom f & n+k = len f+1 & (Rev f)/.n = f/.k
proof
  assume
       n in dom Rev f;
  then n in dom f by FINSEQ_5:60;
  then consider k such that
A1: k in dom Rev f and
A2: n+k = len f+1 and
         f/.n = (Rev f)/.k by Th5;
A3: len f = len Rev f & dom f = dom Rev f by FINSEQ_5:60,def 3;
  then (Rev f)/.n = f/.k by A1,A2,FINSEQ_5:69;
  hence thesis by A1,A2,A3;
end;

begin :: Go-board preliminaries

reserve G for Go-board,
  f, g for FinSequence of TOP-REAL 2,
  p for Point of TOP-REAL 2,
  r, s for Real,
  x for set;

theorem Th7:
  for D being non empty set
  for G being Matrix of D
  for f being FinSequence of D holds
  f is_sequence_on G iff Rev f is_sequence_on G
proof
  let D be non empty set;
  let G be Matrix of D;
  let f be FinSequence of D;
  hereby
    assume
  A1: f is_sequence_on G;
  A2:for n st n in dom Rev f ex i,j st [i,j] in
 Indices G & (Rev f)/.n = G*(i,j)
  proof
    let n;
    assume n in dom Rev f;
    then consider k such that
  A3: k in dom f and
           n+k = len f+1 and
  A4: (Rev f)/.n = f/.k by Th6;
    consider i,j such that
  A5: [i,j] in Indices G and
  A6: f/.k = G*(i,j) by A1,A3,GOBOARD1:def 11;
    take i,j;
    thus thesis by A4,A5,A6;
  end;
       for n st n in dom Rev f & n+1 in dom Rev f holds
    for m,k,i,j being Element of NAT
     st [m,k] in Indices G & [i,j] in Indices G &
                     (Rev f)/.n = G*(m,k) & (Rev f)/.(n+1) = G*(i,j) holds
      abs(m-i)+abs(k-j) = 1
  proof
    let n such that
  A7: n in dom Rev f and
  A8: n+1 in dom Rev f;
    let m,k,i,j be Element of NAT such that
  A9: [m,k] in Indices G and
  A10: [i,j] in Indices G and
  A11: (Rev f)/.n = G*(m,k) and
  A12: (Rev f)/.(n+1) = G*(i,j);
    consider l being Element of NAT such that
  A13: l in dom f and
  A14: n+l = len f+1 and
  A15: (Rev f)/.n = f/.l by A7,Th6;
    consider l' being Element of NAT such that
  A16: l' in dom f and
  A17: n+1+l' = len f+1 and
  A18: (Rev f)/.(n+1) = f/.l' by A8,Th6;
        A19: n+(1+l') = n+l by A14,A17;
         abs(i-m) = abs(m-i) & abs(j-k) = abs(k-j) by UNIFORM1:13;
    hence abs(m-i)+abs(k-j) = 1
            by A1,A9,A10,A11,A12,A13,A15,A16,A18,A19,GOBOARD1:def 11;
  end;
    hence Rev f is_sequence_on G by A2,GOBOARD1:def 11;
  end;
  assume
A20: Rev f is_sequence_on G;
  A21:for n st n in dom f ex i,j st [i,j] in Indices G & f/.n = G*(i,j)
  proof
    let n;
    assume n in dom f;
    then consider k such that
  A22: k in dom Rev f and
           n+k = len f+1 and
  A23: f/.n = (Rev f)/.k by Th5;
    consider i,j such that
  A24: [i,j] in Indices G and
  A25: (Rev f)/.k = G*(i,j) by A20,A22,GOBOARD1:def 11;
    take i,j;
    thus thesis by A23,A24,A25;
  end;

       for n st n in dom f & n+1 in dom f holds
    for m,k,i,j being Element of NAT
     st [m,k] in Indices G & [i,j] in Indices G &
                     f/.n = G*(m,k) & f/.(n+1) = G*(i,j) holds
      abs(m-i)+abs(k-j) = 1
  proof
    let n such that
  A26: n in dom f and
  A27: n+1 in dom f;
    let m,k,i,j be Element of NAT such that
  A28: [m,k] in Indices G and
  A29: [i,j] in Indices G and
  A30: f/.n = G*(m,k) and
  A31: f/.(n+1) = G*(i,j);
    consider l being Element of NAT such that
  A32: l in dom Rev f and
  A33: n+l = len f+1 and
  A34: f/.n = (Rev f)/.l by A26,Th5;

    consider l' being Element of NAT such that
  A35: l' in dom Rev f and
  A36: n+1+l' = len f+1 and
  A37: f/.(n+1) = (Rev f)/.l' by A27,Th5;
        A38: n+(1+l') = n+l by A33,A36;
         abs(i-m) = abs(m-i) & abs(j-k) = abs(k-j) by UNIFORM1:13;
    hence abs(m-i)+abs(k-j) = 1
        by A20,A28,A29,A30,A31,A32,A34,A35,A37,A38,GOBOARD1:def 11;
  end;
  hence f is_sequence_on G by A21,GOBOARD1:def 11;
end;

theorem Th8:
  for G being Matrix of TOP-REAL 2
  for f being FinSequence of TOP-REAL 2 holds
  f is_sequence_on G & 1 <= k & k <= len f implies f/.k in Values G
proof
  let G be Matrix of TOP-REAL 2;
  let f be FinSequence of TOP-REAL 2;
  assume that
A1: f is_sequence_on G and
A2: 1 <= k and
A3: k <= len f;
A4: k in dom f by A2,A3,FINSEQ_3:27;
  then f/.k = f.k by PARTFUN1:def 8;
then A5: f/.k in rng f by A4,FUNCT_1:def 5;
       rng f c= Values G by A1,GOBRD13:9;
  hence f/.k in Values G by A5;
end;

Lm2:
  f is_sequence_on G & 1 <= k & k <= len f implies
   ex i,j being Element of NAT st [i,j] in Indices G & f/.k = G*(i,j)
proof
  assume that
A1: f is_sequence_on G and
A2: 1 <= k & k <= len f;
       k in dom f by A2,FINSEQ_3:27;
  then consider i,j such that
A3: [i,j] in Indices G & f/.k = G*(i,j) by A1,GOBOARD1:def 11;
   take i,j;
   thus thesis by A3;
end;

theorem Th9:
  n <= len f & x in L~(f/^n)
    implies
   ex i being Element of NAT st n+1 <= i & i+1 <= len f & x in LSeg(f,i)
proof
  assume that
A1: n <= len f and
A2: x in L~(f/^n);
  consider j such that
A3: 1 <= j and
A4: j+1 <= len(f/^n) and
A5: x in LSeg(f/^n,j) by A2,SPPOL_2:13;
A6:  j+1 <= len f - n by A1,A4,RFINSEQ:def 2;
  take n+j;
       j+1 <= len f - n by A1,A4,RFINSEQ:def 2;
  then n+(j+1) <= len f by XREAL_1:21;
  hence thesis by A3,A5,A6,SPPOL_2:5,XREAL_1:8;
end;

theorem Th10:
  f is_sequence_on G & 1 <= k & k+1 <= len f
    implies
   f/.k in left_cell(f,k,G) & f/.k in right_cell(f,k,G)
proof
  assume that
A1: f is_sequence_on G and
A2: 1 <= k & k+1 <= len f;
  set p = f/.k;
       LSeg(f,k) = LSeg(f/.k, f/.(k+1)) by A2,TOPREAL1:def 5;
  then p in LSeg(f,k) by TOPREAL1:6;
  then p in left_cell(f,k,G) /\ right_cell(f,k,G) by A1,A2,GOBRD13:30;
  hence thesis by XBOOLE_0:def 3;
end;

theorem Th11:
  f is_sequence_on G & 1 <= k & k+1 <= len f
    implies
   Int left_cell(f,k,G) <> {} & Int right_cell(f,k,G) <> {}
proof
  assume that
A1: f is_sequence_on G and
A2: 1 <= k and
A3: k+1 <= len f;

  consider i1,j1,i2,j2 being Element of NAT such that
A4: [i1,j1] in Indices G and
A5: f/.k = G*(i1,j1) and
A6: [i2,j2] in Indices G and
A7: f/.(k+1) = G*(i2,j2) and
A8: i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
      i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A1,A2,A3,JORDAN8:6;

A9: i1+1 > i1 & j1+1 > j1 & i2+1 > i2 & j2+1 > j2 by NAT_1:13;
A10: i1 <= len G & j1 <= width G by A4,GOBOARD5:1;
A11: i2 <= len G & j2 <= width G by A6,GOBOARD5:1;
A12: i1-'1 <= len G & j1-'1 <= width G by A10,BINARITH:62;
A13: i2-'1 <= len G & j2-'1 <= width G by A11,BINARITH:62;

  per cases by A8;
  suppose
  A14: i1 = i2 & j1+1 = j2;
  then A15: right_cell(f,k,G) = cell(G,i1,j1)
       by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
         left_cell(f,k,G) = cell(G,i1-'1,j1)
       by A1,A2,A3,A4,A5,A6,A7,A9,A14,GOBRD13:def 3;
    hence thesis by A10,A12,A15,GOBOARD9:17;

  end;
  suppose
  A16: i1+1 = i2 & j1 = j2;
  then A17: right_cell(f,k,G) = cell(G,i1,j1-'1)
        by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
         left_cell(f,k,G) = cell(G,i1,j1)
        by A1,A2,A3,A4,A5,A6,A7,A9,A16,GOBRD13:def 3;
    hence thesis by A10,A12,A17,GOBOARD9:17;

  end;
  suppose
  A18: i1 = i2+1 & j1 = j2;
  then A19: right_cell(f,k,G) = cell(G,i2,j2)
        by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
         left_cell(f,k,G) = cell(G,i2,j2-'1)
        by A1,A2,A3,A4,A5,A6,A7,A9,A18,GOBRD13:def 3;
    hence thesis by A11,A13,A19,GOBOARD9:17;

  end;
  suppose
  A20: i1 = i2 & j1 = j2+1;
  then A21: right_cell(f,k,G) = cell(G,i1-'1,j2)
        by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
         left_cell(f,k,G) = cell(G,i1,j2)
        by A1,A2,A3,A4,A5,A6,A7,A9,A20,GOBRD13:def 3;
    hence thesis by A10,A11,A12,A21,GOBOARD9:17;
end;
end;

theorem Th12:
  f is_sequence_on G & 1 <= k & k+1 <= len f
    implies
   Int left_cell(f,k,G) is connected & Int right_cell(f,k,G) is connected
proof
  assume that
A1: f is_sequence_on G and
A2: 1 <= k and
A3: k+1 <= len f;

  consider i1,j1,i2,j2 being Element of NAT such that
A4: [i1,j1] in Indices G and
A5: f/.k = G*(i1,j1) and
A6: [i2,j2] in Indices G and
A7: f/.(k+1) = G*(i2,j2) and
A8: i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
      i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A1,A2,A3,JORDAN8:6;

A9: i1+1 > i1 & j1+1 > j1 & i2+1 > i2 & j2+1 > j2 by NAT_1:13;
A10: i1 <= len G & j1 <= width G by A4,GOBOARD5:1;
A11: i2 <= len G & j2 <= width G by A6,GOBOARD5:1;
A12: i1-'1 <= len G & j1-'1 <= width G by A10,BINARITH:62;
A13: i2-'1 <= len G & j2-'1 <= width G by A11,BINARITH:62;

  per cases by A8;
  suppose
  A14: i1 = i2 & j1+1 = j2;
  then A15: right_cell(f,k,G) = cell(G,i1,j1)
       by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
         left_cell(f,k,G) = cell(G,i1-'1,j1)
       by A1,A2,A3,A4,A5,A6,A7,A9,A14,GOBRD13:def 3;
    hence thesis by A10,A12,A15,GOBOARD9:21;

  end;
  suppose
  A16: i1+1 = i2 & j1 = j2;
  then A17: right_cell(f,k,G) = cell(G,i1,j1-'1)
        by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
         left_cell(f,k,G) = cell(G,i1,j1)
        by A1,A2,A3,A4,A5,A6,A7,A9,A16,GOBRD13:def 3;
    hence thesis by A10,A12,A17,GOBOARD9:21;

  end;
  suppose
  A18: i1 = i2+1 & j1 = j2;
  then A19: right_cell(f,k,G) = cell(G,i2,j2)
        by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
         left_cell(f,k,G) = cell(G,i2,j2-'1)
        by A1,A2,A3,A4,A5,A6,A7,A9,A18,GOBRD13:def 3;
    hence thesis by A11,A13,A19,GOBOARD9:21;

  end;
  suppose
  A20: i1 = i2 & j1 = j2+1;
  then A21: right_cell(f,k,G) = cell(G,i1-'1,j2)
        by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
         left_cell(f,k,G) = cell(G,i1,j2)
        by A1,A2,A3,A4,A5,A6,A7,A9,A20,GOBRD13:def 3;
    hence thesis by A10,A11,A12,A21,GOBOARD9:21;
end;
end;

theorem Th13:
  f is_sequence_on G & 1 <= k & k+1 <= len f
    implies
   Cl Int left_cell(f,k,G) = left_cell(f,k,G) &
     Cl Int right_cell(f,k,G) = right_cell(f,k,G)
proof
  assume that
A1: f is_sequence_on G and
A2: 1 <= k and
A3: k+1 <= len f;

  consider i1,j1,i2,j2 being Element of NAT such that
A4: [i1,j1] in Indices G and
A5: f/.k = G*(i1,j1) and
A6: [i2,j2] in Indices G and
A7: f/.(k+1) = G*(i2,j2) and
A8: i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
      i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A1,A2,A3,JORDAN8:6;

A9: i1+1 > i1 & j1+1 > j1 & i2+1 > i2 & j2+1 > j2 by NAT_1:13;
A10: i1 <= len G & j1 <= width G by A4,GOBOARD5:1;
A11: i2 <= len G & j2 <= width G by A6,GOBOARD5:1;
A12: i1-'1 <= len G & j1-'1 <= width G by A10,BINARITH:62;
A13: i2-'1 <= len G & j2-'1 <= width G by A11,BINARITH:62;

  per cases by A8;
  suppose
  A14: i1 = i2 & j1+1 = j2;
  then A15: right_cell(f,k,G) = cell(G,i1,j1)
       by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
         left_cell(f,k,G) = cell(G,i1-'1,j1)
       by A1,A2,A3,A4,A5,A6,A7,A9,A14,GOBRD13:def 3;
    hence thesis by A10,A12,A15,GOBRD11:35;

  end;
  suppose
  A16: i1+1 = i2 & j1 = j2;
  then A17: right_cell(f,k,G) = cell(G,i1,j1-'1)
        by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
         left_cell(f,k,G) = cell(G,i1,j1)
        by A1,A2,A3,A4,A5,A6,A7,A9,A16,GOBRD13:def 3;
    hence thesis by A10,A12,A17,GOBRD11:35;

  end;
  suppose
  A18: i1 = i2+1 & j1 = j2;
  then A19: right_cell(f,k,G) = cell(G,i2,j2)
        by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
         left_cell(f,k,G) = cell(G,i2,j2-'1)
        by A1,A2,A3,A4,A5,A6,A7,A9,A18,GOBRD13:def 3;
    hence thesis by A11,A13,A19,GOBRD11:35;

  end;
  suppose
  A20: i1 = i2 & j1 = j2+1;
  then A21: right_cell(f,k,G) = cell(G,i1-'1,j2)
        by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
         left_cell(f,k,G) = cell(G,i1,j2)
        by A1,A2,A3,A4,A5,A6,A7,A9,A20,GOBRD13:def 3;
    hence thesis by A10,A11,A12,A21,GOBRD11:35;
end;
end;

theorem Th14:
  f is_sequence_on G & LSeg(f,k) is horizontal
    implies
   ex j st 1 <= j & j <= width G & for p st p in
 LSeg(f,k) holds p`2 = G*(1,j)`2
proof
  assume that
A1: f is_sequence_on G and
A2: LSeg(f,k) is horizontal;
 per cases;
 suppose
A3: 1 <= k & k+1 <= len f;
       k <= k+1 by NAT_1:11;
  then k <= len f by A3,XXREAL_0:2;
  then consider i,j such that
A4: [i,j] in Indices G and
A5: f/.k = G*(i,j) by A1,A3,Lm2;
 take j;
 thus
A6: 1 <= j & j <= width G by A4,GOBOARD5:1;
 let p;
A7: 1 <= i & i <= len G by A4,GOBOARD5:1;
A8: f/.k in LSeg(f,k) by A3,TOPREAL1:27;
 assume p in LSeg(f,k);
 hence p`2 = (f/.k)`2 by A2,A8,SPPOL_1:def 2
          .= G*(1,j)`2 by A5,A6,A7,GOBOARD5:2;
 end;
 suppose
A9: not(1 <= k & k+1 <= len f);
 take 1;
       width G <> 0 by GOBOARD1:def 5;
 hence 1 <= 1 & 1 <= width G by NAT_1:14;
 thus thesis by A9,TOPREAL1:def 5;
end;
end;

theorem Th15:
  f is_sequence_on G & LSeg(f,k) is vertical
    implies
   ex i st 1 <= i & i <= len G & for p st p in LSeg(f,k) holds p`1 = G*(i,1)`1
proof
  assume that
A1: f is_sequence_on G and
A2: LSeg(f,k) is vertical;
 per cases;
 suppose
A3: 1 <= k & k+1 <= len f;
       k <= k+1 by NAT_1:11;
  then k <= len f by A3,XXREAL_0:2;
  then consider i,j such that
A4: [i,j] in Indices G and
A5: f/.k = G*(i,j) by A1,A3,Lm2;
 take i;
 thus
A6: 1 <= i & i <= len G by A4,GOBOARD5:1;
 let p;
A7: 1 <= j & j <= width G by A4,GOBOARD5:1;
A8: f/.k in LSeg(f,k) by A3,TOPREAL1:27;
 assume p in LSeg(f,k);
 hence p`1 = (f/.k)`1 by A2,A8,SPPOL_1:def 3
          .= G*(i,1)`1 by A5,A6,A7,GOBOARD5:3;
 end;
 suppose
A9: not(1 <= k & k+1 <= len f);
 take 1;
       0 <> len G by GOBOARD1:def 5;
 hence 1 <= 1 & 1 <= len G by NAT_1:14;
 thus thesis by A9,TOPREAL1:def 5;
end;
end;

theorem Th16:
  f is_sequence_on G & f is special & i <= len G & j <= width G
    implies
   Int cell(G,i,j) misses L~f
proof
  assume that
A1: f is_sequence_on G and
A2: f is special and
A3: i <= len G and
A4: j <= width G;
 assume Int cell(G,i,j) meets L~f;
 then consider x being set such that
A5: x in Int cell(G,i,j) and
A6: x in L~f by XBOOLE_0:3;
       L~f = union { LSeg(f,k) : 1 <= k & k+1 <= len f } by TOPREAL1:def 6;
  then consider X being set such that
A7: x in X and
A8: X in { LSeg(f,k) : 1 <= k & k+1 <= len f } by A6,TARSKI:def 4;
  consider k such that
A9: X = LSeg(f,k) and
         1 <= k & k+1 <= len f by A8;
  reconsider p = x as Point of TOP-REAL 2 by A7,A9;
A10: Int cell(G,i,j)
           = Int v_strip(G,i) /\ Int h_strip(G,j) by TOPS_1:46;
 per cases by A2,SPPOL_1:41;
 suppose LSeg(f,k) is horizontal;
  then consider j0 being Element of NAT such that
A11: 1 <= j0 & j0 <= width G and
A12: for p being Point of TOP-REAL 2
       st p in LSeg(f,k) holds p`2 = G*(1,j0)`2 by A1,Th14;
        now assume
A13: p in Int h_strip(G,j);
A14: j0 > j implies j0 >= j+1 by NAT_1:13;
    per cases by A14,REAL_1:def 5;
    suppose
A15:    j0 < j;
      then j >= 1 by A11,XXREAL_0:2;
      then A16:    p`2 > G*(1,j)`2 by A4,A13,GOBOARD6:30;
           0 <> len G by GOBOARD1:def 5;
      then 1 <= len G by NAT_1:14;
      then G*(1,j)`2 > G*(1,j0)`2 by A4,A11,A15,GOBOARD5:5;
     hence contradiction by A7,A9,A12,A16;
    end;
    suppose j0 = j;
      then p`2 > G*(1,j0)`2 by A11,A13,GOBOARD6:30;
     hence contradiction by A7,A9,A12;
    end;
    suppose
A17:    j0 > j+1;
      then j+1 <= width G by A11,XXREAL_0:2;
      then j < width G by NAT_1:13;
      then A18:    p`2 < G*(1,j+1)`2 by A13,GOBOARD6:31;
           0 <> len G by GOBOARD1:def 5;
      then 1 <= len G & j+1 >= 1 by NAT_1:14;
      then G*(1,j+1)`2 < G*(1,j0)`2 by A11,A17,GOBOARD5:5;
     hence contradiction by A7,A9,A12,A18;
    end;
    suppose
A19:   j0 = j+1;
      then j < width G by A11,NAT_1:13;
      then p`2 < G*(1,j0)`2 by A13,A19,GOBOARD6:31;
     hence contradiction by A7,A9,A12;
   end;
   end;
 hence contradiction by A5,A10,XBOOLE_0:def 3;
 end;
 suppose LSeg(f,k) is vertical;
  then consider i0 being Element of NAT such that
A20: 1 <= i0 & i0 <= len G and
A21: for p being Point of TOP-REAL 2
  st p in LSeg(f,k) holds p`1 = G*(i0,1)`1 by A1,Th15;
        now assume
A22: p in Int v_strip(G,i);
A23: i0 > i implies i0 >= i+1 by NAT_1:13;
    per cases by A23,REAL_1:def 5;
    suppose
A24:    i0 < i;
      then i >= 1 by A20,XXREAL_0:2;
      then A25:    p`1 > G*(i,1)`1 by A3,A22,GOBOARD6:32;
           0 <> width G by GOBOARD1:def 5;
      then 1 <= width G by NAT_1:14;
      then G*(i,1)`1 > G*(i0,1)`1 by A3,A20,A24,GOBOARD5:4;
     hence contradiction by A7,A9,A21,A25;
    end;
    suppose i0 = i;
      then p`1 > G*(i0,1)`1 by A20,A22,GOBOARD6:32;
     hence contradiction by A7,A9,A21;
    end;
    suppose
A26:    i0 > i+1;
      then i+1 <= len G by A20,XXREAL_0:2;
      then i < len G by NAT_1:13;
      then A27:    p`1 < G*(i+1,1)`1 by A22,GOBOARD6:33;
           0 <> width G by GOBOARD1:def 5;
      then 1 <= width G & i+1 >= 1 by NAT_1:14;
      then G*(i+1,1)`1 < G*(i0,1)`1 by A20,A26,GOBOARD5:4;
     hence contradiction by A7,A9,A21,A27;
    end;
    suppose
A28:   i0 = i+1;
      then i < len G by A20,NAT_1:13;
      then p`1 < G*(i0,1)`1 by A22,A28,GOBOARD6:33;
     hence contradiction by A7,A9,A21;
   end;
   end;
 hence contradiction by A5,A10,XBOOLE_0:def 3;
end;
end;

theorem Th17:
  f is_sequence_on G & f is special & 1 <= k & k+1 <= len f
    implies
   Int left_cell(f,k,G) misses L~f & Int right_cell(f,k,G) misses L~f
proof
  assume that
A1: f is_sequence_on G & f is special and
A2: 1 <= k and
A3: k+1 <= len f;

  consider i1,j1,i2,j2 being Element of NAT such that
A4: [i1,j1] in Indices G and
A5: f/.k = G*(i1,j1) and
A6: [i2,j2] in Indices G and
A7: f/.(k+1) = G*(i2,j2) and
A8: i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
      i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A1,A2,A3,JORDAN8:6;

A9: i1+1 > i1 & j1+1 > j1 & i2+1 > i2 & j2+1 > j2 by NAT_1:13;
A10: i1 <= len G & j1 <= width G by A4,GOBOARD5:1;
A11: i2 <= len G & j2 <= width G by A6,GOBOARD5:1;
A12: i1-'1 <= len G & j1-'1 <= width G by A10,BINARITH:62;
A13: i2-'1 <= len G & j2-'1 <= width G by A11,BINARITH:62;

  per cases by A8;
  suppose
  A14: i1 = i2 & j1+1 = j2;
  then A15: right_cell(f,k,G) = cell(G,i1,j1)
       by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
         left_cell(f,k,G) = cell(G,i1-'1,j1)
       by A1,A2,A3,A4,A5,A6,A7,A9,A14,GOBRD13:def 3;
    hence thesis by A1,A10,A12,A15,Th16;

  end;
  suppose
  A16: i1+1 = i2 & j1 = j2;
  then A17: right_cell(f,k,G) = cell(G,i1,j1-'1)
        by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
         left_cell(f,k,G) = cell(G,i1,j1)
        by A1,A2,A3,A4,A5,A6,A7,A9,A16,GOBRD13:def 3;
    hence thesis by A1,A10,A12,A17,Th16;

  end;
  suppose
  A18: i1 = i2+1 & j1 = j2;
  then A19: right_cell(f,k,G) = cell(G,i2,j2)
        by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
         left_cell(f,k,G) = cell(G,i2,j2-'1)
        by A1,A2,A3,A4,A5,A6,A7,A9,A18,GOBRD13:def 3;
    hence thesis by A1,A11,A13,A19,Th16;

  end;
  suppose
  A20: i1 = i2 & j1 = j2+1;
  then A21: right_cell(f,k,G) = cell(G,i1-'1,j2)
        by A1,A2,A3,A4,A5,A6,A7,A9,GOBRD13:def 2;
         left_cell(f,k,G) = cell(G,i1,j2)
        by A1,A2,A3,A4,A5,A6,A7,A9,A20,GOBRD13:def 3;
    hence thesis by A1,A10,A11,A12,A21,Th16;
end;
end;

theorem Th18:
  1 <= i & i+1 <= len G & 1 <= j & j+1 <= width G
    implies
   G*(i,j)`1 = G*(i,j+1)`1 & G*(i,j)`2 = G*(i+1,j)`2 &
     G*(i+1,j+1)`1 = G*(i+1,j)`1 & G*(i+1,j+1)`2 = G*(i,j+1)`2
proof
  assume that
A1: 1 <= i and
A2: i+1 <= len G and
A3: 1 <= j and
A4: j+1 <= width G;

A5: i < len G by A2,NAT_1:13;
A6: j < width G by A4,NAT_1:13;
A7: 1 <= i+1 by NAT_1:11;
A8: 1 <= j+1 by NAT_1:11;
  thus G*(i,j)`1 = G*(i,1)`1 by A1,A3,A5,A6,GOBOARD5:3
                .= G*(i,j+1)`1 by A1,A4,A5,A8,GOBOARD5:3;
  thus G*(i,j)`2 = G*(1,j)`2 by A1,A3,A5,A6,GOBOARD5:2
                .= G*(i+1,j)`2 by A2,A3,A6,A7,GOBOARD5:2;
  thus G*(i+1,j+1)`1 = G*(i+1,1)`1 by A2,A4,A7,A8,GOBOARD5:3
                    .= G*(i+1,j)`1 by A2,A3,A6,A7,GOBOARD5:3;
  thus G*(i+1,j+1)`2 = G*(1,j+1)`2 by A2,A4,A7,A8,GOBOARD5:2
                    .= G*(i,j+1)`2 by A1,A4,A5,A8,GOBOARD5:2;
end;

theorem Th19:
  for i,j being Element of NAT
   st 1 <= i & i+1 <= len G & 1 <= j & j+1 <= width G
    holds
   p in cell(G,i,j) iff
     G*(i,j)`1 <= p`1 & p`1 <= G*(i+1,j)`1 & G*(i,j)`2 <= p`2 & p`2 <=
 G*(i,j+1)`2
proof
  let i,j be Element of NAT such that
A1: 1 <= i & i+1 <= len G and
A2: 1 <= j & j+1 <= width G;

A3: i < len G by A1,NAT_1:13;
A4: j < width G by A2,NAT_1:13;
then A5: v_strip(G,i) = { |[r,s]| : G*(i,j)`1 <= r & r <= G*(i+1,j)`1 } by A1
,A2,A3,GOBOARD5:9;
A6: h_strip(G,j) = { |[r,s]| : G*(i,j)`2 <= s & s <= G*(i,j+1)`2 } by A1,A2,A3
,A4,GOBOARD5:6;
  hereby
    assume p in cell(G,i,j);
  then A7: p in v_strip(G,i) & p in h_strip(G,j) by XBOOLE_0:def 3;
     then ex r,s st |[r,s]| = p & G*(i,j)`1 <= r & r <= G*(i+1,j)`1 by A5;
    hence G*(i,j)`1 <= p`1 & p`1 <= G*(i+1,j)`1 by EUCLID:56;
          ex r,s st |[r,s]| = p & G*(i,j)`2 <= s & s <= G*(i,j+1)`2 by A6,A7;
    hence G*(i,j)`2 <= p`2 & p`2 <= G*(i,j+1)`2 by EUCLID:56;
  end;
  assume that
A8: G*(i,j)`1 <= p`1 & p`1 <= G*(i+1,j)`1 and
A9: G*(i,j)`2 <= p`2 & p`2 <= G*(i,j+1)`2;

A10: p = |[p`1,p`2]| by EUCLID:57;
then A11: p in v_strip(G,i) by A5,A8;
       p in h_strip(G,j) by A6,A9,A10;
  hence thesis by A11,XBOOLE_0:def 3;
end;

theorem
       1 <= i & i+1 <= len G & 1 <= j & j+1 <= width G
    implies
   cell(G,i,j) = { |[r,s]| : G*(i,j)`1 <= r & r <= G*(i+1,j)`1 &
     G*(i,j)`2 <= s & s <= G*(i,j+1)`2 }
proof
  assume that
A1: 1 <= i & i+1 <= len G and
A2: 1 <= j & j+1 <= width G;

  set A = { |[r,s]| : G*(i,j)`1 <= r & r <= G*(i+1,j)`1 &
    G*(i,j)`2 <= s & s <= G*(i,j+1)`2 };

       now
    let p be set;
    assume
  A3: p in cell(G,i,j);
    then reconsider q=p as Point of TOP-REAL 2;
  A4: p = |[q`1,q`2]| by EUCLID:57;
         G*(i,j)`1 <= q`1 & q`1 <= G*(i+1,j)`1 & G*(i,j)`2 <= q`2 & q`2 <=
 G*(i,j+1)`2
      by A1,A2,A3,Th19;
    hence p in A by A4;
  end;
  hence cell(G,i,j) c= A by TARSKI:def 3;

       now
    let p be set;
    assume p in A;
    then consider r,s such that
  A5: |[r,s]| = p and
  A6: G*(i,j)`1 <= r & r <= G*(i+1,j)`1 and
  A7: G*(i,j)`2 <= s & s <= G*(i,j+1)`2;
    reconsider q=p as Point of TOP-REAL 2 by A5;
         r = q`1 & s = q`2 by A5,EUCLID:56;
    hence p in cell(G,i,j) by A1,A2,A6,A7,Th19;
  end;
  hence A c= cell(G,i,j) by TARSKI:def 3;
end;

theorem Th21:
  1 <= i & i+1 <= len G & 1 <= j & j+1 <= width G &
    p in Values G & p in cell(G,i,j)
      implies
   p = G*(i,j) or p = G*(i,j+1) or p = G*(i+1,j+1) or p = G*(i+1,j)
proof
  assume that
A1: 1 <= i and
A2: i+1 <= len G and
A3: 1 <= j and
A4: j+1 <= width G and
A5: p in Values G and
A6: p in cell(G,i,j);

A7: Values G = { G*(k,l) where k,l is Element of NAT: [k,l] in Indices G }
 by GOBRD13:7;
A8: i < len G by A2,NAT_1:13;
A9: j < width G by A4,NAT_1:13;
A10: 1 <= i+1 by NAT_1:11;
A11: 1 <= j+1 by NAT_1:11;

  consider k,l being Element of NAT such that
A12: p = G*(k,l) and
A13: [k,l] in Indices G by A5,A7;
A14: 1 <= k & k <= len G & 1 <= l & l <= width G by A13,GOBOARD5:1;
A15: now
    assume
A16:  k <> i & k <> i+1;
    per cases by A16,NAT_1:9;
    suppose
           k < i;
      then G*(k,l)`1 < G*(i,l)`1 by A8,A14,GOBOARD5:4;
      then G*(k,l)`1 < G*(i,1)`1 by A1,A8,A14,GOBOARD5:3;
      then G*(k,l)`1 < G*(i,j)`1 by A1,A3,A8,A9,GOBOARD5:3;
      hence contradiction by A1,A2,A3,A4,A6,A12,Th19;
    end;
    suppose
           i+1 < k;
      then G*(i+1,l)`1 < G*(k,l)`1 by A10,A14,GOBOARD5:4;
      then G*(i+1,1)`1 < G*(k,l)`1 by A2,A10,A14,GOBOARD5:3;
      then G*(i+1,j)`1 < G*(k,l)`1 by A2,A3,A9,A10,GOBOARD5:3;
      hence contradiction by A1,A2,A3,A4,A6,A12,Th19;
  end;
  end;
       now
    assume
A17: l <> j & l <> j+1;
    per cases by A17,NAT_1:9;
    suppose
           l < j;
      then G*(k,l)`2 < G*(k,j)`2 by A9,A14,GOBOARD5:5;
      then G*(k,l)`2 < G*(1,j)`2 by A3,A9,A14,GOBOARD5:2;
      then G*(k,l)`2 < G*(i,j)`2 by A1,A3,A8,A9,GOBOARD5:2;
      hence contradiction by A1,A2,A3,A4,A6,A12,Th19;
    end;
    suppose
           j+1 < l;
      then G*(k,j+1)`2 < G*(k,l)`2 by A11,A14,GOBOARD5:5;
      then G*(1,j+1)`2 < G*(k,l)`2 by A4,A11,A14,GOBOARD5:2;
      then G*(i,j+1)`2 < G*(k,l)`2 by A1,A4,A8,A11,GOBOARD5:2;
      hence contradiction by A1,A2,A3,A4,A6,A12,Th19;
  end;
  end;
  hence thesis by A12,A15;
end;

theorem Th22:
  1 <= i & i+1 <= len G & 1 <= j & j+1 <= width G
    implies
   G*(i,j) in cell(G,i,j) & G*(i,j+1) in cell(G,i,j) &
     G*(i+1,j+1) in cell(G,i,j) & G*(i+1,j) in cell(G,i,j)
proof
  assume that
A1: 1 <= i and
A2: i+1 <= len G and
A3: 1 <= j and
A4: j+1 <= width G;
A5: i < i+1 & j < j+1 by NAT_1:13;
A6: i < len G by A2,NAT_1:13;
A7: j < width G by A4,NAT_1:13;

then A8: G*(i,j)`1 <= G*(i+1,j)`1 by A1,A2,A3,A5,GOBOARD5:4;
       G*(i,j)`2 <= G*(i,j+1)`2 by A1,A3,A4,A5,A6,GOBOARD5:5;
  hence G*(i,j) in cell(G,i,j) by A1,A2,A3,A4,A8,Th19;

A9: G*(i,j)`1 = G*(i,j+1)`1 by A1,A2,A3,A4,Th18;
then A10: G*(i,j+1)`1 <= G*(i+1,j)`1 by A1,A2,A3,A5,A7,GOBOARD5:4;
       G*(i,j)`2 <= G*(i,j+1)`2 by A1,A3,A4,A5,A6,GOBOARD5:5;
  hence G*(i,j+1) in cell(G,i,j) by A1,A2,A3,A4,A9,A10,Th19;

A11: G*(i+1,j+1)`1 = G*(i+1,j)`1 by A1,A2,A3,A4,Th18;
then A12: G*(i,j)`1 <= G*(i+1,j+1)`1 by A1,A2,A3,A5,A7,GOBOARD5:4;
A13: G*(i+1,j+1)`2 = G*(i,j+1)`2 by A1,A2,A3,A4,Th18;
  then G*(i,j)`2 <= G*(i+1,j+1)`2 by A1,A3,A4,A5,A6,GOBOARD5:5;
  hence G*(i+1,j+1) in cell(G,i,j) by A1,A2,A3,A4,A11,A12,A13,Th19;

A14: G*(i,j)`1 <= G*(i+1,j)`1 by A1,A2,A3,A5,A7,GOBOARD5:4;
A15: G*(i,j)`2 = G*(i+1,j)`2 by A1,A2,A3,A4,Th18;
  then G*(i+1,j)`2 <= G*(i,j+1)`2 by A1,A3,A4,A5,A6,GOBOARD5:5;
  hence G*(i+1,j) in cell(G,i,j) by A1,A2,A3,A4,A14,A15,Th19;
end;

theorem Th23:
  1 <= i & i+1 <= len G & 1 <= j & j+1 <= width G &
    p in Values G & p in cell(G,i,j)
      implies
   p is_extremal_in cell(G,i,j)
proof
  assume that
A1: 1 <= i and
A2: i+1 <= len G and
A3: 1 <= j and
A4: j+1 <= width G and
A5: p in Values G and
A6: p in cell(G,i,j);
       for a,b being Point of TOP-REAL 2 st p in
 LSeg(a,b) & LSeg(a,b) c= cell(G,i,j)
    holds p = a or p = b
  proof
    let a,b be Point of TOP-REAL 2 such that
  A7: p in LSeg(a,b) and
  A8: LSeg(a,b) c= cell(G,i,j);
    assume
  A9: a <> p & b <> p;
  A10: a in LSeg(a,b) & b in LSeg(a,b) by TOPREAL1:6;
    per cases by A1,A2,A3,A4,A5,A6,Th21;
    suppose
    A11: p = G*(i,j);
    then A12: p`1 <= a`1 & p`2 <= a`2 by A1,A2,A3,A4,A8,A10,Th19;
    A13: p`1 <= b`1 & p`2 <= b`2 by A1,A2,A3,A4,A8,A10,A11,Th19;
           now
        per cases;
        suppose
               a`1 <= b`1 & a`2 <= b`2;
          then a`1 <= p`1 & a`2 <= p`2 by A7,TOPREAL1:9,10;
          then a`1 = p`1 & a`2 = p`2 by A12,REAL_1:def 5;
          hence contradiction by A9,TOPREAL3:11;
        end;
        suppose
               a`1 <= b`1 & b`2 < a`2;
          then a`1 <= p`1 & b`2 <= p`2 by A7,TOPREAL1:9,10;
        then A14: a`1 = p`1 & b`2 = p`2 by A12,A13,REAL_1:def 5;
          then a`2 <> p`2 by A9,TOPREAL3:11;
          then LSeg(a,b) is vertical by A7,A10,A14,SPPOL_1:39;
          then a`1 = b`1 by SPPOL_1:37;
          hence contradiction by A9,A14,TOPREAL3:11;
        end;
        suppose
               b`1 < a`1 & a`2 <= b`2;
          then b`1 <= p`1 & a`2 <= p`2 by A7,TOPREAL1:9,10;
        then A15: b`1 = p`1 & a`2 = p`2 by A12,A13,REAL_1:def 5;
          then b`2 <> p`2 by A9,TOPREAL3:11;
          then LSeg(a,b) is vertical by A7,A10,A15,SPPOL_1:39;
          then a`1 = b`1 by SPPOL_1:37;
          hence contradiction by A9,A15,TOPREAL3:11;
        end;
        suppose
               b`1 < a`1 & b`2 < a`2;
          then b`1 <= p`1 & b`2 <= p`2 by A7,TOPREAL1:9,10;
          then b`1 = p`1 & b`2 = p`2 by A13,REAL_1:def 5;
          hence contradiction by A9,TOPREAL3:11;
      end;
      end;
      hence contradiction;

    end;
    suppose
    A16: p = G*(i,j+1);
    then A17: p`1 = G*(i,j)`1 by A1,A2,A3,A4,Th18;
    then A18: p`1 <= a`1 & a`2 <= p`2 by A1,A2,A3,A4,A8,A10,A16,Th19;
    A19: p`1 <= b`1 & b`2 <= p`2 by A1,A2,A3,A4,A8,A10,A16,A17,Th19;
           now
        per cases;
        suppose
               a`1 <= b`1 & a`2 <= b`2;
          then a`1 <= p`1 & p`2 <= b`2 by A7,TOPREAL1:9,10;
        then A20: a`1 = p`1 & b`2 = p`2 by A18,A19,REAL_1:def 5;
          then a`2 <> p`2 by A9,TOPREAL3:11;
          then LSeg(a,b) is vertical by A7,A10,A20,SPPOL_1:39;
          then a`1 = b`1 by SPPOL_1:37;
          hence contradiction by A9,A20,TOPREAL3:11;
        end;
        suppose
               a`1 <= b`1 & b`2 < a`2;
          then a`1 <= p`1 & p`2 <= a`2 by A7,TOPREAL1:9,10;
          then a`1 = p`1 & a`2 = p`2 by A18,REAL_1:def 5;
          hence contradiction by A9,TOPREAL3:11;
        end;
        suppose
               b`1 < a`1 & a`2 <= b`2;
          then b`1 <= p`1 & p`2 <= b`2 by A7,TOPREAL1:9,10;
          then b`1 = p`1 & b`2 = p`2 by A19,REAL_1:def 5;
          hence contradiction by A9,TOPREAL3:11;
        end;
        suppose
               b`1 < a`1 & b`2 < a`2;
          then b`1 <= p`1 & p`2 <= a`2 by A7,TOPREAL1:9,10;
        then A21: b`1 = p`1 & a`2 = p`2 by A18,A19,REAL_1:def 5;
          then b`2 <> p`2 by A9,TOPREAL3:11;
          then LSeg(a,b) is vertical by A7,A10,A21,SPPOL_1:39;
          then a`1 = b`1 by SPPOL_1:37;
          hence contradiction by A9,A21,TOPREAL3:11;
      end;
      end;
      hence contradiction;

    end;
    suppose
           p = G*(i+1,j+1);
    then A22: p`1 = G*(i+1,j)`1 & p`2 = G*(i,j+1)`2 by A1,A2,A3,A4,Th18;
    then A23: a`1 <= p`1 & a`2 <= p`2 by A1,A2,A3,A4,A8,A10,Th19;
    A24: b`1 <= p`1 & b`2 <= p`2 by A1,A2,A3,A4,A8,A10,A22,Th19;
           now
        per cases;
        suppose
               a`1 <= b`1 & a`2 <= b`2;
          then p`1 <= b`1 & p`2 <= b`2 by A7,TOPREAL1:9,10;
          then b`1 = p`1 & b`2 = p`2 by A24,REAL_1:def 5;
          hence contradiction by A9,TOPREAL3:11;
        end;
        suppose
               a`1 <= b`1 & b`2 < a`2;
          then p`1 <= b`1 & p`2 <= a`2 by A7,TOPREAL1:9,10;
        then A25: b`1 = p`1 & a`2 = p`2 by A23,A24,REAL_1:def 5;
          then b`2 <> p`2 by A9,TOPREAL3:11;
          then LSeg(a,b) is vertical by A7,A10,A25,SPPOL_1:39;
          then a`1 = b`1 by SPPOL_1:37;
          hence contradiction by A9,A25,TOPREAL3:11;
        end;
        suppose
               b`1 < a`1 & a`2 <= b`2;
          then p`1 <= a`1 & p`2 <= b`2 by A7,TOPREAL1:9,10;
        then A26: a`1 = p`1 & b`2 = p`2 by A23,A24,REAL_1:def 5;
          then a`2 <> p`2 by A9,TOPREAL3:11;
          then LSeg(a,b) is vertical by A7,A10,A26,SPPOL_1:39;
          then a`1 = b`1 by SPPOL_1:37;
          hence contradiction by A9,A26,TOPREAL3:11;
        end;
        suppose
               b`1 < a`1 & b`2 < a`2;
          then p`1 <= a`1 & p`2 <= a`2 by A7,TOPREAL1:9,10;
          then a`1 = p`1 & a`2 = p`2 by A23,REAL_1:def 5;
          hence contradiction by A9,TOPREAL3:11;
      end;
      end;
      hence contradiction;
    end;
    suppose
    A27: p = G*(i+1,j);
    then A28: p`2 = G*(i,j)`2 by A1,A2,A3,A4,Th18;
    then A29: a`1 <= p`1 & p`2 <= a`2 by A1,A2,A3,A4,A8,A10,A27,Th19;
    A30: b`1 <= p`1 & p`2 <= b`2 by A1,A2,A3,A4,A8,A10,A27,A28,Th19;
           now
        per cases;
        suppose
               a`1 <= b`1 & a`2 <= b`2;
          then p`1 <= b`1 & a`2 <= p`2 by A7,TOPREAL1:9,10;
        then A31: b`1 = p`1 & a`2 = p`2 by A29,A30,REAL_1:def 5;
          then b`2 <> p`2 by A9,TOPREAL3:11;
          then LSeg(a,b) is vertical by A7,A10,A31,SPPOL_1:39;
          then a`1 = b`1 by SPPOL_1:37;
          hence contradiction by A9,A31,TOPREAL3:11;
        end;
        suppose
               a`1 <= b`1 & b`2 < a`2;
          then p`1 <= b`1 & b`2 <= p`2 by A7,TOPREAL1:9,10;
          then b`1 = p`1 & b`2 = p`2 by A30,REAL_1:def 5;
          hence contradiction by A9,TOPREAL3:11;
        end;
        suppose
               b`1 < a`1 & a`2 <= b`2;
          then p`1 <= a`1 & a`2 <= p`2 by A7,TOPREAL1:9,10;
          then a`1 = p`1 & a`2 = p`2 by A29,REAL_1:def 5;
          hence contradiction by A9,TOPREAL3:11;
        end;
        suppose
               b`1 < a`1 & b`2 < a`2;
          then p`1 <= a`1 & b`2 <= p`2 by A7,TOPREAL1:9,10;
        then A32: a`1 = p`1 & b`2 = p`2 by A29,A30,REAL_1:def 5;
          then a`2 <> p`2 by A9,TOPREAL3:11;
          then LSeg(a,b) is vertical by A7,A10,A32,SPPOL_1:39;
          then a`1 = b`1 by SPPOL_1:37;
          hence contradiction by A9,A32,TOPREAL3:11;
      end;
      end;
      hence contradiction;
  end;
  end;
  hence thesis by A6,SPPOL_1:def 1;
end;

theorem Th24:
  2 <= len G & 2 <= width G & f is_sequence_on G & 1 <= k & k+1 <= len f
    implies
   ex i,j st 1 <= i & i+1 <= len G & 1 <= j & j+1 <= width G &
     LSeg(f,k) c= cell(G,i,j)
proof
  assume that
A1: 2 <= len G and
A2: 2 <= width G and
A3: f is_sequence_on G and
A4: 1 <= k and
A5: k+1 <= len f;

A6: LSeg(f,k) = LSeg(f/.k, f/.(k+1)) by A4,A5,TOPREAL1:def 5;

  consider i1,j1,i2,j2 being Element of NAT such that
A7: [i1,j1] in Indices G and
A8: f/.k = G*(i1,j1) and
A9: [i2,j2] in Indices G and
A10: f/.(k+1) = G*(i2,j2) and
A11: i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or i1 = i2+1 & j1 = j2 or
      i1 = i2 & j1 = j2+1 by A3,A4,A5,JORDAN8:6;
A12: 1 <= i1 & i1 <= len G & 1 <= j1 & j1 <= width G by A7,GOBOARD5:1;
A13: 1 <= i2 & i2 <= len G & 1 <= j2 & j2 <= width G by A9,GOBOARD5:1;

  per cases by A11;
  suppose
  A14: i1 = i2 & j1+1 = j2;
  then A15: j1 < width G by A13,SPPOL_1:5;
         now
      per cases by A12,REAL_1:def 5;
      suppose
             i1 < len G;
      then A16: i1+1 <= len G by NAT_1:13;
        take i1,j1;
             LSeg(f,k) c= cell(G,i1,j1) by A6,A8,A10,A12,A14,A15,GOBOARD5:20;
        hence thesis by A12,A13,A14,A16;
      end;
      suppose
      A17: i1 = len G;
        take i1'=i1-'1,j1;
             2-1 <= 2-'1 & 2-'1 <= i1' by A1,A17,BINARITH:60,def 3;
      then A18: 1 <= i1' by XXREAL_0:2;
      A19: i1'+1 = i1 by A12,BINARITH:53;
           then i1' < len G by A12,NAT_1:13;
        then LSeg(f,k) c= cell(G,i1',j1) by A6,A8,A10,A12,A14,A15,A19,
GOBOARD5:19;
        hence thesis by A12,A13,A14,A18,A19;
    end;
    end;
    hence thesis;
  end;
  suppose
  A20: i1+1 = i2 & j1 = j2;
  then A21: i1 < len G by A13,SPPOL_1:5;
         now
      per cases by A12,REAL_1:def 5;
      suppose
             j1 < width G;
      then A22: j1+1 <= width G by NAT_1:13;
        take i1,j1;
             LSeg(f,k) c= cell(G,i1,j1) by A6,A8,A10,A12,A20,A21,GOBOARD5:23;
        hence thesis by A12,A13,A20,A22;
      end;
      suppose
      A23: j1 = width G;
        take i1,j1'=j1-'1;
             2-1 <= 2-'1 & 2-'1 <= j1' by A2,A23,BINARITH:60,def 3;
      then A24: 1 <= j1' by XXREAL_0:2;
      A25: j1'+1=j1 by A12,BINARITH:53;
      then j1' < width G by A23,NAT_1:13;
        then LSeg(f,k) c= cell(G,i1,j1') by A6,A8,A10,A12,A20,A21,A25,
GOBOARD5:22;
        hence thesis by A12,A13,A20,A24,A25;
    end;
    end;
    hence thesis;
  end;
  suppose
  A26: i1 = i2+1 & j1 = j2;
  then A27: i2 < len G by A12,SPPOL_1:5;
         now
      per cases by A12,REAL_1:def 5;
      suppose
             j1 < width G;
      then A28: j1+1 <= width G by NAT_1:13;
        take i2,j1;
             LSeg(f,k) c= cell(G,i2,j1) by A6,A8,A10,A13,A26,A27,GOBOARD5:23;
        hence thesis by A12,A13,A26,A28;
      end;
      suppose
      A29: j1 = width G;
        take i2,j1'=j1-'1;
             2-1 <= 2-'1 & 2-'1 <= j1' by A2,A29,BINARITH:60,def 3;
      then A30: 1 <= j1' by XXREAL_0:2;
      A31: j1'+1=j1 by A12,BINARITH:53;
      then j1' < width G by A29,NAT_1:13;
        then LSeg(f,k) c= cell(G,i2,j1') by A6,A8,A10,A13,A26,A27,A31,
GOBOARD5:22;
        hence thesis by A12,A13,A26,A30,A31;
    end;
    end;
    hence thesis;
  end;
  suppose
  A32: i1 = i2 & j1 = j2+1;
  then A33: j2 < width G by A12,SPPOL_1:5;
         now
      per cases by A12,REAL_1:def 5;
      suppose
             i1 < len G;
      then A34: i1+1 <= len G by NAT_1:13;
        take i1,j2;
             LSeg(f,k) c= cell(G,i1,j2) by A6,A8,A10,A13,A32,A33,GOBOARD5:20;
        hence thesis by A12,A13,A32,A34;
      end;
      suppose
      A35: i1 = len G;
        take i1'=i1-'1,j2;
             2-1 <= 2-'1 & 2-'1 <= i1' by A1,A35,BINARITH:60,def 3;
      then A36: 1 <= i1' by XXREAL_0:2;
      A37: i1'+1 = i1 by A12,BINARITH:53;
           then i1' < len G by A12,NAT_1:13;
        then LSeg(f,k) c= cell(G,i1',j2) by A6,A8,A10,A13,A32,A33,A37,
GOBOARD5:19;
        hence thesis by A12,A13,A32,A36,A37;
    end;
    end;
    hence thesis;
end;
end;

theorem Th25:
  2 <= len G & 2 <= width G & f is_sequence_on G & 1 <= k & k+1 <= len f &
    p in Values G & p in LSeg(f,k)
      implies
   p = f/.k or p = f/.(k+1)
proof
  assume that
A1: 2 <= len G and
A2: 2 <= width G and
A3: f is_sequence_on G and
A4: 1 <= k and
A5: k+1 <= len f and
A6: p in Values G and
A7: p in LSeg(f,k);

  consider i,j such that
A8: 1 <= i & i+1 <= len G and
A9: 1 <= j & j+1 <= width G and
A10: LSeg(f,k) c= cell(G,i,j) by A1,A2,A3,A4,A5,Th24;
A11: LSeg(f,k) = LSeg(f/.k, f/.(k+1)) by A4,A5,TOPREAL1:def 5;
       p is_extremal_in cell(G,i,j) by A6,A7,A8,A9,A10,Th23;
  hence thesis by A7,A10,A11,SPPOL_1:def 1;
end;

theorem
       [i,j] in Indices G & 1 <= k & k <= width G implies G*(i,j)`1 <= G*
(len G,k)`1
proof
  assume that
A1: [i,j] in Indices G and
A2: 1 <= k & k <= width G;
A3: 1 <= i & i <= len G & 1 <= j & j <= width G by A1,GOBOARD5:1;
then A4: G*(i,j)`1 = G*(i,1)`1 by GOBOARD5:3
             .= G*(i,k)`1 by A2,A3,GOBOARD5:3;
       i < len G or i = len G by A3,REAL_1:def 5;
 hence thesis by A2,A3,A4,GOBOARD5:4;
end;

theorem
       [i,j] in Indices G & 1 <= k & k <= len G implies G*(i,j)`2 <= G*
(k,width G)`2
proof
  assume that
A1: [i,j] in Indices G and
A2: 1 <= k & k <= len G;
A3: 1 <= i & i <= len G & 1 <= j & j <= width G by A1,GOBOARD5:1;
then A4: G*(i,j)`2 = G*(1,j)`2 by GOBOARD5:2
             .= G*(k,j)`2 by A2,A3,GOBOARD5:2;
       j < width G or j = width G by A3,REAL_1:def 5;
 hence thesis by A2,A3,A4,GOBOARD5:5;
end;

theorem Th28:
  f is_sequence_on G & f is special & L~g c= L~f & 1 <= k & k+1 <= len f
    implies
   for A being Subset of TOP-REAL 2 st
    A = right_cell(f,k,G)\L~g or A = left_cell(f,k,G)\L~g holds A is connected
proof
  assume that
A1: f is_sequence_on G & f is special & L~g c= L~f and
A2: 1 <= k and
A3: k+1 <= len f;
  let A be Subset of TOP-REAL 2 such that
A4: A = right_cell(f,k,G)\L~g or A = left_cell(f,k,G)\L~g;

  per cases by A4;
  suppose
  A5: A = right_cell(f,k,G)\L~g;

then A6: A = right_cell(f,k,G) /\ (L~g)` by SUBSET_1:32;
A7: A c= right_cell(f,k,G) by A5,XBOOLE_1:36;

  A8: Int right_cell(f,k,G) is connected by A1,A2,A3,Th12;
         Int right_cell(f,k,G) misses L~f by A1,A2,A3,Th17;
    then Int right_cell(f,k,G) misses L~g by A1,XBOOLE_1:63;
  then A9: Int right_cell(f,k,G) c= (L~g)` by SUBSET_1:43;
         Int right_cell(f,k,G) c= right_cell(f,k,G) by TOPS_1:44;
  then A10: Int right_cell(f,k,G) c= A by A6,A9,XBOOLE_1:19;
         A c= Cl Int right_cell(f,k,G) by A1,A2,A3,A7,Th13;
  hence A is connected by A8,A10,CONNSP_1:19;

  end;
  suppose
  A11: A = left_cell(f,k,G)\L~g;

then A12: A = left_cell(f,k,G) /\ (L~g)` by SUBSET_1:32;
A13: A c= left_cell(f,k,G) by A11,XBOOLE_1:36;

  A14: Int left_cell(f,k,G) is connected by A1,A2,A3,Th12;
         Int left_cell(f,k,G) misses L~f by A1,A2,A3,Th17;
    then Int left_cell(f,k,G) misses L~g by A1,XBOOLE_1:63;
  then A15: Int left_cell(f,k,G) c= (L~g)` by SUBSET_1:43;
         Int left_cell(f,k,G) c= left_cell(f,k,G) by TOPS_1:44;
  then A16: Int left_cell(f,k,G) c= A by A12,A15,XBOOLE_1:19;
         A c= Cl Int left_cell(f,k,G) by A1,A2,A3,A13,Th13;
  hence A is connected by A14,A16,CONNSP_1:19;
end;
end;

theorem Th29:
  for f being non constant standard special_circular_sequence st
    f is_sequence_on G
  for k st 1 <= k & k+1 <= len f
    holds
   right_cell(f,k,G)\L~f c= RightComp f & left_cell(f,k,G)\L~f c= LeftComp f
proof
  let f be non constant standard special_circular_sequence such that
A1: f is_sequence_on G;
  let k such that
A2: 1 <= k & k+1 <= len f;

  set rc = right_cell(f,k,G)\L~f;
A3: rc = right_cell(f,k,G) /\ (L~f)` by SUBSET_1:32;
A4: rc c= right_cell(f,k,G) by XBOOLE_1:36;
       right_cell(f,k,G) c= right_cell(f,k) by A1,A2,GOBRD13:34;
  then rc c= right_cell(f,k) by A4,XBOOLE_1:1;
then A5: Int rc c= Int right_cell(f,k) by TOPS_1:48;
       Int right_cell(f,k) c= RightComp f by A2,GOBOARD9:28;
then A6: Int rc c= RightComp f by A5,XBOOLE_1:1;
A7: Int right_cell(f,k,G) <> {} by A1,A2,Th11;
A8:  Int right_cell(f,k,G) misses L~f by A1,A2,Th17;
A9: Int right_cell(f,k,G) c= right_cell(f,k,G) by TOPS_1:44;
       rc \/ L~f = right_cell(f,k,G) \/ L~f by XBOOLE_1:39;
  then right_cell(f,k,G) c= rc \/ L~f by XBOOLE_1:7;
then Int right_cell(f,k,G) c= rc \/ L~f by A9,XBOOLE_1:1;
then A10: Int right_cell(f,k,G) c= rc by A8,XBOOLE_1:73;
  then Int Int right_cell(f,k,G) c= Int rc by TOPS_1:48;
then A11: rc meets Int rc by A7,A10,XBOOLE_1:68;
  A12: rc is connected by A1,A2,Th28;
  A13: RightComp f is_a_component_of (L~f)` by GOBOARD9:def 2;
       rc c= (L~f)` by A3,XBOOLE_1:17;
  hence right_cell(f,k,G)\L~f c= RightComp f by A6,A11,A12,A13,GOBOARD9:6;
  set lc = left_cell(f,k,G)\L~f;
A14: lc = left_cell(f,k,G) /\ (L~f)` by SUBSET_1:32;
A15: lc c= left_cell(f,k,G) by XBOOLE_1:36;
       left_cell(f,k,G) c= left_cell(f,k) by A1,A2,GOBRD13:34;
  then lc c= left_cell(f,k) by A15,XBOOLE_1:1;
then A16: Int lc c= Int left_cell(f,k) by TOPS_1:48;
       Int left_cell(f,k) c= LeftComp f by A2,GOBOARD9:24;
then A17: Int lc c= LeftComp f by A16,XBOOLE_1:1;
A18: Int left_cell(f,k,G) <> {} by A1,A2,Th11;
A19:  Int left_cell(f,k,G) misses L~f by A1,A2,Th17;
A20: Int left_cell(f,k,G) c= left_cell(f,k,G) by TOPS_1:44;
       lc \/ L~f = left_cell(f,k,G) \/ L~f by XBOOLE_1:39;
  then left_cell(f,k,G) c= lc \/ L~f by XBOOLE_1:7;
then Int left_cell(f,k,G) c= lc \/ L~f by A20,XBOOLE_1:1;
then A21: Int left_cell(f,k,G) c= lc by A19,XBOOLE_1:73;
  then Int Int left_cell(f,k,G) c= Int lc by TOPS_1:48;
then A22: lc meets Int lc by A18,A21,XBOOLE_1:68;
  A23: lc is connected by A1,A2,Th28;
  A24: LeftComp f is_a_component_of (L~f)` by GOBOARD9:def 1;
       lc c= (L~f)` by A14,XBOOLE_1:17;
  hence left_cell(f,k,G)\L~f c= LeftComp f by A17,A22,A23,A24,GOBOARD9:6;
end;

begin :: Cages

reserve
  C for compact non vertical non horizontal non empty Subset of TOP-REAL 2,
  l, m, i1, i2, j1, j2 for Element of NAT;

theorem Th30:
  for n being Nat
  ex i st 1 <= i & i+1 <= len Gauge(C,n) &
    N-min C in cell(Gauge(C,n),i,width Gauge(C,n)-'1) &
      N-min C <> Gauge(C,n)*(i,width Gauge(C,n)-'1)
proof
  let n be Nat;
A1: n in NAT by ORDINAL1:def 13;
 set G = Gauge(C,n);
A2: len G = width G by JORDAN8:def 1;
 defpred P[Nat]
   means 1 <= $1 & $1 < len G & G*($1,(width G)-'1)`1 < (N-min C)`1;
A3:  for k be Nat st P[k] holds k <= len G;
A4:  len G = 2|^n+3 & len G = width G by JORDAN8:def 1;
A5:  len G >= 4 by JORDAN8:13;
then A6:  1 < len G by XXREAL_0:2;
then A7:  1 <= (len G)-'1 by BINARITH:67;
A8:  (len G)-'1 <= len G by BINARITH:52;
       (NW-corner C)`1 <= (N-min C)`1 by PSCOMP_1:97;
then A9:  W-bound C <= (N-min C)`1 by EUCLID:56;
A10:  2 <= len G by A5,XXREAL_0:2;
       G*(2,(width G)-'1)`1 = W-bound C by A1,A2,A7,A8,JORDAN8:14;
  then G*(1,(width G)-'1)`1 < W-bound C by A4,A7,A8,A10,GOBOARD5:4;
  then G*(1,(width G)-'1)`1 < (N-min C)`1 by A9,XXREAL_0:2;
then A11:  ex k be Nat st P[k] by A6;
     ex i being Nat st P[i] &
     for n be Nat st P[n] holds n <= i from NAT_1:sch 6(A3,A11);
  then consider i being Nat such that
A12:  1 <= i & i < len G and
A13:  G*(i,(width G)-'1)`1 < (N-min C)`1 and
A14:  for n be Nat st P[n] holds n <= i;
      reconsider i as Element of NAT by ORDINAL1:def 13;
 take i;
 thus 1 <= i & i+1 <= len G by A12,NAT_1:13;
A15:  LSeg(G*(i,(width G)-'1),G*(i+1,(width G)-'1)) c= cell(G,i,(width G)-'1)
      by A4,A7,A8,A12,GOBOARD5:23;
A16:  i+1 <= len G by A12,NAT_1:13;
A17:  1 <= i+1 by NAT_1:12;
      (N-min C)`2 = N-bound C by EUCLID:56;
then A18:  G*(i,(width G)-'1)`2 = (N-min C)`2 & (N-min C)`2 = G*
(i+1,(width G)-'1)`2
      by A1,A2,A12,A16,A17,JORDAN8:17;
       now assume i+1 = len G;
   then len G-'1 = i by BINARITH:39;
then A19:   G*(i,(width G)-'1)`1 = E-bound C by A1,A2,A7,A8,JORDAN8:15;
        (NE-corner C)`1 >= (N-min C)`1 by PSCOMP_1:97;
   hence contradiction by A13,A19,EUCLID:56;
  end;
 then i+1 < len G & i < i+1 by A16,NAT_1:13,REAL_1:def 5;
 then (N-min C)`1 <= G*(i+1,(width G)-'1)`1 by A14,A17;
 then N-min C in LSeg(G*(i,(width G)-'1),G*(i+1,(width G)-'1))
   by A13,A18,GOBOARD7:9;
 hence N-min C in cell(G,i,(width G)-'1) by A15;
 thus N-min C <> G*(i,(width G)-'1) by A13;
end;

theorem Th31:
  for n, i1, i2 being Nat holds
  1 <= i1 & i1+1 <= len Gauge(C,n) &
     N-min C in cell(Gauge(C,n),i1,width Gauge(C,n)-'1) &
       N-min C <> Gauge(C,n)*(i1,width Gauge(C,n)-'1) &
    1 <= i2 & i2+1 <= len Gauge(C,n) &
      N-min C in cell(Gauge(C,n),i2,width Gauge(C,n)-'1) &
        N-min C <> Gauge(C,n)*(i2,width Gauge(C,n)-'1)
    implies
   i1 = i2
proof
  let n, i1, i2 be Nat;
A1: i1 in NAT & i2 in NAT by ORDINAL1:def 13;
  set G = Gauge(C,n), j = width G-'1;
  assume that
A2:  1 <= i1 & i1+1 <= len G and
A3:  N-min C in cell(G,i1,j) and
A4:  N-min C <> G*(i1,j) and
A5:  1 <= i2 & i2+1 <= len G and
A6:  N-min C in cell(G,i2,j) and
A7:  N-min C <> G*(i2,j) and
A8:  i1 <> i2;
A9: i1 < len G & i2 < len G & len G = width G by A2,A5,JORDAN8:def 1,NAT_1:13;
A10:  cell(G,i1,j) meets cell(G,i2,j) by A3,A6,XBOOLE_0:3;
A11:  len G = 2|^n+3 & len G = width G by JORDAN8:def 1;
A12:  2|^n >= n+1 by NEWTON:104;
   then len G >= n+1+3 by A11,XREAL_1:8;
   then len G >= 1+ (n+3) & 1+ (n+3) > 1+0 by XREAL_1:8;
then A13:  len G > 1 by XXREAL_0:2;
   then len G >= 1+1 by NAT_1:13;
then A14:  1 <= j by A9,JORDAN5B:2;
A15:  j+1 = len G by A9,A13,BINARITH:53;
then A16:  j < len G by NAT_1:13;
 per cases by A8,REAL_1:def 5;
  suppose
A17:   i1 < i2;
then A18:   i2-'i1+i1 = i2 by BINARITH:53;
     then i2-'i1 <= 1 by A1,A9,A10,A14,A16,JORDAN8:10;
     then i2-'i1 < 1 or i2-'i1 = 1 by REAL_1:def 5;
     then i2-'i1 = 0 or i2-'i1 = 1 by NAT_1:14;
    then cell(G,i1,j) /\ cell(G,i2,j) = LSeg(G*(i2,j),G*(i2,j+1))
        by A1,A9,A14,A16,A17,A18,GOBOARD5:26;
    then A19:  N-min C in LSeg(G*(i2,j),G*(i2,j+1)) by A3,A6,XBOOLE_0:def 3;
A20:  [i2,j] in Indices G by A1,A5,A9,A14,A16,GOBOARD7:10;
         1 <= j+1 by NAT_1:12;
then A21:  [i2,j+1] in Indices G by A1,A5,A9,A15,GOBOARD7:10;
     set x = (W-bound C)+(((E-bound C)-(W-bound C))/(2|^n))*(i2-2);
     set y1 = (S-bound C)+(((N-bound C)-(S-bound C))/(2|^n))*(j-2);
     set y2 = (S-bound C)+(((N-bound C)-(S-bound C))/(2|^n))*(j-1);
A22:   j+1-(1+1) = j-1;
A23:   G*(i2,j) = |[x,y1]| by A20,JORDAN8:def 1;
       G*(i2,j+1) = |[x,y2]| by A21,A22,JORDAN8:def 1;
then A24:  G*(i2,j)`1 = x & G*(i2,j+1)`1 = x by A23,EUCLID:56;
     then LSeg(G*(i2,j),G*(i2,j+1)) is vertical by SPPOL_1:37;
then A25:  (N-min C)`1 = G*(i2,j)`1 by A19,SPPOL_1:64;
          j = (2|^n+2+1)-'1 by A11
      .= (2|^n+2) by BINARITH:39;
     then (((N-bound C)-(S-bound C))/(2|^n))*(j-2) = (N-bound C)-(S-bound C)
       by A12,XCMPLX_1:88;
   hence contradiction by A7,A23,A24,A25,EUCLID:56;
  end;
  suppose
A26:   i2 < i1;
then A27:   i1-'i2+i2 = i1 by BINARITH:53;
     then i1-'i2 <= 1 by A1,A9,A10,A14,A16,JORDAN8:10;
     then i1-'i2 < 1 or i1-'i2 = 1 by REAL_1:def 5;
     then i1-'i2 = 0 or i1-'i2 = 1 by NAT_1:14;
    then cell(G,i2,j) /\ cell(G,i1,j) = LSeg(G*(i1,j),G*(i1,j+1))
        by A1,A9,A14,A16,A26,A27,GOBOARD5:26;
    then A28:  N-min C in LSeg(G*(i1,j),G*(i1,j+1)) by A3,A6,XBOOLE_0:def 3;
A29:  [i1,j] in Indices G by A1,A2,A9,A14,A16,GOBOARD7:10;
         1 <= j+1 by NAT_1:12;
then A30:  [i1,j+1] in Indices G by A1,A2,A9,A15,GOBOARD7:10;
     set x = (W-bound C)+(((E-bound C)-(W-bound C))/(2|^n))*(i1-2);
     set y1 = (S-bound C)+(((N-bound C)-(S-bound C))/(2|^n))*(j-2);
     set y2 = (S-bound C)+(((N-bound C)-(S-bound C))/(2|^n))*(j-1);
A31:   j+1-(1+1) = j-1;
A32:   G*(i1,j) = |[x,y1]| by A29,JORDAN8:def 1;
       G*(i1,j+1) = |[x,y2]| by A30,A31,JORDAN8:def 1;
then A33:  G*(i1,j)`1 = x & G*(i1,j+1)`1 = x by A32,EUCLID:56;
    then LSeg(G*(i1,j),G*(i1,j+1)) is vertical by SPPOL_1:37;
then A34:  (N-min C)`1 = G*(i1,j)`1 by A28,SPPOL_1:64;
          j = (2|^n+2+1)-'1 by A11
      .= (2|^n+2) by BINARITH:39;
     then (((N-bound C)-(S-bound C))/(2|^n))*(j-2) = (N-bound C)-(S-bound C)
       by A12,XCMPLX_1:88;
   hence contradiction by A4,A32,A33,A34,EUCLID:56;
end;
end;

theorem Th32:
  for n being Nat
  for f being standard non constant special_circular_sequence
    st f is_sequence_on Gauge(C,n) &
      (for k st 1 <= k & k+1 <= len f
         holds
        left_cell(f,k,Gauge(C,n)) misses C &
          right_cell(f,k,Gauge(C,n)) meets C) &
      (ex i st 1 <= i & i+1 <= len Gauge(C,n) &
        f/.1 = Gauge(C,n)*(i,width Gauge(C,n)) &
          f/.2 = Gauge(C,n)*(i+1,width Gauge(C,n)) &
            N-min C in cell(Gauge(C,n),i,width Gauge(C,n)-'1) &
              N-min C <> Gauge(C,n)*(i,width Gauge(C,n)-'1))
  holds
 N-min L~f = f/.1
proof
  let n be Nat;
  set G = Gauge(C,n);
  let f be standard non constant special_circular_sequence such that
A1: f is_sequence_on G and
A2: for k st 1 <= k & k+1 <= len f
       holds left_cell(f,k,G) misses C & right_cell(f,k,G) meets C;
  given i' being Element of NAT such that
A3:    1 <= i' & i'+1 <= len G and
A4:    f/.1 = G*(i',width G) and
A5:    f/.2 = G*(i'+1,width G) and
A6:    N-min C in cell(G,i',width G-'1) and
A7:    N-min C <> G*(i',width G-'1);
A8: i' < len G & len G = width G by A3,JORDAN8:def 1,NAT_1:13;
      len f > 4 by GOBOARD7:36;
then A9: len f >= 2 by XXREAL_0:2;
A10:  len G = 2|^n+3 & len G = width G by JORDAN8:def 1;
    then len G >= 3 by NAT_1:12;
then A11:  1 < len G by XXREAL_0:2;
     set W = W-bound C, S = S-bound C, E = E-bound C, N = N-bound C;
          N-min L~f in rng f by SPRECT_2:43;
     then consider m being Nat such that
A12:    m in dom f and
A13:    f.m = N-min L~f by FINSEQ_2:11;
        reconsider m as Element of NAT by ORDINAL1:def 13;
A14:    f/.m = f.m by A12,PARTFUN1:def 8;
A15:    (N-min L~f)`2 = N-bound L~f by EUCLID:56;
A16:    2|^n > 0 by NEWTON:102;
          N > S by JORDAN8:12;
     then N-S > 0 by XREAL_1:52;
then A17:    (N-S)/(2|^n) > 0 by A16,REAL_2:127;
A18:    1 <= m & m <= len f by A12,FINSEQ_3:27;
     consider i,j such that
A19:     [i,j] in Indices G and
A20:     f/.m = G*(i,j) by A1,A12,GOBOARD1:def 11;
A21:     1 <= i & i <= len G & 1 <= j & j <= width G by A19,GOBOARD5:1;
          G*(i,j) = |[W+((E-W)/(2|^n))*(i-2), S+((N-S)/(2|^n))*(j-2)]|
       by A19,JORDAN8:def 1;
then A22:     S+((N-S)/(2|^n))*(j-2) = N-bound L~f by A13,A14,A15,A20,EUCLID:56
;
          1 in dom f by FINSEQ_5:6;
     then A23:    f/.1 in L~f by A9,GOBOARD1:16;
then A24:    N-bound L~f >= (f/.1)`2 by PSCOMP_1:71;
          G*(i',j)`2 = G*(1,j)`2 & G*(i,j)`2 = G*
(1,j)`2 by A3,A8,A21,GOBOARD5:2;
     then G*(i,j)`2 <= G*(i',len G)`2 by A3,A8,A21,SPRECT_3:24;
then A25:    N-bound L~f = (f/.1)`2 by A4,A8,A13,A14,A15,A20,A24,XXREAL_0:1;
          [i',len G] in Indices G by A3,A8,A11,GOBOARD7:10;
     then G*(i',len G)=|[W+((E-W)/(2|^n))*(i'-2),S+((N-S)/(2|^n))*(len G-2)]|
      by JORDAN8:def 1;
     then S+((N-S)/(2|^n))*(len G-2) = N-bound L~f by A4,A8,A25,EUCLID:56;
     then A26: len G-2 = j-2 by A17,A22,XCMPLX_1:5;
A27:    (NW-corner C)`1 = W & (NE-corner C)`1 = E &
         (NW-corner C)`2 = N & (NE-corner C)`2 = N by EUCLID:56;
A28:    G*(i',len G)`1 = G*(i',1)`1 by A3,A8,A21,A26,GOBOARD5:3;
A29:    G*(i,len G)`1 = G*(i,1)`1 by A21,A26,GOBOARD5:3;
A30:    (NW-corner L~f)`1 = W-bound L~f & (NE-corner L~f)`1 = E-bound L~f &
         (NW-corner L~f)`2 = N-bound L~f & (NE-corner L~f)`2 = N-bound L~f
          by EUCLID:56;
          W-bound L~f <= (f/.1)`1 & (f/.1)`1 <= E-bound L~f by A23,PSCOMP_1:71;
     then f/.1 in LSeg(NW-corner L~f, NE-corner L~f) by A25,A30,GOBOARD7:9;
     then f/.1 in LSeg(NW-corner L~f, NE-corner L~f) /\ L~f
       by A23,XBOOLE_0:def 3;
then A31:    (N-min L~f)`1 <= (f/.1)`1 by PSCOMP_1:98;
A32:    1 <= len G-'1 by A11,BINARITH:67;
then A33:    len G-'1 < len G by BINARITH:69;
A34:    len G-'1+1 = len G by A11,BINARITH:53;
     then N-min C in { |[r',s']| where r',s' is Real:
               G*(i',1)`1 <= r' & r' <= G*(i'+1,1)`1 &
                   G*(1,len G-'1)`2 <= s' & s' <= G*(1,len G)`2 }
         by A3,A6,A8,A32,A33,GOBRD11:32;
     then consider r',s' being Real such that
A35:    N-min C = |[r',s']| and
A36:    G*(i',1)`1 <= r' & r' <= G*(i'+1,1)`1 and
             G*(1,len G-'1)`2 <= s' & s' <= G*(1,len G)`2;
A37:    (f/.1)`1 <= (N-min C)`1 by A4,A8,A28,A35,A36,EUCLID:56;
then A38:    (N-min L~f)`1 <= (N-min C)`1 by A31,XXREAL_0:2;
A39:    G*(i',len G-'1)`1 = G*(i',1)`1 by A3,A8,A32,A33,GOBOARD5:3;
A40:    N-min C = |[(N-min C)`1,(N-min C)`2]| by EUCLID:57;
A41:    G*(i',len G-'1) = |[G*(i',len G-'1)`1,G*(i',len G-'1)`2]|
          by EUCLID:57;
A42:    (N-min C)`2 = N by EUCLID:56;
A43:   n in NAT by ORDINAL1:def 13;
        then G*(i',len G-'1)`2 = N by A3,A8,JORDAN8:17;
then A44:    G*(i',len G-'1)`1 < (N-min C)`1
         by A4,A7,A8,A28,A37,A39,A40,A41,A42,REAL_1:def 5;
A45: i <= i' by A3,A4,A8,A13,A14,A20,A21,A26,A31,GOBOARD5:4;
     then A46:    i < len G by A8,XXREAL_0:2;
then A47:   i+1 <= len G by NAT_1:13;
     per cases by A18,REAL_1:def 5;
     suppose m = len f;
       hence N-min L~f = f/.1 by A13,A14,FINSEQ_6:def 1;
     end;
     suppose m < len f;
then A48:    m+1 <= len f by NAT_1:13;
then A49:    right_cell(f,m,G) meets C by A2,A18;
      then consider p being set such that
A50:     p in right_cell(f,m,G) & p in C by XBOOLE_0:3;
      reconsider p as Point of TOP-REAL 2 by A50;
      consider i1,j1,i2,j2 being Element of NAT such that
A51:     [i1,j1] in Indices G & f/.m = G*(i1,j1) and
A52:     [i2,j2] in Indices G & f/.(m+1) = G*(i2,j2) and
A53:     i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
        i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A1,A18,A48,JORDAN8:6;
A54:     1 <= i2 & i2 <= len G & 1 <= j2 & j2 <= len G by A10,A52,GOBOARD5:1;
A55:     (N-min C)`2 = N by EUCLID:56;
then A56:     p`2 <= (N-min C)`2 by A50,PSCOMP_1:71;
A57:     G*(1,len G-'1)`2 = N by A11,A43,JORDAN8:17;
A58:     G*(1,len G-'1)`2 < G*(1,len G)`2 by A10,A11,A32,A33,GOBOARD5:5;
A59:     W <= p`1 & p`1 <= E by A50,PSCOMP_1:71;
          now per cases by A19,A20,A26,A51,A53,GOBOARD1:21;
      suppose i = i2 & len G+1 = j2;
       hence N-min L~f = f/.1 by A54,NAT_1:13;
      end;
      suppose i+1 = i2 & len G = j2;
then A60:     right_cell(f,m,G) = cell(G,i,len G-'1)
           by A1,A18,A19,A20,A26,A48,A52,GOBRD13:25;
A61:     cell(G,i,len G-'1) = {|[r,s]| : G*(i,1)`1 <= r & r <= G*(i+1,1)`1 &
           G*(1,len G-'1)`2 <= s & s <= G*(1,len G-'1+1)`2 }
          by A10,A21,A32,A33,A46,GOBRD11:32;
       then consider r,s such that
A62:     p = |[r,s]| and
A63:     G*(i,1)`1 <= r & r <= G*(i+1,1)`1 and
A64:     G*(1,len G-'1)`2 <= s & s <= G*(1,len G-'1+1)`2 by A50,A60;
A65:     p`1 = r & p`2 = s by A62,EUCLID:56;
       then p`2 = N by A55,A56,A57,A64,XXREAL_0:1;
       then p in LSeg(NW-corner C, NE-corner C) by A27,A59,GOBOARD7:9;
       then p in LSeg(NW-corner C, NE-corner C) /\ C
         by A50,XBOOLE_0:def 3;
       then (N-min C)`1 <= p`1 by PSCOMP_1:98;
         then (N-min C)`1 <= G*(i+1,1)`1 by A63,A65,XXREAL_0:2;
       then A66:     N-min C in cell(G,i,width G-'1)
               by A8,A13,A14,A20,A26,A29,A34,A38,A40,A55,A57,A58,A61;
            N-min C <> G*(i,len G-'1) by A8,A21,A32,A33,A44,A45,SPRECT_3:25;
       hence N-min L~f = f/.1
          by A3,A4,A6,A7,A8,A13,A14,A20,A21,A26,A43,A47,A66,Th31;
      end;
      suppose
A67:     i = i2+1 & len G = j2;
then A68:     right_cell(f,m,G) = cell(G,i2,len G)
           by A1,A18,A19,A20,A26,A48,A52,GOBRD13:27;
            i2 < len G by A21,A67,NAT_1:13;
       hence N-min L~f = f/.1 by A49,A68,JORDAN8:18;
      end;
      suppose
A69:     i = i2 & len G = j2+1;
then A70:     j2 = len G-'1 by BINARITH:39;
then A71:     right_cell(f,m,G) = cell(G,i-'1,len G-'1)
          by A1,A18,A19,A20,A26,A48,A52,A69,GOBRD13:29;
            now assume
A72:      m = 1;
            1 <= i'+1 & i'+1<= len G by A3,NAT_1:13;
       then G*(i',len G)`2 = G*(1,len G)`2 & G*(i'+1,len G)`2 = G*
(1,len G)`2 by A3,A8,A11,GOBOARD5:2;
        hence contradiction
         by A4,A5,A8,A20,A21,A26,A32,A33,A52,A69,A70,A72,GOBOARD5:5;
       end;
       then m > 1 by A18,REAL_1:def 5;
then A73:   m-'1 >= 1 by BINARITH:67;
A74:   m-'1+1 = m by A18,BINARITH:53;
            m-'1 <= m by BINARITH:52;
then A75:   m-'1 <= len f by A18,XXREAL_0:2;
       consider i1',j1',i2',j2' being Element of NAT such that
A76:     [i1',j1'] in Indices G & f/.(m-'1) = G*(i1',j1') and
A77:     [i2',j2'] in Indices G & f/.m = G*(i2',j2') and
A78:     i1' = i2' & j1'+1 = j2' or i1'+1 = i2' & j1' = j2' or
          i1' = i2'+1 & j1' = j2' or i1' = i2' & j1' = j2'+1
           by A1,A18,A73,A74,JORDAN8:6;
A79:     1 <= i1' & i1' <= len G & 1 <= j1' &
           j1' <= len G by A10,A76,GOBOARD5:1;
            now per cases by A19,A20,A26,A77,A78,GOBOARD1:21;
        suppose
A80:        i1' = i & j1'+1 = len G;
         then j1' = len G-'1 by BINARITH:39;
         then left_cell(f,m-'1,G) = cell(G,i-'1,len G-'1)
           by A1,A18,A19,A20,A26,A73,A74,A76,A80,GOBRD13:22;
         hence contradiction by A2,A18,A49,A71,A73,A74;
        end;
        suppose
A81:     i1'+1 = i & j1' = len G;
         then i1' < i by NAT_1:13;
then A82:     (f/.(m-'1))`1 < (f/.m)`1 by A20,A21,A26,A76,A79,A81,GOBOARD5:4;
A83:     G*(i1',j)`2 = G*(1,j)`2 & G*(i,j)`2 = G*(1,j)`2
           by A21,A79,GOBOARD5:2;
              m-'1 in dom f by A73,A75,FINSEQ_3:27;
then A84:     f/.(m-'1) in L~f by A9,GOBOARD1:16;
         then W-bound L~f <= (f/.(m-'1))`1 &
           (f/.(m-'1))`1 <= E-bound L~f by PSCOMP_1:71;
         then f/.(m-'1) in LSeg(NW-corner L~f, NE-corner L~f)
          by A13,A14,A15,A20,A26,A30,A76,A81,A83,GOBOARD7:9;
         then f/.(m-'1) in LSeg(NW-corner L~f, NE-corner L~f) /\ L~f
          by A84,XBOOLE_0:def 3;
         hence contradiction by A13,A14,A82,PSCOMP_1:98;
        end;
        suppose i1' = i+1 & j1' = len G;
         then right_cell(f,m-'1,G) = cell(G,i,len G)
           by A1,A18,A19,A20,A26,A73,A74,A76,GOBRD13:27;
         then cell(G,i,len G) meets C by A2,A18,A73,A74;
         hence contradiction by A21,JORDAN8:18;
        end;
        suppose i1' = i & j1' = len G+1;
         then len G+1 <= len G+0 by A10,A76,GOBOARD5:1;
         hence contradiction by XREAL_1:8;
       end;
       end;
       hence N-min L~f = f/.1;
     end;
     end;
     hence N-min L~f = f/.1;
end;
end;

definition
  let C be compact non vertical non horizontal non empty Subset of TOP-REAL 2;
  let n be Nat;
  assume
A1:    C is connected;
  func Cage(C,n) -> clockwise_oriented
    (standard non constant special_circular_sequence) means
:Def1:
  it is_sequence_on Gauge(C,n) &
    (ex i st 1 <= i & i+1 <= len Gauge(C,n) &
      it/.1 = Gauge(C,n)*(i,width Gauge(C,n)) &
        it/.2 = Gauge(C,n)*(i+1,width Gauge(C,n)) &
          N-min C in cell(Gauge(C,n),i,width Gauge(C,n)-'1) &
            N-min C <> Gauge(C,n)*(i,width Gauge(C,n)-'1)) &
    for k st 1 <= k & k+2 <= len it holds
      (front_left_cell(it,k,Gauge(C,n)) misses C &
        front_right_cell(it,k,Gauge(C,n)) misses C
          implies
         it turns_right k,Gauge(C,n)) &
      (front_left_cell(it,k,Gauge(C,n)) misses C &
        front_right_cell(it,k,Gauge(C,n)) meets C
          implies
         it goes_straight k,Gauge(C,n)) &
      (front_left_cell(it,k,Gauge(C,n)) meets C
        implies
       it turns_left k,Gauge(C,n));
existence
proof
   reconsider n1=n as Element of NAT by ORDINAL1:def 13;
   set G = Gauge(C,n);
   set W = W-bound C, E = E-bound C, S = S-bound C, N = N-bound C;
A2:   len G = 2|^n+3 & len G = width G by JORDAN8:def 1;
   defpred P[Element of NAT,set,set] means
      ($1 = 0 implies
        ex i st 1 <= i & i+1 <= len G &
             N-min C in cell(G,i,width G-'1) & N-min C <> G*(i,width G-'1) &
            $3 = <*G*(i,width G)*>) &
      ($1 = 1 implies
         ex i st 1 <= i & i+1 <= len G &
             N-min C in cell(G,i,width G-'1) & N-min C <> G*(i,width G-'1) &
            $3 = <*G*(i,width G),G*(i+1,width G)*>) &
      ($1 > 1 & $2 is FinSequence of TOP-REAL 2 implies
        for f being FinSequence of TOP-REAL 2 st $2 = f holds
         (len f = $1 implies
          (f is_sequence_on G & right_cell(f,len f-'1,G) meets C implies
           (front_left_cell(f,(len f)-'1,G) misses C &
              front_right_cell(f,(len f)-'1,G) misses C
             implies ex i,j st
                f^<*G*(i,j)*> turns_right (len f)-'1,G &
              $3 = f^<*G*(i,j)*>) &
           (front_left_cell(f,(len f)-'1,G) misses C &
              front_right_cell(f,(len f)-'1,G) meets C
             implies ex i,j st
               f^<*G*(i,j)*> goes_straight (len f)-'1,G &
              $3 = f^<*G*(i,j)*>) &
           (front_left_cell(f,(len f)-'1,G) meets C
             implies ex i,j st
               f^<*G*(i,j)*> turns_left (len f)-'1,G &
              $3 = f^<*G*(i,j)*>)) &
          (not f is_sequence_on G or right_cell(f,len f-'1,G) misses C
           implies $3 = f^<*G*(1,1)*>)) &
         (len f <> $1 implies $3 = {})) &
       ($1 > 1 & $2 is not FinSequence of TOP-REAL 2 implies $3 = {});
A3:  for k being Element of NAT, x being set ex y being set st P[k,x,y]
   proof
    let k be Element of NAT, x be set;
    consider m being Element of NAT such that
A4:   1 <= m & m+1 <= len G and
A5:   N-min C in cell(G,m,width G-'1) &
        N-min C <> G*(m,width G-'1) by Th30;
    per cases by NAT_1:26;
    suppose
A6:    k=0;
     take <*G*(m,width G)*>;
     thus thesis by A4,A5,A6;
    end;
    suppose
A7:    k = 1;
     take <*G*(m,width G),G*(m+1,width G)*>;
     thus thesis by A4,A5,A7;
    end;
    suppose that
A8:    k > 1 and
A9:    x is FinSequence of TOP-REAL 2;
     reconsider f = x as FinSequence of TOP-REAL 2 by A9;
     thus thesis
     proof per cases;
      suppose
A10:      len f = k;
       thus thesis
        proof per cases;
         suppose
A11:         f is_sequence_on G & right_cell(f,len f-'1,G) meets C;
A12:         1 <= (len f)-'1 by A8,A10,BINARITH:67;
A13:         (len f) -'1 +1 = len f by A8,A10,BINARITH:53;
         then consider i1,j1,i2,j2 being Element of NAT such that
A14:         [i1,j1] in Indices G & f/.((len f) -'1) = G*(i1,j1) and
A15:         [i2,j2] in Indices G & f/.((len f) -'1+1) = G*(i2,j2) and
A16:         i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
             i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A11,A12,JORDAN8:6;
A17:        1 <= i1 & i1 <= len G & 1 <= j1 & j1 <= width G by A14,GOBOARD5:1;
A18:        1 <= i2 & i2 <= len G & 1 <= j2 & j2 <= width G by A15,GOBOARD5:1;
A19:       i1-'1 <= len G & j1-'1 <= width G by A17,BINARITH:62;
A20:        1 <= i2+1 & 1 <= j2+1 by NAT_1:12;
A21:       i2-'1 <= len G & j2-'1 <= width G by A18,BINARITH:62;
                (len f)-'1 <= len f by BINARITH:52;
then A22:        (len f)-'1 in dom f & (len f)-'1+1 in dom f
              by A8,A10,A12,A13,FINSEQ_3:27;
A23:        (len f)-'1+(1+1) = (len f)+1 by A13;
          thus thesis
          proof per cases;
           suppose
A24:          front_left_cell(f,(len f)-'1,G) misses C &
              front_right_cell(f,(len f)-'1,G) misses C;
            thus thesis
             proof per cases by A16;
              suppose
A25:              i1 = i2 & j1+1 = j2;
               take f1 = f^<*G*(i2+1,j2)*>;
                    now
                take i=i2+1 ,j=j2;
                thus f1 turns_right (len f)-'1,G
                 proof let i1',j1',i2',j2' be Element of NAT;
                  assume that
A26:                 [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A27:                 f1/.((len f)-'1) = G*(i1',j1') &
                    f1/.((len f)-'1+1) = G*(i2',j2');
                       f/.((len f)-'1) = G*(i1',j1') &
               f/.((len f)-'1+1) = G*(i2',j2') by A22,A27,FINSEQ_4:83;
then A28:                 i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                     by A14,A15,A26,GOBOARD1:21;
                  per cases by A16,A28;
                  case i1' = i2' & j1'+1 = j2';
                       now assume i2+1 > len G;
                   then i2+1 <= (len G)+1 & (len G)+1 <= i2+1
                    by A18,NAT_1:13,XREAL_1:8;
                   then i2+1 = (len G)+1 by XXREAL_0:1;
                   then cell(G,len G,j1) meets C
                    by A11,A12,A13,A14,A15,A25,GOBRD13:23;
                   hence contradiction by A2,A17,JORDAN8:19;
                  end;
                  hence [i2'+1,j2'] in Indices G by A18,A20,A28,GOBOARD7:10;
                  thus thesis by A23,A28,FINSEQ_4:82;
                 end;
                 case i1'+1 = i2' & j1' = j2';
                  hence thesis by A25,A28;
                 end;
                 case i1' = i2'+1 & j1' = j2';
                  hence thesis by A25,A28;
                 end;
                 case
               i1' = i2' & j1' = j2'+1;
                  hence thesis by A25,A28;
                 end;
                 end;
               end;
               hence thesis by A8,A10,A11,A24;
              end;
              suppose
A29:             i1+1 = i2 & j1 = j2;
               take f1 = f^<*G*(i2,j2-'1)*>;
                    now
                take i=i2 ,j=j2-'1;
                thus f1 turns_right (len f)-'1,G
                 proof let i1',j1',i2',j2' be Element of NAT;
                  assume that
A30:                 [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A31:                 f1/.((len f)-'1) = G*(i1',j1') &
                    f1/.((len f)-'1+1) = G*(i2',j2');
                       f/.((len f)-'1) = G*(i1',j1') &
            f/.((len f)-'1+1) = G*(i2',j2') by A22,A31,FINSEQ_4:83;
then A32:                 i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                     by A14,A15,A30,GOBOARD1:21;
                  per cases by A16,A32;
                  case i1' = i2' & j1'+1 = j2';
                   hence thesis by A29,A32;
                  end;
                  case i1'+1 = i2' & j1' = j2';
                       now assume j2-'1 < 1;
                   then j2-'1 = 0 by NAT_1:14;
                   then j2 <= 1 by BINARITH:54;
                   then j2 = 1 by A18,XXREAL_0:1;
                   then cell(G,i1,1-'1) meets C
                    by A11,A12,A13,A14,A15,A29,GOBRD13:25;
                   then cell(G,i1,0) meets C by BINARITH:51;
                   hence contradiction by A17,JORDAN8:20;
                  end;
                  hence [i2',j2'-'1] in Indices G by A18,A21,A32,GOBOARD7:10;
                  thus f1/.((len f)-'1+2) = G*(i2',j2'-'1)
                         by A23,A32,FINSEQ_4:82;
                  end;
                  case
                i1' = i2'+1 & j1' = j2';
                  hence thesis by A29,A32;
                  end;
                  case i1' = i2' & j1' = j2'+1;
                   hence thesis by A29,A32;
                 end;
                 end;
               end;
               hence thesis by A8,A10,A11,A24;
              end;
              suppose
A33:             i1 = i2+1 & j1 = j2;
               take f1 = f^<*G*(i2,j2+1)*>;
                    now
                take i=i2 ,j=j2+1;
                thus f1 turns_right (len f)-'1,G
                 proof let i1',j1',i2',j2' be Element of NAT;
                  assume that
A34:                 [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A35:                 f1/.((len f)-'1) = G*(i1',j1') &
                    f1/.((len f)-'1+1) = G*(i2',j2');
                       f/.((len f)-'1) = G*(i1',j1') &
               f/.((len f)-'1+1) = G*(i2',j2') by A22,A35,FINSEQ_4:83;
then A36:                 i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                     by A14,A15,A34,GOBOARD1:21;
                  per cases by A16,A36;
                  case i1' = i2' & j1'+1 = j2';
                   hence thesis by A33,A36;
                  end;
                  case
                i1'+1 = i2' & j1' = j2';
                  hence thesis by A33,A36;
                  end;
                  case i1' = i2'+1 & j1' = j2';
                       now assume j2+1 > len G;
                   then j2+1 <= (len G)+1 & (len G)+1 <= j2+1
                     by A2,A18,NAT_1:13,XREAL_1:8;
                   then j2+1 = (len G)+1 by XXREAL_0:1;
                   then cell(G,i2,len G) meets C
                    by A11,A12,A13,A14,A15,A33,GOBRD13:27;
                   hence contradiction by A18,JORDAN8:18;
                  end;
                  hence [i2',j2'+1] in Indices G by A2,A18,A20,A36,GOBOARD7:10
;
                  thus f1/.((len f)-'1+2) = G*(i2',j2'+1)
                      by A23,A36,FINSEQ_4:82;
                  end;
                  case i1' = i2' & j1' = j2'+1;
                   hence thesis by A33,A36;
                 end;
                 end;
               end;
               hence thesis by A8,A10,A11,A24;
              end;
              suppose
A37:             i1 = i2 & j1 = j2+1;
               take f1 = f^<*G*(i2-'1,j2)*>;
                    now
                take i=i2-'1 ,j=j2;
                thus f1 turns_right (len f)-'1,G
                 proof let i1',j1',i2',j2' be Element of NAT;
                  assume that
A38:                 [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A39:                 f1/.((len f)-'1) = G*(i1',j1') &
                    f1/.((len f)-'1+1) = G*(i2',j2');
                       f/.((len f)-'1) = G*(i1',j1') &
               f/.((len f)-'1+1) = G*(i2',j2') by A22,A39,FINSEQ_4:83;
then A40:                 i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                     by A14,A15,A38,GOBOARD1:21;
                  per cases by A16,A40;
                  case
                i1' = i2' & j1'+1 = j2';
                  hence thesis by A37,A40;
                  end;
                  case i1'+1 = i2' & j1' = j2';
                   hence thesis by A37,A40;
                  end;
                  case i1' = i2'+1 & j1' = j2';
                   hence thesis by A37,A40;
                  end;
                  case i1' = i2' & j1' = j2'+1;
                       now assume i2-'1 < 1;
                   then i2-'1 = 0 by NAT_1:14;
                   then i2 <= 1 by BINARITH:54;
                   then i2 = 1 by A18,XXREAL_0:1;
                   then cell(G,1-'1,j2) meets C
                    by A11,A12,A13,A14,A15,A37,GOBRD13:29;
                   then cell(G,0,j2) meets C by BINARITH:51;
                   hence contradiction by A2,A18,JORDAN8:21;
                  end;
                  hence [i2'-'1,j2'] in Indices G by A18,A21,A40,GOBOARD7:10;
                  thus f1/.((len f)-'1+2) = G*(i2'-'1,j2')
                              by A23,A40,FINSEQ_4:82;
                 end;
                 end;
               end;
               hence thesis by A8,A10,A11,A24;
             end;
             end;
           end;
           suppose
A41:          front_left_cell(f,(len f)-'1,G) misses C &
               front_right_cell(f,(len f)-'1,G) meets C;
            thus thesis
             proof per cases by A16;
              suppose
A42:              i1 = i2 & j1+1 = j2;
               take f1 = f^<*G*(i2,j2+1)*>;
                    now
                take i=i2 ,j=j2+1;
                thus f1 goes_straight (len f)-'1,G
                 proof let i1',j1',i2',j2' be Element of NAT;
                  assume that
A43:                 [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A44:                 f1/.((len f)-'1) = G*(i1',j1') &
                    f1/.((len f)-'1+1) = G*(i2',j2');
                       f/.((len f)-'1) = G*(i1',j1') &
             f/.((len f)-'1+1) = G*(i2',j2') by A22,A44,FINSEQ_4:83;
then A45:                 i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                     by A14,A15,A43,GOBOARD1:21;
                  per cases by A16,A45;
                  case i1' = i2' & j1'+1 = j2';
                       now assume j2+1 > len G;
                   then j2+1 <= (len G)+1 & (len G)+1 <= j2+1
                     by A2,A18,NAT_1:13,XREAL_1:8;
                   then j2+1 = (len G)+1 by XXREAL_0:1;
                   then cell(G,i1,len G) meets C
                    by A11,A12,A13,A14,A15,A41,A42,GOBRD13:36;
                   hence contradiction by A17,JORDAN8:18;
                  end;
                  hence [i2',j2'+1] in Indices G by A2,A18,A20,A45,GOBOARD7:10
;
                  thus f1/.((len f)-'1+2) = G*(i2',j2'+1)
                            by A23,A45,FINSEQ_4:82;
                  end;
                  case i1'+1 = i2' & j1' = j2';
                   hence thesis by A42,A45;
                  end;
                  case i1' = i2'+1 & j1' = j2';
                   hence thesis by A42,A45;
                  end;
                  case
                i1' = i2' & j1' = j2'+1;
                  hence thesis by A42,A45;
                 end;
                 end;
               end;
               hence thesis by A8,A10,A11,A41;
              end;
              suppose
A46:             i1+1 = i2 & j1 = j2;
               take f1 = f^<*G*(i2+1,j2)*>;
                    now
                take i=i2+1 ,j=j2;
                thus f1 goes_straight (len f)-'1,G
                 proof let i1',j1',i2',j2' be Element of NAT;
                  assume that
A47:                 [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A48:                 f1/.((len f)-'1) = G*(i1',j1') &
                    f1/.((len f)-'1+1) = G*(i2',j2');
                       f/.((len f)-'1) = G*(i1',j1') &
                 f/.((len f)-'1+1) = G*(i2',j2') by A22,A48,FINSEQ_4:83;
then A49:                 i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                     by A14,A15,A47,GOBOARD1:21;
                  per cases by A16,A49;
                  case i1' = i2' & j1'+1 = j2';
                   hence thesis by A46,A49;
                  end;
                  case i1'+1 = i2' & j1' = j2';
                       now assume i2+1 > len G;
                   then i2+1 <= (len G)+1 & (len G)+1 <= i2+1
                     by A18,NAT_1:13,XREAL_1:8;
                   then i2+1 = (len G)+1 by XXREAL_0:1;
                   then cell(G,len G,j1-'1) meets C
                     by A11,A12,A13,A14,A15,A41,A46,GOBRD13:38;
                   hence contradiction by A2,A19,JORDAN8:19;
                  end;
                  hence [i2'+1,j2'] in Indices G by A18,A20,A49,GOBOARD7:10;
                  thus f1/.((len f)-'1+2) = G*(i2'+1,j2')
                           by A23,A49,FINSEQ_4:82;
                  end;
                  case
                i1' = i2'+1 & j1' = j2';
                  hence thesis by A46,A49;
                  end;
                  case i1' = i2' & j1' = j2'+1;
                   hence thesis by A46,A49;
                 end;
                 end;
               end;
               hence thesis by A8,A10,A11,A41;
              end;
              suppose
A50:             i1 = i2+1 & j1 = j2;
               take f1 = f^<*G*(i2-'1,j2)*>;
                    now
                take i=i2-'1 ,j=j2;
                thus f1 goes_straight (len f)-'1,G
                 proof let i1',j1',i2',j2' be Element of NAT;
                  assume that
A51:                 [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A52:                 f1/.((len f)-'1) = G*(i1',j1') &
                    f1/.((len f)-'1+1) = G*(i2',j2');
                       f/.((len f)-'1) = G*(i1',j1') &
                f/.((len f)-'1+1) = G*(i2',j2') by A22,A52,FINSEQ_4:83;
then A53:                 i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                     by A14,A15,A51,GOBOARD1:21;
                  per cases by A16,A53;
                  case i1' = i2' & j1'+1 = j2';
                   hence thesis by A50,A53;
                  end;
                  case
                i1'+1 = i2' & j1' = j2';
                  hence thesis by A50,A53;
                  end;
                  case i1' = i2'+1 & j1' = j2';
                       now assume i2-'1 < 1;
                   then i2-'1 = 0 by NAT_1:14;
                   then i2 <= 1 by BINARITH:54;
                   then i2 = 1 by A18,XXREAL_0:1;
                   then cell(G,1-'1,j1) meets C
                    by A11,A12,A13,A14,A15,A41,A50,GOBRD13:40;
                   then cell(G,0,j1) meets C by BINARITH:51;
                   hence contradiction by A2,A17,JORDAN8:21;
                  end;
                  hence [i2'-'1,j2'] in Indices G by A18,A21,A53,GOBOARD7:10;
                  thus f1/.((len f)-'1+2) = G*(i2'-'1,j2')
                            by A23,A53,FINSEQ_4:82;
                  end;
                  case i1' = i2' & j1' = j2'+1;
                   hence thesis by A50,A53;
                 end;
                 end;
               end;
               hence thesis by A8,A10,A11,A41;
              end;
              suppose
A54:             i1 = i2 & j1 = j2+1;
               take f1 = f^<*G*(i2,j2-'1)*>;
                    now
                take i=i2 ,j=j2-'1;
                thus f1 goes_straight (len f)-'1,G
                 proof let i1',j1',i2',j2' be Element of NAT;
                  assume that
A55:                 [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A56:                 f1/.((len f)-'1) = G*(i1',j1') &
                    f1/.((len f)-'1+1) = G*(i2',j2');
                       f/.((len f)-'1) = G*(i1',j1') &
                f/.((len f)-'1+1) = G*(i2',j2') by A22,A56,FINSEQ_4:83;
then A57:                 i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                     by A14,A15,A55,GOBOARD1:21;
                  per cases by A16,A57;
                  case
                i1' = i2' & j1'+1 = j2';
                  hence thesis by A54,A57;
                  end;
                  case i1'+1 = i2' & j1' = j2';
                   hence thesis by A54,A57;
                  end;
                  case i1' = i2'+1 & j1' = j2';
                   hence thesis by A54,A57;
                  end;
                  case i1' = i2' & j1' = j2'+1;
                       now assume j2-'1 < 1;
                   then j2-'1 = 0 by NAT_1:14;
                   then j2 <= 1 by BINARITH:54;
                   then j2 = 1 by A18,XXREAL_0:1;
                   then cell(G,i1-'1,1-'1) meets C
                     by A11,A12,A13,A14,A15,A41,A54,GOBRD13:42;
                   then cell(G,i1-'1,0) meets C by BINARITH:51;
                   hence contradiction by A19,JORDAN8:20;
                  end;
                  hence [i2',j2'-'1] in Indices G by A18,A21,A57,GOBOARD7:10;
                  thus f1/.((len f)-'1+2) = G*(i2',j2'-'1)
                            by A23,A57,FINSEQ_4:82;
                 end;
                 end;
               end;
               hence thesis by A8,A10,A11,A41;
             end;
             end;
           end;
           suppose
A58:          front_left_cell(f,(len f)-'1,G) meets C;
            thus thesis
             proof per cases by A16;
              suppose
A59:              i1 = i2 & j1+1 = j2;
               take f1 = f^<*G*(i2-'1,j2)*>;
                    now
                take i=i2-'1 ,j=j2;
                thus f1 turns_left (len f)-'1,G
                 proof let i1',j1',i2',j2' be Element of NAT;
                  assume that
A60:                 [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A61:                 f1/.((len f)-'1) = G*(i1',j1') &
                    f1/.((len f)-'1+1) = G*(i2',j2');
                       f/.((len f)-'1) = G*(i1',j1') &
               f/.((len f)-'1+1) = G*(i2',j2') by A22,A61,FINSEQ_4:83;
then A62:                 i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                     by A14,A15,A60,GOBOARD1:21;
                  per cases by A16,A62;
                  case i1' = i2' & j1'+1 = j2';
                       now assume i2-'1 < 1;
                   then i2-'1 = 0 by NAT_1:14;
                   then i2 <= 1 by BINARITH:54;
                   then i2 = 1 by A18,XXREAL_0:1;
                   then cell(G,1-'1,j2) meets C
                    by A11,A12,A13,A14,A15,A58,A59,GOBRD13:35;
                   then cell(G,0,j2) meets C by BINARITH:51;
                   hence contradiction by A2,A18,JORDAN8:21;
                  end;
                  hence [i2'-'1,j2'] in Indices G by A18,A21,A62,GOBOARD7:10;
                  thus f1/.((len f)-'1+2) = G*(i2'-'1,j2')
                            by A23,A62,FINSEQ_4:82;
                  end;
                  case i1'+1 = i2' & j1' = j2';
                   hence thesis by A59,A62;
                  end;
                  case i1' = i2'+1 & j1' = j2';
                   hence thesis by A59,A62;
                  end;
                  case
                i1' = i2' & j1' = j2'+1;
                  hence thesis by A59,A62;
                 end;
                 end;
               end;
               hence thesis by A8,A10,A11,A58;
              end;
              suppose
A63:             i1+1 = i2 & j1 = j2;
               take f1 = f^<*G*(i2,j2+1)*>;
                    now
                take i=i2 ,j=j2+1;
                thus f1 turns_left (len f)-'1,G
                 proof let i1',j1',i2',j2' be Element of NAT;
                  assume that
A64:                 [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A65:                 f1/.((len f)-'1) = G*(i1',j1') &
                    f1/.((len f)-'1+1) = G*(i2',j2');
                       f/.((len f)-'1) = G*(i1',j1') &
                f/.((len f)-'1+1) = G*(i2',j2') by A22,A65,FINSEQ_4:83;
then A66:                 i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                     by A14,A15,A64,GOBOARD1:21;
                  per cases by A16,A66;
                  case i1' = i2' & j1'+1 = j2';
                   hence thesis by A63,A66;
                  end;
                  case i1'+1 = i2' & j1' = j2';
                       now assume j2+1 > len G;
                   then j2+1 <= (len G)+1 & (len G)+1 <= j2+1
                      by A2,A18,NAT_1:13,XREAL_1:8;
                   then j2+1 = (len G)+1 by XXREAL_0:1;
                   then cell(G,i2,len G) meets C
                     by A11,A12,A13,A14,A15,A58,A63,GOBRD13:37;
                   hence contradiction by A18,JORDAN8:18;
                  end;
                  hence [i2',j2'+1] in Indices G by A2,A18,A20,A66,GOBOARD7:10
;
                  thus f1/.((len f)-'1+2) = G*(i2',j2'+1)
                            by A23,A66,FINSEQ_4:82;
                  end;
                  case
                i1' = i2'+1 & j1' = j2';
                  hence thesis by A63,A66;
                  end;
                  case i1' = i2' & j1' = j2'+1;
                   hence thesis by A63,A66;
                 end;
                 end;
               end;
               hence thesis by A8,A10,A11,A58;
              end;
              suppose
A67:             i1 = i2+1 & j1 = j2;
               take f1 = f^<*G*(i2,j2-'1)*>;
                    now
                take i=i2 ,j=j2-'1;
                thus f1 turns_left (len f)-'1,G
                 proof let i1',j1',i2',j2' be Element of NAT;
                  assume that
A68:                 [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A69:                 f1/.((len f)-'1) = G*(i1',j1') &
                    f1/.((len f)-'1+1) = G*(i2',j2');
                       f/.((len f)-'1) = G*(i1',j1') &
               f/.((len f)-'1+1) = G*(i2',j2') by A22,A69,FINSEQ_4:83;
then A70:                 i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                     by A14,A15,A68,GOBOARD1:21;
                  per cases by A16,A70;
                  case i1' = i2' & j1'+1 = j2';
                   hence thesis by A67,A70;
                  end;
                  case
                i1'+1 = i2' & j1' = j2';
                  hence thesis by A67,A70;
                  end;
                  case i1' = i2'+1 & j1' = j2';
                       now assume j2-'1 < 1;
                   then j2-'1 = 0 by NAT_1:14;
                   then j2 <= 1 by BINARITH:54;
                   then j2 = 1 by A18,XXREAL_0:1;
                   then cell(G,i2-'1,1-'1) meets C
                     by A11,A12,A13,A14,A15,A58,A67,GOBRD13:39;
                   then cell(G,i2-'1,0) meets C by BINARITH:51;
                   hence contradiction by A21,JORDAN8:20;
                  end;
                  hence [i2',j2'-'1] in Indices G by A18,A21,A70,GOBOARD7:10;
                  thus f1/.((len f)-'1+2) = G*(i2',j2'-'1)
                            by A23,A70,FINSEQ_4:82;
                  end;
                  case i1' = i2' & j1' = j2'+1;
                   hence thesis by A67,A70;
                 end;
                 end;
               end;
               hence thesis by A8,A10,A11,A58;
              end;
              suppose
A71:             i1 = i2 & j1 = j2+1;
               take f1 = f^<*G*(i2+1,j2)*>;
                    now
                take i=i2+1 ,j=j2;
                thus f1 turns_left (len f)-'1,G
                 proof let i1',j1',i2',j2' be Element of NAT;
                  assume that
A72:                 [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A73:                 f1/.((len f)-'1) = G*(i1',j1') &
                    f1/.((len f)-'1+1) = G*(i2',j2');
                       f/.((len f)-'1) = G*(i1',j1') &
                f/.((len f)-'1+1) = G*(i2',j2') by A22,A73,FINSEQ_4:83;
then A74:                 i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                     by A14,A15,A72,GOBOARD1:21;
                  per cases by A16,A74;
                  case
                  i1' = i2' & j1'+1 = j2';
                  hence thesis by A71,A74;
                  end;
                  case i1'+1 = i2' & j1' = j2';
                   hence thesis by A71,A74;
                  end;
                  case i1' = i2'+1 & j1' = j2';
                   hence thesis by A71,A74;
                  end;
                  case i1' = i2' & j1' = j2'+1;
                       now assume i2+1 > len G;
                   then i2+1 <= (len G)+1 & (len G)+1 <= i2+1
                    by A18,NAT_1:13,XREAL_1:8;
                   then i2+1 = (len G)+1 by XXREAL_0:1;
                   then cell(G,len G,j2-'1) meets C
                     by A11,A12,A13,A14,A15,A58,A71,GOBRD13:41;
                   hence contradiction by A2,A21,JORDAN8:19;
                  end;
                  hence [i2'+1,j2'] in Indices G by A18,A20,A74,GOBOARD7:10;
                  thus f1/.((len f)-'1+2) = G*(i2'+1,j2')
                            by A23,A74,FINSEQ_4:82;
                 end;
                 end;
               end;
               hence thesis by A8,A10,A11,A58;
             end;
             end;
          end;
          end;
         end;
         suppose
A75:         not f is_sequence_on G or right_cell(f,len f-'1,G) misses C;
          take f^<*G*(1,1)*>;
          thus thesis by A8,A10,A75;
       end;
       end;
      end;
      suppose
A76:      len f <> k;
       take {};
       thus thesis by A8,A76;
     end;
     end;
    end;
    suppose
A77:    k > 1 & x is not FinSequence of TOP-REAL 2;
     take {};
     thus thesis by A77;
   end;
   end;
  consider F being Function such that
A78:   dom F = NAT and
A79:   F.0 = {} and
A80:   for k being Element of NAT holds P[k,F.k,F.(k+1)] from LATTICE5:sch 1
(A3);
defpred P[Element of NAT] means F.$1 is FinSequence of TOP-REAL 2;
A81:   {} = <*>(the carrier of TOP-REAL 2);
then A82:  P[0] by A79;
A83:  for k st P[k] holds P[k+1]
   proof let k such that
A84:   F.k is FinSequence of TOP-REAL 2;
A85:   P[k,F.k,F.(k+1)] by A80;
    per cases by NAT_1:26;
     suppose k = 0;
      hence F.(k+1) is FinSequence of TOP-REAL 2 by A85;
     end;
     suppose k = 1;
      hence F.(k+1) is FinSequence of TOP-REAL 2 by A85;
     end;
     suppose
A86:     k > 1;
      thus thesis
      proof
        reconsider f = F.k as FinSequence of TOP-REAL 2 by A84;
       per cases;
        suppose
A87:        len f = k;
          thus thesis
          proof per cases;
           suppose f is_sequence_on G & right_cell(f,len f-'1,G) meets C
;
            then (front_left_cell(f,(len f)-'1,G) misses C &
              front_right_cell(f,(len f)-'1,G) misses C
             implies ex i,j st
                 f^<*G*(i,j)*> turns_right (len f)-'1,G &
               F.(k+1) = f^<*G*(i,j)*>) &
            (front_left_cell(f,(len f)-'1,G) misses C &
              front_right_cell(f,(len f)-'1,G) meets C
             implies ex i,j st
                 f^<*G*(i,j)*> goes_straight (len f)-'1,G &
               F.(k+1) = f^<*G*(i,j)*>) &
            (front_left_cell(f,(len f)-'1,G) meets C
             implies ex i,j st
                 f^<*G*(i,j)*> turns_left (len f)-'1,G &
               F.(k+1) = f^<*G*(i,j)*>) by A80,A86,A87;
            hence F.(k+1) is FinSequence of TOP-REAL 2;
           end;
           suppose
A88:           not f is_sequence_on G or right_cell(f,len f-'1,G) misses C;
                  f^<*G*(1,1)*> is FinSequence of TOP-REAL 2;
            hence F.(k+1) is FinSequence of TOP-REAL 2
             by A80,A86,A87,A88;
          end;
          end;
        end;
        suppose len f <> k;
         hence F.(k+1) is FinSequence of TOP-REAL 2 by A80,A81,A86;
      end;
      end;
   end;
   end;

A89:  for k holds P[k] from NAT_1:sch 1(A82,A83);
        rng F c= (the carrier of TOP-REAL 2)*
    proof let y be set;
     assume y in rng F;
     then ex x being set st x in dom F & F.x = y by FUNCT_1:def 5;
     then y is FinSequence of TOP-REAL 2 by A78,A89;
     hence thesis by FINSEQ_1:def 11;
    end;
  then reconsider F as Function of NAT,(the carrier of TOP-REAL 2)*
   by A78,FUNCT_2:def 1,RELSET_1:11;
   defpred P[Element of NAT] means len(F.$1) = $1;
A90:  P[0] by A79,FINSEQ_1:25;
A91:  for k st P[k] holds P[k+1]
    proof let k such that
A92:   len(F.k) = k;
A93:   P[k,F.k,F.(k+1)] by A80;
     per cases by NAT_1:26;
     suppose k = 0;
      hence thesis by A93,FINSEQ_1:56;
     end;
     suppose k = 1;
      hence thesis by A93,FINSEQ_1:61;
     end;
     suppose
A94:     k > 1;
      thus thesis
      proof per cases;
       suppose
          F.k is_sequence_on G & right_cell(F.k,len(F.k)-'1,G) meets C;
            then (front_left_cell(F.k,(len(F.k))-'1,G) misses C &
              front_right_cell(F.k,(len(F.k))-'1,G) misses C
             implies ex i,j st
                 (F.k)^<*G*(i,j)*> turns_right (len(F.k))-'1,G &
               F.(k+1) = (F.k)^<*G*(i,j)*>) &
            (front_left_cell(F.k,(len(F.k))-'1,G) misses C &
              front_right_cell(F.k,(len(F.k))-'1,G) meets C
             implies ex i,j st
                 (F.k)^<*G*(i,j)*> goes_straight (len(F.k))-'1,G &
               F.(k+1) = (F.k)^<*G*(i,j)*>) &
            (front_left_cell(F.k,(len(F.k))-'1,G) meets C
             implies ex i,j st
                 (F.k)^<*G*(i,j)*> turns_left (len(F.k))-'1,G &
               F.(k+1) = (F.k)^<*G*(i,j)*>) by A80,A92,A94;
            hence thesis by A92,FINSEQ_2:19;
       end;
       suppose
             not F.k is_sequence_on G or right_cell(F.k,len(F.k)-'1,G) misses C
;
        then F.(k+1) = (F.k)^<*G*(1,1)*> by A80,A92,A94;
        hence thesis by A92,FINSEQ_2:19;
      end;
      end;
    end;
    end;

A95:   for k holds P[k] from NAT_1:sch 1(A90,A91);
defpred P[Element of NAT] means
F.$1 is_sequence_on G &
      for m st 1 <= m & m+1 <= len(F.$1)
       holds left_cell(F.$1,m,G) misses C & right_cell(F.$1,m,G) meets C;
A96:
  P[0] proof
         (for n st n in dom(F.0) ex i,j st [i,j] in Indices G &
      (F.0)/.n = G*(i,j)) &
    (for n st n in dom(F.0) & n+1 in dom(F.0) holds
      for m,k,i,j st [m,k] in Indices G & [i,j] in Indices G &
                    (F.0)/.n = G*(m,k) & (F.0)/.(n+1) = G*(i,j) holds
      abs(m-i)+abs(k-j) = 1) by A79,RELAT_1:60;
   hence F.0 is_sequence_on G by GOBOARD1:def 11;
   let m; assume
  1 <= m & m+1 <= len(F.0);
   hence left_cell(F.0,m,G) misses C &
           right_cell(F.0,m,G) meets C by A79,FINSEQ_1:25;
  end;
A97: now let k such that
A98:   F.k is_sequence_on G and
A99:   for m st 1 <= m & m+1 <= len(F.k)
        holds left_cell(F.k,m,G) misses C &
            right_cell(F.k,m,G) meets C and
A100:   k > 1;
     let i1,j1,i2,j2 be Element of NAT such that
A101:   [i1,j1] in Indices G & (F.k)/.((len(F.k)) -'1) = G*(i1,j1) and
A102:   [i2,j2] in Indices G & (F.k)/.len(F.k) = G*(i2,j2);
A103:   len(F.k) = k by A95;
then A104:   1 <= (len(F.k))-'1 by A100,BINARITH:67;
A105:   (len(F.k)) -'1 +1 = len(F.k) by A100,A103,BINARITH:53;
then A106:  left_cell(F.k,(len(F.k))-'1,G) misses C &
       right_cell(F.k,(len(F.k))-'1,G) meets C by A99,A104;
A107:   1 <= i1 & i1 <= len G & 1 <= j1 & j1 <= width G by A101,GOBOARD5:1;
A108:   1 <= i2 & i2 <= len G & 1 <= j2 & j2 <= width G by A102,GOBOARD5:1;
A109:  i1-'1 <= len G & j1-'1 <= width G by A107,BINARITH:62;
A110:   1 <= i2+1 & 1 <= j2+1 by NAT_1:12;
A111:  i2-'1 <= len G & j2-'1 <= width G by A108,BINARITH:62;
     hereby assume
A112:     i1 = i2 & j1+1 = j2;
            now assume i2+1 > len G;
        then i2+1 <= (len G)+1 & (len G)+1 <= i2+1 by A108,NAT_1:13,XREAL_1:8;
        then i2+1 = (len G)+1 by XXREAL_0:1;
        then cell(G,len G,j1) meets C
          by A98,A101,A102,A104,A105,A106,A112,GOBRD13:23;
        hence contradiction by A2,A107,JORDAN8:19;
       end;
      hence [i2+1,j2] in Indices G by A108,A110,GOBOARD7:10;
     end;
     hereby assume
A113:     i1+1 = i2 & j1 = j2;
            now assume j2-'1 < 1;
        then j2-'1 = 0 by NAT_1:14;
        then j2 <= 1 by BINARITH:54;
        then j2 = 1 by A108,XXREAL_0:1;
        then cell(G,i1,1-'1) meets C by A98,A101,A102,A104,A105,A106,A113,
GOBRD13:25;
        then cell(G,i1,0) meets C by BINARITH:51;
        hence contradiction by A107,JORDAN8:20;
       end;
      hence [i2,j2-'1] in Indices G by A108,A111,GOBOARD7:10;
     end;
     hereby assume
A114:     i1 = i2+1 & j1 = j2;
            now assume j2+1 > len G;
        then j2+1 <= (len G)+1 & (len G)+1 <=
 j2+1 by A2,A108,NAT_1:13,XREAL_1:8;
        then j2+1 = (len G)+1 by XXREAL_0:1;
        then cell(G,i2,len G) meets C by A98,A101,A102,A104,A105,A106,A114,
GOBRD13:27;
        hence contradiction by A108,JORDAN8:18;
       end;
      hence [i2,j2+1] in Indices G by A2,A108,A110,GOBOARD7:10;
     end;
     hereby assume
A115:     i1 = i2 & j1 = j2+1;
            now assume i2-'1 < 1;
        then i2-'1 = 0 by NAT_1:14;
        then i2 <= 1 by BINARITH:54;
        then i2 = 1 by A108,XXREAL_0:1;
        then cell(G,1-'1,j2) meets C by A98,A101,A102,A104,A105,A106,A115,
GOBRD13:29;
        then cell(G,0,j2) meets C by BINARITH:51;
        hence contradiction by A2,A108,JORDAN8:21;
       end;
      hence [i2-'1,j2] in Indices G by A108,A111,GOBOARD7:10;
     end;
     hereby assume that
A116:     front_right_cell(F.k,(len(F.k))-'1,G) meets C and
A117:     i1 = i2 & j1+1 = j2;
            now assume j2+1 > len G;
        then j2+1 <= (len G)+1 & (len G)+1 <=
 j2+1 by A2,A108,NAT_1:13,XREAL_1:8;
        then j2+1 = (len G)+1 by XXREAL_0:1;
        then cell(G,i1,len G) meets C by A98,A101,A102,A104,A105,A116,A117,
GOBRD13:36;
        hence contradiction by A107,JORDAN8:18;
       end;
      hence [i2,j2+1] in Indices G by A2,A108,A110,GOBOARD7:10;
     end;
     hereby assume that
A118:     front_right_cell(F.k,(len(F.k))-'1,G) meets C and
A119:     i1+1 = i2 & j1 = j2;
            now assume i2+1 > len G;
        then i2+1 <= (len G)+1 & (len G)+1 <= i2+1 by A108,NAT_1:13,XREAL_1:8;
        then i2+1 = (len G)+1 by XXREAL_0:1;
        then cell(G,len G,j1-'1) meets C
         by A98,A101,A102,A104,A105,A118,A119,GOBRD13:38;
        hence contradiction by A2,A109,JORDAN8:19;
       end;
      hence [i2+1,j2] in Indices G by A108,A110,GOBOARD7:10;
     end;
     hereby assume that
A120:     front_right_cell(F.k,(len(F.k))-'1,G) meets C and
A121:     i1 = i2+1 & j1 = j2;
            now assume i2-'1 < 1;
        then i2-'1 = 0 by NAT_1:14;
        then i2 <= 1 by BINARITH:54;
        then i2 = 1 by A108,XXREAL_0:1;
        then cell(G,1-'1,j1) meets C by A98,A101,A102,A104,A105,A120,A121,
GOBRD13:40;
        then cell(G,0,j1) meets C by BINARITH:51;
        hence contradiction by A2,A107,JORDAN8:21;
       end;
      hence [i2-'1,j2] in Indices G by A108,A111,GOBOARD7:10;
     end;
     hereby assume that
A122:     front_right_cell(F.k,(len(F.k))-'1,G) meets C and
A123:     i1 = i2 & j1 = j2+1;
            now assume j2-'1 < 1;
        then j2-'1 = 0 by NAT_1:14;
        then j2 <= 1 by BINARITH:54;
        then j2 = 1 by A108,XXREAL_0:1;
        then cell(G,i1-'1,1-'1) meets C
           by A98,A101,A102,A104,A105,A122,A123,GOBRD13:42;
        then cell(G,i1-'1,0) meets C by BINARITH:51;
        hence contradiction by A109,JORDAN8:20;
       end;
      hence [i2,j2-'1] in Indices G by A108,A111,GOBOARD7:10;
     end;
     hereby assume that
A124:     front_left_cell(F.k,(len(F.k))-'1,G) meets C and
A125:     i1 = i2 & j1+1 = j2;
            now assume i2-'1 < 1;
        then i2-'1 = 0 by NAT_1:14;
        then i2 <= 1 by BINARITH:54;
        then i2 = 1 by A108,XXREAL_0:1;
        then cell(G,1-'1,j2) meets C by A98,A101,A102,A104,A105,A124,A125,
GOBRD13:35;
        then cell(G,0,j2) meets C by BINARITH:51;
        hence contradiction by A2,A108,JORDAN8:21;
       end;
      hence [i2-'1,j2] in Indices G by A108,A111,GOBOARD7:10;
     end;
     hereby assume that
A126:     front_left_cell(F.k,(len(F.k))-'1,G) meets C and
A127:     i1+1 = i2 & j1 = j2;
            now assume j2+1 > len G;
        then j2+1 <= (len G)+1 & (len G)+1 <=
 j2+1 by A2,A108,NAT_1:13,XREAL_1:8;
        then j2+1 = (len G)+1 by XXREAL_0:1;
        then cell(G,i2,len G) meets C by A98,A101,A102,A104,A105,A126,A127,
GOBRD13:37;
        hence contradiction by A108,JORDAN8:18;
       end;
      hence [i2,j2+1] in Indices G by A2,A108,A110,GOBOARD7:10;
     end;
     hereby assume that
A128:     front_left_cell(F.k,(len(F.k))-'1,G) meets C and
A129:     i1 = i2+1 & j1 = j2;
            now assume j2-'1 < 1;
        then j2-'1 = 0 by NAT_1:14;
        then j2 <= 1 by BINARITH:54;
        then j2 = 1 by A108,XXREAL_0:1;
        then cell(G,i2-'1,1-'1) meets C
           by A98,A101,A102,A104,A105,A128,A129,GOBRD13:39;
        then cell(G,i2-'1,0) meets C by BINARITH:51;
        hence contradiction by A111,JORDAN8:20;
       end;
      hence [i2,j2-'1] in Indices G by A108,A111,GOBOARD7:10;
     end;
     hereby assume that
A130:     front_left_cell(F.k,(len(F.k))-'1,G) meets C and
A131:     i1 = i2 & j1 = j2+1;
            now assume i2+1 > len G;
        then i2+1 <= (len G)+1 & (len G)+1 <= i2+1 by A108,NAT_1:13,XREAL_1:8;
        then i2+1 = (len G)+1 by XXREAL_0:1;
        then cell(G,len G,j2-'1) meets C
         by A98,A101,A102,A104,A105,A130,A131,GOBRD13:41;
        hence contradiction by A2,A111,JORDAN8:19;
       end;
      hence [i2+1,j2] in Indices G by A108,A110,GOBOARD7:10;
     end;
    end;
A132: for k st P[k] holds P[k+1]
   proof let k such that
A133:   F.k is_sequence_on G and
A134:   for m st 1 <= m & m+1 <= len(F.k)
        holds left_cell(F.k,m,G) misses C & right_cell(F.k,m,G) meets C;
A135:   len(F.k) = k by A95;
A136:   len(F.(k+1)) = k+1 by A95;
A137:   1 <= len G by A2,NAT_1:12;
A138:   2|^n > 0 by NEWTON:102;
    per cases by NAT_1:26;
    suppose
A139:   k = 0; then consider i such that
A140:   1 <= i & i+1 <= len G and
             N-min C in cell(G,i,width G-'1) & N-min C <> G*(i,width G-'1) and
A141:   F.(k+1) = <*G*(i,width G)*> by A80;
           i < len G by A140,NAT_1:13;
then A142:   [i,len G] in Indices G by A2,A137,A140,GOBOARD7:10;
A143:   now let l;
       assume l in dom(F.(k+1));
       then 1 <= l & l <= 1 by A136,A139,FINSEQ_3:27;
       then l = 1 by XXREAL_0:1;
       then (F.(k+1))/.l = G*(i,width G) by A141,FINSEQ_4:25;
       hence ex i,j st [i,j] in Indices G & (F.(k+1))/.l = G*
(i,j) by A2,A142;
      end;
          now let l;
      assume l in dom(F.(k+1)) & l+1 in dom(F.(k+1));
      then 1 <= l & l <= 1 & 1 <= l+1 & l+1 <= 1 by A136,A139,FINSEQ_3:27;
      then l = 1 & 1 = l+1 by XXREAL_0:1;
      hence for i1,j1,i2,j2 st [i1,j1] in Indices G & [i2,j2] in Indices G &
                    (F.(k+1))/.l = G*(i1,j1) & (F.(k+1))/.(l+1) = G*(i2,j2)
       holds abs(i1-i2)+abs(j1-j2) = 1;
     end;
     hence F.(k+1) is_sequence_on G by A143,GOBOARD1:def 11;
     let m;
     assume
A144:   1 <= m & m+1 <= len(F.(k+1));
          1 <= m+1 by NAT_1:12;
     then m+1 = 0+1 by A136,A139,A144,XXREAL_0:1;
     hence left_cell(F.(k+1),m,G) misses C &
              right_cell(F.(k+1),m,G) meets C by A144;
    end;
    suppose
A145:   k = 1; then consider i such that
A146:   1 <= i & i+1 <= len G and
A147:   N-min C in cell(G,i,width G-'1) & N-min C <> G*(i,width G-'1) and
A148:   F.(k+1) = <*G*(i,width G),G*(i+1,width G)*> by A80;
A149:   (F.(k+1))/.1 = G*(i,width G) & (F.(k+1))/.2 = G*(i+1,width G)
        by A148,FINSEQ_4:26;
A150:  i < len G & 1 <= i+1 & i+1 <= len G by A146,NAT_1:13;
then A151:   [i,len G] in Indices G & [i+1,len G] in Indices G
        by A2,A137,A146,GOBOARD7:10;
A152:   now let l;
       assume A153: l in dom(F.(k+1));
       then 1 <= l & l <= 2 by A136,A145,FINSEQ_3:27;
       then l = 0 or l = 1 or l = 2 by NAT_1:27;
       hence ex i,j st [i,j] in Indices G & (F.(k+1))/.l = G*(i,j)
         by A2,A149,A151,A153,FINSEQ_3:27;
      end;
          now let l;
      assume A154: l in dom(F.(k+1)) & l+1 in dom(F.(k+1));
      then 1 <= l & l <= 2 & 1 <= l+1 & l+1 <= 2 by A136,A145,FINSEQ_3:27;
      then A155: l = 0 or l = 1 or l = 2 by NAT_1:27;
      let i1,j1,i2,j2 such that
A156:      [i1,j1] in Indices G & [i2,j2] in Indices G &
        (F.(k+1))/.l = G*(i1,j1) & (F.(k+1))/.(l+1) = G*(i2,j2);
            i1 = i & j1 = len G & i2 = i+1 & j2 = len G
         by A2,A136,A145,A149,A151,A154,A155,A156,FINSEQ_3:27,GOBOARD1:21;
      then abs(i2-i1) = 1 & abs(j1-j2) = 0 by ABSVALUE:def 1;
      hence abs(i1-i2)+abs(j1-j2) = 1 by UNIFORM1:13;
     end;
     hence A157:    F.(k+1) is_sequence_on G by A152,GOBOARD1:def 11;
     let m;
     assume
A158:   1 <= m & m+1 <= len(F.(k+1));
     then 1+1 <= m+1 by XREAL_1:8;
     then A159: m+1 = 1+1 by A136,A145,A158,XXREAL_0:1;
A160:  i < i+1 & i+1 < (i+1)+1 by NAT_1:13;
then A161:   left_cell(F.(k+1),m,G) = cell(G,i,len G)
        by A2,A149,A151,A157,A158,A159,GOBRD13:def 3;
          now assume left_cell(F.(k+1),m,G) meets C;
      then consider p being set such that
A162:     p in cell(G,i,len G) & p in C by A161,XBOOLE_0:3;
      reconsider p as Point of TOP-REAL 2 by A162;
       reconsider p as Element of TOP-REAL 2;
           cell(G,i,len G) = { |[r,s]|: G*(i,1)`1 <= r & r <= G*(i+1,1)`1 &
                                  G*(1,len G)`2 <= s }
       by A2,A146,A150,GOBRD11:31;
      then consider r,s such that
A163:     p = |[r,s]| and
             G*(i,1)`1 <= r & r <= G*(i+1,1)`1 and
A164:     G*(1,len G)`2 <= s by A162;
           [1,len G] in Indices G by A2,A137,GOBOARD7:10;
then A165:     G*
(1,len G) = |[W+((E-W)/(2|^n))*(1-2),S+((N-S)/(2|^n))*((len G)-2)]|
         by JORDAN8:def 1;
       A166: ((N-S)/(2|^n))*((len G)-2)
           = ((N-S)/(2|^n))*(2|^n)+((N-S)/(2|^n))*1 by A2
          .= (N-S)+(N-S)/(2|^n) by A138,XCMPLX_1:88;
A167:     G*(1,len G)`2 = S+((N-S)/(2|^n))*((len G)-2) by A165,EUCLID:56;
            N > S by JORDAN8:12;
       then N-S > S-S by XREAL_1:11;
       then (N-S)/(2|^n) > 0 by A138,REAL_2:127;
       then N+0 < N+(N-S)/(2|^n) by XREAL_1:8;
then A168:     N < s by A164,A166,A167,XXREAL_0:2;
            p`2 <= N by A162,PSCOMP_1:71;
      hence contradiction by A163,A168,EUCLID:56;
     end;
     hence left_cell(F.(k+1),m,G) misses C;
A169:   N-min C in C by SPRECT_1:13;
          N-min C in right_cell(F.(k+1),m,G)
      by A2,A147,A149,A151,A157,A158,A159,A160,GOBRD13:def 2;
     hence right_cell(F.(k+1),m,G) meets C by A169,XBOOLE_0:3;
    end;
    suppose
A170:   k > 1;
then A171:   F.k is non empty by A135,FINSEQ_1:25;
A172:   1 <= (len(F.k))-'1 by A135,A170,BINARITH:67;
A173:   (len(F.k)) -'1 +1 = len(F.k) by A135,A170,BINARITH:53;
     then consider i1,j1,i2,j2 being Element of NAT such that
A174:   [i1,j1] in Indices G & (F.k)/.((len(F.k)) -'1) = G*(i1,j1) and
A175:   [i2,j2] in Indices G & (F.k)/.len(F.k) = G*(i2,j2) and
           i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
        i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A133,A172,JORDAN8:6;
A176:   1 <= i2 & i2 <= len G & 1 <= j2 & j2 <= width G by A175,GOBOARD5:1;
           (len(F.k))-'1 <= len(F.k) by BINARITH:52;
then A177:  (len(F.k))-'1 in dom(F.k) & len(F.k) in dom(F.k)
        by A135,A170,A172,FINSEQ_3:27;
A178:  (len(F.k))-'1+(1+1) = (len(F.k))+1 by A173;
A179:  left_cell(F.k,(len(F.k))-'1,G) misses C &
       right_cell(F.k,(len(F.k))-'1,G) meets C by A134,A172,A173;
A180: i1 = i2 & j1+1 = j2 implies [i2+1,j2] in Indices G by A97,A133,A134,A170
,A174,A175;
A181: i1+1 = i2 & j1 = j2 implies [i2,j2-'1] in Indices G by A97,A133,A134,A170
,A174,A175;
A182: i1 = i2+1 & j1 = j2 implies [i2,j2+1] in Indices G by A97,A133,A134,A170
,A174,A175;
A183: i1 = i2 & j1 = j2+1 implies [i2-'1,j2] in Indices G by A97,A133,A134,A170
,A174,A175;
A184: front_right_cell(F.k,(len(F.k))-'1,G) meets C &
     i1 = i2 & j1+1 = j2 implies [i2,j2+1] in Indices G by A97,A133,A134,A170
,A174,A175;
A185: front_right_cell(F.k,(len(F.k))-'1,G) meets C &
     i1+1 = i2 & j1 = j2 implies [i2+1,j2] in Indices G by A97,A133,A134,A170
,A174,A175;
A186: front_right_cell(F.k,(len(F.k))-'1,G) meets C &
     i1 = i2+1 & j1 = j2 implies [i2-'1,j2] in Indices G by A97,A133,A134,A170
,A174,A175;
A187: front_right_cell(F.k,(len(F.k))-'1,G) meets C &
     i1 = i2 & j1 = j2+1 implies [i2,j2-'1] in Indices G by A97,A133,A134,A170
,A174,A175;
A188: front_left_cell(F.k,(len(F.k))-'1,G) meets C &
     i1 = i2 & j1+1 = j2 implies [i2-'1,j2] in Indices G by A97,A133,A134,A170
,A174,A175;
A189: front_left_cell(F.k,(len(F.k))-'1,G) meets C &
     i1+1 = i2 & j1 = j2 implies [i2,j2+1] in Indices G by A97,A133,A134,A170
,A174,A175;
A190: front_left_cell(F.k,(len(F.k))-'1,G) meets C &
     i1 = i2+1 & j1 = j2 implies [i2,j2-'1] in Indices G by A97,A133,A134,A170
,A174,A175;
A191: front_left_cell(F.k,(len(F.k))-'1,G) meets C &
     i1 = i2 & j1 = j2+1 implies [i2+1,j2] in Indices G by A97,A133,A134,A170
,A174,A175;
   thus
A192: F.(k+1) is_sequence_on G
      proof
       per cases;
       suppose front_left_cell(F.k,(len(F.k))-'1,G) misses C &
            front_right_cell(F.k,(len(F.k))-'1,G) misses C;
        then consider i,j such that
A193:       (F.k)^<*G*(i,j)*> turns_right (len(F.k))-'1,G and
A194:       F.(k+1) = (F.k)^<*G*(i,j)*> by A80,A133,A135,A170,A179;
        thus thesis
         proof set f = (F.k)^<*G*(i,j)*>;
A195:       f/.(len(F.k)-'1) = G*(i1,j1) & f/.len(F.k) = G*(i2,j2)
           by A174,A175,A177,FINSEQ_4:83;
A196:        f/.(len(F.k)+1) = G*(i,j) by FINSEQ_4:82;
          per cases by A173,A174,A175,A178,A193,A195,GOBRD13:def 6;
          suppose that
A197:         i1 = i2 & j1+1 = j2 and
A198:         f/.(len(F.k)+1) = G*(i2+1,j2);
                now let i1',j1',i2',j2' be Element of NAT;
            assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
                (F.k)/.len(F.k) = G*(i1',j1') & G*(i2+1,j2) = G*(i2',j2');
             then i2 = i1' & j2 = j1' & i2+1 = i2' & j2 = j2'
                by A175,A180,A197,GOBOARD1:21;
             then abs(i2'-i1') = 1 & abs(j2'-j1') = 0 by ABSVALUE:def 1;
            hence abs(i2'-i1')+abs(j2'-j1') = 1;
           end;
           hence F.(k+1) is_sequence_on G by A133,A171,A180,A194,A196,A197,A198
,JORDAN8:9;
          end;
          suppose that
A199:          i1+1 = i2 & j1 = j2 and
A200:          f/.(len(F.k)+1) = G*(i2,j2-'1);
                now let i1',j1',i2',j2' be Element of NAT;
            assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
              (F.k)/.len(F.k) = G*(i1',j1') & G*(i2,j2-'1) = G*
(i2',j2');
then A201:           i2 = i1' & j2 = j1' & i2 = i2' & j2-'1 = j2'
                by A175,A181,A199,GOBOARD1:21;
             then j1'-j2' = j2-(j2-1) by A176,BINARITH:50;
             then abs(i2'-i1') = 0 & abs(j1'-j2') = 1 by A201,ABSVALUE:def 1;
            hence abs(i2'-i1')+abs(j2'-j1') = 1 by UNIFORM1:13;
           end;
           hence F.(k+1) is_sequence_on G by A133,A171,A181,A194,A196,A199,A200
,JORDAN8:9;
          end;
          suppose that
A202:          i1 = i2+1 & j1 = j2 and
A203:          f/.(len(F.k)+1) = G*(i2,j2+1);
                now let i1',j1',i2',j2' be Element of NAT;
            assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
                (F.k)/.len(F.k) = G*(i1',j1') & G*(i2,j2+1) = G*(i2',j2');
             then i2 = i1' & j2 = j1' & i2 = i2' & j2+1 = j2'
                by A175,A182,A202,GOBOARD1:21;
             then abs(i2'-i1') = 0 & abs(j2'-j1') = 1 by ABSVALUE:def 1;
            hence abs(i2'-i1')+abs(j2'-j1') = 1;
           end;
           hence F.(k+1) is_sequence_on G by A133,A171,A182,A194,A196,A202,A203
,JORDAN8:9;
          end;
          suppose that
A204:          i1 = i2 & j1 = j2+1 and
A205:          f/.(len(F.k)+1) = G*(i2-'1,j2);
                now let i1',j1',i2',j2' be Element of NAT;
            assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
              (F.k)/.len(F.k) = G*(i1',j1') & G*(i2-'1,j2) = G*
(i2',j2');
then A206:           i2 = i1' & j2 = j1' & i2-'1 = i2' & j2 = j2'
                by A175,A183,A204,GOBOARD1:21;
             then i1'-i2' = i2-(i2-1) by A176,BINARITH:50;
             then abs(j2'-j1') = 0 & abs(i1'-i2') = 1 by A206,ABSVALUE:def 1;
            hence abs(i2'-i1')+abs(j2'-j1') = 1 by UNIFORM1:13;
           end;
           hence F.(k+1) is_sequence_on G by A133,A171,A183,A194,A196,A204,A205
,JORDAN8:9;
         end;
         end;
       end;
       suppose
A207:       front_left_cell(F.k,(len(F.k))-'1,G) misses C &
             front_right_cell(F.k,(len(F.k))-'1,G) meets C;
        then consider i,j such that
A208:       (F.k)^<*G*(i,j)*> goes_straight (len(F.k))-'1,G and
A209:       F.(k+1) = (F.k)^<*G*(i,j)*> by A80,A133,A135,A170,A179;
        thus thesis
         proof set f = (F.k)^<*G*(i,j)*>;
A210:       f/.(len(F.k)-'1) = G*(i1,j1) & f/.len(F.k) = G*(i2,j2)
           by A174,A175,A177,FINSEQ_4:83;
A211:        f/.(len(F.k)+1) = G*(i,j) by FINSEQ_4:82;
          per cases by A173,A174,A175,A178,A208,A210,GOBRD13:def 8;
          suppose that
A212:         i1 = i2 & j1+1 = j2 and
A213:         f/.(len(F.k)+1) = G*(i2,j2+1);
                now let i1',j1',i2',j2' be Element of NAT;
            assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
                (F.k)/.len(F.k) = G*(i1',j1') & G*(i2,j2+1) = G*(i2',j2');
             then i2 = i1' & j2 = j1' & i2 = i2' & j2+1 = j2'
                by A175,A184,A207,A212,GOBOARD1:21;
             then abs(i2'-i1') = 0 & abs(j2'-j1') = 1 by ABSVALUE:def 1;
            hence abs(i2'-i1')+abs(j2'-j1') = 1;
           end;
          hence F.(k+1) is_sequence_on G by A133,A171,A184,A207,A209,A211,A212
,A213,JORDAN8:9;
          end;
          suppose that
A214:          i1+1 = i2 & j1 = j2 and
A215:          f/.(len(F.k)+1) = G*(i2+1,j2);
                now let i1',j1',i2',j2' be Element of NAT;
            assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
              (F.k)/.len(F.k) = G*(i1',j1') & G*(i2+1,j2) = G*
(i2',j2');
              then i2 = i1' & j2 = j1' & i2+1 = i2' & j2 = j2'
                by A175,A185,A207,A214,GOBOARD1:21;
             then abs(i2'-i1') = 1 & abs(j2'-j1') = 0 by ABSVALUE:def 1;
            hence abs(i2'-i1')+abs(j2'-j1') = 1;
           end;
          hence F.(k+1) is_sequence_on G by A133,A171,A185,A207,A209,A211,A214
,A215,JORDAN8:9;
          end;
          suppose that
A216:          i1 = i2+1 & j1 = j2 and
A217:          f/.(len(F.k)+1) = G*(i2-'1,j2);
                now let i1',j1',i2',j2' be Element of NAT;
            assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
                (F.k)/.len(F.k) = G*(i1',j1') & G*(i2-'1,j2) = G*(i2',j2');
             then A218:           i2 = i1' & j2 = j1' & i2-'1 = i2' & j2 = j2'
                by A175,A186,A207,A216,GOBOARD1:21;
             then i1'-i2' = i2-(i2-1) by A176,BINARITH:50;
             then abs(j2'-j1') = 0 & abs(i1'-i2') = 1 by A218,ABSVALUE:def 1;
            hence abs(i2'-i1')+abs(j2'-j1') = 1 by UNIFORM1:13;
           end;
          hence F.(k+1) is_sequence_on G by A133,A171,A186,A207,A209,A211,A216
,A217,JORDAN8:9;
          end;
          suppose that
A219:          i1 = i2 & j1 = j2+1 and
A220:          f/.(len(F.k)+1) = G*(i2,j2-'1);
                now let i1',j1',i2',j2' be Element of NAT;
            assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
              (F.k)/.len(F.k) = G*(i1',j1') & G*(i2,j2-'1) = G*
(i2',j2');
then A221:           i2 = i1' & j2 = j1' & i2 = i2' & j2-'1 = j2'
                by A175,A187,A207,A219,GOBOARD1:21;
             then j1'-j2' = j2-(j2-1) by A176,BINARITH:50;
             then abs(i2'-i1') = 0 & abs(j1'-j2') = 1 by A221,ABSVALUE:def 1;
            hence abs(i2'-i1')+abs(j2'-j1') = 1 by UNIFORM1:13;
           end;
          hence F.(k+1) is_sequence_on G by A133,A171,A187,A207,A209,A211,A219
,A220,JORDAN8:9;
         end;
         end;
       end;
       suppose
A222:       front_left_cell(F.k,(len(F.k))-'1,G) meets C;
        then consider i,j such that
A223:       (F.k)^<*G*(i,j)*> turns_left (len(F.k))-'1,G and
A224:       F.(k+1) = (F.k)^<*G*(i,j)*> by A80,A133,A135,A170,A179;
        thus thesis
         proof set f = (F.k)^<*G*(i,j)*>;
A225:       f/.(len(F.k)-'1) = G*(i1,j1) & f/.len(F.k) = G*(i2,j2)
           by A174,A175,A177,FINSEQ_4:83;
A226:        f/.(len(F.k)+1) = G*(i,j) by FINSEQ_4:82;
          per cases by A173,A174,A175,A178,A223,A225,GOBRD13:def 7;
          suppose that
A227:         i1 = i2 & j1+1 = j2 and
A228:         f/.(len(F.k)+1) = G*(i2-'1,j2);
                now let i1',j1',i2',j2' be Element of NAT;
            assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
                (F.k)/.len(F.k) = G*(i1',j1') & G*(i2-'1,j2) = G*(i2',j2');
             then A229:           i2 = i1' & j2 = j1' & i2-'1 = i2' & j2 = j2'
                by A175,A188,A222,A227,GOBOARD1:21;
             then i1'-i2' = i2-(i2-1) by A176,BINARITH:50;
             then abs(j2'-j1') = 0 & abs(i1'-i2') = 1 by A229,ABSVALUE:def 1;
            hence abs(i2'-i1')+abs(j2'-j1') = 1 by UNIFORM1:13;
           end;
          hence F.(k+1) is_sequence_on G by A133,A171,A188,A222,A224,A226,A227
,A228,JORDAN8:9;
          end;
          suppose that
A230:          i1+1 = i2 & j1 = j2 and
A231:          f/.(len(F.k)+1) = G*(i2,j2+1);
                now let i1',j1',i2',j2' be Element of NAT;
            assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
              (F.k)/.len(F.k) = G*(i1',j1') & G*(i2,j2+1) = G*
(i2',j2');
              then i2 = i1' & j2 = j1' & i2 = i2' & j2+1 = j2'
                by A175,A189,A222,A230,GOBOARD1:21;
             then abs(i2'-i1') = 0 & abs(j2'-j1') = 1 by ABSVALUE:def 1;
            hence abs(i2'-i1')+abs(j2'-j1') = 1;
           end;
          hence F.(k+1) is_sequence_on G by A133,A171,A189,A222,A224,A226,A230
,A231,JORDAN8:9;
          end;
          suppose that
A232:          i1 = i2+1 & j1 = j2 and
A233:          f/.(len(F.k)+1) = G*(i2,j2-'1);
                now let i1',j1',i2',j2' be Element of NAT;
            assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
                (F.k)/.len(F.k) = G*(i1',j1') & G*(i2,j2-'1) = G*(i2',j2');
             then A234:           i2 = i1' & j2 = j1' & i2 = i2' & j2-'1 = j2'
                by A175,A190,A222,A232,GOBOARD1:21;
             then j1'-j2' = j2-(j2-1) by A176,BINARITH:50;
             then abs(i2'-i1') = 0 & abs(j1'-j2') = 1 by A234,ABSVALUE:def 1;
            hence abs(i2'-i1')+abs(j2'-j1') = 1 by UNIFORM1:13;
           end;
          hence F.(k+1) is_sequence_on G by A133,A171,A190,A222,A224,A226,A232
,A233,JORDAN8:9;
          end;
          suppose that
A235:          i1 = i2 & j1 = j2+1 and
A236:          f/.(len(F.k)+1) = G*(i2+1,j2);
                now let i1',j1',i2',j2' be Element of NAT;
            assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
              (F.k)/.len(F.k) = G*(i1',j1') & G*(i2+1,j2) = G*
(i2',j2');
              then i2 = i1' & j2 = j1' & i2+1 = i2' & j2 = j2'
                by A175,A191,A222,A235,GOBOARD1:21;
             then abs(i2'-i1') = 1 & abs(j2'-j1') = 0 by ABSVALUE:def 1;
            hence abs(i2'-i1')+abs(j2'-j1') = 1;
           end;
          hence F.(k+1) is_sequence_on G by A133,A171,A191,A222,A224,A226,A235
,A236,JORDAN8:9;
         end;
         end;
      end;
      end;
     let m such that
A237:    1 <= m & m+1 <= len(F.(k+1));
          now
     per cases;
      suppose A238: m+1 = len(F.(k+1));
A239:    (i2-'1)+1 = i2 by A176,BINARITH:53;
A240:    (j2-'1)+1 = j2 by A176,BINARITH:53;
       thus thesis
        proof per cases;
         suppose
A241:        front_left_cell(F.k,(len(F.k))-'1,G) misses C &
            front_right_cell(F.k,(len(F.k))-'1,G) misses C;
          then consider i,j such that
A242:        (F.k)^<*G*(i,j)*> turns_right (len(F.k))-'1,G and
A243:        F.(k+1) = (F.k)^<*G*(i,j)*> by A80,A133,A135,A170,A179;
A244:        (F.(k+1))/.(len(F.k)-'1) = G*(i1,j1) & (F.(k+1))/.len(F.k) = G*
(i2,j2)
            by A174,A175,A177,A243,FINSEQ_4:83;
               now per cases by A173,A174,A175,A178,A242,A243,A244,
GOBRD13:def 6
;
           suppose that
A245:           i1 = i2 & j1+1 = j2 and
A246:           (F.(k+1))/.((len(F.k))+1) = G*(i2+1,j2);
                  front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i1,j2)
               by A133,A172,A173,A174,A175,A245,GOBRD13:36;
            hence left_cell(F.(k+1),m,G) misses C
               by A135,A136,A175,A180,A192,A237,A238,A241,A244,A245,A246,
GOBRD13:24;
                  j2-'1 = j1 & cell(G,i1,j1) meets C
               by A133,A172,A173,A174,A175,A179,A245,BINARITH:39,GOBRD13:23;
            hence right_cell(F.(k+1),m,G) meets C
               by A135,A136,A175,A180,A192,A237,A238,A244,A245,A246,GOBRD13:25;
           end;
           suppose that
A247:           i1+1 = i2 & j1 = j2 and
A248:           (F.(k+1))/.((len(F.k))+1) = G*(i2,j2-'1);
                  front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i2,j2-'1)
               by A133,A172,A173,A174,A175,A247,GOBRD13:38;
            hence left_cell(F.(k+1),m,G) misses C
               by A135,A136,A175,A181,A192,A237,A238,A240,A241,A244,A247,A248,
GOBRD13:28;
                  i2-'1 = i1 & cell(G,i1,j1-'1) meets C
               by A133,A172,A173,A174,A175,A179,A247,BINARITH:39,GOBRD13:25;
            hence right_cell(F.(k+1),m,G) meets C
               by A135,A136,A175,A181,A192,A237,A238,A240,A244,A247,A248,
GOBRD13:29;
           end;
           suppose that
A249:           i1 = i2+1 & j1 = j2 and
A250:           (F.(k+1))/.((len(F.k))+1) = G*(i2,j2+1);
                  front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i2-'1,j2)
               by A133,A172,A173,A174,A175,A249,GOBRD13:40;
            hence left_cell(F.(k+1),m,G) misses C
               by A135,A136,A175,A182,A192,A237,A238,A241,A244,A249,A250,
GOBRD13:22;
                  cell(G,i2,j2) meets C
               by A133,A172,A173,A174,A175,A179,A249,GOBRD13:27;
            hence right_cell(F.(k+1),m,G) meets C
               by A135,A136,A175,A182,A192,A237,A238,A244,A249,A250,GOBRD13:23;
           end;
           suppose that
A251:           i1 = i2 & j1 = j2+1 and
A252:           (F.(k+1))/.((len(F.k))+1) = G*(i2-'1,j2);
                  front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i2-'1,j2-'1)
               by A133,A172,A173,A174,A175,A251,GOBRD13:42;
            hence left_cell(F.(k+1),m,G) misses C
              by A135,A136,A175,A183,A192,A237,A238,A239,A241,A244,A251,A252,
GOBRD13:26;
                  cell(G,i2-'1,j2) meets C
              by A133,A172,A173,A174,A175,A179,A251,GOBRD13:29;
            hence right_cell(F.(k+1),m,G) meets C
             by A135,A136,A175,A183,A192,A237,A238,A239,A244,A251,A252,
GOBRD13:27;
          end;
          end;
          hence thesis;
         end;
         suppose
A253:        front_left_cell(F.k,(len(F.k))-'1,G) misses C &
             front_right_cell(F.k,(len(F.k))-'1,G) meets C;
          then consider i,j such that
A254:        (F.k)^<*G*(i,j)*> goes_straight (len(F.k))-'1,G and
A255:        F.(k+1) = (F.k)^<*G*(i,j)*> by A80,A133,A135,A170,A179;
A256:        (F.(k+1))/.(len(F.k)-'1) = G*(i1,j1) & (F.(k+1))/.len(F.k)
                      = G*(i2,j2)
            by A174,A175,A177,A255,FINSEQ_4:83;
               now per cases by A173,A174,A175,A178,A254,A255,A256,
GOBRD13:def 8
;
           suppose that
A257:           i1 = i2 & j1+1 = j2 and
A258:           (F.(k+1))/.(len(F.k)+1) = G*(i2,j2+1);
                  front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i1-'1,j2)
               by A133,A172,A173,A174,A175,A257,GOBRD13:35;
             hence left_cell(F.(k+1),m,G) misses C
               by A135,A136,A175,A184,A192,A237,A238,A253,A256,A257,A258,
GOBRD13:22;
                 front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i1,j2)
               by A133,A172,A173,A174,A175,A257,GOBRD13:36;
            hence right_cell(F.(k+1),m,G) meets C
               by A135,A136,A175,A184,A192,A237,A238,A253,A256,A257,A258,
GOBRD13:23;
           end;
           suppose that
A259:           i1+1 = i2 & j1 = j2 and
A260:           (F.(k+1))/.(len(F.k)+1) = G*(i2+1,j2);
                  front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i2,j2)
               by A133,A172,A173,A174,A175,A259,GOBRD13:37;
            hence left_cell(F.(k+1),m,G) misses C
               by A135,A136,A175,A185,A192,A237,A238,A253,A256,A259,A260,
GOBRD13:24;
                  front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i2,j2-'1)
               by A133,A172,A173,A174,A175,A259,GOBRD13:38;
            hence right_cell(F.(k+1),m,G) meets C
               by A135,A136,A175,A185,A192,A237,A238,A253,A256,A259,A260,
GOBRD13:25;
           end;
           suppose that
A261:          i1 = i2+1 & j1 = j2 and
A262:          (F.(k+1))/.(len(F.k)+1) = G*(i2-'1,j2);
                  front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i2-'1,j2-'1)
               by A133,A172,A173,A174,A175,A261,GOBRD13:39;
            hence left_cell(F.(k+1),m,G) misses C
               by A135,A136,A175,A186,A192,A237,A238,A239,A253,A256,A261,A262,
GOBRD13:26;
                  front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i2-'1,j2)
               by A133,A172,A173,A174,A175,A261,GOBRD13:40;
            hence right_cell(F.(k+1),m,G) meets C
               by A135,A136,A175,A186,A192,A237,A238,A239,A253,A256,A261,A262,
GOBRD13:27;
           end;
           suppose that
A263:          i1 = i2 & j1 = j2+1 and
A264:          (F.(k+1))/.(len(F.k)+1) = G*(i2,j2-'1);
                  front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i2,j2-'1)
               by A133,A172,A173,A174,A175,A263,GOBRD13:41;
            hence left_cell(F.(k+1),m,G) misses C
               by A135,A136,A175,A187,A192,A237,A238,A240,A253,A256,A263,A264,
GOBRD13:28;
                  front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i2-'1,j2-'1)
               by A133,A172,A173,A174,A175,A263,GOBRD13:42;
            hence right_cell(F.(k+1),m,G) meets C
               by A135,A136,A175,A187,A192,A237,A238,A240,A253,A256,A263,A264,
GOBRD13:29;
          end;
          end;
          hence thesis;
         end;
         suppose
A265:        front_left_cell(F.k,(len(F.k))-'1,G) meets C;
          then consider i,j such that
A266:        (F.k)^<*G*(i,j)*> turns_left (len(F.k))-'1,G and
A267:        F.(k+1) = (F.k)^<*G*(i,j)*> by A80,A133,A135,A170,A179;
A268:        (F.(k+1))/.(len(F.k)-'1) = G*(i1,j1) & (F.(k+1))/.len(F.k) = G*
(i2,j2)
             by A174,A175,A177,A267,FINSEQ_4:83;
               now per cases by A173,A174,A175,A178,A266,A267,A268,
GOBRD13:def 7
;
           suppose that
A269:           i1 = i2 & j1+1 = j2 and
A270:           (F.(k+1))/.(len(F.k)+1) = G*(i2-'1,j2);
                  j2-'1 = j1 &
             cell(G,i1-'1,j1) misses C
               by A133,A172,A173,A174,A175,A179,A269,BINARITH:39,GOBRD13:22;
            hence left_cell(F.(k+1),m,G) misses C
               by A135,A136,A175,A188,A192,A237,A238,A239,A265,A268,A269,A270,
GOBRD13:26;
                  front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i1-'1,j2)
               by A133,A172,A173,A174,A175,A269,GOBRD13:35;
            hence right_cell(F.(k+1),m,G) meets C
               by A135,A136,A175,A188,A192,A237,A238,A239,A265,A268,A269,A270,
GOBRD13:27;
           end;
           suppose that
A271:           i1+1 = i2 & j1 = j2 and
A272:           (F.(k+1))/.(len(F.k)+1) = G*(i2,j2+1);
                  i2-'1 = i1 & cell(G,i1,j1) misses C
               by A133,A172,A173,A174,A175,A179,A271,BINARITH:39,GOBRD13:24;
             hence left_cell(F.(k+1),m,G) misses C
               by A135,A136,A175,A189,A192,A237,A238,A265,A268,A271,A272,
GOBRD13:22;
                  front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i2,j2)
               by A133,A172,A173,A174,A175,A271,GOBRD13:37;
            hence right_cell(F.(k+1),m,G) meets C
               by A135,A136,A175,A189,A192,A237,A238,A265,A268,A271,A272,
GOBRD13:23;
           end;
           suppose that
A273:           i1 = i2+1 & j1 = j2 and
A274:           (F.(k+1))/.(len(F.k)+1) = G*(i2,j2-'1);
                  cell(G,i2,j2-'1) misses C
               by A133,A172,A173,A174,A175,A179,A273,GOBRD13:26;
            hence left_cell(F.(k+1),m,G) misses C
               by A135,A136,A175,A190,A192,A237,A238,A240,A265,A268,A273,A274,
GOBRD13:28;
                  front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i2-'1,j2-'1)
               by A133,A172,A173,A174,A175,A273,GOBRD13:39;
            hence right_cell(F.(k+1),m,G) meets C
               by A135,A136,A175,A190,A192,A237,A238,A240,A265,A268,A273,A274,
GOBRD13:29;
           end;
           suppose that
A275:           i1 = i2 & j1 = j2+1 and
A276:           (F.(k+1))/.(len(F.k)+1) = G*(i2+1,j2);
                  cell(G,i2,j2) misses C by A133,A172,A173,A174,A175,A179,A275,
GOBRD13:28;
            hence left_cell(F.(k+1),m,G) misses C
               by A135,A136,A175,A191,A192,A237,A238,A265,A268,A275,A276,
GOBRD13:24;
                  front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i2,j2-'1)
               by A133,A172,A173,A174,A175,A275,GOBRD13:41;
            hence right_cell(F.(k+1),m,G) meets C
               by A135,A136,A175,A191,A192,A237,A238,A265,A268,A275,A276,
GOBRD13:25;
          end;
          end;
          hence thesis;
       end;
       end;
      end;
      suppose m+1 <> len(F.(k+1));
       then m+1 < len(F.(k+1)) by A237,REAL_1:def 5;
       then A277:     m+1 <= len(F.k)by A135,A136,NAT_1:13;
       then consider i1,j1,i2,j2 being Element of NAT such that
A278:     [i1,j1] in Indices G & (F.k)/.m = G*(i1,j1) and
A279:     [i2,j2] in Indices G & (F.k)/.(m+1) = G*(i2,j2) and
A280:      i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
          i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A133,A237,JORDAN8:6;
A281:    1 <= m+1 by NAT_1:12;
             m <= len(F.k) by A277,NAT_1:13;
then A282:    m in dom(F.k) & m+1 in dom(F.k) by A237,A277,A281,FINSEQ_3:27;
A283:     left_cell(F.k,m,G) misses C & right_cell(F.k,m,G) meets C
         by A134,A237,A277;
            now per cases;
         suppose
               front_left_cell(F.k,(len(F.k))-'1,G) misses C &
            front_right_cell(F.k,(len(F.k))-'1,G) misses C;
          then consider i,j such that
                (F.k)^<*G*(i,j)*> turns_right (len(F.k))-'1,G and
A284:        F.(k+1) = (F.k)^<*G*(i,j)*> by A80,A133,A135,A170,A179;
          take i,j;
          thus F.(k+1) = (F.k)^<*G*(i,j)*> by A284;
         end;
         suppose
                front_left_cell(F.k,(len(F.k))-'1,G) misses C &
             front_right_cell(F.k,(len(F.k))-'1,G) meets C;
          then consider i,j such that
                (F.k)^<*G*(i,j)*> goes_straight (len(F.k))-'1,G and
A285:        F.(k+1) = (F.k)^<*G*(i,j)*> by A80,A133,A135,A170,A179;
          take i,j;
          thus F.(k+1) = (F.k)^<*G*(i,j)*> by A285;
         end;
         suppose
               front_left_cell(F.k,(len(F.k))-'1,G) meets C;
          then consider i,j such that
                (F.k)^<*G*(i,j)*> turns_left (len(F.k))-'1,G and
A286:        F.(k+1) = (F.k)^<*G*(i,j)*> by A80,A133,A135,A170,A179;
          take i,j;
          thus F.(k+1) = (F.k)^<*G*(i,j)*> by A286;
       end;
       end;
       then consider i,j such that
A287:      F.(k+1) = (F.k)^<*G*(i,j)*>;
A288:      (F.(k+1))/.m = G*(i1,j1) & (F.(k+1))/.(m+1) = G*(i2,j2)
            by A278,A279,A282,A287,FINSEQ_4:83;
            now per cases by A280;
        suppose
A289:        i1 = i2 & j1+1 = j2;
          then left_cell(F.k,m,G) = cell(G,i1-'1,j1) &
            right_cell(F.k,m,G) = cell(G,i1,j1)
           by A133,A237,A277,A278,A279,GOBRD13:22,23;
         hence thesis by A192,A237,A278,A279,A283,A288,A289,GOBRD13:22,23;
        end;
        suppose
A290:        i1+1 = i2 & j1 = j2;
          then left_cell(F.k,m,G) = cell(G,i1,j1) &
            right_cell(F.k,m,G) = cell(G,i1,j1-'1)
           by A133,A237,A277,A278,A279,GOBRD13:24,25;
         hence thesis by A192,A237,A278,A279,A283,A288,A290,GOBRD13:24,25;
        end;
        suppose
A291:        i1 = i2+1 & j1 = j2;
          then left_cell(F.k,m,G) = cell(G,i2,j2-'1) &
            right_cell(F.k,m,G) = cell(G,i2,j2)
           by A133,A237,A277,A278,A279,GOBRD13:26,27;
         hence thesis by A192,A237,A278,A279,A283,A288,A291,GOBRD13:26,27;
        end;
        suppose
A292:        i1 = i2 & j1 = j2+1;
          then left_cell(F.k,m,G) = cell(G,i2,j2) &
            right_cell(F.k,m,G) = cell(G,i1-'1,j2)
           by A133,A237,A277,A278,A279,GOBRD13:28,29;
         hence thesis by A192,A237,A278,A279,A283,A288,A292,GOBRD13:28,29;
       end;
       end;
       hence thesis;
     end;
     end;
    hence thesis;
   end;
   end;

A293: for k holds P[k] from NAT_1:sch 1(A96,A132);
A294: for k,i1,i2,j1,j2 st k > 1 &
        [i1,j1] in Indices G & (F.k)/.((len(F.k)) -'1) = G*(i1,j1) &
        [i2,j2] in Indices G & (F.k)/.len(F.k) = G*(i2,j2)
      holds
       (front_left_cell(F.k,(len(F.k))-'1,G) misses C &
          front_right_cell(F.k,(len(F.k))-'1,G) misses C
         implies F.(k+1) turns_right (len(F.k))-'1,G &
          (i1 = i2 & j1+1 = j2 implies [i2+1,j2] in Indices G &
            F.(k+1) = (F.k)^<*G*(i2+1,j2)*>) &
          (i1+1 = i2 & j1 = j2 implies [i2,j2-'1] in Indices G &
            F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>) &
          (i1 = i2+1 & j1 = j2 implies [i2,j2+1] in Indices G &
            F.(k+1) = (F.k)^<*G*(i2,j2+1)*>)&
          (i1 = i2 & j1 = j2+1 implies [i2-'1,j2] in Indices G &
            F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>)) &
       (front_left_cell(F.k,(len(F.k))-'1,G) misses C &
          front_right_cell(F.k,(len(F.k))-'1,G) meets C
         implies F.(k+1) goes_straight (len(F.k))-'1,G &
          (i1 = i2 & j1+1 = j2 implies [i2,j2+1] in Indices G &
            F.(k+1) = (F.k)^<*G*(i2,j2+1)*>) &
          (i1+1 = i2 & j1 = j2 implies [i2+1,j2] in Indices G &
            F.(k+1) = (F.k)^<*G*(i2+1,j2)*>) &
          (i1 = i2+1 & j1 = j2 implies [i2-'1,j2] in Indices G &
            F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>)&
          (i1 = i2 & j1 = j2+1 implies [i2,j2-'1] in Indices G &
            F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>)) &
       (front_left_cell(F.k,(len(F.k))-'1,G) meets C
         implies F.(k+1) turns_left (len(F.k))-'1,G &
          (i1 = i2 & j1+1 = j2 implies [i2-'1,j2] in Indices G &
            F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>) &
          (i1+1 = i2 & j1 = j2 implies [i2,j2+1] in Indices G &
            F.(k+1) = (F.k)^<*G*(i2,j2+1)*>) &
          (i1 = i2+1 & j1 = j2 implies [i2,j2-'1] in Indices G &
            F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>)&
          (i1 = i2 & j1 = j2+1 implies [i2+1,j2] in Indices G &
            F.(k+1) = (F.k)^<*G*(i2+1,j2)*>))
  proof let k,i1,i2,j1,j2 such that
A295:  k > 1 and
A296:  [i1,j1] in Indices G & (F.k)/.((len(F.k)) -'1) = G*(i1,j1) and
A297:  [i2,j2] in Indices G & (F.k)/.len(F.k) = G*(i2,j2);
A298:  (len(F.k))-'1 <= len(F.k) by BINARITH:52;
A299:   F.k is_sequence_on G by A293;
A300:   len(F.k) = k by A95;
then A301:  1 <= (len(F.k))-'1 by A295,BINARITH:67;
A302:  (len(F.k)) -'1 +1 = len(F.k) by A295,A300,BINARITH:53;
then A303: right_cell(F.k,(len(F.k))-'1,G) meets C by A293,A301;
A304: (len(F.k))-'1 in dom(F.k) & len(F.k) in dom(F.k)
       by A295,A298,A300,A301,FINSEQ_3:27;
A305: (len(F.k))-'1+(1+1) = (len(F.k))+1 by A302;
A306: i1+1 > i1 & i2+1 > i2 & j1+1 > j1 & j2+1 > j2 by NAT_1:13;
    hereby assume
           front_left_cell(F.k,(len(F.k))-'1,G) misses C &
        front_right_cell(F.k,(len(F.k))-'1,G) misses C;
     then consider i,j such that
A307:   (F.k)^<*G*(i,j)*> turns_right (len(F.k))-'1,G and
A308:   F.(k+1) = (F.k)^<*G*(i,j)*> by A80,A295,A299,A300,A303;
A309:   (F.(k+1))/.(len(F.k)-'1) = G*(i1,j1) & (F.(k+1))/.len(F.k) = G*
(i2,j2)
        by A296,A297,A304,A308,FINSEQ_4:83;
A310:   (F.(k+1))/.(len(F.k)+1) = G*(i,j) by A308,FINSEQ_4:82;
     thus
         F.(k+1) turns_right (len(F.k))-'1,G by A307,A308;
     thus i1 = i2 & j1+1 = j2 implies
      [i2+1,j2] in Indices G &
       F.(k+1) = (F.k)^<*G*(i2+1,j2)*>
       by A296,A297,A302,A305,A306,A307,A308,A309,A310,GOBRD13:def 6;
    thus i1+1 = i2 & j1 = j2 implies
       [i2,j2-'1] in Indices G &
       F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>
       by A296,A297,A302,A305,A306,A307,A308,A309,A310,GOBRD13:def 6;
     thus i1 = i2+1 & j1 = j2 implies
      [i2,j2+1] in Indices G &
      F.(k+1) = (F.k)^<*G*(i2,j2+1)*>
       by A296,A297,A302,A305,A306,A307,A308,A309,A310,GOBRD13:def 6;
     thus i1 = i2 & j1 = j2+1 implies
      [i2-'1,j2] in Indices G &
      F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>
       by A296,A297,A302,A305,A306,A307,A308,A309,A310,GOBRD13:def 6;
   end;
   hereby assume
           front_left_cell(F.k,(len(F.k))-'1,G) misses C &
        front_right_cell(F.k,(len(F.k))-'1,G) meets C;
    then consider i,j such that
A311:   (F.k)^<*G*(i,j)*> goes_straight (len(F.k))-'1,G and
A312:   F.(k+1) = (F.k)^<*G*(i,j)*> by A80,A295,A299,A300,A303;
A313:   (F.(k+1))/.(len(F.k)-'1) = G*(i1,j1) & (F.(k+1))/.len(F.k) = G*
(i2,j2)
        by A296,A297,A304,A312,FINSEQ_4:83;
A314:   (F.(k+1))/.(len(F.k)+1) = G*(i,j) by A312,FINSEQ_4:82;
    thus
       F.(k+1) goes_straight (len(F.k))-'1,G by A311,A312;
    thus i1 = i2 & j1+1 = j2 implies
      [i2,j2+1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2+1)*>
       by A296,A297,A302,A305,A306,A311,A312,A313,A314,GOBRD13:def 8;
    thus i1+1 = i2 & j1 = j2 implies
      [i2+1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2+1,j2)*>
       by A296,A297,A302,A305,A306,A311,A312,A313,A314,GOBRD13:def 8;
    thus i1 = i2+1 & j1 = j2 implies
      [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>
       by A296,A297,A302,A305,A306,A311,A312,A313,A314,GOBRD13:def 8;
    thus i1 = i2 & j1 = j2+1 implies
      [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>
       by A296,A297,A302,A305,A306,A311,A312,A313,A314,GOBRD13:def 8;
   end;
   assume
           front_left_cell(F.k,(len(F.k))-'1,G) meets C;
   then consider i,j such that
A315:   (F.k)^<*G*(i,j)*> turns_left (len(F.k))-'1,G and
A316:   F.(k+1) = (F.k)^<*G*(i,j)*> by A80,A295,A299,A300,A303;
A317:   (F.(k+1))/.(len(F.k)-'1) = G*(i1,j1) & (F.(k+1))/.len(F.k) = G*
(i2,j2)
        by A296,A297,A304,A316,FINSEQ_4:83;
A318:   (F.(k+1))/.(len(F.k)+1) = G*(i,j) by A316,FINSEQ_4:82;
   thus
       F.(k+1) turns_left (len(F.k))-'1,G by A315,A316;
   thus i1 = i2 & j1+1 = j2 implies
    [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>
       by A296,A297,A302,A305,A306,A315,A316,A317,A318,GOBRD13:def 7;
   thus i1+1 = i2 & j1 = j2 implies
    [i2,j2+1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2+1)*>
       by A296,A297,A302,A305,A306,A315,A316,A317,A318,GOBRD13:def 7;
   thus i1 = i2+1 & j1 = j2 implies
    [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>
       by A296,A297,A302,A305,A306,A315,A316,A317,A318,GOBRD13:def 7;
   thus i1 = i2 & j1 = j2+1 implies
    [i2+1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2+1,j2)*>
       by A296,A297,A302,A305,A306,A315,A316,A317,A318,GOBRD13:def 7;
 end;

A319:
  for k holds ex i,j st [i,j] in Indices G & F.(k+1) = (F.k)^<*G*(i,j)*>
   proof let k;
A320:  F.k is_sequence_on G by A293;
A321:  len(F.k) = k by A95;
A322:  len G = 2|^n+3 & len G = width G by JORDAN8:def 1;
         len G >= 4 by JORDAN8:13;
    then A323:    1 < len G by XXREAL_0:2;
    per cases by REAL_1:def 5;
    suppose k < 1;
then A324:   k = 0 by NAT_1:14;
     consider i such that
A325:      1 <= i & i+1 <= len G and
             N-min C in cell(G,i,width G-'1) & N-min C <> G*(i,width G-'1) and
A326:    F.(0+1) = <*G*(i,width G)*> by A80;
      take i, j = width G;
           i < len G by A325,NAT_1:13;
      hence [i,j] in Indices G by A322,A323,A325,GOBOARD7:10;
      thus thesis by A79,A324,A326,FINSEQ_1:47;
    end;
    suppose
A327:   k = 1;
     consider i such that
A328:    1 <= i & i+1 <= len G and
A329:    N-min C in cell(G,i,width G-'1) & N-min C <> G*(i,width G-'1) and
A330:    F.(0+1) = <*G*(i,width G)*> by A80;
     consider i' being Element of NAT such that
A331:    1 <= i' & i'+1 <= len G &
       N-min C in cell(G,i',width G-'1) & N-min C <> G*(i',width G-'1) and
A332:    F.(1+1) = <*G*(i',width G),G*(i'+1,width G)*> by A80;

A333:    i = i' by A328,A329,A331,Th31;
     take i+1,j = width G;
          1 <= i+1 & i+1 <= len G by A328,NAT_1:13;
     hence [i+1,j] in Indices G by A322,A323,GOBOARD7:10;
     thus thesis by A327,A330,A332,A333,FINSEQ_1:def 9;
    end;
    suppose
A334:   k > 1;
then A335:   1 <= (len(F.k))-'1 by A321,BINARITH:67;
           (len(F.k)) -'1 +1 = len(F.k) by A321,A334,BINARITH:53;
     then consider i1,j1,i2,j2 being Element of NAT such that
A336:   [i1,j1] in Indices G & (F.k)/.((len(F.k)) -'1) = G*(i1,j1) and
A337:   [i2,j2] in Indices G & (F.k)/.len(F.k) = G*(i2,j2) and
A338:   i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
        i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A320,A335,JORDAN8:6;
          now per cases;
       suppose
A339:       front_left_cell(F.k,(len(F.k))-'1,G) misses C &
          front_right_cell(F.k,(len(F.k))-'1,G) misses C;
              now per cases by A338;
          suppose i1 = i2 & j1+1 = j2;
           then [i2+1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2+1,j2)*>
             by A294,A334,A336,A337,A339;
            hence thesis;
          end;
          suppose i1+1 = i2 & j1 = j2;
           then [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>
             by A294,A334,A336,A337,A339;
            hence thesis;
          end;
          suppose i1 = i2+1 & j1 = j2;
           then [i2,j2+1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2+1)*>
             by A294,A334,A336,A337,A339;
            hence thesis;
          end;
          suppose i1 = i2 & j1 = j2+1;
           then [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>
             by A294,A334,A336,A337,A339;
            hence thesis;
         end;
         end;
        hence thesis;
       end;
       suppose
A340:       front_left_cell(F.k,(len(F.k))-'1,G) misses C &
          front_right_cell(F.k,(len(F.k))-'1,G) meets C;
              now per cases by A338;
          suppose i1 = i2 & j1+1 = j2;
           then [i2,j2+1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2+1)*>
             by A294,A334,A336,A337,A340;
            hence thesis;
          end;
          suppose i1+1 = i2 & j1 = j2;
           then [i2+1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2+1,j2)*>
             by A294,A334,A336,A337,A340;
            hence thesis;
          end;
          suppose i1 = i2+1 & j1 = j2;
           then [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>
             by A294,A334,A336,A337,A340;
            hence thesis;
          end;
          suppose i1 = i2 & j1 = j2+1;
           then [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>
             by A294,A334,A336,A337,A340;
            hence thesis;
         end;
         end;
        hence thesis;
       end;
       suppose
A341:       front_left_cell(F.k,(len(F.k))-'1,G) meets C;
              now per cases by A338;
          suppose i1 = i2 & j1+1 = j2;
           then [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>
             by A294,A334,A336,A337,A341;
            hence thesis;
          end;
          suppose i1+1 = i2 & j1 = j2;
           then [i2,j2+1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2+1)*>
             by A294,A334,A336,A337,A341;
            hence thesis;
          end;
          suppose i1 = i2+1 & j1 = j2;
           then [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>
             by A294,A334,A336,A337,A341;
            hence thesis;
          end;
          suppose i1 = i2 & j1 = j2+1;
           then [i2+1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2+1,j2)*>
             by A294,A334,A336,A337,A341;
            hence thesis;
         end;
         end;
        hence thesis;
     end;
     end;
     hence thesis;
   end;
   end;
defpred P[Element of NAT] means  for m st m <= $1 holds (F.$1)|m = F.m;
A342: P[0]
   proof let m;
    assume
A343:  m <= 0;
    then (F.0)|0 = (F.0)|m by XXREAL_0:1;
    hence thesis by A79,A343,XXREAL_0:1;
   end;
A344: for k st P[k] holds P[k+1]
   proof let k such that
A345:   for m st m <= k holds (F.k)|m = F.m;
    let m such that
A346:   m <= k+1;
    per cases by A346,REAL_1:def 5;
    suppose m < k+1;
then A347:    m <= k by NAT_1:13;
A348:    len(F.k) = k by A95;
     consider i,j such that
            [i,j] in Indices G and
A349:    F.(k+1) = F.k^<*G*(i,j)*> by A319;
          (F.(k+1))|m = (F.k)|m by A347,A348,A349,FINSEQ_5:25;
     hence (F.(k+1))|m = F.m by A345,A347;
    end;
    suppose
A350:    m = k+1;
          len(F.(k+1)) = k+1 by A95;
     hence (F.(k+1))|m = F.m by A350,FINSEQ_1:79;
   end;
   end;

A351: for k holds P[k] from NAT_1:sch 1(A342,A344);
A352: for k st k > 1 holds
       (front_left_cell(F.k,k-'1,Gauge(C,n)) misses C &
          front_right_cell(F.k,k-'1,Gauge(C,n)) misses C
         implies F.(k+1) turns_right k-'1,Gauge(C,n)) &
       (front_left_cell(F.k,k-'1,Gauge(C,n)) misses C &
          front_right_cell(F.k,k-'1,Gauge(C,n)) meets C
         implies F.(k+1) goes_straight k-'1,Gauge(C,n)) &
       (front_left_cell(F.k,k-'1,Gauge(C,n)) meets C
         implies F.(k+1) turns_left k-'1,Gauge(C,n))
   proof
     let k such that
A353:  k > 1;
A354:  F.k is_sequence_on G by A293;
A355:  len(F.k) = k by A95;
then A356:  1 <= (len(F.k))-'1 by A353,BINARITH:67;
         (len(F.k)) -'1 +1 = len(F.k) by A353,A355,BINARITH:53;
    then ex i1,j1,i2,j2 being Element of NAT st
         [i1,j1] in Indices G & (F.k)/.((len(F.k)) -'1) = G*(i1,j1) &
         [i2,j2] in Indices G & (F.k)/.len(F.k) = G*(i2,j2) &
         (i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
      i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1) by A354,A356,JORDAN8:6;
    hence thesis by A294,A353,A355;
   end;
   defpred P[Element of NAT] means F.$1 is unfolded;
        len(F.0) = 0 by A79,FINSEQ_1:25;
then A357: P[0] by SPPOL_2:27;
A358: for k st P[k] holds P[k+1]
   proof let k such that
A359:  F.k is unfolded;
A360:  F.k is_sequence_on G by A293;
    per cases;
    suppose k <= 1;
     then k+1 <= 1+1 by XREAL_1:8;
     then len(F.(k+1)) <= 2 by A95;
     hence F.(k+1) is unfolded by SPPOL_2:27;
    end;
    suppose
A361:   k > 1;
    set m = k-'1;
A362:   1 <= m by A361,BINARITH:67;
A363:   m+1 = k by A361,BINARITH:53;
A364:   len(F.k) = k by A95;
     then consider i1,j1,i2,j2 being Element of NAT such that
A365:   [i1,j1] in Indices G & (F.k)/.m = G*(i1,j1) and
A366:   [i2,j2] in Indices G & (F.k)/.len(F.k) = G*(i2,j2) and
A367:   i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
        i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A360,A362,A363,JORDAN8:6;
A368:  1 <= i1 & i1 <= len G & 1 <= j1 & j1 <= width G by A365,GOBOARD5:1;
A369:  1 <= i2 & i2 <= len G & 1 <= j2 & j2 <= width G by A366,GOBOARD5:1;
then A370:  (i2-'1)+1 = i2 by BINARITH:53;
A371:  (j2-'1)+1 = j2 by A369,BINARITH:53;
A372:   LSeg(F.k,m) = LSeg(G*(i1,j1),G*(i2,j2)) by A362,A363,A364,A365,A366,
TOPREAL1:def 5;
         now per cases;
     suppose
A373:     front_left_cell(F.k,(len(F.k))-'1,G) misses C &
          front_right_cell(F.k,(len(F.k))-'1,G) misses C;
           now per cases by A367;
       suppose
A374:       i1 = i2 & j1+1 = j2;
then A375:       [i2+1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2+1,j2)*>
           by A294,A361,A364,A365,A366,A373;
         then i2+1 <= len G by GOBOARD5:1;
         then LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G*
(i2+1,j2)) = {(F.k)/.len(F.k)}
          by A366,A368,A369,A372,A374,GOBOARD7:17;
        hence F.(k+1) is unfolded by A359,A363,A364,A375,SPPOL_2:31;
       end;
       suppose
A376:       i1+1 = i2 & j1 = j2;
then A377:       [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>
           by A294,A361,A364,A365,A366,A373;
         then 1 <= j2-'1 &
          LSeg((F.k)/.len(F.k),G*(i2,j2-'1))=LSeg(G*(i2,j2-'1),
          (F.k)/.len(F.k)) by GOBOARD5:1;
         then LSeg(F.k,m) /\
 LSeg((F.k)/.len(F.k),G*(i2,j2-'1)) = {(F.k)/.len(F.k)}
           by A366,A368,A369,A371,A372,A376,GOBOARD7:18;
        hence F.(k+1) is unfolded by A359,A363,A364,A377,SPPOL_2:31;
       end;
       suppose
A378:       i1 = i2+1 & j1 = j2;
then A379:       [i2,j2+1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2+1)*>
           by A294,A361,A364,A365,A366,A373;
         then j2+1 <= width G by GOBOARD5:1;
         then LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G*
(i2,j2+1)) = {(F.k)/.len(F.k)}
          by A366,A368,A369,A372,A378,GOBOARD7:19;
        hence F.(k+1) is unfolded by A359,A363,A364,A379,SPPOL_2:31;
       end;
       suppose
A380:       i1 = i2 & j1 = j2+1;
then A381:       [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>
           by A294,A361,A364,A365,A366,A373;
         then 1 <= i2-'1 by GOBOARD5:1;
         then LSeg(F.k,m) /\
 LSeg((F.k)/.len(F.k),G*(i2-'1,j2)) = {(F.k)/.len(F.k)}
          by A366,A368,A369,A370,A372,A380,GOBOARD7:20;
        hence F.(k+1) is unfolded by A359,A363,A364,A381,SPPOL_2:31;
      end;
      end;
      hence F.(k+1) is unfolded;
     end;
     suppose
A382:     front_left_cell(F.k,(len(F.k))-'1,G) misses C &
              front_right_cell(F.k,(len(F.k))-'1,G) meets C;
           now per cases by A367;
       suppose
A383:       i1 = i2 & j1+1 = j2;
then A384:       [i2,j2+1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2+1)*>
           by A294,A361,A364,A365,A366,A382;
         then 1 <= j2+1 & j2+1 <= width G & j2+1 = j1+(1+1)
          by A383,GOBOARD5:1;
         then LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G*
(i2,j2+1)) = {(F.k)/.len(F.k)}
          by A366,A368,A372,A383,GOBOARD7:15;
        hence F.(k+1) is unfolded by A359,A363,A364,A384,SPPOL_2:31;
       end;
       suppose
A385:       i1+1 = i2 & j1 = j2;
then A386:       [i2+1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2+1,j2)*>
           by A294,A361,A364,A365,A366,A382;
         then 1 <= i2+1 & i2+1 <= len G & i2+1 = i1+(1+1)
          by A385,GOBOARD5:1;
         then LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G*
(i2+1,j2)) = {(F.k)/.len(F.k)}
          by A366,A368,A372,A385,GOBOARD7:16;
        hence F.(k+1) is unfolded by A359,A363,A364,A386,SPPOL_2:31;
       end;
       suppose
A387:       i1 = i2+1 & j1 = j2;
then A388:       [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>
           by A294,A361,A364,A365,A366,A382;
         then 1 <= i2-'1 & i2-'1+1+1 = i2-'1+(1+1) by GOBOARD5:1;
         then LSeg(F.k,m) /\
 LSeg((F.k)/.len(F.k),G*(i2-'1,j2)) = {(F.k)/.len(F.k)}
          by A366,A368,A370,A372,A387,GOBOARD7:16;
        hence F.(k+1) is unfolded by A359,A363,A364,A388,SPPOL_2:31;
       end;
       suppose
A389:       i1 = i2 & j1 = j2+1;
then A390:       [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>
           by A294,A361,A364,A365,A366,A382;
         then 1 <= j2-'1 & j2-'1+1+1 = j2-'1+(1+1)
          by GOBOARD5:1;
         then LSeg(F.k,m) /\
 LSeg((F.k)/.len(F.k),G*(i2,j2-'1)) = {(F.k)/.len(F.k)}
          by A366,A368,A371,A372,A389,GOBOARD7:15;
        hence F.(k+1) is unfolded by A359,A363,A364,A390,SPPOL_2:31;
      end;
      end;
      hence F.(k+1) is unfolded;
     end;
     suppose
A391:     front_left_cell(F.k,(len(F.k))-'1,G) meets C;
           now per cases by A367;
       suppose
A392:       i1 = i2 & j1+1 = j2;
then A393:       [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>
           by A294,A361,A364,A365,A366,A391;
         then 1 <= i2-'1 &
         LSeg((F.k)/.len(F.k),G*(i2-'1,j2))=LSeg(G*(i2-'1,j2),
         (F.k)/.len(F.k)) by GOBOARD5:1;
         then LSeg(F.k,m) /\
 LSeg((F.k)/.len(F.k),G*(i2-'1,j2)) = {(F.k)/.len(F.k)}
          by A366,A368,A369,A370,A372,A392,GOBOARD7:18;
        hence F.(k+1) is unfolded by A359,A363,A364,A393,SPPOL_2:31;
       end;
       suppose
A394:       i1+1 = i2 & j1 = j2;
then A395:       [i2,j2+1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2+1)*>
           by A294,A361,A364,A365,A366,A391;
         then 1 <= j2+1 & j2+1 <= width G by GOBOARD5:1;
         then LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G*
(i2,j2+1)) = {(F.k)/.len(F.k)}
          by A366,A368,A369,A372,A394,GOBOARD7:20;
        hence F.(k+1) is unfolded by A359,A363,A364,A395,SPPOL_2:31;
       end;
       suppose
A396:       i1 = i2+1 & j1 = j2;
then A397:       [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>
           by A294,A361,A364,A365,A366,A391;
         then 1 <= j2-'1 &
         LSeg((F.k)/.len(F.k),G*(i2,j2-'1))=LSeg(G*(i2,j2-'1),
         (F.k)/.len(F.k)) by GOBOARD5:1;
         then LSeg(F.k,m) /\
 LSeg((F.k)/.len(F.k),G*(i2,j2-'1)) = {(F.k)/.len(F.k)}
          by A366,A368,A369,A371,A372,A396,GOBOARD7:17;
        hence F.(k+1) is unfolded by A359,A363,A364,A397,SPPOL_2:31;
       end;
       suppose
A398:       i1 = i2 & j1 = j2+1;
then A399:       [i2+1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2+1,j2)*>
           by A294,A361,A364,A365,A366,A391;
         then 1 <= i2+1 & i2+1 <= len G &
         LSeg((F.k)/.len(F.k),G*(i2+1,j2))=LSeg(G*
(i2+1,j2),(F.k)/.len(F.k))
          by GOBOARD5:1;
         then LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G*
(i2+1,j2)) = {(F.k)/.len(F.k)}
          by A366,A368,A369,A372,A398,GOBOARD7:19;
        hence F.(k+1) is unfolded by A359,A363,A364,A399,SPPOL_2:31;
      end;
      end;
      hence F.(k+1) is unfolded;
    end;
    end;
    hence F.(k+1) is unfolded;
   end;
   end;

A400: for k holds P[k] from NAT_1:sch 1(A357,A358);
defpred Q[Nat] means ex w being Element of NAT st w = $1 &
$1 >= 1 & ex m st m in dom(F.w) &
m <> len(F.w) & (F.w)/.m = (F.w)/.len(F.w);
   now assume
A401:   for k st k >= 1 holds
        for m st m in dom(F.k) & m <> len(F.k)
         holds (F.k)/.m <> (F.k)/.len(F.k);
         defpred P[Element of NAT] means F.$1 is one-to-one;
A402:    P[0] by A79;
A403:    for k st P[k] holds P[k+1]
     proof let k; assume
A404:    F.k is one-to-one;
           now let n,m such that
A405:     n in dom(F.(k+1)) & m in dom(F.(k+1)) and
A406:     (F.(k+1))/.n = (F.(k+1))/.m;
       consider i,j such that
             [i,j] in Indices G and
A407:     F.(k+1) = (F.k)^<*G*(i,j)*> by A319;
A408:     1 <= n & n <= len(F.(k+1)) & 1 <= m & m <= len(F.(k+1))
         by A405,FINSEQ_3:27;
A409:     len(F.k) = k & len(F.(k+1)) = k+1 by A95;
A410:     1 <= k+1 by NAT_1:12;
       per cases by A408,A409,NAT_1:8;
        suppose n <= k & m <= k;
then A411:        n in dom(F.k) & m in dom(F.k) by A408,A409,FINSEQ_3:27;
         then (F.(k+1))/.n = (F.k)/.n & (F.(k+1))/.m = (F.k)/.m
          by A407,FINSEQ_4:83;
         hence n = m by A404,A406,A411,PARTFUN2:17;
        end;
        suppose n = k+1 & m <= k;
         hence n = m by A401,A405,A406,A409,A410;
        end;
        suppose n <= k & m = k+1;
         hence n = m by A401,A405,A406,A409,A410;
        end;
        suppose n = k+1 & m = k+1;
         hence n = m;
      end;
      end;
      hence F.(k+1) is one-to-one by PARTFUN2:16;
     end;
A412:   for k holds P[k] from NAT_1:sch 1(A402,A403);
A413:   for k holds card rng(F.k) = k
     proof let k;
           F.k is one-to-one by A412;
      hence card rng(F.k) = len(F.k) by FINSEQ_4:77
                         .= k by A95;
     end;
    set k = (len G)*(width G)+1;
A414:   k > (len G)*(width G) by NAT_1:13;
A415:   card Values G <= (len G)*(width G) by GOBRD13:8;
         F.k is_sequence_on G by A293;
    then rng(F.k) c= Values G by GOBRD13:9;
    then card rng(F.k) <= card Values G by NAT_1:44;
    then card rng(F.k) <= (len G)*(width G) by A415,XXREAL_0:2;
    hence contradiction by A413,A414;
   end; then ex k be Element of NAT st Q[k];
   then A416: ex k be Nat st Q[k];
   consider k be Nat such that
A417:  Q[k] and
A418:  for l be Nat st Q[l] holds k <= l from NAT_1:sch 5(A416);
   reconsider k as Element of NAT by ORDINAL1:def 13;
  consider w being Element of NAT such that
A419: w = k and
A420: k >= 1 and
A421: ex m st m in dom(F.w) & m <> len(F.w) & (F.w)/.m = (F.w)/.len(F.w)
       by A417;
   consider m such that
A422:  m in dom(F.k) and
A423:  m <> len(F.k) and
A424:  (F.k)/.m = (F.k)/.len(F.k) by A419,A420,A421;
A425:  len(F.k) = k by A95;
  then reconsider f = F.k as non empty FinSequence of TOP-REAL 2 by A417,A419
,A420,FINSEQ_1:25;
A426: f is_sequence_on G by A293;
A427: 1 <= m & m <= len f by A422,FINSEQ_3:27;
then A428: m < len f by A423,REAL_1:def 5;
   then 1 < len f by A427,XXREAL_0:2;
then A429: len f >= 1+1 by NAT_1:13;
  then reconsider f as non constant special unfolded non empty
    FinSequence of TOP-REAL 2 by A400,A426,JORDAN8:7,8;
  set g = f/^(m-'1);
A430: m+1 <= len f by A428,NAT_1:13;
       m-'1 <= m & m < m+1 by BINARITH:62,NAT_1:13;
  then m-'1 < m+1 by XXREAL_0:2;
then A431: m-'1 < len f by A430,XXREAL_0:2;
then A432: len g = len f - (m-'1) by RFINSEQ:def 2;
  then (m-'1)-(m-'1) < len g by A431,XREAL_1:11;
  then reconsider g as non empty FinSequence of TOP-REAL 2 by FINSEQ_1:25;
       1 in dom g by FINSEQ_5:6;
then A433:  g/.1 = f/.(m-'1+1) by FINSEQ_5:30
           .= f/.m by A427,BINARITH:53;
       len g in dom g by FINSEQ_5:6;
then A434:  g/.len g = f/.(m-'1+len g) by FINSEQ_5:30
                .= f/.len f by A432;
A435: g is_sequence_on G by A426,JORDAN8:5;
then A436: g is standard by JORDAN8:7;
A437: for i st 1 <= i & i < len g & 1 <= j & j < len g & g/.i = g/.j
      holds i = j
   proof let i such that
A438:  1 <= i & i < len g and
A439:  1 <= j & j < len g and
A440:  g/.i = g/.j and
A441:  i <> j;
          i in dom g by A438,FINSEQ_3:27;
then A442:  g/.i = f/.(m-'1+i) by FINSEQ_5:30;
          j in dom g by A439,FINSEQ_3:27;
then A443:  g/.j = f/.(m-'1+j) by FINSEQ_5:30;
    per cases by A441,REAL_1:def 5;
    suppose
A444:    i < j;
     set l = m-'1+j, m'= m-'1+i;
A445:    m' < l by A444,XREAL_1:8;
A446:    l < k by A425,A432,A439,XREAL_1:22;
then A447:    f|l = F.l by A351;
          0+j <= l by XREAL_1:8;
then A448:    1 <= l by A439,XXREAL_0:2;
A449:    len(F.l) = l by A95;
          0+i <= m' by XREAL_1:8;
     then 1 <= m' by A438,XXREAL_0:2;
then A450:    m' in dom(F.l) by A445,A449,FINSEQ_3:27;
then A451:    (F.l)/.m' = f/.m' by A447,FINSEQ_4:85;
          l in dom(F.l) by A448,A449,FINSEQ_3:27;
     then (F.l)/.l = f/.l by A447,FINSEQ_4:85;
     hence contradiction by A418,A440,A442,A443,A445,A446,A448,A449,A450,A451;
    end;
    suppose
A452:    j < i;
     set l = m-'1+i, m'= m-'1+j;
A453:    m' < l by A452,XREAL_1:8;
A454:    l < k by A425,A432,A438,XREAL_1:22;
then A455:    f|l = F.l by A351;
          0+i <= l by XREAL_1:8;
then A456:    1 <= l by A438,XXREAL_0:2;
A457:    len(F.l) = l by A95;
          0+j <= m' by XREAL_1:8;
     then 1 <= m' by A439,XXREAL_0:2;
then A458:    m' in dom(F.l) by A453,A457,FINSEQ_3:27;
then A459:    (F.l)/.m' = f/.m' by A455,FINSEQ_4:85;
          l in dom(F.l) by A456,A457,FINSEQ_3:27;
     then (F.l)/.l = f/.l by A455,FINSEQ_4:85;
     hence contradiction by A418,A440,A442,A443,A453,A454,A456,A457,A458,A459;
   end;
   end;
A460: for i st 1 < i & i < j & j <= len g holds g/.i <> g/.j
   proof let i such that
A461:   1 < i and
A462:   i < j and
A463:   j <= len g and
A464:   g/.i = g/.j;
A465:   1 < j by A461,A462,XXREAL_0:2;
A466:   i < len g by A462,A463,XXREAL_0:2;
then A467:   1 < len g by A461,XXREAL_0:2;
    per cases;
    suppose j <> len g;
     then j < len g by A463,REAL_1:def 5;
     hence contradiction by A437,A461,A462,A464,A465,A466;
    end;
    suppose j = len g;
     hence contradiction by A424,A433,A434,A437,A461,A462,A464,A467;
   end;
   end;
A468: for i st 1 <= i & i < j & j < len g holds g/.i <> g/.j
   proof let i such that
A469:   1 <= i and
A470:   i < j and
A471:   j < len g and
A472:   g/.i = g/.j;
A473:   1 < j by A469,A470,XXREAL_0:2;
         i < len g by A470,A471,XXREAL_0:2;
    hence contradiction by A437,A469,A470,A471,A472,A473;
   end;
A474: for i st 1 <= i & i+1 <= len f
       holds right_cell(f,i,G) = Cl Int right_cell(f,i,G)
   proof let i such that
A475:    1 <= i & i+1 <= len f;
     consider i1,j1,i2,j2 such that
A476:    [i1,j1] in Indices G and
A477:    f/.i = G*(i1,j1) and
A478:    [i2,j2] in Indices G and
A479:    f/.(i+1) = G*(i2,j2) and
A480:    i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
        i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A426,A475,JORDAN8:6;
A481:    1 <= i1 & i1 <= len G & 1 <= j1 & j1 <= width G by A476,GOBOARD5:1;
A482:    1 <= i2 & i2 <= len G & 1 <= j2 & j2 <= width G by A478,GOBOARD5:1;
A483:    i1+1 > i1 & j1+1 > j1 & i2+1 > i2 & j2+1 > j2 by NAT_1:13;
    per cases by A480;
    suppose
           i1 = i2 & j1+1 = j2;
     then right_cell(f,i,G) = cell(G,i1,j1)
      by A426,A475,A476,A477,A478,A479,A483,GOBRD13:def 2;
     hence thesis by A481,GOBRD11:35;
    end;
    suppose
A484:   i1+1 = i2 & j1 = j2;
A485:   j1-'1 <= width G by A481,BINARITH:62;
          right_cell(f,i,G) = cell(G,i1,j1-'1)
      by A426,A475,A476,A477,A478,A479,A483,A484,GOBRD13:def 2;
     hence thesis by A481,A485,GOBRD11:35;
    end;
    suppose
           i1 = i2+1 & j1 = j2;
     then right_cell(f,i,G) = cell(G,i2,j2)
      by A426,A475,A476,A477,A478,A479,A483,GOBRD13:def 2;
     hence thesis by A482,GOBRD11:35;
    end;
    suppose
A486:   i1 = i2 & j1 = j2+1;
A487:   i1-'1 <= len G by A481,BINARITH:62;
          right_cell(f,i,G) = cell(G,i1-'1,j2)
      by A426,A475,A476,A477,A478,A479,A483,A486,GOBRD13:def 2;
     hence thesis by A482,A487,GOBRD11:35;
   end;
   end;
A488: g is s.c.c.
   proof
    let i,j such that
A489:   i+1 < j and
A490:   i > 1 & j < len g or j+1 < len g;
A491:   j <= j+1 by NAT_1:12;
then A492:  i+1 < j+1 by A489,XXREAL_0:2;
A493:   1 <= i+1 by NAT_1:12;
A494:   1 < j by A489,NAT_1:12;
        i < j by A489,NAT_1:13;
then A495:    i < j+1 by A491,XXREAL_0:2;
    per cases by A490,NAT_1:14;
    suppose
A496:    i > 1 & j < len g;
then A497:    i+1 < len g by A489,XXREAL_0:2;
then A498:    LSeg(g,i) = LSeg(g/.i,g/.(i+1)) by A496,TOPREAL1:def 5;
A499:   1 < i+1 by A496,NAT_1:13;
A500:    i < len g by A497,NAT_1:13;
     consider i1,j1,i2,j2 such that
A501:    [i1,j1] in Indices G and
A502:    g/.i = G*(i1,j1) and
A503:    [i2,j2] in Indices G and
A504:    g/.(i+1) = G*(i2,j2) and
A505:    i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
        i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A435,A496,A497,JORDAN8:6;
A506:    1 <= i1 & i1 <= len G & 1 <= j1 & j1 <= width G by A501,GOBOARD5:1;
A507:    1 <= i2 & i2 <= len G & 1 <= j2 & j2 <= width G by A503,GOBOARD5:1;
A508:    j+1 <= len g by A496,NAT_1:13;
then A509:    LSeg(g,j) = LSeg(g/.j,g/.(j+1)) by A494,TOPREAL1:def 5;
     consider i1',j1',i2',j2' being Element of NAT such that
A510:    [i1',j1'] in Indices G and
A511:    g/.j = G*(i1',j1') and
A512:    [i2',j2'] in Indices G and
A513:    g/.(j+1) = G*(i2',j2') and
A514:    i1' = i2' & j1'+1 = j2' or i1'+1 = i2' & j1' = j2' or
        i1' = i2'+1 & j1' = j2' or i1' = i2' & j1' = j2'+1
         by A435,A494,A508,JORDAN8:6;
A515:    1 <= i1' & i1' <= len G & 1 <= j1' & j1' <= width G by A510,GOBOARD5:1
;
A516:    1 <= i2' & i2' <= len G & 1 <= j2' & j2' <= width G by A512,GOBOARD5:1
;
     assume
A517:  LSeg(g,i) meets LSeg(g,j);
           now per cases by A505,A514;
       suppose
A518:      i1 = i2 & j1+1 = j2 & i1' = i2' & j1'+1 = j2';
then A519:      i1 = i1' by A498,A502,A504,A506,A507,A509,A511,A513,A515,A516
,A517,GOBOARD7:21;
              j1 = j1' or j1 = j1'+1 or j1+1 = j1'
           by A498,A502,A504,A506,A507,A509,A511,A513,A515,A516,A517,A518,
GOBOARD7:24;
        hence contradiction
           by A437,A460,A489,A491,A493,A494,A495,A496,A497,A500,A502,A504,A508
,A511,A513,A518,A519;
       end;
       suppose
A520:      i1 = i2 & j1+1 = j2 & i1'+1 = i2' & j1' = j2';
         then i1 = i1' & j1 = j1' or i1 = i1' & j1+1 = j1' or
              i1 = i1'+1 & j1 = j1' or i1 = i1'+1 & j1+1 = j1'
          by A498,A502,A504,A506,A507,A509,A511,A513,A515,A516,A517,GOBOARD7:23
;
        hence contradiction
            by A437,A460,A489,A492,A494,A495,A496,A499,A500,A502,A504,A508,A511
,A513,A520;
       end;
       suppose
A521:      i1 = i2 & j1+1 = j2 & i1' = i2'+1 & j1' = j2';
         then i1 = i2' & j1' = j1 or i1 = i2' & j1+1 = j1' or
          i1 = i2'+1 & j1' = j1 or i1 = i2'+1 & j1+1 = j1'
            by A498,A502,A504,A506,A507,A509,A511,A513,A515,A516,A517,
GOBOARD7:23;
        hence contradiction
         by A437,A460,A489,A492,A494,A495,A496,A499,A500,A502,A504,A508,A511
,A513,A521;
       end;
       suppose
A522:      i1 = i2 & j1+1 = j2 & i1' = i2' & j1' = j2'+1;
then A523:      i1 = i1' by A498,A502,A504,A506,A507,A509,A511,A513,A515,A516
,A517,GOBOARD7:21;
             j1 = j2' or j1 = j2'+1 or j1+1 = j2'
              by A498,A502,A504,A506,A507,A509,A511,A513,A515,A516,A517,A522,
GOBOARD7:24;
        hence contradiction by A437,A460,A489,A492,A494,A496,A499,A500,A502
,A504,A508,A511,A513,A522,A523;
       end;
       suppose
A524:      i1+1 = i2 & j1 = j2 & i1' = i2' & j1'+1 = j2';
        then i1' = i1 & j1 = j1' or i1' = i1 & j1'+1 = j1 or
         i1' = i1+1 & j1 = j1' or i1' = i1+1 & j1'+1 = j1
            by A498,A502,A504,A506,A507,A509,A511,A513,A515,A516,A517,
GOBOARD7:23;
        hence contradiction
            by A437,A460,A489,A492,A494,A495,A496,A499,A500,A502,A504,A508,A511
,A513,A524;
       end;
       suppose
A525:      i1+1 = i2 & j1 = j2 & i1'+1 = i2' & j1' = j2';
then A526:      j1 = j1' by A498,A502,A504,A506,A507,A509,A511,A513,A515,A516
,A517,GOBOARD7:22;
             i1 = i1' or i1 = i1'+1 or i1+1 = i1'
         by A498,A502,A504,A506,A507,A509,A511,A513,A515,A516,A517,A525,
GOBOARD7:25;
        hence contradiction
         by A437,A460,A489,A491,A493,A494,A495,A496,A497,A500,A502,A504,A508
,A511,A513,A525,A526;
       end;
       suppose
A527:      i1+1 = i2 & j1 = j2 & i1' = i2'+1 & j1' = j2';
then A528:      j1 = j1' by A498,A502,A504,A506,A507,A509,A511,A513,A515,A516
,A517,GOBOARD7:22;
             i1 = i2' or i1 = i2'+1 or i1+1 = i2'
         by A498,A502,A504,A506,A507,A509,A511,A513,A515,A516,A517,A527,
GOBOARD7:25;
        hence contradiction
         by A437,A460,A492,A494,A495,A496,A499,A500,A502,A504,A508,A511,A513
,A527,A528;
       end;
       suppose
A529:      i1+1 = i2 & j1 = j2 & i1' = i2' & j1' = j2'+1;
         then i1' = i1 & j1 = j2' or i1' = i1 & j2'+1 = j1 or
              i1' = i1+1 & j1 = j2' or i1' = i1+1 & j2'+1 = j1
             by A498,A502,A504,A506,A507,A509,A511,A513,A515,A516,A517,
GOBOARD7:23;
        hence contradiction
         by A437,A460,A489,A492,A494,A495,A496,A499,A500,A502,A504,A508,A511
,A513,A529;
       end;
       suppose
A530:      i1 = i2+1 & j1 = j2 & i1' = i2' & j1'+1 = j2';
         then i1' = i2 & j1' = j1 or i1' = i2 & j1'+1 = j1 or
              i1' = i2+1 & j1' = j1 or i1' = i2+1 & j1'+1 = j1
          by A498,A502,A504,A506,A507,A509,A511,A513,A515,A516,A517,GOBOARD7:23
;
        hence contradiction
         by A437,A460,A489,A492,A494,A495,A496,A499,A500,A502,A504,A508,A511
,A513,A530;
       end;
       suppose
A531:      i1 = i2+1 & j1 = j2 & i1'+1 = i2' & j1' = j2';
then A532:      j1 = j1' by A498,A502,A504,A506,A507,A509,A511,A513,A515,A516
,A517,GOBOARD7:22;
              i2 = i1' or i2 = i1'+1 or i2+1 = i1'
            by A498,A502,A504,A506,A507,A509,A511,A513,A515,A516,A517,A531,
GOBOARD7:25;
        hence contradiction
          by A437,A460,A489,A492,A494,A496,A499,A500,A502,A504,A508,A511,A513
,A531,A532;
       end;
       suppose
A533:      i1 = i2+1 & j1 = j2 & i1' = i2'+1 & j1' = j2';
then A534:      j1 = j1' by A498,A502,A504,A506,A507,A509,A511,A513,A515,A516
,A517,GOBOARD7:22;
              i2 = i2' or i2 = i2'+1 or i2+1 = i2'
           by A498,A502,A504,A506,A507,A509,A511,A513,A515,A516,A517,A533,
GOBOARD7:25;
        hence contradiction by A460,A489,A492,A495,A496,A499,A502,A504,A508
,A511,A513,A533,A534;
       end;
       suppose
A535:      i1 = i2+1 & j1 = j2 & i1' = i2' & j1' = j2'+1;
         then i1' = i2 & j2' = j1 or i1' = i2 & j2'+1 = j1 or
         i1' = i2+1 & j2' = j1 or i1' = i2+1 & j2'+1 = j1
           by A498,A502,A504,A506,A507,A509,A511,A513,A515,A516,A517,
GOBOARD7:23;
        hence contradiction
          by A437,A460,A489,A492,A494,A495,A496,A499,A500,A502,A504,A508,A511
,A513,A535;
       end;
       suppose
A536:      i1 = i2 & j1 = j2+1 & i1' = i2' & j1'+1 = j2';
then A537:      i1 = i1' by A498,A502,A504,A506,A507,A509,A511,A513,A515,A516
,A517,GOBOARD7:21;
              j2 = j1' or j2 = j1'+1 or j2+1 = j1'
           by A498,A502,A504,A506,A507,A509,A511,A513,A515,A516,A517,A536,
GOBOARD7:24;
        hence contradiction
          by A437,A460,A489,A492,A494,A496,A499,A500,A502,A504,A508,A511,A513
,A536,A537;
       end;
       suppose
A538:      i1 = i2 & j1 = j2+1 & i1'+1 = i2' & j1' = j2';
         then i1 = i1' & j2 = j1' or i1 = i1' & j2+1 = j1' or
             i1 = i1'+1 & j2 = j1' or i1 = i1'+1 & j2+1 = j1'
          by A498,A502,A504,A506,A507,A509,A511,A513,A515,A516,A517,GOBOARD7:23
;
        hence contradiction
          by A437,A460,A489,A492,A494,A495,A496,A499,A500,A502,A504,A508,A511
,A513,A538;
       end;
       suppose
A539:      i1 = i2 & j1 = j2+1 & i1' = i2'+1 & j1' = j2';
         then i1 = i2' & j2 = j1' or i1 = i2' & j2+1 = j1' or
             i1 = i2'+1 & j2 = j1' or i1 = i2'+1 & j2+1 = j1'
          by A498,A502,A504,A506,A507,A509,A511,A513,A515,A516,A517,GOBOARD7:23
;
        hence contradiction
          by A437,A460,A489,A492,A494,A495,A496,A499,A500,A502,A504,A508,A511
,A513,A539;
       end;
       suppose
A540:      i1 = i2 & j1 = j2+1 & i1' = i2' & j1' = j2'+1;
then A541:      i1 = i1' by A498,A502,A504,A506,A507,A509,A511,A513,A515,A516
,A517,GOBOARD7:21;
              j2 = j2' or j2 = j2'+1 or j2+1 = j2'
           by A498,A502,A504,A506,A507,A509,A511,A513,A515,A516,A517,A540,
GOBOARD7:24;
        hence contradiction by A460,A489,A492,A495,A496,A499,A502,A504,A508
,A511,A513,A540,A541;
      end;
      end;
     hence contradiction;
    end;
    suppose i = 0 & j+1 < len g;
     then LSeg(g,i) = {} by TOPREAL1:def 5;
     hence LSeg(g,i) misses LSeg(g,j) by XBOOLE_1:65;
    end;
    suppose
A542:   1 <= i & j+1 < len g;
then A543:   i+1 < len g by A492,XXREAL_0:2;
then A544:    LSeg(g,i) = LSeg(g/.i,g/.(i+1)) by A542,TOPREAL1:def 5;
A545:   1 < i+1 by A542,NAT_1:13;
A546:    i < len g by A543,NAT_1:13;
A547:   j < len g by A542,NAT_1:12;
     consider i1,j1,i2,j2 such that
A548:    [i1,j1] in Indices G and
A549:    g/.i = G*(i1,j1) and
A550:    [i2,j2] in Indices G and
A551:    g/.(i+1) = G*(i2,j2) and
A552:    i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
        i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A435,A542,A543,JORDAN8:6;
A553:    1 <= i1 & i1 <= len G & 1 <= j1 & j1 <= width G by A548,GOBOARD5:1;
A554:    1 <= i2 & i2 <= len G & 1 <= j2 & j2 <= width G by A550,GOBOARD5:1;
A555:    LSeg(g,j) = LSeg(g/.j,g/.(j+1)) by A494,A542,TOPREAL1:def 5;
     consider i1',j1',i2',j2' being Element of NAT such that
A556:    [i1',j1'] in Indices G and
A557:    g/.j = G*(i1',j1') and
A558:    [i2',j2'] in Indices G and
A559:    g/.(j+1) = G*(i2',j2') and
A560:    i1' = i2' & j1'+1 = j2' or i1'+1 = i2' & j1' = j2' or
        i1' = i2'+1 & j1' = j2' or i1' = i2' & j1' = j2'+1
         by A435,A494,A542,JORDAN8:6;
A561:    1 <= i1' & i1' <= len G & 1 <= j1' & j1' <= width G by A556,GOBOARD5:1
;
A562:    1 <= i2' & i2' <= len G & 1 <= j2' & j2' <= width G by A558,GOBOARD5:1
;
     assume
A563: LSeg(g,i) meets LSeg(g,j);
           now per cases by A552,A560;
       suppose
A564:      i1 = i2 & j1+1 = j2 & i1' = i2' & j1'+1 = j2';
then A565:      i1 = i1' by A544,A549,A551,A553,A554,A555,A557,A559,A561,A562
,A563,GOBOARD7:21;
              j1 = j1' or j1 = j1'+1 or j1+1 = j1'
           by A544,A549,A551,A553,A554,A555,A557,A559,A561,A562,A563,A564,
GOBOARD7:24;
        hence contradiction by A468,A489,A492,A493,A495,A542,A547,A549,A551
,A557,A559,A564,A565;
       end;
       suppose
A566:      i1 = i2 & j1+1 = j2 & i1'+1 = i2' & j1' = j2';
         then i1 = i1' & j1 = j1' or i1 = i1' & j1+1 = j1' or
            i1 = i1'+1 & j1 = j1' or i1 = i1'+1 & j1+1 = j1'
           by A544,A549,A551,A553,A554,A555,A557,A559,A561,A562,A563,
GOBOARD7:23;
        hence contradiction
           by A437,A468,A489,A492,A494,A495,A542,A545,A546,A547,A549,A551,A557
,A559,A566;
       end;
       suppose
A567:      i1 = i2 & j1+1 = j2 & i1' = i2'+1 & j1' = j2';
         then i1 = i2' & j1' = j1 or i1 = i2' & j1+1 = j1' or
              i1 = i2'+1 & j1' = j1 or i1 = i2'+1 & j1+1 = j1'
           by A544,A549,A551,A553,A554,A555,A557,A559,A561,A562,A563,
GOBOARD7:23;
        hence contradiction
           by A437,A468,A489,A492,A494,A495,A542,A545,A546,A547,A549,A551,A557
,A559,A567;
       end;
       suppose
A568:      i1 = i2 & j1+1 = j2 & i1' = i2' & j1' = j2'+1;
then A569:      i1 = i1' by A544,A549,A551,A553,A554,A555,A557,A559,A561,A562
,A563,GOBOARD7:21;
              j1 = j2' or j1 = j2'+1 or j1+1 = j2'
           by A544,A549,A551,A553,A554,A555,A557,A559,A561,A562,A563,A568,
GOBOARD7:24;
        hence contradiction by A437,A460,A489,A492,A494,A542,A545,A546,A547
,A549,A551,A557,A559,A568,A569;
       end;
       suppose
A570:      i1+1 = i2 & j1 = j2 & i1' = i2' & j1'+1 = j2';
         then i1' = i1 & j1 = j1' or i1' = i1 & j1'+1 = j1 or
              i1' = i1+1 & j1 = j1' or i1' = i1+1 & j1'+1 = j1
           by A544,A549,A551,A553,A554,A555,A557,A559,A561,A562,A563,
GOBOARD7:23;
        hence contradiction by A437,A468,A489,A492,A493,A494,A495,A542,A546
,A547,A549,A551,A557,A559,A570;
       end;
       suppose
A571:      i1+1 = i2 & j1 = j2 & i1'+1 = i2' & j1' = j2';
then A572:      j1 = j1' by A544,A549,A551,A553,A554,A555,A557,A559,A561,A562
,A563,GOBOARD7:22;
              i1 = i1' or i1 = i1'+1 or i1+1 = i1'
           by A544,A549,A551,A553,A554,A555,A557,A559,A561,A562,A563,A571,
GOBOARD7:25;
        hence contradiction by A468,A489,A492,A493,A495,A542,A547,A549,A551
,A557,A559,A571,A572;
       end;
       suppose
A573:      i1+1 = i2 & j1 = j2 & i1' = i2'+1 & j1' = j2';
then A574:      j1 = j1' by A544,A549,A551,A553,A554,A555,A557,A559,A561,A562
,A563,GOBOARD7:22;
              i1 = i2' or i1 = i2'+1 or i1+1 = i2'
           by A544,A549,A551,A553,A554,A555,A557,A559,A561,A562,A563,A573,
GOBOARD7:25;
        hence contradiction by A437,A468,A492,A494,A495,A542,A545,A546,A547
,A549,A551,A557,A559,A573,A574;
       end;
       suppose
A575:      i1+1 = i2 & j1 = j2 & i1' = i2' & j1' = j2'+1;
         then i1' = i1 & j1 = j2' or i1' = i1 & j2'+1 = j1 or
              i1' = i1+1 & j1 = j2' or i1' = i1+1 & j2'+1 = j1
           by A544,A549,A551,A553,A554,A555,A557,A559,A561,A562,A563,
GOBOARD7:23;
        hence contradiction by A437,A468,A489,A492,A494,A495,A542,A545,A546
,A547,A549,A551,A557,A559,A575;
       end;
       suppose
A576:      i1 = i2+1 & j1 = j2 & i1' = i2' & j1'+1 = j2';
         then i1' = i2 & j1' = j1 or i1' = i2 & j1'+1 = j1 or
              i1' = i2+1 & j1' = j1 or i1' = i2+1 & j1'+1 = j1
          by A544,A549,A551,A553,A554,A555,A557,A559,A561,A562,A563,GOBOARD7:23
;
        hence contradiction by A437,A468,A489,A492,A494,A495,A542,A545,A546
,A547,A549,A551,A557,A559,A576;
       end;
       suppose
A577:      i1 = i2+1 & j1 = j2 & i1'+1 = i2' & j1' = j2';
then A578:      j1 = j1' by A544,A549,A551,A553,A554,A555,A557,A559,A561,A562
,A563,GOBOARD7:22;
              i2 = i1' or i2 = i1'+1 or i2+1 = i1'
            by A544,A549,A551,A553,A554,A555,A557,A559,A561,A562,A563,A577,
GOBOARD7:25;
        hence contradiction by A437,A460,A489,A492,A494,A542,A545,A546,A547
,A549,A551,A557,A559,A577,A578;
       end;
       suppose
A579:      i1 = i2+1 & j1 = j2 & i1' = i2'+1 & j1' = j2';
then A580:      j1 = j1' by A544,A549,A551,A553,A554,A555,A557,A559,A561,A562
,A563,GOBOARD7:22;
              i2 = i2' or i2 = i2'+1 or i2+1 = i2'
           by A544,A549,A551,A553,A554,A555,A557,A559,A561,A562,A563,A579,
GOBOARD7:25;
        hence contradiction by A468,A489,A492,A495,A542,A545,A547,A549,A551
,A557,A559,A579,A580;
       end;
       suppose
A581:      i1 = i2+1 & j1 = j2 & i1' = i2' & j1' = j2'+1;
         then i1' = i2 & j2' = j1 or i1' = i2 & j2'+1 = j1 or
              i1' = i2+1 & j2' = j1 or i1' = i2+1 & j2'+1 = j1
            by A544,A549,A551,A553,A554,A555,A557,A559,A561,A562,A563,
GOBOARD7:23;
        hence contradiction by A437,A468,A489,A492,A494,A495,A542,A545,A546
,A547,A549,A551,A557,A559,A581;
       end;
       suppose
A582:      i1 = i2 & j1 = j2+1 & i1' = i2' & j1'+1 = j2';
then A583:      i1 = i1' by A544,A549,A551,A553,A554,A555,A557,A559,A561,A562
,A563,GOBOARD7:21;
              j2 = j1' or j2 = j1'+1 or j2+1 = j1'
           by A544,A549,A551,A553,A554,A555,A557,A559,A561,A562,A563,A582,
GOBOARD7:24;
        hence contradiction by A437,A460,A489,A492,A494,A542,A545,A546,A547
,A549,A551,A557,A559,A582,A583;
       end;
       suppose
A584:      i1 = i2 & j1 = j2+1 & i1'+1 = i2' & j1' = j2';
         then i1 = i1' & j2 = j1' or i1 = i1' & j2+1 = j1' or
              i1 = i1'+1 & j2 = j1' or i1 = i1'+1 & j2+1 = j1'
           by A544,A549,A551,A553,A554,A555,A557,A559,A561,A562,A563,
GOBOARD7:23;
        hence contradiction by A437,A468,A489,A492,A494,A495,A542,A545,A546
,A547,A549,A551,A557,A559,A584;
       end;
       suppose
A585:      i1 = i2 & j1 = j2+1 & i1' = i2'+1 & j1' = j2';
         then i1 = i2' & j2 = j1' or i1 = i2' & j2+1 = j1' or
              i1 = i2'+1 & j2 = j1' or i1 = i2'+1 & j2+1 = j1'
           by A544,A549,A551,A553,A554,A555,A557,A559,A561,A562,A563,
GOBOARD7:23;
        hence contradiction by A437,A468,A489,A492,A494,A495,A542,A545,A546
,A547,A549,A551,A557,A559,A585;
       end;
       suppose
A586:      i1 = i2 & j1 = j2+1 & i1' = i2' & j1' = j2'+1;
then A587:      i1 = i1' by A544,A549,A551,A553,A554,A555,A557,A559,A561,A562
,A563,GOBOARD7:21;
              j2 = j2' or j2 = j2'+1 or j2+1 = j2'
           by A544,A549,A551,A553,A554,A555,A557,A559,A561,A562,A563,A586,
GOBOARD7:24;
        hence contradiction by A468,A489,A492,A495,A542,A545,A547,A549,A551
,A557,A559,A586,A587;
      end;
      end;
     hence contradiction;
   end;
   end;
       m+1-(m-'1) <= len g by A430,A432,XREAL_1:11;
  then A588: m+1-(m-1) <= len g by A427,BINARITH:50;
  then A589: 1+m-m+1 <= len g;
       g is non constant
   proof
    take 1,2;
    thus
A590:   1 in dom g by FINSEQ_5:6;
    thus
A591:   2 in dom g by A588,FINSEQ_3:27;
    then g/.1 <> g/.(1+1) by A436,A590,GOBOARD7:31;
    then g.1 <> g/.(1+1) by A590,PARTFUN1:def 8;
    hence g.1 <> g.2 by A591,PARTFUN1:def 8;
   end;
  then reconsider g as standard non constant special_circular_sequence
   by A424,A433,A434,A435,A488,FINSEQ_6:def 1,JORDAN8:7;
       now
    assume m <> 1;
     then A592:  1 < m by A427,REAL_1:def 5;
A593:  LeftComp g is_a_component_of (L~g)` &
       RightComp g is_a_component_of (L~g)` by GOBOARD9:def 1,def 2;
    reconsider Lg' = (L~g)` as Subset of TOP-REAL 2;

A594:   C c= Lg'
    proof
     let c be set;
     assume that
A595:   c in C and
A596:   not c in Lg';
     reconsider c as Point of TOP-REAL 2 by A595;
          c in L~g by A596,SUBSET_1:50;
     then consider i such that
A597:   1 <= i & i+1 <= len g and
A598:   c in LSeg(g/.i,g/.(i+1)) by SPPOL_2:14;
          i in dom g & i+1 in dom g by A597,GOBOARD2:3;
then A599:   g/.i = f/.(i+(m-'1)) & g/.(i+1) = f/.(i+1+(m-'1)) by FINSEQ_5:30;
A600:   1 <= i+(m-'1) by A597,NAT_1:12;
    i+1+(m-'1) = i+(m-'1)+1;
     then A601: i+(m-'1)+1 <= (len g)+(m-'1) by A597,XREAL_1:8;
      then c in LSeg(f,i+(m-'1)) by A432,A598,A599,A600,TOPREAL1:def 5;
     then c in left_cell(f,i+(m-'1),G) /\ right_cell(f,i+(m-'1),G)
      by A426,A432,A600,A601,GOBRD13:30;
     then c in left_cell(f,i+(m-'1),G) by XBOOLE_0:def 3;
     then left_cell(f,i+(m-'1),G) meets C by A595,XBOOLE_0:3;
     hence contradiction by A293,A432,A600,A601;
    end;
A602:   TOP-REAL 2 = TopSpaceMetr (Euclid 2) by EUCLID:def 8;
         L~g is closed by SPPOL_1:49;
    then (L~g)` is open by TOPS_1:29;
then A603:  (L~g)` = Int (L~g)` by TOPS_1:55;

A604: for j,k st 1 <= j & j <= k holds (F.k)/.j = (F.j)/.j
  proof
    let j,k;
    assume that
  A605: 1 <= j and
  A606: j <= k;
  A607: (F.k)|j = F.j by A351,A606;
           j <= len(F.k) by A95,A606;
  then len(F.k|j) = j by FINSEQ_1:80;
      then j in dom((F.k)|j) by A605,FINSEQ_3:27;
      hence thesis by A607,FINSEQ_4:85;
  end;

A608:  L~g c= L~f by JORDAN3:75;

A609: for n st 1 <= n & n <= m-'1 holds not f/.n in L~g
  proof
    let n such that
  A610: 1 <= n and
  A611: n <= m-'1;
  A612: n <= len f by A431,A611,XXREAL_0:2;

    set p = f/.n;
    assume p in L~g;
    then consider j such that
  A613: m-'1+1 <= j and
  A614: j+1 <= len f and
  A615: p in LSeg(f,j) by A431,Th9;

  A616: n < m-'1+1 by A611,NAT_1:13;
  then A617: n < j by A613,XXREAL_0:2;

  A618: m-'1+1=m by A427,BINARITH:53;
  then A619: 1 < j by A592,A613,XXREAL_0:2;
  A620: j < k by A425,A614,NAT_1:13;
 A621: 2 <= len G & 2 <= width G by A2,NAT_1:12;
A622: p in Values G by A426,A610,A612,Th8;
    per cases by A426,A614,A615,A619,A621,A622,Th25;
    suppose
    A623: p = f/.j;
           n <= len(F.j) by A95,A617;
    then A624: n in dom(F.j) by A610,FINSEQ_3:27;
    A625: n <> len(F.j) by A95,A613,A616;
           (F.j)/.n = (F.n)/.n by A604,A610,A617
              .= p by A425,A604,A610,A612
              .= (F.j)/.j by A604,A619,A620,A623
              .= (F.j)/.len(F.j) by A95;
      hence contradiction by A418,A619,A620,A624,A625;

    end;
    suppose
    A626: p = f/.(j+1);
           now
        per cases by A425,A614,REAL_1:def 5;
        suppose
        A627: j+1 = k;
               n <= len(F.m) by A95,A616,A618;
        then A628: n in dom(F.m) by A610,FINSEQ_3:27;
        A629: n <> len(F.m) by A95,A616,A618;
               (F.m)/.n = (F.n)/.n by A604,A610,A616,A618
                  .= (F.k)/.k by A425,A604,A610,A612,A626,A627
                  .= (F.m)/.m by A424,A425,A427,A604
                  .= (F.m)/.len(F.m) by A95;
          hence contradiction by A418,A425,A427,A428,A628,A629;
        end;
        suppose
        A630: j+1 < k;
          set l = j+1;
        A631: 1 <= l by NAT_1:11;
          A632: n < n+1 & n+1 < l by A617,XREAL_1:8,31;
        then A633: n < l by XXREAL_0:2;
          then n <= len(F.l) by A95;
        then A634: n in dom(F.l) by A610,FINSEQ_3:27;
        A635: n <> len(F.l) by A95,A632;
               (F.l)/.n = (F.n)/.n by A604,A610,A633
                  .= p by A425,A604,A610,A612
                  .= (F.l)/.l by A604,A626,A630,A631
                  .= (F.l)/.len(F.l) by A95;
          hence contradiction by A418,A630,A631,A634,A635;
      end;
      end;
      hence contradiction;
  end;
  end;

A636: for h being standard non constant special_circular_sequence st L~h c= L~f
    for Comp being Subset of TOP-REAL 2 st Comp is_a_component_of (L~h)`
    for n st 1 <= n & n+1 <= len f & f/.n in Comp & not f/.n in L~h
      holds
     C meets Comp
  proof
    let h be standard non constant special_circular_sequence such that
  A637: L~h c= L~f;
    let Comp be Subset of TOP-REAL 2 such that
  A638: Comp is_a_component_of (L~h)`;
    let n such that
  A639: 1 <= n & n+1 <= len f and
  A640: f/.n in Comp and
  A641: not f/.n in L~h;

    reconsider rc = right_cell(f,n,G)\L~h as Subset of TOP-REAL 2;
  A642: rc c= right_cell(f,n,G) by XBOOLE_1:36;
  A643: rc = right_cell(f,n,G) /\ (L~h)` by SUBSET_1:32;

  A644: rc meets C
  proof
         right_cell(f,n,G) meets C by A293,A639;
    then consider p being set such that
  A645: p in right_cell(f,n,G) & p in C by XBOOLE_0:3;
    reconsider p as Element of TOP-REAL 2 by A645;
         now take a = p;
         now
      assume p in L~h;
      then consider j such that
    A646: 1 <= j and
    A647: j+1 <= len f and
    A648: p in LSeg(f,j) by A637,SPPOL_2:13;
           p in
 left_cell(f,j,G) /\ right_cell(f,j,G) by A426,A646,A647,A648,GOBRD13:30;
    then A649: p in left_cell(f,j,G) by XBOOLE_0:def 3;
           left_cell(f,j,G) misses C by A293,A646,A647;
      hence contradiction by A645,A649,XBOOLE_0:3;
    end;
    hence a in rc by A645,XBOOLE_0:def 4;
    thus a in C by A645;
  end; hence thesis by XBOOLE_0:3; end;

  A650: Int right_cell(f,n,G) is connected by A426,A639,Th12;
         Int right_cell(f,n,G) misses L~f by A426,A639,Th17;
    then Int right_cell(f,n,G) misses L~h by A637,XBOOLE_1:63;
  then A651: Int right_cell(f,n,G) c= (L~h)` by SUBSET_1:43;
         Int right_cell(f,n,G) c= right_cell(f,n,G) by TOPS_1:44;
  then A652: Int right_cell(f,n,G) c= rc by A643,A651,XBOOLE_1:19;
         rc c= Cl Int right_cell(f,n,G) by A426,A639,A642,Th13;
  then A653: rc is connected by A650,A652,CONNSP_1:19;
         f/.n in right_cell(f,n,G) by A426,A639,Th10;
    then f/.n in rc by A641,XBOOLE_0:def 4;
  then A654: rc meets Comp by A640,XBOOLE_0:3;
         rc c= (L~h)` by A643,XBOOLE_1:17;
    then rc c= Comp by A638,A653,A654,GOBOARD9:6;
    hence C meets Comp by A644,XBOOLE_1:63;
  end;

A655:
 C meets RightComp Rev g
  proof
    set rg=Rev g;

  A656: rg is_sequence_on G by A435,Th7;

  A657: 1+1 <= len rg by A588,FINSEQ_5:def 3;
    then 1+1-'1 <= len rg-'1 by BINARITH:60;
  then A658: 1 <= len rg -'1 by BINARITH:39;
         1 < len rg by A657,NAT_1:13;
  then A659: len rg -'1+1 = len rg by BINARITH:53;

    set p = rg/.1, q = rg/.2;
    set a = f/.(m-'1);
    set l = (m-'1)+(len g-'1);

  A660: p = f/.m by A424,A434,FINSEQ_5:68;
  A661: m-'1+1 = m by A427,BINARITH:53;
  then A662: 1 <= m-'1 by A592,NAT_1:13;

         1+1-'1 <= len g-'1 by A588,BINARITH:60;
  then A663: 1 <= len g-'1 by BINARITH:39;
        A664: 1+1 - 1 <= len g - 1 by A588,XREAL_1:11;
A665: 1 - 1 < m - 1 by A592,XREAL_1:11;
         l = m+(len g -'1)-'1 by A427,BINARITH:56
     .= (len g -'1)+m - 1 by A663,BINARITH:55
     .= (len g - 1)+m - 1 by A664,BINARITH:def 3
     .= ((k - (m - 1)) - 1)+m - 1 by A425,A432,A665,BINARITH:def 3
     .= k - 1;
  then A666: k = l+1;
  then A667: l < k by XREAL_1:31;
         len g-'1 <= l by NAT_1:11;
  then A668: 1 <= l by A663,XXREAL_0:2;
         len g-'1 <= len g by BINARITH:62;
  then A669: len g-'1 in dom g by A663,FINSEQ_3:27;
         1 <= len g by A589,SPPOL_1:5;
  then A670: len g-'1+2 = len g+1 by Lm1;
  then A671: q = g/.(len g-'1) by A669,FINSEQ_5:69
       .= f/.l by A669,FINSEQ_5:30;
  A672: right_cell(f,m-'1,G) meets C by A293,A427,A661,A662;
  A673: right_cell(f,l,G) meets C by A293,A425,A666,A668;

         not a in L~g by A609,A662;
  then A674: not a in L~rg by SPPOL_2:22;

  A675: m-'1+2 = m+1 by A427,Lm1;

  A676: m-'1 <= l by NAT_1:11;
    then m-'1 <= len(F.l) by A95;
  then A677: m-'1 in dom(F.l) by A662,FINSEQ_3:27;
         (m-'1)+1 <= l by A663,XREAL_1:8;
    then m-'1 < l by NAT_1:13;
  then A678: m-'1 <> len(F.l) by A95;

    consider p1,p2,q1,q2 being Element of NAT such that
  A679: [p1,p2] in Indices G and
  A680: p = G*(p1,p2) and
  A681: [q1,q2] in Indices G and
  A682: q = G*(q1,q2) and
  A683: p1 = q1 & p2+1 = q2 or p1+1 = q1 & p2 = q2 or
        p1 = q1+1 & p2 = q2 or p1 = q1 & p2 = q2+1 by A656,A657,JORDAN8:6;

  A684: 1 <= p1 & p1 <= len G & 1 <= p2 & p2 <= width G by A679,GOBOARD5:1;

    per cases by A683;
    suppose
    A685: p1 = q1 & p2+1 = q2;
      consider a1,a2,p'1,p'2 being Element of NAT such that
    A686: [a1,a2] in Indices G and
    A687: a = G*(a1,a2) and
    A688: [p'1,p'2] in Indices G and
    A689: p = G*(p'1,p'2) and
    A690: a1 = p'1 & a2+1 = p'2 or a1+1 = p'1 & a2 = p'2 or
          a1 = p'1+1 & a2 = p'2 or a1 = p'1 & a2 = p'2+1
            by A426,A427,A660,A661,A662,JORDAN8:6;
    A691: 1 <= a1 & a1 <= len G & 1 <= a2 & a2 <= width G by A686,GOBOARD5:1;

      thus thesis
      proof
        per cases by A690;
        suppose
               a1 = p'1 & a2+1 = p'2;
        then A692: a1 = p1 & a2+1 = p2 by A679,A680,A688,A689,GOBOARD1:21;
        A693: F.m is_sequence_on G by A293;
        A694: m-'1+1 <= len (F.m) by A95,A661;
        A695: m-'1 <= m by A661,NAT_1:11;
        A696: F.k|(m+1)=F.(m+1) by A351,A425,A430;
A697:      p2+1 > a2+1 & a2+1 > a2 by A692,NAT_1:13;
        A698: f/.(m-'1) = (F.(m-'1))/.(m-'1) by A425,A431,A604,A662
                     .= (F.m)/.(m-'1) by A604,A662,A695;
        A699: f/.(m-'1+1) = (F.m)/.m by A425,A427,A604,A661;
               right_cell(f,l,G) = cell(G,p1-'1,p2)
                 by A424,A425,A426,A660,A666,A668,A671,A679,A680,A681,A682,A685
,GOBRD13:29
            .= front_left_cell(F.m,m-'1,G) by A660,A661,A662,A679,A680,A686
,A687,A692,A693,A694,A698,A699,GOBRD13:35;
          then F.(m+1) turns_left m-'1,G by A352,A592,A673;
          then f turns_left m-'1,G by A430,A662,A675,A696,GOBRD13:45;
        then A700: f/.(m+1) = G*(p1-'1,p2) & [p1-'1,p2] in Indices G
            by A660,A661,A675,A679,A680,A686,A687,A697,GOBRD13:def 7;
        then A701: 1 <= p1-'1 & p1-'1 <= len G by GOBOARD5:1;

          set rc = right_cell(rg,len rg-'1,G)\L~rg;
        A702: rc c= RightComp rg by A656,A658,A659,Th29;
        A703: p2-'1 = a2 & p1-'1+1 = p1 by A684,A692,BINARITH:39,53;
        A704: 2 in dom g by A588,FINSEQ_3:27;
                len rg-'1+2 = len g +1 by A670,FINSEQ_5:def 3;
        then A705: rg/.(len rg-'1) = g/.2 by A704,FINSEQ_5:69
                           .= f/.(m+1) by A675,A704,FINSEQ_5:30;
             p = g/.1 by A424,A433,A434,FINSEQ_5:68
              .= rg/.len g by FINSEQ_5:68
              .= rg/.len rg by FINSEQ_5:def 3;
          then right_cell(rg,len rg-'1,G) = cell(G,p1-'1,a2)
            by A656,A658,A659,A679,A680,A700,A703,A705,GOBRD13:25;
          then a in right_cell(rg,len rg-'1,G)
            by A684,A687,A691,A692,A701,A703,Th22;
then A706:       a in rc by A674,XBOOLE_0:def 4;
        A707: L~rg c= L~f by A608,SPPOL_2:22;
               RightComp rg is_a_component_of (L~rg)` by GOBOARD9:def 2;
          hence C meets RightComp Rev g by A427,A636,A661,A662,A674,A702,A706
,A707;

        end;
        suppose
          A708: a1+1 = p'1 & a2 = p'2;
        then A709: a1+1 = p1 & a2 = p2 by A679,A680,A688,A689,GOBOARD1:21;
        then q1-'1 = a1 by A685,BINARITH:39;
          then right_cell(f,l,G) = cell(G,a1,a2)
                 by A424,A425,A426,A660,A666,A668,A671,A679,A680,A681,A682,A685
,A709,GOBRD13:29
            .= left_cell(f,m-'1,G)
                 by A426,A427,A660,A661,A662,A686,A687,A688,A689,A708,
GOBRD13:24;
          hence C meets RightComp Rev g by A293,A427,A661,A662,A673;

        end;
        suppose
               a1 = p'1+1 & a2 = p'2;
        then a1 = p1+1 & a2 = p2 by A679,A680,A688,A689,GOBOARD1:21;
          then right_cell(f,m-'1,G) = cell(G,p1,p2)
                 by A426,A427,A660,A661,A662,A679,A680,A686,A687,GOBRD13:27
            .= left_cell(f,l,G)
                 by A424,A425,A426,A660,A666,A668,A671,A679,A680,A681,A682,A685
,GOBRD13:28;
          hence C meets RightComp Rev g by A293,A425,A666,A668,A672;

        end;
        suppose
               a1 = p'1 & a2 = p'2+1;
        then A710: a1 = q1 & a2 = q2 by A679,A680,A685,A688,A689,GOBOARD1:21;
               (F.l)/.(m-'1) = (F.(m-'1))/.(m-'1) by A604,A662,A676
                     .= q by A425,A431,A604,A662,A682,A687,A710
                     .= (F.l)/.l by A604,A667,A668,A671
                     .= (F.l)/.len(F.l) by A95;
          hence C meets RightComp Rev g by A418,A667,A668,A677,A678;
      end;
      end;

    end;
    suppose
    A711: p1+1 = q1 & p2 = q2;
      consider a1,a2,p'1,p'2 being Element of NAT such that
    A712: [a1,a2] in Indices G and
    A713: a = G*(a1,a2) and
    A714: [p'1,p'2] in Indices G and
    A715: p = G*(p'1,p'2) and
    A716: a1 = p'1 & a2+1 = p'2 or a1+1 = p'1 & a2 = p'2 or
          a1 = p'1+1 & a2 = p'2 or a1 = p'1 & a2 = p'2+1
            by A426,A427,A660,A661,A662,JORDAN8:6;
    A717: 1 <= a1 & a1 <= len G & 1 <= a2 & a2 <= width G by A712,GOBOARD5:1;

      thus thesis
      proof
        per cases by A716;
        suppose
          A718: a1 = p'1 & a2+1 = p'2;
        then A719: a1 = p1 & a2+1 = p2 by A679,A680,A714,A715,GOBOARD1:21;
        then A720: q2-'1 = a2 by A711,BINARITH:39;
               right_cell(f,m-'1,G) = cell(G,a1,a2)
                 by A426,A427,A660,A661,A662,A712,A713,A714,A715,A718,
GOBRD13:23
            .= left_cell(f,l,G)
                by A424,A425,A426,A660,A666,A668,A671,A679,A680,A681,A682,A711
,A719,A720,GOBRD13:26;
          hence C meets RightComp Rev g by A293,A425,A666,A668,A672;

        end;
        suppose
               a1+1 = p'1 & a2 = p'2;
        then A721: a1+1 = p1 & a2 = p2 by A679,A680,A714,A715,GOBOARD1:21;
        A722: F.m is_sequence_on G by A293;
        A723: m-'1+1 <= len (F.m) by A95,A661;
        A724: m-'1 <= m by A661,NAT_1:11;
        A725: F.k|(m+1)=F.(m+1) by A351,A425,A430;
A726:      a1 < a1+1 & p1 < p1+1 by XREAL_1:31;
        A727: f/.(m-'1) = (F.(m-'1))/.(m-'1) by A425,A431,A604,A662
                     .= (F.m)/.(m-'1) by A604,A662,A724;
        A728: f/.(m-'1+1) = (F.m)/.m by A425,A427,A604,A661;
               right_cell(f,l,G) = cell(G,p1,p2)
                 by A424,A425,A426,A660,A666,A668,A671,A679,A680,A681,A682,A711
,GOBRD13:27
            .= front_left_cell(F.m,m-'1,G) by A660,A661,A662,A679,A680,A712
,A713,A721,A722,A723,A727,A728,GOBRD13:37;
          then F.(m+1) turns_left m-'1,G by A352,A592,A673;
          then f turns_left m-'1,G by A430,A662,A675,A725,GOBRD13:45;
        then A729: f/.(m+1) = G*(p1,p2+1) & [p1,p2+1] in Indices G
            by A660,A661,A675,A679,A680,A712,A713,A721,A726,GOBRD13:def 7;
        then A730: p2+1 <= width G by GOBOARD5:1;

          set rc = right_cell(rg,len rg-'1,G)\L~rg;
        A731: rc c= RightComp rg by A656,A658,A659,Th29;
        A732: a1 = p1-'1 by A721,BINARITH:39;
        A733: 2 in dom g by A588,FINSEQ_3:27;
                len rg-'1+2 = len g +1 by A670,FINSEQ_5:def 3;
        then A734: rg/.(len rg-'1) = g/.2 by A733,FINSEQ_5:69
                           .= f/.(m+1) by A675,A733,FINSEQ_5:30;
                p = g/.1 by A424,A433,A434,FINSEQ_5:68
              .= rg/.len g by FINSEQ_5:68
              .= rg/.len rg by FINSEQ_5:def 3;
          then right_cell(rg,len rg-'1,G) = cell(G,p1-'1,a2)
            by A656,A658,A659,A679,A680,A721,A729,A734,GOBRD13:29;
          then a in right_cell(rg,len rg-'1,G)
            by A684,A713,A717,A721,A730,A732,Th22;
then A735:       a in rc by A674,XBOOLE_0:def 4;
        A736: L~rg c= L~f by A608,SPPOL_2:22;
               RightComp rg is_a_component_of (L~rg)` by GOBOARD9:def 2;
          hence C meets RightComp Rev g by A427,A636,A661,A662,A674,A731,A735
,A736;

        end;
        suppose
               a1 = p'1+1 & a2 = p'2;
        then A737: a1 = q1 & a2 = q2 by A679,A680,A711,A714,A715,GOBOARD1:21;
               (F.l)/.(m-'1) = (F.(m-'1))/.(m-'1) by A604,A662,A676
                     .= q by A425,A431,A604,A662,A682,A713,A737
                     .= (F.l)/.l by A604,A667,A668,A671
                     .= (F.l)/.len(F.l) by A95;
          hence C meets RightComp Rev g by A418,A667,A668,A677,A678;

        end;
        suppose
               a1 = p'1 & a2 = p'2+1;
        then A738: a1 = p1 & a2 = p2+1 by A679,A680,A714,A715,GOBOARD1:21;
               right_cell(f,l,G) = cell(G,p1,p2)
                 by A424,A425,A426,A660,A666,A668,A671,A679,A680,A681,A682,A711
,GOBRD13:27
            .= left_cell(f,m-'1,G)
                 by A426,A427,A660,A661,A662,A679,A680,A712,A713,A738,
GOBRD13:28;
          hence C meets RightComp Rev g by A293,A427,A661,A662,A673;
      end;
      end;

    end;
    suppose
    A739: p1 = q1+1 & p2 = q2;
      consider a1,a2,p'1,p'2 being Element of NAT such that
    A740: [a1,a2] in Indices G and
    A741: a = G*(a1,a2) and
    A742: [p'1,p'2] in Indices G and
    A743: p = G*(p'1,p'2) and
    A744: a1 = p'1 & a2+1 = p'2 or a1+1 = p'1 & a2 = p'2 or
          a1 = p'1+1 & a2 = p'2 or a1 = p'1 & a2 = p'2+1
            by A426,A427,A660,A661,A662,JORDAN8:6;
    A745: 1 <= a1 & a1 <= len G & 1 <= a2 & a2 <= width G by A740,GOBOARD5:1;

      thus thesis
      proof
        per cases by A744;
        suppose
          A746: a1 = p'1 & a2+1 = p'2;
        then A747: a1 = p1 & a2+1 = p2 by A679,A680,A742,A743,GOBOARD1:21;
        then A748: q1 = a1-'1 by A739,BINARITH:39;
        A749: q2-'1 = a2 by A739,A747,BINARITH:39;
               right_cell(f,l,G) = cell(G,q1,q2-'1)
              by A424,A425,A426,A660,A666,A668,A671,A679,A680,A681,A682,A739,
GOBRD13:25
            .= left_cell(f,m-'1,G)
              by A426,A427,A660,A661,A662,A740,A741,A742,A743,A746,A748,A749,
GOBRD13:22;
          hence C meets RightComp Rev g by A293,A427,A661,A662,A673;

        end;
        suppose
               a1+1 = p'1 & a2 = p'2;
          then A750: a1+1 = p1 & a2 = p2 by A679,A680,A742,A743,GOBOARD1:21;
               (F.l)/.(m-'1) = (F.(m-'1))/.(m-'1) by A604,A662,A676
                     .= q by A425,A431,A604,A662,A682,A739,A741,A750
                     .= (F.l)/.l by A604,A667,A668,A671
                     .= (F.l)/.len(F.l) by A95;
          hence C meets RightComp Rev g by A418,A667,A668,A677,A678;

        end;
        suppose
               a1 = p'1+1 & a2 = p'2;
        then A751: a1 = p1+1 & a2 = p2 by A679,A680,A742,A743,GOBOARD1:21;
        A752: p1-'1 = q1 by A739,BINARITH:39;
        A753: F.m is_sequence_on G by A293;
        A754: m-'1+1 <= len (F.m) by A95,A661;
        A755: m-'1 <= m by A661,NAT_1:11;
        A756: F.k|(m+1)=F.(m+1) by A351,A425,A430;
                p1+1>p1 by XREAL_1:31;
        then A757: a2+1 > p2 & a1+1 > p1 & a2 < p2+1 by A751,NAT_1:13;
        A758: f/.(m-'1) = (F.(m-'1))/.(m-'1) by A425,A431,A604,A662
                     .= (F.m)/.(m-'1) by A604,A662,A755;
        A759: f/.(m-'1+1) = (F.m)/.m by A425,A427,A604,A661;
               right_cell(f,l,G) = cell(G,q1,q2-'1)
                 by A424,A425,A426,A660,A666,A668,A671,A679,A680,A681,A682,A739
,GOBRD13:25
            .= front_left_cell(F.m,m-'1,G) by A660,A661,A662,A679,A680,A739
,A740,A741,A751,A752,A753,A754,A758,A759,GOBRD13:39
;
          then F.(m+1) turns_left m-'1,G by A352,A592,A673;
          then f turns_left m-'1,G by A430,A662,A675,A756,GOBRD13:45;
        then A760: f/.(m+1) = G*(p1,p2-'1) & [p1,p2-'1] in Indices G
            by A660,A661,A675,A679,A680,A740,A741,A757,GOBRD13:def 7;
        then A761: 1 <= p2-'1 & p2-'1 <= width G by GOBOARD5:1;

          set rc = right_cell(rg,len rg-'1,G)\L~rg;
        A762: rc c= RightComp rg by A656,A658,A659,Th29;
        A763: p2-'1+1 = p2 by A684,BINARITH:53;
        A764: 2 in dom g by A588,FINSEQ_3:27;
                len rg-'1+2 = len g +1 by A670,FINSEQ_5:def 3;
        then A765: rg/.(len rg-'1) = g/.2 by A764,FINSEQ_5:69
                           .= f/.(m+1) by A675,A764,FINSEQ_5:30;
                 p = g/.1 by A424,A433,A434,FINSEQ_5:68
              .= rg/.len g by FINSEQ_5:68
              .= rg/.len rg by FINSEQ_5:def 3;
          then right_cell(rg,len rg-'1,G) = cell(G,p1,p2-'1)
            by A656,A658,A659,A679,A680,A760,A763,A765,GOBRD13:23;
          then a in right_cell(rg,len rg-'1,G)
            by A684,A741,A745,A751,A761,A763,Th22;
then A766:       a in rc by A674,XBOOLE_0:def 4;
        A767: L~rg c= L~f by A608,SPPOL_2:22;
               RightComp rg is_a_component_of (L~rg)` by GOBOARD9:def 2;
          hence C meets RightComp Rev g by A427,A636,A661,A662,A674,A762,A766
,A767;

        end;
        suppose
               a1 = p'1 & a2 = p'2+1;
        then A768: a1 = p1 & a2 = p2+1 by A679,A680,A742,A743,GOBOARD1:21;
        then q1 = a1-'1 by A739,BINARITH:39;
          then right_cell(f,m-'1,G) = cell(G,q1,q2)
                 by A426,A427,A660,A661,A662,A679,A680,A739,A740,A741,A768,
GOBRD13:29
            .= left_cell(f,l,G)
                 by A424,A425,A426,A660,A666,A668,A671,A679,A680,A681,A682,A739
,GOBRD13:24;
          hence C meets RightComp Rev g by A293,A425,A666,A668,A672;
      end;
      end;

    end;
    suppose
    A769: p1 = q1 & p2 = q2+1;
      consider a1,a2,p'1,p'2 being Element of NAT such that
    A770: [a1,a2] in Indices G and
    A771: a = G*(a1,a2) and
    A772: [p'1,p'2] in Indices G and
    A773: p = G*(p'1,p'2) and
    A774: a1 = p'1 & a2+1 = p'2 or a1+1 = p'1 & a2 = p'2 or
          a1 = p'1+1 & a2 = p'2 or a1 = p'1 & a2 = p'2+1
            by A426,A427,A660,A661,A662,JORDAN8:6;
    A775: 1 <= a1 & a1 <= len G & 1 <= a2 & a2 <= width G by A770,GOBOARD5:1;

      thus thesis
      proof
        per cases by A774;
        suppose
               a1 = p'1 & a2+1 = p'2;
          then A776: a1 = p1 & a2+1 = p2 by A679,A680,A772,A773,GOBOARD1:21;
               (F.l)/.(m-'1) = (F.(m-'1))/.(m-'1) by A604,A662,A676
                     .= q by A425,A431,A604,A662,A682,A769,A771,A776
                     .= (F.l)/.l by A604,A667,A668,A671
                     .= (F.l)/.len(F.l) by A95;
          hence C meets RightComp Rev g by A418,A667,A668,A677,A678;

        end;
        suppose
          A777: a1+1 = p'1 & a2 = p'2;
        then A778: a1+1 = p1 & a2 = p2 by A679,A680,A772,A773,GOBOARD1:21;
        then A779: a1 = q1-'1 by A769,BINARITH:39;
        A780: a2-'1 = q2 by A769,A778,BINARITH:39;
               right_cell(f,m-'1,G) = cell(G,a1,a2-'1)
                 by A426,A427,A660,A661,A662,A770,A771,A772,A773,A777,
GOBRD13:25
            .= left_cell(f,l,G)
                by A424,A425,A426,A660,A666,A668,A671,A679,A680,A681,A682,A769
,A779,A780,GOBRD13:22;
          hence C meets RightComp Rev g by A293,A425,A666,A668,A672;

        end;
        suppose
               a1 = p'1+1 & a2 = p'2;
        then A781: a1 = p1+1 & a2 = p2 by A679,A680,A772,A773,GOBOARD1:21;
        then A782: a2-'1 = q2 by A769,BINARITH:39;
               right_cell(f,l,G) = cell(G,q1,q2)
                 by A424,A425,A426,A660,A666,A668,A671,A679,A680,A681,A682,A769
,GOBRD13:23
            .= left_cell(f,m-'1,G)
                 by A426,A427,A660,A661,A662,A679,A680,A769,A770,A771,A781,A782
,GOBRD13:26;
          hence C meets RightComp Rev g by A293,A427,A661,A662,A673;

        end;
        suppose
               a1 = p'1 & a2 = p'2+1;
        then A783: a1 = p1 & a2 = p2+1 by A679,A680,A772,A773,GOBOARD1:21;
        A784: p2-'1 = q2 by A769,BINARITH:39;
        A785: F.m is_sequence_on G by A293;
        A786: m-'1+1 <= len (F.m) by A95,A661;
        A787: m-'1 <= m by A661,NAT_1:11;
        A788: F.k|(m+1)=F.(m+1) by A351,A425,A430;
A789:      a2+1>p2+1 & p2+1>p2 by A783,NAT_1:13;
        A790: f/.(m-'1) = (F.(m-'1))/.(m-'1) by A425,A431,A604,A662
                     .= (F.m)/.(m-'1) by A604,A662,A787;
        A791: f/.(m-'1+1) = (F.m)/.m by A425,A427,A604,A661;
               right_cell(f,l,G) = cell(G,q1,q2)
                 by A424,A425,A426,A660,A666,A668,A671,A679,A680,A681,A682,A769
,GOBRD13:23
            .= front_left_cell(F.m,m-'1,G) by A660,A661,A662,A679,A680,A769
,A770,A771,A783,A784,A785,A786,A790,A791,GOBRD13:41
;
          then F.(m+1) turns_left m-'1,G by A352,A592,A673;
          then f turns_left m-'1,G by A430,A662,A675,A788,GOBRD13:45;
        then A792: f/.(m+1) = G*(p1+1,p2) & [p1+1,p2] in Indices G
            by A660,A661,A675,A679,A680,A770,A771,A789,GOBRD13:def 7;
        then A793: p1+1 <= len G by GOBOARD5:1;

          set rc = right_cell(rg,len rg-'1,G)\L~rg;
        A794: rc c= RightComp rg by A656,A658,A659,Th29;
        A795: 2 in dom g by A588,FINSEQ_3:27;
                len rg-'1+2 = len g +1 by A670,FINSEQ_5:def 3;
        then A796: rg/.(len rg-'1) = g/.2 by A795,FINSEQ_5:69
                           .= f/.(m+1) by A675,A795,FINSEQ_5:30;
             p = g/.1 by A424,A433,A434,FINSEQ_5:68
              .= rg/.len g by FINSEQ_5:68
              .= rg/.len rg by FINSEQ_5:def 3;
          then right_cell(rg,len rg-'1,G) = cell(G,p1,p2)
            by A656,A658,A659,A679,A680,A792,A796,GOBRD13:27;
          then a in right_cell(rg,len rg-'1,G)
            by A684,A771,A775,A783,A793,Th22;
then A797:       a in rc by A674,XBOOLE_0:def 4;
        A798: L~rg c= L~f by A608,SPPOL_2:22;
               RightComp rg is_a_component_of (L~rg)` by GOBOARD9:def 2;
          hence C meets RightComp Rev g by A427,A636,A661,A662,A674,A794,A797
,A798;
      end;
      end;
  end;
  end;
A799: C meets RightComp g
   proof
         right_cell(f,m,G) meets C by A293,A427,A430;
    then consider p being set such that
A800:  p in right_cell(f,m,G) & p in C by XBOOLE_0:3;
    reconsider p as Element of TOP-REAL 2 by A800;
         now take a = p;
    thus a in C by A800;
    reconsider u = p as Element of Euclid 2 by TOPREAL3:13;
    consider r being real number such that
A801:   r > 0 and
A802:   Ball(u,r) c= (L~g)` by A594,A603,A800,GOBOARD6:8;
    reconsider r as Real by XREAL_0:def 1;
A803:   p in Ball(u,r) by A801,GOBOARD6:4;
    reconsider B = Ball(u,r) as non empty Subset of TOP-REAL 2
       by A602,A801,GOBOARD6:4,TOPMETR:16;
A804:   B is connected by SPRECT_3:17;
         right_cell(g,1,G) c= right_cell(g,1) by A435,A589,GOBRD13:34;
then A805:   Int right_cell(g,1,G) c= Int right_cell(g,1) by TOPS_1:48;
         Int right_cell(g,1) c= RightComp g by A589,GOBOARD9:28;
    then Int right_cell(g,1,G) c= RightComp g by A805,XBOOLE_1:1;
    then Int right_cell(f,m-'1+1,G) c= RightComp g by A426,A431,A589,GOBRD13:33
;
    then A806:  Int right_cell(f,m,G) c= RightComp g by A427,BINARITH:53;
A807:   right_cell(f,m,G) = Cl Int right_cell(f,m,G) by A427,A430,A474;
         B is open by GOBOARD6:6;
then A808:   Int right_cell(f,m,G) meets B by A800,A803,A807,TOPS_1:39;
A809:   p in B by A801,GOBOARD6:4;
         B c= RightComp g by A593,A802,A804,A806,A808,GOBOARD9:6;
    hence a in RightComp g by A809;
   end; hence thesis by XBOOLE_0:3; end;
         C meets LeftComp g by A655,GOBOARD9:27;
    then LeftComp g = RightComp g by A1,A593,A594,A799,Th3;
    hence contradiction by SPRECT_4:7;
  end;
then A810: g = f/^0 by BINARITH:51
      .= f by FINSEQ_5:31;
A811:
  now
   consider i such that
A812:   1 <= i & i+1 <= len G and
A813:   N-min C in cell(G,i,width G-'1) & N-min C <> G*(i,width G-'1) and
A814:   F.(1+1) = <*G*(i,width G),G*(i+1,width G)*> by A80;
   take i;
   thus 1 <= i & i+1 <= len G by A812;
A815:  f|2 = F.2 by A351,A425,A429;
A816:  len(f|2) = 2 by A429,FINSEQ_1:80;
   then 1 in dom(f|2) by FINSEQ_3:27;
   hence f/.1 = (f|2)/.1 by FINSEQ_4:85
               .= G*(i,width G) by A814,A815,FINSEQ_4:26;
        2 in dom(f|2) by A816,FINSEQ_3:27;
   hence f/.2 = (f|2)/.2 by FINSEQ_4:85
               .= G*(i+1,width G) by A814,A815,FINSEQ_4:26;
   thus N-min C in cell(G,i,width G-'1) & N-min C <> G*
(i,width G-'1) by A813;
  end;
  reconsider f as standard non constant special_circular_sequence by A810;
       f is clockwise_oriented
  proof
         len G >= 3 by A2,NAT_1:12;
then A817:  1 < len G by XXREAL_0:2;
      for k st 1 <= k & k+1 <= len f
      holds left_cell(f,k,G) misses C & right_cell(f,k,G) meets C by A293;
    then A818:   N-min L~f = f/.1 by A426,A811,Th32;
         f/.2 in LSeg(f/.1,f/.(1+1)) by TOPREAL1:6;
then A819:  f/.2 in L~f by A429,SPPOL_2:15;
    consider i such that
A820:  1 <= i & i+1 <= len G and
A821:  f/.1 = G*(i,width G) and
A822:  f/.2 = G*(i+1,width G) and
            N-min C in cell(G,i,width G-'1) & N-min C <> G*(i,width G-'1) by
A811;
A823:  (NW-corner L~f)`2 = (NE-corner L~f)`2 by PSCOMP_1:82;
A824:  (NE-corner L~f)`2 = N-bound L~f & (N-min L~f)`2 = N-bound L~f
        by EUCLID:56;
           i < len G by A820,NAT_1:13;
then A825:  G*(i,width G)`2 = G*(1,width G)`2 by A2,A817,A820,GOBOARD5:2;
           1 <= i+1 by NAT_1:12;
then A826:   G*(i+1,width G)`2 = G*(1,width G)`2 by A2,A817,A820,GOBOARD5:2;
         (NW-corner L~f)`1 = W-bound L~f & (NE-corner L~f)`1 = E-bound L~f
       by EUCLID:56;
    then (NW-corner L~f)`1 <= (f/.2)`1 & (f/.2)`1 <= (NE-corner L~f)`1
       by A819,PSCOMP_1:71;
    then f/.2 in LSeg(NW-corner L~f, NE-corner L~f)
     by A818,A821,A822,A823,A824,A825,A826,GOBOARD7:9;
    then f/.2 in LSeg(NW-corner L~f, NE-corner L~f) /\ L~f by A819,
XBOOLE_0:def 3;
    hence thesis by A818,SPRECT_2:34;
   end;
  then reconsider f as
   clockwise_oriented (standard non constant special_circular_sequence);
  take f;
  thus f is_sequence_on G by A293;
  thus ex i st 1 <= i & i+1 <= len G &
    f/.1 = G*(i,width G) & f/.2 = G*(i+1,width G) &
     N-min C in cell(G,i,width G-'1) & N-min C <> G*(i,width G-'1) by A811;
   let m such that
A827:  1 <= m & m+2 <= len f;
        m+1 < m+2 by XREAL_1:8;
then A828:  m+1 <= len f by A827,XXREAL_0:2;
then A829:  f|(m+1) = F.(m+1) by A351,A425;
A830:  m = m+1-'1 by BINARITH:39;
A831:  m+1 > 1 by A827,NAT_1:13;
A832:  front_left_cell(F.(m+1),m,G) = front_left_cell(f,m,G) &
       front_right_cell(F.(m+1),m,G) = front_right_cell(f,m,G)
        by A426,A827,A828,A829,GOBRD13:43;
A833:  F.(m+1+1) = f|(m+1+1) by A351,A425,A827;
   hereby assume front_left_cell(f,m,G) misses C &
          front_right_cell(f,m,G) misses C;
     then F.(m+1+1) turns_right m,G by A352,A830,A831,A832;
    hence f turns_right m,G by A827,A833,GOBRD13:44;
   end;
   hereby assume front_left_cell(f,m,G) misses C &
          front_right_cell(f,m,G) meets C;
    then F.(m+1+1) goes_straight m,G by A352,A830,A831,A832;
    hence f goes_straight m,G by A827,A833,GOBRD13:46;
   end;
   assume front_left_cell(f,m,G) meets C;
    then F.(m+1+1) turns_left m,G by A352,A830,A831,A832;
   hence f turns_left m,G by A827,A833,GOBRD13:45;
 end;
uniqueness
proof
  let f1,f2 be clockwise_oriented
     (standard non constant special_circular_sequence)
   such that
A834:   f1 is_sequence_on Gauge(C,n);
    given i1 such that
A835:   1 <= i1 & i1+1 <= len Gauge(C,n) and
A836:   f1/.1 = Gauge(C,n)*(i1,width Gauge(C,n)) &
      f1/.2 = Gauge(C,n)*(i1+1,width Gauge(C,n)) and
A837:   N-min C in cell(Gauge(C,n),i1,width Gauge(C,n)-'1) and
A838:   N-min C <> Gauge(C,n)*(i1,width Gauge(C,n)-'1);
   assume that
A839: for k st 1 <= k & k+2 <= len f1 holds
      (front_left_cell(f1,k,Gauge(C,n)) misses C &
         front_right_cell(f1,k,Gauge(C,n)) misses C
       implies f1 turns_right k,Gauge(C,n)) &
      (front_left_cell(f1,k,Gauge(C,n)) misses C &
        front_right_cell(f1,k,Gauge(C,n)) meets C
       implies f1 goes_straight k,Gauge(C,n)) &
      (front_left_cell(f1,k,Gauge(C,n)) meets C
       implies f1 turns_left k,Gauge(C,n)) and
A840:   f2 is_sequence_on Gauge(C,n);
   given i2 such that
A841:   1 <= i2 & i2+1 <= len Gauge(C,n) and
A842:   f2/.1 = Gauge(C,n)*(i2,width Gauge(C,n)) &
      f2/.2 = Gauge(C,n)*(i2+1,width Gauge(C,n)) and
A843:   N-min C in cell(Gauge(C,n),i2,width Gauge(C,n)-'1) and
A844:   N-min C <> Gauge(C,n)*(i2,width Gauge(C,n)-'1);
   assume
A845: for k st 1 <= k & k+2 <= len f2 holds
      (front_left_cell(f2,k,Gauge(C,n)) misses C &
         front_right_cell(f2,k,Gauge(C,n)) misses C
       implies f2 turns_right k,Gauge(C,n)) &
      (front_left_cell(f2,k,Gauge(C,n)) misses C &
        front_right_cell(f2,k,Gauge(C,n)) meets C
       implies f2 goes_straight k,Gauge(C,n)) &
      (front_left_cell(f2,k,Gauge(C,n)) meets C
       implies f2 turns_left k,Gauge(C,n));
       defpred P[Element of NAT] means f1|$1 = f2|$1;
A846:  P[0];
A847: for k st P[k] holds P[k+1]
     proof let k such that
A848:    f1|k = f2|k;
A849:    f1|1 = <*f1/.1*> & f2|1 = <*f2/.1*> by FINSEQ_5:23;
A850:    i1 = i2 by A835,A837,A838,A841,A843,A844,Th31;
A851:    len f1 > 4 & len f2 > 4 by GOBOARD7:36;
      per cases by NAT_1:26;
      suppose k = 0;
       hence f1|(k+1) = f2|(k+1) by A835,A836,A837,A838,A841,A842,A843,A844
,A849,Th31;
      end;
      suppose
A852:      k = 1;
            len f1 > 2 & len f2 > 2 by A851,XXREAL_0:2;
       then f1|2 = <*f1/.1,f1/.2*> & f2|2 = <*f2/.1,f2/.2*>
        by JORDAN8:1;
       hence f1|(k+1) = f2|(k+1) by A836,A842,A850,A852;
      end;
      suppose
A853:      k > 1;
A854:      f1/.1 = f1/.len f1 & f2/.1 = f2/.len f2 by FINSEQ_6:def 1;
            now
        per cases;
        suppose
A855:       len f1 > k;
         set m = k-'1;
A856:       1 <= m by A853,BINARITH:67;
then A857:       m+1 = k by BINARITH:61;
A858:      now assume
A859:        len f2 <= k;
then A860:        f2 = f2|k by FINSEQ_1:79;
          then 1 in dom(f2|k) by FINSEQ_5:6;
then A861:        (f1|k)/.1 = f1/.1 by A848,FINSEQ_4:85;
               len f2 in dom(f2|k) by A860,FINSEQ_5:6;
then A862:        (f1|k)/.len f2 = f1/.len f2 by A848,FINSEQ_4:85;
             1 < len f2 & len f2 <= len f1 by A848,A851,A860,FINSEQ_5:18
,XXREAL_0:2
;
          hence contradiction by A848,A854,A855,A859,A860,A861,A862,GOBOARD7:40
;
         end;
then A863:       k+1 <= len f2 by NAT_1:13;
A864:       k+1 <= len f1 by A855,NAT_1:13;
A865:    front_left_cell(f1,m,Gauge(C,n))= front_left_cell(f1|k,m,Gauge(C,n))
              by A834,A855,A856,A857,GOBRD13:43;
A866:       front_right_cell(f1,m,Gauge(C,n))
              = front_right_cell(f1|k,m,Gauge(C,n))
              by A834,A855,A856,A857,GOBRD13:43;
A867:       front_left_cell(f2,m,Gauge(C,n))
              = front_left_cell(f2|k,m,Gauge(C,n))
              by A840,A856,A857,A858,GOBRD13:43;
A868:       front_right_cell(f2,m,Gauge(C,n))
              = front_right_cell(f2|k,m,Gauge(C,n))
              by A840,A856,A857,A858,GOBRD13:43;
A869:      m+(1+1) = k+1 by A857;
              now per cases;
          suppose front_left_cell(f1,m,Gauge(C,n)) misses C &
             front_right_cell(f1,m,Gauge(C,n)) misses C;
           then f1 turns_right m,Gauge(C,n) & f2 turns_right m,Gauge(C,n)
            by A839,A845,A848,A856,A863,A864,A865,A866,A867,A868,A869;
          hence f1|(k+1) = f2|(k+1) by A840,A848,A853,A863,A864,GOBRD13:47;
         end;
         suppose front_left_cell(f1,m,Gauge(C,n)) misses C &
              front_right_cell(f1,m,Gauge(C,n)) meets C;
            then f1 goes_straight m,Gauge(C,n) & f2 goes_straight m,Gauge(C,n)
             by A839,A845,A848,A856,A863,A864,A865,A866,A867,A868,A869;
            hence f1|(k+1) = f2|(k+1) by A840,A848,A853,A863,A864,GOBRD13:49;
         end;
         suppose front_left_cell(f1,m,Gauge(C,n)) meets C;
           then f1 turns_left m,Gauge(C,n) & f2 turns_left m,Gauge(C,n)
             by A839,A845,A848,A856,A863,A864,A865,A867,A869;
           hence f1|(k+1) = f2|(k+1) by A840,A848,A853,A863,A864,GOBRD13:48;
         end;
         end;
         hence f1|(k+1) = f2|(k+1);
        end;
        suppose
A870:       k >= len f1;
then A871:       f1 = f1|k by FINSEQ_1:79;
         then 1 in dom(f1|k) by FINSEQ_5:6;
then A872:       (f2|k)/.1 = f2/.1 by A848,FINSEQ_4:85;
              len f1 in dom(f1|k) by A871,FINSEQ_5:6;
then A873:       (f2|k)/.len f1 = f2/.len f1 by A848,FINSEQ_4:85;
              1 < len f1 & len f1 <= len f2 by A848,A851,A871,FINSEQ_5:18
,XXREAL_0:2
;
then A874:       len f2 = len f1 by A848,A854,A871,A872,A873,GOBOARD7:40;
A875:        k+1 > len f1 by A870,NAT_1:13;
         hence f1|(k+1) = f1 by FINSEQ_1:79
                       .= f2 by A848,A870,A871,A874,FINSEQ_1:79
                       .= f2|(k+1) by A874,A875,FINSEQ_1:79;
        end;
        end;
       hence f1|(k+1) = f2|(k+1);
     end;
     end;
        for k holds P[k] from NAT_1:sch 1(A846,A847);
   hence f1 = f2 by Th4;
 end;
end;

theorem Th33:
  C is connected & 1 <= k & k+1 <= len Cage(C,n)
    implies
   left_cell(Cage(C,n),k,Gauge(C,n)) misses C &
     right_cell(Cage(C,n),k,Gauge(C,n)) meets C
proof
  set G = Gauge(C,n), f = Cage(C,n);
  set W = W-bound C, E = E-bound C, S = S-bound C, N = N-bound C;
  assume
A1:  C is connected;
then A2:  f is_sequence_on G by Def1;
defpred P[Element of NAT] means
for m st 1 <= m & m+1 <= len(f|$1)
       holds left_cell(f|$1,m,G) misses C & right_cell(f|$1,m,G) meets C;
A3:P[0] by FINSEQ_1:25;
A4:   len G = 2|^n+3 & len G = width G by JORDAN8:def 1;
A5: for k st P[k] holds P[k+1]
         proof let k such that
A6:   for m st 1 <= m & m+1 <= len(f|k)
        holds left_cell(f|k,m,G) misses C & right_cell(f|k,m,G) meets C;
    per cases;
    suppose
A7:    k >= len f;
     then k+1 >= len f by NAT_1:12;
     then f|k = f & f|(k+1) = f by A7,FINSEQ_1:79;
     hence thesis by A6;
    end;
    suppose
A8:   k < len f;
then A9:  k+1 <= len f by NAT_1:13;
A10:   f|k is_sequence_on G by A2,GOBOARD1:38;
A11:  f|(k+1) is_sequence_on G by A2,GOBOARD1:38;
     consider i such that
A12:   1 <= i & i+1 <= len G and
A13:   f/.1 = G*(i,width G) and
A14:   f/.2 = G*(i+1,width G) and
A15:   N-min C in cell(G,i,width G-'1) & N-min C <> G*(i,width G-'1)
         by A1,Def1;
A16:   len(f|k) = k by A8,FINSEQ_1:80;
A17:   len(f|(k+1)) = k+1 by A9,FINSEQ_1:80;
A18:   1 <= len G by A4,NAT_1:12;
         A19: 2|^n >= n+1 & n+1 >= 1 by NAT_1:12,NEWTON:104;
     let m such that
A20:  1 <= m & m+1 <= len(f|(k+1));
         now per cases by NAT_1:26;
    suppose
A21:   k = 0;
          1 <= m+1 by NAT_1:12;
     then m+1 = 0+1 by A17,A20,A21,XXREAL_0:1;
     hence left_cell(f|(k+1),m,G) misses C &
              right_cell(f|(k+1),m,G) meets C by A20;
    end;
    suppose
A22:   k = 1;
then f|(k+1) = <*G*(i,width G),G*(i+1,width G)*> by A9,A13,A14,JORDAN8:1;
then A23:   (f|(k+1))/.1 = G*(i,width G) & (f|(k+1))/.2 = G*(i+1,width G)
        by FINSEQ_4:26;
A24:  i < len G & 1 <= i+1 & i+1 <= len G by A12,NAT_1:13;
then A25:   [i,len G] in Indices G & [i+1,len G] in Indices G
        by A4,A12,A18,GOBOARD7:10;
          1+1 <= m+1 by A20,XREAL_1:8;
     then A26: m+1 = 1+1 by A17,A20,A22,XXREAL_0:1;
A27:     i < i+1 & i+1 < (i+1)+1 by NAT_1:13;
then A28:   left_cell(f|(k+1),m,G) = cell(G,i,len G)
        by A4,A11,A20,A23,A25,A26,GOBRD13:def 3;
          now assume left_cell(f|(k+1),m,G) meets C;
      then consider p being set such that
A29:     p in cell(G,i,len G) & p in C by A28,XBOOLE_0:3;
       reconsider p as Element of TOP-REAL 2 by A29;
           cell(G,i,len G) = { |[r,s]|: G*(i,1)`1 <= r & r <= G*(i+1,1)`1 &
                                  G*(1,len G)`2 <= s }
       by A4,A12,A24,GOBRD11:31;
      then consider r,s such that
A30:     p = |[r,s]| and
             G*(i,1)`1 <= r & r <= G*(i+1,1)`1 and
A31:     G*(1,len G)`2 <= s by A29;
           [1,len G] in Indices G by A4,A18,GOBOARD7:10;
then A32:     G*(1,len G) = |[W+((E-W)/(2|^n))*(1-2),S+((N-S)/(2|^n))*((len G)-
2)]|
         by JORDAN8:def 1;
       A33: ((N-S)/(2|^n))*((len G)-2)
           = ((N-S)/(2|^n))*(2|^n)+((N-S)/(2|^n))*1 by A4
          .= (N-S)+(N-S)/(2|^n) by A19,XCMPLX_1:88;
A34:     G*(1,len G)`2 = S+((N-S)/(2|^n))*((len G)-2) by A32,EUCLID:56;
            N > S by JORDAN8:12;
       then N-S > S-S by XREAL_1:11;
       then (N-S)/(2|^n) > 0 by A19,REAL_2:127;
       then N+0 < N+(N-S)/(2|^n) by XREAL_1:8;
then A35:     N < s by A31,A33,A34,XXREAL_0:2;
            p`2 <= N by A29,PSCOMP_1:71;
      hence contradiction by A30,A35,EUCLID:56;
     end;
     hence left_cell(f|(k+1),m,G) misses C;
A36:   N-min C in C by SPRECT_1:13;
          N-min C in right_cell(f|(k+1),m,G)
      by A4,A11,A15,A20,A23,A25,A26,A27,GOBRD13:def 2;
     hence right_cell(f|(k+1),m,G) meets C by A36,XBOOLE_0:3;
    end;
    suppose
A37:   k > 1;
then A38:   1 <= (len(f|k))-'1 by A16,BINARITH:67;
A39:   (len(f|k)) -'1 +1 = len(f|k) by A16,A37,BINARITH:53;
          now per cases;
      suppose A40: m+1 = len(f|(k+1));
A41:     len(f|k) <= len f by FINSEQ_5:18;
             now
         consider i1,j1,i2,j2 being Element of NAT such that
A42:       [i1,j1] in Indices G & f/.((len(f|k)) -'1) = G*(i1,j1) and
A43:       [i2,j2] in Indices G & f/.len(f|k) = G*(i2,j2) and
               i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
           i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1
            by A2,A8,A16,A38,A39,JORDAN8:6;
A44:      1 <= i2 & i2 <= len G & 1 <= j2 & j2 <= width G by A43,GOBOARD5:1;
A45:      (len(f|k))-'1+(1+1) = (len(f|k))+1 by A39;
A46:      (i2-'1)+1 = i2 by A44,BINARITH:53;
A47:       (j2-'1)+1 = j2 by A44,BINARITH:53;
               left_cell(f|k,(len(f|k))-'1,G) misses C &
            right_cell(f|k,(len(f|k))-'1,G) meets C by A6,A38,A39;
then A48:      left_cell(f,(len(f|k))-'1,G) misses C &
           right_cell(f,(len(f|k))-'1,G) meets C
 by A2,A16,A38,A39,A41,GOBRD13:32;
         per cases;
         suppose
A49:        front_left_cell(f,(len(f|k))-'1,G) misses C &
            front_right_cell(f,(len(f|k))-'1,G) misses C;
          then A50:        f turns_right (len(f|k))-'1,G by A1,A9,A16,A38,A45,
Def1;
               now per cases by A39,A42,A43,A45,A50,GOBRD13:def 6;
           suppose that
A51:           i1 = i2 & j1+1 = j2 and
A52:           [i2+1,j2] in Indices G and
A53:           f/.((len(f|k))+1) = G*(i2+1,j2);
                  front_right_cell(f,(len(f|k))-'1,G) = cell(G,i1,j2)
               by A2,A38,A39,A41,A42,A43,A51,GOBRD13:36;
            then left_cell(f,m,G) misses C
               by A2,A9,A16,A17,A20,A40,A43,A49,A51,A52,A53,GOBRD13:24;
            hence left_cell(f|(k+1),m,G) misses C
              by A2,A9,A17,A20,A40,GOBRD13:32;
                  j2-'1 = j1 & cell(G,i1,j1) meets C
               by A2,A38,A39,A41,A42,A43,A48,A51,BINARITH:39,GOBRD13:23;
            then right_cell(f,m,G) meets C
               by A2,A9,A16,A17,A20,A40,A43,A51,A52,A53,GOBRD13:25;
            hence right_cell(f|(k+1),m,G) meets C
              by A2,A9,A17,A20,A40,GOBRD13:32;
           end;
           suppose that
A54:           i1+1 = i2 & j1 = j2 and
A55:           [i2,j2-'1] in Indices G and
A56:           f/.((len(f|k))+1) = G*(i2,j2-'1);
                  front_right_cell(f,(len(f|k))-'1,G) = cell(G,i2,j2-'1)
               by A2,A38,A39,A41,A42,A43,A54,GOBRD13:38;
            then left_cell(f,m,G) misses C
               by A2,A9,A16,A17,A20,A40,A43,A47,A49,A55,A56,GOBRD13:28;
            hence left_cell(f|(k+1),m,G) misses C
               by A2,A9,A17,A20,A40,GOBRD13:32;
                  i2-'1 = i1 & cell(G,i1,j1-'1) meets C
               by A2,A38,A39,A41,A42,A43,A48,A54,BINARITH:39,GOBRD13:25;
            then right_cell(f,m,G) meets C
               by A2,A9,A16,A17,A20,A40,A43,A47,A54,A55,A56,GOBRD13:29;
            hence right_cell(f|(k+1),m,G) meets C
               by A2,A9,A17,A20,A40,GOBRD13:32;
           end;
           suppose that
A57:           i1 = i2+1 & j1 = j2 and
A58:           [i2,j2+1] in Indices G and
A59:           f/.((len(f|k))+1) = G*(i2,j2+1);
                  front_right_cell(f,(len(f|k))-'1,G) = cell(G,i2-'1,j2)
               by A2,A38,A39,A41,A42,A43,A57,GOBRD13:40;
            then left_cell(f,m,G) misses C
               by A2,A9,A16,A17,A20,A40,A43,A49,A58,A59,GOBRD13:22;
            hence left_cell(f|(k+1),m,G) misses C
               by A2,A9,A17,A20,A40,GOBRD13:32;
                  cell(G,i2,j2) meets C
               by A2,A38,A39,A41,A42,A43,A48,A57,GOBRD13:27;
            then right_cell(f,m,G) meets C
               by A2,A9,A16,A17,A20,A40,A43,A58,A59,GOBRD13:23;
            hence right_cell(f|(k+1),m,G) meets C
               by A2,A9,A17,A20,A40,GOBRD13:32;
           end;
           suppose that
A60:           i1 = i2 & j1 = j2+1 and
A61:           [i2-'1,j2] in Indices G and
A62:           f/.((len(f|k))+1) = G*(i2-'1,j2);
                  front_right_cell(f,(len(f|k))-'1,G) = cell(G,i2-'1,j2-'1)
               by A2,A38,A39,A41,A42,A43,A60,GOBRD13:42;
            then left_cell(f,m,G) misses C
              by A2,A9,A16,A17,A20,A40,A43,A46,A49,A61,A62,GOBRD13:26;
            hence left_cell(f|(k+1),m,G) misses C
              by A2,A9,A17,A20,A40,GOBRD13:32;
                  cell(G,i2-'1,j2) meets C by A2,A38,A39,A41,A42,A43,A48,A60,
GOBRD13:29;
            then right_cell(f,m,G) meets C
             by A2,A9,A16,A17,A20,A40,A43,A46,A61,A62,GOBRD13:27;
            hence right_cell(f|(k+1),m,G) meets C
             by A2,A9,A17,A20,A40,GOBRD13:32;
          end;
          end;
          hence thesis;
         end;
         suppose
A63:        front_left_cell(f,(len(f|k))-'1,G) misses C &
             front_right_cell(f,(len(f|k))-'1,G) meets C;
            then A64:        f goes_straight (len(f|k))-'1,G by A1,A9,A16,A38
,A45,Def1;
               now per cases by A39,A42,A43,A45,A64,GOBRD13:def 8;
           suppose that
A65:           i1 = i2 & j1+1 = j2 and
A66:           [i2,j2+1] in Indices G and
A67:           f/.(len(f|k)+1) = G*(i2,j2+1);
                  front_left_cell(f,(len(f|k))-'1,G) = cell(G,i1-'1,j2)
               by A2,A38,A39,A41,A42,A43,A65,GOBRD13:35;
             then left_cell(f,m,G) misses C
               by A2,A9,A16,A17,A20,A40,A43,A63,A65,A66,A67,GOBRD13:22;
             hence left_cell(f|(k+1),m,G) misses C
               by A2,A9,A17,A20,A40,GOBRD13:32;
                 front_right_cell(f,(len(f|k))-'1,G) = cell(G,i1,j2)
               by A2,A38,A39,A41,A42,A43,A65,GOBRD13:36;
            then right_cell(f,m,G) meets C
               by A2,A9,A16,A17,A20,A40,A43,A63,A65,A66,A67,GOBRD13:23;
            hence right_cell(f|(k+1),m,G) meets C
               by A2,A9,A17,A20,A40,GOBRD13:32;
           end;
           suppose that
A68:           i1+1 = i2 & j1 = j2 and
A69:           [i2+1,j2] in Indices G and
A70:           f/.(len(f|k)+1) = G*(i2+1,j2);
                  front_left_cell(f,(len(f|k))-'1,G) = cell(G,i2,j2)
               by A2,A38,A39,A41,A42,A43,A68,GOBRD13:37;
            then left_cell(f,m,G) misses C
               by A2,A9,A16,A17,A20,A40,A43,A63,A69,A70,GOBRD13:24;
            hence left_cell(f|(k+1),m,G) misses C
               by A2,A9,A17,A20,A40,GOBRD13:32;
                  front_right_cell(f,(len(f|k))-'1,G) = cell(G,i2,j2-'1)
               by A2,A38,A39,A41,A42,A43,A68,GOBRD13:38;
            then right_cell(f,m,G) meets C
               by A2,A9,A16,A17,A20,A40,A43,A63,A69,A70,GOBRD13:25;
            hence right_cell(f|(k+1),m,G) meets C
               by A2,A9,A17,A20,A40,GOBRD13:32;
           end;
           suppose that
A71:          i1 = i2+1 & j1 = j2 and
A72:          [i2-'1,j2] in Indices G and
A73:          f/.(len(f|k)+1) = G*(i2-'1,j2);
                  front_left_cell(f,(len(f|k))-'1,G) = cell(G,i2-'1,j2-'1)
               by A2,A38,A39,A41,A42,A43,A71,GOBRD13:39;
            then left_cell(f,m,G) misses C
               by A2,A9,A16,A17,A20,A40,A43,A46,A63,A72,A73,GOBRD13:26;
            hence left_cell(f|(k+1),m,G) misses C
               by A2,A9,A17,A20,A40,GOBRD13:32;
                  front_right_cell(f,(len(f|k))-'1,G) = cell(G,i2-'1,j2)
               by A2,A38,A39,A41,A42,A43,A71,GOBRD13:40;
            then right_cell(f,m,G) meets C
               by A2,A9,A16,A17,A20,A40,A43,A46,A63,A72,A73,GOBRD13:27;
            hence right_cell(f|(k+1),m,G) meets C
               by A2,A9,A17,A20,A40,GOBRD13:32;
           end;
           suppose that
A74:          i1 = i2 & j1 = j2+1 and
A75:          [i2,j2-'1] in Indices G and
A76:          f/.(len(f|k)+1) = G*(i2,j2-'1);
                  front_left_cell(f,(len(f|k))-'1,G) = cell(G,i2,j2-'1)
               by A2,A38,A39,A41,A42,A43,A74,GOBRD13:41;
            then left_cell(f,m,G) misses C
               by A2,A9,A16,A17,A20,A40,A43,A47,A63,A75,A76,GOBRD13:28;
            hence left_cell(f|(k+1),m,G) misses C
               by A2,A9,A17,A20,A40,GOBRD13:32;
                  front_right_cell(f,(len(f|k))-'1,G) = cell(G,i2-'1,j2-'1)
               by A2,A38,A39,A41,A42,A43,A74,GOBRD13:42;
            then right_cell(f,m,G) meets C
               by A2,A9,A16,A17,A20,A40,A43,A47,A63,A75,A76,GOBRD13:29;
            hence right_cell(f|(k+1),m,G) meets C
               by A2,A9,A17,A20,A40,GOBRD13:32;
          end;
          end;
          hence thesis;
         end;
         suppose
A77:        front_left_cell(f,(len(f|k))-'1,G) meets C;
then A78:        f turns_left (len(f|k))-'1,G by A1,A9,A16,A38,A45,Def1;
               now per cases by A39,A42,A43,A45,A78,GOBRD13:def 7;
           suppose that
A79:           i1 = i2 & j1+1 = j2 and
A80:           [i2-'1,j2] in Indices G and
A81:           f/.(len(f|k)+1) = G*(i2-'1,j2);
                  j2-'1 = j1 &
             cell(G,i1-'1,j1) misses C
               by A2,A38,A39,A41,A42,A43,A48,A79,BINARITH:39,GOBRD13:22;
            then left_cell(f,m,G) misses C
               by A2,A9,A16,A17,A20,A40,A43,A46,A79,A80,A81,GOBRD13:26;
            hence left_cell(f|(k+1),m,G) misses C
               by A2,A9,A17,A20,A40,GOBRD13:32;
                  front_left_cell(f,(len(f|k))-'1,G) = cell(G,i1-'1,j2)
               by A2,A38,A39,A41,A42,A43,A79,GOBRD13:35;
            then right_cell(f,m,G) meets C
               by A2,A9,A16,A17,A20,A40,A43,A46,A77,A79,A80,A81,GOBRD13:27;
            hence right_cell(f|(k+1),m,G) meets C
               by A2,A9,A17,A20,A40,GOBRD13:32;
           end;
           suppose that
A82:           i1+1 = i2 & j1 = j2 and
A83:           [i2,j2+1] in Indices G and
A84:           f/.(len(f|k)+1) = G*(i2,j2+1);
                  i2-'1 = i1 & cell(G,i1,j1) misses C
               by A2,A38,A39,A41,A42,A43,A48,A82,BINARITH:39,GOBRD13:24;
             then left_cell(f,m,G) misses C
               by A2,A9,A16,A17,A20,A40,A43,A82,A83,A84,GOBRD13:22;
             hence left_cell(f|(k+1),m,G) misses C
               by A2,A9,A17,A20,A40,GOBRD13:32;
                  front_left_cell(f,(len(f|k))-'1,G) = cell(G,i2,j2)
               by A2,A38,A39,A41,A42,A43,A82,GOBRD13:37;
            then right_cell(f,m,G) meets C
               by A2,A9,A16,A17,A20,A40,A43,A77,A83,A84,GOBRD13:23;
            hence right_cell(f|(k+1),m,G) meets C
               by A2,A9,A17,A20,A40,GOBRD13:32;
           end;
           suppose that
A85:           i1 = i2+1 & j1 = j2 and
A86:           [i2,j2-'1] in Indices G and
A87:           f/.(len(f|k)+1) = G*(i2,j2-'1);
                  cell(G,i2,j2-'1) misses C
               by A2,A38,A39,A41,A42,A43,A48,A85,GOBRD13:26;
            then left_cell(f,m,G) misses C
               by A2,A9,A16,A17,A20,A40,A43,A47,A86,A87,GOBRD13:28;
            hence left_cell(f|(k+1),m,G) misses C
               by A2,A9,A17,A20,A40,GOBRD13:32;
                  front_left_cell(f,(len(f|k))-'1,G) = cell(G,i2-'1,j2-'1)
               by A2,A38,A39,A41,A42,A43,A85,GOBRD13:39;
            then right_cell(f,m,G) meets C
               by A2,A9,A16,A17,A20,A40,A43,A47,A77,A86,A87,GOBRD13:29;
            hence right_cell(f|(k+1),m,G) meets C
               by A2,A9,A17,A20,A40,GOBRD13:32;
           end;
           suppose that
A88:           i1 = i2 & j1 = j2+1 and
A89:           [i2+1,j2] in Indices G and
A90:           f/.(len(f|k)+1) = G*(i2+1,j2);
                  cell(G,i2,j2) misses C
              by A2,A38,A39,A41,A42,A43,A48,A88,GOBRD13:28;
            then left_cell(f,m,G) misses C
               by A2,A9,A16,A17,A20,A40,A43,A89,A90,GOBRD13:24;
            hence left_cell(f|(k+1),m,G) misses C
               by A2,A9,A17,A20,A40,GOBRD13:32;
                  front_left_cell(f,(len(f|k))-'1,G) = cell(G,i2,j2-'1)
               by A2,A38,A39,A41,A42,A43,A88,GOBRD13:41;
            then right_cell(f,m,G) meets C
               by A2,A9,A16,A17,A20,A40,A43,A77,A89,A90,GOBRD13:25;
            hence right_cell(f|(k+1),m,G) meets C
               by A2,A9,A17,A20,A40,GOBRD13:32;
          end;
          end;
         hence thesis;
        end;
        end;
       hence thesis;
      end;
      suppose m+1 <> len(f|(k+1));
       then m+1 < len(f|(k+1)) by A20,REAL_1:def 5;
       then A91:     m+1 <= len(f|k)by A16,A17,NAT_1:13;
       then consider i1,j1,i2,j2 being Element of NAT such that
A92:     [i1,j1] in Indices G & (f|k)/.m = G*(i1,j1) and
A93:     [i2,j2] in Indices G & (f|k)/.(m+1) = G*(i2,j2) and
A94:      i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
          i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A10,A20,JORDAN8:6;
A95:    1 <= m+1 by NAT_1:12;
             m <= len(f|k) by A91,NAT_1:13;
then A96:    m in dom(f|k) & m+1 in dom(f|k) by A20,A91,A95,FINSEQ_3:27;
A97:     left_cell(f|k,m,G) misses C & right_cell(f|k,m,G) meets C
         by A6,A20,A91;
          f|(k+1) = (f|k)^<*f/.(k+1)*> by A9,JORDAN8:2;
then A98:      (f|(k+1))/.m = G*(i1,j1) & (f|(k+1))/.(m+1) = G*(i2,j2)
            by A92,A93,A96,FINSEQ_4:83;
            now per cases by A94;
        suppose
A99:        i1 = i2 & j1+1 = j2;
          then left_cell(f|k,m,G) = cell(G,i1-'1,j1) &
            right_cell(f|k,m,G) = cell(G,i1,j1)
           by A10,A20,A91,A92,A93,GOBRD13:22,23;
         hence thesis by A11,A20,A92,A93,A97,A98,A99,GOBRD13:22,23;
        end;
        suppose
A100:        i1+1 = i2 & j1 = j2;
          then left_cell(f|k,m,G) = cell(G,i1,j1) &
            right_cell(f|k,m,G) = cell(G,i1,j1-'1)
           by A10,A20,A91,A92,A93,GOBRD13:24,25;
         hence thesis by A11,A20,A92,A93,A97,A98,A100,GOBRD13:24,25;
        end;
        suppose
A101:        i1 = i2+1 & j1 = j2;
          then left_cell(f|k,m,G) = cell(G,i2,j2-'1) &
            right_cell(f|k,m,G) = cell(G,i2,j2)
           by A10,A20,A91,A92,A93,GOBRD13:26,27;
         hence thesis by A11,A20,A92,A93,A97,A98,A101,GOBRD13:26,27;
        end;
        suppose
A102:        i1 = i2 & j1 = j2+1;
          then left_cell(f|k,m,G) = cell(G,i2,j2) &
            right_cell(f|k,m,G) = cell(G,i1-'1,j2)
           by A10,A20,A91,A92,A93,GOBRD13:28,29;
         hence thesis by A11,A20,A92,A93,A97,A98,A102,GOBRD13:28,29;
       end;
       end;
       hence thesis;
     end;
     end;
     hence thesis;
    end;
    end;
    hence thesis;
   end;
   end;
A103: for k holds P[k]
     from NAT_1:sch 1(A3,A5);
       f|len f = f by FINSEQ_1:79;
  hence thesis by A103;
end;

theorem
  C is connected implies N-min L~Cage(C,n) = (Cage(C,n))/.1
proof
 set f = Cage(C,n);
 assume
A1: C is connected;
then A2: f is_sequence_on Gauge(C,n) &
 (ex i st 1 <= i & i+1 <= len Gauge(C,n) &
          f/.1 = Gauge(C,n)*(i,width Gauge(C,n)) &
          f/.2 = Gauge(C,n)*(i+1,width Gauge(C,n)) &
          N-min C in cell(Gauge(C,n),i,width Gauge(C,n)-'1) &
          N-min C <> Gauge(C,n)*(i,width Gauge(C,n)-'1)) by Def1;
       for k st 1 <= k & k+1 <= len f
    holds left_cell(f,k,Gauge(C,n)) misses C &
          right_cell(f,k,Gauge(C,n)) meets C by A1,Th33;
  hence thesis by A2,Th32;
end;
