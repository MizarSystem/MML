:: On a Dividing Function of the Simple Closed Curve into Segments
::  by Yatsuka Nakamura
::
:: Received June 16, 1998
:: Copyright (c) 1998 Association of Mizar Users

environ

 vocabulary PRE_TOPC, EUCLID, ARYTM_1, COMPTS_1, TOPREAL2, PSCOMP_1, JORDAN6,
      TOPREAL1, JORDAN3, BOOLE, BORSUK_1, RELAT_1, TOPS_2, ORDINAL2, FUNCT_1,
      SUBSET_1, RCOMP_1, FINSEQ_1, TBSP_1, GOBRD10, FINSEQ_4;
 notation TARSKI, XBOOLE_0, SUBSET_1, NUMBERS, XREAL_0, REAL_1, NAT_1, RCOMP_1,
      RELAT_1, BINARITH, FINSEQ_1, FUNCT_1, FUNCT_2, FINSEQ_4, TOPREAL1,
      TOPREAL2, TBSP_1, GOBOARD1, GOBRD10, PRE_TOPC, TOPS_2, STRUCT_0,
      COMPTS_1, EUCLID, JORDAN3, PSCOMP_1, JORDAN5C, JORDAN6, TOPMETR;
 constructors RCOMP_1, GOBRD10, BINARITH, TOPREAL2, TOPS_2, TBSP_1, REAL_1,
      PSCOMP_1, JORDAN3, JORDAN4, JORDAN5C, JORDAN6, FINSEQ_4, GOBOARD1,
      T_0TOPSP, URYSOHN1, YELLOW_8;
 clusters STRUCT_0, RELSET_1, EUCLID, PSCOMP_1, PRE_TOPC, XREAL_0, ARYTM_3,
      GOBOARD1, BORSUK_2, MEMBERED;
 requirements REAL, SUBSET, BOOLE, NUMERALS, ARITHM;
 definitions TARSKI, XBOOLE_0, FUNCT_1;
 theorems TARSKI, JORDAN6, TOPREAL1, TOPREAL5, JORDAN5C, UNIFORM1, PRE_TOPC,
      FUNCT_2, TOPS_2, RELAT_1, FUNCT_1, SCMFSA_7, FINSEQ_1, AXIOMS, TOPMETR,
      FINSEQ_2, JORDAN3, GOBOARD1, BINARITH, NAT_1, REAL_1, RCOMP_1, FINSEQ_4,
      SQUARE_1, GOBRD10, SPRECT_1, XBOOLE_0, XBOOLE_1, FINSEQ_3, BORSUK_1,
      COMPTS_1, RELSET_1, AMI_5, JORDAN5B, XCMPLX_0, PARTFUN2, XCMPLX_1;
 schemes DOMAIN_1, NAT_1;

begin :: Definition of the Segment and its property

reserve p,p1,p2,p3,q for Point of TOP-REAL 2;

Lm1: 2-'1 = 2-1 by SCMFSA_7:3 .=1;

Lm2:
 for i, j, k be Nat holds i-'k <= j implies i <= j + k
proof let i, j, k be Nat; assume
A1: i-'k <= j;
 per cases;
 suppose
A2: i >= k;
     i-'k +k <= j + k by A1,AXIOMS:24;
 hence i <= j + k by A2,AMI_5:4;
 end;
 suppose
A3: i <= k;
     k <= j + k by NAT_1:29;
 hence i <= j + k by A3,AXIOMS:22;
end;
end;

Lm3: for i, j, k be Nat holds j + k <= i implies k <= i -' j
proof let i, j, k be Nat; assume
A1: j + k <= i;
 per cases by A1,AXIOMS:21;
 suppose j + k = i;
 hence k <= i -' j by BINARITH:39;
 end;
 suppose j + k < i;
 hence k <= i -' j by Lm2;
end;
end;

theorem Th1: for P being compact non empty Subset of TOP-REAL 2
 st P is_simple_closed_curve holds
 W-min(P) in Lower_Arc(P) & E-max(P) in Lower_Arc(P) &
 W-min(P) in Upper_Arc(P) & E-max(P) in Upper_Arc(P)
 proof let P be compact non empty Subset of TOP-REAL 2;
   assume P is_simple_closed_curve;
    then Upper_Arc(P) is_an_arc_of W-min(P),E-max(P) &
    Lower_Arc(P) is_an_arc_of E-max(P),W-min(P) by JORDAN6:65;
   hence thesis by TOPREAL1:4;
 end;

theorem Th2: for P being compact non empty Subset of TOP-REAL 2,q
 st P is_simple_closed_curve & LE q,W-min(P),P
holds q=W-min(P)
proof let P be compact non empty Subset of TOP-REAL 2,q;
 assume A1:P is_simple_closed_curve & LE q,W-min(P),P;
   then A2:q in Upper_Arc(P) & W-min(P) in Upper_Arc(P) &
    LE q,W-min(P),Upper_Arc(P),W-min(P),E-max(P) by JORDAN6:def 10;
       Upper_Arc(P) is_an_arc_of W-min(P),E-max(P)
                            by A1,JORDAN6:def 8;
 hence q=W-min(P) by A2,JORDAN6:69;
end;

theorem Th3: for P being compact non empty Subset of TOP-REAL 2,q
 st P is_simple_closed_curve & q in P holds
 LE W-min(P),q,P
proof let P be compact non empty Subset of TOP-REAL 2,q;
  assume A1: P is_simple_closed_curve & q in P;
then A2:q in Upper_Arc(P) \/ Lower_Arc(P) by JORDAN6:65;
   A3: Upper_Arc(P) is_an_arc_of W-min(P),E-max(P) &
    Lower_Arc(P) is_an_arc_of E-max(P),W-min(P) by A1,JORDAN6:65;
     A4: W-min(P) in Upper_Arc(P) by A1,Th1;
      now per cases by A2,XBOOLE_0:def 2;
   case A5:q in Upper_Arc(P);
     then LE W-min(P),q,Upper_Arc(P),W-min(P),E-max(P) by A3,JORDAN5C:10;
    hence LE W-min(P),q,P by A4,A5,JORDAN6:def 10;
   end;
   case A6:q in Lower_Arc(P);
        now per cases;
     case not q=W-min(P);
      hence LE W-min(P),q,P by A4,A6,JORDAN6:def 10;
     end;
     case A7: q=W-min(P);
       then LE W-min(P),q,Upper_Arc(P),W-min(P),E-max(P) by A4,JORDAN5C:9;
      hence LE W-min(P),q,P by A4,A7,JORDAN6:def 10;
     end;
     end;
    hence LE W-min(P),q,P;
   end;
   end;
  hence LE W-min(P),q,P;
end;

definition
 let P be compact non empty Subset of TOP-REAL 2,
     q1,q2 be Point of TOP-REAL 2;
 func Segment(q1,q2,P) -> Subset of TOP-REAL 2 equals
 :Def1: {p: LE q1,p,P & LE p,q2,P} if q2<>W-min(P)
           otherwise {p1: LE q1,p1,P or q1 in P & p1=W-min(P)};
  correctness
  proof
      ex B being Subset of TOP-REAL 2 st
    (q2<>W-min(P) implies B={p: LE q1,p,P & LE p,q2,P})&
    (not q2<>W-min(P) implies B={p1: LE q1,p1,P or q1 in P & p1=W-min(P)})
    proof
        now per cases;
     case A1:q2<>W-min(P);
     defpred P[Point of TOP-REAL 2] means LE q1,$1,P & LE $1,q2,P;
          {p: P[p]} is Subset of
       TOP-REAL 2 from DOMAIN_1:sch 7;
       then reconsider C = {p: LE q1,p,P & LE p,q2,P} as Subset of
         TOP-REAL 2;
          (q2<>W-min(P) implies C={p: LE q1,p,P & LE p,q2,P})&
       (not q2<>W-min(P) implies C={p1: LE q1,p1,P or q1 in P & p1=W-min(P)})
       by A1;
      hence thesis;
     end;
     case A2: not q2<>W-min(P);
     defpred P[Point of TOP-REAL 2] means LE q1,$1,P or q1 in P & $1=W-min(P);
          {p1: P[p1]}
       is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
       then reconsider C = {p1: LE q1,p1,P or q1 in P & p1=W-min(P)}
       as Subset of TOP-REAL 2;
          (q2<>W-min(P) implies C={p: LE q1,p,P & LE p,q2,P})&
       (not q2<>W-min(P) implies C={p1: LE q1,p1,P or q1 in P & p1=W-min(P)})
       by A2;
      hence thesis;
     end;
     end;
     hence thesis;
    end;
   hence thesis;
  end;
 end;

theorem
    for P being compact non empty Subset of TOP-REAL 2
 st P is_simple_closed_curve holds
 Segment(W-min(P),E-max(P),P)=Upper_Arc(P) &
 Segment(E-max(P),W-min(P),P)=Lower_Arc(P)
  proof let P be compact non empty Subset of TOP-REAL 2;
   assume A1:P is_simple_closed_curve;
    then A2:E-max(P)<>W-min(P) by TOPREAL5:25;
    A3: Upper_Arc(P) is_an_arc_of W-min(P),E-max(P) by A1,JORDAN6:def 8;
A4:{p: LE W-min(P),p,P & LE p,E-max(P),P} = Upper_Arc(P)
    proof
      A5: {p: LE W-min(P),p,P & LE p,E-max(P),P} c= Upper_Arc(P)
       proof let x be set;assume
             x in {p: LE W-min(P),p,P & LE p,E-max(P),P};
          then consider p such that
          A6: p=x &
          ( LE W-min(P),p,P & LE p,E-max(P),P);
               now per cases by A6,JORDAN6:def 10;
            case p in Upper_Arc(P) & E-max(P) in Lower_Arc(P)
                                              & not E-max(P)=W-min(P);
             hence x in Upper_Arc(P) by A6;
            end;
            case p in Upper_Arc(P) & E-max(P) in Upper_Arc(P) &
                 LE p,E-max(P),Upper_Arc(P),W-min(P),E-max(P);
             hence x in Upper_Arc(P) by A6;
            end;
            case A7: p in Lower_Arc(P) & E-max(P) in Lower_Arc(P)
                  & not E-max(P)=W-min(P) &
               LE p,E-max(P),Lower_Arc(P),E-max(P),W-min(P);
                  Lower_Arc(P) is_an_arc_of E-max(P),W-min(P)
                            by A1,JORDAN6:def 9;
               then p=E-max(P) by A7,JORDAN6:69;
             hence x in Upper_Arc(P) by A3,A6,TOPREAL1:4;
            end;
            end;
         hence x in Upper_Arc(P);
       end;
         Upper_Arc(P) c= {p: LE W-min(P),p,P & LE p,E-max(P),P}
       proof let x be set;assume A8: x in Upper_Arc(P);
         then reconsider p2=x as Point of TOP-REAL 2;
         A9: W-min(P) in Lower_Arc(P) & E-max(P) in Lower_Arc(P) &
         W-min(P) in Upper_Arc(P) & E-max(P) in Upper_Arc(P) by A1,Th1;
              LE W-min(P),p2,Upper_Arc(P),W-min(P),E-max(P)
                                 by A3,A8,JORDAN5C:10;
          then A10: LE W-min(P),p2,P by A8,A9,JORDAN6:def 10;
            LE p2,E-max(P),P by A2,A8,A9,JORDAN6:def 10;
        hence x in {p: LE W-min(P),p,P & LE p,E-max(P),P} by A10;
       end;
     hence thesis by A5,XBOOLE_0:def 10;
    end;
       {p1: LE E-max(P),p1,P or E-max(P) in P & p1=W-min(P)} = Lower_Arc(P)
    proof
      A11: {p1: LE E-max(P),p1,P or E-max(P) in P &
      p1=W-min(P)} c= Lower_Arc(P)
       proof let x be set;assume
             x in {p1: LE E-max(P),p1,P or E-max(P) in P & p1=W-min(P)};
          then consider p1 such that
          A12: p1=x & (LE E-max(P),p1,P or E-max(P) in P & p1=W-min(P));
             now per cases by A12;
          case A13: LE E-max(P),p1,P;
               now per cases by A12,A13,JORDAN6:def 10;
            case x in Lower_Arc(P);
             hence x in Lower_Arc(P);
            end;
            case A14: E-max(P) in Upper_Arc(P) & p1 in Upper_Arc(P) &
              LE E-max(P),p1,Upper_Arc(P),W-min(P),E-max(P);
              A15:Upper_Arc(P) is_an_arc_of W-min(P),E-max(P)
                             by A1,JORDAN6:65;
              then LE p1,E-max(P),Upper_Arc(P),W-min(P),E-max(P)
                                       by A14,JORDAN5C:10;
              then A16:p1=E-max(P) by A14,A15,JORDAN5C:12;
                 Lower_Arc(P) is_an_arc_of E-max(P),W-min(P) by A1,JORDAN6:def
9
;
             hence x in Lower_Arc(P) by A12,A16,TOPREAL1:4;
            end;
            end;
           hence x in Lower_Arc(P);
          end;
          case E-max(P) in P & p1=W-min(P);
            then x in {W-min(P),E-max(P)} by A12,TARSKI:def 2;
            then x in Upper_Arc(P) /\ Lower_Arc(P) by A1,JORDAN6:def 9;
           hence x in Lower_Arc(P) by XBOOLE_0:def 3;
          end;
          end;
         hence x in Lower_Arc(P);
       end;
         Lower_Arc(P) c= {p1: LE E-max(P),p1,P or E-max(P) in P & p1=W-min(P)}
       proof let x be set;assume A17: x in Lower_Arc(P);
         then reconsider p2=x as Point of TOP-REAL 2;
       Upper_Arc(P) is_an_arc_of W-min(P),E-max(P) by A1,JORDAN6:65;
         then not (E-max P in P & p2=W-min P) implies
          E-max P in Upper_Arc P & p2 in Lower_Arc P & not p2=W-min P
                                 by A17,SPRECT_1:16,TOPREAL1:4;
         then LE E-max(P),p2,P or E-max P in P & p2=W-min P by JORDAN6:def 10;
        hence x in {p1: LE E-max(P),p1,P or E-max(P) in P & p1=W-min(P)};
       end;
     hence thesis by A11,XBOOLE_0:def 10;
    end;
   hence thesis by A2,A4,Def1;
  end;

theorem Th5:
for P being compact non empty Subset of TOP-REAL 2,
 q1,q2 being Point of TOP-REAL 2 st P is_simple_closed_curve & LE q1,q2,P holds
 q1 in P & q2 in P
proof let P be compact non empty Subset of TOP-REAL 2,
 q1,q2 be Point of TOP-REAL 2;
 assume A1: P is_simple_closed_curve & LE q1,q2,P;
  then A2: Upper_Arc(P) \/ Lower_Arc(P)=P by JORDAN6:65;
     now per cases by A1,JORDAN6:def 10;
  case q1 in Upper_Arc(P) & q2 in Lower_Arc(P);
   hence q1 in P & q2 in P by A2,XBOOLE_0:def 2;
  end;
  case q1 in Upper_Arc(P) & q2 in Upper_Arc(P);
   hence q1 in P & q2 in P by A2,XBOOLE_0:def 2;
  end;
  case q1 in Lower_Arc(P) & q2 in Lower_Arc(P);
   hence q1 in P & q2 in P by A2,XBOOLE_0:def 2;
  end;
  end;
 hence thesis;
end;

theorem Th6:
for P being compact non empty Subset of TOP-REAL 2,
 q1,q2 being Point of TOP-REAL 2 st P is_simple_closed_curve & LE q1,q2,P holds
 q1 in Segment(q1,q2,P) & q2 in Segment(q1,q2,P)
 proof let P be compact non empty Subset of TOP-REAL 2,
   q1,q2 be Point of TOP-REAL 2;
   assume A1: P is_simple_closed_curve & LE q1,q2,P;
   hereby per cases;
   suppose A2: q2<>W-min(P);
         q1 in P by A1,Th5;
      then LE q1,q1,P by A1,JORDAN6:71;
      then q1 in {p: LE q1,p,P & LE p,q2,P} by A1;
     hence q1 in Segment(q1,q2,P) by A2,Def1;
   end;
   suppose A3: q2=W-min(P);
         q1 in P by A1,Th5;
      then LE q1,q1,P by A1,JORDAN6:71;
      then q1 in {p1: LE q1,p1,P or q1 in P & p1=W-min(P)};
     hence q1 in Segment(q1,q2,P) by A3,Def1;
   end;
   end;
   per cases;
   suppose A4: q2<>W-min(P);
         q2 in P by A1,Th5;
      then LE q2,q2,P by A1,JORDAN6:71;
      then q2 in {p: LE q1,p,P & LE p,q2,P} by A1;
     hence q2 in Segment(q1,q2,P) by A4,Def1;
   end;
   suppose A5: q2=W-min(P);
         q2 in {p1: LE q1,p1,P or q1 in P & p1=W-min(P)} by A1;
     hence q2 in Segment(q1,q2,P) by A5,Def1;
 end;
 end;

theorem Th7:
for P being compact non empty Subset of TOP-REAL 2,
 q1 being Point of TOP-REAL 2 st q1 in P & P is_simple_closed_curve holds
   q1 in Segment(q1,W-min P,P)
 proof let P be compact non empty Subset of TOP-REAL 2,
   q1 be Point of TOP-REAL 2 such that
A1:  q1 in P;
   assume P is_simple_closed_curve;
      then LE q1,q1,P by A1,JORDAN6:71;
      then q1 in {p1: LE q1,p1,P or q1 in P & p1=W-min(P)};
     hence q1 in Segment(q1,W-min P,P) by Def1;
 end;

theorem
    for P being compact non empty Subset of TOP-REAL 2,
 q being Point of TOP-REAL 2
 st P is_simple_closed_curve & q in P
 & q<>W-min(P) holds Segment(q,q,P)={q}
proof let P be compact non empty Subset of TOP-REAL 2,
  q be Point of TOP-REAL 2;
  assume that
A1:P is_simple_closed_curve and
A2: q in P and
A3: q <> W-min P;
     for x being set holds x in Segment(q,q,P) iff x=q
   proof let x be set;
     hereby assume x in Segment(q,q,P);
       then x in {p: LE q,p,P & LE p,q,P} by A3,Def1;
       then ex p st p=x & (LE q,p,P & LE p,q,P);
      hence x=q by A1,JORDAN6:72;
     end;
    assume A4:x=q;
         LE q,q,P by A1,A2,JORDAN6:71;
      then x in {p: LE q,p,P & LE p,q,P} by A4;
     hence x in Segment(q,q,P) by A3,Def1;
   end;
 hence thesis by TARSKI:def 1;
end;

theorem
   for P being compact non empty Subset of TOP-REAL 2,
 q1,q2 being Point of TOP-REAL 2 st
  P is_simple_closed_curve & q1<>W-min(P) & q2<>W-min(P)
 holds not W-min(P) in Segment(q1,q2,P)
proof let P be compact non empty Subset of TOP-REAL 2,
 q1,q2 be Point of TOP-REAL 2;
 assume A1: P is_simple_closed_curve & q1<>W-min(P) & q2<>W-min(P);
  then A2:Segment(q1,q2,P)={p: LE q1,p,P & LE p,q2,P} by Def1;
     now assume W-min(P) in Segment(q1,q2,P);
    then consider p such that A3: p=W-min(P) &(LE q1,p,P & LE p,q2,P) by A2;
         A4: q1 in Upper_Arc(P) & p in Upper_Arc(P) &
            LE q1,p,Upper_Arc(P),W-min(P),E-max(P) by A3,JORDAN6:def 10;
             Upper_Arc(P) is_an_arc_of W-min(P),E-max(P)
                            by A1,JORDAN6:def 8;
   hence contradiction by A1,A3,A4,JORDAN6:69;
  end;
 hence thesis;
end;

theorem Th10:
for P being compact non empty Subset of TOP-REAL 2,
 q1,q2,q3 being Point of TOP-REAL 2
 st P is_simple_closed_curve & LE q1,q2,P & LE q2,q3,P
 & not(q1=q2 & q1=W-min(P)) & q1<>q3 & not(q2=q3 & q2=W-min(P)) holds
 Segment(q1,q2,P)/\ Segment(q2,q3,P)={q2}
  proof let P be compact non empty Subset of TOP-REAL 2,
    q1,q2,q3 be Point of TOP-REAL 2;
    assume A1: P is_simple_closed_curve & LE q1,q2,P & LE q2,q3,P
    & not(q1=q2 & q1=W-min(P)) & q1<>q3 & not(q2=q3 & q2=W-min(P));
    then A2: Upper_Arc(P) is_an_arc_of W-min(P),E-max(P) by JORDAN6:def 8;
     thus Segment(q1,q2,P)/\ Segment(q2,q3,P) c= {q2}
     proof let x be set;
       assume x in Segment(q1,q2,P)/\ Segment(q2,q3,P);
       then A3: x in Segment(q1,q2,P) & x in Segment(q2,q3,P) by XBOOLE_0:def 3
;
          now per cases;
       case q3<>W-min(P);
         then x in {p: LE q2,p,P & LE p,q3,P} by A3,Def1;
         then consider p such that A4: p=x & (LE q2,p,P & LE p,q3,P);
            now per cases;
         case q2<>W-min(P);
           then x in {p2: LE q1,p2,P & LE p2,q2,P} by A3,Def1;
           then ex p2 st p2=x & (LE q1,p2,P & LE p2,q2,P);
          hence x=q2 by A1,A4,JORDAN6:72;
         end;
         case A5:q2=W-min(P);
             then q1 in Upper_Arc(P) & q2 in Upper_Arc(P) &
             LE q1,q2,Upper_Arc(P),W-min(P),E-max(P)
                             by A1,JORDAN6:def 10;
            hence contradiction by A1,A2,A5,JORDAN6:69;
         end;
         end;
        hence x=q2;
       end;
       case A6: q3=W-min(P);
        then x in {p1: LE q2,p1,P or q2 in P & p1=W-min(P)} by A3,Def1;
         then consider p1 such that
         A7:p1=x &(LE q2,p1,P or q2 in P & p1=W-min(P));
               p1 in {p: LE q1,p,P & LE p,q2,P} by A1,A3,A6,A7,Def1;
         then ex p st p=p1 & LE q1,p,P & LE p,q2,P;
        hence x=q2 by A1,A6,A7,JORDAN6:72;
       end;
       end;
      hence x in {q2} by TARSKI:def 1;
     end;
     let x be set;assume x in {q2};
     then A8: x=q2 by TARSKI:def 1;
     then A9: x in Segment(q1,q2,P) by A1,Th6;
        x in Segment(q2,q3,P) by A1,A8,Th6;
     hence thesis by A9,XBOOLE_0:def 3;
  end;

theorem Th11:
for P being compact non empty Subset of TOP-REAL 2,
 q1,q2 being Point of TOP-REAL 2
 st P is_simple_closed_curve & LE q1,q2,P
 & q1 <> W-min P & q2 <> W-min P holds
 Segment(q1,q2,P)/\ Segment(q2,W-min P,P)={q2}
  proof let P be compact non empty Subset of TOP-REAL 2,
    q1,q2 be Point of TOP-REAL 2;
   set q3 = W-min P;
    assume A1: P is_simple_closed_curve & LE q1,q2,P
    & q1<>q3 & not(q2=W-min(P));
     thus Segment(q1,q2,P)/\ Segment(q2,W-min P,P) c= {q2}
     proof let x be set;
       assume x in Segment(q1,q2,P)/\ Segment(q2,q3,P);
       then A2: x in Segment(q1,q2,P) & x in Segment(q2,q3,P) by XBOOLE_0:def 3
;
        then x in {p1: LE q2,p1,P or q2 in P & p1=W-min P} by Def1;
         then consider p1 such that
         A3:p1=x and
A4:       LE q2,p1,P or q2 in P & p1=W-min P;
               p1 in {p: LE q1,p,P & LE p,q2,P} by A1,A2,A3,Def1;
then A5:      ex p st p=p1 & LE q1,p,P & LE p,q2,P;
       per cases by A4;
       suppose LE q2,p1,P;
        then x=q2 by A1,A3,A5,JORDAN6:72;
      hence x in {q2} by TARSKI:def 1;
       end;
       suppose q2 in P & p1=W-min(P);
      hence x in {q2} by A1,A5,Th2;
     end;
     end;
     let x be set;assume x in {q2};
     then A6: x=q2 by TARSKI:def 1;
     then A7: x in Segment(q1,q2,P) by A1,Th6;
        q2 in P by A1,Th5;
     then x in Segment(q2,q3,P) by A1,A6,Th7;
     hence thesis by A7,XBOOLE_0:def 3;
  end;

theorem Th12: for P being compact non empty Subset of TOP-REAL 2,
 q1,q2 being Point of TOP-REAL 2
 st P is_simple_closed_curve & LE q1,q2,P & q1<>q2 & q1<>W-min(P) holds
 Segment(q2,W-min(P),P)/\ Segment(W-min(P),q1,P)={W-min(P)}
 proof let P be compact non empty Subset of TOP-REAL 2,
   q1,q2 be Point of TOP-REAL 2;
   assume A1: P is_simple_closed_curve & LE q1,q2,P & q1<>q2 &
   q1<>W-min(P);
   then A2: q1 in P & q2 in P by Th5;
   thus Segment(q2,W-min(P),P)/\ Segment(W-min(P),q1,P) c= {W-min(P)}
    proof let x be set;
     assume x in Segment(q2,W-min(P),P)/\ Segment(W-min(P),q1,P);
      then A3: x in Segment(q2,W-min(P),P) & x in Segment(W-min(P),q1,P)
                              by XBOOLE_0:def 3;
      then x in {p1: LE q2,p1,P or q2 in P & p1=W-min(P)} by Def1;
      then consider p1 such that A4: p1=x &(LE q2,p1,P or q2 in P & p1=W-min(P)
);
         now per cases by A4;
      case A5:LE q2,p1,P;
           x in {p: LE W-min(P),p,P & LE p,q1,P} by A1,A3,Def1;
        then ex p2 st p2=x & LE W-min(P),p2,P & LE p2,q1,P;
        then LE q2,q1,P by A1,A4,A5,JORDAN6:73;
       hence contradiction by A1,JORDAN6:72;
      end;
      case q2 in P & p1=W-min(P);
       hence x=W-min(P) by A4;
      end;
      end;
     hence x in {W-min(P)} by TARSKI:def 1;
    end;
    let x be set;assume x in {W-min(P)};
    then A6: x=W-min(P) by TARSKI:def 1;
    then x in {p1: LE q2,p1,P or q2 in P & p1=W-min(P)} by A2;
    then A7: x in Segment(q2,W-min(P),P) by Def1;
       LE W-min(P),q1,P by A1,A2,Th3;
    then x in Segment(W-min(P),q1,P) by A1,A6,Th6;
    hence thesis by A7,XBOOLE_0:def 3;
 end;

theorem Th13:
for P being compact non empty Subset of TOP-REAL 2,
  q1,q2,q3,q4 being Point of TOP-REAL 2
  st P is_simple_closed_curve & LE q1,q2,P & LE q2,q3,P & LE q3,q4,P
   & q1<>q2 & q2<>q3 holds
  Segment(q1,q2,P) misses Segment(q3,q4,P)
proof let P be compact non empty Subset of TOP-REAL 2,
  q1,q2,q3,q4 be Point of TOP-REAL 2;
  assume that
A1:P is_simple_closed_curve and
A2: LE q1,q2,P and
A3: LE q2,q3,P and
A4: LE q3,q4,P and
A5: q1<>q2 and
A6: q2<>q3;
  assume A7:Segment(q1,q2,P)/\ Segment(q3,q4,P)<>{};
    consider x being Element of Segment(q1,q2,P)/\ Segment(q3,q4,P);
    A8:x in Segment(q1,q2,P) & x in Segment(q3,q4,P) by A7,XBOOLE_0:def 3;
       now per cases;
    case q4=W-min(P);
      then q3=W-min(P) by A1,A4,Th2;
     hence contradiction by A1,A3,A6,Th2;
    end;
    case q4<>W-min(P);
     then x in {p1: LE q3,p1,P & LE p1,q4,P} by A8,Def1;
     then consider p1 such that A9:p1=x &(LE q3,p1,P & LE p1,q4,P);
        q2<>W-min(P) by A1,A2,A5,Th2;
       then x in {p2: LE q1,p2,P & LE p2,q2,P} by A8,Def1;
       then consider p2 such that A10:p2=x &(LE q1,p2,P & LE p2,q2,P);
          LE q3,q2,P by A1,A9,A10,JORDAN6:73;
      hence contradiction by A1,A3,A6,JORDAN6:72;
    end;
    end;
   hence contradiction;
end;

theorem Th14:
for P being compact non empty Subset of TOP-REAL 2,
  q1,q2,q3 being Point of TOP-REAL 2
  st P is_simple_closed_curve & LE q1,q2,P & LE q2,q3,P & q1<>W-min P
   & q1<>q2 & q2<>q3 holds
  Segment(q1,q2,P) misses Segment(q3,W-min P,P)
proof let P be compact non empty Subset of TOP-REAL 2,
  q1,q2,q3 be Point of TOP-REAL 2;
  assume A1:P is_simple_closed_curve & LE q1,q2,P & LE q2,q3,P
  & q1<>W-min P & q1<>q2 & q2<>q3;
  assume A2:Segment(q1,q2,P)/\ Segment(q3,W-min P,P)<>{};
    consider x being Element of Segment(q1,q2,P)/\ Segment(q3,W-min P,P);
    A3:x in Segment(q1,q2,P) & x in Segment(q3,W-min P,P) by A2,XBOOLE_0:def 3;
     then x in {p1: LE q3,p1,P or q3 in P & p1=W-min P} by Def1;
     then consider p1 such that
A4:   p1=x and
A5:   LE q3,p1,P or q3 in P & p1=W-min P;
      q2 <> W-min P by A1,Th2;
  then x in {p: LE q1,p,P & LE p,q2,P} by A3,Def1;
  then ex p3 st p3 = x & LE q1,p3,P & LE p3,q2,P;
  then LE q3,q2,P by A1,A4,A5,Th2,JORDAN6:73;
 hence contradiction by A1,JORDAN6:72;
end;

begin :: A function to divide the simple closed curve

reserve n for Nat;

theorem Th15:
  for P being non empty Subset of TOP-REAL n,
  f being map of I[01], (TOP-REAL n)|P st P<>{} & f is_homeomorphism
  ex g being map of I[01],TOP-REAL n st f=g &
  g is continuous & g is one-to-one
proof let P be non empty Subset of TOP-REAL n,
  f be map of I[01], (TOP-REAL n)|P;
  assume A1: P<>{} & f is_homeomorphism;
        the carrier of (TOP-REAL n)|P = [#]((TOP-REAL n)|P) by PRE_TOPC:12
         .=P by PRE_TOPC:def 10;
  then reconsider g1=f as map of I[01],TOP-REAL n by FUNCT_2:9;
    A2:the carrier of (TOP-REAL n)|P = [#]((TOP-REAL n)|P) by PRE_TOPC:12;
    A3:[#]((TOP-REAL n)|P)= P  by PRE_TOPC:def 10;
    A4:f is one-to-one & f is continuous & f" is continuous
                                  by A1,TOPS_2:def 5;
     for P2 being Subset of TOP-REAL n st
    P2 is open holds g1"P2 is open
  proof let P2 be Subset of TOP-REAL n;
    assume A5: P2 is open;
    reconsider B1=P2 /\ P as Subset of (TOP-REAL n)|P by A2,A3,XBOOLE_1:17;
        B1 is open by A3,A5,TOPS_2:32;
     then A6:f"B1 is open by A4,TOPS_2:55;
     A7:f"B1 = f"P2 /\ f"P by FUNCT_1:137;
        f"(rng f) c= f"P by A2,A3,RELAT_1:178;
     then A8:dom f c= f"P by RELAT_1:169;
        f"P c= dom f by RELAT_1:167;
     then A9:f"P=dom f by A8,XBOOLE_0:def 10;
        f"P2 c= dom f by RELAT_1:167;
    hence g1"P2 is open by A6,A7,A9,XBOOLE_1:28;
  end;
  then g1 is continuous by TOPS_2:55;
 hence thesis by A4;
end;

theorem Th16:
  for P being non empty Subset of TOP-REAL n,
  g being map of I[01], (TOP-REAL n) st g is continuous one-to-one
   & rng g = P
  ex f being map of I[01],(TOP-REAL n)|P st f=g &
   f is_homeomorphism
proof let P be non empty Subset of TOP-REAL n,
  g be map of I[01], (TOP-REAL n);
  assume that
A1: g is continuous one-to-one and
A2: rng g = P;
       the carrier of (TOP-REAL n)|P = [#]((TOP-REAL n)|P) by PRE_TOPC:12;
   then A3: the carrier of (TOP-REAL n)|P = P by PRE_TOPC:def 10;
  then reconsider f=g as map of I[01],(TOP-REAL n)|P by A2,FUNCT_2:8;
 take f;
 thus f = g;
A4: dom f = the carrier of I[01] by FUNCT_2:def 1
      .= [#]I[01] by PRE_TOPC:12;
A5: rng f = [#]((TOP-REAL n)|P) by A2,PRE_TOPC:def 10;
A6: [#]((TOP-REAL n)|P)= P  by PRE_TOPC:def 10;
     for P2 being Subset of (TOP-REAL n)|P st
    P2 is open holds f"P2 is open
  proof let P2 be Subset of (TOP-REAL n)|P;
   assume
  P2 is open;
    then consider C being Subset of TOP-REAL n such that
A7:  C is open and
A8:  C /\ [#]((TOP-REAL n)|P) = P2 by TOPS_2:32;
A9:   f"C c= [#]I[01] by PRE_TOPC:14;
       g"P = [#]I[01] by A3,A4,RELSET_1:38;
    then f"P2 = f"C /\ [#]I[01] by A6,A8,FUNCT_1:137
         .= f"C by A9,XBOOLE_1:28;
    hence f"P2 is open by A1,A7,TOPS_2:55;
  end;
  then A10: f is continuous by TOPS_2:55;
     (TOP-REAL n)|P is_T2 by TOPMETR:3;
 hence thesis by A1,A4,A5,A10,COMPTS_1:26;
end;

registration
 cluster increasing -> one-to-one FinSequence of REAL;
 coherence
 proof let f be FinSequence of REAL;
   assume A1:f is increasing;
    let x,y be set;assume A2: x in dom f & y in dom f & f.x=f.y;
      then reconsider nx=x,ny=y as Nat;
      A3: nx<=ny by A1,A2,GOBOARD1:def 1;
           nx>=ny by A1,A2,GOBOARD1:def 1;
     hence x=y by A3,REAL_1:def 5;
 end;
end;

theorem Th17:
 for f being FinSequence of REAL st
 f is increasing holds f is one-to-one
 proof let f be FinSequence of REAL;
   assume f is increasing;
    then reconsider f as increasing FinSequence of REAL;
      f is one-to-one;
  hence thesis;
 end;

Lm4: now
  let h2 be Nat;
     h2<h2+1 by NAT_1:38;
  then h2-1<h2+1-1 by REAL_1:54;
  then h2-1-1<h2-1 & h2-1<h2 by REAL_1:54;
  hence h2-1-1<h2 by AXIOMS:22;
end;

Lm5: 0 in [.0,1.] & 1 in [.0,1.] by RCOMP_1:15;

theorem Th18:
 for A being Subset of TOP-REAL 2,
     p1,p2 being Point of TOP-REAL 2
  st A is_an_arc_of p1,p2
 ex g being map of I[01], TOP-REAL 2 st
  g is continuous one-to-one & rng g = A & g.0 = p1 & g.1 = p2
 proof let A be Subset of TOP-REAL 2,
     p1,p2 being Point of TOP-REAL 2;
  assume
A1: A is_an_arc_of p1,p2;
   then reconsider A' = A as non empty Subset of TOP-REAL 2
                     by TOPREAL1:4;
   consider f being map of I[01], (TOP-REAL 2)|A' such that
A2: f is_homeomorphism & f.0 = p1 & f.1 = p2 by A1,TOPREAL1:def 2;
A3: rng f=[#]((TOP-REAL 2)|A') by A2,TOPS_2:def 5;
   consider g being map of I[01], TOP-REAL 2 such that
A4: f=g and
A5: g is continuous one-to-one by A2,Th15;
  take g;
  thus g is continuous one-to-one by A5;
  thus rng g = A by A3,A4,PRE_TOPC:def 10;
  thus thesis by A2,A4;
 end;

theorem Th19:
 for P being non empty Subset of TOP-REAL 2,
     p1, p2, q1, q2 being Point of TOP-REAL 2,
     g being map of I[01], TOP-REAL 2,
     s1, s2 being Real st
  P is_an_arc_of p1,p2 & g is continuous one-to-one & rng g = P
  & g.0 = p1 & g.1 = p2
  & g.s1 = q1 & 0 <= s1 & s1 <= 1 & g.s2 = q2 & 0 <= s2 & s2 <= 1 & s1 <= s2
 holds LE q1,q2,P,p1,p2
proof let P be non empty Subset of TOP-REAL 2,
     p1, p2, q1, q2 be Point of TOP-REAL 2,
     g be map of I[01], TOP-REAL 2,
     s1, s2 be Real such that
A1: P is_an_arc_of p1,p2 and
A2: g is continuous one-to-one and
A3: rng g = P;
     ex f being map of I[01],(TOP-REAL 2)|P st
   f=g & f is_homeomorphism by A2,A3,Th16;
 hence thesis by A1,JORDAN5C:8;
end;

theorem Th20:
 for P being non empty Subset of TOP-REAL 2,
     p1, p2, q1, q2 being Point of TOP-REAL 2,
     g being map of I[01], TOP-REAL 2,
     s1, s2 being Real st
  g is continuous one-to-one & rng g = P
  & g.0 = p1 & g.1 = p2
  & g.s1 = q1 & 0 <= s1 & s1 <= 1 & g.s2 = q2 & 0 <= s2 & s2 <= 1
  & LE q1,q2,P,p1,p2
 holds s1 <= s2
proof
 let P be non empty Subset of TOP-REAL 2,
     p1, p2, q1, q2 be Point of TOP-REAL 2,
     g be map of I[01], TOP-REAL 2,
     s1, s2 be Real such that
A1: g is continuous one-to-one and
A2: rng g = P;
     ex f being map of I[01],(TOP-REAL 2)|P st
   f=g & f is_homeomorphism by A1,A2,Th16;
 hence thesis by JORDAN5C:def 3;
end;

theorem :: Dividing simple closed curve into segments.
    for P being compact non empty Subset of TOP-REAL 2, e being Real
   st P is_simple_closed_curve & e > 0
   ex h being FinSequence of the carrier of TOP-REAL 2
   st h.1=W-min(P) & h is one-to-one & 8<=len h & rng h c= P
   &(for i being Nat st 1<=i & i<len h holds LE h/.i,h/.(i+1),P)
   &(for i being Nat,W being Subset of Euclid 2
   st 1<=i & i<len h & W=Segment(h/.i,h/.(i+1),P) holds
   diameter(W)<e)
   & (for W being Subset of Euclid 2 st
   W=Segment(h/.len h,h/.1,P)  holds diameter(W)<e)
   & (for i being Nat st 1<=i & i+1<len h holds
    Segment(h/.i,h/.(i+1),P)/\ Segment(h/.(i+1),h/.(i+2),P)={h/.(i+1)})
   & Segment(h/.len h,h/.1,P)/\ Segment(h/.1,h/.2,P)={h/.1}
   & Segment(h/.(len h-' 1),h/.len h,P)/\ Segment(h/.len h,h/.1,P)={h/.len h}
   & Segment(h/.(len h-'1),h/.len h,P) misses Segment(h/.1,h/.2,P)
  &(for i,j being Nat st 1<=i & i < j & j < len h & not(i,j are_adjacent1)
    holds Segment(h/.i,h/.(i+1),P) misses Segment(h/.j,h/.(j+1),P))
  & (for i being Nat st 1 < i & i+1 < len h holds
      Segment(h/.len h,h/.1,P) misses Segment(h/.i,h/.(i+1),P))
 proof
   let P be compact non empty Subset of TOP-REAL 2, e be Real;
   assume
A1: P is_simple_closed_curve & e > 0;
    then A2: Upper_Arc P is_an_arc_of W-min P, E-max P by JORDAN6:def 8;
    then consider g1 being map of I[01], TOP-REAL 2 such that
A3:  g1 is continuous one-to-one and
A4: rng g1 = Upper_Arc P and
A5: g1.0 = W-min P & g1.1 = E-max P by Th18;
A6: dom g1 =[.0,1.] by BORSUK_1:83,FUNCT_2:def 1;
A7: 0 in dom g1 & 1 in dom g1 by Lm5,BORSUK_1:83,FUNCT_2:def 1;
A8: E-max P in Upper_Arc P & W-min P in Upper_Arc P by A1,Th1;
   consider h1 being FinSequence of REAL such that
   A9: h1.1=0 & h1.len h1=1 & 5<=len h1 & rng h1 c= the carrier of I[01]
    & h1 is increasing
    &(for i being Nat,Q being Subset of I[01],
    W being Subset of Euclid 2
    st 1<=i & i<len h1 & Q=[.h1/.i,h1/.(i+1).]
    & W=g1.:Q holds diameter(W)<e) by A1,A3,A5,UNIFORM1:15;
    A10:h1 is one-to-one by A9,Th17;
A11: Lower_Arc P is_an_arc_of E-max P, W-min P by A1,JORDAN6:def 9;
    then consider g2 being map of I[01], TOP-REAL 2 such that
A12:  g2 is continuous one-to-one and
A13: rng g2 = Lower_Arc P and
A14: g2.0 = E-max P & g2.1 = W-min P by Th18;
A15: dom g2 = [.0,1.] by BORSUK_1:83,FUNCT_2:def 1;
   consider h2 being FinSequence of REAL such that
   A16: h2.1=0 & h2.len h2=1 & 5<=len h2 & rng h2 c= the carrier of I[01]
    & h2 is increasing
    &(for i being Nat,Q being Subset of I[01],
    W being Subset of Euclid 2
    st 1<=i & i<len h2 & Q=[.h2/.i,h2/.(i+1).]
    & W=g2.:Q holds diameter(W)<e) by A1,A12,A14,UNIFORM1:15;
A17: len h2-1-1<len h2 by Lm4;
    A18:h2 is one-to-one by A16,Th17;
       h1 is FinSequence of the carrier of I[01] by A9,FINSEQ_1:def 4;
    then reconsider h11=g1*h1 as FinSequence of the carrier of TOP-REAL 2
                                                 by FINSEQ_2:36;
    A19:rng h1 c= dom g1 by A9,FUNCT_2:def 1;
    then A20:dom h1=dom h11 by RELAT_1:46;
    then A21: len h1=len h11 by FINSEQ_3:31;
       h2 is FinSequence of the carrier of I[01] by A16,FINSEQ_1:def 4;
    then reconsider h21=g2*h2 as FinSequence of the carrier of TOP-REAL 2
                                                 by FINSEQ_2:36;
       dom g2=the carrier of I[01] by FUNCT_2:def 1;
    then A22:dom h2=dom h21 by A16,RELAT_1:46;
    then A23: len h2=len h21 by FINSEQ_3:31;
A24: 1<=len h1 by A9,AXIOMS:22;
    then A25: 1 in dom h1 by FINSEQ_3:27;
A26:len h1 in dom h1 by A24,FINSEQ_3:27;
    A27: 1<=len h2 by A16,AXIOMS:22;
    then A28:1 in dom h2 by FINSEQ_3:27;
A29: len h2 in dom h2 by A27,FINSEQ_3:27;
A30: h21.1=E-max P by A14,A16,A28,FUNCT_1:23;
A31: h21.len h2=W-min P by A14,A16,A29,FUNCT_1:23;
    A32:1 in dom g2 by Lm5,BORSUK_1:83,FUNCT_2:def 1;
    A33:dom g1=[.0,1.] by BORSUK_1:83,FUNCT_2:def 1;
    then A34:1 in dom (g1*h1) by A9,A25,Lm5,FUNCT_1:21;
A35:len h1 in dom h1 by A24,FINSEQ_3:27;
       h1.len h1 in dom g1 by A9,A33,TOPREAL5:1;
    then A36:len h1 in dom (g1*h1) by A26,FUNCT_1:21;
    then A37: h11.len h1=E-max(P) by A5,A9,FUNCT_1:22;
    reconsider h0=h11^(mid(h21,2,len h21-' 1))
                as FinSequence of the carrier of TOP-REAL 2;
A38: h11.1=W-min P by A5,A9,A34,FUNCT_1:22;
   take h0;
   thus
A39: h0.1=W-min P by A34,A38,FINSEQ_1:def 7;
    A40:len h0=len h11+len (mid(h21,2,len h21 -'1)) by FINSEQ_1:35;
       2<=len h21 by A16,A23,AXIOMS:22;
then A41:1+1-1<=len h21-1 by REAL_1:49;
    then A42: 0<=len h21-1 by AXIOMS:22;
    then A43:len h21-'1=len h21 -1 by BINARITH:def 3;
       len h21<=len h21 +1 by NAT_1:37;
    then len h21 -1<=len h21 +1-1 by REAL_1:49;
    then A44:2<=len h21 & 1<=len h21-'1 & len h21-'1<=len h21
                              by A16,A23,A41,A42,AXIOMS:22,BINARITH:def 3;
       3<len h21 by A16,A23,AXIOMS:22;
    then 2+1-1<len h21 -1 by REAL_1:54;
    then A45:2<len h21 -'1 by A41,JORDAN3:1;
    then A46:len h21 -'1-'2=len h21 -'1-2 by SCMFSA_7:3;
    A47:len (mid(h21,2,len h21 -'1))
                          =(len h21-'1)-'2+1 by A44,A45,JORDAN3:27;
    then A48:len h0=len h1+(len h2-2) by A20,A23,A40,A43,A46,FINSEQ_3:31;
                   A49: 3+2-2<=len h2 -2 by A16,REAL_1:49;
                 then A50: 1<=len h2 -2 by AXIOMS:22;
then A51:   len h1+1<=len h0 by A21,A23,A40,A43,A46,A47,REAL_1:55;
        then A52:   len h0>len h1 by NAT_1:38;
       then A53:     1<len h0 by A24,AXIOMS:22;
        then A54:    len h0 in dom h0 by FINSEQ_3:27;
        then A55:    h0/.len h0=h0.len h0 by FINSEQ_4:def 4;
A56:   1<=len h0-len h1 by A48,A49,AXIOMS:22;
A57: len h0-len h11=len h0-'len h11 by A21,A52,SCMFSA_7:3;
then A58:   1<=len h0-'len h11 by A21,A51,REAL_1:84;
A59:  2<len h1 by A9,AXIOMS:22;
    then A60:2 in dom h1 by FINSEQ_3:27;
    A61: 1+1<=len h0 by A52,A59,AXIOMS:22;
    then A62:2 in dom h0 by FINSEQ_3:27;
    A63:h0.2=h11.2 by A21,A59,SCMFSA_7:9;
A64:  1 in dom h0 by A53,FINSEQ_3:27;
then A65: h0/.1 = h0.1 by FINSEQ_4:def 4;
A66: h0/.1=W-min(P) by A39,A64,FINSEQ_4:def 4;
    A67:h11 is one-to-one by A3,A10,FUNCT_1:46;
    A68:h21 is one-to-one by A12,A18,FUNCT_1:46;
   thus
A69:  h0 is one-to-one
     proof let x,y be set;assume
     A70: x in dom h0 & y in dom h0 & h0.x=h0.y;
       then reconsider nx=x,ny=y as Nat;
       A71:1<=nx & nx<=len h0 by A70,FINSEQ_3:27;
       A72:1<=ny & ny<=len h0 by A70,FINSEQ_3:27;
          now per cases;
       case nx<=len h1;
         then A73:nx in dom h1 by A71,FINSEQ_3:27;
then A74:      h1.nx in rng h1 by FUNCT_1:def 5;
         A75:h0.nx=h11.nx by A20,A73,FINSEQ_1:def 7
            .=g1.(h1.nx) by A20,A73,FUNCT_1:22;
         then A76:h0.nx in Upper_Arc(P) by A4,A19,A74,FUNCT_1:def 5;
            now per cases;
         case ny<=len h1;
           then A77:ny in dom h1 by A72,FINSEQ_3:27;
then A78:        h1.ny in rng h1 by FUNCT_1:def 5;
              h0.ny=h11.ny by A20,A77,FINSEQ_1:def 7
              .=g1.(h1.ny) by A77,FUNCT_1:23;
           then h1.nx=h1.ny by A3,A19,A70,A74,A75,A78,FUNCT_1:def 8;
          hence nx=ny by A10,A73,A77,FUNCT_1:def 8;
         end;
         case A79:ny>len h1;
           then A80:len h1 +1<=ny by NAT_1:38;
           A81:len h11+1<=ny & ny<=len h11 + len (mid(h21,2,len h21 -'1))
                                 by A21,A72,A79,FINSEQ_1:35,NAT_1:38;
           then A82:h0.ny=(mid(h21,2,len h21 -'1)).(ny -len h11) by FINSEQ_1:36
;
           A83:ny-len h11=ny-'len h11 by A21,A79,SCMFSA_7:3;
A84:        ny-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                         by A81,REAL_1:49;
             A85: len h1 +1-len h1<=ny-len h1 by A80,REAL_1:49;
           then A86:1<=ny-'len h11 & ny-'len h11<=len mid(h21,2,len h21 -'1)
                             by A21,A79,A84,SCMFSA_7:3;
           A87:h0.ny=h21.(ny-'len h11 +2-'1)
                             by A21,A44,A45,A82,A83,A84,A85,JORDAN3:27;
           A88: 1+1<=ny-'len h11+1+1-1 by A86,AXIOMS:24;
              0<=ny-'len h11 by NAT_1:18;
then A89:        0+2<=ny-'len h11 +2 by AXIOMS:24;
              ny-len h11<=len h1+(len h2-2)-len h11 by A21,A23,A40,A43,A46,A47,
A72,REAL_1:49;
           then A90: ny-'len h11+2<=len h2-2+2 by A21,A83,AXIOMS:24;
           then A91:ny-'len h11+2-1<=len h2-1 by REAL_1:49;
           A92:1<=(ny-'len h11 +2-'1) & (ny-'len h11 +2-'1)<=len h21
                      by A23,A89,A90,Lm1,JORDAN3:5,7;
           then A93:(ny-'len h11 +2-'1) in dom h21 by FINSEQ_3:27;
           then h0.ny in rng h21 by A87,FUNCT_1:def 5;
           then h0.ny in rng g2 by FUNCT_1:25;
           then h0.nx in Upper_Arc(P)/\ Lower_Arc(P)
                         by A13,A70,A76,XBOOLE_0:def 3;
then A94:         h0.nx in {W-min(P),E-max(P)} by A1,JORDAN6:65;
           A95:ny-'len h11+2-'1<=len h2-1 by A91,A92,JORDAN3:1;
           A96:2<=ny-'len h11+2-'1 by A88,A92,JORDAN3:1;
              now per cases by A94,TARSKI:def 2;
           case h0.nx=W-min(P);
             then h21.(ny-'len h11 +2-'1)=W-min(P)
               by A21,A44,A45,A70,A82,A83,A84,A85,JORDAN3:27;
             then len h21=(ny-'len h11 +2-'1)
                         by A22,A23,A29,A31,A68,A93,FUNCT_1:def 8;
             then len h21+1<=len h21-1+1 by A23,A95,AXIOMS:24;
             then len h21+1-len h21<=len h21 -len h21 by REAL_1:49;
             then len h21+1-len h21<=0;
            hence contradiction;
           end;
           case h0.nx=E-max(P);
             then 1=(ny-'len h11 +2-'1)
                       by A22,A28,A30,A68,A70,A87,A93,FUNCT_1:def 8;
            hence contradiction by A96;
           end;
           end;
          hence nx=ny;
         end;
         end;
        hence nx=ny;
       end;
       case A97:nx>len h1;
         then A98:len h1 +1<=nx by NAT_1:38;
         A99:len h11+1<=nx & nx<=len h11 + len (mid(h21,2,len h21 -'1))
                            by A21,A71,A97,FINSEQ_1:35,NAT_1:38;
         then A100:h0.nx=(mid(h21,2,len h21 -'1)).(nx -len h11) by FINSEQ_1:36;
         A101:nx-len h11=nx-'len h11 by A21,A97,SCMFSA_7:3;
A102:     nx-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                         by A99,REAL_1:49;
           A103: len h1 +1-len h1<=nx-len h1 by A98,REAL_1:49;
         then A104:1<=nx-'len h11 & nx-'len h11<=len mid(h21,2,len h21 -'1)
                             by A21,A97,A102,SCMFSA_7:3;
         A105:h0.nx=h21.(nx-'len h11 +2-'1)
                             by A21,A44,A45,A100,A101,A102,A103,JORDAN3:27;
         A106: 1+1<=nx-'len h11+1+1-1 by A104,AXIOMS:24;
            0<=nx-'len h11 by NAT_1:18;
then A107:    0+2<=nx-'len h11 +2 by AXIOMS:24;
            nx-len h11<=len h1+(len h2-2)-len h11 by A21,A23,A40,A43,A46,A47,
A71,REAL_1:49;
         then A108: nx-'len h11+2<=len h2-2+2 by A21,A101,AXIOMS:24;
         then A109:nx-'len h11+2-1<=len h2-1 by REAL_1:49;
         A110:1<=(nx-'len h11 +2-'1) & (nx-'len h11 +2-'1)<=len h21
                      by A23,A107,A108,Lm1,JORDAN3:5,7;
         then A111:(nx-'len h11 +2-'1) in dom h21 by FINSEQ_3:27;
         then h0.nx in rng h21 by A105,FUNCT_1:def 5;
         then A112:h0.nx in Lower_Arc(P) by A13,FUNCT_1:25;
            now per cases;
         case ny<=len h1;
           then A113:ny in dom h1 by A72,FINSEQ_3:27;
then A114:      h1.ny in rng h1 by FUNCT_1:def 5;
              h0.ny=h11.ny by A20,A113,FINSEQ_1:def 7
              .=g1.(h1.ny) by A20,A113,FUNCT_1:22;
           then h0.ny in rng g1 by A19,A114,FUNCT_1:def 5;
           then h0.ny in Upper_Arc(P)/\ Lower_Arc(P) by A4,A70,A112,XBOOLE_0:
def 3;
           then A115:       h0.ny in {W-min(P),E-max(P)} by A1,JORDAN6:65;
           A116:nx-'len h11+2-'1<=len h2-1 by A109,A110,JORDAN3:1;
           A117:2<=nx-'len h11+2-'1 by A106,A110,JORDAN3:1;
              now per cases by A115,TARSKI:def 2;
           case h0.ny=W-min(P);
             then len h21=(nx-'len h11 +2-'1)
                     by A22,A23,A29,A31,A68,A70,A105,A111,FUNCT_1:def 8;
             then len h21+1<=len h21-1+1 by A23,A116,AXIOMS:24;
             then len h21+1-len h21<=len h21 -len h21 by REAL_1:49;
             then len h21+1-len h21<=0;
            hence contradiction;
           end;
           case h0.ny=E-max(P);
             then h21.(nx-'len h11 +2-'1)=E-max(P)
               by A21,A44,A45,A70,A100,A101,A102,A103,JORDAN3:27;
             then 1=(nx-'len h11 +2-'1)
                         by A22,A28,A30,A68,A111,FUNCT_1:def 8;
            hence contradiction by A117;
           end;
           end;
          hence nx=ny;
         end;
         case A118:ny>len h1;
           then A119:len h1 +1<=ny by NAT_1:38;
           then A120:h0.ny=(mid(h21,2,len h21 -'1)).(ny -len h11)
             by A21,A40,A72,FINSEQ_1:36;
           A121:ny-len h11=ny-'len h11 by A21,A118,SCMFSA_7:3;
             A122: ny-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len h11
             by A40,A72,REAL_1:49;
              len h1 +1-len h1<=ny-len h1 by A119,REAL_1:49;
           then A123:h0.ny=h21.(ny-'len h11 +2-'1)
                             by A21,A44,A45,A120,A121,A122,JORDAN3:27;
              0<=ny-'len h11 by NAT_1:18;
then A124:        0+2<=ny-'len h11 +2 by AXIOMS:24;
              ny-len h11<=len h1+(len h2-2)-len h11 by A21,A23,A40,A43,A46,A47,
A72,REAL_1:49;
           then ny-'len h11+2<=len h2-2+2 by A21,A121,AXIOMS:24;
           then A125:1<=(ny-'len h11 +2-'1) & (ny-'len h11 +2-'1)<=len h21
                         by A23,A124,Lm1,JORDAN3:5,7;
           then (ny-'len h11 +2-'1) in dom h21 by FINSEQ_3:27;
           then nx-'len h1+2-'1=ny-'len h1+2-'1
                           by A21,A68,A70,A105,A111,A123,FUNCT_1:def 8;
           then nx-'len h1+2-1=ny-'len h1+2-'1 by A21,A110,JORDAN3:1;
           then nx-'len h1+2-1=ny-'len h1+2-1 by A21,A125,JORDAN3:1;
           then nx-'len h1+(2-1)=ny-'len h1+2-1 by XCMPLX_1:29;
           then nx-'len h1=ny-'len h1+(2-1)-(2-1) by XCMPLX_1:26;
           then len h1+nx-len h1=len h1+(ny-len h1) by A21,A101,A121,XCMPLX_1:
29;
          hence nx=ny by XCMPLX_1:26;
         end;
         end;
        hence nx=ny;
       end;
       end;
      hence x=y;
     end;
then A126: h0/.len h0 <> W-min P by A24,A39,A52,A54,A55,A64,FUNCT_1:def 8;
       3+2-2<=len h2 -2 by A16,REAL_1:49;
    then A127: 5+3<=len h1+(len h2 -2) by A9,REAL_1:55;
   hence
 8<=len h0 by A20,A23,A40,A43,A46,A47,FINSEQ_3:31;
     A128:rng (g1*h1) c= rng g1 by RELAT_1:45;
     A129:rng (mid(h21,2,len h21 -'1)) c= rng h21 by JORDAN3:28;
        rng (g2*h2) c= rng g2 by RELAT_1:45;
     then rng (mid(h21,2,len h21 -'1)) c= rng g2 by A129,XBOOLE_1:1;
     then rng h11 \/ rng (mid(h21,2,len h21 -'1)) c= Upper_Arc(P) \/
 Lower_Arc(P)
                 by A4,A13,A128,XBOOLE_1:13;
     then rng h0 c=Upper_Arc(P) \/ Lower_Arc(P) by FINSEQ_1:44;
   hence rng h0 c= P by A1,JORDAN6:def 9;
   thus for i being Nat st 1<=i & i<len h0 holds LE h0/.i,h0/.(i+1),P
     proof let i be Nat;assume A130: 1<=i & i<len h0;
       then A131:i+1<=len h0 by NAT_1:38;
       A132:1<i+1 by A130,NAT_1:38;
       A133:i<i+1 by NAT_1:38;
          now per cases;
       case A134:i<len h1;
         then A135:i+1<=len h1 by NAT_1:38;
         A136:h0.i=h11.i by A21,A130,A134,SCMFSA_7:9;
         A137:i in dom h1 by A130,A134,FINSEQ_3:27;
         then A138:h0.i=g1.(h1.i) by A136,FUNCT_1:23;
A139:      h1.i in rng h1 by A137,FUNCT_1:def 5;
         then A140:0<=h1.i & h1.i<=1 by A9,BORSUK_1:83,TOPREAL5:1;
         A141:h0.(i+1)=h11.(i+1) by A21,A132,A135,SCMFSA_7:9;
         A142:i+1 in dom h1 by A132,A135,FINSEQ_3:27;
         then A143:h0.(i+1)=g1.(h1.(i+1)) by A141,FUNCT_1:23;
A144:    h1.(i+1) in rng h1 by A142,FUNCT_1:def 5;
         then A145:0<=h1.(i+1) & h1.(i+1)<=1 by A9,BORSUK_1:83,TOPREAL5:1;
         A146:h1.i<h1.(i+1) by A9,A133,A137,A142,GOBOARD1:def 1;
            i in dom h0 by A130,FINSEQ_3:27;
         then A147:h0/.i=h0.i by FINSEQ_4:def 4;
            i+1 in dom h0 by A131,A132,FINSEQ_3:27;
         then A148:h0/.(i+1)=h0.(i+1) by FINSEQ_4:def 4;
         A149:g1.(h1.i) in rng g1
            by A6,A9,A139,BORSUK_1:83,FUNCT_1:def 5;
         A150:h0.(i+1) in Upper_Arc(P)
         by A4,A6,A9,A143,A144,BORSUK_1:83,FUNCT_1:def 5;
            LE h0/.i,h0/.(i+1),Upper_Arc(P),W-min(P),E-max(P)
            by A2,A3,A4,A5,A138,A140,A143,A145,A146,A147,A148,Th19;
        hence LE h0/.i,h0/.(i+1),P
          by A4,A138,A147,A148,A149,A150,JORDAN6:def 10;
       end;
       case A151: i>=len h1;
            now per cases by A151,REAL_1:def 5;
         case A152:i>len h1;
           then A153:len h1 +1<=i by NAT_1:38;
             len h11+1<=i by A21,A152,NAT_1:38;
           then A154:h0.i=(mid(h21,2,len h21 -'1)).(i -len h11)
                       by A40,A130,FINSEQ_1:36;
           A155:i-len h11=i-'len h11 by A21,A152,SCMFSA_7:3;
A156:        i-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                 by A40,A130,REAL_1:49;
              len h1 +1-len h1<=i-len h1 by A153,REAL_1:49;
           then A157:h0.i=h21.(i-'len h11 +2-'1)
                             by A21,A44,A45,A154,A155,A156,JORDAN3:27;
           A158:len h1 +1<=i+1 by A153,NAT_1:38;
           then A159:h0.(i+1)=(mid(h21,2,len h21 -'1)).(i+1 -len h11)
                                      by A21,A40,A131,FINSEQ_1:36;
              i+1>len h11 by A21,A152,NAT_1:38;
           then A160:i+1-len h11=i+1-'len h11 by SCMFSA_7:3;
A161:      i+1-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                  by A40,A131,REAL_1:49;
             A162: len h1 +1-len h1<=i+1-len h1 by A158,REAL_1:49;
           then A163:h0.(i+1)=h21.(i+1-'len h11 +2-'1)
                    by A21,A44,A45,A159,A160,A161,JORDAN3:27;
              1<i+1-'len h11+(2-1) by A21,A160,A162,NAT_1:38;
then A164:       0<i+1-'len h11+2-1 by AXIOMS:22;
           then A165:i+1-'len h11+2-1=i+1-'len h11+2-'1 by BINARITH:def 3;
              0<=i-'len h11 by NAT_1:18;
then A166:        0+2<=i-'len h11 +2 by AXIOMS:24;
              i-len h11<=len h1+(len h2-2)-len h11 by A21,A23,A40,A43,A46,A47,
A130,REAL_1:49;
           then A167: i-'len h11+2<=len h2-2+2 by A21,A155,AXIOMS:24;
           then A168:1<=(i-'len h11 +2-'1) & (i-'len h11 +2-'1)<=len h21
                          by A23,A166,Lm1,JORDAN3:5,7;
           set j=i-'len h11+2-'1;
A169:      j+1=i-'len h11+1+1-1+1 by A168,JORDAN3:1
               .=i-'len h11+2;
           A170:j+1=i-len h11+2-1+1 by A155,A168,JORDAN3:1
               .=i+1-len h11+(2-1)
               .=i+1-'len h11+2-'1 by A160,A164,BINARITH:def 3;
           A171:j in dom h2 by A22,A168,FINSEQ_3:27;
           then A172:h0.i=g2.(h2.j) by A157,FUNCT_1:23;
A173:      h2.j in rng h2 by A171,FUNCT_1:def 5;
           then A174:0<=h2.j & h2.j<=1 by A16,BORSUK_1:83,TOPREAL5:1;
           A175:j<j+1 by NAT_1:38;
           A176:1<j+1 by A168,NAT_1:38;
           then A177:j+1 in dom h2 by A167,A169,FINSEQ_3:27;
           then A178:h0.(i+1)=g2.(h2.(j+1)) by A163,A170,FUNCT_1:23;
A179:      h2.(j+1) in rng h2 by A177,FUNCT_1:def 5;
           then A180:0<=h2.(j+1) & h2.(j+1)<=1 by A16,BORSUK_1:83,TOPREAL5:1;
           A181:h2.j<h2.(j+1) by A16,A171,A175,A177,GOBOARD1:def 1;
              i in dom h0 by A130,FINSEQ_3:27;
           then A182:h0/.i=h0.i by FINSEQ_4:def 4;
              i+1 in dom h0 by A131,A132,FINSEQ_3:27;
           then A183:h0/.(i+1)=h0.(i+1) by FINSEQ_4:def 4;
           A184:h0.i in Lower_Arc(P)
              by A13,A15,A16,A172,A173,BORSUK_1:83,FUNCT_1:def 5;
           A185:h0.(i+1) in Lower_Arc(P)
             by A13,A15,A16,A178,A179,BORSUK_1:83,FUNCT_1:def 5;
              i+1-len h11<=len h1+(len h2-2)-len h11 by A21,A23,A40,A43,A46,A47
,A131,REAL_1:49;
           then A186: i+1-'len h11+2<=len h2-2+2 by A21,A160,AXIOMS:24;then
           A188:i+1-'len h11+2-1<=len h2-1 by REAL_1:49;
              len h2<len h2+1 by NAT_1:38;
           then len h2-1<len h2+1-1 by REAL_1:54;
           then i+1-'len h11+2-'1<len h2 by A165,A188,AXIOMS:22;
           then A189:i+1-'len h11+2-'1 in dom h2 by A170,A176,FINSEQ_3:27;
A190:      now assume h0/.(i+1)=W-min(P);
             then len h21=(i+1-'len h11 +2-'1)
                   by A22,A23,A29,A31,A68,A163,A183,A189,FUNCT_1:def 8;
             then len h21+1-len h21<=len h21 -len h21
               by REAL_1:49,A23,A165,A186;
             then len h21+1-len h21<=0;
            hence contradiction;
           end;
              LE h0/.i,h0/.(i+1),Lower_Arc(P),E-max(P),W-min(P)
            by A11,A12,A13,A14,A172,A174,A178,A180,A181,A182,A183,Th19;
          hence LE h0/.i,h0/.(i+1),P
            by A182,A183,A184,A185,A190,JORDAN6:def 10;
         end;
         case A191:i=len h1;
          then A192:h0.(i+1)=(mid(h21,2,len h21 -'1)).(i+1 -len h11)
                                 by A21,A40,A131,FINSEQ_1:36;
           A193:i+1-len h11=i+1-'len h11 by A21,A133,A191,SCMFSA_7:3;
             A194: i+1-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                               by A40,A131,REAL_1:49;
              1<=i+1-len h11 by A21,A191;
           then A195:h0.(i+1)=h21.(i+1-'len h11 +2-'1)
                    by A44,A45,A192,A193,A194,JORDAN3:27;
           A196:h0.i=h11.i by A21,A130,A191,SCMFSA_7:9;
              i in dom h1 by A130,A191,FINSEQ_3:27;
           then A197:h0.i=E-max(P) by A5,A9,A191,A196,FUNCT_1:23;
              i in dom h0 by A130,FINSEQ_3:27;
           then h0/.i=E-max(P) by A197,FINSEQ_4:def 4;
           then A198:h0/.i in Upper_Arc(P) by A1,Th1;
           set j=i-'len h11+2-'1;
             len h11-'len h11= len h11-len h11 by SCMFSA_7:3.=0;
then A199:      j=2-1 by A21,A191,SCMFSA_7:3;
           then A200:j+1<=len h2 by A16,AXIOMS:22;
           A201:i+1-'len h11+2-'1=1+2-'1 by A21,A191,BINARITH:39
           .=2 by BINARITH:39;
           A202:j+1 in dom h2 by A199,A200,FINSEQ_3:27;
           then A203:h0.(i+1)=g2.(h2.(j+1)) by A195,A199,A201,FUNCT_1:23;
A204:      h2.(j+1) in rng h2 by A202,FUNCT_1:def 5;
              i+1 in dom h0 by A131,A132,FINSEQ_3:27;
           then A205:h0/.(i+1)=h0.(i+1) by FINSEQ_4:def 4;
           A206:h0.(i+1) in Lower_Arc(P)
              by A13,A15,A16,A203,A204,BORSUK_1:83,FUNCT_1:def 5;
              2<=len h21 by A16,A23,AXIOMS:22;
           then A207:2 in dom h21 by FINSEQ_3:27;
             len h21 <> i+1-'len h11 +2-'1 by A16,A23,A201;
           then h0/.(i+1) <> W-min P
            by A22,A23,A29,A31,A68,A195,A201,A205,A207,FUNCT_1:def 8;
          hence LE h0/.i,h0/.(i+1),P by A198,A205,A206,JORDAN6:def 10;
         end;
         end;
        hence LE h0/.i,h0/.(i+1),P;
       end;
       end;
      hence LE h0/.i,h0/.(i+1),P;
     end;
    thus for i being Nat,W being Subset of Euclid 2
      st 1<=i & i<len h0 & W=Segment(h0/.i,h0/.(i+1),P) holds
      diameter(W)<e
     proof let i be Nat,W be Subset of Euclid 2;
      assume
       A208:1<=i & i<len h0 & W=Segment(h0/.i,h0/.(i+1),P);
       then A209:i+1<=len h0 by NAT_1:38;
       A210:1<i+1 by A208,NAT_1:38;
       A211:i<i+1 by NAT_1:38;
          now per cases by REAL_1:def 5;
       case A212:i<len h1;
         then A213:i+1<=len h1 by NAT_1:38;
         A214:h0.i=h11.i by A21,A208,A212,SCMFSA_7:9;
         A215:i in dom h1 by A208,A212,FINSEQ_3:27;
         then A216:h11.i=g1.(h1.i) by FUNCT_1:23;
         then A217:h0.i=g1.(h1.i) by A21,A208,A212,SCMFSA_7:9;
A218:    h1.i in rng h1 by A215,FUNCT_1:def 5;
         then A219:0<=h1.i & h1.i<=1 by A9,BORSUK_1:83,TOPREAL5:1;
         A220:h0.(i+1)=h11.(i+1) by A21,A210,A213,SCMFSA_7:9;
         A221:i+1 in dom h1 by A210,A213,FINSEQ_3:27;
         then A222:h0.(i+1)=g1.(h1.(i+1)) by A220,FUNCT_1:23;
A223:      h1.(i+1) in rng h1 by A221,FUNCT_1:def 5;
         then A224:0<=h1.(i+1) & h1.(i+1)<=1 by A9,BORSUK_1:83,TOPREAL5:1;
         A225:h1.i<h1.(i+1) by A9,A211,A215,A221,GOBOARD1:def 1;
            i in dom h0 by A208,FINSEQ_3:27;
         then A226:h0/.i=h0.i by FINSEQ_4:def 4;
            i+1 in dom h0 by A209,A210,FINSEQ_3:27;
         then A227:h0/.(i+1)=h0.(i+1) by FINSEQ_4:def 4;
         A228:h0.i in Upper_Arc(P)
             by A4,A6,A9,A217,A218,BORSUK_1:83,FUNCT_1:def 5;
         A229:h0.(i+1) in Upper_Arc(P)
           by A4,A6,A9,A222,A223,BORSUK_1:83,FUNCT_1:def 5;
          A230:h1/.i=h1.i by A208,A212,FINSEQ_4:24;
          A231:h1/.(i+1)=h1.(i+1) by A210,A213,FINSEQ_4:24;
         then reconsider Q1=[.h1/.i,h1/.(i+1).]
          as Subset of I[01]
             by A9,A218,A223,A230,BORSUK_1:83,RCOMP_1:16;
         A232:Segment(h0/.i,h0/.(i+1),P) c= g1.:([.h1/.i,h1/.(i+1).])
          proof let x be set;assume
           A233:x in Segment(h0/.i,h0/.(i+1),P);
A234:         h0/.(i+1) <> W-min P
               by A20,A25,A38,A67,A210,A220,A221,A227,FUNCT_1:def 8;
            then x in {p: LE h0/.i,p,P & LE p,h0/.(i+1),P} by A233,Def1;
            then consider p being Point of TOP-REAL 2 such that
            A235:p=x & (LE h0/.i,p,P & LE p,h0/.(i+1),P);
       A236:h0/.i in Upper_Arc(P) & p in Lower_Arc(P)& not p=W-min(P) or
            h0/.i in Upper_Arc(P) & p in Upper_Arc(P) &
             LE h0/.i,p,Upper_Arc(P),W-min(P),E-max(P) or
            h0/.i in Lower_Arc(P) & p in Lower_Arc(P)& not p=W-min(P) &
             LE h0/.i,p,Lower_Arc(P),E-max(P),W-min(P)
                                   by A235,JORDAN6:def 10;
            A237:p in Upper_Arc(P) & h0/.(i+1) in Lower_Arc(P) or
            p in Upper_Arc(P) & h0/.(i+1) in Upper_Arc(P) &
             LE p,h0/.(i+1),Upper_Arc(P),W-min(P),E-max(P) or
            p in Lower_Arc(P) & h0/.(i+1) in Lower_Arc(P)&
             LE p,h0/.(i+1),Lower_Arc(P),E-max(P),W-min(P)
                                   by A235,JORDAN6:def 10;
               now per cases by A213,REAL_1:def 5;
            case i+1<len h1;
             then A238:         h0/.(i+1) <> E-max P
                       by A20,A26,A37,A67,A220,A221,A227,FUNCT_1:def 8;
A239:            now assume h0/.(i+1) in Lower_Arc(P);
                  then h0/.(i+1) in Upper_Arc(P)/\ Lower_Arc(P)
                             by A227,A229,XBOOLE_0:def 3;
                  then h0/.(i+1) in {W-min(P),E-max(P)} by A1,JORDAN6:def 9;
                 hence contradiction by A234,A238,TARSKI:def 2;
                end;
              then A240:p in Upper_Arc(P) & h0/.(i+1) in Upper_Arc(P)
                by A235,JORDAN6:def 10;
A241:           LE p,h0/.(i+1),Upper_Arc(P),W-min(P),E-max(P)
                   by A235,A239,JORDAN6:def 10;
                then A242:         p<>E-max(P) by A2,A238,JORDAN6:70;
                 now per cases by A208,REAL_1:def 5;
              case i>1;
then A243:        h0/.i <> W-min P
                  by A20,A25,A38,A67,A215,A216,A217,A226,FUNCT_1:def 8;
A244:         h11.i <> E-max(P) by A20,A26,A37,A67,A212,A215,FUNCT_1:def 8;
                   now assume h0/.i in Lower_Arc(P);
                  then h0/.i in Upper_Arc(P)/\ Lower_Arc(P)
                             by A226,A228,XBOOLE_0:def 3;
                  then h0/.i in {W-min(P),E-max(P)} by A1,JORDAN6:def 9;
                 hence contradiction by A214,A226,A243,A244,TARSKI:def 2;
                end;
                then A245:h0/.i in Upper_Arc(P) & p in Lower_Arc(P)
                 & not p=W-min(P) or
                h0/.i in Upper_Arc(P) & p in Upper_Arc(P) &
                LE h0/.i,p,Upper_Arc(P),W-min(P),E-max(P)
                  by A235,JORDAN6:def 10;
then A246:            p <> W-min P by A2,A243,JORDAN6:69;
A247:             now assume p in Lower_Arc(P);
                  then p in Upper_Arc(P)/\ Lower_Arc(P) by A240,XBOOLE_0:def 3
;
                then p in {W-min(P),E-max(P)} by A1,JORDAN6:def 9;
                 hence contradiction by A242,A246,TARSKI:def 2;
                end;
                  then consider z being set such that A248:z in dom g1 & p=g1.z
                                   by A4,A245,FUNCT_1:def 5;
                  reconsider rz=z as Real by A6,A248;
                A249:g1.(h1/.i)=h0/.i by A208,A212,A214,A216,A226,FINSEQ_4:24;
                  A250:0<=h1/.i & h1/.i<=1 &
                   g1.(h1/.(i+1))=h0/.(i+1)
                by A208,A210,A212,A213,A219,A222,A227,FINSEQ_4:24;
                      h1.(i+1) in rng h1 by A221,FUNCT_1:def 5;
              then A251:0<=h1/.(i+1) & h1/.(i+1)<=1
                by A9,A231,BORSUK_1:83,TOPREAL5:1;
               take rz;
               thus rz in dom g1 by A248;
                   A252:0<=rz & rz<=1 by A6,A248,TOPREAL5:1;
                   then A253:h1/.i<=rz
                  by A3,A4,A5,A245,A247,A248,A249,A250,Th20;
                      rz<=h1/.(i+1)
                    by A3,A4,A5,A241,A248,A250,A251,A252,Th20;
               hence rz in [.h1/.i,h1/.(i+1).] by A253,TOPREAL5:1;
               thus x = g1.rz by A235,A248;
              end;
              case A254:i=1;
                   now per cases;
                case A255:p<>W-min(P);
                 now assume p in Lower_Arc(P);
                    then p in Upper_Arc(P)/\ Lower_Arc(P) by A240,XBOOLE_0:def
3;
                    then p in {W-min(P),E-max(P)} by A1,JORDAN6:def 9;
                   hence contradiction by A242,A255,TARSKI:def 2;
                  end;
                  then consider z being set such that A256:z in dom g1 & p=g1.z
                                   by A4,A236,FUNCT_1:def 5;
                  reconsider rz=z as Real by A6,A256;
              take rz;
              A257:g1.(h1/.(1+1))=h0/.(1+1)
                  by A213,A222,A227,A254,FINSEQ_4:24;
                      h1.(1+1) in rng h1 by A221,A254,FUNCT_1:def 5;
              then A258:0<=h1/.(1+1) & h1/.(1+1)<=1
              by A9,A231,A254,BORSUK_1:83,TOPREAL5:1;
                   A259:0<=rz & rz<=1 by A6,A256,TOPREAL5:1;
         A260:h1/.1<=rz by A6,A9,A230,A254,A256,TOPREAL5:1;
                      rz<=h1/.(1+1)
                   by A3,A4,A5,A241,A254,A256,A257,A258,A259,Th20;
                 hence rz in dom g1
                      & rz in [.h1/.1,h1/.(1+1).]
                      & x = g1.rz by A235,A256,A260,TOPREAL5:1;
                end;
                case A261:p=W-min(P);
                 thus 0 in [.h1/.1,h1/.(1+1).]
                    by A9,A225,A230,A231,A254,TOPREAL5:1;
                 thus x = g1.0 by A5,A235,A261;
                end;
                end;
               hence ex y being set st y in dom g1 &
               y in [.h1/.1,h1/.(1+1).] & x = g1.y by A7;
              end;
              end;
             hence ex y being set st y in dom g1 & y in [.h1/.i,h1/.(i+1).]
              & x = g1.y;
            end;
            case A262:i+1=len h1;
              then A263:h0/.(i+1)=E-max(P)
                by A5,A9,A26,A220,A227,FUNCT_1:23;
              A264:p in Upper_Arc(P) or p in Lower_Arc(P)
              by A235,JORDAN6:def 10;
A265:           now assume A266:p in Lower_Arc(P)& not p in Upper_Arc(P);
                then LE h0/.(i+1),p,Lower_Arc(P),E-max(P),W-min(P)
                   by A11,A263,JORDAN5C:10;
               hence contradiction by A8,A11,A237,A263,A266,JORDAN5C:12;
              end;
              then A267:LE p,h0/.(i+1),Upper_Arc(P),W-min(P),E-max(P)
                               by A2,A263,A264,JORDAN5C:10;
                 now per cases;
              case A268:p<>E-max(P);
                   now per cases;
                case A269:p<>W-min(P);
A270:               now assume p in Lower_Arc(P);
                    then p in Upper_Arc(P)/\ Lower_Arc(P) by A265,XBOOLE_0:def
3;
                    then p in {W-min(P),E-max(P)} by A1,JORDAN6:def 9;
                   hence contradiction by A268,A269,TARSKI:def 2;
                  end;
                  then consider z being set such that A271:z in dom g1 & p=g1.z
                                   by A4,A236,FUNCT_1:def 5;
                  reconsider rz=z as Real by A6,A271;
                 take rz;
A272:             g1.(h1/.(i+1))=h0/.(i+1) by A210,A213,A222,A227,FINSEQ_4:24;
                      h1.(i+1) in rng h1 by A221,FUNCT_1:def 5;
              then A273:0<=h1/.(i+1) & h1/.(i+1)<=1
              by A9,A231,BORSUK_1:83,TOPREAL5:1;
                   A274:0<=rz & rz<=1 by A6,A271,TOPREAL5:1;
                   then A275:h1/.i<=rz
                    by A3,A4,A5,A214,A216,A219,A226,A230,A236,A270,A271,Th20;
                      rz<=h1/.(i+1)
         by A3,A4,A5,A267,A271,A272,A273,A274,Th20;
                 hence rz in dom g1 &
                 rz in [.h1/.i,h1/.(i+1).]
                      & x = g1.rz by A235,A271,A275,TOPREAL5:1;
                end;
                case A276:p=W-min(P);
                  then h11.i=W-min(P) by A2,A214,A226,A236,JORDAN6:69;
                  then i=1 by A20,A25,A38,A67,A215,FUNCT_1:def 8;
                  then 0 in [.h1/.i,h1/.(i+1).]
                    by A9,A225,A230,A231,TOPREAL5:1;
                 hence ex y being set st y in dom g1 &
                 y in [.h1/.i,h1/.(i+1).]
                     & x = g1.y by A5,A7,A235,A276;
                end;
                end;
               hence ex y being set st y in dom g1 &
               y in [.h1/.i,h1/.(i+1).] & x = g1.y;
               end;
               case A277:p=E-max(P);
                   1 in [.h1/.i,h1/.(i+1).]
                 by A9,A225,A230,A231,A262,TOPREAL5:1;
               hence ex y being set st
                y in dom g1 & y in [.h1/.i,h1/.(i+1).]
                  & x = g1.y by A5,A33,A235,A277,Lm5;
               end;
               end;
              hence ex y being set st y in dom g1 & y in [.h1/.i,
              h1/.(i+1).] & x = g1.y;
            end;
            end;
           hence x in g1.:([.h1/.i,h1/.(i+1).]) by FUNCT_1:def 12;
          end;
            g1.:([.h1/.i,h1/.(i+1).]) c= Segment(h0/.i,h0/.(i+1),P)
          proof let x be set;assume x in g1.:([.h1/.i,h1/.(i+1).]);
            then consider y being set such that
      A278: y in dom g1 & y in [.h1/.i,h1/.(i+1).] & x=g1.y by FUNCT_1:def 12;
            A279:x in Upper_Arc(P) by A4,A278,FUNCT_1:def 5;
            then reconsider p1=x as Point of TOP-REAL 2;
            reconsider sy=y as Real by A278;
             A280:g1.(h1/.i)=h0/.i by A208,A212,A217,A226,FINSEQ_4:24;
             A281:h1/.i<=sy & sy<=h1/.(i+1) by A278,TOPREAL5:1;
             A282:0<=h1/.i & h1/.i<=1 by A208,A212,A219,FINSEQ_4:24;
             A283:0<=sy & sy<=1 by A6,A278,TOPREAL5:1;
             then A284:             LE h0/.i,p1,Upper_Arc(P),W-min(P),E-max(P)
              by A2,A3,A4,A5,A278,A280,A281,A282,Th19;
                LE p1,h0/.(i+1),Upper_Arc(P),W-min(P),E-max(P)
           by A2,A3,A4,A5,A222,A224,A227,A231,A278,A281,A283,Th19;
                           then A285: LE h0/.i,p1,P & LE p1,h0/.(i+1),P
                       by A226,A227,A228,A229,A279,A284,JORDAN6:def 10;
A286:       not h0/.(i+1)=W-min P
               by A20,A25,A38,A67,A210,A220,A221,A227,FUNCT_1:def 8;
               x in {p: LE h0/.i,p,P & LE p,h0/.(i+1),P} by A285;
           hence x in Segment(h0/.i,h0/.(i+1),P) by A286,Def1;
          end;
         then W=g1.:Q1 by A208,A232,XBOOLE_0:def 10;
        hence diameter(W)<e by A9,A208,A212;
       end;
       case A287:i>len h1;
           then A288:len h1 +1<=i by NAT_1:38;
              len h11+1<=i & i<=len h11 + len (mid(h21,2,len h21 -'1))
                                 by A21,A208,A287,FINSEQ_1:35,NAT_1:38;
           then A289:h0.i=(mid(h21,2,len h21 -'1)).(i -len h11) by FINSEQ_1:36;
           A290:i-len h11=i-'len h11 by A21,A287,SCMFSA_7:3;
A291:       i-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                      by A40,A208,REAL_1:49;
              len h1 +1-len h1<=i-len h1 by A288,REAL_1:49;
           then A292:h0.i=h21.(i-'len h11 +2-'1)
                             by A21,A44,A45,A289,A290,A291,JORDAN3:27;
           A293:len h1 +1<=i+1 by A288,NAT_1:38;
           then A294:h0.(i+1)=(mid(h21,2,len h21 -'1)).(i+1 -len h11)
                                      by A21,A40,A209,FINSEQ_1:36;
              i+1>len h11 by A21,A287,NAT_1:38;
           then A295:i+1-len h11=i+1-'len h11 by SCMFSA_7:3;
A296:       i+1-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                         by A40,A209,REAL_1:49;
             A297: len h1 +1-len h1<=i+1-len h1 by A293,REAL_1:49;
           then A298:h0.(i+1)=h21.(i+1-'len h11 +2-'1)
                    by A21,A44,A45,A294,A295,A296,JORDAN3:27;
              1<i+1-'len h11+(2-1) by A21,A295,A297,NAT_1:38;
           then A299: 0<i+1-'len h11+2-1 by AXIOMS:22;
              0<=i-'len h11 by NAT_1:18;
then A300:      0+2<=i-'len h11 +2 by AXIOMS:24;
              i-len h11<=len h1+(len h2-2)-len h11 by A21,A23,A40,A43,A46,A47,
A208,REAL_1:49;
           then A301: i-'len h11+2<=len h2-2+2 by A21,A290,AXIOMS:24;
           then A302:i-'len h11+2-1<=len h2-1 by REAL_1:49;
           A303:1<=(i-'len h11 +2-'1) & (i-'len h11 +2-'1)<=len h21
                         by A23,A300,A301,Lm1,JORDAN3:5,7;
              len h2<len h2+1 by NAT_1:38;
           then len h2-1<len h2+1-1 by REAL_1:54;
           then A304:i-'len h11+2-1<len h2 by A302,AXIOMS:22;
           A305:i-'len h11+2-'1=i-'len h11+2-1 by A303,JORDAN3:1;
           set j=i-'len h11+2-'1;
              len h1 +1<=i by A287,NAT_1:38;
           then len h11+1-len h11<=i-len h11 by A21,REAL_1:49;
           then 1<=i-'len h11 by JORDAN3:1;
           then 1+2<=i-'len h11+2 by AXIOMS:24;
           then 1+2-1<=i-'len h11+2-1 by REAL_1:49;
           then A306:1<j by A305,AXIOMS:22;
              i-len h11<len h11+(len h2-2)-len h11 by A23,A40,A43,A46,A47,A208,
REAL_1:54;
then A307:       i-len h11+2<len h2-2+2 by REAL_1:53;
           A308:j< len h2 by A303,A304,JORDAN3:1;
           A309:j+1=i-'len h11+1+1-1+1 by A303,JORDAN3:1
               .=i-'len h11+(1+1);
           A310:j+1 =1+(i-len h11+(2-1)) by A290,A305
               .=i+1-len h11+(2-1)
               .=i+1-'len h11+2-'1 by A295,A299,BINARITH:def 3;
           A311:j in dom h2 by A22,A303,FINSEQ_3:27;
           then A312:h0.i=g2.(h2.j) by A292,FUNCT_1:23;
A313:        h2.j in rng h2 by A311,FUNCT_1:def 5;
           A314:1<j+1 by A303,NAT_1:38;
           then A315:j+1 in dom h2 by A301,A309,FINSEQ_3:27;
then A316:      h0.(i+1)=g2.(h2.(j+1)) by A298,A310,FUNCT_1:23;
A317:        h2.(j+1) in rng h2 by A315,FUNCT_1:def 5;
              i in dom h0 by A208,FINSEQ_3:27;
           then A318:h0/.i=h0.i by FINSEQ_4:def 4;
              i+1 in dom h0 by A209,A210,FINSEQ_3:27;
           then A319:h0/.(i+1)=h0.(i+1) by FINSEQ_4:def 4;
              g2.(h2.j) in rng g2 by A15,A16,A313,BORSUK_1:83,FUNCT_1:def 5;
           then A320:h0.i in Lower_Arc(P) by A13,A292,A311,FUNCT_1:23;
           A321:h0.(i+1) in Lower_Arc(P)
            by A13,A15,A16,A316,A317,BORSUK_1:83,FUNCT_1:def 5;
A322: 0 <= h2.j by A16,A313,BORSUK_1:83,TOPREAL5:1;
A323: h2.j <= 1 by A16,A313,BORSUK_1:83,TOPREAL5:1;
A324: g2.(h2.(j+1)) = h0/.(i+1) by A298,A310,A315,A319,FUNCT_1:23;
A325: h2.(j+1) <= 1 by A16,A317,BORSUK_1:83,TOPREAL5:1;
          A326:h2/.j=h2.j by A303,A308,FINSEQ_4:24;
          A327:h2/.(j+1)=h2.(j+1) by A301,A309,A314,FINSEQ_4:24;
         then reconsider Q1=[.h2/.j,h2/.(j+1).] as Subset of
I[01]
            by A16,A313,A317,A326,BORSUK_1:83,RCOMP_1:16;
         A328:Segment(h0/.i,h0/.(i+1),P) c= g2.:([.h2/.j,h2/.(j+1).])
          proof let x be set;assume
           A329:x in Segment(h0/.i,h0/.(i+1),P);
               h0/.(i+1) <> W-min P
                   by A22,A29,A31,A68,A290,A298,A307,A309,A310,A315,A319,
FUNCT_1:def 8;
            then x in {p: LE h0/.i,p,P & LE p,h0/.(i+1),P} by A329,Def1;
            then consider p being Point of TOP-REAL 2 such that
            A330:p=x & (LE h0/.i,p,P & LE p,h0/.(i+1),P);
            A331:h0/.i in Upper_Arc(P) & p in Lower_Arc(P)& not p=W-min(P) or
            h0/.i in Upper_Arc(P) & p in Upper_Arc(P) &
             LE h0/.i,p,Upper_Arc(P),W-min(P),E-max(P) or
            h0/.i in Lower_Arc(P) & p in Lower_Arc(P)& not p=W-min(P) &
             LE h0/.i,p,Lower_Arc(P),E-max(P),W-min(P)
                                   by A330,JORDAN6:def 10;
                A332:j<len h2 by A301,A309,NAT_1:38;
              A333: h0/.(i+1) <> E-max P
              by A22,A28,A30,A68,A298,A310,A314,A315,A319,FUNCT_1:def 8;
A334:       h21.(j+1) <> W-min P by A22,A29,A31,A68,A290,A307,A309,A315,FUNCT_1
:def 8;
                   now assume h0/.(i+1) in Upper_Arc(P);
                  then h0/.(i+1) in Upper_Arc(P)/\ Lower_Arc(P)
                             by A319,A321,XBOOLE_0:def 3;
                  then h0/.(i+1) in {W-min(P),E-max(P)} by A1,JORDAN6:def 9;
                 hence contradiction by A298,A310,A319,A333,A334,TARSKI:def 2;
                end;
     then A335:p in Lower_Arc(P) & h0/.(i+1) in Lower_Arc(P)& not
            h0/.(i+1)=W-min(P)
             & LE p,h0/.(i+1),Lower_Arc(P),E-max(P),W-min(P) or
            p in Upper_Arc(P) & h0/.(i+1) in Lower_Arc(P)
                 & not h0/.(i+1)=W-min(P) by A330,JORDAN6:def 10;
A336:        h0/.i <> W-min(P)
                    by A22,A29,A31,A68,A292,A311,A318,A332,FUNCT_1:def 8;
A337:         h21.j <> E-max P by A22,A28,A30,A68,A306,A311,FUNCT_1:def 8;
A338:         now assume h0/.i in Upper_Arc(P);
                  then h0/.i in Upper_Arc(P)/\ Lower_Arc(P)
                                   by A318,A320,XBOOLE_0:def 3;
                  then h0/.i in {W-min(P),E-max(P)} by A1,JORDAN6:def 9;
                 hence contradiction by A292,A318,A336,A337,TARSKI:def 2;
              end;
then A339:         LE h0/.i,p,Lower_Arc P, E-max P, W-min P
                      by A330,JORDAN6:def 10;
A340:         h0/.i <> E-max(P) by A22,A28,A30,A68,A292,A306,A311,A318,FUNCT_1:
def 8;
A341:             now assume p in Upper_Arc(P);
                  then p in Upper_Arc P /\ Lower_Arc P by A331,A338,XBOOLE_0:
def 3;
                  then p in {W-min(P),E-max(P)} by A1,JORDAN6:def 9;
                  then p=W-min(P) or p=E-max(P) by TARSKI:def 2;
                 hence contradiction by A11,A331,A338,A340,JORDAN6:69;
                end;
then A342:           LE p,h0/.(i+1),Lower_Arc(P),E-max(P),W-min(P)
                  by A330,JORDAN6:def 10;
                  consider z being set such that A343:z in dom g2 & p=g2.z
                                   by A13,A335,A341,FUNCT_1:def 5;
                  reconsider rz=z as Real by A15,A343;
                  A344:g2.(h2/.(j+1))=h0/.(i+1)
                      by A298,A310,A315,A319,A327,FUNCT_1:23;
                   A345:0<=h2/.j & h2/.j<=1
                      by A16,A313,A326,BORSUK_1:83,TOPREAL5:1;
                      h2.(j+1) in rng h2 by A315,FUNCT_1:def 5;
                then 0<=rz & rz<=1 & 0<=h2/.(j+1) & h2/.(j+1)<=1
                               by A15,A16,A327,A343,BORSUK_1:83,TOPREAL5:1;
                   then rz<=h2/.(j+1)& h2/.j<=rz
               by A12,A13,A14,A312,A318,A326,A339,A342,A343,A344,A345,Th20;
             then rz in [.h2/.j,h2/.(j+1).] by TOPREAL5:1;
           hence x in g2.:([.h2/.j,h2/.(j+1).]) by A330,A343,FUNCT_1:def 12;
          end;
            g2.:([.h2/.j,h2/.(j+1).]) c= Segment(h0/.i,h0/.(i+1),P)
          proof let x be set;assume x in g2.:([.h2/.j,h2/.(j+1).]);
            then consider y being set such that
A346: y in dom g2 & y in [.h2/.j,h2/.(j+1).] & x=g2.y by FUNCT_1:def 12;
            A347:x in Lower_Arc(P) by A13,A346,FUNCT_1:def 5;
            then reconsider p1=x as Point of TOP-REAL 2;
            reconsider sy=y as Real by A346;
             A348:h2/.j<=sy & sy<=h2/.(j+1) by A346,TOPREAL5:1;
             A349:0<=sy & sy<=1 by A15,A346,TOPREAL5:1;
A350:         h2.(j+1) <> 1 by A16,A18,A29,A290,A307,A309,A315,FUNCT_1:def 8;
A351:         now assume p1=W-min(P);
             then 1=sy by A12,A14,A32,A346,FUNCT_1:def 8;
             hence contradiction by A325,A327,A348,A350,AXIOMS:21;
            end;
A352:       h0/.(i+1) <> W-min P
            by A22,A29,A31,A68,A290,A298,A307,A309,A310,A315,A319,FUNCT_1:def 8
;
A353:          LE h0/.i,p1,Lower_Arc(P),E-max(P),W-min(P)
                  by A11,A12,A13,A14,A312,A318,A322,A323,A326,A346,A348,A349,
Th19;
                LE p1,h0/.(i+1),Lower_Arc(P),E-max(P),W-min(P)
                       by A11,A12,A13,A14,A324,A325,A327,A346,A348,A349,Th19;
             then LE h0/.i,p1,P & LE p1,h0/.(i+1),P
                    by A318,A319,A320,A321,A347,A351,A352,A353,JORDAN6:def 10;
            then x in {p: LE h0/.i,p,P & LE p,h0/.(i+1),P};
           hence x in Segment(h0/.i,h0/.(i+1),P) by A352,Def1;
          end;
         then W=g2.:(Q1) by A208,A328,XBOOLE_0:def 10;
        hence diameter(W)<e by A16,A303,A308;
       end;
       case A354:i=len h1;
           then A355:h0.i=E-max(P) by A21,A37,A208,SCMFSA_7:9;
           A356:i-len h11=i-'len h11 by A21,A354,SCMFSA_7:3;
           A357:h0.(i+1)=(mid(h21,2,len h21 -'1)).(i+1 -len h11)
                            by A21,A40,A209,A354,FINSEQ_1:36;
           A358:i+1-len h11=i+1-'len h11 by A21,A211,A354,SCMFSA_7:3;
         i+1-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                         by A40,A209,REAL_1:49;
           then A359:1<=i+1-'len h11 & i+1-'len h11<=len mid(h21,2,len h21 -'1)
                             by A21,A211,A354,SCMFSA_7:3;
           then 1<i+1-'len h11+(2-1) by NAT_1:38;
           then A360: 0<i+1-'len h11+2-1 by AXIOMS:22;
              0<=i-'len h11 by NAT_1:18;
then A361:      0+2<=i-'len h11 +2 by AXIOMS:24;
              i-len h11<=len h1+(len h2-2)-len h11 by A21,A23,A40,A43,A46,A47,
A208,REAL_1:49;
           then A362: i-'len h11+2<=len h2-2+2 by A21,A356,AXIOMS:24;
           then A363:i-'len h11+2-1<=len h2-1 by REAL_1:49;
           A364:1<=(i-'len h11 +2-'1) & (i-'len h11 +2-'1)<=len h21
                                    by A23,A361,A362,Lm1,JORDAN3:5,7;
              len h2<len h2+1 by NAT_1:38;
           then len h2-1<len h2+1-1 by REAL_1:54;
           then A365:i-'len h11+2-1<len h2 by A363,AXIOMS:22;
           A366:i-'len h11+2-'1=i-'len h11+2-1 by A364,JORDAN3:1;
           set j=i-'len h11+2-'1;
            len h1-'len h11=len h11-len h11 by A21,BINARITH:def 3;
then A367:      0+2-1=len h1-'len h11+2-1;
              i-len h11<len h11+(len h2-2)-len h11 by A23,A40,A43,A46,A47,A208,
REAL_1:54;
           then A368: i-len h11+2<len h2-2+2 by REAL_1:53;
           A369:j+1=i-'len h11+1+1-1+1 by A364,JORDAN3:1
               .=i-'len h11+(1+1);
           then A370:j+1<len h2 by A21,A354,A368,BINARITH:def 3;
           A371:j+1=i-len h11+2-1+1 by A21,A354,A366,BINARITH:def 3
               .=i+1-len h11+(2-1)
               .=i+1-'len h11+2-'1 by A358,A360,BINARITH:def 3;
           A372:j in dom h2 by A22,A364,FINSEQ_3:27;
           then A373:h21.j=g2.(h2.j) by FUNCT_1:23;
           A374:h0.i=g2.(h2.j) by A14,A16,A354,A355,A367,JORDAN3:1;
A375:        h2.j in rng h2 by A372,FUNCT_1:def 5;
           A376:1<j+1 by A364,NAT_1:38;
           A377:  h0.(i+1)=h21.(j+1) by A44,A45,A357,A358,A359,A371,JORDAN3:27;
           A378:j+1 in dom h2 by A362,A369,A376,FINSEQ_3:27;
           then A379:h0.(i+1)=g2.(h2.(j+1)) by A377,FUNCT_1:23;
A380:        h2.(j+1) in rng h2 by A378,FUNCT_1:def 5;
              i in dom h0 by A208,FINSEQ_3:27;
           then A381:h0/.i=h0.i by FINSEQ_4:def 4;
              i+1 in dom h0 by A209,A210,FINSEQ_3:27;
           then A382:h0/.(i+1)=h0.(i+1) by FINSEQ_4:def 4;
             g2.(h2.j) in rng g2 by A15,A16,A375,BORSUK_1:83,FUNCT_1:def 5;
           then A383:h0.i in Lower_Arc P
              by A13,A14,A16,A354,A355,A367,JORDAN3:1;
           A384:h0.(i+1) in Lower_Arc P
                 by A13,A15,A16,A379,A380,BORSUK_1:83,FUNCT_1:def 5;
           A385:1<=j & j<len h2 by A364,A365,JORDAN3:1;
A386:    g2.(h2.(j+1)) = h0/.(i+1) by A377,A378,A382,FUNCT_1:23;
A387:    h2.(j+1) <= 1 by A16,A380,BORSUK_1:83,TOPREAL5:1;
           A388:h2/.j=h2.j by A385,FINSEQ_4:24;
           A389:h2/.(j+1)=h2.(j+1) by A362,A369,A376,FINSEQ_4:24;
         then reconsider Q1=[.h2/.j,h2/.(j+1).]
                     as Subset of I[01]
                          by A16,A375,A380,A388,BORSUK_1:83,RCOMP_1:16;
         A390:Segment(h0/.i,h0/.(i+1),P) c= g2.:([.h2/.j,h2/.(j+1).])
          proof let x be set;assume
           A391:x in Segment(h0/.i,h0/.(i+1),P);
               h0/.(i+1) <> W-min P
              by A22,A29,A31,A68,A370,A377,A378,A382,FUNCT_1:def 8;
            then x in {p: LE h0/.i,p,P & LE p,h0/.(i+1),P} by A391,Def1;
            then consider p being Point of TOP-REAL 2 such that
            A392:p=x & LE h0/.i,p,P & LE p,h0/.(i+1),P;
       A393:h0/.i in Upper_Arc(P) & p in Lower_Arc(P)& not p=W-min(P) or
            h0/.i in Upper_Arc(P) & p in Upper_Arc(P) &
             LE h0/.i,p,Upper_Arc(P),W-min(P),E-max(P) or
            h0/.i in Lower_Arc(P) & p in Lower_Arc(P)& not p=W-min(P) &
             LE h0/.i,p,Lower_Arc(P),E-max(P),W-min(P)
                                   by A392,JORDAN6:def 10;
              j+1<len h2 by A21,A354,A368,A369,BINARITH:def 3;
            then A394:j<len h2 by NAT_1:38;
              A395:not h0/.(i+1)=E-max(P)
                      by A22,A28,A30,A68,A376,A377,A378,A382,FUNCT_1:def 8;
                A396:h0/.(i+1) in Lower_Arc(P)
                   by A13,A15,A16,A379,A380,A382,BORSUK_1:83,FUNCT_1:def 5;
               now assume h0/.(i+1) in Upper_Arc(P);
              then h0/.(i+1) in Upper_Arc(P)/\ Lower_Arc(P)
                       by A396,XBOOLE_0:def 3;
              then h0/.(i+1) in {W-min(P),E-max(P)} by A1,JORDAN6:def 9;
              then h21.(j+1)=W-min(P) by A377,A382,A395,TARSKI:def 2;
             hence contradiction by A22,A29,A31,A68,A370,A378,FUNCT_1:def 8;
            end;
            then A397:p in Lower_Arc(P) & h0/.(i+1) in Lower_Arc(P)
            & not h0/.(i+1)=W-min(P)
             & LE p,h0/.(i+1),Lower_Arc(P),E-max(P),W-min(P) or
            p in Upper_Arc(P) & h0/.(i+1) in Lower_Arc(P)
                 & not h0/.(i+1)=W-min(P) by A392,JORDAN6:def 10;
                A398:h0/.i<>W-min(P)
                  by A22,A29,A31,A68,A372,A373,A374,A381,A394,FUNCT_1:def 8;
                   dom (g1*h1) c= dom h0 by FINSEQ_1:39;
                then A399: h0/.i=E-max(P) by A36,A354,A355,FINSEQ_4:def 4;
A400:           now assume A401:not p in Lower_Arc(P);
                  then p=E-max(P) by A2,A393,A399,JORDAN6:70;
                 hence contradiction by A1,A401,Th1;
                end;
A402:           now assume p in Upper_Arc(P);
                  then p in Upper_Arc(P)/\ Lower_Arc(P) by A400,XBOOLE_0:def 3
;
then A403:             p in {W-min(P),E-max(P)} by A1,JORDAN6:def 9;
                     p <> W-min P by A2,A393,A398,JORDAN6:69;
                 hence p = E-max P by A403,TARSKI:def 2;
                end;
then A404:           LE p,h0/.(i+1),Lower_Arc P, E-max P, W-min P
                    by A11,A397,JORDAN5C:10;
                   p in rng g2 by A1,A13,A392,A402,Th1,JORDAN6:def 10;
                then consider z being set such that A405:z in dom g2 & p=g2.z
                                 by FUNCT_1:def 5;
                reconsider rz=z as Real by A15,A405;
A406:          g2.(h2/.(j+1))=h0/.(i+1)
                 by A362,A369,A376,A379,A382,FINSEQ_4:24;
                      h2.(j+1) in rng h2 by A378,FUNCT_1:def 5;
              then 0<=rz & rz<=1 & 0<=h2/.(j+1) & h2/.(j+1)<=1
                 by A15,A16,A389,A405,BORSUK_1:83,TOPREAL5:1;
              then rz<=h2/.(j+1)& h2/.j<=rz
                 by A12,A13,A14,A16,A354,A367,A388,A404,A405,A406,Th20,JORDAN3:
1;
             then rz in [.h2/.j,h2/.(j+1).] by TOPREAL5:1;
           hence x in g2.:([.h2/.j,h2/.(j+1).]) by A392,A405,FUNCT_1:def 12;
          end;
            g2.:([.h2/.j,h2/.(j+1).]) c= Segment(h0/.i,h0/.(i+1),P)
          proof let x be set;assume x in g2.:([.h2/.j,h2/.(j+1).]);
            then consider y being set such that
      A407: y in dom g2 & y in [.h2/.j,h2/.(j+1).] & x=g2.y by FUNCT_1:def 12;
            A408:x in Lower_Arc(P) by A13,A407,FUNCT_1:def 5;
            then reconsider p1=x as Point of TOP-REAL 2;
            reconsider sy=y as Real by A407;
             A409:h2/.j<=sy & sy<=h2/.(j+1) by A407,TOPREAL5:1;
             A410:0<=sy & sy<=1 by A15,A407,TOPREAL5:1;
A411:         h2.(j+1) <> 1 by A16,A18,A29,A370,A378,FUNCT_1:def 8;
A412:        now assume p1=W-min(P);
              then 1=sy by A12,A14,A32,A407,FUNCT_1:def 8;
             hence contradiction by A387,A389,A409,A411,AXIOMS:21;
            end;
A413:        h0/.(i+1) <> W-min(P)
                 by A22,A29,A31,A68,A370,A377,A378,A382,FUNCT_1:def 8;
                LE h0/.i,p1,Lower_Arc(P),E-max(P),W-min(P)
                by A11,A12,A13,A14,A355,A381,A407,A410,Th19;
            then A414: LE h0/.i,p1,P by A381,A383,A408,A412,JORDAN6:def 10;
               LE p1,h0/.(i+1),Lower_Arc(P),E-max(P),W-min(P)
                    by A11,A12,A13,A14,A386,A387,A389,A407,A409,A410,Th19;
            then LE p1,h0/.(i+1),P by A382,A384,A408,A413,JORDAN6:def 10;
            then x in {p: LE h0/.i,p,P & LE p,h0/.(i+1),P} by A414;
           hence x in Segment(h0/.i,h0/.(i+1),P) by A413,Def1;
          end;
         then W=g2.:(Q1) by A208,A390,XBOOLE_0:def 10;
        hence diameter(W)<e by A16,A385;
       end;
       end;
       hence diameter(W)<e;
      end;
   thus for W being Subset of Euclid 2 st
       W=Segment(h0/.len h0,h0/.1,P)  holds diameter W < e
      proof let W be Subset of Euclid 2;
       assume
A415:   W=Segment(h0/.len h0,h0/.1,P);
         set i=len h0;
           len h0<=len h11 + len mid(h21,2,len h21 -'1) by FINSEQ_1:35;
        then A416:    h0.i=(mid(h21,2,len h21 -'1)).(i -len h11) by A21,A51,
FINSEQ_1:36;
           A417:i-len h11=i-'len h11 by A21,A52,SCMFSA_7:3;
             A418: i-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                          by FINSEQ_1:35;
              len h1 +1-len h1<=i-len h1 by A48,A49,AXIOMS:22;
           then A419:h0.i=h21.(i-'len h11 +2-'1)
                             by A21,A44,A45,A416,A417,A418,JORDAN3:27;
             A420:i-'len h11+2
              =(len h21-2)+2 by A40,A43,A46,A47,A417,XCMPLX_1:26
             .=len h21;
              0<=i-'len h11 by NAT_1:18;
then A421:      0+2<=i-'len h11 +2 by AXIOMS:24;
then A422:      2-'1<=(i-'len h11 +2-'1) by JORDAN3:5;
             A423: i-'len h11+2<=len h2-2+2 by A23,A40,A43,A46,A47,A417,
XCMPLX_1:26;
           then A424:i-'len h11+2-1<=len h2-1 by REAL_1:49;
           A425:1<=(i-'len h11 +2-'1) & (i-'len h11 +2-'1)<=len h21
                             by A23,A421,A423,Lm1,JORDAN3:5,7;
              len h2<len h2+1 by NAT_1:38;
           then len h2-1<len h2+1-1 by REAL_1:54;
           then A426:i-'len h11+2-1<len h2 by A424,AXIOMS:22;
           A427:i-'len h11+2-'1=i-'len h11+2-1 by A422,Lm1,JORDAN3:1;
           set j=i-'len h11+2-'1;
              len h11+1-len h11<=i-len h11 by A23,A40,A43,A46,A47,A49,AXIOMS:22
;
           then 1<=i-'len h11 by JORDAN3:1;
           then 1+2<=i-'len h11+2 by AXIOMS:24;
           then 1+2-1<=i-'len h11+2-1 by REAL_1:49;
           then A428:1<j by A427,AXIOMS:22;
           A429:j< len h2 by A422,A426,Lm1,JORDAN3:1;
           A430:j+1=i-'len h11+(1+1)-1+1 by A422,Lm1,JORDAN3:1
               .=i-'len h11+(1+1);
           A431:j in dom h2 by A22,A425,FINSEQ_3:27;
           then A432:h0.i=g2.(h2.j) by A419,FUNCT_1:23;
A433:       h2.j in rng h2 by A431,FUNCT_1:def 5;
           then A434:0<=h2.j & h2.j<=1 by A16,BORSUK_1:83,TOPREAL5:1;
           A435:1<j+1 by A422,Lm1,NAT_1:38;
           A436:h0.i in Lower_Arc P
                       by A13,A15,A16,A432,A433,BORSUK_1:83,FUNCT_1:def 5;
A437:      now assume h0.i in Upper_Arc(P);
             then h0.i in Upper_Arc(P)/\ Lower_Arc(P) by A436,XBOOLE_0:def 3;
             then h0.i in {W-min(P),E-max(P)} by A1,JORDAN6:def 9;
             then h0.i=W-min(P) or h0.i=E-max(P) by TARSKI:def 2;
            hence contradiction
            by A22,A28,A29,A30,A31,A68,A419,A428,A429,A431,FUNCT_1:def 8;
           end;
             j+1 in dom h2 by A22,A420,A430,A435,FINSEQ_3:27;
then A438:      h2.(j+1) in rng h2 by FUNCT_1:def 5;
              i in dom h0 by A53,FINSEQ_3:27;
           then A439:h0/.i=h0.i by FINSEQ_4:def 4;
A440:     0 <= h2.j by A16,A433,BORSUK_1:83,TOPREAL5:1;
A441:     h2.j <= 1 by A16,A433,BORSUK_1:83,TOPREAL5:1;
          A442:h2/.j=h2.j by A422,A429,Lm1,FINSEQ_4:24;
          A443:h2/.(j+1)=h2.(j+1) by A423,A430,A435,FINSEQ_4:24;
         then reconsider Q1=[.h2/.j,h2/.(j+1).]
                     as Subset of I[01]
                by A16,A433,A438,A442,BORSUK_1:83,RCOMP_1:16;
         A444:Segment(h0/.i,h0/.1,P) c= g2.:([.h2/.j,h2/.(j+1).])
          proof let x be set;assume
           A445:x in Segment(h0/.i,h0/.1,P);
               h0/.1=W-min(P) by A39,A64,FINSEQ_4:def 4;
            then x in {p: LE h0/.i,p,P or h0/.i in P & p=W-min(P)}
                                      by A445,Def1;
            then consider p being Point of TOP-REAL 2 such that
            A446:p=x & (LE h0/.i,p,P or h0/.i in P & p=W-min(P));
              A447:j<j+1 by NAT_1:38;
              A448:j in dom h2 by A422,A429,Lm1,FINSEQ_3:27;
                 j+1 in dom h2 by A423,A430,A435,FINSEQ_3:27;
              then h2.j<h2.(j+1) by A16,A447,A448,GOBOARD1:def 1;
              then A449:h2/.(j+1) in [.h2/.j,
              h2/.(j+1).] by A442,A443,RCOMP_1:15;
              A450: h2/.(j+1)=1 by A16,A23,A29,A420,A430,FINSEQ_4:def 4;
               now per cases by A446;
            case LE h0/.i,p,P & (p<>W-min(P) or not h0/.i in P);
then A451:h0/.i in Lower_Arc(P) & p in Lower_Arc(P)& not p=W-min(P) &
               LE h0/.i,p,Lower_Arc(P),E-max(P),W-min(P)
                          by A437,A439,JORDAN6:def 10;
                  then consider z being set such that A452:z in dom g2 & p=g2.z
                                   by A13,FUNCT_1:def 5;
                  reconsider rz=z as Real by A15,A452;
              take rz;
A453:               0<=rz & rz<=1 by A15,A452,TOPREAL5:1;
then A454:         h2/.j<=rz
                 by A12,A13,A14,A432,A434,A439,A442,A451,A452,Th20;
             thus rz in dom g2 by A452;
                 rz<=h2/.(j+1) by A16,A22,A420,A430,A443,A453,FINSEQ_3:31;
             hence rz in [.h2/.j,h2/.(j+1).] & x = g2.rz
                         by A446,A452,A454,TOPREAL5:1;
            end;
            case h0/.i in P & p=W-min(P);
             hence ex y being set st y in dom g2 & y in [.h2/.j,h2/.(j+1).]
              & x = g2.y by A14,A32,A446,A449,A450;
            end;
            end;
           hence x in g2.:([.h2/.j,h2/.(j+1).]) by FUNCT_1:def 12;
          end;
            g2.:([.h2/.j,h2/.(j+1).]) c= Segment(h0/.i,h0/.1,P)
          proof let x be set;assume x in g2.:([.h2/.j,h2/.(j+1).]);
            then consider y being set such that
      A455: y in dom g2 & y in [.h2/.j,h2/.(j+1).] & x=g2.y by FUNCT_1:def 12;
            A456:x in Lower_Arc(P) by A13,A455,FUNCT_1:def 5;
            then reconsider p1=x as Point of TOP-REAL 2;
            reconsider sy=y as Real by A455;
             A457:h2/.j<=sy & sy<=h2/.(j+1) by A455,TOPREAL5:1;
             A458:0<=sy & sy<=1 by A15,A455,TOPREAL5:1;
            A459:h0/.1=W-min(P) by A39,A64,FINSEQ_4:def 4;
A460:      Upper_Arc(P) \/ Lower_Arc(P)=P by A1,JORDAN6:def 9;
A461:        LE h0/.i,p1,Lower_Arc(P),E-max(P),W-min(P)
               by A11,A12,A13,A14,A432,A439,A440,A441,A442,A455,A457,A458,Th19;
               now per cases;
            case p1=W-min(P);
             hence LE h0/.i,p1,P or  h0/.i in P & p1=W-min(P)
              by A436,A439,A460,XBOOLE_0:def 2;
            end;
            case p1<>W-min(P);
             hence LE h0/.i,p1,P or  h0/.i in P & p1=W-min(P)
                              by A436,A439,A456,A461,JORDAN6:def 10;
            end;
            end;
            then x in {p: LE h0/.i,p,P or h0/.i in P & p=W-min(P)};
           hence x in Segment(h0/.i,h0/.1,P) by A459,Def1;
          end;
         then W=g2.:Q1 by A415,A444,XBOOLE_0:def 10;
        hence diameter(W)<e by A16,A422,A429,Lm1;
      end;
      A462: for i being Nat st 1<=i & i+1<len h0 holds
         LE h0/.(i+1),h0/.(i+2),P
            proof let i be Nat;assume
            A463: 1<=i & i+1<len h0;
              then A464:i+1+1<=len h0 by NAT_1:38;
              A465:1<i+1 by A463,NAT_1:38;
              then A466:1<i+1+1 by NAT_1:38;
A467:         i+1<i+1+1 by NAT_1:38;
                 now per cases;
              case A468:i+1<len h1;
                then A469:i+1+1<=len h1 by NAT_1:38;
                A470:h0.(i+1)=h11.(i+1) by A21,A465,A468,SCMFSA_7:9;
                A471:i+1 in dom h1 by A465,A468,FINSEQ_3:27;
                then A472:h0.(i+1)=g1.(h1.(i+1)) by A470,FUNCT_1:23;
A473:            h1.(i+1) in rng h1 by A471,FUNCT_1:def 5;
                then A474:0<=h1.(i+1) & h1.(i+1)<=1
                    by A9,BORSUK_1:83,TOPREAL5:1;
                A475:1<i+1+1 by A465,NAT_1:38;
                then A476:h0.(i+1+1)=h11.(i+1+1) by A21,A469,SCMFSA_7:9;
                A477:i+1+1 in dom h1 by A469,A475,FINSEQ_3:27;
                then A478:h0.(i+1+1)=g1.(h1.(i+1+1)) by A476,FUNCT_1:23;
A479:            h1.((i+1)+1) in rng h1 by A477,FUNCT_1:def 5;
then A480:           0<=h1.(i+1+1) by A9,BORSUK_1:83,TOPREAL5:1;
A481:           h1.(i+1+1)<=1 by A9,A479,BORSUK_1:83,TOPREAL5:1;
                A482:h1.(i+1)<h1.(i+1+1) by A9,A467,A471,A477,GOBOARD1:def 1;
                   i+1 in dom h0 by A463,A465,FINSEQ_3:27;
                then A483:h0/.(i+1)=h0.(i+1) by FINSEQ_4:def 4;
                   (i+1)+1 in dom h0 by A464,A475,FINSEQ_3:27;
                then A484:h0/.(i+1+1)=h0.(i+1+1) by FINSEQ_4:def 4;
                g1.(h1.(i+1)) in rng g1
                     by A6,A9,A473,BORSUK_1:83,FUNCT_1:def 5;
then A485:           h0/.(i+1) in Upper_Arc P
                       by A4,A470,A471,A483,FUNCT_1:23;
A486:           h0/.(i+1+1) in Upper_Arc P
                      by A4,A6,A9,A478,A479,A484,BORSUK_1:83,FUNCT_1:def 5;
                   LE h0/.(i+1),h0/.((i+1)+1),Upper_Arc(P),W-min(P),E-max(P)
                by A2,A3,A4,A5,A472,A474,A478,A480,A481,A482,A483,A484,Th19;
               hence thesis by A485,A486,JORDAN6:def 10;
              end;
              case
A487:          i+1>=len h1;
                   now per cases by A487,REAL_1:def 5;
                case A488:i+1>len h1;
                  then A489:len h1 +1<=i+1 by NAT_1:38;
A490:             len h11+1<=i+1 by A21,A488,NAT_1:38;
A491:             i+1<=len h11 + len (mid(h21,2,len h21 -'1))
                                by A463,FINSEQ_1:35;
                  then A492:h0.(i+1)=(mid(h21,2,len h21 -'1)).((i+1) -len h11)
                                               by A490,FINSEQ_1:36;
                  A493:(i+1)-len h11=(i+1)-'len h11 by A21,A488,SCMFSA_7:3;
                    A494: (i+1)-len h11<=len h11 + len (mid(h21,2,len h21 -'1))
-len
h11
                                         by A491,REAL_1:49;
                     len h1 +1-len h1<=(i+1)-len h1 by A489,REAL_1:49;
                  then A495:h0.(i+1)=h21.((i+1)-'len h11 +2-'1)
                             by A21,A44,A45,A492,A493,A494,JORDAN3:27;
                  A496:len h1 +1<=(i+1)+1 by A489,NAT_1:38;
                  then A497:h0.((i+1)+1)=(mid(h21,2,len h21 -'1)).((i+1)+1 -len
h11)
                                      by A21,A40,A464,FINSEQ_1:36;
                     (i+1)+1>len h11 by A21,A488,NAT_1:38;
                  then A498:(i+1)+1-len h11=(i+1)+1-'len h11 by SCMFSA_7:3;
A499:             (i+1)+1-len h11
                      <=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                         by A40,A464,REAL_1:49;
                    A500: len h1 +1-len h1<=(i+1)+1-len h1 by A496,REAL_1:49;
                  then A501:h0.((i+1)+1)=h21.((i+1)+1-'len h11 +2-'1)
                    by A21,A44,A45,A497,A498,A499,JORDAN3:27;
                     1<(i+1)+1-'len h11+(2-1) by A21,A498,A500,NAT_1:38;
then A502:             0<(i+1)+1-'len h11+2-1 by AXIOMS:22;
                     0<=(i+1)-'len h11 by NAT_1:18;
then A503:             0+2<=(i+1)-'len h11 +2 by AXIOMS:24;
then A504:             2-'1<=((i+1)-'len h11 +2-'1) by JORDAN3:5;
                     (i+1)-len h11<=len h1+(len h2-2)-len h11
                             by A21,A23,A40,A43,A46,A47,A463,REAL_1:49;
                  then A505: (i+1)-'len h11+2<=len h2-2+2 by A21,A493,AXIOMS:24
;
                  then A506:1<=((i+1)-'len h11 +2-'1)
                            & ((i+1)-'len h11 +2-'1)<=len h21
                                    by A23,A503,Lm1,JORDAN3:5,7;
                  A507:(i+1)-'len h11+2-'1=(i+1)-'len h11+2-1
                                      by A504,Lm1,JORDAN3:1;
                  set j=(i+1)-'len h11+2-'1;
                     (i+1)-len h11<len h11+(len h2-2)-len h11
                                     by A23,A40,A43,A46,A47,A463,REAL_1:54;
                  then A508: (i+1)-len h11+2<len h2-2+2 by REAL_1:53;
                A509:j+1=(i+1)-'len h11+(1+1)-1+1 by A504,Lm1,JORDAN3:1
                  .=(i+1)-'len h11+2;
                  A510:j+1=1+((i+1)-len h11+(2-1)) by A493,A507
                  .=(i+1)+1-len h11+2-1
                  .=(i+1)+1-'len h11+2-'1 by A498,A502,BINARITH:def 3;
A511:             j in dom h2 by A22,A506,FINSEQ_3:27;
                  then A512:h0.(i+1)=g2.(h2.j) by A495,FUNCT_1:23;
A513:              h2.j in rng h2 by A511,FUNCT_1:def 5;
                  then A514:0<=h2.j & h2.j<=1 by A16,BORSUK_1:83,TOPREAL5:1;
                  A515:j<j+1 by NAT_1:38;
                    1<j+1 by A504,Lm1,NAT_1:38;
                  then A516:j+1 in dom h2 by A505,A509,FINSEQ_3:27;
                  then A517:h0.((i+1)+1)=g2.(h2.(j+1))
                     & h21.(j+1)=g2.(h2.(j+1))  by A501,A510,FUNCT_1:23;
A518:              h2.(j+1) in rng h2 by A516,FUNCT_1:def 5;
                  A519:h2.j<h2.(j+1) by A16,A511,A515,A516,GOBOARD1:def 1;
                     i+1 in dom h0 by A463,A465,FINSEQ_3:27;
                  then A520:h0/.(i+1)=h0.(i+1) by FINSEQ_4:def 4;
                     (i+1)+1 in dom h0 by A464,A466,FINSEQ_3:27;
                  then A521:h0/.((i+1)+1)=h0.((i+1)+1) by FINSEQ_4:def 4;
                  A522:h0.(i+1) in Lower_Arc(P)
                     by A13,A15,A16,A512,A513,BORSUK_1:83,FUNCT_1:def 5;
                  A523:h0.((i+1)+1) in Lower_Arc(P)
                   by A13,A15,A16,A517,A518,BORSUK_1:83,FUNCT_1:def 5;
A524: 0 <= (h2.(j+1)) by A16,A518,BORSUK_1:83,TOPREAL5:1;
A525: (h2.(j+1)) <= 1 by A16,A518,BORSUK_1:83,TOPREAL5:1;
A526:            h0/.(i+1+1) <> W-min P
           by A22,A29,A31,A68,A493,A501,A508,A509,A510,A516,A521,FUNCT_1:def 8;
                   LE h0/.(i+1),h0/.((i+1)+1),Lower_Arc(P),E-max(P),W-min(P)
                             by A11,A12,A13,A14,A512,A514,A517,A519,A520,A521,
A524,A525,Th19;
                 hence thesis by A520,A521,A522,A523,A526,JORDAN6:def 10;
                end;
                case A527:i+1=len h1;
                  then A528:h0.len h1 =E-max(P) by A21,A37,A465,SCMFSA_7:9;
                  A529:len h1-len h11=len h1-'len h11 by A21,SCMFSA_7:3;
A530:             len h1+1 <=len h11 + len (mid(h21,2,len h21 -'1))
                                          by A464,A527,FINSEQ_1:35;
                  A531:h0.((i+1)+1)=(mid(h21,2,len h21 -'1)).((i+1)+1 -len h11)
                                      by A21,A40,A464,A527,FINSEQ_1:36;
                  A532:(i+1)+1-len h11=(i+1)+1-'len h11
                                by A21,A467,A527,SCMFSA_7:3;
               (i+1)+1-len h11
                       <=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                         by A527,A530,REAL_1:49;
                  then A533:1<=(i+1)+1-'len h11
                         & (i+1)+1-'len h11<=len mid(h21,2,len h21 -'1)
                             by A21,A467,A527,SCMFSA_7:3;
                  then A534:h0.((i+1)+1)=h21.((i+1)+1-'len h11 +2-'1)
                    by A44,A45,A531,A532,JORDAN3:27;
                     1<(i+1)+1-'len h11+(2-1) by A533,NAT_1:38;
                  then A535: 0<(i+1)+1-'len h11+2-1 by AXIOMS:22;
                     0<=(i+1)-'len h11 by NAT_1:18;
                  then 0+2<=(i+1)-'len h11 +2 by AXIOMS:24;
                  then A536:2-'1<=((i+1)-'len h11 +2-'1) by JORDAN3:5;
                     (i+1)-len h11<=len h1+(len h2-2)-len h11
                               by A21,A23,A40,A43,A46,A47,A463,REAL_1:49;
                  then A537: (i+1)-'len h11+2<=len h2-2+2 by A21,A527,A529,
AXIOMS:24;
                  set j=(i+1)-'len h11+2-'1;
                     (i+1)-len h11<len h11+(len h2-2)-len h11
                  by A23,A40,A43,A46,A47,A463,REAL_1:54;
                  then A538: (i+1)-len h11+2<len h2-2+2 by REAL_1:53;
                  A539:j+1=(i+1)-'len h11+(1+1)-1+1 by A536,Lm1,JORDAN3:1
                  .=(i+1)-'len h11+(1+1);
                  then A540:j+1<len h2 by A21,A527,A538,BINARITH:def 3;
                  A541:j+1=(i+1)-len h11+2-1+1 by A21,A527,Lm1,BINARITH:def 3
                  .=(i+1)+1-len h11+(2-1)
                  .=(i+1)+1-'len h11+2-'1 by A532,A535,BINARITH:def 3;
                    1<j+1 by A536,Lm1,NAT_1:38;
                  then A542:j+1 in dom h2 by A537,A539,FINSEQ_3:27;
                  then A543:h0.((i+1)+1)=g2.(h2.(j+1))
                         & h21.(j+1)=g2.(h2.(j+1)) by A534,A541,FUNCT_1:23;
A544:             h2.(j+1) in rng h2 by A542,FUNCT_1:def 5;
                     len h1 in dom h0 by A463,A465,A527,FINSEQ_3:27;
                  then A545:h0/.len h1=h0.len h1 by FINSEQ_4:def 4;
                     (i+1)+1 in dom h0 by A464,A466,FINSEQ_3:27;
                  then A546:h0/.((i+1)+1)=h0.((i+1)+1) by FINSEQ_4:def 4;
                  A547:h0.(i+1+1) in Lower_Arc P
                        by A13,A15,A16,A543,A544,BORSUK_1:83,FUNCT_1:def 5;
                  A548: h0.(i+1) in Upper_Arc(P) by A1,A527,A528,Th1;
A549:             h0/.(i+1+1) <> W-min P
                    by A22,A29,A31,A68,A534,A540,A541,A542,A546,FUNCT_1:def 8;
                     i+1+1=i+2;
                 hence thesis by A527,A545,A546,A547,A548,A549,JORDAN6:def 10;
                end;
                end;
               hence thesis;
              end;
              end;
             hence thesis;
            end;
      A550: for i being Nat st 1<=i & i+1<=len h0 holds
         LE h0/.i,h0/.(i+1),P & h0/.(i+1)<>W-min(P) & h0/.i<>h0/.(i+1)
       proof let i be Nat such that
A551:    1<=i and
A552:    i+1<=len h0;
A553:    1<i+1 by A551,NAT_1:38;
A554:    i<len h0 by A552,NAT_1:38;
A555:    i<i+1 by NAT_1:38;
            i in dom h0 by A551,A554,FINSEQ_3:27;
then A556:    h0/.i=h0.i by FINSEQ_4:def 4;
                   i+1 in dom h0 by A552,A553,FINSEQ_3:27;
then A557:    h0/.(i+1)=h0.(i+1) by FINSEQ_4:def 4;
                now per cases;
              case A558:i<len h1;
                then A559:i+1<=len h1 by NAT_1:38;
                A560:h0.i=h11.i by A21,A551,A558,SCMFSA_7:9;
                A561:i in dom h1 by A551,A558,FINSEQ_3:27;
then A562:            h1.i in rng h1 by FUNCT_1:def 5;
                A563:h0.(i+1)=h11.(i+1) by A21,A553,A559,SCMFSA_7:9;
                A564:i+1 in dom h1 by A553,A559,FINSEQ_3:27;
                then A565:h0.(i+1)=g1.(h1.(i+1)) by A563,FUNCT_1:23;
A566:            h1.(i+1) in rng h1 by A564,FUNCT_1:def 5;
                A567:h1.i<h1.(i+1) by A9,A555,A561,A564,GOBOARD1:def 1;
                  g1.(h1.i) in rng g1
                        by A6,A9,A562,BORSUK_1:83,FUNCT_1:def 5;
                then A568:h0.i in Upper_Arc(P) by A4,A560,A561,FUNCT_1:23;
           A569:h0.(i+1) in Upper_Arc(P)
                  by A4,A6,A9,A565,A566,BORSUK_1:83,FUNCT_1:def 5;
A570: g1.(h1.i) = h0/.i by A556,A560,A561,FUNCT_1:23;
A571: 0 <= (h1.i) by A9,A562,BORSUK_1:83,TOPREAL5:1;
A572: (h1.i) <= 1 by A9,A562,BORSUK_1:83,TOPREAL5:1;
A573: 0 <= (h1.(i+1)) by A9,A566,BORSUK_1:83,TOPREAL5:1;
A574: (h1.(i+1)) <= 1 by A9,A566,BORSUK_1:83,TOPREAL5:1;
     A575: i+1 <> 1 by A551,NAT_1:38;
    A576: i+1 <> i by NAT_1:38;
                   LE h0/.i,h0/.(i+1),Upper_Arc(P),W-min(P),E-max(P)
                    by A2,A3,A4,A5,A557,A565,A567,A570,A571,A572,A573,A574,Th19
;
               hence thesis by A20,A25,A38,A67,A556,A557,A560,A561,A563,A564,
A568,A569,A575,A576,FUNCT_1:def 8,JORDAN6:def 10;
              end;
              case
A577:          i>=len h1;
                   now per cases by A577,REAL_1:def 5;
                case A578:i>len h1;
                  then A579:len h1 +1<=i by NAT_1:38;
                  A580:len h11+1<=i & i<=len h11 + len (mid(h21,2,len h21 -'1))
                                      by A21,A554,A578,FINSEQ_1:35,NAT_1:38;
                                          then A581:             h0.i=(mid(h21,
2,len h21 -'1)).(i -len h11) by FINSEQ_1:36;
                  A582:i-len h11=i-'len h11 by A21,A578,SCMFSA_7:3;
A583:             i-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                         by A580,REAL_1:49;
                     len h1 +1-len h1<=i-len h1 by A579,REAL_1:49;
                  then A584:h0.i=h21.(i-'len h11 +2-'1)
                             by A21,A44,A45,A581,A582,A583,JORDAN3:27;
                  A585:len h1 +1<=i+1 by A579,NAT_1:38;
                  then A586:h0.(i+1)=(mid(h21,2,len h21 -'1)).(i+1 -len h11)
                                      by A21,A40,A552,FINSEQ_1:36;
                     i+1>len h11 by A21,A578,NAT_1:38;
                  then A587:i+1-len h11=i+1-'len h11 by SCMFSA_7:3;
A588:             i+1-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                         by A40,A552,REAL_1:49;
                    A589: len h1 +1-len h1<=i+1-len h1 by A585,REAL_1:49;
                  then A590:h0.(i+1)=h21.(i+1-'len h11 +2-'1)
                    by A21,A44,A45,A586,A587,A588,JORDAN3:27;
                     1<i+1-'len h11+(2-1) by A21,A587,A589,NAT_1:38;
                  then A591: 0<i+1-'len h11+2-1 by AXIOMS:22;
                     0<=i-'len h11 by NAT_1:18;
then A592:             0+2<=i-'len h11 +2 by AXIOMS:24;
then A593:             2-'1<=(i-'len h11 +2-'1) by JORDAN3:5;
                     i-len h11<=len h1+(len h2-2)-len h11
                                      by A21,A23,A40,A43,A46,A47,A554,REAL_1:49
;
                  then A594: i-'len h11+2<=len h2-2+2 by A21,A582,AXIOMS:24;
A595:             1<=i-'len h11 +2-'1 by A592,Lm1,JORDAN3:5;
A596:             i-'len h11 +2-'1<=len h21 by A23,A594,JORDAN3:7;
                  set j=i-'len h11+2-'1;
                     i-len h11<len h11+(len h2-2)-len h11
                                  by A23,A40,A43,A46,A47,A554,REAL_1:54;
then A597:             i-len h11+2<len h2-2+2 by REAL_1:53;
                    A598: j+1=i-'len h11+(1+1)-1+1 by A593,Lm1,JORDAN3:1
                  .=i-'len h11+(1+1);
                  A599:j+1=i-len h11+2-1+1 by A582,A593,Lm1,JORDAN3:1
                  .=i+1-len h11+(2-1)
                  .=i+1-'len h11+2-'1 by A587,A591,BINARITH:def 3;
                  A600:j in dom h2 by A22,A595,A596,FINSEQ_3:27;
                  then A601:h0.i=g2.(h2.j) by A584,FUNCT_1:23;
A602:              h2.j in rng h2 by A600,FUNCT_1:def 5;
                  A603:j<j+1 by NAT_1:38;
                    1<j+1 by A595,NAT_1:38;
                  then A604:j+1 in dom h2 by A582,A597,A598,FINSEQ_3:27;
                  then A605:h0.(i+1)=g2.(h2.(j+1))
                     & h21.(j+1)=g2.(h2.(j+1))  by A590,A599,FUNCT_1:23;
A606:              h2.(j+1) in rng h2 by A604,FUNCT_1:def 5;
A607:          h2.j<h2.(j+1) by A16,A600,A603,A604,GOBOARD1:def 1;
                     i in dom h0 by A551,A554,FINSEQ_3:27;
                  then A608:h0/.i=h0.i by FINSEQ_4:def 4;
                     i+1 in dom h0 by A552,A553,FINSEQ_3:27;
                  then A609:h0/.(i+1)=h0.(i+1) by FINSEQ_4:def 4;
A610: 0 <= (h2.j) by A16,A602,BORSUK_1:83,TOPREAL5:1;
A611: (h2.j) <= 1 by A16,A602,BORSUK_1:83,TOPREAL5:1;
A612: 0 <= (h2.(j+1)) by A16,A606,BORSUK_1:83,TOPREAL5:1;
A613: (h2.(j+1)) <= 1 by A16,A606,BORSUK_1:83,TOPREAL5:1;
A614:           h0/.(i+1) <> W-min P
                by A22,A29,A31,A68,A582,A590,A597,A598,A599,A604,A609,FUNCT_1:
def 8;
                A615: j < j+1 by NAT_1:38;
                   h0/.i in Lower_Arc(P) & h0/.(i+1) in Lower_Arc(P)
                   & LE h0/.i,h0/.(i+1),Lower_Arc(P),E-max(P),W-min(P)
                                             by A11,A12,A13,A14,A15,A16,A601,
A602,A605,A606,A607,A608,A609,A610,A611,A612,A613,Th19,BORSUK_1:83,FUNCT_1:def
5;
                 hence thesis by A22,A68,A584,A590,A599,A600,A604,A608,A609,
A614,A615,FUNCT_1:def 8,JORDAN6:def 10;
                end;
                case A616:i=len h1;
                  then A617:h0.i=E-max(P) by A21,A37,A551,SCMFSA_7:9;
                  A618:i-len h11=i-'len h11 by A21,A616,SCMFSA_7:3;
A619:             i+1 <=len h11 + len (mid(h21,2,len h21 -'1))
                                          by A552,FINSEQ_1:35;
                  A620:h0.(i+1)=(mid(h21,2,len h21 -'1)).(i+1 -len h11)
                                      by A21,A40,A552,A616,FINSEQ_1:36;
                  A621:i+1-len h11=i+1-'len h11 by A21,A555,A616,SCMFSA_7:3;
A622:             i+1-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                         by A619,REAL_1:49;
A623:              1<=i+1-'len h11 by A21,A616,A621,XCMPLX_1:26;
                  then A624:h0.(i+1)=h21.(i+1-'len h11 +2-'1)
                    by A44,A45,A620,A621,A622,JORDAN3:27;
                     1<i+1-'len h11+(2-1) by A623,NAT_1:38;
                  then A625: 0<i+1-'len h11+2-1 by AXIOMS:22;
                     0<=i-'len h11 by NAT_1:18;
                  then A626: 0+2<=i-'len h11 +2 by AXIOMS:24;
                  then A627:2-'1<=(i-'len h11 +2-'1) by JORDAN3:5;
                     i-len h11<=len h1+(len h2-2)-len h11 by A21,A23,A40,A43,
A46,A47,A554,REAL_1:49;
then A628:              i-'len h11+2<=len h2-2+2 by A21,A618,AXIOMS:24;
                  then A629:1<=(i-'len h11 +2-'1) & (i-'len h11 +2-'1)<=len h21
                                    by A23,A626,Lm1,JORDAN3:5,7;
                  set j=i-'len h11+2-'1;
                   len h1-'len h11=len h11-len h11 by A21,BINARITH:def 3;
                               then A630:             0+2-1=len h1-'len h11+2-1
;
                     i-len h11<len h11+(len h2-2)-len h11
                                  by A23,A40,A43,A46,A47,A554,REAL_1:54;
                  then A631: i-len h11+2<len h2-2+2 by REAL_1:53;
                  A632:j+1=i-'len h11+(1+1)-1+1 by A627,Lm1,JORDAN3:1
                  .=i-'len h11+2;
                  then A633:j+1<len h2 by A21,A616,A631,BINARITH:def 3;
                  A634:j+1=i-len h11+2-1+1 by A21,A616,Lm1,BINARITH:def 3
                  .=i+1-len h11+(2-1)
                  .=i+1-'len h11+2-'1 by A621,A625,BINARITH:def 3;
                  A635:j in dom h2 by A22,A629,FINSEQ_3:27;
                  then A636:h21.j=g2.(h2.j) by FUNCT_1:23;
                  A637:h0.i=g2.(h2.j) by A14,A16,A616,A617,A630,JORDAN3:1;
                    1<j+1 by A627,Lm1,NAT_1:38;
                  then A638:j+1 in dom h2 by A628,A632,FINSEQ_3:27;
                  then A639:h0.(i+1)=g2.(h2.(j+1)) by A624,A634,FUNCT_1:23;
A640:             h2.(j+1) in rng h2 by A638,FUNCT_1:def 5;
                     i in dom h0 by A551,A554,FINSEQ_3:27;
                  then A641:h0/.i=h0.i by FINSEQ_4:def 4;
                     i+1 in dom h0 by A552,A553,FINSEQ_3:27;
                  then A642:h0/.(i+1)=h0.(i+1) by FINSEQ_4:def 4;
                  A643:h0.(i+1) in Lower_Arc(P)
                         by A13,A15,A16,A639,A640,BORSUK_1:83,FUNCT_1:def 5;
                  A644: h0.i in Upper_Arc(P) by A1,A617,Th1;
A645:            h0/.(i+1) <> W-min P
                 by A22,A29,A31,A68,A624,A633,A634,A638,A642,FUNCT_1:def 8;
                    j+1 <> j by NAT_1:38;
                 hence thesis
                 by A22,A68,A624,A634,A635,A636,A637,A638,A641,A642,A643,A644,
A645,FUNCT_1:def 8,JORDAN6:def 10;
                end;
                end;
               hence thesis;
              end;
              end;
             hence thesis;
       end;
   thus for i being Nat st 1<=i & i+1<len h0 holds
         Segment(h0/.i,h0/.(i+1),P)/\ Segment(h0/.(i+1),h0/.(i+2),P)
         ={h0/.(i+1)}
      proof let i be Nat;assume
        A646: 1<=i & i+1<len h0;
then A647:LE h0/.i,h0/.(i+1),P & h0/.(i+1)<>W-min(P) & h0/.i<>h0/.(i+1)
             by A550;
        A648: LE h0/.(i+1),h0/.(i+2),P by A462,A646;
        then h0/.i<>h0/.(i+2) by A1,A647,JORDAN6:72;
        hence Segment(h0/.i,h0/.(i+1),P)/\ Segment(h0/.(i+1),h0/.(i+2),P)
         ={h0/.(i+1)} by A1,A647,A648,Th10;
      end;
   thus Segment(h0/.len h0,h0/.1,P)/\ Segment(h0/.1,h0/.2,P)={h0/.1}
    proof A649: h11.2 <> W-min(P) by A20,A25,A38,A60,A67,FUNCT_1:def 8;
                A650:h0.2=g1.(h1.2) by A60,A63,FUNCT_1:23;
A651:           h1.2 in rng h1 by A60,FUNCT_1:def 5;
                A652:h0/.2=h0.2 by A62,FINSEQ_4:def 4;
then A653:     h0/.2 in Upper_Arc P
               by A4,A6,A9,A650,A651,BORSUK_1:83,FUNCT_1:def 5;
                   A654: len h1 +1-len h1<=len h0 -len h1 by A48,A49,AXIOMS:22;
                  A655:h0.len h0=(mid(h21,2,len h21 -'1)).(len h0 -len h11)
                                   by A21,A40,A51,FINSEQ_1:36;
                  len h0 -len h11 <=len h11 + len mid(h21,2,len h21 -'1) -len
h11
                                         by FINSEQ_1:35;
                  then A656:h0.len h0=h21.(len h0-'len h11 +2-'1)
                    by A21,A44,A45,A57,A654,A655,JORDAN3:27;
                     0<=len h0-'len h11 by NAT_1:18;
then A657:             0+2<=len h0-'len h11 +2 by AXIOMS:24;
                     len h0-'len h11+2<=len h2-2+2
                              by A23,A40,A43,A46,A47,A57,XCMPLX_1:26;
                  then A658:1<=(len h0-'len h11 +2-'1)
                     & (len h0-'len h11 +2-'1)<=len h21
                                    by A23,A657,Lm1,JORDAN3:5,7;
                  set j=len h0-'len h11+2-'1;
                  A659:j in dom h2 by A22,A658,FINSEQ_3:27;
                  then A660:h0.len h0=g2.(h2.j) by A656,FUNCT_1:23;
            A661: now assume A662:h0/.2=h0/.len h0;
                     h2.j in rng h2 by A659,FUNCT_1:def 5;
                then g2.(h2.j) in rng g2 by A15,A16,BORSUK_1:83,FUNCT_1:def 5;
                then h0/.2 in Upper_Arc(P)/\  Lower_Arc(P)
                     by A13,A55,A653,A660,A662,XBOOLE_0:def 3;
                then h0/.2 in {W-min(P),E-max(P)} by A1,JORDAN6:def 9;
                then h11.2=E-max(P) by A63,A649,A652,TARSKI:def 2;
             hence contradiction by A20,A35,A37,A59,A60,A67,FUNCT_1:def 8;
            end;
      defpred P[Nat] means
      $1+2<=len h0 implies LE h0/.2,h0/.($1+2),P;
           Upper_Arc(P) \/ Lower_Arc(P)= P by A1,JORDAN6:65;
        then h0/.2 in P by A653,XBOOLE_0:def 2;
        then A663: P[0] by A1,JORDAN6:71;
        A664:for k being Nat st P[k] holds P[k+1]
         proof let k be Nat;assume
          A665: k+2<=len h0 implies LE h0/.2,h0/.(k+2),P;
              now assume A666:k+1+2<=len h0;
             A667:k+1+2=k+2+1;
             then A668:k+2<len h0 by A666,NAT_1:38;
             A669:1<=1+k by NAT_1:29;
                k+1+1=k+2;
             then LE h0/.(k+2),h0/.(k+2+1),P by A462,A667,A668,A669;
            hence LE h0/.2,h0/.(k+1+2),P
             by A1,A665,A666,JORDAN6:73,NAT_1:38;
           end;
          hence (k+1+2<=len h0 implies LE h0/.2,h0/.(k+1+2),P);
         end;
        A670:for i being Nat holds P[i]
            from NAT_1:sch 1(A663,A664);
               len h0 -'2=len h0-2 by A61,SCMFSA_7:3;
            then len h0-'2+2=len h0;
           then LE h0/.2,h0/.len h0,P & h0/.2<>h0/.len h0
                         & h0/.2<>W-min(P) by A62,A63,A649,A661,A670,FINSEQ_4:
def 4;
       hence thesis by A1,A66,Th12;
      end;
      set i = len h0-'1;
A671:    i+1 = len h0 by A53,AMI_5:4;
A672:    1<=i by A61,Lm3;
      A673: len h0 > 1+1+1 by A21,A23,A40,A43,A46,A47,A127,AXIOMS:22;
      then A674:   len h0-'1 > 1+1 by Lm2;
A675:  i<len h0 by A53,JORDAN5B:1;
then A676:   i in dom h0 by A672,FINSEQ_3:27;
then A677:h0/.i=h0.i by FINSEQ_4:def 4;
        A678:i+1<=len h0 by A675,NAT_1:38;
        A679:1+1<=len h0 by A53,NAT_1:38;
        A680:LE h0/.i,h0/.(i+1),P by A550,A672,A678;
        A681:LE h0/.1,h0/.(1+1),P by A550,A679;
             1+1 in dom h0 by A679,FINSEQ_3:27;
then A682:h0/.(1+1)=h0.(1+1) by FINSEQ_4:def 4;
        A683:h0/.1<>h0/.(1+1) by A550,A679;
        A684:h0.(1+1)=h11.(1+1) by A21,A59,SCMFSA_7:9;
        A685: 1+1 in dom h1 by A59,FINSEQ_3:27;
        then A686:h0.(1+1)=g1.(h1.(1+1)) by A684,FUNCT_1:23;
A687:    h1.(1+1) in rng h1 by A685,FUNCT_1:def 5;
        A688:1<i by A674,AXIOMS:22;
A689:  now per cases;
               case A690:i<=len h1;
                then A691:h0.i=h11.i by A21,A688,SCMFSA_7:9;
        A692:i in dom h1 by A688,A690,FINSEQ_3:27;
        then A693:h1.(1+1)<h1.i by A9,A674,A685,GOBOARD1:def 1;
A694:    h1.i in rng h1 by A692,FUNCT_1:def 5;
                A695:h0.i=g1.(h1.i) by A691,A692,FUNCT_1:23;
        A696:0<=h1.i & h1.i<=1 by A9,A694,BORSUK_1:83,TOPREAL5:1;
              0 <= h1.(1+1) & h1.(1+1) <= 1 by A9,A687,BORSUK_1:83,TOPREAL5:1;
                then h0/.(1+1) in Upper_Arc(P) & h0/.i in Upper_Arc(P) &
                LE h0/.(1+1),h0/.i,Upper_Arc(P),W-min(P),E-max(P)
                  by A2,A3,A4,A5,A6,A9,A677,A682,A686,A687,A693,A694,A695,A696,
Th19,BORSUK_1:83,FUNCT_1:def 5;
               hence LE h0/.(1+1),h0/.i,P by JORDAN6:def 10;
               end;
               case A697:i>len h1;
                  then A698:i-len h11=i-'len h11 by A21,SCMFSA_7:3;
                     i-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                        by A40,A675,REAL_1:49;
then A699:0<=i-'len h11
                      & i-'len h11<=len mid(h21,2,len h21 -'1)
                             by A21,A697,A698,SQUARE_1:12;
                    A700: i-len h11
                       <=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                by A40,A675,REAL_1:49;
                   0+1<=i-'len h11+1+1-1 by A699,AXIOMS:24;
                  then A701:i-'len h11+2-'1=i-'len h11+2-1 by JORDAN3:1;
                     0<=i-'len h11 by NAT_1:18;
                  then 0+2<=i-'len h11 +2 by AXIOMS:24;
                  then A702:2-'1<=(i-'len h11 +2-'1) by JORDAN3:5;
                     i-len h11<=len h1+(len h2-2)-len h11 by A21,A23,A40,A43,
A46,A47,A675,REAL_1:49;
                  then i-'len h11+2<=len h2-2+2 by A21,A698,AXIOMS:24;
then i-'len h11 +2-'1<=len h21 by A23,JORDAN3:7;
then A703:           (i-'len h11 +2-'1) in dom h21 by A702,Lm1,FINSEQ_3:27;
                1+1 in dom h1 by A59,FINSEQ_3:27;
                  then A704: h11.(1+1)=g1.(h1.(1+1)) by FUNCT_1:23;
                  A705:len h1 +1<=i by A697,NAT_1:38;
                  then A706:h0.i=(mid(h21,2,len h21 -'1)).(i -len h11)
                                      by A21,A40,A675,FINSEQ_1:36;
                    A707: len h1 +1-len h1<=i-len h1 by A705,REAL_1:49;
                  then A708: 1<=i-len h11 by A20,FINSEQ_3:31;
                  A709:h0.(i)=h21.(i-'len h11 +2-'1)
                    by A21,A44,A45,A698,A700,A706,A707,JORDAN3:27;
                     i+1-1<=len h1+(len h2-2)-1 by A21,A23,A40,A43,A46,A47,A678
,REAL_1:49;
                  then i-len h11<=len h1+((len h2-2)-1)-len h11 by REAL_1:49;
                  then i-'len h11+2<=len h2-2-1+2 by A21,A698,AXIOMS:24;
                  then A710:i-'len h11+2-1<=len h2-1-1 by REAL_1:49;
                  set k=i-'len h11+2-'1;
                  A711: h2.k in rng h2 by A22,A703,FUNCT_1:def 5;
                  A712: h1.(1+1) in rng h1 by A60,FUNCT_1:def 5;
                  A713:h0.i=h21.k by A44,A45,A698,A700,A706,A708,JORDAN3:27;
                  A714:h0.i=g2.(h2.k)
                         & h21.k=g2.(h2.k) by A22,A703,A709,FUNCT_1:23;
A715:g1.(h1.(1+1)) in rng g1 by A6,A9,A712,BORSUK_1:83,FUNCT_1:def 5;
                  A716:h0.i in Lower_Arc(P)
                  by A13,A15,A16,A711,A714,BORSUK_1:83,FUNCT_1:def 5;
                     h0/.i <> W-min P
              by A17,A22,A29,A31,A68,A677,A701,A703,A710,A713,FUNCT_1:def 8;
                 hence LE h0/.(1+1),h0/.i,P
                 by A4,A677,A682,A684,A704,A715,A716,JORDAN6:def 10;
               end;
               end;
   thus Segment(h0/.(len h0-' 1),h0/.len h0,P)/\ Segment(h0/.len h0,h0/.1,P)
               ={h0/.len h0}
      proof
A717:LE h0/.i,h0/.(i+1),P & h0/.(i+1)<>W-min(P) & h0/.i<>h0/.(i+1)
             by A550,A671,A672;
         i <> 1 by A673,Lm2;
      then h0/.i <> h0/.1 by A64,A69,A676,PARTFUN2:17;

       hence
            Segment(h0/.i,h0/.len h0,P)/\ Segment(h0/.len h0,h0/.1,P)={h0/.len
h0
}
          by A1,A66,A671,A717,Th11;
      end;
            now
             now assume A718:h0/.(1+1)=h0/.i;
               now
                A719:1+1 in dom h1 by A59,FINSEQ_3:27;
                then A720: h1.(1+1) in rng h1 by FUNCT_1:def 5;
                A721:h0.(1+1)=h11.(1+1) by A21,A59,SCMFSA_7:9;
                then h0.(1+1)=g1.(h1.(1+1)) by A719,FUNCT_1:23;
          then A722:h0.(1+1) in Upper_Arc(P) by A4,A6,A9,A720,BORSUK_1:83,
FUNCT_1:def 5;
                now
             per cases;
             case A723:i<=len h1;
                then A724:h0.i=h11.i by A21,A672,SCMFSA_7:9;
                   i in dom h1 by A672,A723,FINSEQ_3:27;
              hence contradiction
               by A20,A67,A674,A677,A682,A718,A719,A721,A724,FUNCT_1:def 8;
             end;
             case A725:i>len h1;
                  then A726:len h1 +1<=i by NAT_1:38;
then A727:     h0.i=(mid(h21,2,len h21 -'1)).(i -len h11)
                  by A21,A40,A675,FINSEQ_1:36;
                  A728:i-len h11=i-'len h11 by A21,A725,SCMFSA_7:3;
                    A729: i-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len
h11
                                         by A40,A675,REAL_1:49;
                     len h1 +1-len h1<=i-len h1 by A726,REAL_1:49;
                  then A730:h0.i=h21.(i-'len h11 +2-'1)
                             by A21,A44,A45,A727,A728,A729,JORDAN3:27;
                     0<=i-'len h11 by NAT_1:18;
                  then A731: 0+2<=i-'len h11 +2 by AXIOMS:24;
                  then A732:2-'1<=(i-'len h11 +2-'1) by JORDAN3:5;
                     i-len h11<=len h1+(len h2-2)-len h11
                    by A21,A23,A40,A43,A46,A47,A675,REAL_1:49;
                  then i-'len h11+2<=len h2-2+2 by A21,A728,AXIOMS:24;
                  then A733:1<=(i-'len h11 +2-'1) & (i-'len h11 +2-'1)<=len h21
                                    by A23,A731,Lm1,JORDAN3:5,7;
                  A734:i-'len h11+2-'1=i-'len h11+2-1
                          by A732,Lm1,JORDAN3:1;
                  set k=i-'len h11+2-'1;
                     i-len h11<=len h1+(len h2-2)-len h11 by A21,A23,A40,A43,
A46,A47,A675,REAL_1:49;
                  then A735: i-'len h11+2<=len h2-2+2 by A21,A728,AXIOMS:24;
                    A736: i-'len h11+2-'1<i-'len h11+2-1+1 by A734,NAT_1:38;
                     len h11+1-len h11<=i-len h11 by A21,A726,REAL_1:49;
                  then 1<=i-'len h11 by JORDAN3:1;
                  then 1+2<=i-'len h11+2 by AXIOMS:24;
                  then 1+2-1<=i-'len h11+2-1 by REAL_1:49;
                  then A737:1<k by A734,AXIOMS:22;
                  A738:k in dom h2 by A22,A733,FINSEQ_3:27;
                  then A739:h0.i=g2.(h2.k) by A730,FUNCT_1:23;
                  A740: h2.k in rng h2 by A738,FUNCT_1:def 5;
                     i in dom h0 by A672,A675,FINSEQ_3:27;
                  then A741:h0/.i=h0.i by FINSEQ_4:def 4;
                  g2.(h2.k) in rng g2 by A15,A16,A740,BORSUK_1:83,FUNCT_1:def 5
;
               then h0.i in Upper_Arc(P) /\ Lower_Arc(P)
                         by A13,A682,A718,A722,A739,A741,XBOOLE_0:def 3;
               then h0.i in {W-min(P),E-max(P)} by A1,JORDAN6:def 9;
               then h0.i=W-min(P) or h0.i=E-max(P)by TARSKI:def 2;
              hence contradiction by A22,A28,A29,A30,A31,A68,A730,A735,A736,
A737,A738,FUNCT_1:def 8;
             end;
             end;
             hence contradiction;
            end;
           hence contradiction;
          end;
         hence Segment(h0/.1,h0/.(1+1),P) misses Segment(h0/.i,h0/.len h0,P)
           by A1,A671,A680,A681,A683,A689,Th13;
        end;
     hence Segment(h0/.i,h0/.len h0,P) misses Segment(h0/.1,h0/.2,P);
     thus for i,j being Nat
           st 1<=i & i < j & j < len h0 & not i,j are_adjacent1
         holds Segment(h0/.i,h0/.(i+1),P) misses Segment(h0/.j,h0/.(j+1),P)
     proof
      let i,j be Nat;assume that
A742:    1<=i and
A743:    i < j and
A744:    j < len h0 and
A745:    not i,j are_adjacent1;
A746:  i<len h0 by A743,A744,AXIOMS:22;
A747:  1<j by A742,A743,AXIOMS:22;
          i in dom h0 by A742,A746,FINSEQ_3:27;
then A748:h0/.i=h0.i by FINSEQ_4:def 4;
        A749:i+1<=len h0 by A746,NAT_1:38;
        A750:j+1<=len h0 by A744,NAT_1:38;
        A751:LE h0/.i,h0/.(i+1),P by A550,A742,A749;
        A752:LE h0/.j,h0/.(j+1),P by A550,A747,A750;
        A753:not(j=i+1 or i=j+1) by A745,GOBRD10:def 1;
             1<j+1 by A747,NAT_1:38;
          then j+1 in dom h0 by A750,FINSEQ_3:27;
then A754:h0/.(j+1)=h0.(j+1) by FINSEQ_4:def 4;
            now per cases;
         case i<j;
then A755:       i+1<=j by NAT_1:38;
           then A756:i+1<j by A753,REAL_1:def 5;
           A757:i+1<len h0 by A744,A755,AXIOMS:22;
          A758:h0/.i<>h0/.(i+1) by A550,A742,A749;
          A759:1<i+1 by A742,NAT_1:38;
          A760:1<=(i+1) & (i+1)<len h0 by A742,A744,A755,AXIOMS:22,NAT_1:38;
          A761:LE h0/.(i+1),h0/.j,P
            proof
                 now per cases;
              case A762:i+1<=len h1;
                  now per cases;
               case A763:j<=len h1;
                A764:h0.(i+1)=h11.(i+1) by A21,A760,A762,SCMFSA_7:9;
                A765:(i+1) in dom h1 by A760,A762,FINSEQ_3:27;
then A766:            h1.(i+1) in rng h1 by FUNCT_1:def 5;
                A767:1<j by A756,A760,AXIOMS:22;
                then A768:h0.j=h11.j by A21,A763,SCMFSA_7:9;
                A769:j in dom h1 by A763,A767,FINSEQ_3:27;
then A770:            h1.j in rng h1 by FUNCT_1:def 5;
                   i+1 in dom h0 by A760,FINSEQ_3:27;
                then A771:h0/.(i+1)=h0.(i+1) by FINSEQ_4:def 4;
                   j in dom h0 by A744,A767,FINSEQ_3:27;
                then h0/.j=h0.j by FINSEQ_4:def 4;
                then Upper_Arc(P) is_an_arc_of W-min(P),E-max(P) &
                g1.(h1.(i+1)) = h0/.(i+1) & 0 <= (h1.(i+1)) & (h1.(i+1)) <= 1
                & g1.(h1.j) = h0/.j
                & 0 <= (h1.j) & (h1.j) <= 1
                                  & (h1.(i+1)) <= (h1.j)
                      by A1,A9,A756,A764,A765,A766,A768,A769,A770,A771,BORSUK_1
:83,FUNCT_1:23,GOBOARD1:def 1,JORDAN6:def 8,TOPREAL5:1;
                then h0/.(i+1) in Upper_Arc(P) & h0/.j in Upper_Arc(P) &
                LE h0/.(i+1),h0/.j,Upper_Arc(P),W-min(P),E-max(P)
                                       by A3,A4,A5,A6,A9,A766,A770,Th19,
BORSUK_1:83,FUNCT_1:def 5;
               hence thesis by JORDAN6:def 10;
               end;
               case A772:j>len h1;
                   then A773:len h11<=j
                   & j<=len h11 + len (mid(h21,2,len h21 -'1))
                                        by A20,A744,FINSEQ_1:35,FINSEQ_3:31;
                  A774:j-len h11=j-'len h11 by A21,A772,SCMFSA_7:3;
                     j-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                        by A773,REAL_1:49;
then A775:0<=j-'len h11
                      & j-'len h11<=len mid(h21,2,len h21 -'1)
                             by A21,A772,A774,SQUARE_1:12;
                  A776: j-len h11
                       <=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                           by A40,A744,REAL_1:49;
                   0+1<=j-'len h11+1+1-1 by A775,AXIOMS:24;
                  then A777:j-'len h11+2-'1=j-'len h11+2-1 by JORDAN3:1;
                     0<=j-'len h11 by NAT_1:18;
                  then 0+2<=j-'len h11 +2 by AXIOMS:24;
                  then A778:2-'1<=j-'len h11 +2-'1 by JORDAN3:5;
                     j-len h11<=len h1+(len h2-2)-len h11
                            by A21,A23,A40,A43,A46,A47,A744,REAL_1:49;
                  then j-'len h11+2<=len h2-2+2 by A21,A774,AXIOMS:24;
then A779: (j-'len h11 +2-'1)<=len h21 by A23,JORDAN3:7;
                  then A780:(j-'len h11 +2-'1) in dom h21 by A778,Lm1,FINSEQ_3:
27;
                    i+1 in Seg len h1 by A760,A762,FINSEQ_1:3;
then i+1 in dom h1 by FINSEQ_1:def 3;
                  then A781: j-len h11=j-'len h11
                  & h0.(i+1)=h11.(i+1) & (j-'len h11 +2-'1) in dom h21
                  & j-'len h11+2-'1=j-'len h11+2-1
                  & j-len h11 <= len (mid(h21,2,len h21 -'1))
                  & (i+1) in dom h1 & h11.(i+1)=g1.(h1.(i+1))
              by A21,A759,A762,A772,A776,A778,A779,Lm1,FINSEQ_3:27,FUNCT_1:23,
JORDAN3:1,SCMFSA_7:3,9;
                  A782:len h1 +1<=j by A772,NAT_1:38;
                  then A783:h0.j=(mid(h21,2,len h21 -'1)).(j -len h11)
                                      by A21,A40,A744,FINSEQ_1:36;
                    A784: len h1 +1-len h1<=j-len h1 by A782,REAL_1:49;
                  then A785:h0.j=h21.(j-'len h11 +2-'1)
                    by A21,A44,A45,A774,A776,A783,JORDAN3:27;
                     j+1-1<=len h1+(len h2-2)-1 by A21,A23,A40,A43,A46,A47,A750
,REAL_1:49;
                  then j-len h11<=len h1+((len h2-2)-1)-len h11 by REAL_1:49;
                  then j-'len h11+2<=len h2-2-1+2 by A21,A774,AXIOMS:24;
                  then A786:j-'len h11+2-1<=len h2-1-1 by REAL_1:49;
                  A787: len h2-1-1<len h2 by Lm4;
                  set k=j-'len h11+2-'1;
                  A788: h2.k in rng h2 by A22,A780,FUNCT_1:def 5;
                     i+1 in dom h1 by A759,A762,FINSEQ_3:27;
                  then A789: h1.(i+1) in rng h1 by FUNCT_1:def 5;
                  A790:  h0.j=h21.k by A21,A44,A45,A781,A783,A784,JORDAN3:27;
                  A791:h0.j=g2.(h2.k) & h21.k=g2.(h2.k) by A22,A780,A785,
FUNCT_1:23;
                     (i+1) in dom h0 by A760,FINSEQ_3:27;
                  then A792:h0/.(i+1)=h0.(i+1) by FINSEQ_4:def 4;
                     j in dom h0 by A744,A747,FINSEQ_3:27;
                  then A793:h0/.j=h0.j by FINSEQ_4:def 4;
                  A794:g1.(h1.(i+1)) in rng g1 by A6,A9,A789,BORSUK_1:83,
FUNCT_1:def 5;
                  A795:h0.j in Lower_Arc(P)
                           by A13,A15,A16,A788,A791,BORSUK_1:83,FUNCT_1:def 5;
                     h0/.j <> W-min P
                 by A22,A29,A31,A68,A777,A780,A786,A787,A790,A793,FUNCT_1:def 8
;
                 hence thesis by A4,A781,A792,A793,A794,A795,JORDAN6:def 10;
               end;
               end;
               hence thesis;
              end;
              case A796:i+1>len h1;
then A797:                len h1<j by A755,AXIOMS:22;
                  then A798:j-len h11=j-'len h11 by A21,SCMFSA_7:3;
                     j-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                        by A40,A744,REAL_1:49;
then A799:0<=j-'len h11
                      & j-'len h11<=len mid(h21,2,len h21 -'1)
                               by A21,A797,A798,SQUARE_1:12;
                  A800: j-len h11
                       <=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                         by A40,A744,REAL_1:49;
                   0+1<=j-'len h11+1+1-1 by A799,AXIOMS:24;
                  then A801:j-'len h11+2-'1=j-'len h11+2-1 by JORDAN3:1;
                     0<=j-'len h11 by NAT_1:18;
                  then 0+2<=j-'len h11 +2 by AXIOMS:24;
                  then A802:2-'1<=j-'len h11 +2-'1 by JORDAN3:5;
                     j-len h11<=len h1+(len h2-2)-len h11 by A21,A23,A40,A43,
A46,A47,A744,REAL_1:49;
                  then j-'len h11+2<=len h2-2+2 by A21,A798,AXIOMS:24;
then A803: (j-'len h11 +2-'1)<=len h21 by A23,JORDAN3:7;
                  then A804:j-'len h11 +2-'1 in dom h21 by A802,Lm1,FINSEQ_3:27
;
                  A805:len h11+1<=i+1
                      & i+1<len h11 + len (mid(h21,2,len h21 -'1))
                                   by A21,A757,A796,FINSEQ_1:35,NAT_1:38;
                  A806: i+1-len h11<len h11 + len (mid(h21,2,len h21 -'1)) -
len h11
                             by A40,A757,REAL_1:54;
                     len h1+1<=i+1 by A796,NAT_1:38;
                  then len h1+1-len h1<=i+1-len h1 by REAL_1:49;
                  then A807:1<=i+1-'len h11 & i+1-'len h11=i+1-len h11
                                     by A21,JORDAN3:1;
A808:               h0.(i+1)=(mid(h21,2,len h21 -'1)).(i+1 -len h11)
                                      by A805,FINSEQ_1:36
                              .=h21.(i+1-'len h11+2-'1)
                    by A44,A45,A806,A807,JORDAN3:27;
                  then A809: j-len h11=j-'len h11 & (i+1)-len h11=(i+1)-'len
h11
                  & h0.(i+1)=h21.(i+1-'len h11+2-'1)
                  & (j-'len h11 +2-'1) in dom h21
                  & len h11+1<=i+1
                  & i+1<=len h11 + len (mid(h21,2,len h21 -'1))
                  & j-'len h11+2-'1=j-'len h11+2-1
                  & j-len h11 <= len (mid(h21,2,len h21 -'1))
                  & i+1-len h11<len (mid(h21,2,len h21 -'1))
                  by A21,A40,A744,A796,A797,A802,A803,A806,Lm1,FINSEQ_3:27,
JORDAN3:1,NAT_1:38,REAL_1:49,SCMFSA_7:3;
                     len h1<j by A755,A796,AXIOMS:22;
                  then A810:len h11+1<=j
                   & j<=len h11 + len (mid(h21,2,len h21 -'1))
                               by A21,A744,FINSEQ_1:35,NAT_1:38;
                  then A811:h0.j=(mid(h21,2,len h21 -'1)).(j -len h11)
                                      by FINSEQ_1:36;
                    A812: len h1 +1-len h1<=j-len h1 by A21,A810,REAL_1:49
;
                  then A813:h0.j=h21.(j-'len h11 +2-'1)
                    by A21,A44,A45,A798,A800,A811,JORDAN3:27;
                     0<=(i+1)-'len h11 by NAT_1:18;
                  then A814: 0+2<=(i+1)-'len h11 +2 by AXIOMS:24;
                  then A815:2-'1<=((i+1)-'len h11 +2-'1) by JORDAN3:5;
                   (i+1)-'len h11+2<=len h2-2+2 by A23,A43,A46,A47,A809,AXIOMS:
24;
                  then A816:1<=((i+1)-'len h11 +2-'1)
                      & ((i+1)-'len h11 +2-'1)<=len h21
                                    by A23,A814,Lm1,JORDAN3:5,7;
                  A817:(i+1)-'len h11+2-'1=(i+1)-'len h11+2-1
                                  by A815,Lm1,JORDAN3:1;
                     j+1-1<=len h1+(len h2-2)-1 by A21,A23,A40,A43,A46,A47,A750
,REAL_1:49
;
                  then j-len h11<=len h1+((len h2-2)-1)-len h11 by REAL_1:49;
                  then j-'len h11+2<=len h2-2-1+2 by A21,A798,AXIOMS:24;
                  then A818:j-'len h11+2-1<=len h2-1-1 by REAL_1:49;
                  A819: len h2-1-1<len h2 by Lm4;
                  set k=j-'len h11+2-'1;
                  set j0=(i+1)-'len h11+2-'1;
                     (i+1)-len h11<j-len h11 by A756,REAL_1:54;
                  then (i+1)-'len h11+2<j-'len h11+2 by A809,REAL_1:53;
                  then A820:j0<k by A801,A817,REAL_1:54;
                  A821:h21.k=g2.(h2.k) by A22,A804,FUNCT_1:23;
A822:              h2.k in rng h2 by A22,A804,FUNCT_1:def 5;
                  then A823:0<=h2.k & h2.k<=1 by A16,BORSUK_1:83,TOPREAL5:1;
                  A824:j0 in dom h2 by A22,A816,FINSEQ_3:27;
                  then A825:h0.(i+1)=g2.(h2.j0) by A808,FUNCT_1:23;
A826:              h2.j0 in rng h2 by A824,FUNCT_1:def 5;
                  then A827:0<=h2.j0 & h2.j0<=1 by A16,BORSUK_1:83,TOPREAL5:1;
                  A828:h2.(j0)<h2.(k) by A16,A22,A804,A820,A824,GOBOARD1:def 1;
                  A829:  h0.j=h21.(k) by A21,A44,A45,A809,A811,A812,JORDAN3:27;
                  A830:h0.j=g2.(h2.k) & h21.k=g2.(h2.k) by A22,A804,A813,
FUNCT_1:23;
                     (i+1) in dom h0 by A760,FINSEQ_3:27;
                  then A831:h0/.(i+1)=h0.(i+1) by FINSEQ_4:def 4;
                     j in dom h0 by A744,A747,FINSEQ_3:27;
                  then A832:h0/.j=h0.(j) by FINSEQ_4:def 4;
                  A833:g2.(h2.j0) in rng g2 by A15,A16,A826,BORSUK_1:83,FUNCT_1
:def 5;
                  A834:h0.(j) in Lower_Arc(P)
                   by A13,A15,A16,A822,A830,BORSUK_1:83,FUNCT_1:def 5;
A835:            h0/.j <> W-min P
                  by A22,A29,A31,A68,A801,A804,A818,A819,A829,A832,FUNCT_1:def
8;
                   LE h0/.(i+1),h0/.j,Lower_Arc(P),E-max(P),W-min(P)
                     by A11,A12,A13,A14,A813,A821,A823,A825,A827,A828,A831,A832
,Th19;
                 hence thesis by A13,A825,A831,A832,A833,A834,A835,JORDAN6:def
10;
              end;
              end;
             hence thesis;
            end;
             now assume A836:h0/.(i+1)=h0/.j;
               now per cases;
            case A837:i+1<=len h1;
                A838:1<i+1 by A742,NAT_1:38;
                then A839:i+1 in dom h1 by A837,FINSEQ_3:27;
                   i+1 in dom h0 by A749,A838,FINSEQ_3:27;
                then A840:h0/.(i+1)=h0.(i+1) by FINSEQ_4:def 4;
                A841:h0.(i+1)=h11.(i+1) by A21,A837,A838,SCMFSA_7:9;
                then A842:h0.(i+1)=g1.(h1.(i+1)) by A839,FUNCT_1:23;
                   h1.(i+1) in rng h1 by A839,FUNCT_1:def 5;
                then A843:h0.(i+1) in Upper_Arc(P)
                             by A4,A6,A9,A842,BORSUK_1:83,FUNCT_1:def 5;
                now per cases;
             case A844:j<=len h1;
                then A845:h0.(j)=h11.(j) by A21,A747,SCMFSA_7:9;
                A846:j in dom h1 by A747,A844,FINSEQ_3:27;
                   j in dom h0 by A744,A747,FINSEQ_3:27;
                then h0/.j=h0.j by FINSEQ_4:def 4;
              hence contradiction by A20,A67,A753,A836,A839,A840,A841,A845,
A846,FUNCT_1:def 8;
             end;
             case A847:j>len h1;
                  then A848:len h1 +1<=j by NAT_1:38;
                  A849:len h11+1<=j & j<=
len h11 + len (mid(h21,2,len h21 -'1)) by A21,A744,A847,FINSEQ_1:35,NAT_1:38;
A850: h0.j=(mid(h21,2,len h21 -'1)).(j -len h11)
              by A21,A40,A744,A848,FINSEQ_1:36;
                  A851:j-len h11=j-'len h11 by A21,A847,SCMFSA_7:3;
                    A852: j-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len
h11
                                         by A849,REAL_1:49;
                     len h1 +1-len h1<=j-len h1 by A848,REAL_1:49;
                  then A853:h0.j=h21.(j-'len h11 +2-'1)
                             by A21,A44,A45,A850,A851,A852,JORDAN3:27;
                     0<=j-'len h11 by NAT_1:18;
                  then A854: 0+2<=j-'len h11 +2 by AXIOMS:24;
                  then A855:2-'1<=(j-'len h11 +2-'1) by JORDAN3:5;
                     j-len h11<=len h1+(len h2-2)-len h11
                           by A21,A23,A40,A43,A46,A47,A744,REAL_1:49;
                  then j-'len h11+2<=len h2-2+2 by A21,A851,AXIOMS:24;
then A856:1<=(j-'len h11 +2-'1) & (j-'len h11 +2-'1)<=
len h21
                                    by A23,A854,Lm1,JORDAN3:5,7;
                  A857:j-'len h11+2-'1=j-'len h11+2-1
                     by A855,Lm1,JORDAN3:1;
                  set k=j-'len h11+2-'1;
                     j-len h11<=len h1+(len h2-2)-len h11
                                   by A21,A23,A40,A43,A46,A47,A744,REAL_1:49;
                  then A858: j-'len h11+2<=len h2-2+2 by A21,A851,AXIOMS:24;
                    A859: j-'len h11+2-'1<j-'len h11+2-'1+1 by NAT_1:38;
                     len h11+1-len h11<=j-len h11 by A21,A848,REAL_1:49
;
                  then 1<=j-'len h11 by JORDAN3:1;
                  then 1+2<=j-'len h11+2 by AXIOMS:24;
                  then 1+2-1<=j-'len h11+2-1 by REAL_1:49;
                  then A860:1<k by A857,AXIOMS:22;
                  A861:k in dom h2 by A22,A856,FINSEQ_3:27;
                  then A862:h0.j=g2.(h2.k) by A853,FUNCT_1:23;
                  A863: h2.k in rng h2 by A861,FUNCT_1:def 5;
                     j in dom h0 by A744,A747,FINSEQ_3:27;
                  then A864:h0/.j=h0.j by FINSEQ_4:def 4;
                     g2.(h2.k) in rng g2 by A15,A16,A863,BORSUK_1:83,FUNCT_1:
def 5;
                  then h0.j in Upper_Arc(P) /\ Lower_Arc(P)
                            by A13,A836,A840,A843,A862,A864,XBOOLE_0:def 3;
                  then A865:         h0.j in {W-min(P),E-max(P)} by A1,JORDAN6:
def 9;
A866:         h0.j <> W-min P
                   by A22,A29,A31,A68,A853,A857,A858,A859,A861,FUNCT_1:def 8;
                  h0.j <> E-max P
                   by A22,A28,A30,A68,A853,A860,A861,FUNCT_1:def 8;
              hence contradiction by A865,A866,TARSKI:def 2;
             end;
             end;
             hence contradiction;
            end;
            case A867:i+1>len h1;
                  then A868:len h1 +1<=i+1 by NAT_1:38;
                  then A869:h0.(i+1)=(mid(h21,2,len h21 -'1)).((i+1) -len h11)
                                     by A21,A40,A749,FINSEQ_1:36;
                  A870:(i+1)-len h11=(i+1)-'len h11 by A21,A867,SCMFSA_7:3;
                    A871: (i+1)-len h11
                   <=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                         by A40,A749,REAL_1:49;
                     len h1 +1-len h1<=(i+1)-len h1 by A868,REAL_1:49
;
                  then A872:h0.(i+1)=h21.((i+1)-'len h11 +2-'1)
                             by A21,A44,A45,A869,A870,A871,JORDAN3:27;
                     0<=(i+1)-'len h11 by NAT_1:18;
                  then A873: 0+2<=(i+1)-'len h11 +2 by AXIOMS:24;
                  then A874:2-'1<=((i+1)-'len h11 +2-'1) by JORDAN3:5;
                     (i+1)-len h11<=len h1+(len h2-2)-len h11
                            by A21,A23,A40,A43,A46,A47,A749,REAL_1:49;
                  then (i+1)-'len h11+2<=len h2-2+2 by A21,A870,AXIOMS:24;
then A875:1<=((i+1)-'len h11 +2-'1)
                  & ((i+1)-'len h11 +2-'1)<=len h21
                                    by A23,A873,Lm1,JORDAN3:5,7;
                  A876:(i+1)-'len h11+2-'1=(i+1)-'len h11+2-1
                                 by A874,Lm1,JORDAN3:1;
                  set j0=(i+1)-'len h11+2-'1;
                     len h11+1-len h11<=(i+1)-len h11
                           by A21,A868,REAL_1:49;
                  then A877:(i+1)-'len h11=(i+1)-len h11 by JORDAN3:1;
                  A878:j0 in dom h2 by A22,A875,FINSEQ_3:27;
                     1<=i+1 by A742,NAT_1:38;
                  then i+1 in dom h0 by A749,FINSEQ_3:27;
                  then A879:h0/.(i+1)=h0.(i+1) by FINSEQ_4:def 4;
                  A880:j>len h1 by A755,A867,AXIOMS:22;
                  then A881:len h1 +1<=j by NAT_1:38;
                     len h11+1<=j & j<=
len h11 + len (mid(h21,2,len h21 -'1)) by A21,A744,A880,FINSEQ_1:35,NAT_1:38;
then A882: h0.j=(mid(h21,2,len h21 -'1)).(j -len h11)
                     by FINSEQ_1:36;
                  A883:j-len h11=j-'len h11 by A21,A880,SCMFSA_7:3;
                  A884: j-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len
h11
                                    by A40,A744,REAL_1:49;
                     len h1 +1-len h1<=j-len h1 by A881,REAL_1:49;
                  then A885:h0.j=h21.(j-'len h11 +2-'1)
                             by A21,A44,A45,A882,A883,A884,JORDAN3:27;
                     0<=j-'len h11 by NAT_1:18;
                  then A886: 0+2<=j-'len h11 +2 by AXIOMS:24;
                  then A887:2-'1<=(j-'len h11 +2-'1) by JORDAN3:5;
                     j-len h11<=len h1+(len h2-2)-len h11 by A21,A23,A40,A43,
A46,A47,A744,REAL_1:49;
                  then j-'len h11+2<=len h2-2+2 by A21,A883,AXIOMS:24;
                  then A888:1<=(j-'len h11 +2-'1) & (j-'len h11 +2-'1)<=len h21
                                    by A23,A886,Lm1,JORDAN3:5,7;
                  A889:j-'len h11+2-'1=j-'len h11+2-1
                      by A887,Lm1,JORDAN3:1;
                  set k=j-'len h11+2-'1;
                     len h11+1-len h11<=j-len h11 by A21,A881,REAL_1:49
;
                  then j-'len h11=j-len h11 by JORDAN3:1;
                  then i+1-'len h11<j-'len h11 by A756,A877,REAL_1:54;
                  then i+1-'len h11+2<j-'len h11+2 by REAL_1:53;
                  then A890:(i+1)-'len h11+2-'1<j-'len h11+2-'1
                            by A876,A889,REAL_1:54;
                  A891:k in dom h2 by A22,A888,FINSEQ_3:27;
                     j in dom h0 by A744,A747,FINSEQ_3:27;
                  then h0/.j=h0.j by FINSEQ_4:def 4;
                 hence contradiction
      by A22,A68,A836,A872,A878,A879,A885,A890,A891,FUNCT_1:def 8;
            end;
            end;
           hence contradiction;
          end;
         hence
             Segment(h0/.i,h0/.(i+1),P) misses Segment(h0/.j,h0/.(j+1),P)
                   by A1,A751,A752,A758,A761,Th13;
        end;
        case A892: j<=i;
          A893:h0/.j<>h0/.(j+1) by A550,A747,A750;
          A894:1<j+1 by A747,NAT_1:38;
          A895:LE h0/.(j+1),h0/.i,P
            proof
                 now per cases;
              case A896:j+1<=len h1;
              then A897:h0.(j+1)=h11.(j+1) by A21,A894,SCMFSA_7:9;
                  now per cases;
               case i<=len h1;
               thus thesis by A743,A892;
               end;
               case A898:i>len h1;
                  then A899:i-len h11=i-'len h11 by A21,SCMFSA_7:3;
                     i-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                        by A40,A746,REAL_1:49;
then A900:0<=i-'len h11
                      & i-'len h11<=len mid(h21,2,len h21 -'1)
                             by A21,A898,A899,SQUARE_1:12;
                    A901: i-len h11
                       <=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                by A40,A746,REAL_1:49;
                   0+1<=i-'len h11+1+1-1 by A900,AXIOMS:24;
                  then A902:i-'len h11+2-'1=i-'len h11+2-1 by JORDAN3:1;
                     0<=i-'len h11 by NAT_1:18;
                  then 0+2<=i-'len h11 +2 by AXIOMS:24;
                  then A903:2-'1<=(i-'len h11 +2-'1) by JORDAN3:5;
                     i-len h11<=len h1+(len h2-2)-len h11 by A21,A23,A40,A43,
A46,A47,A746,REAL_1:49;
                  then i-'len h11+2<=len h2-2+2 by A21,A899,AXIOMS:24;
then i-'len h11 +2-'1<=len h21 by A23,JORDAN3:7;
then A904:           (i-'len h11 +2-'1) in dom h21 by A903,Lm1,FINSEQ_3:27;
                j+1 in dom h1 by A894,A896,FINSEQ_3:27;
                  then A905: h11.(j+1)=g1.(h1.(j+1)) by FUNCT_1:23;
                  A906:len h1 +1<=i by A898,NAT_1:38;
                  then A907:h0.i=(mid(h21,2,len h21 -'1)).(i -len h11)
                                      by A21,A40,A746,FINSEQ_1:36;
                    A908: len h1 +1-len h1<=i-len h1 by A906,REAL_1:49;
                  then A909: 1<=i-len h11 by A20,FINSEQ_3:31;
                  A910:h0.(i)=h21.(i-'len h11 +2-'1)
                    by A21,A44,A45,A899,A901,A907,A908,JORDAN3:27;
                     i+1-1<=len h1+(len h2-2)-1 by A21,A23,A40,A43,A46,A47,A749
,REAL_1:49;
                  then i-len h11<=len h1+((len h2-2)-1)-len h11 by REAL_1:49;
                  then i-'len h11+2<=len h2-2-1+2 by A21,A899,AXIOMS:24;
                  then A911:i-'len h11+2-1<=len h2-1-1 by REAL_1:49;
A912:               len h2-1-1<len h2 by Lm4;
                  set k=i-'len h11+2-'1;
                  A913: h2.k in rng h2 by A22,A904,FUNCT_1:def 5;
                     j+1 in dom h1 by A894,A896,FINSEQ_3:27;
                  then A914: h1.(j+1) in rng h1 by FUNCT_1:def 5;
                  A915:h0.i=h21.k by A44,A45,A899,A901,A907,A909,JORDAN3:27;
                  A916:h0.i=g2.(h2.k)
                         & h21.k=g2.(h2.k) by A22,A904,A910,FUNCT_1:23;
A917:g1.(h1.(j+1)) in rng g1 by A6,A9,A914,BORSUK_1:83,FUNCT_1:def 5;
                  A918:h0.i in Lower_Arc(P)
                  by A13,A15,A16,A913,A916,BORSUK_1:83,FUNCT_1:def 5;
                     h0/.i <> W-min P
              by A22,A29,A31,A68,A748,A902,A904,A911,A912,A915,FUNCT_1:def 8;
                 hence thesis by A4,A748,A754,A897,A905,A917,A918,JORDAN6:def
10;
               end;
               end;
               hence thesis;
              end;
              case j+1>len h1;
               thus thesis by A743,A892;
              end;
              end;
             hence thesis;
            end;
          A919:1<j+1 by A747,NAT_1:38;
             now assume A920:h0/.(j+1)=h0/.i;
               now per cases;
            case A921:j+1<=len h1;
                then A922:j+1 in dom h1 by A919,FINSEQ_3:27;
                then A923: h1.(j+1) in rng h1 by FUNCT_1:def 5;
                A924:h0.(j+1)=h11.(j+1) by A21,A919,A921,SCMFSA_7:9;
                then h0.(j+1)=g1.(h1.(j+1)) by A922,FUNCT_1:23;
          then A925:h0.(j+1) in Upper_Arc(P) by A4,A6,A9,A923,BORSUK_1:83,
FUNCT_1:def 5;
                now per cases;
             case A926:i<=len h1;
                then A927:h0.i=h11.i by A21,A742,SCMFSA_7:9;
                   i in dom h1 by A742,A926,FINSEQ_3:27;
              hence contradiction
               by A20,A67,A748,A753,A754,A920,A922,A924,A927,FUNCT_1:def 8;
             end;
             case A928:i>len h1;
                  then A929:len h1 +1<=i by NAT_1:38;
then A930:     h0.i=(mid(h21,2,len h21 -'1)).(i -len h11)
                  by A21,A40,A746,FINSEQ_1:36;
                  A931:i-len h11=i-'len h11 by A21,A928,SCMFSA_7:3;
                    A932: i-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len
h11
                                         by A40,A746,REAL_1:49;
                     len h1 +1-len h1<=i-len h1 by A929,REAL_1:49;
                  then A933:h0.i=h21.(i-'len h11 +2-'1)
                             by A21,A44,A45,A930,A931,A932,JORDAN3:27;
                     0<=i-'len h11 by NAT_1:18;
                  then A934: 0+2<=i-'len h11 +2 by AXIOMS:24;
                  then A935:2-'1<=(i-'len h11 +2-'1) by JORDAN3:5;
                     i-len h11<=len h1+(len h2-2)-len h11
                    by A21,A23,A40,A43,A46,A47,A746,REAL_1:49;
                  then i-'len h11+2<=len h2-2+2 by A21,A931,AXIOMS:24;
                  then A936:1<=(i-'len h11 +2-'1) & (i-'len h11 +2-'1)<=len h21
                                    by A23,A934,Lm1,JORDAN3:5,7;
                  A937:i-'len h11+2-'1=i-'len h11+2-1
                          by A935,Lm1,JORDAN3:1;
                  set k=i-'len h11+2-'1;
                     i-len h11<=len h1+(len h2-2)-len h11 by A21,A23,A40,A43,
A46,A47,A746,REAL_1:49;
                  then A938: i-'len h11+2<=len h2-2+2 by A21,A931,AXIOMS:24;
                    A939: i-'len h11+2-'1<i-'len h11+2-1+1 by A937,NAT_1:38;
                     len h11+1-len h11<=i-len h11 by A21,A929,REAL_1:49;
                  then 1<=i-'len h11 by JORDAN3:1;
                  then 1+2<=i-'len h11+2 by AXIOMS:24;
                  then 1+2-1<=i-'len h11+2-1 by REAL_1:49;
                  then A940:1<k by A937,AXIOMS:22;
                  A941:k in dom h2 by A22,A936,FINSEQ_3:27;
                  then A942:h0.i=g2.(h2.k) by A933,FUNCT_1:23;
                  A943: h2.k in rng h2 by A941,FUNCT_1:def 5;
                     i in dom h0 by A742,A746,FINSEQ_3:27;
                  then A944:h0/.i=h0.i by FINSEQ_4:def 4;
                  g2.(h2.k) in rng g2 by A15,A16,A943,BORSUK_1:83,FUNCT_1:def 5
;
               then h0.i in Upper_Arc(P) /\ Lower_Arc(P)
                         by A13,A754,A920,A925,A942,A944,XBOOLE_0:def 3;
               then h0.i in {W-min(P),E-max(P)} by A1,JORDAN6:def 9;
               then h0.i=W-min(P) or h0.i=E-max(P)by TARSKI:def 2;
              hence contradiction by A22,A28,A29,A30,A31,A68,A933,A938,A939,
A940,A941,FUNCT_1:def 8;
             end;
             end;
             hence contradiction;
            end;
            case j+1>len h1;
                 thus contradiction by A743,A892;
            end;
            end;
           hence contradiction;
          end;
         hence Segment(h0/.j,h0/.(j+1),P) misses Segment(h0/.i,
         h0/.(i+1),P) by A1,A751,A752,A893,A895,Th13;
        end;
        end;
     hence Segment(h0/.i,h0/.(i+1),P) misses Segment(h0/.j,h0/.(j+1),P);
    end;
   let i be Nat such that
A945: 1 < i and
A946: i+1 < len h0;
A947:  i<len h0 by A946,NAT_1:38;
A948: LE h0/.i,h0/.(i+1),P by A550,A945,A946;
A949: 1<i+1 by A945,NAT_1:38;
A950: h0/.i<>h0/.(i+1) by A550,A945,A946;
A951: i in dom h0 by A945,A947,FINSEQ_3:27;
     then h0/.i = h0.i by FINSEQ_4:def 4;
then A952: h0/.i<>W-min P by A39,A64,A69,A945,A951,FUNCT_1:def 8;
A953: i+1 in dom h0 by A946,A949,FINSEQ_3:27;
A954: len h0-len h11 <= len (mid(h21,2,len h21 -'1)) by A40;
      set k=len h0-'len h11+2-'1;
         0<=len h0-'len h11 by NAT_1:18;
      then 0+2<=len h0-'len h11 +2 by AXIOMS:24;
then A955: 2-'1<=len h0-'len h11 +2-'1 by JORDAN3:5;
         len h0-'len h11+2<=len h2-2+2 by A23,A40,A43,A46,A47,A57,XCMPLX_1:26;
      then (len h0-'len h11 +2-'1)<=len h21 by A23,JORDAN3:7;
      then A956: (len h0-'len h11 +2-'1) in dom h21 by A955,Lm1,FINSEQ_3:27;
   h0.len h0=mid(h21,2,len h21 -'1).(len h0 -len h11)
                        by A21,A40,A51,FINSEQ_1:36;
then A957: h0.len h0=h21.(len h0-'len h11 +2-'1)
             by A21,A44,A45,A56,A57,A954,JORDAN3:27;
A958: h21.k=g2.(h2.k) by A22,A956,FUNCT_1:23;
      A959: h2.k in rng h2 by A22,A956,FUNCT_1:def 5;
then A960: h0.len h0 in Lower_Arc(P) by A13,A15,A16,A957,A958,BORSUK_1:83,
FUNCT_1:def 5;
A961:LE h0/.(i+1),h0/.len h0,P
      proof
       per cases;
       suppose A962:i+1<=len h1;
then A963:      h0.(i+1)=h11.(i+1) by A21,A949,SCMFSA_7:9;
            i+1 in dom h1 by A949,A962,FINSEQ_3:27;
         then A964:      h11.(i+1)=g1.(h1.(i+1)) by FUNCT_1:23;
                     i+1 in dom h1 by A949,A962,FINSEQ_3:27;
                  then A965: h1.(i+1) in rng h1 by FUNCT_1:def 5;
                  A966:h0/.(i+1)=h0.(i+1) by A953,FINSEQ_4:def 4;
                          g1.(h1.(i+1)) in rng g1 by A6,A9,A965,BORSUK_1:83,
FUNCT_1:def 5;
        hence thesis by A4,A55,A126,A960,A963,A964,A966,JORDAN6:def 10;
       end;
       suppose A967:i+1>len h1;
A968:             0<=len h0-'len h11 by A21,A52,A57,SQUARE_1:12;
                  A969:len h0-len h11
                      <= len (mid(h21,2,len h21 -'1)) by A40;
                   0+1<=len h0-'len h11+1+1-1 by A968,AXIOMS:24;
                  then A970:len h0-'len h11+2-'1=len h0-'len h11+2-1 by JORDAN3
:1;
                     len h0-'len h11+2<=len h2-2+2
                        by A23,A40,A43,A46,A47,A57,XCMPLX_1:26;
then A971: (len h0-'len h11 +2-'1)<=len h21 by A23,JORDAN3:7;
                  then A972:len h0-'len h11 +2-'1 in dom h21
                  by A955,Lm1,FINSEQ_3:27;
A973:             len h11+1<=i+1 by A21,A967,NAT_1:38;
A974:             i+1<len h11 + len (mid(h21,2,len h21 -'1)) by A946,FINSEQ_1:
35;
                    A975: i+1-len h11<len h11 + len (mid(h21,2,len h21 -'1)) -
len
h11
                             by A40,A946,REAL_1:54;
                     len h1+1<=i+1 by A967,NAT_1:38;
                  then A976: len h1+1-len h1<=i+1-len h1 by REAL_1:49;
then A977:             i+1-'len h11=i+1-len h11 by A21,JORDAN3:1;
A978:              h0.(i+1) = mid(h21,2,len h21 -'1).(i+1 -len h11)
                                      by A973,A974,FINSEQ_1:36
                          .= h21.(i+1-'len h11+2-'1)
                    by A21,A44,A45,A975,A976,A977,JORDAN3:27;
A979:             (i+1)-len h11=(i+1)-'len h11 by A21,A967,SCMFSA_7:3;
A980:             (len h0-'len h11 +2-'1) in dom h21 by A955,A971,Lm1,FINSEQ_3:
27;
                    h0.len h0=(mid(h21,2,len h21 -'1)).(len h0 -len h11)
                                      by A21,A40,A51,FINSEQ_1:36;
                  then A981:h0.len h0=h21.(len h0-'len h11 +2-'1)
                    by A21,A44,A45,A56,A57,A969,JORDAN3:27;
                     0<=(i+1)-'len h11 by NAT_1:18;
                  then 0+2<=(i+1)-'len h11 +2 by AXIOMS:24;
                  then A982:2-'1<=((i+1)-'len h11 +2-'1) by JORDAN3:5;
                     (i+1)-len h11<=len h11+(len h2-2)-len h11
                                    by A23,A40,A43,A46,A47,A946,REAL_1:49;
                  then (i+1)-'len h11+2<=len h2-2+2 by A979,AXIOMS:24;
then A983:           (i+1)-'len h11 +2-'1 <= len h21 by A23,JORDAN3:7;
                  A984:(i+1)-'len h11+2-'1=(i+1)-'len h11+2-1
                                  by A982,Lm1,JORDAN3:1;
                  set k=len h0-'len h11+2-'1;
                  set j0=(i+1)-'len h11+2-'1;
                     (i+1)-len h11<len h0-len h11 by A946,REAL_1:54;
                  then (i+1)-'len h11+2<len h0-'len h11+2 by A57,A979,REAL_1:
53
;
                  then A985:j0<k by A970,A984,REAL_1:54;
                  A986:h21.k=g2.(h2.k) by A22,A972,FUNCT_1:23;
A987:              h2.k in rng h2 by A22,A980,FUNCT_1:def 5;
then A988:             0<=h2.k by A16,BORSUK_1:83,TOPREAL5:1;
A989:             h2.k<=1 by A16,A987,BORSUK_1:83,TOPREAL5:1;
                  A990:j0 in dom h2 by A22,A982,A983,Lm1,FINSEQ_3:27;
                  then A991:h0.(i+1)=g2.(h2.j0) by A978,FUNCT_1:23;
A992:              h2.j0 in rng h2 by A990,FUNCT_1:def 5;
then A993:             0<=h2.j0 by A16,BORSUK_1:83,TOPREAL5:1;
A994:             h2.j0<=1 by A16,A992,BORSUK_1:83,TOPREAL5:1;
                  A995:h2.(j0)<h2.(k)
                  by A16,A22,A980,A985,A990,GOBOARD1:def 1;
                  A996:h0/.(i+1)=h0.(i+1) by A953,FINSEQ_4:def 4;
                    g2.(h2.j0) in rng g2 by A15,A16,A992,BORSUK_1:83,FUNCT_1:
def 5;
                  then A997:h0.(i+1) in Lower_Arc(P) by A13,A978,A990,FUNCT_1:
23;
                    h0.(len h0) in Lower_Arc(P) by A13,A15,A16,A957,A958,A959,
BORSUK_1:83,FUNCT_1:def 5;
then A998:       h0/.len h0 in Lower_Arc P by A54,FINSEQ_4:def 4;
           LE h0/.(i+1),h0/.len h0,Lower_Arc(P),E-max(P),W-min(P)
             by A11,A12,A13,A14,A55,A981,A986,A988,A989,A991,A993,A994,A995,
A996,Th19;
       hence thesis by A126,A996,A997,A998,JORDAN6:def 10;
      end;
      end;
             now assume A999:h0/.(i+1)=h0/.len h0;
               now per cases;
            case A1000:i+1<=len h1;
                   i+1 in dom h0 by A946,A949,FINSEQ_3:27;
                then A1001:h0/.(i+1)=h0.(i+1) by FINSEQ_4:def 4;
                A1002:h0.(i+1)=h11.(i+1) by A21,A949,A1000,SCMFSA_7:9;
                A1003:i+1 in dom h1 by A949,A1000,FINSEQ_3:27;
                then A1004:h0.(i+1)=g1.(h1.(i+1)) by A1002,FUNCT_1:23;
                   h1.(i+1) in rng h1 by A1003,FUNCT_1:def 5;
                then A1005:h0.(i+1) in Upper_Arc(P)
                             by A4,A6,A9,A1004,BORSUK_1:83,FUNCT_1:def 5;
A1006: h0.len h0=(mid(h21,2,len h21 -'1)).(len h0 -len h11)
              by A21,A40,A51,FINSEQ_1:36;
                    len h0-len h11<= len (mid(h21,2,len h21 -'1))
                                             by A40;
                  then A1007:h0.len h0=h21.(len h0-'len h11 +2-'1)
                             by A21,A44,A45,A56,A57,A1006,JORDAN3:27;
                     0<=len h0-'len h11 by NAT_1:18;
                  then 0+2<=len h0-'len h11 +2 by AXIOMS:24;
                  then A1008:2-'1<=(len h0-'len h11 +2-'1) by JORDAN3:5;
                     len h0-'len h11+2<=len h2-2+2
                           by A23,A40,A43,A46,A47,A57,XCMPLX_1:26;
then A1009:            len h0-'len h11 +2-'1 <= len h21 by A23,JORDAN3:7;
                  A1010:len h0-'len h11+2-'1=len h0-'len h11+2-1
                     by A1008,Lm1,JORDAN3:1;
                  set k=len h0-'len h11+2-'1;
                    A1011: len h0-'len h11+2<=len h2-2+2
                      by A23,A40,A43,A46,A47,A57,XCMPLX_1:26;
                    A1012: len h0-'len h11+2-'1<len h0-'len h11+2-'1+1 by NAT_1
:38;
                     1+2<=len h0-'len h11+2 by A58,AXIOMS:24;
                  then 1+2-1<=len h0-'len h11+2-1 by REAL_1:49;
                  then A1013:1<k by A1010,AXIOMS:22;
                  A1014:k in dom h2 by A22,A1008,A1009,Lm1,FINSEQ_3:27;
                  then A1015:h0.len h0=g2.(h2.k) by A1007,FUNCT_1:23;
                     h2.k in rng h2 by A1014,FUNCT_1:def 5;
                  then g2.(h2.k) in rng g2 by A15,A16,BORSUK_1:83,FUNCT_1:def
5
;
                  then h0.len h0 in Upper_Arc(P) /\ Lower_Arc(P)
                   by A13,A55,A999,A1001,A1005,A1015,XBOOLE_0:def 3;
then A1016:         h0.len h0 in {W-min(P),E-max(P)} by A1,JORDAN6:def 9;
A1017:         h0.len h0 <> W-min P
                     by A22,A29,A31,A68,A1007,A1010,A1011,A1012,A1014,FUNCT_1:
def 8;
                  h0.len h0 <> E-max P
                    by A22,A28,A30,A68,A1007,A1013,A1014,FUNCT_1:def 8;
              hence contradiction by A1016,A1017,TARSKI:def 2;
            end;
            case A1018:i+1>len h1;
                  then A1019:len h1 +1<=i+1 by NAT_1:38;
A1020:        i+1 <= len h11 + len mid(h21,2,len h21 -'1) by A946,FINSEQ_1:35;
                  A1021:h0.(i+1)=(mid(h21,2,len h21 -'1)).((i+1) -len h11)
                                     by A21,A40,A946,A1019,FINSEQ_1:36;
                  A1022:(i+1)-len h11=(i+1)-'len h11 by A21,A1018,SCMFSA_7:3;
                    A1023: i+1-len h11
                   <=len h11 + len mid(h21,2,len h21 -'1)-len h11
                                         by A1020,REAL_1:49;
                     len h1 +1-len h1<=(i+1)-len h1 by A1019,REAL_1:49;
                  then A1024:h0.(i+1)=h21.((i+1)-'len h11 +2-'1)
                             by A21,A44,A45,A1021,A1022,A1023,JORDAN3:27;
                     0<=(i+1)-'len h11 by NAT_1:18;
                  then 0+2<=(i+1)-'len h11 +2 by AXIOMS:24;
                  then A1025:2-'1<=((i+1)-'len h11 +2-'1) by JORDAN3:5;
                     (i+1)-len h11<=len h1+(len h2-2)-len h11
                            by A21,A23,A40,A43,A46,A47,A946,REAL_1:49;
                  then (i+1)-'len h11+2<=len h2-2+2 by A21,A1022,AXIOMS:24;
then A1026:            (i+1)-'len h11 +2-'1 <= len h21 by A23,JORDAN3:7;
                  A1027:(i+1)-'len h11+2-'1=(i+1)-'len h11+2-1
                                 by A1025,Lm1,JORDAN3:1;
                  set j0=(i+1)-'len h11+2-'1;
                     len h11+1-len h11<=(i+1)-len h11
                           by A21,A1019,REAL_1:49;
                  then A1028:(i+1)-'len h11=(i+1)-len h11 by JORDAN3:1;
                 A1029:j0 in dom h2 by A22,A1025,A1026,Lm1,FINSEQ_3:27;
                     1<=i+1 by A945,NAT_1:38;
                  then i+1 in dom h0 by A946,FINSEQ_3:27;
                  then A1030:h0/.(i+1)=h0.(i+1) by FINSEQ_4:def 4;
A1031: h0.len h0=(mid(h21,2,len h21 -'1)).(len h0 -len h11)
                     by A21,A40,A51,FINSEQ_1:36;
                    len h0-len h11<= len (mid(h21,2,len h21 -'1))
                                             by A40;
                  then A1032:h0.len h0=h21.(len h0-'len h11 +2-'1)
                             by A44,A45,A57,A58,A1031,JORDAN3:27;
                     0<=len h0-'len h11 by NAT_1:18;
                  then 0+2<=len h0-'len h11 +2 by AXIOMS:24;
                  then A1033:2-'1<=(len h0-'len h11 +2-'1) by JORDAN3:5;
                     len h0-'len h11+2<=len h2-2+2
                    by A23,A40,A43,A46,A47,A57,XCMPLX_1:26;
then A1034:            len h0-'len h11 +2-'1 <= len h21 by A23,JORDAN3:7;
                  A1035:len h0-'len h11+2-'1=len h0-'len h11+2-1
                      by A1033,Lm1,JORDAN3:1;
                  set k=len h0-'len h11+2-'1;
                     len h0-'len h11=len h0-len h11 by A23,A40,A43,A46,A47,A50,
JORDAN3:1;
                  then i+1-'len h11<len h0-'len h11 by A946,A1028,REAL_1:54;
                  then i+1-'len h11+2<len h0-'len h11+2 by REAL_1:53;
                  then A1036:            (i+1)-'len h11+2-'1<len h0-'len h11+2
-'1
                             by A1027,A1035,REAL_1:54;
                   k in dom h2 by A22,A1033,A1034,Lm1,FINSEQ_3:27;
              hence contradiction by A22,A55,A68,A999,A1024,A1029,A1030,A1032,
A1036,FUNCT_1:def 8;
            end;
            end;
           hence contradiction;
          end;
   hence Segment(h0/.len h0,h0/.1,P) misses Segment(h0/.i,h0/.(i+1),P)
                   by A1,A39,A65,A948,A950,A952,A961,Th14;
  end;
