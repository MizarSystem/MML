:: On a Dividing Function of the Simple Closed Curve into Segments
::  by Yatsuka Nakamura
::
:: Received June 16, 1998
:: Copyright (c) 1998 Association of Mizar Users

environ

 vocabularies PRE_TOPC, EUCLID, ARYTM_1, COMPTS_1, TOPREAL2, PSCOMP_1, JORDAN6,
      TOPREAL1, JORDAN3, BOOLE, BORSUK_1, RELAT_1, TOPS_2, ORDINAL2, FUNCT_1,
      SUBSET_1, RCOMP_1, FINSEQ_1, TBSP_1, GOBRD10, FINSEQ_4, ARYTM;
 notations TARSKI, XBOOLE_0, SUBSET_1, NUMBERS, XCMPLX_0, REAL_1, NAT_1,
      RCOMP_1, BINARITH, FINSEQ_1, FUNCT_1, RELSET_1, PARTFUN1, SEQ_1,
      FINSEQ_4, TOPREAL1, TOPREAL2, TBSP_1, GOBOARD1, GOBRD10, PRE_TOPC,
      TOPS_2, STRUCT_0, COMPTS_1, EUCLID, JORDAN3, PSCOMP_1, JORDAN5C, JORDAN6,
      TOPMETR, XXREAL_0;
 constructors REAL_1, NAT_1, RCOMP_1, FINSEQ_4, BINARITH, TOPS_2, COMPTS_1,
      TBSP_1, TOPMETR, TOPREAL1, GOBOARD1, PSCOMP_1, GOBRD10, JORDAN3,
      JORDAN5C, JORDAN6;
 registrations XBOOLE_0, RELSET_1, XXREAL_0, XREAL_0, MEMBERED, STRUCT_0,
      PRE_TOPC, EUCLID, TOPREAL1, GOBOARD1, PSCOMP_1, BORSUK_2, SEQ_1;
 requirements REAL, SUBSET, BOOLE, NUMERALS, ARITHM;
 definitions TARSKI, XBOOLE_0, FUNCT_1;
 theorems TARSKI, JORDAN6, TOPREAL1, TOPREAL5, JORDAN5C, UNIFORM1, PRE_TOPC,
      FUNCT_2, TOPS_2, RELAT_1, FUNCT_1, FINSEQ_1, TOPMETR, FINSEQ_2, JORDAN3,
      GOBOARD1, BINARITH, NAT_1, REAL_1, RCOMP_1, FINSEQ_4, GOBRD10, SPRECT_1,
      XBOOLE_0, XBOOLE_1, FINSEQ_3, BORSUK_1, COMPTS_1, RELSET_1, JORDAN5B,
      PARTFUN2, XCMPLX_1, XREAL_1, XXREAL_0, PARTFUN1;
 schemes DOMAIN_1, NAT_1;

begin :: Definition of the Segment and its property

reserve p,p1,p2,p3,q for Point of TOP-REAL 2;

Lm1: 2-'1 = 2-1 by BINARITH:50 .=1;

Lm2:
 for i, j, k be Element of NAT holds i-'k <= j implies i <= j + k
proof let i, j, k be Element of NAT; assume
A1: i-'k <= j;
 per cases;
 suppose
A2: i >= k;
      i-'k +k <= j + k by A1,XREAL_1:8;
 hence i <= j + k by A2,BINARITH:53;
 end;
 suppose
A3: i <= k;
      k <= j + k by NAT_1:11;
 hence i <= j + k by A3,XXREAL_0:2;
end;
end;

Lm3: for i, j, k be Element of NAT holds j + k <= i implies k <= i -' j
proof let i, j, k be Element of NAT; assume
A1: j + k <= i;
 per cases by A1,XXREAL_0:1;
 suppose j + k = i;
 hence k <= i -' j by BINARITH:39;
 end;
 suppose j + k < i;
 hence k <= i -' j by Lm2;
end;
end;

theorem Th1: for P being compact non empty Subset of TOP-REAL 2
 st P is_simple_closed_curve holds
 W-min(P) in Lower_Arc(P) & E-max(P) in Lower_Arc(P) &
 W-min(P) in Upper_Arc(P) & E-max(P) in Upper_Arc(P)
 proof let P be compact non empty Subset of TOP-REAL 2;
   assume P is_simple_closed_curve;
    then Upper_Arc(P) is_an_arc_of W-min(P),E-max(P) &
    Lower_Arc(P) is_an_arc_of E-max(P),W-min(P) by JORDAN6:65;
   hence thesis by TOPREAL1:4;
 end;

theorem Th2: for P being compact non empty Subset of TOP-REAL 2,q
 st P is_simple_closed_curve & LE q,W-min(P),P
holds q=W-min(P)
proof let P be compact non empty Subset of TOP-REAL 2,q;
 assume A1:P is_simple_closed_curve & LE q,W-min(P),P;
   then A2:q in Upper_Arc(P) & W-min(P) in Upper_Arc(P) &
    LE q,W-min(P),Upper_Arc(P),W-min(P),E-max(P) by JORDAN6:def 10;
        Upper_Arc(P) is_an_arc_of W-min(P),E-max(P)
                            by A1,JORDAN6:def 8;
 hence q=W-min(P) by A2,JORDAN6:69;
end;

theorem Th3: for P being compact non empty Subset of TOP-REAL 2,q
 st P is_simple_closed_curve & q in P holds
 LE W-min(P),q,P
proof let P be compact non empty Subset of TOP-REAL 2,q;
  assume A1: P is_simple_closed_curve & q in P;
then A2:q in Upper_Arc(P) \/ Lower_Arc(P) by JORDAN6:65;
   A3: Upper_Arc(P) is_an_arc_of W-min(P),E-max(P) &
    Lower_Arc(P) is_an_arc_of E-max(P),W-min(P) by A1,JORDAN6:65;
     A4: W-min(P) in Upper_Arc(P) by A1,Th1;
   per cases by A2,XBOOLE_0:def 2;
   suppose A5:q in Upper_Arc(P);
     then LE W-min(P),q,Upper_Arc(P),W-min(P),E-max(P) by A3,JORDAN5C:10;
    hence LE W-min(P),q,P by A4,A5,JORDAN6:def 10;
   end;
   suppose A6:q in Lower_Arc(P);
    per cases;
     suppose not q=W-min(P);
      hence LE W-min(P),q,P by A4,A6,JORDAN6:def 10;
     end;
     suppose A7: q=W-min(P);
       then LE W-min(P),q,Upper_Arc(P),W-min(P),E-max(P) by A4,JORDAN5C:9;
      hence LE W-min(P),q,P by A4,A7,JORDAN6:def 10;
     end;
   end;
end;

definition
 let P be compact non empty Subset of TOP-REAL 2,
     q1,q2 be Point of TOP-REAL 2;
 func Segment(q1,q2,P) -> Subset of TOP-REAL 2 equals
 :Def1: {p: LE q1,p,P & LE p,q2,P} if q2<>W-min(P)
           otherwise {p1: LE q1,p1,P or q1 in P & p1=W-min(P)};
  correctness
  proof
       ex B being Subset of TOP-REAL 2 st
    (q2<>W-min(P) implies B={p: LE q1,p,P & LE p,q2,P})&
    (not q2<>W-min(P) implies B={p1: LE q1,p1,P or q1 in P & p1=W-min(P)})
    proof
     per cases;
     suppose A1:q2<>W-min(P);
     defpred P[Point of TOP-REAL 2] means LE q1,$1,P & LE $1,q2,P;
           {p: P[p]} is Subset of
       TOP-REAL 2 from DOMAIN_1:sch 7;
       then reconsider C = {p: LE q1,p,P & LE p,q2,P} as Subset of
         TOP-REAL 2;
           (q2<>W-min(P) implies C={p: LE q1,p,P & LE p,q2,P})&
       (not q2<>W-min(P) implies C={p1: LE q1,p1,P or q1 in P & p1=W-min(P)})
       by A1;
      hence thesis;
     end;
     suppose A2: not q2<>W-min(P);
     defpred P[Point of TOP-REAL 2] means LE q1,$1,P or q1 in P & $1=W-min(P);
           {p1: P[p1]}
       is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
       then reconsider C = {p1: LE q1,p1,P or q1 in P & p1=W-min(P)}
       as Subset of TOP-REAL 2;
           (q2<>W-min(P) implies C={p: LE q1,p,P & LE p,q2,P})&
       (not q2<>W-min(P) implies C={p1: LE q1,p1,P or q1 in P & p1=W-min(P)})
       by A2;
      hence thesis;
     end;
    end;
   hence thesis;
  end;
 end;

theorem
     for P being compact non empty Subset of TOP-REAL 2
 st P is_simple_closed_curve holds
 Segment(W-min(P),E-max(P),P)=Upper_Arc(P) &
 Segment(E-max(P),W-min(P),P)=Lower_Arc(P)
  proof let P be compact non empty Subset of TOP-REAL 2;
   assume A1:P is_simple_closed_curve;
    then A2:E-max(P)<>W-min(P) by TOPREAL5:25;
    A3: Upper_Arc(P) is_an_arc_of W-min(P),E-max(P) by A1,JORDAN6:def 8;
A4:{p: LE W-min(P),p,P & LE p,E-max(P),P} = Upper_Arc(P)
    proof
      A5: {p: LE W-min(P),p,P & LE p,E-max(P),P} c= Upper_Arc(P)
       proof let x be set;assume
              x in {p: LE W-min(P),p,P & LE p,E-max(P),P};
          then consider p such that
          A6: p=x &
          ( LE W-min(P),p,P & LE p,E-max(P),P);
        per cases by A6,JORDAN6:def 10;
        suppose p in Upper_Arc(P) & E-max(P) in Lower_Arc(P)
                                              & not E-max(P)=W-min(P);
             hence x in Upper_Arc(P) by A6;
        end;
        suppose p in Upper_Arc(P) & E-max(P) in Upper_Arc(P) &
                 LE p,E-max(P),Upper_Arc(P),W-min(P),E-max(P);
             hence x in Upper_Arc(P) by A6;
        end;
        suppose A7: p in Lower_Arc(P) & E-max(P) in Lower_Arc(P)
                  & not E-max(P)=W-min(P) &
               LE p,E-max(P),Lower_Arc(P),E-max(P),W-min(P);
                   Lower_Arc(P) is_an_arc_of E-max(P),W-min(P)
                            by A1,JORDAN6:def 9;
               then p=E-max(P) by A7,JORDAN6:69;
             hence x in Upper_Arc(P) by A3,A6,TOPREAL1:4;
        end;
       end;
          Upper_Arc(P) c= {p: LE W-min(P),p,P & LE p,E-max(P),P}
       proof let x be set;assume A8: x in Upper_Arc(P);
         then reconsider p2=x as Point of TOP-REAL 2;
         A9: W-min(P) in Lower_Arc(P) & E-max(P) in Lower_Arc(P) &
         W-min(P) in Upper_Arc(P) & E-max(P) in Upper_Arc(P) by A1,Th1;
               LE W-min(P),p2,Upper_Arc(P),W-min(P),E-max(P)
                                 by A3,A8,JORDAN5C:10;
          then A10: LE W-min(P),p2,P by A8,A9,JORDAN6:def 10;
             LE p2,E-max(P),P by A2,A8,A9,JORDAN6:def 10;
        hence x in {p: LE W-min(P),p,P & LE p,E-max(P),P} by A10;
       end;
     hence thesis by A5,XBOOLE_0:def 10;
    end;
        {p1: LE E-max(P),p1,P or E-max(P) in P & p1=W-min(P)} = Lower_Arc(P)
    proof
      A11: {p1: LE E-max(P),p1,P or E-max(P) in P &
      p1=W-min(P)} c= Lower_Arc(P)
       proof let x be set;assume
              x in {p1: LE E-max(P),p1,P or E-max(P) in P & p1=W-min(P)};
          then consider p1 such that
          A12: p1=x & (LE E-max(P),p1,P or E-max(P) in P & p1=W-min(P));
        per cases by A12;
        suppose A13: LE E-max(P),p1,P;
         per cases by A12,A13,JORDAN6:def 10;
         suppose x in Lower_Arc(P);
             hence x in Lower_Arc(P);
            end;
         suppose A14: E-max(P) in Upper_Arc(P) & p1 in Upper_Arc(P) &
              LE E-max(P),p1,Upper_Arc(P),W-min(P),E-max(P);
              A15:Upper_Arc(P) is_an_arc_of W-min(P),E-max(P)
                             by A1,JORDAN6:65;
              then LE p1,E-max(P),Upper_Arc(P),W-min(P),E-max(P)
                                       by A14,JORDAN5C:10;
              then A16:p1=E-max(P) by A14,A15,JORDAN5C:12;
                  Lower_Arc(P) is_an_arc_of E-max(P),W-min(P) by A1,
JORDAN6:def 9
;
             hence x in Lower_Arc(P) by A12,A16,TOPREAL1:4;
            end;
          end;
        suppose E-max(P) in P & p1=W-min(P);
            then x in {W-min(P),E-max(P)} by A12,TARSKI:def 2;
            then x in Upper_Arc(P) /\ Lower_Arc(P) by A1,JORDAN6:def 9;
           hence x in Lower_Arc(P) by XBOOLE_0:def 3;
          end;
       end;
          Lower_Arc(P) c= {p1: LE E-max(P),p1,P or E-max(P) in P & p1=W-min(P)}
       proof let x be set;assume A17: x in Lower_Arc(P);
         then reconsider p2=x as Point of TOP-REAL 2;
        Upper_Arc(P) is_an_arc_of W-min(P),E-max(P) by A1,JORDAN6:65;
         then not (E-max P in P & p2=W-min P) implies
          E-max P in Upper_Arc P & p2 in Lower_Arc P & not p2=W-min P
                                 by A17,SPRECT_1:16,TOPREAL1:4;
         then LE E-max(P),p2,P or E-max P in P & p2=W-min P by JORDAN6:def 10;
        hence x in {p1: LE E-max(P),p1,P or E-max(P) in P & p1=W-min(P)};
       end;
     hence thesis by A11,XBOOLE_0:def 10;
    end;
   hence thesis by A2,A4,Def1;
  end;

theorem Th5:
for P being compact non empty Subset of TOP-REAL 2,
 q1,q2 being Point of TOP-REAL 2 st P is_simple_closed_curve & LE q1,q2,P holds
 q1 in P & q2 in P
proof let P be compact non empty Subset of TOP-REAL 2,
 q1,q2 be Point of TOP-REAL 2;
 assume A1: P is_simple_closed_curve & LE q1,q2,P;
  then A2: Upper_Arc(P) \/ Lower_Arc(P)=P by JORDAN6:65;
  per cases by A1,JORDAN6:def 10;
  suppose q1 in Upper_Arc(P) & q2 in Lower_Arc(P);
   hence q1 in P & q2 in P by A2,XBOOLE_0:def 2;
  end;
  suppose q1 in Upper_Arc(P) & q2 in Upper_Arc(P);
   hence q1 in P & q2 in P by A2,XBOOLE_0:def 2;
  end;
  suppose q1 in Lower_Arc(P) & q2 in Lower_Arc(P);
   hence q1 in P & q2 in P by A2,XBOOLE_0:def 2;
  end;
end;

theorem Th6:
for P being compact non empty Subset of TOP-REAL 2,
 q1,q2 being Point of TOP-REAL 2 st P is_simple_closed_curve & LE q1,q2,P holds
 q1 in Segment(q1,q2,P) & q2 in Segment(q1,q2,P)
 proof let P be compact non empty Subset of TOP-REAL 2,
   q1,q2 be Point of TOP-REAL 2;
   assume A1: P is_simple_closed_curve & LE q1,q2,P;
   hereby per cases;
   suppose A2: q2<>W-min(P);
          q1 in P by A1,Th5;
      then LE q1,q1,P by A1,JORDAN6:71;
      then q1 in {p: LE q1,p,P & LE p,q2,P} by A1;
     hence q1 in Segment(q1,q2,P) by A2,Def1;
   end;
   suppose A3: q2=W-min(P);
          q1 in P by A1,Th5;
      then LE q1,q1,P by A1,JORDAN6:71;
      then q1 in {p1: LE q1,p1,P or q1 in P & p1=W-min(P)};
     hence q1 in Segment(q1,q2,P) by A3,Def1;
   end;
   end;
   per cases;
   suppose A4: q2<>W-min(P);
          q2 in P by A1,Th5;
      then LE q2,q2,P by A1,JORDAN6:71;
      then q2 in {p: LE q1,p,P & LE p,q2,P} by A1;
     hence q2 in Segment(q1,q2,P) by A4,Def1;
   end;
   suppose A5: q2=W-min(P);
          q2 in {p1: LE q1,p1,P or q1 in P & p1=W-min(P)} by A1;
     hence q2 in Segment(q1,q2,P) by A5,Def1;
 end;
 end;

theorem Th7:
for P being compact non empty Subset of TOP-REAL 2,
 q1 being Point of TOP-REAL 2 st q1 in P & P is_simple_closed_curve holds
   q1 in Segment(q1,W-min P,P)
 proof let P be compact non empty Subset of TOP-REAL 2,
   q1 be Point of TOP-REAL 2 such that
A1:  q1 in P;
   assume P is_simple_closed_curve;
      then LE q1,q1,P by A1,JORDAN6:71;
      then q1 in {p1: LE q1,p1,P or q1 in P & p1=W-min(P)};
     hence q1 in Segment(q1,W-min P,P) by Def1;
 end;

theorem
     for P being compact non empty Subset of TOP-REAL 2,
 q being Point of TOP-REAL 2
 st P is_simple_closed_curve & q in P
 & q<>W-min(P) holds Segment(q,q,P)={q}
proof let P be compact non empty Subset of TOP-REAL 2,
  q be Point of TOP-REAL 2;
  assume that
A1:P is_simple_closed_curve and
A2: q in P and
A3: q <> W-min P;
      for x being set holds x in Segment(q,q,P) iff x=q
   proof let x be set;
     hereby assume x in Segment(q,q,P);
       then x in {p: LE q,p,P & LE p,q,P} by A3,Def1;
       then ex p st p=x & (LE q,p,P & LE p,q,P);
      hence x=q by A1,JORDAN6:72;
     end;
    assume A4:x=q;
          LE q,q,P by A1,A2,JORDAN6:71;
      then x in {p: LE q,p,P & LE p,q,P} by A4;
     hence x in Segment(q,q,P) by A3,Def1;
   end;
 hence thesis by TARSKI:def 1;
end;

theorem
    for P being compact non empty Subset of TOP-REAL 2,
 q1,q2 being Point of TOP-REAL 2 st
  P is_simple_closed_curve & q1<>W-min(P) & q2<>W-min(P)
 holds not W-min(P) in Segment(q1,q2,P)
proof let P be compact non empty Subset of TOP-REAL 2,
 q1,q2 be Point of TOP-REAL 2;
 assume A1: P is_simple_closed_curve & q1<>W-min(P) & q2<>W-min(P);
  then A2:Segment(q1,q2,P)={p: LE q1,p,P & LE p,q2,P} by Def1;
      now assume W-min(P) in Segment(q1,q2,P);
    then consider p such that A3: p=W-min(P) &(LE q1,p,P & LE p,q2,P) by A2;
         A4: q1 in Upper_Arc(P) & p in Upper_Arc(P) &
            LE q1,p,Upper_Arc(P),W-min(P),E-max(P) by A3,JORDAN6:def 10;
              Upper_Arc(P) is_an_arc_of W-min(P),E-max(P)
                            by A1,JORDAN6:def 8;
   hence contradiction by A1,A3,A4,JORDAN6:69;
  end;
 hence thesis;
end;

theorem Th10:
for P being compact non empty Subset of TOP-REAL 2,
 q1,q2,q3 being Point of TOP-REAL 2
 st P is_simple_closed_curve & LE q1,q2,P & LE q2,q3,P
 & not(q1=q2 & q1=W-min(P)) & q1<>q3 & not(q2=q3 & q2=W-min(P)) holds
 Segment(q1,q2,P)/\ Segment(q2,q3,P)={q2}
  proof let P be compact non empty Subset of TOP-REAL 2,
    q1,q2,q3 be Point of TOP-REAL 2;
    assume A1: P is_simple_closed_curve & LE q1,q2,P & LE q2,q3,P
    & not(q1=q2 & q1=W-min(P)) & q1<>q3 & not(q2=q3 & q2=W-min(P));
    then A2: Upper_Arc(P) is_an_arc_of W-min(P),E-max(P) by JORDAN6:def 8;
     thus Segment(q1,q2,P)/\ Segment(q2,q3,P) c= {q2}
     proof let x be set;
       assume x in Segment(q1,q2,P)/\ Segment(q2,q3,P);
       then A3: x in Segment(q1,q2,P) & x in Segment(q2,q3,P) by XBOOLE_0:def 3
;
        now per cases;
       case q3<>W-min(P);
         then x in {p: LE q2,p,P & LE p,q3,P} by A3,Def1;
         then consider p such that A4: p=x & (LE q2,p,P & LE p,q3,P);
         per cases;
         suppose q2<>W-min(P);
           then x in {p2: LE q1,p2,P & LE p2,q2,P} by A3,Def1;
           then ex p2 st p2=x & (LE q1,p2,P & LE p2,q2,P);
          hence x=q2 by A1,A4,JORDAN6:72;
         end;
         suppose A5:q2=W-min(P);
             then q1 in Upper_Arc(P) & q2 in Upper_Arc(P) &
             LE q1,q2,Upper_Arc(P),W-min(P),E-max(P)
                             by A1,JORDAN6:def 10;
            hence x=q2 by A1,A2,A5,JORDAN6:69;
         end;
       end;
       case A6: q3=W-min(P);
        then x in {p1: LE q2,p1,P or q2 in P & p1=W-min(P)} by A3,Def1;
         then consider p1 such that
         A7:p1=x &(LE q2,p1,P or q2 in P & p1=W-min(P));
                p1 in {p: LE q1,p,P & LE p,q2,P} by A1,A3,A6,A7,Def1;
         then ex p st p=p1 & LE q1,p,P & LE p,q2,P;
        hence x=q2 by A1,A6,A7,JORDAN6:72;
       end;
       end;
      hence x in {q2} by TARSKI:def 1;
     end;
     let x be set;assume x in {q2};
     then A8: x=q2 by TARSKI:def 1;
     then A9: x in Segment(q1,q2,P) by A1,Th6;
         x in Segment(q2,q3,P) by A1,A8,Th6;
     hence thesis by A9,XBOOLE_0:def 3;
  end;

theorem Th11:
for P being compact non empty Subset of TOP-REAL 2,
 q1,q2 being Point of TOP-REAL 2
 st P is_simple_closed_curve & LE q1,q2,P
 & q1 <> W-min P & q2 <> W-min P holds
 Segment(q1,q2,P)/\ Segment(q2,W-min P,P)={q2}
  proof let P be compact non empty Subset of TOP-REAL 2,
    q1,q2 be Point of TOP-REAL 2;
   set q3 = W-min P;
    assume A1: P is_simple_closed_curve & LE q1,q2,P
    & q1<>q3 & not(q2=W-min(P));
     thus Segment(q1,q2,P)/\ Segment(q2,W-min P,P) c= {q2}
     proof let x be set;
       assume x in Segment(q1,q2,P)/\ Segment(q2,q3,P);
       then A2: x in Segment(q1,q2,P) & x in Segment(q2,q3,P) by XBOOLE_0:def 3
;
        then x in {p1: LE q2,p1,P or q2 in P & p1=W-min P} by Def1;
         then consider p1 such that
         A3:p1=x and
A4:       LE q2,p1,P or q2 in P & p1=W-min P;
                p1 in {p: LE q1,p,P & LE p,q2,P} by A1,A2,A3,Def1;
then A5:      ex p st p=p1 & LE q1,p,P & LE p,q2,P;
       per cases by A4;
       suppose LE q2,p1,P;
        then x=q2 by A1,A3,A5,JORDAN6:72;
      hence x in {q2} by TARSKI:def 1;
       end;
       suppose q2 in P & p1=W-min(P);
      hence x in {q2} by A1,A5,Th2;
     end;
     end;
     let x be set;assume x in {q2};
     then A6: x=q2 by TARSKI:def 1;
     then A7: x in Segment(q1,q2,P) by A1,Th6;
         q2 in P by A1,Th5;
     then x in Segment(q2,q3,P) by A1,A6,Th7;
     hence thesis by A7,XBOOLE_0:def 3;
  end;

theorem Th12: for P being compact non empty Subset of TOP-REAL 2,
 q1,q2 being Point of TOP-REAL 2
 st P is_simple_closed_curve & LE q1,q2,P & q1<>q2 & q1<>W-min(P) holds
 Segment(q2,W-min(P),P)/\ Segment(W-min(P),q1,P)={W-min(P)}
 proof let P be compact non empty Subset of TOP-REAL 2,
   q1,q2 be Point of TOP-REAL 2;
   assume A1: P is_simple_closed_curve & LE q1,q2,P & q1<>q2 &
   q1<>W-min(P);
   then A2: q1 in P & q2 in P by Th5;
   thus Segment(q2,W-min(P),P)/\ Segment(W-min(P),q1,P) c= {W-min(P)}
    proof let x be set;
     assume x in Segment(q2,W-min(P),P)/\ Segment(W-min(P),q1,P);
      then A3: x in Segment(q2,W-min(P),P) & x in Segment(W-min(P),q1,P)
                              by XBOOLE_0:def 3;
      then x in {p1: LE q2,p1,P or q2 in P & p1=W-min(P)} by Def1;
      then consider p1 such that A4: p1=x &(LE q2,p1,P or q2 in P & p1=W-min(P)
);
          now per cases by A4;
      case A5:LE q2,p1,P;
            x in {p: LE W-min(P),p,P & LE p,q1,P} by A1,A3,Def1;
        then ex p2 st p2=x & LE W-min(P),p2,P & LE p2,q1,P;
        then LE q2,q1,P by A1,A4,A5,JORDAN6:73;
       hence contradiction by A1,JORDAN6:72;
      end;
      case q2 in P & p1=W-min(P);
       hence x=W-min(P) by A4;
      end;
      end;
     hence x in {W-min(P)} by TARSKI:def 1;
    end;
    let x be set;assume x in {W-min(P)};
    then A6: x=W-min(P) by TARSKI:def 1;
    then x in {p1: LE q2,p1,P or q2 in P & p1=W-min(P)} by A2;
    then A7: x in Segment(q2,W-min(P),P) by Def1;
        LE W-min(P),q1,P by A1,A2,Th3;
    then x in Segment(W-min(P),q1,P) by A1,A6,Th6;
    hence thesis by A7,XBOOLE_0:def 3;
 end;

theorem Th13:
for P being compact non empty Subset of TOP-REAL 2,
  q1,q2,q3,q4 being Point of TOP-REAL 2
  st P is_simple_closed_curve & LE q1,q2,P & LE q2,q3,P & LE q3,q4,P
   & q1<>q2 & q2<>q3 holds
  Segment(q1,q2,P) misses Segment(q3,q4,P)
proof let P be compact non empty Subset of TOP-REAL 2,
  q1,q2,q3,q4 be Point of TOP-REAL 2;
  assume that
A1:P is_simple_closed_curve and
A2: LE q1,q2,P and
A3: LE q2,q3,P and
A4: LE q3,q4,P and
A5: q1<>q2 and
A6: q2<>q3;
  assume A7:Segment(q1,q2,P)/\ Segment(q3,q4,P)<>{};
    consider x being Element of Segment(q1,q2,P)/\ Segment(q3,q4,P);
    A8:x in Segment(q1,q2,P) & x in Segment(q3,q4,P) by A7,XBOOLE_0:def 3;
    per cases;
    suppose q4=W-min(P);
      then q3=W-min(P) by A1,A4,Th2;
     hence contradiction by A1,A3,A6,Th2;
    end;
    suppose q4<>W-min(P);
     then x in {p1: LE q3,p1,P & LE p1,q4,P} by A8,Def1;
     then consider p1 such that A9:p1=x &(LE q3,p1,P & LE p1,q4,P);
         q2<>W-min(P) by A1,A2,A5,Th2;
       then x in {p2: LE q1,p2,P & LE p2,q2,P} by A8,Def1;
       then consider p2 such that A10:p2=x &(LE q1,p2,P & LE p2,q2,P);
           LE q3,q2,P by A1,A9,A10,JORDAN6:73;
      hence contradiction by A1,A3,A6,JORDAN6:72;
    end;
end;

theorem Th14:
for P being compact non empty Subset of TOP-REAL 2,
  q1,q2,q3 being Point of TOP-REAL 2
  st P is_simple_closed_curve & LE q1,q2,P & LE q2,q3,P & q1<>W-min P
   & q1<>q2 & q2<>q3 holds
  Segment(q1,q2,P) misses Segment(q3,W-min P,P)
proof let P be compact non empty Subset of TOP-REAL 2,
  q1,q2,q3 be Point of TOP-REAL 2;
  assume A1:P is_simple_closed_curve & LE q1,q2,P & LE q2,q3,P
  & q1<>W-min P & q1<>q2 & q2<>q3;
  assume A2:Segment(q1,q2,P)/\ Segment(q3,W-min P,P)<>{};
    consider x being Element of Segment(q1,q2,P)/\ Segment(q3,W-min P,P);
    A3:x in Segment(q1,q2,P) & x in Segment(q3,W-min P,P) by A2,XBOOLE_0:def 3;
     then x in {p1: LE q3,p1,P or q3 in P & p1=W-min P} by Def1;
     then consider p1 such that
A4:   p1=x and
A5:   LE q3,p1,P or q3 in P & p1=W-min P;
       q2 <> W-min P by A1,Th2;
  then x in {p: LE q1,p,P & LE p,q2,P} by A3,Def1;
  then ex p3 st p3 = x & LE q1,p3,P & LE p3,q2,P;
  then LE q3,q2,P by A1,A4,A5,Th2,JORDAN6:73;
 hence contradiction by A1,JORDAN6:72;
end;

begin :: A function to divide the simple closed curve

reserve n for Element of NAT;

theorem Th15:
  for P being non empty Subset of TOP-REAL n,
  f being Function of I[01], (TOP-REAL n)|P st P<>{} & f is_homeomorphism
  ex g being Function of I[01],TOP-REAL n st f=g &
  g is continuous & g is one-to-one
proof let P be non empty Subset of TOP-REAL n,
  f be Function of I[01], (TOP-REAL n)|P;
  assume A1: P<>{} & f is_homeomorphism;
  the carrier of (TOP-REAL n)|P = [#]((TOP-REAL n)|P) by PRE_TOPC:12
         .=P by PRE_TOPC:def 10;
  then reconsider g1=f as Function of I[01],TOP-REAL n by FUNCT_2:9;
A2:  [#]TOP-REAL n <> {} & [#]((TOP-REAL n)|P) <> {};
    A3:the carrier of (TOP-REAL n)|P = [#]((TOP-REAL n)|P) by PRE_TOPC:12;
    A4:[#]((TOP-REAL n)|P)= P by PRE_TOPC:def 10;
    A5:f is one-to-one & f is continuous & f" is continuous
                                  by A1,TOPS_2:def 5;
  for P2 being Subset of TOP-REAL n st
    P2 is open holds g1"P2 is open
  proof let P2 be Subset of TOP-REAL n;
    assume A6: P2 is open;
    reconsider B1=P2 /\ P as Subset of (TOP-REAL n)|P by A3,A4,XBOOLE_1:17;
     B1 is open by A4,A6,TOPS_2:32;
     then A7:f"B1 is open by A2,A5,TOPS_2:55;
     A8:f"B1 = f"P2 /\ f"P by FUNCT_1:137;
     f"(rng f) c= f"P by A3,A4,RELAT_1:178;
     then A9:dom f c= f"P by RELAT_1:169;
     f"P c= dom f by RELAT_1:167;
     then A10:f"P=dom f by A9,XBOOLE_0:def 10;
     f"P2 c= dom f by RELAT_1:167;
    hence g1"P2 is open by A7,A8,A10,XBOOLE_1:28;
  end;
  then g1 is continuous by A2,TOPS_2:55;
 hence thesis by A5;
end;

theorem Th16:
  for P being non empty Subset of TOP-REAL n,
  g being Function of I[01], (TOP-REAL n) st g is continuous one-to-one
   & rng g = P
  ex f being Function of I[01],(TOP-REAL n)|P st f=g &
   f is_homeomorphism
proof let P be non empty Subset of TOP-REAL n,
  g be Function of I[01], TOP-REAL n;
  assume that
A1: g is continuous one-to-one and
A2: rng g = P;
    the carrier of (TOP-REAL n)|P = [#]((TOP-REAL n)|P) by PRE_TOPC:12;
   then A3: the carrier of (TOP-REAL n)|P = P by PRE_TOPC:def 10;
  then reconsider f=g as Function of I[01],(TOP-REAL n)|P by A2,FUNCT_2:8;
 take f;
 thus f = g;
A4: dom f = the carrier of I[01] by FUNCT_2:def 1
      .= [#]I[01] by PRE_TOPC:12;
A5: rng f = [#]((TOP-REAL n)|P) by A2,PRE_TOPC:def 10;
A6: [#]((TOP-REAL n)|P)= P by PRE_TOPC:def 10;
A7: [#]TOP-REAL n<>{};
  for P2 being Subset of (TOP-REAL n)|P st
    P2 is open holds f"P2 is open
  proof let P2 be Subset of (TOP-REAL n)|P;
   assume P2 is open;
    then consider C being Subset of TOP-REAL n such that
A8:  C is open and
A9:  C /\ [#]((TOP-REAL n)|P) = P2 by TOPS_2:32;
A10: f"C c= [#]I[01] by PRE_TOPC:14;
    g"P = [#]I[01] by A3,A4,RELSET_1:38;
    then f"P2 = f"C /\ [#]I[01] by A6,A9,FUNCT_1:137
         .= f"C by A10,XBOOLE_1:28;
    hence f"P2 is open by A1,A7,A8,TOPS_2:55;
  end;
  then A11: f is continuous by A6,TOPS_2:55;
      (TOP-REAL n)|P is_T2 by TOPMETR:3;
 hence thesis by A1,A4,A5,A11,COMPTS_1:26;
end;

registration
 cluster increasing -> one-to-one FinSequence of REAL;
 coherence
 proof let f be FinSequence of REAL;
   assume A1:f is increasing;
    let x,y be set;assume A2: x in dom f & y in dom f & f.x=f.y;
      then reconsider nx=x,ny=y as Element of NAT;
      A3: nx<=ny by A1,A2,GOBOARD1:def 1;
            nx>=ny by A1,A2,GOBOARD1:def 1;
     hence x=y by A3,REAL_1:def 5;
 end;
end;

theorem Th17:
 for f being FinSequence of REAL st
 f is increasing holds f is one-to-one
 proof let f be FinSequence of REAL;
   assume f is increasing;
    then reconsider f as increasing FinSequence of REAL;
       f is one-to-one;
  hence thesis;
 end;

Lm4: now
  let h2 be Element of NAT;
      h2<h2+1 by NAT_1:13;
  then h2-1<h2+1-1 by XREAL_1:11;
  then h2-1-1<h2-1 & h2-1<h2 by XREAL_1:11;
  hence h2-1-1<h2 by XXREAL_0:2;
end;

Lm5: 0 in [.0,1.] & 1 in [.0,1.] by RCOMP_1:15;

theorem Th18:
 for A being Subset of TOP-REAL 2,
     p1,p2 being Point of TOP-REAL 2
  st A is_an_arc_of p1,p2
 ex g being Function of I[01], TOP-REAL 2 st
  g is continuous one-to-one & rng g = A & g.0 = p1 & g.1 = p2
 proof let A be Subset of TOP-REAL 2,
     p1,p2 being Point of TOP-REAL 2;
  assume
A1: A is_an_arc_of p1,p2;
   then reconsider A' = A as non empty Subset of TOP-REAL 2
                     by TOPREAL1:4;
   consider f being Function of I[01], (TOP-REAL 2)|A' such that
A2: f is_homeomorphism & f.0 = p1 & f.1 = p2 by A1,TOPREAL1:def 2;
A3: rng f=[#]((TOP-REAL 2)|A') by A2,TOPS_2:def 5;
   consider g being Function of I[01], TOP-REAL 2 such that
A4: f=g and
A5: g is continuous one-to-one by A2,Th15;
  take g;
  thus g is continuous one-to-one by A5;
  thus rng g = A by A3,A4,PRE_TOPC:def 10;
  thus thesis by A2,A4;
 end;

theorem Th19:
 for P being non empty Subset of TOP-REAL 2,
     p1, p2, q1, q2 being Point of TOP-REAL 2,
     g being Function of I[01], TOP-REAL 2,
     s1, s2 being Real st
  P is_an_arc_of p1,p2 & g is continuous one-to-one & rng g = P
  & g.0 = p1 & g.1 = p2
  & g.s1 = q1 & 0 <= s1 & s1 <= 1 & g.s2 = q2 & 0 <= s2 & s2 <= 1 & s1 <= s2
 holds LE q1,q2,P,p1,p2
proof let P be non empty Subset of TOP-REAL 2,
     p1, p2, q1, q2 be Point of TOP-REAL 2,
     g be Function of I[01], TOP-REAL 2,
     s1, s2 be Real such that
A1: P is_an_arc_of p1,p2 and
A2: g is continuous one-to-one and
A3: rng g = P;
      ex f being Function of I[01],(TOP-REAL 2)|P st
   f=g & f is_homeomorphism by A2,A3,Th16;
 hence thesis by A1,JORDAN5C:8;
end;

theorem Th20:
 for P being non empty Subset of TOP-REAL 2,
     p1, p2, q1, q2 being Point of TOP-REAL 2,
     g being Function of I[01], TOP-REAL 2,
     s1, s2 being Real st
  g is continuous one-to-one & rng g = P
  & g.0 = p1 & g.1 = p2
  & g.s1 = q1 & 0 <= s1 & s1 <= 1 & g.s2 = q2 & 0 <= s2 & s2 <= 1
  & LE q1,q2,P,p1,p2
 holds s1 <= s2
proof
 let P be non empty Subset of TOP-REAL 2,
     p1, p2, q1, q2 be Point of TOP-REAL 2,
     g be Function of I[01], TOP-REAL 2,
     s1, s2 be Real such that
A1: g is continuous one-to-one and
A2: rng g = P;
      ex f being Function of I[01],(TOP-REAL 2)|P st
   f=g & f is_homeomorphism by A1,A2,Th16;
 hence thesis by JORDAN5C:def 3;
end;

theorem :: Dividing simple closed curve into segments.
     for P being compact non empty Subset of TOP-REAL 2, e being Real
   st P is_simple_closed_curve & e > 0
   ex h being FinSequence of the carrier of TOP-REAL 2
   st h.1=W-min(P) & h is one-to-one & 8<=len h & rng h c= P
   &(for i being Element of NAT st 1<=i & i<len h holds LE h/.i,h/.(i+1),P)
   &(for i being Element of NAT,W being Subset of Euclid 2
   st 1<=i & i<len h & W=Segment(h/.i,h/.(i+1),P) holds
   diameter(W)<e)
   & (for W being Subset of Euclid 2 st
   W=Segment(h/.len h,h/.1,P)  holds diameter(W)<e)
   & (for i being Element of NAT st 1<=i & i+1<len h holds
    Segment(h/.i,h/.(i+1),P)/\ Segment(h/.(i+1),h/.(i+2),P)={h/.(i+1)})
   & Segment(h/.len h,h/.1,P)/\ Segment(h/.1,h/.2,P)={h/.1}
   & Segment(h/.(len h-' 1),h/.len h,P)/\ Segment(h/.len h,h/.1,P)={h/.len h}
   & Segment(h/.(len h-'1),h/.len h,P) misses Segment(h/.1,h/.2,P)
  &(for i,j being Element of NAT st 1<=i & i < j & j < len h &
   not(i,j are_adjacent1)
    holds Segment(h/.i,h/.(i+1),P) misses Segment(h/.j,h/.(j+1),P))
  & (for i being Element of NAT st 1 < i & i+1 < len h holds
      Segment(h/.len h,h/.1,P) misses Segment(h/.i,h/.(i+1),P))
 proof
   let P be compact non empty Subset of TOP-REAL 2, e be Real;
   assume
A1: P is_simple_closed_curve & e > 0;
    then A2: Upper_Arc P is_an_arc_of W-min P, E-max P by JORDAN6:def 8;
    then consider g1 being Function of I[01], TOP-REAL 2 such that
A3:  g1 is continuous one-to-one and
A4: rng g1 = Upper_Arc P and
A5: g1.0 = W-min P & g1.1 = E-max P by Th18;
A6: dom g1 =[.0,1.] by BORSUK_1:83,FUNCT_2:def 1;
A7: 0 in dom g1 & 1 in dom g1 by Lm5,BORSUK_1:83,FUNCT_2:def 1;
A8: E-max P in Upper_Arc P & W-min P in Upper_Arc P by A1,Th1;
   consider h1 being FinSequence of REAL such that
   A9: h1.1=0 & h1.len h1=1 & 5<=len h1 & rng h1 c= the carrier of I[01]
    & h1 is increasing
    &(for i being Element of NAT,Q being Subset of I[01],
    W being Subset of Euclid 2
    st 1<=i & i<len h1 & Q=[.h1/.i,h1/.(i+1).]
    & W=g1.:Q holds diameter(W)<e) by A1,A3,A5,UNIFORM1:15;
    A10:h1 is one-to-one by A9,Th17;
A11: Lower_Arc P is_an_arc_of E-max P, W-min P by A1,JORDAN6:def 9;
    then consider g2 being Function of I[01], TOP-REAL 2 such that
A12:  g2 is continuous one-to-one and
A13: rng g2 = Lower_Arc P and
A14: g2.0 = E-max P & g2.1 = W-min P by Th18;
A15: dom g2 = [.0,1.] by BORSUK_1:83,FUNCT_2:def 1;
   consider h2 being FinSequence of REAL such that
   A16: h2.1=0 & h2.len h2=1 & 5<=len h2 & rng h2 c= the carrier of I[01]
    & h2 is increasing
    &(for i being Element of NAT,Q being Subset of I[01],
    W being Subset of Euclid 2
    st 1<=i & i<len h2 & Q=[.h2/.i,h2/.(i+1).]
    & W=g2.:Q holds diameter(W)<e) by A1,A12,A14,UNIFORM1:15;
A17: len h2-1-1<len h2 by Lm4;
    A18:h2 is one-to-one by A16,Th17;
        h1 is FinSequence of the carrier of I[01] by A9,FINSEQ_1:def 4;
    then reconsider h11=g1*h1 as FinSequence of the carrier of TOP-REAL 2
                                                 by FINSEQ_2:36;
    A19:rng h1 c= dom g1 by A9,FUNCT_2:def 1;
    then A20:dom h1=dom h11 by RELAT_1:46;
    then A21: len h1=len h11 by FINSEQ_3:31;
        h2 is FinSequence of the carrier of I[01] by A16,FINSEQ_1:def 4;
    then reconsider h21=g2*h2 as FinSequence of the carrier of TOP-REAL 2
                                                 by FINSEQ_2:36;
        dom g2=the carrier of I[01] by FUNCT_2:def 1;
    then A22:dom h2=dom h21 by A16,RELAT_1:46;
    then A23: len h2=len h21 by FINSEQ_3:31;
A24: 1<=len h1 by A9,XXREAL_0:2;
    then A25: 1 in dom h1 by FINSEQ_3:27;
A26:len h1 in dom h1 by A24,FINSEQ_3:27;
    A27: 1<=len h2 by A16,XXREAL_0:2;
    then A28:1 in dom h2 by FINSEQ_3:27;
A29: len h2 in dom h2 by A27,FINSEQ_3:27;
A30: h21.1=E-max P by A14,A16,A28,FUNCT_1:23;
A31: h21.len h2=W-min P by A14,A16,A29,FUNCT_1:23;
    A32:1 in dom g2 by Lm5,BORSUK_1:83,FUNCT_2:def 1;
    A33:dom g1=[.0,1.] by BORSUK_1:83,FUNCT_2:def 1;
    then A34:1 in dom (g1*h1) by A9,A25,Lm5,FUNCT_1:21;
A35:len h1 in dom h1 by A24,FINSEQ_3:27;
        h1.len h1 in dom g1 by A9,A33,RCOMP_1:48;
    then A36:len h1 in dom (g1*h1) by A26,FUNCT_1:21;
    then A37: h11.len h1=E-max(P) by A5,A9,FUNCT_1:22;
    reconsider h0=h11^(mid(h21,2,len h21-' 1))
                as FinSequence of the carrier of TOP-REAL 2;
A38: h11.1=W-min P by A5,A9,A34,FUNCT_1:22;
   take h0;
   thus
A39: h0.1=W-min P by A34,A38,FINSEQ_1:def 7;
    A40:len h0=len h11+len (mid(h21,2,len h21 -'1)) by FINSEQ_1:35;
        2<=len h21 by A16,A23,XXREAL_0:2;
then A41:1+1-1<=len h21-1 by XREAL_1:11;
    then A42:len h21-'1=len h21 -1 by BINARITH:def 3;
        len h21<=len h21 +1 by NAT_1:12;
    then len h21 -1<=len h21 +1-1 by XREAL_1:11;
    then A43:2<=len h21 & 1<=len h21-'1 & len h21-'1<=len h21
                              by A16,A23,A41,BINARITH:def 3,XXREAL_0:2;
        3<len h21 by A16,A23,XXREAL_0:2;
    then A44: 2+1-1<len h21 -1 by XREAL_1:11;
    then A45:2<len h21 -'1 by A41,BINARITH:57;
    then A46:len h21 -'1-'2=len h21 -'1-2 by BINARITH:50;
    A47:len (mid(h21,2,len h21 -'1))
                          =(len h21-'1)-'2+1 by A43,A45,JORDAN3:27;
    then A48:len h0=len h1+(len h2-2) by A20,A23,A40,A42,A46,FINSEQ_3:31;
                   A49: 3+2-2<=len h2 -2 by A16,XREAL_1:11;
                 then A50: 1<=len h2 -2 by XXREAL_0:2;
then A51:   len h1+1<=len h0 by A21,A23,A40,A42,A46,A47,XREAL_1:9;
        then A52:   len h0>len h1 by NAT_1:13;
       then A53:     1<len h0 by A24,XXREAL_0:2;
        then A54:    len h0 in dom h0 by FINSEQ_3:27;
        then A55:    h0/.len h0=h0.len h0 by PARTFUN1:def 8;
A56:   1<=len h0-len h1 by A48,A49,XXREAL_0:2;
A57: len h0-len h11=len h0-'len h11 by A21,A52,BINARITH:50;
A58:  2<len h1 by A9,XXREAL_0:2;
    then A59:2 in dom h1 by FINSEQ_3:27;
    A60: 1+1<=len h0 by A52,A58,XXREAL_0:2;
    then A61:2 in dom h0 by FINSEQ_3:27;
    A62:h0.2=h11.2 by A21,A58,FINSEQ_1:85;
A63:  1 in dom h0 by A53,FINSEQ_3:27;
then A64: h0/.1 = h0.1 by PARTFUN1:def 8;
A65: h0/.1=W-min(P) by A39,A63,PARTFUN1:def 8;
    A66:h11 is one-to-one by A3,A10,FUNCT_1:46;
    A67:h21 is one-to-one by A12,A18,FUNCT_1:46;
   thus
A68:  h0 is one-to-one
     proof let x,y be set;assume
     A69: x in dom h0 & y in dom h0 & h0.x=h0.y;
       then reconsider nx=x,ny=y as Element of NAT;
       A70:1<=nx & nx<=len h0 by A69,FINSEQ_3:27;
       A71:1<=ny & ny<=len h0 by A69,FINSEQ_3:27;
       per cases;
       suppose nx<=len h1;
         then A72:nx in dom h1 by A70,FINSEQ_3:27;
then A73:      h1.nx in rng h1 by FUNCT_1:def 5;
         A74:h0.nx=h11.nx by A20,A72,FINSEQ_1:def 7
            .=g1.(h1.nx) by A20,A72,FUNCT_1:22;
         then A75:h0.nx in Upper_Arc(P) by A4,A19,A73,FUNCT_1:def 5;
         per cases;
         suppose ny<=len h1;
           then A76:ny in dom h1 by A71,FINSEQ_3:27;
then A77:        h1.ny in rng h1 by FUNCT_1:def 5;
               h0.ny=h11.ny by A20,A76,FINSEQ_1:def 7
              .=g1.(h1.ny) by A76,FUNCT_1:23;
           then h1.nx=h1.ny by A3,A19,A69,A73,A74,A77,FUNCT_1:def 8;
          hence x=y by A10,A72,A76,FUNCT_1:def 8;
         end;
         suppose A78:ny>len h1;
           then A79:len h1 +1<=ny by NAT_1:13;
           A80:len h11+1<=ny & ny<=len h11 + len (mid(h21,2,len h21 -'1))
                                 by A21,A71,A78,FINSEQ_1:35,NAT_1:13;
           then A81:h0.ny=(mid(h21,2,len h21 -'1)).(ny -len h11) by FINSEQ_1:36
;
           A82:ny-len h11=ny-'len h11 by A21,A78,BINARITH:50;
A83:        ny-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                         by A80,XREAL_1:11;
             A84: len h1 +1-len h1<=ny-len h1 by A79,XREAL_1:11;
           then A85:1<=ny-'len h11 & ny-'len h11<=len mid(h21,2,len h21 -'1)
                             by A21,A78,A83,BINARITH:50;
           A86:h0.ny=h21.(ny-'len h11 +2-'1)
                             by A21,A43,A45,A81,A82,A83,A84,JORDAN3:27;
           A87: 1+1<=ny-'len h11+1+1-1 by A85,XREAL_1:8;
               0<=ny-'len h11 by NAT_1:2;
then A88:        0+2<=ny-'len h11 +2 by XREAL_1:8;
               ny-len h11<=len h1+(len h2-2)-len h11 by A21,A23,A40,A42,A46,A47
,A71,XREAL_1:11;
           then A89: ny-'len h11+2<=len h2-2+2 by A21,A82,XREAL_1:8;
           then A90:ny-'len h11+2-1<=len h2-1 by XREAL_1:11;
           A91:1<=(ny-'len h11 +2-'1) & (ny-'len h11 +2-'1)<=len h21
                      by A23,A88,A89,Lm1,BINARITH:60,62;
           then A92:(ny-'len h11 +2-'1) in dom h21 by FINSEQ_3:27;
           then h0.ny in rng h21 by A86,FUNCT_1:def 5;
           then h0.ny in rng g2 by FUNCT_1:25;
           then h0.nx in Upper_Arc(P)/\ Lower_Arc(P)
                         by A13,A69,A75,XBOOLE_0:def 3;
then A93:         h0.nx in {W-min(P),E-max(P)} by A1,JORDAN6:65;
           A94:ny-'len h11+2-'1<=len h2-1 by A90,A91,BINARITH:57;
           A95:2<=ny-'len h11+2-'1 by A87,A91,BINARITH:57;
           per cases by A93,TARSKI:def 2;
           suppose h0.nx=W-min(P);
             then h21.(ny-'len h11 +2-'1)=W-min(P)
               by A21,A43,A45,A69,A81,A82,A83,A84,JORDAN3:27;
             then len h21=(ny-'len h11 +2-'1)
                         by A22,A23,A29,A31,A67,A92,FUNCT_1:def 8;
             then len h21+1<=len h21-1+1 by A23,A94,XREAL_1:8;
             then len h21+1-len h21<=len h21 -len h21 by XREAL_1:11;
             then len h21+1-len h21<=0;
            hence x=y;
           end;
           suppose h0.nx=E-max(P);
             then 1=(ny-'len h11 +2-'1)
                       by A22,A28,A30,A67,A69,A86,A92,FUNCT_1:def 8;
            hence x=y by A95;
           end;
         end;
       end;
       suppose A96:nx>len h1;
         then A97:len h1 +1<=nx by NAT_1:13;
         A98:len h11+1<=nx & nx<=len h11 + len (mid(h21,2,len h21 -'1))
                            by A21,A70,A96,FINSEQ_1:35,NAT_1:13;
         then A99:h0.nx=(mid(h21,2,len h21 -'1)).(nx -len h11) by FINSEQ_1:36;
         A100:nx-len h11=nx-'len h11 by A21,A96,BINARITH:50;
A101:     nx-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                         by A98,XREAL_1:11;
           A102: len h1 +1-len h1<=nx-len h1 by A97,XREAL_1:11;
         then A103:1<=nx-'len h11 & nx-'len h11<=len mid(h21,2,len h21 -'1)
                             by A21,A96,A101,BINARITH:50;
         A104:h0.nx=h21.(nx-'len h11 +2-'1)
                             by A21,A43,A45,A99,A100,A101,A102,JORDAN3:27;
         A105: 1+1<=nx-'len h11+1+1-1 by A103,XREAL_1:8;
             0<=nx-'len h11 by NAT_1:2;
then A106:    0+2<=nx-'len h11 +2 by XREAL_1:8;
             nx-len h11<=len h1+(len h2-2)-len h11 by A21,A23,A40,A42,A46,A47
,A70,XREAL_1:11;
         then A107: nx-'len h11+2<=len h2-2+2 by A21,A100,XREAL_1:8;
         then A108:nx-'len h11+2-1<=len h2-1 by XREAL_1:11;
         A109:1<=(nx-'len h11 +2-'1) & (nx-'len h11 +2-'1)<=len h21
                      by A23,A106,A107,Lm1,BINARITH:60,62;
         then A110:(nx-'len h11 +2-'1) in dom h21 by FINSEQ_3:27;
         then h0.nx in rng h21 by A104,FUNCT_1:def 5;
         then A111:h0.nx in Lower_Arc(P) by A13,FUNCT_1:25;
         per cases;
         suppose ny<=len h1;
           then A112:ny in dom h1 by A71,FINSEQ_3:27;
then A113:      h1.ny in rng h1 by FUNCT_1:def 5;
               h0.ny=h11.ny by A20,A112,FINSEQ_1:def 7
              .=g1.(h1.ny) by A20,A112,FUNCT_1:22;
           then h0.ny in rng g1 by A19,A113,FUNCT_1:def 5;
           then h0.ny in Upper_Arc(P)/\ Lower_Arc(P) by A4,A69,A111,
XBOOLE_0:def 3;
           then A114:       h0.ny in {W-min(P),E-max(P)} by A1,JORDAN6:65;
           A115:nx-'len h11+2-'1<=len h2-1 by A108,A109,BINARITH:57;
           A116:2<=nx-'len h11+2-'1 by A105,A109,BINARITH:57;
           per cases by A114,TARSKI:def 2;
           suppose h0.ny=W-min(P);
             then len h21=(nx-'len h11 +2-'1)
                     by A22,A23,A29,A31,A67,A69,A104,A110,FUNCT_1:def 8;
             then len h21+1<=len h21-1+1 by A23,A115,XREAL_1:8;
             then len h21+1-len h21<=len h21 -len h21 by XREAL_1:11;
             then len h21+1-len h21<=0;
            hence x=y;
           end;
           suppose h0.ny=E-max(P);
             then h21.(nx-'len h11 +2-'1)=E-max(P)
               by A21,A43,A45,A69,A99,A100,A101,A102,JORDAN3:27;
             then 1=(nx-'len h11 +2-'1)
                         by A22,A28,A30,A67,A110,FUNCT_1:def 8;
            hence x=y by A116;
           end;
         end;
         suppose A117:ny>len h1;
           then A118:len h1 +1<=ny by NAT_1:13;
           then A119:h0.ny=(mid(h21,2,len h21 -'1)).(ny -len h11)
             by A21,A40,A71,FINSEQ_1:36;
           A120:ny-len h11=ny-'len h11 by A21,A117,BINARITH:50;
             A121: ny-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len h11
             by A40,A71,XREAL_1:11;
               len h1 +1-len h1<=ny-len h1 by A118,XREAL_1:11;
           then A122:h0.ny=h21.(ny-'len h11 +2-'1)
                             by A21,A43,A45,A119,A120,A121,JORDAN3:27;
               0<=ny-'len h11 by NAT_1:2;
then A123:        0+2<=ny-'len h11 +2 by XREAL_1:8;
               ny-len h11<=len h1+(len h2-2)-len h11 by A21,A23,A40,A42,A46,A47
,A71,XREAL_1:11;
           then ny-'len h11+2<=len h2-2+2 by A21,A120,XREAL_1:8;
           then A124:1<=(ny-'len h11 +2-'1) & (ny-'len h11 +2-'1)<=len h21
                         by A23,A123,Lm1,BINARITH:60,62;
           then (ny-'len h11 +2-'1) in dom h21 by FINSEQ_3:27;
           then nx-'len h1+2-'1=ny-'len h1+2-'1
                           by A21,A67,A69,A104,A110,A122,FUNCT_1:def 8;
           then nx-'len h1+2-1=ny-'len h1+2-'1 by A21,A109,BINARITH:57;
           then nx-'len h1+(2-1)=ny-'len h1+2-1 by A21,A124,BINARITH:57;
           then len h1+nx-len h1=len h1+(ny-len h1) by A21,A100,A120,
XCMPLX_1:29;
          hence x=y;
         end;
       end;
     end;
then A125: h0/.len h0 <> W-min P by A24,A39,A52,A54,A55,A63,FUNCT_1:def 8;
        3+2-2<=len h2 -2 by A16,XREAL_1:11;
    then A126: 5+3<=len h1+(len h2 -2) by A9,XREAL_1:9;
   hence 8<=len h0 by A20,A23,A40,A42,A46,A47,FINSEQ_3:31;
     A127:rng (g1*h1) c= rng g1 by RELAT_1:45;
     A128:rng (mid(h21,2,len h21 -'1)) c= rng h21 by JORDAN3:28;
         rng (g2*h2) c= rng g2 by RELAT_1:45;
     then rng (mid(h21,2,len h21 -'1)) c= rng g2 by A128,XBOOLE_1:1;
     then rng h11 \/ rng (mid(h21,2,len h21 -'1)) c= Upper_Arc(P) \/
 Lower_Arc(P)
                 by A4,A13,A127,XBOOLE_1:13;
     then rng h0 c=Upper_Arc(P) \/ Lower_Arc(P) by FINSEQ_1:44;
   hence rng h0 c= P by A1,JORDAN6:def 9;
   thus for i being Element of NAT st 1<=i & i<len h0
    holds LE h0/.i,h0/.(i+1),P
     proof let i be Element of NAT;assume A129: 1<=i & i<len h0;
       then A130:i+1<=len h0 by NAT_1:13;
       A131:1<i+1 by A129,NAT_1:13;
       A132:i<i+1 by NAT_1:13;
       per cases;
       suppose A133:i<len h1;
         then A134:i+1<=len h1 by NAT_1:13;
         A135:h0.i=h11.i by A21,A129,A133,FINSEQ_1:85;
         A136:i in dom h1 by A129,A133,FINSEQ_3:27;
         then A137:h0.i=g1.(h1.i) by A135,FUNCT_1:23;
A138:      h1.i in rng h1 by A136,FUNCT_1:def 5;
         then A139:0<=h1.i & h1.i<=1 by A9,BORSUK_1:83,RCOMP_1:48;
         A140:h0.(i+1)=h11.(i+1) by A21,A131,A134,FINSEQ_1:85;
         A141:i+1 in dom h1 by A131,A134,FINSEQ_3:27;
         then A142:h0.(i+1)=g1.(h1.(i+1)) by A140,FUNCT_1:23;
A143:    h1.(i+1) in rng h1 by A141,FUNCT_1:def 5;
         then A144:0<=h1.(i+1) & h1.(i+1)<=1 by A9,BORSUK_1:83,RCOMP_1:48;
         A145:h1.i<h1.(i+1) by A9,A132,A136,A141,GOBOARD1:def 1;
             i in dom h0 by A129,FINSEQ_3:27;
         then A146:h0/.i=h0.i by PARTFUN1:def 8;
             i+1 in dom h0 by A130,A131,FINSEQ_3:27;
         then A147:h0/.(i+1)=h0.(i+1) by PARTFUN1:def 8;
         A148:g1.(h1.i) in rng g1
            by A6,A9,A138,BORSUK_1:83,FUNCT_1:def 5;
         A149:h0.(i+1) in Upper_Arc(P)
         by A4,A6,A9,A142,A143,BORSUK_1:83,FUNCT_1:def 5;
             LE h0/.i,h0/.(i+1),Upper_Arc(P),W-min(P),E-max(P)
            by A2,A3,A4,A5,A137,A139,A142,A144,A145,A146,A147,Th19;
        hence LE h0/.i,h0/.(i+1),P
          by A4,A137,A146,A147,A148,A149,JORDAN6:def 10;
       end;
       suppose A150: i>=len h1;
        per cases by A150,REAL_1:def 5;
         suppose A151:i>len h1;
           then A152:len h1 +1<=i by NAT_1:13;
              len h11+1<=i by A21,A151,NAT_1:13;
           then A153:h0.i=(mid(h21,2,len h21 -'1)).(i -len h11)
                       by A40,A129,FINSEQ_1:36;
           A154:i-len h11=i-'len h11 by A21,A151,BINARITH:50;
A155:        i-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                 by A40,A129,XREAL_1:11;
               len h1 +1-len h1<=i-len h1 by A152,XREAL_1:11;
           then A156:h0.i=h21.(i-'len h11 +2-'1)
                             by A21,A43,A45,A153,A154,A155,JORDAN3:27;
           A157:len h1 +1<=i+1 by A152,NAT_1:13;
           then A158:h0.(i+1)=(mid(h21,2,len h21 -'1)).(i+1 -len h11)
                                      by A21,A40,A130,FINSEQ_1:36;
               i+1>len h11 by A21,A151,NAT_1:13;
           then A159:i+1-len h11=i+1-'len h11 by BINARITH:50;
A160:      i+1-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                  by A40,A130,XREAL_1:11;
             A161: len h1 +1-len h1<=i+1-len h1 by A157,XREAL_1:11;
           then A162:h0.(i+1)=h21.(i+1-'len h11 +2-'1)
                    by A21,A43,A45,A158,A159,A160,JORDAN3:27;
              A163: 1<i+1-'len h11+(2-1) by A21,A159,A161,NAT_1:13;
then A164:       0<i+1-'len h11+2-1;
           A165:i+1-'len h11+2-1=i+1-'len h11+2-'1 by A163,BINARITH:def 3;
               0<=i-'len h11 by NAT_1:2;
then A166:        0+2<=i-'len h11 +2 by XREAL_1:8;
               i-len h11<=len h1+(len h2-2)-len h11 by A21,A23,A40,A42,A46,A47
,A129,XREAL_1:11;
           then A167: i-'len h11+2<=len h2-2+2 by A21,A154,XREAL_1:8;
           then A168:1<=(i-'len h11 +2-'1) & (i-'len h11 +2-'1)<=len h21
                          by A23,A166,Lm1,BINARITH:60,62;
           set j=i-'len h11+2-'1;
A169:      j+1=i-'len h11+1+1-1+1 by A168,BINARITH:57
               .=i-'len h11+2;
           A170:j+1=i-len h11+2-1+1 by A154,A168,BINARITH:57
               .=i+1-'len h11+2-'1 by A159,A164,BINARITH:def 3;
           A171:j in dom h2 by A22,A168,FINSEQ_3:27;
           then A172:h0.i=g2.(h2.j) by A156,FUNCT_1:23;
A173:      h2.j in rng h2 by A171,FUNCT_1:def 5;
           then A174:0<=h2.j & h2.j<=1 by A16,BORSUK_1:83,RCOMP_1:48;
           A175:j<j+1 by NAT_1:13;
           A176:1<j+1 by A168,NAT_1:13;
           then A177:j+1 in dom h2 by A167,A169,FINSEQ_3:27;
           then A178:h0.(i+1)=g2.(h2.(j+1)) by A162,A170,FUNCT_1:23;
A179:      h2.(j+1) in rng h2 by A177,FUNCT_1:def 5;
           then A180:0<=h2.(j+1) & h2.(j+1)<=1 by A16,BORSUK_1:83,RCOMP_1:48;
           A181:h2.j<h2.(j+1) by A16,A171,A175,A177,GOBOARD1:def 1;
               i in dom h0 by A129,FINSEQ_3:27;
           then A182:h0/.i=h0.i by PARTFUN1:def 8;
               i+1 in dom h0 by A130,A131,FINSEQ_3:27;
           then A183:h0/.(i+1)=h0.(i+1) by PARTFUN1:def 8;
           A184:h0.i in Lower_Arc(P)
              by A13,A15,A16,A172,A173,BORSUK_1:83,FUNCT_1:def 5;
           A185:h0.(i+1) in Lower_Arc(P)
             by A13,A15,A16,A178,A179,BORSUK_1:83,FUNCT_1:def 5;
               i+1-len h11<=len h1+(len h2-2)-len h11 by A21,A23,A40,A42,A46
,A47,A130,XREAL_1:11;
           then A186: i+1-'len h11+2<=len h2-2+2 by A21,A159,XREAL_1:8;
           then A187:i+1-'len h11+2-1<=len h2-1 by XREAL_1:11;
               len h2<len h2+1 by NAT_1:13;
           then len h2-1<len h2+1-1 by XREAL_1:11;
           then i+1-'len h11+2-'1<len h2 by A165,A187,XXREAL_0:2;
           then A188:i+1-'len h11+2-'1 in dom h2 by A170,A176,FINSEQ_3:27;
A189:      now assume h0/.(i+1)=W-min(P);
             then len h21=(i+1-'len h11 +2-'1)
                   by A22,A23,A29,A31,A67,A162,A183,A188,FUNCT_1:def 8;
             then len h21+1-len h21<=len h21 -len h21
               by A23,A165,A186,XREAL_1:11;
             then len h21+1-len h21<=0;
            hence contradiction;
           end;
               LE h0/.i,h0/.(i+1),Lower_Arc(P),E-max(P),W-min(P)
            by A11,A12,A13,A14,A172,A174,A178,A180,A181,A182,A183,Th19;
          hence LE h0/.i,h0/.(i+1),P
            by A182,A183,A184,A185,A189,JORDAN6:def 10;
         end;
         suppose A190:i=len h1;
          then A191:h0.(i+1)=(mid(h21,2,len h21 -'1)).(i+1 -len h11)
                                 by A21,A40,A130,FINSEQ_1:36;
           A192:i+1-len h11=i+1-'len h11 by A21,A132,A190,BINARITH:50;
              i+1-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                               by A40,A130,XREAL_1:11;
           then A193:h0.(i+1)=h21.(i+1-'len h11 +2-'1)
                    by A21,A43,A45,A190,A191,A192,JORDAN3:27;
           A194:h0.i=h11.i by A21,A129,A190,FINSEQ_1:85;
               i in dom h1 by A129,A190,FINSEQ_3:27;
           then A195:h0.i=E-max(P) by A5,A9,A190,A194,FUNCT_1:23;
               i in dom h0 by A129,FINSEQ_3:27;
           then h0/.i=E-max(P) by A195,PARTFUN1:def 8;
           then A196:h0/.i in Upper_Arc(P) by A1,Th1;
           set j=i-'len h11+2-'1;
              len h11-'len h11= len h11-len h11 by BINARITH:50.=0;
then A197:      j=2-1 by A21,A190,BINARITH:50;
           then A198:j+1<=len h2 by A16,XXREAL_0:2;
           A199:i+1-'len h11+2-'1=1+2-'1 by A21,A190,BINARITH:39
           .=2 by BINARITH:39;
           A200:j+1 in dom h2 by A197,A198,FINSEQ_3:27;
           then A201:h0.(i+1)=g2.(h2.(j+1)) by A193,A197,A199,FUNCT_1:23;
A202:      h2.(j+1) in rng h2 by A200,FUNCT_1:def 5;
               i+1 in dom h0 by A130,A131,FINSEQ_3:27;
           then A203:h0/.(i+1)=h0.(i+1) by PARTFUN1:def 8;
           A204:h0.(i+1) in Lower_Arc(P)
              by A13,A15,A16,A201,A202,BORSUK_1:83,FUNCT_1:def 5;
               2<=len h21 by A16,A23,XXREAL_0:2;
           then A205:2 in dom h21 by FINSEQ_3:27;
              len h21 <> i+1-'len h11 +2-'1 by A16,A23,A199;
           then h0/.(i+1) <> W-min P
            by A22,A23,A29,A31,A67,A193,A199,A203,A205,FUNCT_1:def 8;
          hence LE h0/.i,h0/.(i+1),P by A196,A203,A204,JORDAN6:def 10;
         end;
       end;
     end;
    thus for i being Element of NAT,W being Subset of Euclid 2
      st 1<=i & i<len h0 & W=Segment(h0/.i,h0/.(i+1),P) holds
      diameter(W)<e
     proof let i be Element of NAT,W be Subset of Euclid 2;
      assume
       A206:1<=i & i<len h0 & W=Segment(h0/.i,h0/.(i+1),P);
       then A207:i+1<=len h0 by NAT_1:13;
       A208:1<i+1 by A206,NAT_1:13;
       A209:i<i+1 by NAT_1:13;
       per cases by REAL_1:def 5;
       suppose A210:i<len h1;
         then A211:i+1<=len h1 by NAT_1:13;
         A212:h0.i=h11.i by A21,A206,A210,FINSEQ_1:85;
         A213:i in dom h1 by A206,A210,FINSEQ_3:27;
         then A214:h11.i=g1.(h1.i) by FUNCT_1:23;
         then A215:h0.i=g1.(h1.i) by A21,A206,A210,FINSEQ_1:85;
A216:    h1.i in rng h1 by A213,FUNCT_1:def 5;
         then A217:0<=h1.i & h1.i<=1 by A9,BORSUK_1:83,RCOMP_1:48;
         A218:h0.(i+1)=h11.(i+1) by A21,A208,A211,FINSEQ_1:85;
         A219:i+1 in dom h1 by A208,A211,FINSEQ_3:27;
         then A220:h0.(i+1)=g1.(h1.(i+1)) by A218,FUNCT_1:23;
A221:      h1.(i+1) in rng h1 by A219,FUNCT_1:def 5;
         then A222:0<=h1.(i+1) & h1.(i+1)<=1 by A9,BORSUK_1:83,RCOMP_1:48;
         A223:h1.i<h1.(i+1) by A9,A209,A213,A219,GOBOARD1:def 1;
             i in dom h0 by A206,FINSEQ_3:27;
         then A224:h0/.i=h0.i by PARTFUN1:def 8;
             i+1 in dom h0 by A207,A208,FINSEQ_3:27;
         then A225:h0/.(i+1)=h0.(i+1) by PARTFUN1:def 8;
         A226:h0.i in Upper_Arc(P)
             by A4,A6,A9,A215,A216,BORSUK_1:83,FUNCT_1:def 5;
         A227:h0.(i+1) in Upper_Arc(P)
           by A4,A6,A9,A220,A221,BORSUK_1:83,FUNCT_1:def 5;
          A228:h1/.i=h1.i by A206,A210,FINSEQ_4:24;
          A229:h1/.(i+1)=h1.(i+1) by A208,A211,FINSEQ_4:24;
         then reconsider Q1=[.h1/.i,h1/.(i+1).]
          as Subset of I[01]
             by A9,A216,A221,A228,BORSUK_1:83,RCOMP_1:16;
         A230:Segment(h0/.i,h0/.(i+1),P) c= g1.:([.h1/.i,h1/.(i+1).])
          proof let x be set;assume
           A231:x in Segment(h0/.i,h0/.(i+1),P);
A232:         h0/.(i+1) <> W-min P
               by A20,A25,A38,A66,A208,A218,A219,A225,FUNCT_1:def 8;
            then x in {p: LE h0/.i,p,P & LE p,h0/.(i+1),P} by A231,Def1;
            then consider p being Point of TOP-REAL 2 such that
            A233:p=x & (LE h0/.i,p,P & LE p,h0/.(i+1),P);
       A234:h0/.i in Upper_Arc(P) & p in Lower_Arc(P)& not p=W-min(P) or
            h0/.i in Upper_Arc(P) & p in Upper_Arc(P) &
             LE h0/.i,p,Upper_Arc(P),W-min(P),E-max(P) or
            h0/.i in Lower_Arc(P) & p in Lower_Arc(P)& not p=W-min(P) &
             LE h0/.i,p,Lower_Arc(P),E-max(P),W-min(P)
                                   by A233,JORDAN6:def 10;
            A235:p in Upper_Arc(P) & h0/.(i+1) in Lower_Arc(P) or
            p in Upper_Arc(P) & h0/.(i+1) in Upper_Arc(P) &
             LE p,h0/.(i+1),Upper_Arc(P),W-min(P),E-max(P) or
            p in Lower_Arc(P) & h0/.(i+1) in Lower_Arc(P)&
             LE p,h0/.(i+1),Lower_Arc(P),E-max(P),W-min(P)
                                   by A233,JORDAN6:def 10;
             now per cases by A211,REAL_1:def 5;
            suppose i+1<len h1;
             then A236:         h0/.(i+1) <> E-max P
                       by A20,A26,A37,A66,A218,A219,A225,FUNCT_1:def 8;
A237:            now assume h0/.(i+1) in Lower_Arc(P);
                  then h0/.(i+1) in Upper_Arc(P)/\ Lower_Arc(P)
                             by A225,A227,XBOOLE_0:def 3;
                  then h0/.(i+1) in {W-min(P),E-max(P)} by A1,JORDAN6:def 9;
                 hence contradiction by A232,A236,TARSKI:def 2;
                end;
              then A238:p in Upper_Arc(P) & h0/.(i+1) in Upper_Arc(P)
                by A233,JORDAN6:def 10;
A239:           LE p,h0/.(i+1),Upper_Arc(P),W-min(P),E-max(P)
                   by A233,A237,JORDAN6:def 10;
                then A240:         p<>E-max(P) by A2,A236,JORDAN6:70;
              per cases by A206,REAL_1:def 5;
              suppose i>1;
then A241:        h0/.i <> W-min P
                  by A20,A25,A38,A66,A213,A214,A215,A224,FUNCT_1:def 8;
A242:         h11.i <> E-max(P) by A20,A26,A37,A66,A210,A213,FUNCT_1:def 8;
                    now assume h0/.i in Lower_Arc(P);
                  then h0/.i in Upper_Arc(P)/\ Lower_Arc(P)
                             by A224,A226,XBOOLE_0:def 3;
                  then h0/.i in {W-min(P),E-max(P)} by A1,JORDAN6:def 9;
                 hence contradiction by A212,A224,A241,A242,TARSKI:def 2;
                end;
                then A243:h0/.i in Upper_Arc(P) & p in Lower_Arc(P)
                 & not p=W-min(P) or
                h0/.i in Upper_Arc(P) & p in Upper_Arc(P) &
                LE h0/.i,p,Upper_Arc(P),W-min(P),E-max(P)
                  by A233,JORDAN6:def 10;
then A244:            p <> W-min P by A2,A241,JORDAN6:69;
A245:             now assume p in Lower_Arc(P);
                then p in Upper_Arc(P)/\ Lower_Arc(P) by A238,XBOOLE_0:def 3;
                then p in {W-min(P),E-max(P)} by A1,JORDAN6:def 9;
                 hence contradiction by A240,A244,TARSKI:def 2;
                end;
                  then consider z being set such that A246:z in dom g1 & p=g1.z
                                   by A4,A243,FUNCT_1:def 5;
                  reconsider rz=z as Real by A6,A246;
                A247:g1.(h1/.i)=h0/.i by A206,A210,A212,A214,A224,FINSEQ_4:24;
                  A248:0<=h1/.i & h1/.i<=1 &
                   g1.(h1/.(i+1))=h0/.(i+1)
                by A206,A208,A210,A211,A217,A220,A225,FINSEQ_4:24;
                       h1.(i+1) in rng h1 by A219,FUNCT_1:def 5;
              then A249:0<=h1/.(i+1) & h1/.(i+1)<=1
                by A9,A229,BORSUK_1:83,RCOMP_1:48;
               take z;
               thus z in dom g1 by A246;
                   A250:0<=rz & rz<=1 by A246,BORSUK_1:83,RCOMP_1:48;
                   then A251:h1/.i<=rz
                  by A3,A4,A5,A243,A245,A246,A247,A248,Th20;
                       rz<=h1/.(i+1)
                    by A3,A4,A5,A239,A246,A248,A249,A250,Th20;
               hence z in [.h1/.i,h1/.(i+1).] by A251,RCOMP_1:48;
               thus x = g1.z by A233,A246;
              end;
              suppose A252:i=1;
                    now per cases;
                case A253:p<>W-min(P);
                  now assume p in Lower_Arc(P);
                    then p in Upper_Arc(P)/\ Lower_Arc(P) by A238,
XBOOLE_0:def 3;
                    then p in {W-min(P),E-max(P)} by A1,JORDAN6:def 9;
                   hence contradiction by A240,A253,TARSKI:def 2;
                  end;
                  then consider z being set such that A254:z in dom g1 & p=g1.z
                                   by A4,A234,FUNCT_1:def 5;
                  reconsider rz=z as Real by A6,A254;
              take rz;
              A255:g1.(h1/.(1+1))=h0/.(1+1)
                  by A211,A220,A225,A252,FINSEQ_4:24;
                       h1.(1+1) in rng h1 by A219,A252,FUNCT_1:def 5;
              then A256:0<=h1/.(1+1) & h1/.(1+1)<=1
              by A9,A229,A252,BORSUK_1:83,RCOMP_1:48;
                   A257:0<=rz & rz<=1 by A254,BORSUK_1:83,RCOMP_1:48;
         A258:h1/.1<=rz by A9,A228,A252,A254,BORSUK_1:83,RCOMP_1:48;
                       rz<=h1/.(1+1)
                   by A3,A4,A5,A239,A252,A254,A255,A256,A257,Th20;
                 hence rz in dom g1
                      & rz in [.h1/.1,h1/.(1+1).]
                      & x = g1.rz by A233,A254,A258,RCOMP_1:48;
                end;
                case A259:p=W-min(P);
                 thus 0 in [.h1/.1,h1/.(1+1).]
                    by A9,A223,A228,A229,A252,RCOMP_1:48;
                 thus x = g1.0 by A5,A233,A259;
                end;
                end;
               hence ex y being set st y in dom g1 &
               y in [.h1/.i,h1/.(i+1).] & x = g1.y by A7,A252;
              end;
            end;
            suppose A260:i+1=len h1;
              then A261:h0/.(i+1)=E-max(P)
                by A5,A9,A26,A218,A225,FUNCT_1:23;
              A262:p in Upper_Arc(P) or p in Lower_Arc(P)
              by A233,JORDAN6:def 10;
A263:           now assume A264:p in Lower_Arc(P)& not p in Upper_Arc(P);
                then LE h0/.(i+1),p,Lower_Arc(P),E-max(P),W-min(P)
                   by A11,A261,JORDAN5C:10;
               hence contradiction by A8,A11,A235,A261,A264,JORDAN5C:12;
              end;
              then A265:LE p,h0/.(i+1),Upper_Arc(P),W-min(P),E-max(P)
                               by A2,A261,A262,JORDAN5C:10;
              per cases;
              suppose A266:p<>E-max(P);
                    now per cases;
                case A267:p<>W-min(P);
A268:               now assume p in Lower_Arc(P);
                    then p in Upper_Arc(P)/\ Lower_Arc(P) by A263,
XBOOLE_0:def 3;
                    then p in {W-min(P),E-max(P)} by A1,JORDAN6:def 9;
                   hence contradiction by A266,A267,TARSKI:def 2;
                  end;
                  then consider z being set such that A269:z in dom g1 & p=g1.z
                                   by A4,A234,FUNCT_1:def 5;
                  reconsider rz=z as Real by A6,A269;
                 take rz;
A270:             g1.(h1/.(i+1))=h0/.(i+1) by A208,A211,A220,A225,FINSEQ_4:24;
                       h1.(i+1) in rng h1 by A219,FUNCT_1:def 5;
              then A271:0<=h1/.(i+1) & h1/.(i+1)<=1
              by A9,A229,BORSUK_1:83,RCOMP_1:48;
                   A272:0<=rz & rz<=1 by A269,BORSUK_1:83,RCOMP_1:48;
                   then A273:h1/.i<=rz
                    by A3,A4,A5,A212,A214,A217,A224,A228,A234,A268,A269,Th20;
                       rz<=h1/.(i+1)
         by A3,A4,A5,A265,A269,A270,A271,A272,Th20;
                 hence rz in dom g1 &
                 rz in [.h1/.i,h1/.(i+1).]
                      & x = g1.rz by A233,A269,A273,RCOMP_1:48;
                end;
                case A274:p=W-min(P);
                  then h11.i=W-min(P) by A2,A212,A224,A234,JORDAN6:69;
                  then i=1 by A20,A25,A38,A66,A213,FUNCT_1:def 8;
                  then 0 in [.h1/.i,h1/.(i+1).]
                    by A9,A223,A228,A229,RCOMP_1:48;
                 hence ex y being set st y in dom g1 &
                 y in [.h1/.i,h1/.(i+1).]
                     & x = g1.y by A5,A7,A233,A274;
                end;
                end;
               hence ex y being set st y in dom g1 &
               y in [.h1/.i,h1/.(i+1).] & x = g1.y;
               end;
               suppose A275:p=E-max(P);
                    1 in [.h1/.i,h1/.(i+1).]
                 by A9,A223,A228,A229,A260,RCOMP_1:48;
               hence ex y being set st
                y in dom g1 & y in [.h1/.i,h1/.(i+1).]
                  & x = g1.y by A5,A33,A233,A275,Lm5;
               end;
            end;
            end;
           hence x in g1.:([.h1/.i,h1/.(i+1).]) by FUNCT_1:def 12;
          end;
             g1.:([.h1/.i,h1/.(i+1).]) c= Segment(h0/.i,h0/.(i+1),P)
          proof let x be set;assume x in g1.:([.h1/.i,h1/.(i+1).]);
            then consider y being set such that
      A276: y in dom g1 & y in [.h1/.i,h1/.(i+1).] & x=g1.y by FUNCT_1:def 12;
            A277:x in Upper_Arc(P) by A4,A276,FUNCT_1:def 5;
            then reconsider p1=x as Point of TOP-REAL 2;
            reconsider sy=y as Real by A276;
             A278:g1.(h1/.i)=h0/.i by A206,A210,A215,A224,FINSEQ_4:24;
             A279:h1/.i<=sy & sy<=h1/.(i+1) by A276,RCOMP_1:48;
             A280:0<=h1/.i & h1/.i<=1 by A206,A210,A217,FINSEQ_4:24;
             A281:0<=sy & sy<=1 by A276,BORSUK_1:83,RCOMP_1:48;
             then A282:             LE h0/.i,p1,Upper_Arc(P),W-min(P),E-max(P)
              by A2,A3,A4,A5,A276,A278,A279,A280,Th19;
                 LE p1,h0/.(i+1),Upper_Arc(P),W-min(P),E-max(P)
           by A2,A3,A4,A5,A220,A222,A225,A229,A276,A279,A281,Th19;
                           then A283: LE h0/.i,p1,P & LE p1,h0/.(i+1),P
                       by A224,A225,A226,A227,A277,A282,JORDAN6:def 10;
A284:       not h0/.(i+1)=W-min P
               by A20,A25,A38,A66,A208,A218,A219,A225,FUNCT_1:def 8;
                x in {p: LE h0/.i,p,P & LE p,h0/.(i+1),P} by A283;
           hence x in Segment(h0/.i,h0/.(i+1),P) by A284,Def1;
          end;
         then W=g1.:Q1 by A206,A230,XBOOLE_0:def 10;
        hence diameter(W)<e by A9,A206,A210;
       end;
       suppose A285:i>len h1;
           then A286:len h1 +1<=i by NAT_1:13;
               len h11+1<=i & i<=len h11 + len (mid(h21,2,len h21 -'1))
                                 by A21,A206,A285,FINSEQ_1:35,NAT_1:13;
           then A287:h0.i=(mid(h21,2,len h21 -'1)).(i -len h11) by FINSEQ_1:36;
           A288:i-len h11=i-'len h11 by A21,A285,BINARITH:50;
A289:       i-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                      by A40,A206,XREAL_1:11;
               len h1 +1-len h1<=i-len h1 by A286,XREAL_1:11;
           then A290:h0.i=h21.(i-'len h11 +2-'1)
                             by A21,A43,A45,A287,A288,A289,JORDAN3:27;
           A291:len h1 +1<=i+1 by A286,NAT_1:13;
           then A292:h0.(i+1)=(mid(h21,2,len h21 -'1)).(i+1 -len h11)
                                      by A21,A40,A207,FINSEQ_1:36;
               i+1>len h11 by A21,A285,NAT_1:13;
           then A293:i+1-len h11=i+1-'len h11 by BINARITH:50;
A294:       i+1-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                         by A40,A207,XREAL_1:11;
             A295: len h1 +1-len h1<=i+1-len h1 by A291,XREAL_1:11;
           then A296:h0.(i+1)=h21.(i+1-'len h11 +2-'1)
                    by A21,A43,A45,A292,A293,A294,JORDAN3:27;
               1<i+1-'len h11+(2-1) by A21,A293,A295,NAT_1:13;
           then A297: 0<i+1-'len h11+2-1;
               0<=i-'len h11 by NAT_1:2;
then A298:      0+2<=i-'len h11 +2 by XREAL_1:8;
               i-len h11<=len h1+(len h2-2)-len h11 by A21,A23,A40,A42,A46,A47
,A206,XREAL_1:11;
           then A299: i-'len h11+2<=len h2-2+2 by A21,A288,XREAL_1:8;
           then A300:i-'len h11+2-1<=len h2-1 by XREAL_1:11;
           A301:1<=(i-'len h11 +2-'1) & (i-'len h11 +2-'1)<=len h21
                         by A23,A298,A299,Lm1,BINARITH:60,62;
               len h2<len h2+1 by NAT_1:13;
           then len h2-1<len h2+1-1 by XREAL_1:11;
           then A302:i-'len h11+2-1<len h2 by A300,XXREAL_0:2;
           A303:i-'len h11+2-'1=i-'len h11+2-1 by A301,BINARITH:57;
           set j=i-'len h11+2-'1;
               len h1 +1<=i by A285,NAT_1:13;
           then len h11+1-len h11<=i-len h11 by A21,XREAL_1:11;
           then 1<=i-'len h11 by BINARITH:57;
           then 1+2<=i-'len h11+2 by XREAL_1:8;
           then 1+2-1<=i-'len h11+2-1 by XREAL_1:11;
           then A304:1<j by A303,XXREAL_0:2;
               i-len h11<len h11+(len h2-2)-len h11 by A23,A40,A42,A46,A47,A206
,XREAL_1:11;
then A305:       i-len h11+2<len h2-2+2 by XREAL_1:8;
           A306:j< len h2 by A301,A302,BINARITH:57;
           A307:j+1=i-'len h11+1+1-1+1 by A301,BINARITH:57
               .=i-'len h11+(1+1);
           A308:j+1 =i+1-'len h11+2-'1 by A288,A293,A297,A303,BINARITH:def 3;
           A309:j in dom h2 by A22,A301,FINSEQ_3:27;
           then A310:h0.i=g2.(h2.j) by A290,FUNCT_1:23;
A311:        h2.j in rng h2 by A309,FUNCT_1:def 5;
           A312:1<j+1 by A301,NAT_1:13;
           then A313:j+1 in dom h2 by A299,A307,FINSEQ_3:27;
then A314:      h0.(i+1)=g2.(h2.(j+1)) by A296,A308,FUNCT_1:23;
A315:        h2.(j+1) in rng h2 by A313,FUNCT_1:def 5;
               i in dom h0 by A206,FINSEQ_3:27;
           then A316:h0/.i=h0.i by PARTFUN1:def 8;
               i+1 in dom h0 by A207,A208,FINSEQ_3:27;
           then A317:h0/.(i+1)=h0.(i+1) by PARTFUN1:def 8;
               g2.(h2.j) in rng g2 by A15,A16,A311,BORSUK_1:83,FUNCT_1:def 5;
           then A318:h0.i in Lower_Arc(P) by A13,A290,A309,FUNCT_1:23;
           A319:h0.(i+1) in Lower_Arc(P)
            by A13,A15,A16,A314,A315,BORSUK_1:83,FUNCT_1:def 5;
A320: 0 <= h2.j by A16,A311,BORSUK_1:83,RCOMP_1:48;
A321: h2.j <= 1 by A16,A311,BORSUK_1:83,RCOMP_1:48;
A322: g2.(h2.(j+1)) = h0/.(i+1) by A296,A308,A313,A317,FUNCT_1:23;
A323: h2.(j+1) <= 1 by A16,A315,BORSUK_1:83,RCOMP_1:48;
          A324:h2/.j=h2.j by A301,A306,FINSEQ_4:24;
          A325:h2/.(j+1)=h2.(j+1) by A299,A307,A312,FINSEQ_4:24;
         then reconsider Q1=[.h2/.j,h2/.(j+1).] as Subset of
I[01]
            by A16,A311,A315,A324,BORSUK_1:83,RCOMP_1:16;
         A326:Segment(h0/.i,h0/.(i+1),P) c= g2.:([.h2/.j,h2/.(j+1).])
          proof let x be set;assume
           A327:x in Segment(h0/.i,h0/.(i+1),P);
                h0/.(i+1) <> W-min P
                   by A22,A29,A31,A67,A288,A296,A305,A307,A308,A313,A317,
FUNCT_1:def 8;
            then x in {p: LE h0/.i,p,P & LE p,h0/.(i+1),P} by A327,Def1;
            then consider p being Point of TOP-REAL 2 such that
            A328:p=x & (LE h0/.i,p,P & LE p,h0/.(i+1),P);
            A329:h0/.i in Upper_Arc(P) & p in Lower_Arc(P)& not p=W-min(P) or
            h0/.i in Upper_Arc(P) & p in Upper_Arc(P) &
             LE h0/.i,p,Upper_Arc(P),W-min(P),E-max(P) or
            h0/.i in Lower_Arc(P) & p in Lower_Arc(P)& not p=W-min(P) &
             LE h0/.i,p,Lower_Arc(P),E-max(P),W-min(P)
                                   by A328,JORDAN6:def 10;
                A330:j<len h2 by A299,A307,NAT_1:13;
              A331: h0/.(i+1) <> E-max P
              by A22,A28,A30,A67,A296,A308,A312,A313,A317,FUNCT_1:def 8;
A332:       h21.(j+1) <> W-min P by A22,A29,A31,A67,A288,A305,A307,A313,
FUNCT_1:def 8;
                    now assume h0/.(i+1) in Upper_Arc(P);
                  then h0/.(i+1) in Upper_Arc(P)/\ Lower_Arc(P)
                             by A317,A319,XBOOLE_0:def 3;
                  then h0/.(i+1) in {W-min(P),E-max(P)} by A1,JORDAN6:def 9;
                 hence contradiction by A296,A308,A317,A331,A332,TARSKI:def 2;
                end;
     then A333:p in Lower_Arc(P) & h0/.(i+1) in Lower_Arc(P)& not
            h0/.(i+1)=W-min(P)
             & LE p,h0/.(i+1),Lower_Arc(P),E-max(P),W-min(P) or
            p in Upper_Arc(P) & h0/.(i+1) in Lower_Arc(P)
                 & not h0/.(i+1)=W-min(P) by A328,JORDAN6:def 10;
A334:        h0/.i <> W-min(P)
                    by A22,A29,A31,A67,A290,A309,A316,A330,FUNCT_1:def 8;
A335:         h21.j <> E-max P by A22,A28,A30,A67,A304,A309,FUNCT_1:def 8;
A336:         now assume h0/.i in Upper_Arc(P);
                  then h0/.i in Upper_Arc(P)/\ Lower_Arc(P)
                                   by A316,A318,XBOOLE_0:def 3;
                  then h0/.i in {W-min(P),E-max(P)} by A1,JORDAN6:def 9;
                 hence contradiction by A290,A316,A334,A335,TARSKI:def 2;
              end;
then A337:         LE h0/.i,p,Lower_Arc P, E-max P, W-min P
                      by A328,JORDAN6:def 10;
A338:         h0/.i <> E-max(P) by A22,A28,A30,A67,A290,A304,A309,A316,
FUNCT_1:def 8;
A339:             now assume p in Upper_Arc(P);
                  then p in Upper_Arc P /\ Lower_Arc P by A329,A336,
XBOOLE_0:def 3;
                  then p in {W-min(P),E-max(P)} by A1,JORDAN6:def 9;
                  then p=W-min(P) or p=E-max(P) by TARSKI:def 2;
                 hence contradiction by A11,A329,A336,A338,JORDAN6:69;
                end;
then A340:           LE p,h0/.(i+1),Lower_Arc(P),E-max(P),W-min(P)
                  by A328,JORDAN6:def 10;
                  consider z being set such that A341:z in dom g2 & p=g2.z
                                   by A13,A333,A339,FUNCT_1:def 5;
                  reconsider rz=z as Real by A15,A341;
                  A342:g2.(h2/.(j+1))=h0/.(i+1)
                      by A296,A308,A313,A317,A325,FUNCT_1:23;
                   A343:0<=h2/.j & h2/.j<=1
                      by A16,A311,A324,BORSUK_1:83,RCOMP_1:48;
                       h2.(j+1) in rng h2 by A313,FUNCT_1:def 5;
                then 0<=rz & rz<=1 & 0<=h2/.(j+1) & h2/.(j+1)<=1
                               by A16,A325,A341,BORSUK_1:83,RCOMP_1:48;
                   then rz<=h2/.(j+1)& h2/.j<=rz
               by A12,A13,A14,A310,A316,A324,A337,A340,A341,A342,A343,Th20;
             then rz in [.h2/.j,h2/.(j+1).] by RCOMP_1:48;
           hence x in g2.:([.h2/.j,h2/.(j+1).]) by A328,A341,FUNCT_1:def 12;
          end;
             g2.:([.h2/.j,h2/.(j+1).]) c= Segment(h0/.i,h0/.(i+1),P)
          proof let x be set;assume x in g2.:([.h2/.j,h2/.(j+1).]);
            then consider y being set such that
A344: y in dom g2 & y in [.h2/.j,h2/.(j+1).] & x=g2.y by FUNCT_1:def 12;
            A345:x in Lower_Arc(P) by A13,A344,FUNCT_1:def 5;
            then reconsider p1=x as Point of TOP-REAL 2;
            reconsider sy=y as Real by A344;
             A346:h2/.j<=sy & sy<=h2/.(j+1) by A344,RCOMP_1:48;
             A347:0<=sy & sy<=1 by A344,BORSUK_1:83,RCOMP_1:48;
A348:         h2.(j+1) <> 1 by A16,A18,A29,A288,A305,A307,A313,FUNCT_1:def 8;
A349:         now assume p1=W-min(P);
             then 1=sy by A12,A14,A32,A344,FUNCT_1:def 8;
             hence contradiction by A323,A325,A346,A348,XXREAL_0:1;
            end;
A350:       h0/.(i+1) <> W-min P
          by A22,A29,A31,A67,A288,A296,A305,A307,A308,A313,A317,FUNCT_1:def 8;
A351:          LE h0/.i,p1,Lower_Arc(P),E-max(P),W-min(P)
                  by A11,A12,A13,A14,A310,A316,A320,A321,A324,A344,A346,A347,
Th19;
                 LE p1,h0/.(i+1),Lower_Arc(P),E-max(P),W-min(P)
                       by A11,A12,A13,A14,A322,A323,A325,A344,A346,A347,Th19;
             then LE h0/.i,p1,P & LE p1,h0/.(i+1),P
                    by A316,A317,A318,A319,A345,A349,A350,A351,JORDAN6:def 10;
            then x in {p: LE h0/.i,p,P & LE p,h0/.(i+1),P};
           hence x in Segment(h0/.i,h0/.(i+1),P) by A350,Def1;
          end;
         then W=g2.:(Q1) by A206,A326,XBOOLE_0:def 10;
        hence diameter(W)<e by A16,A301,A306;
       end;
       suppose A352:i=len h1;
           then A353:h0.i=E-max(P) by A21,A37,A206,FINSEQ_1:85;
           A354:i-len h11=i-'len h11 by A21,A352,BINARITH:50;
           A355:h0.(i+1)=(mid(h21,2,len h21 -'1)).(i+1 -len h11)
                            by A21,A40,A207,A352,FINSEQ_1:36;
           A356:i+1-len h11=i+1-'len h11 by A21,A209,A352,BINARITH:50;
         A357: i+1-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                         by A40,A207,XREAL_1:11;
           then 1<=i+1-'len h11 & i+1-'len h11<=len mid(h21,2,len h21 -'1)
                             by A21,A209,A352,BINARITH:50;
           then 1<i+1-'len h11+(2-1) by NAT_1:13;
           then A358: 0<i+1-'len h11+2-1;
               0<=i-'len h11 by NAT_1:2;
then A359:      0+2<=i-'len h11 +2 by XREAL_1:8;
               i-len h11<=len h1+(len h2-2)-len h11 by A21,A23,A40,A42,A46,A47
,A206,XREAL_1:11;
           then A360: i-'len h11+2<=len h2-2+2 by A21,A354,XREAL_1:8;
           then A361:i-'len h11+2-1<=len h2-1 by XREAL_1:11;
           A362:1<=(i-'len h11 +2-'1) & (i-'len h11 +2-'1)<=len h21
                                    by A23,A359,A360,Lm1,BINARITH:60,62;
               len h2<len h2+1 by NAT_1:13;
           then len h2-1<len h2+1-1 by XREAL_1:11;
           then A363:i-'len h11+2-1<len h2 by A361,XXREAL_0:2;
           A364:i-'len h11+2-'1=i-'len h11+2-1 by A362,BINARITH:57;
           set j=i-'len h11+2-'1;
             len h1-'len h11=len h11-len h11 by A21,BINARITH:def 3;
then A365:      0+2-1=len h1-'len h11+2-1;
               i-len h11<len h11+(len h2-2)-len h11 by A23,A40,A42,A46,A47,A206
,XREAL_1:11;
           then A366: i-len h11+2<len h2-2+2 by XREAL_1:8;
           A367:j+1=i-'len h11+1+1-1+1 by A362,BINARITH:57
               .=i-'len h11+(1+1);
           then A368:j+1<len h2 by A21,A352,A366,BINARITH:def 3;
           A369:j+1=i-len h11+2-1+1 by A21,A352,A364,BINARITH:def 3
               .=i+1-'len h11+2-'1 by A356,A358,BINARITH:def 3;
           A370:j in dom h2 by A22,A362,FINSEQ_3:27;
           then A371:h21.j=g2.(h2.j) by FUNCT_1:23;
           A372:h0.i=g2.(h2.j) by A14,A16,A352,A353,A365,BINARITH:57;
A373:        h2.j in rng h2 by A370,FUNCT_1:def 5;
           A374:1<j+1 by A362,NAT_1:13;
           A375:  h0.(i+1)=h21.(j+1) by A21,A43,A45,A352,A355,A356,A357,A369,
JORDAN3:27;
           A376:j+1 in dom h2 by A360,A367,A374,FINSEQ_3:27;
           then A377:h0.(i+1)=g2.(h2.(j+1)) by A375,FUNCT_1:23;
A378:        h2.(j+1) in rng h2 by A376,FUNCT_1:def 5;
               i in dom h0 by A206,FINSEQ_3:27;
           then A379:h0/.i=h0.i by PARTFUN1:def 8;
               i+1 in dom h0 by A207,A208,FINSEQ_3:27;
           then A380:h0/.(i+1)=h0.(i+1) by PARTFUN1:def 8;
              g2.(h2.j) in rng g2 by A15,A16,A373,BORSUK_1:83,FUNCT_1:def 5;
           then A381:h0.i in Lower_Arc P
              by A13,A14,A16,A352,A353,A365,BINARITH:57;
           A382:h0.(i+1) in Lower_Arc P
                 by A13,A15,A16,A377,A378,BORSUK_1:83,FUNCT_1:def 5;
           A383:1<=j & j<len h2 by A362,A363,BINARITH:57;
A384:    g2.(h2.(j+1)) = h0/.(i+1) by A375,A376,A380,FUNCT_1:23;
A385:    h2.(j+1) <= 1 by A16,A378,BORSUK_1:83,RCOMP_1:48;
           A386:h2/.j=h2.j by A383,FINSEQ_4:24;
           A387:h2/.(j+1)=h2.(j+1) by A360,A367,A374,FINSEQ_4:24;
         then reconsider Q1=[.h2/.j,h2/.(j+1).]
                     as Subset of I[01]
                          by A16,A373,A378,A386,BORSUK_1:83,RCOMP_1:16;
         A388:Segment(h0/.i,h0/.(i+1),P) c= g2.:([.h2/.j,h2/.(j+1).])
          proof let x be set;assume
           A389:x in Segment(h0/.i,h0/.(i+1),P);
                h0/.(i+1) <> W-min P
              by A22,A29,A31,A67,A368,A375,A376,A380,FUNCT_1:def 8;
            then x in {p: LE h0/.i,p,P & LE p,h0/.(i+1),P} by A389,Def1;
            then consider p being Point of TOP-REAL 2 such that
            A390:p=x & LE h0/.i,p,P & LE p,h0/.(i+1),P;
       A391:h0/.i in Upper_Arc(P) & p in Lower_Arc(P)& not p=W-min(P) or
            h0/.i in Upper_Arc(P) & p in Upper_Arc(P) &
             LE h0/.i,p,Upper_Arc(P),W-min(P),E-max(P) or
            h0/.i in Lower_Arc(P) & p in Lower_Arc(P)& not p=W-min(P) &
             LE h0/.i,p,Lower_Arc(P),E-max(P),W-min(P)
                                   by A390,JORDAN6:def 10;
               j+1<len h2 by A21,A352,A366,A367,BINARITH:def 3;
            then A392:j<len h2 by NAT_1:13;
              A393:not h0/.(i+1)=E-max(P)
                      by A22,A28,A30,A67,A374,A375,A376,A380,FUNCT_1:def 8;
                A394:h0/.(i+1) in Lower_Arc(P)
                   by A13,A15,A16,A377,A378,A380,BORSUK_1:83,FUNCT_1:def 5;
                now assume h0/.(i+1) in Upper_Arc(P);
              then h0/.(i+1) in Upper_Arc(P)/\ Lower_Arc(P)
                       by A394,XBOOLE_0:def 3;
              then h0/.(i+1) in {W-min(P),E-max(P)} by A1,JORDAN6:def 9;
              then h21.(j+1)=W-min(P) by A375,A380,A393,TARSKI:def 2;
             hence contradiction by A22,A29,A31,A67,A368,A376,FUNCT_1:def 8;
            end;
            then A395:p in Lower_Arc(P) & h0/.(i+1) in Lower_Arc(P)
            & not h0/.(i+1)=W-min(P)
             & LE p,h0/.(i+1),Lower_Arc(P),E-max(P),W-min(P) or
            p in Upper_Arc(P) & h0/.(i+1) in Lower_Arc(P)
                 & not h0/.(i+1)=W-min(P) by A390,JORDAN6:def 10;
                A396:h0/.i<>W-min(P)
                  by A22,A29,A31,A67,A370,A371,A372,A379,A392,FUNCT_1:def 8;
                    dom (g1*h1) c= dom h0 by FINSEQ_1:39;
                then A397: h0/.i=E-max(P) by A36,A352,A353,PARTFUN1:def 8;
A398:           now assume A399:not p in Lower_Arc(P);
                  then p=E-max(P) by A2,A391,A397,JORDAN6:70;
                 hence contradiction by A1,A399,Th1;
                end;
A400:           now assume p in Upper_Arc(P);
                  then p in Upper_Arc(P)/\ Lower_Arc(P) by A398,XBOOLE_0:def 3
;
then A401:             p in {W-min(P),E-max(P)} by A1,JORDAN6:def 9;
                      p <> W-min P by A2,A391,A396,JORDAN6:69;
                 hence p = E-max P by A401,TARSKI:def 2;
                end;
then A402:           LE p,h0/.(i+1),Lower_Arc P, E-max P, W-min P
                    by A11,A395,JORDAN5C:10;
                    p in rng g2 by A1,A13,A390,A400,Th1,JORDAN6:def 10;
                then consider z being set such that A403:z in dom g2 & p=g2.z
                                 by FUNCT_1:def 5;
                reconsider rz=z as Real by A15,A403;
A404:          g2.(h2/.(j+1))=h0/.(i+1)
                 by A360,A367,A374,A377,A380,FINSEQ_4:24;
                       h2.(j+1) in rng h2 by A376,FUNCT_1:def 5;
              then 0<=rz & rz<=1 & 0<=h2/.(j+1) & h2/.(j+1)<=1
                 by A16,A387,A403,BORSUK_1:83,RCOMP_1:48;
              then rz<=h2/.(j+1)& h2/.j<=rz
               by A12,A13,A14,A16,A352,A365,A386,A402,A403,A404,Th20,
BINARITH:57;
             then rz in [.h2/.j,h2/.(j+1).] by RCOMP_1:48;
           hence x in g2.:([.h2/.j,h2/.(j+1).]) by A390,A403,FUNCT_1:def 12;
          end;
             g2.:([.h2/.j,h2/.(j+1).]) c= Segment(h0/.i,h0/.(i+1),P)
          proof let x be set;assume x in g2.:([.h2/.j,h2/.(j+1).]);
            then consider y being set such that
      A405: y in dom g2 & y in [.h2/.j,h2/.(j+1).] & x=g2.y by FUNCT_1:def 12;
            A406:x in Lower_Arc(P) by A13,A405,FUNCT_1:def 5;
            then reconsider p1=x as Point of TOP-REAL 2;
            reconsider sy=y as Real by A405;
             A407:h2/.j<=sy & sy<=h2/.(j+1) by A405,RCOMP_1:48;
             A408:0<=sy & sy<=1 by A405,BORSUK_1:83,RCOMP_1:48;
A409:         h2.(j+1) <> 1 by A16,A18,A29,A368,A376,FUNCT_1:def 8;
A410:        now assume p1=W-min(P);
              then 1=sy by A12,A14,A32,A405,FUNCT_1:def 8;
             hence contradiction by A385,A387,A407,A409,XXREAL_0:1;
            end;
A411:        h0/.(i+1) <> W-min(P)
                 by A22,A29,A31,A67,A368,A375,A376,A380,FUNCT_1:def 8;
                 LE h0/.i,p1,Lower_Arc(P),E-max(P),W-min(P)
                by A11,A12,A13,A14,A353,A379,A405,A408,Th19;
            then A412: LE h0/.i,p1,P by A379,A381,A406,A410,JORDAN6:def 10;
                LE p1,h0/.(i+1),Lower_Arc(P),E-max(P),W-min(P)
                    by A11,A12,A13,A14,A384,A385,A387,A405,A407,A408,Th19;
            then LE p1,h0/.(i+1),P by A380,A382,A406,A411,JORDAN6:def 10;
            then x in {p: LE h0/.i,p,P & LE p,h0/.(i+1),P} by A412;
           hence x in Segment(h0/.i,h0/.(i+1),P) by A411,Def1;
          end;
         then W=g2.:(Q1) by A206,A388,XBOOLE_0:def 10;
        hence diameter(W)<e by A16,A383;
       end;
      end;
   thus for W being Subset of Euclid 2 st
       W=Segment(h0/.len h0,h0/.1,P)  holds diameter W < e
      proof let W be Subset of Euclid 2;
       assume
A413:   W=Segment(h0/.len h0,h0/.1,P);
         set i=len h0;
            len h0<=len h11 + len mid(h21,2,len h21 -'1) by FINSEQ_1:35;
        then A414:    h0.i=(mid(h21,2,len h21 -'1)).(i -len h11) by A21,A51,
FINSEQ_1:36;
           A415:i-len h11=i-'len h11 by A21,A52,BINARITH:50;
             A416: i-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                          by FINSEQ_1:35;
               len h1 +1-len h1<=i-len h1 by A48,A49,XXREAL_0:2;
           then A417:h0.i=h21.(i-'len h11 +2-'1)
                             by A21,A43,A45,A414,A415,A416,JORDAN3:27;
               0<=i-'len h11 by NAT_1:2;
then A418:      0+2<=i-'len h11 +2 by XREAL_1:8;
then A419:      2-'1<=(i-'len h11 +2-'1) by BINARITH:60;
           A420:1<=(i-'len h11 +2-'1) & (i-'len h11 +2-'1)<=len h21
                             by A40,A42,A46,A47,A415,A418,Lm1,BINARITH:60,62;
               len h2<len h2+1 by NAT_1:13;
           then A421: len h2-1<len h2+1-1 by XREAL_1:11;
           A422:i-'len h11+2-'1=i-'len h11+2-1 by A419,Lm1,BINARITH:57;
           set j=i-'len h11+2-'1;
            len h11+1-len h11<=i-len h11 by A23,A40,A42,A46,A47,A49,XXREAL_0:2;
           then 1<=i-'len h11 by BINARITH:57;
           then 1+2<=i-'len h11+2 by XREAL_1:8;
           then 1+2-1<=i-'len h11+2-1 by XREAL_1:11;
           then A423:1<j by A422,XXREAL_0:2;
           A424:j in dom h2 by A22,A420,FINSEQ_3:27;
           then A425:h0.i=g2.(h2.j) by A417,FUNCT_1:23;
A426:       h2.j in rng h2 by A424,FUNCT_1:def 5;
           then A427:0<=h2.j & h2.j<=1 by A16,BORSUK_1:83,RCOMP_1:48;
           A428:1<j+1 by A419,Lm1,NAT_1:13;
           A429:h0.i in Lower_Arc P
                       by A13,A15,A16,A425,A426,BORSUK_1:83,FUNCT_1:def 5;
A430:      now assume h0.i in Upper_Arc(P);
             then h0.i in Upper_Arc(P)/\ Lower_Arc(P) by A429,XBOOLE_0:def 3;
             then h0.i in {W-min(P),E-max(P)} by A1,JORDAN6:def 9;
             then h0.i=W-min(P) or h0.i=E-max(P) by TARSKI:def 2;
            hence contradiction
            by A22,A23,A28,A29,A30,A31,A40,A42,A46,A47,A67,A415,A417,A421,A423
,A424,FUNCT_1:def 8;
           end;
              j+1 in dom h2 by A22,A40,A42,A46,A47,A415,A428,FINSEQ_3:27;
then A431:      h2.(j+1) in rng h2 by FUNCT_1:def 5;
               i in dom h0 by A53,FINSEQ_3:27;
           then A432:h0/.i=h0.i by PARTFUN1:def 8;
A433:     0 <= h2.j by A16,A426,BORSUK_1:83,RCOMP_1:48;
A434:     h2.j <= 1 by A16,A426,BORSUK_1:83,RCOMP_1:48;
          A435:h2/.j=h2.j by A23,A40,A42,A46,A47,A415,A419,A421,Lm1,FINSEQ_4:24
;
          A436:h2/.(j+1)=h2.(j+1) by A23,A40,A42,A46,A47,A415,A428,FINSEQ_4:24;
         then reconsider Q1=[.h2/.j,h2/.(j+1).]
                     as Subset of I[01]
                by A16,A426,A431,A435,BORSUK_1:83,RCOMP_1:16;
         A437:Segment(h0/.i,h0/.1,P) c= g2.:([.h2/.j,h2/.(j+1).])
          proof let x be set;assume
           A438:x in Segment(h0/.i,h0/.1,P);
                h0/.1=W-min(P) by A39,A63,PARTFUN1:def 8;
            then x in {p: LE h0/.i,p,P or h0/.i in P & p=W-min(P)}
                                      by A438,Def1;
            then consider p being Point of TOP-REAL 2 such that
            A439:p=x & (LE h0/.i,p,P or h0/.i in P & p=W-min(P));
              A440:j<j+1 by NAT_1:13;
              A441:j in dom h2 by A23,A40,A42,A46,A47,A415,A419,A421,Lm1,
FINSEQ_3:27;
                  j+1 in dom h2 by A22,A40,A42,A46,A47,A415,A428,FINSEQ_3:27;
              then h2.j<h2.(j+1) by A16,A440,A441,GOBOARD1:def 1;
              then A442:h2/.(j+1) in [.h2/.j,
              h2/.(j+1).] by A435,A436,RCOMP_1:15;
              A443: h2/.(j+1)=1 by A16,A23,A29,A40,A42,A46,A47,A415,
PARTFUN1:def 8;
                now per cases by A439;
            suppose LE h0/.i,p,P & (p<>W-min(P) or not h0/.i in P);
then A444:h0/.i in Lower_Arc(P) & p in Lower_Arc(P)& not p=W-min(P) &
               LE h0/.i,p,Lower_Arc(P),E-max(P),W-min(P)
                          by A430,A432,JORDAN6:def 10;
                  then consider z being set such that A445:z in dom g2 & p=g2.z
                                   by A13,FUNCT_1:def 5;
                  reconsider rz=z as Real by A15,A445;
              take z;
A446:               0<=rz & rz<=1 by A445,BORSUK_1:83,RCOMP_1:48;
then A447:         h2/.j<=rz
                 by A12,A13,A14,A425,A427,A432,A435,A444,A445,Th20;
             thus z in dom g2 by A445;
                  rz<=h2/.(j+1) by A16,A23,A40,A42,A46,A47,A415,A428,A446,
FINSEQ_4:24;
             hence z in [.h2/.j,h2/.(j+1).] & x = g2.z
                         by A439,A445,A447,RCOMP_1:48;
            end;
            suppose h0/.i in P & p=W-min(P);
             hence ex y being set st y in dom g2 & y in [.h2/.j,h2/.(j+1).]
              & x = g2.y by A14,A32,A439,A442,A443;
            end;
            end;
           hence x in g2.:([.h2/.j,h2/.(j+1).]) by FUNCT_1:def 12;
          end;
             g2.:([.h2/.j,h2/.(j+1).]) c= Segment(h0/.i,h0/.1,P)
          proof let x be set;assume x in g2.:([.h2/.j,h2/.(j+1).]);
            then consider y being set such that
      A448: y in dom g2 & y in [.h2/.j,h2/.(j+1).] & x=g2.y by FUNCT_1:def 12;
            A449:x in Lower_Arc(P) by A13,A448,FUNCT_1:def 5;
            then reconsider p1=x as Point of TOP-REAL 2;
            reconsider sy=y as Real by A448;
             A450:h2/.j<=sy & sy<=h2/.(j+1) by A448,RCOMP_1:48;
             A451:0<=sy & sy<=1 by A448,BORSUK_1:83,RCOMP_1:48;
            A452:h0/.1=W-min(P) by A39,A63,PARTFUN1:def 8;
A453:      Upper_Arc(P) \/ Lower_Arc(P)=P by A1,JORDAN6:def 9;
A454:        LE h0/.i,p1,Lower_Arc(P),E-max(P),W-min(P)
               by A11,A12,A13,A14,A425,A432,A433,A434,A435,A448,A450,A451,Th19;
                now per cases;
            case p1=W-min(P);
             hence LE h0/.i,p1,P or  h0/.i in P & p1=W-min(P)
              by A429,A432,A453,XBOOLE_0:def 2;
            end;
            case p1<>W-min(P);
             hence LE h0/.i,p1,P or  h0/.i in P & p1=W-min(P)
                              by A429,A432,A449,A454,JORDAN6:def 10;
            end;
            end;
            then x in {p: LE h0/.i,p,P or h0/.i in P & p=W-min(P)};
           hence x in Segment(h0/.i,h0/.1,P) by A452,Def1;
          end;
         then W=g2.:Q1 by A413,A437,XBOOLE_0:def 10;
        hence diameter(W)<e by A16,A23,A40,A42,A46,A47,A415,A419,A421,Lm1;
      end;
      A455: for i being Element of NAT st 1<=i & i+1<len h0 holds
         LE h0/.(i+1),h0/.(i+2),P
            proof let i be Element of NAT;assume
            A456: 1<=i & i+1<len h0;
              then A457:i+1+1<=len h0 by NAT_1:13;
              A458:1<i+1 by A456,NAT_1:13;
              then A459:1<i+1+1 by NAT_1:13;
A460:         i+1<i+1+1 by NAT_1:13;
              per cases;
              suppose A461:i+1<len h1;
                then A462:i+1+1<=len h1 by NAT_1:13;
                A463:h0.(i+1)=h11.(i+1) by A21,A458,A461,FINSEQ_1:85;
                A464:i+1 in dom h1 by A458,A461,FINSEQ_3:27;
                then A465:h0.(i+1)=g1.(h1.(i+1)) by A463,FUNCT_1:23;
A466:            h1.(i+1) in rng h1 by A464,FUNCT_1:def 5;
                then A467:0<=h1.(i+1) & h1.(i+1)<=1
                    by A9,BORSUK_1:83,RCOMP_1:48;
                A468:1<i+1+1 by A458,NAT_1:13;
                then A469:h0.(i+1+1)=h11.(i+1+1) by A21,A462,FINSEQ_1:85;
                A470:i+1+1 in dom h1 by A462,A468,FINSEQ_3:27;
                then A471:h0.(i+1+1)=g1.(h1.(i+1+1)) by A469,FUNCT_1:23;
A472:            h1.((i+1)+1) in rng h1 by A470,FUNCT_1:def 5;
then A473:           h1.(i+1+1)<=1 by A9,BORSUK_1:83,RCOMP_1:48;
                A474:h1.(i+1)<h1.(i+1+1) by A9,A460,A464,A470,GOBOARD1:def 1;
                    i+1 in dom h0 by A456,A458,FINSEQ_3:27;
                then A475:h0/.(i+1)=h0.(i+1) by PARTFUN1:def 8;
                    (i+1)+1 in dom h0 by A457,A468,FINSEQ_3:27;
                then A476:h0/.(i+1+1)=h0.(i+1+1) by PARTFUN1:def 8;
                 g1.(h1.(i+1)) in rng g1
                     by A6,A9,A466,BORSUK_1:83,FUNCT_1:def 5;
then A477:           h0/.(i+1) in Upper_Arc P
                       by A4,A463,A464,A475,FUNCT_1:23;
A478:           h0/.(i+1+1) in Upper_Arc P
                      by A4,A6,A9,A471,A472,A476,BORSUK_1:83,FUNCT_1:def 5;
                    LE h0/.(i+1),h0/.((i+1)+1),Upper_Arc(P),W-min(P),E-max(P)
                by A2,A3,A4,A5,A465,A467,A471,A473,A474,A475,A476,Th19;
               hence thesis by A477,A478,JORDAN6:def 10;
              end;
              suppose
A479:          i+1>=len h1;
                per cases by A479,REAL_1:def 5;
                suppose A480:i+1>len h1;
                  then A481:len h1 +1<=i+1 by NAT_1:13;
A482:             len h11+1<=i+1 by A21,A480,NAT_1:13;
A483:             i+1<=len h11 + len (mid(h21,2,len h21 -'1))
                                by A456,FINSEQ_1:35;
                  then A484:h0.(i+1)=(mid(h21,2,len h21 -'1)).((i+1) -len h11)
                                               by A482,FINSEQ_1:36;
                  A485:(i+1)-len h11=(i+1)-'len h11 by A21,A480,BINARITH:50;
                    A486: (i+1)-len h11<=len h11 + len (mid(h21,2,len h21 -'1))
-len
h11
                                         by A483,XREAL_1:11;
                      len h1 +1-len h1<=(i+1)-len h1 by A481,XREAL_1:11;
                  then A487:h0.(i+1)=h21.((i+1)-'len h11 +2-'1)
                             by A21,A43,A45,A484,A485,A486,JORDAN3:27;
                  A488:len h1 +1<=(i+1)+1 by A481,NAT_1:13;
                  then A489:h0.((i+1)+1)=(mid(h21,2,len h21 -'1)).((i+1)+1 -len
h11)
                                      by A21,A40,A457,FINSEQ_1:36;
                      (i+1)+1>len h11 by A21,A480,NAT_1:13;
                  then A490:(i+1)+1-len h11=(i+1)+1-'len h11 by BINARITH:50;
A491:             (i+1)+1-len h11
                      <=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                         by A40,A457,XREAL_1:11;
                    A492: len h1 +1-len h1<=(i+1)+1-len h1 by A488,XREAL_1:11;
                  then A493:h0.((i+1)+1)=h21.((i+1)+1-'len h11 +2-'1)
                    by A21,A43,A45,A489,A490,A491,JORDAN3:27;
                      1<(i+1)+1-'len h11+(2-1) by A21,A490,A492,NAT_1:13;
then A494:             0<(i+1)+1-'len h11+2-1;
                      0<=(i+1)-'len h11 by NAT_1:2;
then A495:             0+2<=(i+1)-'len h11 +2 by XREAL_1:8;
then A496:             2-'1<=((i+1)-'len h11 +2-'1) by BINARITH:60;
                      (i+1)-len h11<=len h1+(len h2-2)-len h11
                             by A21,A23,A40,A42,A46,A47,A456,XREAL_1:11;
                  then A497: (i+1)-'len h11+2<=len h2-2+2 by A21,A485,XREAL_1:8
;
                  then A498:1<=((i+1)-'len h11 +2-'1)
                            & ((i+1)-'len h11 +2-'1)<=len h21
                                    by A23,A495,Lm1,BINARITH:60,62;
                  A499:(i+1)-'len h11+2-'1=(i+1)-'len h11+2-1
                                      by A496,Lm1,BINARITH:57;
                  set j=(i+1)-'len h11+2-'1;
                      (i+1)-len h11<len h11+(len h2-2)-len h11
                                     by A23,A40,A42,A46,A47,A456,XREAL_1:11;
                  then A500: (i+1)-len h11+2<len h2-2+2 by XREAL_1:8;
                A501:j+1=(i+1)-'len h11+(1+1)-1+1 by A496,Lm1,BINARITH:57
                  .=(i+1)-'len h11+2;
                  A502:j+1=(i+1)+1-'len h11+2-'1 by A485,A490,A494,A499,
BINARITH:def 3;
A503:             j in dom h2 by A22,A498,FINSEQ_3:27;
                  then A504:h0.(i+1)=g2.(h2.j) by A487,FUNCT_1:23;
A505:              h2.j in rng h2 by A503,FUNCT_1:def 5;
                  then A506:0<=h2.j & h2.j<=1 by A16,BORSUK_1:83,RCOMP_1:48;
                  A507:j<j+1 by NAT_1:13;
                     1<j+1 by A496,Lm1,NAT_1:13;
                  then A508:j+1 in dom h2 by A497,A501,FINSEQ_3:27;
                  then A509:h0.((i+1)+1)=g2.(h2.(j+1))
                     & h21.(j+1)=g2.(h2.(j+1))  by A493,A502,FUNCT_1:23;
A510:              h2.(j+1) in rng h2 by A508,FUNCT_1:def 5;
                  A511:h2.j<h2.(j+1) by A16,A503,A507,A508,GOBOARD1:def 1;
                      i+1 in dom h0 by A456,A458,FINSEQ_3:27;
                  then A512:h0/.(i+1)=h0.(i+1) by PARTFUN1:def 8;
                      (i+1)+1 in dom h0 by A457,A459,FINSEQ_3:27;
                  then A513:h0/.((i+1)+1)=h0.((i+1)+1) by PARTFUN1:def 8;
                  A514:h0.(i+1) in Lower_Arc(P)
                     by A13,A15,A16,A504,A505,BORSUK_1:83,FUNCT_1:def 5;
                  A515:h0.((i+1)+1) in Lower_Arc(P)
                   by A13,A15,A16,A509,A510,BORSUK_1:83,FUNCT_1:def 5;
A516: (h2.(j+1)) <= 1 by A16,A510,BORSUK_1:83,RCOMP_1:48;
A517:            h0/.(i+1+1) <> W-min P
           by A22,A29,A31,A67,A485,A493,A500,A501,A502,A508,A513,FUNCT_1:def 8;
                    LE h0/.(i+1),h0/.((i+1)+1),Lower_Arc(P),E-max(P),W-min(P)
                             by A11,A12,A13,A14,A504,A506,A509,A511,A512,A513
,A516,Th19;
                 hence thesis by A512,A513,A514,A515,A517,JORDAN6:def 10;
                end;
                suppose A518:i+1=len h1;
                  then A519:h0.len h1 =E-max(P) by A21,A37,A458,FINSEQ_1:85;
                  A520:len h1-len h11=len h1-'len h11 by A21,BINARITH:50;
A521:             len h1+1 <=len h11 + len (mid(h21,2,len h21 -'1))
                                          by A457,A518,FINSEQ_1:35;
                  A522:h0.((i+1)+1)=(mid(h21,2,len h21 -'1)).((i+1)+1 -len h11)
                                      by A21,A40,A457,A518,FINSEQ_1:36;
                  A523:(i+1)+1-len h11=(i+1)+1-'len h11
                                by A21,A460,A518,BINARITH:50;
               A524: (i+1)+1-len h11
                       <=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                         by A518,A521,XREAL_1:11;
                  then A525:1<=(i+1)+1-'len h11
                         & (i+1)+1-'len h11<=len mid(h21,2,len h21 -'1)
                             by A21,A460,A518,BINARITH:50;
                  A526:h0.((i+1)+1)=h21.((i+1)+1-'len h11 +2-'1)
                    by A21,A43,A45,A518,A522,A523,A524,JORDAN3:27;
                      1<(i+1)+1-'len h11+(2-1) by A525,NAT_1:13;
                  then A527: 0<(i+1)+1-'len h11+2-1;
                      0<=(i+1)-'len h11 by NAT_1:2;
                  then 0+2<=(i+1)-'len h11 +2 by XREAL_1:8;
                  then A528:2-'1<=((i+1)-'len h11 +2-'1) by BINARITH:60;
                      (i+1)-len h11<=len h1+(len h2-2)-len h11
                               by A21,A23,A40,A42,A46,A47,A456,XREAL_1:11;
                  then A529: (i+1)-'len h11+2<=len h2-2+2 by A21,A518,A520,
XREAL_1:8;
                  set j=(i+1)-'len h11+2-'1;
                      (i+1)-len h11<len h11+(len h2-2)-len h11
                  by A23,A40,A42,A46,A47,A456,XREAL_1:11;
                  then A530: (i+1)-len h11+2<len h2-2+2 by XREAL_1:8;
                  A531:j+1=(i+1)-'len h11+(1+1)-1+1 by A528,Lm1,BINARITH:57
                  .=(i+1)-'len h11+(1+1);
                  then A532:j+1<len h2 by A21,A518,A530,BINARITH:def 3;
                  A533:j+1=(i+1)-len h11+2-1+1 by A21,A518,Lm1,BINARITH:def 3
                  .=(i+1)+1-'len h11+2-'1 by A523,A527,BINARITH:def 3;
                     1<j+1 by A528,Lm1,NAT_1:13;
                  then A534:j+1 in dom h2 by A529,A531,FINSEQ_3:27;
                  then A535:h0.((i+1)+1)=g2.(h2.(j+1))
                         & h21.(j+1)=g2.(h2.(j+1)) by A526,A533,FUNCT_1:23;
A536:             h2.(j+1) in rng h2 by A534,FUNCT_1:def 5;
                      len h1 in dom h0 by A456,A458,A518,FINSEQ_3:27;
                  then A537:h0/.len h1=h0.len h1 by PARTFUN1:def 8;
                      (i+1)+1 in dom h0 by A457,A459,FINSEQ_3:27;
                  then A538:h0/.((i+1)+1)=h0.((i+1)+1) by PARTFUN1:def 8;
                  A539:h0.(i+1+1) in Lower_Arc P
                        by A13,A15,A16,A535,A536,BORSUK_1:83,FUNCT_1:def 5;
                  A540: h0.(i+1) in Upper_Arc(P) by A1,A518,A519,Th1;
             h0/.(i+1+1) <> W-min P
                    by A22,A29,A31,A67,A526,A532,A533,A534,A538,FUNCT_1:def 8;
                 hence thesis by A518,A537,A538,A539,A540,JORDAN6:def 10;
                end;
              end;
            end;
      A541: for i being Element of NAT st 1<=i & i+1<=len h0 holds
         LE h0/.i,h0/.(i+1),P & h0/.(i+1)<>W-min(P) & h0/.i<>h0/.(i+1)
       proof let i be Element of NAT such that
A542:    1<=i and
A543:    i+1<=len h0;
A544:    1<i+1 by A542,NAT_1:13;
A545:    i<len h0 by A543,NAT_1:13;
A546:    i<i+1 by NAT_1:13;
             i in dom h0 by A542,A545,FINSEQ_3:27;
then A547:    h0/.i=h0.i by PARTFUN1:def 8;
                    i+1 in dom h0 by A543,A544,FINSEQ_3:27;
then A548:    h0/.(i+1)=h0.(i+1) by PARTFUN1:def 8;
              per cases;
              suppose A549:i<len h1;
                then A550:i+1<=len h1 by NAT_1:13;
                A551:h0.i=h11.i by A21,A542,A549,FINSEQ_1:85;
                A552:i in dom h1 by A542,A549,FINSEQ_3:27;
then A553:            h1.i in rng h1 by FUNCT_1:def 5;
                A554:h0.(i+1)=h11.(i+1) by A21,A544,A550,FINSEQ_1:85;
                A555:i+1 in dom h1 by A544,A550,FINSEQ_3:27;
                then A556:h0.(i+1)=g1.(h1.(i+1)) by A554,FUNCT_1:23;
A557:            h1.(i+1) in rng h1 by A555,FUNCT_1:def 5;
                A558:h1.i<h1.(i+1) by A9,A546,A552,A555,GOBOARD1:def 1;
                   g1.(h1.i) in rng g1
                        by A6,A9,A553,BORSUK_1:83,FUNCT_1:def 5;
                then A559:h0.i in Upper_Arc(P) by A4,A551,A552,FUNCT_1:23;
           A560:h0.(i+1) in Upper_Arc(P)
                  by A4,A6,A9,A556,A557,BORSUK_1:83,FUNCT_1:def 5;
A561: g1.(h1.i) = h0/.i by A547,A551,A552,FUNCT_1:23;
A562: 0 <= (h1.i) by A9,A553,BORSUK_1:83,RCOMP_1:48;
A563: (h1.i) <= 1 by A9,A553,BORSUK_1:83,RCOMP_1:48;
A564: (h1.(i+1)) <= 1 by A9,A557,BORSUK_1:83,RCOMP_1:48;
     A565: i+1 <> 1 by A542,NAT_1:13;
    A566: i+1 <> i;
                    LE h0/.i,h0/.(i+1),Upper_Arc(P),W-min(P),E-max(P)
                 by A2,A3,A4,A5,A548,A556,A558,A561,A562,A563,A564,Th19;
               hence thesis by A20,A25,A38,A66,A547,A548,A551,A552,A554,A555
,A559,A560,A565,A566,FUNCT_1:def 8,JORDAN6:def 10;
              end;
              suppose
A567:          i>=len h1;
                per cases by A567,REAL_1:def 5;
                suppose A568:i>len h1;
                  then A569:len h1 +1<=i by NAT_1:13;
                  A570:len h11+1<=i & i<=len h11 + len (mid(h21,2,len h21 -'1))
                                      by A21,A545,A568,FINSEQ_1:35,NAT_1:13;
                                          then A571:             h0.i=(mid(h21,
2,len h21 -'1)).(i -len h11) by FINSEQ_1:36;
                  A572:i-len h11=i-'len h11 by A21,A568,BINARITH:50;
A573:             i-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                         by A570,XREAL_1:11;
                      len h1 +1-len h1<=i-len h1 by A569,XREAL_1:11;
                  then A574:h0.i=h21.(i-'len h11 +2-'1)
                             by A21,A43,A45,A571,A572,A573,JORDAN3:27;
                  A575:len h1 +1<=i+1 by A569,NAT_1:13;
                  then A576:h0.(i+1)=(mid(h21,2,len h21 -'1)).(i+1 -len h11)
                                      by A21,A40,A543,FINSEQ_1:36;
                      i+1>len h11 by A21,A568,NAT_1:13;
                  then A577:i+1-len h11=i+1-'len h11 by BINARITH:50;
A578:             i+1-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                         by A40,A543,XREAL_1:11;
                    A579: len h1 +1-len h1<=i+1-len h1 by A575,XREAL_1:11;
                  then A580:h0.(i+1)=h21.(i+1-'len h11 +2-'1)
                    by A21,A43,A45,A576,A577,A578,JORDAN3:27;
                      1<i+1-'len h11+(2-1) by A21,A577,A579,NAT_1:13;
                  then A581: 0<i+1-'len h11+2-1;
                      0<=i-'len h11 by NAT_1:2;
then A582:             0+2<=i-'len h11 +2 by XREAL_1:8;
then A583:             2-'1<=(i-'len h11 +2-'1) by BINARITH:60;
                      i-len h11<=len h1+(len h2-2)-len h11
                                      by A21,A23,A40,A42,A46,A47,A545,
XREAL_1:11
;
                  then A584: i-'len h11+2<=len h2-2+2 by A21,A572,XREAL_1:8;
A585:             1<=i-'len h11 +2-'1 by A582,Lm1,BINARITH:60;
A586:             i-'len h11 +2-'1<=len h21 by A23,A584,BINARITH:62;
                  set j=i-'len h11+2-'1;
                      i-len h11<len h11+(len h2-2)-len h11
                                  by A23,A40,A42,A46,A47,A545,XREAL_1:11;
then A587:             i-len h11+2<len h2-2+2 by XREAL_1:8;
                    A588: j+1=i-'len h11+(1+1)-1+1 by A583,Lm1,BINARITH:57
                  .=i-'len h11+(1+1);
                  A589:j+1=i-len h11+2-1+1 by A572,A583,Lm1,BINARITH:57
                  .=i+1-'len h11+2-'1 by A577,A581,BINARITH:def 3;
                  A590:j in dom h2 by A22,A585,A586,FINSEQ_3:27;
                  then A591:h0.i=g2.(h2.j) by A574,FUNCT_1:23;
A592:              h2.j in rng h2 by A590,FUNCT_1:def 5;
                  A593:j<j+1 by NAT_1:13;
                     1<j+1 by A585,NAT_1:13;
                  then A594:j+1 in dom h2 by A572,A587,A588,FINSEQ_3:27;
                  then A595:h0.(i+1)=g2.(h2.(j+1))
                     & h21.(j+1)=g2.(h2.(j+1))  by A580,A589,FUNCT_1:23;
A596:              h2.(j+1) in rng h2 by A594,FUNCT_1:def 5;
A597:          h2.j<h2.(j+1) by A16,A590,A593,A594,GOBOARD1:def 1;
                      i in dom h0 by A542,A545,FINSEQ_3:27;
                  then A598:h0/.i=h0.i by PARTFUN1:def 8;
                      i+1 in dom h0 by A543,A544,FINSEQ_3:27;
                  then A599:h0/.(i+1)=h0.(i+1) by PARTFUN1:def 8;
A600: 0 <= (h2.j) by A16,A592,BORSUK_1:83,RCOMP_1:48;
A601: (h2.j) <= 1 by A16,A592,BORSUK_1:83,RCOMP_1:48;
A602: (h2.(j+1)) <= 1 by A16,A596,BORSUK_1:83,RCOMP_1:48;
A603:           h0/.(i+1) <> W-min P
                by A22,A29,A31,A67,A572,A580,A587,A588,A589,A594,A599,
FUNCT_1:def 8;
                A604: j < j+1 by NAT_1:13;
                    h0/.i in Lower_Arc(P) & h0/.(i+1) in Lower_Arc(P)
                   & LE h0/.i,h0/.(i+1),Lower_Arc(P),E-max(P),W-min(P)
                                             by A11,A12,A13,A14,A15,A16,A591
,A592,A595,A596,A597,A598,A599,A600,A601,A602,Th19,BORSUK_1:83,FUNCT_1:def 5;
                 hence thesis by A22,A67,A574,A580,A589,A590,A594,A598,A599
,A603,A604,FUNCT_1:def 8,JORDAN6:def 10;
                end;
                suppose A605:i=len h1;
                  then A606:h0.i=E-max(P) by A21,A37,A542,FINSEQ_1:85;
                  A607:i-len h11=i-'len h11 by A21,A605,BINARITH:50;
A608:             i+1 <=len h11 + len (mid(h21,2,len h21 -'1))
                                          by A543,FINSEQ_1:35;
                  A609:h0.(i+1)=(mid(h21,2,len h21 -'1)).(i+1 -len h11)
                                      by A21,A40,A543,A605,FINSEQ_1:36;
                  A610:i+1-len h11=i+1-'len h11 by A21,A546,A605,BINARITH:50;
             i+1-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                         by A608,XREAL_1:11;
                  then A611:h0.(i+1)=h21.(i+1-'len h11 +2-'1)
                    by A21,A43,A45,A605,A609,A610,JORDAN3:27;
                  A612: 0<i+1-'len h11+2-1 by A21,A605,A610;
                      0<=i-'len h11 by NAT_1:2;
                  then A613: 0+2<=i-'len h11 +2 by XREAL_1:8;
                  then A614:2-'1<=(i-'len h11 +2-'1) by BINARITH:60;
                      i-len h11<=len h1+(len h2-2)-len h11 by A21,A23,A40,A42
,A46,A47,A545,XREAL_1:11;
then A615:              i-'len h11+2<=len h2-2+2 by A21,A607,XREAL_1:8;
                  then A616:1<=(i-'len h11 +2-'1) & (i-'len h11 +2-'1)<=len h21
                                    by A23,A613,Lm1,BINARITH:60,62;
                  set j=i-'len h11+2-'1;
                    len h1-'len h11=len h11-len h11 by A21,BINARITH:def 3;
                               then A617: 0+2-1=len h1-'len h11+2-1;
                      i-len h11<len h11+(len h2-2)-len h11
                                  by A23,A40,A42,A46,A47,A545,XREAL_1:11;
                  then A618: i-len h11+2<len h2-2+2 by XREAL_1:8;
                  A619:j+1=i-'len h11+(1+1)-1+1 by A614,Lm1,BINARITH:57
                  .=i-'len h11+2;
                  then A620:j+1<len h2 by A21,A605,A618,BINARITH:def 3;
                  A621:j+1=i-len h11+2-1+1 by A21,A605,Lm1,BINARITH:def 3
                  .=i+1-'len h11+2-'1 by A610,A612,BINARITH:def 3;
                  A622:j in dom h2 by A22,A616,FINSEQ_3:27;
                  then A623:h21.j=g2.(h2.j) by FUNCT_1:23;
                  A624:h0.i=g2.(h2.j) by A14,A16,A605,A606,A617,BINARITH:57;
                     1<j+1 by A614,Lm1,NAT_1:13;
                  then A625:j+1 in dom h2 by A615,A619,FINSEQ_3:27;
                  then A626:h0.(i+1)=g2.(h2.(j+1)) by A611,A621,FUNCT_1:23;
A627:             h2.(j+1) in rng h2 by A625,FUNCT_1:def 5;
                      i in dom h0 by A542,A545,FINSEQ_3:27;
                  then A628:h0/.i=h0.i by PARTFUN1:def 8;
                      i+1 in dom h0 by A543,A544,FINSEQ_3:27;
                  then A629:h0/.(i+1)=h0.(i+1) by PARTFUN1:def 8;
                  A630:h0.(i+1) in Lower_Arc(P)
                         by A13,A15,A16,A626,A627,BORSUK_1:83,FUNCT_1:def 5;
                  A631: h0.i in Upper_Arc(P) by A1,A606,Th1;
A632:            h0/.(i+1) <> W-min P
                 by A22,A29,A31,A67,A611,A620,A621,A625,A629,FUNCT_1:def 8;
                     j+1 <> j;
                 hence thesis
                 by A22,A67,A611,A621,A622,A623,A624,A625,A628,A629,A630,A631
,A632,FUNCT_1:def 8,JORDAN6:def 10;
                end;
              end;
       end;
   thus for i being Element of NAT st 1<=i & i+1<len h0 holds
         Segment(h0/.i,h0/.(i+1),P)/\ Segment(h0/.(i+1),h0/.(i+2),P)
         ={h0/.(i+1)}
      proof let i be Element of NAT;assume
        A633: 1<=i & i+1<len h0;
then A634:LE h0/.i,h0/.(i+1),P & h0/.(i+1)<>W-min(P) & h0/.i<>h0/.(i+1)
             by A541;
        A635: LE h0/.(i+1),h0/.(i+2),P by A455,A633;
        then h0/.i<>h0/.(i+2) by A1,A634,JORDAN6:72;
        hence Segment(h0/.i,h0/.(i+1),P)/\ Segment(h0/.(i+1),h0/.(i+2),P)
         ={h0/.(i+1)} by A1,A634,A635,Th10;
      end;
   thus Segment(h0/.len h0,h0/.1,P)/\ Segment(h0/.1,h0/.2,P)={h0/.1}
    proof A636: h11.2 <> W-min(P) by A20,A25,A38,A59,A66,FUNCT_1:def 8;
                A637:h0.2=g1.(h1.2) by A59,A62,FUNCT_1:23;
A638:           h1.2 in rng h1 by A59,FUNCT_1:def 5;
                A639:h0/.2=h0.2 by A61,PARTFUN1:def 8;
then A640:     h0/.2 in Upper_Arc P
               by A4,A6,A9,A637,A638,BORSUK_1:83,FUNCT_1:def 5;
                   A641: len h1 +1-len h1<=len h0 -len h1 by A48,A49,XXREAL_0:2
;
                  A642:h0.len h0=(mid(h21,2,len h21 -'1)).(len h0 -len h11)
                                   by A21,A40,A51,FINSEQ_1:36;
                   len h0 -len h11 <=len h11 + len mid(h21,2,len h21 -'1) -len
h11
                                         by FINSEQ_1:35;
                  then A643:h0.len h0=h21.(len h0-'len h11 +2-'1)
                    by A21,A43,A45,A57,A641,A642,JORDAN3:27;
                      0<=len h0-'len h11 by NAT_1:2;
then             0+2<=len h0-'len h11 +2 by XREAL_1:8;
                  then A644:1<=(len h0-'len h11 +2-'1)
                     & (len h0-'len h11 +2-'1)<=len h21
                                    by A40,A42,A46,A47,A57,Lm1,BINARITH:60,62;
                  set j=len h0-'len h11+2-'1;
                  A645:j in dom h2 by A22,A644,FINSEQ_3:27;
                  then A646:h0.len h0=g2.(h2.j) by A643,FUNCT_1:23;
            A647: now assume A648:h0/.2=h0/.len h0;
                      h2.j in rng h2 by A645,FUNCT_1:def 5;
                then g2.(h2.j) in rng g2 by A15,A16,BORSUK_1:83,FUNCT_1:def 5;
                then h0/.2 in Upper_Arc(P)/\  Lower_Arc(P)
                     by A13,A55,A640,A646,A648,XBOOLE_0:def 3;
                then h0/.2 in {W-min(P),E-max(P)} by A1,JORDAN6:def 9;
                then h11.2=E-max(P) by A62,A636,A639,TARSKI:def 2;
             hence contradiction by A20,A35,A37,A58,A59,A66,FUNCT_1:def 8;
            end;
      defpred P[Element of NAT] means
      $1+2<=len h0 implies LE h0/.2,h0/.($1+2),P;
            Upper_Arc(P) \/ Lower_Arc(P)= P by A1,JORDAN6:65;
        then h0/.2 in P by A640,XBOOLE_0:def 2;
        then A649: P[0] by A1,JORDAN6:71;
        A650:for k being Element of NAT st P[k] holds P[k+1]
         proof let k be Element of NAT;assume
          A651: k+2<=len h0 implies LE h0/.2,h0/.(k+2),P;
               now assume A652:k+1+2<=len h0;
             A653:k+1+2=k+2+1;
             then A654:k+2<len h0 by A652,NAT_1:13;
             A655:1<=1+k by NAT_1:11;
                 k+1+1=k+2;
             then LE h0/.(k+2),h0/.(k+2+1),P by A455,A653,A654,A655;
            hence LE h0/.2,h0/.(k+1+2),P
             by A1,A651,A652,JORDAN6:73,NAT_1:13;
           end;
          hence (k+1+2<=len h0 implies LE h0/.2,h0/.(k+1+2),P);
         end;
        A656:for i being Element of NAT holds P[i] from NAT_1:sch 1(A649,A650);
                len h0 -'2=len h0-2 by A60,BINARITH:50;
            then len h0-'2+2=len h0;
           then LE h0/.2,h0/.len h0,P & h0/.2<>h0/.len h0
              & h0/.2<>W-min(P) by A61,A62,A636,A647,A656,PARTFUN1:def 8;
       hence thesis by A1,A65,Th12;
      end;
      set i = len h0-'1;
A657:    i+1 = len h0 by A53,BINARITH:53;
A658:    1<=i by A60,Lm3;
      A659: len h0 > 1+1+1 by A21,A23,A40,A42,A46,A47,A126,XXREAL_0:2;
      then A660:   len h0-'1 > 1+1 by Lm2;
A661:  i<len h0 by A53,JORDAN5B:1;
then A662:   i in dom h0 by A658,FINSEQ_3:27;
then A663:h0/.i=h0.i by PARTFUN1:def 8;
        A664:i+1<=len h0 by A661,NAT_1:13;
        A665:1+1<=len h0 by A53,NAT_1:13;
        A666:LE h0/.i,h0/.(i+1),P by A541,A658,A664;
        A667:LE h0/.1,h0/.(1+1),P by A541,A665;
              1+1 in dom h0 by A665,FINSEQ_3:27;
then A668:h0/.(1+1)=h0.(1+1) by PARTFUN1:def 8;
        A669:h0/.1<>h0/.(1+1) by A541,A665;
        A670:h0.(1+1)=h11.(1+1) by A21,A58,FINSEQ_1:85;
        A671: 1+1 in dom h1 by A58,FINSEQ_3:27;
        then A672:h0.(1+1)=g1.(h1.(1+1)) by A670,FUNCT_1:23;
A673:    h1.(1+1) in rng h1 by A671,FUNCT_1:def 5;
        A674:1<i by A660,XXREAL_0:2;
A675:  now per cases;
               case A676:i<=len h1;
                then A677:h0.i=h11.i by A21,A674,FINSEQ_1:85;
        A678:i in dom h1 by A674,A676,FINSEQ_3:27;
        then A679:h1.(1+1)<h1.i by A9,A660,A671,GOBOARD1:def 1;
A680:    h1.i in rng h1 by A678,FUNCT_1:def 5;
                A681:h0.i=g1.(h1.i) by A677,A678,FUNCT_1:23;
        A682:0<=h1.i & h1.i<=1 by A9,A680,BORSUK_1:83,RCOMP_1:48;
               0 <= h1.(1+1) & h1.(1+1) <= 1 by A9,A673,BORSUK_1:83,RCOMP_1:48;
                then h0/.(1+1) in Upper_Arc(P) & h0/.i in Upper_Arc(P) &
                LE h0/.(1+1),h0/.i,Upper_Arc(P),W-min(P),E-max(P)
                  by A2,A3,A4,A5,A6,A9,A663,A668,A672,A673,A679,A680,A681,A682,
Th19,BORSUK_1:83,FUNCT_1:def 5;
               hence LE h0/.(1+1),h0/.i,P by JORDAN6:def 10;
               end;
               case A683:i>len h1;
                  then A684:i-len h11=i-'len h11 by A21,BINARITH:50;
                      i-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                        by A40,A661,XREAL_1:11;
then A685:0<=i-'len h11
                      & i-'len h11<=len mid(h21,2,len h21 -'1)
                             by A21,A683,A684,XREAL_1:50;
                    A686: i-len h11
                       <=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                by A40,A661,XREAL_1:11;
                    0+1<=i-'len h11+1+1-1 by A685,XREAL_1:8;
                  then A687:i-'len h11+2-'1=i-'len h11+2-1 by BINARITH:57;
                      0<=i-'len h11 by NAT_1:2;
                  then 0+2<=i-'len h11 +2 by XREAL_1:8;
                  then A688:2-'1<=(i-'len h11 +2-'1) by BINARITH:60;
                      i-len h11<=len h1+(len h2-2)-len h11 by A21,A23,A40,A42
,A46,A47,A661,XREAL_1:11;
                  then i-'len h11+2<=len h2-2+2 by A21,A684,XREAL_1:8;
then i-'len h11 +2-'1<=len h21 by A23,BINARITH:62;
then A689:           (i-'len h11 +2-'1) in dom h21 by A688,Lm1,FINSEQ_3:27;
                 1+1 in dom h1 by A58,FINSEQ_3:27;
                  then A690: h11.(1+1)=g1.(h1.(1+1)) by FUNCT_1:23;
                  A691:len h1 +1<=i by A683,NAT_1:13;
                  then A692:h0.i=(mid(h21,2,len h21 -'1)).(i -len h11)
                                      by A21,A40,A661,FINSEQ_1:36;
                    A693: len h1 +1-len h1<=i-len h1 by A691,XREAL_1:11;
                  then A694: 1<=i-len h11 by A20,FINSEQ_3:31;
                  A695:h0.(i)=h21.(i-'len h11 +2-'1)
                    by A21,A43,A45,A684,A686,A692,A693,JORDAN3:27;
                      i+1-1<=len h1+(len h2-2)-1 by A21,A23,A40,A42,A46,A47
,A664,XREAL_1:11;
                  then i-len h11<=len h1+((len h2-2)-1)-len h11 by XREAL_1:11;
                  then i-'len h11+2<=len h2-2-1+2 by A21,A684,XREAL_1:8;
                  then A696:i-'len h11+2-1<=len h2-1-1 by XREAL_1:11;
                  set k=i-'len h11+2-'1;
                  A697: h2.k in rng h2 by A22,A689,FUNCT_1:def 5;
                  A698: h1.(1+1) in rng h1 by A59,FUNCT_1:def 5;
                  A699:h0.i=h21.k by A43,A45,A684,A686,A692,A694,JORDAN3:27;
                  A700:h0.i=g2.(h2.k)
                         & h21.k=g2.(h2.k) by A22,A689,A695,FUNCT_1:23;
A701:g1.(h1.(1+1)) in rng g1 by A6,A9,A698,BORSUK_1:83,FUNCT_1:def 5;
                  A702:h0.i in Lower_Arc(P)
                  by A13,A15,A16,A697,A700,BORSUK_1:83,FUNCT_1:def 5;
                      h0/.i <> W-min P
              by A17,A22,A29,A31,A67,A663,A687,A689,A696,A699,FUNCT_1:def 8;
                 hence LE h0/.(1+1),h0/.i,P
                 by A4,A663,A668,A670,A690,A701,A702,JORDAN6:def 10;
               end;
               end;
A703:LE h0/.i,h0/.(i+1),P & h0/.(i+1)<>W-min(P) & h0/.i<>h0/.(i+1)
             by A541,A657,A658;
          i <> 1 by A659,Lm2;
      then h0/.i <> h0/.1 by A63,A68,A662,PARTFUN2:17;

       hence Segment(h0/.i,h0/.len h0,P)/\ Segment(h0/.len h0,h0/.1,P)={h0/.len
h0}
          by A1,A65,A657,A703,Th11;
              now assume A704:h0/.(1+1)=h0/.i;
                A705:1+1 in dom h1 by A58,FINSEQ_3:27;
                then A706: h1.(1+1) in rng h1 by FUNCT_1:def 5;
                A707:h0.(1+1)=h11.(1+1) by A21,A58,FINSEQ_1:85;
                then h0.(1+1)=g1.(h1.(1+1)) by A705,FUNCT_1:23;
          then A708:h0.(1+1) in Upper_Arc(P) by A4,A6,A9,A706,BORSUK_1:83
,FUNCT_1:def 5;
             per cases;
             suppose A709:i<=len h1;
                then A710:h0.i=h11.i by A21,A658,FINSEQ_1:85;
                    i in dom h1 by A658,A709,FINSEQ_3:27;
              hence contradiction
               by A20,A66,A660,A663,A668,A704,A705,A707,A710,FUNCT_1:def 8;
             end;
             suppose A711:i>len h1;
                  then A712:len h1 +1<=i by NAT_1:13;
then A713:     h0.i=(mid(h21,2,len h21 -'1)).(i -len h11)
                  by A21,A40,A661,FINSEQ_1:36;
                  A714:i-len h11=i-'len h11 by A21,A711,BINARITH:50;
                    A715: i-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len
h11
                                         by A40,A661,XREAL_1:11;
                      len h1 +1-len h1<=i-len h1 by A712,XREAL_1:11;
                  then A716:h0.i=h21.(i-'len h11 +2-'1)
                             by A21,A43,A45,A713,A714,A715,JORDAN3:27;
                      0<=i-'len h11 by NAT_1:2;
                  then A717: 0+2<=i-'len h11 +2 by XREAL_1:8;
                  then A718:2-'1<=(i-'len h11 +2-'1) by BINARITH:60;
                      i-len h11<=len h1+(len h2-2)-len h11
                    by A21,A23,A40,A42,A46,A47,A661,XREAL_1:11;
                  then i-'len h11+2<=len h2-2+2 by A21,A714,XREAL_1:8;
                  then A719:1<=(i-'len h11 +2-'1) & (i-'len h11 +2-'1)<=len h21
                                    by A23,A717,Lm1,BINARITH:60,62;
                  A720:i-'len h11+2-'1=i-'len h11+2-1
                          by A718,Lm1,BINARITH:57;
                  set k=i-'len h11+2-'1;
                      i-len h11<=len h1+(len h2-2)-len h11 by A21,A23,A40,A42
,A46,A47,A661,XREAL_1:11;
                  then A721: i-'len h11+2<=len h2-2+2 by A21,A714,XREAL_1:8;
                    A722: i-'len h11+2-'1<i-'len h11+2-1+1 by A720,NAT_1:13;
                      len h11+1-len h11<=i-len h11 by A21,A712,XREAL_1:11;
                  then 1<=i-'len h11 by BINARITH:57;
                  then 1+2<=i-'len h11+2 by XREAL_1:8;
                  then 1+2-1<=i-'len h11+2-1 by XREAL_1:11;
                  then A723:1<k by A720,XXREAL_0:2;
                  A724:k in dom h2 by A22,A719,FINSEQ_3:27;
                  then A725:h0.i=g2.(h2.k) by A716,FUNCT_1:23;
                  A726: h2.k in rng h2 by A724,FUNCT_1:def 5;
                      i in dom h0 by A658,A661,FINSEQ_3:27;
                  then A727:h0/.i=h0.i by PARTFUN1:def 8;
                g2.(h2.k) in rng g2 by A15,A16,A726,BORSUK_1:83,FUNCT_1:def 5;
               then h0.i in Upper_Arc(P) /\ Lower_Arc(P)
                         by A13,A668,A704,A708,A725,A727,XBOOLE_0:def 3;
               then h0.i in {W-min(P),E-max(P)} by A1,JORDAN6:def 9;
               then h0.i=W-min(P) or h0.i=E-max(P)by TARSKI:def 2;
              hence contradiction by A22,A28,A29,A30,A31,A67,A716,A721,A722
,A723,A724,FUNCT_1:def 8;
             end;
          end;
     hence Segment(h0/.i,h0/.len h0,P) misses Segment(h0/.1,h0/.2,P)
           by A1,A657,A666,A667,A669,A675,Th13;
     thus for i,j being Element of NAT
           st 1<=i & i < j & j < len h0 & not i,j are_adjacent1
         holds Segment(h0/.i,h0/.(i+1),P) misses Segment(h0/.j,h0/.(j+1),P)
     proof
      let i,j be Element of NAT;assume that
A728:    1<=i and
A729:    i < j and
A730:    j < len h0 and
A731:    not i,j are_adjacent1;
A732:  i<len h0 by A729,A730,XXREAL_0:2;
A733:  1<j by A728,A729,XXREAL_0:2;
        A734:i+1<=len h0 by A732,NAT_1:13;
        A735:j+1<=len h0 by A730,NAT_1:13;
        A736:LE h0/.i,h0/.(i+1),P by A541,A728,A734;
        A737:LE h0/.j,h0/.(j+1),P by A541,A733,A735;
        A738:not(j=i+1 or i=j+1) by A731,GOBRD10:def 1;
A739:      i+1<=j by A729,NAT_1:13;
           then A740:i+1<j by A738,REAL_1:def 5;
           A741:i+1<len h0 by A730,A739,XXREAL_0:2;
          A742:h0/.i<>h0/.(i+1) by A541,A728,A734;
          A743:1<i+1 by A728,NAT_1:13;
          A744:1<=(i+1) & (i+1)<len h0 by A728,A730,A739,NAT_1:13,XXREAL_0:2;
          A745:LE h0/.(i+1),h0/.j,P
            proof
              per cases;
              suppose A746:i+1<=len h1;
               per cases;
               suppose A747:j<=len h1;
                A748:h0.(i+1)=h11.(i+1) by A21,A744,A746,FINSEQ_1:85;
                A749:(i+1) in dom h1 by A744,A746,FINSEQ_3:27;
then A750:            h1.(i+1) in rng h1 by FUNCT_1:def 5;
                A751:1<j by A740,A744,XXREAL_0:2;
                then A752:h0.j=h11.j by A21,A747,FINSEQ_1:85;
                A753:j in dom h1 by A747,A751,FINSEQ_3:27;
then A754:            h1.j in rng h1 by FUNCT_1:def 5;
                    i+1 in dom h0 by A744,FINSEQ_3:27;
                then A755:h0/.(i+1)=h0.(i+1) by PARTFUN1:def 8;
                    j in dom h0 by A730,A751,FINSEQ_3:27;
                then h0/.j=h0.j by PARTFUN1:def 8;
                then Upper_Arc(P) is_an_arc_of W-min(P),E-max(P) &
                g1.(h1.(i+1)) = h0/.(i+1) & 0 <= (h1.(i+1)) & (h1.(i+1)) <= 1
                & g1.(h1.j) = h0/.j
                & 0 <= (h1.j) & (h1.j) <= 1
                                  & (h1.(i+1)) <= (h1.j)
                      by A1,A9,A740,A748,A749,A750,A752,A753,A754,A755,
BORSUK_1:83,FUNCT_1:23,GOBOARD1:def 1,JORDAN6:def 8,RCOMP_1:48;
                then h0/.(i+1) in Upper_Arc(P) & h0/.j in Upper_Arc(P) &
                LE h0/.(i+1),h0/.j,Upper_Arc(P),W-min(P),E-max(P)
                                       by A3,A4,A5,A6,A9,A750,A754,Th19,
BORSUK_1:83,FUNCT_1:def 5;
               hence thesis by JORDAN6:def 10;
               end;
               suppose A756:j>len h1;
                   then A757:len h11<=j
                   & j<=len h11 + len (mid(h21,2,len h21 -'1))
                                        by A20,A730,FINSEQ_1:35,FINSEQ_3:31;
                  A758:j-len h11=j-'len h11 by A21,A756,BINARITH:50;
                      j-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                        by A757,XREAL_1:11;
then A759:0<=j-'len h11
                      & j-'len h11<=len mid(h21,2,len h21 -'1)
                             by A21,A756,A758,XREAL_1:50;
                  A760: j-len h11
                       <=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                           by A40,A730,XREAL_1:11;
                    0+1<=j-'len h11+1+1-1 by A759,XREAL_1:8;
                  then A761:j-'len h11+2-'1=j-'len h11+2-1 by BINARITH:57;
                      0<=j-'len h11 by NAT_1:2;
                  then 0+2<=j-'len h11 +2 by XREAL_1:8;
                  then A762:2-'1<=j-'len h11 +2-'1 by BINARITH:60;
                      j-len h11<=len h1+(len h2-2)-len h11
                            by A21,A23,A40,A42,A46,A47,A730,XREAL_1:11;
                  then j-'len h11+2<=len h2-2+2 by A21,A758,XREAL_1:8;
then A763: (j-'len h11 +2-'1)<=len h21 by A23,BINARITH:62;
                  then A764:(j-'len h11 +2-'1) in dom h21 by A762,Lm1,
FINSEQ_3:27;
                     i+1 in Seg len h1 by A744,A746,FINSEQ_1:3;
then i+1 in dom h1 by FINSEQ_1:def 3;
                  then A765: j-len h11=j-'len h11
                  & h0.(i+1)=h11.(i+1) & (j-'len h11 +2-'1) in dom h21
                  & j-'len h11+2-'1=j-'len h11+2-1
                  & j-len h11 <= len (mid(h21,2,len h21 -'1))
                  & (i+1) in dom h1 & h11.(i+1)=g1.(h1.(i+1))
              by A21,A743,A746,A756,A760,A762,A763,Lm1,BINARITH:50,57
,FINSEQ_1:85,FINSEQ_3:27,FUNCT_1:23;
                  A766:len h1 +1<=j by A756,NAT_1:13;
                  then A767:h0.j=(mid(h21,2,len h21 -'1)).(j -len h11)
                                      by A21,A40,A730,FINSEQ_1:36;
                    A768: len h1 +1-len h1<=j-len h1 by A766,XREAL_1:11;
                  then A769:h0.j=h21.(j-'len h11 +2-'1)
                    by A21,A43,A45,A758,A760,A767,JORDAN3:27;
                      j+1-1<=len h1+(len h2-2)-1 by A21,A23,A40,A42,A46,A47
,A735,XREAL_1:11;
                  then j-len h11<=len h1+((len h2-2)-1)-len h11 by XREAL_1:11;
                  then j-'len h11+2<=len h2-2-1+2 by A21,A758,XREAL_1:8;
                  then A770:j-'len h11+2-1<=len h2-1-1 by XREAL_1:11;
                  A771: len h2-1-1<len h2 by Lm4;
                  set k=j-'len h11+2-'1;
                  A772: h2.k in rng h2 by A22,A764,FUNCT_1:def 5;
                      i+1 in dom h1 by A743,A746,FINSEQ_3:27;
                  then A773: h1.(i+1) in rng h1 by FUNCT_1:def 5;
                  A774:  h0.j=h21.k by A21,A43,A45,A765,A767,A768,JORDAN3:27;
                  A775:h0.j=g2.(h2.k) & h21.k=g2.(h2.k) by A22,A764,A769,
FUNCT_1:23;
                      (i+1) in dom h0 by A744,FINSEQ_3:27;
                  then A776:h0/.(i+1)=h0.(i+1) by PARTFUN1:def 8;
                      j in dom h0 by A730,A733,FINSEQ_3:27;
                  then A777:h0/.j=h0.j by PARTFUN1:def 8;
                  A778:g1.(h1.(i+1)) in rng g1 by A6,A9,A773,BORSUK_1:83
,FUNCT_1:def 5;
                  A779:h0.j in Lower_Arc(P)
                           by A13,A15,A16,A772,A775,BORSUK_1:83,FUNCT_1:def 5;
                      h0/.j <> W-min P
                 by A22,A29,A31,A67,A761,A764,A770,A771,A774,A777,FUNCT_1:def 8
;
                 hence thesis by A4,A765,A776,A777,A778,A779,JORDAN6:def 10;
               end;
              end;
              suppose A780:i+1>len h1;
then A781:                len h1<j by A739,XXREAL_0:2;
                  then A782:j-len h11=j-'len h11 by A21,BINARITH:50;
                      j-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                        by A40,A730,XREAL_1:11;
then A783:0<=j-'len h11
                      & j-'len h11<=len mid(h21,2,len h21 -'1)
                               by A21,A781,A782,XREAL_1:50;
                  A784: j-len h11
                       <=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                         by A40,A730,XREAL_1:11;
                    0+1<=j-'len h11+1+1-1 by A783,XREAL_1:8;
                  then A785:j-'len h11+2-'1=j-'len h11+2-1 by BINARITH:57;
                      0<=j-'len h11 by NAT_1:2;
                  then 0+2<=j-'len h11 +2 by XREAL_1:8;
                  then A786:2-'1<=j-'len h11 +2-'1 by BINARITH:60;
                      j-len h11<=len h1+(len h2-2)-len h11 by A21,A23,A40,A42
,A46,A47,A730,XREAL_1:11;
                  then j-'len h11+2<=len h2-2+2 by A21,A782,XREAL_1:8;
then A787: (j-'len h11 +2-'1)<=len h21 by A23,BINARITH:62;
                  then A788:j-'len h11 +2-'1 in dom h21 by A786,Lm1,FINSEQ_3:27
;
                  A789:len h11+1<=i+1
                      & i+1<len h11 + len (mid(h21,2,len h21 -'1))
                                   by A21,A741,A780,FINSEQ_1:35,NAT_1:13;
                  A790: i+1-len h11<len h11 + len (mid(h21,2,len h21 -'1)) -
len h11
                             by A40,A741,XREAL_1:11;
                      len h1+1<=i+1 by A780,NAT_1:13;
                  then len h1+1-len h1<=i+1-len h1 by XREAL_1:11;
                  then A791:1<=i+1-'len h11 & i+1-'len h11=i+1-len h11
                                     by A21,BINARITH:57;
A792:               h0.(i+1)=(mid(h21,2,len h21 -'1)).(i+1 -len h11)
                                      by A789,FINSEQ_1:36
                              .=h21.(i+1-'len h11+2-'1)
                    by A43,A45,A790,A791,JORDAN3:27;
                  then A793: j-len h11=j-'len h11 & (i+1)-len h11=(i+1)-'len
h11
                  & h0.(i+1)=h21.(i+1-'len h11+2-'1)
                  & (j-'len h11 +2-'1) in dom h21
                  & len h11+1<=i+1
                  & i+1<=len h11 + len (mid(h21,2,len h21 -'1))
                  & j-'len h11+2-'1=j-'len h11+2-1
                  & j-len h11 <= len (mid(h21,2,len h21 -'1))
                  & i+1-len h11<len (mid(h21,2,len h21 -'1))
                  by A21,A40,A730,A780,A781,A786,A787,A790,Lm1,BINARITH:50,57
,FINSEQ_3:27,NAT_1:13,XREAL_1:11;
                      len h1<j by A739,A780,XXREAL_0:2;
                  then A794:len h11+1<=j
                   & j<=len h11 + len (mid(h21,2,len h21 -'1))
                               by A21,A730,FINSEQ_1:35,NAT_1:13;
                  then A795:h0.j=(mid(h21,2,len h21 -'1)).(j -len h11)
                                      by FINSEQ_1:36;
                    A796: len h1 +1-len h1<=j-len h1 by A21,A794,XREAL_1:11;
                  then A797:h0.j=h21.(j-'len h11 +2-'1)
                    by A21,A43,A45,A782,A784,A795,JORDAN3:27;
                      0<=(i+1)-'len h11 by NAT_1:2;
                  then A798: 0+2<=(i+1)-'len h11 +2 by XREAL_1:8;
                  then A799:2-'1<=((i+1)-'len h11 +2-'1) by BINARITH:60;
                    (i+1)-'len h11+2<=len h2-2+2 by A23,A42,A46,A47,A793,
XREAL_1:8;
                  then A800:1<=((i+1)-'len h11 +2-'1)
                      & ((i+1)-'len h11 +2-'1)<=len h21
                                    by A23,A798,Lm1,BINARITH:60,62;
                  A801:(i+1)-'len h11+2-'1=(i+1)-'len h11+2-1
                                  by A799,Lm1,BINARITH:57;
                      j+1-1<=len h1+(len h2-2)-1 by A21,A23,A40,A42,A46,A47
,A735,XREAL_1:11
;
                  then j-len h11<=len h1+((len h2-2)-1)-len h11 by XREAL_1:11;
                  then j-'len h11+2<=len h2-2-1+2 by A21,A782,XREAL_1:8;
                  then A802:j-'len h11+2-1<=len h2-1-1 by XREAL_1:11;
                  A803: len h2-1-1<len h2 by Lm4;
                  set k=j-'len h11+2-'1;
                  set j0=(i+1)-'len h11+2-'1;
                      (i+1)-len h11<j-len h11 by A740,XREAL_1:11;
                  then (i+1)-'len h11+2<j-'len h11+2 by A793,XREAL_1:8;
                  then A804:j0<k by A785,A801,XREAL_1:11;
                  A805:h21.k=g2.(h2.k) by A22,A788,FUNCT_1:23;
A806:              h2.k in rng h2 by A22,A788,FUNCT_1:def 5;
                  then A807:0<=h2.k & h2.k<=1 by A16,BORSUK_1:83,RCOMP_1:48;
                  A808:j0 in dom h2 by A22,A800,FINSEQ_3:27;
                  then A809:h0.(i+1)=g2.(h2.j0) by A792,FUNCT_1:23;
A810:              h2.j0 in rng h2 by A808,FUNCT_1:def 5;
                  then A811:0<=h2.j0 & h2.j0<=1 by A16,BORSUK_1:83,RCOMP_1:48;
                  A812:h2.(j0)<h2.(k) by A16,A22,A788,A804,A808,GOBOARD1:def 1;
                  A813:  h0.j=h21.(k) by A21,A43,A45,A793,A795,A796,JORDAN3:27;
                  A814:h0.j=g2.(h2.k) & h21.k=g2.(h2.k) by A22,A788,A797,
FUNCT_1:23;
                      (i+1) in dom h0 by A744,FINSEQ_3:27;
                  then A815:h0/.(i+1)=h0.(i+1) by PARTFUN1:def 8;
                      j in dom h0 by A730,A733,FINSEQ_3:27;
                  then A816:h0/.j=h0.(j) by PARTFUN1:def 8;
                  A817:g2.(h2.j0) in rng g2 by A15,A16,A810,BORSUK_1:83
,FUNCT_1:def 5;
                  A818:h0.(j) in Lower_Arc(P)
                   by A13,A15,A16,A806,A814,BORSUK_1:83,FUNCT_1:def 5;
A819:            h0/.j <> W-min P
                  by A22,A29,A31,A67,A785,A788,A802,A803,A813,A816,
FUNCT_1:def 8;
                    LE h0/.(i+1),h0/.j,Lower_Arc(P),E-max(P),W-min(P)
                     by A11,A12,A13,A14,A797,A805,A807,A809,A811,A812,A815,A816
,Th19;
                 hence thesis by A13,A809,A815,A816,A817,A818,A819,
JORDAN6:def 10;
              end;
            end;
              now assume A820:h0/.(i+1)=h0/.j;
            per cases;
            suppose A821:i+1<=len h1;
                A822:1<i+1 by A728,NAT_1:13;
                then A823:i+1 in dom h1 by A821,FINSEQ_3:27;
                    i+1 in dom h0 by A734,A822,FINSEQ_3:27;
                then A824:h0/.(i+1)=h0.(i+1) by PARTFUN1:def 8;
                A825:h0.(i+1)=h11.(i+1) by A21,A821,A822,FINSEQ_1:85;
                then A826:h0.(i+1)=g1.(h1.(i+1)) by A823,FUNCT_1:23;
                    h1.(i+1) in rng h1 by A823,FUNCT_1:def 5;
                then A827:h0.(i+1) in Upper_Arc(P)
                             by A4,A6,A9,A826,BORSUK_1:83,FUNCT_1:def 5;
             per cases;
             suppose A828:j<=len h1;
                then A829:h0.(j)=h11.(j) by A21,A733,FINSEQ_1:85;
                A830:j in dom h1 by A733,A828,FINSEQ_3:27;
                    j in dom h0 by A730,A733,FINSEQ_3:27;
                then h0/.j=h0.j by PARTFUN1:def 8;
              hence contradiction by A20,A66,A738,A820,A823,A824,A825,A829,A830
,FUNCT_1:def 8;
             end;
             suppose A831:j>len h1;
                  then A832:len h1 +1<=j by NAT_1:13;
                  A833:len h11+1<=j & j<=
len h11 + len (mid(h21,2,len h21 -'1)) by A21,A730,A831,FINSEQ_1:35,NAT_1:13;
A834: h0.j=(mid(h21,2,len h21 -'1)).(j -len h11)
              by A21,A40,A730,A832,FINSEQ_1:36;
                  A835:j-len h11=j-'len h11 by A21,A831,BINARITH:50;
                    A836: j-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len
h11
                                         by A833,XREAL_1:11;
                      len h1 +1-len h1<=j-len h1 by A832,XREAL_1:11;
                  then A837:h0.j=h21.(j-'len h11 +2-'1)
                             by A21,A43,A45,A834,A835,A836,JORDAN3:27;
                      0<=j-'len h11 by NAT_1:2;
                  then A838: 0+2<=j-'len h11 +2 by XREAL_1:8;
                  then A839:2-'1<=(j-'len h11 +2-'1) by BINARITH:60;
                      j-len h11<=len h1+(len h2-2)-len h11
                           by A21,A23,A40,A42,A46,A47,A730,XREAL_1:11;
                  then j-'len h11+2<=len h2-2+2 by A21,A835,XREAL_1:8;
then A840:1<=(j-'len h11 +2-'1) & (j-'len h11 +2-'1)<=
len h21
                                    by A23,A838,Lm1,BINARITH:60,62;
                  A841:j-'len h11+2-'1=j-'len h11+2-1
                     by A839,Lm1,BINARITH:57;
                  set k=j-'len h11+2-'1;
                      j-len h11<=len h1+(len h2-2)-len h11
                                   by A21,A23,A40,A42,A46,A47,A730,XREAL_1:11;
                  then A842: j-'len h11+2<=len h2-2+2 by A21,A835,XREAL_1:8;
                    A843: j-'len h11+2-'1<j-'len h11+2-'1+1 by NAT_1:13;
                      len h11+1-len h11<=j-len h11 by A21,A832,XREAL_1:11
;
                  then 1<=j-'len h11 by BINARITH:57;
                  then 1+2<=j-'len h11+2 by XREAL_1:8;
                  then 1+2-1<=j-'len h11+2-1 by XREAL_1:11;
                  then A844:1<k by A841,XXREAL_0:2;
                  A845:k in dom h2 by A22,A840,FINSEQ_3:27;
                  then A846:h0.j=g2.(h2.k) by A837,FUNCT_1:23;
                  A847: h2.k in rng h2 by A845,FUNCT_1:def 5;
                      j in dom h0 by A730,A733,FINSEQ_3:27;
                  then A848:h0/.j=h0.j by PARTFUN1:def 8;
                      g2.(h2.k) in rng g2 by A15,A16,A847,BORSUK_1:83
,FUNCT_1:def 5;
                  then h0.j in Upper_Arc(P) /\ Lower_Arc(P)
                            by A13,A820,A824,A827,A846,A848,XBOOLE_0:def 3;
                  then A849:         h0.j in {W-min(P),E-max(P)} by A1,
JORDAN6:def 9;
A850:         h0.j <> W-min P
                   by A22,A29,A31,A67,A837,A841,A842,A843,A845,FUNCT_1:def 8;
                   h0.j <> E-max P
                   by A22,A28,A30,A67,A837,A844,A845,FUNCT_1:def 8;
              hence contradiction by A849,A850,TARSKI:def 2;
             end;
            end;
            suppose A851:i+1>len h1;
                  then A852:len h1 +1<=i+1 by NAT_1:13;
                  then A853:h0.(i+1)=(mid(h21,2,len h21 -'1)).((i+1) -len h11)
                                     by A21,A40,A734,FINSEQ_1:36;
                  A854:(i+1)-len h11=(i+1)-'len h11 by A21,A851,BINARITH:50;
                    A855: (i+1)-len h11
                   <=len h11 + len (mid(h21,2,len h21 -'1))-len h11
                                         by A40,A734,XREAL_1:11;
                      len h1 +1-len h1<=(i+1)-len h1 by A852,XREAL_1:11
;
                  then A856:h0.(i+1)=h21.((i+1)-'len h11 +2-'1)
                             by A21,A43,A45,A853,A854,A855,JORDAN3:27;
                      0<=(i+1)-'len h11 by NAT_1:2;
                  then A857: 0+2<=(i+1)-'len h11 +2 by XREAL_1:8;
                  then A858:2-'1<=((i+1)-'len h11 +2-'1) by BINARITH:60;
                      (i+1)-len h11<=len h1+(len h2-2)-len h11
                            by A21,A23,A40,A42,A46,A47,A734,XREAL_1:11;
                  then (i+1)-'len h11+2<=len h2-2+2 by A21,A854,XREAL_1:8;
then A859:1<=((i+1)-'len h11 +2-'1)
                  & ((i+1)-'len h11 +2-'1)<=len h21
                                    by A23,A857,Lm1,BINARITH:60,62;
                  A860:(i+1)-'len h11+2-'1=(i+1)-'len h11+2-1
                                 by A858,Lm1,BINARITH:57;
                  set j0=(i+1)-'len h11+2-'1;
                      len h11+1-len h11<=(i+1)-len h11
                           by A21,A852,XREAL_1:11;
                  then A861:(i+1)-'len h11=(i+1)-len h11 by BINARITH:57;
                  A862:j0 in dom h2 by A22,A859,FINSEQ_3:27;
                      1<=i+1 by A728,NAT_1:13;
                  then i+1 in dom h0 by A734,FINSEQ_3:27;
                  then A863:h0/.(i+1)=h0.(i+1) by PARTFUN1:def 8;
                  A864:j>len h1 by A739,A851,XXREAL_0:2;
                  then A865:len h1 +1<=j by NAT_1:13;
                      len h11+1<=j & j<=
len h11 + len (mid(h21,2,len h21 -'1)) by A21,A730,A864,FINSEQ_1:35,NAT_1:13;
then A866: h0.j=(mid(h21,2,len h21 -'1)).(j -len h11)
                     by FINSEQ_1:36;
                  A867:j-len h11=j-'len h11 by A21,A864,BINARITH:50;
                  A868: j-len h11<=len h11 + len (mid(h21,2,len h21 -'1))-len
h11
                                    by A40,A730,XREAL_1:11;
                      len h1 +1-len h1<=j-len h1 by A865,XREAL_1:11;
                  then A869:h0.j=h21.(j-'len h11 +2-'1)
                             by A21,A43,A45,A866,A867,A868,JORDAN3:27;
                      0<=j-'len h11 by NAT_1:2;
                  then A870: 0+2<=j-'len h11 +2 by XREAL_1:8;
                  then A871:2-'1<=(j-'len h11 +2-'1) by BINARITH:60;
                      j-len h11<=len h1+(len h2-2)-len h11 by A21,A23,A40,A42
,A46,A47,A730,XREAL_1:11;
                  then j-'len h11+2<=len h2-2+2 by A21,A867,XREAL_1:8;
                  then A872:1<=(j-'len h11 +2-'1) & (j-'len h11 +2-'1)<=len h21
                                    by A23,A870,Lm1,BINARITH:60,62;
                  A873:j-'len h11+2-'1=j-'len h11+2-1
                      by A871,Lm1,BINARITH:57;
                  set k=j-'len h11+2-'1;
                      len h11+1-len h11<=j-len h11 by A21,A865,XREAL_1:11;
                  then j-'len h11=j-len h11 by BINARITH:57;
                  then i+1-'len h11<j-'len h11 by A740,A861,XREAL_1:11;
                  then i+1-'len h11+2<j-'len h11+2 by XREAL_1:8;
                  then A874:(i+1)-'len h11+2-'1<j-'len h11+2-'1
                            by A860,A873,XREAL_1:11;
                  A875:k in dom h2 by A22,A872,FINSEQ_3:27;
                      j in dom h0 by A730,A733,FINSEQ_3:27;
                  then h0/.j=h0.j by PARTFUN1:def 8;
                 hence contradiction
      by A22,A67,A820,A856,A862,A863,A869,A874,A875,FUNCT_1:def 8;
            end;
          end;
     hence Segment(h0/.i,h0/.(i+1),P) misses Segment(h0/.j,h0/.(j+1),P)
                   by A1,A736,A737,A742,A745,Th13;
    end;
   let i be Element of NAT such that
A876: 1 < i and
A877: i+1 < len h0;
A878:  i<len h0 by A877,NAT_1:13;
A879: LE h0/.i,h0/.(i+1),P by A541,A876,A877;
A880: 1<i+1 by A876,NAT_1:13;
A881: h0/.i<>h0/.(i+1) by A541,A876,A877;
A882: i in dom h0 by A876,A878,FINSEQ_3:27;
     then h0/.i = h0.i by PARTFUN1:def 8;
then A883: h0/.i<>W-min P by A39,A63,A68,A876,A882,FUNCT_1:def 8;
A884: i+1 in dom h0 by A877,A880,FINSEQ_3:27;
      set k=len h0-'len h11+2-'1;
          0<=len h0-'len h11 by NAT_1:2;
      then 0+2<=len h0-'len h11 +2 by XREAL_1:8;
then A885: 2-'1<=len h0-'len h11 +2-'1 by BINARITH:60;
       (len h0-'len h11 +2-'1)<=len h21 by A40,A42,A46,A47,A57,BINARITH:62;
      then A886: (len h0-'len h11 +2-'1) in dom h21 by A885,Lm1,FINSEQ_3:27;
    h0.len h0=mid(h21,2,len h21 -'1).(len h0 -len h11)
                        by A21,A40,A51,FINSEQ_1:36;
then A887: h0.len h0=h21.(len h0-'len h11 +2-'1)
             by A21,A40,A43,A45,A56,A57,JORDAN3:27;
A888: h21.k=g2.(h2.k) by A22,A886,FUNCT_1:23;
      A889: h2.k in rng h2 by A22,A886,FUNCT_1:def 5;
then A890: h0.len h0 in Lower_Arc(P) by A13,A15,A16,A887,A888,BORSUK_1:83
,FUNCT_1:def 5;
A891:LE h0/.(i+1),h0/.len h0,P
      proof
       per cases;
       suppose A892:i+1<=len h1;
then A893:      h0.(i+1)=h11.(i+1) by A21,A880,FINSEQ_1:85;
             i+1 in dom h1 by A880,A892,FINSEQ_3:27;
         then A894:      h11.(i+1)=g1.(h1.(i+1)) by FUNCT_1:23;
                      i+1 in dom h1 by A880,A892,FINSEQ_3:27;
                  then A895: h1.(i+1) in rng h1 by FUNCT_1:def 5;
                  A896:h0/.(i+1)=h0.(i+1) by A884,PARTFUN1:def 8;
                           g1.(h1.(i+1)) in rng g1 by A6,A9,A895,BORSUK_1:83
,FUNCT_1:def 5;
        hence thesis by A4,A55,A125,A890,A893,A894,A896,JORDAN6:def 10;
       end;
       suppose A897:i+1>len h1;
             0<=len h0-'len h11 by A21,A52,A57,XREAL_1:50;
                   then 0+1<=len h0-'len h11+1+1-1 by XREAL_1:8;
                  then A898:len h0-'len h11+2-'1=len h0-'len h11+2-1 by
BINARITH:57;
A899: (len h0-'len h11 +2-'1)<=len h21 by A40,A42,A46,A47,A57,BINARITH:62;
                  then A900:len h0-'len h11 +2-'1 in dom h21
                  by A885,Lm1,FINSEQ_3:27;
A901:             len h11+1<=i+1 by A21,A897,NAT_1:13;
A902:             i+1<len h11 + len (mid(h21,2,len h21 -'1)) by A877,
FINSEQ_1:35;
                    A903: i+1-len h11<len h11 + len (mid(h21,2,len h21 -'1)) -
len h11
                             by A40,A877,XREAL_1:11;
                      len h1+1<=i+1 by A897,NAT_1:13;
                  then A904: len h1+1-len h1<=i+1-len h1 by XREAL_1:11;
then A905:             i+1-'len h11=i+1-len h11 by A21,BINARITH:57;
A906:              h0.(i+1) = mid(h21,2,len h21 -'1).(i+1 -len h11)
                                      by A901,A902,FINSEQ_1:36
                          .= h21.(i+1-'len h11+2-'1)
                    by A21,A43,A45,A903,A904,A905,JORDAN3:27;
A907:             (i+1)-len h11=(i+1)-'len h11 by A21,A897,BINARITH:50;
A908:             (len h0-'len h11 +2-'1) in dom h21 by A885,A899,Lm1,
FINSEQ_3:27;
                     h0.len h0=(mid(h21,2,len h21 -'1)).(len h0 -len h11)
                                      by A21,A40,A51,FINSEQ_1:36;
                  then A909:h0.len h0=h21.(len h0-'len h11 +2-'1)
                    by A21,A40,A43,A45,A56,A57,JORDAN3:27;
                      0<=(i+1)-'len h11 by NAT_1:2;
                  then 0+2<=(i+1)-'len h11 +2 by XREAL_1:8;
                  then A910:2-'1<=((i+1)-'len h11 +2-'1) by BINARITH:60;
                      (i+1)-len h11<=len h11+(len h2-2)-len h11
                                    by A23,A40,A42,A46,A47,A877,XREAL_1:11;
                  then (i+1)-'len h11+2<=len h2-2+2 by A907,XREAL_1:8;
then A911:           (i+1)-'len h11 +2-'1 <= len h21 by A23,BINARITH:62;
                  A912:(i+1)-'len h11+2-'1=(i+1)-'len h11+2-1
                                  by A910,Lm1,BINARITH:57;
                  set k=len h0-'len h11+2-'1;
                  set j0=(i+1)-'len h11+2-'1;
                      (i+1)-len h11<len h0-len h11 by A877,XREAL_1:11;
                  then (i+1)-'len h11+2<len h0-'len h11+2 by A57,A907,XREAL_1:8
;
                  then A913:j0<k by A898,A912,XREAL_1:11;
                  A914:h21.k=g2.(h2.k) by A22,A900,FUNCT_1:23;
              h2.k in rng h2 by A22,A908,FUNCT_1:def 5;
then A915:             h2.k<=1 by A16,BORSUK_1:83,RCOMP_1:48;
                  A916:j0 in dom h2 by A22,A910,A911,Lm1,FINSEQ_3:27;
                  then A917:h0.(i+1)=g2.(h2.j0) by A906,FUNCT_1:23;
A918:              h2.j0 in rng h2 by A916,FUNCT_1:def 5;
then A919:             0<=h2.j0 by A16,BORSUK_1:83,RCOMP_1:48;
A920:             h2.j0<=1 by A16,A918,BORSUK_1:83,RCOMP_1:48;
                  A921:h2.(j0)<h2.(k)
                  by A16,A22,A908,A913,A916,GOBOARD1:def 1;
                  A922:h0/.(i+1)=h0.(i+1) by A884,PARTFUN1:def 8;
                     g2.(h2.j0) in rng g2 by A15,A16,A918,BORSUK_1:83
,FUNCT_1:def 5;
                  then A923:h0.(i+1) in Lower_Arc(P) by A13,A906,A916,
FUNCT_1:23;
                     h0.(len h0) in Lower_Arc(P) by A13,A15,A16,A887,A888,A889,
BORSUK_1:83,FUNCT_1:def 5;
then A924:       h0/.len h0 in Lower_Arc P by A54,PARTFUN1:def 8;
            LE h0/.(i+1),h0/.len h0,Lower_Arc(P),E-max(P),W-min(P)
             by A11,A12,A13,A14,A55,A909,A914,A915,A917,A919,A920,A921,A922,
Th19;
       hence thesis by A125,A922,A923,A924,JORDAN6:def 10;
      end;
      end;
              now assume A925:h0/.(i+1)=h0/.len h0;
            per cases;
            suppose A926:i+1<=len h1;
                    i+1 in dom h0 by A877,A880,FINSEQ_3:27;
                then A927:h0/.(i+1)=h0.(i+1) by PARTFUN1:def 8;
                A928:h0.(i+1)=h11.(i+1) by A21,A880,A926,FINSEQ_1:85;
                A929:i+1 in dom h1 by A880,A926,FINSEQ_3:27;
                then A930:h0.(i+1)=g1.(h1.(i+1)) by A928,FUNCT_1:23;
                    h1.(i+1) in rng h1 by A929,FUNCT_1:def 5;
                then A931:h0.(i+1) in Upper_Arc(P)
                             by A4,A6,A9,A930,BORSUK_1:83,FUNCT_1:def 5;
 h0.len h0=(mid(h21,2,len h21 -'1)).(len h0 -len h11)
              by A21,A40,A51,FINSEQ_1:36;
                  then A932:h0.len h0=h21.(len h0-'len h11 +2-'1)
                             by A21,A40,A43,A45,A56,A57,JORDAN3:27;
                      0<=len h0-'len h11 by NAT_1:2;
                  then 0+2<=len h0-'len h11 +2 by XREAL_1:8;
                  then A933:2-'1<=(len h0-'len h11 +2-'1) by BINARITH:60;
A934:            len h0-'len h11 +2-'1 <= len h21 by A40,A42,A46,A47,A57,
BINARITH:62;
                  A935:len h0-'len h11+2-'1=len h0-'len h11+2-1
                     by A933,Lm1,BINARITH:57;
                  set k=len h0-'len h11+2-'1;
                    A936: len h0-'len h11+2-'1<len h0-'len h11+2-'1+1 by
NAT_1:13;
                      1+2<=len h0-'len h11+2 by A23,A40,A42,A46,A47,A50,A57,
XREAL_1:8;
                  then 1+2-1<=len h0-'len h11+2-1 by XREAL_1:11;
                  then A937:1<k by A935,XXREAL_0:2;
                  A938:k in dom h2 by A22,A933,A934,Lm1,FINSEQ_3:27;
                  then A939:h0.len h0=g2.(h2.k) by A932,FUNCT_1:23;
                      h2.k in rng h2 by A938,FUNCT_1:def 5;
                  then g2.(h2.k) in rng g2 by A15,A16,BORSUK_1:83,FUNCT_1:def 5
;
                  then h0.len h0 in Upper_Arc(P) /\ Lower_Arc(P)
                   by A13,A55,A925,A927,A931,A939,XBOOLE_0:def 3;
then A940:         h0.len h0 in {W-min(P),E-max(P)} by A1,JORDAN6:def 9;
A941:         h0.len h0 <> W-min P
                     by A22,A23,A29,A31,A40,A42,A46,A47,A57,A67,A932,A936,A938,
FUNCT_1:def 8;
                   h0.len h0 <> E-max P
                    by A22,A28,A30,A67,A932,A937,A938,FUNCT_1:def 8;
              hence contradiction by A940,A941,TARSKI:def 2;
            end;
            suppose A942:i+1>len h1;
                  then A943:len h1 +1<=i+1 by NAT_1:13;
A944:        i+1 <= len h11 + len mid(h21,2,len h21 -'1) by A877,FINSEQ_1:35;
                  A945:h0.(i+1)=(mid(h21,2,len h21 -'1)).((i+1) -len h11)
                                     by A21,A40,A877,A943,FINSEQ_1:36;
                  A946:(i+1)-len h11=(i+1)-'len h11 by A21,A942,BINARITH:50;
                    A947: i+1-len h11
                   <=len h11 + len mid(h21,2,len h21 -'1)-len h11
                                         by A944,XREAL_1:11;
                      len h1 +1-len h1<=(i+1)-len h1 by A943,XREAL_1:11;
                  then A948:h0.(i+1)=h21.((i+1)-'len h11 +2-'1)
                             by A21,A43,A45,A945,A946,A947,JORDAN3:27;
                      0<=(i+1)-'len h11 by NAT_1:2;
                  then 0+2<=(i+1)-'len h11 +2 by XREAL_1:8;
                  then A949:2-'1<=((i+1)-'len h11 +2-'1) by BINARITH:60;
                      (i+1)-len h11<=len h1+(len h2-2)-len h11
                            by A21,A23,A40,A42,A46,A47,A877,XREAL_1:11;
                  then (i+1)-'len h11+2<=len h2-2+2 by A21,A946,XREAL_1:8;
then A950:            (i+1)-'len h11 +2-'1 <= len h21 by A23,BINARITH:62;
                  A951:(i+1)-'len h11+2-'1=(i+1)-'len h11+2-1
                                 by A949,Lm1,BINARITH:57;
                  set j0=(i+1)-'len h11+2-'1;
                      len h11+1-len h11<=(i+1)-len h11
                           by A21,A943,XREAL_1:11;
                  then A952:(i+1)-'len h11=(i+1)-len h11 by BINARITH:57;
                 A953:j0 in dom h2 by A22,A949,A950,Lm1,FINSEQ_3:27;
                      1<=i+1 by A876,NAT_1:13;
                  then i+1 in dom h0 by A877,FINSEQ_3:27;
                  then A954:h0/.(i+1)=h0.(i+1) by PARTFUN1:def 8;
 h0.len h0=(mid(h21,2,len h21 -'1)).(len h0 -len h11)
                     by A21,A40,A51,FINSEQ_1:36;
                  then A955:h0.len h0=h21.(len h0-'len h11 +2-'1)
                             by A23,A40,A42,A43,A44,A46,A47,A50,A57,JORDAN3:27;
                      0<=len h0-'len h11 by NAT_1:2;
                  then 0+2<=len h0-'len h11 +2 by XREAL_1:8;
                  then A956:2-'1<=(len h0-'len h11 +2-'1) by BINARITH:60;
A957:            len h0-'len h11 +2-'1 <= len h21 by A40,A42,A46,A47,A57,
BINARITH:62;
                  A958:len h0-'len h11+2-'1=len h0-'len h11+2-1
                      by A956,Lm1,BINARITH:57;
                  set k=len h0-'len h11+2-'1;
                      len h0-'len h11=len h0-len h11 by A23,A40,A42,A46,A47,A50
,BINARITH:57;
                  then i+1-'len h11<len h0-'len h11 by A877,A952,XREAL_1:11;
                  then i+1-'len h11+2<len h0-'len h11+2 by XREAL_1:8;
                  then A959: (i+1)-'len h11+2-'1<k by A951,A958,XREAL_1:11;
                    k in dom h2 by A22,A956,A957,Lm1,FINSEQ_3:27;
              hence contradiction by A22,A55,A67,A925,A948,A953,A954,A955,A959,
FUNCT_1:def 8;
            end;
          end;
   hence Segment(h0/.len h0,h0/.1,P) misses Segment(h0/.i,h0/.(i+1),P)
                   by A1,A39,A64,A879,A881,A883,A891,Th14;
  end;
