:: Introducing Spans
::  by Andrzej Trybulec
::
:: Received May 27, 2002
:: Copyright (c) 2002 Association of Mizar Users

environ

 vocabularies JORDAN13, JORDAN11, FINSEQ_1, TOPREAL1, GOBOARD1, BOOLE,
      JORDAN1H, FINSEQ_4, EUCLID, MATRIX_1, PRE_TOPC, SEQM_3, SPPOL_1,
      SPRECT_2, GOBOARD5, ABSVALUE, CONNSP_1, TOPREAL2, ARYTM_1, TOPS_1,
      RELAT_1, FUNCT_1, SUBSET_1, RELAT_2, RFINSEQ, GOBOARD9, TARSKI, TREES_1,
      CARD_1, JORDAN8, GOBRD13, FINSEQ_5, JORDAN2C, METRIC_1, PCOMPS_1,
      GROUP_1, ARYTM;
 notations TARSKI, GOBOARD5, XBOOLE_0, SUBSET_1, ORDINAL1, CARD_1, NUMBERS,
      XCMPLX_0, XXREAL_0, XREAL_0, REAL_1, NAT_1, NAT_D, RELAT_1, FUNCT_1,
      PARTFUN1, FUNCT_2, COMPLEX1, NEWTON, FINSEQ_1, FINSEQ_2, FINSEQ_4,
      STRUCT_0, RFINSEQ, MATRIX_1, METRIC_1, PRE_TOPC, TOPS_1, CONNSP_1,
      PCOMPS_1, EUCLID, TOPREAL1, TOPREAL2, GOBOARD1, SPPOL_1, SPRECT_2,
      GOBOARD9, JORDAN8, GOBRD13, JORDAN2C, JORDAN1H, JORDAN11;
 constructors PARTFUN1, XXREAL_0, REAL_1, NAT_1, FINSEQ_4, NEWTON, RFINSEQ,
      NAT_D, TOPS_1, CONNSP_1, REALSET2, TOPREAL4, PSCOMP_1, GOBOARD9,
      SPRECT_2, JORDAN2C, JORDAN8, JORDAN1H, JORDAN11;
 registrations XBOOLE_0, RELAT_1, FUNCT_1, ORDINAL1, XXREAL_0, XREAL_0, NAT_1,
      MEMBERED, FINSEQ_1, STRUCT_0, EUCLID, TOPREAL2, SPPOL_2, GOBOARD9,
      SPRECT_2, SPRECT_3, TOPREAL6, JORDAN8, GOBRD13, JORDAN1A, FINSET_1;
 requirements NUMERALS, SUBSET, BOOLE, REAL, ARITHM;
 definitions TARSKI, XBOOLE_0, GOBOARD1, GOBOARD5;
 theorems NAT_1, FINSEQ_1, GOBOARD1, FINSEQ_4, EUCLID, FINSEQ_3,
      SPPOL_2, JORDAN3, FINSEQ_5, FINSEQ_6, GOBOARD7, TOPREAL1, BINARITH,
      XBOOLE_0, XBOOLE_1, SPPOL_1, ABSVALUE, FUNCT_1, FUNCT_2,
      GOBOARD9, RELAT_1, FINSEQ_2, UNIFORM1, SUBSET_1, GOBRD11, GOBOARD2,
      SPRECT_3, CARD_1, RFINSEQ, GOBOARD6, TOPREAL3, TOPMETR, TOPS_1, JORDAN8,
      GOBRD13, SPRECT_4, CONNSP_1, GOBRD14, JORDAN9, JORDAN5B, JORDAN2C,
      PARTFUN2, RELSET_1, TBSP_1, JORDAN1H, JORDAN11, XREAL_0, ZFMISC_1,
      XREAL_1, XXREAL_0, PARTFUN1, ORDINAL1, MATRIX_1, NAT_D;
 schemes NAT_1, RECDEF_1;

begin :: Spans

reserve i, j, k, l, m, n, i1, i2, j1, j2 for Element of NAT;

definition
  let C be non vertical non horizontal non empty
  being_simple_closed_curve Subset of TOP-REAL 2, n be Element of NAT;
  assume
A1: n is_sufficiently_large_for C;
  func Span(C,n) -> clockwise_oriented
  (standard non constant special_circular_sequence) means
  it is_sequence_on Gauge(C,n) &
  it/.1 = Gauge(C,n)*(X-SpanStart(C,n),Y-SpanStart(C,n)) &
  it/.2 = Gauge(C,n)*(X-SpanStart(C,n)-'1,Y-SpanStart(C,n)) &
  for k being Element of NAT st 1 <= k & k+2 <= len it holds
  (front_right_cell(it,k,Gauge(C,n)) misses C &
  front_left_cell(it,k,Gauge(C,n)) misses C
  implies it turns_left k,Gauge(C,n)) &
  (front_right_cell(it,k,Gauge(C,n)) misses C &
  front_left_cell(it,k,Gauge(C,n)) meets C
  implies it goes_straight k,Gauge(C,n)) &
  (front_right_cell(it,k,Gauge(C,n)) meets C
  implies it turns_right k,Gauge(C,n));
  existence
  proof
    set G = Gauge(C,n);
A2: len G = 2|^n+3 & len G = width G by JORDAN8:def 1;
    defpred P[Element of NAT,set,set] means
    ($1 = 0 implies $3 = <*G*(X-SpanStart(C,n),Y-SpanStart(C,n))*>) &
    ($1 = 1 implies $3 = <*G*(X-SpanStart(C,n),Y-SpanStart(C,n)),
    G*(X-SpanStart(C,n)-'1,Y-SpanStart(C,n))*>) &
    ($1 > 1 & $2 is FinSequence of TOP-REAL 2 implies
    for f being FinSequence of TOP-REAL 2 st $2 = f holds (len f = $1 implies
    (f is_sequence_on G & left_cell(f,len f-'1,G) meets C implies
    (front_right_cell(f,(len f)-'1,G) misses C &
    front_left_cell(f,(len f)-'1,G) misses C implies ex i,j st
    f^<*G*(i,j)*> turns_left (len f)-'1,G & $3 = f^<*G*(i,j)*>) &
    (front_right_cell(f,(len f)-'1,G) misses C &
    front_left_cell(f,(len f)-'1,G) meets C implies ex i,j st
    f^<*G*(i,j)*> goes_straight (len f)-'1,G & $3 = f^<*G*(i,j)*>) &
    (front_right_cell(f,(len f)-'1,G) meets C implies ex i,j st
    f^<*G*(i,j)*> turns_right (len f)-'1,G & $3 = f^<*G*(i,j)*>)) &
    (not f is_sequence_on G or left_cell(f,len f-'1,G) misses C
    implies $3 = f^<*G*(1,1)*>)) & (len f <> $1 implies $3 = {})) &
    ($1 > 1 & $2 is not FinSequence of TOP-REAL 2 implies $3 = {});
A3: for k being Element of NAT, x being set ex y being set st P[k,x,y]
    proof
      let k be Element of NAT, x be set;
      per cases by NAT_1:26;
      suppose
A4:     k=0;
        take <*G*(X-SpanStart(C,n),Y-SpanStart(C,n))*>;
        thus thesis by A4;
      end;
      suppose
A5:     k = 1;
        take <*G*(X-SpanStart(C,n),Y-SpanStart(C,n)),
        G*(X-SpanStart(C,n)-'1,Y-SpanStart(C,n))*>;
        thus thesis by A5;
      end;
      suppose that
A6:     k > 1 and
A7:     x is FinSequence of TOP-REAL 2;
        reconsider f = x as FinSequence of TOP-REAL 2 by A7;
        thus thesis
        proof per cases;
          suppose
A8:         len f = k;
            thus thesis
            proof per cases;
              suppose
A9:             f is_sequence_on G & left_cell(f,len f-'1,G) meets C;
A10:            1 <= (len f)-'1 by A6,A8,NAT_D:49;
A11:            (len f) -'1 +1 = len f by A6,A8,XREAL_1:237;
                then consider i1,j1,i2,j2 being Element of NAT such that
A12:            [i1,j1] in Indices G & f/.((len f)-'1) = G*(i1,j1) and
A13:            [i2,j2] in Indices G & f/.((len f) -'1+1) = G*(i2,j2) and
A14:            i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
                i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A9,A10,JORDAN8:6;
A15:            1

<= i1 & i1 <= len G & 1 <= j1 & j1 <= width G by A12,MATRIX_1:39;
A16:            1

<= i2 & i2 <= len G & 1 <= j2 & j2 <= width G by A13,MATRIX_1:39;
A17:            1 <= i2+1 & 1 <= j2+1 by NAT_1:12;
A18:            i2-'1 <= len G & j2-'1 <= width G by A16,NAT_D:44;
                (len f)-'1 <= len f by NAT_D:35;
                then
A19:            (len f)-'1 in dom f & (len f)-'1+1 in dom f
                by A6,A8,A10,A11,FINSEQ_3:27;
A20:            (len f)-'1+(1+1) = (len f)+1 by A11;
                thus thesis
                proof per cases;
                  suppose
A21:                front_right_cell(f,(len f)-'1,G) misses C &
                    front_left_cell(f,(len f)-'1,G) misses C;
                    thus thesis
                    proof per cases by A14;
                      suppose
A22:                    i1 = i2 & j1+1 = j2;
                        take f1 = f^<*G*(i2-'1,j2)*>;
                        now
                          take i=i2-'1 ,j=j2;
                          now
                            let i1',j1',i2',j2' be Element of NAT;
                            assume that
A23:                        [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A24:                        f1/.((len f)-'1) = G*(i1',j1') &
                            f1/.((len f)-'1+1) = G*(i2',j2');
                            f/.((len f)-'1) = G*(i1',j1') &

f/.((len f)-'1+1) = G*(i2',j2') by A19,A24,FINSEQ_4:83;
                            then
A25:                        i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                            by A12,A13,A23,GOBOARD1:21;
                            now
                              assume i2-'1 < 1;
                              then i2 <= 1 by NAT_1:14,NAT_D:36;
                              then i2 = 1 by A16,XXREAL_0:1;
                              then cell(G,1-'1,j1) meets C
                              by A9,A10,A11,A12,A13,A22,GOBRD13:22;
                              then cell(G,0,j1) meets C by XREAL_1:234;
                              hence contradiction by A2,A15,JORDAN8:21;
                            end;

hence i1' = i2' & j1'+1 = j2' & [i2'-'1,j2'] in Indices G &
                            f1/.(len f -'1+2) = G*(i2'-'1,j2') or

i1'+1 = i2' & j1' = j2' & [i2',j2'+1] in Indices G &
                            f1/.(len f -'1+2) = G*(i2',j2'+1) or

i1' = i2'+1 & j1' = j2' & [i2',j2'-'1] in Indices G &
                            f1/.(len f -'1+2) = G*(i2',j2'-'1) or

i1' = i2' & j1' = j2'+1 & [i2'+1,j2'] in Indices G &
                            f1/.(len f -'1+2) = G*(i2'+1,j2')
                            by A16,A18,A20,A22,A25,FINSEQ_4:82,MATRIX_1:37;
                          end;
                          hence f1 turns_left (len f)-'1,G by GOBRD13:def 7;
                          thus f1 = f^<*G*(i,j)*>;
                        end;
                        hence thesis by A6,A8,A9,A21;
                      end;
                      suppose
A26:                    i1+1 = i2 & j1 = j2;
                        take f1 = f^<*G*(i2,j2+1)*>;
                        now
                          take i=i2,j=j2+1;
                          now
                            let i1',j1',i2',j2' be Element of NAT;
                            assume that
A27:                        [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A28:                        f1/.((len f)-'1) = G*(i1',j1') &
                            f1/.((len f)-'1+1) = G*(i2',j2');
                            f/.((len f)-'1) = G*(i1',j1') &

f/.((len f)-'1+1) = G*(i2',j2') by A19,A28,FINSEQ_4:83;
                            then
A29:                        i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                            by A12,A13,A27,GOBOARD1:21;
                            now
                              assume j2+1 > len G;
                              then j2+1 <= (len G)+1 & (len G)+1 <= j2+1
                              by A2,A16,NAT_1:13,XREAL_1:8;
                              then j2+1 = (len G)+1 by XXREAL_0:1;
                              then cell(G,i1,len G) meets C
                              by A9,A10,A11,A12,A13,A26,GOBRD13:24;
                              hence contradiction by A15,JORDAN8:18;
                            end;

hence i1' = i2' & j1'+1 = j2' & [i2'-'1,j2'] in Indices G &
                            f1/.(len f -'1+2) = G*(i2'-'1,j2') or

i1'+1 = i2' & j1' = j2' & [i2',j2'+1] in Indices G &
                            f1/.(len f -'1+2) = G*(i2',j2'+1) or

i1' = i2'+1 & j1' = j2' & [i2',j2'-'1] in Indices G &
                            f1/.(len f -'1+2) = G*(i2',j2'-'1) or

i1' = i2' & j1' = j2'+1 & [i2'+1,j2'] in Indices G &
                            f1/.(len f -'1+2) = G*(i2'+1,j2')
                            by A2,A16,A17,A20,A26,A29,FINSEQ_4:82,MATRIX_1:37;
                          end;
                          hence f1 turns_left (len f)-'1,G by GOBRD13:def 7;
                          thus f1 = f^<*G*(i,j)*>;
                        end;
                        hence thesis by A6,A8,A9,A21;
                      end;
                      suppose
A30:                    i1 = i2+1 & j1 = j2;
                        take f1 = f^<*G*(i2,j2-'1)*>;
                        now
                          take i=i2,j=j2-'1;
                          now
                            let i1',j1',i2',j2' be Element of NAT;
                            assume that
A31:                        [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A32:                        f1/.((len f)-'1) = G*(i1',j1') &
                            f1/.((len f)-'1+1) = G*(i2',j2');
                            f/.((len f)-'1) = G*(i1',j1') &

f/.((len f)-'1+1) = G*(i2',j2') by A19,A32,FINSEQ_4:83;
                            then
A33:                        i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                            by A12,A13,A31,GOBOARD1:21;
                            now
                              assume j2-'1 < 1;
                              then j2 <= 1 by NAT_1:14,NAT_D:36;
                              then j2 = 1 by A16,XXREAL_0:1;
                              then cell(G,i2,1-'1) meets C
                              by A9,A10,A11,A12,A13,A30,GOBRD13:26;
                              then cell(G,i2,0) meets C by XREAL_1:234;
                              hence contradiction by A16,JORDAN8:20;
                            end;

hence i1' = i2' & j1'+1 = j2' & [i2'-'1,j2'] in Indices G &
                            f1/.(len f -'1+2) = G*(i2'-'1,j2') or

i1'+1 = i2' & j1' = j2' & [i2',j2'+1] in Indices G &
                            f1/.(len f -'1+2) = G*(i2',j2'+1) or

i1' = i2'+1 & j1' = j2' & [i2',j2'-'1] in Indices G &
                            f1/.(len f -'1+2) = G*(i2',j2'-'1) or

i1' = i2' & j1' = j2'+1 & [i2'+1,j2'] in Indices G &
                            f1/.(len f -'1+2) = G*(i2'+1,j2')
                            by A16,A18,A20,A30,A33,FINSEQ_4:82,MATRIX_1:37;
                          end;
                          hence f1 turns_left (len f)-'1,G by GOBRD13:def 7;
                          thus f1 = f^<*G*(i,j)*>;
                        end;
                        hence thesis by A6,A8,A9,A21;
                      end;
                      suppose
A34:                    i1 = i2 & j1 = j2+1;
                        take f1 = f^<*G*(i2+1,j2)*>;
                        now
                          take i=i2+1 ,j=j2;
                          now
                            let i1',j1',i2',j2' be Element of NAT;
                            assume that
A35:                        [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A36:                        f1/.((len f)-'1) = G*(i1',j1') &
                            f1/.((len f)-'1+1) = G*(i2',j2');
                            f/.((len f)-'1) = G*(i1',j1') &

f/.((len f)-'1+1) = G*(i2',j2') by A19,A36,FINSEQ_4:83;
                            then
A37:                        i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                            by A12,A13,A35,GOBOARD1:21;
                            now
                              assume i2+1 > len G;
                              then i2+1 <= (len G)+1 & (len G)+1 <= i2+1
                              by A16,NAT_1:13,XREAL_1:8;
                              then i2+1 = (len G)+1 by XXREAL_0:1;
                              then cell(G,len G,j2) meets C
                              by A9,A10,A11,A12,A13,A34,GOBRD13:28;
                              hence contradiction by A2,A16,JORDAN8:19;
                            end;

hence i1' = i2' & j1'+1 = j2' & [i2'-'1,j2'] in Indices G &
                            f1/.(len f -'1+2) = G*(i2'-'1,j2') or

i1'+1 = i2' & j1' = j2' & [i2',j2'+1] in Indices G &
                            f1/.(len f -'1+2) = G*(i2',j2'+1) or

i1' = i2'+1 & j1' = j2' & [i2',j2'-'1] in Indices G &
                            f1/.(len f -'1+2) = G*(i2',j2'-'1) or

i1' = i2' & j1' = j2'+1 & [i2'+1,j2'] in Indices G &
                            f1/.(len f -'1+2) = G*(i2'+1,j2')
                            by A16,A17,A20,A34,A37,FINSEQ_4:82,MATRIX_1:37;
                          end;
                          hence f1 turns_left (len f)-'1,G by GOBRD13:def 7;
                          thus f1 = f^<*G*(i,j)*>;
                        end;
                        hence thesis by A6,A8,A9,A21;
                      end;
                    end;
                  end;
                  suppose
A38:                front_right_cell(f,(len f)-'1,G) misses C &
                    front_left_cell(f,(len f)-'1,G) meets C;
                    thus thesis
                    proof per cases by A14;
                      suppose
A39:                    i1 = i2 & j1+1 = j2;
                        take f1 = f^<*G*(i2,j2+1)*>;
                        now
                          take i=i2,j=j2+1;
                          now
                            let i1',j1',i2',j2' be Element of NAT;
                            assume that
A40:                        [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A41:                        f1/.((len f)-'1) = G*(i1',j1') &
                            f1/.((len f)-'1+1) = G*(i2',j2');
                            f/.((len f)-'1) = G*(i1',j1') &

f/.((len f)-'1+1) = G*(i2',j2') by A19,A41,FINSEQ_4:83;
                            then
A42:                        i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                            by A12,A13,A40,GOBOARD1:21;
                            now
                              assume j2+1 > len G;
                              then j2+1 <= (len G)+1 & (len G)+1 <= j2+1
                              by A2,A16,NAT_1:13,XREAL_1:8;
                              then j2+1 = (len G)+1 by XXREAL_0:1;
                              then cell(G,i1-'1,len G) meets C
                              by A9,A10,A11,A12,A13,A38,A39,GOBRD13:35;

hence contradiction by A15,JORDAN8:18,NAT_D:44;
                            end;

hence i1' = i2' & j1'+1 = j2' & [i2',j2'+1] in Indices G &
                            f1/.(len f -'1+2) = G*(i2',j2'+1) or

i1'+1 = i2' & j1' = j2' & [i2'+1,j2'] in Indices G &
                            f1/.(len f -'1+2) = G*(i2'+1,j2') or

i1' = i2'+1 & j1' = j2' & [i2'-'1,j2'] in Indices G &
                            f1/.(len f -'1+2) = G*(i2'-'1,j2') or

i1' = i2' & j1' = j2'+1 & [i2',j2'-'1] in Indices G &
                            f1/.(len f -'1+2) = G*(i2',j2'-'1)
                            by A2,A16,A17,A20,A39,A42,FINSEQ_4:82,MATRIX_1:37;
                          end;
                          hence f1 goes_straight (len f)-'1,G by GOBRD13:def 8;
                          thus f1 = f^<*G*(i,j)*>;
                        end;
                        hence thesis by A6,A8,A9,A38;
                      end;
                      suppose
A43:                    i1+1 = i2 & j1 = j2;
                        take f1 = f^<*G*(i2+1,j2)*>;
                        now
                          take i=i2+1 ,j=j2;
                          now
                            let i1',j1',i2',j2' be Element of NAT;
                            assume that
A44:                        [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A45:                        f1/.((len f)-'1) = G*(i1',j1') &
                            f1/.((len f)-'1+1) = G*(i2',j2');
                            f/.((len f)-'1) = G*(i1',j1') &

f/.((len f)-'1+1) = G*(i2',j2') by A19,A45,FINSEQ_4:83;
                            then
A46:                        i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                            by A12,A13,A44,GOBOARD1:21;
                            now
                              assume i2+1 > len G;
                              then i2+1 <= (len G)+1 & (len G)+1 <= i2+1
                              by A16,NAT_1:13,XREAL_1:8;
                              then i2+1 = (len G)+1 by XXREAL_0:1;
                              then cell(G,len G,j1) meets C
                              by A9,A10,A11,A12,A13,A38,A43,GOBRD13:37;
                              hence contradiction by A2,A15,JORDAN8:19;
                            end;

hence i1' = i2' & j1'+1 = j2' & [i2',j2'+1] in Indices G &
                            f1/.(len f -'1+2) = G*(i2',j2'+1) or

i1'+1 = i2' & j1' = j2' & [i2'+1,j2'] in Indices G &
                            f1/.(len f -'1+2) = G*(i2'+1,j2') or

i1' = i2'+1 & j1' = j2' & [i2'-'1,j2'] in Indices G &
                            f1/.(len f -'1+2) = G*(i2'-'1,j2') or

i1' = i2' & j1' = j2'+1 & [i2',j2'-'1] in Indices G &
                            f1/.(len f -'1+2) = G*(i2',j2'-'1)
                            by A16,A17,A20,A43,A46,FINSEQ_4:82,MATRIX_1:37;
                          end;
                          hence f1 goes_straight (len f)-'1,G by GOBRD13:def 8;
                          thus f1 = f^<*G*(i,j)*>;
                        end;
                        hence thesis by A6,A8,A9,A38;
                      end;
                      suppose
A47:                    i1 = i2+1 & j1 = j2;
                        take f1 = f^<*G*(i2-'1,j2)*>;
                        now
                          take i=i2-'1 ,j=j2;
                          now
                            let i1',j1',i2',j2' be Element of NAT;
                            assume that
A48:                        [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A49:                        f1/.((len f)-'1) = G*(i1',j1') &
                            f1/.((len f)-'1+1) = G*(i2',j2');
                            f/.((len f)-'1) = G*(i1',j1') &

f/.((len f)-'1+1) = G*(i2',j2') by A19,A49,FINSEQ_4:83;
                            then
A50:                        i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                            by A12,A13,A48,GOBOARD1:21;
                            now
                              assume i2-'1 < 1;
                              then i2 <= 1 by NAT_1:14,NAT_D:36;
                              then i2 = 1 by A16,XXREAL_0:1;
                              then cell(G,1-'1,j1-'1) meets C
                              by A9,A10,A11,A12,A13,A38,A47,GOBRD13:39;
                              then cell(G,0,j1-'1) meets C by XREAL_1:234;

hence contradiction by A2,A15,JORDAN8:21,NAT_D:44;
                            end;

hence i1' = i2' & j1'+1 = j2' & [i2',j2'+1] in Indices G &
                            f1/.(len f -'1+2) = G*(i2',j2'+1) or

i1'+1 = i2' & j1' = j2' & [i2'+1,j2'] in Indices G &
                            f1/.(len f -'1+2) = G*(i2'+1,j2') or

i1' = i2'+1 & j1' = j2' & [i2'-'1,j2'] in Indices G &
                            f1/.(len f -'1+2) = G*(i2'-'1,j2') or

i1' = i2' & j1' = j2'+1 & [i2',j2'-'1] in Indices G &
                            f1/.(len f -'1+2) = G*(i2',j2'-'1)
                            by A16,A18,A20,A47,A50,FINSEQ_4:82,MATRIX_1:37;
                          end;
                          hence f1 goes_straight (len f)-'1,G by GOBRD13:def 8;
                          thus f1 = f^<*G*(i,j)*>;
                        end;
                        hence thesis by A6,A8,A9,A38;
                      end;
                      suppose
A51:                    i1 = i2 & j1 = j2+1;
                        take f1 = f^<*G*(i2,j2-'1)*>;
                        now
                          take i=i2,j=j2-'1;
                          now
                            let i1',j1',i2',j2' be Element of NAT;
                            assume that
A52:                        [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A53:                        f1/.((len f)-'1) = G*(i1',j1') &
                            f1/.((len f)-'1+1) = G*(i2',j2');
                            f/.((len f)-'1) = G*(i1',j1') &

f/.((len f)-'1+1) = G*(i2',j2') by A19,A53,FINSEQ_4:83;
                            then
A54:                        i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                            by A12,A13,A52,GOBOARD1:21;
                            now
                              assume j2-'1 < 1;
                              then j2 <= 1 by NAT_1:14,NAT_D:36;
                              then j2 = 1 by A16,XXREAL_0:1;
                              then cell(G,i1,1-'1) meets C
                              by A9,A10,A11,A12,A13,A38,A51,GOBRD13:41;
                              then cell(G,i1,0) meets C by XREAL_1:234;
                              hence contradiction by A15,JORDAN8:20;
                            end;

hence i1' = i2' & j1'+1 = j2' & [i2',j2'+1] in Indices G &
                            f1/.(len f -'1+2) = G*(i2',j2'+1) or

i1'+1 = i2' & j1' = j2' & [i2'+1,j2'] in Indices G &
                            f1/.(len f -'1+2) = G*(i2'+1,j2') or

i1' = i2'+1 & j1' = j2' & [i2'-'1,j2'] in Indices G &
                            f1/.(len f -'1+2) = G*(i2'-'1,j2') or

i1' = i2' & j1' = j2'+1 & [i2',j2'-'1] in Indices G &
                            f1/.(len f -'1+2) = G*(i2',j2'-'1)
                            by A16,A18,A20,A51,A54,FINSEQ_4:82,MATRIX_1:37;
                          end;
                          hence f1 goes_straight (len f)-'1,G by GOBRD13:def 8;
                          thus f1 = f^<*G*(i,j)*>;
                        end;
                        hence thesis by A6,A8,A9,A38;
                      end;
                    end;
                  end;
                  suppose
A55:                front_right_cell(f,(len f)-'1,G) meets C;
                    thus thesis
                    proof per cases by A14;
                      suppose
A56:                    i1 = i2 & j1+1 = j2;
                        take f1 = f^<*G*(i2+1,j2)*>;
                        now
                          take i=i2+1 ,j=j2;
                          now
                            let i1',j1',i2',j2' be Element of NAT;
                            assume that
A57:                        [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A58:                        f1/.((len f)-'1) = G*(i1',j1') &
                            f1/.((len f)-'1+1) = G*(i2',j2');
                            f/.((len f)-'1) = G*(i1',j1') &

f/.((len f)-'1+1) = G*(i2',j2') by A19,A58,FINSEQ_4:83;
                            then
A59:                        i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                            by A12,A13,A57,GOBOARD1:21;
                            now
                              assume i2+1 > len G;
                              then i2+1 <= (len G)+1 & (len G)+1 <= i2+1
                              by A16,NAT_1:13,XREAL_1:8;
                              then i2+1 = (len G)+1 by XXREAL_0:1;
                              then cell(G,len G,j2) meets C
                              by A9,A10,A11,A12,A13,A55,A56,GOBRD13:36;
                              hence contradiction by A2,A16,JORDAN8:19;
                            end;

hence i1' = i2' & j1'+1 = j2' & [i2'+1,j2'] in Indices G &
                            f1/.(len f -'1+2) = G*(i2'+1,j2') or

i1'+1 = i2' & j1' = j2' & [i2',j2'-'1] in Indices G &
                            f1/.(len f -'1+2) = G*(i2',j2'-'1) or

i1' = i2'+1 & j1' = j2' & [i2',j2'+1] in Indices G &
                            f1/.(len f -'1+2) = G*(i2',j2'+1) or

i1' = i2' & j1' = j2'+1 & [i2'-'1,j2'] in Indices G &
                            f1/.(len f -'1+2) = G*(i2'-'1,j2')
                            by A16,A17,A20,A56,A59,FINSEQ_4:82,MATRIX_1:37;
                          end;
                          hence f1 turns_right (len f)-'1,G by GOBRD13:def 6;
                          thus f1 = f^<*G*(i,j)*>;
                        end;
                        hence thesis by A6,A8,A9,A55;
                      end;
                      suppose
A60:                    i1+1 = i2 & j1 = j2;
                        take f1 = f^<*G*(i2,j2-'1)*>;
                        now
                          take i=i2,j=j2-'1;
                          now
                            let i1',j1',i2',j2' be Element of NAT;
                            assume that
A61:                        [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A62:                        f1/.((len f)-'1) = G*(i1',j1') &
                            f1/.((len f)-'1+1) = G*(i2',j2');
                            f/.((len f)-'1) = G*(i1',j1') &

f/.((len f)-'1+1) = G*(i2',j2') by A19,A62,FINSEQ_4:83;
                            then
A63:                        i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                            by A12,A13,A61,GOBOARD1:21;
                            now
                              assume j2-'1 < 1;
                              then j2 <= 1 by NAT_1:14,NAT_D:36;
                              then j2 = 1 by A16,XXREAL_0:1;
                              then cell(G,i2,1-'1) meets C
                              by A9,A10,A11,A12,A13,A55,A60,GOBRD13:38;
                              then cell(G,i2,0) meets C by XREAL_1:234;
                              hence contradiction by A16,JORDAN8:20;
                            end;

hence i1' = i2' & j1'+1 = j2' & [i2'+1,j2'] in Indices G &
                            f1/.(len f -'1+2) = G*(i2'+1,j2') or

i1'+1 = i2' & j1' = j2' & [i2',j2'-'1] in Indices G &
                            f1/.(len f -'1+2) = G*(i2',j2'-'1) or

i1' = i2'+1 & j1' = j2' & [i2',j2'+1] in Indices G &
                            f1/.(len f -'1+2) = G*(i2',j2'+1) or

i1' = i2' & j1' = j2'+1 & [i2'-'1,j2'] in Indices G &
                            f1/.(len f -'1+2) = G*(i2'-'1,j2')
                            by A16,A18,A20,A60,A63,FINSEQ_4:82,MATRIX_1:37;
                          end;
                          hence f1 turns_right (len f)-'1,G by GOBRD13:def 6;
                          thus f1 = f^<*G*(i,j)*>;
                        end;
                        hence thesis by A6,A8,A9,A55;
                      end;
                      suppose
A64:                    i1 = i2+1 & j1 = j2;
                        take f1 = f^<*G*(i2,j2+1)*>;
                        now
                          take i=i2,j=j2+1;
                          now
                            let i1',j1',i2',j2' be Element of NAT;
                            assume that
A65:                        [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A66:                        f1/.((len f)-'1) = G*(i1',j1') &
                            f1/.((len f)-'1+1) = G*(i2',j2');
                            f/.((len f)-'1) = G*(i1',j1') &

f/.((len f)-'1+1) = G*(i2',j2') by A19,A66,FINSEQ_4:83;
                            then
A67:                        i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                            by A12,A13,A65,GOBOARD1:21;
                            now
                              assume j2+1 > len G;
                              then j2+1 <= (len G)+1 & (len G)+1 <= j2+1
                              by A2,A16,NAT_1:13,XREAL_1:8;
                              then j2+1 = (len G)+1 by XXREAL_0:1;
                              then cell(G,i2-'1,len G) meets C
                              by A9,A10,A11,A12,A13,A55,A64,GOBRD13:40;

hence contradiction by A16,JORDAN8:18,NAT_D:44;
                            end;

hence i1' = i2' & j1'+1 = j2' & [i2'+1,j2'] in Indices G &
                            f1/.(len f -'1+2) = G*(i2'+1,j2') or

i1'+1 = i2' & j1' = j2' & [i2',j2'-'1] in Indices G &
                            f1/.(len f -'1+2) = G*(i2',j2'-'1) or

i1' = i2'+1 & j1' = j2' & [i2',j2'+1] in Indices G &
                            f1/.(len f -'1+2) = G*(i2',j2'+1) or

i1' = i2' & j1' = j2'+1 & [i2'-'1,j2'] in Indices G &
                            f1/.(len f -'1+2) = G*(i2'-'1,j2')
                            by A2,A16,A17,A20,A64,A67,FINSEQ_4:82,MATRIX_1:37;
                          end;
                          hence f1 turns_right (len f)-'1,G by GOBRD13:def 6;
                          thus f1 = f^<*G*(i,j)*>;
                        end;
                        hence thesis by A6,A8,A9,A55;
                      end;
                      suppose
A68:                    i1 = i2 & j1 = j2+1;
                        take f1 = f^<*G*(i2-'1,j2)*>;
                        now
                          take i=i2-'1 ,j=j2;
                          now
                            let i1',j1',i2',j2' be Element of NAT;
                            assume that
A69:                        [i1',j1'] in Indices G & [i2',j2'] in Indices G and
A70:                        f1/.((len f)-'1) = G*(i1',j1') &
                            f1/.((len f)-'1+1) = G*(i2',j2');
                            f/.((len f)-'1) = G*(i1',j1') &

f/.((len f)-'1+1) = G*(i2',j2') by A19,A70,FINSEQ_4:83;
                            then
A71:                        i1 = i1' & j1 = j1' & i2 = i2' & j2 = j2'
                            by A12,A13,A69,GOBOARD1:21;
                            now
                              assume i2-'1 < 1;
                              then i2 <= 1 by NAT_1:14,NAT_D:36;
                              then i2 = 1 by A16,XXREAL_0:1;
                              then cell(G,1-'1,j2-'1) meets C
                              by A9,A10,A11,A12,A13,A55,A68,GOBRD13:42;
                              then cell(G,0,j2-'1) meets C by XREAL_1:234;

hence contradiction by A2,A16,JORDAN8:21,NAT_D:44;
                            end;

hence i1' = i2' & j1'+1 = j2' & [i2'+1,j2'] in Indices G &
                            f1/.(len f -'1+2) = G*(i2'+1,j2') or

i1'+1 = i2' & j1' = j2' & [i2',j2'-'1] in Indices G &
                            f1/.(len f -'1+2) = G*(i2',j2'-'1) or

i1' = i2'+1 & j1' = j2' & [i2',j2'+1] in Indices G &
                            f1/.(len f -'1+2) = G*(i2',j2'+1) or

i1' = i2' & j1' = j2'+1 & [i2'-'1,j2'] in Indices G &
                            f1/.(len f -'1+2) = G*(i2'-'1,j2')
                            by A16,A18,A20,A68,A71,FINSEQ_4:82,MATRIX_1:37;
                          end;
                          hence f1 turns_right (len f)-'1,G by GOBRD13:def 6;
                          thus f1 = f^<*G*(i,j)*>;
                        end;
                        hence thesis by A6,A8,A9,A55;
                      end;
                    end;
                  end;
                end;
              end;
              suppose
A72:            not f is_sequence_on G or left_cell(f,len f-'1,G) misses C;
                take f^<*G*(1,1)*>;
                thus thesis by A6,A8,A72;
              end;
            end;
          end;
          suppose
A73:        len f <> k;
            take {};
            thus thesis by A6,A73;
          end;
        end;
      end;
      suppose
A74:    k > 1 & x is not FinSequence of TOP-REAL 2;
        take {};
        thus thesis by A74;
      end;
    end;
    consider F being Function such that
A75: dom F = NAT and
A76: F.0 = {} and
A77: for k being Element of NAT holds P[k,F.k,F.(k+1)] from RECDEF_1:sch 1
    (A3);
    defpred P[Element of NAT] means F.$1 is FinSequence of TOP-REAL 2;
A78: {} = <*>(the carrier of TOP-REAL 2);
    then
A79: P[0] by A76;
A80: for k st P[k] holds P[k+1]
    proof
      let k such that
A81:  F.k is FinSequence of TOP-REAL 2;
      per cases by NAT_1:26;
      suppose k = 0;
        hence F.(k+1) is FinSequence of TOP-REAL 2 by A77;
      end;
      suppose k = 1;
        hence F.(k+1) is FinSequence of TOP-REAL 2 by A77;
      end;
      suppose
A82:    k > 1;
        thus thesis
        proof
          reconsider f = F.k as FinSequence of TOP-REAL 2 by A81;
          per cases;
          suppose
A83:        len f = k;
            thus thesis
            proof per cases;
              suppose f is_sequence_on G & left_cell(f,len f-'1,G) meets C;
                then (front_right_cell(f,(len f)-'1,G) misses C &
                front_left_cell(f,(len f)-'1,G) misses C implies ex i,j st
                f^<*G*(i,j)*> turns_left (len f)-'1,G &
                F.(k+1) = f^<*G*(i,j)*>) &
                (front_right_cell(f,(len f)-'1,G) misses C &
                front_left_cell(f,(len f)-'1,G) meets C implies ex i,j st
                f^<*G*(i,j)*> goes_straight (len f)-'1,G &
                F.(k+1) = f^<*G*(i,j)*>) &
                (front_right_cell(f,(len f)-'1,G) meets C implies ex i,j st
                f^<*G*(i,j)*> turns_right (len f)-'1,G &
                F.(k+1) = f^<*G*(i,j)*>) by A77,A82,A83;
                hence F.(k+1) is FinSequence of TOP-REAL 2;
              end;
              suppose
A84:            not f is_sequence_on G or left_cell(f,len f-'1,G) misses C;
                f^<*G*(1,1)*> is FinSequence of TOP-REAL 2;
                hence F.(k+1) is FinSequence of TOP-REAL 2 by A77,A82,A83,A84;
              end;
            end;
          end;
          suppose len f <> k;
            hence F.(k+1) is FinSequence of TOP-REAL 2 by A77,A78,A82;
          end;
        end;
      end;
    end;
A85: for k holds P[k] from NAT_1:sch 1(A79,A80);
    rng F c= (the carrier of TOP-REAL 2)*
    proof
      let y be set;
      assume y in rng F;
      then ex x being set st x in dom F & F.x = y by FUNCT_1:def 5;
      then y is FinSequence of TOP-REAL 2 by A75,A85;
      hence thesis by FINSEQ_1:def 11;
    end;
    then reconsider F as Function of NAT,(the carrier of TOP-REAL 2)*
    by A75,FUNCT_2:def 1,RELSET_1:11;
    defpred P[Element of NAT] means len(F.$1) = $1;
A86: P[0] by A76,CARD_1:47;
A87: for k st P[k] holds P[k+1]
    proof
      let k such that
A88:  len(F.k) = k;
A89:  P[k,F.k,F.(k+1)] by A77;
      per cases by NAT_1:26;
      suppose k = 0;
        hence thesis by A89,FINSEQ_1:56;
      end;
      suppose k = 1;
        hence thesis by A89,FINSEQ_1:61;
      end;
      suppose
A90:    k > 1;
        thus thesis
        proof per cases;
          suppose F.k is_sequence_on G & left_cell(F.k,len(F.k)-'1,G) meets C;
            then (front_right_cell(F.k,(len(F.k))-'1,G) misses C &
            front_left_cell(F.k,(len(F.k))-'1,G) misses C implies ex i,j st
            (F.k)^<*G*(i,j)*> turns_left (len(F.k))-'1,G &
            F.(k+1) = (F.k)^<*G*(i,j)*>) &
            (front_right_cell(F.k,(len(F.k))-'1,G) misses C &
            front_left_cell(F.k,(len(F.k))-'1,G) meets C implies ex i,j st
            (F.k)^<*G*(i,j)*> goes_straight (len(F.k))-'1,G &
            F.(k+1) = (F.k)^<*G*(i,j)*>) &
            (front_right_cell(F.k,(len(F.k))-'1,G) meets C implies ex i,j st
            (F.k)^<*G*(i,j)*> turns_right (len(F.k))-'1,G &
            F.(k+1) = (F.k)^<*G*(i,j)*>) by A77,A88,A90;
            hence thesis by A88,FINSEQ_2:19;
          end;
          suppose
            not F.k is_sequence_on G or left_cell(F.k,len(F.k)-'1,G) misses C;
            then F.(k+1) = (F.k)^<*G*(1,1)*> by A77,A88,A90;
            hence thesis by A88,FINSEQ_2:19;
          end;
        end;
      end;
    end;
A91: for k holds P[k] from NAT_1:sch 1(A86,A87);
    set XS = X-SpanStart(C,n), YS = Y-SpanStart(C,n);
A92: 2 < XS by JORDAN1H:58;
    then
A93: 1 <= XS by XXREAL_0:2;
    defpred Q[Element of NAT] means F.$1 is_sequence_on G &
    for m st 1 <= m & m+1 <= len(F.$1)
    holds right_cell(F.$1,m,G) misses C & left_cell(F.$1,m,G) meets C;
A94: Q[0]
    proof
      (for n st n in dom(F.0)
      ex i,j st [i,j] in Indices G & (F.0)/.n = G*(i,j)) &
      (for n st n in dom(F.0) & n+1 in dom(F.0) holds
      for m,k,i,j st [m,k] in Indices G & [i,j] in Indices G &
      (F.0)/.n = G*(m,k) & (F.0)/.(n+1) = G*(i,j) holds
      abs(m-i)+abs(k-j) = 1) by A76;
      hence F.0 is_sequence_on G by GOBOARD1:def 11;
      let m;
      assume 1 <= m & m+1 <= len(F.0);
      hence right_cell(F.0,m,G) misses C & left_cell(F.0,m,G) meets C by A76,
CARD_1:47;
    end;
A95: [X-SpanStart(C,n),Y-SpanStart(C,n)] in Indices G by A1,JORDAN11:8;
    1+1 <= XS by JORDAN1H:58;
    then
A96: 1 <= XS-'1 & XS <= len G by JORDAN1H:58,NAT_D:55;
A97: for k st Q[k] holds Q[k+1]
    proof
      let k such that
A98:  F.k is_sequence_on G and
A99:  for m st 1 <= m & m+1 <= len(F.k)
      holds right_cell(F.k,m,G) misses C & left_cell(F.k,m,G) meets C;
A100: len(F.k) = k by A91;
A101: len(F.(k+1)) = k+1 by A91;
      per cases by NAT_1:26;
      suppose
A102:   k = 0;
        then
A103:   F.(k+1) = <*G*(X-SpanStart(C,n),Y-SpanStart(C,n))*> by A77;
A104:   now
          let l;
          assume l in dom(F.(k+1));
          then 1 <= l & l <= 1 by A101,A102,FINSEQ_3:27;
          then l = 1 by XXREAL_0:1;

hence ex i,j st [i,j] in Indices G & (F.(k+1))/.l = G*(i,j) by A95,A103,
FINSEQ_4:25;
        end;
        now
          let l;
          assume l in dom(F.(k+1)) & l+1 in dom(F.(k+1));
          then 1 <= l & l <= 1 & 1 <= l+1 & l+1 <= 1 by A101,A102,FINSEQ_3:27;
          then l = 1 & 1 = l+1 by XXREAL_0:1;

hence for i1,j1,i2,j2 st [i1,j1] in Indices G & [i2,j2] in Indices G &
          (F.(k+1))/.l = G*(i1,j1) & (F.(k+1))/.(l+1) = G*(i2,j2)
          holds abs(i1-i2)+abs(j1-j2) = 1;
        end;
        hence F.(k+1) is_sequence_on G by A104,GOBOARD1:def 11;
        let m;
        assume
A105:   1 <= m & m+1 <= len(F.(k+1));
        1 <= m+1 by NAT_1:12;
        then m+1 = 0+1 by A101,A102,A105,XXREAL_0:1;
        hence right_cell(F.(k+1),m,G) misses C &
        left_cell(F.(k+1),m,G) meets C by A105;
      end;
      suppose
A106:   k = 1;
        then F.(k+1) = <*G*(X-SpanStart(C,n),Y-SpanStart(C,n)),
        G*(X-SpanStart(C,n)-'1,Y-SpanStart(C,n))*> by A77;
        then
A107:   (F.(k+1))/.1 = G*(X-SpanStart(C,n),Y-SpanStart(C,n)) &
        (F.(k+1))/.2 = G*(X-SpanStart(C,n)-'1,Y-SpanStart(C,n))
        by FINSEQ_4:26;
A108:   [X-SpanStart(C,n),Y-SpanStart(C,n)] in Indices G &
        [X-SpanStart(C,n)-'1,Y-SpanStart(C,n)] in Indices G
        by A1,JORDAN11:8,9;
A109:   now
          let l;
          assume
A110:     l in dom(F.(k+1));
          then 1 <= l & l <= 2 by A101,A106,FINSEQ_3:27;
          then l = 0 or l = 1 or l = 2 by NAT_1:27;
          hence ex i,j st [i,j] in Indices G & (F.(k+1))/.l = G*(i,j)
          by A107,A108,A110,FINSEQ_3:27;
        end;
        now
          let l;
          assume
A111:     l in dom(F.(k+1)) & l+1 in dom(F.(k+1));
          then 1 <= l & l <= 2 & 1 <= l+1 & l+1 <= 2 by A101,A106,FINSEQ_3:27;
          then
A112:     l = 0 or l = 1 or l = 2 by NAT_1:27;
          let i1,j1,i2,j2 be Element of NAT such that
A113:     [i1,j1] in Indices G & [i2,j2]in Indices G &
          (F.(k+1))/.l = G*(i1,j1) & (F.(k+1))/.(l+1) = G*(i2,j2);
A114:     i1 = XS & j1 = YS & i2 = XS-'1 & j2 = YS
          by A101,A106,A107,A108,A111,A112,A113,FINSEQ_3:27,GOBOARD1:21;
          then i2+1 = i1 by A96,NAT_D:43;
          then abs(i1-i2) = 1 & abs(j1-j2) = 0 by A114,ABSVALUE:def 1;
          hence abs(i1-i2)+abs(j1-j2) = 1;
        end;
        hence
A115:   F.(k+1) is_sequence_on G by A109,GOBOARD1:def 11;
        let m;
        assume
A116:   1 <= m & m+1 <= len(F.(k+1));
        then 1+1 <= m+1 by XREAL_1:8;
        then
A117:   m+1 = 1+1 by A101,A106,A116,XXREAL_0:1;
A118:   XS-'1 < XS & XS-'1 < XS-'1+1 by A93,JORDAN5B:1,NAT_1:13;
A119:   XS <= XS+1 by NAT_1:11;
        then
A120:   right_cell(F.(k+1),m,G) = cell(G,XS-'1,YS)
        by A107,A108,A115,A116,A117,A118,GOBRD13:def 2;
A121:   left_cell(F.(k+1),m,G) = cell(G,XS-'1,YS-'1)
        by A107,A108,A115,A116,A117,A118,A119,GOBRD13:def 3;
        thus right_cell(F.(k+1),m,G) misses C by A1,A120,JORDAN11:11;
        thus left_cell(F.(k+1),m,G) meets C by A1,A121,JORDAN11:10;
      end;
      suppose
A122:   k > 1;
        then
A123:   F.k is non empty by A100,CARD_1:47;
A124:   1 <= (len(F.k))-'1 by A100,A122,NAT_D:49;
A125:   (len(F.k)) -'1 +1 = len(F.k) by A100,A122,XREAL_1:237;
        then consider i1,j1,i2,j2 being Element of NAT such that
A126:   [i1,j1] in Indices G & (F.k)/.(len(F.k)-'1) = G*(i1,j1) and
A127:   [i2,j2] in Indices G & (F.k)/.len(F.k) = G*(i2,j2) and
        i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
        i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A98,A124,JORDAN8:6;
A128:   1 <= i2 & i2 <= len G & 1 <= j2 & j2 <= width G by A127,MATRIX_1:39;
        (len(F.k))-'1 <= len(F.k) by NAT_D:35;
        then
A129:   (len(F.k))-'1 in dom(F.k) & len(F.k) in dom(F.k)
        by A100,A122,A124,FINSEQ_3:27;
A130:   (len(F.k))-'1+(1+1) = (len(F.k))+1 by A125;
A131:   right_cell(F.k,(len(F.k))-'1,G) misses C &
        left_cell(F.k,(len(F.k))-'1,G) meets C by A99,A124,A125;
        then
A132:   i1 = i2 & j1+1 = j2 implies [i1-'1,j1+1] in Indices G
        by A98,A100,A122,A126,A127,JORDAN1H:61;
A133:   i1+1 = i2 & j1 = j2 implies [i1+1,j1+1] in Indices G
        by A98,A100,A122,A126,A127,A131,JORDAN1H:62;
A134:   i1 = i2+1 & j1 = j2 implies [i2,j1-'1] in Indices G
        by A98,A100,A122,A126,A127,A131,JORDAN1H:63;
A135:   i1 = i2 & j1 = j2+1 implies [i1+1,j2] in Indices G
        by A98,A100,A122,A126,A127,A131,JORDAN1H:64;
        j1+1+1 = j1+2;
        then
A136:   front_left_cell(F.k,(len(F.k))-'1,G) meets C &
        i1 = i2 & j1+1 = j2 implies [i1,j2+1] in Indices G
        by A98,A100,A122,A126,A127,JORDAN1H:65;
        i1+1+1 = i1+2;
        then
A137:   front_left_cell(F.k,(len(F.k))-'1,G) meets C &
        i1+1 = i2 & j1 = j2 implies [i2+1,j2] in Indices G
        by A98,A100,A122,A126,A127,JORDAN1H:66;
A138:   front_left_cell(F.k,(len(F.k))-'1,G) meets C &
        i1 = i2+1 & j1 = j2 implies [i2-'1,j2] in Indices G
        by A98,A100,A122,A126,A127,JORDAN1H:67;
A139:   front_left_cell(F.k,(len(F.k))-'1,G) meets C &
        i1 = i2 & j1 = j2+1 implies [i2,j2-'1] in Indices G
        by A98,A100,A122,A126,A127,JORDAN1H:68;
A140:   front_right_cell(F.k,(len(F.k))-'1,G) meets C &
        i1 = i2 & j1+1 = j2 implies [i2+1,j2] in Indices G
        by A98,A100,A122,A126,A127,JORDAN1H:69;
A141:   front_right_cell(F.k,(len(F.k))-'1,G) meets C &
        i1+1 = i2 & j1 = j2 implies [i2,j2-'1] in Indices G
        by A98,A100,A122,A126,A127,JORDAN1H:70;
A142:   front_right_cell(F.k,(len(F.k))-'1,G) meets C &
        i1 = i2+1 & j1 = j2 implies [i2,j2+1] in Indices G
        by A98,A100,A122,A126,A127,JORDAN1H:71;
A143:   front_right_cell(F.k,(len(F.k))-'1,G) meets C &
        i1 = i2 & j1 = j2+1 implies [i2-'1,j2] in Indices G
        by A98,A100,A122,A126,A127,JORDAN1H:72; thus
A144:   F.(k+1) is_sequence_on G
        proof per cases;
          suppose front_right_cell(F.k,(len(F.k))-'1,G) misses C &
            front_left_cell(F.k,(len(F.k))-'1,G) misses C;
            then consider i,j such that
A145:       (F.k)^<*G*(i,j)*> turns_left (len(F.k))-'1,G and
A146:       F.(k+1) = (F.k)^<*G*(i,j)*> by A77,A98,A100,A122,A131;
            set f = (F.k)^<*G*(i,j)*>;
A147:       f/.(len(F.k)-'1) = G*(i1,j1) & f/.len(F.k) = G*(i2,j2)
            by A126,A127,A129,FINSEQ_4:83;
A148:       f/.(len(F.k)+1) = G*(i,j) by FINSEQ_4:82;
            thus thesis
            proof per cases by A125,A126,A127,A130,A145,A147,GOBRD13:def 7;
              suppose that
A149:           i1 = i2 & j1+1 = j2 and
A150:           f/.(len(F.k)+1) = G*(i2-'1,j2);
                now
                  let i1',j1',i2',j2' be Element of NAT;
                  assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
                  (F.k)/.len(F.k) = G*(i1',j1') & G*(i2-'1,j2) = G*(i2',j2');
                  then
A151:             i2 = i1' & j2 = j1' & i2-'1 = i2' & j2 = j2'
                  by A127,A132,A149,GOBOARD1:21;
                  then i1'-i2' = i2-(i2-1) by A128,XREAL_1:235;

then abs(j2'-j1') = 0 & abs(i1'-i2') = 1 by A151,ABSVALUE:def 1;
                  hence abs(i2'-i1')+abs(j2'-j1') = 1 by UNIFORM1:13;
                end;
                hence F.(k+1) is_sequence_on G
                by A98,A123,A132,A146,A148,A149,A150,JORDAN8:9;
              end;
              suppose that
A152:           i1+1 = i2 & j1 = j2 and
A153:           f/.(len(F.k)+1) = G*(i2,j2+1);
                now
                  let i1',j1',i2',j2' be Element of NAT;
                  assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
                  (F.k)/.len(F.k) = G*(i1',j1') & G*(i2,j2+1) = G*(i2',j2');
                  then i2 = i1' & j2 = j1' & i2 = i2' & j2+1 = j2'
                  by A127,A133,A152,GOBOARD1:21;
                  then abs(i2'-i1') = 0 & abs(j2'-j1') = 1 by ABSVALUE:def 1;
                  hence abs(i2'-i1')+abs(j2'-j1') = 1;
                end;
                hence F.(k+1) is_sequence_on G
                by A98,A123,A133,A146,A148,A152,A153,JORDAN8:9;
              end;
              suppose that
A154:           i1 = i2+1 & j1 = j2 and
A155:           f/.(len(F.k)+1) = G*(i2,j2-'1);
                now
                  let i1',j1',i2',j2' be Element of NAT;
                  assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
                  (F.k)/.len(F.k) = G*(i1',j1') & G*(i2,j2-'1) = G*(i2',j2');
                  then
A156:             i2 = i1' & j2 = j1' & i2 = i2' & j2-'1 = j2'
                  by A127,A134,A154,GOBOARD1:21;
                  then j1'-j2' = j2-(j2-1) by A128,XREAL_1:235;

then abs(i2'-i1') = 0 & abs(j1'-j2') = 1 by A156,ABSVALUE:def 1;
                  hence abs(i2'-i1')+abs(j2'-j1') = 1 by UNIFORM1:13;
                end;
                hence F.(k+1) is_sequence_on G
                by A98,A123,A134,A146,A148,A154,A155,JORDAN8:9;
              end;
              suppose that
A157:           i1 = i2 & j1 = j2+1 and
A158:           f/.(len(F.k)+1) = G*(i2+1,j2);
                now
                  let i1',j1',i2',j2' be Element of NAT;
                  assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
                  (F.k)/.len(F.k) = G*(i1',j1') & G*(i2+1,j2) = G*(i2',j2');
                  then i2 = i1' & j2 = j1' & i2+1 = i2' & j2 = j2'
                  by A127,A135,A157,GOBOARD1:21;
                  then abs(i2'-i1') = 1 & abs(j2'-j1') = 0 by ABSVALUE:def 1;
                  hence abs(i2'-i1')+abs(j2'-j1') = 1;
                end;
                hence F.(k+1) is_sequence_on G
                by A98,A123,A135,A146,A148,A157,A158,JORDAN8:9;
              end;
            end;
          end;
          suppose
A159:       front_right_cell(F.k,(len(F.k))-'1,G) misses C &
            front_left_cell(F.k,(len(F.k))-'1,G) meets C;
            then consider i,j such that
A160:       (F.k)^<*G*(i,j)*> goes_straight (len(F.k))-'1,G and
A161:       F.(k+1) = (F.k)^<*G*(i,j)*> by A77,A98,A100,A122,A131;
            set f = (F.k)^<*G*(i,j)*>;
A162:       f/.(len(F.k)-'1) = G*(i1,j1) & f/.len(F.k) = G*(i2,j2)
            by A126,A127,A129,FINSEQ_4:83;
A163:       f/.(len(F.k)+1) = G*(i,j) by FINSEQ_4:82;
            thus thesis
            proof per cases by A125,A126,A127,A130,A160,A162,GOBRD13:def 8;
              suppose that
A164:           i1 = i2 & j1+1 = j2 and
A165:           f/.(len(F.k)+1) = G*(i2,j2+1);
                now
                  let i1',j1',i2',j2' be Element of NAT;
                  assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
                  (F.k)/.len(F.k) = G*(i1',j1') & G*(i2,j2+1) = G*(i2',j2');
                  then i2 = i1' & j2 = j1' & i2 = i2' & j2+1 = j2'
                  by A127,A136,A159,A164,GOBOARD1:21;
                  then abs(i2'-i1') = 0 & abs(j2'-j1') = 1 by ABSVALUE:def 1;
                  hence abs(i2'-i1')+abs(j2'-j1') = 1;
                end;
                hence F.(k+1) is_sequence_on G
                by A98,A123,A136,A159,A161,A163,A164,A165,JORDAN8:9;
              end;
              suppose that
A166:           i1+1 = i2 & j1 = j2 and
A167:           f/.(len(F.k)+1) = G*(i2+1,j2);
                now
                  let i1',j1',i2',j2' be Element of NAT;
                  assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
                  (F.k)/.len(F.k) = G*(i1',j1') & G*(i2+1,j2) = G*(i2',j2');
                  then i2 = i1' & j2 = j1' & i2+1 = i2' & j2 = j2'
                  by A127,A137,A159,A166,GOBOARD1:21;
                  then abs(i2'-i1') = 1 & abs(j2'-j1') = 0 by ABSVALUE:def 1;
                  hence abs(i2'-i1')+abs(j2'-j1') = 1;
                end;
                hence F.(k+1) is_sequence_on G
                by A98,A123,A137,A159,A161,A163,A166,A167,JORDAN8:9;
              end;
              suppose that
A168:           i1 = i2+1 & j1 = j2 and
A169:           f/.(len(F.k)+1) = G*(i2-'1,j2);
                now
                  let i1',j1',i2',j2' be Element of NAT;
                  assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
                  (F.k)/.len(F.k) = G*(i1',j1') & G*(i2-'1,j2) = G*(i2',j2');
                  then
A170:             i2 = i1' & j2 = j1' & i2-'1 = i2' & j2 = j2'
                  by A127,A138,A159,A168,GOBOARD1:21;
                  then i1'-i2' = i2-(i2-1) by A128,XREAL_1:235;

then abs(j2'-j1') = 0 & abs(i1'-i2') = 1 by A170,ABSVALUE:def 1;
                  hence abs(i2'-i1')+abs(j2'-j1') = 1 by UNIFORM1:13;
                end;
                hence F.(k+1) is_sequence_on G
                by A98,A123,A138,A159,A161,A163,A168,A169,JORDAN8:9;
              end;
              suppose that
A171:           i1 = i2 & j1 = j2+1 and
A172:           f/.(len(F.k)+1) = G*(i2,j2-'1);
                now
                  let i1',j1',i2',j2' be Element of NAT;
                  assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
                  (F.k)/.len(F.k) = G*(i1',j1') & G*(i2,j2-'1) = G*(i2',j2');
                  then
A173:             i2 = i1' & j2 = j1' & i2 = i2' & j2-'1 = j2'
                  by A127,A139,A159,A171,GOBOARD1:21;
                  then j1'-j2' = j2-(j2-1) by A128,XREAL_1:235;

then abs(i2'-i1') = 0 & abs(j1'-j2') = 1 by A173,ABSVALUE:def 1;
                  hence abs(i2'-i1')+abs(j2'-j1') = 1 by UNIFORM1:13;
                end;
                hence F.(k+1) is_sequence_on G
                by A98,A123,A139,A159,A161,A163,A171,A172,JORDAN8:9;
              end;
            end;
          end;
          suppose
A174:       front_right_cell(F.k,(len(F.k))-'1,G) meets C;
            then consider i,j such that
A175:       (F.k)^<*G*(i,j)*> turns_right (len(F.k))-'1,G and
A176:       F.(k+1) = (F.k)^<*G*(i,j)*> by A77,A98,A100,A122,A131;
            set f = (F.k)^<*G*(i,j)*>;
A177:       f/.(len(F.k)-'1) = G*(i1,j1) & f/.len(F.k) = G*(i2,j2)
            by A126,A127,A129,FINSEQ_4:83;
A178:       f/.(len(F.k)+1) = G*(i,j) by FINSEQ_4:82;
            thus thesis
            proof per cases by A125,A126,A127,A130,A175,A177,GOBRD13:def 6;
              suppose that
A179:           i1 = i2 & j1+1 = j2 and
A180:           f/.(len(F.k)+1) = G*(i2+1,j2);
                now
                  let i1',j1',i2',j2' be Element of NAT;
                  assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
                  (F.k)/.len(F.k) = G*(i1',j1') & G*(i2+1,j2) = G*(i2',j2');
                  then i2 = i1' & j2 = j1' & i2+1 = i2' & j2 = j2'
                  by A127,A140,A174,A179,GOBOARD1:21;
                  then abs(i2'-i1') = 1 & abs(j2'-j1') = 0 by ABSVALUE:def 1;
                  hence abs(i2'-i1')+abs(j2'-j1') = 1;
                end;
                hence F.(k+1) is_sequence_on G
                by A98,A123,A140,A174,A176,A178,A179,A180,JORDAN8:9;
              end;
              suppose that
A181:           i1+1 = i2 & j1 = j2 and
A182:           f/.(len(F.k)+1) = G*(i2,j2-'1);
                now
                  let i1',j1',i2',j2' be Element of NAT;
                  assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
                  (F.k)/.len(F.k) = G*(i1',j1') & G*(i2,j2-'1) = G*(i2',j2');
                  then
A183:             i2 = i1' & j2 = j1' & i2 = i2' & j2-'1 = j2'
                  by A127,A141,A174,A181,GOBOARD1:21;
                  then j1'-j2' = j2-(j2-1) by A128,XREAL_1:235;

then abs(i2'-i1') = 0 & abs(j1'-j2') = 1 by A183,ABSVALUE:def 1;
                  hence abs(i2'-i1')+abs(j2'-j1') = 1 by UNIFORM1:13;
                end;

hence F.(k+1) is_sequence_on G by A98,A123,A141,A174,A176,A178,A181,A182,
JORDAN8:9;
              end;
              suppose that
A184:           i1 = i2+1 & j1 = j2 and
A185:           f/.(len(F.k)+1) = G*(i2,j2+1);
                now
                  let i1',j1',i2',j2' be Element of NAT;
                  assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
                  (F.k)/.len(F.k) = G*(i1',j1') & G*(i2,j2+1) = G*(i2',j2');
                  then i2 = i1' & j2 = j1' & i2 = i2' & j2+1 = j2'
                  by A127,A142,A174,A184,GOBOARD1:21;
                  then abs(i2'-i1') = 0 & abs(j2'-j1') = 1 by ABSVALUE:def 1;
                  hence abs(i2'-i1')+abs(j2'-j1') = 1;
                end;
                hence F.(k+1) is_sequence_on G
                by A98,A123,A142,A174,A176,A178,A184,A185,JORDAN8:9;
              end;
              suppose that
A186:           i1 = i2 & j1 = j2+1 and
A187:           f/.(len(F.k)+1) = G*(i2-'1,j2);
                now
                  let i1',j1',i2',j2' be Element of NAT;
                  assume [i1',j1'] in Indices G & [i2',j2'] in Indices G &
                  (F.k)/.len(F.k) = G*(i1',j1') & G*(i2-'1,j2) = G*(i2',j2');
                  then
A188:             i2 = i1' & j2 = j1' & i2-'1 = i2' & j2 = j2'
                  by A127,A143,A174,A186,GOBOARD1:21;
                  then i1'-i2' = i2-(i2-1) by A128,XREAL_1:235;

then abs(j2'-j1') = 0 & abs(i1'-i2') = 1 by A188,ABSVALUE:def 1;
                  hence abs(i2'-i1')+abs(j2'-j1') = 1 by UNIFORM1:13;
                end;
                hence F.(k+1) is_sequence_on G
                by A98,A123,A143,A174,A176,A178,A186,A187,JORDAN8:9;
              end;
            end;
          end;
        end;
        let m such that
A189:   1 <= m & m+1 <= len(F.(k+1));
        now per cases;
          suppose
A190:       m+1 = len(F.(k+1));
A191:       (i2-'1)+1 = i2 by A128,XREAL_1:237;
A192:       (j2-'1)+1 = j2 by A128,XREAL_1:237;
            thus thesis
            proof per cases;
              suppose
A193:           front_right_cell(F.k,(len(F.k))-'1,G) misses C &
                front_left_cell(F.k,(len(F.k))-'1,G) misses C;
                then consider i,j such that
A194:           (F.k)^<*G*(i,j)*> turns_left (len(F.k))-'1,G and
A195:           F.(k+1) = (F.k)^<*G*(i,j)*> by A77,A98,A100,A122,A131;
A196:           (F.(k+1))/.(len(F.k)-'1) = G*(i1,j1) &
                (F.(k+1))/.len(F.k) = G*(i2,j2)
                by A126,A127,A129,A195,FINSEQ_4:83;
                now per cases by A125,A126,A127,A130,A194,A195,A196,
GOBRD13:def 7;
                  suppose that
A197:               i1 = i2 & j1+1 = j2 and
A198:               (F.(k+1))/.(len(F.k)+1) = G*(i2-'1,j2);
                    front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i1-'1,j2)
                    by A98,A124,A125,A126,A127,A197,GOBRD13:35;
                    hence right_cell(F.(k+1),m,G) misses C

by A100,A101,A127,A132,A144,A189,A190,A191,A193,A196,A197,A198,GOBRD13:27;
                    j2-'1 = j1 & cell(G,i1-'1,j1) meets C

by A98,A124,A125,A126,A127,A131,A197,GOBRD13:22,NAT_D:34;
                    hence left_cell(F.(k+1),m,G) meets C
                    by A100,A101,A127,A132,A144,A189,A190,A191,A196,A197,A198,
GOBRD13:26;
                  end;
                  suppose that
A199:               i1+1 = i2 & j1 = j2 and
A200:               (F.(k+1))/.(len(F.k)+1) = G*(i2,j2+1);
                    front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i2,j2)
                    by A98,A124,A125,A126,A127,A199,GOBRD13:37;
                    hence right_cell(F.(k+1),m,G) misses C
                    by A100,A101,A127,A133,A144,A189,A190,A193,A196,A199,A200,
GOBRD13:23;
                    i1+1-'1 = i1 & cell(G,i1,j1) meets C

by A98,A124,A125,A126,A127,A131,A199,GOBRD13:24,NAT_D:34;
                    hence left_cell(F.(k+1),m,G) meets C

by A100,A101,A127,A133,A144,A189,A190,A196,A199,A200,GOBRD13:22;
                  end;
                  suppose that
A201:               i1 = i2+1 & j1 = j2 and
A202:               (F.(k+1))/.(len(F.k)+1) = G*(i2,j2-'1);
                    front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i2-'1,j2-'1)
                    by A98,A124,A125,A126,A127,A201,GOBRD13:39;
                    hence right_cell(F.(k+1),m,G) misses C

by A100,A101,A127,A134,A144,A189,A190,A192,A193,A196,A201,A202,GOBRD13:29;
                    cell(G,i2,j2-'1) meets C by A98,A124,A125,A126,A127,A131
,A201,GOBRD13:26;
                    hence left_cell(F.(k+1),m,G) meets C
                    by A100,A101,A127,A134,A144,A189,A190,A192,A196,A201,A202,
GOBRD13:28;
                  end;
                  suppose that
A203:               i1 = i2 & j1 = j2+1 and
A204:               (F.(k+1))/.(len(F.k)+1) = G*(i2+1,j2);
                    front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i2,j2-'1)
                    by A98,A124,A125,A126,A127,A203,GOBRD13:41;
                    hence right_cell(F.(k+1),m,G) misses C
                    by A100,A101,A127,A135,A144,A189,A190,A193,A196,A203,A204,
GOBRD13:25;
                    cell(G,i2,j2) meets C by A98,A124,A125,A126,A127,A131,A203,
GOBRD13:28;
                    hence left_cell(F.(k+1),m,G) meets C

by A100,A101,A127,A135,A144,A189,A190,A196,A203,A204,GOBRD13:24;
                  end;
                end;
                hence thesis;
              end;
              suppose
A205:           front_right_cell(F.k,(len(F.k))-'1,G) misses C &
                front_left_cell(F.k,(len(F.k))-'1,G) meets C;
                then consider i,j such that
A206:           (F.k)^<*G*(i,j)*> goes_straight (len(F.k))-'1,G and
A207:           F.(k+1) = (F.k)^<*G*(i,j)*> by A77,A98,A100,A122,A131;
A208:           (F.(k+1))/.(len(F.k)-'1) = G*(i1,j1) &
                (F.(k+1))/.len(F.k) = G*(i2,j2)
                by A126,A127,A129,A207,FINSEQ_4:83;
                now per cases by A125,A126,A127,A130,A206,A207,A208,
GOBRD13:def 8;
                  suppose that
A209:               i1 = i2 & j1+1 = j2 and
A210:               (F.(k+1))/.(len(F.k)+1) = G*(i2,j2+1);
                    front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i1,j2)
                    by A98,A124,A125,A126,A127,A209,GOBRD13:36;
                    hence right_cell(F.(k+1),m,G) misses C
                    by A100,A101,A127,A136,A144,A189,A190,A205,A208,A209,A210,
GOBRD13:23;
                    front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i1-'1,j2)
                    by A98,A124,A125,A126,A127,A209,GOBRD13:35;
                    hence left_cell(F.(k+1),m,G) meets C
                    by A100,A101,A127,A136,A144,A189,A190,A205,A208,A209,A210,
GOBRD13:22;
                  end;
                  suppose that
A211:               i1+1 = i2 & j1 = j2 and
A212:               (F.(k+1))/.(len(F.k)+1) = G*(i2+1,j2);
                    front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i2,j2-'1)
                    by A98,A124,A125,A126,A127,A211,GOBRD13:38;
                    hence right_cell(F.(k+1),m,G) misses C
                    by A100,A101,A127,A137,A144,A189,A190,A205,A208,A211,A212,
GOBRD13:25;
                    front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i2,j2)
                    by A98,A124,A125,A126,A127,A211,GOBRD13:37;
                    hence left_cell(F.(k+1),m,G) meets C
                    by A100,A101,A127,A137,A144,A189,A190,A205,A208,A211,A212,
GOBRD13:24;
                  end;
                  suppose that
A213:               i1 = i2+1 & j1 = j2 and
A214:               (F.(k+1))/.(len(F.k)+1) = G*(i2-'1,j2);
                    front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i2-'1,j2)
                    by A98,A124,A125,A126,A127,A213,GOBRD13:40;
                    hence right_cell(F.(k+1),m,G) misses C

by A100,A101,A127,A138,A144,A189,A190,A191,A205,A208,A213,A214,GOBRD13:27;
                    front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i2-'1,j2-'1)
                    by A98,A124,A125,A126,A127,A213,GOBRD13:39;
                    hence left_cell(F.(k+1),m,G) meets C

by A100,A101,A127,A138,A144,A189,A190,A191,A205,A208,A213,A214,GOBRD13:26;
                  end;
                  suppose that
A215:               i1 = i2 & j1 = j2+1 and
A216:               (F.(k+1))/.(len(F.k)+1) = G*(i2,j2-'1);
                    front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i2-'1,j2-'1
                    ) by A98,A124,A125,A126,A127,A215,GOBRD13:42;
                    hence right_cell(F.(k+1),m,G) misses C

by A100,A101,A127,A139,A144,A189,A190,A192,A205,A208,A215,A216,GOBRD13:29;
                    front_left_cell(F.k,(len(F.k))-'1,G) = cell(G,i2,j2-'1)
                    by A98,A124,A125,A126,A127,A215,GOBRD13:41;
                    hence left_cell(F.(k+1),m,G) meets C

by A100,A101,A127,A139,A144,A189,A190,A192,A205,A208,A215,A216,GOBRD13:28;
                  end;
                end;
                hence thesis;
              end;
              suppose
A217:           front_right_cell(F.k,(len(F.k))-'1,G) meets C;
                then consider i,j such that
A218:           (F.k)^<*G*(i,j)*> turns_right (len(F.k))-'1,G and
A219:           F.(k+1) = (F.k)^<*G*(i,j)*> by A77,A98,A100,A122,A131;
A220:           (F.(k+1))/.(len(F.k)-'1) = G*(i1,j1) &
                (F.(k+1))/.len(F.k) = G*(i2,j2)
                by A126,A127,A129,A219,FINSEQ_4:83;
                now per cases by A125,A126,A127,A130,A218,A219,A220,
GOBRD13:def 6;
                  suppose that
A221:               i1 = i2 & j1+1 = j2 and
A222:               (F.(k+1))/.(len(F.k)+1) = G*(i2+1,j2);
                    j2 -'1 = j1 & cell(G,i1,j1) misses C

by A98,A124,A125,A126,A127,A131,A221,GOBRD13:23,NAT_D:34;
                    hence right_cell(F.(k+1),m,G) misses C
                    by A100,A101,A127,A140,A144,A189,A190,A217,A220,A221,A222,
GOBRD13:25;
                    front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i2,j2)
                    by A98,A124,A125,A126,A127,A221,GOBRD13:36;
                    hence left_cell(F.(k+1),m,G) meets C
                    by A100,A101,A127,A140,A144,A189,A190,A217,A220,A221,A222,
GOBRD13:24;
                  end;
                  suppose that
A223:               i1+1 = i2 & j1 = j2 and
A224:               (F.(k+1))/.(len(F.k)+1) = G*(i2,j2-'1);
                    i2 -'1 = i1 & cell(G,i1,j1-'1) misses C

by A98,A124,A125,A126,A127,A131,A223,GOBRD13:25,NAT_D:34;
                    hence right_cell(F.(k+1),m,G) misses C

by A100,A101,A127,A141,A144,A189,A190,A192,A217,A220,A223,A224,GOBRD13:29;
                    front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i2,j2-'1)
                    by A98,A124,A125,A126,A127,A223,GOBRD13:38;
                    hence left_cell(F.(k+1),m,G) meets C

by A100,A101,A127,A141,A144,A189,A190,A192,A217,A220,A223,A224,GOBRD13:28;
                  end;
                  suppose that
A225:               i1 = i2+1 & j1 = j2 and
A226:               (F.(k+1))/.(len(F.k)+1) = G*(i2,j2+1);

cell(G,i2,j2) misses C by A98,A124,A125,A126,A127,A131,A225,GOBRD13:27;
                    hence right_cell(F.(k+1),m,G) misses C
                    by A100,A101,A127,A142,A144,A189,A190,A217,A220,A225,A226,
GOBRD13:23;
                    front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i2-'1,j2)
                    by A98,A124,A125,A126,A127,A225,GOBRD13:40;
                    hence left_cell(F.(k+1),m,G) meets C
                    by A100,A101,A127,A142,A144,A189,A190,A217,A220,A225,A226,
GOBRD13:22;
                  end;
                  suppose that
A227:               i1 = i2 & j1 = j2+1 and
A228:               (F.(k+1))/.(len(F.k)+1) = G*(i2-'1,j2);
                    cell(G,i2-'1,j2) misses C by A98,A124,A125,A126,A127,A131
,A227,GOBRD13:29;
                    hence right_cell(F.(k+1),m,G) misses C

by A100,A101,A127,A143,A144,A189,A190,A191,A217,A220,A227,A228,GOBRD13:27;
                    front_right_cell(F.k,(len(F.k))-'1,G) = cell(G,i2-'1,j2-'1
                    ) by A98,A124,A125,A126,A127,A227,GOBRD13:42;
                    hence left_cell(F.(k+1),m,G) meets C

by A100,A101,A127,A143,A144,A189,A190,A191,A217,A220,A227,A228,GOBRD13:26;
                  end;
                end;
                hence thesis;
              end;
            end;
          end;
          suppose m+1 <> len(F.(k+1));
            then m+1 < len(F.(k+1)) by A189,XXREAL_0:1;
            then
A229:       m+1 <= len(F.k)by A100,A101,NAT_1:13;
            then consider i1,j1,i2,j2 being Element of NAT such that
A230:       [i1,j1] in Indices G & (F.k)/.m = G*(i1,j1) and
A231:       [i2,j2] in Indices G & (F.k)/.(m+1) = G*(i2,j2) and
A232:       i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
            i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A98,A189,JORDAN8:6;
A233:       1 <= m+1 by NAT_1:12;
            m <= len(F.k) by A229,NAT_1:13;
            then
A234:       m in dom(F.k) & m+1 in dom(F.k) by A189,A229,A233,FINSEQ_3:27;
A235:       right_cell(F.k,m,G) misses C & left_cell(F.k,m,G) meets C
            by A99,A189,A229;
            now per cases;
              suppose front_right_cell(F.k,(len(F.k))-'1,G) misses C &
                front_left_cell(F.k,(len(F.k))-'1,G) misses C;
                then consider i,j such that
                (F.k)^<*G*(i,j)*> turns_left (len(F.k))-'1,G and
A236:           F.(k+1) = (F.k)^<*G*(i,j)*> by A77,A98,A100,A122,A131;
                take i,j;
                thus F.(k+1) = (F.k)^<*G*(i,j)*> by A236;
              end;
              suppose front_right_cell(F.k,(len(F.k))-'1,G) misses C &
                front_left_cell(F.k,(len(F.k))-'1,G) meets C;
                then consider i,j such that
                (F.k)^<*G*(i,j)*> goes_straight (len(F.k))-'1,G and
A237:           F.(k+1) = (F.k)^<*G*(i,j)*> by A77,A98,A100,A122,A131;
                take i,j;
                thus F.(k+1) = (F.k)^<*G*(i,j)*> by A237;
              end;
              suppose front_right_cell(F.k,(len(F.k))-'1,G) meets C;
                then consider i,j such that
                (F.k)^<*G*(i,j)*> turns_right (len(F.k))-'1,G and
A238:           F.(k+1) = (F.k)^<*G*(i,j)*> by A77,A98,A100,A122,A131;
                take i,j;
                thus F.(k+1) = (F.k)^<*G*(i,j)*> by A238;
              end;
            end;
            then consider i,j such that
A239:       F.(k+1) = (F.k)^<*G*(i,j)*>;
A240:       (F.(k+1))/.m = G*(i1,j1) & (F.(k+1))/.(m+1) = G*(i2,j2)
            by A230,A231,A234,A239,FINSEQ_4:83;
            now per cases by A232;
              suppose
A241:           i1 = i2 & j1+1 = j2;
                then left_cell(F.k,m,G) = cell(G,i1-'1,j1) &
                right_cell(F.k,m,G) = cell(G,i1,j1)
                by A98,A189,A229,A230,A231,GOBRD13:22,23;

hence thesis by A144,A189,A230,A231,A235,A240,A241,GOBRD13:22,23;
              end;
              suppose
A242:           i1+1 = i2 & j1 = j2;
                then left_cell(F.k,m,G) = cell(G,i1,j1) &
                right_cell(F.k,m,G) = cell(G,i1,j1-'1)
                by A98,A189,A229,A230,A231,GOBRD13:24,25;

hence thesis by A144,A189,A230,A231,A235,A240,A242,GOBRD13:24,25;
              end;
              suppose
A243:           i1 = i2+1 & j1 = j2;
                then left_cell(F.k,m,G) = cell(G,i2,j2-'1) &
                right_cell(F.k,m,G) = cell(G,i2,j2)
                by A98,A189,A229,A230,A231,GOBRD13:26,27;

hence thesis by A144,A189,A230,A231,A235,A240,A243,GOBRD13:26,27;
              end;
              suppose
A244:           i1 = i2 & j1 = j2+1;
                then left_cell(F.k,m,G) = cell(G,i2,j2) &
                right_cell(F.k,m,G) = cell(G,i1-'1,j2)
                by A98,A189,A229,A230,A231,GOBRD13:28,29;

hence thesis by A144,A189,A230,A231,A235,A240,A244,GOBRD13:28,29;
              end;
            end;
            hence thesis;
          end;
        end;
        hence thesis;
      end;
    end;
A245: for k holds Q[k] from NAT_1:sch 1(A94,A97);
A246: P[0,F.0,F.(0+1)] by A77;
A247: P[1,F.1,F.(1+1)] by A77;
A248: for k,i1,i2,j1,j2 st k > 1 &
    [i1,j1] in Indices G & (F.k)/.(len(F.k)-'1) = G*(i1,j1) &
    [i2,j2] in Indices G & (F.k)/.len(F.k) = G*(i2,j2) holds
    (front_right_cell(F.k,(len(F.k))-'1,G) misses C &
    front_left_cell(F.k,(len(F.k))-'1,G) misses C
    implies F.(k+1) turns_left (len(F.k))-'1,G &
    (i1 = i2 & j1+1 = j2 implies [i2-'1,j2] in Indices G &
    F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>) &
    (i1+1 = i2 & j1 = j2 implies [i2,j2+1] in Indices G &
    F.(k+1) = (F.k)^<*G*(i2,j2+1)*>) &
    (i1 = i2+1 & j1 = j2 implies [i2,j2-'1] in Indices G &
    F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>)&
    (i1 = i2 & j1 = j2+1 implies [i2+1,j2] in Indices G &
    F.(k+1) = (F.k)^<*G*(i2+1,j2)*>))
    proof
      let k,i1,i2,j1,j2 such that
A249: k > 1 and
A250: [i1,j1] in Indices G & (F.k)/.(len(F.k)-'1) = G*(i1,j1) and
A251: [i2,j2] in Indices G & (F.k)/.len(F.k) = G*(i2,j2);
A252: (len(F.k))-'1 <= len(F.k) by NAT_D:35;
A253: F.k is_sequence_on G by A245;
A254: len(F.k) = k by A91;
      then
A255: 1 <= (len(F.k))-'1 by A249,NAT_D:49;
A256: (len(F.k)) -'1 +1 = len(F.k) by A249,A254,XREAL_1:237;
      then
A257: left_cell(F.k,(len(F.k))-'1,G) meets C by A245,A255;
A258: (len(F.k))-'1 in dom(F.k) & len(F.k) in dom(F.k)
      by A249,A252,A254,A255,FINSEQ_3:27;
A259: (len(F.k))-'1+(1+1) = (len(F.k))+1 by A256;
A260: i1+1 > i1 & i2+1 > i2 & j1+1 > j1 & j2+1 > j2 by NAT_1:13;
      hereby
        assume front_right_cell(F.k,(len(F.k))-'1,G) misses C &
        front_left_cell(F.k,(len(F.k))-'1,G) misses C;
        then consider i,j such that
A261:   (F.k)^<*G*(i,j)*> turns_left (len(F.k))-'1,G and
A262:   F.(k+1) = (F.k)^<*G*(i,j)*> by A77,A249,A253,A254,A257;
A263:   (F.(k+1))/.(len(F.k)-'1) = G*(i1,j1) & (F.(k+1))/.len(F.k) = G*(i2,j2)
        by A250,A251,A258,A262,FINSEQ_4:83;
A264:   (F.(k+1))/.(len(F.k)+1) = G*(i,j) by A262,FINSEQ_4:82;
        thus F.(k+1) turns_left (len(F.k))-'1,G by A261,A262;
        thus i1 = i2 & j1+1 = j2 implies
        [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>
        by A250,A251,A256,A259,A260,A261,A262,A263,A264,GOBRD13:def 7;
        thus i1+1 = i2 & j1 = j2 implies
        [i2,j2+1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2+1)*>
        by A250,A251,A256,A259,A260,A261,A262,A263,A264,GOBRD13:def 7;
        thus i1 = i2+1 & j1 = j2 implies
        [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>
        by A250,A251,A256,A259,A260,A261,A262,A263,A264,GOBRD13:def 7;
        thus i1 = i2 & j1 = j2+1 implies
        [i2+1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2+1,j2)*>
        by A250,A251,A256,A259,A260,A261,A262,A263,A264,GOBRD13:def 7;
      end;
    end;
A265: for k,i1,i2,j1,j2 st k > 1 &
    [i1,j1] in Indices G & (F.k)/.(len(F.k)-'1) = G*(i1,j1) &
    [i2,j2] in Indices G & (F.k)/.len(F.k) = G*(i2,j2) holds
    (front_right_cell(F.k,(len(F.k))-'1,G) misses C &
    front_left_cell(F.k,(len(F.k))-'1,G) meets C
    implies F.(k+1) goes_straight (len(F.k))-'1,G &
    (i1 = i2 & j1+1 = j2 implies [i2,j2+1] in Indices G &
    F.(k+1) = (F.k)^<*G*(i2,j2+1)*>) &
    (i1+1 = i2 & j1 = j2 implies [i2+1,j2] in Indices G &
    F.(k+1) = (F.k)^<*G*(i2+1,j2)*>) &
    (i1 = i2+1 & j1 = j2 implies [i2-'1,j2] in Indices G &
    F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>)&
    (i1 = i2 & j1 = j2+1 implies [i2,j2-'1] in Indices G &
    F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>))
    proof
      let k,i1,i2,j1,j2 such that
A266: k > 1 and
A267: [i1,j1] in Indices G & (F.k)/.(len(F.k)-'1) = G*(i1,j1) and
A268: [i2,j2] in Indices G & (F.k)/.len(F.k) = G*(i2,j2);
A269: (len(F.k))-'1 <= len(F.k) by NAT_D:35;
A270: F.k is_sequence_on G by A245;
A271: len(F.k) = k by A91;
      then
A272: 1 <= (len(F.k))-'1 by A266,NAT_D:49;
A273: (len(F.k)) -'1 +1 = len(F.k) by A266,A271,XREAL_1:237;
      then
A274: left_cell(F.k,(len(F.k))-'1,G) meets C by A245,A272;
A275: (len(F.k))-'1 in dom(F.k) & len(F.k) in dom(F.k)
      by A266,A269,A271,A272,FINSEQ_3:27;
A276: (len(F.k))-'1+(1+1) = (len(F.k))+1 by A273;
A277: i1+1 > i1 & i2+1 > i2 & j1+1 > j1 & j2+1 > j2 by NAT_1:13;
      hereby
        assume front_right_cell(F.k,(len(F.k))-'1,G) misses C &
        front_left_cell(F.k,(len(F.k))-'1,G) meets C;
        then consider i,j such that
A278:   (F.k)^<*G*(i,j)*> goes_straight (len(F.k))-'1,G and
A279:   F.(k+1) = (F.k)^<*G*(i,j)*> by A77,A266,A270,A271,A274;
A280:   (F.(k+1))/.(len(F.k)-'1) = G*(i1,j1) & (F.(k+1))/.len(F.k) = G*(i2,j2)
        by A267,A268,A275,A279,FINSEQ_4:83;
A281:   (F.(k+1))/.(len(F.k)+1) = G*(i,j) by A279,FINSEQ_4:82;
        thus F.(k+1) goes_straight (len(F.k))-'1,G by A278,A279;
        thus i1 = i2 & j1+1 = j2 implies
        [i2,j2+1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2+1)*>
        by A267,A268,A273,A276,A277,A278,A279,A280,A281,GOBRD13:def 8;
        thus i1+1 = i2 & j1 = j2 implies
        [i2+1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2+1,j2)*>
        by A267,A268,A273,A276,A277,A278,A279,A280,A281,GOBRD13:def 8;
        thus i1 = i2+1 & j1 = j2 implies
        [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>
        by A267,A268,A273,A276,A277,A278,A279,A280,A281,GOBRD13:def 8;
        thus i1 = i2 & j1 = j2+1 implies
        [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>
        by A267,A268,A273,A276,A277,A278,A279,A280,A281,GOBRD13:def 8;
      end;
    end;
A282: for k,i1,i2,j1,j2 st k > 1 &
    [i1,j1] in Indices G & (F.k)/.(len(F.k)-'1) = G*(i1,j1) &
    [i2,j2] in Indices G & (F.k)/.len(F.k) = G*(i2,j2) holds
    (front_right_cell(F.k,(len(F.k))-'1,G) meets C
    implies F.(k+1) turns_right (len(F.k))-'1,G &
    (i1 = i2 & j1+1 = j2 implies [i2+1,j2] in Indices G &
    F.(k+1) = (F.k)^<*G*(i2+1,j2)*>) &
    (i1+1 = i2 & j1 = j2 implies [i2,j2-'1] in Indices G &
    F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>) &
    (i1 = i2+1 & j1 = j2 implies [i2,j2+1] in Indices G &
    F.(k+1) = (F.k)^<*G*(i2,j2+1)*>)&
    (i1 = i2 & j1 = j2+1 implies [i2-'1,j2] in Indices G &
    F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>))
    proof
      let k,i1,i2,j1,j2 such that
A283: k > 1 and
A284: [i1,j1] in Indices G & (F.k)/.(len(F.k)-'1) = G*(i1,j1) and
A285: [i2,j2] in Indices G & (F.k)/.len(F.k) = G*(i2,j2);
A286: (len(F.k))-'1 <= len(F.k) by NAT_D:35;
A287: F.k is_sequence_on G by A245;
A288: len(F.k) = k by A91;
      then
A289: 1 <= (len(F.k))-'1 by A283,NAT_D:49;
A290: (len(F.k)) -'1 +1 = len(F.k) by A283,A288,XREAL_1:237;
      then
A291: left_cell(F.k,(len(F.k))-'1,G) meets C by A245,A289;
A292: (len(F.k))-'1 in dom(F.k) & len(F.k) in dom(F.k)
      by A283,A286,A288,A289,FINSEQ_3:27;
A293: (len(F.k))-'1+(1+1) = (len(F.k))+1 by A290;
A294: i1+1 > i1 & i2+1 > i2 & j1+1 > j1 & j2+1 > j2 by NAT_1:13;
      assume front_right_cell(F.k,(len(F.k))-'1,G) meets C;
      then consider i,j such that
A295: (F.k)^<*G*(i,j)*> turns_right (len(F.k))-'1,G and
A296: F.(k+1) = (F.k)^<*G*(i,j)*> by A77,A283,A287,A288,A291;
A297: (F.(k+1))/.(len(F.k)-'1) = G*(i1,j1) & (F.(k+1))/.len(F.k) = G*(i2,j2)
      by A284,A285,A292,A296,FINSEQ_4:83;
A298: (F.(k+1))/.(len(F.k)+1) = G*(i,j) by A296,FINSEQ_4:82;
      thus F.(k+1) turns_right (len(F.k))-'1,G by A295,A296;
      thus i1 = i2 & j1+1 = j2 implies
      [i2+1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2+1,j2)*>
      by A284,A285,A290,A293,A294,A295,A296,A297,A298,GOBRD13:def 6;
      thus i1+1 = i2 & j1 = j2 implies
      [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2-'1)*>
      by A284,A285,A290,A293,A294,A295,A296,A297,A298,GOBRD13:def 6;
      thus i1 = i2+1 & j1 = j2 implies
      [i2,j2+1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2+1)*>
      by A284,A285,A290,A293,A294,A295,A296,A297,A298,GOBRD13:def 6;
      thus i1 = i2 & j1 = j2+1 implies
      [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2-'1,j2)*>
      by A284,A285,A290,A293,A294,A295,A296,A297,A298,GOBRD13:def 6;
    end;
A299: for k holds ex i,j st [i,j] in Indices G & F.(k+1) = (F.k)^<*G*(i,j)*>
    proof
      let k;
A300: F.k is_sequence_on G by A245;
A301: len(F.k) = k by A91;
      per cases by XXREAL_0:1;
      suppose k < 1;
        then
A302:   k = 0 by NAT_1:14;
        take X-SpanStart(C,n),Y-SpanStart(C,n);
        thus [X-SpanStart(C,n),Y-SpanStart(C,n)] in Indices G by A1,JORDAN11:8;
        thus thesis by A76,A246,A302,FINSEQ_1:47;
      end;
      suppose
A303:   k = 1;
        take X-SpanStart(C,n)-'1,Y-SpanStart(C,n);
        thus [X-SpanStart(C,n)-'1,Y-SpanStart(C,n)] in Indices G
        by A1,JORDAN11:9;
        thus thesis by A246,A247,A303,FINSEQ_1:def 9;
      end;
      suppose
A304:   k > 1;
        then
A305:   1 <= (len(F.k))-'1 by A301,NAT_D:49;
        (len(F.k)) -'1 +1 = len(F.k) by A301,A304,XREAL_1:237;
        then consider i1,j1,i2,j2 being Element of NAT such that
A306:   [i1,j1] in Indices G & (F.k)/.(len(F.k)-'1) = G*(i1,j1) and
A307:   [i2,j2] in Indices G & (F.k)/.len(F.k) = G*(i2,j2) and
A308:   i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
        i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A300,A305,JORDAN8:6;
        now per cases;
          suppose
A309:       front_right_cell(F.k,(len(F.k))-'1,G) misses C &
            front_left_cell(F.k,(len(F.k))-'1,G) misses C;
            now per cases by A308;
              suppose i1 = i2 & j1+1 = j2;
                then [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2-'1,j2)
                *> by A248,A304,A306,A307,A309;
                hence thesis;
              end;
              suppose i1+1 = i2 & j1 = j2;
                then [i2,j2+1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2+1)*>
                by A248,A304,A306,A307,A309;
                hence thesis;
              end;
              suppose i1 = i2+1 & j1 = j2;
                then [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2-'1)
                *> by A248,A304,A306,A307,A309;
                hence thesis;
              end;
              suppose i1 = i2 & j1 = j2+1;
                then [i2+1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2+1,j2)*>
                by A248,A304,A306,A307,A309;
                hence thesis;
              end;
            end;
            hence thesis;
          end;
          suppose
A310:       front_right_cell(F.k,(len(F.k))-'1,G) misses C &
            front_left_cell(F.k,(len(F.k))-'1,G) meets C;
            now per cases by A308;
              suppose i1 = i2 & j1+1 = j2;
                then [i2,j2+1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2+1)*>
                by A265,A304,A306,A307,A310;
                hence thesis;
              end;
              suppose i1+1 = i2 & j1 = j2;
                then [i2+1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2+1,j2)*>
                by A265,A304,A306,A307,A310;
                hence thesis;
              end;
              suppose i1 = i2+1 & j1 = j2;
                then [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2-'1,j2)
                *> by A265,A304,A306,A307,A310;
                hence thesis;
              end;
              suppose i1 = i2 & j1 = j2+1;
                then [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2-'1)
                *> by A265,A304,A306,A307,A310;
                hence thesis;
              end;
            end;
            hence thesis;
          end;
          suppose
A311:       front_right_cell(F.k,(len(F.k))-'1,G) meets C;
            now per cases by A308;
              suppose i1 = i2 & j1+1 = j2;
                then [i2+1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2+1,j2)*>
                by A282,A304,A306,A307,A311;
                hence thesis;
              end;
              suppose i1+1 = i2 & j1 = j2;
                then [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2-'1)
                *> by A282,A304,A306,A307,A311;
                hence thesis;
              end;
              suppose i1 = i2+1 & j1 = j2;
                then [i2,j2+1] in Indices G & F.(k+1) = (F.k)^<*G*(i2,j2+1)*>
                by A282,A304,A306,A307,A311;
                hence thesis;
              end;
              suppose i1 = i2 & j1 = j2+1;
                then [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^<*G*(i2-'1,j2)
                *> by A282,A304,A306,A307,A311;
                hence thesis;
              end;
            end;
            hence thesis;
          end;
        end;
        hence thesis;
      end;
    end;
    defpred P[Element of NAT] means for m st m <= $1 holds (F.$1)|m = F.m;
A312: P[0]
    proof
      let m;
      assume
A313: m <= 0;
      then 0 = m;
      then (F.0)|m = (F.m)|Seg 0 by FINSEQ_1:def 15;
      then (F.0)|m = {} by FINSEQ_1:4,RELAT_1:110;
      hence thesis by A76,A313;
    end;
A314: for k st P[k] holds P[k+1]
    proof
      let k such that
A315: for m st m <= k holds (F.k)|m = F.m;
      let m such that
A316: m <= k+1;
      per cases by A316,XXREAL_0:1;
      suppose m < k+1;
        then
A317:   m <= k by NAT_1:13;
A318:   len(F.k) = k by A91;
        consider i,j such that [i,j] in Indices G and
A319:   F.(k+1) = F.k^<*G*(i,j)*> by A299;
        (F.(k+1))|m = (F.k)|m by A317,A318,A319,FINSEQ_5:25;
        hence (F.(k+1))|m = F.m by A315,A317;
      end;
      suppose
A320:   m = k+1;
        len(F.(k+1)) = k+1 by A91;
        hence (F.(k+1))|m = F.m by A320,FINSEQ_1:79;
      end;
    end;
A321: for k holds P[k] from NAT_1:sch 1(A312,A314);
A322: for k st k > 1 holds (front_right_cell(F.k,k-'1,Gauge(C,n)) misses C &
    front_left_cell(F.k,k-'1,Gauge(C,n)) misses C
    implies F.(k+1) turns_left k-'1,Gauge(C,n)) &
    (front_right_cell(F.k,k-'1,Gauge(C,n)) misses C &
    front_left_cell(F.k,k-'1,Gauge(C,n)) meets C
    implies F.(k+1) goes_straight k-'1,Gauge(C,n)) &
    (front_right_cell(F.k,k-'1,Gauge(C,n)) meets C
    implies F.(k+1) turns_right k-'1,Gauge(C,n))
    proof
      let k such that
A323: k > 1;
A324: F.k is_sequence_on G by A245;
A325: len(F.k) = k by A91;
      then
A326: 1 <= (len(F.k))-'1 by A323,NAT_D:49;
      (len(F.k)) -'1 +1 = len(F.k) by A323,A325,XREAL_1:237;
      then ex i1,j1,i2,j2 being Element of NAT st
      [i1,j1] in Indices G & (F.k)/.(len(F.k)-'1) = G*(i1,j1) &
      [i2,j2] in Indices G & (F.k)/.len(F.k) = G*(i2,j2) &
      (i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
      i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1) by A324,A326,JORDAN8:6;
      hence thesis by A248,A265,A282,A323,A325;
    end;
    defpred P[Element of NAT] means F.$1 is unfolded;
    len(F.0) = 0 by A76,CARD_1:47;
    then
A327: P[0] by SPPOL_2:27;
A328: for k st P[k] holds P[k+1]
    proof
      let k such that
A329: F.k is unfolded;
A330: F.k is_sequence_on G by A245;
      per cases;
      suppose k <= 1;
        then k+1 <= 1+1 by XREAL_1:8;
        then len(F.(k+1)) <= 2 by A91;
        hence F.(k+1) is unfolded by SPPOL_2:27;
      end;
      suppose
A331:   k > 1;
        set m = k-'1;
A332:   1 <= m by A331,NAT_D:49;
A333:   m+1 = k by A331,XREAL_1:237;
A334:   len(F.k) = k by A91;
        then consider i1,j1,i2,j2 being Element of NAT such that
A335:   [i1,j1] in Indices G & (F.k)/.m = G*(i1,j1) and
A336:   [i2,j2] in Indices G & (F.k)/.len(F.k) = G*(i2,j2) and
A337:   i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
        i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A330,A332,A333,JORDAN8:6;
A338:   1 <= i1 & i1 <= len G & 1 <= j1 & j1 <= width G by A335,MATRIX_1:39;
A339:   1 <= i2 & i2 <= len G & 1 <= j2 & j2 <= width G by A336,MATRIX_1:39;
        then
A340:   (i2-'1)+1 = i2 by XREAL_1:237;
A341:   (j2-'1)+1 = j2 by A339,XREAL_1:237;
A342:   LSeg(F.k,m) = LSeg(G*(i1,j1),G*(i2,j2)) by A332,A333,A334,A335,A336,
TOPREAL1:def 5;
        now per cases;
          suppose
A343:       front_right_cell(F.k,(len(F.k))-'1,G) misses C &
            front_left_cell(F.k,(len(F.k))-'1,G) misses C;
            now per cases by A337;
              suppose
A344:           i1 = i2 & j1+1 = j2;
                then
A345:           [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^ <*G*(i2-'1,j2)*>
                by A248,A331,A334,A335,A336,A343;
                then 1 <= i2-'1 by MATRIX_1:39;
                then LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G*(i2-'1,j2)) =
                {(F.k)/.len(F.k)}
                by A336,A338,A339,A340,A342,A344,GOBOARD7:18;
                hence F.(k+1) is unfolded by A329,A333,A334,A345,SPPOL_2:31;
              end;
              suppose
A346:           i1+1 = i2 & j1 = j2;
                then
A347:           [i2,j2+1] in Indices G & F.(k+1) = (F.k)^ <*G*(i2,j2+1)*>
                by A248,A331,A334,A335,A336,A343;
                then j2+1 <= width G &

LSeg((F.k)/.len(F.k),G*(i2,j2+1))=LSeg(G*(i2,j2+1),(F.k)/.len(F.k))
                by MATRIX_1:39;

then LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G*(i2,j2+1)) = {(F.k)/.len(F .k)}
                by A336,A338,A339,A342,A346,GOBOARD7:20;
                hence F.(k+1) is unfolded by A329,A333,A334,A347,SPPOL_2:31;
              end;
              suppose
A348:           i1 = i2+1 & j1 = j2;
                then
A349:           [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^ <*G*(i2,j2-'1)*>
                by A248,A331,A334,A335,A336,A343;
                then 1 <= j2-'1 by MATRIX_1:39;
                then LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G*(i2,j2-'1)) =
                {(F.k)/.len(F.k)}
                by A336,A338,A339,A341,A342,A348,GOBOARD7:17;
                hence F.(k+1) is unfolded by A329,A333,A334,A349,SPPOL_2:31;
              end;
              suppose
A350:           i1 = i2 & j1 = j2+1;
                then
A351:           [i2+1,j2] in Indices G & F.(k+1) = (F.k)^ <*G*(i2+1,j2)*>
                by A248,A331,A334,A335,A336,A343;
                then i2+1 <= len G by MATRIX_1:39;

then LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G*(i2+1,j2)) = {(F.k)/.len(F .k)}
                by A336,A338,A339,A342,A350,GOBOARD7:19;
                hence F.(k+1) is unfolded by A329,A333,A334,A351,SPPOL_2:31;
              end;
            end;
            hence F.(k+1) is unfolded;
          end;
          suppose
A352:       front_right_cell(F.k,(len(F.k))-'1,G) misses C &
            front_left_cell(F.k,(len(F.k))-'1,G) meets C;
            now per cases by A337;
              suppose
A353:           i1 = i2 & j1+1 = j2;
                then
A354:           [i2,j2+1] in Indices G & F.(k+1) = (F.k)^ <*G*(i2,j2+1)*>
                by A265,A331,A334,A335,A336,A352;
                then 1 <= j2+1 & j2+1 <= width G & j2+1 = j1+(1+1)
                by A353,MATRIX_1:39;

then LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G*(i2,j2+1)) = {(F.k)/.len(F .k)}
                by A336,A338,A342,A353,GOBOARD7:15;
                hence F.(k+1) is unfolded by A329,A333,A334,A354,SPPOL_2:31;
              end;
              suppose
A355:           i1+1 = i2 & j1 = j2;
                then
A356:           [i2+1,j2] in Indices G & F.(k+1) = (F.k)^ <*G*(i2+1,j2)*>
                by A265,A331,A334,A335,A336,A352;
                then 1 <= i2+1 & i2+1 <= len G & i2+1 = i1+(1+1)
                by A355,MATRIX_1:39;

then LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G*(i2+1,j2)) = {(F.k)/.len(F .k)}
                by A336,A338,A342,A355,GOBOARD7:16;
                hence F.(k+1) is unfolded by A329,A333,A334,A356,SPPOL_2:31;
              end;
              suppose
A357:           i1 = i2+1 & j1 = j2;
                then
A358:           [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^ <*G*(i2-'1,j2)*>
                by A265,A331,A334,A335,A336,A352;
                then 1 <= i2-'1 & i2-'1+1+1 = i2-'1+(1+1) by MATRIX_1:39;
                then LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G*(i2-'1,j2)) =
                {(F.k)/.len(F.k)} by A336,A338,A340,A342,A357,GOBOARD7:16;
                hence F.(k+1) is unfolded by A329,A333,A334,A358,SPPOL_2:31;
              end;
              suppose
A359:           i1 = i2 & j1 = j2+1;
                then
A360:           [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^ <*G*(i2,j2-'1)*>
                by A265,A331,A334,A335,A336,A352;
                then 1 <= j2-'1 & j2-'1+1+1 = j2-'1+(1+1) by MATRIX_1:39;
                then LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G*(i2,j2-'1)) =
                {(F.k)/.len(F.k)} by A336,A338,A341,A342,A359,GOBOARD7:15;
                hence F.(k+1) is unfolded by A329,A333,A334,A360,SPPOL_2:31;
              end;
            end;
            hence F.(k+1) is unfolded;
          end;
          suppose
A361:       front_right_cell(F.k,(len(F.k))-'1,G) meets C;
            now per cases by A337;
              suppose
A362:           i1 = i2 & j1+1 = j2;
                then
A363:           [i2+1,j2] in Indices G & F.(k+1) = (F.k)^ <*G*(i2+1,j2)*>
                by A282,A331,A334,A335,A336,A361;
                then i2+1 <= len G by MATRIX_1:39;

then LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G*(i2+1,j2)) = {(F.k)/.len(F .k)}
                by A336,A338,A339,A342,A362,GOBOARD7:17;
                hence F.(k+1) is unfolded by A329,A333,A334,A363,SPPOL_2:31;
              end;
              suppose
A364:           i1+1 = i2 & j1 = j2;
                then
A365:           [i2,j2-'1] in Indices G & F.(k+1) = (F.k)^ <*G*(i2,j2-'1)*>
                by A282,A331,A334,A335,A336,A361;
                then 1 <= j2-'1 by MATRIX_1:39;
                then LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G*(i2,j2-'1)) =
                {(F.k)/.len(F.k)}
                by A336,A338,A339,A341,A342,A364,GOBOARD7:18;
                hence F.(k+1) is unfolded by A329,A333,A334,A365,SPPOL_2:31;
              end;
              suppose
A366:           i1 = i2+1 & j1 = j2;
                then
A367:           [i2,j2+1] in Indices G & F.(k+1) = (F.k)^ <*G*(i2,j2+1)*>
                by A282,A331,A334,A335,A336,A361;
                then j2+1 <= width G by MATRIX_1:39;

then LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G*(i2,j2+1)) = {(F.k)/.len(F .k)}
                by A336,A338,A339,A342,A366,GOBOARD7:19;
                hence F.(k+1) is unfolded by A329,A333,A334,A367,SPPOL_2:31;
              end;
              suppose
A368:           i1 = i2 & j1 = j2+1;
                then
A369:           [i2-'1,j2] in Indices G & F.(k+1) = (F.k)^ <*G*(i2-'1,j2)*>
                by A282,A331,A334,A335,A336,A361;
                then 1 <= i2-'1 by MATRIX_1:39;
                then LSeg(F.k,m) /\ LSeg((F.k)/.len(F.k),G*(i2-'1,j2)) =
                {(F.k)/.len(F.k)}
                by A336,A338,A339,A340,A342,A368,GOBOARD7:20;
                hence F.(k+1) is unfolded by A329,A333,A334,A369,SPPOL_2:31;
              end;
            end;
            hence F.(k+1) is unfolded;
          end;
        end;
        hence F.(k+1) is unfolded;
      end;
    end;
A370: for k holds P[k] from NAT_1:sch 1(A327,A328);
    defpred K[Nat] means ex w being Element of NAT st w = $1 & $1 >= 1 &
    ex m st m in dom(F.w) & m <> len(F.w) & (F.w)/.m = (F.w)/.len(F.w);
    now
      assume
A371: for k st k >= 1 holds for m st m in dom(F.k) & m <> len(F.k)
      holds (F.k)/.m <> (F.k)/.len(F.k);
      defpred P[Element of NAT] means F.$1 is one-to-one;
A372: P[0] by A76;
A373: for k st P[k] holds P[k+1]
      proof
        let k;
        assume
A374:   F.k is one-to-one;
        now
          let n,m such that
A375:     n in dom(F.(k+1)) & m in dom(F.(k+1)) and
A376:     (F.(k+1))/.n = (F.(k+1))/.m;
          consider i,j such that [i,j] in Indices G and
A377:     F.(k+1) = (F.k)^<*G*(i,j)*> by A299;
A378:     1 <= n & n <= len(F.(k+1)) & 1 <= m & m <= len(F.(k+1))
          by A375,FINSEQ_3:27;
A379:     len(F.k) = k & len(F.(k+1)) = k+1 by A91;
          per cases by A378,A379,NAT_1:8;
          suppose n <= k & m <= k;
            then
A380:       n in dom(F.k) & m in dom(F.k) by A378,A379,FINSEQ_3:27;
            then (F.(k+1))/.n = (F.k)/.n & (F.(k+1))/.m = (F.k)/.m
            by A377,FINSEQ_4:83;
            hence n = m by A374,A376,A380,PARTFUN2:17;
          end;
          suppose n = k+1 & m <= k;
            hence n = m by A371,A375,A376,A379,NAT_1:12;
          end;
          suppose n <= k & m = k+1;
            hence n = m by A371,A375,A376,A379,NAT_1:12;
          end;
          suppose n = k+1 & m = k+1;
            hence n = m;
          end;
        end;
        hence F.(k+1) is one-to-one by PARTFUN2:16;
      end;
A381: for k holds P[k] from NAT_1:sch 1(A372,A373);
A382: for k holds card rng(F.k) = k
      proof
        let k;
        F.k is one-to-one by A381;
        hence card rng(F.k) = len(F.k) by FINSEQ_4:77
          .= k by A91;
      end;
      reconsider k = (len G)*(width G)+1 as Element of NAT;
A383: k > (len G)*(width G) by NAT_1:13;
A384: card Values G <= (len G)*(width G) by GOBRD13:8;
      F.k is_sequence_on G by A245;
      then card rng(F.k) <= card Values G by GOBRD13:9,NAT_1:44;
      then card rng(F.k) <= (len G)*(width G) by A384,XXREAL_0:2;
      hence contradiction by A382,A383;
    end;
    then
A385: ex k be Nat st K[k];
    consider k be Nat such that
A386: K[k] and
A387: for l be Nat st K[l] holds k <= l from NAT_1:sch 5(A385);
    reconsider k as Element of NAT by ORDINAL1:def 13;
    consider w being Element of NAT such that
A388: w = k and k >= 1 and
A389: ex m st m in dom(F.w) & m <> len(F.w) &
    (F.w)/.m = (F.w)/.len(F.w) by A386;
    consider m such that
A390: m in dom(F.k) and
A391: m <> len(F.k) and
A392: (F.k)/.m = (F.k)/.len(F.k) by A388,A389;
A393: len(F.k) = k by A91;
    reconsider f = F.k as non empty FinSequence of TOP-REAL 2 by A386;
A394: f is_sequence_on G by A245;
A395: 1 <= m & m <= len f by A390,FINSEQ_3:27;
    then
A396: m < len f by A391,XXREAL_0:1;
    then 1 < len f by A395,XXREAL_0:2;
    then
A397: len f >= 1+1 by NAT_1:13;
    then
A398: k >= 2 by A91;
    reconsider f as non constant special unfolded non empty
    FinSequence of TOP-REAL 2 by A370,A394,A397,JORDAN8:7,8;
    set g = f/^(m-'1);
A399: m+1 <= len f by A396,NAT_1:13;
    m-'1 <= m & m < m+1 by NAT_1:13,NAT_D:44;
    then m-'1 < m+1 by XXREAL_0:2;
    then
A400: m-'1 < len f by A399,XXREAL_0:2;
    then
A401: len g = len f - (m-'1) by RFINSEQ:def 2;
    then (m-'1)-(m-'1) < len g by A400,XREAL_1:11;
    then reconsider g as non empty FinSequence of TOP-REAL 2
     by CARD_1:47;
    1 in dom g by FINSEQ_5:6;
    then
A402: g/.1 = f/.(m-'1+1) by FINSEQ_5:30
      .= f/.m by A395,XREAL_1:237;
    len g in dom g by FINSEQ_5:6;
    then
A403: g/.len g = f/.(m-'1+len g) by FINSEQ_5:30
      .= f/.len f by A401;
A404: g is_sequence_on G by A394,JORDAN8:5;
    then
A405: g is standard by JORDAN8:7;
A406: for i st 1 <= i & i < len g & 1 <= j & j < len g & g/.i = g/.j
    holds i = j
    proof
      let i such that
A407: 1 <= i & i < len g and
A408: 1 <= j & j < len g and
A409: g/.i = g/.j and
A410: i <> j;
A411: i in dom g by A407,FINSEQ_3:27;
      then
A412: g/.i = f/.(m-'1+i) by FINSEQ_5:30;
A413: j in dom g by A408,FINSEQ_3:27;
      then
A414: g/.j = f/.(m-'1+j) by FINSEQ_5:30;
      per cases by A410,XXREAL_0:1;
      suppose
A415:   i < j;
        set l = m-'1+j, m'= m-'1+i;
A416:   m' < l by A415,XREAL_1:8;
A417:   l < k by A393,A401,A408,XREAL_1:22;
        then
A418:   f|l = F.l by A321;
        0+j <= l by XREAL_1:8;
        then
A419:   1 <= l by A408,XXREAL_0:2;
A420:   len(F.l) = l by A91;
        0+i <= m' by XREAL_1:8;
        then 1 <= m' by A407,XXREAL_0:2;
        then
A421:   m' in dom(F.l) by A416,A420,FINSEQ_3:27;
        then
A422:   (F.l)/.m' = f/.m' by A418,FINSEQ_4:85;
        l in dom(F.l) by A419,A420,FINSEQ_3:27;
        then (F.l)/.l = f/.l by A418,FINSEQ_4:85;

hence contradiction by A387,A409,A412,A413,A416,A417,A419,A420,A421,A422,
FINSEQ_5:30;
      end;
      suppose
A423:   j < i;
        set l = m-'1+i, m'= m-'1+j;
A424:   m' < l by A423,XREAL_1:8;
A425:   l < k by A393,A401,A407,XREAL_1:22;
        then
A426:   f|l = F.l by A321;
        0+i <= l by XREAL_1:8;
        then
A427:   1 <= l by A407,XXREAL_0:2;
A428:   len(F.l) = l by A91;
        0+j <= m' by XREAL_1:8;
        then 1 <= m' by A408,XXREAL_0:2;
        then
A429:   m' in dom(F.l) by A424,A428,FINSEQ_3:27;
        then
A430:   (F.l)/.m' = f/.m' by A426,FINSEQ_4:85;
        l in dom(F.l) by A427,A428,FINSEQ_3:27;
        then (F.l)/.l = f/.l by A426,FINSEQ_4:85;

hence contradiction by A387,A409,A411,A414,A424,A425,A427,A428,A429,A430,
FINSEQ_5:30;
      end;
    end;
A431: for i st 1 < i & i < j & j <= len g holds g/.i <> g/.j
    proof
      let i such that
A432: 1 < i and
A433: i < j and
A434: j <= len g and
A435: g/.i = g/.j;
A436: 1 < j by A432,A433,XXREAL_0:2;
A437: i < len g by A433,A434,XXREAL_0:2;
      then
A438: 1 < len g by A432,XXREAL_0:2;
      per cases;
      suppose j <> len g;
        then j < len g by A434,XXREAL_0:1;
        hence contradiction by A406,A432,A433,A435,A436,A437;
      end;
      suppose j = len g;
        hence contradiction by A392,A402,A403,A406,A432,A433,A435,A438;
      end;
    end;
A439: for i st 1 <= i & i < j & j < len g holds g/.i <> g/.j
    proof
      let i such that
A440: 1 <= i and
A441: i < j and
A442: j < len g and
A443: g/.i = g/.j;
A444: 1 < j by A440,A441,XXREAL_0:2;
      i < len g by A441,A442,XXREAL_0:2;
      hence contradiction by A406,A440,A441,A442,A443,A444;
    end;
A445: for i st 1 <= i & i+1 <= len f
    holds left_cell(f,i,G) = Cl Int left_cell(f,i,G)
    proof
      let i such that
A446: 1 <= i & i+1 <= len f;
      consider i1,j1,i2,j2 such that
A447: [i1,j1] in Indices G and
A448: f/.i = G*(i1,j1) and
A449: [i2,j2] in Indices G and
A450: f/.(i+1) = G*(i2,j2) and
A451: i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
      i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A394,A446,JORDAN8:6;
A452: 1 <= i1 & i1 <= len G & 1 <= j1 & j1 <= width G by A447,MATRIX_1:39;
A453: 1 <= i2 & i2 <= len G & 1 <= j2 & j2 <= width G by A449,MATRIX_1:39;
A454: i1+1 > i1 & j1+1 > j1 & i2+1 > i2 & j2+1 > j2 by NAT_1:13;
      per cases by A451;
      suppose
A455:   i1 = i2 & j1+1 = j2;
A456:   i1-'1 <= len G by A452,NAT_D:44;
        left_cell(f,i,G) = cell(G,i1-'1,j1)
        by A394,A446,A447,A448,A449,A450,A454,A455,GOBRD13:def 3;
        hence thesis by A452,A456,GOBRD11:35;
      end;
      suppose i1+1 = i2 & j1 = j2;
        then left_cell(f,i,G) = cell(G,i1,j1)
        by A394,A446,A447,A448,A449,A450,A454,GOBRD13:def 3;
        hence thesis by A452,GOBRD11:35;
      end;
      suppose
A457:   i1 = i2+1 & j1 = j2;
A458:   j2-'1 <= width G by A453,NAT_D:44;
        left_cell(f,i,G) = cell(G,i2,j2-'1)
        by A394,A446,A447,A448,A449,A450,A454,A457,GOBRD13:def 3;
        hence thesis by A453,A458,GOBRD11:35;
      end;
      suppose i1 = i2 & j1 = j2+1;
        then left_cell(f,i,G) = cell(G,i1,j2)
        by A394,A446,A447,A448,A449,A450,A454,GOBRD13:def 3;
        hence thesis by A452,A453,GOBRD11:35;
      end;
    end;
A459: g is s.c.c.
    proof
      let i,j such that
A460: i+1 < j and
A461: i > 1 & j < len g or j+1 < len g;
A462: j <= j+1 by NAT_1:12;
      then
A463: i+1 < j+1 by A460,XXREAL_0:2;
A464: 1 <= i+1 by NAT_1:12;
A465: 1 < j by A460,NAT_1:12;
      i < j by A460,NAT_1:13;
      then
A466: i < j+1 by A462,XXREAL_0:2;
      per cases by A461,NAT_1:14;
      suppose
A467:   i > 1 & j < len g;
        then
A468:   i+1 < len g by A460,XXREAL_0:2;
        then
A469:   LSeg(g,i) = LSeg(g/.i,g/.(i+1)) by A467,TOPREAL1:def 5;
A470:   1 < i+1 by A467,NAT_1:13;
A471:   i < len g by A468,NAT_1:13;
        consider i1,j1,i2,j2 such that
A472:   [i1,j1] in Indices G and
A473:   g/.i = G*(i1,j1) and
A474:   [i2,j2] in Indices G and
A475:   g/.(i+1) = G*(i2,j2) and
A476:   i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
        i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A404,A467,A468,JORDAN8:6;
A477:   1 <= i1 & i1 <= len G & 1 <= j1 & j1 <= width G by A472,MATRIX_1:39;
A478:   1 <= i2 & i2 <= len G & 1 <= j2 & j2 <= width G by A474,MATRIX_1:39;
A479:   j+1 <= len g by A467,NAT_1:13;
        then
A480:   LSeg(g,j) = LSeg(g/.j,g/.(j+1)) by A465,TOPREAL1:def 5;
        consider i1',j1',i2',j2' being Element of NAT such that
A481:   [i1',j1'] in Indices G and
A482:   g/.j = G*(i1',j1') and
A483:   [i2',j2'] in Indices G and
A484:   g/.(j+1) = G*(i2',j2') and
A485:   i1' = i2' & j1'+1 = j2' or i1'+1 = i2' & j1' = j2' or
        i1' = i2'+1 & j1' = j2' or i1' = i2' & j1' = j2'+1
        by A404,A465,A479,JORDAN8:6;
A486:   1 <= i1' & i1' <= len G & 1 <= j1' & j1' <= width G
 by A481,MATRIX_1:39;
A487:   1 <= i2' & i2' <= len G & 1 <= j2' & j2' <= width G
 by A483,MATRIX_1:39;
        assume LSeg(g,i) /\ LSeg(g,j) <> {};
        then
A488:   LSeg(g,i) meets LSeg(g,j) by XBOOLE_0:def 7;
        now per cases by A476,A485;
          suppose
A489:       i1 = i2 & j1+1 = j2 & i1' = i2' & j1'+1 = j2';
            then
A490:       i1 = i1' by A469,A473,A475,A477,A478,A480,A482,A484,A486,A487,A488,
GOBOARD7:21;
            now per cases by A469,A473,A475,A477,A478,A480,A482,A484,A486,A487
,A488,A489,GOBOARD7:24;
              suppose j1 = j1';

hence contradiction by A406,A460,A462,A465,A467,A471,A473,A482,A490;
              end;
              suppose j1 = j1'+1;
                hence contradiction by A431,A466,A467,A473,A479,A484,A489,A490;
              end;
              suppose j1+1 = j1';

hence contradiction by A406,A460,A464,A465,A467,A468,A475,A482,A489,A490;
              end;
            end;
            hence contradiction;
          end;
          suppose
A491:       i1 = i2 & j1+1 = j2 & i1'+1 = i2' & j1' = j2';
            now per cases by A469,A473,A475,A477,A478,A480,A482,A484,A486,A487
,A488,A491,GOBOARD7:23;
              suppose i1 = i1' & j1 = j1';
                hence contradiction by A406,A460,A462,A465,A467,A471,A473,A482;
              end;
              suppose i1 = i1' & j1+1 = j1';
                hence contradiction by A431,A460,A467,A470,A475,A482,A491;
              end;
              suppose i1 = i1'+1 & j1 = j1';
                hence contradiction by A431,A466,A467,A473,A479,A484,A491;
              end;
              suppose i1 = i1'+1 & j1+1 = j1';
                hence contradiction by A431,A463,A470,A475,A479,A484,A491;
              end;
            end;
            hence contradiction;
          end;
          suppose
A492:       i1 = i2 & j1+1 = j2 & i1' = i2'+1 & j1' = j2';
            now per cases by A469,A473,A475,A477,A478,A480,A482,A484,A486,A487
,A488,A492,GOBOARD7:23;
              suppose i1 = i2' & j1' = j1;
                hence contradiction by A431,A466,A467,A473,A479,A484,A492;
              end;
              suppose i1 = i2' & j1+1 = j1';
                hence contradiction by A431,A463,A470,A475,A479,A484,A492;
              end;
              suppose i1 = i2'+1 & j1' = j1;

hence contradiction by A406,A460,A462,A465,A467,A471,A473,A482,A492;
              end;
              suppose i1 = i2'+1 & j1+1 = j1';

hence contradiction by A406,A460,A464,A465,A467,A468,A475,A482,A492;
              end;
            end;
            hence contradiction;
          end;
          suppose
A493:       i1 = i2 & j1+1 = j2 & i1' = i2' & j1' = j2'+1;
            then
A494:       i1 = i1' by A469,A473,A475,A477,A478,A480,A482,A484,A486,A487,A488,
GOBOARD7:21;
            now per cases by A469,A473,A475,A477,A478,A480,A482,A484,A486,A487
,A488,A493,GOBOARD7:24;
              suppose j1 = j2';

hence contradiction by A406,A460,A464,A465,A467,A468,A475,A482,A493,A494;
              end;
              suppose j1 = j2'+1;

hence contradiction by A406,A460,A462,A465,A467,A471,A473,A482,A493,A494;
              end;
              suppose j1+1 = j2';
                hence contradiction by A431,A463,A470,A475,A479,A484,A493,A494;
              end;
            end;
            hence contradiction;
          end;
          suppose
A495:       i1+1 = i2 & j1 = j2 & i1' = i2' & j1'+1 = j2';
            now per cases by A469,A473,A475,A477,A478,A480,A482,A484,A486,A487
,A488,A495,GOBOARD7:23;
              suppose i1' = i1 & j1 = j1';
                hence contradiction by A406,A460,A462,A465,A467,A471,A473,A482;
              end;
              suppose i1' = i1 & j1'+1 = j1;
                hence contradiction by A431,A466,A467,A473,A479,A484,A495;
              end;
              suppose i1' = i1+1 & j1 = j1';

hence contradiction by A406,A460,A464,A465,A467,A468,A475,A482,A495;
              end;
              suppose i1' = i1+1 & j1'+1 = j1;
                hence contradiction by A431,A463,A470,A475,A479,A484,A495;
              end;
            end;
            hence contradiction;
          end;
          suppose
A496:       i1+1 = i2 & j1 = j2 & i1'+1 = i2' & j1' = j2';
            then
A497:       j1 = j1' by A469,A473,A475,A477,A478,A480,A482,A484,A486,A487,A488,
GOBOARD7:22;
            now per cases by A469,A473,A475,A477,A478,A480,A482,A484,A486,A487
,A488,A496,GOBOARD7:25;
              suppose i1 = i1';

hence contradiction by A406,A460,A462,A465,A467,A471,A473,A482,A497;
              end;
              suppose i1 = i1'+1;
                hence contradiction by A431,A466,A467,A473,A479,A484,A496,A497;
              end;
              suppose i1+1 = i1';

hence contradiction by A406,A460,A464,A465,A467,A468,A475,A482,A496,A497;
              end;
            end;
            hence contradiction;
          end;
          suppose
A498:       i1+1 = i2 & j1 = j2 & i1' = i2'+1 & j1' = j2';
            then
A499:       j1 = j1' by A469,A473,A475,A477,A478,A480,A482,A484,A486,A487,A488,
GOBOARD7:22;
            now per cases by A469,A473,A475,A477,A478,A480,A482,A484,A486,A487
,A488,A498,GOBOARD7:25;
              suppose i1 = i2';
                hence contradiction by A431,A466,A467,A473,A479,A484,A498,A499;
              end;
              suppose i1 = i2'+1;

hence contradiction by A406,A460,A462,A465,A467,A471,A473,A482,A498,A499;
              end;
              suppose i1+1 = i2';
                hence contradiction by A431,A463,A470,A475,A479,A484,A498,A499;
              end;
            end;
            hence contradiction;
          end;
          suppose
A500:       i1+1 = i2 & j1 = j2 & i1' = i2' & j1' = j2'+1;
            now per cases by A469,A473,A475,A477,A478,A480,A482,A484,A486,A487
,A488,A500,GOBOARD7:23;
              suppose i1' = i1 & j1 = j2';
                hence contradiction by A431,A466,A467,A473,A479,A484,A500;
              end;
              suppose i1' = i1 & j2'+1 = j1;

hence contradiction by A406,A460,A462,A465,A467,A471,A473,A482,A500;
              end;
              suppose i1' = i1+1 & j1 = j2';
                hence contradiction by A431,A463,A470,A475,A479,A484,A500;
              end;
              suppose i1' = i1+1 & j2'+1 = j1;

hence contradiction by A406,A460,A464,A465,A467,A468,A475,A482,A500;
              end;
            end;
            hence contradiction;
          end;
          suppose
A501:       i1 = i2+1 & j1 = j2 & i1' = i2' & j1'+1 = j2';
            now per cases by A469,A473,A475,A477,A478,A480,A482,A484,A486,A487
,A488,A501,GOBOARD7:23;
              suppose i1' = i2 & j1' = j1;

hence contradiction by A406,A460,A464,A465,A467,A468,A475,A482,A501;
              end;
              suppose i1' = i2 & j1'+1 = j1;
                hence contradiction by A431,A463,A470,A475,A479,A484,A501;
              end;
              suppose i1' = i2+1 & j1' = j1;

hence contradiction by A406,A460,A462,A465,A467,A471,A473,A482,A501;
              end;
              suppose i1' = i2+1 & j1'+1 = j1;
                hence contradiction by A431,A466,A467,A473,A479,A484,A501;
              end;
            end;
            hence contradiction;
          end;
          suppose
A502:       i1 = i2+1 & j1 = j2 & i1'+1 = i2' & j1' = j2';
            then
A503:       j1 = j1' by A469,A473,A475,A477,A478,A480,A482,A484,A486,A487,A488,
GOBOARD7:22;
            now per cases by A469,A473,A475,A477,A478,A480,A482,A484,A486,A487
,A488,A502,GOBOARD7:25;
              suppose i2 = i1';

hence contradiction by A406,A460,A464,A465,A467,A468,A475,A482,A502,A503;
              end;
              suppose i2 = i1'+1;
                hence contradiction by A431,A463,A470,A475,A479,A484,A502,A503;
              end;
              suppose i2+1 = i1';

hence contradiction by A406,A460,A462,A465,A467,A471,A473,A482,A502,A503;
              end;
            end;
            hence contradiction;
          end;
          suppose
A504:       i1 = i2+1 & j1 = j2 & i1' = i2'+1 & j1' = j2';
            then
A505:       j1 = j1' by A469,A473,A475,A477,A478,A480,A482,A484,A486,A487,A488,
GOBOARD7:22;
            now per cases by A469,A473,A475,A477,A478,A480,A482,A484,A486,A487
,A488,A504,GOBOARD7:25;
              suppose i2 = i2';
                hence contradiction by A431,A463,A470,A475,A479,A484,A504,A505;
              end;
              suppose i2 = i2'+1;

hence contradiction by A406,A460,A464,A465,A467,A468,A475,A482,A504,A505;
              end;
              suppose i2+1 = i2';
                hence contradiction by A431,A466,A467,A473,A479,A484,A504,A505;
              end;
            end;
            hence contradiction;
          end;
          suppose
A506:       i1 = i2+1 & j1 = j2 & i1' = i2' & j1' = j2'+1;
            now per cases by A469,A473,A475,A477,A478,A480,A482,A484,A486,A487
,A488,A506,GOBOARD7:23;
              suppose i1' = i2 & j2' = j1;
                hence contradiction by A431,A463,A470,A475,A479,A484,A506;
              end;
              suppose i1' = i2 & j2'+1 = j1;

hence contradiction by A406,A460,A464,A465,A467,A468,A475,A482,A506;
              end;
              suppose i1' = i2+1 & j2' = j1;
                hence contradiction by A431,A466,A467,A473,A479,A484,A506;
              end;
              suppose i1' = i2+1 & j2'+1 = j1;

hence contradiction by A406,A460,A462,A465,A467,A471,A473,A482,A506;
              end;
            end;
            hence contradiction;
          end;
          suppose
A507:       i1 = i2 & j1 = j2+1 & i1' = i2' & j1'+1 = j2';
            then
A508:       i1 = i1' by A469,A473,A475,A477,A478,A480,A482,A484,A486,A487,A488,
GOBOARD7:21;
            now per cases by A469,A473,A475,A477,A478,A480,A482,A484,A486,A487
,A488,A507,GOBOARD7:24;
              suppose j2 = j1';

hence contradiction by A406,A460,A464,A465,A467,A468,A475,A482,A507,A508;
              end;
              suppose j2 = j1'+1;
                hence contradiction by A431,A463,A470,A475,A479,A484,A507,A508;
              end;
              suppose j2+1 = j1';

hence contradiction by A406,A460,A462,A465,A467,A471,A473,A482,A507,A508;
              end;
            end;
            hence contradiction;
          end;
          suppose
A509:       i1 = i2 & j1 = j2+1 & i1'+1 = i2' & j1' = j2';
            now per cases by A469,A473,A475,A477,A478,A480,A482,A484,A486,A487
,A488,A509,GOBOARD7:23;
              suppose i1 = i1' & j2 = j1';

hence contradiction by A406,A460,A464,A465,A467,A468,A475,A482,A509;
              end;
              suppose i1 = i1' & j2+1 = j1';

hence contradiction by A406,A460,A462,A465,A467,A471,A473,A482,A509;
              end;
              suppose i1 = i1'+1 & j2 = j1';
                hence contradiction by A431,A463,A470,A475,A479,A484,A509;
              end;
              suppose i1 = i1'+1 & j2+1 = j1';
                hence contradiction by A431,A466,A467,A473,A479,A484,A509;
              end;
            end;
            hence contradiction;
          end;
          suppose
A510:       i1 = i2 & j1 = j2+1 & i1' = i2'+1 & j1' = j2';
            now per cases by A469,A473,A475,A477,A478,A480,A482,A484,A486,A487
,A488,A510,GOBOARD7:23;
              suppose i1 = i2' & j2 = j1';
                hence contradiction by A431,A463,A470,A475,A479,A484,A510;
              end;
              suppose i1 = i2' & j2+1 = j1';
                hence contradiction by A431,A466,A467,A473,A479,A484,A510;
              end;
              suppose i1 = i2'+1 & j2 = j1';

hence contradiction by A406,A460,A464,A465,A467,A468,A475,A482,A510;
              end;
              suppose i1 = i2'+1 & j2+1 = j1';

hence contradiction by A406,A460,A462,A465,A467,A471,A473,A482,A510;
              end;
            end;
            hence contradiction;
          end;
          suppose
A511:       i1 = i2 & j1 = j2+1 & i1' = i2' & j1' = j2'+1;
            then
A512:       i1 = i1' by A469,A473,A475,A477,A478,A480,A482,A484,A486,A487,A488,
GOBOARD7:21;
            now per cases by A469,A473,A475,A477,A478,A480,A482,A484,A486,A487
,A488,A511,GOBOARD7:24;
              suppose j2 = j2';
                hence contradiction by A431,A463,A470,A475,A479,A484,A511,A512;
              end;
              suppose j2 = j2'+1;

hence contradiction by A406,A460,A464,A465,A467,A468,A475,A482,A511,A512;
              end;
              suppose j2+1 = j2';
                hence contradiction by A431,A466,A467,A473,A479,A484,A511,A512;
              end;
            end;
            hence contradiction;
          end;
        end;
        hence contradiction;
      end;
      suppose i = 0 & j+1 < len g;
        then LSeg(g,i) = {} by TOPREAL1:def 5;
        hence LSeg(g,i) /\ LSeg(g,j) = {};
      end;
      suppose
A513:   1 <= i & j+1 < len g;
        then
A514:   i+1 < len g by A463,XXREAL_0:2;
        then
A515:   LSeg(g,i) = LSeg(g/.i,g/.(i+1)) by A513,TOPREAL1:def 5;
A516:   1 < i+1 by A513,NAT_1:13;
A517:   i < len g by A514,NAT_1:13;
A518:   j < len g by A513,NAT_1:12;
        consider i1,j1,i2,j2 such that
A519:   [i1,j1] in Indices G and
A520:   g/.i = G*(i1,j1) and
A521:   [i2,j2] in Indices G and
A522:   g/.(i+1) = G*(i2,j2) and
A523:   i1 = i2 & j1+1 = j2 or i1+1 = i2 & j1 = j2 or
        i1 = i2+1 & j1 = j2 or i1 = i2 & j1 = j2+1 by A404,A513,A514,JORDAN8:6;
A524:   1 <= i1 & i1 <= len G & 1 <= j1 & j1 <= width G by A519,MATRIX_1:39;
A525:   1 <= i2 & i2 <= len G & 1 <= j2 & j2 <= width G by A521,MATRIX_1:39;
A526:   LSeg(g,j) = LSeg(g/.j,g/.(j+1)) by A465,A513,TOPREAL1:def 5;
        consider i1',j1',i2',j2' being Element of NAT such that
A527:   [i1',j1'] in Indices G and
A528:   g/.j = G*(i1',j1') and
A529:   [i2',j2'] in Indices G and
A530:   g/.(j+1) = G*(i2',j2') and
A531:   i1' = i2' & j1'+1 = j2' or i1'+1 = i2' & j1' = j2' or
        i1' = i2'+1 & j1' = j2' or i1' = i2' & j1' = j2'+1
        by A404,A465,A513,JORDAN8:6;
A532:   1 <= i1' & i1' <= len G & 1 <= j1' & j1' <= width G
 by A527,MATRIX_1:39;
A533:   1 <= i2' & i2' <= len G & 1 <= j2' & j2' <= width G
 by A529,MATRIX_1:39;
        assume LSeg(g,i) /\ LSeg(g,j) <> {};
        then
A534:   LSeg(g,i) meets LSeg(g,j) by XBOOLE_0:def 7;
        now per cases by A523,A531;
          suppose
A535:       i1 = i2 & j1+1 = j2 & i1' = i2' & j1'+1 = j2';
            then
A536:       i1 = i1' by A515,A520,A522,A524,A525,A526,A528,A530,A532,A533,A534,
GOBOARD7:21;
            now per cases by A515,A520,A522,A524,A525,A526,A528,A530,A532,A533
,A534,A535,GOBOARD7:24;
              suppose j1 = j1';

hence contradiction by A406,A460,A462,A465,A513,A517,A518,A520,A528,A536;
              end;
              suppose j1 = j1'+1;
                hence contradiction by A439,A466,A513,A520,A530,A535,A536;
              end;
              suppose j1+1 = j1';

hence contradiction by A406,A460,A464,A465,A514,A518,A522,A528,A535,A536;
              end;
            end;
            hence contradiction;
          end;
          suppose
A537:       i1 = i2 & j1+1 = j2 & i1'+1 = i2' & j1' = j2';
            now per cases by A515,A520,A522,A524,A525,A526,A528,A530,A532,A533
,A534,A537,GOBOARD7:23;
              suppose i1 = i1' & j1 = j1';

hence contradiction by A406,A460,A462,A465,A513,A517,A518,A520,A528;
              end;
              suppose i1 = i1' & j1+1 = j1';
                hence contradiction by A431,A460,A516,A518,A522,A528,A537;
              end;
              suppose i1 = i1'+1 & j1 = j1';
                hence contradiction by A439,A466,A513,A520,A530,A537;
              end;
              suppose i1 = i1'+1 & j1+1 = j1';
                hence contradiction by A431,A463,A513,A516,A522,A530,A537;
              end;
            end;
            hence contradiction;
          end;
          suppose
A538:       i1 = i2 & j1+1 = j2 & i1' = i2'+1 & j1' = j2';
            now per cases by A515,A520,A522,A524,A525,A526,A528,A530,A532,A533
,A534,A538,GOBOARD7:23;
              suppose i1 = i2' & j1' = j1;
                hence contradiction by A439,A466,A513,A520,A530,A538;
              end;
              suppose i1 = i2' & j1+1 = j1';
                hence contradiction by A431,A463,A513,A516,A522,A530,A538;
              end;
              suppose i1 = i2'+1 & j1' = j1;

hence contradiction by A406,A460,A462,A465,A513,A517,A518,A520,A528,A538;
              end;
              suppose i1 = i2'+1 & j1+1 = j1';

hence contradiction by A406,A460,A464,A465,A514,A518,A522,A528,A538;
              end;
            end;
            hence contradiction;
          end;
          suppose
A539:       i1 = i2 & j1+1 = j2 & i1' = i2' & j1' = j2'+1;
            then
A540:       i1 = i1' by A515,A520,A522,A524,A525,A526,A528,A530,A532,A533,A534,
GOBOARD7:21;
            now per cases by A515,A520,A522,A524,A525,A526,A528,A530,A532,A533
,A534,A539,GOBOARD7:24;
              suppose j1 = j2';

hence contradiction by A406,A460,A464,A465,A514,A518,A522,A528,A539,A540;
              end;
              suppose j1 = j2'+1;

hence contradiction by A406,A460,A462,A465,A513,A517,A518,A520,A528,A539,A540;
              end;
              suppose j1+1 = j2';
                hence contradiction by A431,A463,A513,A516,A522,A530,A539,A540;
              end;
            end;
            hence contradiction;
          end;
          suppose
A541:       i1+1 = i2 & j1 = j2 & i1' = i2' & j1'+1 = j2';
            now per cases by A515,A520,A522,A524,A525,A526,A528,A530,A532,A533
,A534,A541,GOBOARD7:23;
              suppose i1' = i1 & j1 = j1';

hence contradiction by A406,A460,A462,A465,A513,A517,A518,A520,A528;
              end;
              suppose i1' = i1 & j1'+1 = j1;
                hence contradiction by A439,A466,A513,A520,A530,A541;
              end;
              suppose i1' = i1+1 & j1 = j1';

hence contradiction by A406,A460,A464,A465,A514,A518,A522,A528,A541;
              end;
              suppose i1' = i1+1 & j1'+1 = j1;
                hence contradiction by A431,A463,A513,A516,A522,A530,A541;
              end;
            end;
            hence contradiction;
          end;
          suppose
A542:       i1+1 = i2 & j1 = j2 & i1'+1 = i2' & j1' = j2';
            then
A543:       j1 = j1' by A515,A520,A522,A524,A525,A526,A528,A530,A532,A533,A534,
GOBOARD7:22;
            now per cases by A515,A520,A522,A524,A525,A526,A528,A530,A532,A533
,A534,A542,GOBOARD7:25;
              suppose i1 = i1';

hence contradiction by A406,A460,A462,A465,A513,A517,A518,A520,A528,A543;
              end;
              suppose i1 = i1'+1;
                hence contradiction by A439,A466,A513,A520,A530,A542,A543;
              end;
              suppose i1+1 = i1';

hence contradiction by A406,A460,A464,A465,A514,A518,A522,A528,A542,A543;
              end;
            end;
            hence contradiction;
          end;
          suppose
A544:       i1+1 = i2 & j1 = j2 & i1' = i2'+1 & j1' = j2';
            then
A545:       j1 = j1' by A515,A520,A522,A524,A525,A526,A528,A530,A532,A533,A534,
GOBOARD7:22;
            now per cases by A515,A520,A522,A524,A525,A526,A528,A530,A532,A533
,A534,A544,GOBOARD7:25;
              suppose i1 = i2';
                hence contradiction by A439,A466,A513,A520,A530,A544,A545;
              end;
              suppose i1 = i2'+1;

hence contradiction by A406,A460,A462,A465,A513,A517,A518,A520,A528,A544,A545;
              end;
              suppose i1+1 = i2';
                hence contradiction by A431,A463,A513,A516,A522,A530,A544,A545;
              end;
            end;
            hence contradiction;
          end;
          suppose
A546:       i1+1 = i2 & j1 = j2 & i1' = i2' & j1' = j2'+1;
            now per cases by A515,A520,A522,A524,A525,A526,A528,A530,A532,A533
,A534,A546,GOBOARD7:23;
              suppose i1' = i1 & j1 = j2';
                hence contradiction by A439,A466,A513,A520,A530,A546;
              end;
              suppose i1' = i1 & j2'+1 = j1;

hence contradiction by A406,A460,A462,A465,A513,A517,A518,A520,A528,A546;
              end;
              suppose i1' = i1+1 & j1 = j2';
                hence contradiction by A431,A463,A513,A516,A522,A530,A546;
              end;
              suppose i1' = i1+1 & j2'+1 = j1;

hence contradiction by A406,A460,A464,A465,A514,A518,A522,A528,A546;
              end;
            end;
            hence contradiction;
          end;
          suppose
A547:       i1 = i2+1 & j1 = j2 & i1' = i2' & j1'+1 = j2';
            now per cases by A515,A520,A522,A524,A525,A526,A528,A530,A532,A533
,A534,A547,GOBOARD7:23;
              suppose i1' = i2 & j1' = j1;

hence contradiction by A406,A460,A464,A465,A514,A518,A522,A528,A547;
              end;
              suppose i1' = i2 & j1'+1 = j1;
                hence contradiction by A431,A463,A513,A516,A522,A530,A547;
              end;
              suppose i1' = i2+1 & j1' = j1;

hence contradiction by A406,A460,A462,A465,A513,A517,A518,A520,A528,A547;
              end;
              suppose i1' = i2+1 & j1'+1 = j1;
                hence contradiction by A439,A466,A513,A520,A530,A547;
              end;
            end;
            hence contradiction;
          end;
          suppose
A548:       i1 = i2+1 & j1 = j2 & i1'+1 = i2' & j1' = j2';
            then
A549:       j1 = j1' by A515,A520,A522,A524,A525,A526,A528,A530,A532,A533,A534,
GOBOARD7:22;
            now per cases by A515,A520,A522,A524,A525,A526,A528,A530,A532,A533
,A534,A548,GOBOARD7:25;
              suppose i2 = i1';

hence contradiction by A406,A460,A464,A465,A514,A518,A522,A528,A548,A549;
              end;
              suppose i2 = i1'+1;
                hence contradiction by A431,A463,A513,A516,A522,A530,A548,A549;
              end;
              suppose i2+1 = i1';

hence contradiction by A406,A460,A462,A465,A513,A517,A518,A520,A528,A548,A549;
              end;
            end;
            hence contradiction;
          end;
          suppose
A550:       i1 = i2+1 & j1 = j2 & i1' = i2'+1 & j1' = j2';
            then
A551:       j1 = j1' by A515,A520,A522,A524,A525,A526,A528,A530,A532,A533,A534,
GOBOARD7:22;
            now per cases by A515,A520,A522,A524,A525,A526,A528,A530,A532,A533
,A534,A550,GOBOARD7:25;
              suppose i2 = i2';
                hence contradiction by A431,A463,A513,A516,A522,A530,A550,A551;
              end;
              suppose i2 = i2'+1;

hence contradiction by A406,A460,A464,A465,A514,A518,A522,A528,A550,A551;
              end;
              suppose i2+1 = i2';
                hence contradiction by A439,A466,A513,A520,A530,A550,A551;
              end;
            end;
            hence contradiction;
          end;
          suppose
A552:       i1 = i2+1 & j1 = j2 & i1' = i2' & j1' = j2'+1;
            now per cases by A515,A520,A522,A524,A525,A526,A528,A530,A532,A533
,A534,A552,GOBOARD7:23;
              suppose i1' = i2 & j2' = j1;
                hence contradiction by A431,A463,A513,A516,A522,A530,A552;
              end;
              suppose i1' = i2 & j2'+1 = j1;

hence contradiction by A406,A460,A464,A465,A514,A518,A522,A528,A552;
              end;
              suppose i1' = i2+1 & j2' = j1;
                hence contradiction by A439,A466,A513,A520,A530,A552;
              end;
              suppose i1' = i2+1 & j2'+1 = j1;

hence contradiction by A406,A460,A462,A465,A513,A517,A518,A520,A528,A552;
              end;
            end;
            hence contradiction;
          end;
          suppose
A553:       i1 = i2 & j1 = j2+1 & i1' = i2' & j1'+1 = j2';
            then
A554:       i1 = i1' by A515,A520,A522,A524,A525,A526,A528,A530,A532,A533,A534,
GOBOARD7:21;
            now per cases by A515,A520,A522,A524,A525,A526,A528,A530,A532,A533
,A534,A553,GOBOARD7:24;
              suppose j2 = j1';

hence contradiction by A406,A460,A464,A465,A514,A518,A522,A528,A553,A554;
              end;
              suppose j2 = j1'+1;
                hence contradiction by A431,A463,A513,A516,A522,A530,A553,A554;
              end;
              suppose j2+1 = j1';

hence contradiction by A406,A460,A462,A465,A513,A517,A518,A520,A528,A553,A554;
              end;
            end;
            hence contradiction;
          end;
          suppose
A555:       i1 = i2 & j1 = j2+1 & i1'+1 = i2' & j1' = j2';
            now per cases by A515,A520,A522,A524,A525,A526,A528,A530,A532,A533
,A534,A555,GOBOARD7:23;
              suppose i1 = i1' & j2 = j1';

hence contradiction by A406,A460,A464,A465,A514,A518,A522,A528,A555;
              end;
              suppose i1 = i1' & j2+1 = j1';

hence contradiction by A406,A460,A462,A465,A513,A517,A518,A520,A528,A555;
              end;
              suppose i1 = i1'+1 & j2 = j1';
                hence contradiction by A431,A463,A513,A516,A522,A530,A555;
              end;
              suppose i1 = i1'+1 & j2+1 = j1';
                hence contradiction by A439,A466,A513,A520,A530,A555;
              end;
            end;
            hence contradiction;
          end;
          suppose
A556:       i1 = i2 & j1 = j2+1 & i1' = i2'+1 & j1' = j2';
            now per cases by A515,A520,A522,A524,A525,A526,A528,A530,A532,A533
,A534,A556,GOBOARD7:23;
              suppose i1 = i2' & j2 = j1';
                hence contradiction by A431,A463,A513,A516,A522,A530,A556;
              end;
              suppose i1 = i2' & j2+1 = j1';
                hence contradiction by A439,A466,A513,A520,A530,A556;
              end;
              suppose i1 = i2'+1 & j2 = j1';

hence contradiction by A406,A460,A464,A465,A514,A518,A522,A528,A556;
              end;
              suppose i1 = i2'+1 & j2+1 = j1';

hence contradiction by A406,A460,A462,A465,A513,A517,A518,A520,A528,A556;
              end;
            end;
            hence contradiction;
          end;
          suppose
A557:       i1 = i2 & j1 = j2+1 & i1' = i2' & j1' = j2'+1;
            then
A558:       i1 = i1' by A515,A520,A522,A524,A525,A526,A528,A530,A532,A533,A534,
GOBOARD7:21;
            now per cases by A515,A520,A522,A524,A525,A526,A528,A530,A532,A533
,A534,A557,GOBOARD7:24;
              suppose j2 = j2';
                hence contradiction by A431,A463,A513,A516,A522,A530,A557,A558;
              end;
              suppose j2 = j2'+1;

hence contradiction by A406,A460,A464,A465,A514,A518,A522,A528,A557,A558;
              end;
              suppose j2+1 = j2';
                hence contradiction by A439,A466,A513,A520,A530,A557,A558;
              end;
            end;
            hence contradiction;
          end;
        end;
        hence contradiction;
      end;
    end;
    m+1-(m-'1) <= len g by A399,A401,XREAL_1:11;
    then
A559: m+1-(m-1) <= len g by A395,XREAL_1:235;
    then
A560: 1+m-m+1 <= len g;
    g is non constant
    proof
      take 1,2; thus
A561: 1 in dom g by FINSEQ_5:6; thus
A562: 2 in dom g by A559,FINSEQ_3:27;
      then g/.1 <> g/.(1+1) by A405,A561,GOBOARD7:31;
      then g.1 <> g/.(1+1) by A561,PARTFUN1:def 8;
      hence g.1 <> g.2 by A562,PARTFUN1:def 8;
    end;
    then reconsider g as standard non constant special_circular_sequence
    by A392,A402,A403,A404,A459,FINSEQ_6:def 1,JORDAN8:7;
A563: for j,k st 1 <= j & j <= k holds (F.k)/.j = (F.j)/.j
    proof
      let j,k;
      assume that
A564: 1 <= j and
A565: j <= k;
A566: (F.k)|j = F.j by A321,A565;
      j <= len(F.k) by A91,A565;
      then len(F.k|j) = j by FINSEQ_1:80;
      then j in dom((F.k)|j) by A564,FINSEQ_3:27;
      hence (F.k)/.j = (F.j)/.j by A566,FINSEQ_4:85;
    end;
    reconsider Lg' = (L~g)` as Subset of TOP-REAL 2;
A567: C c= Lg'
    proof
      let c be set;
      assume that
A568: c in C and
A569: not c in Lg';
      reconsider c as Point of TOP-REAL 2 by A568;
      c in L~g by A569,SUBSET_1:50;
      then consider i such that
A570: 1 <= i & i+1 <= len g and
A571: c in LSeg(g/.i,g/.(i+1)) by SPPOL_2:14;
      i in dom g & i+1 in dom g by A570,GOBOARD2:3;
      then
A572: g/.i = f/.(i+(m-'1)) & g/.(i+1) = f/.(i+1+(m-'1)) by FINSEQ_5:30;
A573: 1 <= i+(m-'1) by A570,NAT_1:12;
      i+1+(m-'1) = i+(m-'1)+1;
      then
A574: i+(m-'1)+1 <= (len g)+(m-'1) by A570,XREAL_1:8;
      then c in LSeg(f,i+(m-'1)) by A401,A571,A572,A573,TOPREAL1:def 5;
      then c in right_cell(f,i+(m-'1),G) /\ left_cell(f,i+(m-'1),G)
      by A394,A401,A573,A574,GOBRD13:30;
      then c in right_cell(f,i+(m-'1),G) by XBOOLE_0:def 4;
      then right_cell(f,i+(m-'1),G) meets C by A568,XBOOLE_0:3;
      hence contradiction by A245,A401,A573,A574;
    end;
A575: TOP-REAL 2 = TopSpaceMetr (Euclid 2) by EUCLID:def 8;
    L~g is closed by SPPOL_1:49;
    then (L~g)` is open by TOPS_1:29;
    then
A576: (L~g)` = Int (L~g)` by TOPS_1:55;
A577: L~g c= L~f by JORDAN3:75;
A578: LeftComp g is_a_component_of (L~g)` &
    RightComp g is_a_component_of (L~g)` by GOBOARD9:def 1,def 2;
A579: for h being standard non constant special_circular_sequence st L~h c= L~f
    for Comp being Subset of TOP-REAL 2 st Comp is_a_component_of (L~h)`
    for n st 1 <= n & n+1 <= len f & f/.n in Comp & not f/.n in L~h holds
    C meets Comp
    proof
      let h be standard non constant special_circular_sequence such that
A580: L~h c= L~f;
      let Comp be Subset of TOP-REAL 2 such that
A581: Comp is_a_component_of (L~h)`;
      let n such that
A582: 1 <= n & n+1 <= len f and
A583: f/.n in Comp and
A584: not f/.n in L~h;
      set rc=left_cell(f,n,G)\L~h;
      reconsider rc as Subset of TOP-REAL 2;
A585: rc c= left_cell(f,n,G) by XBOOLE_1:36;
A586: rc = left_cell(f,n,G) /\ (L~h)` by SUBSET_1:32;
A587: rc meets C
      proof
        left_cell(f,n,G) meets C by A245,A582;
        then consider p being set such that
A588:   p in left_cell(f,n,G) & p in C by XBOOLE_0:3;
        reconsider p as Element of TOP-REAL 2 by A588;
        now
          take p;
          now
            assume p in L~h;
            then consider j such that
A589:       1 <= j and
A590:       j+1 <= len f and
A591:       p in LSeg(f,j) by A580,SPPOL_2:13;
            p in right_cell(f,j,G) /\ left_cell(f,j,G) by A394,A589,A590,A591,
GOBRD13:30;
            then
A592:       p in right_cell(f,j,G) by XBOOLE_0:def 4;
            right_cell(f,j,G) misses C by A245,A589,A590;
            hence contradiction by A588,A592,XBOOLE_0:3;
          end;
          hence p in rc by A588,XBOOLE_0:def 5;
          thus p in C by A588;
        end;
        hence thesis by XBOOLE_0:3;
      end;
A593: Int left_cell(f,n,G) is connected by A394,A582,JORDAN9:12;
      Int left_cell(f,n,G) misses L~f by A394,A582,JORDAN9:17;
      then Int left_cell(f,n,G) misses L~h by A580,XBOOLE_1:63;
      then
A594: Int left_cell(f,n,G) c= (L~h)` by SUBSET_1:43;
A595: Int left_cell(f,n,G) c= left_cell(f,n,G) by TOPS_1:44;
      rc c= Cl Int left_cell(f,n,G) by A394,A582,A585,JORDAN9:13;
      then
A596: rc is connected by A586,A593,A594,A595,CONNSP_1:19,XBOOLE_1:19;
      f/.n in left_cell(f,n,G) by A394,A582,JORDAN9:10;
      then f/.n in rc by A584,XBOOLE_0:def 5;
      then
A597: rc meets Comp by A583,XBOOLE_0:3;
      rc c= (L~h)` by A586,XBOOLE_1:17;
      then rc c= Comp by A581,A596,A597,GOBOARD9:6;
      hence C meets Comp by A587,XBOOLE_1:63;
    end;
A598: C meets LeftComp g
    proof
      left_cell(f,m,G) meets C by A245,A395,A399;
      then consider p being set such that
A599: p in left_cell(f,m,G) & p in C by XBOOLE_0:3;
      reconsider p as Element of TOP-REAL 2 by A599;
      now
        take p;
        thus p in C by A599;
        reconsider u = p as Element of Euclid 2 by TOPREAL3:13;
        consider r being real number such that
A600:   r > 0 and
A601:   Ball(u,r) c= (L~g)` by A567,A576,A599,GOBOARD6:8;
        reconsider r as Real by XREAL_0:def 1;
A602:   p in Ball(u,r) by A600,TBSP_1:16;
        reconsider B = Ball(u,r) as non empty Subset of TOP-REAL 2
        by A575,A600,TBSP_1:16,TOPMETR:16;
A603:   B is connected by SPRECT_3:17;
        left_cell(g,1,G) c= left_cell(g,1) by A404,A560,GOBRD13:34;
        then
A604:   Int left_cell(g,1,G) c= Int left_cell(g,1) by TOPS_1:48;
        Int left_cell(g,1) c= LeftComp g by A560,GOBOARD9:24;
        then Int left_cell(g,1,G) c= LeftComp g by A604,XBOOLE_1:1;

then Int left_cell(f,m-'1+1,G) c= LeftComp g by A394,A400,A560,GOBRD13:33;
        then
A605:   Int left_cell(f,m,G) c= LeftComp g by A395,XREAL_1:237;
A606:   left_cell(f,m,G) = Cl Int left_cell(f,m,G) by A395,A399,A445;
        B is open by GOBOARD6:6;
        then
A607:   Int left_cell(f,m,G) meets B by A599,A602,A606,TOPS_1:39;
A608:   p in B by A600,TBSP_1:16;
        B c= LeftComp g by A578,A601,A603,A605,A607,GOBOARD9:6;
        hence p in LeftComp g by A608;
      end;
      hence thesis by XBOOLE_0:3;
    end;
    m = 1
    proof
      assume m <> 1;
      then
A609: 1 < m by A395,XXREAL_0:1;
A610: for n st 1 <= n & n <= m-'1 holds not f/.n in L~g
      proof
        let n such that
A611:   1 <= n and
A612:   n <= m-'1;
A613:   n <= len f by A400,A612,XXREAL_0:2;
        set p = f/.n;
        assume p in L~g;
        then consider j such that
A614:   m-'1+1 <= j and
A615:   j+1 <= len f and
A616:   p in LSeg(f,j) by A400,JORDAN9:9;
A617:   n < m-'1+1 by A612,NAT_1:13;
        then
A618:   n < j by A614,XXREAL_0:2;
A619:   m-'1+1=m by A395,XREAL_1:237;
        then
A620:   1 < j by A609,A614,XXREAL_0:2;
A621:   j+1 <= k by A91,A615;
A622:   j < k by A393,A615,NAT_1:13;
A623:   2 <= len G & 2 <= width G by A2,NAT_1:12;
A624:   p in Values G by A394,A611,A613,JORDAN9:8;
        per cases by A394,A615,A616,A620,A623,A624,JORDAN9:25;
        suppose
A625:     p = f/.j;
          n <= len(F.j) by A91,A618;
          then
A626:     n in dom(F.j) by A611,FINSEQ_3:27;
A627:     n <> len(F.j) by A91,A614,A617;
          (F.j)/.n = (F.n)/.n by A563,A611,A618
            .= p by A393,A563,A611,A613
            .= (F.j)/.j by A563,A620,A622,A625
            .= (F.j)/.len(F.j) by A91;
          hence contradiction by A387,A620,A622,A626,A627;
        end;
        suppose
A628:     p = f/.(j+1);
          now
            per cases by A621,XXREAL_0:1;
            suppose
A629:         j+1 = k;
              n <= len(F.m) by A91,A617,A619;
              then
A630:         n in dom(F.m) by A611,FINSEQ_3:27;
A631:         n <> len(F.m) by A91,A617,A619;
              (F.m)/.n = (F.n)/.n by A563,A611,A617,A619
                .= p by A393,A563,A611,A613
                .= (F.m)/.m by A392,A393,A395,A563,A628,A629
                .= (F.m)/.len(F.m) by A91;
              hence contradiction by A387,A393,A395,A396,A630,A631;
            end;
            suppose
A632:         j+1 < k;
              set l = j+1;
A633:         1 <= l by NAT_1:11;
A634:         n < n+1 & n+1 < l by A618,XREAL_1:8,31;
              then
A635:         n < l by XXREAL_0:2;
              then n <= len(F.l) by A91;
              then
A636:         n in dom(F.l) by A611,FINSEQ_3:27;
A637:         n <> len(F.l) by A91,A634;
              (F.l)/.n = (F.n)/.n by A563,A611,A635
                .= p by A393,A563,A611,A613
                .= (F.l)/.l by A563,A628,A632,A633
                .= (F.l)/.len(F.l) by A91;
              hence contradiction by A387,A632,A636,A637,NAT_1:11;
            end;
          end;
          hence contradiction;
        end;
      end;
A638: for n st 1 <= n holds n-'1+2 = n+1
      proof
        let n;
        assume 1 <= n;
        hence n-'1+2 = n+2-'1 by NAT_D:38
          .= n+1+1 - 1 by NAT_D:37
          .= n+1;
      end;
      C meets LeftComp Rev g
      proof
        set rg = Rev g;
A639:   rg is_sequence_on G by A404,JORDAN9:7;
A640:   1+1 <= len rg by A559,FINSEQ_5:def 3;
        then 1+1-'1 <= len rg-'1 by NAT_D:42;
        then
A641:   1 <= len rg -'1 by NAT_D:34;
        1 < len rg by A640,NAT_1:13;
        then
A642:   len rg -'1+1 = len rg by XREAL_1:237;
        set p = rg/.1, q = rg/.2;
        set a = f/.(m-'1);
        set l = (m-'1)+(len g-'1);
A643:   p = f/.m by A392,A403,FINSEQ_5:68;
A644:   m-'1+1 = m by A395,XREAL_1:237;
        then
A645:   1 <= m-'1 by A609,NAT_1:13;
        1+1-'1 <= len g-'1 by A559,NAT_D:42;
        then
A646:   1 <= len g-'1 by NAT_D:34;
A647:   1+1 - 1 <= len g - 1 by A559,XREAL_1:11;
A648:   1 - 1 < m - 1 by A609,XREAL_1:11;
A649:   l = m+(len g -'1)-'1 by A395,NAT_D:38
          .= (len g -'1)+m - 1 by A646,NAT_D:37
          .= (len g - 1)+m - 1 by A647,XREAL_0:def 2
          .= ((k - (m - 1)) - 1)+m - 1 by A393,A401,A648,XREAL_0:def 2
          .= k - 1;
        then
A650:   k = l+1;
        then
A651:   l < k by XREAL_1:31;
        len g-'1 <= l by NAT_1:11;
        then
A652:   1 <= l by A646,XXREAL_0:2;
        len g-'1 <= len g by NAT_D:44;
        then
A653:   len g-'1 in dom g by A646,FINSEQ_3:27;
        1 <= len g by A560,SPPOL_1:5;
        then
A654:   len g-'1+2 = len g+1 by A638;
        then
A655:   q = g/.(len g -'1) by A653,FINSEQ_5:69
          .= f/.l by A653,FINSEQ_5:30;
A656:   p = f/.(l+1) by A393,A403,A649,FINSEQ_5:68;
A657:   left_cell(f,m-'1,G) meets C by A245,A395,A644,A645;
A658:   left_cell(f,l,G) meets C by A245,A393,A650,A652;
        not a in L~g by A610,A645;
        then
A659:   not a in L~rg by SPPOL_2:22;
A660:   m-'1+2 = m+1 by A395,A638;
        m-'1 <= l by NAT_1:11;
        then m-'1 <= len(F.l) by A91;
        then
A661:   m-'1 in dom(F.l) by A645,FINSEQ_3:27;
        (m-'1)+1 <= l by A646,XREAL_1:8;
        then m-'1 < l by NAT_1:13;
        then
A662:   m-'1 <> len(F.l) by A91;
        consider p1,p2,q1,q2 being Element of NAT such that
A663:   [p1,p2] in Indices G and
A664:   p = G*(p1,p2) and
A665:   [q1,q2] in Indices G and
A666:   q = G*(q1,q2) and
A667:   p1 = q1 & p2+1 = q2 or p1+1 = q1 & p2 = q2 or
        p1 = q1+1 & p2 = q2 or p1 = q1 & p2 = q2+1 by A639,A640,JORDAN8:6;
A668:   1 <= p1 & p1 <= len G & 1 <= p2 & p2 <= width G by A663,MATRIX_1:39;
        per cases by A667;
        suppose ::A
A669:     p1 = q1 & p2+1 = q2;
          consider a1,a2,p'1,p'2 being Element of NAT such that
A670:     [a1,a2] in Indices G and
A671:     a = G*(a1,a2) and
A672:     [p'1,p'2] in Indices G and
A673:     p = G*(p'1,p'2) and
A674:     a1 = p'1 & a2+1 = p'2 or a1+1 = p'1 & a2 = p'2 or
          a1 = p'1+1 & a2 = p'2 or a1 = p'1 & a2 = p'2+1
          by A394,A395,A643,A644,A645,JORDAN8:6;
A675:     1 <= a1 & a1 <= len G & 1 <= a2 & a2 <= width G by A670,MATRIX_1:39;
          thus thesis
          proof
            per cases by A674;
            suppose ::I
              a1 = p'1 & a2+1 = p'2;
              then
A676:         a1 = p1 & a2+1 = p2 by A663,A664,A672,A673,GOBOARD1:21;
A677:         F.m is_sequence_on G by A245;
A678:         m-'1+1 <= len (F.m) by A91,A644;
A679:         m-'1 <= m by A644,NAT_1:11;
A680:         F.k|(m+1)=F.(m+1) by A321,A393,A399;
A681:         p2+1 > a2+1 & a2+1 > a2 by A676,NAT_1:13;
A682:         f/.(m-'1) = (F.(m-'1))/.(m-'1) by A393,A400,A563,A645
                .= (F.m)/.(m-'1) by A563,A645,A679;
A683:         f/.(m-'1+1) = (F.m)/.m by A393,A395,A563,A644;
              left_cell(f,l,G) = cell(G,p1,p2)
              by A393,A394,A649,A652,A655,A656,A663,A664,A665,A666,A669,
GOBRD13:28

.= front_right_cell(F.m,m-'1,G) by A643,A644,A645,A663,A664,A670,A671,A676,A677
,A678,A682,A683,GOBRD13:36;
              then F.(m+1) turns_right m-'1,G by A322,A609,A658;
              then f turns_right m-'1,G by A399,A645,A660,A680,GOBRD13:44;
              then
A684:         f/.(m+1) = G*(p1+1,p2) & [p1+1,p2] in Indices G
              by A643,A644,A660,A663,A664,A670,A671,A681,GOBRD13:def 6;
              then
A685:         1 <= p1+1 & p1+1 <= len G by MATRIX_1:39;
              set rc = left_cell(rg,len rg-'1,G)\L~rg;
A686:         rc c= LeftComp rg by A639,A641,A642,JORDAN9:29;
A687:         p2-'1 = a2 & p1-'1+1 = p1 by A668,A676,NAT_D:34,XREAL_1:237;
A688:         2 in dom g by A559,FINSEQ_3:27;
              len rg-'1+2 = len g +1 by A654,FINSEQ_5:def 3;
              then
A689:         rg/.(len rg -' 1) = g/.2 by A688,FINSEQ_5:69
                .= f/.(m+1) by A660,A688,FINSEQ_5:30;
              p = g/.1 by A392,A402,A403,FINSEQ_5:68
                .= rg/.len g by FINSEQ_5:68
                .= rg/.len rg by FINSEQ_5:def 3;
              then left_cell(rg,len rg-'1,G) = cell(G,p1,a2)
              by A639,A641,A642,A663,A664,A684,A687,A689,GOBRD13:26;
              then a in left_cell(rg,len rg-'1,G)
              by A668,A671,A675,A676,A685,JORDAN9:22;
              then
A690:         a in rc by A659,XBOOLE_0:def 5;
A691:         L~rg c= L~f by A577,SPPOL_2:22;
              LeftComp rg is_a_component_of (L~rg)` by GOBOARD9:def 1;

hence C meets LeftComp Rev g by A395,A579,A644,A645,A659,A686,A690,A691;
            end;
            suppose ::II
A692:         a1+1 = p'1 & a2 = p'2;
              then
A693:         a1+1 = p1 & a2 = p2 by A663,A664,A672,A673,GOBOARD1:21;
              then q1-'1 = a1 by A669,NAT_D:34;
              then right_cell(f,l,G) = cell(G,a1,a2)
              by A393,A394,A649,A652,A655,A656,A663,A664,A665,A666,A669,A693,
GOBRD13:29
                .= left_cell(f,m-'1,G)
              by A394,A395,A643,A644,A645,A670,A671,A672,A673,A692,GOBRD13:24;
              hence C meets LeftComp Rev g by A245,A393,A650,A652,A657;
            end;
            suppose ::III
              a1 = p'1+1 & a2 = p'2;
              then a1 = p1+1 & a2 = p2 by A663,A664,A672,A673,GOBOARD1:21;
              then right_cell(f,m-'1,G) = cell(G,p1,p2)
              by A394,A395,A643,A644,A645,A663,A664,A670,A671,GOBRD13:27
                .= left_cell(f,l,G)
              by A393,A394,A649,A652,A655,A656,A663,A664,A665,A666,A669,
GOBRD13:28;
              hence C meets LeftComp Rev g by A245,A395,A644,A645,A658;
            end;
            suppose ::IV
              a1 = p'1 & a2 = p'2+1;
              then
A694:         a1 = q1 & a2 = q2 by A663,A664,A669,A672,A673,GOBOARD1:21;
              (F.l)/.(m-'1) = (F.(m-'1))/.(m-'1) by A563,A645,NAT_1:11
                .= q by A393,A400,A563,A645,A666,A671,A694
                .= (F.l)/.l by A563,A651,A652,A655
                .= (F.l)/.len(F.l) by A91;
              hence C meets LeftComp Rev g by A387,A651,A652,A661,A662;
            end;
          end;
        end;
        suppose ::B
A695:     p1+1 = q1 & p2 = q2;
          consider a1,a2,p'1,p'2 being Element of NAT such that
A696:     [a1,a2] in Indices G and
A697:     a = G*(a1,a2) and
A698:     [p'1,p'2] in Indices G and
A699:     p = G*(p'1,p'2) and
A700:     a1 = p'1 & a2+1 = p'2 or a1+1 = p'1 & a2 = p'2 or
          a1 = p'1+1 & a2 = p'2 or a1 = p'1 & a2 = p'2+1
          by A394,A395,A643,A644,A645,JORDAN8:6;
A701:     1 <= a1 & a1 <= len G & 1 <= a2 & a2 <= width G by A696,MATRIX_1:39;
          thus thesis
          proof
            per cases by A700;
            suppose ::I
A702:         a1 = p'1 & a2+1 = p'2;
              then
A703:         a1 = p1 & a2+1 = p2 by A663,A664,A698,A699,GOBOARD1:21;
              then
A704:         q2-'1 = a2 by A695,NAT_D:34;
              right_cell(f,m-'1,G) = cell(G,a1,a2)
              by A394,A395,A643,A644,A645,A696,A697,A698,A699,A702,GOBRD13:23
                .= left_cell(f,l,G)
              by A393,A394,A649,A652,A655,A656,A663,A664,A665,A666,A695,A703
,A704,GOBRD13:26;
              hence C meets LeftComp Rev g by A245,A395,A644,A645,A658;
            end;
            suppose ::II
              a1+1 = p'1 & a2 = p'2;
              then
A705:         a1+1 = p1 & a2 = p2 by A663,A664,A698,A699,GOBOARD1:21;
A706:         F.m is_sequence_on G by A245;
A707:         m-'1+1 <= len (F.m) by A91,A644;
A708:         m-'1 <= m by A644,NAT_1:11;
A709:         F.k|(m+1)=F.(m+1) by A321,A393,A399;
A710:         a1 < a1+1 & p1 < p1+1 by XREAL_1:31;
A711:         f/.(m-'1) = (F.(m-'1))/.(m-'1) by A393,A400,A563,A645
                .= (F.m)/.(m-'1) by A563,A645,A708;
A712:         f/.(m-'1+1) = (F.m)/.m by A393,A395,A563,A644;
              left_cell(f,l,G) = cell(G,p1,p2-'1)
              by A393,A394,A649,A652,A655,A656,A663,A664,A665,A666,A695,
GOBRD13:26

.= front_right_cell(F.m,m-'1,G) by A643,A644,A645,A663,A664,A696,A697,A705,A706
,A707,A711,A712,GOBRD13:38;
              then F.(m+1) turns_right m-'1,G by A322,A609,A658;
              then f turns_right m-'1,G by A399,A645,A660,A709,GOBRD13:44;
              then
A713:         f/.(m+1) = G*(p1,p2-'1) & [p1,p2-'1] in Indices G
              by A643,A644,A660,A663,A664,A696,A697,A705,A710,GOBRD13:def 6;
              set rc = left_cell(rg,len rg-'1,G)\L~rg;
A714:         rc c= LeftComp rg by A639,A641,A642,JORDAN9:29;
A715:         a1 = p1-'1 by A705,NAT_D:34;
A716:         2 in dom g by A559,FINSEQ_3:27;
              len rg-'1+2 = len g +1 by A654,FINSEQ_5:def 3;
              then
A717:         rg/.(len rg -' 1) = g/.2 by A716,FINSEQ_5:69
                .= f/.(m+1) by A660,A716,FINSEQ_5:30;
A718:         a2-'1+1 = a2 by A701,XREAL_1:237;
A719:         1 <= a2-'1 by A705,A713,MATRIX_1:39;
              p = g/.1 by A392,A402,A403,FINSEQ_5:68
                .= rg/.len g by FINSEQ_5:68
                .= rg/.len rg by FINSEQ_5:def 3;
              then left_cell(rg,len rg-'1,G) = cell(G,a1,a2-'1)
              by A639,A641,A642,A663,A664,A705,A713,A715,A717,A718,GOBRD13:22;
              then a in left_cell(rg,len rg-'1,G)
              by A668,A697,A701,A705,A718,A719,JORDAN9:22;
              then
A720:         a in rc by A659,XBOOLE_0:def 5;
A721:         L~rg c= L~f by A577,SPPOL_2:22;
              LeftComp rg is_a_component_of (L~rg)` by GOBOARD9:def 1;

hence C meets LeftComp Rev g by A395,A579,A644,A645,A659,A714,A720,A721;
            end;
            suppose ::III
              a1 = p'1+1 & a2 = p'2;
              then
A722:         a1 = q1 & a2 = q2 by A663,A664,A695,A698,A699,GOBOARD1:21;
              (F.l)/.(m-'1) = (F.(m-'1))/.(m-'1) by A563,A645,NAT_1:11
                .= q by A393,A400,A563,A645,A666,A697,A722
                .= (F.l)/.l by A563,A651,A652,A655
                .= (F.l)/.len(F.l) by A91;
              hence C meets LeftComp Rev g by A387,A651,A652,A661,A662;
            end;
            suppose ::IV
              a1 = p'1 & a2 = p'2+1;
              then
A723:         a1 = p1 & a2 = p2+1 by A663,A664,A698,A699,GOBOARD1:21;
              right_cell(f,l,G) = cell(G,p1,p2)
              by A393,A394,A649,A652,A655,A656,A663,A664,A665,A666,A695,
GOBRD13:27
                .= left_cell(f,m-'1,G)
              by A394,A395,A643,A644,A645,A663,A664,A696,A697,A723,GOBRD13:28;
              hence C meets LeftComp Rev g by A245,A393,A650,A652,A657;
            end;
          end;
        end;
        suppose ::C
A724:     p1 = q1+1 & p2 = q2;
          consider a1,a2,p'1,p'2 being Element of NAT such that
A725:     [a1,a2] in Indices G and
A726:     a = G*(a1,a2) and
A727:     [p'1,p'2] in Indices G and
A728:     p = G*(p'1,p'2) and
A729:     a1 = p'1 & a2+1 = p'2 or a1+1 = p'1 & a2 = p'2 or
          a1 = p'1+1 & a2 = p'2 or a1 = p'1 & a2 = p'2+1
          by A394,A395,A643,A644,A645,JORDAN8:6;
A730:     1 <= a1 & a1 <= len G & 1 <= a2 & a2 <= width G by A725,MATRIX_1:39;
          thus thesis
          proof
            per cases by A729;
            suppose ::I
A731:         a1 = p'1 & a2+1 = p'2;
              then
A732:         a1 = p1 & a2+1 = p2 by A663,A664,A727,A728,GOBOARD1:21;
              then
A733:         q1 = a1-'1 by A724,NAT_D:34;
A734:         q2-'1 = a2 by A724,A732,NAT_D:34;
              right_cell(f,l,G) = cell(G,q1,q2-'1)
              by A393,A394,A649,A652,A655,A656,A663,A664,A665,A666,A724,
GOBRD13:25
                .= left_cell(f,m-'1,G)
              by A394,A395,A643,A644,A645,A725,A726,A727,A728,A731,A733,A734,
GOBRD13:22;
              hence C meets LeftComp Rev g by A245,A393,A650,A652,A657;
            end;
            suppose ::II
              a1+1 = p'1 & a2 = p'2;
              then
A735:         a1+1 = p1 & a2 = p2 by A663,A664,A727,A728,GOBOARD1:21;
              (F.l)/.(m-'1) = (F.(m-'1))/.(m-'1) by A563,A645,NAT_1:11
                .= q by A393,A400,A563,A645,A666,A724,A726,A735
                .= (F.l)/.l by A563,A651,A652,A655
                .= (F.l)/.len(F.l) by A91;
              hence C meets LeftComp Rev g by A387,A651,A652,A661,A662;
            end;
            suppose ::III
              a1 = p'1+1 & a2 = p'2;
              then
A736:         a1 = p1+1 & a2 = p2 by A663,A664,A727,A728,GOBOARD1:21;
A737:         p1-'1 = q1 by A724,NAT_D:34;
A738:         F.m is_sequence_on G by A245;
A739:         m-'1+1 <= len (F.m) by A91,A644;
A740:         m-'1 <= m by A644,NAT_1:11;
A741:         F.k|(m+1)=F.(m+1) by A321,A393,A399;
              p1+1>p1 by XREAL_1:31;
              then
A742:         a2+1 > p2 & a1+1 > p1 & a2 < p2+1 by A736,NAT_1:13;
A743:         f/.(m-'1) = (F.(m-'1))/.(m-'1) by A393,A400,A563,A645
                .= (F.m)/.(m-'1) by A563,A645,A740;
A744:         f/.(m-'1+1) = (F.m)/.m by A393,A395,A563,A644;
              left_cell(f,l,G) = cell(G,q1,q2)
              by A393,A394,A649,A652,A655,A656,A663,A664,A665,A666,A724,
GOBRD13:24

.= front_right_cell(F.m,m-'1,G) by A643,A644,A645,A663,A664,A724,A725,A726,A736
,A737,A738,A739,A743,A744,GOBRD13:40;
              then F.(m+1) turns_right m-'1,G by A322,A609,A658;
              then f turns_right m-'1,G by A399,A645,A660,A741,GOBRD13:44;
              then
A745:         f/.(m+1) = G*(p1,p2+1) & [p1,p2+1] in Indices G
              by A643,A644,A660,A663,A664,A725,A726,A742,GOBRD13:def 6;
              then
A746:         1 <= p2+1 & p2+1 <= width G by MATRIX_1:39;
              set rc = left_cell(rg,len rg-'1,G)\L~rg;
A747:         rc c= LeftComp rg by A639,A641,A642,JORDAN9:29;
A748:         2 in dom g by A559,FINSEQ_3:27;
              len rg-'1+2 = len g +1 by A654,FINSEQ_5:def 3;
              then
A749:         rg/.(len rg -' 1) = g/.2 by A748,FINSEQ_5:69
                .= f/.(m+1) by A660,A748,FINSEQ_5:30;
              p = g/.1 by A392,A402,A403,FINSEQ_5:68
                .= rg/.len g by FINSEQ_5:68
                .= rg/.len rg by FINSEQ_5:def 3;
              then left_cell(rg,len rg-'1,G) = cell(G,p1,p2)
              by A639,A641,A642,A663,A664,A745,A749,GOBRD13:28;
              then a in left_cell(rg,len rg-'1,G)
              by A668,A726,A730,A736,A746,JORDAN9:22;
              then
A750:         a in rc by A659,XBOOLE_0:def 5;
A751:         L~rg c= L~f by A577,SPPOL_2:22;
              LeftComp rg is_a_component_of (L~rg)` by GOBOARD9:def 1;

hence C meets LeftComp Rev g by A395,A579,A644,A645,A659,A747,A750,A751;
            end;
            suppose ::IV
              a1 = p'1 & a2 = p'2+1;
              then
A752:         a1 = p1 & a2 = p2+1 by A663,A664,A727,A728,GOBOARD1:21;
              then q1 = a1-'1 by A724,NAT_D:34;
              then right_cell(f,m-'1,G) = cell(G,q1,q2)
              by A394,A395,A643,A644,A645,A663,A664,A724,A725,A726,A752,
GOBRD13:29
                .= left_cell(f,l,G)
              by A393,A394,A649,A652,A655,A656,A663,A664,A665,A666,A724,
GOBRD13:24;
              hence C meets LeftComp Rev g by A245,A395,A644,A645,A658;
            end;
          end;
        end;
        suppose ::D
A753:     p1 = q1 & p2 = q2+1;
          consider a1,a2,p'1,p'2 being Element of NAT such that
A754:     [a1,a2] in Indices G and
A755:     a = G*(a1,a2) and
A756:     [p'1,p'2] in Indices G and
A757:     p = G*(p'1,p'2) and
A758:     a1 = p'1 & a2+1 = p'2 or a1+1 = p'1 & a2 = p'2 or
          a1 = p'1+1 & a2 = p'2 or a1 = p'1 & a2 = p'2+1
          by A394,A395,A643,A644,A645,JORDAN8:6;
A759:     1 <= a1 & a1 <= len G & 1 <= a2 & a2 <= width G by A754,MATRIX_1:39;
          thus thesis
          proof
            per cases by A758;
            suppose ::I
              a1 = p'1 & a2+1 = p'2;
              then
A760:         a1 = p1 & a2+1 = p2 by A663,A664,A756,A757,GOBOARD1:21;
              (F.l)/.(m-'1) = (F.(m-'1))/.(m-'1) by A563,A645,NAT_1:11
                .= q by A393,A400,A563,A645,A666,A753,A755,A760
                .= (F.l)/.l by A563,A651,A652,A655
                .= (F.l)/.len(F.l) by A91;
              hence C meets LeftComp Rev g by A387,A651,A652,A661,A662;
            end;
            suppose ::II
A761:         a1+1 = p'1 & a2 = p'2;
              then
A762:         a1+1 = p1 & a2 = p2 by A663,A664,A756,A757,GOBOARD1:21;
              then
A763:         a1 = q1-'1 by A753,NAT_D:34;
A764:         a2-'1 = q2 by A753,A762,NAT_D:34;
              right_cell(f,m-'1,G) = cell(G,a1,a2-'1)
              by A394,A395,A643,A644,A645,A754,A755,A756,A757,A761,GOBRD13:25
                .= left_cell(f,l,G)
              by A393,A394,A649,A652,A655,A656,A663,A664,A665,A666,A753,A763
,A764,GOBRD13:22;
              hence C meets LeftComp Rev g by A245,A395,A644,A645,A658;
            end;
            suppose ::III
              a1 = p'1+1 & a2 = p'2;
              then
A765:         a1 = p1+1 & a2 = p2 by A663,A664,A756,A757,GOBOARD1:21;
              then
A766:         a2-'1 = q2 by A753,NAT_D:34;
              right_cell(f,l,G) = cell(G,q1,q2)
              by A393,A394,A649,A652,A655,A656,A663,A664,A665,A666,A753,
GOBRD13:23
                .= left_cell(f,m-'1,G)
              by A394,A395,A643,A644,A645,A663,A664,A753,A754,A755,A765,A766,
GOBRD13:26;
              hence C meets LeftComp Rev g by A245,A393,A650,A652,A657;
            end;
            suppose ::IV
              a1 = p'1 & a2 = p'2+1;
              then
A767:         a1 = p1 & a2 = p2+1 by A663,A664,A756,A757,GOBOARD1:21;
A768:         p2-'1 = q2 by A753,NAT_D:34;
A769:         F.m is_sequence_on G by A245;
A770:         m-'1+1 <= len (F.m) by A91,A644;
A771:         m-'1 <= m by A644,NAT_1:11;
A772:         F.k|(m+1)=F.(m+1) by A321,A393,A399;
A773:         a2+1>p2+1 & p2+1>p2 by A767,NAT_1:13;
A774:         f/.(m-'1) = (F.(m-'1))/.(m-'1) by A393,A400,A563,A645
                .= (F.m)/.(m-'1) by A563,A645,A771;
A775:         f/.(m-'1+1) = (F.m)/.m by A393,A395,A563,A644;
              left_cell(f,l,G) = cell(G,q1-'1,q2)
              by A393,A394,A649,A652,A655,A656,A663,A664,A665,A666,A753,
GOBRD13:22

.= front_right_cell(F.m,m-'1,G) by A643,A644,A645,A663,A664,A753,A754,A755,A767
,A768,A769,A770,A774,A775,GOBRD13:42;
              then F.(m+1) turns_right m-'1,G by A322,A609,A658;
              then f turns_right m-'1,G by A399,A645,A660,A772,GOBRD13:44;
              then
A776:         f/.(m+1) = G*(p1-'1,p2) & [p1-'1,p2] in Indices G
              by A643,A644,A660,A663,A664,A754,A755,A773,GOBRD13:def 6;
              set rc = left_cell(rg,len rg-'1,G)\L~rg;
A777:         rc c= LeftComp rg by A639,A641,A642,JORDAN9:29;
A778:         2 in dom g by A559,FINSEQ_3:27;
              len rg-'1+2 = len g +1 by A654,FINSEQ_5:def 3;
              then
A779:         rg/.(len rg -' 1) = g/.2 by A778,FINSEQ_5:69
                .= f/.(m+1) by A660,A778,FINSEQ_5:30;
A780:         p = g/.1 by A392,A402,A403,FINSEQ_5:68
                .= rg/.len g by FINSEQ_5:68
                .= rg/.len rg by FINSEQ_5:def 3;
A781:         1 <= p1-'1 by A776,MATRIX_1:39;
A782:         p1-'1+1 = p1 by A668,XREAL_1:237;
              then left_cell(rg,len rg-'1,G) = cell(G,p1-'1,p2)
              by A639,A641,A642,A663,A664,A776,A779,A780,GOBRD13:24;
              then a in left_cell(rg,len rg-'1,G)
              by A668,A755,A759,A767,A781,A782,JORDAN9:22;
              then
A783:         a in rc by A659,XBOOLE_0:def 5;
A784:         L~rg c= L~f by A577,SPPOL_2:22;
              LeftComp rg is_a_component_of (L~rg)` by GOBOARD9:def 1;

hence C meets LeftComp Rev g by A395,A579,A644,A645,A659,A777,A783,A784;
            end;
          end;
        end;
      end;
      then C meets RightComp g by GOBOARD9:26;
      hence contradiction by A567,A578,A598,JORDAN9:3,SPRECT_4:7;
    end;
    then
A785: g = f/^0 by XREAL_1:234
      .= f by FINSEQ_5:31;
    then reconsider f as standard non constant special_circular_sequence;
    F.(0+1) = <*G*(XS,YS)*> by A77;
    then
A786: G*(XS,YS) = (F.1)/.1 by FINSEQ_4:25
      .= f/.1 by A386,A563;
    F.(1+1) = <*G*(XS,YS),G*(XS-'1,YS)*> by A77;
    then
A787: G*(XS-'1,YS) = (F.2)/.2 by FINSEQ_4:26
      .= f/.2 by A398,A563;
    f is clockwise_oriented
    proof
A788: LeftComp f is_a_component_of (L~f)` by GOBOARD9:def 1;
      UBD L~f is_outside_component_of L~f by JORDAN2C:73,76;
      then
A789: UBD L~f is_a_component_of (L~f)` by JORDAN2C:def 4;
A790: Int right_cell(f,1,G) c= right_cell(f,1,G) by TOPS_1:44;
A791: cell(G,XS-'1,YS) c= BDD C by A1,JORDAN11:6;
A792: XS-'1+1 = XS by A92,XREAL_1:237,XXREAL_0:2;
      [XS-'1,YS] in Indices G by A1,JORDAN11:9;
      then right_cell(f,1,G) c= BDD C by A95,A394,A397,A786,A787,A791,A792,
GOBRD13:27;
      then
A793: Int right_cell(f,1,G) c= BDD C by A790,XBOOLE_1:1;
A794: Int right_cell(f,1,G) c= RightComp f by A394,A397,JORDAN1H:31;
      Int right_cell(f,1,G) <> {} by A394,A397,JORDAN9:11;
      then
A795: BDD C meets RightComp f by A793,A794,XBOOLE_1:68;
A796: C c= LeftComp f by A567,A598,A785,A788,GOBOARD9:6;
      set W = {B where B is Subset of TOP-REAL 2: B is_inside_component_of C};
      BDD C = union W by JORDAN2C:def 5;
      then consider e being set such that
A797: e in W and
A798: RightComp f meets e by A795,ZFMISC_1:98;
      consider B being Subset of TOP-REAL 2 such that
A799: e = B and
A800: B is_inside_component_of C by A797;
A801: B is_a_component_of C` by A800,JORDAN2C:def 3;
      RightComp f misses C by A796,GOBRD14:24,XBOOLE_1:63;
      then
A802: RightComp f c= C` by SUBSET_1:43;
      B is Bounded by A800,JORDAN2C:def 3;
      then
A803: RightComp f is Bounded by A798,A799,A801,A802,GOBOARD9:6,JORDAN2C:16;
A804: UBD L~f = RightComp f or UBD L~f = LeftComp f by A789,JORDAN1H:30;
      L~f is Bounded by JORDAN2C:73;
      hence thesis by A803,A804,JORDAN1H:47,49;
    end;
    then reconsider f as
    clockwise_oriented (standard non constant special_circular_sequence);
    take f;
    thus f is_sequence_on G by A245;
    thus f/.1 = G*(XS,YS) by A786;
    thus f/.2 = G*(XS-'1,YS) by A787;
    let m such that
A805: 1 <= m & m+2 <= len f;
A806: m+1 < m+2 by XREAL_1:8;
    then
A807: m+1 <= len f by A805,XXREAL_0:2;
A808: f|(m+1) = F.(m+1) by A321,A393,A805,A806,XXREAL_0:2;
A809: m = m+1-'1 by NAT_D:34;
A810: m+1 > 1 by A805,NAT_1:13;
A811: front_right_cell(F.(m+1),m,G) = front_right_cell(f,m,G) &
    front_left_cell(F.(m+1),m,G) = front_left_cell(f,m,G)
    by A394,A805,A807,A808,GOBRD13:43;
A812: F.(m+1+1) = f|(m+1+1) by A321,A393,A805;
    hereby
      assume front_right_cell(f,m,G) misses C &
      front_left_cell(f,m,G) misses C;
      then F.(m+1+1) turns_left m,G by A322,A809,A810,A811;
      hence f turns_left m,G by A805,A812,GOBRD13:45;
    end;
    hereby
      assume front_right_cell(f,m,G) misses C &
      front_left_cell(f,m,G) meets C;
      then F.(m+1+1) goes_straight m,G by A322,A809,A810,A811;
      hence f goes_straight m,G by A805,A812,GOBRD13:46;
    end;
    assume front_right_cell(f,m,G) meets C;
    then F.(m+1+1) turns_right m,G by A322,A809,A810,A811;
    hence f turns_right m,G by A805,A812,GOBRD13:44;
  end;
  uniqueness
  proof
    let f1,f2 be clockwise_oriented
    (standard non constant special_circular_sequence) such that
A813: f1 is_sequence_on Gauge(C,n) and
A814: f1/.1 = Gauge(C,n)*(X-SpanStart(C,n),Y-SpanStart(C,n)) and
A815: f1/.2 = Gauge(C,n)*(X-SpanStart(C,n)-'1,Y-SpanStart(C,n)) and
A816: for k st 1 <= k & k+2 <= len f1 holds
    (front_right_cell(f1,k,Gauge(C,n)) misses C &
    front_left_cell(f1,k,Gauge(C,n)) misses C
    implies f1 turns_left k,Gauge(C,n)) &
    (front_right_cell(f1,k,Gauge(C,n)) misses C &
    front_left_cell(f1,k,Gauge(C,n)) meets C
    implies f1 goes_straight k,Gauge(C,n)) &
    (front_right_cell(f1,k,Gauge(C,n)) meets C
    implies f1 turns_right k,Gauge(C,n)) and
A817: f2 is_sequence_on Gauge(C,n) and
A818: f2/.1 = Gauge(C,n)*(X-SpanStart(C,n),Y-SpanStart(C,n)) and
A819: f2/.2 = Gauge(C,n)*(X-SpanStart(C,n)-'1,Y-SpanStart(C,n)) and
A820: for k st 1 <= k & k+2 <= len f2 holds
    (front_right_cell(f2,k,Gauge(C,n)) misses C &
    front_left_cell(f2,k,Gauge(C,n)) misses C
    implies f2 turns_left k,Gauge(C,n)) &
    (front_right_cell(f2,k,Gauge(C,n)) misses C &
    front_left_cell(f2,k,Gauge(C,n)) meets C
    implies f2 goes_straight k,Gauge(C,n)) &
    (front_right_cell(f2,k,Gauge(C,n)) meets C
    implies f2 turns_right k,Gauge(C,n));
    defpred P[Element of NAT] means f1|$1 = f2|$1;
A821: P[0];
A822: for k st P[k] holds P[k+1]
    proof
      let k such that
A823: f1|k = f2|k;
A824: f1|1 = <*f1/.1 *> & f2|1 = <*f2/.1 *> by FINSEQ_5:23;
A825: len f1 > 4 & len f2 > 4 by GOBOARD7:36;
      per cases by NAT_1:26;
      suppose k = 0;
        hence f1|(k+1) = f2|(k+1) by A814,A818,A824;
      end;
      suppose
A826:   k = 1;
        f1|2 = <*f1/.1,f1/.2*> & f2|2 = <*f2/.1,f2/.2*>
        by A825,JORDAN8:1,XXREAL_0:2;
        hence f1|(k+1) = f2|(k+1) by A814,A815,A818,A819,A826;
      end;
      suppose
A827:   k > 1;
A828:   f1/.1 = f1/.len f1 & f2/.1 = f2/.len f2 by FINSEQ_6:def 1;
        now
          per cases;
          suppose
A829:       len f1 > k;
            set m = k-'1;
A830:       1 <= m by A827,NAT_D:49;
            then
A831:       m+1 = k by NAT_D:43;
A832:       now
              assume
A833:         len f2 <= k;
              then
A834:         f2 = f2|k by FINSEQ_1:79;
              then
A835:         1 in dom(f2|k) by FINSEQ_5:6;
              len f2 in dom(f2|k) by A834,FINSEQ_5:6;
              then
A836:         (f1|k)/.len f2 = f1/.len f2 by A823,FINSEQ_4:85;
              1 < len f2 & len f2 <= len f1 by A823,A825,A834,FINSEQ_5:18
,XXREAL_0:2;

hence contradiction by A823,A828,A829,A833,A834,A835,A836,FINSEQ_4:85
,GOBOARD7:40;
            end;
            then
A837:       k+1 <= len f2 by NAT_1:13;
A838:       k+1 <= len f1 by A829,NAT_1:13;
A839:       front_right_cell(f1,m,Gauge(C,n))
            = front_right_cell(f1|k,m,Gauge(C,n))
            by A813,A829,A830,A831,GOBRD13:43;
A840:       front_left_cell(f1,m,Gauge(C,n))
            = front_left_cell(f1|k,m,Gauge(C,n))
            by A813,A829,A830,A831,GOBRD13:43;
A841:       front_right_cell(f2,m,Gauge(C,n))
            = front_right_cell(f2|k,m,Gauge(C,n))
            by A817,A830,A831,A832,GOBRD13:43;
A842:       front_left_cell(f2,m,Gauge(C,n))
            = front_left_cell(f2|k,m,Gauge(C,n))
            by A817,A830,A831,A832,GOBRD13:43;
A843:       m+(1+1) = k+1 by A831;
            now per cases;
              suppose front_right_cell(f1,m,Gauge(C,n)) misses C &
                front_left_cell(f1,m,Gauge(C,n)) misses C;
                then f1 turns_left m,Gauge(C,n) & f2 turns_left m,Gauge(C,n)
                by A816,A820,A823,A830,A837,A838,A839,A840,A841,A842,A843;

hence f1|(k+1) = f2|(k+1) by A817,A823,A827,A837,A838,GOBRD13:48;
              end;
              suppose front_right_cell(f1,m,Gauge(C,n)) misses C &
                front_left_cell(f1,m,Gauge(C,n)) meets C;

then f1 goes_straight m,Gauge(C,n) & f2 goes_straight m,Gauge(C,n)
                by A816,A820,A823,A830,A837,A838,A839,A840,A841,A842,A843;

hence f1|(k+1) = f2|(k+1) by A817,A823,A827,A837,A838,GOBRD13:49;
              end;
              suppose front_right_cell(f1,m,Gauge(C,n)) meets C;
                then f1 turns_right m,Gauge(C,n) & f2 turns_right m,Gauge(C,n)
                by A816,A820,A823,A830,A837,A838,A839,A841,A843;

hence f1|(k+1) = f2|(k+1) by A817,A823,A827,A837,A838,GOBRD13:47;
              end;
            end;
            hence f1|(k+1) = f2|(k+1);
          end;
          suppose
A844:       k >= len f1;
            then
A845:       f1 = f1|k by FINSEQ_1:79;
            then
A846:       1 in dom(f1|k) by FINSEQ_5:6;
            len f1 in dom(f1|k) by A845,FINSEQ_5:6;
            then
A847:       (f2|k)/.len f1 = f2/.len f1 by A823,FINSEQ_4:85;
            1 < len f1 & len f1 <= len f2 by A823,A825,A845,FINSEQ_5:18
,XXREAL_0:2;

then len f2 = len f1 by A823,A828,A845,A846,A847,FINSEQ_4:85,GOBOARD7:40;
            hence f1|(k+1) = f2|(k+1) by A823,A844,A845,FINSEQ_1:79;
          end;
        end;
        hence f1|(k+1) = f2|(k+1);
      end;
    end;
    for k holds P[k] from NAT_1:sch 1(A821,A822);
    hence f1 = f2 by JORDAN9:4;
  end;
end;

