:: Go-Board Theorem
::  by Jaros{\l}aw Kotowicz and Yatsuka Nakamura
::
:: Received August 24, 1992
:: Copyright (c) 1992 Association of Mizar Users
 
environ

 vocabularies NUMBERS, PRE_TOPC, EUCLID, SUBSET_1, FINSEQ_1, GOBOARD1,
      XXREAL_0, PARTFUN1, RELAT_1, INCSP_1, MATRIX_1, TREES_1, XBOOLE_0,
      CARD_1, ARYTM_3, NAT_1, TARSKI, FUNCT_1, ARYTM_1, ZFMISC_1, COMPLEX1,
      MATRIX_2, ORDINAL4, TOPREAL1, REAL_1, XXREAL_1, GOBOARD2, MCART_1,
      TOPREAL4, GOBOARD4;
 notations TARSKI, XBOOLE_0, ZFMISC_1, SUBSET_1, NUMBERS, XCMPLX_0, REAL_1,
      COMPLEX1, NAT_1, RELAT_1, FUNCT_1, PARTFUN1, FINSEQ_1, SEQ_1, STRUCT_0,
      PRE_TOPC, MATRIX_1, EUCLID, TOPREAL1, TOPREAL4, GOBOARD1, GOBOARD2,
      XXREAL_0, XXREAL_1;
 constructors PARTFUN1, NAT_1, XXREAL_1, COMPLEX1, FINSEQ_3, TOPREAL1,
      TOPREAL4, GOBOARD2, SEQ_1, GOBOARD1, RELSET_1, SEQM_3, REAL_1;
 registrations XBOOLE_0, ORDINAL1, RELSET_1, NUMBERS, XREAL_0, MEMBERED,
      FINSEQ_1, STRUCT_0, EUCLID, GOBOARD2, VALUED_0, CARD_1;
 requirements REAL, NUMERALS, BOOLE, SUBSET, ARITHM;
 definitions TARSKI, GOBOARD1;
 theorems TARSKI, NAT_1, ZFMISC_1, FINSEQ_1, ABSVALUE, FINSEQ_2, MATRIX_1,
      TOPREAL1, TOPREAL4, GOBOARD1, GOBOARD2, FINSEQ_3, FINSEQ_4, FUNCT_1,
      PARTFUN2, INT_1, XBOOLE_0, XBOOLE_1, XREAL_1, COMPLEX1, XXREAL_0,
      XXREAL_1, ORDINAL1, PARTFUN1, SEQM_3, SEQ_4;
 schemes NAT_1, FINSEQ_4;

begin

reserve p,p1,p2,q1,q2 for Point of TOP-REAL 2,
  P1,P2 for Subset of TOP-REAL 2,
  f,f1,f2,g1,g2 for FinSequence of TOP-REAL 2,
  n,m,i,j,k for Element of NAT,
  G,G1 for Go-board,
  x,y for set;

theorem Th1:
  for G,f1,f2 st 1<=len f1 & 1<=len f2 & f1 is_sequence_on G & f2
  is_sequence_on G & f1/.1 in rng Line(G,1) & f1/.len f1 in rng Line(G,len G) &
f2/.1 in rng Col(G,1) & f2/.len f2 in rng Col(G,width G) holds rng f1 meets rng
  f2
proof
  defpred P[Element of NAT] means for G1,g1,g2 st $1=width G1 & $1>0 & 1<=len
  g1 & 1<=len g2 & g1 is_sequence_on G1 & g2 is_sequence_on G1 & g1/.1 in rng
Line(G1,1) & g1/.len g1 in rng Line(G1,len G1) & g2/.1 in rng Col(G1,1) & g2/.
  len g2 in rng Col(G1,width G1) holds rng g1 /\ rng g2 <> {};
  let G,f1,f2;
A1: for k st P[k] holds P[k+1]
  proof
    let k such that
A2: P[k];
    let G1,g1,g2 such that
A3: k+1=width G1 and
    k+1>0 and
A4: 1<=len g1 and
A5: 1<=len g2 and
A6: g1 is_sequence_on G1 and
A7: g2 is_sequence_on G1 and
A8: g1/.1 in rng Line(G1,1) and
A9: g1/.len g1 in rng Line(G1,len G1) and
A10: g2/.1 in rng Col(G1,1) and
A11: g2/.len g2 in rng Col(G1,width G1);
    defpred P[Nat] means $1 in dom g2 & g2/.$1 in rng Col(G1,width G1);
A12: ex m be Nat st P[m]
    proof
      take n=len g2;
      thus n in dom g2 by A5,FINSEQ_3:27;
      thus thesis by A11;
    end;
    consider m be Nat such that
A13: P[m] & for i be Nat st P[i] holds m<=i from NAT_1:sch 5(A12);
    reconsider m as Element of NAT by ORDINAL1:def 13;
    set g = g2|m;
A14: g/.1 in rng Col(G1,1) by A10,A13,GOBOARD1:22;
A15: g is_sequence_on G1 by A7,GOBOARD1:38;
A16: m<=len g2 by A13,FINSEQ_3:27;
    then
A17: len g = m by FINSEQ_1:80;
A18: rng g c= rng g2
    proof
      let x;
      assume x in rng g;
      then consider n such that
A19:  n in dom g and
A20:  x=g/.n by PARTFUN2:4;
A21:  n in Seg m by A17,A19,FINSEQ_1:def 3;
      then
A22:  n in dom g2 by A13,FINSEQ_4:86;
      x=g2/.n by A13,A20,A21,FINSEQ_4:86;
      hence thesis by A22,PARTFUN2:4;
    end;
    reconsider L1 = Line(G1,1), Ll = Line(G1,len G1) as FinSequence of
    TOP-REAL 2;
A23: dom g2 = Seg len g2 by FINSEQ_1:def 3;
A24: dom g = Seg len g by FINSEQ_1:def 3;
    0<>len G1 by GOBOARD1:def 5;
    then
A25: 0+1<=len G1 by NAT_1:14;
    then
A26: 1 in dom G1 by FINSEQ_3:27;
A27: len G1 in dom G1 by A25,FINSEQ_3:27;
A28: g/.len g in rng Col(G1,width G1) by A13,GOBOARD1:23;
    defpred P[Nat] means $1 in dom G1 & rng g /\ rng Line(G1,$1) <> {};
A29: for n be Nat st P[n] holds n<=len G1 by FINSEQ_3:27;
    0<>width G1 by GOBOARD1:def 5;
    then
A30: 0+1<=width G1 by NAT_1:14;
    then
A31: 1 in Seg width G1 by FINSEQ_1:3;
A32: 1<=len g by A13,GOBOARD1:38;
    then
A33: 1 in dom g by FINSEQ_3:27;
A34: ex n be Nat st P[n]
    proof
      consider i being Nat such that
A35:  i in dom Col(G1,1) and
A36:  g/.1=Col(G1,1).i by A10,A13,FINSEQ_2:11,GOBOARD1:22;
      reconsider i as Element of NAT by ORDINAL1:def 13;
      take i;
      i in Seg len Col(G1,1) by A35,FINSEQ_1:def 3;
      then i in Seg len G1 by MATRIX_1:def 9;
      hence i in dom G1 by FINSEQ_1:def 3;
      then
A37:  g/.1=Line(G1,i).1 by A31,A36,GOBOARD1:17;
A38:  g/.1 in rng g by A33,PARTFUN2:4;
      len Line(G1,i)=width G1 by MATRIX_1:def 8;
      then dom Line(G1,i) = Seg width G1 by FINSEQ_1:def 3;
      then g/.1 in rng Line(G1,i) by A31,A37,FUNCT_1:def 5;
      hence thesis by A38,XBOOLE_0:def 4;
    end;
    consider mi be Nat such that
A39: P[mi] & for n be Nat st P[n] holds mi<=n from NAT_1:sch 5(A34);
A40: ex n be Nat st P[n] by A34;
    consider ma be Nat such that
A41: P[ma] & for n be Nat st P[n] holds n<=ma from NAT_1:sch 6(A29,A40
    );
    reconsider mi,ma as Element of NAT by ORDINAL1:def 13;
A42: 1<=mi by A39,FINSEQ_3:27;
    reconsider Lmi = Line(G1,mi) as FinSequence of TOP-REAL 2;
    defpred P[Nat] means $1 in dom g1 & g1/.$1 in rng Line(G1,mi);
A43: for n be Nat st P[n] holds n<=len g1 by FINSEQ_3:27;
A44: mi<=len G1 by A39,FINSEQ_3:27;
    then ex n st P[n] by A4,A6,A8,A9,A42,GOBOARD1:45;
    then
A45: ex n be Nat st P[n];
    consider ma1 be Nat such that
A46: P[ma1] & for n be Nat st P[n] holds n<= ma1 from NAT_1:sch 6(A43,
    A45);
A47: ma<=len G1 by A41,FINSEQ_3:27;
    1<=mi by A39,FINSEQ_3:27;
    then reconsider l1=mi-1, l2=len G1-ma as Element of NAT by A47,INT_1:18;
A48: ma<=len G1 by A41,FINSEQ_3:27;
A49: for n st P[n] holds n<= ma1 by A46;
    reconsider ma1 as Element of NAT by ORDINAL1:def 13;
    consider k1 be Element of NAT such that
A50: k1 in dom Lmi and
A51: g1/.ma1 = Lmi/.k1 by A46,PARTFUN2:4;
    Seg len Lmi = dom Lmi by FINSEQ_1:def 3;
    then
A52: k1 in Seg width G1 by A50,MATRIX_1:def 8;
A53: dom G1 = Seg len G1 by FINSEQ_1:def 3;
A54: mi=ma implies rng g1 /\ rng g2 <> {}
    proof
      consider n such that
A55:  n in dom g1 and
A56:  g1/.n in rng Line(G1,mi) by A4,A6,A8,A9,A42,A44,GOBOARD1:45;
      consider i such that
A57:  i in dom Line(G1,mi) and
A58:  g1/.n=Lmi/.i by A56,PARTFUN2:4;
A59:  1<=i by A57,FINSEQ_3:27;
A60:  len Line(G1,mi)=width G1 by MATRIX_1:def 8;
      then i<=width G1 by A57,FINSEQ_3:27;
      then consider m such that
A61:  m in dom g and
A62:  g/.m in rng Col(G1,i) by A32,A15,A14,A28,A59,GOBOARD1:49;
A63:  g/.m in rng g by A61,PARTFUN2:4;
      reconsider Ci = Col(G1,i) as FinSequence of TOP-REAL 2;
A64:  len Col(G1,i)= len G1 by MATRIX_1:def 9;
      then
A65:  dom Col(G1,i) = Seg len G1 by FINSEQ_1:def 3
        .= dom G1 by FINSEQ_1:def 3;
      assume
A66:  mi=ma;
A67:  dom Line(G1,mi) = Seg len Line(G1,mi) by FINSEQ_1:def 3;
      consider j such that
A68:  j in dom Ci and
A69:  g/.m=Ci/.j by A62,PARTFUN2:4;
      reconsider Lj = Line(G1,j) as FinSequence of TOP-REAL 2;
      len Line(G1,mi) = width G1 by MATRIX_1:def 8
        .= len Lj by MATRIX_1:def 8;
      then
A70:  dom Line(G1,mi) = dom Lj by A67,FINSEQ_1:def 3;
A71:  g/.m = Ci.j by A68,A69,PARTFUN1:def 8
        .= Lj.i by A57,A67,A60,A65,A68,GOBOARD1:17
        .= Lj/.i by A57,A70,PARTFUN1:def 8;
      len Lj=width G1 by MATRIX_1:def 8;
      then i in dom Lj by A57,A67,A60,FINSEQ_1:def 3;
      then g/.m in rng Lj by A71,PARTFUN2:4;
      then
A72:  dom Ci = Seg len Ci & rng g /\ rng Line(G1,j) <> {} by A63,FINSEQ_1:def 3
,XBOOLE_0:def 4;
A73:  now
        assume j<>mi;
        then j<mi or j>mi by XXREAL_0:1;
        hence contradiction by A39,A53,A41,A66,A64,A68,A72;
      end;
      g1/.n in rng g1 by A55,PARTFUN2:4;
      hence thesis by A18,A58,A63,A71,A73,XBOOLE_0:def 4;
    end;
A74: width G1 in Seg width G1 by A30,FINSEQ_1:3;
    deffunc F(Nat) = G1*($1,k1);
    reconsider Ck1 = Col(G1,k1) as FinSequence of TOP-REAL 2;
    consider h1 be FinSequence of TOP-REAL 2 such that
A75: len h1 = l1 & for n being Nat st n in dom h1 holds h1/.n=F(n)
    from FINSEQ_4:sch 2;
A76: dom g1 = Seg len g1 by FINSEQ_1:def 3;
    now
      per cases;
      suppose
A77:    k=0;
        reconsider c1 = Col(G1,1) as FinSequence of TOP-REAL 2;
        consider x being Element of NAT such that
A78:    x in dom c1 and
A79:    g2/.1=c1/.x by A10,PARTFUN2:4;
        reconsider lx = Line(G1,x) as FinSequence of TOP-REAL 2;
A80:    1<=x by A78,FINSEQ_3:27;
A81:    len c1 = len G1 by MATRIX_1:def 9;
        then x<=len G1 by A78,FINSEQ_3:27;
        then consider m such that
A82:    m in dom g1 and
A83:    g1/.m in rng lx by A4,A6,A8,A9,A80,GOBOARD1:45;
A84:    g1/.m in rng g1 by A82,PARTFUN2:4;
        Seg len c1 = dom c1 by FINSEQ_1:def 3;
        then
A85:    x in dom G1 by A78,A81,FINSEQ_1:def 3;
A86:    c1/.x = c1.x by A78,PARTFUN1:def 8;
        consider y being Element of NAT such that
A87:    y in dom lx and
A88:    lx/.y=g1/.m by A83,PARTFUN2:4;
        Seg len lx=dom lx & len lx=width G1 by FINSEQ_1:def 3,MATRIX_1:def 8;
        then
A89:    y =1 by A3,A77,A87,FINSEQ_1:4,TARSKI:def 1;
        0<>width G1 by GOBOARD1:def 5;
        then 0+1<=width G1 by NAT_1:14;
        then
A90:    1 in Seg width G1 by FINSEQ_1:3;
        1 in dom g2 by A5,FINSEQ_3:27;
        then
A91:    g2/.1 in rng g2 by PARTFUN2:4;
        lx/.y = lx.y by A87,PARTFUN1:def 8;
        then g1/.m=g2/.1 by A79,A90,A85,A88,A86,A89,GOBOARD1:17;
        hence thesis by A84,A91,XBOOLE_0:def 4;
      end;
      suppose
A92:    k<>0;
        then
A93:    0<k by NAT_1:3;
        now
          per cases;
          suppose
            mi=ma;
            hence thesis by A54;
          end;
          suppose
A94:        mi<>ma;
            1<=ma1 by A46,FINSEQ_3:27;
            then reconsider w=ma1-1 as Element of NAT by INT_1:18;
            reconsider Lma = Line(G1,ma) as FinSequence of TOP-REAL 2;
A95:        Indices G1=[:dom G1,Seg width G1:] by MATRIX_1:def 5;
A96:        now
              let n;
A97:          l1<=mi by XREAL_1:45;
              assume
A98:          n in dom h1;
              then
A99:          1<=n by FINSEQ_3:27;
              n<=l1 by A75,A98,FINSEQ_3:27;
              then
A100:         n<=mi by A97,XXREAL_0:2;
              mi<=len G1 by A39,FINSEQ_3:27;
              then n<=len G1 by A100,XXREAL_0:2;
              hence n in dom G1 by A99,FINSEQ_3:27;
            end;
A101:       now
              let n;
              assume that
A102:         n in dom h1 and
A103:         n+1 in dom h1;
              n+1 in dom G1 by A96,A103;
              then
A104:         [n+1,k1] in Indices G1 by A52,A95,ZFMISC_1:106;
              let i1,i2,j1,j2 be Element of NAT;
              assume that
A105:         [i1,i2] in Indices G1 and
A106:         [j1,j2] in Indices G1 and
A107:         h1/.n=G1*(i1,i2) and
A108:         h1/.(n+1)=G1*(j1,j2);
              h1/.(n+1)=G1*(n+1,k1) by A75,A103;
              then
A109:         j1=n+1 & j2=k1 by A104,A106,A108,GOBOARD1:21;
              n in dom G1 by A96,A102;
              then
A110:         [n,k1] in Indices G1 by A52,A95,ZFMISC_1:106;
              h1/.n=G1*(n,k1) by A75,A102;
              then i1=n & i2=k1 by A110,A105,A107,GOBOARD1:21;
              hence abs(i1-j1)+abs(i2-j2)= abs(n-n+-1)+0 by A109,ABSVALUE:7
                .= abs(1) by COMPLEX1:138
                .= 1 by ABSVALUE:def 1;
            end;
A111:       rng h1 /\ rng g = {}
            proof
              consider x being Element of rng h1 /\ rng g;
              assume
A112:         not thesis;
              then x in rng h1 by XBOOLE_0:def 4;
              then consider n1 be Element of NAT such that
A113:         n1 in dom h1 and
A114:         x=h1/.n1 by PARTFUN2:4;
A115:         n1<=l1 by A75,A113,FINSEQ_3:27;
              n1 in dom G1 by A96,A113;
              then
A116:         [n1,k1] in Indices G1 by A52,A95,ZFMISC_1:106;
              x in rng g by A112,XBOOLE_0:def 4;
              then consider n2 be Element of NAT such that
A117:         n2 in dom g and
A118:         x=g/.n2 by PARTFUN2:4;
A119:         g/.n2 in rng g by A117,PARTFUN2:4;
              consider i1,i2 be Element of NAT such that
A120:         [i1,i2] in Indices G1 and
A121:         g/.n2=G1*(i1,i2) by A15,A117,GOBOARD1:def 11;
              reconsider L=Line(G1,i1) as FinSequence of TOP-REAL 2;
A122:         i2 in Seg width G1 by A95,A120,ZFMISC_1:106;
A123:         Seg len L = dom L & len L=width G1 by FINSEQ_1:def 3
,MATRIX_1:def 8;
              then L/.i2 = L.i2 by A122,PARTFUN1:def 8;
              then g/.n2=L/.i2 by A121,A122,MATRIX_1:def 8;
              then g/.n2 in rng L by A122,A123,PARTFUN2:4;
              then
A124:         rng g /\ rng L <> {} by A119,XBOOLE_0:def 4;
              i1 in dom G1 by A95,A120,ZFMISC_1:106;
              then
A125:         mi<=i1 by A39,A124;
              x=G1*(n1,k1) by A75,A113,A114;
              then i1=n1 by A118,A120,A121,A116,GOBOARD1:21;
              then mi<=mi-1 by A115,A125,XXREAL_0:2;
              hence contradiction by XREAL_1:46;
            end;
            defpred P[Nat] means $1 in dom g1 & ma1<$1 & g1/.$1 in rng Line(G1
            ,ma);
A126:       mi<=ma by A39,A41;
            then
A127:       mi<ma by A94,XXREAL_0:1;
            then ex n st P[n] by A6,A9,A39,A48,A46,GOBOARD1:53;
            then
A128:       ex n be Nat st P[n];
            consider mi1 be Nat such that
A129:       P[mi1] & for n be Nat st P[n] holds mi1<=n from NAT_1:
            sch 5(A128);
            consider k2 be Element of NAT such that
A130:       k2 in dom Lma and
A131:       g1/.mi1=Lma/.k2 by A129,PARTFUN2:4;
            deffunc F(Nat) = G1*(ma+$1,k2);
            consider h2 be FinSequence of TOP-REAL 2 such that
A132:       len h2 = l2 & for n being Nat st n in dom h2 holds h2/.n
            = F(n) from FINSEQ_4:sch 2;
            reconsider Ck2 = Col(G1,k2) as FinSequence of TOP-REAL 2;
            dom Lma = Seg len Lma by FINSEQ_1:def 3;
            then
A133:       k2 in Seg width G1 by A130,MATRIX_1:def 8;
A134:       now
              let n;
A135:         n<=n+ma by NAT_1:11;
              assume
A136:         n in dom h2;
              then n<=l2 by A132,FINSEQ_3:27;
              then
A137:         ma+n<=ma+l2 by XREAL_1:9;
              1<=n by A136,FINSEQ_3:27;
              then 1<=n+ma by A135,XXREAL_0:2;
              hence ma+n in dom G1 by A137,FINSEQ_3:27;
            end;
A138:       now
              let n;
              assume
A139:         n in dom h2;
              take m=ma+n,k2;
              ma+n in dom G1 by A134,A139;
              hence [m,k2] in Indices G1 & h2/.n=G1*(m,k2) by A133,A132,A95
,A139,ZFMISC_1:106;
            end;
A140:       now
              let n;
              assume that
A141:         n in dom h2 and
A142:         n+1 in dom h2;
              ma+(n+1) in dom G1 by A134,A142;
              then
A143:         [ma+n+1,k2] in Indices G1 by A133,A95,ZFMISC_1:106;
              let i1,i2,j1,j2 be Element of NAT;
              assume that
A144:         [i1,i2] in Indices G1 and
A145:         [j1,j2] in Indices G1 and
A146:         h2/.n=G1* (i1,i2) and
A147:         h2/.(n+1)=G1*(j1,j2);
              h2/.(n+1)=G1*(ma+(n+1),k2) by A132,A142;
              then
A148:         j1=ma+n+1 & j2=k2 by A143,A145,A147,GOBOARD1:21;
              ma+n in dom G1 by A134,A141;
              then
A149:         [ma+n,k2] in Indices G1 by A133,A95,ZFMISC_1:106;
              h2/.n=G1 *(ma+n,k2) by A132,A141;
              then i1=ma+n & i2=k2 by A149,A144,A146,GOBOARD1:21;
              hence abs(i1-j1)+abs(i2-j2)= abs(ma+n-(ma+n)+-1)+0 by A148,
ABSVALUE:7
                .= abs(1) by COMPLEX1:138
                .= 1 by ABSVALUE:def 1;
            end;
A150:       mi1<=mi1+1 by NAT_1:11;
A151:       0+1<width G1 by A3,A93,XREAL_1:8;
            then
A152:       len DelCol(G1,width G1)= len G1 by A74,GOBOARD1:def 10;
            ma1<=mi1 by A129;
            then reconsider l=mi1+1-ma1 as Element of NAT by A150,INT_1:18
,XXREAL_0:2;
            set f1=g1|mi1;
            defpred P[Nat,Element of TOP-REAL 2] means $2=f1/.(w+$1);
A153:       for n being Nat st n in Seg l ex p st P[n,p];
            consider f such that
A154:       len f = l & for n being Nat st n in Seg l holds P[n,f/.n
            ] from FINSEQ_4:sch 1(A153);
A155:       w+l= mi1;
A156:       dom f = Seg l by A154,FINSEQ_1:def 3;
            set ff = h1^f^h2;
            ma1+1<=mi1 by A129,NAT_1:13;
            then ma1+1<=mi1+1 by NAT_1:13;
            then
A157:       1<=l by XREAL_1:21;
A158:       now
              per cases;
              suppose
A159:           mi=1;
                1<=ma1 by A76,A46,FINSEQ_1:3;
                then
A160:           ma1 in Seg mi1 by A129,FINSEQ_1:3;
A161:           w+1=ma1;
A162:           1 in Seg l by A157,FINSEQ_1:3;
                h1 = {} by A75,A159;
                then ff=f^h2 by FINSEQ_1:47;
                then ff/.1=f/.1 by A156,A162,FINSEQ_4:83
                  .= f1/.ma1 by A154,A162,A161
                  .= g1/.ma1 by A129,A160,FINSEQ_4:86;
                hence ff/.1 in rng Line(G1,1) by A46,A159;
              end;
              suppose
A163:           mi<>1;
                1<=mi by A39,FINSEQ_3:27;
                then 1<mi by A163,XXREAL_0:1;
                then 1+1<=mi by NAT_1:13;
                then
A164:           1<=l1 by XREAL_1:21;
                then
A165:           1 in dom h1 by A75,FINSEQ_3:27;
A166:           len Line(G1,1)=width G1 by MATRIX_1:def 8;
                then
A167:           k1 in dom L1 by A52,FINSEQ_1:def 3;
                dom Line(G1,1) = Seg width G1 by A166,FINSEQ_1:def 3;
                then
A168:           L1/.k1 = L1.k1 by A52,PARTFUN1:def 8;
                len(h1^f)=len h1 + len f & 0<=len f by FINSEQ_1:35,NAT_1:2;
                then 0+1<=len(h1^f) by A75,A164,XREAL_1:9;
                then 1 in dom(h1^f) by FINSEQ_3:27;
                then ff/.1=(h1^f)/.1 by FINSEQ_4:83
                  .=h1/.1 by A165,FINSEQ_4:83
                  .=G1*(1,k1) by A75,A165
                  .=L1/.k1 by A52,A168,MATRIX_1:def 8;
                hence ff/.1 in rng Line(G1,1) by A167,PARTFUN2:4;
              end;
            end;
A169:       for n st n in Seg l holds f1/.(w+n)=g1/.(w+n) & w+n in dom g1
            proof
              0+1<=ma1 by A46,FINSEQ_3:27;
              then
A170:         0<=ma1-1 by XREAL_1:21;
              let n such that
A171:         n in Seg l;
              n<=l by A171,FINSEQ_1:3;
              then n+ma1<=l+ma1 by XREAL_1:9;
              then
A172:         n+ma1-1<=mi1 by XREAL_1:22;
              1<=n by A171,FINSEQ_1:3;
              then 0+1<=ma1-1+n by A170,XREAL_1:9;
              then w+n in Seg mi1 by A172,FINSEQ_1:3;
              hence thesis by A129,FINSEQ_4:86;
            end;
A173:       now
              let n;
              assume
A174:         n in dom f;
              then w+n in dom g1 by A169,A156;
              then consider i,j such that
A175:         [i,j] in Indices G1 & g1/.(w+n)=G1*(i,j) by A6,GOBOARD1:def 11;
              take i,j;
              f/.n=f1/.(w+n) by A154,A156,A174;
              hence [i,j] in Indices G1 & f/.n=G1*(i,j) by A169,A156,A174,A175;
            end;
A176:       Seg len f=dom f by FINSEQ_1:def 3;
A177:       rng f c= rng g1
            proof
              let x;
              assume x in rng f;
              then consider n such that
A178:         n in dom f and
A179:         x=f/.n by PARTFUN2:4;
              f/.n=f1/.(w+n) by A154,A176,A178;
              then
A180:         f/.n=g1/.(w+n) by A169,A154,A176,A178;
              w+n in dom g1 by A169,A154,A176,A178;
              hence thesis by A179,A180,PARTFUN2:4;
            end;
A181:       dom h2 = Seg len h2 by FINSEQ_1:def 3;
A182:       now
              per cases;
              suppose
A183:           ma=len G1;
                1<=mi1 by A129,FINSEQ_3:27;
                then
A184:           mi1 in Seg mi1 by FINSEQ_1:3;
A185:           len f in dom f by A154,A176,A157,FINSEQ_1:3;
                h2 = {} by A132,A183;
                then
A186:           ff=h1^f by FINSEQ_1:47;
                then ff/.len ff=ff/.(len h1+len f) by FINSEQ_1:35
                  .= f/.l by A154,A186,A185,FINSEQ_4:84
                  .= f1/.mi1 by A154,A156,A155,A185
                  .= g1/.mi1 by A129,A184,FINSEQ_4:86;
                hence ff/.len ff in rng Line(G1,len G1) by A129,A183;
              end;
              suppose
A187:           ma<>len G1;
                ma<=len G1 by A41,FINSEQ_3:27;
                then ma<len G1 by A187,XXREAL_0:1;
                then ma+1<=len G1 by NAT_1:13;
                then
A188:           1<=l2 by XREAL_1:21;
                then
A189:           l2 in Seg l2 by FINSEQ_1:3;
A190:           len h2 in dom h2 by A132,A188,FINSEQ_3:27;
A191:           len Line(G1,len G1)=width G1 by MATRIX_1:def 8;
                then
A192:           k2 in dom Ll by A133,FINSEQ_1:def 3;
                k2 in dom Ll by A133,A191,FINSEQ_1:def 3;
                then
A193:           Ll/.k2 = Ll.k2 by PARTFUN1:def 8;
                ff/.len ff=ff/.(len(h1^f)+len h2) by FINSEQ_1:35
                  .=h2/.l2 by A132,A190,FINSEQ_4:84
                  .=G1*(ma+l2,k2) by A132,A181,A189
                  .=Ll/.k2 by A133,A193,MATRIX_1:def 8;
                hence ff/.len ff in rng Line(G1,len G1) by A192,PARTFUN2:4;
              end;
            end;
            0+0<=len h1+len h2 by NAT_1:2;
            then
A194:       0+1<=len f+(len h1+len h2) by A154,A157,XREAL_1:9;
A195:       rng ff = rng(h1^f) \/ rng h2 by FINSEQ_1:44
              .= rng h1 \/ rng f \/ rng h2 by FINSEQ_1:44;
A196:       for k st k in Seg width G1 & rng f /\ rng Col(G1,k)={} holds
            rng ff /\ rng Col(G1,k)={}
            proof
A197:         len Col(G1,k2)=len G1 by MATRIX_1:def 9;
A198:         len Col(G1,k1)=len G1 by MATRIX_1:def 9;
A199:         w+1=ma1;
              let k;
              assume that
A200:         k in Seg width G1 and
A201:         rng f /\ rng Col(G1,k)={};
              set gg=Col(G1,k);
              assume
A202:         rng ff /\ rng gg <> {};
              consider x being Element of rng ff /\ rng gg;
              rng ff = rng f \/ (rng h1 \/ rng h2) by A195,XBOOLE_1:4;
              then
A203:         rng ff /\ rng gg = {} \/ (rng h1 \/ rng h2) /\ rng gg by A201,
XBOOLE_1:23
                .= rng h1 /\ rng gg \/ rng h2 /\ rng gg by XBOOLE_1:23;
              now
                per cases by A202,A203,XBOOLE_0:def 3;
                suppose
A204:             x in rng h1 /\ rng gg;
                  then x in rng h1 by XBOOLE_0:def 4;
                  then consider i such that
A205:             i in dom h1 and
A206:             x=h1/.i by PARTFUN2:4;
A207:             x=G1*(i,k1) by A75,A205,A206;
                  reconsider y=x as Point of TOP-REAL 2 by A206;
A208:             Lmi/.k1 = Lmi.k1 by A50,PARTFUN1:def 8;
A209:             x in rng gg by A204,XBOOLE_0:def 4;
A210:             dom Col(G1,k1) = Seg len G1 by A198,FINSEQ_1:def 3
                    .= dom G1 by FINSEQ_1:def 3;
                  then
A211:             Ck1/.mi = Ck1.mi by A39,PARTFUN1:def 8;
A212:             i in dom Ck1 by A96,A205,A210;
                  Ck1/.i = Ck1.i by A96,A205,A210,PARTFUN1:def 8;
                  then y=Ck1/.i by A207,A210,A212,MATRIX_1:def 9;
                  then y in rng Ck1 by A212,PARTFUN2:4;
                  then
A213:             k1 =k by A52,A200,A209,GOBOARD1:20;
A214:             1 in Seg l by A157,FINSEQ_1:3;
                  then f/.1=f1/.ma1 & f1/.ma1=g1/.(w+1) by A169,A154,A199;
                  then f/.1= Ck1/.mi by A39,A51,A52,A208,A211,GOBOARD1:17;
                  then
A215:             f/.1 in rng Col(G1,k) by A39,A210,A213,PARTFUN2:4;
                  f/.1 in rng f by A156,A214,PARTFUN2:4;
                  hence contradiction by A201,A215,XBOOLE_0:def 4;
                end;
                suppose
A216:             x in rng h2 /\ rng gg;
                  then x in rng h2 by XBOOLE_0:def 4;
                  then consider i such that
A217:             i in dom h2 and
A218:             x=h2/.i by PARTFUN2:4;
A219:             x=G1*(ma+i,k2) by A132,A217,A218;
                  reconsider y=x as Point of TOP-REAL 2 by A218;
A220:             Lma/.k2 = Lma.k2 by A130,PARTFUN1:def 8;
A221:             x in rng gg by A216,XBOOLE_0:def 4;
A222:             dom Col(G1,k2) = Seg len G1 by A197,FINSEQ_1:def 3
                    .= dom G1 by FINSEQ_1:def 3;
                  then
A223:             Ck2/.ma = Ck2.ma by A41,PARTFUN1:def 8;
A224:             ma+i in dom Ck2 by A134,A217,A222;
                  Ck2/.(ma+i) = Ck2.(ma+i) by A134,A217,A222,PARTFUN1:def 8;
                  then y=Ck2/.(ma+i) by A219,A222,A224,MATRIX_1:def 9;
                  then y in rng Ck2 by A224,PARTFUN2:4;
                  then
A225:             k2=k by A133,A200,A221,GOBOARD1:20;
A226:             l in Seg l by A157,FINSEQ_1:3;
                  then f/.l=f1/.(w+l) & f1/.(w+l)=g1/.(w+l) by A169,A154;
                  then f/.l=Ck2/.ma by A41,A131,A133,A220,A223,GOBOARD1:17;
                  then
A227:             f/.l in rng Col(G1,k) by A41,A222,A225,PARTFUN2:4;
                  f/.l in rng f by A156,A226,PARTFUN2:4;
                  hence contradiction by A201,A227,XBOOLE_0:def 4;
                end;
              end;
              hence contradiction;
            end;
            rng h2 /\ rng g = {}
            proof
              consider x being Element of rng h2 /\ rng g;
              assume
A228:         not thesis;
              then x in rng h2 by XBOOLE_0:def 4;
              then consider n1 be Element of NAT such that
A229:         n1 in dom h2 and
A230:         x=h2/.n1 by PARTFUN2:4;
A231:         1<=n1 by A229,FINSEQ_3:27;
              ma+n1 in dom G1 by A134,A229;
              then
A232:         [ma+n1,k2] in Indices G1 by A133,A95,ZFMISC_1:106;
              x in rng g by A228,XBOOLE_0:def 4;
              then consider n2 be Element of NAT such that
A233:         n2 in dom g and
A234:         x=g/.n2 by PARTFUN2:4;
              consider i1,i2 be Element of NAT such that
A235:         [i1,i2] in Indices G1 and
A236:         g/.n2=G1*(i1,i2) by A15,A233,GOBOARD1:def 11;
              reconsider L=Line(G1,i1) as FinSequence of TOP-REAL 2;
A237:         i2 in Seg width G1 by A95,A235,ZFMISC_1:106;
A238:         Seg len L = dom L & len L=width G1 by FINSEQ_1:def 3
,MATRIX_1:def 8;
              then L/.i2 = L.i2 by A237,PARTFUN1:def 8;
              then g/.n2=L/.i2 by A236,A237,MATRIX_1:def 8;
              then
A239:         g/.n2 in rng L by A237,A238,PARTFUN2:4;
              g/.n2 in rng g by A233,PARTFUN2:4;
              then
A240:         rng g /\ rng L <> {} by A239,XBOOLE_0:def 4;
A241:         i1 in dom G1 by A95,A235,ZFMISC_1:106;
              x=G1*(ma+n1,k2) by A132,A229,A230;
              then i1=ma+n1 by A234,A235,A236,A232,GOBOARD1:21;
              then n1<=0 by A41,A241,A240,XREAL_1:31;
              hence contradiction by A231,XXREAL_0:2;
            end;
            then rng ff /\ rng g = ((rng h1 \/ rng f) /\ rng g) \/ {} by A195,
XBOOLE_1:23
              .= {} \/ rng f /\ rng g by A111,XBOOLE_1:23
              .= rng f /\ rng g;
            then
A242:       rng ff /\ rng g c= rng g1 /\ rng g2 by A18,A177,XBOOLE_1:27;
A243:       len DelCol(G1,1)=len G1 by A31,A151,GOBOARD1:def 10;
            then
A244:       dom DelCol(G1,1) = Seg len G1 by FINSEQ_1:def 3
              .= dom G1 by FINSEQ_1:def 3;
A245:       now
              let n;
              assume that
A246:         n in dom f and
A247:         n+1 in dom f;
              f/.n=f1/.(w+n) by A154,A156,A246;
              then
A248:         f/.n=g1 /.(w+n) by A169,A156,A246;
              f/.(n+1)=f1/.(w+(n+1)) by A154,A156,A247;
              then
A249:         w+n+1 in dom g1 & f/.(n+1)=g1/.(w+n+1) by A169,A156,A247;
              let i1,i2,j1,j2 be Element of NAT;
              assume
A250:         [i1,i2] in Indices G1 & [j1,j2] in Indices G1 & f/.n=
              G1*(i1,i2) & f/. (n+1)=G1*(j1,j2);
              w+n in dom g1 by A169,A156,A246;
              hence abs(i1-j1)+abs(i2-j2)=1 by A6,A248,A249,A250,
GOBOARD1:def 11;
            end;
            set hf=h1^f;
A251:       len ff=len(h1^f)+len h2 by FINSEQ_1:35
              .=len h1+len f+len h2 by FINSEQ_1:35;
A252:       now
              let i1,i2,j1,j2 be Element of NAT;
              assume that
A253:         [ i1,i2] in Indices G1 and
A254:         [j1,j2] in Indices G1 and
A255:         hf/.len hf=G1*(i1,i2) and
A256:         h2/.1=G1*(j1,j2) and
              len hf in dom hf and
A257:         1 in dom h2;
              ma+1 in dom G1 by A134,A257;
              then
A258:         [ma+1,k2] in Indices G1 by A133,A95,ZFMISC_1:106;
A259:         [ma,k2] in Indices G1 by A41,A133,A95,ZFMISC_1:106;
A260:         Lma/.k2 = Lma.k2 by A130,PARTFUN1:def 8;
A261:         len f in dom f by A154,A156,A157,FINSEQ_1:3;
              hf/.len hf=hf/.(len h1+len f) by FINSEQ_1:35
                .= f/.len f by A261,FINSEQ_4:84
                .= f1/.(w+l) by A154,A156,A261
                .= g1/.mi1 by A169,A154,A156,A261
                .= G1*(ma,k2) by A131,A133,A260,MATRIX_1:def 8;
              then
A262:         i1=ma & i2=k2 by A253,A255,A259,GOBOARD1:21;
              h2/.1=G1*(ma+1,k2) by A132,A257;
              then j1=ma+1 & j2=k2 by A254,A256,A258,GOBOARD1:21;
              hence abs(i1-j1)+abs(i2-j2)=abs(ma-(ma+1))+0 by A262,ABSVALUE:7
                .=abs(-(ma+1 -ma))
                .=abs(1) by COMPLEX1:138
                .=1 by ABSVALUE:def 1;
            end;
            now
A263:         [mi,k1] in Indices G1 by A39,A52,A95,ZFMISC_1:106;
A264:         Lmi/.k1 = Lmi.k1 by A50,PARTFUN1:def 8;
              let i1,i2,j1,j2 be Element of NAT;
              assume that
A265:         [i1,i2] in Indices G1 and
A266:         [j1,j2] in Indices G1 and
A267:         h1/.len h1=G1*(i1,i2) and
A268:         f/.1=G1*(j1,j2) and
A269:         len h1 in dom h1 and
A270:         1 in dom f;
              l1 in dom G1 by A75,A96,A269;
              then
A271:         [l1,k1] in Indices G1 by A52,A95,ZFMISC_1:106;
A272:         w+1=ma1;
              then f/.1=f1/.ma1 by A154,A156,A270;
              then f/.1=g1/.ma1 by A169,A156,A270,A272
                .= G1*(mi,k1) by A51,A52,A264,MATRIX_1:def 8;
              then
A273:         j1=mi & j2=k1 by A266,A268,A263,GOBOARD1:21;
              h1/.len h1=G1*(l1,k1) by A75,A269;
              then i1=l1 & i2=k1 by A265,A267,A271,GOBOARD1:21;
              hence abs(i1-j1)+abs(i2-j2)= abs(mi-1-mi)+0 by A273,ABSVALUE:7
                .= abs(-1)
                .= abs(1) by COMPLEX1:138
                .= 1 by ABSVALUE:def 1;
            end;
            then for n st n in dom(h1^f) & n+1 in dom(h1^f) for i1,i2,j1,j2
be Element of NAT st [i1,i2] in Indices G1 & [j1,j2] in Indices G1 & (h1^f)/.n=
G1*(i1,i2) & (h1^f)/.(n+1)=G1*(j1,j2) holds abs(i1-j1)+abs(i2-j2)=1 by A101
,A245,GOBOARD1:40;
            then
A274:       for n st n in dom ff & n+1 in dom ff for m,k,i,j st [m,k] in
Indices G1 & [i,j] in Indices G1 & ff/.n=G1*(m,k) & ff/.(n+1)=G1*(i,j) holds
            abs(m-i)+abs(k-j)=1 by A140,A252,GOBOARD1:40;
            now
              let n;
              assume
A275:         n in dom h1;
              take i=n,k1;
              n in dom G1 by A96,A275;
              hence
              [i,k1] in Indices G1 & h1/.n=G1*(i,k1) by A75,A52,A95,A275,
ZFMISC_1:106;
            end;
            then for n st n in dom(h1^f) ex i,j st [i,j] in Indices G1 & (h1^
            f)/.n=G1*(i,j) by A173,GOBOARD1:39;
            then for n st n in dom ff ex i,j st [i,j] in Indices G1 & ff/.n=
            G1*(i,j) by A138,GOBOARD1:39;
            then
A276:       ff is_sequence_on G1 by A274,GOBOARD1:def 11;
A277:       Seg len ff=dom ff by FINSEQ_1:def 3;
            then
A278:       len ff in dom ff by A251,A194,FINSEQ_1:3;
A279:       1 in dom ff by A251,A194,A277,FINSEQ_1:3;
            thus thesis
            proof
              per cases;
              suppose
A280:           rng f /\ rng Col(G1,1)={};
                set D = DelCol(G1,1);
                rng ff /\ rng Col(G1,1)={} by A31,A196,A280;
                then
A281:           rng ff misses rng Col(G1,1) by XBOOLE_0:def 7;
                then
A282:           ff is_sequence_on D & ff/.1 in rng Line(D,1) by A31,A26,A276
,A158,A151,A279,GOBOARD1:37,41;
A283:           ff/.len ff in rng Line(D,len D) by A31,A27,A182,A151,A243,A278
,A281,GOBOARD1:37;
                defpred P[Nat] means $1 in dom g & g/.$1 in rng Col(G1,1);
A284:           ex m be Nat st P[m]
                proof
                  take 1;
                  thus thesis by A10,A13,A32,FINSEQ_3:27,GOBOARD1:22;
                end;
A285:           for m be Nat st P[m] holds m<=len g by FINSEQ_3:27;
                consider m be Nat such that
A286:           P [m] & for k be Nat st P[k] holds k<=m from NAT_1:
                sch 6(A285,A284);
A287:           for k st P[k] holds k<=m by A286;
                reconsider m as Element of NAT by ORDINAL1:def 13;
                reconsider p=g/.m as Point of TOP-REAL 2;
A288:           now
                  assume
A289:             m>=len g;
                  m<=len g by A286,FINSEQ_3:27;
                  then p in rng Col(G1,width G1) by A28,A289,XXREAL_0:1;
                  then 1=k+1 by A3,A31,A74,A286,GOBOARD1:20;
                  hence contradiction by A92;
                end;
                then reconsider ll = len g-m as Element of NAT by INT_1:18;
                deffunc F(Nat) = g/.(m+$1);
                consider t be FinSequence of TOP-REAL 2 such that
A290:           len t = ll & for n being Nat st n in dom t holds t/.
                n = F(n) from FINSEQ_4:sch 2;
A291:           dom t = Seg ll by A290,FINSEQ_1:def 3;
A292:           rng t c= rng g
                proof
                  let y;
                  assume y in rng t;
                  then consider x being Element of NAT such that
A293:             x in dom t and
A294:             t/.x=y by PARTFUN2:4;
                  x<=ll by A291,A293,FINSEQ_1:3;
                  then
A295:             m+x<=m+ll by XREAL_1:9;
A296:             x<=x+m by NAT_1:11;
                  1<=x by A291,A293,FINSEQ_1:3;
                  then 1<=x+m by A296,XXREAL_0:2;
                  then m+x in dom g by A295,FINSEQ_3:27;
                  then g/.(m+x) in rng g by PARTFUN2:4;
                  hence thesis by A290,A293,A294;
                end;
A297:           for n st n in dom t holds m+n in dom g
                proof
                  let n;
A298:             n<=n+m by NAT_1:11;
                  assume
A299:             n in dom t;
                  then n<=ll by A291,FINSEQ_1:3;
                  then
A300:             m+n<=m+ll by XREAL_1:9;
                  1<=n by A291,A299,FINSEQ_1:3;
                  then 1<=n+m by A298,XXREAL_0:2;
                  hence thesis by A300,FINSEQ_3:27;
                end;
A301:           Seg len t = dom t by FINSEQ_1:def 3;
                reconsider t as FinSequence of TOP-REAL 2;
A302:           width D = k by A3,A31,A92,GOBOARD1:26,NAT_1:3;
A303:           Indices D = [:dom D,Seg width D:] by MATRIX_1:def 5;
A304:           now
                  let n;
                  assume
A305:             n in dom t;
                  then m+n in dom g by A297;
                  then consider i1,i2 be Element of NAT such that
A306:             [i1,i2] in Indices G1 and
A307:             g/.(m+n)=G1*(i1,i2) by A15,GOBOARD1:def 11;
A308:             i2 in Seg width G1 by A95,A306,ZFMISC_1:106;
                  then
A309:             1<=i2 by FINSEQ_1:3;
                  then reconsider l=i2-1 as Element of NAT by INT_1:18;
                  reconsider Ci2 = Col(G1,i2) as FinSequence of TOP-REAL 2;
A310:             i1 in dom G1 by A95,A306,ZFMISC_1:106;
                  len Ci2 = len G1 by MATRIX_1:def 9;
                  then
A311:             dom Ci2 = Seg len G1 by FINSEQ_1:def 3
                    .= dom G1 by FINSEQ_1:def 3;
                  then Ci2/.i1 = Ci2.i1 by A310,PARTFUN1:def 8;
                  then Ci2/.i1 = G1*(i1,i2) by A310,MATRIX_1:def 9;
                  then
A312:             g/.(m+n) in rng Col(G1,i2) by A307,A310,A311,PARTFUN2:4;
                  now
                    1<=n by A291,A305,FINSEQ_1:3;
                    then
A313:               m+1<=m+n by XREAL_1:9;
                    assume i2=1;
                    then m+n<=m by A286,A297,A305,A312;
                    then m+1<=m by A313,XXREAL_0:2;
                    then 1<=m-m by XREAL_1:21;
                    then 1<=0;
                    hence contradiction;
                  end;
                  then 1<i2 by A309,XXREAL_0:1;
                  then 1+1<=i2 by NAT_1:13;
                  then
A314:             1<=l by XREAL_1:21;
                  take i1;
                  take l;
A315:             t/.n=g/.(m+n) by A290,A305;
                  i2<=width G1 by A308,FINSEQ_1:3;
                  then
A316:             l<=width D by A3,A302,XREAL_1:22;
                  then l in Seg width D by A314,FINSEQ_1:3;
                  hence [i1,l] in Indices D by A244,A303,A310,ZFMISC_1:106;
                  l+1=i2;
                  hence
                  t/.n = D*(i1,l) by A3,A31,A93,A302,A307,A310,A315,A314,A316,
GOBOARD1:32;
                end;
                0<>width D by GOBOARD1:def 5;
                then 0<width D by NAT_1:3;
                then
A317:           0+1<=width D by NAT_1:13;
                then
A318:           Col(D,1)=Col(G1,1+1) & 1+1 in Seg width G1 by A3,A31,A93,A302,
GOBOARD1:30;
                m+1<=len g by A288,NAT_1:13;
                then
A319:           1<=len t by A290,XREAL_1:21;
                then 1 in Seg ll by A290,FINSEQ_1:3;
                then t/.1 = g/.(m+1) by A290,A301;
                then
A320:           t/.1 in rng Col(D,1) by A32,A15,A28,A31,A286,A287,A318,
GOBOARD1:48;
                now
                  let n;
                  assume that
A321:             n in dom t and
A322:             n+1 in dom t;
                  let i1,i2,j1,j2 be Element of NAT;
                  assume that
A323:             [ i1,i2] in Indices D and
A324:             [j1,j2] in Indices D and
A325:             t/.n=D*(i1,i2) and
A326:             t/.(n+1)=D*(j1,j2);
A327:             i1 in dom D by A303,A323,ZFMISC_1:106;
                  i2 in Seg k by A302,A303,A323,ZFMISC_1:106;
                  then
A328:             1<=i2 & i2<=k by FINSEQ_1:3;
                  then i2+1 in Seg width G1 by A3,A31,A93,A244,A327,GOBOARD1:32
;
                  then
A329:             [i1,i2+1] in Indices G1 by A95,A244,A327,ZFMISC_1:106;
                  t/.n=g/.(m+n) by A290,A321;
                  then
A330:             g/.(m+n)=G1*(i1,i2+1) by A3,A31,A93,A244,A325,A327,A328,
GOBOARD1:32;
                  m+(n+1)=m+n+1;
                  then
A331:             m+n+1 in dom g by A297,A322;
A332:             j1 in dom D by A303,A324,ZFMISC_1:106;
                  j2 in Seg k by A302,A303,A324,ZFMISC_1:106;
                  then
A333:             1<=j2 & j2<=k by FINSEQ_1:3;
                  then j2+1 in Seg width G1 by A3,A31,A93,A244,A327,GOBOARD1:32
;
                  then
A334:             [j1,j2+1] in Indices G1 by A95,A244,A332,ZFMISC_1:106;
                  t/.(n+1)=g/.(m+(n+1)) by A290,A322;
                  then
A335:             g/.(m+n+1)=G1* (j1,j2+1) by A3,A31,A93,A244,A326,A332,A333,
GOBOARD1:32;
                  m+n in dom g by A297,A321;
                  hence 1= abs(i1-j1)+abs(i2+1 -(j2+1)) by A15,A330,A335,A329
,A334,A331,GOBOARD1:def 11
                    .=abs(i1-j1)+abs(i2-j2);
                end;
                then
A336:           t is_sequence_on D by A304,GOBOARD1:def 11;
                consider x being Element of rng ff /\ rng t;
A337:           rng ff /\ rng t c= rng ff /\ rng g by A292,XBOOLE_1:26;
                len t in Seg ll by A290,A319,FINSEQ_1:3;
                then t/.len t = g/.(m+ll) by A290,A301
                  .= g/.len g;
                then t/.len t in rng Col(D,width D) by A3,A28,A31,A93,A302,A317
,GOBOARD1:30;
                then rng ff /\ rng t <> {} by A2,A93,A251,A194,A302,A319,A320
,A336,A282,A283;
                then x in rng ff /\ rng g by A337,TARSKI:def 3;
                hence thesis by A242;
              end;
              suppose
A338:           rng f /\ rng Col(G1,1) <> {};
                set D = DelCol(G1,width G1);
A339:           0+1<k+1 by A93,XREAL_1:8;
                now
                  per cases;
                  suppose
                    rng f /\ rng Col(G1,width G1) = {};
                    then rng ff /\ rng Col(G1,width G1) = {} by A74,A196;
                    then
A340:               rng ff misses rng Col(G1,width G1) by XBOOLE_0:def 7;
                    then
A341:               ff is_sequence_on D by A74,A276,A151,GOBOARD1:41;
                    consider t be FinSequence of TOP-REAL 2 such that
A342:               t/.1 in rng Col(D,1) & t/.len t in rng Col(D,
                    width D) & 1<=len t & t is_sequence_on D and
A343:               rng t c= rng g by A3,A32,A15,A14,A28,A339,GOBOARD1:51;
                    consider x being Element of rng ff /\ rng t;
A344:               rng ff /\ rng t c= rng ff /\ rng g by A343,XBOOLE_1:26;
A345:               width D = k by A3,A74,A92,GOBOARD1:26,NAT_1:3;
                    ff/.1 in rng Line(D,1) & ff/.len ff in rng Line(D,
len D) by A74,A26,A27,A158,A182,A151,A152,A279,A278,A340,GOBOARD1:37;
                    then rng ff /\ rng t <> {} by A2,A93,A251,A194,A342,A345
,A341;
                    then x in rng ff /\ rng g by A344,TARSKI:def 3;
                    hence thesis by A242;
                  end;
                  suppose
A346:               rng f /\ rng Col(G1,width G1) <> {};
A347:               f is_sequence_on G1 by A173,A245,GOBOARD1:def 11;
                    then consider t be FinSequence of TOP-REAL 2 such that
A348:               rng t c= rng f and
A349:               t/.1 in rng Col(G1,1) & t/.len t in rng Col(G1,
width G1) & 1<=len t & t is_sequence_on G1 by A338,A346,GOBOARD1:52;
                    consider tt be FinSequence of TOP-REAL 2 such that
A350:               tt/.1 in rng Col(D,1) & tt/.len tt in rng Col(D,
                    width D) & 1<=len tt & tt is_sequence_on D and
A351:               rng tt c= rng t by A3,A339,A349,GOBOARD1:51;
A352:               Seg len Lma = dom Lma & len Lma=width G1 by FINSEQ_1:def 3
,MATRIX_1:def 8;
                    reconsider lg=len g-1 as Element of NAT by A32,INT_1:18;
                    defpred P[Nat] means $1 in dom g & g/.$1 in rng Line(G1,mi
                    );
                    defpred R[Nat] means $1 in dom g & g/.$1 in rng Line(G1,ma
                    );
A353:               lg<=len g by XREAL_1:45;
A354:               now
                      consider x being Element of rng g /\ rng Line(G1,mi);
                      x in rng g by A39,XBOOLE_0:def 4;
                      then consider n such that
A355:                 n in dom g & x=g/.n by PARTFUN2:4;
                      reconsider n as Nat;
                      take n;
                      thus P[n] by A39,A355,XBOOLE_0:def 4;
                    end;
                    consider pf be Nat such that
A356:               P [pf] & for n be Nat st P[n] holds pf<=n from
                    NAT_1:sch 5(A354);
                    defpred PP[Element of NAT] means $1 in dom f implies for m
                    st m in dom G1 & f/.$1 in rng Line(G1,m) holds mi<=m;
                    reconsider C = Col(G1,width G1), Li= Line(G1,mi), La= Line
                    (G1,ma) as FinSequence of TOP-REAL 2;
A357:               lg+ 1=len g;
A358:               now
                      consider x being Element of rng g /\ rng Line(G1,ma);
                      x in rng g by A41,XBOOLE_0:def 4;
                      then consider n such that
A359:                 n in dom g & x=g/.n by PARTFUN2:4;
                      reconsider n as Nat;
                      take n;
                      thus R[n] by A41,A359,XBOOLE_0:def 4;
                    end;
                    consider pl be Nat such that
A360:               R [pl] & for n be Nat st R[n] holds pl<=n from
                    NAT_1:sch 5(A358);
                    reconsider pf,pl as Element of NAT by ORDINAL1:def 13;
A361:               1<=pf by A356,FINSEQ_3:27;
                    consider K2 be Element of NAT such that
A362:               K2 in dom Lma and
A363:               g/.pl=Lma/.K2 by A360,PARTFUN2:4;
                    reconsider CK2 = Col(G1,K2) as FinSequence of TOP-REAL 2;
                    consider K1 be Element of NAT such that
A364:               K1 in dom Li and
A365:               g/.pf=Li/.K1 by A356,PARTFUN2:4;
                    reconsider CK1 = Col(G1,K1) as FinSequence of TOP-REAL 2;
                    deffunc F(Nat) = G1*($1,K1);
                    consider h1 be FinSequence of TOP-REAL 2 such that
A366:               len h1 = l1 & for n being Nat st n in dom h1
                    holds h1/.n=F(n) from FINSEQ_4:sch 2;
A367:               for k st PP[k] holds PP[k+1]
                    proof
                      let k such that
A368:                 PP[k];
                      assume
A369:                 k+1 in dom f;
                      let m such that
A370:                 m in dom G1 & f/.(k+1) in rng Line(G1,m);
                      now
                        per cases;
                        suppose
A371:                     k=0;
                          w+1=ma1 & 1 in Seg l by A157,FINSEQ_1:3;
                          then f/.1=f1/.ma1 & f1/.ma1=g1/.ma1 by A169,A154;
                          then f/.(k+1) in rng Li by A50,A51,A371,PARTFUN2:4;
                          hence thesis by A39,A370,GOBOARD1:19;
                        end;
                        suppose
                          k<>0;
                          then 0<k by NAT_1:3;
                          then
A372:                     0+1<=k by NAT_1:13;
                          k+1<=len f by A369,FINSEQ_3:27;
                          then
A373:                     k<=len f by NAT_1:13;
                          then
A374:                     k in dom f by A372,FINSEQ_3:27;
                          then consider i1,i2 be Element of NAT such that
A375:                     [i1,i2] in Indices G1 and
A376:                     f/.k=G1*(i1,i2) by A173;
A377:                     i2 in Seg width G1 by A95,A375,ZFMISC_1:106;
                          consider j1,j2 be Element of NAT such that
A378:                     [ j1,j2] in Indices G1 and
A379:                     f/.(k+1)=G1*(j1,j2) by A173,A369;
                          reconsider Lj1 = Line(G1,j1) as FinSequence of
                          TOP-REAL 2;
A380:                     j2 in Seg width G1 by A95,A378,ZFMISC_1:106;
A381:                     Seg len Lj1 = dom Lj1 & len Lj1=width G1 by
FINSEQ_1:def 3,MATRIX_1:def 8;
                          then Lj1/.j2 = Lj1.j2 by A380,PARTFUN1:def 8;
                          then f/.(k+1)=Lj1/.j2 by A379,A380,MATRIX_1:def 8;
                          then
A382:                     f/.(k+1) in rng Lj1 by A380,A381,PARTFUN2:4;
A383:                     j1 in dom G1 by A95,A378,ZFMISC_1:106;
                          reconsider Li1 = Line(G1,i1) as FinSequence of
                          TOP-REAL 2;
A384:                     i1 in dom G1 by A95,A375,ZFMISC_1:106;
A385:                     Seg len Li1 = dom Li1 & len Li1=width G1 by
FINSEQ_1:def 3,MATRIX_1:def 8;
                          then
A386:                     Li1/.i2 = Li1.i2 by A377,PARTFUN1:def 8;
                          then f/.k=Li1/.i2 by A376,A377,MATRIX_1:def 8;
                          then
A387:                     f/.k in rng Li1 by A377,A385,PARTFUN2:4;
                          then
A388:                     mi<=i1 by A368,A372,A373,A384,FINSEQ_3:27;
                          now
                            per cases by A388,XXREAL_0:1;
                            suppose
A389:                         mi=i1;
                              g1/.(w+k) = f1/.(w+k) by A169,A156,A374
                                .= f/.k by A154,A156,A374
                                .= Li1/.i2 by A376,A377,A386,MATRIX_1:def 8;
                              then g1/.(w+k) in rng Line(G1,mi) by A377,A385
,A389,PARTFUN2:4;
                              then
A390:                         w+k<=ma1 by A46,A169,A156,A374;
                              w+1<=w+k by A372,XREAL_1:9;
                              then w+k=ma1 by A390,XXREAL_0:1;
                              then
A391:                         ma1+1=w+(k+1);
                              mi+1<=ma by A127,NAT_1:13;
                              then
A392:                         mi+1<=len G1 by A48,XXREAL_0:2;
                              1<=mi+1 by A42,NAT_1:13;
                              then
A393:                         mi+1 in dom G1 by A392,FINSEQ_3:27;
                              f /.(k+1)=f1/.(w+(k+1)) & f1/.(w+(k+1))=g1
                              /.(w+(k+1)) by A169,A154,A156,A369;
                              then f/.(k+1) in rng Line(G1,mi+1) by A4,A6,A9
,A39,A46,A49,A391,A393,GOBOARD1:44;
                              then m=mi+1 by A370,A393,GOBOARD1:19;
                              hence thesis by NAT_1:11;
                            end;
                            suppose
A394:                         mi<i1;
                              now
                                per cases by A347,A369,A374,A384,A387,
GOBOARD1:43;
                                suppose
                                  f/.(k+1) in rng Line(G1,i1);
                                  hence thesis by A370,A384,A394,GOBOARD1:19;
                                end;
                                suppose
                                  for l be Element of NAT st f/.(k+1
) in rng Line(G1,l) & l in dom G1 holds abs(i1-l)=1;
                                  then
A395:                             abs(i1 -j1)=1 by A383,A382;
                                  now
                                    per cases by A395,SEQM_3:81;
                                    suppose
A396:                                 j1<i1 & i1=j1+1;
                                      then mi<=i1-1 by A394,NAT_1:13;
                                      hence thesis by A370,A383,A382,A396,
GOBOARD1:19;
                                    end;
                                    suppose
                                      i1<j1 & j1=i1+1;
                                      then mi<j1 by A394,XXREAL_0:2;
                                      hence thesis by A370,A383,A382,
GOBOARD1:19;
                                    end;
                                  end;
                                  hence thesis;
                                end;
                              end;
                              hence thesis;
                            end;
                          end;
                          hence thesis;
                        end;
                      end;
                      hence thesis;
                    end;
A397:               Seg len Li = dom Li & len Li=width G1 by FINSEQ_1:def 3
,MATRIX_1:def 8;
A398:               now
                      let n;
A399:                 l1<=mi by XREAL_1:45;
                      assume
A400:                 n in dom h1;
                      then
A401:                 1<=n by FINSEQ_3:27;
                      n<=l1 by A366,A400,FINSEQ_3:27;
                      then
A402:                 n<=mi by A399,XXREAL_0:2;
                      mi<= len G1 by A39,FINSEQ_3:27;
                      then n<=len G1 by A402,XXREAL_0:2;
                      hence n in dom G1 by A401,FINSEQ_3:27;
                    end;
A403:               now
                      let n;
                      assume
A404:                 n in dom h1;
                      take i=n,K1;
                      n in dom G1 by A398,A404;
                      hence
                      [i,K1] in Indices G1 & h1/.n=G1*(i,K1) by A95,A364,A397
,A366,A404,ZFMISC_1:106;
                    end;
A405:               now
                      let n;
                      assume that
A406:                 n in dom h1 and
A407:                 n+1 in dom h1;
                      n+1 in dom G1 by A398,A407;
                      then
A408:                 [n+1,K1 ] in Indices G1 by A95,A364,A397,ZFMISC_1:106;
                      let i1,i2,j1,j2 be Element of NAT;
                      assume that
A409:                 [i1,i2] in Indices G1 and
A410:                 [j1,j2] in Indices G1 and
A411:                 h1/.n=G1*(i1,i2) and
A412:                 h1/.(n+1)=G1*(j1,j2);
                      h1/.(n+1)=G1*(n+1,K1) by A366,A407;
                      then
A413:                 j1=n+1 & j2=K1 by A408,A410,A412,GOBOARD1:21;
                      n in dom G1 by A398,A406;
                      then
A414:                 [n,K1] in Indices G1 by A95,A364,A397,ZFMISC_1:106;
                      h1/.n=G1*(n,K1) by A366,A406;
                      then i1=n & i2=K1 by A414,A409,A411,GOBOARD1:21;
                      hence abs(i1-j1)+abs(i2-j2)= abs(n-n+-1)+0 by A413,
ABSVALUE:7
                        .= abs(1) by COMPLEX1:138
                        .= 1 by ABSVALUE:def 1;
                    end;
A415:               pf<=len g by A356,FINSEQ_3:27;
A416:               Lma/.K2 = Lma.K2 by A362,PARTFUN1:def 8;
                    then
A417:               g/.pl=G1*(ma, K2) by A362,A363,A352,MATRIX_1:def 8;
                    deffunc F(Nat) = G1*(ma+$1,K2);
                    consider h2 be FinSequence of TOP-REAL 2 such that
A418:               len h2=l2 & for n being Nat st n in dom h2 holds
                    h2/.n=F(n) from FINSEQ_4:sch 2;
A419:               PP[0] by FINSEQ_3:27;
A420:               for n holds PP[n] from NAT_1:sch 1(A419,A367);
A421:               rng h1 /\ rng tt = {}
                    proof
                      consider x being Element of rng h1 /\ rng tt;
                      assume
A422:                 not thesis;
                      then x in rng h1 by XBOOLE_0:def 4;
                      then consider i2 be Element of NAT such that
A423:                 i2 in dom h1 and
A424:                 h1/.i2=x by PARTFUN2:4;
                      Seg len h1 = dom h1 by FINSEQ_1:def 3;
                      then
A425:                 l1<mi & i2<=l1 by A366,A423,FINSEQ_1:3,XREAL_1:46;
                      i2 in dom G1 by A398,A423;
                      then
A426:                 [i2,K1] in Indices G1 by A95,A364,A397,ZFMISC_1:106;
                      x in rng tt by A422,XBOOLE_0:def 4;
                      then x in rng t by A351;
                      then consider i1 be Element of NAT such that
A427:                 i1 in dom f and
A428:                 f/.i1=x by A348,PARTFUN2:4;
                      consider n1,n2 be Element of NAT such that
A429:                 [n1,n2] in Indices G1 and
A430:                 f/.i1=G1*(n1,n2) by A173,A427;
                      reconsider Ln1 = Line(G1,n1) as FinSequence of TOP-REAL
                      2;
A431:                 n2 in Seg width G1 by A95,A429,ZFMISC_1:106;
A432:                 Seg len Ln1 = dom Ln1 & len Ln1=width G1 by
FINSEQ_1:def 3,MATRIX_1:def 8;
                      then Ln1/.n2 = Ln1.n2 by A431,PARTFUN1:def 8;
                      then f/.i1=Ln1/.n2 by A430,A431,MATRIX_1:def 8;
                      then
A433:                 f/.i1 in rng Ln1 by A431,A432,PARTFUN2:4;
                      n1 in dom G1 by A95,A429,ZFMISC_1:106;
                      then
A434:                 mi<=n1 by A420,A427,A433;
                      x=G1*(i2,K1) by A366,A423,A424;
                      then i2=n1 by A428,A429,A430,A426,GOBOARD1:21;
                      hence contradiction by A434,A425,XXREAL_0:2;
                    end;
                    defpred PP[Element of NAT] means $1 in dom f implies for m
                    st m in dom G1 & f/.$1 in rng Line(G1,m) holds m<=ma;
A435:               for k st PP[k] holds PP[k+1]
                    proof
                      let k such that
A436:                 PP[k];
                      assume
A437:                 k+1 in dom f;
                      let m such that
A438:                 m in dom G1 & f/.(k+1) in rng Line(G1,m);
                      now
                        per cases;
                        suppose
A439:                     k=0;
                          1 in Seg l by A157,FINSEQ_1:3;
                          then f/.1=f1/.(w+1) & f1/.(w+1)=g1/.(w+1) by A169
,A154;
                          then f/.(k+1) in rng Li by A50,A51,A439,PARTFUN2:4;
                          hence thesis by A39,A126,A438,GOBOARD1:19;
                        end;
                        suppose
A440:                     k<>0;
A441:                     k+1<= len f by A176,A437,FINSEQ_1:3;
                          then
A442:                     k<=len f by NAT_1:13;
                          consider j1,j2 be Element of NAT such that
A443:                     [ j1,j2] in Indices G1 and
A444:                     f/.(k+1)=G1*(j1,j2) by A173,A437;
                          reconsider Lj1 = Line(G1,j1) as FinSequence of
                          TOP-REAL 2;
A445:                     j2 in Seg width G1 by A95,A443,ZFMISC_1:106;
A446:                     Seg len Lj1 = dom Lj1 & len Lj1=width G1 by
FINSEQ_1:def 3,MATRIX_1:def 8;
                          then Lj1/.j2 = Lj1.j2 by A445,PARTFUN1:def 8;
                          then f/.(k+1)=Lj1/.j2 by A444,A445,MATRIX_1:def 8;
                          then
A447:                     f/.(k+1) in rng Lj1 by A445,A446,PARTFUN2:4;
A448:                     j1 in dom G1 by A95,A443,ZFMISC_1:106;
                          then
A449:                     j1=m by A438,A447,GOBOARD1:19;
                          0<k by A440,NAT_1:3;
                          then
A450:                     0+1<=k by NAT_1:13;
                          then
A451:                     k in dom f by A442,FINSEQ_3:27;
                          then consider i1,i2 be Element of NAT such that
A452:                     [i1,i2] in Indices G1 and
A453:                     f/.k=G1*(i1,i2) by A173;
                          reconsider Li1 = Line(G1,i1) as FinSequence of
                          TOP-REAL 2;
A454:                     i2 in Seg width G1 by A95,A452,ZFMISC_1:106;
A455:                     Seg len Li1 = dom Li1 & len Li1=width G1 by
FINSEQ_1:def 3,MATRIX_1:def 8;
                          then Li1/.i2 = Li1.i2 by A454,PARTFUN1:def 8;
                          then f/.k=Li1/.i2 by A453,A454,MATRIX_1:def 8;
                          then
A456:                     f/.k in rng Li1 by A454,A455,PARTFUN2:4;
A457:                     i1 in dom G1 by A95,A452,ZFMISC_1:106;
                          then
A458:                     i1<=ma by A436,A450,A442,A456,FINSEQ_3:27;
                          now
                            per cases by A458,XXREAL_0:1;
                            case
A459:                         ma=i1;
A460:                         w+1<=w+k by A450,XREAL_1:9;
A461:                         f /.k=f1/.(w+k) & f1/.(w+k)=g1/.(w+k) by A169
,A154,A156,A451;
                              then ma1 <> w+k by A39,A41,A46,A94,A456,A459,
GOBOARD1:19;
                              then ma1<w+k by A460,XXREAL_0:1;
                              then
A462:                         mi1<=w+k by A129,A169,A156,A451,A456,A459,A461;
                              w+k<=mi1 by A154,A155,A442,XREAL_1:9;
                              then w+k=mi1 by A462,XXREAL_0:1;
                              hence contradiction by A154,A441,NAT_1:13;
                            end;
                            case
A463:                         i1<ma;
                              now
                                per cases by A347,A437,A451,A457,A456,
GOBOARD1:43;
                                suppose
                                  f/.(k+1) in rng Line(G1,i1);
                                  hence thesis by A438,A457,A463,GOBOARD1:19;
                                end;
                                suppose
                                  for l be Element of NAT st f/.(k+1
) in rng Line(G1,l) & l in dom G1 holds abs(i1-l)=1;
                                  then
A464:                             abs(i1 -j1)=1 by A448,A447;
                                  now
                                    per cases by A464,SEQM_3:81;
                                    suppose
                                      j1<i1 & i1=j1+1;
                                      hence thesis by A449,A463,XXREAL_0:2;
                                    end;
                                    suppose
                                      i1<j1 & j1=i1+1;
                                      hence thesis by A449,A463,NAT_1:13;
                                    end;
                                  end;
                                  hence thesis;
                                end;
                              end;
                              hence thesis;
                            end;
                          end;
                          hence thesis;
                        end;
                      end;
                      hence thesis;
                    end;
A465:               Seg len h1 = dom h1 by FINSEQ_1:def 3;
A466:               now
                      let n;
A467:                 n<=n+ma by NAT_1:11;
                      assume
A468:                 n in dom h2;
                      then n<=l2 by A418,FINSEQ_3:27;
                      then
A469:                 ma+n<=ma+l2 by XREAL_1:9;
                      1<=n by A468,FINSEQ_3:27;
                      then 1<=n+ma by A467,XXREAL_0:2;
                      hence ma+n in dom G1 by A469,FINSEQ_3:27;
                    end;
A470:               now
                      let n;
                      assume
A471:                 n in dom h2;
                      take m=ma+n,K2;
                      ma+n in dom G1 by A466,A471;
                      hence
                      [m,K2] in Indices G1 & h2/.n=G1*(m,K2) by A95,A362,A352
,A418,A471,ZFMISC_1:106;
                    end;
A472:               now
                      let n;
                      assume that
A473:                 n in dom h2 and
A474:                 n+1 in dom h2;
                      ma+(n+1) in dom G1 by A466,A474;
                      then
A475:                 [ma+ n+1,K2] in Indices G1 by A95,A362,A352,ZFMISC_1:106;
                      let i1,i2,j1,j2 be Element of NAT;
                      assume that
A476:                 [i1,i2] in Indices G1 and
A477:                 [j1,j2] in Indices G1 and
A478:                 h2/.n=G1*(i1,i2) and
A479:                 h2/.(n+1)=G1*(j1,j2);
                      h2/.(n+1)=G1*(ma+(n+1),K2) by A418,A474;
                      then
A480:                 j1=ma+n+1 & j2=K2 by A475,A477,A479,GOBOARD1:21;
                      ma +n in dom G1 by A466,A473;
                      then
A481:                 [ma+n,K2] in Indices G1 by A95,A362,A352,ZFMISC_1:106;
                      h2/.n=G1*(ma+n,K2) by A418,A473;
                      then i1=ma+n & i2=K2 by A481,A476,A478,GOBOARD1:21;
                      hence abs(i1-j1)+abs(i2-j2)= abs(ma+n-(ma+n)+-1)+0 by
A480,ABSVALUE:7
                        .= abs(1) by COMPLEX1:138
                        .= 1 by ABSVALUE:def 1;
                    end;
A482:               Seg len h2 = dom h2 by FINSEQ_1:def 3;
A483:               pl<=len g by A360,FINSEQ_3:27;
A484:               1<=pl by A360,FINSEQ_3:27;
A485:               pl <> pf by A39,A41,A94,A356,A360,GOBOARD1:19;
                    now
                      per cases by A485,XXREAL_0:1;
                      suppose
                        pf<pl;
                        then pf<len g by A483,XXREAL_0:2;
                        then 1<len g by A361,XXREAL_0:2;
                        hence 1+1<=len g by NAT_1:13;
                      end;
                      suppose
                        pf>pl;
                        then pl<len g by A415,XXREAL_0:2;
                        then 1<len g by A484,XXREAL_0:2;
                        hence 1+1<=len g by NAT_1:13;
                      end;
                    end;
                    then 1<=len g - 1 by XREAL_1:21;
                    then
A486:               lg in dom g by A353,FINSEQ_3:27;
A487:               PP[0] by FINSEQ_3:27;
A488:               for n holds PP[n] from NAT_1:sch 1(A487,A435);
A489:               rng h2 /\ rng tt = {}
                    proof
                      consider x being Element of rng h2 /\ rng tt;
                      assume
A490:                 not thesis;
                      then x in rng h2 by XBOOLE_0:def 4;
                      then consider i2 be Element of NAT such that
A491:                 i2 in dom h2 and
A492:                 h2/.i2=x by PARTFUN2:4;
                      0+1<=i2 by A491,FINSEQ_3:27;
                      then
A493:                 0<i2 by NAT_1:13;
                      ma+i2 in dom G1 by A466,A491;
                      then
A494:                 [ma+i2,K2] in Indices G1 by A95,A362,A352,ZFMISC_1:106;
                      x in rng tt by A490,XBOOLE_0:def 4;
                      then x in rng t by A351;
                      then consider i1 be Element of NAT such that
A495:                 i1 in dom f and
A496:                 f/.i1=x by A348,PARTFUN2:4;
                      consider n1,n2 be Element of NAT such that
A497:                 [n1,n2] in Indices G1 and
A498:                 f/.i1=G1*(n1,n2) by A173,A495;
                      reconsider Ln1 = Line(G1,n1) as FinSequence of TOP-REAL
                      2;
A499:                 n2 in Seg width G1 by A95,A497,ZFMISC_1:106;
A500:                 Seg len Ln1 = dom Ln1 & len Ln1=width G1 by
FINSEQ_1:def 3,MATRIX_1:def 8;
                      then Ln1/.n2 = Ln1.n2 by A499,PARTFUN1:def 8;
                      then f/.i1=Ln1/.n2 by A498,A499,MATRIX_1:def 8;
                      then
A501:                 f/.i1 in rng Ln1 by A499,A500,PARTFUN2:4;
A502:                 n1 in dom G1 by A95,A497,ZFMISC_1:106;
                      x=G1*(ma+i2,K2) by A418,A491,A492;
                      then ma+i2=n1 by A496,A497,A498,A494,GOBOARD1:21;
                      hence contradiction by A488,A495,A502,A501,A493,
XREAL_1:31;
                    end;
                    1<=len g by A13,GOBOARD1:38;
                    then
A503:               len g in dom g by FINSEQ_3:27;
A504:               dom g c= dom g2 by A23,A24,A16,A17,FINSEQ_1:7;
                    now
                      consider i2 be Element of NAT such that
A505:                 i2 in dom C and
A506:                 C/.i2=g/.len g by A28,PARTFUN2:4;
A507:                 dom C = Seg len C by FINSEQ_1:def 3
                        .= Seg len G1 by MATRIX_1:def 9
                        .= dom G1 by FINSEQ_1:def 3;
                      then
A508:                 [i2,width G1] in Indices G1 by A74,A95,A505,ZFMISC_1:106;
                      C/.i2 = C.i2 by A505,PARTFUN1:def 8;
                      then
A509:                 g/.len g=G1*(i2,width G1) by A505,A506,A507,
MATRIX_1:def 9;
                      assume
A510:                 pl=len g;
                      consider n1,n2 be Element of NAT such that
A511:                 [n1,n2] in Indices G1 and
A512:                 g/.lg=G1*(n1,n2) by A15,A486,GOBOARD1:def 11;
A513:                 n1 in dom G1 by A95,A511,ZFMISC_1:106;
A514:                 n2 in Seg width G1 by A95,A511,ZFMISC_1:106;
                      [ma,K2] in Indices G1 by A41,A95,A362,A352,ZFMISC_1:106;
                      then i2=ma by A417,A510,A509,A508,GOBOARD1:21;
                      then
A515:                 abs(n1-ma)+abs(n2- width G1)=1 by A15,A486,A503,A357,A509
,A508,A511,A512,GOBOARD1:def 11;
                      now
                        per cases by A515,SEQM_3:82;
                        suppose
A516:                     abs(n1-ma)=1 & n2=width G1;
A517:                     dom C = Seg len C by FINSEQ_1:def 3
                            .= Seg len G1 by MATRIX_1:def 9
                            .= dom G1 by FINSEQ_1:def 3;
                          then C/.n1 = C.n1 by A513,PARTFUN1:def 8;
                          then g/.lg=C/.n1 by A512,A513,A516,MATRIX_1:def 9;
                          then
A518:                     g/.lg in rng C by A513,A517,PARTFUN2:4;
                          g/.lg=g2/.lg by A13,A24,A17,A486,FINSEQ_4:86;
                          hence contradiction by A13,A17,A486,A504,A518,
XREAL_1:46;
                        end;
                        suppose
A519:                     abs(n2-width G1)=1 & n1=ma;
                          len Lma = width G1 by MATRIX_1:def 8;
                          then
A520:                     n2 in dom Lma by A514,FINSEQ_1:def 3;
                          then La/.n2 = Lma.n2 by PARTFUN1:def 8;
                          then g/.lg=Lma/.n2 by A512,A514,A519,MATRIX_1:def 8;
                          then g/.lg in rng Lma by A520,PARTFUN2:4;
                          hence contradiction by A360,A486,A510,XREAL_1:46;
                        end;
                      end;
                      hence contradiction;
                    end;
                    then
A521:               pl<len g by A483,XXREAL_0:1;
                    len C=len G1 by MATRIX_1:def 9;
                    then
A522:               dom C = Seg len G1 by FINSEQ_1:def 3
                      .= dom G1 by FINSEQ_1:def 3;
A523:               Li/.K1 = Li.K1 by A364,PARTFUN1:def 8;
                    then
A524:               g/.pf=G1*(mi, K1) by A364,A365,A397,MATRIX_1:def 8;
                    now
                      consider i2 be Element of NAT such that
A525:                 i2 in dom C and
A526:                 C/.i2=g/.len g by A28,PARTFUN2:4;
                      C/.i2 = C.i2 by A525,PARTFUN1:def 8;
                      then
A527:                 g/.len g=G1*(i2,width G1) by A522,A525,A526,
MATRIX_1:def 9;
A528:                 [i2,width G1] in Indices G1 by A74,A95,A522,A525,
ZFMISC_1:106;
                      assume
A529:                 pf=len g;
                      consider n1,n2 be Element of NAT such that
A530:                 [n1,n2] in Indices G1 and
A531:                 g/.lg=G1*(n1,n2) by A15,A486,GOBOARD1:def 11;
A532:                 n1 in dom G1 by A95,A530,ZFMISC_1:106;
A533:                 n2 in Seg width G1 by A95,A530,ZFMISC_1:106;
                      [mi,K1] in Indices G1 by A39,A95,A364,A397,ZFMISC_1:106;
                      then i2=mi by A524,A529,A527,A528,GOBOARD1:21;
                      then
A534:                 abs(n1-mi)+abs(n2- width G1)=1 by A15,A486,A503,A357,A527
,A528,A530,A531,GOBOARD1:def 11;
                      now
                        per cases by A534,SEQM_3:82;
                        suppose
A535:                     abs(n1-mi)=1 & n2=width G1;
A536:                     dom C = Seg len C by FINSEQ_1:def 3
                            .= Seg len G1 by MATRIX_1:def 9
                            .= dom G1 by FINSEQ_1:def 3;
                          then C/.n1 = C.n1 by A532,PARTFUN1:def 8;
                          then g/.lg=C/.n1 by A531,A532,A535,MATRIX_1:def 9;
                          then
A537:                     g/.lg in rng C by A532,A536,PARTFUN2:4;
                          g/.lg=g2/.lg by A13,A24,A17,A486,FINSEQ_4:86;
                          hence contradiction by A13,A17,A486,A504,A537,
XREAL_1:46;
                        end;
                        suppose
A538:                     abs(n2-width G1)=1 & n1=mi;
                          len Li = width G1 by MATRIX_1:def 8;
                          then
A539:                     n2 in dom Li by A533,FINSEQ_1:def 3;
                          then Li/.n2 = Li.n2 by PARTFUN1:def 8;
                          then g/.lg=Li/.n2 by A531,A533,A538,MATRIX_1:def 8;
                          then g/.lg in rng Li by A539,PARTFUN2:4;
                          hence contradiction by A356,A486,A529,XREAL_1:46;
                        end;
                      end;
                      hence contradiction;
                    end;
                    then
A540:               pf<len g by A415,XXREAL_0:1;
                    now
                      per cases by A485,XXREAL_0:1;
                      suppose
A541:                   pf<pl;
                        pl<=pl+1 by NAT_1:11;
                        then reconsider LL=pl+1-pf as Element of NAT by A541,
INT_1:18,XXREAL_0:2;
                        reconsider w1=pf-1 as Element of NAT by A361,INT_1:18;
                        set F1=g|pl;
                        defpred P[Nat, Element of TOP-REAL 2] means $2 = F1/.(
                        w1+$1);
A542:                   for n being Nat st n in Seg LL ex p st P[n,p];
                        consider F be FinSequence of TOP-REAL 2 such that
A543:                   len F = LL & for n being Nat st n in Seg LL
                        holds P[n,F/.n] from FINSEQ_4:sch 1(A542);
                        set hf=h1^F;
                        set FF = h1^F^h2;
A544:                   Seg len F = dom F by FINSEQ_1:def 3;
A545:                   for n st n in Seg LL holds F1/.(w1+n)=g/.(w1+n)
                        & w1+n in dom g
                        proof
                          0+1<=pf by A24,A356,FINSEQ_1:3;
                          then
A546:                     0<=w1 by XREAL_1:21;
                          let n such that
A547:                     n in Seg LL;
                          n<=LL by A547,FINSEQ_1:3;
                          then n+pf<=LL+ pf by XREAL_1:9;
                          then
A548:                     n+pf-1<=pl by XREAL_1:22;
                          1<=n by A547,FINSEQ_1:3;
                          then 0+1<=w1+n by A546,XREAL_1:9;
                          then w1+n in Seg pl by A548,FINSEQ_1:3;
                          hence thesis by A360,FINSEQ_4:86;
                        end;
A549:                   rng F c= rng g2
                        proof
                          let x;
                          assume x in rng F;
                          then consider n such that
A550:                     n in dom F and
A551:                     x=F/.n by PARTFUN2:4;
                          F/.n= F1/.(w1+n) by A543,A544,A550;
                          then
A552:                     F/.n=g/.(w1+n) by A545,A543,A544,A550;
                          w1+n in dom g by A545,A543,A544,A550;
                          then x in rng g by A551,A552,PARTFUN2:4;
                          hence thesis by A18;
                        end;
                        pf+1<=pl by A541,NAT_1:13;
                        then pf+1<=pl+1 by NAT_1:13;
                        then
A553:                   1<=LL by XREAL_1:21;
A554:                   now
                          let i1,i2,j1,j2 be Element of NAT;
                          assume that
A555:                     [ i1,i2] in Indices G1 and
A556:                     [j1,j2] in Indices G1 and
A557:                     hf/.len hf=G1*( i1,i2) and
A558:                     h2/.1=G1*(j1,j2) and
                          len hf in dom hf and
A559:                     1 in dom h2;
                          ma+1 in dom G1 by A466,A559;
                          then
A560:                     [
ma+1,K2] in Indices G1 by A95,A362,A352,ZFMISC_1:106;
A561:                     [ma,K2] in Indices G1 by A41,A95,A362,A352,
ZFMISC_1:106;
A562:                     len F in dom F by A543,A544,A553,FINSEQ_1:3;
                          hf/.len hf=hf/.(len h1+len F) by FINSEQ_1:35
                            .= F/.len F by A562,FINSEQ_4:84
                            .= F1/.(w1+LL) by A543,A544,A562
                            .= G1*(ma,K2) by A417,A545,A543,A544,A562;
                          then
A563:                     i1=ma & i2=K2 by A555,A557,A561,GOBOARD1:21;
                          h2/.1=G1*(ma+1,K2) by A418,A559;
                          then j1=ma+1 & j2=K2 by A556,A558,A560,GOBOARD1:21;
                          hence abs(i1-j1)+abs(i2-j2)=abs(ma-(ma+1))+0 by A563,
ABSVALUE:7
                            .=abs(-(ma+1 -ma))
                            .=abs(1) by COMPLEX1:138
                            .=1 by ABSVALUE:def 1;
                        end;
A564:                   rng FF = rng(h1^F) \/ rng h2 by FINSEQ_1:44
                          .= rng h1 \/ rng F \/ rng h2 by FINSEQ_1:44;
A565:                   for k st k in Seg width G1 & rng F /\ rng Col(G1
                        ,k)={} holds rng FF /\ rng Col(G1,k)={}
                        proof
A566:                     len Col(G1,K2)=len G1 by MATRIX_1:def 9;
A567:                     len Col(G1,K1)=len G1 by MATRIX_1:def 9;
                          let k;
                          assume that
A568:                     k in Seg width G1 and
A569:                     rng F /\ rng Col(G1,k)={};
                          set gg=Col(G1,k);
                          assume
A570:                     rng FF /\ rng gg <> {};
                          consider x being Element of rng FF /\ rng gg;
                          rng FF = rng F \/ (rng h1 \/ rng h2) by A564,
XBOOLE_1:4;
                          then
A571:                     rng FF /\ rng gg = {} \/ (rng h1 \/ rng h2) /\
                          rng gg by A569,XBOOLE_1:23
                            .= rng h1 /\ rng gg \/ rng h2 /\ rng gg by
XBOOLE_1:23;
                          now
                            per cases by A570,A571,XBOOLE_0:def 3;
                            suppose
A572:                         x in rng h1 /\ rng gg;
                              then x in rng h1 by XBOOLE_0:def 4;
                              then consider i such that
A573:                         i in dom h1 and
A574:                         x=h1/.i by PARTFUN2:4;
A575:                         x=G1*(i,K1) by A366,A573,A574;
                              reconsider y=x as Point of TOP-REAL 2 by A574;
A576:                         Lmi/.K1 = Lmi.K1 by A364,PARTFUN1:def 8;
A577:                         x in rng gg by A572,XBOOLE_0:def 4;
A578:                         dom CK1 = Seg len G1 by A567,FINSEQ_1:def 3
                                .= dom G1 by FINSEQ_1:def 3;
                              then
A579:                         CK1/.mi = CK1.mi by A39,PARTFUN1:def 8;
A580:                         i in dom CK1 by A398,A573,A578;
                              CK1/.i = CK1.i by A398,A573,A578,PARTFUN1:def 8;
                              then y=CK1/.i by A575,A578,A580,MATRIX_1:def 9;
                              then y in rng CK1 by A580,PARTFUN2:4;
                              then
A581:                         K1=k by A364,A397,A568,A577,GOBOARD1:20;
A582:                         1 in Seg LL by A553,FINSEQ_1:3;
                              then F/.1=F1/.(w1+1) & F1/.(w1+1)=g/.(w1+1) by
A545,A543;
                              then F/.1= CK1/.mi by A39,A364,A365,A397,A576
,A579,GOBOARD1:17;
                              then
A583:                         F/.1 in rng Col(G1,k) by A39,A578,A581,PARTFUN2:4
;
                              F/.1 in rng F by A543,A544,A582,PARTFUN2:4;
                              hence contradiction by A569,A583,XBOOLE_0:def 4;
                            end;
                            suppose
A584:                         x in rng h2 /\ rng gg;
                              then x in rng h2 by XBOOLE_0:def 4;
                              then consider i such that
A585:                         i in dom h2 and
A586:                         x=h2/.i by PARTFUN2:4;
A587:                         x=G1*(ma+i,K2) by A418,A585,A586;
                              reconsider y=x as Point of TOP-REAL 2 by A586;
A588:                         Lma /.K2 = Lma.K2 by A362,PARTFUN1:def 8;
A589:                         x in rng gg by A584,XBOOLE_0:def 4;
A590:                         dom CK2 = Seg len G1 by A566,FINSEQ_1:def 3
                                .= dom G1 by FINSEQ_1:def 3;
                              then
A591:                         CK2/.ma = CK2.ma by A41,PARTFUN1:def 8;
A592:                         ma+i in dom CK2 by A466,A585,A590;
                              CK2/.(ma+i) = CK2.(ma+i) by A466,A585,A590,
PARTFUN1:def 8;
                              then y=CK2/.(ma+i) by A587,A590,A592,
MATRIX_1:def 9;
                              then y in rng CK2 by A592,PARTFUN2:4;
                              then
A593:                         K2=k by A362,A352,A568,A589,GOBOARD1:20;
A594:                         LL in Seg LL by A553,FINSEQ_1:3;
                              then F/.LL=F1/.(w1+LL) & F1/.(w1+LL)=g/.(w1+LL
                              ) by A545,A543;
                              then F/.LL= CK2/.ma by A41,A362,A363,A352,A588
,A591,GOBOARD1:17;
                              then
A595:                         F/.LL in rng Col(G1,k) by A41,A590,A593,
PARTFUN2:4;
                              F/.LL in rng F by A543,A544,A594,PARTFUN2:4;
                              hence contradiction by A569,A595,XBOOLE_0:def 4;
                            end;
                          end;
                          hence contradiction;
                        end;
                        rng F /\ rng C = {}
                        proof
                          reconsider w=w1 as Element of NAT;
                          consider x being Element of rng F /\ rng C;
                          assume
A596:                     not thesis;
                          then
A597:                     x in rng C by XBOOLE_0:def 4;
                          x in rng F by A596,XBOOLE_0:def 4;
                          then consider i1 be Element of NAT such that
A598:                     i1 in dom F and
A599:                     F/.i1=x by PARTFUN2:4;
A600:                     Seg len F = dom F by FINSEQ_1:def 3;
                          then i1<=LL by A543,A598,FINSEQ_1:3;
                          then
A601:                     w+i1<=w+LL by XREAL_1:9;
A602:                     w1+i1 in dom g by A545,A543,A598,A600;
                          then
A603:                     w+i1 in dom g2 by A13,A24,A17,FINSEQ_4:86;
                          F /.i1=F1/.(w1+i1) & F1/.(w1+i1)= g/.(w1+i1)
                          by A545,A543,A598,A600;
                          then g2/.(w+i1) in rng C by A13,A24,A17,A597,A599
,A602,FINSEQ_4:86;
                          then m<=w+i1 by A13,A603;
                          hence contradiction by A17,A521,A601,XXREAL_0:2;
                        end;
                        then rng FF /\ rng Col(G1,width G1) = {} by A74,A565;
                        then
A604:                   rng FF misses rng Col(G1,width G1) by XBOOLE_0:def 7;
                        now
                          reconsider w=w1 as Element of NAT;
                          let n;
                          assume
A605:                     n in dom F;
                          then w1+n in dom g by A545,A543,A544;
                          then consider i,j such that
A606:                     [i,j] in Indices G1 & g/.(w+n)=G1*(i,j) by A15,
GOBOARD1:def 11;
                          take i,j;
                          F/.n= F1/.(w1+n) by A543,A544,A605;
                          hence [i,j] in Indices G1 & F/.n=G1*(i,j) by A545
,A543,A544,A605,A606;
                        end;
                        then for n st n in dom(h1^F) ex i,j st [i,j] in
                        Indices G1 & (h1^F)/.n=G1*(i,j) by A403,GOBOARD1:39;
                        then
A607:                   for n st n in dom FF ex i,j st [i,j] in Indices
                        G1 & FF/.n=G1*(i,j) by A470,GOBOARD1:39;
A608:                   now
A609:                     [mi,K1] in Indices G1 by A39,A95,A364,A397,
ZFMISC_1:106;
                          let i1,i2,j1,j2 be Element of NAT;
                          assume that
A610:                     [i1,i2] in Indices G1 and
A611:                     [j1,j2] in Indices G1 and
A612:                     h1/.len h1=G1*(i1,i2) and
A613:                     F/.1=G1*(j1,j2) and
A614:                     len h1 in dom h1 and
A615:                     1 in dom F;
                          F/.1=F1/.(w1+1) by A543,A544,A615;
                          then F/.1=g/.(w1+1) by A545,A543,A544,A615
                            .= G1*(mi,K1) by A364,A365,A397,A523,MATRIX_1:def 8
;
                          then
A616:                     j1=mi & j2=K1 by A611,A613,A609,GOBOARD1:21;
                          l1 in dom G1 by A366,A398,A614;
                          then
A617:                     [l1,K1] in Indices G1 by A95,A364,A397,ZFMISC_1:106;
                          h1/.len h1=G1*(l1,K1) by A366,A614;
                          then i1=l1 & i2=K1 by A610,A612,A617,GOBOARD1:21;
                          hence abs(i1-j1)+abs(i2-j2)= abs(mi-1-mi)+0 by A616,
ABSVALUE:7
                            .= abs(-1)
                            .= abs(1) by COMPLEX1:138
                            .= 1 by ABSVALUE:def 1;
                        end;
                        now
                          let n;
                          assume that
A618:                     n in dom F and
A619:                     n+1 in dom F;
                          F/.n=F1/.(w1+n) by A543,A544,A618;
                          then
A620:                     F/.n=g/.(w1+n) by A545,A543,A544,A618;
                          F/.(n+1)=F1/.(w1+(n+1)) by A543,A544,A619;
                          then
A621:                     w1+n+1 in dom g & F/.(n+1)=g/.(w1+n+1) by A545,A543
,A544,A619;
                          let i1,i2,j1,j2 be Element of NAT;
                          assume
A622:                     [i1,i2] in Indices G1 & [j1,j2] in Indices
                          G1 & F/.n=G1*(i1,i2) & F/. (n+1)=G1*(j1,j2);
                          w1+n in dom g by A545,A543,A544,A618;
                          hence abs(i1-j1)+abs(i2-j2)=1 by A15,A620,A621,A622,
GOBOARD1:def 11;
                        end;
                        then for n st n in dom(h1^F) & n+1 in dom(h1^F) for
i1,i2,j1,j2 be Element of NAT st [i1,i2] in Indices G1 & [j1,j2] in Indices G1
& (h1^F)/.n=G1*(i1,i2) & (h1^F)/.(n+1)=G1*(j1,j2) holds abs(i1-j1)+abs(i2-j2)=1
                        by A405,A608,GOBOARD1:40;
                        then for n st n in dom FF & n+1 in dom FF for i1,i2,
j1,j2 be Element of NAT st [i1,i2] in Indices G1 & [j1,j2] in Indices G1 & FF/.
n=G1*(i1,i2) & FF/.(n+1)=G1*(j1,j2) holds abs(i1-j1)+abs(i2-j2)=1 by A472,A554,
GOBOARD1:40;
                        then FF is_sequence_on G1 by A607,GOBOARD1:def 11;
                        then
A623:                   FF is_sequence_on D by A74,A151,A604,GOBOARD1:41;
                        consider x being Element of rng FF /\ rng tt;
                        0+0<=len h1+len h2 by NAT_1:2;
                        then
A624:                   0+1<=len F+(len h1+len h2) by A543,A553,XREAL_1:9;
A625:                   now
                          per cases;
                          suppose
A626:                       mi=1;
A627:                       pf in Seg pl by A361,A541,FINSEQ_1:3;
A628:                       1 in Seg LL by A553,FINSEQ_1:3;
                            h1 = {} by A366,A626;
                            then FF=F^h2 by FINSEQ_1:47;
                            then FF/.1=F/.1 by A543,A544,A628,FINSEQ_4:83
                              .= F1/.(w1+1) by A543,A628
                              .= g/.pf by A360,A627,FINSEQ_4:86;
                            hence FF/.1 in rng Line(G1,1) by A356,A626;
                          end;
                          suppose
A629:                       mi<>1;
                            1<=mi by A39,FINSEQ_3:27;
                            then 1<mi by A629,XXREAL_0:1;
                            then 1+1<=mi by NAT_1:13;
                            then
A630:                       1<=l1 by XREAL_1:21;
                            then
A631:                       1 in Seg l1 by FINSEQ_1:3;
                            len Line(G1,1)=width G1 by MATRIX_1:def 8;
                            then
A632:                       K1 in dom L1 by A364,A397,FINSEQ_1:def 3;
                            then
A633:                       L1/.K1 = L1.K1 by PARTFUN1:def 8;
                            len(h1^F)=len h1 + len F & 0<=len F by FINSEQ_1:35
,NAT_1:2;
                            then 0+1<=len(h1^F) by A366,A630,XREAL_1:9;
                            then 1 in dom(h1^F) by FINSEQ_3:27;
                            then FF/.1=(h1^F)/.1 by FINSEQ_4:83
                              .=h1/.1 by A366,A465,A631,FINSEQ_4:83
                              .=G1*(1,K1) by A366,A465,A631
                              .=L1/.K1 by A364,A397,A633,MATRIX_1:def 8;
                            hence FF/.1 in rng Line(G1,1) by A632,PARTFUN2:4;
                          end;
                        end;
A634:                   w1+LL= pl;
A635:                   now
                          per cases;
                          suppose
A636:                       ma=len G1;
                            1<=pl by A24,A360,FINSEQ_1:3;
                            then
A637:                       pl in Seg pl by FINSEQ_1:3;
A638:                       len F in dom F by A543,A553,FINSEQ_3:27;
                            h2 = {} by A418,A636;
                            then
A639:                       FF=h1^F by FINSEQ_1:47;
                            then FF/.len FF=FF/.(len h1+len F) by FINSEQ_1:35
                              .= F/.LL by A543,A639,A638,FINSEQ_4:84
                              .= F1/.pl by A543,A544,A634,A638
                              .= g/.pl by A360,A637,FINSEQ_4:86;
                            hence FF/.len FF in rng Line(G1,len G1) by A360
,A636;
                          end;
                          suppose
A640:                       ma<>len G1;
                            ma<=len G1 by A41,FINSEQ_3:27;
                            then ma<len G1 by A640,XXREAL_0:1;
                            then ma+1<=len G1 by NAT_1:13;
                            then
A641:                       1<=l2 by XREAL_1:21;
                            then
A642:                       l2 in Seg l2 by FINSEQ_1:3;
                            len Line(G1,len G1)=width G1 by MATRIX_1:def 8;
                            then
A643:                       K2 in dom Ll by A362,A352,FINSEQ_1:def 3;
                            then
A644:                       Ll/.K2 = Ll.K2 by PARTFUN1:def 8;
A645:                       len h2 in dom h2 by A418,A641,FINSEQ_3:27;
                            FF/.len FF=FF/.(len(h1^F)+len h2) by FINSEQ_1:35
                              .=h2/.l2 by A418,A645,FINSEQ_4:84
                              .=G1*(ma+l2,K2) by A418,A482,A642
                              .=Ll/.K2 by A362,A352,A644,MATRIX_1:def 8;
                            hence FF/.len FF in rng Line(G1,len G1) by A643,
PARTFUN2:4;
                          end;
                        end;
                        rng tt c= rng f by A348,A351,XBOOLE_1:1;
                        then
A646:                   rng tt c= rng g1 by A177,XBOOLE_1:1;
A647:                   len FF=len(h1^F)+len h2 by FINSEQ_1:35
                          .=len h1+len F+len h2 by FINSEQ_1:35;
                        then 1 in dom FF by A624,FINSEQ_3:27;
                        then
A648:                   FF/. 1 in rng Line(D,1) by A74,A26,A151,A625,A604,
GOBOARD1:37;
                        len FF in dom FF by A647,A624,FINSEQ_3:27;
                        then
A649:                   FF/.len FF in rng Line(D,len D) by A74,A27,A151,A152
,A635,A604,GOBOARD1:37;
                        width D=k by A3,A74,A92,GOBOARD1:26,NAT_1:3;
                        then rng FF /\ rng tt <> {} by A2,A93,A350,A647,A624
,A623,A648,A649;
                        then
A650:                   x in rng FF /\ rng tt;
                        rng tt /\ rng FF = ((rng h1 \/ rng F) /\ rng tt
                        ) \/ {} by A489,A564,XBOOLE_1:23
                          .= {} \/ rng F /\ rng tt by A421,XBOOLE_1:23
                          .= rng tt /\ rng F;
                        then rng FF /\ rng tt c= rng g1 /\ rng g2 by A646,A549,
XBOOLE_1:27;
                        hence thesis by A650;
                      end;
                      suppose
A651:                   pl<pf;
                        pf<=pf+1 by NAT_1:11;
                        then reconsider LL=pf+1-pl as Element of NAT by A651,
INT_1:18,XXREAL_0:2;
                        set F1=g|pf;
                        defpred P[Nat,Element of TOP-REAL 2] means for k st k
                        = pf+1-$1 holds $2 = F1/.k;
A652:                   for n,k st n in Seg LL & k = pf+1-n holds F1/.k
                        =g/.k & k in dom g
                        proof
                          let n,k;
                          assume that
A653:                     n in Seg LL and
A654:                     k = pf+1-n;
A655:                     n<=LL by A653,FINSEQ_1:3;
                          1<=n by A653,FINSEQ_1:3;
                          then
A656:                     pf+1-n<=pf+1-1 by XREAL_1:15;
                          0<=pl by NAT_1:2;
                          then LL<=pf+1-0 by XREAL_1:15;
                          then reconsider w=pf+1-n as Element of NAT by A655,
INT_1:18,XXREAL_0:2;
                          pf+1-LL<=pf+1-n by A655,XREAL_1:15;
                          then 1<=pf+1-n by A484,XXREAL_0:2;
                          then w in Seg pf by A656,FINSEQ_1:3;
                          hence thesis by A356,A654,FINSEQ_4:86;
                        end;
A657:                   for n st n in Seg LL holds pf+1-n is Element of NAT
                        proof
                          let n;
                          0<=pl by NAT_1:2;
                          then
A658:                     LL<=pf+1-0 by XREAL_1:15;
                          assume n in Seg LL;
                          then n<=LL by FINSEQ_1:3;
                          hence thesis by A658,INT_1:18,XXREAL_0:2;
                        end;
A659:                   for n being Nat st n in Seg LL ex p st P[n,p]
                        proof
                          let n be Nat;
                          assume
A660:                     n in Seg LL;
                          then reconsider
                          k = pf+1-n as Element of NAT by A657;
                          take g/.k;
                          thus thesis by A652,A660;
                        end;
                        consider F be FinSequence of TOP-REAL 2 such that
A661:                   len F = LL & for n being Nat st n in Seg LL
                        holds P[n,F/.n] from FINSEQ_4:sch 1(A659);
                        set hf=h1^F;
                        set FF = h1^F^h2;
A662:                   Seg len F = dom F by FINSEQ_1:def 3;
A663:                   rng F c= rng g2
                        proof
                          let x;
                          assume x in rng F;
                          then consider n such that
A664:                     n in dom F and
A665:                     x=F/.n by PARTFUN2:4;
                          reconsider u = pf+1-n as Element of NAT by A657,A661
,A662,A664;
                          F/.n=F1/.u by A661,A662,A664;
                          then pf+1-n in dom g & F/.n=g/.u by A652,A661,A662
,A664;
                          then x in rng g by A665,PARTFUN2:4;
                          hence thesis by A18;
                        end;
                        pl+1<=pf by A651,NAT_1:13;
                        then pl+1<=pf+1 by NAT_1:13;
                        then
A666:                   1<=LL by XREAL_1:21;
A667:                   now
                          reconsider u = pf+1-LL as Element of NAT;
                          let i1,i2,j1,j2 be Element of NAT;
                          assume that
A668:                     [ i1,i2] in Indices G1 and
A669:                     [j1,j2] in Indices G1 and
A670:                     hf/.len hf=G1*(i1,i2) and
A671:                     h2/.1=G1*(j1,j2) and
                          len hf in dom hf and
A672:                     1 in dom h2;
                          ma+1 in dom G1 by A466,A672;
                          then
A673:                     [ma+1,K2] in Indices G1 by A95,A362,A352,ZFMISC_1:106
;
A674:                     [ma,K2] in Indices G1 by A41,A95,A362,A352,
ZFMISC_1:106;
A675:                     len F in dom F by A661,A666,FINSEQ_3:27;
                          hf/.len hf=hf/.(len h1+len F) by FINSEQ_1:35
                            .= F/.len F by A675,FINSEQ_4:84
                            .= F1/.u by A661,A662,A675
                            .= g/.u by A652,A661,A662,A675
                            .= G1*(ma,K2) by A362,A363,A352,A416,MATRIX_1:def 8
;
                          then
A676:                     i1=ma & i2=K2 by A668,A670,A674,GOBOARD1:21;
                          h2/.1=G1*(ma+1,K2) by A418,A672;
                          then j1=ma+1 & j2=K2 by A669,A671,A673,GOBOARD1:21;
                          hence abs(i1-j1)+abs(i2-j2)=abs(ma-(ma+1))+0 by A676,
ABSVALUE:7
                            .=abs(-(ma+1 -ma))
                            .=abs(1) by COMPLEX1:138
                            .=1 by ABSVALUE:def 1;
                        end;
                        now
                          let n;
                          assume
A677:                     n in dom F;
                          then reconsider
                          w=pf+1-n as Element of NAT by A657,A661,A662;
A678:                     F/.n=F1/.w by A661,A662,A677;
                          then pf+1-n in dom g by A652,A661,A662,A677;
                          then consider i,j such that
A679:                     [i,j] in Indices G1 & g/.w=G1*(i,j) by A15,
GOBOARD1:def 11;
                          take i,j;
                          thus [i,j] in Indices G1 & F/.n=G1*(i,j) by A652,A661
,A662,A677,A678,A679;
                        end;
                        then for n st n in dom(h1^F) ex i,j st [i,j] in
                        Indices G1 & (h1^F)/.n=G1*(i,j) by A403,GOBOARD1:39;
                        then
A680:                   for n st n in dom FF ex i,j st [i,j] in Indices
                        G1 & FF/.n=G1*(i,j) by A470,GOBOARD1:39;
                        consider x being Element of rng FF /\ rng tt;
                        0+0<=len h1+len h2 by NAT_1:2;
                        then
A681:                   0+1<=len F+(len h1+len h2) by A661,A666,XREAL_1:9;
A682:                   rng FF = rng(h1^F) \/ rng h2 by FINSEQ_1:44
                          .= rng h1 \/ rng F \/ rng h2 by FINSEQ_1:44;
A683:                   for k st k in Seg width G1 & rng F /\ rng Col(
                        G1,k)={} holds rng FF /\ rng Col(G1,k)={}
                        proof
A684:                     len Col(G1,K2)=len G1 by MATRIX_1:def 9;
A685:                     len Col(G1,K1)=len G1 by MATRIX_1:def 9;
                          let k;
                          assume that
A686:                     k in Seg width G1 and
A687:                     rng F /\ rng Col(G1,k)={};
                          set gg=Col(G1,k);
                          assume
A688:                     rng FF /\ rng gg <> {};
                          consider x being Element of rng FF /\ rng gg;
                          rng FF = rng F \/ (rng h1 \/ rng h2) by A682,
XBOOLE_1:4;
                          then
A689:                     rng FF /\ rng gg = {} \/ (rng h1 \/ rng h2)
                          /\ rng gg by A687,XBOOLE_1:23
                            .= rng h1 /\ rng gg \/ rng h2 /\ rng gg by
XBOOLE_1:23;
                          now
                            per cases by A688,A689,XBOOLE_0:def 3;
                            suppose
A690:                         x in rng h1 /\ rng gg;
                              then
A691:                         x in rng gg by XBOOLE_0:def 4;
A692:                         1 in Seg LL by A666,FINSEQ_1:3;
                              pf+1-1 = pf;
                              then
A693:                         F/.1=F1/.pf & F1/.pf=g/.pf by A652,A661,A692;
                              x in rng h1 by A690,XBOOLE_0:def 4;
                              then consider i such that
A694:                         i in dom h1 and
A695:                         x=h1/.i by PARTFUN2:4;
A696:                         x=G1*(i,K1) by A366,A694,A695;
                              reconsider y=x as Point of TOP-REAL 2 by A695;
A697:                         Lmi/.K1 = Lmi.K1 by A364,PARTFUN1:def 8;
A698:                         dom CK1 = Seg len G1 by A685,FINSEQ_1:def 3
                                .= dom G1 by FINSEQ_1:def 3;
                              then
A699:                         i in dom CK1 by A398,A694;
                              CK1/.i = CK1.i by A398,A694,A698,PARTFUN1:def 8;
                              then y=CK1/.i by A696,A698,A699,MATRIX_1:def 9;
                              then y in rng CK1 by A699,PARTFUN2:4;
                              then
A700:                         K1=k by A364,A397,A686,A691,GOBOARD1:20;
                              CK1/.mi = CK1.mi by A39,A698,PARTFUN1:def 8;
                              then F/.1=CK1/.mi by A39,A364,A365,A397,A697,A693
,GOBOARD1:17;
                              then
A701:                         F/.1 in rng Col(G1,k) by A39,A698,A700,PARTFUN2:4
;
                              F/.1 in rng F by A661,A662,A692,PARTFUN2:4;
                              hence contradiction by A687,A701,XBOOLE_0:def 4;
                            end;
                            suppose
A702:                         x in rng h2 /\ rng gg;
                              then x in rng h2 by XBOOLE_0:def 4;
                              then consider i such that
A703:                         i in dom h2 and
A704:                         x=h2/.i by PARTFUN2:4;
A705:                         x=G1*(ma+i,K2) by A418,A703,A704;
                              reconsider y=x as Point of TOP-REAL 2 by A704;
A706:                         x in rng gg by A702,XBOOLE_0:def 4;
                              reconsider u = pf+1-LL as Element of NAT;
A707:                         Lma /.K2 = Lma.K2 by A362,PARTFUN1:def 8;
A708:                         dom CK2 = Seg len G1 by A684,FINSEQ_1:def 3
                                .= dom G1 by FINSEQ_1:def 3;
                              then
A709:                         CK2/.ma = CK2.ma by A41,PARTFUN1:def 8;
A710:                         ma+i in dom CK2 by A466,A703,A708;
                              CK2/.(ma+i) = CK2.(ma+i) by A466,A703,A708,
PARTFUN1:def 8;
                              then y=CK2/.(ma+i) by A705,A708,A710,
MATRIX_1:def 9;
                              then y in rng CK2 by A710,PARTFUN2:4;
                              then
A711:                         K2=k by A362,A352,A686,A706,GOBOARD1:20;
A712:                         LL in Seg LL by A666,FINSEQ_1:3;
                              then F/.LL=F1/.u & F1/.u=g/.u by A652,A661;
                              then F/.LL= CK2/.ma by A41,A362,A363,A352,A707
,A709,GOBOARD1:17;
                              then
A713:                         F/.LL in rng Col(G1,k) by A41,A708,A711,
PARTFUN2:4;
                              F/.LL in rng F by A661,A662,A712,PARTFUN2:4;
                              hence contradiction by A687,A713,XBOOLE_0:def 4;
                            end;
                          end;
                          hence contradiction;
                        end;
                        rng F /\ rng C = {}
                        proof
                          consider x being Element of rng F /\ rng C;
                          assume
A714:                     not thesis;
                          then
A715:                     x in rng C by XBOOLE_0:def 4;
                          x in rng F by A714,XBOOLE_0:def 4;
                          then consider i1 be Element of NAT such that
A716:                     i1 in dom F and
A717:                     F/.i1=x by PARTFUN2:4;
                          reconsider w=pf+1-i1 as Element of NAT by A657,A661
,A662,A716;
                          1<=i1 by A716,FINSEQ_3:27;
                          then
A718:                     w<=pf+1-1 by XREAL_1:15;
A719:                     w in dom g by A652,A661,A662,A716;
                          then
A720:                     w in dom g2 by A13,A24,A17,FINSEQ_4:86;
                          F/.i1=F1/.w & F1/.w=g/.w by A652,A661,A662,A716;
                          then g2/.w in rng C by A13,A24,A17,A715,A717,A719,
FINSEQ_4:86;
                          then m<=w by A13,A720;
                          hence contradiction by A17,A540,A718,XXREAL_0:2;
                        end;
                        then rng FF /\ rng Col(G1,width G1) = {} by A74,A683;
                        then
A721:                   rng FF misses rng Col(G1,width G1) by XBOOLE_0:def 7;
A722:                   now
                          let n;
                          assume that
A723:                     n in dom F and
A724:                     n+1 in dom F;
                          reconsider w3=pf+1-n, w2=pf+1-(n+1) as Element of
                          NAT by A657,A661,A662,A723,A724;
                          F/.n=F1/.w3 by A661,A662,A723;
                          then
A725:                     pf+1-n in dom g & F/.n =g/.w3 by A652,A661,A662,A723;
                          F/.(n+1)=F1/.w2 by A661,A662,A724;
                          then
A726:                     pf+1-(n+1) in dom g & F/.(n+1)=g/.w2 by A652,A661
,A662,A724;
                          let i1,i2,j1,j2 be Element of NAT;
                          assume
A727:                     [i1,i2] in Indices G1 & [j1,j2] in
                          Indices G1 & F/.n=G1*(i1,i2) & F/. (n+1)=G1*(j1,j2);
                          w2+1=pf+1-n;
                          hence 1=abs(j1-i1)+abs(j2-i2) by A15,A725,A726,A727,
GOBOARD1:def 11
                            .= abs(-(i1-j1))+abs(-(i2-j2))
                            .= abs(i1-j1)+abs(-(i2-j2)) by COMPLEX1:138
                            .= abs(i1-j1)+abs(i2-j2) by COMPLEX1:138;
                        end;
A728:                   pf+1-1 = pf;
A729:                   now
                          per cases;
                          suppose
A730:                       mi=1;
A731:                       pf in Seg pf by A361,FINSEQ_1:3;
A732:                       1 in Seg LL by A666,FINSEQ_1:3;
                            h1 = {} by A366,A730;
                            then FF=F^h2 by FINSEQ_1:47;
                            then FF/.1=F/.1 by A661,A662,A732,FINSEQ_4:83
                              .= F1/.pf by A661,A728,A732
                              .= g/.pf by A356,A731,FINSEQ_4:86;
                            hence FF/.1 in rng Line(G1,1) by A356,A730;
                          end;
                          suppose
A733:                       mi<>1;
                            1<=mi by A39,FINSEQ_3:27;
                            then 1<mi by A733,XXREAL_0:1;
                            then 1+1<=mi by NAT_1:13;
                            then
A734:                       1<=l1 by XREAL_1:21;
                            then
A735:                       1 in Seg l1 by FINSEQ_1:3;
                            len Line(G1,1)=width G1 by MATRIX_1:def 8;
                            then
A736:                       K1 in dom L1 by A364,A397,FINSEQ_1:def 3;
                            then
A737:                       L1/.K1 = L1.K1 by PARTFUN1:def 8;
                            len(h1^F)=len h1 + len F & 0<=len F by FINSEQ_1:35
,NAT_1:2;
                            then 0+1<=len(h1^F) by A366,A734,XREAL_1:9;
                            then 1 in dom(h1^F) by FINSEQ_3:27;
                            then FF/.1=(h1^F)/.1 by FINSEQ_4:83
                              .=h1/.1 by A366,A465,A735,FINSEQ_4:83
                              .=G1*(1,K1) by A366,A465,A735
                              .=L1/.K1 by A364,A397,A737,MATRIX_1:def 8;
                            hence FF/.1 in rng Line(G1,1) by A736,PARTFUN2:4;
                          end;
                        end;
                        rng tt c= rng f by A348,A351,XBOOLE_1:1;
                        then
A738:                   rng tt c= rng g1 by A177,XBOOLE_1:1;
                        now
A739:                     [mi,K1] in Indices G1 by A39,A95,A364,A397,
ZFMISC_1:106;
                          reconsider w4 = pf + 1 - 1 as Element of NAT;
                          let i1,i2,j1,j2 be Element of NAT;
                          assume that
A740:                     [i1,i2] in Indices G1 and
A741:                     [j1,j2] in Indices G1 and
A742:                     h1/.len h1=G1*(i1,i2) and
A743:                     F/.1=G1*(j1,j2) and
A744:                     len h1 in dom h1 and
A745:                     1 in dom F;
                          F/.1 = F1/.w4 by A661,A662,A745
                            .= g/.w4 by A652,A661,A662,A745
                            .= G1*(mi,K1) by A364,A365,A397,A523,MATRIX_1:def 8
;
                          then
A746:                     j1=mi & j2=K1 by A741,A743,A739,GOBOARD1:21;
                          l1 in dom G1 by A366,A398,A744;
                          then
A747:                     [l1,K1] in Indices G1 by A95,A364,A397,ZFMISC_1:106;
                          h1/.len h1=G1*(l1,K1) by A366,A744;
                          then i1=l1 & i2=K1 by A740,A742,A747,GOBOARD1:21;
                          hence abs(i1-j1)+abs(i2-j2)= abs(mi-1-mi)+0 by A746,
ABSVALUE:7
                            .= abs(-1)
                            .= abs(1) by COMPLEX1:138
                            .= 1 by ABSVALUE:def 1;
                        end;
                        then for n st n in dom(h1^F) & n+1 in dom(h1^F) for
i1,i2,j1,j2 be Element of NAT st [i1,i2] in Indices G1 & [j1,j2] in Indices G1
& (h1^F)/.n=G1*(i1,i2) & (h1^F)/.(n+1)=G1*(j1,j2) holds abs(i1-j1)+abs(i2-j2)=1
                        by A405,A722,GOBOARD1:40;
                        then for n st n in dom FF & n+1 in dom FF for m,k,i,
j st [m,k] in Indices G1 & [i,j] in Indices G1 & FF/.n=G1*(m,k) & FF/.(n+1)=G1*
(i,j) holds abs(m-i)+abs(k-j)=1 by A472,A667,GOBOARD1:40;
                        then FF is_sequence_on G1 by A680,GOBOARD1:def 11;
                        then
A748:                   FF is_sequence_on D by A74,A151,A721,GOBOARD1:41;
A749:                   len FF=len(h1^F)+len h2 by FINSEQ_1:35
                          .=len h1+len F+len h2 by FINSEQ_1:35;
                        then 1 in dom FF by A681,FINSEQ_3:27;
                        then
A750:                   FF/. 1 in rng Line(D,1) by A74,A26,A151,A729,A721,
GOBOARD1:37;
A751:                   now
                          per cases;
                          suppose
A752:                       ma=len G1;
A753:                       pl in Seg pf by A484,A651,FINSEQ_1:3;
A754:                       pf+1-(pf+1-pl) = pl;
A755:                       len F in dom F by A661,A666,FINSEQ_3:27;
                            h2 = {} by A418,A752;
                            then
A756:                       FF=h1^F by FINSEQ_1:47;
                            then FF/.len FF=FF/.(len h1+len F) by FINSEQ_1:35
                              .= F/.LL by A661,A756,A755,FINSEQ_4:84
                              .= F1/.pl by A661,A662,A754,A755
                              .= g/.pl by A356,A753,FINSEQ_4:86;
                            hence FF/.len FF in rng Line(G1,len G1) by A360
,A752;
                          end;
                          suppose
A757:                       ma<>len G1;
                            ma<=len G1 by A41,FINSEQ_3:27;
                            then ma<len G1 by A757,XXREAL_0:1;
                            then ma+1<=len G1 by NAT_1:13;
                            then
A758:                       1<=l2 by XREAL_1:21;
                            then
A759:                       l2 in Seg l2 by FINSEQ_1:3;
                            len Line(G1,len G1)=width G1 by MATRIX_1:def 8;
                            then
A760:                       K2 in dom Ll by A362,A352,FINSEQ_1:def 3;
                            then
A761:                       Ll/.K2 = Ll.K2 by PARTFUN1:def 8;
A762:                       len h2 in dom h2 by A418,A758,FINSEQ_3:27;
                            FF/.len FF=FF/.(len(h1^F)+len h2) by FINSEQ_1:35
                              .=h2/.l2 by A418,A762,FINSEQ_4:84
                              .=G1*(ma+l2,K2) by A418,A482,A759
                              .=Ll/.K2 by A362,A352,A761,MATRIX_1:def 8;
                            hence FF/.len FF in rng Line(G1,len G1) by A760,
PARTFUN2:4;
                          end;
                        end;
                        len FF in dom FF by A749,A681,FINSEQ_3:27;
                        then
A763:                   FF/.len FF in rng Line(D,len D) by A74,A27,A151,A152
,A751,A721,GOBOARD1:37;
                        width D=k by A3,A74,A92,GOBOARD1:26,NAT_1:3;
                        then rng FF /\ rng tt <> {} by A2,A93,A350,A749,A681
,A748,A750,A763;
                        then
A764:                   x in rng FF /\ rng tt;
                        rng tt /\ rng FF = ((rng h1 \/ rng F) /\ rng tt
                        ) \/ {} by A489,A682,XBOOLE_1:23
                          .= {} \/ rng F /\ rng tt by A421,XBOOLE_1:23
                          .= rng tt /\ rng F;
                        then rng FF /\ rng tt c= rng g1 /\ rng g2 by A738,A663,
XBOOLE_1:27;
                        hence thesis by A764;
                      end;
                    end;
                    hence thesis;
                  end;
                end;
                hence thesis;
              end;
            end;
          end;
        end;
        hence thesis;
      end;
    end;
    hence thesis;
  end;
A765: P[0];
A766: for k holds P[k] from NAT_1:sch 1(A765,A1);
A767: now
    let k;
    let G1,g1,g2;
    assume k=width G1 & k>0 & 1<=len g1 & 1<=len g2 & g1 is_sequence_on G1
& g2 is_sequence_on G1 & g1/.1 in rng Line(G1,1) & g1/.len g1 in rng Line(G1,
    len G1) & g2/.1 in rng Col(G1,1) & g2/.len g2 in rng Col(G1,width G1);
    then rng g1 /\ rng g2 <> {} by A766;
    hence rng g1 meets rng g2 by XBOOLE_0:def 7;
  end;
  width G <> 0 by GOBOARD1:def 5;
  then
A768: width G > 0 by NAT_1:3;
  assume 1<=len f1 & 1<=len f2 & f1 is_sequence_on G & f2 is_sequence_on G &
f1/.1 in rng Line(G,1) & f1/.len f1 in rng Line(G,len G) & f2/.1 in rng Col(G,
  1) & f2/.len f2 in rng Col(G,width G);
  hence thesis by A767,A768;
end;

theorem Th2:
  for G,f1,f2 st 2<=len f1 & 2<=len f2 & f1 is_sequence_on G & f2
  is_sequence_on G & f1/.1 in rng Line(G,1) & f1/.len f1 in rng Line(G,len G) &
f2/.1 in rng Col(G,1) & f2/.len f2 in rng Col(G,width G) holds L~f1 meets L~f2
proof
  let G,f1,f2;
  assume that
A1: 2<=len f1 and
A2: 2<=len f2 and
A3: f1 is_sequence_on G & f2 is_sequence_on G & f1/.1 in rng Line(G,1) &
  f1/. len f1 in rng Line(G,len G) & f2/.1 in rng Col(G,1) & f2/.len f2 in rng
  Col( G,width G);
  1<=len f1 & 1<=len f2 by A1,A2,XXREAL_0:2;
  then rng f1 meets rng f2 by A3,Th1;
  then consider x being set such that
A4: x in rng f1 and
A5: x in rng f2 by XBOOLE_0:3;
  ex m st m in dom f2 & f2/.m=x by A5,PARTFUN2:4;
  then
A6: x in L~f2 by A2,GOBOARD1:16;
  ex n st n in dom f1 & f1/.n=x by A4,PARTFUN2:4;
  then x in L~f1 by A1,GOBOARD1:16;
  hence thesis by A6,XBOOLE_0:3;
end;

theorem
  for G,f1,f2 st 2 <= len f1 & 2 <= len f2 & f1 is_sequence_on G & f2
  is_sequence_on G & f1/.1 in rng Line(G,1) & f1/.len f1 in rng Line(G,len G) &
f2/.1 in rng Col(G,1) & f2/.len f2 in rng Col(G,width G) holds L~f1 meets L~f2
  by Th2;

definition
  let f be Relation, r,s be Real;
  pred f lies_between r,s means
  :Def1:
  rng f c= [. r,s .];
end;

definition
  let f be FinSequence of REAL, r,s be Real;
  redefine pred f lies_between r,s means
  :Def2:
  for n st n in dom f holds r <= f.n & f.n <= s;
  compatibility
  proof
    hereby
      assume f lies_between r,s;
      then
A1:   rng f c= [. r,s .] by Def1;
      let n;
      assume n in dom f;
      then f.n in rng f by FUNCT_1:12;
      hence r <= f.n & f.n <= s by A1,XXREAL_1:1;
    end;
    assume
A2: for n st n in dom f holds r <= f.n & f.n <= s;
    let y be set;
    assume y in rng f;
    then consider x being set such that
A3: x in dom f and
A4: y = f.x by FUNCT_1:def 5;
    reconsider n=x as Element of NAT by A3;
    r <= f.n & f.n <= s by A2,A3;
    hence thesis by A4,XXREAL_1:1;
  end;
end;

theorem Th4:
  for f1,f2 being FinSequence of TOP-REAL 2 st 2<=len f1 & 2<=len
  f2 & f1 is special & f2 is special & (for n st n in dom f1 & n+1 in dom f1
  holds f1/.n <> f1/.(n+1)) & (for n st n in dom f2 & n+1 in dom f2 holds f2/.n
<> f2/.(n+1)) & X_axis(f1) lies_between (X_axis(f1)).1, (X_axis(f1)).(len f1) &
  X_axis(f2) lies_between (X_axis(f1)).1, (X_axis(f1)).(len f1) & Y_axis(f1)
lies_between (Y_axis(f2)).1, (Y_axis(f2)).(len f2) & Y_axis(f2) lies_between (
  Y_axis(f2)).1, (Y_axis(f2)).(len f2) holds L~f1 meets L~f2
proof
  let f1,f2 be FinSequence of TOP-REAL 2;
  assume that
A1: 2<=len f1 and
A2: 2<=len f2 and
A3: f1 is special and
A4: f2 is special and
A5: for n st n in dom f1 & n+1 in dom f1 holds f1/.n <> f1/.(n+1) and
A6: for n st n in dom f2 & n+1 in dom f2 holds f2/.n <> f2/.(n+1) and
A7: X_axis(f1) lies_between (X_axis(f1)).1, (X_axis(f1)).(len f1) and
A8: X_axis(f2) lies_between (X_axis(f1)).1, (X_axis(f1)).(len f1) and
A9: Y_axis(f1) lies_between (Y_axis(f2)).1, (Y_axis(f2)).(len f2) and
A10: Y_axis(f2) lies_between (Y_axis(f2)).1, (Y_axis(f2)).(len f2);
  len f1 <> 0 & len f2 <> 0 by A1,A2;
  then reconsider f1, f2 as non empty FinSequence of TOP-REAL 2;
  reconsider f = f1^f2 as non empty FinSequence of TOP-REAL 2;
A11: Seg len f2=dom f2 by FINSEQ_1:def 3;
  reconsider p1=f1/.1, p2=f1/.len f1, q1=f2/.1, q2=f2/.len f2 as Point of
  TOP-REAL 2;
  set x = X_axis(f), y = Y_axis(f), x1 = X_axis(f1), y1 = Y_axis(f1), x2 =
  X_axis(f2), y2 = Y_axis(f2);
A12: Seg len f1=dom f1 by FINSEQ_1:def 3;
A13: 1<=len f1 by A1,XXREAL_0:2;
  then
A14: 1 in dom f1 by FINSEQ_3:27;
  then
A15: f/.1=f1/.1 by FINSEQ_4:83;
A16: Seg len f=dom f by FINSEQ_1:def 3;
  set G = GoB(f);
A17: dom x = Seg len x & len x = len f by FINSEQ_1:def 3,GOBOARD1:def 3;
A18: Seg len x2=dom x2 & len x2=len f2 by FINSEQ_1:def 3,GOBOARD1:def 3;
A19: len f = len f1 + len f2 by FINSEQ_1:35;
A20: Seg len x1=dom x1 & len x1=len f1 by FINSEQ_1:def 3,GOBOARD1:def 3;
  then
A21: x1.1=p1`1 by A12,A14,GOBOARD1:def 3;
A22: now
    let m;
    set s = x.m;
    assume
A23: m in dom f;
    then
A24: m<=len f by FINSEQ_3:27;
A25: 1<=m by A23,FINSEQ_3:27;
    now
      per cases;
      suppose
A26:    m<=len f1;
        reconsider u=f1/.m as Point of TOP-REAL 2;
A27:    m in dom f1 by A25,A26,FINSEQ_3:27;
        then f/.m=u by FINSEQ_4:83;
        then
A28:    x.m=u`1 by A16,A17,A23,GOBOARD1:def 3;
        x1.m=u`1 by A12,A20,A27,GOBOARD1:def 3;
        hence p1`1<=s by A7,A12,A20,A21,A27,A28,Def2;
      end;
      suppose
A29:    len f1<m;
        then reconsider w5 = m-len f1 as Element of NAT by INT_1:18;
        w5 > 0 by A29,XREAL_1:52;
        then
A30:    1<=w5 by NAT_1:14;
A31:    m = w5 + len f1;
        then reconsider m1=m-len f1 as Element of NAT;
        reconsider u=f2/.m1 as Point of TOP-REAL 2;
A32:    w5<=len f2 by A19,A24,A31,XREAL_1:8;
        then f/.m = f2/.w5 by A31,A30,SEQ_4:153;
        then
A33:    x.m=u`1 by A16,A17,A23,GOBOARD1:def 3;
A34:    m1 in dom f2 by A30,A32,FINSEQ_3:27;
        then x2.m1=u`1 by A11,A18,GOBOARD1:def 3;
        hence p1`1<=s by A8,A11,A18,A21,A34,A33,Def2;
      end;
    end;
    hence p1`1<=s;
  end;
  len f = len f1 + len f2 by FINSEQ_1:35;
  then 2+2<=len f by A1,A2,XREAL_1:9;
  then 1<=len f by XXREAL_0:2;
  then
A35: 1 in dom f by FINSEQ_3:27;
  then x.1=p1`1 by A16,A17,A15,GOBOARD1:def 3;
  then
A36: f/.1 in rng Line(G,1) by A35,A22,GOBOARD2:26;
A37: len f1 in dom f1 by A13,FINSEQ_3:27;
  then
A38: f/.len f1=f1/.len f1 by FINSEQ_4:83;
A39: x1.(len f1) = p2`1 by A12,A20,A37,GOBOARD1:def 3;
A40: now
    let m;
    set s = x.m;
    assume
A41: m in dom f;
    then
A42: m<=len f by FINSEQ_3:27;
A43: 1<=m by A41,FINSEQ_3:27;
    now
      per cases;
      suppose
A44:    m<=len f1;
        reconsider u=f1/.m as Point of TOP-REAL 2;
A45:    m in dom f1 by A43,A44,FINSEQ_3:27;
        then f/.m=u by FINSEQ_4:83;
        then
A46:    x.m=u`1 by A16,A17,A41,GOBOARD1:def 3;
        x1.m=u`1 by A12,A20,A45,GOBOARD1:def 3;
        hence s<=p2`1 by A7,A12,A20,A39,A45,A46,Def2;
      end;
      suppose
A47:    len f1<m;
        then reconsider w5 = m-len f1 as Element of NAT by INT_1:18;
        w5 > 0 by A47,XREAL_1:52;
        then
A48:    1<=w5 by NAT_1:14;
A49:    m = w5 + len f1;
        then reconsider m1=m-len f1 as Element of NAT;
        reconsider u=f2/.m1 as Point of TOP-REAL 2;
A50:    w5<=len f2 by A19,A42,A49,XREAL_1:8;
        then f/.m = f2/.w5 by A49,A48,SEQ_4:153;
        then
A51:    x.m=u`1 by A16,A17,A41,GOBOARD1:def 3;
A52:    m1 in dom f2 by A48,A50,FINSEQ_3:27;
        then x2.m1=u`1 by A11,A18,GOBOARD1:def 3;
        hence s<=p2`1 by A8,A11,A18,A39,A52,A51,Def2;
      end;
    end;
    hence s<=p2`1;
  end;
A53: dom f1 c= dom f by FINSEQ_1:39;
  then x.(len f1) = p2`1 by A16,A17,A37,A38,GOBOARD1:def 3;
  then
A54: f/.len f1 in rng Line(G,len G) by A53,A37,A40,GOBOARD2:27;
  now
    let n;
    assume
A55: n in dom f1;
    dom f1 c= dom f by FINSEQ_1:39;
    then consider i,j such that
A56: [i,j] in Indices G & f/.n=G*(i,j) by A55,GOBOARD2:25;
    take i,j;
    thus [i,j] in Indices G & f1/.n=G*(i,j) by A55,A56,FINSEQ_4:83;
  end;
  then consider g1 such that
A57: g1 is_sequence_on G & L~g1=L~f1 & g1/.1=f1/.1 & g1/.len g1=f1/.len f1 and
A58: len f1 <= len g1 by A3,A5,GOBOARD2:17;
  now
    let n;
    assume
A59: n in dom f2;
    then len f1+n in dom f by FINSEQ_1:41;
    then consider i,j such that
A60: [i,j] in Indices G & f/.(len f1+n)=G*(i,j) by GOBOARD2:25;
    take i,j;
    thus [i,j] in Indices G & f2/.n=G*(i,j) by A59,A60,FINSEQ_4:84;
  end;
  then consider g2 such that
A61: g2 is_sequence_on G & L~g2=L~f2 & g2/.1=f2/.1 & g2/.len g2=f2/.len f2 and
A62: len f2 <= len g2 by A4,A6,GOBOARD2:17;
A63: 2<=len g2 by A2,A62,XXREAL_0:2;
A64: 1<=len f2 by A2,XXREAL_0:2;
  then
A65: 1 in dom f2 by FINSEQ_3:27;
  then
A66: f/.(len f1+1)=f2/.1 by FINSEQ_4:84;
A67: Seg len y = dom y & len y = len f by FINSEQ_1:def 3,GOBOARD1:def 4;
A68: Seg len y1=dom y1 & len y1=len f1 by FINSEQ_1:def 3,GOBOARD1:def 4;
A69: Seg len y2=dom y2 & len y2=len f2 by FINSEQ_1:def 3,GOBOARD1:def 4;
  then
A70: y2.1=q1`2 by A11,A65,GOBOARD1:def 4;
A71: now
    let m;
    set s = y.m;
    assume
A72: m in dom f;
    then
A73: m<=len f by FINSEQ_3:27;
A74: 1<=m by A72,FINSEQ_3:27;
    now
      per cases;
      suppose
A75:    m<=len f1;
        reconsider u=f1/.m as Point of TOP-REAL 2;
A76:    m in dom f1 by A74,A75,FINSEQ_3:27;
        then f/.m=u by FINSEQ_4:83;
        then
A77:    y.m=u`2 by A16,A67,A72,GOBOARD1:def 4;
        y1.m=u`2 by A12,A68,A76,GOBOARD1:def 4;
        hence q1`2<=s by A9,A12,A68,A70,A76,A77,Def2;
      end;
      suppose
A78:    len f1<m;
        then reconsider w5 = m-len f1 as Element of NAT by INT_1:18;
        w5 > 0 by A78,XREAL_1:52;
        then
A79:    1<=w5 by NAT_1:14;
A80:    m = w5 + len f1;
        then reconsider m1=m-len f1 as Element of NAT;
        reconsider u=f2/.m1 as Point of TOP-REAL 2;
A81:    w5<=len f2 by A19,A73,A80,XREAL_1:8;
        then f/.m = f2/.w5 by A80,A79,SEQ_4:153;
        then
A82:    y.m=u`2 by A16,A67,A72,GOBOARD1:def 4;
A83:    m1 in dom f2 by A79,A81,FINSEQ_3:27;
        then y2.m1=u`2 by A11,A69,GOBOARD1:def 4;
        hence q1`2<=s by A10,A11,A69,A70,A83,A82,Def2;
      end;
    end;
    hence q1`2<=s;
  end;
A84: len f1+1 in dom f by A65,FINSEQ_1:41;
  then y.(len f1+1)=q1`2 by A16,A67,A66,GOBOARD1:def 4;
  then
A85: f/.(len f1+1) in rng Col(G,1) by A84,A71,GOBOARD2:28;
A86: len f2 in dom f2 by A64,FINSEQ_3:27;
  then
A87: f/.(len f1+len f2)=f2/.len f2 by FINSEQ_4:84;
A88: y2.(len f2)=q2`2 by A11,A69,A86,GOBOARD1:def 4;
A89: now
    let m;
    set s = y.m;
    assume
A90: m in dom f;
    then
A91: m<=len f by FINSEQ_3:27;
A92: 1<=m by A90,FINSEQ_3:27;
    now
      per cases;
      suppose
A93:    m<=len f1;
        reconsider u=f1/.m as Point of TOP-REAL 2;
A94:    m in dom f1 by A92,A93,FINSEQ_3:27;
        then f/.m=u by FINSEQ_4:83;
        then
A95:    y.m=u`2 by A16,A67,A90,GOBOARD1:def 4;
        y1.m=u`2 by A12,A68,A94,GOBOARD1:def 4;
        hence s<=q2`2 by A9,A12,A68,A88,A94,A95,Def2;
      end;
      suppose
A96:    len f1<m;
        then reconsider w5 = m-len f1 as Element of NAT by INT_1:18;
        w5 > 0 by A96,XREAL_1:52;
        then
A97:    1<=w5 by NAT_1:14;
A98:    m = w5 + len f1;
        then reconsider m1=m-len f1 as Element of NAT;
        reconsider u=f2/.m1 as Point of TOP-REAL 2;
A99:    w5<=len f2 by A19,A91,A98,XREAL_1:8;
        then f/.m = f2/.w5 by A98,A97,SEQ_4:153;
        then
A100:   y.m=u`2 by A16,A67,A90,GOBOARD1:def 4;
A101:   m1 in dom f2 by A97,A99,FINSEQ_3:27;
        then y2.m1=u`2 by A11,A69,GOBOARD1:def 4;
        hence s<=q2`2 by A10,A11,A69,A88,A101,A100,Def2;
      end;
    end;
    hence s<=q2`2;
  end;
A102: len f1+len f2 in dom f by A86,FINSEQ_1:41;
  then y.(len f1+len f2)=q2`2 by A16,A67,A87,GOBOARD1:def 4;
  then
A103: f/.(len f1+len f2) in rng Col(G,width G) by A102,A89,GOBOARD2:29;
  2<=len g1 by A1,A58,XXREAL_0:2;
  hence thesis by A57,A61,A15,A38,A66,A87,A36,A54,A85,A103,A63,Th2;
end;

theorem Th5:
  for f1,f2 being FinSequence of TOP-REAL 2 st f1 is one-to-one
  special & 2 <= len f1 & f2 is one-to-one special & 2 <= len f2 & X_axis(f1)
lies_between (X_axis(f1)).1, (X_axis(f1)).(len f1) & X_axis(f2) lies_between (
X_axis(f1)).1, (X_axis(f1)).(len f1) & Y_axis(f1) lies_between (Y_axis(f2)).1,
(Y_axis(f2)).(len f2) & Y_axis(f2) lies_between (Y_axis(f2)).1, (Y_axis(f2)).(
  len f2) holds L~f1 meets L~f2
proof
  let f1,f2 be FinSequence of TOP-REAL 2;
  assume that
A1: f1 is one-to-one special and
A2: 2 <= len f1 and
A3: f2 is one-to-one special and
A4: 2 <= len f2 & X_axis(f1) lies_between (X_axis(f1)).1, (X_axis(f1)).(
  len f1 ) & X_axis(f2) lies_between (X_axis(f1)).1, (X_axis(f1)).(len f1) &
  Y_axis ( f1) lies_between (Y_axis(f2)).1, (Y_axis(f2)).(len f2) & Y_axis(f2)
  lies_between (Y_axis(f2)).1, (Y_axis(f2)).(len f2);
A5: for n st n in dom f2 & n+1 in dom f2 holds f2/.n <> f2/.(n+1)
  proof
    let n;
    assume n in dom f2 & n+1 in dom f2 & f2/.n=f2/.(n+1);
    then n=n+1 by A3,PARTFUN2:17;
    hence contradiction;
  end;
  for n st n in dom f1 & n+1 in dom f1 holds f1/.n <> f1/.(n+1)
  proof
    let n;
    assume n in dom f1 & n+1 in dom f1 & f1/.n=f1/.(n+1);
    then n=n+1 by A1,PARTFUN2:17;
    hence contradiction;
  end;
  hence thesis by A1,A2,A3,A4,A5,Th4;
end;

canceled 2;

theorem
  for P1,P2,p1,p2,q1,q2 st P1 is_S-P_arc_joining p1,q1 & P2
is_S-P_arc_joining p2,q2 & (for p st p in P1 \/ P2 holds p1`1<=p`1 & p`1<=q1`1)
  & (for p st p in P1 \/ P2 holds p2`2<=p`2 & p`2<=q2`2) holds P1 meets P2
proof
  let P1,P2,p1,p2,q1,q2;
  assume that
A1: P1 is_S-P_arc_joining p1,q1 and
A2: P2 is_S-P_arc_joining p2,q2 and
A3: for p st p in P1 \/ P2 holds p1`1<=p`1 & p`1<=q1`1 and
A4: for p st p in P1 \/ P2 holds p2`2<=p`2 & p`2<=q2`2;
  consider f1 such that
A5: f1 is being_S-Seq and
A6: P1=L~f1 and
A7: p1=f1/.1 and
A8: q1=f1/.len f1 by A1,TOPREAL4:def 1;
  len f1 <> 0 by A5,TOPREAL1:def 10;
  then reconsider f1 as non empty FinSequence of TOP-REAL 2;
A9: Seg len f1=dom f1 by FINSEQ_1:def 3;
  consider f2 such that
A10: f2 is being_S-Seq and
A11: P2=L~f2 and
A12: p2=f2/.1 and
A13: q2=f2/.len f2 by A2,TOPREAL4:def 1;
  len f2 <> 0 by A10,TOPREAL1:def 10;
  then reconsider f2 as non empty FinSequence of TOP-REAL 2;
A14: Seg len f2=dom f2 by FINSEQ_1:def 3;
  set x1 = X_axis(f1), y1 = Y_axis(f1), x2 = X_axis(f2), y2 = Y_axis(f2);
A15: Seg len x1=dom x1 & len x1= len f1 by FINSEQ_1:def 3,GOBOARD1:def 3;
A16: dom y2=Seg len y2 & len y2=len f2 by FINSEQ_1:def 3,GOBOARD1:def 4;
A17: 2<=len f2 by A10,TOPREAL1:def 10;
  then
A18: 1<=len f2 by XXREAL_0:2;
  then 1 in dom f2 by FINSEQ_3:27;
  then
A19: y2.1=p2`2 by A12,A14,A16,GOBOARD1:def 4;
  len f2 in dom f2 by A18,FINSEQ_3:27;
  then
A20: y2.(len f2)=q2`2 by A13,A14,A16,GOBOARD1:def 4;
A21: y2 lies_between y2.1, y2.len f2
  proof
    let n;
    set q = f2/.n;
    assume
A22: n in dom y2;
    then q in L~f2 by A17,A14,A16,GOBOARD1:16;
    then
A23: q in P1 \/ P2 by A11,XBOOLE_0:def 3;
    y2.n=q`2 by A22,GOBOARD1:def 4;
    hence thesis by A4,A19,A20,A23;
  end;
A24: 2<=len f1 by A5,TOPREAL1:def 10;
  then
A25: 1<=len f1 by XXREAL_0:2;
  then 1 in dom f1 by FINSEQ_3:27;
  then
A26: x1.1=p1`1 by A7,A9,A15,GOBOARD1:def 3;
  len f1 in dom f1 by A25,FINSEQ_3:27;
  then
A27: x1.(len f1)=q1`1 by A8,A9,A15,GOBOARD1:def 3;
A28: x1 lies_between x1.1, x1.len f1
  proof
    let n;
    set q=f1/.n;
    assume
A29: n in dom x1;
    then q in L~f1 by A24,A9,A15,GOBOARD1:16;
    then
A30: q in P1 \/ P2 by A6,XBOOLE_0:def 3;
    x1.n=q`1 by A29,GOBOARD1:def 3;
    hence thesis by A3,A26,A27,A30;
  end;
A31: dom x2=Seg len x2 & len x2=len f2 by FINSEQ_1:def 3,GOBOARD1:def 3;
A32: x2 lies_between x1.1, x1.len f1
  proof
    let n;
    set q=f2/.n;
    assume
A33: n in dom x2;
    then q in L~f2 by A17,A14,A31,GOBOARD1:16;
    then
A34: q in P1 \/ P2 by A11,XBOOLE_0:def 3;
    x2.n=q`1 by A33,GOBOARD1:def 3;
    hence thesis by A3,A26,A27,A34;
  end;
A35: dom y1=Seg len y1 & len y1=len f1 by FINSEQ_1:def 3,GOBOARD1:def 4;
A36: y1 lies_between y2.1, y2.len f2
  proof
    let n;
    set q=f1/.n;
    assume
A37: n in dom y1;
    then q in L~f1 by A24,A9,A35,GOBOARD1:16;
    then
A38: q in P1 \/ P2 by A6,XBOOLE_0:def 3;
    y1.n=q`2 by A37,GOBOARD1:def 4;
    hence thesis by A4,A19,A20,A38;
  end;
A39: f2 is one-to-one special by A10,TOPREAL1:def 10;
  f1 is one-to-one special by A5,TOPREAL1:def 10;
  hence thesis by A6,A11,A39,A24,A17,A28,A32,A36,A21,Th5;
end;
