:: Go-Board Theorem
::  by Jaros{\l}aw Kotowicz and Yatsuka Nakamura
::
:: Received August 24, 1992
:: Copyright (c) 1992 Association of Mizar Users

environ

 vocabularies PRE_TOPC, EUCLID, FINSEQ_1, GOBOARD1, FINSEQ_4, RELAT_1, INCSP_1,
      MATRIX_1, TREES_1, BOOLE, FUNCT_1, ARYTM_1, ABSVALUE, MATRIX_2, TOPREAL1,
      GOBOARD2, MCART_1, TOPREAL4, GOBOARD4, RCOMP_1, ARYTM;
 notations TARSKI, XBOOLE_0, ZFMISC_1, SUBSET_1, NUMBERS, XCMPLX_0, REAL_1,
      COMPLEX1, NAT_1, RELAT_1, FUNCT_1, PARTFUN1, FINSEQ_1, SEQ_1, STRUCT_0,
      PRE_TOPC, MATRIX_1, EUCLID, TOPREAL1, TOPREAL4, GOBOARD1, GOBOARD2,
      XXREAL_0, XXREAL_1;
 constructors PARTFUN1, NAT_1, XXREAL_1, COMPLEX1, FINSEQ_3, TOPREAL1,
      TOPREAL4, GOBOARD2, SEQ_1, GOBOARD1, RELSET_1;
 registrations XBOOLE_0, ORDINAL1, RELSET_1, NUMBERS, XREAL_0, MEMBERED,
      FINSEQ_1, STRUCT_0, EUCLID, GOBOARD2, VALUED_0, CARD_1;
 requirements REAL, NUMERALS, BOOLE, SUBSET, ARITHM;
 definitions TARSKI, GOBOARD1;
 theorems TARSKI, NAT_1, ZFMISC_1, FINSEQ_1, ABSVALUE, FINSEQ_2, MATRIX_1,
      TOPREAL1, TOPREAL4, GOBOARD1, GOBOARD2, FINSEQ_3, FINSEQ_4, FUNCT_1,
      PARTFUN2, INT_1, XBOOLE_0, XBOOLE_1, XREAL_1, COMPLEX1, XXREAL_0,
      XXREAL_1, ORDINAL1, PARTFUN1;
 schemes NAT_1, FINSEQ_4;

begin

reserve p,p1,p2,q1,q2 for Point of TOP-REAL 2,
  P1,P2 for Subset of TOP-REAL 2,
  f,f1,f2,g1,g2 for FinSequence of TOP-REAL 2,
  n,m,i,j,k for Element of NAT,
  G,G1 for Go-board,
  x,y for set;

theorem Th1:
  for G,f1,f2 st 1<=len f1 & 1<=len f2 &
  f1 is_sequence_on G & f2 is_sequence_on G &
  f1/.1 in rng Line(G,1) & f1/.len f1 in rng Line(G,len G) &
  f2/.1 in rng Col(G,1) & f2/.len f2 in rng Col(G,width G) holds
  rng f1 meets rng f2
proof
  let G,f1,f2;
  assume
A1: 1<=len f1 & 1<=len f2 & f1 is_sequence_on G & f2 is_sequence_on G &
  f1/.1 in rng Line(G,1) & f1/.len f1 in rng Line(G,len G) &
  f2/.1 in rng Col(G,1) & f2/.len f2 in rng Col(G,width G);
  defpred P[Element of NAT] means for G1,g1,g2 st $1=width G1 & $1>0 &
  1<=len g1 & 1<=len g2 & g1 is_sequence_on G1 & g2 is_sequence_on G1 &
  g1/.1 in rng Line(G1,1) & g1/.len g1 in rng Line(G1,len G1) &
  g2/.1 in rng Col(G1,1) & g2/.len g2 in rng Col(G1,width G1) holds
  rng g1 /\ rng g2 <> {};
A2: P[0];
A3: for k st P[k] holds P[k+1]
  proof
    let k such that
A4: P[k];
    let G1,g1,g2 such that
A5: k+1=width G1 & k+1>0 & 1<=len g1 & 1<=len g2 &
    g1 is_sequence_on G1 & g2 is_sequence_on G1 &
    g1/.1 in rng Line(G1,1) & g1/.len g1 in rng Line(G1,len G1) &
    g2/.1 in rng Col(G1,1) & g2/.len g2 in rng Col(G1,width G1);
A6: dom g1 = Seg len g1 & dom g2 = Seg len g2 by FINSEQ_1:def 3;
    defpred P[Nat] means $1 in dom g2 & g2/.$1 in rng Col(G1,width G1);
A7: ex m be Nat st P[m]
    proof
      take n=len g2;
      thus n in dom g2 by A5,FINSEQ_3:27;
      thus thesis by A5;
    end;
    consider m be Nat such that
A8: P[m] & for i be Nat st P[i] holds m<=i from NAT_1:sch 5(A7);
    reconsider m as Element of NAT by ORDINAL1:def 13;
    set g = g2|m;
A9: 1<=len g by A8,GOBOARD1:38;
A10: g is_sequence_on G1 by A5,GOBOARD1:38;
A11: g/.1 in rng Col(G1,1) by A5,A8,GOBOARD1:22;
A12: g/.len g in rng Col(G1,width G1) by A8,GOBOARD1:23;
    0<>width G1 & 0<>len G1 by GOBOARD1:def 5;
    then
A13: 0+1<=width G1 & 0+1<=len G1 by NAT_1:14;
    then
A14: 1 in Seg width G1 by FINSEQ_1:3;
A15: width G1 in Seg width G1 by A13,FINSEQ_1:3;
A16: 1 in dom G1 by A13,FINSEQ_3:27;
A17: len G1 in dom G1 by A13,FINSEQ_3:27;
A18: 1 in dom g by A9,FINSEQ_3:27;
A19: dom g = Seg len g by FINSEQ_1:def 3;
    reconsider L1 = Line(G1,1), Ll = Line(G1,len G1)
    as FinSequence of TOP-REAL 2;
    defpred P[Nat] means $1 in dom G1 & rng g /\ rng Line(G1,$1) <> {};
A20: ex n be Nat st P[n]
    proof
      consider i being Nat such that
A21:  i in dom Col(G1,1) & g/.1=Col(G1,1).i by A11,FINSEQ_2:11;
      reconsider i as Element of NAT by ORDINAL1:def 13;
A22:  i in Seg len Col(G1,1) by A21,FINSEQ_1:def 3;
      take i;
      len Col(G1,1)=len G1 & len Line(G1,i)=width G1 by MATRIX_1:def 8,def 9;
      then
A23:  dom Line(G1,i) = Seg width G1 by FINSEQ_1:def 3;
      i in Seg len G1 by A22,MATRIX_1:def 9;
      hence i in dom G1 by FINSEQ_1:def 3;
      then g/.1=Line(G1,i).1 by A14,A21,GOBOARD1:17;
      then g/.1 in rng Line(G1,i) & g/.1 in rng g
      by A14,A18,A23,FUNCT_1:def 5,PARTFUN2:4;
      hence thesis by XBOOLE_0:def 4;
    end;
    then
A24: ex n be Nat st P[n];
A25: for n be Nat st P[n] holds n<=len G1 by FINSEQ_3:27;
    consider mi be Nat such that
A26: P[mi] & for n be Nat st P[n] holds mi<=n from NAT_1:sch 5(A20);
A27: dom G1 = Seg len G1 by FINSEQ_1:def 3;
    consider ma be Nat such that
A28: P[ma] & for n be Nat st P[n] holds n<=ma from NAT_1:sch 6(A25,A24);
    reconsider mi,ma as Element of NAT by ORDINAL1:def 13;
    defpred P[Nat] means $1 in dom g1 & g1/.$1 in rng Line(G1,mi);
A29: 1<=mi & mi<=len G1 & ma<=len G1 by A26,A28,FINSEQ_3:27;
    then ex n st P[n] by A5,GOBOARD1:45;
    then
A30: ex n be Nat st P[n];
A31: for n be Nat st P[n] holds n<=len g1 by FINSEQ_3:27;
    consider ma1 be Nat such that
A32: P[ma1] & for n be Nat st P[n] holds n<= ma1 from NAT_1:sch 6(A31,A30);
A33: for n st P[n] holds n<= ma1 by A32;
    reconsider ma1 as Element of NAT by ORDINAL1:def 13;
A34: 1<=m & m<=len g2 by A8,FINSEQ_3:27;
    then
A35: len g = m by FINSEQ_1:80;
A36: rng g c= rng g2
    proof
      let x;
      assume x in rng g;
      then consider n such that
A37:  n in dom g & x=g/.n by PARTFUN2:4;
      n in Seg m by A35,A37,FINSEQ_1:def 3;
      then x=g2/.n & n in dom g2 by A8,A37,FINSEQ_4:86;
      hence thesis by PARTFUN2:4;
    end;
    reconsider Lmi = Line(G1,mi) as FinSequence of TOP-REAL 2;
A38: mi=ma implies rng g1 /\ rng g2 <> {}
    proof
      assume
A39:  mi=ma;
      consider n such that
A40:  n in dom g1 & g1/.n in rng Line(G1,mi) by A5,A29,GOBOARD1:45;
      consider i such that
A41:  i in dom Line(G1,mi) & g1/.n=Lmi/.i by A40,PARTFUN2:4;
A42:  dom Line(G1,mi) = Seg len Line(G1,mi) by FINSEQ_1:def 3;
      reconsider Ci = Col(G1,i) as FinSequence of TOP-REAL 2;
A43:  len Line(G1,mi)=width G1 & len Col(G1,i)= len G1
      by MATRIX_1:def 8,def 9;
      then 1<=i & i<=width G1 by A41,FINSEQ_3:27;
      then consider m such that
A44:  m in dom g & g/.m in rng Col(G1,i) by A9,A10,A11,A12,GOBOARD1:49;
A45:  dom Col(G1,i) = Seg len G1 by A43,FINSEQ_1:def 3
        .= dom G1 by FINSEQ_1:def 3;
      consider j such that
A46:  j in dom Ci & g/.m=Ci/.j by A44,PARTFUN2:4;
A47:  dom Ci = Seg len Ci by FINSEQ_1:def 3;
      reconsider Lj = Line(G1,j) as FinSequence of TOP-REAL 2;
A48:  g/.m in rng g by A44,PARTFUN2:4;
A49:  g1/.n in rng g1 by A40,PARTFUN2:4;
      len Line(G1,mi) = width G1 by MATRIX_1:def 8
        .= len Lj by MATRIX_1:def 8;
      then
A50:  dom Line(G1,mi) = dom Lj by A42,FINSEQ_1:def 3;
A51:  g/.m = Ci.j by A46,PARTFUN1:def 8
        .= Lj.i by A41,A42,A43,A45,A46,GOBOARD1:17
        .= Lj/.i by A41,A50,PARTFUN1:def 8;
      len Lj=width G1 by MATRIX_1:def 8;
      then i in dom Lj by A41,A42,A43,FINSEQ_1:def 3;
      then g/.m in rng Lj by A51,PARTFUN2:4;
      then
A52:  rng g /\ rng Line(G1,j) <> {} by A48,XBOOLE_0:def 4;
      now
        assume j<>mi;
        then j<mi or j>mi by XXREAL_0:1;
        hence contradiction by A26,A27,A28,A39,A43,A46,A47,A52;
      end;
      hence thesis by A36,A41,A48,A49,A51,XBOOLE_0:def 4;
    end;
    consider k1 be Element of NAT such that
A53: k1 in dom Lmi & g1/.ma1 = Lmi/.k1 by A32,PARTFUN2:4;
A54: Seg len Lmi = dom Lmi by FINSEQ_1:def 3;
    reconsider Ck1 = Col(G1,k1) as FinSequence of TOP-REAL 2;
    1<=mi & ma<=len G1 by A26,A28,FINSEQ_3:27;
    then reconsider l1=mi-1, l2=len G1-ma as Element of NAT by INT_1:18;
    deffunc F(Nat) = G1*($1,k1);
    consider h1 be FinSequence of TOP-REAL 2 such that
A55: len h1 = l1 &
for n being Nat st n in dom h1 holds h1/.n=F(n) from FINSEQ_4:sch 2;
A56: k1 in Seg width G1 by A53,A54,MATRIX_1:def 8;
    now per cases;
      suppose
A57:    k=0;
        reconsider c1 = Col(G1,1) as FinSequence of TOP-REAL 2;
        consider x being Element of NAT such that
A58:    x in dom c1 & g2/.1=c1/.x by A5,PARTFUN2:4;
A59:    Seg len c1 = dom c1 & dom c1 c= NAT & len c1 = len G1
        & dom G1 = Seg len G1 by FINSEQ_1:def 3,MATRIX_1:def 9;
        reconsider lx = Line(G1,x) as FinSequence of TOP-REAL 2;
        0<>width G1 by GOBOARD1:def 5;
        then 0+1<=width G1 by NAT_1:14;
        then
A60:    1 in Seg width G1 & x in dom G1 &
        Seg len lx=dom lx & len lx=width G1 & Seg len g2=dom g2
        by A58,A59,FINSEQ_1:3,def 3,MATRIX_1:def 8;
        1<=x & x<=len G1 by A58,A59,FINSEQ_3:27;
        then consider m such that
A61:    m in dom g1 & g1/.m in rng lx by A5,GOBOARD1:45;
        consider y being Element of NAT such that
A62:    y in dom lx & lx/.y=g1/.m by A61,PARTFUN2:4;
A63:    lx/.y = lx.y & c1/.x = c1.x by A58,A62,PARTFUN1:def 8;
A64:    y
        =1 & 1 in dom g2 by A5,A57,A60,A62,FINSEQ_1:4,FINSEQ_3:27,TARSKI:def 1;
        then
A65:    g1/.m=g2/.1 by A58,A60,A62,A63,GOBOARD1:17;
A66:    g1/.m in rng g1 by A61,PARTFUN2:4;
        g2/.1 in rng g2 by A64,PARTFUN2:4;
        hence thesis by A65,A66,XBOOLE_0:def 4;
      end;
      suppose
A67:    k<>0;
        then
A68:    0<k by NAT_1:3;
        now per cases;
          suppose mi=ma;
            hence thesis by A38;
          end;
          suppose
A69:        mi<>ma;
            defpred P[Nat] means
            $1 in dom g1 & ma1<$1 & g1/.$1 in rng Line(G1,ma);
A70:        mi<=ma by A26,A28;
            then
A71:        mi<ma by A69,XXREAL_0:1;
            then ex n st P[n] by A5,A26,A29,A32,GOBOARD1:53;
            then
A72:        ex n be Nat st P[n];
            consider mi1 be Nat such that
A73:        P[mi1] & for n be Nat st P[n] holds mi1<=n from NAT_1:sch 5(A72);
            set f1=g1|mi1;
            ma1<=mi1 & mi1<=mi1+1 by A73,NAT_1:11;

then reconsider l=mi1+1-ma1 as Element of NAT by INT_1:18,XXREAL_0:2;
            1<=ma1 by A32,FINSEQ_3:27;
            then reconsider w=ma1-1 as Element of NAT by INT_1:18;
A74:        for n st n in Seg l holds f1/.(w+n)=g1/.(w+n) & w+n in dom g1
            proof
              let n such that
A75:          n in Seg l;
              0+1<=ma1 by A32,FINSEQ_3:27;
              then 0<=ma1-1 & 1<=n & n<=l by A75,FINSEQ_1:3,XREAL_1:21;
              then
A76:          0+1<=ma1-1+n & n+ma1<=l+ma1 by XREAL_1:9;
              then n+ma1-1<=mi1 by XREAL_1:22;
              then w+n in Seg mi1 by A76,FINSEQ_1:3;
              hence thesis by A73,FINSEQ_4:86;
            end;
            defpred P[Nat,Element of TOP-REAL 2] means
            $2=f1/.(w+$1);
A77:        for n being Nat st n in Seg l ex p st P[n,p];
            consider f such that
A78:        len f = l & for n being Nat st n in Seg l holds P[n,f/.n]
            from FINSEQ_4:sch 1(A77);
A79:        dom f = Seg l by A78,FINSEQ_1:def 3;
            reconsider Lma = Line(G1,ma) as FinSequence of TOP-REAL 2;
            consider k2 be Element of NAT such that
A80:        k2 in dom Lma & g1/.mi1=Lma/.k2 by A73,PARTFUN2:4;
A81:        dom Lma = Seg len Lma by FINSEQ_1:def 3;
            reconsider Ck2 = Col(G1,k2) as FinSequence of TOP-REAL 2;
A82:        k2 in Seg width G1 by A80,A81,MATRIX_1:def 8;
            deffunc F(Nat) = G1*(ma+$1,k2);
            consider h2 be FinSequence of TOP-REAL 2 such that
A83:        len h2 = l2 & for n being Nat st n in dom h2 holds h2/.n = F(n)
            from FINSEQ_4:sch 2;
A84:        dom h2 = Seg len h2 by FINSEQ_1:def 3;
            set ff = h1^f^h2;
            ma1+1<=mi1 & mi1<=mi1+1 by A73,NAT_1:13;
            then
A85:        ma1+1<=mi1+1 & Seg len f=dom f & Seg len h2=dom h2 &
            dom h1=Seg len h1 by FINSEQ_1:def 3,XXREAL_0:2;
            then
A86:        1<=l & len f=l by A78,XREAL_1:21;
A87:        Indices G1=[:dom G1,Seg width G1:] by MATRIX_1:def 5;
A88:        now
              let n;
              assume n in dom h1;
              then
A89:          1<=n & n<=l1 & l1<=mi & mi<=len G1
              by A26,A55,FINSEQ_3:27,XREAL_1:45;
              then n<=mi by XXREAL_0:2;
              then n<=len G1 by A89,XXREAL_0:2;
              hence n in dom G1 by A89,FINSEQ_3:27;
            end;
A90:        now
              let n;
              assume n in dom h2;
              then 1<=n & n<=l2 & n<=n+ma by A83,FINSEQ_3:27,NAT_1:11;
              then 1<=n+ma & ma+n<=ma+l2 by XREAL_1:9,XXREAL_0:2;
              hence ma+n in dom G1 by FINSEQ_3:27;
            end;
A91:        now
              let n;
              assume n in dom h1;
              then
A92:          h1/.n=G1*(n,k1) & n in dom G1 by A55,A88;
              take i=n,k1;
              thus [i,k1] in Indices G1 &
              h1/.n=G1*(i,k1) by A56,A87,A92,ZFMISC_1:106;
            end;
A93:        now
              let n;
              assume n in dom h2;
              then
A94:          h2/.n=G1*(ma+n,k2) & ma+n in dom G1 by A83,A90;
              take m=ma+n,k2;
              thus [m,k2] in Indices G1 & h2/.n=G1*(m,k2)
              by A82,A87,A94,ZFMISC_1:106;
            end;
A95:        now
              let n;
              assume n in dom f;
              then
A96:          n in Seg l & dom f=Seg l & f/.n=f1/.(w+n) by A78,A79;
              then w is Element of NAT & w+n in dom g1 & f/.n=g1/.(w+n) by A74;
              then consider i,j such that
A97:          [i,j] in Indices G1 & g1/.(w+n)=G1*(i,j) by A5,GOBOARD1:def 11;
              take i,j;
              thus [i,j] in Indices G1 & f/.n=G1*(i,j) by A74,A96,A97;
            end;
            then for n st n in dom(h1^f)
            ex i,j st [i,j] in Indices G1 & (h1^f)/.n=G1*(i,j)
            by A91,GOBOARD1:39;
            then
A98:        for n st n in dom ff
            ex i,j st [i,j] in Indices G1 & ff/.n=G1*(i,j) by A93,GOBOARD1:39;
A99:        now
              let n;
              assume n in dom h1 & n+1 in dom h1;
              then
A100:         n in dom G1 & n+1 in dom G1 & h1/.n=G1*(n,k1) &
              h1/.(n+1)=G1*(n+1,k1) by A55,A88;
              then
A101:         [n,k1] in Indices G1 & [n+1,k1] in Indices G1
              by A56,A87,ZFMISC_1:106;
              let i1,i2,j1,j2 be Element of NAT;
              assume
              [i1,i2] in Indices G1 & [j1,j2] in Indices G1 & h1/.n=G1*(i1,i2)
              & h1/.(n+1)=G1*(j1,j2);

then i1=n & i2=k1 & j1=n+1 & j2=k1 & 0<=1 by A100,A101,GOBOARD1:21;
              hence abs(i1-j1)+abs(i2-j2)= abs(n-n+-1)+0 by ABSVALUE:7
                .= abs(1) by COMPLEX1:138
                .= 1 by ABSVALUE:def 1;
            end;
A102:       w+l= mi1;
A103:       now
              let n;
              assume n in dom h2 & n+1 in dom h2;
              then
A104:         ma+n in dom G1 & ma+(n+1) in dom G1 & h2/.n=G1 *(ma+n,k2) &
              h2/.(n+1)=G1*(ma+(n+1),k2) & ma+(n+1)=ma+n+1 by A83,A90;
              then
A105:         [ma+n,k2] in Indices G1 & [ma+n+1,k2] in Indices G1
              by A82,A87,ZFMISC_1:106;
              let i1,i2,j1,j2 be Element of NAT;
              assume [i1,i2] in Indices G1 & [j1,j2] in Indices G1 & h2/.n=G1*
              (i1,i2) & h2/.(n+1)=G1*(j1,j2);
              then i1=ma+n & i2=k2 & j1=ma+n+1 & j2=k2 & 0<=1 by A104,A105,
GOBOARD1:21;
              hence abs(i1-j1)+abs(i2-j2)= abs(ma+n-(ma+n)+-1)+0 by ABSVALUE:7
                .= abs(1) by COMPLEX1:138
                .= 1 by ABSVALUE:def 1;
            end;
A106:       now
              let n;
              assume n in dom f & n+1 in dom f;
              then n in Seg l & n+1 in Seg l & dom f=Seg l & f/.n=f1/.(w+n) &
              f/.(n+1)=f1/.(w+(n+1)) & w+(n+1)=w+n+1 by A78,A79;
              then
A107:         w is Element of NAT & w+n in dom g1 & f/.n=g1 /.(w+n) &
              w+n+1 in dom g1 & f/.(n+1)=g1/.(w+n+1) by A74;
              let i1,i2,j1,j2 be Element of NAT;
              assume
              [i1,i2] in Indices G1 & [j1,j2] in Indices G1 & f/.n=G1*(i1,i2)
              & f/.(n+1)=G1*(j1,j2);
              hence abs(i1-j1)+abs(i2-j2)=1 by A5,A107,GOBOARD1:def 11;
            end;
            now
              let i1,i2,j1,j2 be Element of NAT;
              assume
A108:         [i1,i2] in Indices G1 & [j1,j2] in Indices G1 &
              h1/.len h1=G1*(i1,i2) & f/.1=G1*(j1,j2) &
              len h1 in dom h1 & 1 in dom f;
              then
A109:         h1/.len h1=G1*(l1,k1) & l1 in dom G1 by A55,A88;
              then [l1,k1] in Indices G1 by A56,A87,ZFMISC_1:106;
              then
A110:         i1=l1 & i2=k1 & 0<=1 by A108,A109,GOBOARD1:21;
A111:         Lmi/.k1 = Lmi.k1 by A53,PARTFUN1:def 8;
A112:         w+1=ma1;
              then 1 in Seg l & dom f=Seg l & f/.1=f1/.ma1 by A78,A79,A108;
              then
A113:         f/.1=g1/.ma1 by A74,A112
                .= G1*(mi,k1) by A53,A56,A111,MATRIX_1:def 8;
              [mi,k1] in Indices G1 by A26,A56,A87,ZFMISC_1:106;
              then j1=mi & j2=k1 by A108,A113,GOBOARD1:21;
              hence abs(i1-j1)+abs(i2-j2)= abs(mi-1-mi)+0 by A110,ABSVALUE:7
                .= abs(-1)
                .= abs(1) by COMPLEX1:138
                .= 1 by ABSVALUE:def 1;
            end;
            then
A114:       for n st n in dom(h1^f) & n+1 in dom(h1^f)
            for i1,i2,j1,j2 be Element of NAT st [i1,i2] in Indices G1 &
            [j1,j2] in Indices G1 &
            (h1^f)/.n=G1*(i1,i2) & (h1^f)/.(n+1)=G1*(j1,j2) holds
            abs(i1-j1)+abs(i2-j2)=1 by A99,A106,GOBOARD1:40;
            set hf=h1^f;
            now
              let i1,i2,j1,j2 be Element of NAT;
              assume
A115:         [

i1,i2] in Indices G1 & [j1,j2] in Indices G1 & hf/.len hf=G1*(i1,i2)
              & h2/.1=G1*(j1,j2) & len hf in dom hf & 1 in dom h2;
              then
A116:         h2/.1=G1*(ma+1,k2) & ma+1 in dom G1 by A83,A90;
              then [ma+1,k2] in Indices G1 by A82,A87,ZFMISC_1:106;
              then
A117:         j1=ma+1 & j2=k2 by A115,A116,GOBOARD1:21;
A118:         len f in dom f & 0<=1 by A79,A86,FINSEQ_1:3;
A119:         Lma/.k2 = Lma.k2 by A80,PARTFUN1:def 8;
A120:         hf/.len hf=hf/.(len h1+len f) by FINSEQ_1:35
                .= f/.len f by A118,FINSEQ_4:84
                .= f1/.(w+l) by A78,A79,A118
                .= g1/.mi1 by A74,A78,A79,A118
                .= G1*(ma,k2) by A80,A82,A119,MATRIX_1:def 8;
              [ma,k2] in Indices G1 by A28,A82,A87,ZFMISC_1:106;
              then i1=ma & i2=k2 by A115,A120,GOBOARD1:21;
              hence abs(i1-j1)+abs(i2-j2)=abs(ma-(ma+1))+0 by A117,ABSVALUE:7
                .=abs(-(ma+1 -ma))
                .=abs(1) by COMPLEX1:138
                .=1 by ABSVALUE:def 1;
            end;
            then for n st n in dom ff & n+1 in dom ff
            for m,k,i,j st [m,k] in Indices G1 & [i,j] in Indices G1 &
            ff/.n=G1*(m,k) & ff/.(n+1)=G1*(i,j) holds abs(m-i)+abs(k-j)=1
            by A103,A114,GOBOARD1:40;
            then
A121:       ff is_sequence_on G1 by A98,GOBOARD1:def 11;
A122:       now per cases;
              suppose
A123:           mi=1;
                then h1 = {} by A55;
                then
A124:           ff=f^h2 by FINSEQ_1:47;
A125:           1 in Seg l & 1<=ma1 by A6,A32,A86,FINSEQ_1:3;
                then
A126:           ma1 in Seg mi1 by A73,FINSEQ_1:3;
A127:           w+1=ma1;
                ff/.1=f/.1 by A79,A124,A125,FINSEQ_4:83
                  .= f1/.ma1 by A78,A125,A127
                  .= g1/.ma1 by A73,A126,FINSEQ_4:86;
                hence ff/.1 in rng Line(G1,1) by A32,A123;
              end;
              suppose
A128:           mi<>1;
                1<=mi by A26,FINSEQ_3:27;
                then 1<mi by A128,XXREAL_0:1;
                then 1+1<=mi by NAT_1:13;
                then
A129:           1<=l1 by XREAL_1:21;
                then
A130:           1 in dom h1 by A55,FINSEQ_3:27;
A131:           len(h1^f)=len h1 + len f by FINSEQ_1:35;
A132:           len Line(G1,1)=width G1 by MATRIX_1:def 8;
                then dom Line(G1,1) = Seg width G1 by FINSEQ_1:def 3;
                then
A133:           L1/.k1 = L1.k1 by A56,PARTFUN1:def 8;
                0<=len f by NAT_1:2;
                then 0+1<=len(h1^f) by A55,A129,A131,XREAL_1:9;
                then 1 in dom(h1^f) by FINSEQ_3:27;
                then
A134:           ff/.1=(h1^f)/.1 by FINSEQ_4:83
                  .=h1/.1 by A130,FINSEQ_4:83
                  .=G1*(1,k1) by A55,A130
                  .=L1/.k1 by A56,A133,MATRIX_1:def 8;
                k1 in dom L1 by A56,A132,FINSEQ_1:def 3;
                hence ff/.1 in rng Line(G1,1) by A134,PARTFUN2:4;
              end;
            end;
A135:       len ff=len(h1^f)+len h2 by FINSEQ_1:35
              .=len h1+len f+len h2 by FINSEQ_1:35;
            0+0<=len h1+len h2 by NAT_1:2;
            then
A136:       0+1<=len f+(len h1+len h2) by A86,XREAL_1:9;
A137:       now per cases;
              suppose
A138:           ma=len G1;
                then h2 = {} by A83;
                then
A139:           ff=h1^f & 1<=mi1 by A73,FINSEQ_1:47,FINSEQ_3:27;
                then
A140:           len f in dom f & mi1 in Seg mi1 by A85,A86,FINSEQ_1:3;
                ff/.len ff=ff/.(len h1+len f) by A139,FINSEQ_1:35
                  .= f/.l by A78,A139,A140,FINSEQ_4:84
                  .= f1/.mi1 by A78,A79,A102,A140
                  .= g1/.mi1 by A73,A140,FINSEQ_4:86;
                hence ff/.len ff in rng Line(G1,len G1) by A73,A138;
              end;
              suppose
A141:           ma<>len G1;
                ma<=len G1 by A28,FINSEQ_3:27;
                then ma<len G1 by A141,XXREAL_0:1;
                then ma+1<=len G1 by NAT_1:13;
                then
A142:           1<=l2 by XREAL_1:21;
                then
A143:           l2 in Seg l2 by FINSEQ_1:3;
A144:           len h2 in dom h2 by A83,A142,FINSEQ_3:27;
A145:           len Line(G1,len G1)=width G1 by MATRIX_1:def 8;
                then k2 in dom Ll by A82,FINSEQ_1:def 3;
                then
A146:           Ll/.k2 = Ll.k2 by PARTFUN1:def 8;
A147:           ff/.len ff=ff/.(len(h1^f)+len h2) by FINSEQ_1:35
                  .=h2/.l2 by A83,A144,FINSEQ_4:84
                  .=G1*(ma+l2,k2) by A83,A84,A143
                  .=Ll/.k2 by A82,A146,MATRIX_1:def 8;
                k2 in dom Ll by A82,A145,FINSEQ_1:def 3;
                hence ff/.len ff in rng Line(G1,len G1) by A147,PARTFUN2:4;
              end;
            end;
A148:       rng ff = rng(h1^f) \/ rng h2 by FINSEQ_1:44
              .= rng h1 \/ rng f \/ rng h2 by FINSEQ_1:44;
A149:       for k st k in Seg width G1 & rng f /\ rng Col(G1,k)={} holds
            rng ff /\ rng Col(G1,k)={}
            proof
              let k;
              assume that
A150:         k in Seg width G1 and
A151:         rng f /\ rng Col(G1,k)={};
              set gg=Col(G1,k);
              assume
A152:         rng ff /\ rng gg <> {};
              consider x being Element of rng ff /\ rng gg;
A153:         w+1=ma1;
              rng ff = rng f \/ (rng h1 \/ rng h2) by A148,XBOOLE_1:4;
              then
A154:         rng ff /\ rng gg = {}
              \/ (rng h1 \/ rng h2) /\ rng gg by A151,XBOOLE_1:23
                .= rng h1 /\ rng gg \/ rng h2 /\ rng gg by XBOOLE_1:23;
A155:         len Col(G1,k1)=len G1 & len Col(G1,k2)=len G1 by MATRIX_1:def 9;
              now per cases by A152,A154,XBOOLE_0:def 3;
                suppose x in rng h1 /\ rng gg;
                  then
A156:             x in rng h1 & x in rng gg by XBOOLE_0:def 4;
                  then consider i such that
A157:             i in dom h1 & x=h1/.i by PARTFUN2:4;
A158:             x=G1*(i,k1) by A55,A157;
                  reconsider y=x as Point of TOP-REAL 2 by A157;
A159:             dom Col(G1,k1) = Seg len G1 by A155,FINSEQ_1:def 3
                    .= dom G1 by FINSEQ_1:def 3;
                  then
A160:             i in dom Ck1 by A88,A157;
A161:             Lmi/.k1 = Lmi.k1 & Ck1/.mi = Ck1.mi
                  by A26,A53,A159,PARTFUN1:def 8;
                  Ck1/.i = Ck1.i by A88,A157,A159,PARTFUN1:def 8;
                  then y=Ck1/.i by A158,A159,A160,MATRIX_1:def 9;
                  then y in rng Ck1 by A160,PARTFUN2:4;
                  then
A162:             k1
                  =k & 1 in Seg l by A56,A86,A150,A156,FINSEQ_1:3,GOBOARD1:20;
                  then f/.1=f1/.ma1 & f1/.ma1=g1/.(w+1) by A74,A78,A153;
                  then f/.1= Ck1/.mi by A26,A53,A56,A161,GOBOARD1:17;
                  then f/.1 in rng Col(G1,k) & f/.1 in rng f
                  by A26,A79,A159,A162,PARTFUN2:4;
                  hence contradiction by A151,XBOOLE_0:def 4;
                end;
                suppose x in rng h2 /\ rng gg;
                  then
A163:             x in rng h2 & x in rng gg by XBOOLE_0:def 4;
                  then consider i such that
A164:             i in dom h2 & x=h2/.i by PARTFUN2:4;
A165:             x=G1*(ma+i,k2) by A83,A164;
                  reconsider y=x as Point of TOP-REAL 2 by A164;
A166:             dom Col(G1,k2) = Seg len G1 by A155,FINSEQ_1:def 3
                    .= dom G1 by FINSEQ_1:def 3;
                  then
A167:             ma+i in dom Ck2 by A90,A164;
A168:             Lma/.k2 = Lma.k2 &
                  Ck2/.ma = Ck2.ma by A28,A80,A166,PARTFUN1:def 8;
                  Ck2/.(ma+i) = Ck2.(ma+i) by A90,A164,A166,PARTFUN1:def 8;
                  then y=Ck2/.(ma+i) by A165,A166,A167,MATRIX_1:def 9;
                  then y in rng Ck2 by A167,PARTFUN2:4;
                  then
A169:             k2=k & l in Seg l by A82,A86,A150,A163,FINSEQ_1:3,GOBOARD1:20
                  ;
                  then f/.l=f1/.(w+l) & f1/.(w+l)=g1/.(w+l) by A74,A78;
                  then f/.l=Ck2/.ma by A28,A80,A82,A168,GOBOARD1:17;
                  then f/.l in rng Col(G1,k) & f/.l in rng f
                  by A28,A79,A166,A169,PARTFUN2:4;
                  hence contradiction by A151,XBOOLE_0:def 4;
                end;
              end;
              hence contradiction;
            end;
A170:       rng h1 /\ rng g = {}
            proof
              assume
A171:         not thesis;
              consider x being Element of rng h1 /\ rng g;
A172:         x in rng h1 & x in rng g by A171,XBOOLE_0:def 4;
              then consider n1 be Element of NAT such that
A173:         n1 in dom h1 & x=h1/.n1 by PARTFUN2:4;
A174:         x=G1*(n1,k1) & 1<=n1 & n1<=l1 by A55,A173,FINSEQ_3:27;
              consider n2 be Element of NAT such that
A175:         n2 in dom g & x=g/.n2 by A172,PARTFUN2:4;
              consider i1,i2 be Element of NAT such that
A176:         [i1,i2] in Indices G1 & g/.n2=G1*(i1,i2)
              by A10,A175,GOBOARD1:def 11;
              reconsider L=Line(G1,i1) as FinSequence of TOP-REAL 2;
A177:         Seg len L = dom L by FINSEQ_1:def 3;
A178:         i1 in dom G1 & i2 in Seg width G1 by A87,A176,ZFMISC_1:106;
A179:         len L=width G1 by MATRIX_1:def 8;
              then L/.i2 = L.i2 by A177,A178,PARTFUN1:def 8;
              then g/.n2=L/.i2 by A176,A178,MATRIX_1:def 8;
              then g/.n2 in rng L & g/.n2 in rng g
              by A175,A177,A178,A179,PARTFUN2:4;
              then rng g /\ rng L <> {} by XBOOLE_0:def 4;
              then
A180:         mi<=i1 by A26,A178;
              n1 in dom G1 by A88,A173;
              then [n1,k1] in Indices G1 by A56,A87,ZFMISC_1:106;
              then i1=n1 & 0<1 by A174,A175,A176,GOBOARD1:21;
              then mi<=mi-1 & mi-1<mi by A174,A180,XREAL_1:46,XXREAL_0:2;
              hence contradiction;
            end;
            rng h2 /\ rng g = {}
            proof
              assume
A181:         not thesis;
              consider x being Element of rng h2 /\ rng g;
A182:         x in rng h2 & x in rng g by A181,XBOOLE_0:def 4;
              then consider n1 be Element of NAT such that
A183:         n1 in dom h2 & x=h2/.n1 by PARTFUN2:4;
A184:         x=G1*(ma+n1,k2) & 1<=n1 & n1<=l2 by A83,A183,FINSEQ_3:27;
              consider n2 be Element of NAT such that
A185:         n2 in dom g & x=g/.n2 by A182,PARTFUN2:4;
              consider i1,i2 be Element of NAT such that
A186:         [i1,i2] in Indices G1 & g/.n2=G1*(i1,i2)
              by A10,A185,GOBOARD1:def 11;
              reconsider L=Line(G1,i1) as FinSequence of TOP-REAL 2;
A187:         Seg len L = dom L by FINSEQ_1:def 3;
A188:         i1 in dom G1 & i2 in Seg width G1 by A87,A186,ZFMISC_1:106;
A189:         len L=width G1 by MATRIX_1:def 8;
              then L/.i2 = L.i2 by A187,A188,PARTFUN1:def 8;
              then g/.n2=L/.i2 by A186,A188,MATRIX_1:def 8;
              then g/.n2 in rng L & g/.n2 in rng g
              by A185,A187,A188,A189,PARTFUN2:4;
              then rng g /\ rng L <> {} by XBOOLE_0:def 4;
              then
A190:         i1<=ma by A28,A188;
              ma+n1 in dom G1 by A90,A183;
              then [ma+n1,k2] in Indices G1 by A82,A87,ZFMISC_1:106;
              then i1=ma+n1 by A184,A185,A186,GOBOARD1:21;
              then n1<=0 by A190,XREAL_1:31;
              hence contradiction by A184,XXREAL_0:2;
            end;
            then
A191:       rng ff /\ rng g = ((rng h1 \/ rng f) /\ rng g) \/
            {} by A148,XBOOLE_1:23
              .= {} \/ rng f /\ rng g by A170,XBOOLE_1:23
              .= rng f /\ rng g;
A192:       rng f c= rng g1
            proof
              let x;
              assume x in rng f;
              then consider n such that
A193:         n in dom f & x=f/.n by PARTFUN2:4;
              n in Seg l & n in Seg l & f/.n=f1/.(w+n) by A78,A85,A193;
              then w is Element of NAT & w+n in dom g1 & f/.n=g1/.(w+n) by A74;
              hence thesis by A193,PARTFUN2:4;
            end;
            then
A194:       rng ff /\ rng g c= rng g1 /\ rng g2 by A36,A191,XBOOLE_1:27;
A195:       0+1<width G1 by A5,A68,XREAL_1:8;
            then
A196:       len DelCol(G1,1)=len G1 & len DelCol(G1,width G1)= len G1 &
            Seg len ff=dom ff by A14,A15,FINSEQ_1:def 3,GOBOARD1:def 10;
            then
A197:       1 in dom ff & len ff in dom ff by A135,A136,FINSEQ_1:3;
A198:       dom DelCol(G1,1) = Seg len G1 by A196,FINSEQ_1:def 3
              .= dom G1 by FINSEQ_1:def 3;
            thus thesis
            proof per cases;
              suppose rng f /\ rng Col(G1,1)={};
                then rng ff /\ rng Col(G1,1)={} by A14,A149;
                then
A199:           rng ff misses rng Col(G1,1) by XBOOLE_0:def 7;
                defpred P[Nat] means $1 in dom g & g/.$1 in rng Col(G1,1);
A200:           for m be Nat st P[m] holds m<=len g by FINSEQ_3:27;
A201:           ex m be Nat st P[m]
                proof
                  take 1;
                  thus thesis by A5,A8,A9,FINSEQ_3:27,GOBOARD1:22;
                end;
                consider m be Nat such that
A202:           P

[m] & for k be Nat st P[k] holds k<=m from NAT_1:sch 6(A200,A201);
A203:           for k st P[k] holds k<=m by A202;
                reconsider m as Element of NAT by ORDINAL1:def 13;
                reconsider p=g/.m as Point of TOP-REAL 2;
A204:           now
                  assume
A205:             m>=len g;
                  m<=len g by A202,FINSEQ_3:27;
                  then p in rng Col(G1,1) & p in rng Col(G1,width G1)
                  by A12,A202,A205,XXREAL_0:1;
                  then 1=k+1 by A5,A14,A15,GOBOARD1:20;
                  hence contradiction by A67;
                end;
                then reconsider ll = len g-m as Element of NAT by INT_1:18;
                deffunc F(Nat) = g/.(m+$1);
                consider t be FinSequence of TOP-REAL 2 such that
A206:           len t = ll &
                for n being Nat st n in dom t holds t/.n = F(n)
                 from FINSEQ_4:sch 2;
A207:           Seg len t = dom t by FINSEQ_1:def 3;
A208:           dom t = Seg ll by A206,FINSEQ_1:def 3;
A209:           for n st n in dom t holds m+n in dom g
                proof
                  let n;
                  assume n in dom t;
                  then 1<=n & n<=ll & n<=n+m by A208,FINSEQ_1:3,NAT_1:11;
                  then 1<=n+m & m+n<=m+ll by XREAL_1:9,XXREAL_0:2;
                  hence thesis by FINSEQ_3:27;
                end;
A210:           rng t c= rng g
                proof
                  let y;
                  assume y in rng t;
                  then consider x being Element of NAT such that
A211:             x in dom t & t/.x=y by PARTFUN2:4;
                  1<=x & x<=ll & x<=x+m by A208,A211,FINSEQ_1:3,NAT_1:11;
                  then 1<=x+m & m+x<=m+ll by XREAL_1:9,XXREAL_0:2;
                  then m+x in dom g by FINSEQ_3:27;
                  then g/.(m+x) in rng g by PARTFUN2:4;
                  hence thesis by A206,A211;
                end;
                reconsider t as FinSequence of TOP-REAL 2;
                set D = DelCol(G1,1);
A212:           width D = k by A5,A14,A67,GOBOARD1:26,NAT_1:3;
                0<>width D by GOBOARD1:def 5;
                then 0<width D by NAT_1:3;
                then
A213:           0+1<=width D by NAT_1:13;
                m+1<=len g by A204,NAT_1:13;
                then
A214:           1<=len t by A206,XREAL_1:21;
                then 1 in Seg ll by A206,FINSEQ_1:3;
                then
A215:           t/.1 = g/.(m+1) by A206,A207;
                Col(D,1)=Col(G1,1+1) & 1+1 in Seg width G1
                by A5,A14,A68,A212,A213,GOBOARD1:30;
                then
A216:           t/.1 in rng Col(D,1)
                by A9,A10,A12,A14,A202,A203,A215,GOBOARD1:48;
                len t in Seg ll by A206,A214,FINSEQ_1:3;
                then t/.len t = g/.(m+ll) by A206,A207
                  .= g/.len g;
                then
A217:           t/.len t in rng Col(D,width D)
                by A5,A12,A14,A68,A212,A213,GOBOARD1:30;
A218:           Indices D = [:dom D,Seg width D:] by MATRIX_1:def 5;
A219:           now
                  let n;
                  assume
A220:             n in dom t;
                  then m+n in dom g by A209;
                  then consider i1,i2 be Element of NAT such that
A221:             [i1,i2] in Indices G1 & g/.(m+n)=G1*(i1,i2)
                  by A10,GOBOARD1:def 11;
                  take i1;
                  reconsider Ci2 = Col(G1,i2) as FinSequence of TOP-REAL 2;
A222:             i1
                  in dom G1 & i2 in Seg width G1 & t/.n=g/.(m+n) & m+n in dom g
                  by A87,A206,A209,A220,A221,ZFMISC_1:106;
                  len Ci2 = len G1 by MATRIX_1:def 9;
                  then
A223:             dom Ci2 = Seg len G1 by FINSEQ_1:def 3
                    .= dom G1 by FINSEQ_1:def 3;
                  then Ci2/.i1 = Ci2.i1 by A222,PARTFUN1:def 8;
                  then Ci2/.i1 = G1*(i1,i2) & dom Col(G1,i2)=dom Col(G1,i2) &
                  len Col(G1,i2)=len G1 by A222,MATRIX_1:def 9;
                  then
A224:             g/.(m+n) in rng Col(G1,i2) by A221,A222,A223,PARTFUN2:4;
                  now
                    assume i2=1;
                    then
A225:               m+n<=m & 1<=n by A202,A208,A220,A222,A224,FINSEQ_1:3;
                    then m+1<=m+n by XREAL_1:9;
                    then m+1<=m by A225,XXREAL_0:2;
                    then 1<=m-m by XREAL_1:21;
                    then 1<=0;
                    hence contradiction;
                  end;
                  then
A226:             1<>i2 & 1<=i2 & i2<=width G1 by A222,FINSEQ_1:3;
                  then
A227:             1<i2 by XXREAL_0:1;
                  reconsider l=i2-1 as Element of NAT by A226,INT_1:18;
                  take l;
                  1+1<=i2 by A227,NAT_1:13;
                  then
A228:             1<=l & l<=width D & l+1=i2 by A5,A212,A226,XREAL_1:21,22;
                  then l in Seg width D by FINSEQ_1:3;
                  hence [i1,l] in Indices D by A198,A218,A222,ZFMISC_1:106;

thus t/.n = D*(i1,l) by A5,A14,A68,A212,A221,A222,A228,GOBOARD1:32;
                end;
                now
                  let n;
                  assume
A229:             n in dom t & n+1 in dom t;
                  then
A230:             t/.n=g/.(m+n) & t/.(n+1)=g/.(m+(n+1)) by A206;
                  let i1,i2,j1,j2 be Element of NAT;
                  assume
A231:             [
                  i1,i2] in Indices D & [j1,j2] in Indices D & t/.n=D*(i1,i2) &
                  t/.(n+1)=D*(j1,j2);
                  then
A232:             i1 in dom D & i2 in Seg k & j1 in dom D &
                  j2 in Seg k & m+(n+1)=m+n+1 by A212,A218,ZFMISC_1:106;
                  then 1<=i2 & i2<=k & 1<=j2 & j2<=k by FINSEQ_1:3;
                  then
A233:             g/.(m+n)=G1*(i1,i2+1) & g/.(m+n+1)=G1* (j1,j2+1) &
                  i2+1 in Seg width G1 & j2+1 in Seg width G1
                  by A5,A14,A68,A198,A230,A231,A232,GOBOARD1:32;
                  then
A234:             [i1,i2+1] in Indices G1 & [j1,j2+1] in Indices G1
                  by A87,A198,A232,ZFMISC_1:106;
                  m+n in dom g & m+n+1 in dom g by A209,A229,A232;
                  hence 1= abs(i1-j1)+abs(i2+1 -(j2+1))
                  by A10,A233,A234,GOBOARD1:def 11
                    .=abs(i1-j1)+abs(i2-j2);
                end;
                then
A235:           t is_sequence_on D by A219,GOBOARD1:def 11;
                ff is_sequence_on D &
                ff/.1 in rng Line(D,1) & ff/.len ff in rng Line(D,len D)

by A14,A16,A17,A121,A122,A137,A195,A196,A197,A199,GOBOARD1:37,41;
                then
A236:           rng
                ff /\ rng t <> {} by A4,A68,A135,A136,A212,A214,A216,A217,A235;
                consider x being Element of rng ff /\ rng t;
                rng ff /\ rng t c= rng ff /\ rng g by A210,XBOOLE_1:26;
                then x in rng ff /\ rng g by A236,TARSKI:def 3;
                hence thesis by A194;
              end;
              suppose
A237:           rng f /\ rng Col(G1,1) <> {};
                set D = DelCol(G1,width G1);
A238:           0+1<k+1 by A68,XREAL_1:8;
                now per cases;
                  suppose rng f /\ rng Col(G1,width G1) = {};
                    then rng ff /\ rng Col(G1,width G1) = {} by A15,A149;
                    then
A239:               rng ff misses rng Col(G1,width G1) by XBOOLE_0:def 7;
                    consider t be FinSequence of TOP-REAL 2 such that
A240:               t/.1 in rng Col(D,1) & t/.len t in rng Col(D,width D) &
                    1<=len t & t is_sequence_on D & rng t c= rng g
                    by A5,A9,A10,A11,A12,A238,GOBOARD1:51;
A241:               width D = k by A5,A15,A67,GOBOARD1:26,NAT_1:3;
                    ff/.1 in rng Line(D,1) & ff/.len ff in rng Line(D,len D) &
                    ff is_sequence_on D

by A15,A16,A17,A121,A122,A137,A195,A196,A197,A239,GOBOARD1:37,41;
                    then
A242:               rng ff /\ rng t <> {} by A4,A68,A135,A136,A240,A241;
                    consider x being Element of rng ff /\ rng t;
                    rng ff /\ rng t c= rng ff /\ rng g by A240,XBOOLE_1:26;
                    then x in rng ff /\ rng g by A242,TARSKI:def 3;
                    hence thesis by A194;
                  end;
                  suppose
A243:               rng f /\ rng Col(G1,width G1) <> {};
A244:               f is_sequence_on G1 by A95,A106,GOBOARD1:def 11;
                    then consider t be FinSequence of TOP-REAL 2 such that
A245:               rng t c= rng f & t/.1 in rng Col(G1,1) &
                    t/.len t in rng Col(G1,width G1)
                    & 1<=len t & t is_sequence_on G1 by A237,A243,GOBOARD1:52;
                    consider tt be FinSequence of TOP-REAL 2 such that
A246:               tt/.1 in rng Col(D,1) &
                    tt/.len tt in rng Col(D,width D) & 1<=len tt &

tt is_sequence_on D & rng tt c= rng t by A5,A238,A245,GOBOARD1:51;

defpred P[Nat] means $1 in dom g & g/.$1 in rng Line(G1,mi);
A247:               now
                      consider x being Element of rng g /\ rng Line(G1,mi);
                      x in rng g & x in rng Line(G1,mi) by A26,XBOOLE_0:def 4;
                      then consider n such that
A248:                 n in dom g & x=g/.n by PARTFUN2:4;
                      reconsider n as Nat;
                      take n;
                      thus P[n] by A26,A248,XBOOLE_0:def 4;
                    end;

defpred R[Nat] means $1 in dom g & g/.$1 in rng Line(G1,ma);
A249:               now consider x being Element of rng g /\ rng Line(G1,ma);
                      x in rng g & x in rng Line(G1,ma) by A28,XBOOLE_0:def 4;
                      then consider n such that
A250:                 n in dom g & x=g/.n by PARTFUN2:4;
                      reconsider n as Nat;
                      take n;
                      thus R[n] by A28,A250,XBOOLE_0:def 4;
                    end;
                    consider pf be Nat such that
A251:               P

[pf] & for n be Nat st P[n] holds pf<=n from NAT_1:sch 5(A247);
                    consider pl be Nat such that
A252:               R

[pl] & for n be Nat st R[n] holds pl<=n from NAT_1:sch 5(A249);
                    reconsider pf,pl as Element of NAT by ORDINAL1:def 13;
A253:               pl <> pf by A26,A28,A69,A251,A252,GOBOARD1:19;
A254:               1<=pf & pf<=len g & 1<=pl & pl<=len g
                    by A251,A252,FINSEQ_3:27;
                    now per cases by A253,XXREAL_0:1;
                      suppose pf<pl;
                        then pf<len g by A254,XXREAL_0:2;
                        then 1<len g by A254,XXREAL_0:2;
                        hence 1+1<=len g by NAT_1:13;
                      end;
                      suppose pf>pl;
                        then pl<len g by A254,XXREAL_0:2;
                        then 1<len g by A254,XXREAL_0:2;
                        hence 1+1<=len g by NAT_1:13;
                      end;
                    end;
                    then
A255:               1<=len g - 1 & 1<=len g by A8,GOBOARD1:38,XREAL_1:21;
                    reconsider lg=len g-1 as Element of NAT by A9,INT_1:18;
                    lg<=len g by XREAL_1:45;
                    then
A256:               lg in dom g & len g in dom g & lg+ 1=len g
                    by A255,FINSEQ_3:27;
                    reconsider C = Col(G1,width G1), Li= Line(G1,mi),
                    La= Line(G1,ma) as FinSequence of TOP-REAL 2;
A257:               dom g c= dom g2 by A6,A19,A34,A35,FINSEQ_1:7;
                    len C=len G1 by MATRIX_1:def 9;
                    then
A258:               dom C = Seg len G1 by FINSEQ_1:def 3
                      .= dom G1 by FINSEQ_1:def 3;
                    consider K1 be Element of NAT such that
A259:               K1 in dom Li & g/.pf=Li/.K1 by A251,PARTFUN2:4;
A260:               Seg len Li = dom Li by FINSEQ_1:def 3;
                    reconsider CK1 = Col(G1,K1) as FinSequence of TOP-REAL 2;
A261:               len Li=width G1 by MATRIX_1:def 8;
A262:               Li/.K1 = Li.K1 by A259,PARTFUN1:def 8;
                    then
A263:               K1 in Seg width G1 & g/.pf=G1*(mi, K1)
                    by A259,A260,A261,MATRIX_1:def 8;
                    now
                      assume
A264:                 pf=len g;
                      consider i2 be Element of NAT such that
A265:                 i2 in dom C & C/.i2=g/.len g by A12,PARTFUN2:4;
                      C/.i2 = C.i2 by A265,PARTFUN1:def 8;
                      then
A266:                 i2 in dom G1 & g/.len g=G1*(i2,width G1)
                      by A258,A265,MATRIX_1:def 9;
A267:                 [i2,width G1] in Indices G1
                      by A15,A87,A258,A265,ZFMISC_1:106;

[mi,K1] in Indices G1 by A26,A87,A259,A260,A261,ZFMISC_1:106;
                      then
A268:                 i2=mi & width G1=K1 by A263,A264,A266,A267,GOBOARD1:21;
                      consider n1,n2 be Element of NAT such that
A269:                 [n1,n2] in Indices G1 & g/.lg=G1*(n1,n2)
                      by A10,A256,GOBOARD1:def 11;
A270:                 abs(n1-mi)+abs(n2- width G1)=1
                      by A10,A256,A266,A267,A268,A269,GOBOARD1:def 11;
A271:                 n1
                      in dom G1 & n2 in Seg width G1 by A87,A269,ZFMISC_1:106;
                      now per cases by A270,GOBOARD1:2;
                        suppose
A272:                     abs(n1-mi)=1 & n2=width G1;
A273:                     dom C = Seg len C by FINSEQ_1:def 3
                            .= Seg len G1 by MATRIX_1:def 9
                            .= dom G1 by FINSEQ_1:def 3;
                          then C/.n1 = C.n1 by A271,PARTFUN1:def 8;
                          then g/.lg=C/.n1 by A269,A271,A272,MATRIX_1:def 9;
                          then g/.lg in rng C & 0<1 & g/.lg=g2/.lg
                          by A8,A19,A35,A256,A271,A273,FINSEQ_4:86,PARTFUN2:4;
                          hence contradiction by A8,A35,A256,A257,XREAL_1:46;
                        end;
                        suppose
A274:                     abs(n2-width G1)=1 & n1=mi;
                          len Li = width G1 by MATRIX_1:def 8;
                          then
A275:                     n2 in dom Li by A271,FINSEQ_1:def 3;
                          then Li/.n2 = Li.n2 by PARTFUN1:def 8;
                          then g/.lg=Li/.n2 by A269,A271,A274,MATRIX_1:def 8;
                          then g/.lg in rng Li & 0<1 by A275,PARTFUN2:4;
                          hence contradiction by A251,A256,A264,XREAL_1:46;
                        end;
                      end;
                      hence contradiction;
                    end;
                    then
A276:               pf<len g by A254,XXREAL_0:1;
                    consider K2 be Element of NAT such that
A277:               K2 in dom Lma & g/.pl=Lma/.K2 by A252,PARTFUN2:4;
A278:               Seg len Lma = dom Lma by FINSEQ_1:def 3;
                    reconsider CK2 = Col(G1,K2) as FinSequence of TOP-REAL 2;
A279:               len Lma=width G1 by MATRIX_1:def 8;
A280:               Lma/.K2 = Lma.K2 by A277,PARTFUN1:def 8;
                    then
A281:               K2 in Seg width G1 & g/.pl=G1*(ma, K2)
                    by A277,A278,A279,MATRIX_1:def 8;
                    now
                      assume
A282:                 pl=len g;
                      consider i2 be Element of NAT such that
A283:                 i2 in dom C & C/.i2=g/.len g by A12,PARTFUN2:4;
A284:                 dom C = Seg len C by FINSEQ_1:def 3
                        .= Seg len G1 by MATRIX_1:def 9
                        .= dom G1 by FINSEQ_1:def 3;
                      C/.i2 = C.i2 by A283,PARTFUN1:def 8;
                      then
A285:                 i2 in dom G1 & g/.len g=G1*(i2,width G1)
                      by A283,A284,MATRIX_1:def 9;
A286:                 [i2,width G1] in Indices G1
                      by A15,A87,A283,A284,ZFMISC_1:106;

[ma,K2] in Indices G1 by A28,A87,A277,A278,A279,ZFMISC_1:106;
                      then
A287:                 i2=ma & width G1=K2 by A281,A282,A285,A286,GOBOARD1:21;
                      consider n1,n2 be Element of NAT such that
A288:                 [n1,n2] in Indices G1 & g/.lg=G1*(n1,n2)
                      by A10,A256,GOBOARD1:def 11;
A289:                 abs(n1-ma)+abs(n2- width G1)=1
                      by A10,A256,A285,A286,A287,A288,GOBOARD1:def 11;
A290:                 n1
                      in dom G1 & n2 in Seg width G1 by A87,A288,ZFMISC_1:106;
                      now per cases by A289,GOBOARD1:2;
                        suppose
A291:                     abs(n1-ma)=1 & n2=width G1;
A292:                     dom C = Seg len C by FINSEQ_1:def 3
                            .= Seg len G1 by MATRIX_1:def 9
                            .= dom G1 by FINSEQ_1:def 3;
                          then C/.n1 = C.n1 by A290,PARTFUN1:def 8;
                          then g/.lg=C/.n1 by A288,A290,A291,MATRIX_1:def 9;
                          then g/.lg in rng C & 0<1 & g/.lg=g2/.lg
                          by A8,A19,A35,A256,A290,A292,FINSEQ_4:86,PARTFUN2:4;
                          hence contradiction by A8,A35,A256,A257,XREAL_1:46;
                        end;
                        suppose
A293:                     abs(n2-width G1)=1 & n1=ma;
                          len Lma = width G1 by MATRIX_1:def 8;
                          then
A294:                     n2 in dom Lma by A290,FINSEQ_1:def 3;
                          then La/.n2 = Lma.n2 by PARTFUN1:def 8;
                          then g/.lg=Lma/.n2 by A288,A290,A293,MATRIX_1:def 8;
                          then g/.lg in rng Lma & 0<1 by A294,PARTFUN2:4;
                          hence contradiction by A252,A256,A282,XREAL_1:46;
                        end;
                      end;
                      hence contradiction;
                    end;
                    then
A295:               pl<len g by A254,XXREAL_0:1;
                    deffunc F(Nat) = G1*($1,K1);
                    consider h1 be FinSequence of TOP-REAL 2 such that
A296:               len h1 = l1 &
for n being Nat st n in dom h1 holds h1/.n=F(n)
                    from FINSEQ_4:sch 2;
A297:               Seg len h1 = dom h1 by FINSEQ_1:def 3;
                    deffunc F(Nat) = G1*(ma+$1,K2);
                    consider h2 be FinSequence of TOP-REAL 2 such that
A298:               len h2=l2 &
for n being Nat st n in dom h2 holds h2/.n=F(n)
                    from FINSEQ_4:sch 2;
A299:               Seg len h2 = dom h2 by FINSEQ_1:def 3;
A300:               now
                      let n;
                      assume n in dom h1;
                      then
A301:                 1<=n & n<=l1 & l1<=mi & mi<= len G1
                      by A26,A296,FINSEQ_3:27,XREAL_1:45;
                      then n<=mi by XXREAL_0:2;
                      then n<=len G1 by A301,XXREAL_0:2;
                      hence n in dom G1 by A301,FINSEQ_3:27;
                    end;
A302:               now
                      let n;
                      assume n in dom h2;
                      then 1<=n & n<=l2 & n<=n+ma by A298,FINSEQ_3:27,NAT_1:11;
                      then 1<=n+ma & ma+n<=ma+l2 by XREAL_1:9,XXREAL_0:2;
                      hence ma+n in dom G1 by FINSEQ_3:27;
                    end;
A303:               now
                      let n;
                      assume n in dom h1;
                      then
A304:                 h1/.n=G1*(n,K1) & n in dom G1 by A296,A300;
                      take i=n,K1;
                      thus [i,K1] in Indices G1 & h1/.n=G1*(i,K1)
                      by A87,A259,A260,A261,A304,ZFMISC_1:106;
                    end;
A305:               now
                      let n;
                      assume n in dom h2;
                      then
A306:                 h2/.n=G1*(ma+n,K2) & ma+n in dom G1 by A298,A302;
                      take m=ma+n,K2;
                      thus [m,K2] in Indices G1 & h2/.n=G1*(m,K2)
                      by A87,A277,A278,A279,A306,ZFMISC_1:106;
                    end;
A307:               now
                      let n;
                      assume n in dom h1 & n+1 in dom h1;
                      then
A308:                 n in dom G1 & n+1 in dom G1 & h1/.n=G1*(n,K1) &
                      h1/.(n+1)=G1*(n+1,K1) by A296,A300;
                      then
A309:                 [n,K1] in Indices G1 & [n+1,K1 ] in Indices G1
                      by A87,A259,A260,A261,ZFMISC_1:106;
                      let i1,i2,j1,j2 be Element of NAT;
                      assume

[i1,i2] in Indices G1 & [j1,j2] in Indices G1 & h1/.n=G1*(i1,i2) &
                      h1/.(n+1)=G1*(j1,j2);

then i1=n & i2=K1 & j1=n+1 & j2=K1 & 0<=1 by A308,A309,GOBOARD1:21;
                      hence abs(i1-j1)+abs(i2-j2)= abs(n-n+-1)+0 by ABSVALUE:7
                        .= abs(1) by COMPLEX1:138
                        .= 1 by ABSVALUE:def 1;
                    end;
A310:               now
                      let n;
                      assume n in dom h2 & n+1 in dom h2;
                      then
A311:                 ma
                      +n in dom G1 & ma+(n+1) in dom G1 & h2/.n=G1*(ma+n,K2) &

h2/.(n+1)=G1*(ma+(n+1),K2) & ma+(n+1)=ma+n+1 by A298,A302;
                      then
A312:                 [ma+n,K2] in Indices G1 & [ma+ n+1,K2] in Indices G1
                      by A87,A277,A278,A279,ZFMISC_1:106;
                      let i1,i2,j1,j2 be Element of NAT;
                      assume

[i1,i2] in Indices G1 & [j1,j2] in Indices G1 & h2/.n=G1*(i1,i2) &
                      h2/.(n+1)=G1*(j1,j2);

then i1=ma+n & i2=K2 & j1=ma+n+1 & j2=K2 & 0<=1 by A311,A312,GOBOARD1:21;

hence abs(i1-j1)+abs(i2-j2)= abs(ma+n-(ma+n)+-1)+0 by ABSVALUE:7
                        .= abs(1) by COMPLEX1:138
                        .= 1 by ABSVALUE:def 1;
                    end;
                    defpred PP[Element of NAT] means $1 in dom f implies
                    for m st m in dom G1 & f/.$1 in rng Line(G1,m) holds mi<=m;
A313:               PP[0] by FINSEQ_3:27;
A314:               for k st PP[k] holds PP[k+1]
                    proof
                      let k such that
A315:                 PP[k];
                      assume
A316:                 k+1 in dom f;
                      let m such that
A317:                 m in dom G1 & f/.(k+1) in rng Line(G1,m);
                      now per cases;
                        suppose
A318:                     k=0;
A319:                     w+1=ma1;
                          1 in Seg l by A86,FINSEQ_1:3;
                          then f/.1=f1/.ma1 & f1/.ma1=g1/.ma1 by A74,A78,A319;
                          then f/.(k+1) in rng Li by A53,A318,PARTFUN2:4;
                          hence thesis by A26,A317,GOBOARD1:19;
                        end;
                        suppose k<>0;

then 0<k & k<=k+1 & k+1<=len f by A316,FINSEQ_3:27,NAT_1:3,11;
                          then
A320:                     0+1<=k & k<=len f by NAT_1:13;
                          then
A321:                     k in dom f by FINSEQ_3:27;
                          then consider i1,i2 be Element of NAT such that
A322:                     [i1,i2] in Indices G1 & f/.k=G1*(i1,i2) by A95;

reconsider Li1 = Line(G1,i1) as FinSequence of TOP-REAL 2;
A323:                     Seg len Li1 = dom Li1 by FINSEQ_1:def 3;
A324:                     i1

in dom G1 & i2 in Seg width G1 by A87,A322,ZFMISC_1:106;
A325:                     len Li1=width G1 by MATRIX_1:def 8;
                          then
A326:                     Li1/.i2 = Li1.i2 by A323,A324,PARTFUN1:def 8;
                          then f/.k=Li1/.i2 by A322,A324,MATRIX_1:def 8;
                          then
A327:                     f/.k in rng Li1 by A323,A324,A325,PARTFUN2:4;
                          then
A328:                     mi<=i1 by A315,A320,A324,FINSEQ_3:27;
                          consider j1,j2 be Element of NAT such that
A329:                     [

j1,j2] in Indices G1 & f/.(k+1)=G1*(j1,j2) by A95,A316;

reconsider Lj1 = Line(G1,j1) as FinSequence of TOP-REAL 2;
A330:                     Seg len Lj1 = dom Lj1 by FINSEQ_1:def 3;
A331:                     j1

in dom G1 & j2 in Seg width G1 by A87,A329,ZFMISC_1:106;
A332:                     len Lj1=width G1 by MATRIX_1:def 8;
                          then Lj1/.j2 = Lj1.j2 by A330,A331,PARTFUN1:def 8;
                          then f/.(k+1)=Lj1/.j2 by A329,A331,MATRIX_1:def 8;
                          then
A333:                     f/.(k+1) in rng Lj1 by A330,A331,A332,PARTFUN2:4;
                          now per cases by A328,XXREAL_0:1;
                            suppose
A334:                         mi=i1;
A335:                         f/.k=f1/.(w+k) & f1/.(w+k)=g1/.(w+k) &
                              w+k in dom g1 by A74,A78,A79,A321;
                              g1/.(w+k) = f1/.(w+k) by A74,A79,A321
                                .= f/.k by A78,A79,A321
                                .= Li1/.i2 by A322,A324,A326,MATRIX_1:def 8;
                              then
A336:                         g1/.(w+k) in rng Line(G1,mi) by A323,A324,A325
,A334,PARTFUN2:4;
                              w+1<=w+k by A320,XREAL_1:9;
                              then w+k<=ma1 & ma1<=w+k by A32,A335,A336;
                              then w+k=ma1 by XXREAL_0:1;
                              then
A337:                         ma1+1=w+(k+1);
A338:                         f

/.(k+1)=f1/.(w+(k+1)) & f1/.(w+(k+1))=g1/.(w+(k+1)) &
                              w+(k+1) in dom g1 & ma-1+(k+1)=ma-1+k+1
                              by A74,A78,A79,A316;
                              mi+1<=ma & mi<=mi+1 by A71,NAT_1:13;
                              then 1<=mi+1 & mi+1<=len G1 by A29,XXREAL_0:2;
                              then
A339:                         mi+1 in dom G1 by FINSEQ_3:27;
                              then f/.(k+1) in rng Line(G1,mi+1)
                              by A5,A26,A32,A33,A337,A338,GOBOARD1:44;

then m=mi+1 & mi<=mi+1 by A317,A339,GOBOARD1:19,NAT_1:11;
                              hence thesis;
                            end;
                            suppose
A340:                         mi<i1;

now per cases by A244,A316,A321,A324,A327,GOBOARD1:43;
                                suppose f/.(k+1) in rng Line(G1,i1);
                                  hence thesis by A317,A324,A340,GOBOARD1:19;
                                end;

suppose for l be Element of NAT st f/.(k+1) in rng Line(G1,l) &
                                  l in dom G1 holds abs(i1-l)=1;
                                  then
A341:                             abs(i1 -j1)=1 by A331,A333;
                                  now per cases by A341,GOBOARD1:1;
                                    suppose j1<i1 & i1=j1+1;
                                      then mi<=i1-1 & i1-1=j1 by A340,NAT_1:13;

hence thesis by A317,A331,A333,GOBOARD1:19;
                                    end;
                                    suppose i1<j1 & j1=i1+1;
                                      then mi<j1 by A340,XXREAL_0:2;

hence thesis by A317,A331,A333,GOBOARD1:19;
                                    end;
                                  end;
                                  hence thesis;
                                end;
                              end;
                              hence thesis;
                            end;
                          end;
                          hence thesis;
                        end;
                      end;
                      hence thesis;
                    end;
A342:               for n holds PP[n] from NAT_1:sch 1(A313,A314);
A343:               rng h1 /\ rng tt = {}
                    proof
                      assume
A344:                 not thesis;
                      consider x being Element of rng h1 /\ rng tt;
A345:                 x in rng h1 & x in rng tt by A344,XBOOLE_0:def 4;
                      then x in rng t by A246;
                      then consider i1 be Element of NAT such that
A346:                 i1 in dom f & f/.i1=x by A245,PARTFUN2:4;
                      consider n1,n2 be Element of NAT such that
A347:                 [n1,n2] in Indices G1 & f/.i1=G1*(n1,n2) by A95,A346;

reconsider Ln1 = Line(G1,n1) as FinSequence of TOP-REAL 2;
A348:                 Seg len Ln1 = dom Ln1 by FINSEQ_1:def 3;
A349:                 n1
                      in dom G1 & n2 in Seg width G1 by A87,A347,ZFMISC_1:106;
A350:                 len Ln1=width G1 by MATRIX_1:def 8;
                      then Ln1/.n2 = Ln1.n2 by A348,A349,PARTFUN1:def 8;
                      then f/.i1=Ln1/.n2 by A347,A349,MATRIX_1:def 8;
                      then f/.i1 in rng Ln1 by A348,A349,A350,PARTFUN2:4;
                      then
A351:                 mi<=n1 by A342,A346,A349;
                      consider i2 be Element of NAT such that
A352:                 i2 in dom h1 & h1/.i2=x by A345,PARTFUN2:4;
A353:                 Seg len h1 = dom h1 by FINSEQ_1:def 3;
A354:                 x=G1*(i2,K1) & i2 in dom G1 by A296,A300,A352;

then [i2,K1] in Indices G1 by A87,A259,A260,A261,ZFMISC_1:106;
                      then
A355:                 i2=n1 & n2=K1 by A346,A347,A354,GOBOARD1:21;
                      l1<mi & i2<=l1 by A296,A352,A353,FINSEQ_1:3,XREAL_1:46;
                      hence contradiction by A351,A355,XXREAL_0:2;
                    end;
                    defpred PP[Element of NAT] means $1 in dom f implies
                    for m st m in dom G1 & f/.$1 in rng Line(G1,m) holds m<=ma;
A356:               PP[0] by FINSEQ_3:27;
A357:               for k st PP[k] holds PP[k+1]
                    proof
                      let k such that
A358:                 PP[k];
                      assume
A359:                 k+1 in dom f;
                      let m such that
A360:                 m in dom G1 & f/.(k+1) in rng Line(G1,m);
                      now per cases;
                        suppose
A361:                     k=0;
                          1 in Seg l by A86,FINSEQ_1:3;
                          then f/.1=f1/.(w+1) & f1/.(w+1)=g1/.(w+1) by A74,A78;
                          then f/.(k+1) in rng Li by A53,A361,PARTFUN2:4;
                          hence thesis by A26,A70,A360,GOBOARD1:19;
                        end;
                        suppose k<>0;
                          then
A362:                     0<k & k<=k+1 & k+1<=
                          len f by A85,A359,FINSEQ_1:3,NAT_1:3,11;
                          then
A363:                     0+1<=k & k<=len f by NAT_1:13;
                          then
A364:                     k in dom f by FINSEQ_3:27;
                          then consider i1,i2 be Element of NAT such that
A365:                     [i1,i2] in Indices G1 & f/.k=G1*(i1,i2) by A95;

reconsider Li1 = Line(G1,i1) as FinSequence of TOP-REAL 2;
A366:                     Seg len Li1 = dom Li1 by FINSEQ_1:def 3;
A367:                     i1

in dom G1 & i2 in Seg width G1 by A87,A365,ZFMISC_1:106;
A368:                     len Li1=width G1 by MATRIX_1:def 8;
                          then Li1/.i2 = Li1.i2 by A366,A367,PARTFUN1:def 8;
                          then f/.k=Li1/.i2 by A365,A367,MATRIX_1:def 8;
                          then
A369:                     f/.k in rng Li1 by A366,A367,A368,PARTFUN2:4;
                          then
A370:                     i1<=ma by A358,A363,A367,FINSEQ_3:27;
                          consider j1,j2 be Element of NAT such that
A371:                     [

j1,j2] in Indices G1 & f/.(k+1)=G1*(j1,j2) by A95,A359;

reconsider Lj1 = Line(G1,j1) as FinSequence of TOP-REAL 2;
A372:                     Seg len Lj1 = dom Lj1 by FINSEQ_1:def 3;
A373:                     j1

in dom G1 & j2 in Seg width G1 by A87,A371,ZFMISC_1:106;
A374:                     len Lj1=width G1 by MATRIX_1:def 8;
                          then Lj1/.j2 = Lj1.j2 by A372,A373,PARTFUN1:def 8;
                          then f/.(k+1)=Lj1/.j2 by A371,A373,MATRIX_1:def 8;
                          then
A375:                     f/.(k+1) in rng Lj1 by A372,A373,A374,PARTFUN2:4;
                          then
A376:                     j1=m by A360,A373,GOBOARD1:19;
                          now per cases by A370,XXREAL_0:1;
                            case
A377:                         ma=i1;
A378:                         f

/.k=f1/.(w+k) & w is Element of NAT & f1/.(w+k)=g1/.(w+k) &
                              w+k in dom g1 & f/.(k+1)=f1/.(w+(k+1)) &
                              f1/.(w+(k+1))=g1/.(w+(k+1)) & w+(k+1) in dom g1 &
                              ma-1+(k+1)=ma-1+k+1 by A74,A78,A79,A359,A364;
A379:                         w+1<=w+k by A363,XREAL_1:9;

ma1 <> w+k by A26,A28,A32,A69,A369,A377,A378,GOBOARD1:19;
                              then ma1<w+k by A379,XXREAL_0:1;
                              then
A380:                         mi1<=w+k by A73,A369,A377,A378;
                              w+k<=mi1 by A78,A102,A363,XREAL_1:9;
                              then w+k=mi1 by A380,XXREAL_0:1;
                              hence contradiction by A78,A362,NAT_1:13;
                            end;
                            case
A381:                         i1<ma;

now per cases by A244,A359,A364,A367,A369,GOBOARD1:43;
                                suppose f/.(k+1) in rng Line(G1,i1);
                                  hence thesis by A360,A367,A381,GOBOARD1:19;
                                end;

suppose for l be Element of NAT st f/.(k+1) in rng Line(G1,l) &
                                  l in dom G1 holds abs(i1-l)=1;
                                  then
A382:                             abs(i1 -j1)=1 by A373,A375;
                                  now per cases by A382,GOBOARD1:1;
                                    suppose j1<i1 & i1=j1+1;
                                      hence thesis by A376,A381,XXREAL_0:2;
                                    end;
                                    suppose i1<j1 & j1=i1+1;
                                      hence thesis by A376,A381,NAT_1:13;
                                    end;
                                  end;
                                  hence thesis;
                                end;
                              end;
                              hence thesis;
                            end;
                          end;
                          hence thesis;
                        end;
                      end;
                      hence thesis;
                    end;
A383:               for n holds PP[n] from NAT_1:sch 1(A356,A357);
A384:               rng h2 /\ rng tt = {}
                    proof
                      assume
A385:                 not thesis;
                      consider x being Element of rng h2 /\ rng tt;
A386:                 x in rng h2 & x in rng tt by A385,XBOOLE_0:def 4;
                      then x in rng t by A246;
                      then consider i1 be Element of NAT such that
A387:                 i1 in dom f & f/.i1=x by A245,PARTFUN2:4;
                      consider n1,n2 be Element of NAT such that
A388:                 [n1,n2] in Indices G1 & f/.i1=G1*(n1,n2) by A95,A387;

reconsider Ln1 = Line(G1,n1) as FinSequence of TOP-REAL 2;
A389:                 Seg len Ln1 = dom Ln1 by FINSEQ_1:def 3;
A390:                 n1
                      in dom G1 & n2 in Seg width G1 by A87,A388,ZFMISC_1:106;
A391:                 len Ln1=width G1 by MATRIX_1:def 8;
                      then Ln1/.n2 = Ln1.n2 by A389,A390,PARTFUN1:def 8;
                      then f/.i1=Ln1/.n2 by A388,A390,MATRIX_1:def 8;
                      then f/.i1 in rng Ln1 by A389,A390,A391,PARTFUN2:4;
                      then
A392:                 n1<=ma by A383,A387,A390;
                      consider i2 be Element of NAT such that
A393:                 i2 in dom h2 & h2/.i2=x by A386,PARTFUN2:4;
A394:                 x=G1*(ma+i2,K2) & ma+i2 in dom G1 by A298,A302,A393;

then [ma+i2,K2] in Indices G1 by A87,A277,A278,A279,ZFMISC_1:106;
                      then
A395:                 ma+i2=n1 & n2=K2 by A387,A388,A394,GOBOARD1:21;
                      0+1<=i2 by A393,FINSEQ_3:27;
                      then 0<i2 by NAT_1:13;
                      hence contradiction by A392,A395,XREAL_1:31;
                    end;
                    now per cases by A253,XXREAL_0:1;
                      suppose
A396:                   pf<pl;
                        set F1=g|pl;
                        pf<=pl & pl<=pl+1 by A396,NAT_1:11;

then reconsider LL=pl+1-pf as Element of NAT by INT_1:18,XXREAL_0:2;
                        reconsider w1=pf-1 as Element of NAT by A254,INT_1:18;
A397:                   for n st n in Seg LL holds F1/.(w1+n)=g/.(w1+n) &
                        w1+n in dom g
                        proof
                          let n such that
A398:                     n in Seg LL;
                          0+1<=pf by A19,A251,FINSEQ_1:3;

then 0<=w1 & 1<=n & n<=LL by A398,FINSEQ_1:3,XREAL_1:21;
                          then
A399:                     0+1<=w1+n & n+pf<=LL+ pf by XREAL_1:9;
                          then n+pf-1<=pl by XREAL_1:22;
                          then w1+n in Seg pl by A399,FINSEQ_1:3;
                          hence thesis by A252,FINSEQ_4:86;
                        end;
                        defpred P[Nat, Element of TOP-REAL 2] means
                        $2 = F1/.(w1+$1);
A400:                   for n being Nat st n in Seg LL ex p st P[n,p];
                        consider F be FinSequence of TOP-REAL 2 such that
A401:                   len F = LL &
for n being Nat st n in Seg LL holds P[n,F/.n]
                        from FINSEQ_4:sch 1(A400);
A402:                   Seg len F = dom F by FINSEQ_1:def 3;
                        set FF = h1^F^h2;
                        pf+1<=pl & pl<=pl+1 by A396,NAT_1:13;
                        then pf+1<=pl+1 & dom F=dom F by XXREAL_0:2;
                        then
A403:                   1<=LL & len F=LL by A401,XREAL_1:21;
                        now
                          let n;
                          assume n in dom F;
                          then
A404:                     n in Seg LL & dom F= Seg LL & F/.n=
                          F1/.(w1+n) by A401,A402;
                          then
A405:                     w1 is Element of NAT &
                          w1+n in dom g & F/.n=g/.(w1+n) by A397;
                          reconsider w=w1 as Element of NAT;
                          consider i,j such that
A406:                     [i,j] in Indices G1 & g/.(w+n)=G1*(i,j)
                          by A10,A405,GOBOARD1:def 11;
                          take i,j;

thus [i,j] in Indices G1 & F/.n=G1*(i,j) by A397,A404,A406;
                        end;
                        then
A407:                   for n st n in dom(h1^F) ex
                        i,j st [i,j] in Indices G1 &
                        (h1^F)/.n=G1*(i,j) by A303,GOBOARD1:39;
A408:                   w1+LL= pl;
A409:                   now
                          let n;
                          assume n in dom F & n+1 in dom F;

then n in Seg LL & n+1 in Seg LL & dom F=Seg LL & F/.n=F1/.(w1+n) &

F/.(n+1)=F1/.(w1+(n+1)) & w1+(n+1)=w1+n+1 by A401,A402;
                          then
A410:                     w1
                          is Element of NAT & w1+n in dom g & F/.n=g/.(w1+n) &
                          w1+n+1 in dom g & F/.(n+1)=g/.(w1+n+1) by A397;
                          let i1,i2,j1,j2 be Element of NAT;
                          assume

[i1,i2] in Indices G1 & [j1,j2] in Indices G1 & F/.n=G1*(i1,i2) &
                          F/.(n+1)=G1*(j1,j2);

hence abs(i1-j1)+abs(i2-j2)=1 by A10,A410,GOBOARD1:def 11;
                        end;
A411:                   now
                          let i1,i2,j1,j2 be Element of NAT;
                          assume
A412:                     [i1,i2] in Indices G1 & [j1,j2] in Indices G1 &
                          h1/.len h1=G1*(i1,i2) &
                          F/.1=G1*(j1,j2) & len h1 in dom h1 & 1 in dom F;
                          then
A413:                     h1/.len h1=G1*(l1,K1) & l1 in dom G1 by A296,A300;

then [l1,K1] in Indices G1 by A87,A259,A260,A261,ZFMISC_1:106;
                          then
A414:                     i1=l1 & i2=K1 & 0<=1 by A412,A413,GOBOARD1:21;

1 in Seg LL & dom F=Seg LL & F/.1=F1/.(w1+1) by A401,A402,A412;
                          then
A415:                     F/.1=g/.(w1+1) by A397

.= G1*(mi,K1) by A259,A260,A261,A262,MATRIX_1:def 8;

[mi,K1] in Indices G1 by A26,A87,A259,A260,A261,ZFMISC_1:106;
                          then j1=mi & j2=K1 by A412,A415,GOBOARD1:21;

hence abs(i1-j1)+abs(i2-j2)= abs(mi-1-mi)+0 by A414,ABSVALUE:7
                            .= abs(-1)
                            .= abs(1) by COMPLEX1:138
                            .= 1 by ABSVALUE:def 1;
                        end;
                        set hf=h1^F;
A416:                   now
                          let i1,i2,j1,j2 be Element of NAT;
                          assume
A417:                     [

i1,i2] in Indices G1 & [j1,j2] in Indices G1 & hf/.len hf=G1*( i1,i2)
                          & h2/.1=G1*(j1,j2) & len hf in dom hf & 1 in dom h2;
                          then
A418:                     h2/.1=G1*(ma+1,K2) & ma+1 in dom G1 by A298,A302;

then [ma+1,K2] in Indices G1 by A87,A277,A278,A279,ZFMISC_1:106;
                          then
A419:                     j1=ma+1 & j2=K2 by A417,A418,GOBOARD1:21;
A420:                     len F in dom F & 0<=1 by A402,A403,FINSEQ_1:3;
A421:                     hf/.len hf=hf/.(len h1+len F) by FINSEQ_1:35
                            .= F/.len F by A420,FINSEQ_4:84
                            .= F1/.(w1+LL) by A401,A402,A420
                            .= G1*(ma,K2) by A281,A397,A401,A402,A420;

[ma,K2] in Indices G1 by A28,A87,A277,A278,A279,ZFMISC_1:106;
                          then i1=ma & i2=K2 by A417,A421,GOBOARD1:21;

hence abs(i1-j1)+abs(i2-j2)=abs(ma-(ma+1))+0 by A419,ABSVALUE:7
                            .=abs(-(ma+1 -ma))
                            .=abs(1) by COMPLEX1:138
                            .=1 by ABSVALUE:def 1;
                        end;
A422:                   FF is_sequence_on G1
                        proof
                          thus for n st n in dom FF
                          ex i,j st [i,j] in Indices G1 & FF/.n=G1*(i,j)
                          by A305,A407,GOBOARD1:39;
                          for n st n in dom(h1^F) & n+1 in dom(h1^F)

for i1,i2,j1,j2 be Element of NAT st [i1,i2] in Indices G1 &
                          [j1,j2] in Indices G1 &
                          (h1^F)/.n=G1*(i1,i2) & (h1^F)/.(n+1)=G1*(j1,j2) holds

abs(i1-j1)+abs(i2-j2)=1 by A307,A409,A411,GOBOARD1:40;
                          hence thesis
                          by A310,A416,GOBOARD1:40;
                        end;
A423:                   now per cases;
                          suppose
A424:                       mi=1;
                            then h1 = {} by A296;
                            then
A425:                       FF=F^h2 by FINSEQ_1:47;
A426:                       1 in Seg LL & 1<=pf by A19,A251,A403,FINSEQ_1:3;
A427:                       pf in Seg pl by A254,A396,FINSEQ_1:3;
                            FF/.1=F/.1 by A401,A402,A425,A426,FINSEQ_4:83
                              .= F1/.(w1+1) by A401,A426
                              .= g/.pf by A252,A427,FINSEQ_4:86;
                            hence FF/.1 in rng Line(G1,1) by A251,A424;
                          end;
                          suppose
A428:                       mi<>1;
                            1<=mi by A26,FINSEQ_3:27;
                            then 1<mi by A428,XXREAL_0:1;
                            then 1+1<=mi by NAT_1:13;
                            then
A429:                       1<=l1 by XREAL_1:21;
                            then
A430:                       1 in Seg l1 by FINSEQ_1:3;
A431:                       len(h1^F)=len h1 + len F by FINSEQ_1:35;
                            len Line(G1,1)=width G1 by MATRIX_1:def 8;
                            then
A432:                       K1 in dom L1 by A259,A260,A261,FINSEQ_1:def 3;
                            then
A433:                       L1/.K1 = L1.K1 by PARTFUN1:def 8;
                            0<=len F by NAT_1:2;
                            then 0+1<=len(h1^F) by A296,A429,A431,XREAL_1:9;
                            then 1 in dom(h1^F) by FINSEQ_3:27;
                            then FF/.1=(h1^F)/.1 by FINSEQ_4:83
                              .=h1/.1 by A296,A297,A430,FINSEQ_4:83
                              .=G1*(1,K1) by A296,A297,A430
                              .=L1/.K1 by A259,A260,A261,A433,MATRIX_1:def 8;
                            hence FF/.1 in rng Line(G1,1) by A432,PARTFUN2:4;
                          end;
                        end;
A434:                   len FF=len(h1^F)+len h2 by FINSEQ_1:35
                          .=len h1+len F+len h2 by FINSEQ_1:35;
                        0+0<=len h1+len h2 by NAT_1:2;
                        then
A435:                   0+1<=len F+(len h1+len h2) by A403,XREAL_1:9;
A436:                   now per cases;
                          suppose
A437:                       ma=len G1;
                            then h2 = {} by A298;
                            then
A438:                       FF=h1^F & 1<=pl by A19,A252,FINSEQ_1:3,47;
                            then
A439:                       len F in dom F & pl in Seg pl by A403,FINSEQ_1:3
,FINSEQ_3:27;
                            FF/.len FF=FF/.(len h1+len F) by A438,FINSEQ_1:35
                              .= F/.LL by A401,A438,A439,FINSEQ_4:84
                              .= F1/.pl by A401,A402,A408,A439
                              .= g/.pl by A252,A439,FINSEQ_4:86;

hence FF/.len FF in rng Line(G1,len G1) by A252,A437;
                          end;
                          suppose
A440:                       ma<>len G1;
                            ma<=len G1 by A28,FINSEQ_3:27;
                            then ma<len G1 by A440,XXREAL_0:1;
                            then ma+1<=len G1 by NAT_1:13;
                            then
A441:                       1<=l2 by XREAL_1:21;
                            then
A442:                       l2 in Seg l2 by FINSEQ_1:3;
                            len Line(G1,len G1)=width G1 by MATRIX_1:def 8;
                            then
A443:                       K2 in dom Ll by A277,A278,A279,FINSEQ_1:def 3;
                            then
A444:                       Ll/.K2 = Ll.K2 by PARTFUN1:def 8;
A445:                       len h2 in dom h2 by A298,A441,FINSEQ_3:27;
                            FF/.len FF=FF/.(len(h1^F)+len h2) by FINSEQ_1:35
                              .=h2/.l2 by A298,A445,FINSEQ_4:84
                              .=G1*(ma+l2,K2) by A298,A299,A442
                              .=Ll/.K2 by A277,A278,A279,A444,MATRIX_1:def 8;

hence FF/.len FF in rng Line(G1,len G1) by A443,PARTFUN2:4;
                          end;
                        end;
A446:                   rng FF = rng(h1^F) \/ rng h2 by FINSEQ_1:44
                          .= rng h1 \/ rng F \/ rng h2 by FINSEQ_1:44;
A447:                   for

k st k in Seg width G1 & rng F /\ rng Col(G1,k)={} holds
                        rng FF /\ rng Col(G1,k)={}
                        proof
                          let k;
                          assume that
A448:                     k in Seg width G1 and
A449:                     rng F /\ rng Col(G1,k)={};
                          set gg=Col(G1,k);
                          assume
A450:                     rng FF /\ rng gg <> {};
                          consider x being Element of rng FF /\ rng gg;

rng FF = rng F \/ (rng h1 \/ rng h2) by A446,XBOOLE_1:4;
                          then
A451:                     rng FF /\ rng gg = {}
                          \/ (rng h1 \/ rng h2) /\ rng gg by A449,XBOOLE_1:23

.= rng h1 /\ rng gg \/ rng h2 /\ rng gg by XBOOLE_1:23;
A452:                     len Col(G1,K1)=len G1 & len Col(G1,K2)=len G1
                          by MATRIX_1:def 9;
                          now per cases by A450,A451,XBOOLE_0:def 3;
                            suppose x in rng h1 /\ rng gg;
                              then
A453:                         x in rng h1 & x in rng gg by XBOOLE_0:def 4;
                              then consider i such that
A454:                         i in dom h1 & x=h1/.i by PARTFUN2:4;
A455:                         x=G1*(i,K1) by A296,A454;
                              reconsider y=x as Point of TOP-REAL 2 by A454;
A456:                         dom CK1 = Seg len G1 by A452,FINSEQ_1:def 3
                                .= dom G1 by FINSEQ_1:def 3;
                              then
A457:                         i in dom CK1 by A300,A454;
A458:                         Lmi/.K1 = Lmi.K1 & CK1/.mi = CK1.mi
                              by A26,A259,A456,PARTFUN1:def 8;
                              CK1/.i = CK1.i by A300,A454,A456,PARTFUN1:def 8;
                              then y=CK1/.i by A455,A456,A457,MATRIX_1:def 9;
                              then y in rng CK1 by A457,PARTFUN2:4;
                              then
A459:                         K1=k & 1 in Seg LL

by A259,A260,A261,A403,A448,A453,FINSEQ_1:3,GOBOARD1:20;

then F/.1=F1/.(w1+1) & F1/.(w1+1)=g/.(w1+1) by A397,A401;

then F/.1= CK1/.mi by A26,A259,A260,A261,A458,GOBOARD1:17;
                              then F/.1 in rng Col(G1,k) & F/.1 in rng F
                              by A26,A401,A402,A456,A459,PARTFUN2:4;
                              hence contradiction by A449,XBOOLE_0:def 4;
                            end;
                            suppose x in rng h2 /\ rng gg;
                              then
A460:                         x in rng h2 & x in rng gg by XBOOLE_0:def 4;
                              then consider i such that
A461:                         i in dom h2 & x=h2/.i by PARTFUN2:4;
A462:                         x=G1*(ma+i,K2) by A298,A461;
                              reconsider y=x as Point of TOP-REAL 2 by A461;
A463:                         dom CK2 = Seg len G1 by A452,FINSEQ_1:def 3
                                .= dom G1 by FINSEQ_1:def 3;
                              then
A464:                         ma+i in dom CK2 by A302,A461;
A465:                         Lma

/.K2 = Lma.K2 & CK2/.ma = CK2.ma by A28,A277,A463,PARTFUN1:def 8;

CK2/.(ma+i) = CK2.(ma+i) by A302,A461,A463,PARTFUN1:def 8;

then y=CK2/.(ma+i) by A462,A463,A464,MATRIX_1:def 9;
                              then y in rng CK2 by A464,PARTFUN2:4;
                              then
A466:                         K2=k by A277,A278,A279,A448,A460,GOBOARD1:20;
A467:                         LL in Seg LL by A403,FINSEQ_1:3;

then F/.LL=F1/.(w1+LL) & F1/.(w1+LL)=g/.(w1+LL) by A397,A401;

then F/.LL= CK2/.ma by A28,A277,A278,A279,A465,GOBOARD1:17;
                              then F/.LL in rng Col(G1,k) & F/.LL in rng F
                              by A28,A401,A402,A463,A466,A467,PARTFUN2:4;
                              hence contradiction by A449,XBOOLE_0:def 4;
                            end;
                          end;
                          hence contradiction;
                        end;
A468:                   rng tt /\ rng FF = ((rng h1 \/ rng F) /\ rng tt) \/
                        {} by A384,A446,XBOOLE_1:23
                          .= {} \/ rng F /\ rng tt by A343,XBOOLE_1:23
                          .= rng tt /\ rng F;
                        rng tt c= rng f by A245,A246,XBOOLE_1:1;
                        then
A469:                   rng tt c= rng g1 by A192,XBOOLE_1:1;
                        rng F c= rng g2
                        proof
                          let x;
                          assume x in rng F;
                          then consider n such that
A470:                     n in dom F & x=F/.n by PARTFUN2:4;
                          n in Seg LL & n in Seg LL & F/.n=
                          F1/.(w1+n) by A401,A402,A470;

then w1 is Element of NAT & w1+n in dom g & F/.n=g/.(w1+n) by A397;
                          then x in rng g by A470,PARTFUN2:4;
                          hence thesis by A36;
                        end;
                        then
A471:                   rng

FF /\ rng tt c= rng g1 /\ rng g2 by A468,A469,XBOOLE_1:27;
A472:                   1
                        in dom FF & len FF in dom FF by A434,A435,FINSEQ_3:27;
                        rng F /\ rng C = {}
                        proof
                          assume
A473:                     not thesis;
                          consider x being Element of rng F /\ rng C;
A474:                     x in rng F & x in rng C by A473,XBOOLE_0:def 4;
                          then consider i1 be Element of NAT such that
A475:                     i1 in dom F & F/.i1=x by PARTFUN2:4;
A476:                     Seg len F = dom F by FINSEQ_1:def 3;
                          then
A477:                     F

/.i1=F1/.(w1+i1) & w1 is Element of NAT & F1/.(w1+i1)=
                          g/.(w1+i1) & w1+i1 in dom g by A397,A401,A475;
                          reconsider w=w1 as Element of NAT;
                          g2/.(w+i1) in rng C & w+i1 in dom g2
                          by A8,A19,A35,A474,A475,A477,FINSEQ_4:86;
                          then
A478:                     m<=w+i1 & i1<=LL by A8,A401,A475,A476,FINSEQ_1:3;
                          then w+i1<=w+LL by XREAL_1:9;
                          hence contradiction by A35,A295,A478,XXREAL_0:2;
                        end;
                        then rng FF /\ rng Col(G1,width G1) = {} by A15,A447;

then rng FF misses rng Col(G1,width G1) by XBOOLE_0:def 7;
                        then
A479:                   FF is_sequence_on D & FF/. 1 in rng Line(D,1) &
                        FF/.len FF in rng Line(D,len D)

by A15,A16,A17,A195,A196,A422,A423,A436,A472,GOBOARD1:37,41;
                        width D=k by A5,A15,A67,GOBOARD1:26,NAT_1:3;
                        then
A480:                   rng FF /\ rng tt <> {} by A4,A68,A246,A434,A435,A479;
                        consider x being Element of rng FF /\ rng tt;
                        x in rng FF /\ rng tt by A480;
                        hence thesis by A471;
                      end;
                      suppose
A481:                   pl<pf;
                        set F1=g|pf;
                        pl<=pf & pf<=pf+1 by A481,NAT_1:11;

then reconsider LL=pf+1-pl as Element of NAT by INT_1:18,XXREAL_0:2;
A482:                   for n st n in Seg LL holds pf+1-n is Element of NAT
                        proof
                          let n;
                          assume n in Seg LL;
                          then
A483:                     1<=n & n<=LL & 0<=pl by FINSEQ_1:3,NAT_1:2;
                          then LL<=pf+1-0 by XREAL_1:15;
                          hence thesis by A483,INT_1:18,XXREAL_0:2;
                        end;
A484:                   for n,k st n in Seg LL & k = pf+1-n holds
                        F1/.k=g/.k & k in dom g
                        proof
                          let n,k;
                          assume that
A485:                     n in Seg LL and
A486:                     k = pf+1-n;
A487:                     1<=n & n<=LL & 0<=pl by A485,FINSEQ_1:3,NAT_1:2;
                          then LL<=pf+1-0 by XREAL_1:15;

then reconsider w=pf+1-n as Element of NAT by A487,INT_1:18,XXREAL_0:2;
A488:                     pf+1-n<=pf+1-1 & pf+1-LL<=pf+1-n
 by A487,XREAL_1:15;
                          then 1<=pf+1-n by A254,XXREAL_0:2;
                          then w in Seg pf by A488,FINSEQ_1:3;
                          hence thesis by A251,A486,FINSEQ_4:86;
                        end;
                        defpred P[Nat,Element of TOP-REAL 2] means
                        for k st k = pf+1-$1 holds $2 = F1/.k;
A489:                   for n being Nat st n in Seg LL ex p st P[n,p]
                        proof
                          let n be Nat;
                          assume
A490:                     n in Seg LL;
                          then reconsider k = pf+1-n as Element of NAT by A482;
                          take g/.k;
                          thus thesis by A484,A490;
                        end;
                        consider F be FinSequence of TOP-REAL 2 such that
A491:                   len F = LL &

for n being Nat st n in Seg LL holds P[n,F/.n] from FINSEQ_4:sch 1(A489);
A492:                   Seg len F = dom F by FINSEQ_1:def 3;
                        set FF = h1^F^h2;
                        pl+1<=pf & pf<=pf+1 by A481,NAT_1:13;
                        then pl+1<=pf+1 & dom F=dom F by XXREAL_0:2;
                        then
A493:                   1<=LL & len F=LL by A491,XREAL_1:21;
                        now
                          let n;
                          assume
A494:                     n in dom F;

then reconsider w=pf+1-n as Element of NAT by A482,A491,A492;
A495:                     n

in Seg LL & dom F=Seg LL & F/.n=F1/.w by A491,A492,A494;

then pf+1-n is Element of NAT & pf+1-n in dom g & F/.n=g/.w by A484;
                          then consider i,j such that
A496:                     [i,j] in Indices G1 & g/.w=G1*(i,j)
                          by A10,GOBOARD1:def 11;
                          take i,j;

thus [i,j] in Indices G1 & F/.n=G1*(i,j) by A484,A495,A496;
                        end;
                        then for n st n in dom(h1^F)
                        ex i,j st [i,j] in Indices G1 & (h1^F)/.n=G1*(i,j)
                        by A303,GOBOARD1:39;
                        then
A497:                   for n st n in dom FF
                        ex i,j st [i,j] in Indices G1 & FF/.n=G1*(i,j)
                        by A305,GOBOARD1:39;
A498:                   now
                          let n;
                          assume
A499:                     n in dom F & n+1 in dom F;

then reconsider w3=pf+1-n, w2=pf+1-(n+1) as Element of NAT by A482,A491,A492;

n in Seg LL & n+1 in Seg LL & dom F=Seg LL & F/.n=F1/.w3 &

F/.(n+1)=F1/.w2 & pf+1-(n+1)=pf+1-n-1 by A491,A492,A499;
                          then
A500:                     pf+1-n in dom g & F/.n
                          =g/.w3 & pf+1-(n+1) in dom g &
                          F/.(n+1)=g/.w2 by A484;
A501:                     w2+1=pf+1-n;
                          let i1,i2,j1,j2 be Element of NAT;
                          assume

[i1,i2] in Indices G1 & [j1,j2] in Indices G1 & F/.n=G1*(i1,i2) &
                          F/.(n+1)=G1*(j1,j2);
                          hence 1=abs(j1-i1)+abs(j2-i2)
                          by A10,A500,A501,GOBOARD1:def 11
                            .= abs(-(i1-j1))+abs(-(i2-j2))
                            .= abs(i1-j1)+abs(-(i2-j2)) by COMPLEX1:138
                            .= abs(i1-j1)+abs(i2-j2) by COMPLEX1:138;
                        end;
A502:                   pf+1-1 = pf;
                        now
                          let i1,i2,j1,j2 be Element of NAT;
                          assume
A503:                     [i1,i2] in Indices G1 & [j1,j2] in Indices G1 &
                          h1/.len h1=G1*(i1,i2) &
                          F/.1=G1*(j1,j2) & len h1 in dom h1 & 1 in dom F;
                          then
A504:                     h1/.len h1=G1*(l1,K1) & l1 in dom G1 by A296,A300;

then [l1,K1] in Indices G1 by A87,A259,A260,A261,ZFMISC_1:106;
                          then
A505:                     i1=l1 & i2=K1 & 0<=1 by A503,A504,GOBOARD1:21;
                          reconsider w4 = pf + 1 - 1 as Element of NAT;
A506:                     F/.1 = F1/.w4 by A491,A492,A503
                            .= g/.w4 by A484,A491,A492,A503

.= G1*(mi,K1) by A259,A260,A261,A262,MATRIX_1:def 8;

[mi,K1] in Indices G1 by A26,A87,A259,A260,A261,ZFMISC_1:106;
                          then j1=mi & j2=K1 by A503,A506,GOBOARD1:21;

hence abs(i1-j1)+abs(i2-j2)= abs(mi-1-mi)+0 by A505,ABSVALUE:7
                            .= abs(-1)
                            .= abs(1) by COMPLEX1:138
                            .= 1 by ABSVALUE:def 1;
                        end;
                        then
A507:                   for n st n in dom(h1^F) & n+1 in dom(h1^F)

for i1,i2,j1,j2 be Element of NAT st [i1,i2] in Indices G1 &
                        [j1,j2] in Indices G1 &
                        (h1^F)/.n=G1*(i1,i2) & (h1^F)/.(n+1)=G1*(j1,j2) holds
                        abs(i1-j1)+abs(i2-j2)=1 by A307,A498,GOBOARD1:40;
                        set hf=h1^F;
                        now
                          let i1,i2,j1,j2 be Element of NAT;
                          assume
A508:                     [

i1,i2] in Indices G1 & [j1,j2] in Indices G1 & hf/.len hf=G1*(i1,i2)
                          & h2/.1=G1*(j1,j2) & len hf in dom hf & 1 in dom h2;
                          then
A509:                     h2/.1=G1*(ma+1,K2) & ma+1 in dom G1 by A298,A302;

then [ma+1,K2] in Indices G1 by A87,A277,A278,A279,ZFMISC_1:106;
                          then
A510:                     j1=ma+1 & j2=K2 by A508,A509,GOBOARD1:21;
A511:                     len F in dom F & 0<=1 by A493,FINSEQ_3:27;
                          reconsider u = pf+1-LL as Element of NAT;
A512:                     hf/.len hf=hf/.(len h1+len F) by FINSEQ_1:35
                            .= F/.len F by A511,FINSEQ_4:84
                            .= F1/.u by A491,A492,A511
                            .= g/.u by A484,A491,A492,A511

.= G1*(ma,K2) by A277,A278,A279,A280,MATRIX_1:def 8;

[ma,K2] in Indices G1 by A28,A87,A277,A278,A279,ZFMISC_1:106;
                          then i1=ma & i2=K2 by A508,A512,GOBOARD1:21;

hence abs(i1-j1)+abs(i2-j2)=abs(ma-(ma+1))+0 by A510,ABSVALUE:7
                            .=abs(-(ma+1 -ma))
                            .=abs(1) by COMPLEX1:138
                            .=1 by ABSVALUE:def 1;
                        end;
                        then for n st n in dom FF & n+1 in dom FF

for m,k,i,j st [m,k] in Indices G1 & [i,j] in Indices G1 &

FF/.n=G1*(m,k) & FF/.(n+1)=G1*(i,j) holds abs(m-i)+abs(k-j)=1
                        by A310,A507,GOBOARD1:40;
                        then
A513:                   FF is_sequence_on G1 by A497,GOBOARD1:def 11;
A514:                   now per cases;
                          suppose
A515:                       mi=1;
                            then h1 = {} by A296;
                            then
A516:                       FF=F^h2 by FINSEQ_1:47;
A517:                       1 in Seg LL & 1<=pl by A19,A252,A493,FINSEQ_1:3;
A518:                       pf in Seg pf by A254,FINSEQ_1:3;
                            FF/.1=F/.1 by A491,A492,A516,A517,FINSEQ_4:83
                              .= F1/.pf by A491,A502,A517
                              .= g/.pf by A251,A518,FINSEQ_4:86;
                            hence FF/.1 in rng Line(G1,1) by A251,A515;
                          end;
                          suppose
A519:                       mi<>1;
                            1<=mi by A26,FINSEQ_3:27;
                            then 1<mi by A519,XXREAL_0:1;
                            then 1+1<=mi by NAT_1:13;
                            then
A520:                       1<=l1 by XREAL_1:21;
                            then
A521:                       1 in Seg l1 by FINSEQ_1:3;
A522:                       len(h1^F)=len h1 + len F by FINSEQ_1:35;
                            len Line(G1,1)=width G1 by MATRIX_1:def 8;
                            then
A523:                       K1 in dom L1 by A259,A260,A261,FINSEQ_1:def 3;
                            then
A524:                       L1/.K1 = L1.K1 by PARTFUN1:def 8;
                            0<=len F by NAT_1:2;
                            then 0+1<=len(h1^F) by A296,A520,A522,XREAL_1:9;
                            then 1 in dom(h1^F) by FINSEQ_3:27;
                            then FF/.1=(h1^F)/.1 by FINSEQ_4:83
                              .=h1/.1 by A296,A297,A521,FINSEQ_4:83
                              .=G1*(1,K1) by A296,A297,A521
                              .=L1/.K1 by A259,A260,A261,A524,MATRIX_1:def 8;
                            hence FF/.1 in rng Line(G1,1) by A523,PARTFUN2:4;
                          end;
                        end;
A525:                   len FF=len(h1^F)+len h2 by FINSEQ_1:35
                          .=len h1+len F+len h2 by FINSEQ_1:35;
                        0+0<=len h1+len h2 by NAT_1:2;
                        then
A526:                   0+1<=len F+(len h1+len h2) by A493,XREAL_1:9;
A527:                   now per cases;
                          suppose
A528:                       ma=len G1;
                            then h2 = {} by A298;
                            then
A529:                       FF=h1^F by FINSEQ_1:47;
A530:                       pf+1-(pf+1-pl) = pl;
A531:                       len F in dom F & pl in Seg pf
                            by A254,A481,A493,FINSEQ_1:3,FINSEQ_3:27;
                            FF/.len FF=FF/.(len h1+len F) by A529,FINSEQ_1:35
                              .= F/.LL by A491,A529,A531,FINSEQ_4:84
                              .= F1/.pl by A491,A492,A530,A531
                              .= g/.pl by A251,A531,FINSEQ_4:86;

hence FF/.len FF in rng Line(G1,len G1) by A252,A528;
                          end;
                          suppose
A532:                       ma<>len G1;
                            ma<=len G1 by A28,FINSEQ_3:27;
                            then ma<len G1 by A532,XXREAL_0:1;
                            then ma+1<=len G1 by NAT_1:13;
                            then
A533:                       1<=l2 by XREAL_1:21;
                            then
A534:                       l2 in Seg l2 by FINSEQ_1:3;
                            len Line(G1,len G1)=width G1 by MATRIX_1:def 8;
                            then
A535:                       K2 in dom Ll by A277,A278,A279,FINSEQ_1:def 3;
                            then
A536:                       Ll/.K2 = Ll.K2 by PARTFUN1:def 8;
A537:                       len h2 in dom h2 by A298,A533,FINSEQ_3:27;
                            FF/.len FF=FF/.(len(h1^F)+len h2) by FINSEQ_1:35
                              .=h2/.l2 by A298,A537,FINSEQ_4:84
                              .=G1*(ma+l2,K2) by A298,A299,A534
                              .=Ll/.K2 by A277,A278,A279,A536,MATRIX_1:def 8;

hence FF/.len FF in rng Line(G1,len G1) by A535,PARTFUN2:4;
                          end;
                        end;
A538:                   rng FF = rng(h1^F) \/ rng h2 by FINSEQ_1:44
                          .= rng h1 \/ rng F \/ rng h2 by FINSEQ_1:44;
A539:                   for

k st k in Seg width G1 & rng F /\ rng Col(G1,k)={} holds
                        rng FF /\ rng Col(G1,k)={}
                        proof
                          let k;
                          assume that
A540:                     k in Seg width G1 and
A541:                     rng F /\ rng Col(G1,k)={};
                          set gg=Col(G1,k);
                          assume
A542:                     rng FF /\ rng gg <> {};
                          consider x being Element of rng FF /\ rng gg;

rng FF = rng F \/ (rng h1 \/ rng h2) by A538,XBOOLE_1:4;
                          then
A543:                     rng FF /\ rng gg = {}
                          \/ (rng h1 \/ rng h2) /\ rng gg by A541,XBOOLE_1:23

.= rng h1 /\ rng gg \/ rng h2 /\ rng gg by XBOOLE_1:23;
A544:                     len Col(G1,K1)=len G1 & len Col(G1,K2)=len G1
                          by MATRIX_1:def 9;
                          now per cases by A542,A543,XBOOLE_0:def 3;
                            suppose x in rng h1 /\ rng gg;
                              then
A545:                         x in rng h1 & x in rng gg by XBOOLE_0:def 4;
                              then consider i such that
A546:                         i in dom h1 & x=h1/.i by PARTFUN2:4;
A547:                         x=G1*(i,K1) by A296,A546;
                              reconsider y=x as Point of TOP-REAL 2 by A546;
A548:                         pf+1-1 = pf;
A549:                         dom CK1 = Seg len G1 by A544,FINSEQ_1:def 3
                                .= dom G1 by FINSEQ_1:def 3;
                              then
A550:                         i in dom CK1 by A300,A546;
A551:                         Lmi/.K1 = Lmi.K1 &
                              CK1/.mi = CK1.mi by A26,A259,A549,PARTFUN1:def 8;
                              CK1/.i = CK1.i by A300,A546,A549,PARTFUN1:def 8;
                              then y=CK1/.i by A547,A549,A550,MATRIX_1:def 9;
                              then y in rng CK1 by A550,PARTFUN2:4;
                              then
A552:                         K1=k & 1 in Seg LL

by A259,A260,A261,A493,A540,A545,FINSEQ_1:3,GOBOARD1:20;

then F/.1=F1/.pf & F1/.pf=g/.pf by A484,A491,A548;

then F/.1=CK1/.mi by A26,A259,A260,A261,A551,GOBOARD1:17;
                              then F/.1 in rng Col(G1,k) & F/.1 in rng F
                              by A26,A491,A492,A549,A552,PARTFUN2:4;
                              hence contradiction by A541,XBOOLE_0:def 4;
                            end;
                            suppose x in rng h2 /\ rng gg;
                              then
A553:                         x in rng h2 & x in rng gg by XBOOLE_0:def 4;
                              then consider i such that
A554:                         i in dom h2 & x=h2/.i by PARTFUN2:4;
A555:                         x=G1*(ma+i,K2) by A298,A554;
                              reconsider y=x as Point of TOP-REAL 2 by A554;
A556:                         LL in Seg LL by A493,FINSEQ_1:3;
                              reconsider u = pf+1-LL as Element of NAT;
A557:                         dom CK2 = Seg len G1 by A544,FINSEQ_1:def 3
                                .= dom G1 by FINSEQ_1:def 3;
                              then
A558:                         ma+i in dom CK2 by A302,A554;
A559:                         Lma

/.K2 = Lma.K2 & CK2/.ma = CK2.ma by A28,A277,A557,PARTFUN1:def 8;

CK2/.(ma+i) = CK2.(ma+i) by A302,A554,A557,PARTFUN1:def 8;

then y=CK2/.(ma+i) by A555,A557,A558,MATRIX_1:def 9;
                              then y in rng CK2 by A558,PARTFUN2:4;
                              then
A560:                         K2=k by A277,A278,A279,A540,A553,GOBOARD1:20;
                              F/.LL=F1/.u & F1/.u=g/.u by A484,A491,A556;

then F/.LL= CK2/.ma by A28,A277,A278,A279,A559,GOBOARD1:17;
                              then F/.LL in rng Col(G1,k) & F/.LL in rng F
                              by A28,A491,A492,A556,A557,A560,PARTFUN2:4;
                              hence contradiction by A541,XBOOLE_0:def 4;
                            end;
                          end;
                          hence contradiction;
                        end;
A561:                   rng tt /\ rng FF = ((rng h1 \/ rng F) /\ rng tt) \/
                        {} by A384,A538,XBOOLE_1:23
                          .= {} \/ rng F /\ rng tt by A343,XBOOLE_1:23
                          .= rng tt /\ rng F;
                        rng tt c= rng f by A245,A246,XBOOLE_1:1;
                        then
A562:                   rng tt c= rng g1 by A192,XBOOLE_1:1;
                        rng F c= rng g2
                        proof
                          let x;
                          assume x in rng F;
                          then consider n such that
A563:                     n in dom F & x=F/.n by PARTFUN2:4;

reconsider u = pf+1-n as Element of NAT by A482,A491,A492,A563;
                          F/.n=F1/.u by A491,A492,A563;

then pf+1-n in dom g & F/.n=g/.u by A484,A491,A492,A563;
                          then x in rng g by A563,PARTFUN2:4;
                          hence thesis by A36;
                        end;
                        then
A564:                   rng

FF /\ rng tt c= rng g1 /\ rng g2 by A561,A562,XBOOLE_1:27;
A565:                   1
                        in dom FF & len FF in dom FF by A525,A526,FINSEQ_3:27;
                        rng F /\ rng C = {}
                        proof
                          assume
A566:                     not thesis;
                          consider x being Element of rng F /\ rng C;
A567:                     x in rng F & x in rng C by A566,XBOOLE_0:def 4;
                          then consider i1 be Element of NAT such that
A568:                     i1 in dom F & F/.i1=x by PARTFUN2:4;

reconsider w=pf+1-i1 as Element of NAT by A482,A491,A492,A568;
A569:                     F/.i1=F1/.w & F1/.w=g/.w &
                          w in dom g by A484,A491,A492,A568;
                          1<=i1 & i1<=LL by A491,A568,FINSEQ_3:27;
                          then
A570:                     w<=pf+1-1 & pf+1-LL<=w by XREAL_1:15;
A571:                     w in dom g2 by A8,A19,A35,A569,FINSEQ_4:86;

g2/.w in rng C by A8,A19,A35,A567,A568,A569,FINSEQ_4:86;
                          then m<=w & w<m by A8,A35,A276,A570,A571,XXREAL_0:2;
                          hence contradiction;
                        end;
                        then rng FF /\ rng Col(G1,width G1) = {} by A15,A539;

then rng FF misses rng Col(G1,width G1) by XBOOLE_0:def 7;
                        then
A572:                   FF is_sequence_on D & FF/. 1 in rng Line(D,1) &
                        FF/.len FF in rng Line(D,len D)

by A15,A16,A17,A195,A196,A513,A514,A527,A565,GOBOARD1:37,41;
                        width D=k by A5,A15,A67,GOBOARD1:26,NAT_1:3;
                        then
A573:                   rng FF /\ rng tt <> {} by A4,A68,A246,A525,A526,A572;
                        consider x being Element of rng FF /\ rng tt;
                        x in rng FF /\ rng tt by A573;
                        hence thesis by A564;
                      end;
                    end;
                    hence thesis;
                  end;
                end;
                hence thesis;
              end;
            end;
          end;
        end;
        hence thesis;
      end;
    end;
    hence thesis;
  end;
A574: for k holds P[k] from NAT_1:sch 1(A2,A3);
A575: now
    let k;
    let G1,g1,g2;
    assume k=width G1 & k>0 &
    1<=len g1 & 1<=len g2 & g1 is_sequence_on G1 & g2 is_sequence_on G1 &
    g1/.1 in rng Line(G1,1) & g1/.len g1 in rng Line(G1,len G1) &
    g2/.1 in rng Col(G1,1) & g2/.len g2 in rng Col(G1,width G1);
    then rng g1 /\ rng g2 <> {} by A574;
    hence rng g1 meets rng g2 by XBOOLE_0:def 7;
  end;
  width G <> 0 by GOBOARD1:def 5;
  then width G > 0 by NAT_1:3;
  hence thesis by A1,A575;
end;

theorem Th2:
  for G,f1,f2 st 2<=len f1 & 2<=len f2 &
  f1 is_sequence_on G & f2 is_sequence_on G &
  f1/.1 in rng Line(G,1) & f1/.len f1 in rng Line(G,len G) &
  f2/.1 in rng Col(G,1) & f2/.len f2 in rng Col(G,width G) holds
  L~f1 meets L~f2
proof
  let G,f1,f2;
  assume
A1: 2<=len f1 & 2<=len f2 & f1 is_sequence_on G & f2 is_sequence_on G &
  f1/.1 in rng Line(G,1) & f1/.len f1 in rng Line(G,len G) &
  f2/.1 in rng Col(G,1) & f2/.len f2 in rng Col(G,width G);
  then 1<=len f1 & 1<=len f2 by XXREAL_0:2;
  then rng f1 meets rng f2 by A1,Th1;
  then consider x being set such that
A2: x in rng f1 & x in rng f2 by XBOOLE_0:3;
A3: ex n st n in dom f1 & f1/.n=x by A2,PARTFUN2:4;
  ex m st m in dom f2 & f2/.m=x by A2,PARTFUN2:4;
  then x in L~f1 & x in L~f2 by A1,A3,GOBOARD1:16;
  hence thesis by XBOOLE_0:3;
end;

theorem
  for G,f1,f2 st 2 <= len f1 & 2 <= len f2 &
  f1 is_sequence_on G & f2 is_sequence_on G &
  f1/.1 in rng Line(G,1) & f1/.len f1 in rng Line(G,len G) &
  f2/.1 in rng Col(G,1) & f2/.len f2 in rng Col(G,width G) holds
  L~f1 meets L~f2 by Th2;

definition
  let f be Relation, r,s be Real;
  pred f lies_between r,s means
  :Def1:
  rng f c= [. r,s .];
end;

definition
  let f be FinSequence of REAL, r,s be Real;
  redefine pred f lies_between r,s means
  :Def2:
  for n st n in dom f holds r <= f.n & f.n <= s;
  compatibility
  proof
    hereby
      assume f lies_between r,s;
      then
A1:   rng f c= [. r,s .] by Def1;
      let n;
      assume n in dom f;
      then f.n in rng f by FUNCT_1:12;
      hence r <= f.n & f.n <= s by A1,XXREAL_1:1;
    end;
    assume
A2: for n st n in dom f holds r <= f.n & f.n <= s;
    let y be set;
    assume y in rng f;
    then consider x being set such that
A3: x in dom f & y = f.x by FUNCT_1:def 5;
    reconsider n=x as Element of NAT by A3;
    r <= f.n & f.n <= s by A2,A3;
    hence thesis by A3,XXREAL_1:1;
  end;
end;

theorem Th4:
  for f1,f2 being FinSequence of TOP-REAL 2 st
  2<=len f1 & 2<=len f2 & f1 is special & f2 is special &
  (for n st n in dom f1 & n+1 in dom f1 holds f1/.n <> f1/.(n+1)) &
  (for n st n in dom f2 & n+1 in dom f2 holds f2/.n <> f2/.(n+1)) &
  X_axis(f1) lies_between (X_axis(f1)).1, (X_axis(f1)).(len f1) &
  X_axis(f2) lies_between (X_axis(f1)).1, (X_axis(f1)).(len f1) &
  Y_axis(f1) lies_between (Y_axis(f2)).1, (Y_axis(f2)).(len f2) &
  Y_axis(f2) lies_between (Y_axis(f2)).1, (Y_axis(f2)).(len f2) holds
  L~f1 meets L~f2
proof
  let f1,f2 be FinSequence of TOP-REAL 2;
  assume that
A1: 2<=len f1 & 2<=len f2 and
A2: f1 is special and
A3: f2 is special and
A4: for n st n in dom f1 & n+1 in dom f1 holds f1/.n <> f1/.(n+1) and
A5: for n st n in dom f2 & n+1 in dom f2 holds f2/.n <> f2/.(n+1) and
A6: X_axis(f1) lies_between (X_axis(f1)).1, (X_axis(f1)).(len f1) and
A7: X_axis(f2) lies_between (X_axis(f1)).1, (X_axis(f1)).(len f1) and
A8: Y_axis(f1) lies_between (Y_axis(f2)).1, (Y_axis(f2)).(len f2) and
A9: Y_axis(f2) lies_between (Y_axis(f2)).1, (Y_axis(f2)).(len f2);
  len f1 <> 0 & len f2 <> 0 by A1;
  then reconsider f1, f2 as non empty FinSequence of TOP-REAL 2;
  reconsider f = f1^f2 as non empty FinSequence of TOP-REAL 2;
  len f = len f1 + len f2 by FINSEQ_1:35;
  then
A10: 2+2<=len f by A1,XREAL_1:9;
  set G = GoB(f);
  now
    let n;
    assume
A11: n in dom f1;
    then f/.n=f1/.n & dom f1 c= dom f by FINSEQ_1:39,FINSEQ_4:83;
    then consider i,j such that
A12: [i,j] in Indices G & f/.n=G*(i,j) by A11,GOBOARD2:25;
    take i,j;
    thus [i,j] in Indices G & f1/.n=G*(i,j) by A11,A12,FINSEQ_4:83;
  end;
  then consider g1 such that
A13: g1 is_sequence_on G & L~g1=L~f1 & g1/.1=f1/.1 & g1/.len g1=f1/.len f1 &
  len f1 <= len g1 by A2,A4,GOBOARD2:17;
  now
    let n;
    assume
A14: n in dom f2;
    then f/.(len f1+n)=f2/.n & len f1+n in dom f by FINSEQ_1:41,FINSEQ_4:84;
    then consider i,j such that
A15: [i,j] in Indices G & f/.(len f1+n)=G*(i,j) by GOBOARD2:25;
    take i,j;
    thus [i,j] in Indices G & f2/.n=G*(i,j) by A14,A15,FINSEQ_4:84;
  end;
  then consider g2 such that
A16: g2 is_sequence_on G & L~g2=L~f2 & g2/.1=f2/.1 &
  g2/.len g2=f2/.len f2 & len f2 <= len g2 by A3,A5,GOBOARD2:17;
  set x = X_axis(f), y = Y_axis(f), x1 = X_axis(f1), y1 = Y_axis(f1),
  x2 = X_axis(f2), y2 = Y_axis(f2);
A17: Seg len f1=dom f1 & Seg len f2=dom f2 & Seg len f=dom f &
  dom x = Seg len x & Seg len y = dom y & len x = len f & len y = len f &
  Seg len x1=dom x1 & Seg len y1=dom y1 & len x1=len f1 & len y1=len f1 &
  Seg len x2=dom x2 & Seg len y2=dom y2 & len x2=len f2 & len y2=len f2 &
  dom f1 c= dom f &
  rng f1 c= the carrier of TOP-REAL 2 & rng f2 c= the carrier of TOP-REAL 2
  by FINSEQ_1:39,def 3,def 4,GOBOARD1:def 3,def 4;
  1<=len f & 1<=len f1 & 1<=len f2 by A1,A10,XXREAL_0:2;
  then
A18: 1 in dom f & 1 in dom f1 &
  len f1 in dom f1 & 1 in dom f2 & len f2 in dom f2 by FINSEQ_3:27;
  then
A19: f/.1=f1/.1 & f/.len f1=f1/.len f1 & f/.(len f1+1)=f2/.1 &
  f/.(len f1+len f2)=f2/.len f2 & len f1 in dom f & len f1+1 in dom f &
  len f1+len f2 in dom f by A17,FINSEQ_1:41,FINSEQ_4:83,84;
  reconsider p1=f1/.1, p2=f1/.len f1, q1=f2/.1, q2=f2/.len f2
  as Point of TOP-REAL 2;
A20: x.1=p1`1 & x1.1=p1`1 & x.(len f1) = p2`1 & x1.(len f1) = p2`1 &
  y.(len f1+1)=q1`2 & y2.1=q1`2 & y.(len f1+len f2)=q2`2 & y2.(len f2)=q2`2
  by A17,A18,A19,GOBOARD1:def 3,def 4;
A21: len f = len f1 + len f2 by FINSEQ_1:35;
  now
    let m;
    assume
A22: m in dom f;
    then
A23: 1<=m & m<=len f by FINSEQ_3:27;
    set s = x.m;
    now per cases;
      suppose m<=len f1;
        then
A24:    m in dom f1 by A23,FINSEQ_3:27;
        reconsider u=f1/.m as Point of TOP-REAL 2;
        f/.m=u by A24,FINSEQ_4:83;
        then
A25:    x.m=u`1 by A17,A22,GOBOARD1:def 3;
        x1.m=u`1 by A17,A24,GOBOARD1:def 3;
        hence p1`1<=s by A6,A17,A20,A24,A25,Def2;
      end;
      suppose
A26:    len f1<m;
        then reconsider w5 = m-len f1 as Element of NAT by INT_1:18;
A27:    m = w5 + len f1;
        w5 > 0 by A26,XREAL_1:52;
        then
A28:    1<=w5 & w5<=len f2 by A21,A23,A27,NAT_1:14,XREAL_1:8;
        then
A29:    f/.m = f2/.w5 & len f1 +1<=m by A26,A27,GOBOARD2:5,NAT_1:13;
        reconsider m1=m-len f1 as Element of NAT by A27;
A30:    m1 in dom f2 by A28,FINSEQ_3:27;
        reconsider u=f2/.m1 as Point of TOP-REAL 2;
A31:    x.m=u`1 by A17,A22,A29,GOBOARD1:def 3;
        x2.m1=u`1 by A17,A30,GOBOARD1:def 3;
        hence p1`1<=s by A7,A17,A20,A30,A31,Def2;
      end;
    end;
    hence p1`1<=s;
  end;
  then
A32: f/.1 in rng Line(G,1) by A18,A20,GOBOARD2:26;
  now
    let m;
    assume
A33: m in dom f;
    then
A34: 1<=m & m<=len f by FINSEQ_3:27;
    set s = x.m;
    now per cases;
      suppose m<=len f1;
        then
A35:    m in dom f1 by A34,FINSEQ_3:27;
        reconsider u=f1/.m as Point of TOP-REAL 2;
        f/.m=u by A35,FINSEQ_4:83;
        then
A36:    x.m=u`1 by A17,A33,GOBOARD1:def 3;
        x1.m=u`1 by A17,A35,GOBOARD1:def 3;
        hence s<=p2`1 by A6,A17,A20,A35,A36,Def2;
      end;
      suppose
A37:    len f1<m;
        then reconsider w5 = m-len f1 as Element of NAT by INT_1:18;
A38:    m = w5 + len f1;
        w5 > 0 by A37,XREAL_1:52;
        then
A39:    1<=w5 & w5<=len f2 by A21,A34,A38,NAT_1:14,XREAL_1:8;
        then
A40:    f/.m = f2/.w5 & len f1 +1<=m by A37,A38,GOBOARD2:5,NAT_1:13;
        reconsider m1=m-len f1 as Element of NAT by A38;
A41:    m1 in dom f2 by A39,FINSEQ_3:27;
        reconsider u=f2/.m1 as Point of TOP-REAL 2;
A42:    x.m=u`1 by A17,A33,A40,GOBOARD1:def 3;
        x2.m1=u`1 by A17,A41,GOBOARD1:def 3;
        hence s<=p2`1 by A7,A17,A20,A41,A42,Def2;
      end;
    end;
    hence s<=p2`1;
  end;
  then
A43: f/.len f1 in rng Line(G,len G) by A17,A18,A20,GOBOARD2:27;
  now
    let m;
    assume
A44: m in dom f;
    then
A45: 1<=m & m<=len f by FINSEQ_3:27;
    set s = y.m;
    now per cases;
      suppose m<=len f1;
        then
A46:    m in dom f1 by A45,FINSEQ_3:27;
        reconsider u=f1/.m as Point of TOP-REAL 2;
        f/.m=u by A46,FINSEQ_4:83;
        then
A47:    y.m=u`2 by A17,A44,GOBOARD1:def 4;
        y1.m=u`2 by A17,A46,GOBOARD1:def 4;
        hence q1`2<=s by A8,A17,A20,A46,A47,Def2;
      end;
      suppose
A48:    len f1<m;
        then reconsider w5 = m-len f1 as Element of NAT by INT_1:18;
A49:    m = w5 + len f1;
        w5 > 0 by A48,XREAL_1:52;
        then
A50:    1<=w5 & w5<=len f2 by A21,A45,A49,NAT_1:14,XREAL_1:8;
        then
A51:    f/.m = f2/.w5 & len f1 +1<=m by A48,A49,GOBOARD2:5,NAT_1:13;
        reconsider m1=m-len f1 as Element of NAT by A49;
A52:    m1 in dom f2 by A50,FINSEQ_3:27;
        reconsider u=f2/.m1 as Point of TOP-REAL 2;
A53:    y.m=u`2 by A17,A44,A51,GOBOARD1:def 4;
        y2.m1=u`2 by A17,A52,GOBOARD1:def 4;
        hence q1`2<=s by A9,A17,A20,A52,A53,Def2;
      end;
    end;
    hence q1`2<=s;
  end;
  then
A54: f/.(len f1+1) in rng Col(G,1) by A19,A20,GOBOARD2:28;
  now
    let m;
    assume
A55: m in dom f;
    then
A56: 1<=m & m<=len f by FINSEQ_3:27;
    set s = y.m;
    now per cases;
      suppose m<=len f1;
        then
A57:    m in dom f1 by A56,FINSEQ_3:27;
        reconsider u=f1/.m as Point of TOP-REAL 2;
        f/.m=u by A57,FINSEQ_4:83;
        then
A58:    y.m=u`2 by A17,A55,GOBOARD1:def 4;
        y1.m=u`2 by A17,A57,GOBOARD1:def 4;
        hence s<=q2`2 by A8,A17,A20,A57,A58,Def2;
      end;
      suppose
A59:    len f1<m;
        then reconsider w5 = m-len f1 as Element of NAT by INT_1:18;
A60:    m = w5 + len f1;
        w5 > 0 by A59,XREAL_1:52;
        then
A61:    1<=w5 & w5<=len f2 by A21,A56,A60,NAT_1:14,XREAL_1:8;
        then
A62:    f/.m = f2/.w5 & len f1 +1<=m by A59,A60,GOBOARD2:5,NAT_1:13;
        reconsider m1=m-len f1 as Element of NAT by A60;
A63:    m1 in dom f2 by A61,FINSEQ_3:27;
        reconsider u=f2/.m1 as Point of TOP-REAL 2;
A64:    y.m=u`2 by A17,A55,A62,GOBOARD1:def 4;
        y2.m1=u`2 by A17,A63,GOBOARD1:def 4;
        hence s<=q2`2 by A9,A17,A20,A63,A64,Def2;
      end;
    end;
    hence s<=q2`2;
  end;
  then
A65: f/.(len f1+len f2) in rng Col(G,width G) by A19,A20,GOBOARD2:29;
  2<=len g1 & 2<=len g2 by A1,A13,A16,XXREAL_0:2;
  hence thesis by A13,A16,A19,A32,A43,A54,A65,Th2;
end;

theorem Th5:
  for f1,f2 being FinSequence of TOP-REAL 2 st
  f1 is one-to-one special & 2 <= len f1 &
  f2 is one-to-one special & 2 <= len f2 &
  X_axis(f1) lies_between (X_axis(f1)).1, (X_axis(f1)).(len f1) &
  X_axis(f2) lies_between (X_axis(f1)).1, (X_axis(f1)).(len f1) &
  Y_axis(f1) lies_between (Y_axis(f2)).1, (Y_axis(f2)).(len f2) &
  Y_axis(f2) lies_between (Y_axis(f2)).1, (Y_axis(f2)).(len f2) holds
  L~f1 meets L~f2
proof
  let f1,f2 be FinSequence of TOP-REAL 2;
  assume that
A1: f1 is one-to-one special & 2 <= len f1 &
  f2 is one-to-one special & 2 <= len f2 and
A2: X_axis(f1) lies_between (X_axis(f1)).1, (X_axis(f1)).(len f1) and
A3: X_axis(f2) lies_between (X_axis(f1)).1, (X_axis(f1)).(len f1) and
A4: Y_axis(f1) lies_between (Y_axis(f2)).1, (Y_axis(f2)).(len f2) and
A5: Y_axis(f2) lies_between (Y_axis(f2)).1, (Y_axis(f2)).(len f2);
A6: for n st n in dom f1 & n+1 in dom f1 holds f1/.n <> f1/.(n+1)
  proof
    let n;
    assume n in dom f1 & n+1 in dom f1 & f1/.n=f1/.(n+1);
    then n=n+1 by A1,PARTFUN2:17;
    hence contradiction;
  end;
  for n st n in dom f2 & n+1 in dom f2 holds f2/.n <> f2/.(n+1)
  proof
    let n;
    assume n in dom f2 & n+1 in dom f2 & f2/.n=f2/.(n+1);
    then n=n+1 by A1,PARTFUN2:17;
    hence contradiction;
  end;
  hence thesis by A1,A2,A3,A4,A5,A6,Th4;
end;

canceled 2;

theorem
  for P1,P2,p1,p2,q1,q2 st
  P1 is_S-P_arc_joining p1,q1 & P2 is_S-P_arc_joining p2,q2 &
  (for p st p in P1 \/ P2 holds p1`1<=p`1 & p`1<=q1`1) &
  (for p st p in P1 \/ P2 holds p2`2<=p`2 & p`2<=q2`2) holds P1 meets P2
proof
  let P1,P2,p1,p2,q1,q2;
  assume that
A1: P1 is_S-P_arc_joining p1,q1 & P2 is_S-P_arc_joining p2,q2 and
A2: for p st p in P1 \/ P2 holds p1`1<=p`1 & p`1<=q1`1 and
A3: for p st p in P1 \/ P2 holds p2`2<=p`2 & p`2<=q2`2;
  consider f1 such that
A4: f1 is being_S-Seq & P1=L~f1 & p1=f1/.1 & q1=f1/.len f1
 by A1,TOPREAL4:def 1;
  len f1 <> 0 by A4,TOPREAL1:def 10;
  then reconsider f1 as non empty FinSequence of TOP-REAL 2;
  consider f2 such that
A5: f2 is being_S-Seq & P2=L~f2 & p2=f2/.1 & q2=f2/.len f2
 by A1,TOPREAL4:def 1;
  len f2 <> 0 by A5,TOPREAL1:def 10;
  then reconsider f2 as non empty FinSequence of TOP-REAL 2;
A6: f1 is one-to-one special & f2 is one-to-one special
  by A4,A5,TOPREAL1:def 10;
A7: 1<=2 & 2<=len f1 & 2<=len f2 by A4,A5,TOPREAL1:def 10;
  then 2<=len f1 & 2<=len f2 & 1<=len f1 & 1<=len f2 by XXREAL_0:2;
  then
A8: 1 in dom f1 & 1 in dom f2 & len f1 in dom f1 & len f2 in dom f2
  by FINSEQ_3:27;
  set x1 = X_axis(f1), y1 = Y_axis(f1), x2 = X_axis(f2), y2 = Y_axis(f2);
A9: Seg len f1=dom f1 & Seg len f2=dom f2 & Seg len x1=dom x1 &
  dom x2=Seg len x2 & dom y1=Seg len y1 & dom y2=Seg len y2 &
  len x1= len f1 & len y1=len f1 & len x2=len f2 & len y2=len f2 &
  rng f1 c=the carrier of TOP-REAL 2 & rng f2 c=the carrier of TOP-REAL 2
  by FINSEQ_1:def 3,def 4,GOBOARD1:def 3,def 4;
  then
A10: x1.1=p1`1 & x1.(len f1)=q1`1 & y2.1=p2`2 & y2.(len f2)=q2`2
  by A4,A5,A8,GOBOARD1:def 3,def 4;
A11: x1 lies_between x1.1, x1.len f1
  proof
    let n;
    set q=f1/.n;
    assume
A12: n in dom x1;
    then q in rng f1 & q in L~f1 by A7,A9,GOBOARD1:16,PARTFUN2:4;
    then x1.n=q`1 & q in P1 \/ P2 by A4,A12,GOBOARD1:def 3,XBOOLE_0:def 3;
    hence thesis by A2,A10;
  end;
A13: x2 lies_between x1.1, x1.len f1
  proof
    let n;
    set q=f2/.n;
    assume
A14: n in dom x2;
    then q in rng f2 & q in L~f2 by A7,A9,GOBOARD1:16,PARTFUN2:4;
    then x2.n=q`1 & q in P1 \/ P2 by A5,A14,GOBOARD1:def 3,XBOOLE_0:def 3;
    hence thesis by A2,A10;
  end;
A15: y1 lies_between y2.1, y2.len f2
  proof
    let n;
    set q=f1/.n;
    assume
A16: n in dom y1;
    then q in rng f1 & q in L~f1 by A7,A9,GOBOARD1:16,PARTFUN2:4;
    then y1.n=q`2 & q in P1 \/ P2 by A4,A16,GOBOARD1:def 4,XBOOLE_0:def 3;
    hence thesis by A3,A10;
  end;
  y2 lies_between y2.1, y2.len f2
  proof
    let n;
    set q = f2/.n;
    assume
A17: n in dom y2;
    then q in rng f2 & q in L~f2 by A7,A9,GOBOARD1:16,PARTFUN2:4;
    then y2.n=q`2 & q in P1 \/ P2 by A5,A17,GOBOARD1:def 4,XBOOLE_0:def 3;
    hence thesis by A3,A10;
  end;
  hence thesis by A4,A5,A6,A7,A11,A13,A15,Th5;
end;

