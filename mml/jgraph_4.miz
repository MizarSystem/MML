:: Fan Homeomorphisms in the Plane
::  by Yatsuka Nakamura
::
:: Received January 8, 2002
:: Copyright (c) 2002 Association of Mizar Users

environ

 vocabularies NUMBERS, XREAL_0, ORDINAL1, PRE_TOPC, EUCLID, SUPINF_2, COMPLEX1,
      XXREAL_0, CARD_1, XBOOLE_0, FUNCT_1, TOPMETR, SUBSET_1, ORDINAL2,
      PARTFUN1, RCOMP_1, REAL_1, TARSKI, STRUCT_0, RELAT_1, ARYTM_3, TOPS_2,
      ARYTM_1, SQUARE_1, NAT_1, METRIC_1, JORDAN2C, XXREAL_2, PCOMPS_1,
      MCART_1, FUNCT_4, JGRAPH_4;
 notations TARSKI, XBOOLE_0, SUBSET_1, ORDINAL1, NUMBERS, XCMPLX_0, XREAL_0,
      NAT_1, REAL_1, COMPLEX1, RELAT_1, FUNCT_1, RELSET_1, FUNCT_2, DOMAIN_1,
      STRUCT_0, PARTFUN1, TOPMETR, RLVECT_1, EUCLID, COMPTS_1, TOPS_2,
      METRIC_1, PCOMPS_1, SQUARE_1, TBSP_1, RCOMP_1, PSCOMP_1, PRE_TOPC,
      JORDAN2C, FUNCT_4, XXREAL_0;
 constructors FUNCT_4, REAL_1, SQUARE_1, BINOP_2, COMPLEX1, RCOMP_1, TOPS_2,
      COMPTS_1, TBSP_1, MONOID_0, TOPMETR, PSCOMP_1, JORDAN2C, SEQ_1, FUNCSDOM;
 registrations XBOOLE_0, RELAT_1, NUMBERS, XXREAL_0, XREAL_0, SQUARE_1,
      MEMBERED, STRUCT_0, PRE_TOPC, METRIC_1, EUCLID, TOPMETR, TOPREAL1,
      PSCOMP_1, JORDAN6, FUNCT_2, COMPTS_1;
 requirements REAL, NUMERALS, BOOLE, SUBSET, ARITHM;
 definitions TARSKI, SQUARE_1, EUCLID, STRUCT_0, PCOMPS_1, ALGSTR_0;
 theorems TARSKI, RELAT_1, SUBSET_1, FUNCT_1, FUNCT_2, FUNCT_4, TOPS_1, TOPS_2,
      PARTFUN1, PRE_TOPC, FRECHET, TOPMETR, JORDAN6, EUCLID, JGRAPH_1,
      SQUARE_1, PSCOMP_1, METRIC_1, JGRAPH_2, GOBOARD6, GOBOARD9, TBSP_1,
      TOPREAL6, JGRAPH_3, ABSVALUE, JORDAN2C, TSEP_1, XREAL_0, XBOOLE_0,
      XBOOLE_1, TOPRNS_1, SEQ_2, XCMPLX_0, XCMPLX_1, COMPLEX1, XREAL_1,
      JORDAN2B, XXREAL_0, XXREAL_1, ORDINAL1;
 schemes FUNCT_2, DOMAIN_1, JGRAPH_2, BINOP_2, JGRAPH_3;

begin :: Preliminaries

reserve x,a for real number;
reserve p,q for Point of TOP-REAL 2;

Lm1: p <> 0.TOP-REAL 2 implies |.p.| > 0
proof
  assume
  p <> 0.TOP-REAL 2;
  then |.p.| <> 0 by TOPRNS_1:25;
  hence thesis;
end;

canceled 5;

theorem Th6:
  for X being non empty TopStruct, g being Function of X,R^1, B
  being Subset of X, a being real number st g is continuous & B = {p where p is
  Point of X: g/.p > a } holds B is open
proof
  let X be non empty TopStruct,g be Function of X,R^1,B be Subset of X, a be
  real number;
  assume that
A1: g is continuous and
A2: B={p where p is Point of X:g/.p > a };
  {r where r is Real: r>a} c= the carrier of R^1
  proof
    let x be set;
    assume
    x in {r where r is Real: r>a};
    then ex r being Real st r=x & r>a;
    hence thesis by TOPMETR:24;
  end;
  then reconsider D={r where r is Real: r>a} as Subset of R^1;
A3: g"D c= B
  proof
    let x be set;
    assume
A4: x in g"D;
    then reconsider p=x as Point of X;
    g.x in D by A4,FUNCT_1:def 13;
    then
A5: ex r being Real st r=g.x & r>a;
    g/.p=g.p;
    hence thesis by A2,A5;
  end;
A6: [#]R^1 <> {} & D is open by JORDAN2B:31;
  B c= g"D
  proof
    let x be set;
    assume
    x in B;
    then consider p being Point of X such that
A7: p=x and
A8: g/.p > a by A2;
    g/.p is Real by XREAL_0:def 1;
    then dom g=the carrier of X & g.x in D by A7,A8,FUNCT_2:def 1;
    hence thesis by A7,FUNCT_1:def 13;
  end;
  then B=g"D by A3,XBOOLE_0:def 10;
  hence thesis by A1,A6,TOPS_2:55;
end;

theorem Th7:
  for X being non empty TopStruct, g being Function of X,R^1,B
being Subset of X, a being Real st g is continuous & B={p where p is Point of X
  : g/.p < a } holds B is open
proof
  let X be non empty TopStruct,g be Function of X,R^1, B be Subset of X,a be
  Real;
  assume that
A1: g is continuous and
A2: B={p where p is Point of X:g/.p < a };
  {r where r is Real: r<a} c= the carrier of R^1
  proof
    let x be set;
    assume
    x in {r where r is Real: r<a};
    then ex r being Real st r=x & r<a;
    hence thesis by TOPMETR:24;
  end;
  then reconsider D={r where r is Real: r<a} as Subset of R^1;
A3: g"D c= B
  proof
    let x be set;
    assume
A4: x in g"D;
    then reconsider p=x as Point of X;
    g.x in D by A4,FUNCT_1:def 13;
    then
A5: ex r being Real st r=g.x & r<a;
    g/.p=g.p;
    hence thesis by A2,A5;
  end;
A6: [#]R^1 <> {} & D is open by JORDAN2B:30;
  B c= g"D
  proof
    let x be set;
    assume
    x in B;
    then consider p being Point of X such that
A7: p=x and
A8: g/.p < a by A2;
    g/.p is Real by XREAL_0:def 1;
    then dom g=the carrier of X & g.x in D by A7,A8,FUNCT_2:def 1;
    hence thesis by A7,FUNCT_1:def 13;
  end;
  then B=g"D by A3,XBOOLE_0:def 10;
  hence thesis by A1,A6,TOPS_2:55;
end;

theorem Th8:
  for f being Function of TOP-REAL 2,TOP-REAL 2 st f is continuous
  one-to-one & rng f=[#](TOP-REAL 2) & (for p2 being Point of TOP-REAL 2 ex K
being non empty compact Subset of TOP-REAL 2 st K = f.:K & (ex V2 being Subset
  of TOP-REAL 2 st p2 in V2 & V2 is open & V2 c= K & f.p2 in V2)) holds f is
  being_homeomorphism
proof
  let f be Function of TOP-REAL 2,TOP-REAL 2;
  assume that
A1: f is continuous one-to-one and
A2: rng f=[#](TOP-REAL 2) and
A3: for p2 being Point of TOP-REAL 2 ex K being non empty compact Subset
  of TOP-REAL 2 st K = f.:K & ex V2 being Subset of TOP-REAL 2 st p2 in V2 & V2
  is open & V2 c= K & f.p2 in V2;
  reconsider g=(f qua Function)" as Function of TOP-REAL 2,TOP-REAL 2 by A1,A2
  ,FUNCT_2:31;
A4: dom f=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
  for p being Point of TOP-REAL 2, V being Subset of TOP-REAL 2 st g.p in
V & V is open ex W being Subset of TOP-REAL 2 st p in W & W is open & g.:W c= V
  proof
    let p be Point of TOP-REAL 2, V be Subset of TOP-REAL 2;
    assume that
A5: g.p in V and
A6: V is open;
    consider K being non empty compact Subset of TOP-REAL 2 such that
A7: K = f.:K and
A8: ex V2 being Subset of TOP-REAL 2 st g.p in V2 & V2 is open & V2 c=
    K & f.(g.p) in V2 by A3;
    consider V2 being Subset of TOP-REAL 2 such that
A9: g.p in V2 and
A10: V2 is open and
A11: V2 c= K and
A12: f.(g.p) in V2 by A8;
A13: dom (f|K)=dom f /\ K by RELAT_1:90
      .=K by A4,XBOOLE_1:28;
A14: g.p in V /\ V2 by A5,A9,XBOOLE_0:def 4;
    the carrier of ((TOP-REAL 2)|K)=K by PRE_TOPC:29;
    then reconsider R=V /\ V2 /\ K as Subset of (TOP-REAL 2)|K by XBOOLE_1:17;
A15: R=V /\ V2 /\ [#]((TOP-REAL 2)|K) by PRE_TOPC:def 10;
    V /\ V2 is open by A6,A10,TOPS_1:38;
    then
A16: R is open by A15,TOPS_2:32;
A17: p in V2 by A1,A2,A12,FUNCT_1:57;
    then reconsider q=p as Point of ((TOP-REAL 2)|K) by A11,PRE_TOPC:29;
A18: rng (f|K) c= the carrier of TOP-REAL 2;
    dom (f|K)=dom f /\ K by RELAT_1:90
      .=(the carrier of TOP-REAL 2)/\ K by FUNCT_2:def 1
      .=K by XBOOLE_1:28
      .=the carrier of ((TOP-REAL 2)|K) by PRE_TOPC:29;
    then reconsider h=f|K as Function of (TOP-REAL 2)|K,TOP-REAL 2 by A18,
    FUNCT_2:4;
A19: h is one-to-one by A1,FUNCT_1:84;
A20: K=(f|K).:K by A7,RELAT_1:162
      .=rng (f|K) by A13,RELAT_1:146;
    then consider f1 being Function of (TOP-REAL 2)|K,(TOP-REAL 2)|K such that
A21: h=f1 and
A22: f1 is being_homeomorphism by A1,A19,JGRAPH_1:64,TOPMETR:10;
A23: rng f1=[#]((TOP-REAL 2)|K) by A22,TOPS_2:def 5;
    dom ((f1 qua Function)")=rng f1 & rng ((f1 qua Function)")=dom f1 by
    A19,A21,FUNCT_1:54,55;
    then reconsider
    g1=(f1 qua Function)" as Function of (TOP-REAL 2)|K,(TOP-REAL 2
    )|K by A23,FUNCT_2:4;
    g1=f1" by A19,A21,A23,TOPS_2:def 4;
    then
A24: g1 is continuous by A22,TOPS_2:def 5;
A25: f1.(g.p)=f.(g.p) by A9,A11,A21,FUNCT_1:72
      .=p by A1,A2,FUNCT_1:57;
A26: dom f1=dom f /\ K by A21,RELAT_1:90
      .=K by A4,XBOOLE_1:28;
    rng f1=dom ((f1 qua Function)") by A19,A21,FUNCT_1:55;
    then
A27: ((f1 qua Function)").p in rng ((f1 qua Function)") by A11,A17,A20,A21
    ,FUNCT_1:12;
A28: rng ((f1 qua Function)")=dom f1 by A19,A21,FUNCT_1:55;
    f1.((f1 qua Function)".p)=p by A11,A17,A19,A20,A21,FUNCT_1:57;
    then ((f1 qua Function)").p=g.p by A8,A19,A21,
    A25,A26,A28,A27, FUNCT_1
    :def 8;
    then ((f1 qua Function)").p in R by A9,A11,A14,XBOOLE_0:def 4;
    then consider W3 being Subset of (TOP-REAL 2)|K such that
A29: q in W3 and
A30: W3 is open and
A31: ((f1 qua Function)").:W3 c= R by A16,A24,JGRAPH_2:20;
    R=V /\ (V2 /\ K) by XBOOLE_1:16;
    then
A32: R c= V by XBOOLE_1:17;
    consider W5 being Subset of TOP-REAL 2 such that
A33: W5 is open and
A34: W3=W5 /\ [#]((TOP-REAL 2)|K) by A30,TOPS_2:32;
    reconsider W4=W5 /\ V2 as Subset of TOP-REAL 2;
    p in W5 by A29,A34,XBOOLE_0:def 4;
    then
A35: p in W4 by A17,XBOOLE_0:def 4;
A36: dom f1=the carrier of (TOP-REAL 2)|K by FUNCT_2:def 1;
A37: ((f qua Function)").:W3 c= R
    proof
      let y be set;
      assume
      y in ((f qua Function)").:W3;
      then consider x being set such that
A38:  x in dom ((f qua Function)") and
A39:  x in W3 and
A40:  y=((f qua Function)").x by FUNCT_1:def 12;
A41:  x in rng f by A1,A38,FUNCT_1:55;
      then
A42:  y in dom f by A1,A40,FUNCT_1:54;
A43:  f.y=x by A1,A40,A41,FUNCT_1:54;
      the carrier of (TOP-REAL 2)|K=K by PRE_TOPC:29;
      then ex z2 being set st z2 in dom f & z2 in K & f.y=f.z2 by A7,A39,A43,
      FUNCT_1:def 12;
      then
A44:  y in K by A1,A42,FUNCT_1:def 8;
      then
A45:  y in the carrier of ((TOP-REAL 2)|K) by PRE_TOPC:29;
A46:  dom ((f1 qua Function)")=the carrier of (TOP-REAL 2)|K by A19,A21,
      A23, FUNCT_1:55;
      f1.y=x by A21,A43,A44,FUNCT_1:72;
      then y=((f1 qua Function)").x by A19,A21,A36,A45,FUNCT_1:54;
      then y in ((f1 qua Function)").:W3 by A39,A46,FUNCT_1:def 12;
      hence thesis by A31;
    end;
    W4=W5 /\ (V2 /\ K) by A11,XBOOLE_1:28
      .=W5 /\ K /\ V2 by XBOOLE_1:16
      .=W3 /\ V2 by A34,PRE_TOPC:def 10;
    then
A47: g.:W4 c= g.:W3 /\ g.:V2 by RELAT_1:154;
    g.:W3 /\ g.:V2 c= g.:W3 by XBOOLE_1:17;
    then g.:W4 c= g.:W3 by A47,XBOOLE_1:1;
    then
A48: g.:W4 c= R by A37,XBOOLE_1:1;
    W4 is open by A10,A33,TOPS_1:38;
    hence thesis by A35,A48,A32,XBOOLE_1:1;
  end;
  then
A49: g is continuous by JGRAPH_2:20;
  g=f" by A1,A2,TOPS_2:def 4;
  hence thesis by A1,A2,A4,A49,TOPS_2:def 5;
end;

theorem Th9:
  for X being non empty TopSpace, f1,f2 being Function of X,R^1,a,b
being real number st f1 is continuous & f2 is continuous & b<>0 & (for q being
  Point of X holds f2.q<>0) holds ex g being Function of X,R^1 st (for p being
Point of X,r1,r2 being real number st f1.p=r1 & f2.p=r2 holds g.p=(r1/r2-a)/b)
  & g is continuous
proof
  let X be non empty TopSpace, f1,f2 be Function of X,R^1,a,b be real number;
  assume that
A1: f1 is continuous & f2 is continuous and
A2: b<>0 and
A3: for q being Point of X holds f2.q<>0;
  consider g3 being Function of X,R^1 such that
A4: for p being Point of X,r1,r0 being real number st f1.p=r1 & f2.p=r0
  holds g3.p=r1/r0 and
A5: g3 is continuous by A1,A3,JGRAPH_2:37;
  consider g1 being Function of X,R^1 such that
A6: for p being Point of X holds g1.p=b & g1 is continuous by JGRAPH_2:
  30;
  consider g2 being Function of X,R^1 such that
A7: for p being Point of X holds g2.p=a & g2 is continuous by JGRAPH_2:
  30;
  consider g4 being Function of X,R^1 such that
A8: for p being Point of X,r1,r0 being real number st g3.p=r1 & g2.p=r0
  holds g4.p=r1-r0 and
A9: g4 is continuous by A7,A5,JGRAPH_2:31;
  for q being Point of X holds g1.q<>0 by A2,A6;
  then consider g5 being Function of X,R^1 such that
A10: for p being Point of X,r1,r0 being real number st g4.p=r1 & g1.p=r0
  holds g5.p=r1/r0 and
A11: g5 is continuous by A6,A9,JGRAPH_2:37;
  for p being Point of X,r1,r2 being real number st f1.p=r1 & f2.p=r2
  holds g5.p=(r1/r2-a)/b
  proof
    let p be Point of X,r1,r2 be real number;
    set r8=r1/r2;
A12: g1.p=b by A6;
    assume
    f1.p=r1 & f2.p=r2;
    then
A13: g3.p=r8 by A4;
    g2.p=a by A7;
    then g4.p=r8-a by A8,A13;
    hence thesis by A10,A12;
  end;
  hence thesis by A11;
end;

theorem Th10:
  for X being non empty TopSpace, f1,f2 being Function of X,R^1,a,
b being Real st f1 is continuous & f2 is continuous & b<>0 & (for q being Point
of X holds f2.q<>0) holds ex g being Function of X,R^1 st (for p being Point of
  X,r1,r2 being Real st f1.p=r1 & f2.p=r2 holds g.p=r2*((r1/r2-a)/b)) & g is
  continuous
proof
  let X be non empty TopSpace, f1,f2 be Function of X,R^1,a,b be Real;
  assume that
A1: f1 is continuous and
A2: f2 is continuous and
A3: b<>0 and
A4: for q being Point of X holds f2.q<>0;
  consider g3 being Function of X,R^1 such that
A5: for p being Point of X,r1,r0 being real number st f1.p=r1 & f2.p=r0
  holds g3.p=r1/r0 and
A6: g3 is continuous by A1,A2,A4,JGRAPH_2:37;
  consider g1 being Function of X,R^1 such that
A7: for p being Point of X holds g1.p=b & g1 is continuous by JGRAPH_2:
  30;
  consider g2 being Function of X,R^1 such that
A8: for p being Point of X holds g2.p=a & g2 is continuous by JGRAPH_2:
  30;
  consider g4 being Function of X,R^1 such that
A9: for p being Point of X,r1,r0 being real number st g3.p=r1 & g2.p=r0
  holds g4.p=r1-r0 and
A10: g4 is continuous by A8,A6,JGRAPH_2:31;
  for q being Point of X holds g1.q<>0 by A3,A7;
  then consider g5 being Function of X,R^1 such that
A11: for p being Point of X,r1,r0 being real number st g4.p=r1 & g1.p=r0
  holds g5.p=r1/r0 and
A12: g5 is continuous by A7,A10,JGRAPH_2:37;
  consider g6 being Function of X,R^1 such that
A13: for p being Point of X,r1,r0 being real number st f2.p=r1 & g5.p=r0
  holds g6.p=r1*r0 and
A14: g6 is continuous by A2,A12,JGRAPH_2:35;
  for p being Point of X,r1,r2 being Real st f1.p=r1 & f2.p=r2 holds g6.p
  =r2*((r1/r2-a)/b)
  proof
    let p be Point of X,r1,r2 be Real;
    assume that
A15: f1.p=r1 and
A16: f2.p=r2;
A17: g2.p=a by A8;
    set r8=r1/r2;
A18: g1.p=b by A7;
    g3.p=r8 by A5,A15,A16;
    then g4.p=r8-a by A9,A17;
    then g5.p=(r1/r2-a)/b by A11,A18;
    hence thesis by A13,A16;
  end;
  hence thesis by A14;
end;

theorem Th11:
  for X being non empty TopSpace, f1 being Function of X,R^1 st f1
is continuous holds ex g being Function of X,R^1 st (for p being Point of X,r1
  being real number st f1.p=r1 holds g.p=r1^2) & g is continuous
proof
  let X be non empty TopSpace, f1 be Function of X,R^1;
  assume
  f1 is continuous;
  then consider g1 being Function of X,R^1 such that
A1: for p being Point of X,r1 being real number st f1.p=r1 holds g1.p=r1
  *r1 and
A2: g1 is continuous by JGRAPH_2:32;
  for p being Point of X,r1 being real number st f1.p=r1 holds g1.p=r1^2
  by A1;
  hence thesis by A2;
end;

theorem Th12:
  for X being non empty TopSpace, f1 being Function of X,R^1 st f1
is continuous holds ex g being Function of X,R^1 st (for p being Point of X,r1
  being real number st f1.p=r1 holds g.p=abs(r1)) & g is continuous
proof
  let X be non empty TopSpace, f1 be Function of X,R^1;
  assume
  f1 is continuous;
  then consider g1 being Function of X,R^1 such that
A1: for p being Point of X,r1 being real number st f1.p=r1 holds g1.p=r1
  ^2 and
A2: g1 is continuous by Th11;
  for q being Point of X ex r being real number st g1.q=r & r>=0
  proof
    let q be Point of X;
    reconsider r11=f1.q as Real by TOPMETR:24;
    g1.q=r11^2 by A1;
    hence thesis by XREAL_1:65;
  end;
  then consider g2 being Function of X,R^1 such that
A3: for p being Point of X,r1 being real number st g1.p=r1 holds g2.p=
  sqrt( r1) and
A4: g2 is continuous by A2,JGRAPH_3:15;
  for p being Point of X,r1 being real number st f1.p=r1 holds g2.p=abs(r1
  )
  proof
    let p be Point of X,r1 be real number;
    assume
    f1.p=r1;
    then g1.p=r1^2 by A1;
    then g2.p=sqrt(r1^2) by A3
      .=abs(r1) by COMPLEX1:158;
    hence thesis;
  end;
  hence thesis by A4;
end;

theorem Th13:
  for X being non empty TopSpace, f1 being Function of X,R^1 st f1
is continuous holds ex g being Function of X,R^1 st (for p being Point of X,r1
  being real number st f1.p=r1 holds g.p=-r1) & g is continuous
proof
  let X be non empty TopSpace, f1 be Function of X,R^1;
  consider g1 being Function of X,R^1 such that
A1: for p being Point of X holds g1.p=0 and
A2: g1 is continuous by JGRAPH_2:30;
  assume
  f1 is continuous;
  then consider g2 being Function of X,R^1 such that
A3: for p being Point of X,r1,r2 being real number st g1.p=r1 & f1.p=r2
  holds g2.p=r1-r2 and
A4: g2 is continuous by A2,JGRAPH_2:31;
  for p being Point of X,r1 being real number st f1.p=r1 holds g2.p=-r1
  proof
    let p be Point of X,r1 be real number;
    assume
A5: f1.p=r1;
    g1.p=0 by A1;
    then g2.p=0-r1 by A3,A5;
    hence thesis;
  end;
  hence thesis by A4;
end;

theorem Th14:
  for X being non empty TopSpace, f1,f2 being Function of X,R^1,a,
  b being real number st f1 is continuous & f2 is continuous & b<>0 & (for q
  being Point of X holds f2.q<>0) holds ex g being Function of X,R^1 st (for p
being Point of X,r1,r2 being real number st f1.p=r1 & f2.p=r2 holds g.p= r2*(-
  sqrt(abs(1-((r1/r2-a)/b)^2)))) & g is continuous
proof
  let X be non empty TopSpace, f1,f2 be Function of X,R^1,a,b be real number;
  assume that
A1: f1 is continuous and
A2: f2 is continuous and
A3: b<>0 & for q being Point of X holds f2.q<>0;
  consider g1 being Function of X,R^1 such that
A4: for p being Point of X,r1,r2 being real number st f1.p=r1 & f2.p=r2
  holds g1.p=(r1/r2-a)/b and
A5: g1 is continuous by A1,A2,A3,Th9;
  consider g2 being Function of X,R^1 such that
A6: for p being Point of X,s being real number st g1.p=s holds g2.p=s^2 and
A7: g2 is continuous by A5,Th11;
  consider g0 being Function of X,R^1 such that
A8: for p being Point of X holds g0.p=1 and
A9: g0 is continuous by JGRAPH_2:30;
  consider g3 being Function of X,R^1 such that
A10: for p being Point of X,s,t being real number st g0.p=s & g2.p=t
  holds g3.p=s-t and
A11: g3 is continuous by A7,A9,JGRAPH_2:31;
  consider g4 being Function of X,R^1 such that
A12: for p being Point of X,s being real number st g3.p=s holds g4.p=abs
  s and
A13: g4 is continuous by A11,Th12;
  for q being Point of X ex r being real number st g4.q=r & r>=0
  proof
    let q be Point of X;
    reconsider s=g3.q as Real by TOPMETR:24;
    g4.q=abs s by A12;
    hence thesis by COMPLEX1:132;
  end;
  then consider g5 being Function of X,R^1 such that
A14: for p being Point of X,s being real number st g4.p=s holds g5.p=
  sqrt(s ) and
A15: g5 is continuous by A13,JGRAPH_3:15;
  consider g6 being Function of X,R^1 such that
A16: for p being Point of X,s being real number st g5.p=s holds g6.p=-s and
A17: g6 is continuous by A15,Th13;
  consider g7 being Function of X,R^1 such that
A18: for p being Point of X,r1,r0 being real number st f2.p=r1 & g6.p=r0
  holds g7.p=r1*r0 and
A19: g7 is continuous by A2,A17,JGRAPH_2:35;
  for p being Point of X,r1,r2 being real number st f1.p=r1 & f2.p=r2
  holds g7.p= r2*(-sqrt(abs(1-((r1/r2-a)/b)^2)))
  proof
    let p be Point of X,r1,r2 be real number;
    assume that
A20: f1.p=r1 and
A21: f2.p=r2;
A22: g0.p=1 by A8;
    g1.p=(r1/r2-a)/b by A4,A20,A21;
    then g2.p=((r1/r2-a)/b)^2 by A6;
    then g3.p=1-((r1/r2-a)/b)^2 by A10,A22;
    then g4.p= abs(1-((r1/r2-a)/b)^2) by A12;
    then g5.p=sqrt(abs(1-((r1/r2-a)/b)^2)) by A14;
    then g6.p= -sqrt(abs(1-((r1/r2-a)/b)^2)) by A16;
    hence thesis by A18,A21;
  end;
  hence thesis by A19;
end;

theorem Th15:
  for X being non empty TopSpace, f1,f2 being Function of X,R^1,a,
  b being real number st f1 is continuous & f2 is continuous & b<>0 & (for q
  being Point of X holds f2.q<>0) holds ex g being Function of X,R^1 st (for p
  being Point of X,r1,r2 being real number st f1.p=r1 & f2.p=r2 holds g.p= r2*(
  sqrt(abs(1-((r1/r2-a)/b)^2)))) & g is continuous
proof
  let X be non empty TopSpace, f1,f2 be Function of X,R^1,a,b be real number;
  assume that
A1: f1 is continuous and
A2: f2 is continuous and
A3: b<>0 & for q being Point of X holds f2.q<>0;
  consider g1 being Function of X,R^1 such that
A4: for p being Point of X,r1,r2 being real number st f1.p=r1 & f2.p=r2
  holds g1.p=(r1/r2-a)/b and
A5: g1 is continuous by A1,A2,A3,Th9;
  consider g2 being Function of X,R^1 such that
A6: for p being Point of X,s being real number st g1.p=s holds g2.p=s^2 and
A7: g2 is continuous by A5,Th11;
  consider g0 being Function of X,R^1 such that
A8: for p being Point of X holds g0.p=1 and
A9: g0 is continuous by JGRAPH_2:30;
  consider g3 being Function of X,R^1 such that
A10: for p being Point of X,s,t being real number st g0.p=s & g2.p=t
  holds g3.p=s-t and
A11: g3 is continuous by A7,A9,JGRAPH_2:31;
  consider g4 being Function of X,R^1 such that
A12: for p being Point of X,s being real number st g3.p=s holds g4.p=abs
  s and
A13: g4 is continuous by A11,Th12;
  for q being Point of X ex r being real number st g4.q=r & r>=0
  proof
    let q be Point of X;
    reconsider s=g3.q as Real by TOPMETR:24;
    g4.q=abs s by A12;
    hence thesis by COMPLEX1:132;
  end;
  then consider g5 being Function of X,R^1 such that
A14: for p being Point of X,s being real number st g4.p=s holds g5.p=
  sqrt s and
A15: g5 is continuous by A13,JGRAPH_3:15;
  consider g7 being Function of X,R^1 such that
A16: for p being Point of X,r1,r0 being real number st f2.p=r1 & g5.p=r0
  holds g7.p=r1*r0 and
A17: g7 is continuous by A2,A15,JGRAPH_2:35;
  for p being Point of X,r1,r2 being real number st f1.p=r1 & f2.p=r2
  holds g7.p= r2*( sqrt(abs(1-((r1/r2-a)/b)^2)))
  proof
    let p be Point of X,r1,r2 be real number;
    assume that
A18: f1.p=r1 and
A19: f2.p=r2;
A20: g0.p=1 by A8;
    g1.p=(r1/r2-a)/b by A4,A18,A19;
    then g2.p=((r1/r2-a)/b)^2 by A6;
    then g3.p=1-((r1/r2-a)/b)^2 by A10,A20;
    then g4.p= abs(1-((r1/r2-a)/b)^2) by A12;
    then g5.p=sqrt(abs(1-((r1/r2-a)/b)^2)) by A14;
    hence thesis by A16,A19;
  end;
  hence thesis by A17;
end;

definition
  let n be Nat;
  deffunc F(Point of TOP-REAL n)=|.$1.|;
  func n NormF -> Function of TOP-REAL n, R^1 means
  :Def1:
  for q being Point of TOP-REAL n holds it.q=|.q.|;
  existence
  proof
A1: for x being Element of TOP-REAL n holds F(x) in the carrier of R^1 by
    TOPMETR:24;
    thus ex IT being Function of TOP-REAL n, R^1 st for q being Point of
    TOP-REAL n holds IT.q = F(q) from FUNCT_2:sch 8(A1);
  end;
  uniqueness
  proof
    thus for f,g being Function of TOP-REAL n, R^1 st (for q being Point of
TOP-REAL n holds f.q=F(q)) & (for q being Point of TOP-REAL n holds g.q=F(q))
    holds f=g from BINOP_2:sch 1;
  end;
end;

theorem
  for n being Nat holds dom (n NormF)=the carrier of TOP-REAL
  n & dom (n NormF)=REAL n
proof
  let n be Nat;
  thus dom (n NormF)=the carrier of TOP-REAL n by FUNCT_2:def 1;
  hence thesis by EUCLID:25;
end;

canceled 2;

theorem Th19:
  for n being Nat holds n NormF is continuous
proof
  let n be Nat;
A1: n in NAT by ORDINAL1:def 13;
  for q being Point of TOP-REAL n holds (n NormF).q=|.q.| by Def1;
  hence thesis by A1,JORDAN2C:91;
end;

registration
  let n be Nat;
  cluster n NormF -> continuous;
  coherence by Th19;
end;

theorem Th20:
  for n being Element of NAT,K0 being Subset of TOP-REAL n, f
being Function of (TOP-REAL n)|K0,R^1 st (for p being Point of (TOP-REAL n)|K0
  holds f.p=(n NormF).p) holds f is continuous
proof
  let n be Element of NAT,K0 be Subset of TOP-REAL n, f be Function of (
  TOP-REAL n)|K0,R^1;
A1: (the carrier of TOP-REAL n)/\K0=K0 by XBOOLE_1:28;
  reconsider g=(n NormF) as Function of TOP-REAL n,R^1;
  assume
  for p being Point of (TOP-REAL n)|K0 holds f.p=(n NormF).p;
  then
A2: for x being set st x in dom f holds f.x=(n NormF).x;
  dom f= the carrier of (TOP-REAL n)|K0 & the carrier of (TOP-REAL n)|K0=
  K0 by FUNCT_2:def 1,PRE_TOPC:29;
  then dom f=dom (n NormF) /\ K0 by A1,FUNCT_2:def 1;
  then f=g|K0 by A2,FUNCT_1:68;
  hence thesis by TOPMETR:10;
end;

theorem Th21:
  for n being Element of NAT,p being Point of Euclid n,r being
Real, B being Subset of TOP-REAL n st B=cl_Ball(p,r) holds B is Bounded closed
proof
  let n be Element of NAT,p be Point of Euclid n,r be Real, B be Subset of
  TOP-REAL n;
  assume
A1: B=cl_Ball(p,r);
  cl_Ball(p,r) c= Ball(p,r+1)
  proof
    let x be set;
A2: r<r+1 by XREAL_1:31;
    assume
A3: x in cl_Ball(p,r);
    then reconsider q=x as Point of Euclid n;
    dist(p,q)<=r by A3,METRIC_1:13;
    then dist(p,q)<r+1 by A2,XXREAL_0:2;
    hence thesis by METRIC_1:12;
  end;
  then cl_Ball(p,r) is bounded by TBSP_1:19,21;
  hence B is Bounded by A1,JORDAN2C:def 2;
A4: the TopStruct of TOP-REAL n = TopSpaceMetr Euclid n by EUCLID:def 8;
  then reconsider BB = B as Subset of TopSpaceMetr Euclid n;
  BB is closed by A1,TOPREAL6:65;
  hence thesis by A4,PRE_TOPC:61;
end;

theorem Th22:
  for p being Point of Euclid 2,r being Real, B being Subset of
  TOP-REAL 2 st B=cl_Ball(p,r) holds B is compact
proof
  let p be Point of Euclid 2,r be Real, B be Subset of TOP-REAL 2;
  assume
  B=cl_Ball(p,r);
  then B is Bounded closed by Th21;
  hence thesis by TOPREAL6:88;
end;

begin :: Fan Morphism for West

definition
  let s be real number, q be Point of TOP-REAL 2;
  func FanW(s,q) -> Point of TOP-REAL 2 equals
  :Def2:
  |.q.|*|[-sqrt(1-((q`2/|.
q.|-s)/(1-s))^2), (q`2/|.q.|-s)/(1-s)]| if q`2/|.q.|>=s & q`1<0, |.q.|*|[-sqrt(
  1-((q`2/|.q.|-s)/(1+s))^2), (q`2/|.q.|-s)/(1+s)]| if q`2/|.q.|<s & q`1<0
  otherwise q;
  correctness;
end;

definition
  let s be real number;
  func s-FanMorphW -> Function of TOP-REAL 2, TOP-REAL 2 means
  :Def3:
  for q
  being Point of TOP-REAL 2 holds it.q=FanW(s,q);
  existence
  proof
    deffunc F(Point of TOP-REAL 2)=FanW(s,$1);
    thus ex IT being Function of TOP-REAL 2, TOP-REAL 2 st for q being Point
    of TOP-REAL 2 holds IT.q=F(q) from FUNCT_2:sch 4;
  end;
  uniqueness
  proof
    deffunc F(Point of TOP-REAL 2)=FanW(s,$1);
    thus for f,g being Function of TOP-REAL 2, TOP-REAL 2 st (for q being
Point of TOP-REAL 2 holds f.q=F(q)) & (for q being Point of TOP-REAL 2 holds g.
    q=F(q)) holds f=g from BINOP_2:sch 1;
  end;
end;

theorem Th23:
  for sn being real number holds (q`2/|.q.|>=sn & q`1<0 implies sn
-FanMorphW.q= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)), |.q.|* ((q`2/|.q.|
  -sn)/(1-sn))]|) & (q`1>=0 implies sn-FanMorphW.q=q)
proof
  let sn be real number;
  hereby
    assume
    q`2/|.q.|>=sn & q`1<0;
    then
    FanW(sn,q)= |.q.|*|[-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2), (q`2/|.q.|-sn)
    /(1-sn)]| by Def2
      .= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)), |.q.|* ((q`2/|.q.|-
    sn)/(1-sn))]| by EUCLID:62;
    hence
    sn-FanMorphW.q= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)), |.q.|*
    ((q`2/|.q.|-sn)/(1-sn))]| by Def3;
  end;
  assume
A1: q`1>=0;
  sn-FanMorphW.q=FanW(sn,q) by Def3;
  hence thesis by A1,Def2;
end;

theorem Th24:
  for sn being Real st q`2/|.q.|<=sn & q`1<0 holds sn-FanMorphW.q=
|[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)), |.q.|*((q`2/|.q.|-sn)/(1+sn))]|
proof
  let sn be Real;
  assume that
A1: q`2/|.q.|<=sn and
A2: q`1<0;
  per cases by A1,XXREAL_0:1;
  suppose
    q`2/|.q.|<sn;
    then
    FanW(sn,q)= |.q.|*|[-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2), (q`2/|.q.|-sn)
    /(1+sn)]| by A2,Def2
      .= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)), |.q.|* ((q`2/|.q.|-
    sn)/(1+sn))]| by EUCLID:62;
    hence thesis by Def3;
  end;
  suppose
A3: q`2/|.q.|=sn;
    then (q`2/|.q.|-sn)/(1-sn)=0;
    hence thesis by A2,A3,Th23;
  end;
end;

theorem Th25:
  for sn being Real st -1<sn & sn<1 holds (q`2/|.q.|>=sn & q`1<=0
& q<>0.TOP-REAL 2 implies sn-FanMorphW.q= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-
  sn))^2)), |.q.|* ((q`2/|.q.|-sn)/(1-sn))]|) & (q`2/|.q.|<=sn & q`1<=0 & q<>0.
TOP-REAL 2 implies sn-FanMorphW.q= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)
  ), |.q.|*((q`2/|.q.|-sn)/(1+sn))]|)
proof
  let sn be Real;
  assume that
A1: -1<sn and
A2: sn<1;
  per cases;
  suppose
A3: q`2/|.q.|>=sn & q`1<=0 & q<>0.TOP-REAL 2;
    per cases;
    suppose
A4:   q`1<0;
      then
      FanW(sn,q)= |.q.|*|[-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2), (q`2/|.q.|-
      sn)/(1-sn)]| by A3,Def2
        .= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)), |.q.|* ((q`2/|.q.|
      -sn)/(1-sn))]| by EUCLID:62;
      hence thesis by A4,Def3,Th24;
    end;
    suppose
A5:   q`1>=0;
      then
A6:   sn-FanMorphW.q=q by Th23;
A7:   (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
A8:   1-sn>0 by A2,XREAL_1:151;
A9:   q`1=0 by A3,A5;
      |.q.|<>0 by A3,TOPRNS_1:25;
      then |.q.|^2>0 by SQUARE_1:74;
      then (q`2)^2/|.q.|^2=1^2 by A7,A9,XCMPLX_1:60;
      then ((q`2)/|.q.|)^2=1^2 by XCMPLX_1:77;
      then
A10:  sqrt(((q`2)/|.q.|)^2)=1 by SQUARE_1:89;
A11:  now
        assume
        q`2<0;
        then -((q`2)/|.q.|)=1 by A10,SQUARE_1:90;
        hence contradiction by A1,A3;
      end;
      sqrt((|.q.|)^2)=|.q.| by SQUARE_1:89;
      then
A12:  |.q.|=q`2 by A7,A9,A11,SQUARE_1:89;
      then 1=q`2/|.q.| by A3,TOPRNS_1:25,XCMPLX_1:60;
      then (q`2/|.q.|-sn)/(1-sn)=1 by A8,XCMPLX_1:60;
      hence thesis by A2,A6,A9,A12,EUCLID:57,SQUARE_1:82,TOPRNS_1:25 ,
      XCMPLX_1:60;
    end;
  end;
  suppose
A13: q`2/|.q.|<=sn & q`1<=0 & q<>0.TOP-REAL 2;
    per cases;
    suppose
      q`1<0;
      hence thesis by Th23,Th24;
    end;
    suppose
A14:  q`1>=0;
A15:  1+sn>0 by A1,XREAL_1:150;
A16:  |.q.|<>0 by A13,TOPRNS_1:25;
A17:  q`1=0 by A13,A14;
      |.q.|>0 & 1>q`2/|.q.| by A2,A13,Lm1,XXREAL_0:2;
      then 1 *(|.q.|)>q`2/|.q.|*(|.q.|) by XREAL_1:70;
      then
A18:  (|.q.|)^2 =(q`1)^2+(q`2)^2 & (|.q.|)>q`2 by A13,JGRAPH_3:10,
      TOPRNS_1:25 ,XCMPLX_1:88;
      then
A19:  q`2= -(|.q.|) by A17,SQUARE_1:109;
      then -1=q`2/|.q.| by A13,TOPRNS_1:25,XCMPLX_1:198;
      then
A20:  (q`2/|.q.|-sn)/(1+sn) =(-(1+sn))/(1+sn)
        .=-1 by A15,XCMPLX_1:198;
      |.q.|=-q`2 by A17,A18,SQUARE_1:109;
      then |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)), |.q.|* ((q`2/|.q.|-
      sn)/(1+sn))]| =q by A17,A20,EUCLID:57,SQUARE_1:82;
      hence thesis by A1,A14,A16,A19,Th23,XCMPLX_1:198;
    end;
  end;
  suppose
    q`1>0 or q=0.TOP-REAL 2;
    hence thesis;
  end;
end;

Lm2: for K being non empty Subset of TOP-REAL 2 holds proj1|K is continuous
Function of (TOP-REAL 2)|K,R^1 & for q being Point of (TOP-REAL 2)|K holds (
proj1|K).q=proj1.q

proof
  let K be non empty Subset of TOP-REAL 2;
  reconsider g2=proj1|K as Function of (TOP-REAL 2)|K,R^1 by TOPMETR:24;
A1: the carrier of (TOP-REAL 2)|K=K by PRE_TOPC:29;
  for q being Point of (TOP-REAL 2)|K holds g2.q=proj1.q
  proof
    let q be Point of (TOP-REAL 2)|K;

    q in the carrier of (TOP-REAL 2)|K & dom proj1=the carrier of TOP-REAL
    2 by FUNCT_2:def 1;

    then q in dom proj1 /\ K by A1,XBOOLE_0:def 4;
    hence thesis by FUNCT_1:71;
  end;
  hence thesis by JGRAPH_2:39;
end;

Lm3: for K being non empty Subset of TOP-REAL 2 holds proj2|K is continuous
Function of (TOP-REAL 2)|K,R^1 & for q being Point of (TOP-REAL 2)|K holds (
proj2|K).q=proj2.q

proof
  let K be non empty Subset of TOP-REAL 2;
  reconsider g2=proj2|K as Function of (TOP-REAL 2)|K,R^1 by TOPMETR:24;
A1: the carrier of (TOP-REAL 2)|K=K by PRE_TOPC:29;
  for q being Point of (TOP-REAL 2)|K holds g2.q=proj2.q
  proof
    let q be Point of (TOP-REAL 2)|K;

    q in the carrier of (TOP-REAL 2)|K & dom proj2=the carrier of TOP-REAL
    2 by FUNCT_2:def 1;

    then q in dom proj2 /\ K by A1,XBOOLE_0:def 4;
    hence thesis by FUNCT_1:71;
  end;
  hence thesis by JGRAPH_2:40;
end;

Lm4: dom (2 NormF)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;

Lm5: for K being non empty Subset of TOP-REAL 2 holds (2 NormF)|K is
continuous Function of (TOP-REAL 2)|K,R^1 & for q being Point of (TOP-REAL 2)|K
holds ((2 NormF)|K).q=(2 NormF).q

proof
  let K1 be non empty Subset of TOP-REAL 2;
A1: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;

  then reconsider g1=(2 NormF)|K1 as Function of (TOP-REAL 2)|K1,R^1 by
  FUNCT_2:
  38;

  for q being Point of (TOP-REAL 2)|K1 holds g1.q=(2 NormF).q
  proof
    let q be Point of (TOP-REAL 2)|K1;
    q in the carrier of (TOP-REAL 2)|K1;
    then q in dom (2 NormF) /\ K1 by A1,Lm4,XBOOLE_0:def 4;
    hence thesis by FUNCT_1:71;
  end;
  hence thesis by Th20;
end;

Lm6: for K1 be non empty Subset of TOP-REAL 2, g1 be Function of (TOP-REAL 2)|
K1,R^1 st g1=(2 NormF)|K1 & (for q being Point of TOP-REAL 2 st q in the
carrier of (TOP-REAL 2)|K1 holds q<>0.TOP-REAL 2) holds for q being Point of (
TOP-REAL 2)|K1 holds g1.q<>0

proof

  let K1 be non empty Subset of TOP-REAL 2, g1 be Function of (TOP-REAL 2)|K1,
  R^1;

  assume that
A1: g1=(2 NormF)|K1 and

A2: for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)
  |K1 holds q<>0.TOP-REAL 2;

  let q be Point of (TOP-REAL 2)|K1;

  the carrier of (TOP-REAL 2)|K1=K1 & q in the carrier of (TOP-REAL 2)|K1
  by PRE_TOPC:29;

  then reconsider q2=q as Point of TOP-REAL 2;
  g1.q=(2 NormF).q by A1,Lm5
    .= |.q2.| by Def1;
  hence thesis by A2,TOPRNS_1:25;
end;

theorem Th26:
  for sn being Real,K1 being non empty Subset of TOP-REAL 2, f
being Function of (TOP-REAL 2)|K1,R^1 st sn<1 & (for p being Point of (TOP-REAL
2) st p in the carrier of (TOP-REAL 2)|K1 holds f.p=|.p.|* ((p`2/|.p.|-sn)/(1-
sn))) & (for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)|K1
  holds q`1<=0 & q<>0.TOP-REAL 2) holds f is continuous
proof
  let sn be Real,K1 be non empty Subset of TOP-REAL 2, f be Function of (
  TOP-REAL 2)|K1,R^1;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by
  Lm5;
  set a=sn, b=1-sn;
  reconsider g2=proj2|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm3;
  assume that
A1: sn<1 and
A2: for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)
  |K1 holds f.p=|.p.|* ((p`2/|.p.|-sn)/(1-sn)) and
A3: for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)
  |K1 holds q`1<=0 & q<>0.TOP-REAL 2;
  for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)|K1
  holds q<>0.TOP-REAL 2 by A3;
  then
A4: for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm6;
  b>0 by A1,XREAL_1:151;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
A5: for q being Point of (TOP-REAL 2)|K1,r1,r2 being Real st g2.q=r1 &
  g1.q =r2 holds g3.q=r2*((r1/r2-a)/b) and
A6: g3 is continuous by A4,Th10;
A7: dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then
A8: dom f=dom g3 by FUNCT_2:def 1;
  for x being set st x in dom f holds f.x=g3.x
  proof
    let x be set;
    assume
A9: x in dom f;
    then reconsider s=x as Point of (TOP-REAL 2)|K1;
    x in K1 by A7,A8,A9,PRE_TOPC:29;
    then reconsider r=x as Point of TOP-REAL 2;
A10: proj2.r=r`2 & (2 NormF).r=|.r.| by Def1,PSCOMP_1:def 29;
A11: g2.s=proj2.s & g1.s=(2 NormF).s by Lm3,Lm5;
    f.r=(|.r.|)* ((r`2/|.r.|-sn)/(1-sn)) by A2,A9;
    hence thesis by A5,A11,A10;
  end;
  hence thesis by A6,A8,FUNCT_1:9;
end;

theorem Th27:
  for sn being Real,K1 being non empty Subset of TOP-REAL 2, f
  being Function of (TOP-REAL 2)|K1,R^1 st -1<sn & (for p being Point of (
TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1 holds f.p=|.p.|* ((p`2/|.p.|
  -sn)/(1+sn))) & (for q being Point of TOP-REAL 2 st q in the carrier of (
  TOP-REAL 2)|K1 holds q`1<=0 & q<>0.TOP-REAL 2) holds f is continuous
proof
  let sn be Real,K1 be non empty Subset of TOP-REAL 2, f be Function of (
  TOP-REAL 2)|K1,R^1;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by
  Lm5;
  set a=sn, b=1+sn;
  reconsider g2=proj2|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm3;
  assume that
A1: -1<sn and
A2: for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2
  )|K1 holds f.p=|.p.|* ((p`2/|.p.|-sn)/(1+sn)) and
A3: for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)
  |K1 holds q`1<=0 & q<>0.TOP-REAL 2;
  for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)|K1
  holds q<>0.TOP-REAL 2 by A3;
  then
A4: for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm6;
  1+sn>0 by A1,XREAL_1:150;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
A5: for q being Point of (TOP-REAL 2)|K1,r1,r2 being Real st g2.q=r1 &
  g1.q =r2 holds g3.q=r2*((r1/r2-a)/b) and
A6: g3 is continuous by A4,Th10;
A7: dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
A8: for x being set st x in dom f holds f.x=g3.x
  proof
    let x be set;
    assume
A9: x in dom f;
    then reconsider s=x as Point of (TOP-REAL 2)|K1;
    x in dom g3 by A7,A9;
    then x in K1 by A7,PRE_TOPC:29;
    then reconsider r=x as Point of TOP-REAL 2;
A10: proj2.r=r`2 & (2 NormF).r=|.r.| by Def1,PSCOMP_1:def 29;
A11: g2.s=proj2.s & g1.s=(2 NormF).s by Lm3,Lm5;
    f.r=(|.r.|)* ((r`2/|.r.|-sn)/(1+sn)) by A2,A9;
    hence thesis by A5,A11,A10;
  end;
  dom f=dom g3 by A7,FUNCT_2:def 1;
  hence thesis by A6,A8,FUNCT_1:9;
end;

theorem Th28:
  for sn being Real,K1 being non empty Subset of TOP-REAL 2, f
being Function of (TOP-REAL 2)|K1,R^1 st sn<1 & (for p being Point of (TOP-REAL
2) st p in the carrier of (TOP-REAL 2)|K1 holds f.p=|.p.|*(-sqrt(1-((p`2/|.p.|-
  sn)/(1-sn))^2))) & (for q being Point of TOP-REAL 2 st q in the carrier of (
  TOP-REAL 2)|K1 holds q`1<=0 & q`2/|.q.|>=sn & q<>0.TOP-REAL 2) holds f is
  continuous
proof
  let sn be Real,K1 be non empty Subset of TOP-REAL 2, f be Function of (
  TOP-REAL 2)|K1,R^1;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by
  Lm5;
  set a=sn, b=1-sn;
  reconsider g2=proj2|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm3;
  assume that
A1: sn<1 and
A2: for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)
  |K1 holds f.p=|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)) and
A3: for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)
  |K1 holds q`1<=0 & q`2/|.q.|>=sn & q<>0.TOP-REAL 2;
  for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)|K1
  holds q<>0.TOP-REAL 2 by A3;
  then
A4: for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm6;
  b>0 by A1,XREAL_1:151;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
A5: for q being Point of (TOP-REAL 2)|K1,r1,r2 being real number st g2.q
  =r1 & g1.q=r2 holds g3.q=r2*(-sqrt(abs(1-((r1/r2-a)/b)^2))) and
A6: g3 is continuous by A4,Th14;
A7: dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then
A8: dom f=dom g3 by FUNCT_2:def 1;
  for x being set st x in dom f holds f.x=g3.x
  proof
    let x be set;
A9: 1-sn>0 by A1,XREAL_1:151;
    assume
A10: x in dom f;
    then x in K1 by A7,A8,PRE_TOPC:29;
    then reconsider r=x as Point of TOP-REAL 2;
A11: |.r.|<>0 by A3,A10,TOPRNS_1:25;
    |.r.|^2=(r`1)^2+(r`2)^2 by JGRAPH_3:10;
    then
A12: ((r`2) -(|.r.|))*((r`2)+|.r.|) =-(r`1)^2;
    (r`1)^2>=0 by XREAL_1:65;
    then r`2<= |.r.| by A12,XREAL_1:95;
    then r`2/|.r.| <= |.r.|/|.r.| by XREAL_1:74;
    then r`2/|.r.|<=1 by A11,XCMPLX_1:60;
    then
A13: r`2/|.r.|-sn<=(1-sn) by XREAL_1:11;
    reconsider s=x as Point of (TOP-REAL 2)|K1 by A10;
A14: now
      assume
      (1-sn)^2=0;
      then 1-sn+sn=0+sn by XCMPLX_1:6;
      hence contradiction by A1;
    end;
    sn-r`2/|.r.|<=0 by A3,A10,XREAL_1:49;
    then -(sn- r`2/|.r.|)>=-(1-sn) by A9,XREAL_1:26;
    then (1-sn)^2>=0 & (r`2/|.r.|-sn)^2<=(1-sn)^2 by A13,SQUARE_1:119,
    XREAL_1:65;
    then (r`2/|.r.|-sn)^2/(1-sn)^2<=(1-sn)^2/(1-sn)^2 by XREAL_1:74;
    then (r`2/|.r.|-sn)^2/(1-sn)^2<=1 by A14,XCMPLX_1:60;
    then ((r`2/|.r.|-sn)/(1-sn))^2<=1 by XCMPLX_1:77;
    then 1-((r`2/|.r.|-sn)/(1-sn))^2>=0 by XREAL_1:50;
    then abs(1-((r`2/|.r.|-sn)/(1-sn))^2) =1-((r`2/|.r.|-sn)/(1-sn))^2 by
    ABSVALUE:def 1;
    then
A15: f.r=(|.r.|)*(-sqrt(abs(1-((r`2/|.r.|-sn)/(1-sn))^2))) by A2,A10;
A16: proj2.r=r`2 & (2 NormF).r=|.r.| by Def1,PSCOMP_1:def 29;
    g2.s=proj2.s & g1.s=(2 NormF).s by Lm3,Lm5;
    hence thesis by A5,A15,A16;
  end;
  hence thesis by A6,A8,FUNCT_1:9;
end;

theorem Th29:
  for sn being Real,K1 being non empty Subset of TOP-REAL 2, f
  being Function of (TOP-REAL 2)|K1,R^1 st -1<sn & (for p being Point of (
TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1 holds f.p=|.p.|*(-sqrt(1-((p
  `2/|.p.|-sn)/(1+sn))^2))) & (for q being Point of TOP-REAL 2 st q in the
  carrier of (TOP-REAL 2)|K1 holds q`1<=0 & q`2/|.q.|<=sn & q<>0.TOP-REAL 2)
  holds f is continuous
proof
  let sn be Real,K1 be non empty Subset of TOP-REAL 2, f be Function of (
  TOP-REAL 2)|K1,R^1;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by
  Lm5;
  set a=sn, b=1+sn;
  reconsider g2=proj2|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm3;
  assume that
A1: -1<sn and
A2: for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2
  )|K1 holds f.p=|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)) and
A3: for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)
  |K1 holds q`1<=0 & q`2/|.q.|<=sn & q<>0.TOP-REAL 2;
A4: 1+sn>0 by A1,XREAL_1:150;
  for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)|K1
  holds q<>0.TOP-REAL 2 by A3;
  then for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm6;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
A5: for q being Point of (TOP-REAL 2)|K1,r1,r2 being real number st g2.q
  =r1 & g1.q=r2 holds g3.q=r2*(-sqrt(abs(1-((r1/r2-a)/b)^2))) and
A6: g3 is continuous by A4,Th14;
A7: dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then
A8: dom f=dom g3 by FUNCT_2:def 1;
  for x being set st x in dom f holds f.x=g3.x
  proof
    let x be set;
    assume
A9: x in dom f;
    then x in K1 by A7,A8,PRE_TOPC:29;
    then reconsider r=x as Point of TOP-REAL 2;
    reconsider s=x as Point of (TOP-REAL 2)|K1 by A9;
A10: (1+sn)^2>0 by A4,SQUARE_1:74;
A11: |.r.|<>0 by A3,A9,TOPRNS_1:25;
    |.r.|^2=(r`1)^2+(r`2)^2 by JGRAPH_3:10;
    then
A12: ((r`2) -(|.r.|))*((r`2)+|.r.|) =-(r`1)^2;
    (r`1)^2>=0 by XREAL_1:65;
    then -(|.r.|)<=r`2 by A12,XREAL_1:95;
    then r`2/|.r.| >= (-(|.r.|))/|.r.| by XREAL_1:74;
    then r`2/|.r.|>= -1 by A11,XCMPLX_1:198;
    then r`2/|.r.|-sn>=-1-sn by XREAL_1:11;
    then
A13: r`2/|.r.|-sn>=-(1+sn);
    sn-r`2/|.r.|>=0 by A3,A9,XREAL_1:50;
    then -(sn-r`2/|.r.|)<=-0;
    then (r`2/|.r.|-sn)^2<=(1+sn)^2 by A4,A13,SQUARE_1:119;
    then (r`2/|.r.|-sn)^2/(1+sn)^2<=(1+sn)^2/(1+sn)^2 by A4,XREAL_1:74;
    then (r`2/|.r.|-sn)^2/(1+sn)^2<=1 by A10,XCMPLX_1:60;
    then ((r`2/|.r.|-sn)/(1+sn))^2<=1 by XCMPLX_1:77;
    then 1-((r`2/|.r.|-sn)/(1+sn))^2>=0 by XREAL_1:50;
    then abs(1-((r`2/|.r.|-sn)/(1+sn))^2) =1-((r`2/|.r.|-sn)/(1+sn))^2 by
    ABSVALUE:def 1;
    then
A14: f.r=(|.r.|)*(-sqrt(abs(1-((r`2/|.r.|-sn)/(1+sn))^2))) by A2,A9;
A15: proj2.r=r`2 & (2 NormF).r=|.r.| by Def1,PSCOMP_1:def 29;
    g2.s=proj2.s & g1.s=(2 NormF).s by Lm3,Lm5;
    hence thesis by A5,A14,A15;
  end;
  hence thesis by A6,A8,FUNCT_1:9;
end;

theorem Th30:
  for sn being Real, K0,B0 being Subset of TOP-REAL 2, f being
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0 st -1<sn & sn<1 & f=(sn-FanMorphW)|
K0 & B0={q where q is Point of TOP-REAL 2: q`1<=0 & q<>0.TOP-REAL 2} & K0={p: p
  `2/|.p.|>=sn & p`1<=0 & p<>0.TOP-REAL 2} holds f is continuous
proof
  let sn be Real,K0,B0 be Subset of TOP-REAL 2, f be Function of (TOP-REAL 2)|
  K0,(TOP-REAL 2)|B0;
  set cn=sqrt(1-sn^2);
  set p0=|[-cn,sn]|;
A1: p0`1=-cn by EUCLID:56;
  p0`2=sn by EUCLID:56;
  then
A2: |.p0.|=sqrt((-cn)^2+sn^2) by A1,JGRAPH_3:10
    .=sqrt((cn)^2+sn^2);
  assume
A3: -1<sn & sn<1 & f=(sn-FanMorphW)|K0 & B0={q where q is Point of
  TOP-REAL 2: q`1<=0 & q<>0.TOP-REAL 2} & K0={p: p`2/|.p.|>=sn & p`1<=0 & p<>0.
  TOP-REAL 2};
  then sn^2<1^2 by SQUARE_1:120;
  then
A4: 1-sn^2>0 by XREAL_1:52;
  then
A5: --cn>0 by SQUARE_1:93;
A6: now
    assume
    p0=0.TOP-REAL 2;
    then --cn=-0 by EUCLID:56,JGRAPH_2:11;
    hence contradiction by A4,SQUARE_1:93;
  end;
  cn^2=1-sn^2 by A4,SQUARE_1:def 4;
  then p0`2/|.p0.|=sn by A2,EUCLID:56,SQUARE_1:83;
  then
A7: p0 in K0 by A3,A1,A6,A5;
  then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
A8: rng (proj1*((sn-FanMorphW)|K1)) c= the carrier of R^1 by TOPMETR:24;
A9: K0 c= B0
  proof
    let x be set;
    assume
    x in K0;
    then
    ex p8 being Point of TOP-REAL 2 st x=p8 & p8`2/|.p8.|>= sn & p8`1<=0 &
    p8<>0.TOP-REAL 2 by A3;
    hence thesis by A3;
  end;
A10: dom ((sn-FanMorphW)|K1) c= dom (proj2*((sn-FanMorphW)|K1))
  proof
    let x be set;
    assume
A11: x in dom ((sn-FanMorphW)|K1);
    then x in dom (sn-FanMorphW) /\ K1 by RELAT_1:90;
    then x in dom (sn-FanMorphW) by XBOOLE_0:def 4;
    then
A12: dom proj2 = (the carrier of TOP-REAL 2) & (sn-FanMorphW).x in rng (sn
    -FanMorphW) by FUNCT_1:12,FUNCT_2:def 1;
    ((sn-FanMorphW)|K1).x=(sn-FanMorphW).x by A11,FUNCT_1:70;
    hence thesis by A11,A12,FUNCT_1:21;
  end;
A13: rng (proj2*((sn-FanMorphW)|K1)) c= the carrier of R^1 by TOPMETR:24;
  dom (proj2*((sn-FanMorphW)|K1)) c= dom ((sn-FanMorphW)|K1) by RELAT_1:
  44;
  then dom (proj2*((sn-FanMorphW)|K1)) =dom ((sn-FanMorphW)|K1) by A10,
  XBOOLE_0:def 10
    .=dom (sn-FanMorphW) /\ K1 by RELAT_1:90
    .=(the carrier of TOP-REAL 2)/\ K1 by FUNCT_2:def 1
    .=K1 by XBOOLE_1:28
    .=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
  then reconsider
  g2=proj2*((sn-FanMorphW)|K1) as Function of (TOP-REAL 2)|K1,R^1
  by A13,FUNCT_2:4;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g2.p=|.p.|* ((p`2/|.p.|-sn)/(1-sn))
  proof
    let p be Point of TOP-REAL 2;
A14: dom ((sn-FanMorphW)|K1)=dom (sn-FanMorphW) /\ K1 by RELAT_1:90
      .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
      .=K1 by XBOOLE_1:28;
A15: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    assume
A16: p in the carrier of (TOP-REAL 2)|K1;
    then
    ex p3 being Point of TOP-REAL 2 st p=p3 & p3`2/|.p3.|>= sn & p3`1<=0 &
    p3<>0.TOP-REAL 2 by A3,A15;
    then
A17: (sn-FanMorphW).p =|[|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)), |.p.|
    * ((p`2/|.p.|-sn)/(1-sn))]| by A3,Th25;
    ((sn-FanMorphW)|K1).p=(sn-FanMorphW).p by A16,A15,FUNCT_1:72;
    then g2.p=proj2.(|[|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)), |.p.|* ((p
    `2/|.p.|-sn)/(1-sn))]|) by A16,A14,A15,A17,FUNCT_1:23
      .=(|[|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)), |.p.|* ((p`2/|.p.|-sn
    )/(1-sn))]|)`2 by PSCOMP_1:def 29
      .=|.p.|* ((p`2/|.p.|-sn)/(1-sn)) by EUCLID:56;
    hence thesis;
  end;
  then consider f2 being Function of (TOP-REAL 2)|K1,R^1 such that
A18: for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)
  |K1 holds f2.p=|.p.|* ((p`2/|.p.|-sn)/(1-sn));
A19: dom ((sn-FanMorphW)|K1) c= dom (proj1*((sn-FanMorphW)|K1))
  proof
    let x be set;
    assume
A20: x in dom ((sn-FanMorphW)|K1);
    then x in dom (sn-FanMorphW) /\ K1 by RELAT_1:90;
    then x in dom (sn-FanMorphW) by XBOOLE_0:def 4;
    then
A21: dom proj1 = (the carrier of TOP-REAL 2) & (sn-FanMorphW).x in rng (sn
    -FanMorphW) by FUNCT_1:12,FUNCT_2:def 1;
    ((sn-FanMorphW)|K1).x=(sn-FanMorphW).x by A20,FUNCT_1:70;
    hence thesis by A20,A21,FUNCT_1:21;
  end;
  dom (proj1*((sn-FanMorphW)|K1)) c= dom ((sn-FanMorphW)|K1) by RELAT_1:
  44;
  then dom (proj1*((sn-FanMorphW)|K1)) =dom ((sn-FanMorphW)|K1) by A19,
  XBOOLE_0:def 10
    .=dom (sn-FanMorphW) /\ K1 by RELAT_1:90
    .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
    .=K1 by XBOOLE_1:28
    .=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
  then reconsider
  g1=proj1*((sn-FanMorphW)|K1) as Function of (TOP-REAL 2)|K1,R^1
  by A8,FUNCT_2:4;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g1.p=|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2))
  proof
    let p be Point of TOP-REAL 2;
A22: dom ((sn-FanMorphW)|K1)=dom (sn-FanMorphW) /\ K1 by RELAT_1:90
      .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
      .=K1 by XBOOLE_1:28;
A23: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    assume
A24: p in the carrier of (TOP-REAL 2)|K1;
    then
    ex p3 being Point of TOP-REAL 2 st p=p3 & p3`2/|.p3.|>= sn & p3`1<=0 &
    p3<>0.TOP-REAL 2 by A3,A23;
    then
A25: (sn-FanMorphW).p=|[|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)), |.p.|*
    ((p`2/|.p.|-sn)/(1-sn))]| by A3,Th25;
    ((sn-FanMorphW)|K1).p=(sn-FanMorphW).p by A24,A23,FUNCT_1:72;
    then g1.p=proj1.(|[|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)), |.p.|* ((p
    `2/|.p.|-sn)/(1-sn))]|) by A24,A22,A23,A25,FUNCT_1:23
      .=(|[|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)), |.p.|* ((p`2/|.p.|-sn
    )/(1-sn)) ]|)`1 by PSCOMP_1:def 28
      .= |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)) by EUCLID:56;
    hence thesis;
  end;
  then consider f1 being Function of (TOP-REAL 2)|K1,R^1 such that
A26: for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)
  |K1 holds f1.p=|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2));
  for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)|K1
  holds q`1<=0 & q`2/|.q.|>=sn & q<>0.TOP-REAL 2
  proof
    let q be Point of TOP-REAL 2;
A27: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    assume
    q in the carrier of (TOP-REAL 2)|K1;
    then
    ex p3 being Point of TOP-REAL 2 st q=p3 & p3`2/|.p3.|>= sn & p3`1<=0 &
    p3<>0.TOP-REAL 2 by A3,A27;
    hence thesis;
  end;
  then
A28: f1 is continuous by A3,A26,Th28;
A29: for x,y,r,s being real number st |[x,y]| in K1 & r=f1.(|[x,y]|) & s=f2.
  (|[x,y]|) holds f.(|[x,y]|)=|[r,s]|
  proof
    let x,y,r,s be real number;
    assume that
A30: |[x,y]| in K1 and
A31: r=f1.(|[x,y]|) & s=f2.(|[x,y]|);
    set p99=|[x,y]|;
A32: ex p3 being Point of TOP-REAL 2 st p99=p3 & p3`2/|.p3.| >=sn & p3`1<=0
    & p3<>0.TOP-REAL 2 by A3,A30;
A33: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then
A34: f1.p99=|.p99.|*(-sqrt(1-((p99`2/|.p99.|-sn)/(1-sn))^2)) by A26,A30;
    ((sn-FanMorphW)|K0).(|[x,y]|)=((sn-FanMorphW)).(|[x,y]|) by A30,
    FUNCT_1:72
      .= |[|.p99.|*(-sqrt(1-((p99`2/|.p99.|-sn)/(1-sn))^2)), |.p99.|* ((p99
    `2/|.p99.|-sn)/(1-sn))]| by A3,A32,Th25
      .=|[r,s]| by A18,A30,A31,A33,A34;
    hence thesis by A3;
  end;
  for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)|K1
  holds q`1<=0 & q<>0.TOP-REAL 2
  proof
    let q be Point of TOP-REAL 2;
A35: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    assume
    q in the carrier of (TOP-REAL 2)|K1;
    then
    ex p3 being Point of TOP-REAL 2 st q=p3 & p3`2/|.p3.|>= sn & p3`1<=0 &
    p3<>0.TOP-REAL 2 by A3,A35;
    hence thesis;
  end;
  then f2 is continuous by A3,A18,Th26;
  hence thesis by A7,A9,A28,A29,JGRAPH_2:45;
end;

theorem Th31:
  for sn being Real, K0,B0 being Subset of TOP-REAL 2, f being
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0 st -1<sn & sn<1 & f=(sn-FanMorphW)|
K0 & B0={q where q is Point of TOP-REAL 2: q`1<=0 & q<>0.TOP-REAL 2} & K0={p: p
  `2/|.p.|<=sn & p`1<=0 & p<>0.TOP-REAL 2} holds f is continuous
proof
  let sn be Real,K0,B0 be Subset of TOP-REAL 2, f be Function of (TOP-REAL 2)|
  K0,(TOP-REAL 2)|B0;
  set cn=sqrt(1-sn^2);
  set p0=|[-cn,sn]|;
A1: p0`1=-cn by EUCLID:56;
  p0`2=sn by EUCLID:56;
  then
A2: |.p0.|=sqrt((-cn)^2+sn^2) by A1,JGRAPH_3:10
    .=sqrt((cn)^2+sn^2);
  assume
A3: -1<sn & sn<1 & f=(sn-FanMorphW)|K0 & B0={q where q is Point of
  TOP-REAL 2: q`1<=0 & q<>0.TOP-REAL 2} & K0={p: p`2/|.p.|<=sn & p`1<=0 & p<>0.
  TOP-REAL 2};
  then sn^2<1^2 by SQUARE_1:120;
  then
A4: 1-sn^2>0 by XREAL_1:52;
  then
A5: --cn>0 by SQUARE_1:93;
A6: now
    assume
    p0=0.TOP-REAL 2;
    then --cn=-0 by EUCLID:56,JGRAPH_2:11;
    hence contradiction by A4,SQUARE_1:93;
  end;
  cn^2=1-sn^2 by A4,SQUARE_1:def 4;
  then p0`2/|.p0.|=sn by A2,EUCLID:56,SQUARE_1:83;
  then
A7: p0 in K0 by A3,A1,A6,A5;
  then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
A8: rng (proj1*((sn-FanMorphW)|K1)) c= the carrier of R^1 by TOPMETR:24;
A9: K0 c= B0
  proof
    let x be set;
    assume
    x in K0;
    then
    ex p8 being Point of TOP-REAL 2 st x=p8 & p8`2/|.p8.|<= sn & p8`1<=0 &
    p8<>0.TOP-REAL 2 by A3;
    hence thesis by A3;
  end;
A10: dom ((sn-FanMorphW)|K1) c= dom (proj2*((sn-FanMorphW)|K1))
  proof
    let x be set;
    assume
A11: x in dom ((sn-FanMorphW)|K1);
    then x in dom (sn-FanMorphW) /\ K1 by RELAT_1:90;
    then x in dom (sn-FanMorphW) by XBOOLE_0:def 4;
    then
A12: dom proj2 = (the carrier of TOP-REAL 2) & (sn-FanMorphW).x in rng (sn
    -FanMorphW) by FUNCT_1:12,FUNCT_2:def 1;
    ((sn-FanMorphW)|K1).x=(sn-FanMorphW).x by A11,FUNCT_1:70;
    hence thesis by A11,A12,FUNCT_1:21;
  end;
A13: rng (proj2*((sn-FanMorphW)|K1)) c= the carrier of R^1 by TOPMETR:24;
  dom (proj2*((sn-FanMorphW)|K1)) c= dom ((sn-FanMorphW)|K1) by RELAT_1:
  44;
  then dom (proj2*((sn-FanMorphW)|K1)) =dom ((sn-FanMorphW)|K1) by A10,
  XBOOLE_0:def 10
    .=dom (sn-FanMorphW) /\ K1 by RELAT_1:90
    .=(the carrier of TOP-REAL 2)/\ K1 by FUNCT_2:def 1
    .=K1 by XBOOLE_1:28
    .=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
  then reconsider
  g2=proj2*((sn-FanMorphW)|K1) as Function of (TOP-REAL 2)|K1,R^1
  by A13,FUNCT_2:4;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g2.p=|.p.|* ((p`2/|.p.|-sn)/(1+sn))
  proof
    let p be Point of TOP-REAL 2;
A14: dom ((sn-FanMorphW)|K1)=dom (sn-FanMorphW) /\ K1 by RELAT_1:90
      .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
      .=K1 by XBOOLE_1:28;
A15: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    assume
A16: p in the carrier of (TOP-REAL 2)|K1;
    then
    ex p3 being Point of TOP-REAL 2 st p=p3 & p3`2/|.p3.|<= sn & p3`1<=0 &
    p3<>0.TOP-REAL 2 by A3,A15;
    then
A17: (sn-FanMorphW).p =|[|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)), |.p.|
    * ((p`2/|.p.|-sn)/(1+sn))]| by A3,Th25;
    ((sn-FanMorphW)|K1).p=(sn-FanMorphW).p by A16,A15,FUNCT_1:72;
    then g2.p=proj2.(|[|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)), |.p.|* ((p
    `2/|.p.|-sn)/(1+sn))]|) by A16,A14,A15,A17,FUNCT_1:23
      .=(|[|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)), |.p.|* ((p`2/|.p.|-sn
    )/(1+sn))]|)`2 by PSCOMP_1:def 29
      .=|.p.|* ((p`2/|.p.|-sn)/(1+sn)) by EUCLID:56;
    hence thesis;
  end;
  then consider f2 being Function of (TOP-REAL 2)|K1,R^1 such that
A18: for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)
  |K1 holds f2.p=|.p.|* ((p`2/|.p.|-sn)/(1+sn));
A19: dom ((sn-FanMorphW)|K1) c= dom (proj1*((sn-FanMorphW)|K1))
  proof
    let x be set;
    assume
A20: x in dom ((sn-FanMorphW)|K1);
    then x in dom (sn-FanMorphW) /\ K1 by RELAT_1:90;
    then x in dom (sn-FanMorphW) by XBOOLE_0:def 4;
    then
A21: dom proj1 = (the carrier of TOP-REAL 2) & (sn-FanMorphW).x in rng (sn
    -FanMorphW) by FUNCT_1:12,FUNCT_2:def 1;
    ((sn-FanMorphW)|K1).x=(sn-FanMorphW).x by A20,FUNCT_1:70;
    hence thesis by A20,A21,FUNCT_1:21;
  end;
  dom (proj1*((sn-FanMorphW)|K1)) c= dom ((sn-FanMorphW)|K1) by RELAT_1:
  44;
  then dom (proj1*((sn-FanMorphW)|K1)) =dom ((sn-FanMorphW)|K1) by A19,
  XBOOLE_0:def 10
    .=dom (sn-FanMorphW) /\ K1 by RELAT_1:90
    .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
    .=K1 by XBOOLE_1:28
    .=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
  then reconsider
  g1=proj1*((sn-FanMorphW)|K1) as Function of (TOP-REAL 2)|K1,R^1
  by A8,FUNCT_2:4;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g1.p=|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2))
  proof
    let p be Point of TOP-REAL 2;
A22: dom ((sn-FanMorphW)|K1)=dom (sn-FanMorphW) /\ K1 by RELAT_1:90
      .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
      .=K1 by XBOOLE_1:28;
A23: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    assume
A24: p in the carrier of (TOP-REAL 2)|K1;
    then
    ex p3 being Point of TOP-REAL 2 st p=p3 & p3`2/|.p3.|<= sn & p3`1<=0 &
    p3<>0.TOP-REAL 2 by A3,A23;
    then
A25: (sn-FanMorphW).p=|[|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)), |.p.|*
    ((p`2/|.p.|-sn)/(1+sn))]| by A3,Th25;
    ((sn-FanMorphW)|K1).p=(sn-FanMorphW).p by A24,A23,FUNCT_1:72;
    then g1.p=proj1.(|[|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)), |.p.|* ((p
    `2/|.p.|-sn)/(1+sn))]|) by A24,A22,A23,A25,FUNCT_1:23
      .=(|[|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)), |.p.|* ((p`2/|.p.|-sn
    )/(1+sn)) ]|)`1 by PSCOMP_1:def 28
      .= |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)) by EUCLID:56;
    hence thesis;
  end;
  then consider f1 being Function of (TOP-REAL 2)|K1,R^1 such that
A26: for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)
  |K1 holds f1.p=|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2));
  for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)|K1
  holds q`1<=0 & q`2/|.q.|<=sn & q<>0.TOP-REAL 2
  proof
    let q be Point of TOP-REAL 2;
A27: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    assume
    q in the carrier of (TOP-REAL 2)|K1;
    then
    ex p3 being Point of TOP-REAL 2 st q=p3 & p3`2/|.p3.|<= sn & p3`1<=0 &
    p3<>0.TOP-REAL 2 by A3,A27;
    hence thesis;
  end;
  then
A28: f1 is continuous by A3,A26,Th29;
A29: for x,y,r,s being real number st |[x,y]| in K1 & r=f1.(|[x,y]|) & s=f2.
  (|[x,y]|) holds f.(|[x,y]|)=|[r,s]|
  proof
    let x,y,r,s be real number;
    assume that
A30: |[x,y]| in K1 and
A31: r=f1.(|[x,y]|) & s=f2.(|[x,y]|);
    set p99=|[x,y]|;
A32: ex p3 being Point of TOP-REAL 2 st p99=p3 & p3`2/|.p3.| <=sn & p3`1<=0
    & p3<>0.TOP-REAL 2 by A3,A30;
A33: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then
A34: f1.p99=|.p99.|*(-sqrt(1-((p99`2/|.p99.|-sn)/(1+sn))^2)) by A26,A30;
    ((sn-FanMorphW)|K0).(|[x,y]|)=((sn-FanMorphW)).(|[x,y]|) by A30,
    FUNCT_1:72
      .= |[|.p99.|*(-sqrt(1-((p99`2/|.p99.|-sn)/(1+sn))^2)), |.p99.|* ((p99
    `2/|.p99.|-sn)/(1+sn))]| by A3,A32,Th25
      .=|[r,s]| by A18,A30,A31,A33,A34;
    hence thesis by A3;
  end;
  for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)|K1
  holds q`1<=0 & q<>0.TOP-REAL 2
  proof
    let q be Point of TOP-REAL 2;
A35: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    assume
    q in the carrier of (TOP-REAL 2)|K1;
    then
    ex p3 being Point of TOP-REAL 2 st q=p3 & p3`2/|.p3.|<= sn & p3`1<=0 &
    p3<>0.TOP-REAL 2 by A3,A35;
    hence thesis;
  end;
  then f2 is continuous by A3,A18,Th27;
  hence thesis by A7,A9,A28,A29,JGRAPH_2:45;
end;

Lm7: for sn being Real, K1 being Subset of TOP-REAL 2 st K1={p7 where p7 is
Point of TOP-REAL 2:p7`2>=sn*|.p7.|} holds K1 is closed

proof
  set K10=[#]TOP-REAL 2;

  reconsider g0=(2 NormF)|K10 as continuous Function of (TOP-REAL 2)|K10,R^1
  by Lm5;

  reconsider g1=proj2|K10 as continuous Function of (TOP-REAL 2)|K10,R^1 by
  Lm3;

  let sn be Real, K1 be Subset of TOP-REAL 2;
  defpred P[Point of TOP-REAL 2] means ($1`2>=sn*|.$1.|);
  consider g2 being Function of (TOP-REAL 2)|K10,R^1 such that

A1: for q being Point of (TOP-REAL 2)|K10,r1 being real number st g0.q=
  r1 holds g2.q=sn*r1 and
A2: g2 is continuous by JGRAPH_2:33;
  consider g3 being Function of (TOP-REAL 2)|K10,R^1 such that

A3: for q being Point of (TOP-REAL 2)|K10,r1,r2 being real number st g2.
  q= r1 & g1.q=r2 holds g3.q=r1-r2 and
A4: g3 is continuous by A2,JGRAPH_2:31;
A5: (TOP-REAL 2)|K10=the TopStruct of TOP-REAL 2 by TSEP_1:100;
  then reconsider g=g3 as Function of TOP-REAL 2,R^1;
  reconsider K2=K1 as Subset of the TopStruct of TOP-REAL 2;
  assume
  K1={p: p`2>=(sn)*(|.p.|)};
  then
A6: K1={p7 where p7 is Point of TOP-REAL 2:P[p7]};

A7: K1`={p7 where p7 is Point of TOP-REAL 2:not P[p7]} from JGRAPH_2:sch 2(
  A6);

A8: for p being Point of TOP-REAL 2 holds g3.p=sn*|.p.|-p`2
  proof
    let p be Point of TOP-REAL 2;
    g0.p=(2 NormF).p by A5,Lm5
      .=|.p.| by Def1;
    then
A9: g2.p=sn*|.p.| by A1,A5;
    g1.p=proj2.p by A5,Lm3
      .=p`2 by PSCOMP_1:def 29;
    hence thesis by A3,A5,A9;
  end;
A10: K1` c= {p7 where p7 is Point of TOP-REAL 2:g/.p7>0}
  proof
    let x be set;
    assume
    x in K1`;
    then consider p9 being Point of TOP-REAL 2 such that
A11: x=p9 and
A12: p9`2<sn*|.p9.| by A7;
A13: g/.p9=sn*|.p9.|-p9`2 by A8;
    sn*|.p9.| - p9`2>0 by A12,XREAL_1:52;
    hence thesis by A11,A13;
  end;
  {p7 where p7 is Point of TOP-REAL 2: g/.p7>0} c= K1`
  proof
    let x be set;
    assume
    x in {p7 where p7 is Point of TOP-REAL 2: g/.p7>0};
    then consider p7 being Point of TOP-REAL 2 such that
A14: p7=x and
A15: g/.p7>0;
    g/.p7=sn*|.p7.|-p7`2 by A8;
    then sn*|.p7.| - p7`2+p7`2>0+p7`2 by A15,XREAL_1:10;
    hence thesis by A7,A14;
  end;

  then K1`={p7 where p7 is Point of TOP-REAL 2:g/.p7>0} by A10,
  XBOOLE_0:def 10;

  then K2` is open by A4,A5,Th6;
  then K1` is open by PRE_TOPC:60;
  hence thesis by TOPS_1:29;
end;

Lm8: for sn being Real, K1 being Subset of TOP-REAL 2 st K1={p7 where p7 is
Point of TOP-REAL 2:p7`1>=sn*|.p7.|} holds K1 is closed

proof
  set K10=[#](TOP-REAL 2);

  reconsider g0=(2 NormF)|K10 as continuous Function of (TOP-REAL 2)|K10,R^1
  by Lm5;

  reconsider g1=proj1|K10 as continuous Function of (TOP-REAL 2)|K10,R^1 by
  Lm2;

  let sn be Real, K1 be Subset of TOP-REAL 2;
  defpred P[Point of TOP-REAL 2] means ($1`1>=sn*|.$1.|);
  consider g2 being Function of (TOP-REAL 2)|K10,R^1 such that

A1: for q being Point of (TOP-REAL 2)|K10,r1 being real number st g0.q=
  r1 holds g2.q=sn*r1 and
A2: g2 is continuous by JGRAPH_2:33;
  consider g3 being Function of (TOP-REAL 2)|K10,R^1 such that

A3: for q being Point of (TOP-REAL 2)|K10,r1,r2 being real number st g2.
  q= r1 & g1.q=r2 holds g3.q=r1-r2 and
A4: g3 is continuous by A2,JGRAPH_2:31;
A5: (TOP-REAL 2)|K10=the TopStruct of TOP-REAL 2 by TSEP_1:100;
  then reconsider g=g3 as Function of TOP-REAL 2,R^1;
  reconsider K2=K1 as Subset of the TopStruct of TOP-REAL 2;
  assume
  K1={p: p`1>=(sn)*(|.p.|)};
  then
A6: K1={p7 where p7 is Point of TOP-REAL 2:P[p7]};

A7: K1`={p7 where p7 is Point of TOP-REAL 2:not P[p7]} from JGRAPH_2:sch 2(
  A6);

A8: for p being Point of TOP-REAL 2 holds g3.p=sn*|.p.|-p`1
  proof
    let p be Point of TOP-REAL 2;
    g0.p=(2 NormF).p by A5,Lm5
      .=|.p.| by Def1;
    then
A9: g2.p=sn*|.p.| by A1,A5;
    g1.p=proj1.p by A5,Lm2
      .=p`1 by PSCOMP_1:def 28;
    hence thesis by A3,A5,A9;
  end;
A10: K1` c= {p7 where p7 is Point of TOP-REAL 2:g/.p7>0}
  proof
    let x be set;
    assume
    x in K1`;
    then consider p9 being Point of TOP-REAL 2 such that
A11: x=p9 and
A12: p9`1<sn*|.p9.| by A7;
A13: g/.p9=sn*|.p9.|-p9`1 by A8;
    sn*|.p9.| - p9`1>0 by A12,XREAL_1:52;
    hence thesis by A11,A13;
  end;
  {p7 where p7 is Point of TOP-REAL 2: g/.p7>0} c= K1`
  proof
    let x be set;
    assume
    x in {p7 where p7 is Point of TOP-REAL 2: g/.p7>0};
    then consider p7 being Point of TOP-REAL 2 such that
A14: p7=x and
A15: g/.p7>0;
    g/.p7=sn*|.p7.|-p7`1 by A8;
    then sn*|.p7.| - p7`1+p7`1>0+p7`1 by A15,XREAL_1:10;
    hence thesis by A7,A14;
  end;

  then K1`={p7 where p7 is Point of TOP-REAL 2:g/.p7>0} by A10,
  XBOOLE_0:def 10;

  then K2` is open by A4,A5,Th6;
  then K1` is open by PRE_TOPC:60;
  hence thesis by TOPS_1:29;
end;

theorem Th32:
  for sn being Real, K03 being Subset of TOP-REAL 2 st K03={p: p`2
  >=sn*(|.p.|) & p`1<=0} holds K03 is closed
proof
  defpred Q[Point of TOP-REAL 2] means $1`1<=0;
  let sn be Real, K003 be Subset of TOP-REAL 2;
  defpred P[Point of TOP-REAL 2] means ($1`2>=sn*|.$1.|);
  assume
A1: K003={p: p`2>=(sn)*(|.p.|) & p`1<=0};
  reconsider KX={p where p is Point of TOP-REAL 2: Q[p]} as Subset of TOP-REAL
  2 from JGRAPH_2:sch 1;
  reconsider K1={p7 where p7 is Point of TOP-REAL 2:P[p7]} as Subset of
  TOP-REAL 2 from JGRAPH_2:sch 1;
A2: {p : P[p] & Q[p]} = {p7 where p7 is Point of TOP-REAL 2:P[p7]} /\ {p1
  where p1 is Point of TOP-REAL 2: Q[p1]} from DOMAIN_1:sch 10;
  K1 is closed & KX is closed by Lm7,JORDAN6:6;
  hence thesis by A1,A2,TOPS_1:35;
end;

Lm9: for sn being Real, K1 being Subset of TOP-REAL 2 st K1={p7 where p7 is
Point of TOP-REAL 2:p7`2<=sn*|.p7.|} holds K1 is closed

proof
  set K10=[#](TOP-REAL 2);

  reconsider g0=(2 NormF)|K10 as continuous Function of (TOP-REAL 2)|K10,R^1
  by Lm5;

  reconsider g1=proj2|K10 as continuous Function of (TOP-REAL 2)|K10,R^1 by
  Lm3;

  let sn be Real, K1 be Subset of TOP-REAL 2;
  defpred P[Point of TOP-REAL 2] means ($1`2<=sn*|.$1.|);
  consider g2 being Function of (TOP-REAL 2)|K10,R^1 such that

A1: for q being Point of (TOP-REAL 2)|K10,r1 being real number st g0.q=
  r1 holds g2.q=sn*r1 and
A2: g2 is continuous by JGRAPH_2:33;
  consider g3 being Function of (TOP-REAL 2)|K10,R^1 such that

A3: for q being Point of (TOP-REAL 2)|K10,r1,r2 being real number st g2.
  q= r1 & g1.q=r2 holds g3.q=r1-r2 and
A4: g3 is continuous by A2,JGRAPH_2:31;
A5: (TOP-REAL 2)|K10=the TopStruct of TOP-REAL 2 by TSEP_1:100;
  then reconsider g=g3 as Function of TOP-REAL 2,R^1;
  reconsider K2=K1 as Subset of the TopStruct of TOP-REAL 2;
  assume
  K1={p: p`2<=(sn)*(|.p.|)};
  then
A6: K1={p7 where p7 is Point of TOP-REAL 2:P[p7]};

A7: K1`={p7 where p7 is Point of TOP-REAL 2:not P[p7]} from JGRAPH_2:sch 2(
  A6);

A8: for p being Point of TOP-REAL 2 holds g3.p=sn*|.p.|-p`2
  proof
    let p be Point of TOP-REAL 2;
    g0.p=(2 NormF).p by A5,Lm5
      .=|.p.| by Def1;
    then
A9: g2.p=sn*|.p.| by A1,A5;
    g1.p=proj2.p by A5,Lm3
      .=p`2 by PSCOMP_1:def 29;
    hence thesis by A3,A5,A9;
  end;
A10: K1` c= {p7 where p7 is Point of TOP-REAL 2:g/.p7<0}
  proof
    let x be set;
    assume
    x in K1`;
    then consider p9 being Point of TOP-REAL 2 such that
A11: x=p9 and
A12: p9`2>sn*|.p9.| by A7;
A13: g/.p9=sn*|.p9.|-p9`2 by A8;
    sn*|.p9.| - p9`2<0 by A12,XREAL_1:51;
    hence thesis by A11,A13;
  end;
  {p7 where p7 is Point of TOP-REAL 2: g/.p7<0} c= K1`
  proof
    let x be set;
    assume
    x in {p7 where p7 is Point of TOP-REAL 2: g/.p7<0};
    then consider p7 being Point of TOP-REAL 2 such that
A14: p7=x and
A15: g/.p7<0;
    g/.p7=sn*|.p7.|-p7`2 by A8;
    then sn*|.p7.| - p7`2+p7`2<0+p7`2 by A15,XREAL_1:10;
    hence thesis by A7,A14;
  end;

  then K1`={p7 where p7 is Point of TOP-REAL 2:g/.p7<0} by A10,
  XBOOLE_0:def 10;

  then K2` is open by A4,A5,Th7;
  then K1` is open by PRE_TOPC:60;
  hence thesis by TOPS_1:29;
end;

Lm10: for sn being Real, K1 being Subset of TOP-REAL 2 st K1={p7 where p7 is
Point of TOP-REAL 2:p7`1<=sn*|.p7.|} holds K1 is closed

proof
  set K10=[#](TOP-REAL 2);

  reconsider g0=(2 NormF)|K10 as continuous Function of (TOP-REAL 2)|K10,R^1
  by Lm5;

  reconsider g1=proj1|K10 as continuous Function of (TOP-REAL 2)|K10,R^1 by
  Lm2;

  let sn be Real, K1 be Subset of TOP-REAL 2;
  defpred P[Point of TOP-REAL 2] means ($1`1<=sn*|.$1.|);
  consider g2 being Function of (TOP-REAL 2)|K10,R^1 such that

A1: for q being Point of (TOP-REAL 2)|K10,r1 being real number st g0.q=
  r1 holds g2.q=sn*r1 and
A2: g2 is continuous by JGRAPH_2:33;
  consider g3 being Function of (TOP-REAL 2)|K10,R^1 such that

A3: for q being Point of (TOP-REAL 2)|K10,r1,r2 being real number st g2.
  q= r1 & g1.q=r2 holds g3.q=r1-r2 and
A4: g3 is continuous by A2,JGRAPH_2:31;
A5: (TOP-REAL 2)|K10=the TopStruct of TOP-REAL 2 by TSEP_1:100;
  then reconsider g=g3 as Function of TOP-REAL 2,R^1;
  reconsider K2=K1 as Subset of the TopStruct of TOP-REAL 2;
  assume
  K1={p: p`1<=(sn)*(|.p.|)};
  then
A6: K1={p7 where p7 is Point of TOP-REAL 2:P[p7]};

A7: K1`={p7 where p7 is Point of TOP-REAL 2:not P[p7]} from JGRAPH_2:sch 2(
  A6);

A8: for p being Point of TOP-REAL 2 holds g3.p=sn*|.p.|-p`1
  proof
    let p be Point of TOP-REAL 2;
    g0.p=(2 NormF).p by A5,Lm5
      .=|.p.| by Def1;
    then
A9: g2.p=sn*|.p.| by A1,A5;
    g1.p=proj1.p by A5,Lm2
      .=p`1 by PSCOMP_1:def 28;
    hence thesis by A3,A5,A9;
  end;
A10: K1` c= {p7 where p7 is Point of TOP-REAL 2:g/.p7<0}
  proof
    let x be set;
    assume
    x in K1`;
    then consider p9 being Point of TOP-REAL 2 such that
A11: x=p9 and
A12: p9`1>sn*|.p9.| by A7;
A13: g/.p9=sn*|.p9.|-p9`1 by A8;
    sn*|.p9.| - p9`1<0 by A12,XREAL_1:51;
    hence thesis by A11,A13;
  end;
  {p7 where p7 is Point of TOP-REAL 2: g/.p7<0} c= K1`
  proof
    let x be set;
    assume
    x in {p7 where p7 is Point of TOP-REAL 2: g/.p7<0};
    then consider p7 being Point of TOP-REAL 2 such that
A14: p7=x and
A15: g/.p7<0;
    g/.p7=sn*|.p7.|-p7`1 by A8;
    then sn*|.p7.| - p7`1+p7`1<0+p7`1 by A15,XREAL_1:10;
    hence thesis by A7,A14;
  end;

  then K1`={p7 where p7 is Point of TOP-REAL 2:g/.p7<0} by A10,
  XBOOLE_0:def 10;

  then K2` is open by A4,A5,Th7;
  then K1` is open by PRE_TOPC:60;
  hence thesis by TOPS_1:29;
end;

theorem Th33:
  for sn being Real, K03 being Subset of TOP-REAL 2 st K03={p: p`2
  <=(sn)*(|.p.|) & p`1<=0} holds K03 is closed
proof
  defpred Q[Point of TOP-REAL 2] means $1`1<=0;
  let sn be Real, K003 be Subset of TOP-REAL 2;
  defpred P[Point of TOP-REAL 2] means ($1`2<=sn*|.$1.|);
  assume
A1: K003={p: P[p] & Q[p]};
  reconsider KX={p where p is Point of TOP-REAL 2: Q[p]} as Subset of TOP-REAL
  2 from JGRAPH_2:sch 1;
  reconsider K1={p7 where p7 is Point of TOP-REAL 2:P[p7]} as Subset of
  TOP-REAL 2 from JGRAPH_2:sch 1;
A2: {p : P[p] & Q[p]} = {p7 where p7 is Point of TOP-REAL 2:P[p7]} /\ {p1
  where p1 is Point of TOP-REAL 2: Q[p1]} from DOMAIN_1:sch 10;
  K1 is closed & KX is closed by Lm9,JORDAN6:6;
  hence thesis by A1,A2,TOPS_1:35;
end;

theorem Th34:
  for sn being Real, K0,B0 being Subset of TOP-REAL 2, f being
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0 st -1<sn & sn<1 & f=(sn-FanMorphW)|
  K0 & B0=NonZero TOP-REAL 2 & K0={p: p`1<=0 & p<>0.TOP-REAL 2} holds f is
  continuous
proof
  let sn be Real,K0,B0 be Subset of TOP-REAL 2, f be Function of (TOP-REAL 2)|
  K0,(TOP-REAL 2)|B0;
  set cn=sqrt(1-sn^2);
  set p0=|[-cn,sn]|;
A1: p0`1=-cn by EUCLID:56;
  p0`2=sn by EUCLID:56;
  then
A2: |.p0.|=sqrt((-cn)^2+sn^2) by A1,JGRAPH_3:10
    .=sqrt((cn)^2+sn^2);
  assume
A3: -1<sn & sn<1 & f=(sn-FanMorphW)|K0 & B0=NonZero TOP-REAL 2 & K0={p:
  p`1<=0 & p<>0.TOP-REAL 2};
  then sn^2<1^2 by SQUARE_1:120;
  then
A4: 1-sn^2>0 by XREAL_1:52;
  then
A5: --cn>0 by SQUARE_1:93;
A6: now
    assume
    p0=0.TOP-REAL 2;
    then --cn=-0 by EUCLID:56,JGRAPH_2:11;
    hence contradiction by A4,SQUARE_1:93;
  end;
  then p0 in K0 by A3,A1,A5;
  then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
  cn^2=1-sn^2 by A4,SQUARE_1:def 4;
  then
A7: p0`2/|.p0.|=sn by A2,EUCLID:56,SQUARE_1:83;
  then
A8: p0 in {p: p`2/|.p.|>=sn & p`1<=0 & p<>0.TOP-REAL 2} by A1,A6,A5;
  not p0 in {0.TOP-REAL 2} by A6,TARSKI:def 1;
  then reconsider D=B0 as non empty Subset of TOP-REAL 2 by A3,XBOOLE_0:def 5;
  K1 c= D
  proof
    let x be set;
    assume
A9: x in K1;
    then ex p6 being Point of TOP-REAL 2 st p6=x & p6`1<=0 & p6 <>0.TOP-REAL 2
    by A3;
    then not x in {0.TOP-REAL 2} by TARSKI:def 1;
    hence thesis by A3,A9,XBOOLE_0:def 5;
  end;
  then D=K1 \/ D by XBOOLE_1:12;
  then
A10: (TOP-REAL 2)|K1 is SubSpace of (TOP-REAL 2)|D by TOPMETR:5;
A11: {p: p`2/|.p.|<=sn & p`1<=0 & p<>0.TOP-REAL 2} c= K1
  proof
    let x be set;
    assume
    x in {p: p`2/|.p.|<=sn & p`1<=0 & p<>0.TOP-REAL 2};
    then ex p st p=x & p`2/|.p.|<=sn & p`1<=0 & p<>0.TOP-REAL 2;
    hence thesis by A3;
  end;
A12: {p: p`2/|.p.|>=sn & p`1<=0 & p<>0.TOP-REAL 2} c= K1
  proof
    let x be set;
    assume
    x in {p: p`2/|.p.|>=sn & p`1<=0 & p<>0.TOP-REAL 2};
    then ex p st p=x & p`2/|.p.|>=sn & p`1<=0 & p<>0.TOP-REAL 2;
    hence thesis by A3;
  end;
  then reconsider
  K00={p: p`2/|.p.|>=sn & p`1<=0 & p<>0.TOP-REAL 2} as non empty
  Subset of ((TOP-REAL 2)|K1) by A8,PRE_TOPC:29;
  the carrier of (TOP-REAL 2)|D=D by PRE_TOPC:29;
  then
A13: rng (f|K00) c=D;
  p0 in {p: p`2/|.p.|<=sn & p`1<=0 & p<>0.TOP-REAL 2} by A1,A6,A5,A7;
  then reconsider
  K11={p: p`2/|.p.|<=sn & p`1<=0 & p<>0.TOP-REAL 2} as non empty
  Subset of ((TOP-REAL 2)|K1) by A11,PRE_TOPC:29;
  the carrier of (TOP-REAL 2)|D=D by PRE_TOPC:29;
  then
A14: rng (f|K11) c=D;
  the carrier of (TOP-REAL 2)|B0=the carrier of (TOP-REAL 2)|D;
  then
A15: dom f=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1
    .=K1 by PRE_TOPC:29;
  then dom (f|K00)=K00 by A12,RELAT_1:91
    .= the carrier of ((TOP-REAL 2)|K1)|K00 by PRE_TOPC:29;
  then reconsider
  f1=f|K00 as Function of ((TOP-REAL 2)|K1)|K00,(TOP-REAL 2)|D by
  A13,FUNCT_2:4;
  dom (f|K11)=K11 by A11,A15,RELAT_1:91
    .= the carrier of ((TOP-REAL 2)|K1)|K11 by PRE_TOPC:29;
  then reconsider
  f2=f|K11 as Function of ((TOP-REAL 2)|K1)|K11,(TOP-REAL 2)|D by
  A14,FUNCT_2:4;
A16: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
  defpred P[Point of TOP-REAL 2] means $1`2/|.$1.|>=sn & $1`1<=0 & $1<>0.
  TOP-REAL 2;
A17: dom f2=the carrier of ((TOP-REAL 2)|K1)|K11 by FUNCT_2:def 1
    .=K11 by PRE_TOPC:29;
  {p: P[p]} is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
  then reconsider
  K001={p: p`2/|.p.|>=sn & p`1<=0 & p<>0.TOP-REAL 2} as non empty
  Subset of TOP-REAL 2 by A8;
A18: the carrier of (TOP-REAL 2)|K1 = K1 by PRE_TOPC:29;
  defpred P[Point of TOP-REAL 2] means $1`2>=(sn)*(|.$1.|) & $1`1<=0;
  {p: P[p]} is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
  then reconsider
  K003={p: p`2>=(sn)*(|.p.|) & p`1<=0} as Subset of TOP-REAL 2;
  defpred P[Point of TOP-REAL 2] means $1`2/|.$1.|<=sn & $1`1<=0 & $1<>0.
  TOP-REAL 2;
A19: {p: P[p]} is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
A20: rng ((sn-FanMorphW)|K001) c= K1
  proof
    let y be set;
    assume
    y in rng ((sn-FanMorphW)|K001);
    then consider x being set such that
A21: x in dom ((sn-FanMorphW)|K001) and
A22: y=((sn-FanMorphW)|K001).x by FUNCT_1:def 5;
    reconsider q=x as Point of TOP-REAL 2 by A21;
A23: y=(sn-FanMorphW).q by A21,A22,FUNCT_1:70;
    dom ((sn-FanMorphW)|K001)=(dom (sn-FanMorphW))/\ K001 by RELAT_1:90
      .=(the carrier of TOP-REAL 2)/\ K001 by FUNCT_2:def 1
      .=K001 by XBOOLE_1:28;
    then
A24: ex p2 being Point of TOP-REAL 2 st p2=q & p2`2/|.p2.|>= sn & p2`1<=0 &
    p2<>0.TOP-REAL 2 by A21;
    then
A25: (q`2/|.q.|-sn)>= 0 by XREAL_1:50;
    |.q.|<>0 by A24,TOPRNS_1:25;
    then
A26: (|.q.|)^2>0^2 by SQUARE_1:74;
    set q4= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)), |.q.|* ((q`2/|.q.|-
    sn)/(1-sn))]|;
A27: q4`2= |.q.|*((q`2/|.q.|-sn)/(1-sn)) by EUCLID:56;
A28: 1-sn>0 by A3,XREAL_1:151;
    0<=(q`1)^2 by XREAL_1:65;
    then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
    then (q`2)^2 <= (|.q.|)^2 by JGRAPH_3:10;
    then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by XREAL_1:74;
    then (q`2)^2/(|.q.|)^2 <= 1 by A26,XCMPLX_1:60;
    then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
    then 1>=q`2/|.q.| by SQUARE_1:121;
    then 1-sn>=q`2/|.q.|-sn by XREAL_1:11;
    then -(1-sn)<= -( q`2/|.q.|-sn) by XREAL_1:26;
    then (-(1-sn))/(1-sn)<=(-( q`2/|.q.|-sn))/(1-sn) by A28,XREAL_1:74;
    then -1<=(-( q`2/|.q.|-sn))/(1-sn) by A28,XCMPLX_1:198;
    then ((-(q`2/|.q.|-sn))/(1-sn))^2<=1^2 by A28,A25,SQUARE_1:119;
    then
A29: 1-((-(q`2/|.q.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
    then
A30: 1-(-((q`2/|.q.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
    sqrt(1-((-(q`2/|.q.|-sn))/(1-sn))^2)>=0 by A29,SQUARE_1:def 4;
    then sqrt(1-(-(q`2/|.q.|-sn))^2/(1-sn)^2)>=0 by XCMPLX_1:77;
    then sqrt(1-(q`2/|.q.|-sn)^2/(1-sn)^2)>=0;
    then
A31: sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)>=0 by XCMPLX_1:77;
A32: q4`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)) by EUCLID:56;
    then
A33: (q4`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))^2
      .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1-sn))^2) by A30,SQUARE_1:def 4;
    (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
      .=(|.q.|)^2 by A27,A33;
    then
A34: q4<>0.TOP-REAL 2 by A26,TOPRNS_1:24;
    sn-FanMorphW.q= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)), |.q.|*
    ((q`2/|.q.|-sn)/(1-sn))]| by A3,A24,Th25;
    hence thesis by A3,A23,A32,A31,A34;
  end;
A35: dom (sn-FanMorphW)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
  then dom ((sn-FanMorphW)|K001)=K001 by RELAT_1:91
    .= the carrier of (TOP-REAL 2)|K001 by PRE_TOPC:29;
  then reconsider
  f3=(sn-FanMorphW)|K001 as Function of (TOP-REAL 2)|K001,(TOP-REAL
  2)|K1 by A18,A20,FUNCT_2:4;
A36: K003 is closed by Th32;
  defpred P[Point of TOP-REAL 2] means $1`2<=(sn)*(|.$1.|) & $1`1<=0;
  {p: P[p]} is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
  then reconsider
  K004={p: p`2<=(sn)*(|.p.|) & p`1<=0} as Subset of TOP-REAL 2;
A37: K004 /\ K1 c= K11
  proof
    let x be set;
    assume
A38: x in K004 /\ K1;
    then x in K004 by XBOOLE_0:def 4;
    then consider q1 being Point of TOP-REAL 2 such that
A39: q1=x and
A40: q1`2<=(sn)*(|.q1.|) and
    q1`1<=0;
    x in K1 by A38,XBOOLE_0:def 4;
    then
A41: ex q2 being Point of TOP-REAL 2 st q2=x & q2`1<=0 & q2 <>0.TOP-REAL 2
    by A3;
    q1`2/|.q1.|<=(sn)*(|.q1.|)/|.q1.| by A40,XREAL_1:74;
    then q1`2/|.q1.|<=(sn) by A39,A41,TOPRNS_1:25,XCMPLX_1:90;
    hence thesis by A39,A41;
  end;
A42: K004 is closed by Th33;
  the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
  then ((TOP-REAL 2)|K1)|K00=(TOP-REAL 2)|K001 & f1= f3 by A3,FUNCT_1:82
  ,GOBOARD9:4;
  then
A43: f1 is continuous by A3,A10,Th30,PRE_TOPC:56;
A44: [#]((TOP-REAL 2)|K1)=K1 by PRE_TOPC:def 10;
  p0 in {p: p`2/|.p.|<=sn & p`1<=0 & p<>0.TOP-REAL 2} by A1,A6,A5,A7;
  then reconsider
  K111={p: p`2/|.p.|<=sn & p`1<=0 & p<>0.TOP-REAL 2} as non empty
  Subset of TOP-REAL 2 by A19;
A45: rng ((sn-FanMorphW)|K111) c= K1
  proof
    let y be set;
    assume
    y in rng ((sn-FanMorphW)|K111);
    then consider x being set such that
A46: x in dom ((sn-FanMorphW)|K111) and
A47: y=((sn-FanMorphW)|K111).x by FUNCT_1:def 5;
    reconsider q=x as Point of TOP-REAL 2 by A46;
A48: y=(sn-FanMorphW).q by A46,A47,FUNCT_1:70;
    dom ((sn-FanMorphW)|K111)=(dom (sn-FanMorphW))/\ K111 by RELAT_1:90
      .=(the carrier of TOP-REAL 2)/\ K111 by FUNCT_2:def 1
      .=K111 by XBOOLE_1:28;
    then
A49: ex p2 being Point of TOP-REAL 2 st p2=q & p2`2/|.p2.|<= sn & p2`1<=0 &
    p2<>0.TOP-REAL 2 by A46;
    then
A50: (q`2/|.q.|-sn)<=0 by XREAL_1:49;
    |.q.|<>0 by A49,TOPRNS_1:25;
    then
A51: (|.q.|)^2>0^2 by SQUARE_1:74;
    set q4= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)), |.q.|* ((q`2/|.q.|-
    sn)/(1+sn))]|;
A52: q4`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by EUCLID:56;
A53: 1+sn>0 by A3,XREAL_1:150;
    0<=(q`1)^2 by XREAL_1:65;
    then (|.q.|)^2 =(q`1)^2+(q`2)^2 & 0+(q`2)^2<=(q`1)^2+(q`2)^2 by
    JGRAPH_3:10 ,XREAL_1:9;
    then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by XREAL_1:74;
    then (q`2)^2/(|.q.|)^2 <= 1 by A51,XCMPLX_1:60;
    then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
    then -1<=q`2/|.q.| by SQUARE_1:121;
    then -1-sn<=q`2/|.q.|-sn by XREAL_1:11;
    then (-(1+sn))/(1+sn)<=(( q`2/|.q.|-sn))/(1+sn) by A53,XREAL_1:74;
    then -1<=(( q`2/|.q.|-sn))/(1+sn) by A53,XCMPLX_1:198;
    then
A54: ( (q`2/|.q.|-sn) /(1+sn))^2<=1^2 by A53,A50,SQUARE_1:119;
    then
A55: 1-((q`2/|.q.|-sn)/(1+sn))^2>=0 by XREAL_1:50;
    1-(-((q`2/|.q.|-sn)/(1+sn)))^2>=0 by A54,XREAL_1:50;
    then 1-((-(q`2/|.q.|-sn))/(1+sn))^2>=0 by XCMPLX_1:188;
    then sqrt(1-((-(q`2/|.q.|-sn))/(1+sn))^2)>=0 by SQUARE_1:def 4;
    then sqrt(1-(-(q`2/|.q.|-sn))^2/(1+sn)^2)>=0 by XCMPLX_1:77;
    then sqrt(1-(q`2/|.q.|-sn)^2/(1+sn)^2)>=0;
    then
A56: sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)>=0 by XCMPLX_1:77;
A57: q4`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)) by EUCLID:56;
    then
A58: (q4`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))^2
      .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1+sn))^2) by A55,SQUARE_1:def 4;
    (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
      .=(|.q.|)^2 by A52,A58;
    then
A59: q4<>0.TOP-REAL 2 by A51,TOPRNS_1:24;
    sn-FanMorphW.q= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)), |.q.|*
    ((q`2/|.q.|-sn)/(1+sn))]| by A3,A49,Th25;
    hence thesis by A3,A48,A57,A56,A59;
  end;
  dom ((sn-FanMorphW)|K111)=K111 by A35,RELAT_1:91
    .= the carrier of (TOP-REAL 2)|K111 by PRE_TOPC:29;
  then reconsider
  f4=(sn-FanMorphW)|K111 as Function of (TOP-REAL 2)|K111,(TOP-REAL
  2)|K1 by A16,A45,FUNCT_2:4;
  the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
  then ((TOP-REAL 2)|K1)|K11=(TOP-REAL 2)|K111 & f2= f4 by A3,FUNCT_1:82
  ,GOBOARD9:4;
  then
A60: f2 is continuous by A3,A10,Th31,PRE_TOPC:56;
  set T1= ((TOP-REAL 2)|K1)|K00,T2=((TOP-REAL 2)|K1)|K11;
A61: [#](((TOP-REAL 2)|K1)|K11)=K11 by PRE_TOPC:def 10;
  K11 c= K004 /\ K1
  proof
    let x be set;
    assume
    x in K11;
    then consider p such that
A62: p=x and
A63: p`2/|.p.|<=sn and
A64: p`1<=0 and
A65: p<>0.TOP-REAL 2;
    p`2/|.p.|*|.p.|<=(sn)*(|.p.|) by A63,XREAL_1:66;
    then p`2<=(sn)*(|.p.|) by A65,TOPRNS_1:25,XCMPLX_1:88;
    then
A66: x in K004 by A62,A64;
    x in K1 by A3,A62,A64,A65;
    hence thesis by A66,XBOOLE_0:def 4;
  end;
  then K11=K004 /\ [#]((TOP-REAL 2)|K1) by A44,A37,XBOOLE_0:def 10;
  then
A67: K11 is closed by A42,PRE_TOPC:43;
A68: K003 /\ K1 c= K00
  proof
    let x be set;
    assume
A69: x in K003 /\ K1;
    then x in K003 by XBOOLE_0:def 4;
    then consider q1 being Point of TOP-REAL 2 such that
A70: q1=x and
A71: q1`2>=(sn)*(|.q1.|) and
    q1`1<=0;
    x in K1 by A69,XBOOLE_0:def 4;
    then
A72: ex q2 being Point of TOP-REAL 2 st q2=x & q2`1<=0 & q2 <>0.TOP-REAL 2
    by A3;
    q1`2/|.q1.|>=(sn)*(|.q1.|)/|.q1.| by A71,XREAL_1:74;
    then q1`2/|.q1.|>=(sn) by A70,A72,TOPRNS_1:25,XCMPLX_1:90;
    hence thesis by A70,A72;
  end;
A73: the carrier of ((TOP-REAL 2)|K1)=K0 by PRE_TOPC:29;
A74: D<>{};
A75: [#](((TOP-REAL 2)|K1)|K00)=K00 by PRE_TOPC:def 10;
A76: for p being set st p in ([#]T1)/\([#]T2) holds f1.p = f2.p
  proof
    let p be set;
    assume
A77: p in ([#]T1)/\([#]T2);
    then p in K00 by A75,XBOOLE_0:def 4;
    hence f1.p=f.p by FUNCT_1:72
      .=f2.p by A61,A77,FUNCT_1:72;
  end;
  K00 c= K003 /\ K1
  proof
    let x be set;
    assume
    x in K00;
    then consider p such that
A78: p=x and
A79: p`2/|.p.|>=sn and
A80: p`1<=0 and
A81: p<>0.TOP-REAL 2;
    p`2/|.p.|*|.p.|>=(sn)*(|.p.|) by A79,XREAL_1:66;
    then p`2>=(sn)*(|.p.|) by A81,TOPRNS_1:25,XCMPLX_1:88;
    then
A82: x in K003 by A78,A80;
    x in K1 by A3,A78,A80,A81;
    hence thesis by A82,XBOOLE_0:def 4;
  end;
  then K00=K003 /\ [#]((TOP-REAL 2)|K1) by A44,A68,XBOOLE_0:def 10;
  then
A83: K00 is closed by A36,PRE_TOPC:43;
A84: K1 c= K00 \/ K11
  proof
    let x be set;
    assume
    x in K1;
    then consider p such that
A85: p=x & p`1<=0 & p<>0.TOP-REAL 2 by A3;
    per cases;
    suppose
      p`2/|.p.|>=sn;
      then x in K00 by A85;
      hence thesis by XBOOLE_0:def 3;
    end;
    suppose
      p`2/|.p.|<sn;
      then x in K11 by A85;
      hence thesis by XBOOLE_0:def 3;
    end;
  end;
  then [#](((TOP-REAL 2)|K1)|K00) \/ [#](((TOP-REAL 2)|K1)|K11) =[#]((
  TOP-REAL 2)|K1) by A75,A61,A44,XBOOLE_0:def 10;
  then consider h being Function of (TOP-REAL 2)|K1,(TOP-REAL 2)|D such that
A86: h=f1+*f2 and
A87: h is continuous by A75,A61,A83,A67,A43,A60,A76,
  JGRAPH_2:9;
A88: dom h=the carrier of ((TOP-REAL 2)|K1) by FUNCT_2:def 1;
A89: dom f1=the carrier of ((TOP-REAL 2)|K1)|K00 by FUNCT_2:def 1
    .=K00 by PRE_TOPC:29;
A90: for y being set st y in dom h holds h.y=f.y
  proof
    let y be set;
    assume
A91: y in dom h;
    now
      per cases by A84,A88,A73,A91,XBOOLE_0:def 3;
      case
A92:    y in K00 & not y in K11;
        then y in dom f1 \/ dom f2 by A89,XBOOLE_0:def 3;
        hence h.y=f1.y by A17,A86,A92,FUNCT_4:def 1
          .=f.y by A92,FUNCT_1:72;
      end;
      case
A93:    y in K11;
        then y in dom f1 \/ dom f2 by A17,XBOOLE_0:def 3;
        hence h.y=f2.y by A17,A86,A93,FUNCT_4:def 1
          .=f.y by A93,FUNCT_1:72;
      end;
    end;
    hence thesis;
  end;
  K0=the carrier of ((TOP-REAL 2)|K0) by PRE_TOPC:29
    .=dom f by A74,FUNCT_2:def 1;
  hence thesis by A87,A88,A90,FUNCT_1:9,PRE_TOPC:29;
end;

theorem Th35:
  for sn being Real, K0,B0 being Subset of TOP-REAL 2, f being
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0 st -1<sn & sn<1 & f=(sn-FanMorphW)|
  K0 & B0=NonZero TOP-REAL 2 & K0={p: p`1>=0 & p<>0.TOP-REAL 2} holds f is
  continuous
proof
  let sn be Real,K0,B0 be Subset of TOP-REAL 2, f be Function of (TOP-REAL 2)|
  K0,(TOP-REAL 2)|B0;
  set cn=sqrt(1-sn^2);
  set p0=|[cn,-sn]|;
  assume
A1: -1<sn & sn<1 & f=(sn-FanMorphW)|K0 & B0=NonZero TOP-REAL 2 & K0={p:
  p`1>=0 & p<>0.TOP-REAL 2};
  then sn^2<1^2 by SQUARE_1:120;
  then
A2: p0`1=cn & 1-sn^2>0 by EUCLID:56,XREAL_1:52;
  then p0<>0.TOP-REAL 2 by JGRAPH_2:11,SQUARE_1:93;
  then not p0 in {0.TOP-REAL 2} by TARSKI:def 1;
  then reconsider D=B0 as non empty Subset of TOP-REAL 2 by A1,XBOOLE_0:def 5;
  p0`1>0 by A2,SQUARE_1:93;
  then p0 in K0 by A1,JGRAPH_2:11;
  then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
A3: K1 c= D
  proof
    let x be set;
    assume
    x in K1;
    then consider p2 being Point of TOP-REAL 2 such that
A4: p2=x and
    p2`1>=0 and
A5: p2<>0.TOP-REAL 2 by A1;
    not p2 in {0.TOP-REAL 2} by A5,TARSKI:def 1;
    hence thesis by A1,A4,XBOOLE_0:def 5;
  end;
  for p being Point of (TOP-REAL 2)|K1,V being Subset of (TOP-REAL 2)|D
st f.p in V & V is open holds ex W being Subset of (TOP-REAL 2)|K1 st p in W &
  W is open & f.:W c= V
  proof
    let p be Point of (TOP-REAL 2)|K1,V be Subset of (TOP-REAL 2)|D;
    assume that
A6: f.p in V and
A7: V is open;
    consider V2 being Subset of TOP-REAL 2 such that
A8: V2 is open and
A9: V2 /\ [#]((TOP-REAL 2)|D)=V by A7,TOPS_2:32;
    reconsider W2=V2 /\ [#]((TOP-REAL 2)|K1) as Subset of (TOP-REAL 2)| K1;
A10: [#]((TOP-REAL 2)|K1)=K1 by PRE_TOPC:def 10;
    then
A11: f.p=(sn-FanMorphW).p by A1,FUNCT_1:72;
A12: f.:W2 c= V
    proof
      let y be set;
      assume
      y in f.:W2;
      then consider x being set such that
A13:  x in dom f and
A14:  x in W2 and
A15:  y=f.x by FUNCT_1:def 12;
      f is Function of (TOP-REAL 2)|K1, (TOP-REAL 2)|D;
      then dom f= K1 by A10,FUNCT_2:def 1;
      then consider p4 being Point of TOP-REAL 2 such that
A16:  x=p4 and
A17:  p4`1>=0 and
      p4<>0.TOP-REAL 2 by A1,A13;
A18:  p4 in V2 by A14,A16,XBOOLE_0:def 4;
      p4 in [#]((TOP-REAL 2)|K1) by A13,A16;
      then p4 in D by A3,A10;
      then
A19:  p4 in [#]((TOP-REAL 2)|D) by PRE_TOPC:def 10;
      f.p4=(sn-FanMorphW).p4 by A1,A10,A13,A16,FUNCT_1:72
        .=p4 by A17,Th23;
      hence thesis by A9,A15,A16,A18,A19,XBOOLE_0:def 4;
    end;
    p in the carrier of (TOP-REAL 2)|K1;
    then consider q being Point of TOP-REAL 2 such that
A20: q=p and
A21: q`1>=0 and
    q <>0.TOP-REAL 2 by A1,A10;
    (sn-FanMorphW).q=q by A21,Th23;
    then p in V2 by A6,A9,A11,A20,XBOOLE_0:def 4;
    then
A22: p in W2 by XBOOLE_0:def 4;
    W2 is open by A8,TOPS_2:32;
    hence thesis by A22,A12;
  end;
  hence thesis by JGRAPH_2:20;
end;

theorem Th36:
  for B0 being Subset of TOP-REAL 2, K0 being Subset of (TOP-REAL
  2)|B0 st B0=NonZero TOP-REAL 2 & K0={p: p`1<=0 & p<>0.TOP-REAL 2} holds K0 is
  closed
proof
  set J0 = NonZero TOP-REAL 2;
  defpred P[Point of TOP-REAL 2] means $1`1<=0;
  set I1 = {p: P[p] & p<>0.TOP-REAL 2};
  let B0 be Subset of TOP-REAL 2,K0 be Subset of (TOP-REAL 2)|B0;
  reconsider K1={p7 where p7 is Point of TOP-REAL 2:P[p7]} as Subset of
  TOP-REAL 2 from JGRAPH_2:sch 1;
A1: I1 = {p7 where p7 is Point of TOP-REAL 2 : P[p7]} /\ J0 from JGRAPH_3:
  sch 2;
  assume
  B0=J0 & K0=I1;
  then K1 is closed & K0=K1 /\ [#]((TOP-REAL 2)|B0) by A1,JORDAN6:6 ,
  PRE_TOPC:def 10;
  hence thesis by PRE_TOPC:43;
end;

theorem Th37:
  for sn being Real, B0 being Subset of TOP-REAL 2, K0 being
Subset of (TOP-REAL 2)|B0, f being Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL
2)|B0) st -1<sn & sn<1 & f=(sn-FanMorphW)|K0 & B0=NonZero TOP-REAL 2 & K0={p: p
  `1<=0 & p<>0.TOP-REAL 2} holds f is continuous
proof
  defpred P[Point of TOP-REAL 2] means $1`1<=0 & $1<>0.TOP-REAL 2;
  let sn be Real,B0 be Subset of TOP-REAL 2,K0 be Subset of (TOP-REAL 2)|B0,f
  be Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0);
  reconsider K1={p: P[p] } as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
  assume
A1: -1<sn & sn<1 & f=(sn-FanMorphW)|K0 & B0=NonZero TOP-REAL 2 & K0={p:
  p`1<=0 & p<>0.TOP-REAL 2 };
  K0 c= B0
  proof
    let x be set;
    assume
    x in K0;
    then
A2: ex p8 being Point of TOP-REAL 2 st x=p8 & p8`1<=0 & p8 <>0.TOP-REAL 2
    by A1;
    then not x in {0.TOP-REAL 2} by TARSKI:def 1;
    hence thesis by A1,A2,XBOOLE_0:def 5;
  end;
  then ((TOP-REAL 2)|B0)|K0=(TOP-REAL 2)|K1 by A1,PRE_TOPC:28;
  hence thesis by A1,Th34;
end;

theorem Th38:
  for B0 being Subset of TOP-REAL 2, K0 being Subset of (TOP-REAL
  2)|B0 st B0=NonZero TOP-REAL 2 & K0={p: p`1>=0 & p<>0.TOP-REAL 2} holds K0 is
  closed
proof
  set J0 = NonZero TOP-REAL 2;
  defpred P[Point of TOP-REAL 2] means $1`1>=0;
  set I1 = {p: P[p] & p<>0.TOP-REAL 2};
  let B0 be Subset of TOP-REAL 2,K0 be Subset of (TOP-REAL 2)|B0;
  reconsider K1={p7 where p7 is Point of TOP-REAL 2:P[p7]} as Subset of
  TOP-REAL 2 from JGRAPH_2:sch 1;
A1: I1 = {p7 where p7 is Point of TOP-REAL 2 : P[p7]} /\ J0 from JGRAPH_3:
  sch 2;
  assume
  B0=J0 & K0=I1;
  then K1 is closed & K0=K1 /\ [#]((TOP-REAL 2)|B0) by A1,JORDAN6:5 ,
  PRE_TOPC:def 10;
  hence thesis by PRE_TOPC:43;
end;

theorem Th39:
  for sn being Real, B0 being Subset of TOP-REAL 2,K0 being Subset
  of (TOP-REAL 2)|B0,f being Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0)
st -1<sn & sn<1 & f=(sn-FanMorphW)|K0 & B0=NonZero TOP-REAL 2 & K0={p: p`1>=0 &
  p<>0.TOP-REAL 2} holds f is continuous
proof
  let sn be Real, B0 be Subset of TOP-REAL 2,K0 be Subset of (TOP-REAL 2)|B0,f
  be Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0);
  the carrier of (TOP-REAL 2)|B0= B0 by PRE_TOPC:29;
  then reconsider K1=K0 as Subset of TOP-REAL 2 by XBOOLE_1:1;
  assume
A1: -1<sn & sn<1 & f=(sn-FanMorphW)|K0 & B0=NonZero TOP-REAL 2 & K0={p:
  p`1>=0 & p<>0.TOP-REAL 2};
  K0 c= B0
  proof
    let x be set;
    assume
    x in K0;
    then
A2: ex p8 being Point of TOP-REAL 2 st x=p8 & p8`1>=0 & p8 <>0.TOP-REAL 2
    by A1;
    then not x in {0.TOP-REAL 2} by TARSKI:def 1;
    hence thesis by A1,A2,XBOOLE_0:def 5;
  end;
  then ((TOP-REAL 2)|B0)|K0=(TOP-REAL 2)|K1 by PRE_TOPC:28;
  hence thesis by A1,Th35;
end;

theorem Th40:
  for sn being Real,p being Point of TOP-REAL 2 holds |.(sn
  -FanMorphW).p.|=|.p.|
proof
  let sn be Real,p be Point of TOP-REAL 2;
  set z=(sn-FanMorphW).p;
  reconsider q=p,qz=z as Point of TOP-REAL 2;
  per cases;
  suppose
A1: q`2/|.q.|>=sn & q`1<0;
    then
A2: (sn-FanMorphW).q= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)), |.q.|
    * ((q`2/|.q.|-sn)/(1-sn))]| by Th23;
    then
A3: qz`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)) by EUCLID:56;
A4: qz`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by A2,EUCLID:56;
A5: (q`2/|.q.|-sn)>=0 by A1,XREAL_1:50;
A6: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
    |.q.|<>0 by A1,JGRAPH_2:11,TOPRNS_1:25;
    then
A7: (|.q.|)^2>0 by SQUARE_1:74;
    0<=(q`1)^2 by XREAL_1:65;
    then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
    then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A6,XREAL_1:74;
    then (q`2)^2/(|.q.|)^2 <= 1 by A7,XCMPLX_1:60;
    then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
    then 1>=q`2/|.q.| by SQUARE_1:121;
    then
A8: 1-sn>=q`2/|.q.|-sn by XREAL_1:11;
    per cases;
    suppose
A9:   1-sn=0;
A10:  ((q`2/|.q.|-sn)/(1-sn))=(q`2/|.q.|-sn)*(1-sn)" by XCMPLX_0:def 9
        .= (q`2/|.q.|-sn)*0 by A9
        .=0;
      then -sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)=-1 by SQUARE_1:83;
      then (sn-FanMorphW).q= |[|.q.|*(-1),|.q.|*0]| by A1,A10,Th23
        .=|[-(|.q.|),0]|;
      then ((sn-FanMorphW).q)`1=-(|.q.|) & ((sn-FanMorphW).q)`2=0 by
      EUCLID:56;
      then |.(sn-FanMorphW).p.|=sqrt((-(|.q.|))^2+0^2) by JGRAPH_3:10
        .=sqrt((|.q.|)^2)
        .=|.q.| by SQUARE_1:89;
      hence thesis;
    end;
    suppose
A11:  1-sn<>0;
      per cases by A11;
      suppose
A12:    1-sn>0;
        -(1-sn)<= -( q`2/|.q.|-sn) by A8,XREAL_1:26;
        then (-(1-sn))/(1-sn)<=(-( q`2/|.q.|-sn))/(1-sn) by A12,
        XREAL_1:74;
        then -1<=(-( q`2/|.q.|-sn))/(1-sn) by A12,XCMPLX_1:198;
        then ((-(q`2/|.q.|-sn))/(1-sn))^2<=1^2 by A5,A12,SQUARE_1:119;
        then 1-((-(q`2/|.q.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
        then
A13:    1-(-((q`2/|.q.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
A14:    (qz`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))^2 by A3
          .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1-sn))^2) by A13,SQUARE_1:def 4;
        (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
          .=(|.q.|)^2 by A4,A14;
        then sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
        hence thesis by SQUARE_1:89;
      end;
      suppose
A15:    1-sn<0;
        0+(q`2)^2<(q`1)^2+(q`2)^2 by A1,SQUARE_1:74,XREAL_1:10;
        then (q`2)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A7,A6,XREAL_1:76;
        then (q`2)^2/(|.q.|)^2 < 1 by A7,XCMPLX_1:60;
        then ((q`2)/|.q.|)^2 < 1 by XCMPLX_1:77;
        then
A16:    1 > q`2/|.p.| by SQUARE_1:122;
        q`2/|.q.|-sn>=0 by A1,XREAL_1:50;
        hence thesis by A15,A16,XREAL_1:11;
      end;
    end;
  end;
  suppose
A17: q`2/|.q.|<sn & q`1<0;
    then |.q.|<>0 by JGRAPH_2:11,TOPRNS_1:25;
    then
A18: (|.q.|)^2>0 by SQUARE_1:74;
A19: (q`2/|.q.|-sn)<0 by A17,XREAL_1:51;
A20: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
    0<=(q`1)^2 by XREAL_1:65;
    then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
    then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A20,XREAL_1:74;
    then (q`2)^2/(|.q.|)^2 <= 1 by A18,XCMPLX_1:60;
    then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
    then -1<=q`2/|.q.| by SQUARE_1:121;
    then
A21: -1-sn<=q`2/|.q.|-sn by XREAL_1:11;
A22: (sn-FanMorphW).q= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)), |.q
    .|* ((q`2/|.q.|-sn)/(1+sn))]| by A17,Th24;
    then
A23: qz`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)) by EUCLID:56;
A24: qz`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by A22,EUCLID:56;
    per cases;
    suppose
A25:  1+sn=0;
      ((q`2/|.q.|-sn)/(1+sn))=(q`2/|.q.|-sn)*(1+sn)" by XCMPLX_0:def 9
        .= (q`2/|.q.|-sn)*0 by A25
        .=0;
      then ((sn-FanMorphW).q)`1=-(|.q.|) & ((sn-FanMorphW).q)`2=0 by A22,
      EUCLID:56 ,SQUARE_1:83;
      then |.(sn-FanMorphW).p.|=sqrt((-(|.q.|))^2+0^2) by JGRAPH_3:10
        .=sqrt((|.q.|)^2)
        .=|.q.| by SQUARE_1:89;
      hence thesis;
    end;
    suppose
A26:  1+sn<>0;
      per cases by A26;
      suppose
A27:    1+sn>0;
        then (-(1+sn))/(1+sn)<=(( q`2/|.q.|-sn))/(1+sn) by A21,
        XREAL_1:74;
        then -1<=(( q`2/|.q.|-sn))/(1+sn) by A27,XCMPLX_1:198;
        then ( (q`2/|.q.|-sn) /(1+sn))^2<=1^2 by A19,A27,SQUARE_1:119;
        then
A28:    1-(((q`2/|.q.|-sn))/(1+sn))^2>=0 by XREAL_1:50;
A29:    (qz`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))^2 by A23
          .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1+sn))^2) by A28,SQUARE_1:def 4;
        (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
          .=(|.q.|)^2 by A24,A29;
        then sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
        hence thesis by SQUARE_1:89;
      end;
      suppose
A30:    1+sn<0;
        0+(q`2)^2<(q`1)^2+(q`2)^2 by A17,SQUARE_1:74,XREAL_1:10;
        then (q`2)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A18,A20,
        XREAL_1:76;
        then (q`2)^2/(|.q.|)^2 < 1 by A18,XCMPLX_1:60;
        then ((q`2)/|.q.|)^2 < 1 by XCMPLX_1:77;
        then -1 < q`2/|.p.| by SQUARE_1:122;
        then
A31:    q`2/|.q.|-sn>-1-sn by XREAL_1:11;
        -(1+sn)>-0 by A30,XREAL_1:26;
        hence thesis by A17,A31,XREAL_1:51;
      end;
    end;
  end;
  suppose
    q`1>=0;
    hence thesis by Th23;
  end;
end;

theorem Th41:
  for sn being Real,x,K0 being set st -1<sn & sn<1 & x in K0 & K0=
  {p: p`1<=0 & p<>0.TOP-REAL 2} holds (sn-FanMorphW).x in K0
proof
  let sn be Real,x,K0 be set;
  assume
A1: -1<sn & sn<1 & x in K0 & K0={p: p`1<=0 & p<>0.TOP-REAL 2};
  then consider p such that
A2: p=x and
A3: p`1<=0 and
A4: p<>0.TOP-REAL 2;
A5: now
    assume
    |.p.|<=0;
    then |.p.|=0;
    hence contradiction by A4,TOPRNS_1:25;
  end;
  then
A6: (|.p.|)^2>0 by SQUARE_1:74;
  per cases;
  suppose
A7: p`2/|.p.|<=sn;
    reconsider p9= (sn-FanMorphW).p as Point of TOP-REAL 2;
    (sn-FanMorphW).p= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)), |.p
    .|*((p`2/|.p.|-sn)/(1+sn))]| by A1,A3,A4,A7,Th25;
    then
A8: p9`1=|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)) by EUCLID:56;
A9: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
A10: 1+sn>0 by A1,XREAL_1:150;
    per cases;
    suppose
      p`1=0;
      hence thesis by A1,A2,Th23;
    end;
    suppose
      p`1<>0;
      then 0+(p`2)^2<(p`1)^2+(p`2)^2 by SQUARE_1:74,XREAL_1:10;
      then (p`2)^2/(|.p.|)^2 < (|.p.|)^2/(|.p.|)^2 by A6,A9,XREAL_1:76;
      then (p`2)^2/(|.p.|)^2 < 1 by A6,XCMPLX_1:60;
      then ((p`2)/|.p.|)^2 < 1 by XCMPLX_1:77;
      then -1 < p`2/|.p.| by SQUARE_1:122;
      then -1-sn< p`2/|.p.|-sn by XREAL_1:11;
      then (-1)*(1+sn)/(1+sn)< (p`2/|.p.|-sn)/(1+sn) by A10,XREAL_1:76;
      then
A11:  -1< (p`2/|.p.|-sn)/(1+sn) by A10,XCMPLX_1:90;
      p`2/|.p.|-sn<=0 by A7,XREAL_1:49;
      then 1^2> ((p`2/|.p.|-sn)/(1+sn))^2 by A10,A11,SQUARE_1:120;
      then 1-((p`2/|.p.|-sn)/(1+sn))^2>0 by XREAL_1:52;
      then --sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)>0 by SQUARE_1:93;
      then -sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)<0;
      then |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2))<0 by A5,
      XREAL_1:134;
      hence thesis by A1,A2,A8,JGRAPH_2:11;
    end;
  end;
  suppose
A12: p`2/|.p.|>sn;
    reconsider p9= (sn-FanMorphW).p as Point of TOP-REAL 2;
    (sn-FanMorphW).p= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)), |.p
    .|*((p`2/|.p.|-sn)/(1-sn))]| by A1,A3,A4,A12,Th25;
    then
A13: p9`1=|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)) by EUCLID:56;
A14: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
A15: 1-sn>0 by A1,XREAL_1:151;
    per cases;
    suppose
      p`1=0;
      hence thesis by A1,A2,Th23;
    end;
    suppose
      p`1<>0;
      then 0+(p`2)^2<(p`1)^2+(p`2)^2 by SQUARE_1:74,XREAL_1:10;
      then (p`2)^2/(|.p.|)^2 < (|.p.|)^2/(|.p.|)^2 by A6,A14,XREAL_1:76;
      then (p`2)^2/(|.p.|)^2 < 1 by A6,XCMPLX_1:60;
      then ((p`2)/|.p.|)^2 < 1 by XCMPLX_1:77;
      then p`2/|.p.|<1 by SQUARE_1:122;
      then (p`2/|.p.|-sn)<1-sn by XREAL_1:11;
      then (p`2/|.p.|-sn)/(1-sn)<(1-sn)/(1-sn) by A15,XREAL_1:76;
      then
A16:  (p`2/|.p.|-sn)/(1-sn)<1 by A15,XCMPLX_1:60;
      -(1-sn)< -0 & p`2/|.p.|-sn>=sn-sn by A12,A15,XREAL_1:11,26;
      then (-1)*(1-sn)/(1-sn)< (p`2/|.p.|-sn)/(1-sn) by A15,XREAL_1:76;
      then -1< (p`2/|.p.|-sn)/(1-sn) by A15,XCMPLX_1:90;
      then 1^2> ((p`2/|.p.|-sn)/(1-sn))^2 by A16,SQUARE_1:120;
      then 1-((p`2/|.p.|-sn)/(1-sn))^2>0 by XREAL_1:52;
      then --sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)>0 by SQUARE_1:93;
      then -sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)<0;
      then p9`1<0 by A5,A13,XREAL_1:134;
      hence thesis by A1,A2,JGRAPH_2:11;
    end;
  end;
end;

theorem Th42:
  for sn being Real,x,K0 being set st -1<sn & sn<1 & x in K0 & K0=
  {p: p`1>=0 & p<>0.TOP-REAL 2} holds (sn-FanMorphW).x in K0
proof
  let sn be Real,x,K0 be set;
  assume
A1: -1<sn & sn<1 & x in K0 & K0={p: p`1>=0 & p<>0.TOP-REAL 2};
  then ex p st p=x & p`1>=0 & p<>0.TOP-REAL 2;
  hence thesis by A1,Th23;
end;

scheme
  InclSub { D() -> non empty Subset of TOP-REAL 2, P[set] } : { p : P[p] & p<>
  0.TOP-REAL 2 } c= the carrier of (TOP-REAL 2)|D()
provided
A1: D() = NonZero TOP-REAL 2
proof
  let x be set;
  assume
  x in {p: P[p] & p<>0.TOP-REAL 2};
  then
A2: ex p st x=p &( P[p])& p<>0.TOP-REAL 2;
A3: D()` = {0.TOP-REAL 2} by A1,JGRAPH_3:30;
  now
    assume
    not x in D();
    then x in (the carrier of TOP-REAL 2) \ D() by A2,XBOOLE_0:def 5;
    then x in D()` by SUBSET_1:def 5;
    hence contradiction by A3,A2,TARSKI:def 1;
  end;
  hence thesis by PRE_TOPC:29;
end;

theorem Th43:
  for sn being Real, D being non empty Subset of TOP-REAL 2 st -1<
  sn & sn<1 & D`={0.TOP-REAL 2} holds ex h being Function of (TOP-REAL 2)|D,(
  TOP-REAL 2)|D st h=(sn-FanMorphW)|D & h is continuous
proof
  (|[0,1]|)`1=0 & (|[0,1]|)`2=1 by EUCLID:56;
  then
A1: |[0,1]| in {p where p is Point of TOP-REAL 2: p`1<=0 & p<>0.TOP-REAL 2}
  by JGRAPH_2:11;
  set Y1=|[0,1]|;
  defpred P[Point of TOP-REAL 2] means $1`1<=0;
  reconsider B0= {0.TOP-REAL 2} as Subset of TOP-REAL 2;
  let sn be Real,D be non empty Subset of TOP-REAL 2;
  assume that
A2: -1<sn & sn<1 and
A3: D`={0.TOP-REAL 2};
A4: the carrier of ((TOP-REAL 2)|D)=D by PRE_TOPC:29;
A5: D =(B0)` by A3
    .=(NonZero TOP-REAL 2) by SUBSET_1:def 5;
  {p: P[p] & p<>0.TOP-REAL 2} c= the carrier of (TOP-REAL 2)|D from
  InclSub(A5);
  then reconsider
  K0={p:p`1<=0 & p<>0.TOP-REAL 2} as non empty Subset of (TOP-REAL
  2)|D by A1;
A6: K0 =the carrier of ((TOP-REAL 2)|D)|K0 by PRE_TOPC:29;
A7: the carrier of ((TOP-REAL 2)|D) =D by PRE_TOPC:29;
A8: rng ((sn-FanMorphW)|K0) c= the carrier of ((TOP-REAL 2)|D)|K0
  proof
    let y be set;
    assume
    y in rng ((sn-FanMorphW)|K0);
    then consider x being set such that
A9: x in dom ((sn-FanMorphW)|K0) and
A10: y=((sn-FanMorphW)|K0).x by FUNCT_1:def 5;
    x in (dom (sn-FanMorphW)) /\ K0 by A9,RELAT_1:90;
    then
A11: x in K0 by XBOOLE_0:def 4;
    K0 c= the carrier of TOP-REAL 2 by A7,XBOOLE_1:1;
    then reconsider p=x as Point of TOP-REAL 2 by A11;
    (sn-FanMorphW).p=y by A10,A11,FUNCT_1:72;
    then y in K0 by A2,A11,Th41;
    hence thesis by PRE_TOPC:29;
  end;
A12: K0 c= (the carrier of TOP-REAL 2)
  proof
    let z be set;
    assume
    z in K0;
    then ex p8 being Point of TOP-REAL 2 st p8=z & p8`1<=0 & p8 <>0.TOP-REAL 2;
    hence thesis;
  end;
  Y1`1=0 & Y1`2=1 by EUCLID:56;
  then
A13: Y1 in {p where p is Point of TOP-REAL 2: p`1>=0 & p<>0.TOP-REAL 2} by
  JGRAPH_2:11;
A14: the carrier of ((TOP-REAL 2)|D) = (NonZero TOP-REAL 2) by A5,PRE_TOPC:
  29;
  defpred P[Point of TOP-REAL 2] means $1`1>=0;
  {p: P[p] & p<>0.TOP-REAL 2} c= the carrier of (TOP-REAL 2)|D from
  InclSub(A5);
  then reconsider
  K1={p: p`1>=0 & p<>0.TOP-REAL 2} as non empty Subset of (TOP-REAL
  2)|D by A13;
A15: K0 is closed & K1 is closed by A5,Th36,Th38;
  dom ((sn-FanMorphW)|K0)= dom ((sn-FanMorphW)) /\ K0 by RELAT_1:90
    .=((the carrier of TOP-REAL 2)) /\ K0 by FUNCT_2:def 1
    .=K0 by A12,XBOOLE_1:28;
  then reconsider f=(sn-FanMorphW)|K0 as Function of ((TOP-REAL 2)|D)|K0, ((
  TOP-REAL 2)|D) by A6,A8,FUNCT_2:4,XBOOLE_1:1;
A16: K1=the carrier of ((TOP-REAL 2)|D)|K1 by PRE_TOPC:29;
A17: rng ((sn-FanMorphW)|K1) c= the carrier of ((TOP-REAL 2)|D)|K1
  proof
    let y be set;
    assume
    y in rng ((sn-FanMorphW)|K1);
    then consider x being set such that
A18: x in dom ((sn-FanMorphW)|K1) and
A19: y=((sn-FanMorphW)|K1).x by FUNCT_1:def 5;
    x in (dom (sn-FanMorphW)) /\ K1 by A18,RELAT_1:90;
    then
A20: x in K1 by XBOOLE_0:def 4;
    K1 c= the carrier of TOP-REAL 2 by A7,XBOOLE_1:1;
    then reconsider p=x as Point of TOP-REAL 2 by A20;
    (sn-FanMorphW).p=y by A19,A20,FUNCT_1:72;
    then y in K1 by A2,A20,Th42;
    hence thesis by PRE_TOPC:29;
  end;
A21: K1 c= (the carrier of TOP-REAL 2)
  proof
    let z be set;
    assume
    z in K1;
    then ex p8 being Point of TOP-REAL 2 st p8=z & p8`1>=0 & p8 <>0.TOP-REAL 2;
    hence thesis;
  end;
  dom ((sn-FanMorphW)|K1)= dom ((sn-FanMorphW)) /\ K1 by RELAT_1:90
    .=((the carrier of TOP-REAL 2)) /\ K1 by FUNCT_2:def 1
    .=K1 by A21,XBOOLE_1:28;
  then reconsider g=(sn-FanMorphW)|K1 as Function of ((TOP-REAL 2)|D)|K1, ((
  TOP-REAL 2)|D) by A16,A17,FUNCT_2:4,XBOOLE_1:1;
A22: K1=[#](((TOP-REAL 2)|D)|K1) by PRE_TOPC:def 10;
A23: D c= K0 \/ K1
  proof
    let x be set;
    assume
A24: x in D;
    then reconsider px=x as Point of TOP-REAL 2;
    not x in {0.TOP-REAL 2} by A5,A24,XBOOLE_0:def 5;
    then px`1<=0 & px<>0.TOP-REAL 2 or px`1>=0 & px<>0.TOP-REAL 2 by
    TARSKI:def 1;
    then x in K0 or x in K1;
    hence thesis by XBOOLE_0:def 3;
  end;
A25: dom f=K0 by A6,FUNCT_2:def 1;
A26: K0=[#](((TOP-REAL 2)|D)|K0) by PRE_TOPC:def 10;
A27: for x be set st x in ([#]((((TOP-REAL 2)|D)|K0))) /\ ([#] ((((TOP-REAL
  2)|D)|K1))) holds f.x = g.x
  proof
    let x be set;
    assume
A28: x in ([#]((((TOP-REAL 2)|D)|K0))) /\ ([#] ((((TOP-REAL 2)|D)|K1))
    );
    then x in K0 by A26,XBOOLE_0:def 4;
    then f.x=(sn-FanMorphW).x by FUNCT_1:72;
    hence thesis by A22,A28,FUNCT_1:72;
  end;
  D= [#]((TOP-REAL 2)|D) by PRE_TOPC:def 10;
  then
A29: ([#](((TOP-REAL 2)|D)|K0)) \/ ([#](((TOP-REAL 2)|D)|K1)) = [#]((
  TOP-REAL 2)|D) by A26,A22,A23,XBOOLE_0:def 10;
A30: f is continuous & g is continuous by A2,A5,Th37,Th39;
  then consider h being Function of (TOP-REAL 2)|D,(TOP-REAL 2)|D such that
A31: h= f+*g and
  h is continuous by A26,A22,A29,A15,A27,JGRAPH_2:9;
A32: dom h=the carrier of ((TOP-REAL 2)|D) by FUNCT_2:def 1;
A33: dom g=K1 by A16,FUNCT_2:def 1;
  K0=[#](((TOP-REAL 2)|D)|K0) & K1=[#](((TOP-REAL 2)|D)|K1) by PRE_TOPC:
  def 10;
  then
A34: f tolerates g by A27,A25,A33,PARTFUN1:def 6;
A35: for x being set st x in dom h holds h.x=((sn-FanMorphW)|D).x
  proof
    let x be set;
    assume
A36: x in dom h;
    then reconsider p=x as Point of TOP-REAL 2 by A14,XBOOLE_0:def 5;
A37: x in D`` by A32,A36,PRE_TOPC:29;
    not x in {0.TOP-REAL 2} by A14,A36,XBOOLE_0:def 5;
    then
A38: x <>0.TOP-REAL 2 by TARSKI:def 1;
    per cases;
    suppose
A39:  x in K0;
A40:  (sn-FanMorphW)|D.p=(sn-FanMorphW).p by A37,FUNCT_1:72
        .=f.p by A39,FUNCT_1:72;
      h.p=(g+*f).p by A31,A34,FUNCT_4:35
        .=f.p by A25,A39,FUNCT_4:14;
      hence thesis by A40;
    end;
    suppose
      not x in K0;
      then not p`1<=0 by A38;
      then
A41:  x in K1 by A38;
      (sn-FanMorphW)|D.p=(sn-FanMorphW).p by A37,FUNCT_1:72
        .=g.p by A41,FUNCT_1:72;
      hence thesis by A31,A33,A41,FUNCT_4:14;
    end;
  end;
  dom (sn-FanMorphW)=(the carrier of (TOP-REAL 2)) by FUNCT_2:def 1;
  then dom ((sn-FanMorphW)|D)=(the carrier of (TOP-REAL 2))/\ D by
  RELAT_1:90
    .=the carrier of ((TOP-REAL 2)|D) by A4,XBOOLE_1:28;
  then f+*g=(sn-FanMorphW)|D by A31,A32,A35,FUNCT_1:9;
  hence thesis by A26,A22,A29,A30,A15,A27,JGRAPH_2:9;
end;

Lm11: the TopStruct of TOP-REAL 2 = TopSpaceMetr Euclid 2 by EUCLID:def 8;

theorem Th44:
  for sn being Real st -1<sn & sn<1 holds ex h being Function of (
  TOP-REAL 2),(TOP-REAL 2) st h=(sn-FanMorphW) & h is continuous
proof
  reconsider D=NonZero TOP-REAL 2 as non empty Subset of TOP-REAL 2 by
  JGRAPH_2:19;
  let sn be Real;
  assume that
A1: -1<sn and
A2: sn<1;
  reconsider f=(sn-FanMorphW) as Function of (TOP-REAL 2),(TOP-REAL 2);
A3: f.(0.TOP-REAL 2)=0.TOP-REAL 2 by Th23,JGRAPH_2:11;
A4: for p being Point of (TOP-REAL 2)|D holds f.p<>f.(0.TOP-REAL 2)
  proof
    let p be Point of (TOP-REAL 2)|D;
A5: [#]((TOP-REAL 2)|D)=D by PRE_TOPC:def 10;
    then reconsider q=p as Point of TOP-REAL 2 by XBOOLE_0:def 5;
    not p in {0.TOP-REAL 2} by A5,XBOOLE_0:def 5;
    then
A6: p<>0.TOP-REAL 2 by TARSKI:def 1;
    per cases;
    suppose
A7:   q`2/|.q.|>=sn & q`1<=0;
      set q9= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)), |.q.|* ((q`2/|.q
      .|-sn)/(1-sn))]|;
A8:   q9`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by EUCLID:56;
A9:   q9`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)) by EUCLID:56;
      now
        assume
A10:    q9=0.TOP-REAL 2;
A11:    |.q.|<>0^2 by A6,TOPRNS_1:25;
        then -sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)=-sqrt(1-0) by A8,A10,
        JGRAPH_2:11,XCMPLX_1:6
          .=-1 by SQUARE_1:83;
        hence contradiction by A9,A10,A11,JGRAPH_2:11,XCMPLX_1:6;
      end;
      hence thesis by A1,A2,A3,A6,A7,Th25;
    end;
    suppose
A12:  q`2/|.q.|<sn & q`1<=0;
      set q9=|[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)), |.q.|* ((q`2/|.q.|
      -sn)/(1+sn))]|;
A13:  q9`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by EUCLID:56;
A14:  q9`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)) by EUCLID:56;
      now
        assume
A15:    q9=0.TOP-REAL 2;
A16:    |.q.|<>0^2 by A6,TOPRNS_1:25;
        then -sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)=-sqrt(1-0) by A13,A15,
        JGRAPH_2:11,XCMPLX_1:6
          .=-1 by SQUARE_1:83;
        hence contradiction by A14,A15,A16,JGRAPH_2:11,XCMPLX_1:6;
      end;
      hence thesis by A1,A2,A3,A6,A12,Th25;
    end;
    suppose
      q`1>0;
      then f.p=p by Th23;
      hence thesis by A6,Th23,JGRAPH_2:11;
    end;
  end;
A17: for V being Subset of (TOP-REAL 2) st f.(0.TOP-REAL 2) in V & V is open
ex W being Subset of (TOP-REAL 2) st 0.TOP-REAL 2 in W & W is open & f.:W c= V
  proof
    reconsider u0=0.TOP-REAL 2 as Point of Euclid 2 by EUCLID:71;
    let V be Subset of TOP-REAL 2;
    reconsider VV = V as Subset of TopSpaceMetr Euclid 2 by Lm11;
    assume that
A18: f.(0.TOP-REAL 2) in V and
A19: V is open;
    VV is open by A19,Lm11,PRE_TOPC:60;
    then consider r being real number such that
A20: r>0 and
A21: Ball(u0,r) c= V by A3,A18,TOPMETR:22;
    reconsider r as Real by XREAL_0:def 1;
    the TopStruct of TOP-REAL 2 = TopSpaceMetr Euclid 2 by EUCLID:def 8;
    then reconsider W1=Ball(u0,r) as Subset of TOP-REAL 2;
A22: W1 is open by GOBOARD6:6;
A23: f.:W1 c= W1
    proof
      let z be set;
      assume
      z in f.:W1;
      then consider y being set such that
A24:  y in dom f and
A25:  y in W1 and
A26:  z=f.y by FUNCT_1:def 12;
      z in rng f by A24,A26,FUNCT_1:def 5;
      then reconsider qz=z as Point of TOP-REAL 2;
      reconsider pz=qz as Point of Euclid 2 by EUCLID:71;
      reconsider q=y as Point of TOP-REAL 2 by A24;
      reconsider qy=q as Point of Euclid 2 by EUCLID:71;
      dist(u0,qy)<r by A25,METRIC_1:12;
      then
A27:  |.(0.TOP-REAL 2) - q.|<r by JGRAPH_1:45;
      per cases by JGRAPH_2:11;
      suppose
        q`1>=0;
        hence thesis by A25,A26,Th23;
      end;
      suppose
A28:    q<>0.TOP-REAL 2 & q`2/|.q.|>=sn & q`1<=0;
        then
A29:    (q`2/|.q.|-sn)>= 0 by XREAL_1:50;
        0<=(q`1)^2 by XREAL_1:65;
        then (|.q.|)^2 =(q`1)^2+(q`2)^2 & 0+(q`2)^2<=(q`1)^2+(q`2)^2 by
        JGRAPH_3:10 ,XREAL_1:9;
        then
A30:    (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by XREAL_1:74;
A31:    1-sn>0 by A2,XREAL_1:151;
        |.q.|<>0 by A28,TOPRNS_1:25;
        then (|.q.|)^2>0 by SQUARE_1:74;
        then (q`2)^2/(|.q.|)^2 <= 1 by A30,XCMPLX_1:60;
        then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then 1>=q`2/|.q.| by SQUARE_1:121;
        then 1-sn>=q`2/|.q.|-sn by XREAL_1:11;
        then -(1-sn)<= -( q`2/|.q.|-sn) by XREAL_1:26;
        then (-(1-sn))/(1-sn)<=(-( q`2/|.q.|-sn))/(1-sn) by A31,
        XREAL_1:74;
        then -1<=(-( q`2/|.q.|-sn))/(1-sn) by A31,XCMPLX_1:198;
        then ((-(q`2/|.q.|-sn))/(1-sn))^2<=1^2 by A31,A29,SQUARE_1:119;
        then 1-((-(q`2/|.q.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
        then
A32:    1-(-((q`2/|.q.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
A33:    (sn-FanMorphW).q= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn) )^2)),
        |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by A1,A2,A28,Th25;
        then
A34:    qz`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by A26,EUCLID:56;
        qz`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)) by A26,A33,
        EUCLID:56;
        then
A35:    (qz`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))^2
          .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1-sn))^2) by A32,SQUARE_1:def 4;
        (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
          .=(|.q.|)^2 by A34,A35;
        then sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
        then
A36:    |.qz.|=|.q.| by SQUARE_1:89;
        |.- q.|<r by A27,EUCLID:31;
        then |.q.|<r by TOPRNS_1:27;
        then |.- qz.|<r by A36,TOPRNS_1:27;
        then |.(0.TOP-REAL 2) - qz.|<r by EUCLID:31;
        then dist(u0,pz)<r by JGRAPH_1:45;
        hence thesis by METRIC_1:12;
      end;
      suppose
A37:    q<>0.TOP-REAL 2 & q`2/|.q.|<sn & q`1<=0;
        0<=(q`1)^2 by XREAL_1:65;
        then (|.q.|)^2 =(q`1)^2+(q`2)^2 & 0+(q`2)^2<=(q`1)^2+(q`2)^2 by
        JGRAPH_3:10 ,XREAL_1:9;
        then
A38:    (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by XREAL_1:74;
A39:    1+sn>0 by A1,XREAL_1:150;
        |.q.|<>0 by A37,TOPRNS_1:25;
        then (|.q.|)^2>0 by SQUARE_1:74;
        then (q`2)^2/(|.q.|)^2 <= 1 by A38,XCMPLX_1:60;
        then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then -1<=q`2/|.q.| by SQUARE_1:121;
        then --1>=-q`2/|.q.| by XREAL_1:26;
        then 1+sn>=-q`2/|.q.|+sn by XREAL_1:9;
        then
A40:    (-(q`2/|.q.|-sn))/(1+sn)<=1 by A39,XREAL_1:187;
        (sn-q`2/|.q.|)>=0 by A37,XREAL_1:50;
        then -1<=(-( q`2/|.q.|-sn))/(1+sn) by A39;
        then ((-(q`2/|.q.|-sn))/(1+sn))^2<=1^2 by A40,SQUARE_1:119;
        then 1-((-(q`2/|.q.|-sn))/(1+sn))^2>=0 by XREAL_1:50;
        then
A41:    1-(-((q`2/|.q.|-sn))/(1+sn))^2>=0 by XCMPLX_1:188;
A42:    (sn-FanMorphW).q= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn) )^2)),
        |.q.|* ((q`2/|.q.|-sn)/(1+sn))]| by A1,A2,A37,Th25;
        then
A43:    qz`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by A26,EUCLID:56;
        qz`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)) by A26,A42,
        EUCLID:56;
        then
A44:    (qz`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))^2
          .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1+sn))^2) by A41,SQUARE_1:def 4;
        (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
          .=(|.q.|)^2 by A43,A44;
        then sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
        then
A45:    |.qz.|=|.q.| by SQUARE_1:89;
        |.- q.|<r by A27,EUCLID:31;
        then |.q.|<r by TOPRNS_1:27;
        then |.- qz.|<r by A45,TOPRNS_1:27;
        then |.(0.TOP-REAL 2) - qz.|<r by EUCLID:31;
        then dist(u0,pz)<r by JGRAPH_1:45;
        hence thesis by METRIC_1:12;
      end;
    end;
    u0 in W1 by A20,GOBOARD6:4;
    hence thesis by A21,A22,A23,XBOOLE_1:1;
  end;
A46: D`= {0.TOP-REAL 2} by JGRAPH_3:30;
  then
  ex h being Function of (TOP-REAL 2)|D,(TOP-REAL 2)|D st h=(sn-FanMorphW
  )|D & h is continuous by A1,A2,Th43;
  hence thesis by A3,A46,A4,A17,JGRAPH_3:13;
end;

theorem Th45:
  for sn being Real st -1<sn & sn<1 holds sn-FanMorphW is
  one-to-one
proof
  let sn be Real;
  assume that
A1: -1<sn and
A2: sn<1;
  for x1,x2 being set st x1 in dom (sn-FanMorphW) & x2 in dom (sn
  -FanMorphW) & (sn-FanMorphW).x1=(sn-FanMorphW).x2 holds x1=x2
  proof
    let x1,x2 be set;
    assume that
A3: x1 in dom (sn-FanMorphW) and
A4: x2 in dom (sn-FanMorphW) and
A5: (sn-FanMorphW).x1=(sn-FanMorphW).x2;
    reconsider p2=x2 as Point of TOP-REAL 2 by A4;
    reconsider p1=x1 as Point of TOP-REAL 2 by A3;
    set q=p1,p=p2;
A6: 1-sn>0 by A2,XREAL_1:151;
    now
      per cases by JGRAPH_2:11;
      case
A7:     q`1>=0;
        then
A8:     (sn-FanMorphW).q=q by Th23;
        now
          per cases by JGRAPH_2:11;
          case
            p`1>=0;
            hence thesis by A5,A8,Th23;
          end;
          case
A9:         p<>0.TOP-REAL 2 & p`2/|.p.|>=sn & p`1<=0;
            set p4= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)), |.p.|* ((p
            `2/|.p.|-sn)/(1-sn))]|;
A10:        (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
            0<=(p`1)^2 by XREAL_1:65;
            then 0+(p`2)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
            then
A11:        (p`2)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by A10,XREAL_1:
            74;
A12:        |.p.|>0 by A9,Lm1;
            then (|.p.|)^2>0 by SQUARE_1:74;
            then (p`2)^2/(|.p.|)^2 <= 1 by A11,XCMPLX_1:60;
            then ((p`2)/|.p.|)^2 <= 1 by XCMPLX_1:77;
            then 1>=p`2/|.p.| by SQUARE_1:121;
            then 1-sn>=p`2/|.p.|-sn by XREAL_1:11;
            then -(1-sn)<= -( p`2/|.p.|-sn) by XREAL_1:26;
            then (-(1-sn))/(1-sn)<=(-( p`2/|.p.|-sn))/(1-sn) by A6,
            XREAL_1
            :74;
            then
A13:        -1<=(-( p`2/|.p.|-sn))/(1-sn) by A6,XCMPLX_1:198;
A14:        (p`2/|.p.|-sn)>=0 by A9,XREAL_1:50;
A15:        sn -FanMorphW.p= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)
            ), |.p.|* ((p`2/|.p.|-sn)/(1-sn))]| by A1,A2,A9,Th25;
            (p`2/|.p.|-sn)>= 0 by A9,XREAL_1:50;
            then ((-(p`2/|.p.|-sn))/(1-sn))^2<=1^2 by A6,
            A13,SQUARE_1:119;
            then
A16:        1-((-(p`2/|.p.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
            then sqrt(1-((-(p`2/|.p.|-sn))/(1-sn))^2)>=0 by
            SQUARE_1:def 4;
            then sqrt(1-(-(p`2/|.p.|-sn))^2/(1-sn)^2)>=0 by XCMPLX_1:77;
            then sqrt(1-(p`2/|.p.|-sn)^2/(1-sn)^2)>=0;
            then sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)>=0 by XCMPLX_1:77;
            then p4`1= |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)) & q`1=0 by
            A5,A7,A8,A15,EUCLID:56;
            then
A17:        (-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2))=0 by A5,A8,A15,A12,
            XCMPLX_1:6;
            1-(-((p`2/|.p.|-sn))/(1-sn))^2>=0 by A16,XCMPLX_1:188;
            then 1-((p`2/|.p.|-sn)/(1-sn))^2=0 by A17,SQUARE_1:92;
            then 1= (p`2/|.p.|-sn)/(1-sn) by A6,A14,SQUARE_1:83,89;
            then 1 *(1-sn)=(p`2/|.p.|-sn) by A6,XCMPLX_1:88;
            then 1 *|.p.|=p`2 by A12,XCMPLX_1:88;
            then p`1=0 by A10,XCMPLX_1:6;
            hence thesis by A5,A8,Th23;
          end;
          case
A18:        p<>0.TOP-REAL 2 & p`2/|.p.|<sn & p`1<=0;
            then
A19:        sn -FanMorphW.p= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)
            ), |.p.|* ((p`2/|.p.|-sn)/(1+sn))]| by A1,A2,Th25;
            set p4= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)), |.p.|* ((p
            `2/|.p.|-sn)/(1+sn))]|;
A20:        (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
            0<=(p`1)^2 by XREAL_1:65;
            then 0+(p`2)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
            then
A21:        (p`2)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by A20,XREAL_1:
            74;
A22:        1+sn>0 by A1,XREAL_1:150;
A23:        (p`2/|.p.|-sn)<=0 by A18,XREAL_1:49;
            then
A24:        -1<=(-( p`2/|.p.|-sn))/(1+sn) by A22;
A25:        |.p.|>0 by A18,Lm1;
            then (|.p.|)^2>0 by SQUARE_1:74;
            then (p`2)^2/(|.p.|)^2 <= 1 by A21,XCMPLX_1:60;
            then ((p`2)/|.p.|)^2 <= 1 by XCMPLX_1:77;
            then (-((p`2)/|.p.|))^2 <= 1;
            then 1>= -p`2/|.p.| by SQUARE_1:121;
            then (1+sn)>= -p`2/|.p.|+sn by XREAL_1:9;
            then (-(p`2/|.p.|-sn))/(1+sn)<=1 by A22,XREAL_1:187;
            then ((-(p`2/|.p.|-sn))/(1+sn))^2<=1^2 by A24,SQUARE_1:119;
            then
A26:        1-((-(p`2/|.p.|-sn))/(1+sn))^2>=0 by XREAL_1:50;
            then sqrt(1-((-(p`2/|.p.|-sn))/(1+sn))^2)>=0 by
            SQUARE_1:def 4;
            then sqrt(1-(-(p`2/|.p.|-sn))^2/(1+sn)^2)>=0 by XCMPLX_1:77;
            then sqrt(1-((p`2/|.p.|-sn))^2/(1+sn)^2)>=0;
            then sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)>=0 by XCMPLX_1:77;
            then p4`1= |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)) & q`1=0 by
            A5,A7,A8,A19,EUCLID:56;
            then
A27:        (-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2))=0 by A5,A8,A19,A25,
            XCMPLX_1:6;
            1-(-((p`2/|.p.|-sn))/(1+sn))^2>=0 by A26,XCMPLX_1:188;
            then 1-((p`2/|.p.|-sn)/(1+sn))^2=0 by A27,SQUARE_1:92;
            then 1=sqrt((-((p`2/|.p.|-sn)/(1+sn)))^2) by SQUARE_1:83;
            then 1= -((p`2/|.p.|-sn)/(1+sn)) by A22,A23,SQUARE_1:89;
            then 1= ((-(p`2/|.p.|-sn))/(1+sn)) by XCMPLX_1:188;
            then 1 *(1+sn)=-(p`2/|.p.|-sn) by A22,XCMPLX_1:88;
            then 1+sn-sn=-p`2/|.p.|;
            then 1=(-p`2)/|.p.| by XCMPLX_1:188;
            then 1 *|.p.|=-p`2 by A25,XCMPLX_1:88;
            then (p`2)^2-(p`2)^2 =(p`1)^2 by A20,XCMPLX_1:26;
            then p`1=0 by XCMPLX_1:6;
            hence thesis by A5,A8,Th23;
          end;
        end;
        hence thesis;
      end;
      case
A28:    q`2/|.q.|>=sn & q`1<=0 & q<>0.TOP-REAL 2;
        then |.q.|>0 by Lm1;
        then
A29:    (|.q.|)^2>0 by SQUARE_1:74;
        set q4= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)), |.q.|* ((q`2/|.
        q.|-sn)/(1-sn))]|;
A30:    q4`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by EUCLID:56;
A31:    sn-FanMorphW.q= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn)) ^2)),
        |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by A1,A2,A28,Th25;
A32:    q4`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)) by EUCLID:56;
        now
          per cases by JGRAPH_2:11;
          case
A33:        p`1>=0;
A34:        (q`2/|.q.|-sn)>= 0 by A28,XREAL_1:50;
A35:        (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
            0<=(q`1)^2 by XREAL_1:65;
            then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
            then
A36:        (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A35,XREAL_1:
            74;
A37:        (sn-FanMorphW).p=p by A33,Th23;
A38:        (q`2/|.q.|-sn)>=0 by A28,XREAL_1:50;
A39:        1-sn>0 by A2,XREAL_1:151;
A40:        |.q.|>0 by A28,Lm1;
            then (|.q.|)^2>0 by SQUARE_1:74;
            then (q`2)^2/(|.q.|)^2 <= 1 by A36,XCMPLX_1:60;
            then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
            then 1>=q`2/|.q.| by SQUARE_1:121;
            then 1-sn>=q`2/|.q.|-sn by XREAL_1:11;
            then -(1-sn)<= -( q`2/|.q.|-sn) by XREAL_1:26;
            then (-(1-sn))/(1-sn)<=(-( q`2/|.q.|-sn))/(1-sn) by A39,
            XREAL_1:74;
            then -1<=(-( q`2/|.q.|-sn))/(1-sn) by A39,XCMPLX_1:198;
            then ((-(q`2/|.q.|-sn))/(1-sn))^2<=1^2 by A39,A34, SQUARE_1:
            119;
            then
A41:        1-((-(q`2/|.q.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
            then sqrt(1-((-(q`2/|.q.|-sn))/(1-sn))^2)>=0 by SQUARE_1:
            def 4;
            then sqrt(1-(-(q`2/|.q.|-sn))^2/(1-sn)^2)>=0 by XCMPLX_1:77;
            then sqrt(1-(q`2/|.q.|-sn)^2/(1-sn)^2)>=0;
            then sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)>=0 by XCMPLX_1:77;
            then p`1=0 by A5,A31,A33,A37,EUCLID:56;
            then
A42:        (-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))=0 by A5,A31,A32,A37,A40
            ,XCMPLX_1:6;
            1-(-((q`2/|.q.|-sn))/(1-sn))^2>=0 by A41,XCMPLX_1:188;
            then 1-((q`2/|.q.|-sn)/(1-sn))^2=0 by A42,SQUARE_1:92;
            then 1= (q`2/|.q.|-sn)/(1-sn) by A39,A38,SQUARE_1:83,89;
            then 1 *(1-sn)=(q`2/|.q.|-sn) by A39,XCMPLX_1:88;
            then 1 *|.q.|=q`2 by A40,XCMPLX_1:88;
            then q`1=0 by A35,XCMPLX_1:6;
            hence thesis by A5,A37,Th23;
          end;
          case
A43:        p<>0.TOP-REAL 2 & p`2/|.p.|>=sn & p`1<=0;
            0<=(q`1)^2 by XREAL_1:65;
            then (|.q.|)^2 =(q`1)^2+(q`2)^2 & 0+(q`2)^2<=(q`1)^2+(q`2)^2 by
            JGRAPH_3:10 ,XREAL_1:9;
            then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by XREAL_1:74;
            then (q`2)^2/(|.q.|)^2 <= 1 by A29,XCMPLX_1:60;
            then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
            then 1>=q`2/|.q.| by SQUARE_1:121;
            then 1-sn>=q`2/|.q.|-sn by XREAL_1:11;
            then -(1-sn)<= -( q`2/|.q.|-sn) by XREAL_1:26;
            then (-(1-sn))/(1-sn)<=(-( q`2/|.q.|-sn))/(1-sn) by A6,
            XREAL_1:74;
            then
A44:        -1<=(-( q`2/|.q.|-sn))/(1-sn) by A6,XCMPLX_1:198;
            (q`2/|.q.|-sn)>= 0 by A28,XREAL_1:50;
            then ((-(q`2/|.q.|-sn))/(1-sn))^2<=1^2 by A6,A44, SQUARE_1:
            119;
            then 1-((-(q`2/|.q.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
            then
A45:        1-(-((q`2/|.q.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
            q4`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)) by EUCLID:
            56;
            then
A46:        (q4`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))^2
              .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1-sn))^2) by A45,SQUARE_1:
            def 4;
A47:        q4`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by EUCLID:56;
            (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
              .=(|.q.|)^2 by A47,A46;
            then sqrt((|.q4.|)^2)=|.q.| by SQUARE_1:89;
            then
A48:        |.q4.|=|.q.| by SQUARE_1:89;
            0<=(p`1)^2 by XREAL_1:65;
            then (|.p.|)^2 =(p`1)^2+(p`2)^2 & 0+(p`2)^2<=(p`1)^2+(p`2)^2 by
            JGRAPH_3:10 ,XREAL_1:9;
            then
A49:        (p`2)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by XREAL_1:74;
A50:        |.p.|>0 by A43,Lm1;
            then (|.p.|)^2>0 by SQUARE_1:74;
            then (p`2)^2/(|.p.|)^2 <= 1 by A49,XCMPLX_1:60;
            then ((p`2)/|.p.|)^2 <= 1 by XCMPLX_1:77;
            then 1>=p`2/|.p.| by SQUARE_1:121;
            then 1-sn>=p`2/|.p.|-sn by XREAL_1:11;
            then -(1-sn)<= -( p`2/|.p.|-sn) by XREAL_1:26;
            then (-(1-sn))/(1-sn)<=(-( p`2/|.p.|-sn))/(1-sn) by A6,
            XREAL_1:74;
            then
A51:        -1<=(-( p`2/|.p.|-sn))/(1-sn) by A6,XCMPLX_1:198;
            set p4 = |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)), |.p.|* ((p
            `2/|.p.|-sn)/(1-sn))]|;
A52:        p4`2= |.p.|* ((p`2/|.p.|-sn)/(1-sn)) by EUCLID:56;
            (p`2/|.p.|-sn)>= 0 by A43,XREAL_1:50;
            then ((-(p`2/|.p.|-sn))/(1-sn))^2<=1^2 by A6,A51, SQUARE_1:
            119;
            then 1-((-(p`2/|.p.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
            then
A53:        1-(-((p`2/|.p.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
            p4`1= |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)) by EUCLID:
            56;
            then
A54:        (p4`1)^2= (|.p.|)^2*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2))^2
              .= (|.p.|)^2*(1-((p`2/|.p.|-sn)/(1-sn))^2) by A53,SQUARE_1:
            def 4;
            (|.p4.|)^2=(p4`1)^2+(p4`2)^2 by JGRAPH_3:10
              .=(|.p.|)^2 by A52,A54;
            then sqrt((|.p4.|)^2)=|.p.| by SQUARE_1:89;
            then
A55:        |.p4.|=|.p.| by SQUARE_1:89;
A56:        sn-FanMorphW.p= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/ (1-sn))^2
            )), |.p.|* ((p`2/|.p.|-sn)/(1-sn))]| by A1,A2,A43,Th25;
            then ((p`2/|.p.|-sn)/(1-sn)) =|.q.|* ((q`2/|.q.|-sn)/(1-sn))/|.p
            .| by A5,A31,A30,A52,A50,XCMPLX_1:90;
            then (p`2/|.p.|-sn)/(1-sn)=(q`2/|.q.|-sn)/(1-sn) by A5,A31,A56,
            A48,A50,A55,XCMPLX_1:90;
            then (p`2/|.p.|-sn)/(1-sn)*(1-sn)=q`2/|.q.|-sn by A6,
            XCMPLX_1:88;
            then p`2/|.p.|-sn=q`2/|.q.|-sn by A6,XCMPLX_1:88;
            then p`2/|.p.|*|.p.|=q`2 by A5,A31,A56,A48,A50,A55,
            XCMPLX_1:88;
            then
A57:        p`2=q`2 by A50,XCMPLX_1:88;
            |.p.|^2=(p`1)^2+(p`2)^2 & |.q.|^2=(q`1)^2+(q`2)^2 by
            JGRAPH_3:10;
            then (-p`1)^2=(q`1)^2 by A5,A31,A56,A48,A55,A57;
            then -p`1=sqrt((-q`1)^2) by A43,SQUARE_1:89;
            then
A58:        --p`1=--q`1 by A28,SQUARE_1:89;
            p=|[p`1,p`2]| by EUCLID:57;
            hence thesis by A57,A58,EUCLID:57;
          end;
          case
A59:        p<>0.TOP-REAL 2 & p`2/|.p.|<sn & p`1<=0;
            then p`2/|.p.|-sn<0 by XREAL_1:51;
            then
A60:        ((p`2/|.p.|-sn)/(1+sn))<0 by A1,XREAL_1:143,150;
            set p4= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)), |.p.|* ((p
            `2/|.p.|-sn)/(1+sn))]|;
A61:        p4`2= |.p.|* ((p`2/|.p.|-sn)/(1+sn)) & q`2/|.q.|-sn>=0 by
            A28,EUCLID:56 ,XREAL_1:50;
A62:        1-sn>0 by A2,XREAL_1:151;
            sn-FanMorphW.p= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/ (1+sn))^2
            )), |.p.|* ((p`2/|.p.|-sn)/(1+sn))]| by A1,A2,A59,Th25;
            hence thesis by A5,A31,A30,A59,A60,A61,A62,Lm1,XREAL_1:134;
          end;
        end;
        hence thesis;
      end;
      case
A63:    q`2/|.q.|<sn & q`1<=0 & q<>0.TOP-REAL 2;
        then
A64:    |.q.|>0 by Lm1;
        then
A65:    (|.q.|)^2>0 by SQUARE_1:74;
        set q4= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)), |.q.|* ((q`2/|.
        q.|-sn)/(1+sn))]|;
A66:    q4`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)) by EUCLID:56;
A67:    q4`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by EUCLID:56;
A68:    sn-FanMorphW.q= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn)) ^2)),
        |.q.|* ((q`2/|.q.|-sn)/(1+sn))]| by A1,A2,A63,Th25;
        per cases by JGRAPH_2:11;
        suppose
A69:      p`1>=0;
A70:      (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
A71:      1+sn>0 by A1,XREAL_1:150;
          0<=(q`1)^2 by XREAL_1:65;
          then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
          then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A70,XREAL_1:
          74;
          then (q`2)^2/(|.q.|)^2 <= 1 by A65,XCMPLX_1:60;
          then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
          then (-((q`2)/|.q.|))^2 <= 1;
          then 1>= -q`2/|.q.| by SQUARE_1:121;
          then (1+sn)>= -q`2/|.q.|+sn by XREAL_1:9;
          then
A72:      (-(q`2/|.q.|-sn))/(1+sn)<=1 by A71,XREAL_1:187;
A73:      (q`2/|.q.|-sn)<=0 by A63,XREAL_1:49;
          then -1<=(-( q`2/|.q.|-sn))/(1+sn) by A71;
          then ((-(q`2/|.q.|-sn))/(1+sn))^2<=1^2 by A72,SQUARE_1:119;
          then
A74:      1-((-(q`2/|.q.|-sn))/(1+sn))^2>=0 by XREAL_1:50;
          then
A75:      1-(-((q`2/|.q.|-sn))/(1+sn))^2>=0 by XCMPLX_1:188;
A76:      (sn-FanMorphW).p=p by A69,Th23;
          sqrt(1-((-(q`2/|.q.|-sn))/(1+sn))^2)>=0 by A74,SQUARE_1:def 4;
          then sqrt(1-(-(q`2/|.q.|-sn))^2/(1+sn)^2)>=0 by XCMPLX_1:77;
          then sqrt(1-((q`2/|.q.|-sn))^2/(1+sn)^2)>=0;
          then sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)>=0 by XCMPLX_1:77;
          then p`1=0 by A5,A68,A69,A76,EUCLID:56;
          then (-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))=0 by A5,A68,A66,A64,
          A76,XCMPLX_1:6;
          then 1-((q`2/|.q.|-sn)/(1+sn))^2=0 by A75,SQUARE_1:92;
          then 1=sqrt((-((q`2/|.q.|-sn)/(1+sn)))^2) by SQUARE_1:83;
          then 1= -((q`2/|.q.|-sn)/(1+sn)) by A71,A73,SQUARE_1:89;
          then 1= ((-(q`2/|.q.|-sn))/(1+sn)) by XCMPLX_1:188;
          then 1 *(1+sn)=-(q`2/|.q.|-sn) by A71,XCMPLX_1:88;
          then 1+sn-sn=-q`2/|.q.|;
          then 1=(-q`2)/|.q.| by XCMPLX_1:188;
          then 1 *|.q.|=-q`2 by A64,XCMPLX_1:88;
          then (q`2)^2-(q`2)^2 =(q`1)^2 by A70,XCMPLX_1:26;
          then q`1=0 by XCMPLX_1:6;
          hence thesis by A5,A76,Th23;
        end;
        suppose
A77:      p<>0.TOP-REAL 2 & p`2/|.p.|>=sn & p`1<=0;
          set p4= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)), |.p.|* ((p`2/
          |.p.|-sn)/(1-sn))]|;
A78:      p4`2= |.p.|* ((p`2/|.p.|-sn)/(1-sn)) & 1-sn>0 by A2,EUCLID:56,
          XREAL_1:151;
          q`2/|.q.|-sn<0 by A63,XREAL_1:51;
          then
A79:      ((q`2/|.q.|-sn)/(1+sn))<0 by A1,XREAL_1:143,150;
          sn-FanMorphW.p= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1- sn))^2))
, |.p.|* ((p`2/ |.p.|-sn)/(1-sn))]| & p`2/|.p.|-sn>=0 by A1,A2,A77,Th25,
          XREAL_1:50;
          hence thesis by A5,A63,A68,A67,A79,A78,Lm1,XREAL_1:134;
        end;
        suppose
A80:      p<>0.TOP-REAL 2 & p`2/|.p.|<sn & p`1<=0;
          0<=(p`1)^2 by XREAL_1:65;
          then (|.p.|)^2 =(p`1)^2+(p`2)^2 & 0+(p`2)^2<=(p`1)^2+(p`2)^2 by
          JGRAPH_3:10 ,XREAL_1:9;
          then
A81:      (p`2)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by XREAL_1:74;
A82:      1+sn>0 by A1,XREAL_1:150;
          0<=(q`1)^2 by XREAL_1:65;
          then (|.q.|)^2 =(q`1)^2+(q`2)^2 & 0+(q`2)^2<=(q`1)^2+(q`2)^2 by
          JGRAPH_3:10 ,XREAL_1:9;
          then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by XREAL_1:74;
          then (q`2)^2/(|.q.|)^2 <= 1 by A65,XCMPLX_1:60;
          then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
          then -1<=q`2/|.q.| by SQUARE_1:121;
          then -1-sn<=q`2/|.q.|-sn by XREAL_1:11;
          then -(-1-sn)>= -(q`2/|.q.|-sn) by XREAL_1:26;
          then
A83:      (-(q`2/|.q.|-sn))/(1+sn)<=1 by A82,XREAL_1:187;
          (q`2/|.q.|-sn)<=0 by A63,XREAL_1:49;
          then -1<=(-( q`2/|.q.|-sn))/(1+sn) by A82;
          then ((-(q`2/|.q.|-sn))/(1+sn))^2<=1^2 by A83,SQUARE_1:119;
          then 1-((-(q`2/|.q.|-sn))/(1+sn))^2>=0 by XREAL_1:50;
          then
A84:      1-(-((q`2/|.q.|-sn))/(1+sn))^2>=0 by XCMPLX_1:188;
          q4`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)) by EUCLID:56;
          then
A85:      (q4`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))^2
            .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1+sn))^2) by A84,SQUARE_1:def
          4;
A86:      q4`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by EUCLID:56;
          set p4= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)), |.p.|* ((p`2/
          |.p.|-sn)/(1+sn))]|;
A87:      p4`2= |.p.|* ((p`2/|.p.|-sn)/(1+sn)) by EUCLID:56;
          (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
            .=(|.q.|)^2 by A86,A85;
          then sqrt((|.q4.|)^2)=|.q.| by SQUARE_1:89;
          then
A88:      |.q4.|=|.q.| by SQUARE_1:89;
          (p`2/|.p.|-sn)<=0 by A80,XREAL_1:49;
          then
A89:      -1<=(-( p`2/|.p.|-sn))/(1+sn) by A82;
A90:      |.p.|>0 by A80,Lm1;
          then (|.p.|)^2>0 by SQUARE_1:74;
          then (p`2)^2/(|.p.|)^2 <= 1 by A81,XCMPLX_1:60;
          then ((p`2)/|.p.|)^2 <= 1 by XCMPLX_1:77;
          then -1<=p`2/|.p.| by SQUARE_1:121;
          then -1-sn<=p`2/|.p.|-sn by XREAL_1:11;
          then -(-1-sn)>= -(p`2/|.p.|-sn) by XREAL_1:26;
          then (-(p`2/|.p.|-sn))/(1+sn)<=1 by A82,XREAL_1:187;
          then ((-(p`2/|.p.|-sn))/(1+sn))^2<=1^2 by A89,SQUARE_1:119;
          then 1-((-(p`2/|.p.|-sn))/(1+sn))^2>=0 by XREAL_1:50;
          then
A91:      1-(-((p`2/|.p.|-sn))/(1+sn))^2>=0 by XCMPLX_1:188;
          p4`1= |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)) by EUCLID:56;
          then
A92:      (p4`1)^2= (|.p.|)^2*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2))^2
            .= (|.p.|)^2*(1-((p`2/|.p.|-sn)/(1+sn))^2) by A91,SQUARE_1:def
          4;
          (|.p4.|)^2=(p4`1)^2+(p4`2)^2 by JGRAPH_3:10
            .=(|.p.|)^2 by A87,A92;
          then sqrt((|.p4.|)^2)=|.p.| by SQUARE_1:89;
          then
A93:      |.p4.|=|.p.| by SQUARE_1:89;
A94:      sn-FanMorphW.p= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+ sn))^2))
          , |.p.|* ((p`2/|.p.|-sn)/(1+sn))]| by A1,A2,A80,Th25;
          then ((p`2/|.p.|-sn)/(1+sn)) =|.q.|* ((q`2/|.q.|-sn)/(1+sn))/|.p.|
          by A5,A68,A67,A87,A90,XCMPLX_1:90;
          then (p`2/|.p.|-sn)/(1+sn)=(q`2/|.q.|-sn)/(1+sn) by A5,A68,A94,
          A88,A90,A93,XCMPLX_1:90;
          then (p`2/|.p.|-sn)/(1+sn)*(1+sn)=q`2/|.q.|-sn by A82,
          XCMPLX_1:88;
          then p`2/|.p.|-sn=q`2/|.q.|-sn by A82,XCMPLX_1:88;
          then p`2/|.p.|*|.p.|=q`2 by A5,A68,A94,A88,A90,A93,
          XCMPLX_1:88;
          then
A95:      p`2=q`2 by A90,XCMPLX_1:88;
          |.p.|^2=(p`1)^2+(p`2)^2 & |.q.|^2=(q`1)^2+(q`2)^2 by JGRAPH_3:
          10;
          then (-p`1)^2=(q`1)^2 by A5,A68,A94,A88,A93,A95;
          then -p`1=sqrt((-q`1)^2) by A80,SQUARE_1:89;
          then
A96:      --p`1=--q`1 by A63,SQUARE_1:89;
          p=|[p`1,p`2]| by EUCLID:57;
          hence thesis by A95,A96,EUCLID:57;
        end;
      end;
    end;
    hence thesis;
  end;
  hence thesis by FUNCT_1:def 8;
end;

theorem Th46:
  for sn being Real st -1<sn & sn<1 holds sn-FanMorphW is Function
  of TOP-REAL 2,TOP-REAL 2 & rng (sn-FanMorphW) = the carrier of TOP-REAL 2
proof
  let sn be Real;
  assume that
A1: -1<sn and
A2: sn<1;
  thus sn-FanMorphW is Function of TOP-REAL 2,TOP-REAL 2;
  for f being Function of TOP-REAL 2,TOP-REAL 2 st f=(sn-FanMorphW) holds
  rng (sn-FanMorphW)=the carrier of TOP-REAL 2
  proof
    let f be Function of TOP-REAL 2,TOP-REAL 2;
    assume
A3: f=sn-FanMorphW;
A4: dom f=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
    the carrier of TOP-REAL 2 c= rng f
    proof
      let y be set;
      assume
      y in the carrier of TOP-REAL 2;
      then reconsider p2=y as Point of TOP-REAL 2;
      set q=p2;
      now
        per cases by JGRAPH_2:11;
        case
          q`1>=0;
          then y=(sn-FanMorphW).q by Th23;
          hence ex x being set st x in dom (sn-FanMorphW) & y=(sn-FanMorphW).x
          by A3,A4;
        end;
        case
A5:       q`2/|.q.|>=0 & q`1<=0 & q<>0.TOP-REAL 2;
A6:       --(1+sn)>0 by A1,XREAL_1:150;
A7:       1-sn>=0 by A2,XREAL_1:151;
          then q`2/|.q.|*(1-sn)>=0 by A5;
          then -(1+sn)<= q`2/|.q.|*(1-sn) by A6;
          then
A8:       -1-sn+sn<= q`2/|.q.|*(1-sn)+sn by XREAL_1:9;
          set px=|[ -(|.q.|)*sqrt(1-(q`2/|.q.|*(1-sn)+sn)^2), |.q.|*(q`2/|.q.|
          *(1-sn)+sn)]|;
A9:       px`2 = |.q.|*(q`2/|.q.|*(1-sn)+sn) by EUCLID:56;
          |.q.|<>0 by A5,TOPRNS_1:25;
          then
A10:      |.q.|^2>0 by SQUARE_1:74;
A11:      |.q.|>0 by A5,Lm1;
A12:      dom (sn-FanMorphW)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
A13:      1-sn>0 by A2,XREAL_1:151;
          0<=(q`1)^2 by XREAL_1:65;
          then (|.q.|)^2 =(q`1)^2+(q`2)^2 & 0+(q`2)^2<=(q`1)^2+(q`2)^2 by
          JGRAPH_3:10 ,XREAL_1:9;
          then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by XREAL_1:74;
          then (q`2)^2/(|.q.|)^2 <= 1 by A10,XCMPLX_1:60;
          then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
          then q`2/|.q.|<=1 by SQUARE_1:121;
          then q`2/|.q.|*(1-sn) <=1 *(1-sn) by A13,XREAL_1:66;
          then q`2/|.q.|*(1-sn)+sn-sn <=1-sn;
          then (q`2/|.q.|*(1-sn)+sn) <=1 by XREAL_1:11;
          then 1^2>=(q`2/|.q.|*(1-sn)+sn)^2 by A8,SQUARE_1:119;
          then
A14:      1-(q`2/|.q.|*(1-sn)+sn)^2>=0 by XREAL_1:50;
          then
A15:      sqrt(1-(q`2/|.q.|*(1-sn)+sn)^2)>=0 by SQUARE_1:def 4;
A16:      px`1 = -(|.q.|)*sqrt(1-(q`2/|.q.|*(1-sn)+sn)^2) by EUCLID:56;
          then
          |.px.|^2=(-(|.q.|)*sqrt(1-(q`2/|.q.|*(1-sn)+sn)^2))^2 +(|.q.|*(
          q`2/|.q.|*(1-sn)+sn))^2 by A9,JGRAPH_3:10
            .=(|.q.|)^2*(sqrt(1-(q`2/|.q.|*(1-sn)+sn)^2))^2 +(|.q.|)^2*((q`2
          /|.q.|*(1-sn)+sn))^2;
          then
A17:      |.px.|^2=(|.q.|)^2*(1-(q`2/|.q.|*(1-sn)+sn)^2) +(|.q.|)^2*((q`2
          /|.q.|*(1-sn)+sn))^2 by A14,SQUARE_1:def 4
            .= (|.q.|)^2;
          then
A18:      |.px.|=sqrt(|.q.|^2) by SQUARE_1:89
            .=|.q.| by SQUARE_1:89;
          then
A19:      px<>0.TOP-REAL 2 by A5,TOPRNS_1:24,25;
          (q`2/|.q.|*(1-sn)+sn)>=0+sn by A5,A7,XREAL_1:9;
          then px`2/|.px.| >=sn by A5,A9,A18,TOPRNS_1:25,XCMPLX_1:90;
          then
A20:      (sn-FanMorphW).px =|[ |.px.|*(-sqrt(1-((px`2/|.px.|-sn )/(1-sn)
          )^2)), |.px.|* ((px`2/|.px.|-sn)/(1-sn))]| by A1,A2,A16,A15,A19,Th25;
A21:      |.px.|*(-sqrt((q`1/|.q.|)^2))=|.px.|*(--(q`1/|.q.|)) by A5,
          SQUARE_1:90
            .=q`1 by A11,A18,XCMPLX_1:88;
A22:      |.px.|* ((px`2/|.px.|-sn)/(1-sn)) =|.q.|* (( ((q`2/|.q.|*(1-sn)
          +sn))-sn)/(1-sn)) by A5,A9,A18,TOPRNS_1:25,XCMPLX_1:90
            .=|.q.|* ( q`2/|.q.|) by A13,XCMPLX_1:90
            .= q`2 by A5,TOPRNS_1:25,XCMPLX_1:88;
          then
          |.px.|*(-sqrt(1-((px`2/|.px.|-sn)/(1-sn))^2)) = |.px.|*(-sqrt(1
          -(q`2/|.px.|)^2)) by A5,A18,TOPRNS_1:25 ,XCMPLX_1:90
            .= |.px.|*(-sqrt(1-(q`2)^2/(|.px.|)^2)) by XCMPLX_1:77
            .= |.px.|*(-sqrt( (|.px.|)^2/(|.px.|)^2-(q`2)^2/(|.px.|)^2)) by
          A10,A17,XCMPLX_1:60
            .= |.px.|*(-sqrt( ((|.px.|)^2-(q`2)^2)/(|.px.|)^2)) by XCMPLX_1:
          121
            .= |.px.|*(-sqrt( ((q`1)^2+(q`2)^2-(q`2)^2)/(|.px.|)^2)) by A17,
          JGRAPH_3:10
            .= |.px.|*(-sqrt((q`1/|.q.|)^2)) by A18,XCMPLX_1:77;
          hence ex x being set st x in dom (sn-FanMorphW) & y=(sn-FanMorphW).x
          by A20,A22,A21,A12,EUCLID:57;
        end;
        case
A23:      q`2/|.q.|<0 & q`1<=0 & q<>0.TOP-REAL 2;
A24:      1+sn>=0 by A1,XREAL_1:150;
          then q`2/|.q.|*(1+sn)<=0 by A23;
          then 1-sn>= q`2/|.q.|*(1+sn) by A2,XREAL_1:151;
          then
A25:      1-sn+sn>= q`2/|.q.|*(1+sn)+sn by XREAL_1:9;
          set px=|[ -(|.q.|)*sqrt(1-(q`2/|.q.|*(1+sn)+sn)^2), |.q.|*(q`2/|.q.|
          *(1+sn)+sn)]|;
A26:      px`2 = |.q.|*(q`2/|.q.|*(1+sn)+sn) by EUCLID:56;
          |.q.|<>0 by A23,TOPRNS_1:25;
          then
A27:      |.q.|^2>0 by SQUARE_1:74;
A28:      |.q.|>0 by A23,Lm1;
A29:      dom (sn-FanMorphW)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
A30:      1+sn>0 by A1,XREAL_1:150;
          0<=(q`1)^2 by XREAL_1:65;
          then (|.q.|)^2 =(q`1)^2+(q`2)^2 & 0+(q`2)^2<=(q`1)^2+(q`2)^2 by
          JGRAPH_3:10 ,XREAL_1:9;
          then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by XREAL_1:74;
          then (q`2)^2/(|.q.|)^2 <= 1 by A27,XCMPLX_1:60;
          then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
          then q`2/|.q.|>=-1 by SQUARE_1:121;
          then q`2/|.q.|*(1+sn) >=(-1)*(1+sn) by A30,XREAL_1:66;
          then q`2/|.q.|*(1+sn)+sn-sn >=-1-sn;
          then (q`2/|.q.|*(1+sn)+sn) >=-1 by XREAL_1:11;
          then 1^2>=(q`2/|.q.|*(1+sn)+sn)^2 by A25,SQUARE_1:119;
          then
A31:      1-(q`2/|.q.|*(1+sn)+sn)^2>=0 by XREAL_1:50;
          then
A32:      sqrt(1-(q`2/|.q.|*(1+sn)+sn)^2)>=0 by SQUARE_1:def 4;
A33:      px`1 = -(|.q.|)*sqrt(1-(q`2/|.q.|*(1+sn)+sn)^2) by EUCLID:56;
          then
          |.px.|^2=(-(|.q.|)*sqrt(1-(q`2/|.q.|*(1+sn)+sn)^2))^2 +(|.q.|*(
          q`2/|.q.|*(1+sn)+sn))^2 by A26,JGRAPH_3:10
            .=(|.q.|)^2*(sqrt(1-(q`2/|.q.|*(1+sn)+sn)^2))^2 +(|.q.|)^2*((q`2
          /|.q.|*(1+sn)+sn))^2;
          then
A34:      |.px.|^2=(|.q.|)^2*(1-(q`2/|.q.|*(1+sn)+sn)^2) +(|.q.|)^2*((q`2
          /|.q.|*(1+sn)+sn))^2 by A31,SQUARE_1:def 4
            .= (|.q.|)^2;
          then
A35:      |.px.|=sqrt(|.q.|^2) by SQUARE_1:89
            .=|.q.| by SQUARE_1:89;
          then
A36:      px<>0.TOP-REAL 2 by A23,TOPRNS_1:24,25;
          (q`2/|.q.|*(1+sn)+sn)<=0+sn by A23,A24,XREAL_1:9;
          then px`2/|.px.| <=sn by A23,A26,A35,TOPRNS_1:25,XCMPLX_1:90;
          then
A37:      (sn-FanMorphW).px =|[ |.px.|*(-sqrt(1-((px`2/|.px.|-sn )/(1+sn)
          )^2)), |.px.|* ((px`2/|.px.|-sn)/(1+sn))]| by A1,A2,A33,A32,A36,Th25;
A38:      |.px.|*(-sqrt((q`1/|.q.|)^2))=|.px.|*(--(q`1/|.q.|)) by A23,
          SQUARE_1:90
            .=q`1 by A28,A35,XCMPLX_1:88;
A39:      |.px.|* ((px`2/|.px.|-sn)/(1+sn)) =|.q.|* (( ((q`2/|.q.|*(1+sn)
          +sn))-sn)/(1+sn)) by A23,A26,A35,TOPRNS_1:25 ,XCMPLX_1:90
            .=|.q.|* ( q`2/|.q.|) by A30,XCMPLX_1:90
            .= q`2 by A23,TOPRNS_1:25,XCMPLX_1:88;
          then
          |.px.|*(-sqrt(1-((px`2/|.px.|-sn)/(1+sn))^2)) = |.px.|*(-sqrt(1
          -(q`2/|.px.|)^2)) by A23,A35,TOPRNS_1:25 ,XCMPLX_1:90
            .= |.px.|*(-sqrt(1-(q`2)^2/(|.px.|)^2)) by XCMPLX_1:77
            .= |.px.|*(-sqrt( (|.px.|)^2/(|.px.|)^2-(q`2)^2/(|.px.|)^2)) by
          A27,A34,XCMPLX_1:60
            .= |.px.|*(-sqrt( ((|.px.|)^2-(q`2)^2)/(|.px.|)^2)) by XCMPLX_1:
          121
            .= |.px.|*(-sqrt( ((q`1)^2+(q`2)^2-(q`2)^2)/(|.px.|)^2)) by A34,
          JGRAPH_3:10
            .= |.px.|*(-sqrt((q`1/|.q.|)^2)) by A35,XCMPLX_1:77;
          hence ex x being set st x in dom (sn-FanMorphW) & y=(sn-FanMorphW).x
          by A37,A39,A38,A29,EUCLID:57;
        end;
      end;
      hence thesis by A3,FUNCT_1:def 5;
    end;
    hence thesis by A3,XBOOLE_0:def 10;
  end;
  hence thesis;
end;

Lm12: for q4,q,p2 be Point of TOP-REAL 2, O,u,uq be Point of Euclid 2 st u in
cl_Ball(O,|.p2.|+1) & q = uq & q4 = u & O=0.TOP-REAL 2 & |.q4.|=|.q.| holds q
in cl_Ball(O,|.p2.|+1)

proof
  let q4,q,p2 be Point of TOP-REAL 2, O,u,uq be Point of Euclid 2;
  assume
A1: u in cl_Ball(O,|.p2.|+1);
  assume that
A2: q = uq and
A3: q4 = u and
A4: O=0.TOP-REAL 2;
  assume
A5: |.q4.|=|.q.|;
  now
    assume
    not q in cl_Ball(O,|.p2.|+1);
    then not dist(O,uq)<=|.p2.|+1 by A2,METRIC_1:13;
    then |.0.TOP-REAL 2 - q.|> |.p2.|+1 by A2,A4,JGRAPH_1:45;
    then |. -q.|> |.p2.|+1 by EUCLID:31;
    then |.q.|> |.p2.|+1 by TOPRNS_1:27;
    then |. -q4.|> |.p2.|+1 by A5,TOPRNS_1:27;
    then |.0.TOP-REAL 2 - q4.|> |.p2.|+1 by EUCLID:31;
    then dist(O,u)> |.p2.|+1 by A3,A4,JGRAPH_1:45;
    hence contradiction by A1,METRIC_1:13;
  end;
  hence q in cl_Ball(O,|.p2.|+1);
end;

theorem Th47:
  for sn being Real,p2 being Point of TOP-REAL 2 st -1<sn & sn<1
ex K being non empty compact Subset of TOP-REAL 2 st K = (sn-FanMorphW).:K & ex
  V2 being Subset of TOP-REAL 2 st p2 in V2 & V2 is open & V2 c= K & (sn
  -FanMorphW).p2 in V2
proof
  reconsider O=0.TOP-REAL 2 as Point of Euclid 2 by EUCLID:71;
  let sn be Real,p2 be Point of TOP-REAL 2;
A1: the TopStruct of TOP-REAL 2 = TopSpaceMetr Euclid 2 by EUCLID:def 8;
  the TopStruct of TOP-REAL 2 = TopSpaceMetr Euclid 2 by EUCLID:def 8;
  then reconsider V0=Ball(O,|.p2.|+1) as Subset of TOP-REAL 2;
  O in V0 & V0 c= cl_Ball(O,|.p2.|+1) by GOBOARD6:4,METRIC_1:15;
  then reconsider
  K0=cl_Ball(O,|.p2.|+1) as non empty compact Subset of TOP-REAL 2
  by A1,Th22;
  set q3= (sn-FanMorphW).p2;
  reconsider VV0 = V0 as Subset of TopSpaceMetr Euclid 2;
  reconsider u2=p2 as Point of Euclid 2 by EUCLID:71;
  reconsider u3=q3 as Point of Euclid 2 by EUCLID:71;
A2: (sn-FanMorphW).:K0 c= K0
  proof
    let y be set;
    assume
    y in (sn-FanMorphW).:K0;
    then consider x being set such that
A3: x in dom (sn-FanMorphW) and
A4: x in K0 and
A5: y=(sn-FanMorphW).x by FUNCT_1:def 12;
    reconsider q=x as Point of TOP-REAL 2 by A3;
    reconsider uq=q as Point of Euclid 2 by EUCLID:71;
    dist(O,uq)<= |.p2.|+1 by A4,METRIC_1:13;
    then |.0.TOP-REAL 2 - q.|<= |.p2.|+1 by JGRAPH_1:45;
    then |. -q.|<= |.p2.|+1 by EUCLID:31;
    then
A6: |.q.|<= |.p2.|+1 by TOPRNS_1:27;
A7: y in rng (sn-FanMorphW) by A3,A5,FUNCT_1:def 5;
    then reconsider u=y as Point of Euclid 2 by EUCLID:71;
    reconsider q4=y as Point of TOP-REAL 2 by A7;
    |.q4.|=|.q.| by A5,Th40;
    then |. -q4.|<= |.p2.|+1 by A6,TOPRNS_1:27;
    then |.0.TOP-REAL 2 - q4.|<= |.p2.|+1 by EUCLID:31;
    then dist(O,u)<= |.p2.|+1 by JGRAPH_1:45;
    hence thesis by METRIC_1:13;
  end;
  VV0 is open by TOPMETR:21;
  then
A8: V0 is open by Lm11,PRE_TOPC:60;
A9: |. p2.|<|.p2.|+1 by XREAL_1:31;
  then |. -p2.|<|.p2.|+1 by TOPRNS_1:27;
  then |.0.TOP-REAL 2 - p2.|<|.p2.|+1 by EUCLID:31;
  then dist(O,u2)<|.p2.|+1 by JGRAPH_1:45;
  then
A10: p2 in V0 by METRIC_1:12;
  |.q3.|=|.p2.| by Th40;
  then |. -q3.|<|.p2.|+1 by A9,TOPRNS_1:27;
  then |.0.TOP-REAL 2 - q3.|<|.p2.|+1 by EUCLID:31;
  then dist(O,u3)< |.p2.|+1 by JGRAPH_1:45;
  then
A11: (sn-FanMorphW).p2 in V0 by METRIC_1:12;
  assume
A12: -1<sn & sn<1;
  K0 c= (sn-FanMorphW).:K0
  proof
    let y be set;
    assume
A13: y in K0;
    then reconsider y as Point of Euclid 2;
    reconsider q4=y as Point of TOP-REAL 2 by A13;
    the carrier of TOP-REAL 2 c= rng (sn-FanMorphW) by A12,Th46;
    then q4 in rng (sn-FanMorphW) by TARSKI:def 3;
    then consider x being set such that
A14: x in dom (sn-FanMorphW) and
A15: y=(sn-FanMorphW).x by FUNCT_1:def 5;
    reconsider x as Point of Euclid 2 by A14,Lm11;
    reconsider q=x as Point of TOP-REAL 2 by A14;
    |.q4.|=|.q.| by A15,Th40;
    then q in K0 by A13,Lm12;
    hence thesis by A14,A15,FUNCT_1:def 12;
  end;
  then K0= (sn-FanMorphW).:K0 by A2,XBOOLE_0:def 10;
  hence thesis by A10,A8,A11,METRIC_1:15;
end;

theorem
  for sn being Real st -1<sn & sn<1 ex f being Function of TOP-REAL 2,
  TOP-REAL 2 st f=(sn-FanMorphW) & f is being_homeomorphism
proof
  let sn be Real;
  reconsider f=(sn-FanMorphW) as Function of TOP-REAL 2,TOP-REAL 2;
  assume
A1: -1<sn & sn<1;
  then
A2: for p2 being Point of TOP-REAL 2 ex K being non empty compact Subset of
  TOP-REAL 2 st K = f.:K & ex V2 being Subset of TOP-REAL 2 st p2 in V2 & V2 is
  open & V2 c= K & f.p2 in V2 by Th47;
  rng (sn-FanMorphW) = the carrier of TOP-REAL 2 & ex h being Function of
  ( TOP-REAL 2),(TOP-REAL 2) st h=(sn -FanMorphW) & h is continuous by A1,Th44,
  Th46;
  then f is being_homeomorphism by A1,A2,Th8,Th45;
  hence thesis;
end;

Lm13: now
  let q be Point of TOP-REAL 2, sn,t be Real;
  assume
  ((-(t/|.q.|-sn))/(1-sn))^2<1^2;
  then 1-((-(t/|.q.|-sn))/(1-sn))^2>0 by XREAL_1:52;
  then sqrt(1-((-(t/|.q.|-sn))/(1-sn))^2)>0 by SQUARE_1:93;
  then sqrt(1-(-(t/|.q.|-sn))^2/(1-sn)^2)> 0 by XCMPLX_1:77;
  then sqrt(1-(t/|.q.|-sn)^2/(1-sn)^2)> 0;
  then sqrt(1-((t/|.q.|-sn)/(1-sn))^2)> 0 by XCMPLX_1:77;
  hence -sqrt(1-((t/|.q.|-sn)/(1-sn))^2)< -0 by XREAL_1:26;
end;

theorem Th49:
  for sn being Real,q being Point of TOP-REAL 2 st sn<1 & q`1<0 &
q`2/|.q.|>=sn holds for p being Point of TOP-REAL 2 st p=(sn-FanMorphW).q holds
  p`1<0 & p`2>=0
proof
  let sn be Real,q be Point of TOP-REAL 2;
  assume that
A1: sn<1 and
A2: q`1<0 and
A3: q`2/|.q.|>=sn;
A4: 1-sn>0 by A1,XREAL_1:151;
  let p be Point of TOP-REAL 2;
  set qz=p;
  assume
  p=(sn-FanMorphW).q;
  then
A5: p=|[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)), |.q.|* ((q`2/|.q.|-sn)/
  (1-sn))]| by A2,A3,Th23;
  then
A6: qz`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)) by EUCLID:56;
A7: (q`2/|.q.|-sn)>= 0 by A3,XREAL_1:50;
A8: |.q.|>0 by A2,Lm1,JGRAPH_2:11;
  then
A9: (|.q.|)^2>0 by SQUARE_1:74;
  (|.q.|)^2 =(q`1)^2+(q`2)^2 & 0+(q`2)^2<(q`1)^2+(q`2)^2 by A2,JGRAPH_3:
  10 ,SQUARE_1:74,XREAL_1:10;
  then (q`2)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A9,XREAL_1:76;
  then (q`2)^2/(|.q.|)^2 < 1 by A9,XCMPLX_1:60;
  then ((q`2)/|.q.|)^2 < 1 by XCMPLX_1:77;
  then 1>q`2/|.q.| by SQUARE_1:122;
  then 1-sn>q`2/|.q.|-sn by XREAL_1:11;
  then -(1-sn)< -( q`2/|.q.|-sn) by XREAL_1:26;
  then (-(1-sn))/(1-sn)<(-( q`2/|.q.|-sn))/(1-sn) by A4,XREAL_1:76;
  then -1<(-( q`2/|.q.|-sn))/(1-sn) by A4,XCMPLX_1:198;
  then ((-(q`2/|.q.|-sn))/(1-sn))^2<1^2 by A4,A7,SQUARE_1:120;
  hence thesis by A5,A8,A4,A6,A7,Lm13,EUCLID:56,XREAL_1:134;
end;

theorem Th50:
  for sn being Real,q being Point of TOP-REAL 2 st -1<sn & q`1<0 &
q`2/|.q.|<sn holds for p being Point of TOP-REAL 2 st p=(sn-FanMorphW).q holds
  p`1<0 & p`2<0
proof
  let sn be Real,q be Point of TOP-REAL 2;
  assume that
A1: -1<sn and
A2: q`1<0 and
A3: q`2/|.q.|<sn;
A4: 1+sn>0 by A1,XREAL_1:150;
A5: (q`2/|.q.|-sn)< 0 by A3,XREAL_1:51;
  then -( q`2/|.q.|-sn)>0 by XREAL_1:60;
  then (-(1+sn))/(1+sn)<(-( q`2/|.q.|-sn))/(1+sn) by A4,XREAL_1:76;
  then
A6: -1<(-( q`2/|.q.|-sn))/(1+sn) by A4,XCMPLX_1:198;
  |.q.|>0 by A2,Lm1,JGRAPH_2:11;
  then
A7: (|.q.|)^2>0 by SQUARE_1:74;
  (|.q.|)^2 =(q`1)^2+(q`2)^2 & 0+(q`2)^2<(q`1)^2+(q`2)^2 by A2,JGRAPH_3:
  10 ,SQUARE_1:74,XREAL_1:10;
  then (q`2)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A7,XREAL_1:76;
  then (q`2)^2/(|.q.|)^2 < 1 by A7,XCMPLX_1:60;
  then ((q`2)/|.q.|)^2 < 1 by XCMPLX_1:77;
  then -1<q`2/|.q.| by SQUARE_1:122;
  then -1-sn<q`2/|.q.|-sn by XREAL_1:11;
  then --(1+sn)> -(q`2/|.q.|-sn) by XREAL_1:26;
  then (-(q`2/|.q.|-sn))/(1+sn)<1 by A4,XREAL_1:193;
  then ((-(q`2/|.q.|-sn))/(1+sn))^2<1^2 by A6,SQUARE_1:120;
  then 1-((-(q`2/|.q.|-sn))/(1+sn))^2>0 by XREAL_1:52;
  then sqrt(1-((-(q`2/|.q.|-sn))/(1+sn))^2)>0 by SQUARE_1:93;
  then sqrt(1-(-(q`2/|.q.|-sn))^2/(1+sn)^2)> 0 by XCMPLX_1:77;
  then sqrt(1-(q`2/|.q.|-sn)^2/(1+sn)^2)> 0;
  then sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)> 0 by XCMPLX_1:77;
  then
A8: -sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)< -0 by XREAL_1:26;
  let p be Point of TOP-REAL 2;
  set qz=p;
  assume
  p=(sn-FanMorphW).q;
  then
  p=|[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)), |.q.|* ((q`2/|.q.|-sn)/
  (1+sn))]| by A2,A3,Th24;
  then
A9: qz`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)) & qz`2= |.q.|* ((q`2/
  |.q.|- sn)/(1+sn)) by EUCLID:56;
  ((q`2/|.q.|-sn)/(1+sn))<0 by A1,A5,XREAL_1:143,150;
  hence thesis by A2,A9,A8,Lm1,JGRAPH_2:11,XREAL_1:134;
end;

theorem Th51:
  for sn being Real,q1,q2 being Point of TOP-REAL 2 st sn<1 & q1`1
<0 & q1`2/|.q1.|>=sn & q2`1<0 & q2`2/|.q2.|>=sn & q1`2/|.q1.|<q2`2/|.q2.| holds
for p1,p2 being Point of TOP-REAL 2 st p1=(sn-FanMorphW).q1 & p2=(sn-FanMorphW)
  .q2 holds p1`2/|.p1.|<p2`2/|.p2.|
proof
  let sn be Real,q1,q2 be Point of TOP-REAL 2;
  assume that
A1: sn<1 and
A2: q1`1<0 and
A3: q1`2/|.q1.|>=sn and
A4: q2`1<0 and
A5: q2`2/|.q2.|>=sn and
A6: q1`2/|.q1.|<q2`2/|.q2.|;
A7: q1`2/|.q1.|-sn< q2`2/|.q2.|-sn & 1-sn>0 by A1,A6,XREAL_1:11,151;
  let p1,p2 be Point of TOP-REAL 2;
  assume that
A8: p1=(sn-FanMorphW).q1 and
A9: p2=(sn-FanMorphW).q2;
A10: |.p2.|=|.q2.| by A9,Th40;
  p2=|[ |.q2.|*(-sqrt(1-((q2`2/|.q2.|-sn)/(1-sn))^2)), |.q2.|* ((q2`2/|.
  q2.|-sn)/(1-sn))]| by A4,A5,A9,Th23;
  then
A11: p2`2= |.q2.|* ((q2`2/|.q2.|-sn)/(1-sn)) by EUCLID:56;
  |.q2.|>0 by A4,Lm1,JGRAPH_2:11;
  then
A12: p2`2/|.p2.|= ((q2`2/|.q2.|-sn)/(1-sn)) by A11,A10,XCMPLX_1:90;
  p1=|[ |.q1.|*(-sqrt(1-((q1`2/|.q1.|-sn)/(1-sn))^2)), |.q1.|* ((q1`2/|.q1
  .|-sn)/(1-sn))]| by A2,A3,A8,Th23;
  then
A13: p1`2= |.q1.|* ((q1`2/|.q1.|-sn)/(1-sn)) by EUCLID:56;
A14: |.p1.|=|.q1.| by A8,Th40;
  |.q1.|>0 by A2,Lm1,JGRAPH_2:11;
  then p1`2/|.p1.|= ((q1`2/|.q1.|-sn)/(1-sn)) by A13,A14,XCMPLX_1:90;
  hence thesis by A12,A7,XREAL_1:76;
end;

theorem Th52:
  for sn being Real,q1,q2 being Point of TOP-REAL 2 st -1<sn & q1
`1<0 & q1`2/|.q1.|<sn & q2`1<0 & q2`2/|.q2.|<sn & q1`2/|.q1.|<q2`2/|.q2.| holds
for p1,p2 being Point of TOP-REAL 2 st p1=(sn-FanMorphW).q1 & p2=(sn-FanMorphW)
  .q2 holds p1`2/|.p1.|<p2`2/|.p2.|
proof
  let sn be Real,q1,q2 be Point of TOP-REAL 2;
  assume that
A1: -1<sn and
A2: q1`1<0 and
A3: q1`2/|.q1.|<sn and
A4: q2`1<0 and
A5: q2`2/|.q2.|<sn and
A6: q1`2/|.q1.|<q2`2/|.q2.|;
A7: q1`2/|.q1.|-sn< q2`2/|.q2.|-sn & 1+sn>0 by A1,A6,XREAL_1:11,150;
  let p1,p2 be Point of TOP-REAL 2;
  assume that
A8: p1=(sn-FanMorphW).q1 and
A9: p2=(sn-FanMorphW).q2;
A10: |.p2.|=|.q2.| by A9,Th40;
  p2=|[ |.q2.|*(-sqrt(1-((q2`2/|.q2.|-sn)/(1+sn))^2)), |.q2.|* ((q2`2/|.
  q2.|-sn)/(1+sn))]| by A4,A5,A9,Th24;
  then
A11: p2`2= |.q2.|* ((q2`2/|.q2.|-sn)/(1+sn)) by EUCLID:56;
  |.q2.|>0 by A4,Lm1,JGRAPH_2:11;
  then
A12: p2`2/|.p2.|= ((q2`2/|.q2.|-sn)/(1+sn)) by A11,A10,XCMPLX_1:90;
  p1=|[ |.q1.|*(-sqrt(1-((q1`2/|.q1.|-sn)/(1+sn))^2)), |.q1.|* ((q1`2/|.q1
  .|-sn)/(1+sn))]| by A2,A3,A8,Th24;
  then
A13: p1`2= |.q1.|* ((q1`2/|.q1.|-sn)/(1+sn)) by EUCLID:56;
A14: |.p1.|=|.q1.| by A8,Th40;
  |.q1.|>0 by A2,Lm1,JGRAPH_2:11;
  then p1`2/|.p1.|= ((q1`2/|.q1.|-sn)/(1+sn)) by A13,A14,XCMPLX_1:90;
  hence thesis by A12,A7,XREAL_1:76;
end;

theorem
  for sn being Real,q1,q2 being Point of TOP-REAL 2 st -1<sn & sn<1 & q1
  `1 < 0 & q2`1<0 & q1`2/|.q1.|<q2`2/|.q2.| holds for p1,p2 being Point of
TOP-REAL 2 st p1=(sn-FanMorphW).q1 & p2=(sn-FanMorphW).q2 holds p1`2/|.p1.|<p2
  `2/|.p2.|
proof
  let sn be Real,q1,q2 be Point of TOP-REAL 2;
  assume that
A1: -1<sn and
A2: sn<1 and
A3: q1`1<0 and
A4: q2`1<0 and
A5: q1`2/|.q1.|<q2`2/|.q2.|;
  let p1,p2 be Point of TOP-REAL 2;
  assume that
A6: p1=(sn-FanMorphW).q1 and
A7: p2=(sn-FanMorphW).q2;
  now
    per cases;
    case
      q1`2/|.q1.|>=sn & q2`2/|.q2.|>=sn;
      hence thesis by A2,A3,A4,A5,A6,A7,Th51;
    end;
    case
      q1`2/|.q1.|>=sn & q2`2/|.q2.|<sn;
      hence thesis by A5,XXREAL_0:2;
    end;
    case
A8:   q1`2/|.q1.|<sn & q2`2/|.q2.|>=sn;
      then p2`2>=0 by A2,A4,A7,Th49;
      then
A9:   p2`2/|.p2.|>=0;
      p1`2<0 by A1,A3,A6,A8,Th50;
      hence thesis by A9,Lm1,JGRAPH_2:11,XREAL_1:143;
    end;
    case
      q1`2/|.q1.|<sn & q2`2/|.q2.|<sn;
      hence thesis by A1,A3,A4,A5,A6,A7,Th52;
    end;
  end;
  hence thesis;
end;

theorem
  for sn being Real,q being Point of TOP-REAL 2 st q`1<0 & q`2/|.q.|=sn
holds for p being Point of TOP-REAL 2 st p=(sn-FanMorphW).q holds p`1<0 & p`2=0
proof
  let sn be Real,q be Point of TOP-REAL 2;
  assume that
A1: q`1<0 and
A2: q`2/|.q.|=sn;
  let p be Point of TOP-REAL 2;
A3: |.q.|>0 by A1,Lm1,JGRAPH_2:11;
  assume
  p=(sn-FanMorphW).q;
  then
A4: p=|[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)), |.q.|* ((q`2/|.q.|-sn)/
  (1-sn))]| by A1,A2,Th23;
  then p`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)) by EUCLID:56;
  hence thesis by A2,A4,A3,Lm13,EUCLID:56,XREAL_1:134;
end;

theorem
  for sn being real number holds 0.TOP-REAL 2=(sn-FanMorphW).(0.TOP-REAL
  2) by Th23,JGRAPH_2:11;

begin :: Fan Morphism for North

definition
  let s be real number, q be Point of TOP-REAL 2;
  func FanN(s,q) -> Point of TOP-REAL 2 equals
  :Def4:
  |.q.|*|[(q`1/|.q.|-s)/(1
-s), sqrt(1-((q`1/|.q.|-s)/(1-s))^2)]| if q`1/|.q.|>=s & q`2>0, |.q.|*|[(q`1/|.
  q.|-s)/(1+s), sqrt(1-((q`1/|.q.|-s)/(1+s))^2)]| if q`1/|.q.|<s & q`2>0
  otherwise q;
  correctness;
end;

definition
  let c be real number;
  func c-FanMorphN -> Function of TOP-REAL 2, TOP-REAL 2 means
  :Def5:
  for q
  being Point of TOP-REAL 2 holds it.q=FanN(c,q);
  existence
  proof
    deffunc F(Point of TOP-REAL 2)=FanN(c,$1);
    thus ex IT being Function of TOP-REAL 2, TOP-REAL 2 st for q being Point
    of TOP-REAL 2 holds IT.q=F(q) from FUNCT_2:sch 4;
  end;
  uniqueness
  proof
    deffunc F(Point of TOP-REAL 2)=FanN(c,$1);
    thus for a,b being Function of TOP-REAL 2, TOP-REAL 2 st (for q being
Point of TOP-REAL 2 holds a.q=F(q)) & (for q being Point of TOP-REAL 2 holds b.
    q=F(q)) holds a = b from BINOP_2:sch 1;
  end;
end;

theorem Th56:
  for cn being real number holds (q`1/|.q.|>=cn & q`2>0 implies cn
-FanMorphN.q= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)), |.q.|*(sqrt(1-((q`1/|.q.|-cn)/
  (1-cn))^2))]|)& (q`2<=0 implies cn-FanMorphN.q=q)
proof
  let cn be real number;
  hereby
    assume
    q`1/|.q.|>=cn & q`2>0;
    then
    FanN(cn,q)= |.q.|*|[(q`1/|.q.|-cn)/(1-cn), sqrt(1-((q`1/|.q.|-cn)/(1-
    cn))^2)]| by Def4
      .= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)), |.q.|*(sqrt(1-((q`1/|.q.|-cn)/(1
    -cn))^2))]| by EUCLID:62;
    hence cn-FanMorphN.q= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)), |.q.|*(sqrt(1-((q
    `1/|.q.|-cn)/(1-cn))^2))]| by Def5;
  end;
  assume
A1: q`2<=0;
  cn-FanMorphN.q=FanN(cn,q) by Def5;
  hence thesis by A1,Def4;
end;

theorem Th57:
  for cn being Real holds (q`1/|.q.|<=cn & q`2>0 implies cn
-FanMorphN.q= |[ |.q.|*((q`1/|.q.|-cn)/(1+cn)), |.q.|*( sqrt(1-((q`1/|.q.|-cn)/
  (1+cn))^2))]|)
proof
  let cn be Real;
  assume that
A1: q`1/|.q.|<=cn and
A2: q`2>0;
  per cases by A1,XXREAL_0:1;
  suppose
    q`1/|.q.|<cn;
    then
    FanN(cn,q)= |.q.|*|[(q`1/|.q.|-cn)/(1+cn), sqrt(1-((q`1/|.q.|-cn)/(1+
    cn))^2)]| by A2,Def4
      .= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)), |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(
    1+cn))^2))]| by EUCLID:62;
    hence thesis by Def5;
  end;
  suppose
A3: q`1/|.q.|=cn;
    then (q`1/|.q.|-cn)/(1-cn)=0;
    hence thesis by A2,A3,Th56;
  end;
end;

theorem Th58:
  for cn being Real st -1<cn & cn<1 holds (q`1/|.q.|>=cn & q`2>=0
& q<>0.TOP-REAL 2 implies cn-FanMorphN.q= |[ |.q.|*((q`1/|.q.|-cn)/(1-cn)), |.q
  .|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]|) & (q`1/|.q.|<=cn & q`2>=0 & q<>0.
  TOP-REAL 2 implies cn-FanMorphN.q= |[ |.q.|*((q`1/|.q.|-cn)/(1+cn)), |.q.|*(
  sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]|)
proof
  let cn be Real;
  assume that
A1: -1<cn and
A2: cn<1;
  per cases;
  suppose
A3: q`1/|.q.|>=cn & q`2>=0 & q<>0.TOP-REAL 2;
    per cases;
    suppose
A4:   q`2>0;
      then
      FanN(cn,q)= |.q.|*|[(q`1/|.q.|-cn)/(1-cn), sqrt(1-((q`1/|.q.|-cn)/(1
      -cn))^2)]| by A3,Def4
        .= |[|.q.|* ((q`1/|.q.|-cn)/(1-cn)), |.q.|*( sqrt(1-((q`1/|.q.|-cn)/
      (1-cn))^2))]| by EUCLID:62;
      hence thesis by A4,Def5,Th57;
    end;
    suppose
A5:   q`2<=0;
      then
A6:   cn-FanMorphN.q=q by Th56;
A7:   (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
A8:   1-cn>0 by A2,XREAL_1:151;
A9:   q`2=0 by A3,A5;
      |.q.|<>0 by A3,TOPRNS_1:25;
      then |.q.|^2>0 by SQUARE_1:74;
      then (q`1)^2/|.q.|^2=1^2 by A7,A9,XCMPLX_1:60;
      then ((q`1)/|.q.|)^2=1^2 by XCMPLX_1:77;
      then
A10:  sqrt(((q`1)/|.q.|)^2)=1 by SQUARE_1:89;
A11:  now
        assume
        q`1<0;
        then -((q`1)/|.q.|)=1 by A10,SQUARE_1:90;
        hence contradiction by A1,A3;
      end;
      sqrt((|.q.|)^2)=|.q.| by SQUARE_1:89;
      then
A12:  |.q.|=q`1 by A7,A9,A11,SQUARE_1:89;
      then 1=q`1/|.q.| by A3,TOPRNS_1:25,XCMPLX_1:60;
      then (q`1/|.q.|-cn)/(1-cn)=1 by A8,XCMPLX_1:60;
      hence thesis by A2,A6,A9,A12,EUCLID:57,SQUARE_1:82,TOPRNS_1:25 ,
      XCMPLX_1:60;
    end;
  end;
  suppose
A13: q`1/|.q.|<=cn & q`2>=0 & q<>0.TOP-REAL 2;
    per cases;
    suppose
      q`2>0;
      hence thesis by Th56,Th57;
    end;
    suppose
A14:  q`2<=0;
A15:  1+cn>0 by A1,XREAL_1:150;
A16:  |.q.|<>0 by A13,TOPRNS_1:25;
A17:  q`2=0 by A13,A14;
      |.q.|>0 & 1>q`1/|.q.| by A2,A13,Lm1,XXREAL_0:2;
      then 1 *(|.q.|)>q`1/|.q.|*(|.q.|) by XREAL_1:70;
      then
A18:  (|.q.|)^2 =(q`1)^2+(q`2)^2 & (|.q.|)>q`1 by A13,JGRAPH_3:10,
      TOPRNS_1:25 ,XCMPLX_1:88;
      then
A19:  q`1= -(|.q.|) by A17,SQUARE_1:109;
      then -1=q`1/|.q.| by A13,TOPRNS_1:25,XCMPLX_1:198;
      then
A20:  (q`1/|.q.|-cn)/(1+cn) =(-(1+cn))/(1+cn)
        .=-1 by A15,XCMPLX_1:198;
      |.q.|=-q`1 by A17,A18,SQUARE_1:109;
      then
      |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)), |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(
      1+cn))^2))]| =q by A17,A20,EUCLID:57,SQUARE_1:82;
      hence thesis by A1,A14,A16,A19,Th56,XCMPLX_1:198;
    end;
  end;
  suppose
    q`2<0 or q=0.TOP-REAL 2;
    hence thesis;
  end;
end;

theorem Th59:
  for cn being Real,K1 being non empty Subset of TOP-REAL 2, f
being Function of (TOP-REAL 2)|K1,R^1 st cn<1 & (for p being Point of (TOP-REAL
2) st p in the carrier of (TOP-REAL 2)|K1 holds f.p=|.p.|* ((p`1/|.p.|-cn)/(1-
cn))) & (for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)|K1
  holds q`2>=0 & q<>0.TOP-REAL 2) holds f is continuous
proof
  let cn be Real,K1 be non empty Subset of TOP-REAL 2, f be Function of (
  TOP-REAL 2)|K1,R^1;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by
  Lm5;
  set a=cn, b=(1-cn);
  reconsider g2=proj1|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm2;
  assume that
A1: cn<1 and
A2: for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2
  )|K1 holds f.p=|.p.|* ((p`1/|.p.|-cn)/(1-cn)) and
A3: for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)
  |K1 holds q`2>=0 & q<>0.TOP-REAL 2;
  for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)|K1
  holds q<>0.TOP-REAL 2 by A3;
  then
A4: for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm6;
  b>0 by A1,XREAL_1:151;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
A5: for q being Point of (TOP-REAL 2)|K1,r1,r2 being Real st g2.q=r1 &
  g1.q =r2 holds g3.q=r2*((r1/r2-a)/b) and
A6: g3 is continuous by A4,Th10;
A7: dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then
A8: dom f=dom g3 by FUNCT_2:def 1;
  for x being set st x in dom f holds f.x=g3.x
  proof
    let x be set;
    assume
A9: x in dom f;
    then reconsider s=x as Point of (TOP-REAL 2)|K1;
    x in K1 by A7,A8,A9,PRE_TOPC:29;
    then reconsider r=x as Point of TOP-REAL 2;
A10: proj1.r=r`1 & (2 NormF).r=|.r.| by Def1,PSCOMP_1:def 28;
A11: g2.s=proj1.s & g1.s=(2 NormF).s by Lm2,Lm5;
    f.r=(|.r.|)* ((r`1/|.r.|-cn)/(1-cn)) by A2,A9;
    hence thesis by A5,A11,A10;
  end;
  hence thesis by A6,A8,FUNCT_1:9;
end;

theorem Th60:
  for cn being Real,K1 being non empty Subset of TOP-REAL 2, f
  being Function of (TOP-REAL 2)|K1,R^1 st -1<cn & (for p being Point of (
TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1 holds f.p=|.p.|* ((p`1/|.p.|
  -cn)/(1+cn))) & (for q being Point of TOP-REAL 2 st q in the carrier of (
  TOP-REAL 2)|K1 holds q`2>=0 & q<>0.TOP-REAL 2) holds f is continuous
proof
  let cn be Real,K1 be non empty Subset of TOP-REAL 2, f be Function of (
  TOP-REAL 2)|K1,R^1;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by
  Lm5;
  set a=cn, b=(1+cn);
  reconsider g2=proj1|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm2;
  assume that
A1: -1<cn and
A2: for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2
  )|K1 holds f.p=|.p.|* ((p`1/|.p.|-cn)/(1+cn)) and
A3: for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)
  |K1 holds q`2>=0 & q<>0.TOP-REAL 2;
  for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)|K1
  holds q<>0.TOP-REAL 2 by A3;
  then
A4: for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm6;
  1+cn>0 by A1,XREAL_1:150;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
A5: for q being Point of (TOP-REAL 2)|K1,r1,r2 being Real st g2.q=r1 &
  g1.q =r2 holds g3.q=r2*((r1/r2-a)/b) and
A6: g3 is continuous by A4,Th10;
A7: dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
A8: for x being set st x in dom f holds f.x=g3.x
  proof
    let x be set;
    assume
A9: x in dom f;
    then reconsider s=x as Point of (TOP-REAL 2)|K1;
    x in dom g3 by A7,A9;
    then x in K1 by A7,PRE_TOPC:29;
    then reconsider r=x as Point of TOP-REAL 2;
A10: proj1.r=r`1 & (2 NormF).r=|.r.| by Def1,PSCOMP_1:def 28;
A11: g2.s=proj1.s & g1.s=(2 NormF).s by Lm2,Lm5;
    f.r=(|.r.|)* ((r`1/|.r.|-cn)/(1+cn)) by A2,A9;
    hence thesis by A5,A11,A10;
  end;
  dom f=dom g3 by A7,FUNCT_2:def 1;
  hence thesis by A6,A8,FUNCT_1:9;
end;

theorem Th61:
  for cn being Real,K1 being non empty Subset of TOP-REAL 2, f
being Function of (TOP-REAL 2)|K1,R^1 st cn<1 & (for p being Point of (TOP-REAL
2) st p in the carrier of (TOP-REAL 2)|K1 holds f.p=|.p.|*( sqrt(1-((p`1/|.p.|-
  cn)/(1-cn))^2))) & (for q being Point of TOP-REAL 2 st q in the carrier of (
  TOP-REAL 2)|K1 holds q`2>=0 & q`1/|.q.|>=cn & q<>0.TOP-REAL 2) holds f is
  continuous
proof
  let cn be Real,K1 be non empty Subset of TOP-REAL 2, f be Function of (
  TOP-REAL 2)|K1,R^1;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by
  Lm5;
  set a=cn, b=(1-cn);
  reconsider g2=proj1|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm2;
  assume that
A1: cn<1 and
A2: for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2
  )|K1 holds f.p=|.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)) and
A3: for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)
  |K1 holds q`2>=0 & q`1/|.q.|>=cn & q<>0.TOP-REAL 2;
  for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)|K1
  holds q<>0.TOP-REAL 2 by A3;
  then
A4: for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm6;
  b>0 by A1,XREAL_1:151;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
A5: for q being Point of (TOP-REAL 2)|K1,r1,r2 being real number st g2.q
  =r1 & g1.q=r2 holds g3.q=r2*( sqrt(abs(1-((r1/r2-a)/b)^2))) and
A6: g3 is continuous by A4,Th15;
A7: dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then
A8: dom f=dom g3 by FUNCT_2:def 1;
  for x being set st x in dom f holds f.x=g3.x
  proof
    let x be set;
A9: 1-cn>0 by A1,XREAL_1:151;
    assume
A10: x in dom f;
    then x in K1 by A7,A8,PRE_TOPC:29;
    then reconsider r=x as Point of TOP-REAL 2;
A11: |.r.|<>0 by A3,A10,TOPRNS_1:25;
    |.r.|^2=(r`1)^2+(r`2)^2 by JGRAPH_3:10;
    then
A12: ((r`1) -(|.r.|))*((r`1)+|.r.|) =-(r`2)^2;
    (r`2)^2>=0 by XREAL_1:65;
    then r`1<= |.r.| by A12,XREAL_1:95;
    then r`1/|.r.| <= |.r.|/|.r.| by XREAL_1:74;
    then r`1/|.r.|<=1 by A11,XCMPLX_1:60;
    then
A13: r`1/|.r.|-cn<=(1-cn) by XREAL_1:11;
    reconsider s=x as Point of (TOP-REAL 2)|K1 by A10;
A14: now
      assume
      (1-cn)^2=0;
      then 1-cn+cn=0+cn by XCMPLX_1:6;
      hence contradiction by A1;
    end;
    cn-r`1/|.r.|<=0 by A3,A10,XREAL_1:49;
    then -(cn- r`1/|.r.|)>=-(1-cn) by A9,XREAL_1:26;
    then (1-cn)^2>=0 & (r`1/|.r.|-cn)^2<=(1-cn)^2 by A13,SQUARE_1:119,
    XREAL_1:65;
    then (r`1/|.r.|-cn)^2/(1-cn)^2<=(1-cn)^2/(1-cn)^2 by XREAL_1:74;
    then (r`1/|.r.|-cn)^2/(1-cn)^2<=1 by A14,XCMPLX_1:60;
    then ((r`1/|.r.|-cn)/(1-cn))^2<=1 by XCMPLX_1:77;
    then 1-((r`1/|.r.|-cn)/(1-cn))^2>=0 by XREAL_1:50;
    then abs(1-((r`1/|.r.|-cn)/(1-cn))^2) =1-((r`1/|.r.|-cn)/(1-cn))^2 by
    ABSVALUE:def 1;
    then
A15: f.r=(|.r.|)*( sqrt(abs(1-((r`1/|.r.|-cn)/(1-cn))^2))) by A2,A10;
A16: proj1.r=r`1 & (2 NormF).r=|.r.| by Def1,PSCOMP_1:def 28;
    g2.s=proj1.s & g1.s=(2 NormF).s by Lm2,Lm5;
    hence thesis by A5,A15,A16;
  end;
  hence thesis by A6,A8,FUNCT_1:9;
end;

theorem Th62:
  for cn being Real,K1 being non empty Subset of TOP-REAL 2, f
  being Function of (TOP-REAL 2)|K1,R^1 st -1<cn & (for p being Point of (
TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1 holds f.p=|.p.|*( sqrt(1-((p
  `1/|.p.|-cn)/(1+cn))^2))) & (for q being Point of TOP-REAL 2 st q in the
  carrier of (TOP-REAL 2)|K1 holds q`2>=0 & q`1/|.q.|<=cn & q<>0.TOP-REAL 2)
  holds f is continuous
proof
  let cn be Real,K1 be non empty Subset of TOP-REAL 2, f be Function of (
  TOP-REAL 2)|K1,R^1;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by
  Lm5;
  set a=cn, b=(1+cn);
  reconsider g2=proj1|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm2;
  assume that
A1: -1<cn and
A2: for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2
  )|K1 holds f.p=|.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)) and
A3: for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)
  |K1 holds q`2>=0 & q`1/|.q.|<=cn & q<>0.TOP-REAL 2;
A4: 1+cn>0 by A1,XREAL_1:150;
  for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)|K1
  holds q<>0.TOP-REAL 2 by A3;
  then for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm6;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
A5: for q being Point of (TOP-REAL 2)|K1,r1,r2 being real number st g2.q
  =r1 & g1.q=r2 holds g3.q=r2*( sqrt(abs(1-((r1/r2-a)/b)^2))) and
A6: g3 is continuous by A4,Th15;
A7: dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then
A8: dom f=dom g3 by FUNCT_2:def 1;
  for x being set st x in dom f holds f.x=g3.x
  proof
    let x be set;
    assume
A9: x in dom f;
    then x in K1 by A7,A8,PRE_TOPC:29;
    then reconsider r=x as Point of TOP-REAL 2;
    reconsider s=x as Point of (TOP-REAL 2)|K1 by A9;
A10: (1+cn)^2>0 by A4,SQUARE_1:74;
A11: |.r.|<>0 by A3,A9,TOPRNS_1:25;
    |.r.|^2=(r`1)^2+(r`2)^2 by JGRAPH_3:10;
    then
A12: ((r`1) -(|.r.|))*((r`1)+|.r.|) =-(r`2)^2;
    (r`2)^2>=0 by XREAL_1:65;
    then -(|.r.|)<=r`1 by A12,XREAL_1:95;
    then r`1/|.r.| >= (-(|.r.|))/|.r.| by XREAL_1:74;
    then r`1/|.r.|>= -1 by A11,XCMPLX_1:198;
    then r`1/|.r.|-cn>=-1-cn by XREAL_1:11;
    then
A13: r`1/|.r.|-cn>=-(1+cn);
    cn-r`1/|.r.|>=0 by A3,A9,XREAL_1:50;
    then -(cn-r`1/|.r.|)<=-0;
    then (r`1/|.r.|-cn)^2<=(1+cn)^2 by A4,A13,SQUARE_1:119;
    then (r`1/|.r.|-cn)^2/(1+cn)^2<=(1+cn)^2/(1+cn)^2 by A4,XREAL_1:74;
    then (r`1/|.r.|-cn)^2/(1+cn)^2<=1 by A10,XCMPLX_1:60;
    then ((r`1/|.r.|-cn)/(1+cn))^2<=1 by XCMPLX_1:77;
    then 1-((r`1/|.r.|-cn)/(1+cn))^2>=0 by XREAL_1:50;
    then abs(1-((r`1/|.r.|-cn)/(1+cn))^2) =1-((r`1/|.r.|-cn)/(1+cn))^2 by
    ABSVALUE:def 1;
    then
A14: f.r=(|.r.|)*( sqrt(abs(1-((r`1/|.r.|-cn)/(1+cn))^2))) by A2,A9;
A15: proj1.r=r`1 & (2 NormF).r=|.r.| by Def1,PSCOMP_1:def 28;
    g2.s=proj1.s & g1.s=(2 NormF).s by Lm2,Lm5;
    hence thesis by A5,A14,A15;
  end;
  hence thesis by A6,A8,FUNCT_1:9;
end;

theorem Th63:
  for cn being Real, K0,B0 being Subset of TOP-REAL 2,f being
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0 st -1<cn & cn<1 & f=(cn-FanMorphN)|
K0 & B0={q where q is Point of TOP-REAL 2: q`2>=0 & q<>0.TOP-REAL 2} & K0={p: p
  `1/|.p.|>=cn & p`2>=0 & p<>0.TOP-REAL 2} holds f is continuous
proof
  let cn be Real,K0,B0 be Subset of TOP-REAL 2,f be Function of (TOP-REAL 2)|
  K0,(TOP-REAL 2)|B0;
  set sn=sqrt(1-cn^2);
  set p0=|[cn,sn]|;
A1: p0`2=sn by EUCLID:56;
  p0`1=cn by EUCLID:56;
  then
A2: |.p0.|=sqrt((sn)^2+cn^2) by A1,JGRAPH_3:10;
  assume
A3: -1<cn & cn<1 & f=(cn-FanMorphN)|K0 & B0={q where q is Point of
  TOP-REAL 2: q`2>=0 & q<>0.TOP-REAL 2} & K0={p: p`1/|.p.|>=cn & p`2>=0 & p<>0.
  TOP-REAL 2};
  then cn^2<1^2 by SQUARE_1:120;
  then
A4: 1-cn^2>0 by XREAL_1:52;
  then sn^2=1-cn^2 by SQUARE_1:def 4;
  then
A5: p0`1/|.p0.|=cn by A2,EUCLID:56,SQUARE_1:83;
  p0`2>0 by A1,A4,SQUARE_1:93;
  then
A6: p0 in K0 by A3,A5,JGRAPH_2:11;
  then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
A7: rng (proj2*((cn-FanMorphN)|K1)) c= the carrier of R^1 by TOPMETR:24;
A8: K0 c= B0
  proof
    let x be set;
    assume
    x in K0;
    then
    ex p8 being Point of TOP-REAL 2 st x=p8 & p8`1/|.p8.|>= cn & p8`2>=0 &
    p8<>0.TOP-REAL 2 by A3;
    hence thesis by A3;
  end;
A9: dom ((cn-FanMorphN)|K1) c= dom (proj1*((cn-FanMorphN)|K1))
  proof
    let x be set;
    assume
A10: x in dom ((cn-FanMorphN)|K1);
    then x in dom (cn-FanMorphN) /\ K1 by RELAT_1:90;
    then x in dom (cn-FanMorphN) by XBOOLE_0:def 4;
    then
A11: dom proj1 = (the carrier of TOP-REAL 2) & (cn-FanMorphN).x in rng (cn
    -FanMorphN) by FUNCT_1:12,FUNCT_2:def 1;
    ((cn-FanMorphN)|K1).x=(cn-FanMorphN).x by A10,FUNCT_1:70;
    hence thesis by A10,A11,FUNCT_1:21;
  end;
A12: rng (proj1*((cn-FanMorphN)|K1)) c= the carrier of R^1 by TOPMETR:24;
  dom (proj1*((cn-FanMorphN)|K1)) c= dom ((cn-FanMorphN)|K1) by RELAT_1:
  44;
  then dom (proj1*((cn-FanMorphN)|K1)) =dom ((cn-FanMorphN)|K1) by A9,
  XBOOLE_0:def 10
    .=dom (cn-FanMorphN) /\ K1 by RELAT_1:90
    .=(the carrier of TOP-REAL 2)/\ K1 by FUNCT_2:def 1
    .=K1 by XBOOLE_1:28
    .=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
  then reconsider
  g2=proj1*((cn-FanMorphN)|K1) as Function of (TOP-REAL 2)|K1,R^1
  by A12,FUNCT_2:4;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g2.p=|.p.|* ((p`1/|.p.|-cn)/(1-cn))
  proof
    let p be Point of TOP-REAL 2;
A13: dom ((cn-FanMorphN)|K1)=dom (cn-FanMorphN) /\ K1 by RELAT_1:90
      .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
      .=K1 by XBOOLE_1:28;
A14: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    assume
A15: p in the carrier of (TOP-REAL 2)|K1;
    then
    ex p3 being Point of TOP-REAL 2 st p=p3 & p3`1/|.p3.|>= cn & p3`2>=0 &
    p3<>0.TOP-REAL 2 by A3,A14;
    then
A16: (cn-FanMorphN).p =|[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)), |.p.|*( sqrt(1-(
    (p`1/|.p.|-cn)/(1-cn))^2))]| by A3,Th58;
    ((cn-FanMorphN)|K1).p=(cn-FanMorphN).p by A15,A14,FUNCT_1:72;
    then g2.p=proj1.(|[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)), |.p.|*( sqrt(1-((p`1/
    |.p.|-cn)/(1-cn))^2))]|) by A15,A13,A14,A16,FUNCT_1:23
      .=(|[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)), |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(
    1-cn))^2))]|)`1 by PSCOMP_1:def 28
      .=|.p.|* ((p`1/|.p.|-cn)/(1-cn)) by EUCLID:56;
    hence thesis;
  end;
  then consider f2 being Function of (TOP-REAL 2)|K1,R^1 such that
A17: for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)
  |K1 holds f2.p=|.p.|* ((p`1/|.p.|-cn)/(1-cn));
A18: dom ((cn-FanMorphN)|K1) c= dom (proj2*((cn-FanMorphN)|K1))
  proof
    let x be set;
    assume
A19: x in dom ((cn-FanMorphN)|K1);
    then x in dom (cn-FanMorphN) /\ K1 by RELAT_1:90;
    then x in dom (cn-FanMorphN) by XBOOLE_0:def 4;
    then
A20: dom proj2 = (the carrier of TOP-REAL 2) & (cn-FanMorphN).x in rng (cn
    -FanMorphN) by FUNCT_1:12,FUNCT_2:def 1;
    ((cn-FanMorphN)|K1).x=(cn-FanMorphN).x by A19,FUNCT_1:70;
    hence thesis by A19,A20,FUNCT_1:21;
  end;
  dom (proj2*((cn-FanMorphN)|K1)) c= dom ((cn-FanMorphN)|K1) by RELAT_1:
  44;
  then dom (proj2*((cn-FanMorphN)|K1)) =dom ((cn-FanMorphN)|K1) by A18,
  XBOOLE_0:def 10
    .=dom (cn-FanMorphN) /\ K1 by RELAT_1:90
    .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
    .=K1 by XBOOLE_1:28
    .=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
  then reconsider
  g1=proj2*((cn-FanMorphN)|K1) as Function of (TOP-REAL 2)|K1,R^1
  by A7,FUNCT_2:4;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g1.p=|.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))
  proof
    let p be Point of TOP-REAL 2;
A21: dom ((cn-FanMorphN)|K1)=dom (cn-FanMorphN) /\ K1 by RELAT_1:90
      .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
      .=K1 by XBOOLE_1:28;
A22: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    assume
A23: p in the carrier of (TOP-REAL 2)|K1;
    then
    ex p3 being Point of TOP-REAL 2 st p=p3 & p3`1/|.p3.|>= cn & p3`2>=0 &
    p3<>0.TOP-REAL 2 by A3,A22;
    then
A24: (cn-FanMorphN).p=|[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)), |.p.|*( sqrt(1-((
    p`1/|.p.|-cn)/(1-cn))^2))]| by A3,Th58;
    ((cn-FanMorphN)|K1).p=(cn-FanMorphN).p by A23,A22,FUNCT_1:72;
    then g1.p=proj2.(|[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)), |.p.|*( sqrt(1-((p`1/
    |.p.|-cn)/(1-cn))^2))]|) by A23,A21,A22,A24,FUNCT_1:23
      .=(|[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)), |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(
    1-cn))^2))]|)`2 by PSCOMP_1:def 29
      .= |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)) by EUCLID:56;
    hence thesis;
  end;
  then consider f1 being Function of (TOP-REAL 2)|K1,R^1 such that
A25: for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)
  |K1 holds f1.p=|.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2));
  for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)|K1
  holds q`2>=0 & q`1/|.q.|>=cn & q<>0.TOP-REAL 2
  proof
    let q be Point of TOP-REAL 2;
A26: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    assume
    q in the carrier of (TOP-REAL 2)|K1;
    then
    ex p3 being Point of TOP-REAL 2 st q=p3 & p3`1/|.p3.|>= cn & p3`2>=0 &
    p3<>0.TOP-REAL 2 by A3,A26;
    hence thesis;
  end;
  then
A27: f1 is continuous by A3,A25,Th61;
A28: for x,y,s,r being real number st |[x,y]| in K1 & s=f2.(|[x,y]|) & r=f1.
  (|[x,y]|) holds f.(|[x,y]|)=|[s,r]|
  proof
    let x,y,s,r be real number;
    assume that
A29: |[x,y]| in K1 and
A30: s=f2.(|[x,y]|) & r=f1.(|[x,y]|);
    set p99=|[x,y]|;
A31: ex p3 being Point of TOP-REAL 2 st p99=p3 & p3`1/|.p3.| >=cn & p3`2>=0
    & p3<>0.TOP-REAL 2 by A3,A29;
A32: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then
A33: f1.p99=|.p99.|*( sqrt(1-((p99`1/|.p99.|-cn)/(1-cn))^2)) by A25,A29;
    ((cn-FanMorphN)|K0).(|[x,y]|)=((cn-FanMorphN)).(|[x,y]|) by A29,
    FUNCT_1:72
      .= |[ |.p99.|* ((p99`1/|.p99.|-cn)/(1-cn)), |.p99.|*( sqrt(1-((p99`1/
    |.p99.|-cn)/(1-cn))^2))]| by A3,A31,Th58
      .=|[s,r]| by A17,A29,A30,A32,A33;
    hence thesis by A3;
  end;
  for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)|K1
  holds q`2>=0 & q<>0.TOP-REAL 2
  proof
    let q be Point of TOP-REAL 2;
A34: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    assume
    q in the carrier of (TOP-REAL 2)|K1;
    then
    ex p3 being Point of TOP-REAL 2 st q=p3 & p3`1/|.p3.|>= cn & p3`2>=0 &
    p3<>0.TOP-REAL 2 by A3,A34;
    hence thesis;
  end;
  then f2 is continuous by A3,A17,Th59;
  hence thesis by A6,A8,A27,A28,JGRAPH_2:45;
end;

theorem Th64:
  for cn being Real, K0,B0 being Subset of TOP-REAL 2,f being
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0 st -1<cn & cn<1 & f=(cn-FanMorphN)|
K0 & B0={q where q is Point of TOP-REAL 2: q`2>=0 & q<>0.TOP-REAL 2} & K0={p: p
  `1/|.p.|<=cn & p`2>=0 & p<>0.TOP-REAL 2} holds f is continuous
proof
  let cn be Real,K0,B0 be Subset of TOP-REAL 2,f be Function of (TOP-REAL 2)|
  K0,(TOP-REAL 2)|B0;
  set sn=sqrt(1-cn^2);
  set p0=|[cn,sn]|;
A1: p0`2=sn by EUCLID:56;
  p0`1=cn by EUCLID:56;
  then
A2: |.p0.|=sqrt((sn)^2+cn^2) by A1,JGRAPH_3:10;
  assume
A3: -1<cn & cn<1 & f=(cn-FanMorphN)|K0 & B0={q where q is Point of
  TOP-REAL 2: q`2>=0 & q<>0.TOP-REAL 2} & K0={p: p`1/|.p.|<=cn & p`2>=0 & p<>0.
  TOP-REAL 2};
  then cn^2<1^2 by SQUARE_1:120;
  then
A4: 1-cn^2>0 by XREAL_1:52;
  then sn^2=1-cn^2 by SQUARE_1:def 4;
  then
A5: p0`1/|.p0.|=cn by A2,EUCLID:56,SQUARE_1:83;
  p0`2>0 by A1,A4,SQUARE_1:93;
  then
A6: p0 in K0 by A3,A5,JGRAPH_2:11;
  then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
A7: rng (proj2*((cn-FanMorphN)|K1)) c= the carrier of R^1 by TOPMETR:24;
A8: K0 c= B0
  proof
    let x be set;
    assume
    x in K0;
    then
    ex p8 being Point of TOP-REAL 2 st x=p8 & p8`1/|.p8.|<= cn & p8`2>=0 &
    p8<>0.TOP-REAL 2 by A3;
    hence thesis by A3;
  end;
A9: dom ((cn-FanMorphN)|K1) c= dom (proj1*((cn-FanMorphN)|K1))
  proof
    let x be set;
    assume
A10: x in dom ((cn-FanMorphN)|K1);
    then x in dom (cn-FanMorphN) /\ K1 by RELAT_1:90;
    then x in dom (cn-FanMorphN) by XBOOLE_0:def 4;
    then
A11: dom proj1 = (the carrier of TOP-REAL 2) & (cn-FanMorphN).x in rng (cn
    -FanMorphN) by FUNCT_1:12,FUNCT_2:def 1;
    ((cn-FanMorphN)|K1).x=(cn-FanMorphN).x by A10,FUNCT_1:70;
    hence thesis by A10,A11,FUNCT_1:21;
  end;
A12: rng (proj1*((cn-FanMorphN)|K1)) c= the carrier of R^1 by TOPMETR:24;
  dom (proj1*((cn-FanMorphN)|K1)) c= dom ((cn-FanMorphN)|K1) by RELAT_1:
  44;
  then dom (proj1*((cn-FanMorphN)|K1)) =dom ((cn-FanMorphN)|K1) by A9,
  XBOOLE_0:def 10
    .=dom (cn-FanMorphN) /\ K1 by RELAT_1:90
    .=(the carrier of TOP-REAL 2)/\ K1 by FUNCT_2:def 1
    .=K1 by XBOOLE_1:28
    .=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
  then reconsider
  g2=proj1*((cn-FanMorphN)|K1) as Function of (TOP-REAL 2)|K1,R^1
  by A12,FUNCT_2:4;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g2.p=|.p.|* ((p`1/|.p.|-cn)/(1+cn))
  proof
    let p be Point of TOP-REAL 2;
A13: dom ((cn-FanMorphN)|K1)=dom (cn-FanMorphN) /\ K1 by RELAT_1:90
      .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
      .=K1 by XBOOLE_1:28;
A14: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    assume
A15: p in the carrier of (TOP-REAL 2)|K1;
    then
    ex p3 being Point of TOP-REAL 2 st p=p3 & p3`1/|.p3.|<= cn & p3`2>=0 &
    p3<>0.TOP-REAL 2 by A3,A14;
    then
A16: (cn-FanMorphN).p =|[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)), |.p.|*( sqrt(1-(
    (p`1/|.p.|-cn)/(1+cn))^2))]| by A3,Th58;
    ((cn-FanMorphN)|K1).p=(cn-FanMorphN).p by A15,A14,FUNCT_1:72;
    then g2.p=proj1.(|[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)), |.p.|*( sqrt(1-((p`1/
    |.p.|-cn)/(1+cn))^2))]|) by A15,A13,A14,A16,FUNCT_1:23
      .=(|[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)), |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(
    1+cn))^2))]|)`1 by PSCOMP_1:def 28
      .=|.p.|* ((p`1/|.p.|-cn)/(1+cn)) by EUCLID:56;
    hence thesis;
  end;
  then consider f2 being Function of (TOP-REAL 2)|K1,R^1 such that
A17: for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)
  |K1 holds f2.p=|.p.|* ((p`1/|.p.|-cn)/(1+cn));
A18: dom ((cn-FanMorphN)|K1) c= dom (proj2*((cn-FanMorphN)|K1))
  proof
    let x be set;
    assume
A19: x in dom ((cn-FanMorphN)|K1);
    then x in dom (cn-FanMorphN) /\ K1 by RELAT_1:90;
    then x in dom (cn-FanMorphN) by XBOOLE_0:def 4;
    then
A20: dom proj2 = (the carrier of TOP-REAL 2) & (cn-FanMorphN).x in rng (cn
    -FanMorphN) by FUNCT_1:12,FUNCT_2:def 1;
    ((cn-FanMorphN)|K1).x=(cn-FanMorphN).x by A19,FUNCT_1:70;
    hence thesis by A19,A20,FUNCT_1:21;
  end;
  dom (proj2*((cn-FanMorphN)|K1)) c= dom ((cn-FanMorphN)|K1) by RELAT_1:
  44;
  then dom (proj2*((cn-FanMorphN)|K1)) =dom ((cn-FanMorphN)|K1) by A18,
  XBOOLE_0:def 10
    .=dom (cn-FanMorphN) /\ K1 by RELAT_1:90
    .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
    .=K1 by XBOOLE_1:28
    .=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
  then reconsider
  g1=proj2*((cn-FanMorphN)|K1) as Function of (TOP-REAL 2)|K1,R^1
  by A7,FUNCT_2:4;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g1.p=|.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))
  proof
    let p be Point of TOP-REAL 2;
A21: dom ((cn-FanMorphN)|K1)=dom (cn-FanMorphN) /\ K1 by RELAT_1:90
      .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
      .=K1 by XBOOLE_1:28;
A22: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    assume
A23: p in the carrier of (TOP-REAL 2)|K1;
    then
    ex p3 being Point of TOP-REAL 2 st p=p3 & p3`1/|.p3.|<= cn & p3`2>=0 &
    p3<>0.TOP-REAL 2 by A3,A22;
    then
A24: (cn-FanMorphN).p=|[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)), |.p.|*( sqrt(1-((
    p`1/|.p.|-cn)/(1+cn))^2))]| by A3,Th58;
    ((cn-FanMorphN)|K1).p=(cn-FanMorphN).p by A23,A22,FUNCT_1:72;
    then g1.p=proj2.(|[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)), |.p.|*( sqrt(1-((p`1/
    |.p.|-cn)/(1+cn))^2))]|) by A23,A21,A22,A24,FUNCT_1:23
      .=(|[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)), |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(
    1+cn))^2))]|)`2 by PSCOMP_1:def 29
      .= |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)) by EUCLID:56;
    hence thesis;
  end;
  then consider f1 being Function of (TOP-REAL 2)|K1,R^1 such that
A25: for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)
  |K1 holds f1.p=|.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2));
  for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)|K1
  holds q`2>=0 & q`1/|.q.|<=cn & q<>0.TOP-REAL 2
  proof
    let q be Point of TOP-REAL 2;
A26: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    assume
    q in the carrier of (TOP-REAL 2)|K1;
    then
    ex p3 being Point of TOP-REAL 2 st q=p3 & p3`1/|.p3.|<= cn & p3`2>=0 &
    p3<>0.TOP-REAL 2 by A3,A26;
    hence thesis;
  end;
  then
A27: f1 is continuous by A3,A25,Th62;
A28: for x,y,s,r being real number st |[x,y]| in K1 & s=f2.(|[x,y]|) & r=f1.
  (|[x,y]|) holds f.(|[x,y]|)=|[s,r]|
  proof
    let x,y,s,r be real number;
    assume that
A29: |[x,y]| in K1 and
A30: s=f2.(|[x,y]|) & r=f1.(|[x,y]|);
    set p99=|[x,y]|;
A31: ex p3 being Point of TOP-REAL 2 st p99=p3 & p3`1/|.p3.| <=cn & p3`2>=0
    & p3<>0.TOP-REAL 2 by A3,A29;
A32: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then
A33: f1.p99=|.p99.|*( sqrt(1-((p99`1/|.p99.|-cn)/(1+cn))^2)) by A25,A29;
    ((cn-FanMorphN)|K0).(|[x,y]|)=((cn-FanMorphN)).(|[x,y]|) by A29,
    FUNCT_1:72
      .= |[ |.p99.|* ((p99`1/|.p99.|-cn)/(1+cn)), |.p99.|*( sqrt(1-((p99`1/
    |.p99.|-cn)/(1+cn))^2))]| by A3,A31,Th58
      .=|[s,r]| by A17,A29,A30,A32,A33;
    hence thesis by A3;
  end;
  for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)|K1
  holds q`2>=0 & q<>0.TOP-REAL 2
  proof
    let q be Point of TOP-REAL 2;
A34: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    assume
    q in the carrier of (TOP-REAL 2)|K1;
    then
    ex p3 being Point of TOP-REAL 2 st q=p3 & p3`1/|.p3.|<= cn & p3`2>=0 &
    p3<>0.TOP-REAL 2 by A3,A34;
    hence thesis;
  end;
  then f2 is continuous by A3,A17,Th60;
  hence thesis by A6,A8,A27,A28,JGRAPH_2:45;
end;

theorem Th65:
  for cn being Real, K03 being Subset of TOP-REAL 2 st K03={p: p`1
  >=(cn)*(|.p.|) & p`2>=0} holds K03 is closed
proof
  defpred Q[Point of TOP-REAL 2] means $1`2>=0;
  let sn be Real, K003 be Subset of TOP-REAL 2;
  assume
A1: K003={p: p`1>=(sn)*(|.p.|) & p`2>=0};
  reconsider KX={p where p is Point of TOP-REAL 2: Q[p]} as Subset of TOP-REAL
  2 from JGRAPH_2:sch 1;
  defpred P[Point of TOP-REAL 2] means ($1`1>=sn*|.$1.|);
  reconsider K1={p7 where p7 is Point of TOP-REAL 2:P[p7]} as Subset of
  TOP-REAL 2 from JGRAPH_2:sch 1;
A2: {p : P[p] & Q[p]} = {p7 where p7 is Point of TOP-REAL 2:P[p7]} /\ {p1
  where p1 is Point of TOP-REAL 2: Q[p1]} from DOMAIN_1:sch 10;
  K1 is closed & KX is closed by Lm8,JORDAN6:8;
  hence thesis by A1,A2,TOPS_1:35;
end;

theorem Th66:
  for cn being Real, K03 being Subset of TOP-REAL 2 st K03={p: p`1
  <=(cn)*(|.p.|) & p`2>=0} holds K03 is closed
proof
  defpred Q[Point of TOP-REAL 2] means $1`2>=0;
  let sn be Real, K003 be Subset of TOP-REAL 2;
  assume
A1: K003={p: p`1<=(sn)*(|.p.|) & p`2>=0};
  reconsider KX={p where p is Point of TOP-REAL 2: Q[p]} as Subset of TOP-REAL
  2 from JGRAPH_2:sch 1;
  defpred P[Point of TOP-REAL 2] means ($1`1<=sn*|.$1.|);
  reconsider K1={p7 where p7 is Point of TOP-REAL 2:P[p7]} as Subset of
  TOP-REAL 2 from JGRAPH_2:sch 1;
A2: {p : P[p] & Q[p]} = {p7 where p7 is Point of TOP-REAL 2:P[p7]} /\ {p1
  where p1 is Point of TOP-REAL 2: Q[p1]} from DOMAIN_1:sch 10;
  K1 is closed & KX is closed by Lm10,JORDAN6:8;
  hence thesis by A1,A2,TOPS_1:35;
end;

theorem Th67:
  for cn being Real, K0,B0 being Subset of TOP-REAL 2,f being
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0 st -1<cn & cn<1 & f=(cn-FanMorphN)|
  K0 & B0=NonZero TOP-REAL 2 & K0={p: p`2>=0 & p<>0.TOP-REAL 2} holds f is
  continuous
proof
  let cn be Real,K0,B0 be Subset of TOP-REAL 2,f be Function of (TOP-REAL 2)|
  K0,(TOP-REAL 2)|B0;
  set sn=sqrt(1-cn^2);
  set p0=|[cn,sn]|;
A1: p0`2=sn by EUCLID:56;
  assume
A2: -1<cn & cn<1 & f=(cn-FanMorphN)|K0 & B0=NonZero TOP-REAL 2 & K0={p:
  p`2>=0 & p<>0.TOP-REAL 2};
  then cn^2<1^2 by SQUARE_1:120;
  then
A3: 1-cn^2>0 by XREAL_1:52;
  then
A4: p0`2>0 by A1,SQUARE_1:93;
  then p0 in K0 by A2,JGRAPH_2:11;
  then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
  p0<>0.TOP-REAL 2 by A1,A3,JGRAPH_2:11,SQUARE_1:93;
  then not p0 in {0.TOP-REAL 2} by TARSKI:def 1;
  then reconsider D=B0 as non empty Subset of TOP-REAL 2 by A2,XBOOLE_0:def 5;
A5: the carrier of (TOP-REAL 2)|K1 = K1 by PRE_TOPC:29;
  p0`1=cn by EUCLID:56;
  then
A6: |.p0.|=sqrt((sn)^2+cn^2) by A1,JGRAPH_3:10;
A7: D<>{};
  sn^2=1-cn^2 by A3,SQUARE_1:def 4;
  then
A8: p0`1/|.p0.|=cn by A6,EUCLID:56,SQUARE_1:83;
  then
A9: p0 in {p: p`1/|.p.|>=cn & p`2>=0 & p<>0.TOP-REAL 2} by A4,
  JGRAPH_2:
  11;
A10: {p: p`1/|.p.|<=cn & p`2>=0 & p<>0.TOP-REAL 2} c= K1
  proof
    let x be set;
    assume
    x in {p: p`1/|.p.|<=cn & p`2>=0 & p<>0.TOP-REAL 2};
    then ex p st p=x & p`1/|.p.|<=cn & p`2>=0 & p<>0.TOP-REAL 2;
    hence thesis by A2;
  end;
A11: {p: p`1/|.p.|>=cn & p`2>=0 & p<>0.TOP-REAL 2} c= K1
  proof
    let x be set;
    assume
    x in {p: p`1/|.p.|>=cn & p`2>=0 & p<>0.TOP-REAL 2};
    then ex p st p=x & p`1/|.p.|>=cn & p`2>=0 & p<>0.TOP-REAL 2;
    hence thesis by A2;
  end;
  then reconsider
  K00={p: p`1/|.p.|>=cn & p`2>=0 & p<>0.TOP-REAL 2} as non empty
  Subset of ((TOP-REAL 2)|K1) by A9,PRE_TOPC:29;
  the carrier of (TOP-REAL 2)|D =D by PRE_TOPC:29;
  then
A12: rng (f|K00) c=D;
  p0 in {p: p`1/|.p.|<=cn & p`2>=0 & p<>0.TOP-REAL 2} by A4,A8,JGRAPH_2:
  11;
  then reconsider
  K11={p: p`1/|.p.|<=cn & p`2>=0 & p<>0.TOP-REAL 2} as non empty
  Subset of ((TOP-REAL 2)|K1) by A10,PRE_TOPC:29;
  the carrier of (TOP-REAL 2)|D =D by PRE_TOPC:29;
  then
A13: rng (f|K11) c=D;
  the carrier of (TOP-REAL 2)|B0=the carrier of (TOP-REAL 2)|D;
  then
A14: dom f=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1
    .=K1 by PRE_TOPC:29;
  then dom (f|K00)=K00 by A11,RELAT_1:91
    .= the carrier of ((TOP-REAL 2)|K1)|K00 by PRE_TOPC:29;
  then reconsider
  f1=f|K00 as Function of ((TOP-REAL 2)|K1)|K00,(TOP-REAL 2)|D by
  A12,FUNCT_2:4;
  dom (f|K11)=K11 by A10,A14,RELAT_1:91
    .= the carrier of ((TOP-REAL 2)|K1)|K11 by PRE_TOPC:29;
  then reconsider
  f2=f|K11 as Function of ((TOP-REAL 2)|K1)|K11,(TOP-REAL 2)|D by
  A13,FUNCT_2:4;
  defpred P[Point of TOP-REAL 2] means $1`1/|.$1.|>=cn & $1`2>=0 & $1<>0.
  TOP-REAL 2;
A15: dom f2=the carrier of ((TOP-REAL 2)|K1)|K11 by FUNCT_2:def 1
    .=K11 by PRE_TOPC:29;
  {p: P[p]} is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
  then reconsider
  K001={p: p`1/|.p.|>=cn & p`2>=0 & p<>0.TOP-REAL 2} as non empty
  Subset of (TOP-REAL 2) by A9;
A16: the carrier of (TOP-REAL 2)|K1 =K1 by PRE_TOPC:29;
  defpred P[Point of TOP-REAL 2] means $1`1>=(cn)*(|.$1.|) & $1`2>=0;
  {p: P[p]} is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
  then reconsider
  K003={p: p`1>=(cn)*(|.p.|) & p`2>=0} as Subset of (TOP-REAL 2);
  defpred P[Point of TOP-REAL 2] means $1`1/|.$1.|<=cn & $1`2>=0 & $1<>0.
  TOP-REAL 2;
A17: {p: P[p]} is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
A18: rng ((cn-FanMorphN)|K001) c= K1
  proof
    let y be set;
    assume
    y in rng ((cn-FanMorphN)|K001);
    then consider x being set such that
A19: x in dom ((cn-FanMorphN)|K001) and
A20: y=((cn-FanMorphN)|K001).x by FUNCT_1:def 5;
    reconsider q=x as Point of TOP-REAL 2 by A19;
A21: y=(cn-FanMorphN).q by A19,A20,FUNCT_1:70;
    dom ((cn-FanMorphN)|K001)=(dom (cn-FanMorphN))/\ K001 by RELAT_1:90
      .=(the carrier of TOP-REAL 2)/\ K001 by FUNCT_2:def 1
      .=K001 by XBOOLE_1:28;
    then
A22: ex p2 being Point of TOP-REAL 2 st p2=q & p2`1/|.p2.|>= cn & p2`2>=0 &
    p2<>0.TOP-REAL 2 by A19;
    then
A23: (q`1/|.q.|-cn)>= 0 by XREAL_1:50;
    |.q.|<>0 by A22,TOPRNS_1:25;
    then
A24: (|.q.|)^2>0^2 by SQUARE_1:74;
    set q4= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)), |.q.|*( sqrt(1-((q`1/|.q.|-cn)/
    (1-cn))^2))]|;
A25: q4`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by EUCLID:56;
A26: 1-cn>0 by A2,XREAL_1:151;
    0<=(q`2)^2 by XREAL_1:65;
    then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
    then (q`1)^2 <= (|.q.|)^2 by JGRAPH_3:10;
    then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by XREAL_1:74;
    then (q`1)^2/(|.q.|)^2 <= 1 by A24,XCMPLX_1:60;
    then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
    then 1>=q`1/|.q.| by SQUARE_1:121;
    then 1-cn>=q`1/|.q.|-cn by XREAL_1:11;
    then -(1-cn)<= -( q`1/|.q.|-cn) by XREAL_1:26;
    then (-(1-cn))/(1-cn)<=(-( q`1/|.q.|-cn))/(1-cn) by A26,XREAL_1:74;
    then -1<=(-( q`1/|.q.|-cn))/(1-cn) by A26,XCMPLX_1:198;
    then ((-(q`1/|.q.|-cn))/(1-cn))^2<=1^2 by A26,A23,SQUARE_1:119;
    then
A27: 1-((-(q`1/|.q.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
    then
A28: 1-(-((q`1/|.q.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
    sqrt(1-((-(q`1/|.q.|-cn))/(1-cn))^2)>=0 by A27,SQUARE_1:def 4;
    then sqrt(1-(-(q`1/|.q.|-cn))^2/(1-cn)^2)>=0 by XCMPLX_1:77;
    then sqrt(1-(q`1/|.q.|-cn)^2/(1-cn)^2)>=0;
    then
A29: sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)>=0 by XCMPLX_1:77;
A30: q4`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)) by EUCLID:56;
    then
A31: (q4`2)^2= (|.q.|)^2*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))^2
      .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1-cn))^2) by A28,SQUARE_1:def 4;
    (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
      .=(|.q.|)^2 by A25,A31;
    then
A32: q4<>0.TOP-REAL 2 by A24,TOPRNS_1:24;
    cn-FanMorphN.q= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)), |.q.|*( sqrt(1-((q
    `1/|.q.|-cn)/(1-cn))^2))]| by A2,A22,Th58;
    hence thesis by A2,A21,A30,A29,A32;
  end;
A33: dom (cn-FanMorphN)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
  then dom ((cn-FanMorphN)|K001)=K001 by RELAT_1:91
    .= the carrier of (TOP-REAL 2)|K001 by PRE_TOPC:29;
  then reconsider
  f3=(cn-FanMorphN)|K001 as Function of (TOP-REAL 2)|K001,(TOP-REAL
  2)|K1 by A5,A18,FUNCT_2:4;
A34: K003 is closed by Th65;
  K1 c= D
  proof
    let x be set;
    assume
A35: x in K1;
    then ex p6 being Point of TOP-REAL 2 st p6=x & p6`2>=0 & p6 <>0.TOP-REAL 2
    by A2;
    then not x in {0.TOP-REAL 2} by TARSKI:def 1;
    hence thesis by A2,A35,XBOOLE_0:def 5;
  end;
  then D=K1 \/ D by XBOOLE_1:12;
  then
A36: (TOP-REAL 2)|K1 is SubSpace of (TOP-REAL 2)|D by TOPMETR:5;
  p0 in {p: p`1/|.p.|<=cn & p`2>=0 & p<>0.TOP-REAL 2} by A4,A8,JGRAPH_2:
  11;
  then reconsider
  K111={p: p`1/|.p.|<=cn & p`2>=0 & p<>0.TOP-REAL 2} as non empty
  Subset of TOP-REAL 2 by A17;
A37: rng ((cn-FanMorphN)|K111) c= K1
  proof
    let y be set;
    assume
    y in rng ((cn-FanMorphN)|K111);
    then consider x being set such that
A38: x in dom ((cn-FanMorphN)|K111) and
A39: y=((cn-FanMorphN)|K111).x by FUNCT_1:def 5;
    reconsider q=x as Point of TOP-REAL 2 by A38;
A40: y=(cn-FanMorphN).q by A38,A39,FUNCT_1:70;
    dom ((cn-FanMorphN)|K111)=(dom (cn-FanMorphN))/\ K111 by RELAT_1:90
      .=(the carrier of TOP-REAL 2)/\ K111 by FUNCT_2:def 1
      .=K111 by XBOOLE_1:28;
    then
A41: ex p2 being Point of TOP-REAL 2 st p2=q & p2`1/|.p2.|<= cn & p2`2>=0 &
    p2<>0.TOP-REAL 2 by A38;
    then
A42: (q`1/|.q.|-cn)<=0 by XREAL_1:49;
    |.q.|<>0 by A41,TOPRNS_1:25;
    then
A43: (|.q.|)^2>0^2 by SQUARE_1:74;
    set q4= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)), |.q.|*( sqrt(1-((q`1/|.q.|-cn)/
    (1+cn))^2))]|;
A44: q4`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by EUCLID:56;
A45: 1+cn>0 by A2,XREAL_1:150;
    0<=(q`2)^2 by XREAL_1:65;
    then (|.q.|)^2 =(q`1)^2+(q`2)^2 & 0+(q`1)^2<=(q`1)^2+(q`2)^2 by
    JGRAPH_3:10 ,XREAL_1:9;
    then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by XREAL_1:74;
    then (q`1)^2/(|.q.|)^2 <= 1 by A43,XCMPLX_1:60;
    then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
    then -1<=q`1/|.q.| by SQUARE_1:121;
    then -1-cn<=q`1/|.q.|-cn by XREAL_1:11;
    then (-(1+cn))/(1+cn)<=(( q`1/|.q.|-cn))/(1+cn) by A45,XREAL_1:74;
    then -1<=(( q`1/|.q.|-cn))/(1+cn) by A45,XCMPLX_1:198;
    then
A46: ( (q`1/|.q.|-cn) /(1+cn))^2<=1^2 by A45,A42,SQUARE_1:119;
    then
A47: 1-((q`1/|.q.|-cn)/(1+cn))^2>=0 by XREAL_1:50;
    1-(-((q`1/|.q.|-cn)/(1+cn)))^2>=0 by A46,XREAL_1:50;
    then 1-((-(q`1/|.q.|-cn))/(1+cn))^2>=0 by XCMPLX_1:188;
    then sqrt(1-((-(q`1/|.q.|-cn))/(1+cn))^2)>=0 by SQUARE_1:def 4;
    then sqrt(1-(-(q`1/|.q.|-cn))^2/(1+cn)^2)>=0 by XCMPLX_1:77;
    then sqrt(1-(q`1/|.q.|-cn)^2/(1+cn)^2)>=0;
    then
A48: sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)>=0 by XCMPLX_1:77;
A49: q4`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)) by EUCLID:56;
    then
A50: (q4`2)^2= (|.q.|)^2*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))^2
      .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1+cn))^2) by A47,SQUARE_1:def 4;
    (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
      .=(|.q.|)^2 by A44,A50;
    then
A51: q4<>0.TOP-REAL 2 by A43,TOPRNS_1:24;
    cn-FanMorphN.q= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)), |.q.|*( sqrt(1-((q
    `1/|.q.|-cn)/(1+cn))^2))]| by A2,A41,Th58;
    hence thesis by A2,A40,A49,A48,A51;
  end;
  dom ((cn-FanMorphN)|K111)=K111 by A33,RELAT_1:91
    .= the carrier of (TOP-REAL 2)|K111 by PRE_TOPC:29;
  then reconsider
  f4=(cn-FanMorphN)|K111 as Function of (TOP-REAL 2)|K111,(TOP-REAL
  2)|K1 by A16,A37,FUNCT_2:4;
  the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
  then ((TOP-REAL 2)|K1)|K11=(TOP-REAL 2)|K111 & f2= f4 by A2,FUNCT_1:82
  ,GOBOARD9:4;
  then
A52: f2 is continuous by A2,A36,Th64,PRE_TOPC:56;
A53: the carrier of ((TOP-REAL 2)|K1)=K0 by PRE_TOPC:29;
  set T1= ((TOP-REAL 2)|K1)|K00,T2=((TOP-REAL 2)|K1)|K11;
A54: [#](((TOP-REAL 2)|K1)|K11)=K11 by PRE_TOPC:def 10;
  defpred P[Point of TOP-REAL 2] means $1`1<=cn*(|.$1.|) & $1`2>=0;
  {p: P[p]} is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
  then reconsider
  K004={p: p`1<=(cn)*(|.p.|) & p`2>=0} as Subset of (TOP-REAL 2);
A55: K004 /\ K1 c= K11
  proof
    let x be set;
    assume
A56: x in K004 /\ K1;
    then x in K004 by XBOOLE_0:def 4;
    then consider q1 being Point of TOP-REAL 2 such that
A57: q1=x and
A58: q1`1<=(cn)*(|.q1.|) and
    q1`2>=0;
    x in K1 by A56,XBOOLE_0:def 4;
    then
A59: ex q2 being Point of TOP-REAL 2 st q2=x & q2`2>=0 & q2 <>0.TOP-REAL 2
    by A2;
    q1`1/|.q1.|<=(cn)*(|.q1.|)/|.q1.| by A58,XREAL_1:74;
    then q1`1/|.q1.|<=(cn) by A57,A59,TOPRNS_1:25,XCMPLX_1:90;
    hence thesis by A57,A59;
  end;
A60: K004 is closed by Th66;
  the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
  then ((TOP-REAL 2)|K1)|K00=(TOP-REAL 2)|K001 & f1= f3 by A2,FUNCT_1:82
  ,GOBOARD9:4;
  then
A61: f1 is continuous by A2,A36,Th63,PRE_TOPC:56;
A62: [#]((TOP-REAL 2)|K1)=K1 by PRE_TOPC:def 10;
  K11 c= K004 /\ K1
  proof
    let x be set;
    assume
    x in K11;
    then consider p such that
A63: p=x and
A64: p`1/|.p.|<=cn and
A65: p`2>=0 and
A66: p<>0.TOP-REAL 2;
    p`1/|.p.|*|.p.|<=(cn)*(|.p.|) by A64,XREAL_1:66;
    then p`1<=(cn)*(|.p.|) by A66,TOPRNS_1:25,XCMPLX_1:88;
    then
A67: x in K004 by A63,A65;
    x in K1 by A2,A63,A65,A66;
    hence thesis by A67,XBOOLE_0:def 4;
  end;
  then K11=K004 /\ [#]((TOP-REAL 2)|K1) by A62,A55,XBOOLE_0:def 10;
  then
A68: K11 is closed by A60,PRE_TOPC:43;
A69: K003 /\ K1 c= K00
  proof
    let x be set;
    assume
A70: x in K003 /\ K1;
    then x in K003 by XBOOLE_0:def 4;
    then consider q1 being Point of TOP-REAL 2 such that
A71: q1=x and
A72: q1`1>=(cn)*(|.q1.|) and
    q1`2>=0;
    x in K1 by A70,XBOOLE_0:def 4;
    then
A73: ex q2 being Point of TOP-REAL 2 st q2=x & q2`2>=0 & q2 <>0.TOP-REAL 2
    by A2;
    q1`1/|.q1.|>=(cn)*(|.q1.|)/|.q1.| by A72,XREAL_1:74;
    then q1`1/|.q1.|>=(cn) by A71,A73,TOPRNS_1:25,XCMPLX_1:90;
    hence thesis by A71,A73;
  end;
  K00 c= K003 /\ K1
  proof
    let x be set;
    assume
    x in K00;
    then consider p such that
A74: p=x and
A75: p`1/|.p.|>=cn and
A76: p`2>=0 and
A77: p<>0.TOP-REAL 2;
    p`1/|.p.|*|.p.|>=(cn)*(|.p.|) by A75,XREAL_1:66;
    then p`1>=(cn)*(|.p.|) by A77,TOPRNS_1:25,XCMPLX_1:88;
    then
A78: x in K003 by A74,A76;
    x in K1 by A2,A74,A76,A77;
    hence thesis by A78,XBOOLE_0:def 4;
  end;
  then K00=K003 /\ [#]((TOP-REAL 2)|K1) by A62,A69,XBOOLE_0:def 10;
  then
A79: K00 is closed by A34,PRE_TOPC:43;
A80: [#](((TOP-REAL 2)|K1)|K00)=K00 by PRE_TOPC:def 10;
A81: for p being set st p in ([#]T1)/\([#]T2) holds f1.p = f2.p
  proof
    let p be set;
    assume
A82: p in ([#]T1)/\([#]T2);
    then p in K00 by A80,XBOOLE_0:def 4;
    hence f1.p=f.p by FUNCT_1:72
      .=f2.p by A54,A82,FUNCT_1:72;
  end;
A83: K1 c= K00 \/ K11
  proof
    let x be set;
    assume
    x in K1;
    then consider p such that
A84: p=x & p`2>=0 & p<>0.TOP-REAL 2 by A2;
    per cases;
    suppose
      p`1/|.p.|>=cn;
      then x in K00 by A84;
      hence thesis by XBOOLE_0:def 3;
    end;
    suppose
      p`1/|.p.|<cn;
      then x in K11 by A84;
      hence thesis by XBOOLE_0:def 3;
    end;
  end;
  then [#](((TOP-REAL 2)|K1)|K00) \/ [#](((TOP-REAL 2)|K1)|K11) =[#]((
  TOP-REAL 2)|K1) by A80,A54,A62,XBOOLE_0:def 10;
  then consider h being Function of (TOP-REAL 2)|K1,(TOP-REAL 2)|D such that
A85: h=f1+*f2 and
A86: h is continuous by A80,A54,A79,A68,A61,A52,A81,
  JGRAPH_2:9;
A87: dom h=the carrier of ((TOP-REAL 2)|K1) by FUNCT_2:def 1;
A88: dom f1=the carrier of ((TOP-REAL 2)|K1)|K00 by FUNCT_2:def 1
    .=K00 by PRE_TOPC:29;
A89: for y being set st y in dom h holds h.y=f.y
  proof
    let y be set;
    assume
A90: y in dom h;
    per cases by A83,A87,A53,A90,XBOOLE_0:def 3;
    suppose
A91:  y in K00 & not y in K11;
      then y in dom f1 \/ dom f2 by A88,XBOOLE_0:def 3;
      hence h.y=f1.y by A15,A85,A91,FUNCT_4:def 1
        .=f.y by A91,FUNCT_1:72;
    end;
    suppose
A92:  y in K11;
      then y in dom f1 \/ dom f2 by A15,XBOOLE_0:def 3;
      hence h.y=f2.y by A15,A85,A92,FUNCT_4:def 1
        .=f.y by A92,FUNCT_1:72;
    end;
  end;
  K0=the carrier of ((TOP-REAL 2)|K0) by PRE_TOPC:29
    .=dom f by A7,FUNCT_2:def 1;
  hence thesis by A86,A87,A89,FUNCT_1:9,PRE_TOPC:29;
end;

theorem Th68:
  for cn being Real, K0,B0 being Subset of TOP-REAL 2,f being
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0 st -1<cn & cn<1 & f=(cn-FanMorphN)|
  K0 & B0=NonZero TOP-REAL 2 & K0={p: p`2<=0 & p<>0.TOP-REAL 2} holds f is
  continuous
proof
  let cn be Real,K0,B0 be Subset of TOP-REAL 2,f be Function of (TOP-REAL 2)|
  K0,(TOP-REAL 2)|B0;
  set sn=sqrt(1-cn^2);
  set p0=|[cn,-sn]|;
  assume
A1: -1<cn & cn<1 & f=(cn-FanMorphN)|K0 & B0=NonZero TOP-REAL 2 & K0={p:
  p`2<=0 & p<>0.TOP-REAL 2};
  then cn^2<1^2 by SQUARE_1:120;
  then 1-cn^2>0 by XREAL_1:52;
  then p0`2=-sn & --sn>0 by EUCLID:56,SQUARE_1:93;
  then
A2: p0`2<0;
  then p0 in K0 by A1,JGRAPH_2:11;
  then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
  not p0 in {0.TOP-REAL 2} by A2,JGRAPH_2:11,TARSKI:def 1;
  then reconsider D=B0 as non empty Subset of TOP-REAL 2 by A1,XBOOLE_0:def 5;
A3: K1 c= D
  proof
    let x be set;
    assume
    x in K1;
    then consider p2 being Point of TOP-REAL 2 such that
A4: p2=x and
    p2`2<=0 and
A5: p2<>0.TOP-REAL 2 by A1;
    not p2 in {0.TOP-REAL 2} by A5,TARSKI:def 1;
    hence thesis by A1,A4,XBOOLE_0:def 5;
  end;
  for p being Point of (TOP-REAL 2)|K1,V being Subset of (TOP-REAL 2)|D
st f.p in V & V is open holds ex W being Subset of (TOP-REAL 2)|K1 st p in W &
  W is open & f.:W c= V
  proof
    let p be Point of (TOP-REAL 2)|K1,V be Subset of (TOP-REAL 2)|D;
    assume that
A6: f.p in V and
A7: V is open;
    consider V2 being Subset of TOP-REAL 2 such that
A8: V2 is open and
A9: V2 /\ [#]((TOP-REAL 2)|D)=V by A7,TOPS_2:32;
    reconsider W2=V2 /\ [#]((TOP-REAL 2)|K1) as Subset of (TOP-REAL 2)| K1;
A10: [#]((TOP-REAL 2)|K1)=K1 by PRE_TOPC:def 10;
    then
A11: f.p=(cn-FanMorphN).p by A1,FUNCT_1:72;
A12: f.:W2 c= V
    proof
      let y be set;
      assume
      y in f.:W2;
      then consider x being set such that
A13:  x in dom f and
A14:  x in W2 and
A15:  y=f.x by FUNCT_1:def 12;
      f is Function of (TOP-REAL 2)|K1, (TOP-REAL 2)|D;
      then dom f= K1 by A10,FUNCT_2:def 1;
      then consider p4 being Point of TOP-REAL 2 such that
A16:  x=p4 and
A17:  p4`2<=0 and
      p4<>0.TOP-REAL 2 by A1,A13;
A18:  p4 in V2 by A14,A16,XBOOLE_0:def 4;
      p4 in [#]((TOP-REAL 2)|K1) by A13,A16;
      then p4 in D by A3,A10;
      then
A19:  p4 in [#]((TOP-REAL 2)|D) by PRE_TOPC:def 10;
      f.p4=(cn-FanMorphN).p4 by A1,A10,A13,A16,FUNCT_1:72
        .=p4 by A17,Th56;
      hence thesis by A9,A15,A16,A18,A19,XBOOLE_0:def 4;
    end;
    p in the carrier of (TOP-REAL 2)|K1;
    then consider q being Point of TOP-REAL 2 such that
A20: q=p and
A21: q`2<=0 and
    q <>0.TOP-REAL 2 by A1,A10;
    (cn-FanMorphN).q=q by A21,Th56;
    then p in V2 by A6,A9,A11,A20,XBOOLE_0:def 4;
    then
A22: p in W2 by XBOOLE_0:def 4;
    W2 is open by A8,TOPS_2:32;
    hence thesis by A22,A12;
  end;
  hence thesis by JGRAPH_2:20;
end;

theorem Th69:
  for B0 being Subset of TOP-REAL 2, K0 being Subset of (TOP-REAL
  2)|B0 st B0=NonZero TOP-REAL 2 & K0={p: p`2>=0 & p<>0.TOP-REAL 2} holds K0 is
  closed
proof
  set J0 = NonZero TOP-REAL 2;
  defpred P[Point of TOP-REAL 2] means $1`2>=0;
  set I1 = {p: P[p] & p<>0.TOP-REAL 2};
  let B0 be Subset of TOP-REAL 2,K0 be Subset of (TOP-REAL 2)|B0;
  reconsider K1={p7 where p7 is Point of TOP-REAL 2:P[p7]} as Subset of
  TOP-REAL 2 from JGRAPH_2:sch 1;
A1: I1 = {p7 where p7 is Point of TOP-REAL 2 : P[p7]} /\ J0 from JGRAPH_3:
  sch 2;
  assume
  B0=J0 & K0=I1;
  then K1 is closed & K0=K1 /\ [#]((TOP-REAL 2)|B0) by A1,JORDAN6:8 ,
  PRE_TOPC:def 10;
  hence thesis by PRE_TOPC:43;
end;

theorem Th70:
  for B0 being Subset of TOP-REAL 2, K0 being Subset of (TOP-REAL
  2)|B0 st B0=NonZero TOP-REAL 2 & K0={p: p`2<=0 & p<>0.TOP-REAL 2} holds K0 is
  closed
proof
  set J0 = NonZero TOP-REAL 2;
  defpred P[Point of TOP-REAL 2] means $1`2<=0;
  set I1 = {p: P[p] & p<>0.TOP-REAL 2};
  let B0 be Subset of TOP-REAL 2,K0 be Subset of (TOP-REAL 2)|B0;
  reconsider K1={p7 where p7 is Point of TOP-REAL 2:P[p7]} as Subset of
  TOP-REAL 2 from JGRAPH_2:sch 1;
A1: I1 = {p7 where p7 is Point of TOP-REAL 2 : P[p7]} /\ J0 from JGRAPH_3:
  sch 2;
  assume
  B0=J0 & K0=I1;
  then K1 is closed & K0=K1 /\ [#]((TOP-REAL 2)|B0) by A1,JORDAN6:9 ,
  PRE_TOPC:def 10;
  hence thesis by PRE_TOPC:43;
end;

theorem Th71:
  for cn being Real, B0 being Subset of TOP-REAL 2,K0 being Subset
  of (TOP-REAL 2)|B0,f being Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0)
st -1<cn & cn<1 & f=(cn-FanMorphN)|K0 & B0=NonZero TOP-REAL 2 & K0={p: p`2>=0 &
  p<>0.TOP-REAL 2} holds f is continuous
proof
  let cn be Real, B0 be Subset of TOP-REAL 2,K0 be Subset of (TOP-REAL 2)|B0,f
  be Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0);
  the carrier of (TOP-REAL 2)|B0= B0 by PRE_TOPC:29;
  then reconsider K1=K0 as Subset of TOP-REAL 2 by XBOOLE_1:1;
  assume
A1: -1<cn & cn<1 & f=(cn-FanMorphN)|K0 & B0=NonZero TOP-REAL 2 & K0={p:
  p`2>=0 & p<>0.TOP-REAL 2 };
  K0 c= B0
  proof
    let x be set;
    assume
    x in K0;
    then
A2: ex p8 being Point of TOP-REAL 2 st x=p8 & p8`2>=0 & p8 <>0.TOP-REAL 2
    by A1;
    then not x in {0.TOP-REAL 2} by TARSKI:def 1;
    hence thesis by A1,A2,XBOOLE_0:def 5;
  end;
  then ((TOP-REAL 2)|B0)|K0=(TOP-REAL 2)|K1 by PRE_TOPC:28;
  hence thesis by A1,Th67;
end;

theorem Th72:
  for cn being Real, B0 being Subset of TOP-REAL 2,K0 being Subset
  of (TOP-REAL 2)|B0,f being Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0)
st -1<cn & cn<1 & f=(cn-FanMorphN)|K0 & B0=NonZero TOP-REAL 2 & K0={p: p`2<=0 &
  p<>0.TOP-REAL 2} holds f is continuous
proof
  let cn be Real, B0 be Subset of TOP-REAL 2, K0 be Subset of (TOP-REAL 2)|B0,
  f be Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0);
  the carrier of (TOP-REAL 2)|B0= B0 by PRE_TOPC:29;
  then reconsider K1=K0 as Subset of TOP-REAL 2 by XBOOLE_1:1;
  assume
A1: -1<cn & cn<1 & f=(cn-FanMorphN)|K0 & B0=NonZero TOP-REAL 2 & K0={p:
  p`2<=0 & p<>0.TOP-REAL 2};
  K0 c= B0
  proof
    let x be set;
    assume
    x in K0;
    then
A2: ex p8 being Point of TOP-REAL 2 st x=p8 & p8`2<=0 & p8 <>0.TOP-REAL 2
    by A1;
    then not x in {0.TOP-REAL 2} by TARSKI:def 1;
    hence thesis by A1,A2,XBOOLE_0:def 5;
  end;
  then ((TOP-REAL 2)|B0)|K0=(TOP-REAL 2)|K1 by PRE_TOPC:28;
  hence thesis by A1,Th68;
end;

theorem Th73:
  for cn being Real,p being Point of TOP-REAL 2 holds |.(cn
  -FanMorphN).p.|=|.p.|
proof
  let cn be Real,p be Point of TOP-REAL 2;
  set f=cn-FanMorphN;
  set z=f.p;
  reconsider q=p as Point of TOP-REAL 2;
  reconsider qz=z as Point of TOP-REAL 2;
  per cases;
  suppose
A1: q`1/|.q.|>=cn & q`2>0;
    then
A2: (cn-FanMorphN).q= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)), |.q.|*( sqrt(1-((
    q`1/|.q.|-cn)/(1-cn))^2))]| by Th56;
    then
A3: qz`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)) by EUCLID:56;
A4: qz`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by A2,EUCLID:56;
A5: (q`1/|.q.|-cn)>=0 by A1,XREAL_1:50;
A6: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
    |.q.|<>0 by A1,JGRAPH_2:11,TOPRNS_1:25;
    then
A7: (|.q.|)^2>0 by SQUARE_1:74;
    0<=(q`2)^2 by XREAL_1:65;
    then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
    then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A6,XREAL_1:74;
    then (q`1)^2/(|.q.|)^2 <= 1 by A7,XCMPLX_1:60;
    then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
    then 1>=q`1/|.q.| by SQUARE_1:121;
    then
A8: 1-cn>=q`1/|.q.|-cn by XREAL_1:11;
    per cases;
    suppose
A9:   1-cn=0;
A10:  ((q`1/|.q.|-cn)/(1-cn))=(q`1/|.q.|-cn)*(1-cn)" by XCMPLX_0:def 9
        .= (q`1/|.q.|-cn)*0 by A9
        .=0;
      then 1-((q`1/|.q.|-cn)/(1-cn))^2=1;
      then (cn-FanMorphN).q= |[ |.q.|*0,|.q.|*1]| by A1,A10,
      Th56, SQUARE_1
      :83
        .=|[0,(|.q.|)]|;
      then ((cn-FanMorphN).q)`2=(|.q.|) & ((cn-FanMorphN).q)`1=0 by
      EUCLID
      :56;
      then |.(cn-FanMorphN).p.|=sqrt(((|.q.|))^2+0^2) by JGRAPH_3:10
        .=|.q.| by SQUARE_1:89;
      hence thesis;
    end;
    suppose
A11:  1-cn<>0;
      per cases by A11;
      suppose
A12:    1-cn>0;
        -(1-cn)<= -( q`1/|.q.|-cn) by A8,XREAL_1:26;
        then (-(1-cn))/(1-cn)<=(-( q`1/|.q.|-cn))/(1-cn) by A12,
        XREAL_1:74;
        then -1<=(-( q`1/|.q.|-cn))/(1-cn) by A12,XCMPLX_1:198;
        then ((-(q`1/|.q.|-cn))/(1-cn))^2<=1^2 by A5,A12,SQUARE_1:119;
        then 1-((-(q`1/|.q.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
        then
A13:    1-(-((q`1/|.q.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
A14:    (qz`2)^2= (|.q.|)^2*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))^2 by A3
          .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1-cn))^2) by A13,SQUARE_1:def 4;
        (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
          .=(|.q.|)^2 by A4,A14;
        then sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
        hence thesis by SQUARE_1:89;
      end;
      suppose
A15:    1-cn<0;
        0+(q`1)^2<(q`1)^2+(q`2)^2 by A1,SQUARE_1:74,XREAL_1:10;
        then (q`1)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A7,A6,XREAL_1:76;
        then (q`1)^2/(|.q.|)^2 < 1 by A7,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 < 1 by XCMPLX_1:77;
        then
A16:    1 > q`1/|.p.| by SQUARE_1:122;
        q`1/|.q.|-cn>=0 by A1,XREAL_1:50;
        hence thesis by A15,A16,XREAL_1:11;
      end;
    end;
  end;
  suppose
A17: q`1/|.q.|<cn & q`2>0;
    then |.q.|<>0 by JGRAPH_2:11,TOPRNS_1:25;
    then
A18: (|.q.|)^2>0 by SQUARE_1:74;
A19: (q`1/|.q.|-cn)<0 by A17,XREAL_1:51;
A20: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
    0<=(q`2)^2 by XREAL_1:65;
    then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
    then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A20,XREAL_1:74;
    then (q`1)^2/(|.q.|)^2 <= 1 by A18,XCMPLX_1:60;
    then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
    then -1<=q`1/|.q.| by SQUARE_1:121;
    then
A21: -1-cn<=q`1/|.q.|-cn by XREAL_1:11;
A22: (cn-FanMorphN).q= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)), |.q.|*( sqrt(1-(
    (q`1/|.q.|-cn)/(1+cn))^2))]| by A17,Th57;
    then
A23: qz`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)) by EUCLID:56;
A24: qz`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by A22,EUCLID:56;
    per cases;
    suppose
A25:  1+cn=0;
      ((q`1/|.q.|-cn)/(1+cn))=(q`1/|.q.|-cn)*(1+cn)" by XCMPLX_0:def 9
        .= (q`1/|.q.|-cn)*0 by A25
        .=0;
      then ((cn-FanMorphN).q)`2=(|.q.|) & ((cn-FanMorphN).q)`1=0 by A22,
      EUCLID:56 ,SQUARE_1:83;
      then |.(cn-FanMorphN).p.|=sqrt(((|.q.|))^2+0^2) by JGRAPH_3:10
        .=|.q.| by SQUARE_1:89;
      hence thesis;
    end;
    suppose
A26:  1+cn<>0;
      per cases by A26;
      suppose
A27:    1+cn>0;
        then (-(1+cn))/(1+cn)<=(( q`1/|.q.|-cn))/(1+cn) by A21,
        XREAL_1:74;
        then -1<=(( q`1/|.q.|-cn))/(1+cn) by A27,XCMPLX_1:198;
        then ( (q`1/|.q.|-cn) /(1+cn))^2<=1^2 by A19,A27,SQUARE_1:119;
        then
A28:    1-(((q`1/|.q.|-cn))/(1+cn))^2>=0 by XREAL_1:50;
A29:    (qz`2)^2= (|.q.|)^2*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))^2 by A23
          .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1+cn))^2) by A28,SQUARE_1:def 4;
        (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
          .=(|.q.|)^2 by A24,A29;
        then sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
        hence thesis by SQUARE_1:89;
      end;
      suppose
A30:    1+cn<0;
        0+(q`1)^2<(q`1)^2+(q`2)^2 by A17,SQUARE_1:74,XREAL_1:10;
        then (q`1)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A18,A20,
        XREAL_1:76;
        then (q`1)^2/(|.q.|)^2 < 1 by A18,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 < 1 by XCMPLX_1:77;
        then -1 < q`1/|.p.| by SQUARE_1:122;
        then
A31:    q`1/|.q.|-cn>-1-cn by XREAL_1:11;
        -(1+cn)>-0 by A30,XREAL_1:26;
        hence thesis by A17,A31,XREAL_1:51;
      end;
    end;
  end;
  suppose
    q`2<=0;
    hence thesis by Th56;
  end;
end;

theorem Th74:
  for cn being Real,x,K0 being set st -1<cn & cn<1 & x in K0 & K0=
  {p: p`2>=0 & p<>0.TOP-REAL 2} holds (cn-FanMorphN).x in K0
proof
  let cn be Real,x,K0 be set;
  assume
A1: -1<cn & cn<1 & x in K0 & K0={p: p`2>=0 & p<>0.TOP-REAL 2};
  then consider p such that
A2: p=x and
A3: p`2>=0 and
A4: p<>0.TOP-REAL 2;
A5: now
    assume
    |.p.|<=0;
    then |.p.|=0;
    hence contradiction by A4,TOPRNS_1:25;
  end;
  then
A6: (|.p.|)^2>0 by SQUARE_1:74;
  per cases;
  suppose
A7: p`1/|.p.|<=cn;
    reconsider p9= (cn-FanMorphN).p as Point of TOP-REAL 2;
    (cn-FanMorphN).p= |[ |.p.|*((p`1/|.p.|-cn)/(1+cn)), |.p.|*( sqrt(1-((
    p`1/|.p.|-cn)/(1+cn))^2))]| by A1,A3,A4,A7,Th58;
    then
A8: p9`2=|.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)) by EUCLID:56;
A9: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
A10: 1+cn>0 by A1,XREAL_1:150;
    per cases;
    suppose
      p`2=0;
      hence thesis by A1,A2,Th56;
    end;
    suppose
      p`2<>0;
      then 0+(p`1)^2<(p`1)^2+(p`2)^2 by SQUARE_1:74,XREAL_1:10;
      then (p`1)^2/(|.p.|)^2 < (|.p.|)^2/(|.p.|)^2 by A6,A9,XREAL_1:76;
      then (p`1)^2/(|.p.|)^2 < 1 by A6,XCMPLX_1:60;
      then ((p`1)/|.p.|)^2 < 1 by XCMPLX_1:77;
      then -1 < p`1/|.p.| by SQUARE_1:122;
      then -1-cn< p`1/|.p.|-cn by XREAL_1:11;
      then (-1)*(1+cn)/(1+cn)< (p`1/|.p.|-cn)/(1+cn) by A10,XREAL_1:76;
      then
A11:  -1< (p`1/|.p.|-cn)/(1+cn) by A10,XCMPLX_1:90;
      p`1/|.p.|-cn<=0 by A7,XREAL_1:49;
      then 1^2> ((p`1/|.p.|-cn)/(1+cn))^2 by A10,A11,SQUARE_1:120;
      then 1-((p`1/|.p.|-cn)/(1+cn))^2>0 by XREAL_1:52;
      then sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)>0 by SQUARE_1:93;
      then |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))>0 by A5,
      XREAL_1:131;
      hence thesis by A1,A2,A8,JGRAPH_2:11;
    end;
  end;
  suppose
A12: p`1/|.p.|>cn;
    reconsider p9= (cn-FanMorphN).p as Point of TOP-REAL 2;
    (cn-FanMorphN).p= |[ |.p.|*((p`1/|.p.|-cn)/(1-cn)), |.p.|*( sqrt(1-((
    p`1/|.p.|-cn)/(1-cn))^2))]| by A1,A3,A4,A12,Th58;
    then
A13: p9`2=|.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)) by EUCLID:56;
A14: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
A15: 1-cn>0 by A1,XREAL_1:151;
    per cases;
    suppose
      p`2=0;
      hence thesis by A1,A2,Th56;
    end;
    suppose
      p`2<>0;
      then 0+(p`1)^2<(p`1)^2+(p`2)^2 by SQUARE_1:74,XREAL_1:10;
      then (p`1)^2/(|.p.|)^2 < (|.p.|)^2/(|.p.|)^2 by A6,A14,XREAL_1:76;
      then (p`1)^2/(|.p.|)^2 < 1 by A6,XCMPLX_1:60;
      then ((p`1)/|.p.|)^2 < 1 by XCMPLX_1:77;
      then p`1/|.p.|<1 by SQUARE_1:122;
      then (p`1/|.p.|-cn)<1-cn by XREAL_1:11;
      then (p`1/|.p.|-cn)/(1-cn)<(1-cn)/(1-cn) by A15,XREAL_1:76;
      then
A16:  (p`1/|.p.|-cn)/(1-cn)<1 by A15,XCMPLX_1:60;
      -(1-cn)< -0 & p`1/|.p.|-cn>=cn-cn by A12,A15,XREAL_1:11,26;
      then (-1)*(1-cn)/(1-cn)< (p`1/|.p.|-cn)/(1-cn) by A15,XREAL_1:76;
      then -1< (p`1/|.p.|-cn)/(1-cn) by A15,XCMPLX_1:90;
      then 1^2> ((p`1/|.p.|-cn)/(1-cn))^2 by A16,SQUARE_1:120;
      then 1-((p`1/|.p.|-cn)/(1-cn))^2>0 by XREAL_1:52;
      then sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)>0 by SQUARE_1:93;
      then p9`2>0 by A5,A13,XREAL_1:131;
      hence thesis by A1,A2,JGRAPH_2:11;
    end;
  end;
end;

theorem Th75:
  for cn being Real,x,K0 being set st -1<cn & cn<1 & x in K0 & K0=
  {p: p`2<=0 & p<>0.TOP-REAL 2} holds (cn-FanMorphN).x in K0
proof
  let cn be Real,x,K0 be set;
  assume
A1: -1<cn & cn<1 & x in K0 & K0={p: p`2<=0 & p<>0.TOP-REAL 2};
  then ex p st p=x & p`2<=0 & p<>0.TOP-REAL 2;
  hence thesis by A1,Th56;
end;

theorem Th76:
  for cn being Real, D being non empty Subset of TOP-REAL 2 st -1<
  cn & cn<1 & D`={0.TOP-REAL 2} holds ex h being Function of (TOP-REAL 2)|D,(
  TOP-REAL 2)|D st h=(cn-FanMorphN)|D & h is continuous
proof
  (|[0,1]|)`2=1 by EUCLID:56;
  then
A1: |[0,1]| in {p where p is Point of TOP-REAL 2: p`2>=0 & p<>0.TOP-REAL 2}
  by JGRAPH_2:11;
  set Y1=|[0,-1]|;
  reconsider B0= {0.TOP-REAL 2} as Subset of TOP-REAL 2;
  defpred P[Point of TOP-REAL 2] means $1`2>=0;
  let cn be Real,D be non empty Subset of TOP-REAL 2;
  assume that
A2: -1<cn & cn<1 and
A3: D`={0.TOP-REAL 2};
A4: the carrier of ((TOP-REAL 2)|D)=D by PRE_TOPC:29;
A5: D =(B0)` by A3
    .=(NonZero TOP-REAL 2) by SUBSET_1:def 5;
  {p: P[p] & p<>0.TOP-REAL 2} c= the carrier of (TOP-REAL 2)|D from
  InclSub(A5);
  then reconsider
  K0={p:p`2>=0 & p<>0.TOP-REAL 2} as non empty Subset of (TOP-REAL
  2)|D by A1;
A6: K0=the carrier of ((TOP-REAL 2)|D)|K0 by PRE_TOPC:29;
A7: the carrier of ((TOP-REAL 2)|D)=D by PRE_TOPC:29;
A8: rng ((cn-FanMorphN)|K0) c= the carrier of ((TOP-REAL 2)|D)|K0
  proof
    let y be set;
    assume
    y in rng ((cn-FanMorphN)|K0);
    then consider x being set such that
A9: x in dom ((cn-FanMorphN)|K0) and
A10: y=((cn-FanMorphN)|K0).x by FUNCT_1:def 5;
    x in (dom (cn-FanMorphN)) /\ K0 by A9,RELAT_1:90;
    then
A11: x in K0 by XBOOLE_0:def 4;
    K0 c= the carrier of TOP-REAL 2 by A7,XBOOLE_1:1;
    then reconsider p=x as Point of TOP-REAL 2 by A11;
    (cn-FanMorphN).p=y by A10,A11,FUNCT_1:72;
    then y in K0 by A2,A11,Th74;
    hence thesis by PRE_TOPC:29;
  end;
A12: K0 c= (the carrier of TOP-REAL 2)
  proof
    let z be set;
    assume
    z in K0;
    then ex p8 being Point of TOP-REAL 2 st p8=z & p8`2>=0 & p8 <>0.TOP-REAL 2;
    hence thesis;
  end;
  Y1`2=-1 & 0.TOP-REAL 2 <> Y1 by EUCLID:56,JGRAPH_2:11;
  then
A13: Y1 in {p where p is Point of TOP-REAL 2: p`2<=0 & p<>0.TOP-REAL 2};
A14: the carrier of ((TOP-REAL 2)|D) = (NonZero TOP-REAL 2) by A5,PRE_TOPC:
  29;
  defpred P[Point of TOP-REAL 2] means $1`2<=0;
  {p: P[p] & p<>0.TOP-REAL 2} c= the carrier of (TOP-REAL 2)|D from
  InclSub(A5);
  then reconsider
  K1={p: p`2<=0 & p<>0.TOP-REAL 2} as non empty Subset of (TOP-REAL
  2)|D by A13;
A15: K0 is closed & K1 is closed by A5,Th69,Th70;
  dom ((cn-FanMorphN)|K0)= dom ((cn-FanMorphN)) /\ K0 by RELAT_1:90
    .=((the carrier of TOP-REAL 2)) /\ K0 by FUNCT_2:def 1
    .=K0 by A12,XBOOLE_1:28;
  then reconsider f=(cn-FanMorphN)|K0 as Function of ((TOP-REAL 2)|D)|K0, ((
  TOP-REAL 2)|D) by A6,A8,FUNCT_2:4,XBOOLE_1:1;
A16: K1=the carrier of ((TOP-REAL 2)|D)|K1 by PRE_TOPC:29;
A17: rng ((cn-FanMorphN)|K1) c= the carrier of ((TOP-REAL 2)|D)|K1
  proof
    let y be set;
    assume
    y in rng ((cn-FanMorphN)|K1);
    then consider x being set such that
A18: x in dom ((cn-FanMorphN)|K1) and
A19: y=((cn-FanMorphN)|K1).x by FUNCT_1:def 5;
    x in (dom (cn-FanMorphN)) /\ K1 by A18,RELAT_1:90;
    then
A20: x in K1 by XBOOLE_0:def 4;
    K1 c= the carrier of TOP-REAL 2 by A7,XBOOLE_1:1;
    then reconsider p=x as Point of TOP-REAL 2 by A20;
    (cn-FanMorphN).p=y by A19,A20,FUNCT_1:72;
    then y in K1 by A2,A20,Th75;
    hence thesis by PRE_TOPC:29;
  end;
A21: K1 c= (the carrier of TOP-REAL 2)
  proof
    let z be set;
    assume
    z in K1;
    then ex p8 being Point of TOP-REAL 2 st p8=z & p8`2<=0 & p8 <>0.TOP-REAL 2;
    hence thesis;
  end;
  dom ((cn-FanMorphN)|K1)= dom ((cn-FanMorphN)) /\ K1 by RELAT_1:90
    .=((the carrier of TOP-REAL 2)) /\ K1 by FUNCT_2:def 1
    .=K1 by A21,XBOOLE_1:28;
  then reconsider g=(cn-FanMorphN)|K1 as Function of ((TOP-REAL 2)|D)|K1, ((
  TOP-REAL 2)|D) by A16,A17,FUNCT_2:4,XBOOLE_1:1;
A22: K1=[#](((TOP-REAL 2)|D)|K1) by PRE_TOPC:def 10;
A23: D c= K0 \/ K1
  proof
    let x be set;
    assume
A24: x in D;
    then reconsider px=x as Point of TOP-REAL 2;
    not x in {0.TOP-REAL 2} by A5,A24,XBOOLE_0:def 5;
    then px`2>=0 & px<>0.TOP-REAL 2 or px`2<=0 & px<>0.TOP-REAL 2 by
    TARSKI:def 1;
    then x in K0 or x in K1;
    hence thesis by XBOOLE_0:def 3;
  end;
A25: dom f=K0 by A6,FUNCT_2:def 1;
A26: K0=[#](((TOP-REAL 2)|D)|K0) by PRE_TOPC:def 10;
A27: for x be set st x in ([#]((((TOP-REAL 2)|D)|K0))) /\ ([#] ((((TOP-REAL
  2)|D)|K1))) holds f.x = g.x
  proof
    let x be set;
    assume
A28: x in ([#]((((TOP-REAL 2)|D)|K0))) /\ ([#] ((((TOP-REAL 2)|D)|K1))
    );
    then x in K0 by A26,XBOOLE_0:def 4;
    then f.x=(cn-FanMorphN).x by FUNCT_1:72;
    hence thesis by A22,A28,FUNCT_1:72;
  end;
  D= [#]((TOP-REAL 2)|D) by PRE_TOPC:def 10;
  then
A29: ([#](((TOP-REAL 2)|D)|K0)) \/ ([#](((TOP-REAL 2)|D)|K1)) = [#]((
  TOP-REAL 2)|D) by A26,A22,A23,XBOOLE_0:def 10;
A30: f is continuous & g is continuous by A2,A5,Th71,Th72;
  then consider h being Function of (TOP-REAL 2)|D,(TOP-REAL 2)|D such that
A31: h= f+*g and
  h is continuous by A26,A22,A29,A15,A27,JGRAPH_2:9;
A32: dom h=the carrier of ((TOP-REAL 2)|D) by FUNCT_2:def 1;
A33: dom g=K1 by A16,FUNCT_2:def 1;
  K0=[#](((TOP-REAL 2)|D)|K0) & K1=[#](((TOP-REAL 2)|D)|K1) by PRE_TOPC:
  def 10;
  then
A34: f tolerates g by A27,A25,A33,PARTFUN1:def 6;
A35: for x being set st x in dom h holds h.x=((cn-FanMorphN)|D).x
  proof
    let x be set;
    assume
A36: x in dom h;
    then reconsider p=x as Point of TOP-REAL 2 by A14,XBOOLE_0:def 5;
    not x in {0.TOP-REAL 2} by A14,A36,XBOOLE_0:def 5;
    then
A37: x <>0.TOP-REAL 2 by TARSKI:def 1;
A38: x in D`` by A32,A36,PRE_TOPC:29;
    now
      per cases;
      case
A39:    x in K0;
A40:    (cn-FanMorphN)|D.p=(cn-FanMorphN).p by A38,FUNCT_1:72
          .=f.p by A39,FUNCT_1:72;
        h.p=(g+*f).p by A31,A34,FUNCT_4:35
          .=f.p by A25,A39,FUNCT_4:14;
        hence thesis by A40;
      end;
      case
        not x in K0;
        then not p`2>=0 by A37;
        then
A41:    x in K1 by A37;
        (cn-FanMorphN)|D.p=(cn-FanMorphN).p by A38,FUNCT_1:72
          .=g.p by A41,FUNCT_1:72;
        hence thesis by A31,A33,A41,FUNCT_4:14;
      end;
    end;
    hence thesis;
  end;
  dom (cn-FanMorphN)=(the carrier of (TOP-REAL 2)) by FUNCT_2:def 1;
  then dom ((cn-FanMorphN)|D)=(the carrier of (TOP-REAL 2))/\ D by
  RELAT_1:90
    .=the carrier of ((TOP-REAL 2)|D) by A4,XBOOLE_1:28;
  then f+*g=(cn-FanMorphN)|D by A31,A32,A35,FUNCT_1:9;
  hence thesis by A26,A22,A29,A30,A15,A27,JGRAPH_2:9;
end;

theorem Th77:
  for cn being Real st -1<cn & cn<1 holds ex h being Function of (
  TOP-REAL 2),(TOP-REAL 2) st h=(cn-FanMorphN) & h is continuous
proof
  reconsider D=NonZero TOP-REAL 2 as non empty Subset of TOP-REAL 2 by
  JGRAPH_2:19;
  let cn be Real;
  assume that
A1: -1<cn and
A2: cn<1;
  reconsider f=(cn-FanMorphN) as Function of (TOP-REAL 2),(TOP-REAL 2);
A3: f.(0.TOP-REAL 2)=0.TOP-REAL 2 by Th56,JGRAPH_2:11;
A4: for p being Point of (TOP-REAL 2)|D holds f.p<>f.(0.TOP-REAL 2)
  proof
    let p be Point of (TOP-REAL 2)|D;
A5: [#]((TOP-REAL 2)|D)=D by PRE_TOPC:def 10;
    then reconsider q=p as Point of TOP-REAL 2 by XBOOLE_0:def 5;
    not p in {0.TOP-REAL 2} by A5,XBOOLE_0:def 5;
    then
A6: not p=0.TOP-REAL 2 by TARSKI:def 1;
    now
      per cases;
      case
A7:     q`1/|.q.|>=cn & q`2>=0;
        set q9= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)), |.q.|*( sqrt(1-((q`1/|.q.|-
        cn)/(1-cn))^2))]|;
A8:     q9`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by EUCLID:56;
        now
          assume
A9:       q9=0.TOP-REAL 2;
A10:      |.q.|<>0^2 by A6,TOPRNS_1:25;
          then sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)= sqrt(1-0) by A8,A9,
          JGRAPH_2:11,XCMPLX_1:6
            .=1 by SQUARE_1:83;
          hence contradiction by A9,A10,EUCLID:56,JGRAPH_2:11;
        end;
        hence thesis by A1,A2,A3,A6,A7,Th58;
      end;
      case
A11:    q`1/|.q.|<cn & q`2>=0;
        set q9=|[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)), |.q.|*( sqrt(1-((q`1/|.q.|-
        cn)/(1+cn))^2))]|;
A12:    q9`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by EUCLID:56;
        now
          assume
A13:      q9=0.TOP-REAL 2;
A14:      |.q.|<>0^2 by A6,TOPRNS_1:25;
          then sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)= sqrt(1-0) by A12,A13,
          JGRAPH_2:11,XCMPLX_1:6
            .=1 by SQUARE_1:83;
          hence contradiction by A13,A14,EUCLID:56,JGRAPH_2:11;
        end;
        hence thesis by A1,A2,A3,A6,A11,Th58;
      end;
      case
        q`2<0;
        then f.p=p by Th56;
        hence thesis by A6,Th56,JGRAPH_2:11;
      end;
    end;
    hence thesis;
  end;
A15: for V being Subset of (TOP-REAL 2) st f.(0.TOP-REAL 2) in V & V is open
ex W being Subset of (TOP-REAL 2) st 0.TOP-REAL 2 in W & W is open & f.:W c= V
  proof
    reconsider u0=0.TOP-REAL 2 as Point of Euclid 2 by EUCLID:71;
    let V be Subset of (TOP-REAL 2);
    reconsider VV = V as Subset of TopSpaceMetr Euclid 2 by Lm11;
    assume that
A16: f.(0.TOP-REAL 2) in V and
A17: V is open;
    VV is open by A17,Lm11,PRE_TOPC:60;
    then consider r being real number such that
A18: r>0 and
A19: Ball(u0,r) c= V by A3,A16,TOPMETR:22;
    reconsider r as Real by XREAL_0:def 1;
    the TopStruct of TOP-REAL 2 = TopSpaceMetr Euclid 2 by EUCLID:def 8;
    then reconsider W1=Ball(u0,r) as Subset of TOP-REAL 2;
A20: W1 is open by GOBOARD6:6;
A21: f.:W1 c= W1
    proof
      let z be set;
      assume
      z in f.:W1;
      then consider y being set such that
A22:  y in dom f and
A23:  y in W1 and
A24:  z=f.y by FUNCT_1:def 12;
      z in rng f by A22,A24,FUNCT_1:def 5;
      then reconsider qz=z as Point of TOP-REAL 2;
      reconsider q=y as Point of TOP-REAL 2 by A22;
      reconsider qy=q as Point of Euclid 2 by EUCLID:71;
      reconsider pz=qz as Point of Euclid 2 by EUCLID:71;
      dist(u0,qy)<r by A23,METRIC_1:12;
      then
A25:  |.(0.TOP-REAL 2) - q.|<r by JGRAPH_1:45;
      now
        per cases by JGRAPH_2:11;
        case
          q`2<=0;
          hence thesis by A23,A24,Th56;
        end;
        case
A26:      q<>0.TOP-REAL 2 & q`1/|.q.|>=cn & q`2>=0;
          then
A27:      (q`1/|.q.|-cn)>= 0 by XREAL_1:50;
          0<=(q`2)^2 by XREAL_1:65;
          then (|.q.|)^2 =(q`1)^2+(q`2)^2 & 0+(q`1)^2<=(q`1)^2+(q`2)^2 by
          JGRAPH_3:10 ,XREAL_1:9;
          then
A28:      (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by XREAL_1:74;
A29:      1-cn>0 by A2,XREAL_1:151;
          |.q.|<>0 by A26,TOPRNS_1:25;
          then (|.q.|)^2>0 by SQUARE_1:74;
          then (q`1)^2/(|.q.|)^2 <= 1 by A28,XCMPLX_1:60;
          then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
          then 1>=q`1/|.q.| by SQUARE_1:121;
          then 1-cn>=q`1/|.q.|-cn by XREAL_1:11;
          then -(1-cn)<= -( q`1/|.q.|-cn) by XREAL_1:26;
          then (-(1-cn))/(1-cn)<=(-( q`1/|.q.|-cn))/(1-cn) by A29,
          XREAL_1:
          74;
          then -1<=(-( q`1/|.q.|-cn))/(1-cn) by A29,XCMPLX_1:198;
          then ((-(q`1/|.q.|-cn))/(1-cn))^2<=1^2 by A29,A27,SQUARE_1:119;
          then 1-((-(q`1/|.q.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
          then
A30:      1-(-((q`1/|.q.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
A31:      (cn-FanMorphN).q= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)) , |.q.|*(
          sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by A1,A2,A26,Th58;
          then
A32:      qz`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by A24,EUCLID:56;
          qz`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)) by A24,A31,
          EUCLID:56;
          then
A33:      (qz`2)^2= (|.q.|)^2*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))^2
            .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1-cn))^2) by A30,SQUARE_1:def 4;
          (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
            .=(|.q.|)^2 by A32,A33;
          then sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
          then
A34:      |.qz.|=|.q.| by SQUARE_1:89;
          |.- q.|<r by A25,EUCLID:31;
          then |.q.|<r by TOPRNS_1:27;
          then |.- qz.|<r by A34,TOPRNS_1:27;
          then |.(0.TOP-REAL 2) - qz.|<r by EUCLID:31;
          then dist(u0,pz)<r by JGRAPH_1:45;
          hence thesis by METRIC_1:12;
        end;
        case
A35:      q<>0.TOP-REAL 2 & q`1/|.q.|<cn & q`2>=0;
          0<=(q`2)^2 by XREAL_1:65;
          then (|.q.|)^2 =(q`1)^2+(q`2)^2 & 0+(q`1)^2<=(q`1)^2+(q`2)^2 by
          JGRAPH_3:10 ,XREAL_1:9;
          then
A36:      (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by XREAL_1:74;
A37:      1+cn>0 by A1,XREAL_1:150;
          |.q.|<>0 by A35,TOPRNS_1:25;
          then (|.q.|)^2>0 by SQUARE_1:74;
          then (q`1)^2/(|.q.|)^2 <= 1 by A36,XCMPLX_1:60;
          then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
          then -1<=q`1/|.q.| by SQUARE_1:121;
          then --1>=-q`1/|.q.| by XREAL_1:26;
          then 1+cn>=-q`1/|.q.|+cn by XREAL_1:9;
          then
A38:      (-(q`1/|.q.|-cn))/(1+cn)<=1 by A37,XREAL_1:187;
          (cn-q`1/|.q.|)>=0 by A35,XREAL_1:50;
          then -1<=(-( q`1/|.q.|-cn))/(1+cn) by A37;
          then ((-(q`1/|.q.|-cn))/(1+cn))^2<=1^2 by A38,SQUARE_1:119;
          then 1-((-(q`1/|.q.|-cn))/(1+cn))^2>=0 by XREAL_1:50;
          then
A39:      1-(-((q`1/|.q.|-cn))/(1+cn))^2>=0 by XCMPLX_1:188;
A40:      (cn-FanMorphN).q= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)), |.q.|*(
          sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]| by A1,A2,A35,Th58;
          then
A41:      qz`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by A24,EUCLID:56;
          qz`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)) by A24,A40,
          EUCLID:56;
          then
A42:      (qz`2)^2= (|.q.|)^2*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))^2
            .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1+cn))^2) by A39,SQUARE_1:def 4;
          (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
            .=(|.q.|)^2 by A41,A42;
          then sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
          then
A43:      |.qz.|=|.q.| by SQUARE_1:89;
          |.- q.|<r by A25,EUCLID:31;
          then |.q.|<r by TOPRNS_1:27;
          then |.- qz.|<r by A43,TOPRNS_1:27;
          then |.(0.TOP-REAL 2) - qz.|<r by EUCLID:31;
          then dist(u0,pz)<r by JGRAPH_1:45;
          hence thesis by METRIC_1:12;
        end;
      end;
      hence thesis;
    end;
    u0 in W1 by A18,GOBOARD6:4;
    hence thesis by A19,A20,A21,XBOOLE_1:1;
  end;
A44: D`= {0.TOP-REAL 2} by JGRAPH_3:30;
  then
  ex h being Function of (TOP-REAL 2)|D,(TOP-REAL 2)|D st h=(cn-FanMorphN
  )|D & h is continuous by A1,A2,Th76;
  hence thesis by A3,A44,A4,A15,JGRAPH_3:13;
end;

theorem Th78:
  for cn being Real st -1<cn & cn<1 holds cn-FanMorphN is
  one-to-one
proof
  let cn be Real;
  assume that
A1: -1<cn and
A2: cn<1;
  for x1,x2 being set st x1 in dom (cn-FanMorphN) & x2 in dom (cn
  -FanMorphN) & (cn-FanMorphN).x1=(cn-FanMorphN).x2 holds x1=x2
  proof
    let x1,x2 be set;
    assume that
A3: x1 in dom (cn-FanMorphN) and
A4: x2 in dom (cn-FanMorphN) and
A5: (cn-FanMorphN).x1=(cn-FanMorphN).x2;
    reconsider p2=x2 as Point of TOP-REAL 2 by A4;
    reconsider p1=x1 as Point of TOP-REAL 2 by A3;
    set q=p1,p=p2;
A6: 1-cn>0 by A2,XREAL_1:151;
    now
      per cases by JGRAPH_2:11;
      case
A7:     q`2<=0;
        then
A8:     (cn-FanMorphN).q=q by Th56;
        now
          per cases by JGRAPH_2:11;
          case
            p`2<=0;
            hence thesis by A5,A8,Th56;
          end;
          case
A9:         p<>0.TOP-REAL 2 & p`1/|.p.|>=cn & p`2>=0;
            set p4= |[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)), |.p.|*( sqrt(1-((p`1/|.
            p.|-cn)/(1-cn))^2))]|;
A10:        (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
            0<=(p`2)^2 by XREAL_1:65;
            then 0+(p`1)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
            then
A11:        (p`1)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by A10,XREAL_1:
            74;
A12:        |.p.|>0 by A9,Lm1;
            then (|.p.|)^2>0 by SQUARE_1:74;
            then (p`1)^2/(|.p.|)^2 <= 1 by A11,XCMPLX_1:60;
            then ((p`1)/|.p.|)^2 <= 1 by XCMPLX_1:77;
            then 1>=p`1/|.p.| by SQUARE_1:121;
            then 1-cn>=p`1/|.p.|-cn by XREAL_1:11;
            then -(1-cn)<= -( p`1/|.p.|-cn) by XREAL_1:26;
            then (-(1-cn))/(1-cn)<=(-( p`1/|.p.|-cn))/(1-cn) by A6,
            XREAL_1
            :74;
            then
A13:        -1<=(-( p`1/|.p.|-cn))/(1-cn) by A6,XCMPLX_1:198;
A14:        (p`1/|.p.|-cn)>=0 by A9,XREAL_1:50;
A15:        cn-FanMorphN.p= |[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)), |.p.|*(
            sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]| by A1,A2,A9,Th58;
            (p`1/|.p.|-cn)>= 0 by A9,XREAL_1:50;
            then ((-(p`1/|.p.|-cn))/(1-cn))^2<=1^2 by A6,
            A13,SQUARE_1:119;
            then
A16:        1-((-(p`1/|.p.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
            then sqrt(1-((-(p`1/|.p.|-cn))/(1-cn))^2)>=0 by
            SQUARE_1:def 4;
            then sqrt(1-(-(p`1/|.p.|-cn))^2/(1-cn)^2)>=0 by XCMPLX_1:77;
            then sqrt(1-(p`1/|.p.|-cn)^2/(1-cn)^2)>=0;
            then sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)>=0 by XCMPLX_1:77;
            then p4`2= |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)) & q`2=0 by
            A5,A7,A8,A15,EUCLID:56;
            then
A17:        ( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))=0 by A5,A8,A15,A12,
            XCMPLX_1:6;
            1-(-((p`1/|.p.|-cn))/(1-cn))^2>=0 by A16,XCMPLX_1:188;
            then 1-((p`1/|.p.|-cn)/(1-cn))^2=0 by A17,SQUARE_1:92;
            then 1= (p`1/|.p.|-cn)/(1-cn) by A6,A14,SQUARE_1:83,89;
            then 1 *(1-cn)=(p`1/|.p.|-cn) by A6,XCMPLX_1:88;
            then 1 *|.p.|=p`1 by A12,XCMPLX_1:88;
            then p`2=0 by A10,XCMPLX_1:6;
            hence thesis by A5,A8,Th56;
          end;
          case
A18:        p<>0.TOP-REAL 2 & p`1/|.p.|<cn & p`2>=0;
            then
A19:        |.p.|<>0 by TOPRNS_1:25;
            then
A20:        (|.p.|)^2>0 by SQUARE_1:74;
            set p4= |[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)), |.p.|*( sqrt(1-((p`1/|.
            p.|-cn)/(1+cn))^2))]|;
A21:        (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
A22:        1+cn>0 by A1,XREAL_1:150;
A23:        (p`1/|.p.|-cn)<=0 by A18,XREAL_1:49;
            then
A24:        -1<=(-( p`1/|.p.|-cn))/(1+cn) by A22;
A25:        cn-FanMorphN.p= |[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)), |.p.|*(
            sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]| by A1,A2,A18,Th58;
            0<=(p`2)^2 by XREAL_1:65;
            then 0+(p`1)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
            then (p`1)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by A21,XREAL_1:
            74;
            then (p`1)^2/(|.p.|)^2 <= 1 by A20,XCMPLX_1:60;
            then ((p`1)/|.p.|)^2 <= 1 by XCMPLX_1:77;
            then (-((p`1)/|.p.|))^2 <= 1;
            then 1>= -p`1/|.p.| by SQUARE_1:121;
            then (1+cn)>= -p`1/|.p.|+cn by XREAL_1:9;
            then (-(p`1/|.p.|-cn))/(1+cn)<=1 by A22,XREAL_1:187;
            then ((-(p`1/|.p.|-cn))/(1+cn))^2<=1^2 by A24,SQUARE_1:119;
            then
A26:        1-((-(p`1/|.p.|-cn))/(1+cn))^2>=0 by XREAL_1:50;
            then sqrt(1-((-(p`1/|.p.|-cn))/(1+cn))^2)>=0 by
            SQUARE_1:def 4;
            then sqrt(1-(-(p`1/|.p.|-cn))^2/(1+cn)^2)>=0 by XCMPLX_1:77;
            then sqrt(1-((p`1/|.p.|-cn))^2/(1+cn)^2)>=0;
            then sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)>=0 by XCMPLX_1:77;
            then p4`2= |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)) & q`2=0 by
            A5,A7,A8,A25,EUCLID:56;
            then
A27:        ( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))=0 by A5,A8,A25,A19,
            XCMPLX_1:6;
            1-(-((p`1/|.p.|-cn))/(1+cn))^2>=0 by A26,XCMPLX_1:188;
            then 1-((p`1/|.p.|-cn)/(1+cn))^2=0 by A27,SQUARE_1:92;
            then 1=sqrt((-((p`1/|.p.|-cn)/(1+cn)))^2) by SQUARE_1:83;
            then 1= -((p`1/|.p.|-cn)/(1+cn)) by A22,A23,SQUARE_1:89;
            then 1= ((-(p`1/|.p.|-cn))/(1+cn)) by XCMPLX_1:188;
            then 1 *(1+cn)=-(p`1/|.p.|-cn) by A22,XCMPLX_1:88;
            then 1+cn-cn=-p`1/|.p.|;
            then 1=(-p`1)/|.p.| by XCMPLX_1:188;
            then 1 *|.p.|=-p`1 by A18,TOPRNS_1:25,XCMPLX_1:88;
            then (p`1)^2-(p`1)^2 =(p`2)^2 by A21,XCMPLX_1:26;
            then p`2=0 by XCMPLX_1:6;
            hence thesis by A5,A8,Th56;
          end;
        end;
        hence thesis;
      end;
      case
A28:    q`1/|.q.|>=cn & q`2>=0 & q<>0.TOP-REAL 2;
        then |.q.|<>0 by TOPRNS_1:25;
        then
A29:    (|.q.|)^2>0 by SQUARE_1:74;
        set q4= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)), |.q.|*( sqrt(1-((q`1/|.q.|-
        cn)/(1-cn))^2))]|;
A30:    q4`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by EUCLID:56;
A31:    cn-FanMorphN.q= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)), |.q.|*( sqrt(1
        -((q`1/|.q.|-cn)/(1-cn))^2))]| by A1,A2,A28,Th58;
A32:    q4`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)) by EUCLID:56;
        now
          per cases by JGRAPH_2:11;
          case
A33:        p`2<=0;
            then
A34:        (cn-FanMorphN).p=p by Th56;
A35:        |.q.|<>0 by A28,TOPRNS_1:25;
            then
A36:        (|.q.|)^2>0 by SQUARE_1:74;
A37:        (q`1/|.q.|-cn)>= 0 by A28,XREAL_1:50;
A38:        (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
A39:        (q`1/|.q.|-cn)>=0 by A28,XREAL_1:50;
A40:        1-cn>0 by A2,XREAL_1:151;
            0<=(q`2)^2 by XREAL_1:65;
            then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
            then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A38,XREAL_1:
            74;
            then (q`1)^2/(|.q.|)^2 <= 1 by A36,XCMPLX_1:60;
            then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
            then 1>=q`1/|.q.| by SQUARE_1:121;
            then 1-cn>=q`1/|.q.|-cn by XREAL_1:11;
            then -(1-cn)<= -( q`1/|.q.|-cn) by XREAL_1:26;
            then (-(1-cn))/(1-cn)<=(-( q`1/|.q.|-cn))/(1-cn) by A40,
            XREAL_1:74;
            then -1<=(-( q`1/|.q.|-cn))/(1-cn) by A40,XCMPLX_1:198;
            then ((-(q`1/|.q.|-cn))/(1-cn))^2<=1^2 by A40,A37, SQUARE_1:
            119;
            then
A41:        1-((-(q`1/|.q.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
            then sqrt(1-((-(q`1/|.q.|-cn))/(1-cn))^2)>=0 by SQUARE_1:
            def 4;
            then sqrt(1-(-(q`1/|.q.|-cn))^2/(1-cn)^2)>=0 by XCMPLX_1:77;
            then sqrt(1-(q`1/|.q.|-cn)^2/(1-cn)^2)>=0;
            then sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)>=0 by XCMPLX_1:77;
            then p`2=0 by A5,A31,A33,A34,EUCLID:56;
            then
A42:        ( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))=0 by A5,A31,A32,A34,A35
            ,XCMPLX_1:6;
            1-(-((q`1/|.q.|-cn))/(1-cn))^2>=0 by A41,XCMPLX_1:188;
            then 1-((q`1/|.q.|-cn)/(1-cn))^2=0 by A42,SQUARE_1:92;
            then 1= (q`1/|.q.|-cn)/(1-cn) by A40,A39,SQUARE_1:83,89;
            then 1 *(1-cn)=(q`1/|.q.|-cn) by A40,XCMPLX_1:88;
            then 1 *|.q.|=q`1 by A28,TOPRNS_1:25,XCMPLX_1:88;
            then q`2=0 by A38,XCMPLX_1:6;
            hence thesis by A5,A34,Th56;
          end;
          case
A43:        p<>0.TOP-REAL 2 & p`1/|.p.|>=cn & p`2>=0;
            0<=(q`2)^2 by XREAL_1:65;
            then (|.q.|)^2 =(q`1)^2+(q`2)^2 & 0+(q`1)^2<=(q`1)^2+(q`2)^2 by
            JGRAPH_3:10 ,XREAL_1:9;
            then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by XREAL_1:74;
            then (q`1)^2/(|.q.|)^2 <= 1 by A29,XCMPLX_1:60;
            then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
            then 1>=q`1/|.q.| by SQUARE_1:121;
            then 1-cn>=q`1/|.q.|-cn by XREAL_1:11;
            then -(1-cn)<= -( q`1/|.q.|-cn) by XREAL_1:26;
            then (-(1-cn))/(1-cn)<=(-( q`1/|.q.|-cn))/(1-cn) by A6,
            XREAL_1:74;
            then
A44:        -1<=(-( q`1/|.q.|-cn))/(1-cn) by A6,XCMPLX_1:198;
            (q`1/|.q.|-cn)>= 0 by A28,XREAL_1:50;
            then ((-(q`1/|.q.|-cn))/(1-cn))^2<=1^2 by A6,A44, SQUARE_1:
            119;
            then 1-((-(q`1/|.q.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
            then
A45:        1-(-((q`1/|.q.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
            q4`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)) by EUCLID:
            56;
            then
A46:        (q4`2)^2= (|.q.|)^2*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))^2
              .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1-cn))^2) by A45,SQUARE_1:
            def 4;
A47:        q4`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by EUCLID:56;
            (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
              .=(|.q.|)^2 by A47,A46;
            then
A48:        sqrt((|.q4.|)^2)=|.q.| by SQUARE_1:89;
            then
A49:        |.q4.|=|.q.| by SQUARE_1:89;
            0<=(p`2)^2 by XREAL_1:65;
            then (|.p.|)^2 =(p`1)^2+(p`2)^2 & 0+(p`1)^2<=(p`1)^2+(p`2)^2 by
            JGRAPH_3:10 ,XREAL_1:9;
            then
A50:        (p`1)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by XREAL_1:74;
            |.p.|<>0 by A43,TOPRNS_1:25;
            then (|.p.|)^2>0 by SQUARE_1:74;
            then (p`1)^2/(|.p.|)^2 <= 1 by A50,XCMPLX_1:60;
            then ((p`1)/|.p.|)^2 <= 1 by XCMPLX_1:77;
            then 1>=p`1/|.p.| by SQUARE_1:121;
            then 1-cn>=p`1/|.p.|-cn by XREAL_1:11;
            then -(1-cn)<= -( p`1/|.p.|-cn) by XREAL_1:26;
            then (-(1-cn))/(1-cn)<=(-( p`1/|.p.|-cn))/(1-cn) by A6,
            XREAL_1:74;
            then
A51:        -1<=(-( p`1/|.p.|-cn))/(1-cn) by A6,XCMPLX_1:198;
            (p`1/|.p.|-cn)>= 0 by A43,XREAL_1:50;
            then ((-(p`1/|.p.|-cn))/(1-cn))^2<=1^2 by A6,A51, SQUARE_1:
            119;
            then 1-((-(p`1/|.p.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
            then
A52:        1-(-((p`1/|.p.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
            set p4= |[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)), |.p.|*( sqrt(1-((p`1/|.
            p.|-cn)/(1-cn))^2))]|;
A53:        p4`1= |.p.|* ((p`1/|.p.|-cn)/(1-cn)) by EUCLID:56;
            p4`2= |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)) by EUCLID:
            56;
            then
A54:        (p4`2)^2= (|.p.|)^2*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))^2
              .= (|.p.|)^2*(1-((p`1/|.p.|-cn)/(1-cn))^2) by A52,SQUARE_1:
            def 4;
            (|.p4.|)^2=(p4`1)^2+(p4`2)^2 by JGRAPH_3:10
              .=(|.p.|)^2 by A53,A54;
            then
A55:        sqrt((|.p4.|)^2)=|.p.| by SQUARE_1:89;
            then
A56:        |.p4.|=|.p.| by SQUARE_1:89;
A57:        cn-FanMorphN.p= |[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)), |.p.|*(
            sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]| by A1,A2,A43,Th58;
            then ((p`1/|.p.|-cn)/(1-cn)) =|.q.|* ((q`1/|.q.|-cn)/(1-cn))/|.p
            .| by A5,A31,A30,A43,A53, TOPRNS_1:25,XCMPLX_1:90;
            then (p`1/|.p.|-cn)/(1-cn)=(q`1/|.q.|-cn)/(1-cn) by A5,A31,A43,
            A57,A48,A55,TOPRNS_1:25,XCMPLX_1:90;
            then (p`1/|.p.|-cn)/(1-cn)*(1-cn)=q`1/|.q.|-cn by A6,
            XCMPLX_1:88;
            then p`1/|.p.|-cn=q`1/|.q.|-cn by A6,XCMPLX_1:88;
            then p`1/|.p.|*|.p.|=q`1 by A5,A31,A43,A57,A49,A56,
            TOPRNS_1:25,XCMPLX_1:88;
            then
A58:        p`1=q`1 by A43,TOPRNS_1:25,XCMPLX_1:88;
A59:        p=|[p`1,p`2]| by EUCLID:57;
            |.p.|^2=(p`1)^2+(p`2)^2 & |.q.|^2=(q`1)^2+(q`2)^2 by
            JGRAPH_3:10;
            then p`2=sqrt((q`2)^2) by A5,A31,A43,A57,A49,A56,A58,
            SQUARE_1:89;
            then p`2=q`2 by A28,SQUARE_1:89;
            hence thesis by A58,A59,EUCLID:57;
          end;
          case
A60:        p<>0.TOP-REAL 2 & p`1/|.p.|<cn & p`2>=0;
            then p`1/|.p.|-cn<0 by XREAL_1:51;
            then
A61:        ((p`1/|.p.|-cn)/(1+cn))<0 by A1,XREAL_1:143,150;
            set p4= |[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)), |.p.|*( sqrt(1-((p`1/|.
            p.|-cn)/(1+cn))^2))]|;
A62:        p4`1= |.p.|* ((p`1/|.p.|-cn)/(1+cn)) & q`1/|.q.|-cn>=0 by
            A28,EUCLID:56 ,XREAL_1:50;
A63:        1-cn>0 by A2,XREAL_1:151;
            cn-FanMorphN.p= |[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)), |.p.|*(
sqrt(1-((p`1/|.p.| -cn)/(1+cn))^2))]| & |.p.|<>0 by A1,A2,A60,Th58,TOPRNS_1:25;
            hence thesis by A5,A31,A30,A61,A62,A63,XREAL_1:134;
          end;
        end;
        hence thesis;
      end;
      case
A64:    q`1/|.q.|<cn & q`2>=0 & q<>0.TOP-REAL 2;
        then
A65:    |.q.|<>0 by TOPRNS_1:25;
        then
A66:    (|.q.|)^2>0 by SQUARE_1:74;
        set q4= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)), |.q.|*( sqrt(1-((q`1/|.q.|-
        cn)/(1+cn))^2))]|;
A67:    q4`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by EUCLID:56;
A68:    cn-FanMorphN.q= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)), |.q.|*( sqrt(
        1-((q`1/|.q.|-cn)/(1+cn))^2))]| by A1,A2,A64,Th58;
A69:    q4`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)) by EUCLID:56;
        now
          per cases by JGRAPH_2:11;
          case
A70:        p`2<=0;
A71:        (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
A72:        1+cn>0 by A1,XREAL_1:150;
            0<=(q`2)^2 by XREAL_1:65;
            then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
            then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A71,
            XREAL_1:74;
            then (q`1)^2/(|.q.|)^2 <= 1 by A66,XCMPLX_1:60;
            then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
            then (-((q`1)/|.q.|))^2 <= 1;
            then 1>= -q`1/|.q.| by SQUARE_1:121;
            then (1+cn)>= -q`1/|.q.|+cn by XREAL_1:9;
            then
A73:        (-(q`1/|.q.|-cn))/(1+cn)<=1 by A72,XREAL_1:187;
A74:        (q`1/|.q.|-cn)<=0 by A64,XREAL_1:49;
            then -1<=(-( q`1/|.q.|-cn))/(1+cn) by A72;
            then ((-(q`1/|.q.|-cn))/(1+cn))^2<=1^2 by A73,SQUARE_1:119;
            then
A75:        1-((-(q`1/|.q.|-cn))/(1+cn))^2>=0 by XREAL_1:50;
            then
A76:        1-(-((q`1/|.q.|-cn))/(1+cn))^2>=0 by XCMPLX_1:188;
A77:        (cn-FanMorphN).p=p by A70,Th56;
            sqrt(1-((-(q`1/|.q.|-cn))/(1+cn))^2)>=0 by A75, SQUARE_1:
            def 4;
            then sqrt(1-(-(q`1/|.q.|-cn))^2/(1+cn)^2)>=0 by XCMPLX_1:77;
            then sqrt(1-((q`1/|.q.|-cn))^2/(1+cn)^2)>=0;
            then sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)>=0 by XCMPLX_1:77;
            then p`2=0 by A5,A68,A70,A77,EUCLID:56;
            then ( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))=0 by A5,A68,A69,A65
            ,A77,XCMPLX_1:6;
            then 1-((q`1/|.q.|-cn)/(1+cn))^2=0 by A76,SQUARE_1:92;
            then 1=sqrt((-((q`1/|.q.|-cn)/(1+cn)))^2) by SQUARE_1:83;
            then 1= -((q`1/|.q.|-cn)/(1+cn)) by A72,A74,SQUARE_1:89;
            then 1= ((-(q`1/|.q.|-cn))/(1+cn)) by XCMPLX_1:188;
            then 1 *(1+cn)=-(q`1/|.q.|-cn) by A72,XCMPLX_1:88;
            then 1+cn-cn=-q`1/|.q.|;
            then 1=(-q`1)/|.q.| by XCMPLX_1:188;
            then 1 *|.q.|=-q`1 by A64,TOPRNS_1:25,XCMPLX_1:88;
            then (q`1)^2-(q`1)^2 =(q`2)^2 by A71,XCMPLX_1:26;
            then q`2=0 by XCMPLX_1:6;
            hence thesis by A5,A77,Th56;
          end;
          case
A78:        p<>0.TOP-REAL 2 & p`1/|.p.|>=cn & p`2>=0;
            set p4= |[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)), |.p.|*( sqrt(1-((p`1/|.
            p.|-cn)/(1-cn))^2))]|;
A79:        p4`1= |.p.|* ((p`1/|.p.|-cn)/(1-cn)) & |.q.|<>0 by A64,
            EUCLID:56 ,TOPRNS_1:25;
            q`1/|.q.|-cn<0 by A64,XREAL_1:51;
            then
A80:        ((q`1/|.q.|-cn)/(1+cn))<0 by A1,XREAL_1:143,150;
A81:        1-cn>0 by A2,XREAL_1:151;
            cn-FanMorphN.p= |[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)), |.p.|*(
sqrt(1-((p`1/|.p.| -cn)/(1-cn))^2))]| & p`1/|.p.|-cn>=0 by A1,A2,A78,Th58,
            XREAL_1:50;
            hence thesis by A5,A68,A67,A80,A79,A81,XREAL_1:134;
          end;
          case
A82:        p<>0.TOP-REAL 2 & p`1/|.p.|<cn & p`2>=0;
            0<=(p`2)^2 by XREAL_1:65;
            then (|.p.|)^2 =(p`1)^2+(p`2)^2 & 0+(p`1)^2<=(p`1)^2+(p`2)^2 by
            JGRAPH_3:10 ,XREAL_1:9;
            then
A83:        (p`1)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by XREAL_1:74;
A84:        1+cn>0 by A1,XREAL_1:150;
            0<=(q`2)^2 by XREAL_1:65;
            then (|.q.|)^2 =(q`1)^2+(q`2)^2 & 0+(q`1)^2<=(q`1)^2+(q`2)^2 by
            JGRAPH_3:10 ,XREAL_1:9;
            then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by XREAL_1:74;
            then (q`1)^2/(|.q.|)^2 <= 1 by A66,XCMPLX_1:60;
            then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
            then -1<=q`1/|.q.| by SQUARE_1:121;
            then -1-cn<=q`1/|.q.|-cn by XREAL_1:11;
            then -(-1-cn)>= -(q`1/|.q.|-cn) by XREAL_1:26;
            then
A85:        (-(q`1/|.q.|-cn))/(1+cn)<=1 by A84,XREAL_1:187;
            (q`1/|.q.|-cn)<=0 by A64,XREAL_1:49;
            then -1<=(-( q`1/|.q.|-cn))/(1+cn) by A84;
            then ((-(q`1/|.q.|-cn))/(1+cn))^2<=1^2 by A85,SQUARE_1:119;
            then 1-((-(q`1/|.q.|-cn))/(1+cn))^2>=0 by XREAL_1:50;
            then
A86:        1-(-((q`1/|.q.|-cn))/(1+cn))^2>=0 by XCMPLX_1:188;
            q4`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)) by EUCLID:
            56;
            then
A87:        (q4`2)^2= (|.q.|)^2*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))^2
              .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1+cn))^2) by A86,SQUARE_1:
            def 4;
A88:        q4`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by EUCLID:56;
            set p4= |[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)), |.p.|*( sqrt(1-((p`1/|.
            p.|-cn)/(1+cn))^2))]|;
A89:        p4`1= |.p.|* ((p`1/|.p.|-cn)/(1+cn)) by EUCLID:56;
            |.p.|<>0 by A82,TOPRNS_1:25;
            then (|.p.|)^2>0 by SQUARE_1:74;
            then (p`1)^2/(|.p.|)^2 <= 1 by A83,XCMPLX_1:60;
            then ((p`1)/|.p.|)^2 <= 1 by XCMPLX_1:77;
            then -1<=p`1/|.p.| by SQUARE_1:121;
            then -1-cn<=p`1/|.p.|-cn by XREAL_1:11;
            then -(-1-cn)>= -(p`1/|.p.|-cn) by XREAL_1:26;
            then
A90:        (-(p`1/|.p.|-cn))/(1+cn)<=1 by A84,XREAL_1:187;
            (p`1/|.p.|-cn)<=0 by A82,XREAL_1:49;
            then -1<=(-( p`1/|.p.|-cn))/(1+cn) by A84;
            then ((-(p`1/|.p.|-cn))/(1+cn))^2<=1^2 by A90,SQUARE_1:119;
            then 1-((-(p`1/|.p.|-cn))/(1+cn))^2>=0 by XREAL_1:50;
            then
A91:        1-(-((p`1/|.p.|-cn))/(1+cn))^2>=0 by XCMPLX_1:188;
            p4`2= |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)) by EUCLID:
            56;
            then
A92:        (p4`2)^2= (|.p.|)^2*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))^2
              .= (|.p.|)^2*(1-((p`1/|.p.|-cn)/(1+cn))^2) by A91,SQUARE_1:
            def 4;
            (|.p4.|)^2=(p4`1)^2+(p4`2)^2 by JGRAPH_3:10
              .=(|.p.|)^2 by A89,A92;
            then
A93:        sqrt((|.p4.|)^2)=|.p.| by SQUARE_1:89;
            then
A94:        |.p4.|=|.p.| by SQUARE_1:89;
            (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
              .=(|.q.|)^2 by A88,A87;
            then
A95:        sqrt((|.q4.|)^2)=|.q.| by SQUARE_1:89;
            then
A96:        |.q4.|=|.q.| by SQUARE_1:89;
A97:        cn-FanMorphN.p= |[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)), |.p.|*(
            sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]| by A1,A2,A82,Th58;
            then ((p`1/|.p.|-cn)/(1+cn))=|.q.|* ((q`1/|.q.|-cn)/(1+cn))/|.p.|
            by A5,A68,A67,A82,A89,TOPRNS_1:25,XCMPLX_1:90;
            then (p`1/|.p.|-cn)/(1+cn)=(q`1/|.q.|-cn)/(1+cn) by A5,A68,A82,
            A97,A95,A93,TOPRNS_1:25,XCMPLX_1:90;
            then (p`1/|.p.|-cn)/(1+cn)*(1+cn)=q`1/|.q.|-cn by A84,
            XCMPLX_1:88;
            then p`1/|.p.|-cn=q`1/|.q.|-cn by A84,XCMPLX_1:88;
            then p`1/|.p.|*|.p.|=q`1 by A5,A68,A82,A97,A96,A94,
            TOPRNS_1:25,XCMPLX_1:88;
            then
A98:        p`1=q`1 by A82,TOPRNS_1:25,XCMPLX_1:88;
A99:        p=|[p`1,p`2]| by EUCLID:57;
            |.p.|^2=(p`1)^2+(p`2)^2 & |.q.|^2=(q`1)^2+(q`2)^2 by
            JGRAPH_3:10;
            then p`2=sqrt((q`2)^2) by A5,A68,A82,A97,A96,A94,A98,
            SQUARE_1:89;
            then p`2=q`2 by A64,SQUARE_1:89;
            hence thesis by A98,A99,EUCLID:57;
          end;
        end;
        hence thesis;
      end;
    end;
    hence thesis;
  end;
  hence thesis by FUNCT_1:def 8;
end;

theorem Th79:
  for cn being Real st -1<cn & cn<1 holds (cn-FanMorphN) is
  Function of TOP-REAL 2,TOP-REAL 2 & rng (cn-FanMorphN) = the carrier of
  TOP-REAL 2
proof
  let cn be Real;
  assume that
A1: -1<cn and
A2: cn<1;
  thus (cn-FanMorphN) is Function of TOP-REAL 2,TOP-REAL 2;
  for f being Function of TOP-REAL 2,TOP-REAL 2 st f=(cn-FanMorphN) holds
  rng (cn-FanMorphN)=the carrier of TOP-REAL 2
  proof
    let f be Function of TOP-REAL 2,TOP-REAL 2;
    assume
A3: f=(cn-FanMorphN);
A4: dom f=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
    the carrier of TOP-REAL 2 c= rng f
    proof
      let y be set;
      assume
      y in the carrier of TOP-REAL 2;
      then reconsider p2=y as Point of TOP-REAL 2;
      set q=p2;
      now
        per cases by JGRAPH_2:11;
        case
          q`2<=0;
          then y=(cn-FanMorphN).q by Th56;
          hence ex x being set st x in dom (cn-FanMorphN) & y=(cn-FanMorphN).x
          by A3,A4;
        end;
        case
A5:       q`1/|.q.|>=0 & q`2>=0 & q<>0.TOP-REAL 2;
          --(1+cn)>0 by A1,XREAL_1:150;
          then
A6:       -(-1-cn)>0;
A7:       1-cn>=0 by A2,XREAL_1:151;
          then q`1/|.q.|*(1-cn)>=0 by A5;
          then -1-cn<= q`1/|.q.|*(1-cn) by A6;
          then
A8:       -1-cn+cn<= q`1/|.q.|*(1-cn)+cn by XREAL_1:9;
          set px=|[ |.q.|*(q`1/|.q.|*(1-cn)+cn), (|.q.|)*sqrt(1-(q`1/|.q.|*(1-
          cn)+cn)^2)]|;
A9:       px`1 = |.q.|*(q`1/|.q.|*(1-cn)+cn) by EUCLID:56;
          |.q.|<>0 by A5,TOPRNS_1:25;
          then
A10:      |.q.|^2>0 by SQUARE_1:74;
A11:      dom (cn-FanMorphN)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
A12:      1-cn>0 by A2,XREAL_1:151;
          0<=(q`2)^2 by XREAL_1:65;
          then (|.q.|)^2 =(q`1)^2+(q`2)^2 & 0+(q`1)^2<=(q`1)^2+(q`2)^2 by
          JGRAPH_3:10 ,XREAL_1:9;
          then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by XREAL_1:74;
          then (q`1)^2/(|.q.|)^2 <= 1 by A10,XCMPLX_1:60;
          then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
          then q`1/|.q.|<=1 by SQUARE_1:121;
          then q`1/|.q.|*(1-cn) <=1 *(1-cn) by A12,XREAL_1:66;
          then q`1/|.q.|*(1-cn)+cn-cn <=1-cn;
          then (q`1/|.q.|*(1-cn)+cn) <=1 by XREAL_1:11;
          then 1^2>=(q`1/|.q.|*(1-cn)+cn)^2 by A8,SQUARE_1:119;
          then
A13:      1-(q`1/|.q.|*(1-cn)+cn)^2>=0 by XREAL_1:50;
          then
A14:      sqrt(1-(q`1/|.q.|*(1-cn)+cn)^2)>=0 by SQUARE_1:def 4;
A15:      px`2 = (|.q.|)*sqrt(1-(q`1/|.q.|*(1-cn)+cn)^2) by EUCLID:56;
          then
          |.px.|^2=((|.q.|)*sqrt(1-(q`1/|.q.|*(1-cn)+cn)^2))^2 +(|.q.|*(q
          `1/|.q.|*(1-cn)+cn))^2 by A9,JGRAPH_3:10
            .=(|.q.|)^2*(sqrt(1-(q`1/|.q.|*(1-cn)+cn)^2))^2 +(|.q.|)^2*((q`1
          /|.q.|*(1-cn)+cn))^2;
          then
A16:      |.px.|^2=(|.q.|)^2*(1-(q`1/|.q.|*(1-cn)+cn)^2) +(|.q.|)^2*((q`1
          /|.q.|*(1-cn)+cn))^2 by A13,SQUARE_1:def 4
            .= (|.q.|)^2;
          then
A17:      |.px.|=sqrt(|.q.|^2) by SQUARE_1:89
            .=|.q.| by SQUARE_1:89;
          then
A18:      px<>0.TOP-REAL 2 by A5,TOPRNS_1:24,25;
          (q`1/|.q.|*(1-cn)+cn)>=0+cn by A5,A7,XREAL_1:9;
          then px`1/|.px.| >=cn by A5,A9,A17,TOPRNS_1:25,XCMPLX_1:90;
          then
A19:      (cn-FanMorphN).px =|[ |.px.|* ((px`1/|.px.|-cn)/(1-cn) ), |.px
.|*( sqrt(1-((px`1/|.px.|-cn)/(1-cn))^2))]| by A1,A2,A15,A14,A18,Th58;
A20:      |.px.|*( sqrt((q`2/|.q.|)^2))=|.q.|*(q`2/|.q.|) by A5,A17,
          SQUARE_1:89
            .=q`2 by A5,TOPRNS_1:25,XCMPLX_1:88;
A21:      |.px.|* ((px`1/|.px.|-cn)/(1-cn)) =|.q.|* (( ((q`1/|.q.|*(1-cn)
          +cn))-cn)/(1-cn)) by A5,A9,A17,TOPRNS_1:25 ,XCMPLX_1:90
            .=|.q.|* ( q`1/|.q.|) by A12,XCMPLX_1:90
            .= q`1 by A5,TOPRNS_1:25,XCMPLX_1:88;
          then
          |.px.|*( sqrt(1-((px`1/|.px.|-cn)/(1-cn))^2)) = |.px.|*( sqrt(1
          -(q`1/|.px.|)^2)) by A5,A17,TOPRNS_1:25 ,XCMPLX_1:90
            .= |.px.|*( sqrt(1-(q`1)^2/(|.px.|)^2)) by XCMPLX_1:77
            .= |.px.|*( sqrt( (|.px.|)^2/(|.px.|)^2-(q`1)^2/(|.px.|)^2)) by
          A10,A16,XCMPLX_1:60
            .= |.px.|*( sqrt( ((|.px.|)^2-(q`1)^2)/(|.px.|)^2)) by XCMPLX_1:
          121
            .= |.px.|*( sqrt( ((q`1)^2+(q`2)^2-(q`1)^2)/(|.px.|)^2)) by A16,
          JGRAPH_3:10
            .= |.px.|*( sqrt((q`2/|.q.|)^2)) by A17,XCMPLX_1:77;
          hence ex x being set st x in dom (cn-FanMorphN) & y=(cn-FanMorphN).x
          by A19,A21,A20,A11,EUCLID:57;
        end;
        case
A22:      q`1/|.q.|<0 & q`2>=0 & q<>0.TOP-REAL 2;
A23:      1+cn>=0 by A1,XREAL_1:150;
          (1-cn)>0 by A2,XREAL_1:151;
          then
A24:      1-cn+cn>= q`1/|.q.|*(1+cn)+cn by A22,A23,XREAL_1:9;
A25:      1+cn>0 by A1,XREAL_1:150;
          |.q.|<>0 by A22,TOPRNS_1:25;
          then
A26:      |.q.|^2>0 by SQUARE_1:74;
          0<=(q`2)^2 by XREAL_1:65;
          then (|.q.|)^2 =(q`1)^2+(q`2)^2 & 0+(q`1)^2<=(q`1)^2+(q`2)^2 by
          JGRAPH_3:10 ,XREAL_1:9;
          then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by XREAL_1:74;
          then (q`1)^2/(|.q.|)^2 <= 1 by A26,XCMPLX_1:60;
          then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
          then q`1/|.q.|>=-1 by SQUARE_1:121;
          then q`1/|.q.|*(1+cn) >=(-1)*(1+cn) by A25,XREAL_1:66;
          then q`1/|.q.|*(1+cn)+cn-cn >=-1-cn;
          then (q`1/|.q.|*(1+cn)+cn) >=-1 by XREAL_1:11;
          then 1^2>=(q`1/|.q.|*(1+cn)+cn)^2 by A24,SQUARE_1:119;
          then
A27:      1-(q`1/|.q.|*(1+cn)+cn)^2>=0 by XREAL_1:50;
          then
A28:      sqrt(1-(q`1/|.q.|*(1+cn)+cn)^2)>=0 by SQUARE_1:def 4;
A29:      dom (cn-FanMorphN)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
          set px=|[ |.q.|*(q`1/|.q.|*(1+cn)+cn), (|.q.|)*sqrt(1-(q`1/|.q.|*(1+
          cn)+cn)^2)]|;
A30:      px`1 = |.q.|*(q`1/|.q.|*(1+cn)+cn) by EUCLID:56;
A31:      px`2 = (|.q.|)*sqrt(1-(q`1/|.q.|*(1+cn)+cn)^2) by EUCLID:56;
          then
          |.px.|^2=((|.q.|)*sqrt(1-(q`1/|.q.|*(1+cn)+cn)^2))^2 +(|.q.|*(q
          `1/|.q.|*(1+cn)+cn))^2 by A30,JGRAPH_3:10
            .=(|.q.|)^2*(sqrt(1-(q`1/|.q.|*(1+cn)+cn)^2))^2 +(|.q.|)^2*((q`1
          /|.q.|*(1+cn)+cn))^2;
          then
A32:      |.px.|^2=(|.q.|)^2*(1-(q`1/|.q.|*(1+cn)+cn)^2) +(|.q.|)^2*((q`1
          /|.q.|*(1+cn)+cn))^2 by A27,SQUARE_1:def 4
            .= (|.q.|)^2;
          then
A33:      |.px.|=sqrt(|.q.|^2) by SQUARE_1:89
            .=|.q.| by SQUARE_1:89;
          then
A34:      px<>0.TOP-REAL 2 by A22,TOPRNS_1:24,25;
          (q`1/|.q.|*(1+cn)+cn)<=0+cn by A22,A23,XREAL_1:9;
          then px`1/|.px.| <=cn by A22,A30,A33,TOPRNS_1:25,XCMPLX_1:90;
          then
A35:      (cn-FanMorphN).px =|[ |.px.|* ((px`1/|.px.|-cn)/(1+cn) ), |.px
.|*( sqrt(1-((px`1/|.px.|-cn)/(1+cn))^2))]| by A1,A2,A31,A28,A34,Th58;
A36:      |.px.|*( sqrt((q`2/|.q.|)^2))=|.q.|*(q`2/|.q.|) by A22,A33,
          SQUARE_1:89
            .=q`2 by A22,TOPRNS_1:25,XCMPLX_1:88;
A37:      |.px.|* ((px`1/|.px.|-cn)/(1+cn)) =|.q.|* (( ((q`1/|.q.|*(1+cn)
          +cn))-cn)/(1+cn)) by A22,A30,A33,TOPRNS_1:25 ,XCMPLX_1:90
            .=|.q.|* ( q`1/|.q.|) by A25,XCMPLX_1:90
            .= q`1 by A22,TOPRNS_1:25,XCMPLX_1:88;
          then
          |.px.|*( sqrt(1-((px`1/|.px.|-cn)/(1+cn))^2)) = |.px.|*( sqrt(1
          -(q`1/|.px.|)^2)) by A22,A33,TOPRNS_1:25 ,XCMPLX_1:90
            .= |.px.|*( sqrt(1-(q`1)^2/(|.px.|)^2)) by XCMPLX_1:77
            .= |.px.|*( sqrt( (|.px.|)^2/(|.px.|)^2-(q`1)^2/(|.px.|)^2)) by
          A26,A32,XCMPLX_1:60
            .= |.px.|*( sqrt( ((|.px.|)^2-(q`1)^2)/(|.px.|)^2)) by XCMPLX_1:
          121
            .= |.px.|*( sqrt( ((q`1)^2+(q`2)^2-(q`1)^2)/(|.px.|)^2)) by A32,
          JGRAPH_3:10
            .= |.px.|*( sqrt((q`2/|.q.|)^2)) by A33,XCMPLX_1:77;
          hence ex x being set st x in dom (cn-FanMorphN) & y=(cn-FanMorphN).x
          by A35,A37,A36,A29,EUCLID:57;
        end;
      end;
      hence thesis by A3,FUNCT_1:def 5;
    end;
    hence thesis by A3,XBOOLE_0:def 10;
  end;
  hence thesis;
end;

theorem Th80:
  for cn being Real,p2 being Point of TOP-REAL 2 st -1<cn & cn<1
ex K being non empty compact Subset of TOP-REAL 2 st K = (cn-FanMorphN).:K & ex
  V2 being Subset of TOP-REAL 2 st p2 in V2 & V2 is open & V2 c= K & (cn
  -FanMorphN).p2 in V2
proof
  reconsider O=0.TOP-REAL 2 as Point of Euclid 2 by EUCLID:71;
  let cn be Real,p2 be Point of TOP-REAL 2;
A1: the TopStruct of TOP-REAL 2 = TopSpaceMetr Euclid 2 by EUCLID:def 8;
  the TopStruct of TOP-REAL 2 = TopSpaceMetr Euclid 2 by EUCLID:def 8;
  then reconsider V0=Ball(O,|.p2.|+1) as Subset of TOP-REAL 2;
  O in V0 & V0 c= cl_Ball(O,|.p2.|+1) by GOBOARD6:4,METRIC_1:15;
  then reconsider
  K0=cl_Ball(O,|.p2.|+1) as non empty compact Subset of TOP-REAL 2
  by A1,Th22;
  set q3= (cn-FanMorphN).p2;
  reconsider VV0 = V0 as Subset of TopSpaceMetr Euclid 2;
  reconsider u2=p2 as Point of Euclid 2 by EUCLID:71;
  reconsider u3=q3 as Point of Euclid 2 by EUCLID:71;
A2: (cn-FanMorphN).:K0 c= K0
  proof
    let y be set;
    assume
    y in (cn-FanMorphN).:K0;
    then consider x being set such that
A3: x in dom (cn-FanMorphN) and
A4: x in K0 and
A5: y=(cn-FanMorphN).x by FUNCT_1:def 12;
    reconsider q=x as Point of TOP-REAL 2 by A3;
    reconsider uq=q as Point of Euclid 2 by EUCLID:71;
    dist(O,uq)<= |.p2.|+1 by A4,METRIC_1:13;
    then |.0.TOP-REAL 2 - q.|<= |.p2.|+1 by JGRAPH_1:45;
    then |. -q.|<= |.p2.|+1 by EUCLID:31;
    then
A6: |.q.|<= |.p2.|+1 by TOPRNS_1:27;
A7: y in rng (cn-FanMorphN) by A3,A5,FUNCT_1:def 5;
    then reconsider u=y as Point of Euclid 2 by EUCLID:71;
    reconsider q4=y as Point of TOP-REAL 2 by A7;
    |.q4.|=|.q.| by A5,Th73;
    then |. -q4.|<= |.p2.|+1 by A6,TOPRNS_1:27;
    then |.0.TOP-REAL 2 - q4.|<= |.p2.|+1 by EUCLID:31;
    then dist(O,u)<= |.p2.|+1 by JGRAPH_1:45;
    hence thesis by METRIC_1:13;
  end;
  VV0 is open by TOPMETR:21;
  then
A8: V0 is open by Lm11,PRE_TOPC:60;
A9: |. p2.|<|.p2.|+1 by XREAL_1:31;
  then |. -p2.|<|.p2.|+1 by TOPRNS_1:27;
  then |.0.TOP-REAL 2 - p2.|<|.p2.|+1 by EUCLID:31;
  then dist(O,u2)<|.p2.|+1 by JGRAPH_1:45;
  then
A10: p2 in V0 by METRIC_1:12;
  |.q3.|=|.p2.| by Th73;
  then |. -q3.|<|.p2.|+1 by A9,TOPRNS_1:27;
  then |.0.TOP-REAL 2 - q3.|<|.p2.|+1 by EUCLID:31;
  then dist(O,u3)< |.p2.|+1 by JGRAPH_1:45;
  then
A11: (cn-FanMorphN).p2 in V0 by METRIC_1:12;
  assume
A12: -1<cn & cn<1;
  K0 c= (cn-FanMorphN).:K0
  proof
    let y be set;
    assume
A13: y in K0;
    then reconsider q4=y as Point of TOP-REAL 2;
    reconsider y as Point of Euclid 2 by A13;
    the carrier of TOP-REAL 2 c= rng (cn-FanMorphN) by A12,Th79;
    then q4 in rng (cn-FanMorphN) by TARSKI:def 3;
    then consider x being set such that
A14: x in dom (cn-FanMorphN) and
A15: y=(cn-FanMorphN).x by FUNCT_1:def 5;
    reconsider x as Point of Euclid 2 by A14,Lm11;
    reconsider q=x as Point of TOP-REAL 2 by A14;
    |.q4.|=|.q.| by A15,Th73;
    then q in K0 by A13,Lm12;
    hence thesis by A14,A15,FUNCT_1:def 12;
  end;
  then K0= (cn-FanMorphN).:K0 by A2,XBOOLE_0:def 10;
  hence thesis by A10,A8,A11,METRIC_1:15;
end;

theorem
  for cn being Real st -1<cn & cn<1 ex f being Function of TOP-REAL 2,
  TOP-REAL 2 st f=cn-FanMorphN & f is being_homeomorphism
proof
  let cn be Real;
  reconsider f=(cn-FanMorphN) as Function of TOP-REAL 2,TOP-REAL 2;
  assume
A1: -1<cn & cn<1;
  then
A2: for p2 being Point of TOP-REAL 2 ex K being non empty compact Subset of
  TOP-REAL 2 st K = f.:K & ex V2 being Subset of TOP-REAL 2 st p2 in V2 & V2 is
  open & V2 c= K & f.p2 in V2 by Th80;
  rng (cn-FanMorphN) = the carrier of TOP-REAL 2 & ex h being Function of
  ( TOP-REAL 2),(TOP-REAL 2) st h=( cn-FanMorphN) & h is continuous by A1,Th77,
  Th79;
  then f is being_homeomorphism by A1,A2,Th8,Th78;
  hence thesis;
end;

theorem Th82:
  for cn being Real,q being Point of TOP-REAL 2 st cn<1 & q`2>0 &
q`1/|.q.|>=cn holds for p being Point of TOP-REAL 2 st p=(cn-FanMorphN).q holds
  p`2>0 & p`1>=0
proof
  let cn be Real,q be Point of TOP-REAL 2;
  assume that
A1: cn<1 and
A2: q`2>0 and
A3: q`1/|.q.|>=cn;
A4: (q`1/|.q.|-cn)>= 0 by A3,XREAL_1:50;
  let p be Point of TOP-REAL 2;
  set qz=p;
A5: 1-cn>0 by A1,XREAL_1:151;
A6: |.q.|<>0 by A2,JGRAPH_2:11,TOPRNS_1:25;
  then
A7: (|.q.|)^2>0 by SQUARE_1:74;
  (|.q.|)^2 =(q`1)^2+(q`2)^2 & 0+(q`1)^2<(q`1)^2+(q`2)^2 by A2,JGRAPH_3:
  10 ,SQUARE_1:74,XREAL_1:10;
  then (q`1)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A7,XREAL_1:76;
  then (q`1)^2/(|.q.|)^2 < 1 by A7,XCMPLX_1:60;
  then ((q`1)/|.q.|)^2 < 1 by XCMPLX_1:77;
  then 1>q`1/|.q.| by SQUARE_1:122;
  then 1-cn>q`1/|.q.|-cn by XREAL_1:11;
  then -(1-cn)< -( q`1/|.q.|-cn) by XREAL_1:26;
  then (-(1-cn))/(1-cn)<(-( q`1/|.q.|-cn))/(1-cn) by A5,XREAL_1:76;
  then -1<(-( q`1/|.q.|-cn))/(1-cn) by A5,XCMPLX_1:198;
  then ((-(q`1/|.q.|-cn))/(1-cn))^2<1^2 by A5,A4,SQUARE_1:120;
  then 1-((-(q`1/|.q.|-cn))/(1-cn))^2>0 by XREAL_1:52;
  then sqrt(1-((-(q`1/|.q.|-cn))/(1-cn))^2)>0 by SQUARE_1:93;
  then sqrt(1-(-(q`1/|.q.|-cn))^2/(1-cn)^2)> 0 by XCMPLX_1:77;
  then sqrt(1-(q`1/|.q.|-cn)^2/(1-cn)^2)> 0;
  then
A8: sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)> 0 by XCMPLX_1:77;
  assume
  p=(cn-FanMorphN).q;
  then
A9: p=|[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)), |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-
  cn))^2))]| by A2,A3,Th56;
  then qz`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)) by EUCLID:56;
  hence thesis by A9,A6,A5,A4,A8,EUCLID:56,XREAL_1:131;
end;

theorem Th83:
  for cn being Real,q being Point of TOP-REAL 2 st -1<cn & q`2>0 &
q`1/|.q.|<cn holds for p being Point of TOP-REAL 2 st p=(cn-FanMorphN).q holds
  p`2>0 & p`1<0
proof
  let cn be Real,q be Point of TOP-REAL 2;
  assume that
A1: -1<cn and
A2: q`2>0 and
A3: q`1/|.q.|<cn;
A4: 1+cn>0 by A1,XREAL_1:150;
  let p be Point of TOP-REAL 2;
  set qz=p;
  assume
  p=(cn-FanMorphN).q;
  then
  p=|[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)), |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+
  cn))^2))]| by A2,A3,Th57;
  then
A5: qz`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)) & qz`1= |.q.|* ((q`1/
  |.q.|- cn)/(1+cn)) by EUCLID:56;
A6: |.q.|<>0 by A2,JGRAPH_2:11,TOPRNS_1:25;
  then
A7: (|.q.|)^2>0 by SQUARE_1:74;
A8: (q`1/|.q.|-cn)< 0 by A3,XREAL_1:51;
  then -( q`1/|.q.|-cn)>0 by XREAL_1:60;
  then (-(1+cn))/(1+cn)<(-( q`1/|.q.|-cn))/(1+cn) by A4,XREAL_1:76;
  then
A9: -1<(-( q`1/|.q.|-cn))/(1+cn) by A4,XCMPLX_1:198;
  (|.q.|)^2 =(q`1)^2+(q`2)^2 & 0+(q`1)^2<(q`1)^2+(q`2)^2 by A2,JGRAPH_3:
  10 ,SQUARE_1:74,XREAL_1:10;
  then (q`1)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A7,XREAL_1:76;
  then (q`1)^2/(|.q.|)^2 < 1 by A7,XCMPLX_1:60;
  then ((q`1)/|.q.|)^2 < 1 by XCMPLX_1:77;
  then -1<q`1/|.q.| by SQUARE_1:122;
  then -1-cn<q`1/|.q.|-cn by XREAL_1:11;
  then --(1+cn)> -(q`1/|.q.|-cn) by XREAL_1:26;
  then (-(q`1/|.q.|-cn))/(1+cn)<1 by A4,XREAL_1:193;
  then ((-(q`1/|.q.|-cn))/(1+cn))^2<1^2 by A9,SQUARE_1:120;
  then 1-((-(q`1/|.q.|-cn))/(1+cn))^2>0 by XREAL_1:52;
  then sqrt(1-((-(q`1/|.q.|-cn))/(1+cn))^2)>0 by SQUARE_1:93;
  then sqrt(1-(-(q`1/|.q.|-cn))^2/(1+cn)^2)> 0 by XCMPLX_1:77;
  then sqrt(1-(q`1/|.q.|-cn)^2/(1+cn)^2)> 0;
  then
A10: sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)> 0 by XCMPLX_1:77;
  ((q`1/|.q.|-cn)/(1+cn))<0 by A1,A8,XREAL_1:143,150;
  hence thesis by A6,A5,A10,XREAL_1:131,134;
end;

theorem Th84:
  for cn being Real,q1,q2 being Point of TOP-REAL 2 st cn<1 & q1`2
>0 & q1`1/|.q1.|>=cn & q2`2>0 & q2`1/|.q2.|>=cn & q1`1/|.q1.|<q2`1/|.q2.| holds
for p1,p2 being Point of TOP-REAL 2 st p1=(cn-FanMorphN).q1 & p2=(cn-FanMorphN)
  .q2 holds p1`1/|.p1.|<p2`1/|.p2.|
proof
  let cn be Real,q1,q2 be Point of TOP-REAL 2;
  assume that
A1: cn<1 and
A2: q1`2>0 and
A3: q1`1/|.q1.|>=cn and
A4: q2`2>0 and
A5: q2`1/|.q2.|>=cn and
A6: q1`1/|.q1.|<q2`1/|.q2.|;
A7: q1`1/|.q1.|-cn< q2`1/|.q2.|-cn & 1-cn>0 by A1,A6,XREAL_1:11,151;
  let p1,p2 be Point of TOP-REAL 2;
  assume that
A8: p1=(cn-FanMorphN).q1 and
A9: p2=(cn-FanMorphN).q2;
A10: |.p2.|=|.q2.| by A9,Th73;
  p2=|[ |.q2.|* ((q2`1/|.q2.|-cn)/(1-cn)), |.q2.|*( sqrt(1-((q2`1/|.q2.|-
  cn)/(1-cn))^2))]| by A4,A5,A9,Th56;
  then
A11: p2`1= |.q2.|* ((q2`1/|.q2.|-cn)/(1-cn)) by EUCLID:56;
  |.q2.|>0 by A4,Lm1,JGRAPH_2:11;
  then
A12: p2`1/|.p2.|= ((q2`1/|.q2.|-cn)/(1-cn)) by A11,A10,XCMPLX_1:90;
  p1=|[ |.q1.|* ((q1`1/|.q1.|-cn)/(1-cn)), |.q1.|*( sqrt(1-((q1`1/|.q1.|-
  cn)/(1-cn))^2))]| by A2,A3,A8,Th56;
  then
A13: p1`1= |.q1.|* ((q1`1/|.q1.|-cn)/(1-cn)) by EUCLID:56;
A14: |.p1.|=|.q1.| by A8,Th73;
  |.q1.|>0 by A2,Lm1,JGRAPH_2:11;
  then p1`1/|.p1.|= ((q1`1/|.q1.|-cn)/(1-cn)) by A13,A14,XCMPLX_1:90;
  hence thesis by A12,A7,XREAL_1:76;
end;

theorem Th85:
  for cn being Real,q1,q2 being Point of TOP-REAL 2 st -1<cn & q1
`2>0 & q1`1/|.q1.|<cn & q2`2>0 & q2`1/|.q2.|<cn & q1`1/|.q1.|<q2`1/|.q2.| holds
for p1,p2 being Point of TOP-REAL 2 st p1=(cn-FanMorphN).q1 & p2=(cn-FanMorphN)
  .q2 holds p1`1/|.p1.|<p2`1/|.p2.|
proof
  let cn be Real,q1,q2 be Point of TOP-REAL 2;
  assume that
A1: -1<cn and
A2: q1`2>0 and
A3: q1`1/|.q1.|<cn and
A4: q2`2>0 and
A5: q2`1/|.q2.|<cn and
A6: q1`1/|.q1.|<q2`1/|.q2.|;
A7: q1`1/|.q1.|-cn< q2`1/|.q2.|-cn & 1+cn>0 by A1,A6,XREAL_1:11,150;
  let p1,p2 be Point of TOP-REAL 2;
  assume that
A8: p1=(cn-FanMorphN).q1 and
A9: p2=(cn-FanMorphN).q2;
A10: |.p2.|=|.q2.| by A9,Th73;
  p2=|[ |.q2.|* ((q2`1/|.q2.|-cn)/(1+cn)), |.q2.|*( sqrt(1-((q2`1/|.q2.|-
  cn)/(1+cn))^2))]| by A4,A5,A9,Th57;
  then
A11: p2`1= |.q2.|* ((q2`1/|.q2.|-cn)/(1+cn)) by EUCLID:56;
  |.q2.|>0 by A4,Lm1,JGRAPH_2:11;
  then
A12: p2`1/|.p2.|= ((q2`1/|.q2.|-cn)/(1+cn)) by A11,A10,XCMPLX_1:90;
  p1=|[ |.q1.|* ((q1`1/|.q1.|-cn)/(1+cn)), |.q1.|*( sqrt(1-((q1`1/|.q1.|-
  cn)/(1+cn))^2))]| by A2,A3,A8,Th57;
  then
A13: p1`1= |.q1.|* ((q1`1/|.q1.|-cn)/(1+cn)) by EUCLID:56;
A14: |.p1.|=|.q1.| by A8,Th73;
  |.q1.|>0 by A2,Lm1,JGRAPH_2:11;
  then p1`1/|.p1.|= ((q1`1/|.q1.|-cn)/(1+cn)) by A13,A14,XCMPLX_1:90;
  hence thesis by A12,A7,XREAL_1:76;
end;

theorem
  for cn being Real,q1,q2 being Point of TOP-REAL 2 st -1<cn & cn<1 & q1
  `2 > 0 & q2`2>0 & q1`1/|.q1.|<q2`1/|.q2.| holds for p1,p2 being Point of
TOP-REAL 2 st p1=(cn-FanMorphN).q1 & p2=(cn-FanMorphN).q2 holds p1`1/|.p1.|<p2
  `1/|.p2.|
proof
  let cn be Real,q1,q2 be Point of TOP-REAL 2;
  assume that
A1: -1<cn and
A2: cn<1 and
A3: q1`2>0 and
A4: q2`2>0 and
A5: q1`1/|.q1.|<q2`1/|.q2.|;
  let p1,p2 be Point of TOP-REAL 2;
  assume that
A6: p1=(cn-FanMorphN).q1 and
A7: p2=(cn-FanMorphN).q2;
  per cases;
  suppose
    q1`1/|.q1.|>=cn & q2`1/|.q2.|>=cn;
    hence thesis by A2,A3,A4,A5,A6,A7,Th84;
  end;
  suppose
    q1`1/|.q1.|>=cn & q2`1/|.q2.|<cn;
    hence thesis by A5,XXREAL_0:2;
  end;
  suppose
A8: q1`1/|.q1.|<cn & q2`1/|.q2.|>=cn;
    then p2`1>=0 by A2,A4,A7,Th82;
    then
A9: p2`1/|.p2.|>=0;
    p1`1<0 by A1,A3,A6,A8,Th83;
    hence thesis by A9,Lm1,JGRAPH_2:11,XREAL_1:143;
  end;
  suppose
    q1`1/|.q1.|<cn & q2`1/|.q2.|<cn;
    hence thesis by A1,A3,A4,A5,A6,A7,Th85;
  end;
end;

theorem
  for cn being Real,q being Point of TOP-REAL 2 st q`2>0 & q`1/|.q.|=cn
holds for p being Point of TOP-REAL 2 st p=(cn-FanMorphN).q holds p`2>0 & p`1=0
proof
  let cn be Real,q be Point of TOP-REAL 2;
  assume that
A1: q`2>0 and
A2: q`1/|.q.|=cn;
A3: |.q.|<>0 & sqrt(1-((-(q`1/|.q.|-cn))/(1-cn))^2)>0 by A1,A2,JGRAPH_2:11 ,
  SQUARE_1:93,TOPRNS_1:25;
  let p be Point of TOP-REAL 2;
  assume
  p=(cn-FanMorphN).q;
  then
A4: p=|[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)), |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-
  cn))^2))]| by A1,A2,Th56;
  then p`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)) by EUCLID:56;
  hence thesis by A2,A4,A3,EUCLID:56,XREAL_1:131;
end;

theorem
  for cn being real number holds 0.TOP-REAL 2=(cn-FanMorphN).(0.TOP-REAL
  2) by Th56,JGRAPH_2:11;

begin :: Fan Morphism for East

definition
  let s be real number, q be Point of TOP-REAL 2;
  func FanE(s,q) -> Point of TOP-REAL 2 equals
  :Def6:
  |.q.|*|[sqrt(1-((q`2/|.q
.|-s)/(1-s))^2), (q`2/|.q.|-s)/(1-s)]| if q`2/|.q.|>=s & q`1>0, |.q.|*|[sqrt(1-
  ((q`2/|.q.|-s)/(1+s))^2), (q`2/|.q.|-s)/(1+s)]| if q`2/|.q.|<s & q`1>0
  otherwise q;
  correctness;
end;

definition
  let s be real number;
  func s-FanMorphE -> Function of TOP-REAL 2, TOP-REAL 2 means
  :Def7:
  for q
  being Point of TOP-REAL 2 holds it.q=FanE(s,q);
  existence
  proof
    deffunc F(Point of TOP-REAL 2)=FanE(s,$1);
    thus ex IT being Function of TOP-REAL 2, TOP-REAL 2 st for q being Point
    of TOP-REAL 2 holds IT.q=F(q)from FUNCT_2:sch 4;
  end;
  uniqueness
  proof
    deffunc F(Point of TOP-REAL 2)=FanE(s,$1);
    thus for a,b being Function of TOP-REAL 2, TOP-REAL 2 st (for q being
Point of TOP-REAL 2 holds a.q=F(q)) & (for q being Point of TOP-REAL 2 holds b.
    q=F(q)) holds a=b from BINOP_2:sch 1;
  end;
end;

theorem Th89:
  for sn being real number holds (q`2/|.q.|>=sn & q`1>0 implies sn
-FanMorphE.q= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)), |.q.|* ((q`2/|.q.|-
  sn)/(1-sn))]|)& (q`1<=0 implies sn-FanMorphE.q=q)
proof
  let sn be real number;
  hereby
    assume
    q`2/|.q.|>=sn & q`1>0;
    then
    FanE(sn,q)= |.q.|*|[sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2), (q`2/|.q.|-sn)/
    (1-sn)]| by Def6
      .= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)), |.q.|* ((q`2/|.q.|-sn
    )/(1-sn))]| by EUCLID:62;
    hence sn-FanMorphE.q= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)), |.q.|*
    ((q`2/|.q.|-sn)/(1-sn))]| by Def7;
  end;
  assume
A1: q`1<=0;
  sn-FanMorphE.q=FanE(sn,q) by Def7;
  hence thesis by A1,Def6;
end;

theorem Th90:
  for sn being Real holds (q`2/|.q.|<=sn & q`1>0 implies sn
-FanMorphE.q= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)), |.q.|*((q`2/|.q.|-
  sn)/(1+sn))]|)
proof
  let sn be Real;
  assume that
A1: q`2/|.q.|<=sn and
A2: q`1>0;
  now
    per cases by A1,XXREAL_0:1;
    case
      q`2/|.q.|<sn;
      then
      FanE(sn,q)= |.q.|*|[sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2), (q`2/|.q.|-sn
      )/(1+sn)]| by A2,Def6
        .= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)), |.q.|* ((q`2/|.q.|-
      sn)/(1+sn))]| by EUCLID:62;
      hence thesis by Def7;
    end;
    case
A3:   q`2/|.q.|=sn;
      then (q`2/|.q.|-sn)/(1-sn)=0;
      hence thesis by A2,A3,Th89;
    end;
  end;
  hence thesis;
end;

theorem Th91:
  for sn being Real st -1<sn & sn<1 holds (q`2/|.q.|>=sn & q`1>=0
& q<>0.TOP-REAL 2 implies sn-FanMorphE.q = |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-
  sn))^2)), |.q.|* ((q`2/|.q.|-sn)/(1-sn))]|) & (q`2/|.q.|<=sn & q`1>=0 & q<>0.
TOP-REAL 2 implies sn-FanMorphE.q = |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)
  ), |.q.|*((q`2/|.q.|-sn)/(1+sn))]|)
proof
  let sn be Real;
  assume that
A1: -1<sn and
A2: sn<1;
  per cases;
  suppose
A3: q`2/|.q.|>=sn & q`1>=0 & q<>0.TOP-REAL 2;
    per cases;
    suppose
A4:   q`1>0;
      then
      FanE(sn,q)= |.q.|*|[sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2), (q`2/|.q.|-sn
      )/(1-sn)]| by A3,Def6
        .= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)), |.q.|* ((q`2/|.q.|-
      sn)/(1-sn))]| by EUCLID:62;
      hence thesis by A4,Def7,Th90;
    end;
    suppose
A5:   q`1<=0;
      then
A6:   sn-FanMorphE.q=q by Th89;
A7:   (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
A8:   1-sn>0 by A2,XREAL_1:151;
A9:   q`1=0 by A3,A5;
      |.q.|<>0 by A3,TOPRNS_1:25;
      then |.q.|^2>0 by SQUARE_1:74;
      then (q`2)^2/|.q.|^2=1^2 by A7,A9,XCMPLX_1:60;
      then ((q`2)/|.q.|)^2=1^2 by XCMPLX_1:77;
      then
A10:  sqrt(((q`2)/|.q.|)^2)=1 by SQUARE_1:89;
A11:  now
        assume
        q`2<0;
        then -((q`2)/|.q.|)=1 by A10,SQUARE_1:90;
        hence contradiction by A1,A3;
      end;
      sqrt((|.q.|)^2)=|.q.| by SQUARE_1:89;
      then
A12:  |.q.|=q`2 by A7,A9,A11,SQUARE_1:89;
      then 1=q`2/|.q.| by A3,TOPRNS_1:25,XCMPLX_1:60;
      then (q`2/|.q.|-sn)/(1-sn)=1 by A8,XCMPLX_1:60;
      hence thesis by A2,A6,A9,A12,EUCLID:57,SQUARE_1:82,TOPRNS_1:25 ,
      XCMPLX_1:60;
    end;
  end;
  suppose
A13: q`2/|.q.|<=sn & q`1>=0 & q<>0.TOP-REAL 2;
    per cases;
    suppose
      q`1>0;
      hence thesis by Th89,Th90;
    end;
    suppose
A14:  q`1<=0;
      then
A15:  q`1=0 by A13;
A16:  1+sn>0 by A1,XREAL_1:150;
A17:  |.q.|<>0 by A13,TOPRNS_1:25;
      1>q`2/|.q.| by A2,A13,XXREAL_0:2;
      then 1 *(|.q.|)>q`2/|.q.|*(|.q.|) by A17,XREAL_1:70;
      then
A18:  (|.q.|)^2 =(q`1)^2+(q`2)^2 & (|.q.|)>q`2 by A13,JGRAPH_3:10,
      TOPRNS_1:25 ,XCMPLX_1:88;
      then
A19:  |.q.|=-q`2 by A15,SQUARE_1:109;
A20:  q`2= -(|.q.|) by A15,A18,SQUARE_1:109;
      then -1=q`2/|.q.| by A13,TOPRNS_1:25,XCMPLX_1:198;
      then (q`2/|.q.|-sn)/(1+sn) =(-(1+sn))/(1+sn)
        .=-1 by A16,XCMPLX_1:198;
      then
      |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)), |.q.|* ((q`2/|.q.|-sn
      )/(1+sn))]| =q by A15,A19,EUCLID:57,SQUARE_1:82;
      hence thesis by A1,A14,A17,A20,Th89,XCMPLX_1:198;
    end;
  end;
  suppose
    q`1<0 or q=0.TOP-REAL 2;
    hence thesis;
  end;
end;

theorem Th92:
  for sn being Real,K1 being non empty Subset of TOP-REAL 2, f
being Function of (TOP-REAL 2)|K1,R^1 st sn<1 & (for p being Point of (TOP-REAL
2) st p in the carrier of (TOP-REAL 2)|K1 holds f.p=|.p.|* ((p`2/|.p.|-sn)/(1-
sn))) & (for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)|K1
  holds q`1>=0 & q<>0.TOP-REAL 2) holds f is continuous
proof
  let sn be Real,K1 be non empty Subset of TOP-REAL 2, f be Function of (
  TOP-REAL 2)|K1,R^1;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by
  Lm5;
  set a=sn, b=(1-sn);
  reconsider g2=proj2|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm3;
  assume that
A1: sn<1 and
A2: for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2
  )|K1 holds f.p=|.p.|* ((p`2/|.p.|-sn)/(1-sn)) and
A3: for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)
  |K1 holds q`1>=0 & q<>0.TOP-REAL 2;
  for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)|K1
  holds q<>0.TOP-REAL 2 by A3;
  then
A4: for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm6;
  b>0 by A1,XREAL_1:151;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
A5: for q being Point of (TOP-REAL 2)|K1,r1,r2 being Real st g2.q=r1 &
  g1.q =r2 holds g3.q=r2*((r1/r2-a)/b) and
A6: g3 is continuous by A4,Th10;
A7: dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then
A8: dom f=dom g3 by FUNCT_2:def 1;
  for x being set st x in dom f holds f.x=g3.x
  proof
    let x be set;
    assume
A9: x in dom f;
    then reconsider s=x as Point of (TOP-REAL 2)|K1;
    x in K1 by A7,A8,A9,PRE_TOPC:29;
    then reconsider r=x as Point of (TOP-REAL 2);
A10: proj2.r=r`2 & (2 NormF).r=|.r.| by Def1,PSCOMP_1:def 29;
A11: g2.s=proj2.s & g1.s=(2 NormF).s by Lm3,Lm5;
    f.r=(|.r.|)* ((r`2/|.r.|-sn)/(1-sn)) by A2,A9;
    hence thesis by A5,A11,A10;
  end;
  hence thesis by A6,A8,FUNCT_1:9;
end;

theorem Th93:
  for sn being Real,K1 being non empty Subset of TOP-REAL 2, f
  being Function of (TOP-REAL 2)|K1,R^1 st -1<sn & (for p being Point of (
TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1 holds f.p=|.p.|* ((p`2/|.p.|
  -sn)/(1+sn))) & (for q being Point of TOP-REAL 2 st q in the carrier of (
  TOP-REAL 2)|K1 holds q`1>=0 & q<>0.TOP-REAL 2) holds f is continuous
proof
  let sn be Real,K1 be non empty Subset of TOP-REAL 2, f be Function of (
  TOP-REAL 2)|K1,R^1;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by
  Lm5;
  set a=sn, b=(1+sn);
  reconsider g2=proj2|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm3;
  assume that
A1: -1<sn and
A2: for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2
  )|K1 holds f.p=|.p.|* ((p`2/|.p.|-sn)/(1+sn)) and
A3: for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)
  |K1 holds q`1>=0 & q<>0.TOP-REAL 2;
  for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)|K1
  holds q<>0.TOP-REAL 2 by A3;
  then
A4: for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm6;
  1+sn>0 by A1,XREAL_1:150;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
A5: for q being Point of (TOP-REAL 2)|K1,r1,r2 being Real st g2.q=r1 &
  g1.q =r2 holds g3.q=r2*((r1/r2-a)/b) and
A6: g3 is continuous by A4,Th10;
A7: dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
A8: for x being set st x in dom f holds f.x=g3.x
  proof
    let x be set;
    assume
A9: x in dom f;
    then reconsider s=x as Point of (TOP-REAL 2)|K1;
    x in dom g3 by A7,A9;
    then x in K1 by A7,PRE_TOPC:29;
    then reconsider r=x as Point of (TOP-REAL 2);
A10: proj2.r=r`2 & (2 NormF).r=|.r.| by Def1,PSCOMP_1:def 29;
A11: g2.s=proj2.s & g1.s=(2 NormF).s by Lm3,Lm5;
    f.r=(|.r.|)* ((r`2/|.r.|-sn)/(1+sn)) by A2,A9;
    hence thesis by A5,A11,A10;
  end;
  dom f=dom g3 by A7,FUNCT_2:def 1;
  hence thesis by A6,A8,FUNCT_1:9;
end;

theorem Th94:
  for sn being Real,K1 being non empty Subset of TOP-REAL 2, f
being Function of (TOP-REAL 2)|K1,R^1 st sn<1 & (for p being Point of (TOP-REAL
2) st p in the carrier of (TOP-REAL 2)|K1 holds f.p=|.p.|*(sqrt(1-((p`2/|.p.|-
  sn)/(1-sn))^2))) & (for q being Point of TOP-REAL 2 st q in the carrier of (
  TOP-REAL 2)|K1 holds q`1>=0 & q`2/|.q.|>=sn & q<>0.TOP-REAL 2) holds f is
  continuous
proof
  let sn be Real,K1 be non empty Subset of TOP-REAL 2, f be Function of (
  TOP-REAL 2)|K1,R^1;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by
  Lm5;
  set a=sn, b=(1-sn);
  reconsider g2=proj2|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm3;
  assume that
A1: sn<1 and
A2: for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2
  )|K1 holds f.p=|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)) and
A3: for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)
  |K1 holds q`1>=0 & q`2/|.q.|>=sn & q<>0.TOP-REAL 2;
  for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)|K1
  holds q<>0.TOP-REAL 2 by A3;
  then
A4: for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm6;
  b>0 by A1,XREAL_1:151;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
A5: for q being Point of (TOP-REAL 2)|K1,r1,r2 being real number st g2.q
  =r1 & g1.q=r2 holds g3.q=r2*(sqrt(abs(1-((r1/r2-a)/b)^2))) and
A6: g3 is continuous by A4,Th15;
A7: dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then
A8: dom f=dom g3 by FUNCT_2:def 1;
  for x being set st x in dom f holds f.x=g3.x
  proof
    let x be set;
A9: 1-sn>0 by A1,XREAL_1:151;
    assume
A10: x in dom f;
    then x in K1 by A7,A8,PRE_TOPC:29;
    then reconsider r=x as Point of (TOP-REAL 2);
A11: |.r.|<>0 by A3,A10,TOPRNS_1:25;
    |.r.|^2=(r`1)^2+(r`2)^2 by JGRAPH_3:10;
    then
A12: ((r`2) -(|.r.|))*((r`2)+|.r.|) =-(r`1)^2;
    (r`1)^2>=0 by XREAL_1:65;
    then r`2<= |.r.| by A12,XREAL_1:95;
    then r`2/|.r.| <= |.r.|/|.r.| by XREAL_1:74;
    then r`2/|.r.|<=1 by A11,XCMPLX_1:60;
    then
A13: r`2/|.r.|-sn<=(1-sn) by XREAL_1:11;
    reconsider s=x as Point of (TOP-REAL 2)|K1 by A10;
A14: now
      assume
      (1-sn)^2=0;
      then 1-sn+sn=0+sn by XCMPLX_1:6;
      hence contradiction by A1;
    end;
    sn-r`2/|.r.|<=0 by A3,A10,XREAL_1:49;
    then -(sn- r`2/|.r.|)>=-(1-sn) by A9,XREAL_1:26;
    then (1-sn)^2>=0 & (r`2/|.r.|-sn)^2<=(1-sn)^2 by A13,SQUARE_1:119,
    XREAL_1:65;
    then (r`2/|.r.|-sn)^2/(1-sn)^2<=(1-sn)^2/(1-sn)^2 by XREAL_1:74;
    then (r`2/|.r.|-sn)^2/(1-sn)^2<=1 by A14,XCMPLX_1:60;
    then ((r`2/|.r.|-sn)/(1-sn))^2<=1 by XCMPLX_1:77;
    then 1-((r`2/|.r.|-sn)/(1-sn))^2>=0 by XREAL_1:50;
    then abs(1-((r`2/|.r.|-sn)/(1-sn))^2) =1-((r`2/|.r.|-sn)/(1-sn))^2 by
    ABSVALUE:def 1;
    then
A15: f.r=(|.r.|)*(sqrt(abs(1-((r`2/|.r.|-sn)/(1-sn))^2))) by A2,A10;
A16: proj2.r=r`2 & (2 NormF).r=|.r.| by Def1,PSCOMP_1:def 29;
    g2.s=proj2.s & g1.s=(2 NormF).s by Lm3,Lm5;
    hence thesis by A5,A15,A16;
  end;
  hence thesis by A6,A8,FUNCT_1:9;
end;

theorem Th95:
  for sn being Real,K1 being non empty Subset of TOP-REAL 2, f
  being Function of (TOP-REAL 2)|K1,R^1 st -1<sn & (for p being Point of (
TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1 holds f.p=|.p.|*(sqrt(1-((p
  `2/|.p.|-sn)/(1+sn))^2))) & (for q being Point of TOP-REAL 2 st q in the
  carrier of (TOP-REAL 2)|K1 holds q`1>=0 & q`2/|.q.|<=sn & q<>0.TOP-REAL 2)
  holds f is continuous
proof
  let sn be Real,K1 be non empty Subset of TOP-REAL 2, f be Function of (
  TOP-REAL 2)|K1,R^1;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by
  Lm5;
  set a=sn, b=(1+sn);
  reconsider g2=proj2|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm3;
  assume that
A1: -1<sn and
A2: for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2
  )|K1 holds f.p=|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)) and
A3: for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)
  |K1 holds q`1>=0 & q`2/|.q.|<=sn & q<>0.TOP-REAL 2;
A4: 1+sn>0 by A1,XREAL_1:150;
  for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)|K1
  holds q<>0.TOP-REAL 2 by A3;
  then for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm6;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
A5: for q being Point of (TOP-REAL 2)|K1,r1,r2 being real number st g2.q
  =r1 & g1.q=r2 holds g3.q=r2*(sqrt(abs(1-((r1/r2-a)/b)^2))) and
A6: g3 is continuous by A4,Th15;
A7: dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then
A8: dom f=dom g3 by FUNCT_2:def 1;
  for x being set st x in dom f holds f.x=g3.x
  proof
    let x be set;
    assume
A9: x in dom f;
    then x in K1 by A7,A8,PRE_TOPC:29;
    then reconsider r=x as Point of (TOP-REAL 2);
    reconsider s=x as Point of (TOP-REAL 2)|K1 by A9;
A10: (1+sn)^2>0 by A4,SQUARE_1:74;
A11: |.r.|<>0 by A3,A9,TOPRNS_1:25;
    |.r.|^2=(r`1)^2+(r`2)^2 by JGRAPH_3:10;
    then
A12: ((r`2) -(|.r.|))*((r`2)+|.r.|) =-(r`1)^2;
    (r`1)^2>=0 by XREAL_1:65;
    then -(|.r.|)<=r`2 by A12,XREAL_1:95;
    then r`2/|.r.| >= (-(|.r.|))/|.r.| by XREAL_1:74;
    then r`2/|.r.|>= -1 by A11,XCMPLX_1:198;
    then r`2/|.r.|-sn>=-1-sn by XREAL_1:11;
    then
A13: r`2/|.r.|-sn>=-(1+sn);
    sn-r`2/|.r.|>=0 by A3,A9,XREAL_1:50;
    then -(sn-r`2/|.r.|)<=-0;
    then (r`2/|.r.|-sn)^2<=(1+sn)^2 by A4,A13,SQUARE_1:119;
    then (r`2/|.r.|-sn)^2/(1+sn)^2<=(1+sn)^2/(1+sn)^2 by A4,XREAL_1:74;
    then (r`2/|.r.|-sn)^2/(1+sn)^2<=1 by A10,XCMPLX_1:60;
    then ((r`2/|.r.|-sn)/(1+sn))^2<=1 by XCMPLX_1:77;
    then 1-((r`2/|.r.|-sn)/(1+sn))^2>=0 by XREAL_1:50;
    then abs(1-((r`2/|.r.|-sn)/(1+sn))^2) =1-((r`2/|.r.|-sn)/(1+sn))^2 by
    ABSVALUE:def 1;
    then
A14: f.r=(|.r.|)*(sqrt(abs(1-((r`2/|.r.|-sn)/(1+sn))^2))) by A2,A9;
A15: proj2.r=r`2 & (2 NormF).r=|.r.| by Def1,PSCOMP_1:def 29;
    g2.s=proj2.s & g1.s=(2 NormF).s by Lm3,Lm5;
    hence thesis by A5,A14,A15;
  end;
  hence thesis by A6,A8,FUNCT_1:9;
end;

theorem Th96:
  for sn being Real, K0,B0 being Subset of TOP-REAL 2,f being
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0 st -1<sn & sn<1 & f=(sn-FanMorphE)|
K0 & B0={q where q is Point of TOP-REAL 2: q`1>=0 & q<>0.TOP-REAL 2} & K0={p: p
  `2/|.p.|>=sn & p`1>=0 & p<>0.TOP-REAL 2} holds f is continuous
proof
  let sn be Real,K0,B0 be Subset of TOP-REAL 2,f be Function of (TOP-REAL 2)|
  K0,(TOP-REAL 2)|B0;
  set cn=sqrt(1-sn^2);
  set p0=|[cn,sn]|;
A1: p0`1=cn by EUCLID:56;
  p0`2=sn by EUCLID:56;
  then
A2: |.p0.|=sqrt((cn)^2+sn^2) by A1,JGRAPH_3:10;
  assume
A3: -1<sn & sn<1 & f=(sn-FanMorphE)|K0 & B0={q where q is Point of
  TOP-REAL 2: q`1>=0 & q<>0.TOP-REAL 2} & K0={p: p`2/|.p.|>=sn & p`1>=0 & p<>0.
  TOP-REAL 2};
  then sn^2<1^2 by SQUARE_1:120;
  then
A4: 1-sn^2>0 by XREAL_1:52;
  then
A5: --cn>0 by SQUARE_1:93;
  cn^2=1-sn^2 by A4,SQUARE_1:def 4;
  then p0`2/|.p0.|=sn by A2,EUCLID:56,SQUARE_1:83;
  then
A6: p0 in K0 by A3,A1,A5,JGRAPH_2:11;
  then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
A7: rng (proj1*((sn-FanMorphE)|K1)) c= the carrier of R^1 by TOPMETR:24;
A8: K0 c= B0
  proof
    let x be set;
    assume
    x in K0;
    then
    ex p8 being Point of TOP-REAL 2 st x=p8 & p8`2/|.p8.|>= sn & p8`1>=0 &
    p8<>0.TOP-REAL 2 by A3;
    hence thesis by A3;
  end;
A9: dom ((sn-FanMorphE)|K1) c= dom (proj2*((sn-FanMorphE)|K1))
  proof
    let x be set;
    assume
A10: x in dom ((sn-FanMorphE)|K1);
    then x in dom (sn-FanMorphE) /\ K1 by RELAT_1:90;
    then x in dom (sn-FanMorphE) by XBOOLE_0:def 4;
    then
A11: dom proj2 = (the carrier of TOP-REAL 2) & (sn-FanMorphE).x in rng (sn
    -FanMorphE) by FUNCT_1:12,FUNCT_2:def 1;
    ((sn-FanMorphE)|K1).x=(sn-FanMorphE).x by A10,FUNCT_1:70;
    hence thesis by A10,A11,FUNCT_1:21;
  end;
A12: rng (proj2*((sn-FanMorphE)|K1)) c= the carrier of R^1 by TOPMETR:24;
  dom (proj2*((sn-FanMorphE)|K1)) c= dom ((sn-FanMorphE)|K1) by RELAT_1:
  44;
  then dom (proj2*((sn-FanMorphE)|K1)) =dom ((sn-FanMorphE)|K1) by A9,
  XBOOLE_0:def 10
    .=dom (sn-FanMorphE) /\ K1 by RELAT_1:90
    .=(the carrier of TOP-REAL 2)/\ K1 by FUNCT_2:def 1
    .=K1 by XBOOLE_1:28
    .=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
  then reconsider
  g2=proj2*((sn-FanMorphE)|K1) as Function of (TOP-REAL 2)|K1,R^1
  by A12,FUNCT_2:4;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g2.p=|.p.|* ((p`2/|.p.|-sn)/(1-sn))
  proof
    let p be Point of TOP-REAL 2;
A13: dom ((sn-FanMorphE)|K1)=dom (sn-FanMorphE) /\ K1 by RELAT_1:90
      .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
      .=K1 by XBOOLE_1:28;
A14: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    assume
A15: p in the carrier of (TOP-REAL 2)|K1;
    then
    ex p3 being Point of TOP-REAL 2 st p=p3 & p3`2/|.p3.|>= sn & p3`1>=0 &
    p3<>0.TOP-REAL 2 by A3,A14;
    then
A16: (sn-FanMorphE).p =|[|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)), |.p.|*
    ((p`2/|.p.|-sn)/(1-sn))]| by A3,Th91;
    ((sn-FanMorphE)|K1).p=(sn-FanMorphE).p by A15,A14,FUNCT_1:72;
    then
    g2.p=proj2.(|[|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)), |.p.|* ((p`2
    /|.p.|-sn)/(1-sn))]|) by A15,A13,A14,A16,FUNCT_1:23
      .=(|[|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)), |.p.|* ((p`2/|.p.|-sn)
    /(1-sn))]|)`2 by PSCOMP_1:def 29
      .=|.p.|* ((p`2/|.p.|-sn)/(1-sn)) by EUCLID:56;
    hence thesis;
  end;
  then consider f2 being Function of (TOP-REAL 2)|K1,R^1 such that
A17: for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)
  |K1 holds f2.p=|.p.|* ((p`2/|.p.|-sn)/(1-sn));
A18: dom ((sn-FanMorphE)|K1) c= dom (proj1*((sn-FanMorphE)|K1))
  proof
    let x be set;
    assume
A19: x in dom ((sn-FanMorphE)|K1);
    then x in dom (sn-FanMorphE) /\ K1 by RELAT_1:90;
    then x in dom (sn-FanMorphE) by XBOOLE_0:def 4;
    then
A20: dom proj1 = (the carrier of TOP-REAL 2) & (sn-FanMorphE).x in rng (sn
    -FanMorphE) by FUNCT_1:12,FUNCT_2:def 1;
    ((sn-FanMorphE)|K1).x=(sn-FanMorphE).x by A19,FUNCT_1:70;
    hence thesis by A19,A20,FUNCT_1:21;
  end;
  dom (proj1*((sn-FanMorphE)|K1)) c= dom ((sn-FanMorphE)|K1) by RELAT_1:
  44;
  then dom (proj1*((sn-FanMorphE)|K1)) =dom ((sn-FanMorphE)|K1) by A18,
  XBOOLE_0:def 10
    .=dom (sn-FanMorphE) /\ K1 by RELAT_1:90
    .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
    .=K1 by XBOOLE_1:28
    .=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
  then reconsider
  g1=proj1*((sn-FanMorphE)|K1) as Function of (TOP-REAL 2)|K1,R^1
  by A7,FUNCT_2:4;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g1.p=|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2))
  proof
    let p be Point of TOP-REAL 2;
A21: dom ((sn-FanMorphE)|K1)=dom (sn-FanMorphE) /\ K1 by RELAT_1:90
      .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
      .=K1 by XBOOLE_1:28;
A22: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    assume
A23: p in the carrier of (TOP-REAL 2)|K1;
    then
    ex p3 being Point of TOP-REAL 2 st p=p3 & p3`2/|.p3.|>= sn & p3`1>=0 &
    p3<>0.TOP-REAL 2 by A3,A22;
    then
A24: (sn-FanMorphE).p=|[|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)), |.p.|*
    ((p`2/|.p.|-sn)/(1-sn))]| by A3,Th91;
    ((sn-FanMorphE)|K1).p=(sn-FanMorphE).p by A23,A22,FUNCT_1:72;
    then
    g1.p=proj1.(|[|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)), |.p.|* ((p`2
    /|.p.|-sn)/(1-sn))]|) by A23,A21,A22,A24,FUNCT_1:23
      .=(|[|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)), |.p.|* ((p`2/|.p.|-sn)
    /(1-sn)) ]|)`1 by PSCOMP_1:def 28
      .= |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)) by EUCLID:56;
    hence thesis;
  end;
  then consider f1 being Function of (TOP-REAL 2)|K1,R^1 such that
A25: for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)
  |K1 holds f1.p=|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2));
  for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)|K1
  holds q`1>=0 & q`2/|.q.|>=sn & q<>0.TOP-REAL 2
  proof
    let q be Point of TOP-REAL 2;
A26: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    assume
    q in the carrier of (TOP-REAL 2)|K1;
    then
    ex p3 being Point of TOP-REAL 2 st q=p3 & p3`2/|.p3.|>= sn & p3`1>=0 &
    p3<>0.TOP-REAL 2 by A3,A26;
    hence thesis;
  end;
  then
A27: f1 is continuous by A3,A25,Th94;
A28: for x,y,r,s being real number st |[x,y]| in K1 & r=f1.(|[x,y]|) & s=f2.
  (|[x,y]|) holds f.(|[x,y]|)=|[r,s]|
  proof
    let x,y,r,s be real number;
    assume that
A29: |[x,y]| in K1 and
A30: r=f1.(|[x,y]|) & s=f2.(|[x,y]|);
    set p99=|[x,y]|;
A31: ex p3 being Point of TOP-REAL 2 st p99=p3 & p3`2/|.p3.| >=sn & p3`1>=0
    & p3<>0.TOP-REAL 2 by A3,A29;
A32: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then
A33: f1.p99=|.p99.|*(sqrt(1-((p99`2/|.p99.|-sn)/(1-sn))^2)) by A25,A29;
    ((sn-FanMorphE)|K0).(|[x,y]|)=((sn-FanMorphE)).(|[x,y]|) by A29,
    FUNCT_1:72
      .= |[|.p99.|*(sqrt(1-((p99`2/|.p99.|-sn)/(1-sn))^2)), |.p99.|* ((p99`2
    /|.p99.|-sn)/(1-sn))]| by A3,A31,Th91
      .=|[r,s]| by A17,A29,A30,A32,A33;
    hence thesis by A3;
  end;
  for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)|K1
  holds q`1>=0 & q<>0.TOP-REAL 2
  proof
    let q be Point of TOP-REAL 2;
A34: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    assume
    q in the carrier of (TOP-REAL 2)|K1;
    then
    ex p3 being Point of TOP-REAL 2 st q=p3 & p3`2/|.p3.|>= sn & p3`1>=0 &
    p3<>0.TOP-REAL 2 by A3,A34;
    hence thesis;
  end;
  then f2 is continuous by A3,A17,Th92;
  hence thesis by A6,A8,A27,A28,JGRAPH_2:45;
end;

theorem Th97:
  for sn being Real, K0,B0 being Subset of TOP-REAL 2,f being
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0 st -1<sn & sn<1 & f=(sn-FanMorphE)|
K0 & B0={q where q is Point of TOP-REAL 2: q`1>=0 & q<>0.TOP-REAL 2} & K0={p: p
  `2/|.p.|<=sn & p`1>=0 & p<>0.TOP-REAL 2} holds f is continuous
proof
  let sn be Real,K0,B0 be Subset of TOP-REAL 2,f be Function of (TOP-REAL 2)|
  K0,(TOP-REAL 2)|B0;
  set cn=sqrt(1-sn^2);
  set p0=|[cn,sn]|;
A1: p0`1=cn by EUCLID:56;
  p0`2=sn by EUCLID:56;
  then
A2: |.p0.|=sqrt((cn)^2+sn^2) by A1,JGRAPH_3:10;
  assume
A3: -1<sn & sn<1 & f=(sn-FanMorphE)|K0 & B0={q where q is Point of
  TOP-REAL 2: q`1>=0 & q<>0.TOP-REAL 2} & K0={p: p`2/|.p.|<=sn & p`1>=0 & p<>0.
  TOP-REAL 2};
  then sn^2<1^2 by SQUARE_1:120;
  then
A4: 1-sn^2>0 by XREAL_1:52;
  then
A5: --cn>0 by SQUARE_1:93;
  cn^2=1-sn^2 by A4,SQUARE_1:def 4;
  then p0`2/|.p0.|=sn by A2,EUCLID:56,SQUARE_1:83;
  then
A6: p0 in K0 by A3,A1,A5,JGRAPH_2:11;
  then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
A7: rng (proj1*((sn-FanMorphE)|K1)) c= the carrier of R^1 by TOPMETR:24;
A8: K0 c= B0
  proof
    let x be set;
    assume
    x in K0;
    then
    ex p8 being Point of TOP-REAL 2 st x=p8 & p8`2/|.p8.|<= sn & p8`1>=0 &
    p8<>0.TOP-REAL 2 by A3;
    hence thesis by A3;
  end;
A9: dom ((sn-FanMorphE)|K1) c= dom (proj2*((sn-FanMorphE)|K1))
  proof
    let x be set;
    assume
A10: x in dom ((sn-FanMorphE)|K1);
    then x in dom (sn-FanMorphE) /\ K1 by RELAT_1:90;
    then x in dom (sn-FanMorphE) by XBOOLE_0:def 4;
    then
A11: dom proj2 = (the carrier of TOP-REAL 2) & (sn-FanMorphE).x in rng (sn
    -FanMorphE) by FUNCT_1:12,FUNCT_2:def 1;
    ((sn-FanMorphE)|K1).x=(sn-FanMorphE).x by A10,FUNCT_1:70;
    hence thesis by A10,A11,FUNCT_1:21;
  end;
A12: rng (proj2*((sn-FanMorphE)|K1)) c= the carrier of R^1 by TOPMETR:24;
  dom (proj2*((sn-FanMorphE)|K1)) c= dom ((sn-FanMorphE)|K1) by RELAT_1:
  44;
  then dom (proj2*((sn-FanMorphE)|K1)) =dom ((sn-FanMorphE)|K1) by A9,
  XBOOLE_0:def 10
    .=dom (sn-FanMorphE) /\ K1 by RELAT_1:90
    .=(the carrier of TOP-REAL 2)/\ K1 by FUNCT_2:def 1
    .=K1 by XBOOLE_1:28
    .=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
  then reconsider
  g2=proj2*((sn-FanMorphE)|K1) as Function of (TOP-REAL 2)|K1,R^1
  by A12,FUNCT_2:4;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g2.p=|.p.|* ((p`2/|.p.|-sn)/(1+sn))
  proof
    let p be Point of TOP-REAL 2;
A13: dom ((sn-FanMorphE)|K1)=dom (sn-FanMorphE) /\ K1 by RELAT_1:90
      .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
      .=K1 by XBOOLE_1:28;
A14: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    assume
A15: p in the carrier of (TOP-REAL 2)|K1;
    then
    ex p3 being Point of TOP-REAL 2 st p=p3 & p3`2/|.p3.|<= sn & p3`1>=0 &
    p3<>0.TOP-REAL 2 by A3,A14;
    then
A16: (sn-FanMorphE).p =|[|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)), |.p.|*
    ((p`2/|.p.|-sn)/(1+sn))]| by A3,Th91;
    ((sn-FanMorphE)|K1).p=(sn-FanMorphE).p by A15,A14,FUNCT_1:72;
    then
    g2.p=proj2.(|[|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)), |.p.|* ((p`2
    /|.p.|-sn)/(1+sn))]|) by A15,A13,A14,A16,FUNCT_1:23
      .=(|[|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)), |.p.|* ((p`2/|.p.|-sn)
    /(1+sn))]|)`2 by PSCOMP_1:def 29
      .=|.p.|* ((p`2/|.p.|-sn)/(1+sn)) by EUCLID:56;
    hence thesis;
  end;
  then consider f2 being Function of (TOP-REAL 2)|K1,R^1 such that
A17: for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)
  |K1 holds f2.p=|.p.|* ((p`2/|.p.|-sn)/(1+sn));
A18: dom ((sn-FanMorphE)|K1) c= dom (proj1*((sn-FanMorphE)|K1))
  proof
    let x be set;
    assume
A19: x in dom ((sn-FanMorphE)|K1);
    then x in dom (sn-FanMorphE) /\ K1 by RELAT_1:90;
    then x in dom (sn-FanMorphE) by XBOOLE_0:def 4;
    then
A20: dom proj1 = (the carrier of TOP-REAL 2) & (sn-FanMorphE).x in rng (sn
    -FanMorphE) by FUNCT_1:12,FUNCT_2:def 1;
    ((sn-FanMorphE)|K1).x=(sn-FanMorphE).x by A19,FUNCT_1:70;
    hence thesis by A19,A20,FUNCT_1:21;
  end;
  dom (proj1*((sn-FanMorphE)|K1)) c= dom ((sn-FanMorphE)|K1) by RELAT_1:
  44;
  then dom (proj1*((sn-FanMorphE)|K1)) =dom ((sn-FanMorphE)|K1) by A18,
  XBOOLE_0:def 10
    .=dom (sn-FanMorphE) /\ K1 by RELAT_1:90
    .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
    .=K1 by XBOOLE_1:28
    .=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
  then reconsider
  g1=proj1*((sn-FanMorphE)|K1) as Function of (TOP-REAL 2)|K1,R^1
  by A7,FUNCT_2:4;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g1.p=|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2))
  proof
    let p be Point of TOP-REAL 2;
A21: dom ((sn-FanMorphE)|K1)=dom (sn-FanMorphE) /\ K1 by RELAT_1:90
      .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
      .=K1 by XBOOLE_1:28;
A22: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    assume
A23: p in the carrier of (TOP-REAL 2)|K1;
    then
    ex p3 being Point of TOP-REAL 2 st p=p3 & p3`2/|.p3.|<= sn & p3`1>=0 &
    p3<>0.TOP-REAL 2 by A3,A22;
    then
A24: (sn-FanMorphE).p=|[|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)), |.p.|*
    ((p`2/|.p.|-sn)/(1+sn))]| by A3,Th91;
    ((sn-FanMorphE)|K1).p=(sn-FanMorphE).p by A23,A22,FUNCT_1:72;
    then
    g1.p=proj1.(|[|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)), |.p.|* ((p`2
    /|.p.|-sn)/(1+sn))]|) by A23,A21,A22,A24,FUNCT_1:23
      .=(|[|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)), |.p.|* ((p`2/|.p.|-sn)
    /(1+sn)) ]|)`1 by PSCOMP_1:def 28
      .= |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)) by EUCLID:56;
    hence thesis;
  end;
  then consider f1 being Function of (TOP-REAL 2)|K1,R^1 such that
A25: for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)
  |K1 holds f1.p=|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2));
  for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)|K1
  holds q`1>=0 & q`2/|.q.|<=sn & q<>0.TOP-REAL 2
  proof
    let q be Point of TOP-REAL 2;
A26: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    assume
    q in the carrier of (TOP-REAL 2)|K1;
    then
    ex p3 being Point of TOP-REAL 2 st q=p3 & p3`2/|.p3.|<= sn & p3`1>=0 &
    p3<>0.TOP-REAL 2 by A3,A26;
    hence thesis;
  end;
  then
A27: f1 is continuous by A3,A25,Th95;
A28: for x,y,r,s being real number st |[x,y]| in K1 & r=f1.(|[x,y]|) & s=f2.
  (|[x,y]|) holds f.(|[x,y]|)=|[r,s]|
  proof
    let x,y,r,s be real number;
    assume that
A29: |[x,y]| in K1 and
A30: r=f1.(|[x,y]|) & s=f2.(|[x,y]|);
    set p99=|[x,y]|;
A31: ex p3 being Point of TOP-REAL 2 st p99=p3 & p3`2/|.p3.| <=sn & p3`1>=0
    & p3<>0.TOP-REAL 2 by A3,A29;
A32: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then
A33: f1.p99=|.p99.|*(sqrt(1-((p99`2/|.p99.|-sn)/(1+sn))^2)) by A25,A29;
    ((sn-FanMorphE)|K0).(|[x,y]|)=((sn-FanMorphE)).(|[x,y]|) by A29,
    FUNCT_1:72
      .= |[|.p99.|*(sqrt(1-((p99`2/|.p99.|-sn)/(1+sn))^2)), |.p99.|* ((p99`2
    /|.p99.|-sn)/(1+sn))]| by A3,A31,Th91
      .=|[r,s]| by A17,A29,A30,A32,A33;
    hence thesis by A3;
  end;
  for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)|K1
  holds q`1>=0 & q<>0.TOP-REAL 2
  proof
    let q be Point of TOP-REAL 2;
A34: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    assume
    q in the carrier of (TOP-REAL 2)|K1;
    then
    ex p3 being Point of TOP-REAL 2 st q=p3 & p3`2/|.p3.|<= sn & p3`1>=0 &
    p3<>0.TOP-REAL 2 by A3,A34;
    hence thesis;
  end;
  then f2 is continuous by A3,A17,Th93;
  hence thesis by A6,A8,A27,A28,JGRAPH_2:45;
end;

theorem Th98:
  for sn being Real, K03 being Subset of TOP-REAL 2 st K03={p: p`2
  >=(sn)*(|.p.|) & p`1>=0} holds K03 is closed
proof
  defpred Q[Point of TOP-REAL 2] means $1`1>=0;
  let sn be Real, K003 be Subset of TOP-REAL 2;
  assume
A1: K003={p: p`2>=(sn)*(|.p.|) & p`1>=0};
  reconsider KX={p where p is Point of TOP-REAL 2: Q[p]} as Subset of TOP-REAL
  2 from JGRAPH_2:sch 1;
  defpred P[Point of TOP-REAL 2] means ($1`2>=sn*|.$1.|);
  reconsider K1={p7 where p7 is Point of TOP-REAL 2:P[p7]} as Subset of
  TOP-REAL 2 from JGRAPH_2:sch 1;
A2: {p : P[p] & Q[p]} = {p7 where p7 is Point of TOP-REAL 2:P[p7]} /\ {p1
  where p1 is Point of TOP-REAL 2: Q[p1]} from DOMAIN_1:sch 10;
  K1 is closed & KX is closed by Lm7,JORDAN6:5;
  hence thesis by A1,A2,TOPS_1:35;
end;

theorem Th99:
  for sn being Real, K03 being Subset of TOP-REAL 2 st K03={p: p`2
  <=(sn)*(|.p.|) & p`1>=0} holds K03 is closed
proof
  defpred Q[Point of TOP-REAL 2] means $1`1>=0;
  let sn be Real, K003 be Subset of TOP-REAL 2;
  assume
A1: K003={p: p`2<=(sn)*(|.p.|) & p`1>=0};
  reconsider KX={p where p is Point of TOP-REAL 2: Q[p]} as Subset of TOP-REAL
  2 from JGRAPH_2:sch 1;
  defpred P[Point of TOP-REAL 2] means ($1`2<=sn*|.$1.|);
  reconsider K1={p7 where p7 is Point of TOP-REAL 2:P[p7]} as Subset of
  TOP-REAL 2 from JGRAPH_2:sch 1;
A2: {p : P[p] & Q[p]} = {p7 where p7 is Point of TOP-REAL 2:P[p7]} /\ {p1
  where p1 is Point of TOP-REAL 2: Q[p1]} from DOMAIN_1:sch 10;
  K1 is closed & KX is closed by Lm9,JORDAN6:5;
  hence thesis by A1,A2,TOPS_1:35;
end;

theorem Th100:
  for sn being Real, K0,B0 being Subset of TOP-REAL 2,f being
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0 st -1<sn & sn<1 & f=(sn-FanMorphE)|
  K0 & B0=NonZero TOP-REAL 2 & K0={p: p`1>=0 & p<>0.TOP-REAL 2} holds f is
  continuous
proof
  let sn be Real,K0,B0 be Subset of TOP-REAL 2,f be Function of (TOP-REAL 2)|
  K0,(TOP-REAL 2)|B0;
  set cn=sqrt(1-sn^2);
  set p0=|[cn,sn]|;
A1: p0`1=cn by EUCLID:56;
  defpred P[Point of TOP-REAL 2] means $1`2/|.$1.|>=sn & $1`1>=0 & $1<>0.
  TOP-REAL 2;
  p0`2=sn by EUCLID:56;
  then
A2: |.p0.|=sqrt((cn)^2+sn^2) by A1,JGRAPH_3:10;
  assume
A3: -1<sn & sn<1 & f=(sn-FanMorphE)|K0 & B0= NonZero TOP-REAL 2 & K0={p:
  p`1>=0 & p<>0.TOP-REAL 2};
  then sn^2<1^2 by SQUARE_1:120;
  then
A4: 1-sn^2>0 by XREAL_1:52;
  then
A5: p0`1>0 by A1,SQUARE_1:93;
  then p0 in K0 by A3,JGRAPH_2:11;
  then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
  cn^2=1-sn^2 by A4,SQUARE_1:def 4;
  then
A6: p0`2/|.p0.|=sn by A2,EUCLID:56,SQUARE_1:83;
  then
A7: p0 in {p: p`2/|.p.|>=sn & p`1>=0 & p<>0.TOP-REAL 2} by A5,
  JGRAPH_2:
  11;
  {p: P[p]} is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
  then reconsider
  K001={p: p`2/|.p.|>=sn & p`1>=0 & p<>0.TOP-REAL 2} as non empty
  Subset of (TOP-REAL 2) by A7;
A8: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
  defpred P[Point of TOP-REAL 2] means $1`2>=(sn)*(|.$1.|) & $1`1>=0;
  {p: P[p]} is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
  then reconsider
  K003={p: p`2>=(sn)*(|.p.|) & p`1>=0} as Subset of (TOP-REAL 2);
  defpred P[Point of TOP-REAL 2] means $1`2/|.$1.|<=sn & $1`1>=0 & $1<>0.
  TOP-REAL 2;
A9: {p: P[p]} is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
A10: --cn>0 by A4,SQUARE_1:93;
  then p0 in {p: p`2/|.p.|<=sn & p`1>=0 & p<>0.TOP-REAL 2} by A1,A6,
  JGRAPH_2:11;
  then reconsider
  K111={p: p`2/|.p.|<=sn & p`1>=0 & p<>0.TOP-REAL 2} as non empty
  Subset of (TOP-REAL 2) by A9;
A11: [#]((TOP-REAL 2)|K1)=K1 by PRE_TOPC:def 10;
A12: rng ((sn-FanMorphE)|K001) c= K1
  proof
    let y be set;
    assume
    y in rng ((sn-FanMorphE)|K001);
    then consider x being set such that
A13: x in dom ((sn-FanMorphE)|K001) and
A14: y=((sn-FanMorphE)|K001).x by FUNCT_1:def 5;
    reconsider q=x as Point of TOP-REAL 2 by A13;
A15: y=(sn-FanMorphE).q by A13,A14,FUNCT_1:70;
    dom ((sn-FanMorphE)|K001)=(dom (sn-FanMorphE))/\ K001 by RELAT_1:90
      .=(the carrier of TOP-REAL 2)/\ K001 by FUNCT_2:def 1
      .=K001 by XBOOLE_1:28;
    then
A16: ex p2 being Point of TOP-REAL 2 st p2=q & p2`2/|.p2.|>= sn & p2`1>=0 &
    p2<>0.TOP-REAL 2 by A13;
    then
A17: (q`2/|.q.|-sn)>= 0 by XREAL_1:50;
    |.q.|<>0 by A16,TOPRNS_1:25;
    then
A18: (|.q.|)^2>0^2 by SQUARE_1:74;
    set q4= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)), |.q.|* ((q`2/|.q.|-
    sn)/(1-sn))]|;
A19: q4`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by EUCLID:56;
A20: 1-sn>0 by A3,XREAL_1:151;
    0<=(q`1)^2 by XREAL_1:65;
    then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
    then (q`2)^2 <= (|.q.|)^2 by JGRAPH_3:10;
    then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by XREAL_1:74;
    then (q`2)^2/(|.q.|)^2 <= 1 by A18,XCMPLX_1:60;
    then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
    then 1>=q`2/|.q.| by SQUARE_1:121;
    then 1-sn>=q`2/|.q.|-sn by XREAL_1:11;
    then -(1-sn)<= -( q`2/|.q.|-sn) by XREAL_1:26;
    then (-(1-sn))/(1-sn)<=(-( q`2/|.q.|-sn))/(1-sn) by A20,XREAL_1:74;
    then -1<=(-( q`2/|.q.|-sn))/(1-sn) by A20,XCMPLX_1:198;
    then ((-(q`2/|.q.|-sn))/(1-sn))^2<=1^2 by A20,A17,SQUARE_1:119;
    then
A21: 1-((-(q`2/|.q.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
    then
A22: 1-(-((q`2/|.q.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
    sqrt(1-((-(q`2/|.q.|-sn))/(1-sn))^2)>=0 by A21,SQUARE_1:def 4;
    then sqrt(1-(-(q`2/|.q.|-sn))^2/(1-sn)^2)>=0 by XCMPLX_1:77;
    then sqrt(1-(q`2/|.q.|-sn)^2/(1-sn)^2)>=0;
    then
A23: sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)>=0 by XCMPLX_1:77;
A24: q4`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)) by EUCLID:56;
    then
A25: (q4`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))^2
      .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1-sn))^2) by A22,SQUARE_1:def 4;
    (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
      .=(|.q.|)^2 by A19,A25;
    then
A26: q4<>0.TOP-REAL 2 by A18,TOPRNS_1:24;
    sn-FanMorphE.q= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)), |.q.|*
    ((q`2/|.q.|-sn)/(1-sn))]| by A3,A16,Th91;
    hence thesis by A3,A15,A24,A23,A26;
  end;
A27: {p: p`2/|.p.|<=sn & p`1>=0 & p<>0.TOP-REAL 2} c= K1
  proof
    let x be set;
    assume
    x in {p: p`2/|.p.|<=sn & p`1>=0 & p<>0.TOP-REAL 2};
    then ex p st p=x & p`2/|.p.|<=sn & p`1>=0 & p<>0.TOP-REAL 2;
    hence thesis by A3;
  end;
  p0<>0.TOP-REAL 2 by A1,A4,JGRAPH_2:11,SQUARE_1:93;
  then not p0 in {0.TOP-REAL 2} by TARSKI:def 1;
  then reconsider D=B0 as non empty Subset of TOP-REAL 2 by A3,XBOOLE_0:def 5;
  K1 c= D
  proof
    let x be set;
    assume
A28: x in K1;
    then ex p6 being Point of TOP-REAL 2 st p6=x & p6`1>=0 & p6 <>0.TOP-REAL 2
    by A3;
    then not x in {0.TOP-REAL 2} by TARSKI:def 1;
    hence thesis by A3,A28,XBOOLE_0:def 5;
  end;
  then D=K1 \/ D by XBOOLE_1:12;
  then
A29: (TOP-REAL 2)|K1 is SubSpace of (TOP-REAL 2)|D by TOPMETR:5;
A30: {p: p`2/|.p.|>=sn & p`1>=0 & p<>0.TOP-REAL 2} c= K1
  proof
    let x be set;
    assume
    x in {p: p`2/|.p.|>=sn & p`1>=0 & p<>0.TOP-REAL 2};
    then ex p st p=x & p`2/|.p.|>=sn & p`1>=0 & p<>0.TOP-REAL 2;
    hence thesis by A3;
  end;
  then reconsider
  K00={p: p`2/|.p.|>=sn & p`1>=0 & p<>0.TOP-REAL 2} as non empty
  Subset of ((TOP-REAL 2)|K1) by A7,PRE_TOPC:29;
A31: K003 is closed by Th98;
A32: rng ((sn-FanMorphE)|K111) c= K1
  proof
    let y be set;
    assume
    y in rng ((sn-FanMorphE)|K111);
    then consider x being set such that
A33: x in dom ((sn-FanMorphE)|K111) and
A34: y=((sn-FanMorphE)|K111).x by FUNCT_1:def 5;
    reconsider q=x as Point of TOP-REAL 2 by A33;
A35: y=(sn-FanMorphE).q by A33,A34,FUNCT_1:70;
    dom ((sn-FanMorphE)|K111)=(dom (sn-FanMorphE))/\ K111 by RELAT_1:90
      .=(the carrier of TOP-REAL 2)/\ K111 by FUNCT_2:def 1
      .=K111 by XBOOLE_1:28;
    then
A36: ex p2 being Point of TOP-REAL 2 st p2=q & p2`2/|.p2.|<= sn & p2`1>=0 &
    p2<>0.TOP-REAL 2 by A33;
    then
A37: (q`2/|.q.|-sn)<=0 by XREAL_1:49;
    |.q.|<>0 by A36,TOPRNS_1:25;
    then
A38: (|.q.|)^2>0^2 by SQUARE_1:74;
    set q4= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)), |.q.|* ((q`2/|.q.|-
    sn)/(1+sn))]|;
A39: q4`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by EUCLID:56;
A40: 1+sn>0 by A3,XREAL_1:150;
    0<=(q`1)^2 by XREAL_1:65;
    then (|.q.|)^2 =(q`1)^2+(q`2)^2 & 0+(q`2)^2<=(q`1)^2+(q`2)^2 by
    JGRAPH_3:10 ,XREAL_1:9;
    then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by XREAL_1:74;
    then (q`2)^2/(|.q.|)^2 <= 1 by A38,XCMPLX_1:60;
    then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
    then -1<=q`2/|.q.| by SQUARE_1:121;
    then -1-sn<=q`2/|.q.|-sn by XREAL_1:11;
    then (-(1+sn))/(1+sn)<=(( q`2/|.q.|-sn))/(1+sn) by A40,XREAL_1:74;
    then -1<=(( q`2/|.q.|-sn))/(1+sn) by A40,XCMPLX_1:198;
    then
A41: ( (q`2/|.q.|-sn) /(1+sn))^2<=1^2 by A40,A37,SQUARE_1:119;
    then
A42: 1-((q`2/|.q.|-sn)/(1+sn))^2>=0 by XREAL_1:50;
    1-(-((q`2/|.q.|-sn)/(1+sn)))^2>=0 by A41,XREAL_1:50;
    then 1-((-(q`2/|.q.|-sn))/(1+sn))^2>=0 by XCMPLX_1:188;
    then sqrt(1-((-(q`2/|.q.|-sn))/(1+sn))^2)>=0 by SQUARE_1:def 4;
    then sqrt(1-(-(q`2/|.q.|-sn))^2/(1+sn)^2)>=0 by XCMPLX_1:77;
    then sqrt(1-(q`2/|.q.|-sn)^2/(1+sn)^2)>=0;
    then
A43: sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)>=0 by XCMPLX_1:77;
A44: q4`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)) by EUCLID:56;
    then
A45: (q4`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))^2
      .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1+sn))^2) by A42,SQUARE_1:def 4;
    (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
      .=(|.q.|)^2 by A39,A45;
    then
A46: q4<>0.TOP-REAL 2 by A38,TOPRNS_1:24;
    sn-FanMorphE.q= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)), |.q.|*
    ((q`2/|.q.|-sn)/(1+sn))]| by A3,A36,Th91;
    hence thesis by A3,A35,A44,A43,A46;
  end;
  the carrier of (TOP-REAL 2)|D=D by PRE_TOPC:29;
  then
A47: rng (f|K00) c=D;
  the carrier of (TOP-REAL 2)|B0=the carrier of (TOP-REAL 2)|D;
  then
A48: dom f=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1
    .=K1 by PRE_TOPC:29;
  then dom (f|K00)=K00 by A30,RELAT_1:91
    .= the carrier of ((TOP-REAL 2)|K1)|K00 by PRE_TOPC:29;
  then reconsider
  f1=f|K00 as Function of ((TOP-REAL 2)|K1)|K00,(TOP-REAL 2)|D by
  A47,FUNCT_2:4;
A49: the carrier of ((TOP-REAL 2)|K1)=K0 by PRE_TOPC:29;
  p0 in {p: p`2/|.p.|<=sn & p`1>=0 & p<>0.TOP-REAL 2} by A1,A10,A6,
  JGRAPH_2:11;
  then reconsider
  K11={p: p`2/|.p.|<=sn & p`1>=0 & p<>0.TOP-REAL 2} as non empty
  Subset of ((TOP-REAL 2)|K1) by A27,PRE_TOPC:29;
A50: the carrier of (TOP-REAL 2)|K1 =K1 by PRE_TOPC:29;
A51: dom (sn-FanMorphE)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
  then dom ((sn-FanMorphE)|K001)=K001 by RELAT_1:91
    .= the carrier of (TOP-REAL 2)|K001 by PRE_TOPC:29;
  then reconsider
  f3=(sn-FanMorphE)|K001 as Function of (TOP-REAL 2)|K001,(TOP-REAL
  2)|K1 by A8,A12,FUNCT_2:4;
A52: D<>{};
  dom ((sn-FanMorphE)|K111)=K111 by A51,RELAT_1:91
    .= the carrier of (TOP-REAL 2)|K111 by PRE_TOPC:29;
  then reconsider
  f4=(sn-FanMorphE)|K111 as Function of (TOP-REAL 2)|K111,(TOP-REAL
  2)|K1 by A50,A32,FUNCT_2:4;
  the carrier of (TOP-REAL 2)|D =D by PRE_TOPC:29;
  then
A53: rng (f|K11) c=D;
  dom (f|K11)=K11 by A27,A48,RELAT_1:91
    .= the carrier of ((TOP-REAL 2)|K1)|K11 by PRE_TOPC:29;
  then reconsider
  f2=f|K11 as Function of ((TOP-REAL 2)|K1)|K11,(TOP-REAL 2)|D by
  A53,FUNCT_2:4;
  the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
  then ((TOP-REAL 2)|K1)|K11=(TOP-REAL 2)|K111 & f2= f4 by A3,FUNCT_1:82
  ,GOBOARD9:4;
  then
A54: f2 is continuous by A3,A29,Th97,PRE_TOPC:56;
  the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
  then ((TOP-REAL 2)|K1)|K00=(TOP-REAL 2)|K001 & f1= f3 by A3,FUNCT_1:82
  ,GOBOARD9:4;
  then
A55: f1 is continuous by A3,A29,Th96,PRE_TOPC:56;
A56: dom f2=the carrier of ((TOP-REAL 2)|K1)|K11 by FUNCT_2:def 1
    .=K11 by PRE_TOPC:29;
  defpred P[Point of TOP-REAL 2] means $1`2<=(sn)*(|.$1.|) & $1`1>=0;
  {p: P[p]} is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
  then reconsider
  K004={p: p`2<=(sn)*(|.p.|) & p`1>=0} as Subset of (TOP-REAL 2);
A57: K004 /\ K1 c= K11
  proof
    let x be set;
    assume
A58: x in K004 /\ K1;
    then x in K004 by XBOOLE_0:def 4;
    then consider q1 being Point of TOP-REAL 2 such that
A59: q1=x and
A60: q1`2<=(sn)*(|.q1.|) and
    q1`1>=0;
    x in K1 by A58,XBOOLE_0:def 4;
    then
A61: ex q2 being Point of TOP-REAL 2 st q2=x & q2`1>=0 & q2 <>0.TOP-REAL 2
    by A3;
    q1`2/|.q1.|<=(sn)*(|.q1.|)/|.q1.| by A60,XREAL_1:74;
    then q1`2/|.q1.|<=(sn) by A59,A61,TOPRNS_1:25,XCMPLX_1:90;
    hence thesis by A59,A61;
  end;
A62: K004 is closed by Th99;
  K11 c= K004 /\ K1
  proof
    let x be set;
    assume
    x in K11;
    then consider p such that
A63: p=x and
A64: p`2/|.p.|<=sn and
A65: p`1>=0 and
A66: p<>0.TOP-REAL 2;
    p`2/|.p.|*|.p.|<=(sn)*(|.p.|) by A64,XREAL_1:66;
    then p`2<=(sn)*(|.p.|) by A66,TOPRNS_1:25,XCMPLX_1:88;
    then
A67: x in K004 by A63,A65;
    x in K1 by A3,A63,A65,A66;
    hence thesis by A67,XBOOLE_0:def 4;
  end;
  then K11=K004 /\ [#]((TOP-REAL 2)|K1) by A11,A57,XBOOLE_0:def 10;
  then
A68: K11 is closed by A62,PRE_TOPC:43;
A69: K003 /\ K1 c= K00
  proof
    let x be set;
    assume
A70: x in K003 /\ K1;
    then x in K003 by XBOOLE_0:def 4;
    then consider q1 being Point of TOP-REAL 2 such that
A71: q1=x and
A72: q1`2>=(sn)*(|.q1.|) and
    q1`1>=0;
    x in K1 by A70,XBOOLE_0:def 4;
    then
A73: ex q2 being Point of TOP-REAL 2 st q2=x & q2`1>=0 & q2 <>0.TOP-REAL 2
    by A3;
    q1`2/|.q1.|>=(sn)*(|.q1.|)/|.q1.| by A72,XREAL_1:74;
    then q1`2/|.q1.|>=(sn) by A71,A73,TOPRNS_1:25,XCMPLX_1:90;
    hence thesis by A71,A73;
  end;
  K00 c= K003 /\ K1
  proof
    let x be set;
    assume
    x in K00;
    then consider p such that
A74: p=x and
A75: p`2/|.p.|>=sn and
A76: p`1>=0 and
A77: p<>0.TOP-REAL 2;
    p`2/|.p.|*|.p.|>=(sn)*(|.p.|) by A75,XREAL_1:66;
    then p`2>=(sn)*(|.p.|) by A77,TOPRNS_1:25,XCMPLX_1:88;
    then
A78: x in K003 by A74,A76;
    x in K1 by A3,A74,A76,A77;
    hence thesis by A78,XBOOLE_0:def 4;
  end;
  then K00=K003 /\ [#]((TOP-REAL 2)|K1) by A11,A69,XBOOLE_0:def 10;
  then
A79: K00 is closed by A31,PRE_TOPC:43;
  set T1= ((TOP-REAL 2)|K1)|K00,T2=((TOP-REAL 2)|K1)|K11;
A80: [#](((TOP-REAL 2)|K1)|K11)=K11 by PRE_TOPC:def 10;
A81: [#](((TOP-REAL 2)|K1)|K00)=K00 by PRE_TOPC:def 10;
A82: for p being set st p in ([#]T1)/\([#]T2) holds f1.p = f2.p
  proof
    let p be set;
    assume
A83: p in ([#]T1)/\([#]T2);
    then p in K00 by A81,XBOOLE_0:def 4;
    hence f1.p=f.p by FUNCT_1:72
      .=f2.p by A80,A83,FUNCT_1:72;
  end;
A84: K1 c= K00 \/ K11
  proof
    let x be set;
    assume
    x in K1;
    then consider p such that
A85: p=x & p`1>=0 & p<>0.TOP-REAL 2 by A3;
    per cases;
    suppose
      p`2/|.p.|>=sn;
      then x in K00 by A85;
      hence thesis by XBOOLE_0:def 3;
    end;
    suppose
      p`2/|.p.|<sn;
      then x in K11 by A85;
      hence thesis by XBOOLE_0:def 3;
    end;
  end;
  then [#](((TOP-REAL 2)|K1)|K00) \/ [#](((TOP-REAL 2)|K1)|K11) =[#]((
  TOP-REAL 2)|K1) by A81,A80,A11,XBOOLE_0:def 10;
  then consider h being Function of (TOP-REAL 2)|K1,(TOP-REAL 2)|D such that
A86: h=f1+*f2 and
A87: h is continuous by A81,A80,A79,A68,A55,A54,A82,
  JGRAPH_2:9;
A88: dom h=the carrier of ((TOP-REAL 2)|K1) by FUNCT_2:def 1;
A89: dom f1=the carrier of ((TOP-REAL 2)|K1)|K00 by FUNCT_2:def 1
    .=K00 by PRE_TOPC:29;
A90: for y being set st y in dom h holds h.y=f.y
  proof
    let y be set;
    assume
A91: y in dom h;
    now
      per cases by A84,A88,A49,A91,XBOOLE_0:def 3;
      suppose
A92:    y in K00 & not y in K11;
        then y in dom f1 \/ dom f2 by A89,XBOOLE_0:def 3;
        hence h.y=f1.y by A56,A86,A92,FUNCT_4:def 1
          .=f.y by A92,FUNCT_1:72;
      end;
      suppose
A93:    y in K11;
        then y in dom f1 \/ dom f2 by A56,XBOOLE_0:def 3;
        hence h.y=f2.y by A56,A86,A93,FUNCT_4:def 1
          .=f.y by A93,FUNCT_1:72;
      end;
    end;
    hence thesis;
  end;
  K0=the carrier of ((TOP-REAL 2)|K0) by PRE_TOPC:29
    .=dom f by A52,FUNCT_2:def 1;
  hence thesis by A87,A88,A90,FUNCT_1:9,PRE_TOPC:29;
end;

theorem Th101:
  for sn being Real, K0,B0 being Subset of TOP-REAL 2,f being
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0 st -1<sn & sn<1 & f=(sn-FanMorphE)|
  K0 & B0=NonZero TOP-REAL 2 & K0={p: p`1<=0 & p<>0.TOP-REAL 2} holds f is
  continuous
proof
  let sn be Real,K0,B0 be Subset of TOP-REAL 2,f be Function of (TOP-REAL 2)|
  K0,(TOP-REAL 2)|B0;
  set cn=sqrt(1-sn^2);
  set p0=|[-cn,-sn]|;
  assume
A1: -1<sn & sn<1 & f=(sn-FanMorphE)|K0 & B0=NonZero TOP-REAL 2 & K0={p:
  p`1<=0 & p<>0.TOP-REAL 2};
  then sn^2<1^2 by SQUARE_1:120;
  then 1-sn^2>0 by XREAL_1:52;
  then --cn>0 by SQUARE_1:93;
  then
A2: p0`1=-cn & -cn<0 by EUCLID:56;
  then p0 in K0 by A1,JGRAPH_2:11;
  then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
  not p0 in {0.TOP-REAL 2} by A2,JGRAPH_2:11,TARSKI:def 1;
  then reconsider D=B0 as non empty Subset of TOP-REAL 2 by A1,XBOOLE_0:def 5;
A3: K1 c= D
  proof
    let x be set;
    assume
    x in K1;
    then consider p2 being Point of TOP-REAL 2 such that
A4: p2=x and
    p2`1<=0 and
A5: p2<>0.TOP-REAL 2 by A1;
    not p2 in {0.TOP-REAL 2} by A5,TARSKI:def 1;
    hence thesis by A1,A4,XBOOLE_0:def 5;
  end;
  for p being Point of (TOP-REAL 2)|K1,V being Subset of (TOP-REAL 2)|D
st f.p in V & V is open holds ex W being Subset of (TOP-REAL 2)|K1 st p in W &
  W is open & f.:W c= V
  proof
    let p be Point of (TOP-REAL 2)|K1,V be Subset of (TOP-REAL 2)|D;
    assume that
A6: f.p in V and
A7: V is open;
    consider V2 being Subset of TOP-REAL 2 such that
A8: V2 is open and
A9: V2 /\ [#]((TOP-REAL 2)|D)=V by A7,TOPS_2:32;
    reconsider W2=V2 /\ [#]((TOP-REAL 2)|K1) as Subset of (TOP-REAL 2)| K1;
A10: [#]((TOP-REAL 2)|K1)=K1 by PRE_TOPC:def 10;
    then
A11: f.p=(sn-FanMorphE).p by A1,FUNCT_1:72;
A12: f.:W2 c= V
    proof
      let y be set;
      assume
      y in f.:W2;
      then consider x being set such that
A13:  x in dom f and
A14:  x in W2 and
A15:  y=f.x by FUNCT_1:def 12;
      f is Function of (TOP-REAL 2)|K1, (TOP-REAL 2)|D;
      then dom f= K1 by A10,FUNCT_2:def 1;
      then consider p4 being Point of TOP-REAL 2 such that
A16:  x=p4 and
A17:  p4`1<=0 and
      p4<>0.TOP-REAL 2 by A1,A13;
A18:  p4 in V2 by A14,A16,XBOOLE_0:def 4;
      p4 in [#]((TOP-REAL 2)|K1) by A13,A16;
      then p4 in D by A3,A10;
      then
A19:  p4 in [#]((TOP-REAL 2)|D) by PRE_TOPC:def 10;
      f.p4=(sn-FanMorphE).p4 by A1,A10,A13,A16,FUNCT_1:72
        .=p4 by A17,Th89;
      hence thesis by A9,A15,A16,A18,A19,XBOOLE_0:def 4;
    end;
    p in the carrier of (TOP-REAL 2)|K1;
    then consider q being Point of TOP-REAL 2 such that
A20: q=p and
A21: q`1<=0 and
    q <>0.TOP-REAL 2 by A1,A10;
    (sn-FanMorphE).q=q by A21,Th89;
    then p in V2 by A6,A9,A11,A20,XBOOLE_0:def 4;
    then
A22: p in W2 by XBOOLE_0:def 4;
    W2 is open by A8,TOPS_2:32;
    hence thesis by A22,A12;
  end;
  hence thesis by JGRAPH_2:20;
end;

theorem Th102:
  for sn being Real, B0 being Subset of TOP-REAL 2,K0 being
Subset of (TOP-REAL 2)|B0,f being Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2
)|B0) st -1<sn & sn<1 & f=(sn-FanMorphE)|K0 & B0=NonZero TOP-REAL 2 & K0={p: p
  `1>=0 & p<>0.TOP-REAL 2} holds f is continuous
proof
  let sn be Real, B0 be Subset of TOP-REAL 2,K0 be Subset of (TOP-REAL 2)|B0,f
  be Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0);
  the carrier of (TOP-REAL 2)|B0= B0 by PRE_TOPC:29;
  then reconsider K1=K0 as Subset of TOP-REAL 2 by XBOOLE_1:1;
  assume
A1: -1<sn & sn<1 & f=(sn-FanMorphE)|K0 & B0=NonZero TOP-REAL 2 & K0={p:
  p`1>=0 & p<>0.TOP-REAL 2 };
  K0 c= B0
  proof
    let x be set;
    assume
    x in K0;
    then
A2: ex p8 being Point of TOP-REAL 2 st x=p8 & p8`1>=0 & p8 <>0.TOP-REAL 2
    by A1;
    then not x in {0.TOP-REAL 2} by TARSKI:def 1;
    hence thesis by A1,A2,XBOOLE_0:def 5;
  end;
  then ((TOP-REAL 2)|B0)|K0=(TOP-REAL 2)|K1 by PRE_TOPC:28;
  hence thesis by A1,Th100;
end;

theorem Th103:
  for sn being Real, B0 being Subset of TOP-REAL 2,K0 being
Subset of (TOP-REAL 2)|B0,f being Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2
)|B0) st -1<sn & sn<1 & f=(sn-FanMorphE)|K0 & B0=NonZero TOP-REAL 2 & K0={p: p
  `1<=0 & p<>0.TOP-REAL 2} holds f is continuous
proof
  let sn be Real, B0 be Subset of TOP-REAL 2,K0 be Subset of (TOP-REAL 2)|B0,f
  be Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0);
  the carrier of (TOP-REAL 2)|B0= B0 by PRE_TOPC:29;
  then reconsider K1=K0 as Subset of TOP-REAL 2 by XBOOLE_1:1;
  assume
A1: -1<sn & sn<1 & f=(sn-FanMorphE)|K0 & B0=NonZero TOP-REAL 2 & K0={p:
  p`1<=0 & p<>0.TOP-REAL 2};
  K0 c= B0
  proof
    let x be set;
    assume
    x in K0;
    then
A2: ex p8 being Point of TOP-REAL 2 st x=p8 & p8`1<=0 & p8 <>0.TOP-REAL 2
    by A1;
    then not x in {0.TOP-REAL 2} by TARSKI:def 1;
    hence thesis by A1,A2,XBOOLE_0:def 5;
  end;
  then ((TOP-REAL 2)|B0)|K0=(TOP-REAL 2)|K1 by PRE_TOPC:28;
  hence thesis by A1,Th101;
end;

theorem Th104:
  for sn being Real,p being Point of TOP-REAL 2 holds |.(sn
  -FanMorphE).p.|=|.p.|
proof
  let sn be Real,p be Point of TOP-REAL 2;
  set f=sn-FanMorphE;
  set z=f.p;
  reconsider q=p as Point of TOP-REAL 2;
  reconsider qz=z as Point of TOP-REAL 2;
  per cases;
  suppose
A1: q`2/|.q.|>=sn & q`1>0;
    then
A2: (sn-FanMorphE).q= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)), |.q.|*
    ((q`2/|.q.|-sn)/(1-sn))]| by Th89;
    then
A3: qz`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)) by EUCLID:56;
A4: qz`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by A2,EUCLID:56;
A5: (q`2/|.q.|-sn)>=0 by A1,XREAL_1:50;
A6: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
    |.q.|<>0 by A1,JGRAPH_2:11,TOPRNS_1:25;
    then
A7: (|.q.|)^2>0 by SQUARE_1:74;
    0<=(q`1)^2 by XREAL_1:65;
    then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
    then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A6,XREAL_1:74;
    then (q`2)^2/(|.q.|)^2 <= 1 by A7,XCMPLX_1:60;
    then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
    then 1>=q`2/|.q.| by SQUARE_1:121;
    then
A8: 1-sn>=q`2/|.q.|-sn by XREAL_1:11;
    per cases;
    suppose
A9:   1-sn=0;
A10:  ((q`2/|.q.|-sn)/(1-sn))=(q`2/|.q.|-sn)*(1-sn)" by XCMPLX_0:def 9
        .= (q`2/|.q.|-sn)*0 by A9
        .=0;
      then 1-((q`2/|.q.|-sn)/(1-sn))^2=1;
      then (sn-FanMorphE).q= |[|.q.|*1,|.q.|*0]| by A1,A10,Th89,SQUARE_1:
      83
        .=|[(|.q.|),0]|;
      then ((sn-FanMorphE).q)`1=(|.q.|) & ((sn-FanMorphE).q)`2=0 by
      EUCLID
      :56;
      then |.(sn-FanMorphE).p.|=sqrt(((|.q.|))^2+0^2) by JGRAPH_3:10
        .=|.q.| by SQUARE_1:89;
      hence thesis;
    end;
    suppose
A11:  1-sn<>0;
      per cases by A11;
      suppose
A12:    1-sn>0;
        -(1-sn)<= -( q`2/|.q.|-sn) by A8,XREAL_1:26;
        then (-(1-sn))/(1-sn)<=(-( q`2/|.q.|-sn))/(1-sn) by A12,
        XREAL_1:74;
        then -1<=(-( q`2/|.q.|-sn))/(1-sn) by A12,XCMPLX_1:198;
        then ((-(q`2/|.q.|-sn))/(1-sn))^2<=1^2 by A5,A12,SQUARE_1:119;
        then 1-((-(q`2/|.q.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
        then
A13:    1-(-((q`2/|.q.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
A14:    (qz`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))^2 by A3
          .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1-sn))^2) by A13,SQUARE_1:def 4;
        (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
          .=(|.q.|)^2 by A4,A14;
        then sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
        hence thesis by SQUARE_1:89;
      end;
      suppose
A15:    1-sn<0;
        0+(q`2)^2<(q`1)^2+(q`2)^2 by A1,SQUARE_1:74,XREAL_1:10;
        then (q`2)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A7,A6,XREAL_1:76;
        then (q`2)^2/(|.q.|)^2 < 1 by A7,XCMPLX_1:60;
        then ((q`2)/|.q.|)^2 < 1 by XCMPLX_1:77;
        then
A16:    1 > q`2/|.p.| by SQUARE_1:122;
        q`2/|.q.|-sn>=0 by A1,XREAL_1:50;
        hence thesis by A15,A16,XREAL_1:11;
      end;
    end;
  end;
  suppose
A17: q`2/|.q.|<sn & q`1>0;
    then |.q.|<>0 by JGRAPH_2:11,TOPRNS_1:25;
    then
A18: (|.q.|)^2>0 by SQUARE_1:74;
A19: (q`2/|.q.|-sn)<0 by A17,XREAL_1:51;
A20: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
    0<=(q`1)^2 by XREAL_1:65;
    then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
    then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A20,XREAL_1:74;
    then (q`2)^2/(|.q.|)^2 <= 1 by A18,XCMPLX_1:60;
    then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
    then -1<=q`2/|.q.| by SQUARE_1:121;
    then
A21: -1-sn<=q`2/|.q.|-sn by XREAL_1:11;
A22: (sn-FanMorphE).q= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)), |.q.|
    * ((q`2/|.q.|-sn)/(1+sn))]| by A17,Th90;
    then
A23: qz`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)) by EUCLID:56;
A24: qz`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by A22,EUCLID:56;
    per cases;
    suppose
A25:  1+sn=0;
      ((q`2/|.q.|-sn)/(1+sn))=(q`2/|.q.|-sn)*(1+sn)" by XCMPLX_0:def 9
        .= (q`2/|.q.|-sn)*0 by A25
        .=0;
      then ((sn-FanMorphE).q)`1=(|.q.|) & ((sn-FanMorphE).q)`2=0 by A22,
      EUCLID:56 ,SQUARE_1:83;
      then |.(sn-FanMorphE).p.|=sqrt(((|.q.|))^2+0^2) by JGRAPH_3:10
        .=|.q.| by SQUARE_1:89;
      hence thesis;
    end;
    suppose
A26:  1+sn<>0;
      per cases by A26;
      suppose
A27:    1+sn>0;
        then (-(1+sn))/(1+sn)<=(( q`2/|.q.|-sn))/(1+sn) by A21,
        XREAL_1:74;
        then -1<=(( q`2/|.q.|-sn))/(1+sn) by A27,XCMPLX_1:198;
        then ( (q`2/|.q.|-sn) /(1+sn))^2<=1^2 by A19,A27,SQUARE_1:119;
        then
A28:    1-(((q`2/|.q.|-sn))/(1+sn))^2>=0 by XREAL_1:50;
A29:    (qz`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))^2 by A23
          .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1+sn))^2) by A28,SQUARE_1:def 4;
        (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
          .=(|.q.|)^2 by A24,A29;
        then sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
        hence thesis by SQUARE_1:89;
      end;
      suppose
A30:    1+sn<0;
        0+(q`2)^2<(q`1)^2+(q`2)^2 by A17,SQUARE_1:74,XREAL_1:10;
        then (q`2)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A18,A20,
        XREAL_1:76;
        then (q`2)^2/(|.q.|)^2 < 1 by A18,XCMPLX_1:60;
        then ((q`2)/|.q.|)^2 < 1 by XCMPLX_1:77;
        then -1 < q`2/|.p.| by SQUARE_1:122;
        then
A31:    q`2/|.q.|-sn>-1-sn by XREAL_1:11;
        -(1+sn)>-0 by A30,XREAL_1:26;
        hence thesis by A17,A31,XREAL_1:51;
      end;
    end;
  end;
  suppose
    q`1<=0;
    hence thesis by Th89;
  end;
end;

theorem Th105:
  for sn being Real,x,K0 being set st -1<sn & sn<1 & x in K0 & K0
  ={p: p`1>=0 & p<>0.TOP-REAL 2} holds (sn-FanMorphE).x in K0
proof
  let sn be Real,x,K0 be set;
  assume
A1: -1<sn & sn<1 & x in K0 & K0={p: p`1>=0 & p<>0.TOP-REAL 2};
  then consider p such that
A2: p=x and
A3: p`1>=0 and
A4: p<>0.TOP-REAL 2;
A5: now
    assume
    |.p.|<=0;
    then |.p.|=0;
    hence contradiction by A4,TOPRNS_1:25;
  end;
  then
A6: (|.p.|)^2>0 by SQUARE_1:74;
  per cases;
  suppose
A7: p`2/|.p.|<=sn;
    reconsider p9= (sn-FanMorphE).p as Point of TOP-REAL 2;
    (sn-FanMorphE).p= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)), |.p.|
    *((p`2/|.p.|-sn)/(1+sn))]| by A1,A3,A4,A7,Th91;
    then
A8: p9`1=|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)) by EUCLID:56;
A9: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
A10: 1+sn>0 by A1,XREAL_1:150;
    per cases;
    suppose
      p`1=0;
      hence thesis by A1,A2,Th89;
    end;
    suppose
      p`1<>0;
      then 0+(p`2)^2<(p`1)^2+(p`2)^2 by SQUARE_1:74,XREAL_1:10;
      then (p`2)^2/(|.p.|)^2 < (|.p.|)^2/(|.p.|)^2 by A6,A9,XREAL_1:76;
      then (p`2)^2/(|.p.|)^2 < 1 by A6,XCMPLX_1:60;
      then ((p`2)/|.p.|)^2 < 1 by XCMPLX_1:77;
      then -1 < p`2/|.p.| by SQUARE_1:122;
      then -1-sn< p`2/|.p.|-sn by XREAL_1:11;
      then (-1)*(1+sn)/(1+sn)< (p`2/|.p.|-sn)/(1+sn) by A10,XREAL_1:76;
      then
A11:  -1< (p`2/|.p.|-sn)/(1+sn) by A10,XCMPLX_1:90;
      p`2/|.p.|-sn<=0 by A7,XREAL_1:49;
      then 1^2> ((p`2/|.p.|-sn)/(1+sn))^2 by A10,A11,SQUARE_1:120;
      then 1-((p`2/|.p.|-sn)/(1+sn))^2>0 by XREAL_1:52;
      then sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)>0 by SQUARE_1:93;
      then |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2))>0 by A5,XREAL_1:131;
      hence thesis by A1,A2,A8,JGRAPH_2:11;
    end;
  end;
  suppose
A12: p`2/|.p.|>sn;
    reconsider p9= (sn-FanMorphE).p as Point of TOP-REAL 2;
    (sn-FanMorphE).p= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)), |.p.|
    *((p`2/|.p.|-sn)/(1-sn))]| by A1,A3,A4,A12,Th91;
    then
A13: p9`1=|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)) by EUCLID:56;
A14: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
A15: 1-sn>0 by A1,XREAL_1:151;
    per cases;
    suppose
      p`1=0;
      hence thesis by A1,A2,Th89;
    end;
    suppose
      p`1<>0;
      then 0+(p`2)^2<(p`1)^2+(p`2)^2 by SQUARE_1:74,XREAL_1:10;
      then (p`2)^2/(|.p.|)^2 < (|.p.|)^2/(|.p.|)^2 by A6,A14,XREAL_1:76;
      then (p`2)^2/(|.p.|)^2 < 1 by A6,XCMPLX_1:60;
      then ((p`2)/|.p.|)^2 < 1 by XCMPLX_1:77;
      then p`2/|.p.|<1 by SQUARE_1:122;
      then (p`2/|.p.|-sn)<1-sn by XREAL_1:11;
      then (p`2/|.p.|-sn)/(1-sn)<(1-sn)/(1-sn) by A15,XREAL_1:76;
      then
A16:  (p`2/|.p.|-sn)/(1-sn)<1 by A15,XCMPLX_1:60;
      -(1-sn)< -0 & p`2/|.p.|-sn>=sn-sn by A12,A15,XREAL_1:11,26;
      then (-1)*(1-sn)/(1-sn)< (p`2/|.p.|-sn)/(1-sn) by A15,XREAL_1:76;
      then -1< (p`2/|.p.|-sn)/(1-sn) by A15,XCMPLX_1:90;
      then 1^2> ((p`2/|.p.|-sn)/(1-sn))^2 by A16,SQUARE_1:120;
      then 1-((p`2/|.p.|-sn)/(1-sn))^2>0 by XREAL_1:52;
      then sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)>0 by SQUARE_1:93;
      then p9`1>0 by A5,A13,XREAL_1:131;
      hence thesis by A1,A2,JGRAPH_2:11;
    end;
  end;
end;

theorem Th106:
  for sn being Real,x,K0 being set st -1<sn & sn<1 & x in K0 & K0
  ={p: p`1<=0 & p<>0.TOP-REAL 2} holds (sn-FanMorphE).x in K0
proof
  let sn be Real,x,K0 be set;
  assume
A1: -1<sn & sn<1 & x in K0 & K0={p: p`1<=0 & p<>0.TOP-REAL 2};
  then ex p st p=x & p`1<=0 & p<>0.TOP-REAL 2;
  hence thesis by A1,Th89;
end;

theorem Th107:
  for sn being Real, D being non empty Subset of TOP-REAL 2 st -1
  <sn & sn<1 & D`={0.TOP-REAL 2} holds ex h being Function of (TOP-REAL 2)|D,(
  TOP-REAL 2)|D st h=(sn-FanMorphE)|D & h is continuous
proof
  (|[0,1]|)`1=0 & (|[0,1]|)`2=1 by EUCLID:56;
  then
A1: |[0,1]| in {p where p is Point of TOP-REAL 2: p`1>=0 & p<>0.TOP-REAL 2}
  by JGRAPH_2:11;
  set Y1=|[0,1]|;
  defpred P[Point of TOP-REAL 2] means $1`1>=0;
  reconsider B0= {0.TOP-REAL 2} as Subset of TOP-REAL 2;
  let sn be Real,D be non empty Subset of TOP-REAL 2;
  assume that
A2: -1<sn & sn<1 and
A3: D`={0.TOP-REAL 2};
A4: the carrier of ((TOP-REAL 2)|D)=D by PRE_TOPC:29;
A5: D =(B0)` by A3
    .=(NonZero TOP-REAL 2) by SUBSET_1:def 5;
  {p: P[p] & p<>0.TOP-REAL 2} c= the carrier of (TOP-REAL 2)|D from
  InclSub(A5);
  then reconsider
  K0={p:p`1>=0 & p<>0.TOP-REAL 2} as non empty Subset of (TOP-REAL
  2)|D by A1;
A6: K0=the carrier of ((TOP-REAL 2)|D)|K0 by PRE_TOPC:29;
A7: the carrier of ((TOP-REAL 2)|D)=D by PRE_TOPC:29;
A8: rng ((sn-FanMorphE)|K0) c= the carrier of ((TOP-REAL 2)|D)|K0
  proof
    let y be set;
    assume
    y in rng ((sn-FanMorphE)|K0);
    then consider x being set such that
A9: x in dom ((sn-FanMorphE)|K0) and
A10: y=((sn-FanMorphE)|K0).x by FUNCT_1:def 5;
    x in (dom (sn-FanMorphE)) /\ K0 by A9,RELAT_1:90;
    then
A11: x in K0 by XBOOLE_0:def 4;
    K0 c= the carrier of TOP-REAL 2 by A7,XBOOLE_1:1;
    then reconsider p=x as Point of TOP-REAL 2 by A11;
    (sn-FanMorphE).p=y by A10,A11,FUNCT_1:72;
    then y in K0 by A2,A11,Th105;
    hence thesis by PRE_TOPC:29;
  end;
A12: K0 c= (the carrier of TOP-REAL 2)
  proof
    let z be set;
    assume
    z in K0;
    then ex p8 being Point of TOP-REAL 2 st p8=z & p8`1>=0 & p8 <>0.TOP-REAL 2;
    hence thesis;
  end;
  Y1`1=0 & Y1`2=1 by EUCLID:56;
  then
A13: Y1 in {p where p is Point of TOP-REAL 2: p`1<=0 & p<>0.TOP-REAL 2} by
  JGRAPH_2:11;
A14: the carrier of ((TOP-REAL 2)|D)= (NonZero TOP-REAL 2) by A5,PRE_TOPC:29;
  defpred P[Point of TOP-REAL 2] means $1`1<=0;
  {p: P[p] & p<>0.TOP-REAL 2} c= the carrier of (TOP-REAL 2)|D from
  InclSub(A5);
  then reconsider
  K1={p: p`1<=0 & p<>0.TOP-REAL 2} as non empty Subset of (TOP-REAL
  2)|D by A13;
A15: K0 is closed & K1 is closed by A5,Th36,Th38;
  dom ((sn-FanMorphE)|K0)= dom ((sn-FanMorphE)) /\ K0 by RELAT_1:90
    .=((the carrier of TOP-REAL 2)) /\ K0 by FUNCT_2:def 1
    .=K0 by A12,XBOOLE_1:28;
  then reconsider f=(sn-FanMorphE)|K0 as Function of ((TOP-REAL 2)|D)|K0, ((
  TOP-REAL 2)|D) by A6,A8,FUNCT_2:4,XBOOLE_1:1;
A16: K1=the carrier of ((TOP-REAL 2)|D)|K1 by PRE_TOPC:29;
A17: rng ((sn-FanMorphE)|K1) c= the carrier of ((TOP-REAL 2)|D)|K1
  proof
    let y be set;
    assume
    y in rng ((sn-FanMorphE)|K1);
    then consider x being set such that
A18: x in dom ((sn-FanMorphE)|K1) and
A19: y=((sn-FanMorphE)|K1).x by FUNCT_1:def 5;
    x in (dom (sn-FanMorphE)) /\ K1 by A18,RELAT_1:90;
    then
A20: x in K1 by XBOOLE_0:def 4;
    K1 c= the carrier of TOP-REAL 2 by A7,XBOOLE_1:1;
    then reconsider p=x as Point of TOP-REAL 2 by A20;
    (sn-FanMorphE).p=y by A19,A20,FUNCT_1:72;
    then y in K1 by A2,A20,Th106;
    hence thesis by PRE_TOPC:29;
  end;
A21: K1 c= (the carrier of TOP-REAL 2)
  proof
    let z be set;
    assume
    z in K1;
    then ex p8 being Point of TOP-REAL 2 st p8=z & p8`1<=0 & p8 <>0.TOP-REAL 2;
    hence thesis;
  end;
  dom ((sn-FanMorphE)|K1)= dom ((sn-FanMorphE)) /\ K1 by RELAT_1:90
    .=((the carrier of TOP-REAL 2)) /\ K1 by FUNCT_2:def 1
    .=K1 by A21,XBOOLE_1:28;
  then reconsider g=(sn-FanMorphE)|K1 as Function of ((TOP-REAL 2)|D)|K1, ((
  TOP-REAL 2)|D) by A16,A17,FUNCT_2:4,XBOOLE_1:1;
A22: K1=[#](((TOP-REAL 2)|D)|K1) by PRE_TOPC:def 10;
A23: D c= K0 \/ K1
  proof
    let x be set;
    assume
A24: x in D;
    then reconsider px=x as Point of TOP-REAL 2;
    not x in {0.TOP-REAL 2} by A5,A24,XBOOLE_0:def 5;
    then px`1>=0 & px<>0.TOP-REAL 2 or px`1<=0 & px<>0.TOP-REAL 2 by
    TARSKI:def 1;
    then x in K0 or x in K1;
    hence thesis by XBOOLE_0:def 3;
  end;
A25: dom f=K0 by A6,FUNCT_2:def 1;
A26: K0=[#](((TOP-REAL 2)|D)|K0) by PRE_TOPC:def 10;
A27: for x be set st x in ([#]((((TOP-REAL 2)|D)|K0))) /\ ([#] ((((TOP-REAL
  2)|D)|K1))) holds f.x = g.x
  proof
    let x be set;
    assume
A28: x in ([#]((((TOP-REAL 2)|D)|K0))) /\ ([#] ((((TOP-REAL 2)|D)|K1))
    );
    then x in K0 by A26,XBOOLE_0:def 4;
    then f.x=(sn-FanMorphE).x by FUNCT_1:72;
    hence thesis by A22,A28,FUNCT_1:72;
  end;
  D= [#]((TOP-REAL 2)|D) by PRE_TOPC:def 10;
  then
A29: ([#](((TOP-REAL 2)|D)|K0)) \/ ([#](((TOP-REAL 2)|D)|K1)) = [#]((
  TOP-REAL 2)|D) by A26,A22,A23,XBOOLE_0:def 10;
A30: f is continuous & g is continuous by A2,A5,Th102,Th103;
  then consider h being Function of (TOP-REAL 2)|D,(TOP-REAL 2)|D such that
A31: h= f+*g and
  h is continuous by A26,A22,A29,A15,A27,JGRAPH_2:9;
A32: dom h=the carrier of ((TOP-REAL 2)|D) by FUNCT_2:def 1;
A33: dom g=K1 by A16,FUNCT_2:def 1;
  K0=[#](((TOP-REAL 2)|D)|K0) & K1=[#](((TOP-REAL 2)|D)|K1) by PRE_TOPC:
  def 10;
  then
A34: f tolerates g by A27,A25,A33,PARTFUN1:def 6;
A35: for x being set st x in dom h holds h.x=((sn-FanMorphE)|D).x
  proof
    let x be set;
    assume
A36: x in dom h;
    then reconsider p=x as Point of TOP-REAL 2 by A14,XBOOLE_0:def 5;
    not x in {0.TOP-REAL 2} by A14,A36,XBOOLE_0:def 5;
    then
A37: x <>0.TOP-REAL 2 by TARSKI:def 1;
A38: x in D`` by A32,A36,PRE_TOPC:29;
    now
      per cases;
      case
A39:    x in K0;
A40:    (sn-FanMorphE)|D.p=(sn-FanMorphE).p by A38,FUNCT_1:72
          .=f.p by A39,FUNCT_1:72;
        h.p=(g+*f).p by A31,A34,FUNCT_4:35
          .=f.p by A25,A39,FUNCT_4:14;
        hence thesis by A40;
      end;
      case
        not x in K0;
        then not p`1>=0 by A37;
        then
A41:    x in K1 by A37;
        (sn-FanMorphE)|D.p=(sn-FanMorphE).p by A38,FUNCT_1:72
          .=g.p by A41,FUNCT_1:72;
        hence thesis by A31,A33,A41,FUNCT_4:14;
      end;
    end;
    hence thesis;
  end;
  dom (sn-FanMorphE)=(the carrier of (TOP-REAL 2)) by FUNCT_2:def 1;
  then dom ((sn-FanMorphE)|D)=(the carrier of (TOP-REAL 2))/\ D by
  RELAT_1:90
    .=the carrier of ((TOP-REAL 2)|D) by A4,XBOOLE_1:28;
  then f+*g=(sn-FanMorphE)|D by A31,A32,A35,FUNCT_1:9;
  hence thesis by A26,A22,A29,A30,A15,A27,JGRAPH_2:9;
end;

theorem Th108:
  for sn being Real st -1<sn & sn<1 holds ex h being Function of
  (TOP-REAL 2),(TOP-REAL 2) st h=(sn-FanMorphE) & h is continuous
proof
  reconsider D=NonZero TOP-REAL 2 as non empty Subset of TOP-REAL 2 by
  JGRAPH_2:19;
  let sn be Real;
  assume that
A1: -1<sn and
A2: sn<1;
  reconsider f=(sn-FanMorphE) as Function of (TOP-REAL 2),(TOP-REAL 2);
A3: f.(0.TOP-REAL 2)=0.TOP-REAL 2 by Th89,JGRAPH_2:11;
A4: for p being Point of (TOP-REAL 2)|D holds f.p<>f.(0.TOP-REAL 2)
  proof
    let p be Point of (TOP-REAL 2)|D;
A5: [#]((TOP-REAL 2)|D)=D by PRE_TOPC:def 10;
    then reconsider q=p as Point of TOP-REAL 2 by XBOOLE_0:def 5;
    not p in {0.TOP-REAL 2} by A5,XBOOLE_0:def 5;
    then
A6: not p=0.TOP-REAL 2 by TARSKI:def 1;
    now
      per cases;
      case
A7:     q`2/|.q.|>=sn & q`1>=0;
        set q9= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)), |.q.|* ((q`2/|.q
        .|-sn)/(1-sn))]|;
A8:     q9`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by EUCLID:56;
        now
          assume
A9:       q9=0.TOP-REAL 2;
A10:      |.q.|<>0 by A6,TOPRNS_1:25;
          then sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)=sqrt(1-0^2) by A8,A9,
          JGRAPH_2:11 ,XCMPLX_1:6
            .=1 by SQUARE_1:83;
          hence contradiction by A9,A10,EUCLID:56,JGRAPH_2:11;
        end;
        hence thesis by A1,A2,A3,A6,A7,Th91;
      end;
      case
A11:    q`2/|.q.|<sn & q`1>=0;
        set q9=|[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)), |.q.|* ((q`2/|.q
        .|-sn)/(1+sn))]|;
A12:    q9`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by EUCLID:56;
        now
          assume
A13:      q9=0.TOP-REAL 2;
A14:      |.q.|<>0 by A6,TOPRNS_1:25;
          then sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)=sqrt(1-0^2) by A12,A13,
          JGRAPH_2:11 ,XCMPLX_1:6
            .=1 by SQUARE_1:83;
          hence contradiction by A13,A14,EUCLID:56,JGRAPH_2:11;
        end;
        hence thesis by A1,A2,A3,A6,A11,Th91;
      end;
      case
        q`1<0;
        then f.p=p by Th89;
        hence thesis by A6,Th89,JGRAPH_2:11;
      end;
    end;
    hence thesis;
  end;
A15: for V being Subset of (TOP-REAL 2) st f.(0.TOP-REAL 2) in V & V is open
ex W being Subset of (TOP-REAL 2) st 0.TOP-REAL 2 in W & W is open & f.:W c= V
  proof
    reconsider u0=0.TOP-REAL 2 as Point of Euclid 2 by EUCLID:71;
    let V be Subset of (TOP-REAL 2);
    reconsider VV = V as Subset of TopSpaceMetr Euclid 2 by Lm11;
    assume that
A16: f.(0.TOP-REAL 2) in V and
A17: V is open;
    VV is open by A17,Lm11,PRE_TOPC:60;
    then consider r being real number such that
A18: r>0 and
A19: Ball(u0,r) c= V by A3,A16,TOPMETR:22;
    reconsider r as Real by XREAL_0:def 1;
    the TopStruct of TOP-REAL 2 = TopSpaceMetr Euclid 2 by EUCLID:def 8;
    then reconsider W1=Ball(u0,r) as Subset of TOP-REAL 2;
A20: W1 is open by GOBOARD6:6;
A21: f.:W1 c= W1
    proof
      let z be set;
      assume
      z in f.:W1;
      then consider y being set such that
A22:  y in dom f and
A23:  y in W1 and
A24:  z=f.y by FUNCT_1:def 12;
      z in rng f by A22,A24,FUNCT_1:def 5;
      then reconsider qz=z as Point of TOP-REAL 2;
      reconsider q=y as Point of TOP-REAL 2 by A22;
      reconsider qy=q as Point of Euclid 2 by EUCLID:71;
      reconsider pz=qz as Point of Euclid 2 by EUCLID:71;
      dist(u0,qy)<r by A23,METRIC_1:12;
      then
A25:  |.(0.TOP-REAL 2) - q.|<r by JGRAPH_1:45;
      now
        per cases by JGRAPH_2:11;
        case
          q`1<=0;
          hence thesis by A23,A24,Th89;
        end;
        case
A26:      q<>0.TOP-REAL 2 & q`2/|.q.|>=sn & q`1>=0;
          then
A27:      (q`2/|.q.|-sn)>= 0 by XREAL_1:50;
          0<=(q`1)^2 by XREAL_1:65;
          then (|.q.|)^2 =(q`1)^2+(q`2)^2 & 0+(q`2)^2<=(q`1)^2+(q`2)^2 by
          JGRAPH_3:10 ,XREAL_1:9;
          then
A28:      (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by XREAL_1:74;
A29:      1-sn>0 by A2,XREAL_1:151;
          |.q.|<>0 by A26,TOPRNS_1:25;
          then (|.q.|)^2>0 by SQUARE_1:74;
          then (q`2)^2/(|.q.|)^2 <= 1 by A28,XCMPLX_1:60;
          then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
          then 1>=q`2/|.q.| by SQUARE_1:121;
          then 1-sn>=q`2/|.q.|-sn by XREAL_1:11;
          then -(1-sn)<= -( q`2/|.q.|-sn) by XREAL_1:26;
          then (-(1-sn))/(1-sn)<=(-( q`2/|.q.|-sn))/(1-sn) by A29,
          XREAL_1:
          74;
          then -1<=(-( q`2/|.q.|-sn))/(1-sn) by A29,XCMPLX_1:198;
          then ((-(q`2/|.q.|-sn))/(1-sn))^2<=1^2 by A29,A27,SQUARE_1:119;
          then 1-((-(q`2/|.q.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
          then
A30:      1-(-((q`2/|.q.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
A31:      (sn-FanMorphE).q= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1- sn))^2))
          , |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by A1,A2,A26,Th91;
          then
A32:      qz`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by A24,EUCLID:56;
          qz`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)) by A24,A31,
          EUCLID:56;
          then
A33:      (qz`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))^2
            .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1-sn))^2) by A30,SQUARE_1:def 4;
          (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
            .=(|.q.|)^2 by A32,A33;
          then sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
          then
A34:      |.qz.|=|.q.| by SQUARE_1:89;
          |.- q.|<r by A25,EUCLID:31;
          then |.q.|<r by TOPRNS_1:27;
          then |.- qz.|<r by A34,TOPRNS_1:27;
          then |.(0.TOP-REAL 2) - qz.|<r by EUCLID:31;
          then dist(u0,pz)<r by JGRAPH_1:45;
          hence thesis by METRIC_1:12;
        end;
        case
A35:      q<>0.TOP-REAL 2 & q`2/|.q.|<sn & q`1>=0;
          0<=(q`1)^2 by XREAL_1:65;
          then (|.q.|)^2 =(q`1)^2+(q`2)^2 & 0+(q`2)^2<=(q`1)^2+(q`2)^2 by
          JGRAPH_3:10 ,XREAL_1:9;
          then
A36:      (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by XREAL_1:74;
A37:      1+sn>0 by A1,XREAL_1:150;
          |.q.|<>0 by A35,TOPRNS_1:25;
          then (|.q.|)^2>0 by SQUARE_1:74;
          then (q`2)^2/(|.q.|)^2 <= 1 by A36,XCMPLX_1:60;
          then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
          then -1<=q`2/|.q.| by SQUARE_1:121;
          then --1>=-q`2/|.q.| by XREAL_1:26;
          then 1+sn>=-q`2/|.q.|+sn by XREAL_1:9;
          then
A38:      (-(q`2/|.q.|-sn))/(1+sn)<=1 by A37,XREAL_1:187;
          (sn-q`2/|.q.|)>=0 by A35,XREAL_1:50;
          then -1<=(-( q`2/|.q.|-sn))/(1+sn) by A37;
          then ((-(q`2/|.q.|-sn))/(1+sn))^2<=1^2 by A38,SQUARE_1:119;
          then 1-((-(q`2/|.q.|-sn))/(1+sn))^2>=0 by XREAL_1:50;
          then
A39:      1-(-((q`2/|.q.|-sn))/(1+sn))^2>=0 by XCMPLX_1:188;
A40:      (sn-FanMorphE).q= |[|.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+ sn))^2) )
          , |.q.|* ((q`2/|.q.|-sn)/(1+sn))]| by A1,A2,A35,Th91;
          then
A41:      qz`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by A24,EUCLID:56;
          qz`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)) by A24,A40,
          EUCLID:56;
          then
A42:      (qz`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))^2
            .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1+sn))^2) by A39,SQUARE_1:def 4;
          (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
            .=(|.q.|)^2 by A41,A42;
          then sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
          then
A43:      |.qz.|=|.q.| by SQUARE_1:89;
          |.- q.|<r by A25,EUCLID:31;
          then |.q.|<r by TOPRNS_1:27;
          then |.- qz.|<r by A43,TOPRNS_1:27;
          then |.(0.TOP-REAL 2) - qz.|<r by EUCLID:31;
          then dist(u0,pz)<r by JGRAPH_1:45;
          hence thesis by METRIC_1:12;
        end;
      end;
      hence thesis;
    end;
    u0 in W1 by A18,GOBOARD6:4;
    hence thesis by A19,A20,A21,XBOOLE_1:1;
  end;
A44: D`= {0.TOP-REAL 2} by JGRAPH_3:30;
  then
  ex h being Function of (TOP-REAL 2)|D,(TOP-REAL 2)|D st h=(sn-FanMorphE
  )|D & h is continuous by A1,A2,Th107;
  hence thesis by A3,A44,A4,A15,JGRAPH_3:13;
end;

theorem Th109:
  for sn being Real st -1<sn & sn<1 holds sn-FanMorphE is
  one-to-one
proof
  let sn be Real;
  assume that
A1: -1<sn and
A2: sn<1;
  for x1,x2 being set st x1 in dom (sn-FanMorphE) & x2 in dom (sn
  -FanMorphE) & (sn-FanMorphE).x1=(sn-FanMorphE).x2 holds x1=x2
  proof
    let x1,x2 be set;
    assume that
A3: x1 in dom (sn-FanMorphE) and
A4: x2 in dom (sn-FanMorphE) and
A5: (sn-FanMorphE).x1=(sn-FanMorphE).x2;
    reconsider p2=x2 as Point of TOP-REAL 2 by A4;
    reconsider p1=x1 as Point of TOP-REAL 2 by A3;
    set q=p1,p=p2;
A6: 1-sn>0 by A2,XREAL_1:151;
    now
      per cases by JGRAPH_2:11;
      case
A7:     q`1<=0;
        then
A8:     (sn-FanMorphE).q=q by Th89;
        now
          per cases by JGRAPH_2:11;
          case
            p`1<=0;
            hence thesis by A5,A8,Th89;
          end;
          case
A9:         p<>0.TOP-REAL 2 & p`2/|.p.|>=sn & p`1>=0;
            then
A10:        (p`2/|.p.|-sn)>=0 by XREAL_1:50;
            set p4= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)), |.p.|* ((p`2
            /|.p.|-sn)/(1-sn))]|;
A11:        (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
A12:        |.p.|<>0 by A9,TOPRNS_1:25;
            then
A13:        (|.p.|)^2>0 by SQUARE_1:74;
            0<=(p`1)^2 by XREAL_1:65;
            then 0+(p`2)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
            then (p`2)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by A11,XREAL_1:
            74;
            then (p`2)^2/(|.p.|)^2 <= 1 by A13,XCMPLX_1:60;
            then ((p`2)/|.p.|)^2 <= 1 by XCMPLX_1:77;
            then 1>=p`2/|.p.| by SQUARE_1:121;
            then 1-sn>=p`2/|.p.|-sn by XREAL_1:11;
            then -(1-sn)<= -( p`2/|.p.|-sn) by XREAL_1:26;
            then (-(1-sn))/(1-sn)<=(-( p`2/|.p.|-sn))/(1-sn) by A6,
            XREAL_1
            :74;
            then
A14:        -1<=(-( p`2/|.p.|-sn))/(1-sn) by A6,XCMPLX_1:198;
A15:        sn -FanMorphE.p= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2))
            , |.p.|* ((p`2/|.p.|-sn)/(1-sn))]| by A1,A2,A9,Th91;
            (p`2/|.p.|-sn)>= 0 by A9,XREAL_1:50;
            then ((-(p`2/|.p.|-sn))/(1-sn))^2<=1^2 by A6,
            A14,SQUARE_1:119;
            then
A16:        1-((-(p`2/|.p.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
            then sqrt(1-((-(p`2/|.p.|-sn))/(1-sn))^2)>=0 by
            SQUARE_1:def 4;
            then sqrt(1-(-(p`2/|.p.|-sn))^2/(1-sn)^2)>=0 by XCMPLX_1:77;
            then sqrt(1-(p`2/|.p.|-sn)^2/(1-sn)^2)>=0;
            then sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)>=0 by XCMPLX_1:77;
            then
            p4`1= |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)) & q`1=0 by A5
            ,A7,A8,A15,EUCLID:56;
            then
A17:        (sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2))=0 by A5,A8,A15,A12,
            XCMPLX_1:6;
            1-(-((p`2/|.p.|-sn))/(1-sn))^2>=0 by A16,XCMPLX_1:188;
            then 1-((p`2/|.p.|-sn)/(1-sn))^2=0 by A17,SQUARE_1:92;
            then 1= (p`2/|.p.|-sn)/(1-sn) by A6,A10,SQUARE_1:83,89;
            then 1 *(1-sn)=(p`2/|.p.|-sn) by A6,XCMPLX_1:88;
            then 1 *|.p.|=p`2 by A9,TOPRNS_1:25,XCMPLX_1:88;
            then p`1=0 by A11,XCMPLX_1:6;
            hence thesis by A5,A8,Th89;
          end;
          case
A18:        p<>0.TOP-REAL 2 & p`2/|.p.|<sn & p`1>=0;
            then
A19:        |.p.|<>0 by TOPRNS_1:25;
            then
A20:        (|.p.|)^2>0 by SQUARE_1:74;
            set p4= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)), |.p.|* ((p`2
            /|.p.|-sn)/(1+sn))]|;
A21:        (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
A22:        1+sn>0 by A1,XREAL_1:150;
A23:        (p`2/|.p.|-sn)<=0 by A18,XREAL_1:49;
            then
A24:        -1<=(-( p`2/|.p.|-sn))/(1+sn) by A22;
A25:        sn -FanMorphE.p= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2))
            , |.p.|* ((p`2/|.p.|-sn)/(1+sn))]| by A1,A2,A18,Th91;
            0<=(p`1)^2 by XREAL_1:65;
            then 0+(p`2)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
            then (p`2)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by A21,XREAL_1:
            74;
            then (p`2)^2/(|.p.|)^2 <= 1 by A20,XCMPLX_1:60;
            then ((p`2)/|.p.|)^2 <= 1 by XCMPLX_1:77;
            then (-((p`2)/|.p.|))^2 <= 1;
            then 1>= -p`2/|.p.| by SQUARE_1:121;
            then (1+sn)>= -p`2/|.p.|+sn by XREAL_1:9;
            then (-(p`2/|.p.|-sn))/(1+sn)<=1 by A22,XREAL_1:187;
            then ((-(p`2/|.p.|-sn))/(1+sn))^2<=1^2 by A24,SQUARE_1:119;
            then
A26:        1-((-(p`2/|.p.|-sn))/(1+sn))^2>=0 by XREAL_1:50;
            then sqrt(1-((-(p`2/|.p.|-sn))/(1+sn))^2)>=0 by
            SQUARE_1:def 4;
            then sqrt(1-(-(p`2/|.p.|-sn))^2/(1+sn)^2)>=0 by XCMPLX_1:77;
            then sqrt(1-((p`2/|.p.|-sn))^2/(1+sn)^2)>=0;
            then sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)>=0 by XCMPLX_1:77;
            then
            p4`1= |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)) & q`1=0 by A5
            ,A7,A8,A25,EUCLID:56;
            then
A27:        (sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2))=0 by A5,A8,A25,A19,
            XCMPLX_1:6;
            1-(-((p`2/|.p.|-sn))/(1+sn))^2>=0 by A26,XCMPLX_1:188;
            then 1-((p`2/|.p.|-sn)/(1+sn))^2=0 by A27,SQUARE_1:92;
            then 1=sqrt((-((p`2/|.p.|-sn)/(1+sn)))^2) by SQUARE_1:83;
            then 1= -((p`2/|.p.|-sn)/(1+sn)) by A22,A23,SQUARE_1:89;
            then 1= ((-(p`2/|.p.|-sn))/(1+sn)) by XCMPLX_1:188;
            then 1 *(1+sn)=-(p`2/|.p.|-sn) by A22,XCMPLX_1:88;
            then 1+sn-sn=-p`2/|.p.|;
            then 1=(-p`2)/|.p.| by XCMPLX_1:188;
            then 1 *|.p.|=-p`2 by A18,TOPRNS_1:25,XCMPLX_1:88;
            then (p`2)^2-(p`2)^2 =(p`1)^2 by A21,XCMPLX_1:26;
            then p`1=0 by XCMPLX_1:6;
            hence thesis by A5,A8,Th89;
          end;
        end;
        hence thesis;
      end;
      case
A28:    q`2/|.q.|>=sn & q`1>=0 & q<>0.TOP-REAL 2;
        then |.q.|<>0 by TOPRNS_1:25;
        then
A29:    (|.q.|)^2>0 by SQUARE_1:74;
        set q4= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)), |.q.|* ((q`2/|.q
        .|-sn)/(1-sn))]|;
A30:    q4`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by EUCLID:56;
A31:    sn-FanMorphE.q= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2 )), |.
        q.|* ((q`2/|.q.|-sn)/(1-sn))]| by A1,A2,A28,Th91;
A32:    q4`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)) by EUCLID:56;
        now
          per cases by JGRAPH_2:11;
          case
A33:        p`1<=0;
            then
A34:        (sn-FanMorphE).p=p by Th89;
A35:        |.q.|<>0 by A28,TOPRNS_1:25;
            then
A36:        (|.q.|)^2>0 by SQUARE_1:74;
A37:        (q`2/|.q.|-sn)>= 0 by A28,XREAL_1:50;
A38:        (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
A39:        (q`2/|.q.|-sn)>=0 by A28,XREAL_1:50;
A40:        1-sn>0 by A2,XREAL_1:151;
            0<=(q`1)^2 by XREAL_1:65;
            then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
            then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A38,XREAL_1:
            74;
            then (q`2)^2/(|.q.|)^2 <= 1 by A36,XCMPLX_1:60;
            then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
            then 1>=q`2/|.q.| by SQUARE_1:121;
            then 1-sn>=q`2/|.q.|-sn by XREAL_1:11;
            then -(1-sn)<= -( q`2/|.q.|-sn) by XREAL_1:26;
            then (-(1-sn))/(1-sn)<=(-( q`2/|.q.|-sn))/(1-sn) by A40,
            XREAL_1:74;
            then -1<=(-( q`2/|.q.|-sn))/(1-sn) by A40,XCMPLX_1:198;
            then ((-(q`2/|.q.|-sn))/(1-sn))^2<=1^2 by A40,A37, SQUARE_1:
            119;
            then
A41:        1-((-(q`2/|.q.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
            then sqrt(1-((-(q`2/|.q.|-sn))/(1-sn))^2)>=0 by SQUARE_1:
            def 4;
            then sqrt(1-(-(q`2/|.q.|-sn))^2/(1-sn)^2)>=0 by XCMPLX_1:77;
            then sqrt(1-(q`2/|.q.|-sn)^2/(1-sn)^2)>=0;
            then sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)>=0 by XCMPLX_1:77;
            then p`1=0 by A5,A31,A33,A34,EUCLID:56;
            then
A42:        (sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))=0 by A5,A31,A32,A34,A35
            ,XCMPLX_1:6;
            1-(-((q`2/|.q.|-sn))/(1-sn))^2>=0 by A41,XCMPLX_1:188;
            then 1-((q`2/|.q.|-sn)/(1-sn))^2=0 by A42,SQUARE_1:92;
            then 1= (q`2/|.q.|-sn)/(1-sn) by A40,A39,SQUARE_1:83,89;
            then 1 *(1-sn)=(q`2/|.q.|-sn) by A40,XCMPLX_1:88;
            then 1 *|.q.|=q`2 by A28,TOPRNS_1:25,XCMPLX_1:88;
            then q`1=0 by A38,XCMPLX_1:6;
            hence thesis by A5,A34,Th89;
          end;
          case
A43:        p<>0.TOP-REAL 2 & p`2/|.p.|>=sn & p`1>=0;
            0<=(q`1)^2 by XREAL_1:65;
            then (|.q.|)^2 =(q`1)^2+(q`2)^2 & 0+(q`2)^2<=(q`1)^2+(q`2)^2 by
            JGRAPH_3:10 ,XREAL_1:9;
            then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by XREAL_1:74;
            then (q`2)^2/(|.q.|)^2 <= 1 by A29,XCMPLX_1:60;
            then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
            then 1>=q`2/|.q.| by SQUARE_1:121;
            then 1-sn>=q`2/|.q.|-sn by XREAL_1:11;
            then -(1-sn)<= -( q`2/|.q.|-sn) by XREAL_1:26;
            then (-(1-sn))/(1-sn)<=(-( q`2/|.q.|-sn))/(1-sn) by A6,
            XREAL_1:74;
            then
A44:        -1<=(-( q`2/|.q.|-sn))/(1-sn) by A6,XCMPLX_1:198;
            (q`2/|.q.|-sn)>= 0 by A28,XREAL_1:50;
            then ((-(q`2/|.q.|-sn))/(1-sn))^2<=1^2 by A6,A44, SQUARE_1:
            119;
            then 1-((-(q`2/|.q.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
            then
A45:        1-(-((q`2/|.q.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
            q4`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)) by EUCLID:56;
            then
A46:        (q4`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))^2
              .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1-sn))^2) by A45,SQUARE_1:
            def 4;
A47:        q4`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by EUCLID:56;
            (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
              .=(|.q.|)^2 by A47,A46;
            then
A48:        sqrt((|.q4.|)^2)=|.q.| by SQUARE_1:89;
            then
A49:        |.q4.|=|.q.| by SQUARE_1:89;
            0<=(p`1)^2 by XREAL_1:65;
            then (|.p.|)^2 =(p`1)^2+(p`2)^2 & 0+(p`2)^2<=(p`1)^2+(p`2)^2 by
            JGRAPH_3:10 ,XREAL_1:9;
            then
A50:        (p`2)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by XREAL_1:74;
            |.p.|<>0 by A43,TOPRNS_1:25;
            then (|.p.|)^2>0 by SQUARE_1:74;
            then (p`2)^2/(|.p.|)^2 <= 1 by A50,XCMPLX_1:60;
            then ((p`2)/|.p.|)^2 <= 1 by XCMPLX_1:77;
            then 1>=p`2/|.p.| by SQUARE_1:121;
            then 1-sn>=p`2/|.p.|-sn by XREAL_1:11;
            then -(1-sn)<= -( p`2/|.p.|-sn) by XREAL_1:26;
            then (-(1-sn))/(1-sn)<=(-( p`2/|.p.|-sn))/(1-sn) by A6,
            XREAL_1:74;
            then
A51:        -1<=(-( p`2/|.p.|-sn))/(1-sn) by A6,XCMPLX_1:198;
            (p`2/|.p.|-sn)>= 0 by A43,XREAL_1:50;
            then ((-(p`2/|.p.|-sn))/(1-sn))^2<=1^2 by A6,A51, SQUARE_1:
            119;
            then 1-((-(p`2/|.p.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
            then
A52:        1-(-((p`2/|.p.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
            set p4= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)), |.p.|* ((p`2
            /|.p.|-sn)/(1-sn))]|;
A53:        p4`2= |.p.|* ((p`2/|.p.|-sn)/(1-sn)) by EUCLID:56;
            p4`1= |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)) by EUCLID:56;
            then
A54:        (p4`1)^2= (|.p.|)^2*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2))^2
              .= (|.p.|)^2*(1-((p`2/|.p.|-sn)/(1-sn))^2) by A52,SQUARE_1:
            def 4;
            (|.p4.|)^2=(p4`1)^2+(p4`2)^2 by JGRAPH_3:10
              .=(|.p.|)^2 by A53,A54;
            then
A55:        sqrt((|.p4.|)^2)=|.p.| by SQUARE_1:89;
            then
A56:        |.p4.|=|.p.| by SQUARE_1:89;
A57:        sn -FanMorphE.p= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)
            ), |.p.|* ((p`2/|.p.|-sn)/(1-sn))]| by A1,A2,A43,Th91;
            then ((p`2/|.p.|-sn)/(1-sn)) =|.q.|* ((q`2/|.q.|-sn)/(1-sn))/|.p
            .| by A5,A31,A30,A43,A53, TOPRNS_1:25,XCMPLX_1:90;
            then (p`2/|.p.|-sn)/(1-sn)=(q`2/|.q.|-sn)/(1-sn) by A5,A31,A43,
            A57,A48,A55,TOPRNS_1:25,XCMPLX_1:90;
            then (p`2/|.p.|-sn)/(1-sn)*(1-sn)=q`2/|.q.|-sn by A6,
            XCMPLX_1:88;
            then p`2/|.p.|-sn=q`2/|.q.|-sn by A6,XCMPLX_1:88;
            then p`2/|.p.|*|.p.|=q`2 by A5,A31,A43,A57,A49,A56,
            TOPRNS_1:25,XCMPLX_1:88;
            then
A58:        p`2=q`2 by A43,TOPRNS_1:25,XCMPLX_1:88;
A59:        p=|[p`1,p`2]| by EUCLID:57;
            |.p.|^2=(p`1)^2+(p`2)^2 & |.q.|^2=(q`1)^2+(q`2)^2 by
            JGRAPH_3:10;
            then p`1=sqrt((q`1)^2) by A5,A31,A43,A57,A49,A56,A58,
            SQUARE_1:89;
            then p`1=q`1 by A28,SQUARE_1:89;
            hence thesis by A58,A59,EUCLID:57;
          end;
          case
A60:        p<>0.TOP-REAL 2 & p`2/|.p.|<sn & p`1>=0;
            then p`2/|.p.|-sn<0 by XREAL_1:51;
            then
A61:        ((p`2/|.p.|-sn)/(1+sn))<0 by A1,XREAL_1:143,150;
            set p4= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)), |.p.|* ((p`2
            /|.p.|-sn)/(1+sn))]|;
A62:        p4`2= |.p.|* ((p`2/|.p.|-sn)/(1+sn)) & q`2/|.q.|-sn>=0 by
            A28,EUCLID:56 ,XREAL_1:50;
A63:        1-sn>0 by A2,XREAL_1:151;
            sn -FanMorphE.p= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)
), |.p.|* ((p`2/ |.p.|-sn)/(1+sn))]| & |.p.|<>0 by A1,A2,A60,Th91,TOPRNS_1:25;
            hence thesis by A5,A31,A30,A61,A62,A63,XREAL_1:134;
          end;
        end;
        hence thesis;
      end;
      case
A64:    q`2/|.q.|<sn & q`1>=0 & q<>0.TOP-REAL 2;
        then
A65:    |.q.|<>0 by TOPRNS_1:25;
        then
A66:    (|.q.|)^2>0 by SQUARE_1:74;
        set q4= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)), |.q.|* ((q`2/|.q
        .|-sn)/(1+sn))]|;
A67:    q4`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by EUCLID:56;
A68:    sn-FanMorphE.q= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2 )),
        |.q.|* ((q`2/|.q.|-sn)/(1+sn))]| by A1,A2,A64,Th91;
A69:    q4`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)) by EUCLID:56;
        now
          per cases by JGRAPH_2:11;
          case
A70:        p`1<=0;
A71:        (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
A72:        1+sn>0 by A1,XREAL_1:150;
            0<=(q`1)^2 by XREAL_1:65;
            then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
            then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A71,
            XREAL_1:74;
            then (q`2)^2/(|.q.|)^2 <= 1 by A66,XCMPLX_1:60;
            then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
            then (-((q`2)/|.q.|))^2 <= 1;
            then 1>= -q`2/|.q.| by SQUARE_1:121;
            then (1+sn)>= -q`2/|.q.|+sn by XREAL_1:9;
            then
A73:        (-(q`2/|.q.|-sn))/(1+sn)<=1 by A72,XREAL_1:187;
A74:        (q`2/|.q.|-sn)<=0 by A64,XREAL_1:49;
            then -1<=(-( q`2/|.q.|-sn))/(1+sn) by A72;
            then ((-(q`2/|.q.|-sn))/(1+sn))^2<=1^2 by A73,SQUARE_1:119;
            then
A75:        1-((-(q`2/|.q.|-sn))/(1+sn))^2>=0 by XREAL_1:50;
            then
A76:        1-(-((q`2/|.q.|-sn))/(1+sn))^2>=0 by XCMPLX_1:188;
A77:        (sn-FanMorphE).p=p by A70,Th89;
            sqrt(1-((-(q`2/|.q.|-sn))/(1+sn))^2)>=0 by A75, SQUARE_1:
            def 4;
            then sqrt(1-(-(q`2/|.q.|-sn))^2/(1+sn)^2)>=0 by XCMPLX_1:77;
            then sqrt(1-((q`2/|.q.|-sn))^2/(1+sn)^2)>=0;
            then sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)>=0 by XCMPLX_1:77;
            then p`1=0 by A5,A68,A70,A77,EUCLID:56;
            then (sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))=0 by A5,A68,A69,A65,
            A77,XCMPLX_1:6;
            then 1-((q`2/|.q.|-sn)/(1+sn))^2=0 by A76,SQUARE_1:92;
            then 1=sqrt((-((q`2/|.q.|-sn)/(1+sn)))^2) by SQUARE_1:83;
            then 1= -((q`2/|.q.|-sn)/(1+sn)) by A72,A74,SQUARE_1:89;
            then 1= ((-(q`2/|.q.|-sn))/(1+sn)) by XCMPLX_1:188;
            then 1 *(1+sn)=-(q`2/|.q.|-sn) by A72,XCMPLX_1:88;
            then 1+sn-sn=-q`2/|.q.|;
            then 1=(-q`2)/|.q.| by XCMPLX_1:188;
            then 1 *|.q.|=-q`2 by A64,TOPRNS_1:25,XCMPLX_1:88;
            then (q`2)^2-(q`2)^2 =(q`1)^2 by A71,XCMPLX_1:26;
            then q`1=0 by XCMPLX_1:6;
            hence thesis by A5,A77,Th89;
          end;
          case
A78:        p<>0.TOP-REAL 2 & p`2/|.p.|>=sn & p`1>=0;
            set p4= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)), |.p.|* ((p`2
            /|.p.|-sn)/(1-sn))]|;
A79:        p4`2= |.p.|* ((p`2/|.p.|-sn)/(1-sn)) & |.q.|<>0 by A64,
            EUCLID:56 ,TOPRNS_1:25;
            q`2/|.q.|-sn<0 by A64,XREAL_1:51;
            then
A80:        ((q`2/|.q.|-sn)/(1+sn))<0 by A1,XREAL_1:143,150;
A81:        1-sn>0 by A2,XREAL_1:151;
            sn -FanMorphE.p= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)
), |.p.|* ((p`2/ |.p.|-sn)/(1-sn))]| & p`2/|.p.|-sn>=0 by A1,A2,A78,Th91,
            XREAL_1:50;
            hence thesis by A5,A68,A67,A80,A79,A81,XREAL_1:134;
          end;
          case
A82:        p<>0.TOP-REAL 2 & p`2/|.p.|<sn & p`1>=0;
            0<=(p`1)^2 by XREAL_1:65;
            then (|.p.|)^2 =(p`1)^2+(p`2)^2 & 0+(p`2)^2<=(p`1)^2+(p`2)^2 by
            JGRAPH_3:10 ,XREAL_1:9;
            then
A83:        (p`2)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by XREAL_1:74;
A84:        1+sn>0 by A1,XREAL_1:150;
            0<=(q`1)^2 by XREAL_1:65;
            then (|.q.|)^2 =(q`1)^2+(q`2)^2 & 0+(q`2)^2<=(q`1)^2+(q`2)^2 by
            JGRAPH_3:10 ,XREAL_1:9;
            then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by XREAL_1:74;
            then (q`2)^2/(|.q.|)^2 <= 1 by A66,XCMPLX_1:60;
            then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
            then -1<=q`2/|.q.| by SQUARE_1:121;
            then -1-sn<=q`2/|.q.|-sn by XREAL_1:11;
            then -(-1-sn)>= -(q`2/|.q.|-sn) by XREAL_1:26;
            then
A85:        (-(q`2/|.q.|-sn))/(1+sn)<=1 by A84,XREAL_1:187;
            (q`2/|.q.|-sn)<=0 by A64,XREAL_1:49;
            then -1<=(-( q`2/|.q.|-sn))/(1+sn) by A84;
            then ((-(q`2/|.q.|-sn))/(1+sn))^2<=1^2 by A85,SQUARE_1:119;
            then 1-((-(q`2/|.q.|-sn))/(1+sn))^2>=0 by XREAL_1:50;
            then
A86:        1-(-((q`2/|.q.|-sn))/(1+sn))^2>=0 by XCMPLX_1:188;
            q4`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)) by EUCLID:56;
            then
A87:        (q4`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))^2
              .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1+sn))^2) by A86,SQUARE_1:
            def 4;
A88:        q4`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by EUCLID:56;
            set p4= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)), |.p.|* ((p`2
            /|.p.|-sn)/(1+sn))]|;
A89:        p4`2= |.p.|* ((p`2/|.p.|-sn)/(1+sn)) by EUCLID:56;
            |.p.|<>0 by A82,TOPRNS_1:25;
            then (|.p.|)^2>0 by SQUARE_1:74;
            then (p`2)^2/(|.p.|)^2 <= 1 by A83,XCMPLX_1:60;
            then ((p`2)/|.p.|)^2 <= 1 by XCMPLX_1:77;
            then -1<=p`2/|.p.| by SQUARE_1:121;
            then -1-sn<=p`2/|.p.|-sn by XREAL_1:11;
            then -(-1-sn)>= -(p`2/|.p.|-sn) by XREAL_1:26;
            then
A90:        (-(p`2/|.p.|-sn))/(1+sn)<=1 by A84,XREAL_1:187;
            (p`2/|.p.|-sn)<=0 by A82,XREAL_1:49;
            then -1<=(-( p`2/|.p.|-sn))/(1+sn) by A84;
            then ((-(p`2/|.p.|-sn))/(1+sn))^2<=1^2 by A90,SQUARE_1:119;
            then 1-((-(p`2/|.p.|-sn))/(1+sn))^2>=0 by XREAL_1:50;
            then
A91:        1-(-((p`2/|.p.|-sn))/(1+sn))^2>=0 by XCMPLX_1:188;
            p4`1= |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)) by EUCLID:56;
            then
A92:        (p4`1)^2= (|.p.|)^2*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2))^2
              .= (|.p.|)^2*(1-((p`2/|.p.|-sn)/(1+sn))^2) by A91,SQUARE_1:
            def 4;
            (|.p4.|)^2=(p4`1)^2+(p4`2)^2 by JGRAPH_3:10
              .=(|.p.|)^2 by A89,A92;
            then
A93:        sqrt((|.p4.|)^2)=|.p.| by SQUARE_1:89;
            then
A94:        |.p4.|=|.p.| by SQUARE_1:89;
            (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
              .=(|.q.|)^2 by A88,A87;
            then
A95:        sqrt((|.q4.|)^2)=|.q.| by SQUARE_1:89;
            then
A96:        |.q4.|=|.q.| by SQUARE_1:89;
A97:        sn -FanMorphE.p= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)
            ), |.p.|* ((p`2/|.p.|-sn)/(1+sn))]| by A1,A2,A82,Th91;
            then ((p`2/|.p.|-sn)/(1+sn)) =|.q.|* ((q`2/|.q.|-sn)/(1+sn))/|.p
            .| by A5,A68,A67,A82,A89,TOPRNS_1:25,XCMPLX_1:90;
            then (p`2/|.p.|-sn)/(1+sn)=(q`2/|.q.|-sn)/(1+sn) by A5,A68,A82,
            A97,A95,A93,TOPRNS_1:25,XCMPLX_1:90;
            then (p`2/|.p.|-sn)/(1+sn)*(1+sn)=q`2/|.q.|-sn by A84,
            XCMPLX_1:88;
            then p`2/|.p.|-sn=q`2/|.q.|-sn by A84,XCMPLX_1:88;
            then p`2/|.p.|*|.p.|=q`2 by A5,A68,A82,A97,A96,A94,
            TOPRNS_1:25,XCMPLX_1:88;
            then
A98:        p`2=q`2 by A82,TOPRNS_1:25,XCMPLX_1:88;
A99:        p=|[p`1,p`2]| by EUCLID:57;
            |.p.|^2=(p`1)^2+(p`2)^2 & |.q.|^2=(q`1)^2+(q`2)^2 by
            JGRAPH_3:10;
            then p`1=sqrt((q`1)^2) by A5,A68,A82,A97,A96,A94,A98,
            SQUARE_1:89;
            then p`1=q`1 by A64,SQUARE_1:89;
            hence thesis by A98,A99,EUCLID:57;
          end;
        end;
        hence thesis;
      end;
    end;
    hence thesis;
  end;
  hence thesis by FUNCT_1:def 8;
end;

theorem Th110:
  for sn being Real st -1<sn & sn<1 holds (sn-FanMorphE) is
  Function of TOP-REAL 2,TOP-REAL 2 & rng (sn-FanMorphE) = the carrier of
  TOP-REAL 2
proof
  let sn be Real;
  assume that
A1: -1<sn and
A2: sn<1;
  thus (sn-FanMorphE) is Function of TOP-REAL 2,TOP-REAL 2;
  for f being Function of TOP-REAL 2,TOP-REAL 2 st f=(sn-FanMorphE) holds
  rng (sn-FanMorphE)=the carrier of TOP-REAL 2
  proof
    let f be Function of TOP-REAL 2,TOP-REAL 2;
    assume
A3: f=(sn-FanMorphE);
A4: dom f=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
    the carrier of TOP-REAL 2 c= rng f
    proof
      let y be set;
      assume
      y in the carrier of TOP-REAL 2;
      then reconsider p2=y as Point of TOP-REAL 2;
      set q=p2;
      now
        per cases by JGRAPH_2:11;
        suppose
          q`1<=0;
          then y=(sn-FanMorphE).q by Th89;
          hence ex x being set st x in dom (sn-FanMorphE) & y=(sn-FanMorphE).x
          by A3,A4;
        end;
        suppose
A5:       q`2/|.q.|>=0 & q`1>=0 & q<>0.TOP-REAL 2;
          --(1+sn)>0 by A1,XREAL_1:150;
          then
A6:       -(-1-sn)>0;
A7:       1-sn>=0 by A2,XREAL_1:151;
          then q`2/|.q.|*(1-sn)>=0 by A5;
          then -1-sn<= q`2/|.q.|*(1-sn) by A6;
          then
A8:       -1-sn+sn<= q`2/|.q.|*(1-sn)+sn by XREAL_1:9;
          set px=|[ (|.q.|)*sqrt(1-(q`2/|.q.|*(1-sn)+sn)^2), |.q.|*(q`2/|.q.|*
          (1-sn)+sn)]|;
A9:       px`2 = |.q.|*(q`2/|.q.|*(1-sn)+sn) by EUCLID:56;
          |.q.|<>0 by A5,TOPRNS_1:25;
          then
A10:      |.q.|^2>0 by SQUARE_1:74;
A11:      dom (sn-FanMorphE)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
A12:      1-sn>0 by A2,XREAL_1:151;
          0<=(q`1)^2 by XREAL_1:65;
          then (|.q.|)^2 =(q`1)^2+(q`2)^2 & 0+(q`2)^2<=(q`1)^2+(q`2)^2 by
          JGRAPH_3:10 ,XREAL_1:9;
          then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by XREAL_1:74;
          then (q`2)^2/(|.q.|)^2 <= 1 by A10,XCMPLX_1:60;
          then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
          then q`2/|.q.|<=1 by SQUARE_1:121;
          then q`2/|.q.|*(1-sn) <= 1 *(1-sn) by A12,XREAL_1:66;
          then q`2/|.q.|*(1-sn)+sn-sn <=1-sn;
          then (q`2/|.q.|*(1-sn)+sn) <=1 by XREAL_1:11;
          then 1^2>=(q`2/|.q.|*(1-sn)+sn)^2 by A8,SQUARE_1:119;
          then
A13:      1-(q`2/|.q.|*(1-sn)+sn)^2>=0 by XREAL_1:50;
          then
A14:      sqrt(1-(q`2/|.q.|*(1-sn)+sn)^2)>=0 by SQUARE_1:def 4;
A15:      px`1 = (|.q.|)*sqrt(1-(q`2/|.q.|*(1-sn)+sn)^2) by EUCLID:56;
          then
          |.px.|^2=((|.q.|)*sqrt(1-(q`2/|.q.|*(1-sn)+sn)^2))^2 +(|.q.|*(q
          `2/|.q.|*(1-sn)+sn))^2 by A9,JGRAPH_3:10
            .=(|.q.|)^2*(sqrt(1-(q`2/|.q.|*(1-sn)+sn)^2))^2 +(|.q.|)^2*((q`2
          /|.q.|*(1-sn)+sn))^2;
          then
A16:      |.px.|^2=(|.q.|)^2*(1-(q`2/|.q.|*(1-sn)+sn)^2) +(|.q.|)^2*((q`2
          /|.q.|*(1-sn)+sn))^2 by A13,SQUARE_1:def 4
            .= (|.q.|)^2;
          then
A17:      |.px.|=sqrt(|.q.|^2) by SQUARE_1:89
            .=|.q.| by SQUARE_1:89;
          then
A18:      px<>0.TOP-REAL 2 by A5,TOPRNS_1:24,25;
          (q`2/|.q.|*(1-sn)+sn)>=0+sn by A5,A7,XREAL_1:9;
          then px`2/|.px.| >=sn by A5,A9,A17,TOPRNS_1:25,XCMPLX_1:90;
          then
A19:      (sn-FanMorphE).px =|[ |.px.|*(sqrt(1-((px`2/|.px.|-sn) /(1-sn))
          ^2)), |.px.|* ((px`2/|.px.|-sn)/(1-sn))]| by A1,A2,A15,A14,A18,Th91;
A20:      |.px.|*(sqrt((q`1/|.q.|)^2))=|.q.|*(q`1/|.q.|) by A5,A17,
          SQUARE_1:89
            .=q`1 by A5,TOPRNS_1:25,XCMPLX_1:88;
A21:      |.px.|* ((px`2/|.px.|-sn)/(1-sn)) =|.q.|* (( ((q`2/|.q.|*(1-sn)
          +sn))-sn)/(1-sn)) by A5,A9,A17,TOPRNS_1:25 ,XCMPLX_1:90
            .=|.q.|* ( q`2/|.q.|) by A12,XCMPLX_1:90
            .= q`2 by A5,TOPRNS_1:25,XCMPLX_1:88;
          then
          |.px.|*(sqrt(1-((px`2/|.px.|-sn)/(1-sn))^2)) = |.px.|*(sqrt(1-(
          q`2/|.px.|)^2)) by A5,A17,TOPRNS_1:25 ,XCMPLX_1:90
            .= |.px.|*(sqrt(1-(q`2)^2/(|.px.|)^2)) by XCMPLX_1:77
            .= |.px.|*(sqrt( (|.px.|)^2/(|.px.|)^2-(q`2)^2/(|.px.|)^2)) by
          A10,A16,XCMPLX_1:60
            .= |.px.|*(sqrt( ((|.px.|)^2-(q`2)^2)/(|.px.|)^2)) by XCMPLX_1:
          121
            .= |.px.|*(sqrt( ((q`1)^2+(q`2)^2-(q`2)^2)/(|.px.|)^2)) by A16,
          JGRAPH_3:10
            .= |.px.|*(sqrt((q`1/|.q.|)^2)) by A17,XCMPLX_1:77;
          hence ex x being set st x in dom (sn-FanMorphE) & y=(sn-FanMorphE).x
          by A19,A21,A20,A11,EUCLID:57;
        end;
        suppose
A22:      q`2/|.q.|<0 & q`1>=0 & q<>0.TOP-REAL 2;
A23:      1+sn>=0 by A1,XREAL_1:150;
          (1-sn)>0 by A2,XREAL_1:151;
          then
A24:      1-sn+sn>= q`2/|.q.|*(1+sn)+sn by A22,A23,XREAL_1:9;
A25:      1+sn>0 by A1,XREAL_1:150;
          |.q.|<>0 by A22,TOPRNS_1:25;
          then
A26:      |.q.|^2>0 by SQUARE_1:74;
          0<=(q`1)^2 by XREAL_1:65;
          then (|.q.|)^2 =(q`1)^2+(q`2)^2 & 0+(q`2)^2<=(q`1)^2+(q`2)^2 by
          JGRAPH_3:10 ,XREAL_1:9;
          then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by XREAL_1:74;
          then (q`2)^2/(|.q.|)^2 <= 1 by A26,XCMPLX_1:60;
          then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
          then q`2/|.q.|>=-1 by SQUARE_1:121;
          then q`2/|.q.|*(1+sn) >=(-1)*(1+sn) by A25,XREAL_1:66;
          then q`2/|.q.|*(1+sn)+sn-sn >=-1-sn;
          then (q`2/|.q.|*(1+sn)+sn) >=-1 by XREAL_1:11;
          then 1^2>=(q`2/|.q.|*(1+sn)+sn)^2 by A24,SQUARE_1:119;
          then
A27:      1-(q`2/|.q.|*(1+sn)+sn)^2>=0 by XREAL_1:50;
          then
A28:      sqrt(1-(q`2/|.q.|*(1+sn)+sn)^2)>=0 by SQUARE_1:def 4;
A29:      dom (sn-FanMorphE)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
          set px=|[ (|.q.|)*sqrt(1-(q`2/|.q.|*(1+sn)+sn)^2), |.q.|*(q`2/|.q.|*
          (1+sn)+sn)]|;
A30:      px`2 = |.q.|*(q`2/|.q.|*(1+sn)+sn) by EUCLID:56;
A31:      px`1 = (|.q.|)*sqrt(1-(q`2/|.q.|*(1+sn)+sn)^2) by EUCLID:56;
          then
          |.px.|^2=((|.q.|)*sqrt(1-(q`2/|.q.|*(1+sn)+sn)^2))^2 +(|.q.|*(q
          `2/|.q.|*(1+sn)+sn))^2 by A30,JGRAPH_3:10
            .=(|.q.|)^2*(sqrt(1-(q`2/|.q.|*(1+sn)+sn)^2))^2 +(|.q.|)^2*((q`2
          /|.q.|*(1+sn)+sn))^2;
          then
A32:      |.px.|^2=(|.q.|)^2*(1-(q`2/|.q.|*(1+sn)+sn)^2) +(|.q.|)^2*((q`2
          /|.q.|*(1+sn)+sn))^2 by A27,SQUARE_1:def 4
            .= (|.q.|)^2;
          then
A33:      |.px.|=sqrt(|.q.|^2) by SQUARE_1:89
            .=|.q.| by SQUARE_1:89;
          then
A34:      px<>0.TOP-REAL 2 by A22,TOPRNS_1:24,25;
          (q`2/|.q.|*(1+sn)+sn)<=0+sn by A22,A23,XREAL_1:9;
          then px`2/|.px.| <=sn by A22,A30,A33,TOPRNS_1:25,XCMPLX_1:90;
          then
A35:      (sn-FanMorphE).px =|[ |.px.|*(sqrt(1-((px`2/|.px.|-sn) /(1+sn))
          ^2)), |.px.|* ((px`2/|.px.|-sn)/(1+sn))]| by A1,A2,A31,A28,A34,Th91;
A36:      |.px.|*(sqrt((q`1/|.q.|)^2)) =|.q.|*(q`1/|.q.|) by A22,A33,
          SQUARE_1:89
            .=q`1 by A22,TOPRNS_1:25,XCMPLX_1:88;
A37:      |.px.|* ((px`2/|.px.|-sn)/(1+sn)) =|.q.|* (( ((q`2/|.q.|*(1+sn)
          +sn))-sn)/(1+sn)) by A22,A30,A33,TOPRNS_1:25 ,XCMPLX_1:90
            .=|.q.|* ( q`2/|.q.|) by A25,XCMPLX_1:90
            .= q`2 by A22,TOPRNS_1:25,XCMPLX_1:88;
          then
          |.px.|*(sqrt(1-((px`2/|.px.|-sn)/(1+sn))^2)) = |.px.|*(sqrt(1-(
          q`2/|.px.|)^2)) by A22,A33,TOPRNS_1:25 ,XCMPLX_1:90
            .= |.px.|*(sqrt(1-(q`2)^2/(|.px.|)^2)) by XCMPLX_1:77
            .= |.px.|*(sqrt( (|.px.|)^2/(|.px.|)^2-(q`2)^2/(|.px.|)^2)) by
          A26,A32,XCMPLX_1:60
            .= |.px.|*(sqrt( ((|.px.|)^2-(q`2)^2)/(|.px.|)^2)) by XCMPLX_1:
          121
            .= |.px.|*(sqrt( ((q`1)^2+(q`2)^2-(q`2)^2)/(|.px.|)^2)) by A32,
          JGRAPH_3:10
            .= |.px.|*(sqrt((q`1/|.q.|)^2)) by A33,XCMPLX_1:77;
          hence ex x being set st x in dom (sn-FanMorphE) & y=(sn-FanMorphE).x
          by A35,A37,A36,A29,EUCLID:57;
        end;
      end;
      hence thesis by A3,FUNCT_1:def 5;
    end;
    hence thesis by A3,XBOOLE_0:def 10;
  end;
  hence thesis;
end;

theorem Th111:
  for sn being Real,p2 being Point of TOP-REAL 2 st -1<sn & sn<1
ex K being non empty compact Subset of TOP-REAL 2 st K = (sn-FanMorphE).:K & ex
  V2 being Subset of TOP-REAL 2 st p2 in V2 & V2 is open & V2 c= K & (sn
  -FanMorphE).p2 in V2
proof
  reconsider O=0.TOP-REAL 2 as Point of Euclid 2 by EUCLID:71;
  let sn be Real,p2 be Point of TOP-REAL 2;
A1: the TopStruct of TOP-REAL 2 = TopSpaceMetr Euclid 2 by EUCLID:def 8;
  the TopStruct of TOP-REAL 2 = TopSpaceMetr Euclid 2 by EUCLID:def 8;
  then reconsider V0=Ball(O,|.p2.|+1) as Subset of TOP-REAL 2;
  O in V0 & V0 c= cl_Ball(O,|.p2.|+1) by GOBOARD6:4,METRIC_1:15;
  then reconsider
  K0=cl_Ball(O,|.p2.|+1) as non empty compact Subset of TOP-REAL 2
  by A1,Th22;
  set q3= (sn-FanMorphE).p2;
  reconsider VV0 = V0 as Subset of TopSpaceMetr Euclid 2;
  reconsider u2=p2 as Point of Euclid 2 by EUCLID:71;
  reconsider u3=q3 as Point of Euclid 2 by EUCLID:71;
A2: (sn-FanMorphE).:K0 c= K0
  proof
    let y be set;
    assume
    y in (sn-FanMorphE).:K0;
    then consider x being set such that
A3: x in dom (sn-FanMorphE) and
A4: x in K0 and
A5: y=(sn-FanMorphE).x by FUNCT_1:def 12;
    reconsider q=x as Point of TOP-REAL 2 by A3;
    reconsider uq=q as Point of Euclid 2 by EUCLID:71;
    dist(O,uq)<= |.p2.|+1 by A4,METRIC_1:13;
    then |.0.TOP-REAL 2 - q.|<= |.p2.|+1 by JGRAPH_1:45;
    then |. -q.|<= |.p2.|+1 by EUCLID:31;
    then
A6: |.q.|<= |.p2.|+1 by TOPRNS_1:27;
A7: y in rng (sn-FanMorphE) by A3,A5,FUNCT_1:def 5;
    then reconsider u=y as Point of Euclid 2 by EUCLID:71;
    reconsider q4=y as Point of TOP-REAL 2 by A7;
    |.q4.|=|.q.| by A5,Th104;
    then |. -q4.|<= |.p2.|+1 by A6,TOPRNS_1:27;
    then |.0.TOP-REAL 2 - q4.|<= |.p2.|+1 by EUCLID:31;
    then dist(O,u)<= |.p2.|+1 by JGRAPH_1:45;
    hence thesis by METRIC_1:13;
  end;
  VV0 is open by TOPMETR:21;
  then
A8: V0 is open by Lm11,PRE_TOPC:60;
A9: |. p2.|<|.p2.|+1 by XREAL_1:31;
  then |. -p2.|<|.p2.|+1 by TOPRNS_1:27;
  then |.0.TOP-REAL 2 - p2.|<|.p2.|+1 by EUCLID:31;
  then dist(O,u2)<|.p2.|+1 by JGRAPH_1:45;
  then
A10: p2 in V0 by METRIC_1:12;
  |.q3.|=|.p2.| by Th104;
  then |. -q3.|<|.p2.|+1 by A9,TOPRNS_1:27;
  then |.0.TOP-REAL 2 - q3.|<|.p2.|+1 by EUCLID:31;
  then dist(O,u3)< |.p2.|+1 by JGRAPH_1:45;
  then
A11: (sn-FanMorphE).p2 in V0 by METRIC_1:12;
  assume
A12: -1<sn & sn<1;
  K0 c= (sn-FanMorphE).:K0
  proof
    let y be set;
    assume
A13: y in K0;
    then reconsider q4=y as Point of TOP-REAL 2;
    reconsider y as Point of Euclid 2 by A13;
    the carrier of TOP-REAL 2 c= rng (sn-FanMorphE) by A12,Th110;
    then q4 in rng (sn-FanMorphE) by TARSKI:def 3;
    then consider x being set such that
A14: x in dom (sn-FanMorphE) and
A15: y=(sn-FanMorphE).x by FUNCT_1:def 5;
    reconsider x as Point of Euclid 2 by A14,Lm11;
    reconsider q=x as Point of TOP-REAL 2 by A14;
    |.q4.|=|.q.| by A15,Th104;
    then q in K0 by A13,Lm12;
    hence thesis by A14,A15,FUNCT_1:def 12;
  end;
  then K0= (sn-FanMorphE).:K0 by A2,XBOOLE_0:def 10;
  hence thesis by A10,A8,A11,METRIC_1:15;
end;

theorem
  for sn being Real st -1<sn & sn<1 ex f being Function of TOP-REAL 2,
  TOP-REAL 2 st f=(sn-FanMorphE) & f is being_homeomorphism
proof
  let sn be Real;
  reconsider f=(sn-FanMorphE) as Function of TOP-REAL 2,TOP-REAL 2;
  assume
A1: -1<sn & sn<1;
  then
A2: for p2 being Point of TOP-REAL 2 ex K being non empty compact Subset of
  TOP-REAL 2 st K = f.:K & ex V2 being Subset of TOP-REAL 2 st p2 in V2 & V2 is
  open & V2 c= K & f.p2 in V2 by Th111;
  rng (sn-FanMorphE) = the carrier of TOP-REAL 2 & ex h being Function of
( TOP-REAL 2),(TOP-REAL 2) st h=( sn-FanMorphE) & h is continuous by A1, Th108,
  Th110;
  then f is being_homeomorphism by A1,A2,Th8,Th109;
  hence thesis;
end;

theorem Th113:
  for sn being Real,q being Point of TOP-REAL 2 st sn<1 & q`1>0 &
q`2/|.q.|>=sn holds for p being Point of TOP-REAL 2 st p=(sn-FanMorphE).q holds
  p`1>0 & p`2>=0
proof
  let sn be Real,q be Point of TOP-REAL 2;
  assume that
A1: sn<1 and
A2: q`1>0 and
A3: q`2/|.q.|>=sn;
A4: (q`2/|.q.|-sn)>= 0 by A3,XREAL_1:50;
  let p be Point of TOP-REAL 2;
  set qz=p;
A5: 1-sn>0 by A1,XREAL_1:151;
A6: |.q.|<>0 by A2,JGRAPH_2:11,TOPRNS_1:25;
  then
A7: (|.q.|)^2>0 by SQUARE_1:74;
  (|.q.|)^2 =(q`1)^2+(q`2)^2 & 0+(q`2)^2<(q`1)^2+(q`2)^2 by A2,JGRAPH_3:
  10 ,SQUARE_1:74,XREAL_1:10;
  then (q`2)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A7,XREAL_1:76;
  then (q`2)^2/(|.q.|)^2 < 1 by A7,XCMPLX_1:60;
  then ((q`2)/|.q.|)^2 < 1 by XCMPLX_1:77;
  then 1>q`2/|.q.| by SQUARE_1:122;
  then 1-sn>q`2/|.q.|-sn by XREAL_1:11;
  then -(1-sn)< -( q`2/|.q.|-sn) by XREAL_1:26;
  then (-(1-sn))/(1-sn)<(-( q`2/|.q.|-sn))/(1-sn) by A5,XREAL_1:76;
  then -1<(-( q`2/|.q.|-sn))/(1-sn) by A5,XCMPLX_1:198;
  then ((-(q`2/|.q.|-sn))/(1-sn))^2<1^2 by A5,A4,SQUARE_1:120;
  then 1-((-(q`2/|.q.|-sn))/(1-sn))^2>0 by XREAL_1:52;
  then sqrt(1-((-(q`2/|.q.|-sn))/(1-sn))^2)>0 by SQUARE_1:93;
  then sqrt(1-(-(q`2/|.q.|-sn))^2/(1-sn)^2)> 0 by XCMPLX_1:77;
  then sqrt(1-(q`2/|.q.|-sn)^2/(1-sn)^2)> 0;
  then
A8: sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)> 0 by XCMPLX_1:77;
  assume
  p=(sn-FanMorphE).q;
  then
A9: p=|[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)), |.q.|* ((q`2/|.q.|-sn)/(
  1-sn))]| by A2,A3,Th89;
  then qz`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)) by EUCLID:56;
  hence thesis by A9,A6,A5,A4,A8,EUCLID:56,XREAL_1:131;
end;

theorem Th114:
  for sn being Real,q being Point of TOP-REAL 2 st -1<sn & q`1>0
  & q`2/|.q.|<sn holds for p being Point of TOP-REAL 2 st p=(sn-FanMorphE).q
  holds p`1>0 & p`2<0
proof
  let sn be Real,q be Point of TOP-REAL 2;
  assume that
A1: -1<sn and
A2: q`1>0 and
A3: q`2/|.q.|<sn;
A4: 1+sn>0 by A1,XREAL_1:150;
  let p be Point of TOP-REAL 2;
  set qz=p;
  assume
  p=(sn-FanMorphE).q;
  then
  p=|[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)), |.q.|* ((q`2/|.q.|-sn)/(
  1+sn))]| by A2,A3,Th90;
  then
A5: qz`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)) & qz`2= |.q.|* ((q`2/|.
  q.|- sn)/(1+sn)) by EUCLID:56;
A6: |.q.|<>0 by A2,JGRAPH_2:11,TOPRNS_1:25;
  then
A7: (|.q.|)^2>0 by SQUARE_1:74;
A8: (q`2/|.q.|-sn)< 0 by A3,XREAL_1:51;
  then -( q`2/|.q.|-sn)>0 by XREAL_1:60;
  then (-(1+sn))/(1+sn)<(-( q`2/|.q.|-sn))/(1+sn) by A4,XREAL_1:76;
  then
A9: -1<(-( q`2/|.q.|-sn))/(1+sn) by A4,XCMPLX_1:198;
  (|.q.|)^2 =(q`1)^2+(q`2)^2 & 0+(q`2)^2<(q`1)^2+(q`2)^2 by A2,JGRAPH_3:
  10 ,SQUARE_1:74,XREAL_1:10;
  then (q`2)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A7,XREAL_1:76;
  then (q`2)^2/(|.q.|)^2 < 1 by A7,XCMPLX_1:60;
  then ((q`2)/|.q.|)^2 < 1 by XCMPLX_1:77;
  then -1<q`2/|.q.| by SQUARE_1:122;
  then -1-sn<q`2/|.q.|-sn by XREAL_1:11;
  then --(1+sn)> -(q`2/|.q.|-sn) by XREAL_1:26;
  then (-(q`2/|.q.|-sn))/(1+sn)<1 by A4,XREAL_1:193;
  then ((-(q`2/|.q.|-sn))/(1+sn))^2<1^2 by A9,SQUARE_1:120;
  then 1-((-(q`2/|.q.|-sn))/(1+sn))^2>0 by XREAL_1:52;
  then sqrt(1-((-(q`2/|.q.|-sn))/(1+sn))^2)>0 by SQUARE_1:93;
  then sqrt(1-(-(q`2/|.q.|-sn))^2/(1+sn)^2)> 0 by XCMPLX_1:77;
  then sqrt(1-(q`2/|.q.|-sn)^2/(1+sn)^2)> 0;
  then
A10: sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)> 0 by XCMPLX_1:77;
  ((q`2/|.q.|-sn)/(1+sn))<0 by A1,A8,XREAL_1:143,150;
  hence thesis by A6,A5,A10,XREAL_1:131,134;
end;

theorem Th115:
  for sn being Real,q1,q2 being Point of TOP-REAL 2 st sn<1 & q1
  `1>0 & q1`2/|.q1.|>=sn & q2`1>0 & q2`2/|.q2.|>=sn & q1`2/|.q1.|<q2`2/|.q2.|
  holds for p1,p2 being Point of TOP-REAL 2 st p1=(sn-FanMorphE).q1 & p2=(sn
  -FanMorphE).q2 holds p1`2/|.p1.|<p2`2/|.p2.|
proof
  let sn be Real,q1,q2 be Point of TOP-REAL 2;
  assume that
A1: sn<1 and
A2: q1`1>0 and
A3: q1`2/|.q1.|>=sn and
A4: q2`1>0 and
A5: q2`2/|.q2.|>=sn and
A6: q1`2/|.q1.|<q2`2/|.q2.|;
A7: q1`2/|.q1.|-sn< q2`2/|.q2.|-sn & 1-sn>0 by A1,A6,XREAL_1:11,151;
  let p1,p2 be Point of TOP-REAL 2;
  assume that
A8: p1=(sn-FanMorphE).q1 and
A9: p2=(sn-FanMorphE).q2;
A10: |.p2.|=|.q2.| by A9,Th104;
  p2=|[ |.q2.|*(sqrt(1-((q2`2/|.q2.|-sn)/(1-sn))^2)), |.q2.|* ((q2`2/|.q2
  .|-sn)/(1-sn))]| by A4,A5,A9,Th89;
  then
A11: p2`2= |.q2.|* ((q2`2/|.q2.|-sn)/(1-sn)) by EUCLID:56;
  |.q2.|>0 by A4,Lm1,JGRAPH_2:11;
  then
A12: p2`2/|.p2.|= ((q2`2/|.q2.|-sn)/(1-sn)) by A11,A10,XCMPLX_1:90;
  p1=|[ |.q1.|*(sqrt(1-((q1`2/|.q1.|-sn)/(1-sn))^2)), |.q1.|* ((q1`2/|.q1
  .|-sn)/(1-sn))]| by A2,A3,A8,Th89;
  then
A13: p1`2= |.q1.|* ((q1`2/|.q1.|-sn)/(1-sn)) by EUCLID:56;
A14: |.p1.|=|.q1.| by A8,Th104;
  |.q1.|>0 by A2,Lm1,JGRAPH_2:11;
  then p1`2/|.p1.|= ((q1`2/|.q1.|-sn)/(1-sn)) by A13,A14,XCMPLX_1:90;
  hence thesis by A12,A7,XREAL_1:76;
end;

theorem Th116:
  for sn being Real,q1,q2 being Point of TOP-REAL 2 st -1<sn & q1
`1>0 & q1`2/|.q1.|<sn & q2`1>0 & q2`2/|.q2.|<sn & q1`2/|.q1.|<q2`2/|.q2.| holds
for p1,p2 being Point of TOP-REAL 2 st p1=(sn-FanMorphE).q1 & p2=(sn-FanMorphE)
  .q2 holds p1`2/|.p1.|<p2`2/|.p2.|
proof
  let sn be Real,q1,q2 be Point of TOP-REAL 2;
  assume that
A1: -1<sn and
A2: q1`1>0 and
A3: q1`2/|.q1.|<sn and
A4: q2`1>0 and
A5: q2`2/|.q2.|<sn and
A6: q1`2/|.q1.|<q2`2/|.q2.|;
A7: q1`2/|.q1.|-sn< q2`2/|.q2.|-sn & 1+sn>0 by A1,A6,XREAL_1:11,150;
  let p1,p2 be Point of TOP-REAL 2;
  assume that
A8: p1=(sn-FanMorphE).q1 and
A9: p2=(sn-FanMorphE).q2;
A10: |.p2.|=|.q2.| by A9,Th104;
  p2=|[ |.q2.|*(sqrt(1-((q2`2/|.q2.|-sn)/(1+sn))^2)), |.q2.|* ((q2`2/|.q2
  .|-sn)/(1+sn))]| by A4,A5,A9,Th90;
  then
A11: p2`2= |.q2.|* ((q2`2/|.q2.|-sn)/(1+sn)) by EUCLID:56;
  |.q2.|>0 by A4,Lm1,JGRAPH_2:11;
  then
A12: p2`2/|.p2.|= (q2`2/|.q2.|-sn)/(1+sn) by A11,A10,XCMPLX_1:90;
  p1=|[ |.q1.|*(sqrt(1-((q1`2/|.q1.|-sn)/(1+sn))^2)), |.q1.|* ((q1`2/|.q1
  .|-sn)/(1+sn))]| by A2,A3,A8,Th90;
  then
A13: p1`2= |.q1.|* ((q1`2/|.q1.|-sn)/(1+sn)) by EUCLID:56;
A14: |.p1.|=|.q1.| by A8,Th104;
  |.q1.|>0 by A2,Lm1,JGRAPH_2:11;
  then p1`2/|.p1.|= (q1`2/|.q1.|-sn)/(1+sn) by A13,A14,XCMPLX_1:90;
  hence thesis by A12,A7,XREAL_1:76;
end;

theorem
  for sn being Real,q1,q2 being Point of TOP-REAL 2 st -1<sn & sn<1 & q1
`1>0 & q2`1>0 & q1`2/|.q1.|<q2`2/|.q2.| holds for p1,p2 being Point of TOP-REAL
2 st p1=(sn-FanMorphE).q1 & p2=(sn-FanMorphE).q2 holds p1`2/|.p1.|<p2`2/|.p2.|
proof
  let sn be Real,q1,q2 be Point of TOP-REAL 2;
  assume that
A1: -1<sn and
A2: sn<1 and
A3: q1`1>0 and
A4: q2`1>0 and
A5: q1`2/|.q1.|<q2`2/|.q2.|;
  let p1,p2 be Point of TOP-REAL 2;
  assume that
A6: p1=(sn-FanMorphE).q1 and
A7: p2=(sn-FanMorphE).q2;
  per cases;
  suppose
    q1`2/|.q1.|>=sn & q2`2/|.q2.|>=sn;
    hence thesis by A2,A3,A4,A5,A6,A7,Th115;
  end;
  suppose
    q1`2/|.q1.|>=sn & q2`2/|.q2.|<sn;
    hence thesis by A5,XXREAL_0:2;
  end;
  suppose
A8: q1`2/|.q1.|<sn & q2`2/|.q2.|>=sn;
    then p2`2>=0 by A2,A4,A7,Th113;
    then
A9: p2`2/|.p2.|>=0;
    p1`2<0 by A1,A3,A6,A8,Th114;
    hence thesis by A9,Lm1,JGRAPH_2:11,XREAL_1:143;
  end;
  suppose
    q1`2/|.q1.|<sn & q2`2/|.q2.|<sn;
    hence thesis by A1,A3,A4,A5,A6,A7,Th116;
  end;
end;

theorem
  for sn being Real,q being Point of TOP-REAL 2 st q`1>0 & q`2/|.q.|=sn
holds for p being Point of TOP-REAL 2 st p=(sn-FanMorphE).q holds p`1>0 & p`2=0
proof
  let sn be Real,q be Point of TOP-REAL 2;
  assume that
A1: q`1>0 and
A2: q`2/|.q.|=sn;
A3: |.q.|<>0 & sqrt(1-((-(q`2/|.q.|-sn))/(1-sn))^2)>0 by A1,A2,JGRAPH_2:11 ,
  SQUARE_1:93,TOPRNS_1:25;
  let p be Point of TOP-REAL 2;
  assume
  p=(sn-FanMorphE).q;
  then
A4: p=|[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)), |.q.|* ((q`2/|.q.|-sn)/(
  1-sn))]| by A1,A2,Th89;
  then p`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)) by EUCLID:56;
  hence thesis by A2,A4,A3,EUCLID:56,XREAL_1:131;
end;

theorem
  for sn being real number holds 0.TOP-REAL 2=(sn-FanMorphE).(0.TOP-REAL
  2) by Th89,JGRAPH_2:11;

begin :: Fan Morphism for South

definition
  let s be real number, q be Point of TOP-REAL 2;
  func FanS(s,q) -> Point of TOP-REAL 2 equals
  :Def8:
  |.q.|*|[(q`1/|.q.|-s)/(1
-s), -sqrt(1-((q`1/|.q.|-s)/(1-s))^2)]| if q`1/|.q.|>=s & q`2<0, |.q.|*|[(q`1/
  |.q.|-s)/(1+s), -sqrt(1-((q`1/|.q.|-s)/(1+s))^2)]| if q`1/|.q.|<s & q`2<0
  otherwise q;
  correctness;
end;

definition
  let c be real number;
  func c-FanMorphS -> Function of TOP-REAL 2, TOP-REAL 2 means
  :Def9:
  for q
  being Point of TOP-REAL 2 holds it.q=FanS(c,q);
  existence
  proof
    deffunc F(Point of TOP-REAL 2)=FanS(c,$1);
    thus ex IT being Function of TOP-REAL 2, TOP-REAL 2 st for q being Point
    of TOP-REAL 2 holds IT.q=F(q)from FUNCT_2:sch 4;
  end;
  uniqueness
  proof
    deffunc F(Point of TOP-REAL 2)=FanS(c,$1);
    thus for a,b being Function of TOP-REAL 2, TOP-REAL 2 st (for q being
Point of TOP-REAL 2 holds a.q=F(q)) & (for q being Point of TOP-REAL 2 holds b.
    q=F(q)) holds a=b from BINOP_2:sch 1;
  end;
end;

theorem Th120:
  for cn being real number holds (q`1/|.q.|>=cn & q`2<0 implies
cn-FanMorphS.q= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)), |.q.|*(-sqrt(1-((q`1/|.q.|-
  cn)/(1-cn))^2))]|)& (q`2>=0 implies cn-FanMorphS.q=q)
proof
  let cn be real number;
  hereby
    assume
    q`1/|.q.|>=cn & q`2<0;
    then
    FanS(cn,q)= |.q.|*|[(q`1/|.q.|-cn)/(1-cn), -sqrt(1-((q`1/|.q.|-cn)/(1-
    cn))^2)]| by Def8
      .= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)), |.q.|*(-sqrt(1-((q`1/|.q.|-cn)/(
    1-cn))^2))]| by EUCLID:62;
    hence
    cn-FanMorphS.q= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)), |.q.|*(-sqrt(1-((q
    `1/|.q.|-cn)/(1-cn))^2))]| by Def9;
  end;
  assume
A1: q`2>=0;
  cn-FanMorphS.q=FanS(cn,q) by Def9;
  hence thesis by A1,Def8;
end;

theorem Th121:
  for cn being Real holds (q`1/|.q.|<=cn & q`2<0 implies cn
-FanMorphS.q= |[ |.q.|*((q`1/|.q.|-cn)/(1+cn)), |.q.|*( -sqrt(1-((q`1/|.q.|-cn)
  /(1+cn))^2))]|)
proof
  let cn be Real;
  assume that
A1: q`1/|.q.|<=cn and
A2: q`2<0;
  per cases by A1,XXREAL_0:1;
  suppose
    q`1/|.q.|<cn;
    then
    FanS(cn,q)= |.q.|*|[(q`1/|.q.|-cn)/(1+cn), -sqrt(1-((q`1/|.q.|-cn)/(1+
    cn))^2)]| by A2,Def8
      .= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)), |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/
    (1+cn))^2))]| by EUCLID:62;
    hence thesis by Def9;
  end;
  suppose
A3: q`1/|.q.|=cn;
    then (q`1/|.q.|-cn)/(1-cn)=0;
    hence thesis by A2,A3,Th120;
  end;
end;

theorem Th122:
  for cn being Real st -1<cn & cn<1 holds (q`1/|.q.|>=cn & q`2<=0
  & q<>0.TOP-REAL 2 implies cn-FanMorphS.q = |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
|.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]|) & (q`1/|.q.|<=cn & q`2<=0 & q<>
0.TOP-REAL 2 implies cn-FanMorphS.q = |[ |.q.|*((q`1/|.q.|-cn)/(1+cn)), |.q.|*(
  -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]|)
proof
  let cn be Real;
  assume that
A1: -1<cn and
A2: cn<1;
  per cases;
  suppose
A3: q`1/|.q.|>=cn & q`2<=0 & q<>0.TOP-REAL 2;
    per cases;
    suppose
A4:   q`2<0;
      then
      FanS(cn,q)= |.q.|*|[(q`1/|.q.|-cn)/(1-cn), -sqrt(1-((q`1/|.q.|-cn)/(
      1-cn))^2)]| by A3,Def8
        .= |[|.q.|* ((q`1/|.q.|-cn)/(1-cn)), |.q.|*( -sqrt(1-((q`1/|.q.|-cn)
      /(1-cn))^2))]| by EUCLID:62;
      hence thesis by A4,Def9,Th121;
    end;
    suppose
A5:   q`2>=0;
      then
A6:   cn-FanMorphS.q=q by Th120;
A7:   (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
A8:   1-cn>0 by A2,XREAL_1:151;
A9:   q`2=0 by A3,A5;
      |.q.|<>0 by A3,TOPRNS_1:25;
      then |.q.|^2>0 by SQUARE_1:74;
      then (q`1)^2/|.q.|^2=1^2 by A7,A9,XCMPLX_1:60;
      then ((q`1)/|.q.|)^2=1^2 by XCMPLX_1:77;
      then
A10:  sqrt(((q`1)/|.q.|)^2)=1 by SQUARE_1:89;
A11:  now
        assume
        q`1<0;
        then -((q`1)/|.q.|)=1 by A10,SQUARE_1:90;
        hence contradiction by A1,A3;
      end;
      sqrt((|.q.|)^2)=|.q.| by SQUARE_1:89;
      then
A12:  |.q.|=q`1 by A7,A9,A11,SQUARE_1:89;
      then 1=q`1/|.q.| by A3,TOPRNS_1:25,XCMPLX_1:60;
      then (q`1/|.q.|-cn)/(1-cn)=1 by A8,XCMPLX_1:60;
      hence thesis by A2,A6,A9,A12,EUCLID:57,SQUARE_1:82,TOPRNS_1:25 ,
      XCMPLX_1:60;
    end;
  end;
  suppose
A13: q`1/|.q.|<=cn & q`2<=0 & q<>0.TOP-REAL 2;
    per cases;
    suppose
      q`2<0;
      hence thesis by Th120,Th121;
    end;
    suppose
A14:  q`2>=0;
      then
A15:  q`2=0 by A13;
A16:  1+cn>0 by A1,XREAL_1:150;
A17:  |.q.|<>0 by A13,TOPRNS_1:25;
      1>q`1/|.q.| by A2,A13,XXREAL_0:2;
      then 1 *(|.q.|)>q`1/|.q.|*(|.q.|) by A17,XREAL_1:70;
      then
A18:  (|.q.|)^2 =(q`1)^2+(q`2)^2 & (|.q.|)>q`1 by A13,JGRAPH_3:10,
      TOPRNS_1:25 ,XCMPLX_1:88;
      then
A19:  |.q.|=-q`1 by A15,SQUARE_1:109;
A20:  q`1= -(|.q.|) by A15,A18,SQUARE_1:109;
      then -1=q`1/|.q.| by A13,TOPRNS_1:25,XCMPLX_1:198;
      then (q`1/|.q.|-cn)/(1+cn) =(-(1+cn))/(1+cn)
        .=-1 by A16,XCMPLX_1:198;
      then
      |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)), |.q.|*(-sqrt(1-((q`1/|.q.|-cn)/(
      1+cn))^2))]| =q by A15,A19,EUCLID:57,SQUARE_1:82;
      hence thesis by A1,A14,A17,A20,Th120,XCMPLX_1:198;
    end;
  end;
  suppose
    q`2>0 or q=0.TOP-REAL 2;
    hence thesis;
  end;
end;

theorem Th123:
  for cn being Real,K1 being non empty Subset of TOP-REAL 2, f
being Function of (TOP-REAL 2)|K1,R^1 st cn<1 & (for p being Point of (TOP-REAL
2) st p in the carrier of (TOP-REAL 2)|K1 holds f.p=|.p.|* ((p`1/|.p.|-cn)/(1-
cn))) & (for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)|K1
  holds q`2<=0 & q<>0.TOP-REAL 2) holds f is continuous
proof
  let cn be Real,K1 be non empty Subset of TOP-REAL 2, f be Function of (
  TOP-REAL 2)|K1,R^1;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by
  Lm5;
  set a=cn, b=(1-cn);
  reconsider g2=proj1|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm2;
  assume that
A1: cn<1 and
A2: for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2
  )|K1 holds f.p=|.p.|* ((p`1/|.p.|-cn)/(1-cn)) and
A3: for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)
  |K1 holds q`2<=0 & q<>0.TOP-REAL 2;
  for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)|K1
  holds q<>0.TOP-REAL 2 by A3;
  then
A4: for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm6;
  b>0 by A1,XREAL_1:151;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
A5: for q being Point of (TOP-REAL 2)|K1,r1,r2 being Real st g2.q=r1 &
  g1.q =r2 holds g3.q=r2*((r1/r2-a)/b) and
A6: g3 is continuous by A4,Th10;
A7: dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then
A8: dom f=dom g3 by FUNCT_2:def 1;
  for x being set st x in dom f holds f.x=g3.x
  proof
    let x be set;
    assume
A9: x in dom f;
    then reconsider s=x as Point of (TOP-REAL 2)|K1;
    x in K1 by A7,A8,A9,PRE_TOPC:29;
    then reconsider r=x as Point of (TOP-REAL 2);
A10: proj1.r=r`1 & (2 NormF).r=|.r.| by Def1,PSCOMP_1:def 28;
A11: g2.s=proj1.s & g1.s=(2 NormF).s by Lm2,Lm5;
    f.r=(|.r.|)* ((r`1/|.r.|-cn)/(1-cn)) by A2,A9;
    hence thesis by A5,A11,A10;
  end;
  hence thesis by A6,A8,FUNCT_1:9;
end;

theorem Th124:
  for cn being Real,K1 being non empty Subset of TOP-REAL 2, f
  being Function of (TOP-REAL 2)|K1,R^1 st -1<cn & (for p being Point of (
TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1 holds f.p=|.p.|* ((p`1/|.p.|
  -cn)/(1+cn))) & (for q being Point of TOP-REAL 2 st q in the carrier of (
  TOP-REAL 2)|K1 holds q`2<=0 & q<>0.TOP-REAL 2) holds f is continuous
proof
  let cn be Real,K1 be non empty Subset of TOP-REAL 2, f be Function of (
  TOP-REAL 2)|K1,R^1;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by
  Lm5;
  set a=cn, b=1+cn;
  reconsider g2=proj1|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm2;
  assume that
A1: -1<cn and
A2: for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2
  )|K1 holds f.p=|.p.|* ((p`1/|.p.|-cn)/(1+cn)) and
A3: for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)
  |K1 holds q`2<=0 & q<>0.TOP-REAL 2;
  for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)|K1
  holds q<>0.TOP-REAL 2 by A3;
  then
A4: for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm6;
  1+cn>0 by A1,XREAL_1:150;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
A5: for q being Point of (TOP-REAL 2)|K1,r1,r2 being Real st g2.q=r1 &
  g1.q =r2 holds g3.q=r2*((r1/r2-a)/b) and
A6: g3 is continuous by A4,Th10;
A7: dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
A8: for x being set st x in dom f holds f.x=g3.x
  proof
    let x be set;
    assume
A9: x in dom f;
    then reconsider s=x as Point of (TOP-REAL 2)|K1;
    x in dom g3 by A7,A9;
    then x in K1 by A7,PRE_TOPC:29;
    then reconsider r=x as Point of (TOP-REAL 2);
A10: proj1.r=r`1 & (2 NormF).r=|.r.| by Def1,PSCOMP_1:def 28;
A11: g2.s=proj1.s & g1.s=(2 NormF).s by Lm2,Lm5;
    f.r=(|.r.|)* ((r`1/|.r.|-cn)/(1+cn)) by A2,A9;
    hence thesis by A5,A11,A10;
  end;
  dom f=dom g3 by A7,FUNCT_2:def 1;
  hence thesis by A6,A8,FUNCT_1:9;
end;

theorem Th125:
  for cn being Real,K1 being non empty Subset of TOP-REAL 2, f
being Function of (TOP-REAL 2)|K1,R^1 st cn<1 & (for p being Point of (TOP-REAL
2) st p in the carrier of (TOP-REAL 2)|K1 holds f.p=|.p.|*( -sqrt(1-((p`1/|.p.|
  -cn)/(1-cn))^2))) & (for q being Point of TOP-REAL 2 st q in the carrier of (
  TOP-REAL 2)|K1 holds q`2<=0 & q`1/|.q.|>=cn & q<>0.TOP-REAL 2) holds f is
  continuous
proof
  let cn be Real,K1 be non empty Subset of TOP-REAL 2, f be Function of (
  TOP-REAL 2)|K1,R^1;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by
  Lm5;
  set a=cn, b=1-cn;
  reconsider g2=proj1|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm2;
  assume that
A1: cn<1 and
A2: for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2
  )|K1 holds f.p=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)) and
A3: for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)
  |K1 holds q`2<=0 & q`1/|.q.|>=cn & q<>0.TOP-REAL 2;
  for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)|K1
  holds q<>0.TOP-REAL 2 by A3;
  then
A4: for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm6;
  b>0 by A1,XREAL_1:151;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
A5: for q being Point of (TOP-REAL 2)|K1,r1,r2 being real number st g2.q
  =r1 & g1.q=r2 holds g3.q=r2*( -sqrt(abs(1-((r1/r2-a)/b)^2))) and
A6: g3 is continuous by A4,Th14;
A7: dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then
A8: dom f=dom g3 by FUNCT_2:def 1;
  for x being set st x in dom f holds f.x=g3.x
  proof
    let x be set;
A9: 1-cn>0 by A1,XREAL_1:151;
    assume
A10: x in dom f;
    then x in K1 by A7,A8,PRE_TOPC:29;
    then reconsider r=x as Point of (TOP-REAL 2);
A11: |.r.|<>0 by A3,A10,TOPRNS_1:25;
    |.r.|^2=(r`1)^2+(r`2)^2 by JGRAPH_3:10;
    then
A12: ((r`1) -(|.r.|))*((r`1)+|.r.|) =-(r`2)^2;
    (r`2)^2>=0 by XREAL_1:65;
    then r`1<= |.r.| by A12,XREAL_1:95;
    then r`1/|.r.| <= |.r.|/|.r.| by XREAL_1:74;
    then r`1/|.r.|<=1 by A11,XCMPLX_1:60;
    then
A13: r`1/|.r.|-cn<=(1-cn) by XREAL_1:11;
    reconsider s=x as Point of (TOP-REAL 2)|K1 by A10;
A14: now
      assume
      (1-cn)^2=0;
      then 1-cn+cn=0+cn by XCMPLX_1:6;
      hence contradiction by A1;
    end;
    cn-r`1/|.r.|<=0 by A3,A10,XREAL_1:49;
    then -(cn- r`1/|.r.|)>=-(1-cn) by A9,XREAL_1:26;
    then (1-cn)^2>=0 & (r`1/|.r.|-cn)^2<=(1-cn)^2 by A13,SQUARE_1:119,
    XREAL_1:65;
    then (r`1/|.r.|-cn)^2/(1-cn)^2<=(1-cn)^2/(1-cn)^2 by XREAL_1:74;
    then (r`1/|.r.|-cn)^2/(1-cn)^2<=1 by A14,XCMPLX_1:60;
    then ((r`1/|.r.|-cn)/(1-cn))^2<=1 by XCMPLX_1:77;
    then 1-((r`1/|.r.|-cn)/(1-cn))^2>=0 by XREAL_1:50;
    then abs(1-((r`1/|.r.|-cn)/(1-cn))^2) =1-((r`1/|.r.|-cn)/(1-cn))^2 by
    ABSVALUE:def 1;
    then
A15: f.r=(|.r.|)*(-sqrt(abs(1-((r`1/|.r.|-cn)/(1-cn))^2))) by A2,A10;
A16: proj1.r=r`1 & (2 NormF).r=|.r.| by Def1,PSCOMP_1:def 28;
    g2.s=proj1.s & g1.s=(2 NormF).s by Lm2,Lm5;
    hence thesis by A5,A15,A16;
  end;
  hence thesis by A6,A8,FUNCT_1:9;
end;

theorem Th126:
  for cn being Real,K1 being non empty Subset of TOP-REAL 2, f
  being Function of (TOP-REAL 2)|K1,R^1 st -1<cn & (for p being Point of (
TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1 holds f.p=|.p.|*( -sqrt(1-((
  p`1/|.p.|-cn)/(1+cn))^2))) & (for q being Point of TOP-REAL 2 st q in the
  carrier of (TOP-REAL 2)|K1 holds q`2<=0 & q`1/|.q.|<=cn & q<>0.TOP-REAL 2)
  holds f is continuous
proof
  let cn be Real,K1 be non empty Subset of TOP-REAL 2, f be Function of (
  TOP-REAL 2)|K1,R^1;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by
  Lm5;
  set a=cn, b=1+cn;
  reconsider g2=proj1|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm2;
  assume that
A1: -1<cn and
A2: for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2
  )|K1 holds f.p=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)) and
A3: for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)
  |K1 holds q`2<=0 & q`1/|.q.|<=cn & q<>0.TOP-REAL 2;
A4: 1+cn>0 by A1,XREAL_1:150;
  for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)|K1
  holds q<>0.TOP-REAL 2 by A3;
  then for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm6;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
A5: for q being Point of (TOP-REAL 2)|K1,r1,r2 being real number st g2.q
  =r1 & g1.q=r2 holds g3.q=r2*( -sqrt(abs(1-((r1/r2-a)/b)^2))) and
A6: g3 is continuous by A4,Th14;
A7: dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then
A8: dom f=dom g3 by FUNCT_2:def 1;
  for x being set st x in dom f holds f.x=g3.x
  proof
    let x be set;
    assume
A9: x in dom f;
    then x in K1 by A7,A8,PRE_TOPC:29;
    then reconsider r=x as Point of (TOP-REAL 2);
    reconsider s=x as Point of (TOP-REAL 2)|K1 by A9;
A10: (1+cn)^2>0 by A4,SQUARE_1:74;
A11: |.r.|<>0 by A3,A9,TOPRNS_1:25;
    |.r.|^2=(r`1)^2+(r`2)^2 by JGRAPH_3:10;
    then
A12: ((r`1) -(|.r.|))*((r`1)+|.r.|) =-(r`2)^2;
    (r`2)^2>=0 by XREAL_1:65;
    then -(|.r.|)<=r`1 by A12,XREAL_1:95;
    then r`1/|.r.| >= (-(|.r.|))/|.r.| by XREAL_1:74;
    then r`1/|.r.|>= -1 by A11,XCMPLX_1:198;
    then r`1/|.r.|-cn>=-1-cn by XREAL_1:11;
    then
A13: r`1/|.r.|-cn>=-(1+cn);
    cn-r`1/|.r.|>=0 by A3,A9,XREAL_1:50;
    then -(cn-r`1/|.r.|)<=-0;
    then (r`1/|.r.|-cn)^2<=(1+cn)^2 by A4,A13,SQUARE_1:119;
    then (r`1/|.r.|-cn)^2/(1+cn)^2<=(1+cn)^2/(1+cn)^2 by A4,XREAL_1:74;
    then (r`1/|.r.|-cn)^2/(1+cn)^2<=1 by A10,XCMPLX_1:60;
    then ((r`1/|.r.|-cn)/(1+cn))^2<=1 by XCMPLX_1:77;
    then 1-((r`1/|.r.|-cn)/(1+cn))^2>=0 by XREAL_1:50;
    then abs(1-((r`1/|.r.|-cn)/(1+cn))^2) =1-((r`1/|.r.|-cn)/(1+cn))^2 by
    ABSVALUE:def 1;
    then
A14: f.r=(|.r.|)*( -sqrt(abs(1-((r`1/|.r.|-cn)/(1+cn))^2))) by A2,A9;
A15: proj1.r=r`1 & (2 NormF).r=|.r.| by Def1,PSCOMP_1:def 28;
    g2.s=proj1.s & g1.s=(2 NormF).s by Lm2,Lm5;
    hence thesis by A5,A14,A15;
  end;
  hence thesis by A6,A8,FUNCT_1:9;
end;

theorem Th127:
  for cn being Real, K0,B0 being Subset of TOP-REAL 2,f being
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0 st -1<cn & cn<1 & f=(cn-FanMorphS)|
K0 & B0={q where q is Point of TOP-REAL 2: q`2<=0 & q<>0.TOP-REAL 2} & K0={p: p
  `1/|.p.|>=cn & p`2<=0 & p<>0.TOP-REAL 2} holds f is continuous
proof
  let cn be Real,K0,B0 be Subset of TOP-REAL 2,f be Function of (TOP-REAL 2)|
  K0,(TOP-REAL 2)|B0;
  set sn=-sqrt(1-cn^2);
  set p0=|[cn,sn]|;
A1: p0`2=sn by EUCLID:56;
  p0`1=cn by EUCLID:56;
  then
A2: |.p0.|=sqrt((sn)^2+cn^2) by A1,JGRAPH_3:10;
  assume
A3: -1<cn & cn<1 & f=(cn-FanMorphS)|K0 & B0={q where q is Point of
  TOP-REAL 2: q`2<=0 & q<>0.TOP-REAL 2} & K0={p: p`1/|.p.|>=cn & p`2<=0 & p<>0.
  TOP-REAL 2};
  then cn^2<1^2 by SQUARE_1:120;
  then
A4: 1-cn^2>0 by XREAL_1:52;
  then
A5: -sn>0 by SQUARE_1:93;
A6: now
    assume
    p0=0.TOP-REAL 2;
    then --sn=-0 by EUCLID:56,JGRAPH_2:11;
    hence contradiction by A4,SQUARE_1:93;
  end;
  (-sn)^2=1-cn^2 by A4,SQUARE_1:def 4;
  then p0`1/|.p0.|=cn by A2,EUCLID:56,SQUARE_1:83;
  then
A7: p0 in K0 by A3,A1,A6,A5;
  then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
A8: rng (proj2*((cn-FanMorphS)|K1)) c= the carrier of R^1 by TOPMETR:24;
A9: K0 c= B0
  proof
    let x be set;
    assume
    x in K0;
    then
    ex p8 being Point of TOP-REAL 2 st x=p8 & p8`1/|.p8.|>= cn & p8`2<=0 &
    p8<>0.TOP-REAL 2 by A3;
    hence thesis by A3;
  end;
A10: dom ((cn-FanMorphS)|K1) c= dom (proj1*((cn-FanMorphS)|K1))
  proof
    let x be set;
    assume
A11: x in dom ((cn-FanMorphS)|K1);
    then x in dom (cn-FanMorphS) /\ K1 by RELAT_1:90;
    then x in dom (cn-FanMorphS) by XBOOLE_0:def 4;
    then
A12: dom proj1 = (the carrier of TOP-REAL 2) & (cn-FanMorphS).x in rng (cn
    -FanMorphS) by FUNCT_1:12,FUNCT_2:def 1;
    ((cn-FanMorphS)|K1).x=(cn-FanMorphS).x by A11,FUNCT_1:70;
    hence thesis by A11,A12,FUNCT_1:21;
  end;
A13: rng (proj1*((cn-FanMorphS)|K1)) c= the carrier of R^1 by TOPMETR:24;
  dom (proj1*((cn-FanMorphS)|K1)) c= dom ((cn-FanMorphS)|K1) by RELAT_1:
  44;
  then dom (proj1*((cn-FanMorphS)|K1)) =dom ((cn-FanMorphS)|K1) by A10,
  XBOOLE_0:def 10
    .=dom (cn-FanMorphS) /\ K1 by RELAT_1:90
    .=(the carrier of TOP-REAL 2)/\ K1 by FUNCT_2:def 1
    .=K1 by XBOOLE_1:28
    .=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
  then reconsider
  g2=proj1*((cn-FanMorphS)|K1) as Function of (TOP-REAL 2)|K1,R^1
  by A13,FUNCT_2:4;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g2.p=|.p.|* ((p`1/|.p.|-cn)/(1-cn))
  proof
    let p be Point of TOP-REAL 2;
A14: dom ((cn-FanMorphS)|K1)=dom (cn-FanMorphS) /\ K1 by RELAT_1:90
      .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
      .=K1 by XBOOLE_1:28;
A15: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    assume
A16: p in the carrier of (TOP-REAL 2)|K1;
    then
    ex p3 being Point of TOP-REAL 2 st p=p3 & p3`1/|.p3.|>= cn & p3`2<=0 &
    p3<>0.TOP-REAL 2 by A3,A15;
    then
A17: (cn-FanMorphS).p =|[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)), |.p.|*( -sqrt(1-
    ((p`1/|.p.|-cn)/(1-cn))^2))]| by A3,Th122;
    ((cn-FanMorphS)|K1).p=(cn-FanMorphS).p by A16,A15,FUNCT_1:72;
    then
    g2.p=proj1.(|[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)), |.p.|*( -sqrt(1-((p`1/
    |.p.|-cn)/(1-cn))^2))]|) by A16,A14,A15,A17,FUNCT_1:23
      .=(|[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)), |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/
    (1-cn))^2))]|)`1 by PSCOMP_1:def 28
      .=|.p.|* ((p`1/|.p.|-cn)/(1-cn)) by EUCLID:56;
    hence thesis;
  end;
  then consider f2 being Function of (TOP-REAL 2)|K1,R^1 such that
A18: for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)
  |K1 holds f2.p=|.p.|* ((p`1/|.p.|-cn)/(1-cn));
A19: dom ((cn-FanMorphS)|K1) c= dom (proj2*((cn-FanMorphS)|K1))
  proof
    let x be set;
    assume
A20: x in dom ((cn-FanMorphS)|K1);
    then x in dom (cn-FanMorphS) /\ K1 by RELAT_1:90;
    then x in dom (cn-FanMorphS) by XBOOLE_0:def 4;
    then
A21: dom proj2 = (the carrier of TOP-REAL 2) & (cn-FanMorphS).x in rng (cn
    -FanMorphS) by FUNCT_1:12,FUNCT_2:def 1;
    ((cn-FanMorphS)|K1).x=(cn-FanMorphS).x by A20,FUNCT_1:70;
    hence thesis by A20,A21,FUNCT_1:21;
  end;
  dom (proj2*((cn-FanMorphS)|K1)) c= dom ((cn-FanMorphS)|K1) by RELAT_1:
  44;
  then dom (proj2*((cn-FanMorphS)|K1)) =dom ((cn-FanMorphS)|K1) by A19,
  XBOOLE_0:def 10
    .=dom (cn-FanMorphS) /\ K1 by RELAT_1:90
    .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
    .=K1 by XBOOLE_1:28
    .=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
  then reconsider
  g1=proj2*((cn-FanMorphS)|K1) as Function of (TOP-REAL 2)|K1,R^1
  by A8,FUNCT_2:4;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g1.p=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))
  proof
    let p be Point of TOP-REAL 2;
A22: dom ((cn-FanMorphS)|K1)=dom (cn-FanMorphS) /\ K1 by RELAT_1:90
      .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
      .=K1 by XBOOLE_1:28;
A23: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    assume
A24: p in the carrier of (TOP-REAL 2)|K1;
    then
    ex p3 being Point of TOP-REAL 2 st p=p3 & p3`1/|.p3.|>= cn & p3`2<=0 &
    p3<>0.TOP-REAL 2 by A3,A23;
    then
A25: (cn-FanMorphS).p=|[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)), |.p.|*( -sqrt(1-(
    (p`1/|.p.|-cn)/(1-cn))^2))]| by A3,Th122;
    ((cn-FanMorphS)|K1).p=(cn-FanMorphS).p by A24,A23,FUNCT_1:72;
    then
    g1.p=proj2.(|[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)), |.p.|*( -sqrt(1-((p`1/
    |.p.|-cn)/(1-cn))^2))]|) by A24,A22,A23,A25,FUNCT_1:23
      .=(|[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)), |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/
    (1-cn))^2))]|)`2 by PSCOMP_1:def 29
      .= |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)) by EUCLID:56;
    hence thesis;
  end;
  then consider f1 being Function of (TOP-REAL 2)|K1,R^1 such that
A26: for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)
  |K1 holds f1.p=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2));
  for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)|K1
  holds q`2<=0 & q`1/|.q.|>=cn & q<>0.TOP-REAL 2
  proof
    let q be Point of TOP-REAL 2;
A27: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    assume
    q in the carrier of (TOP-REAL 2)|K1;
    then
    ex p3 being Point of TOP-REAL 2 st q=p3 & p3`1/|.p3.|>= cn & p3`2<=0 &
    p3<>0.TOP-REAL 2 by A3,A27;
    hence thesis;
  end;
  then
A28: f1 is continuous by A3,A26,Th125;
A29: for x,y,s,r being real number st |[x,y]| in K1 & s=f2.(|[x,y]|) & r=f1.
  (|[x,y]|) holds f.(|[x,y]|)=|[s,r]|
  proof
    let x,y,s,r be real number;
    assume that
A30: |[x,y]| in K1 and
A31: s=f2.(|[x,y]|) & r=f1.(|[x,y]|);
    set p99=|[x,y]|;
A32: ex p3 being Point of TOP-REAL 2 st p99=p3 & p3`1/|.p3.| >=cn & p3`2<=0
    & p3<>0.TOP-REAL 2 by A3,A30;
A33: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then
A34: f1.p99=|.p99.|*( -sqrt(1-((p99`1/|.p99.|-cn)/(1-cn))^2)) by A26,A30;
    ((cn-FanMorphS)|K0).(|[x,y]|)=((cn-FanMorphS)).(|[x,y]|) by A30,
    FUNCT_1:72
      .= |[ |.p99.|* ((p99`1/|.p99.|-cn)/(1-cn)), |.p99.|*( -sqrt(1-((p99`1/
    |.p99.|-cn)/(1-cn))^2))]| by A3,A32,Th122
      .=|[s,r]| by A18,A30,A31,A33,A34;
    hence thesis by A3;
  end;
  for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)|K1
  holds q`2<=0 & q<>0.TOP-REAL 2
  proof
    let q be Point of TOP-REAL 2;
A35: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    assume
    q in the carrier of (TOP-REAL 2)|K1;
    then
    ex p3 being Point of TOP-REAL 2 st q=p3 & p3`1/|.p3.|>= cn & p3`2<=0 &
    p3<>0.TOP-REAL 2 by A3,A35;
    hence thesis;
  end;
  then f2 is continuous by A3,A18,Th123;
  hence thesis by A7,A9,A28,A29,JGRAPH_2:45;
end;

theorem Th128:
  for cn being Real, K0,B0 being Subset of TOP-REAL 2, f being
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0 st -1<cn & cn<1 & f=(cn-FanMorphS)|
K0 & B0={q where q is Point of TOP-REAL 2: q`2<=0 & q<>0.TOP-REAL 2} & K0={p: p
  `1/|.p.|<=cn & p`2<=0 & p<>0.TOP-REAL 2} holds f is continuous
proof
  let cn be Real,K0,B0 be Subset of TOP-REAL 2,f be Function of (TOP-REAL 2)|
  K0,(TOP-REAL 2)|B0;
  set sn=-sqrt(1-cn^2);
  set p0=|[cn,sn]|;
A1: p0`2=sn by EUCLID:56;
  p0`1=cn by EUCLID:56;
  then
A2: |.p0.|=sqrt((sn)^2+cn^2) by A1,JGRAPH_3:10;
  assume
A3: -1<cn & cn<1 & f=(cn-FanMorphS)|K0 & B0={q where q is Point of
  TOP-REAL 2: q`2<=0 & q<>0.TOP-REAL 2} & K0={p: p`1/|.p.|<=cn & p`2<=0 & p<>0.
  TOP-REAL 2};
  then cn^2<1^2 by SQUARE_1:120;
  then
A4: 1-cn^2>0 by XREAL_1:52;
  then
A5: -sn>0 by SQUARE_1:93;
A6: now
    assume
    p0=0.TOP-REAL 2;
    then --sn=-0 by EUCLID:56,JGRAPH_2:11;
    hence contradiction by A4,SQUARE_1:93;
  end;
  (-sn)^2=1-cn^2 by A4,SQUARE_1:def 4;
  then p0`1/|.p0.|=cn by A2,EUCLID:56,SQUARE_1:83;
  then
A7: p0 in K0 by A3,A1,A6,A5;
  then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
A8: rng (proj2*((cn-FanMorphS)|K1)) c= the carrier of R^1 by TOPMETR:24;
A9: K0 c= B0
  proof
    let x be set;
    assume
    x in K0;
    then
    ex p8 being Point of TOP-REAL 2 st x=p8 & p8`1/|.p8.|<= cn & p8`2<=0 &
    p8<>0.TOP-REAL 2 by A3;
    hence thesis by A3;
  end;
A10: dom ((cn-FanMorphS)|K1) c= dom (proj1*((cn-FanMorphS)|K1))
  proof
    let x be set;
    assume
A11: x in dom ((cn-FanMorphS)|K1);
    then x in dom (cn-FanMorphS) /\ K1 by RELAT_1:90;
    then x in dom (cn-FanMorphS) by XBOOLE_0:def 4;
    then
A12: dom proj1 = (the carrier of TOP-REAL 2) & (cn-FanMorphS).x in rng (cn
    -FanMorphS) by FUNCT_1:12,FUNCT_2:def 1;
    ((cn-FanMorphS)|K1).x=(cn-FanMorphS).x by A11,FUNCT_1:70;
    hence thesis by A11,A12,FUNCT_1:21;
  end;
A13: rng (proj1*((cn-FanMorphS)|K1)) c= the carrier of R^1 by TOPMETR:24;
  dom (proj1*((cn-FanMorphS)|K1)) c= dom ((cn-FanMorphS)|K1) by RELAT_1:
  44;
  then dom (proj1*((cn-FanMorphS)|K1)) =dom ((cn-FanMorphS)|K1) by A10,
  XBOOLE_0:def 10
    .=dom (cn-FanMorphS) /\ K1 by RELAT_1:90
    .=(the carrier of TOP-REAL 2)/\ K1 by FUNCT_2:def 1
    .=K1 by XBOOLE_1:28
    .=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
  then reconsider
  g2=proj1*((cn-FanMorphS)|K1) as Function of (TOP-REAL 2)|K1,R^1
  by A13,FUNCT_2:4;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g2.p=|.p.|* ((p`1/|.p.|-cn)/(1+cn))
  proof
    let p be Point of TOP-REAL 2;
A14: dom ((cn-FanMorphS)|K1)=dom (cn-FanMorphS) /\ K1 by RELAT_1:90
      .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
      .=K1 by XBOOLE_1:28;
A15: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    assume
A16: p in the carrier of (TOP-REAL 2)|K1;
    then
    ex p3 being Point of TOP-REAL 2 st p=p3 & p3`1/|.p3.|<= cn & p3`2<=0 &
    p3<>0.TOP-REAL 2 by A3,A15;
    then
A17: (cn-FanMorphS).p =|[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)), |.p.|*( -sqrt(1-
    ((p`1/|.p.|-cn)/(1+cn))^2))]| by A3,Th122;
    ((cn-FanMorphS)|K1).p=(cn-FanMorphS).p by A16,A15,FUNCT_1:72;
    then
    g2.p=proj1.(|[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)), |.p.|*( -sqrt(1-((p`1/
    |.p.|-cn)/(1+cn))^2))]|) by A16,A14,A15,A17,FUNCT_1:23
      .=(|[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)), |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/
    (1+cn))^2))]|)`1 by PSCOMP_1:def 28
      .=|.p.|* ((p`1/|.p.|-cn)/(1+cn)) by EUCLID:56;
    hence thesis;
  end;
  then consider f2 being Function of (TOP-REAL 2)|K1,R^1 such that
A18: for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)
  |K1 holds f2.p=|.p.|* ((p`1/|.p.|-cn)/(1+cn));
A19: dom ((cn-FanMorphS)|K1) c= dom (proj2*((cn-FanMorphS)|K1))
  proof
    let x be set;
    assume
A20: x in dom ((cn-FanMorphS)|K1);
    then x in dom (cn-FanMorphS) /\ K1 by RELAT_1:90;
    then x in dom (cn-FanMorphS) by XBOOLE_0:def 4;
    then
A21: dom proj2 = (the carrier of TOP-REAL 2) & (cn-FanMorphS).x in rng (cn
    -FanMorphS) by FUNCT_1:12,FUNCT_2:def 1;
    ((cn-FanMorphS)|K1).x=(cn-FanMorphS).x by A20,FUNCT_1:70;
    hence thesis by A20,A21,FUNCT_1:21;
  end;
  dom (proj2*((cn-FanMorphS)|K1)) c= dom ((cn-FanMorphS)|K1) by RELAT_1:
  44;
  then dom (proj2*((cn-FanMorphS)|K1)) =dom ((cn-FanMorphS)|K1) by A19,
  XBOOLE_0:def 10
    .=dom (cn-FanMorphS) /\ K1 by RELAT_1:90
    .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
    .=K1 by XBOOLE_1:28
    .=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
  then reconsider
  g1=proj2*((cn-FanMorphS)|K1) as Function of (TOP-REAL 2)|K1,R^1
  by A8,FUNCT_2:4;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g1.p=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))
  proof
    let p be Point of TOP-REAL 2;
A22: dom ((cn-FanMorphS)|K1)=dom (cn-FanMorphS) /\ K1 by RELAT_1:90
      .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
      .=K1 by XBOOLE_1:28;
A23: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    assume
A24: p in the carrier of (TOP-REAL 2)|K1;
    then
    ex p3 being Point of TOP-REAL 2 st p=p3 & p3`1/|.p3.|<= cn & p3`2<=0 &
    p3<>0.TOP-REAL 2 by A3,A23;
    then
A25: (cn-FanMorphS).p=|[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)), |.p.|*( -sqrt(1-(
    (p`1/|.p.|-cn)/(1+cn))^2))]| by A3,Th122;
    ((cn-FanMorphS)|K1).p=(cn-FanMorphS).p by A24,A23,FUNCT_1:72;
    then
    g1.p=proj2.(|[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)), |.p.|*( -sqrt(1-((p`1/
    |.p.|-cn)/(1+cn))^2))]|) by A24,A22,A23,A25,FUNCT_1:23
      .=(|[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)), |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/
    (1+cn))^2))]|)`2 by PSCOMP_1:def 29
      .= |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)) by EUCLID:56;
    hence thesis;
  end;
  then consider f1 being Function of (TOP-REAL 2)|K1,R^1 such that
A26: for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)
  |K1 holds f1.p=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2));
  for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)|K1
  holds q`2<=0 & q`1/|.q.|<=cn & q<>0.TOP-REAL 2
  proof
    let q be Point of TOP-REAL 2;
A27: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    assume
    q in the carrier of (TOP-REAL 2)|K1;
    then
    ex p3 being Point of TOP-REAL 2 st q=p3 & p3`1/|.p3.|<= cn & p3`2<=0 &
    p3<>0.TOP-REAL 2 by A3,A27;
    hence thesis;
  end;
  then
A28: f1 is continuous by A3,A26,Th126;
A29: for x,y,s,r being real number st |[x,y]| in K1 & s=f2.(|[x,y]|) & r=f1.
  (|[x,y]|) holds f.(|[x,y]|)=|[s,r]|
  proof
    let x,y,s,r be real number;
    assume that
A30: |[x,y]| in K1 and
A31: s=f2.(|[x,y]|) & r=f1.(|[x,y]|);
    set p99=|[x,y]|;
A32: ex p3 being Point of TOP-REAL 2 st p99=p3 & p3`1/|.p3.| <=cn & p3`2<=0
    & p3<>0.TOP-REAL 2 by A3,A30;
A33: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then
A34: f1.p99=|.p99.|*( -sqrt(1-((p99`1/|.p99.|-cn)/(1+cn))^2)) by A26,A30;
    ((cn-FanMorphS)|K0).(|[x,y]|)=((cn-FanMorphS)).(|[x,y]|) by A30,
    FUNCT_1:72
      .= |[ |.p99.|* ((p99`1/|.p99.|-cn)/(1+cn)), |.p99.|*( -sqrt(1-((p99`1/
    |.p99.|-cn)/(1+cn))^2))]| by A3,A32,Th122
      .=|[s,r]| by A18,A30,A31,A33,A34;
    hence thesis by A3;
  end;
  for q being Point of TOP-REAL 2 st q in the carrier of (TOP-REAL 2)|K1
  holds q`2<=0 & q<>0.TOP-REAL 2
  proof
    let q be Point of TOP-REAL 2;
A35: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    assume
    q in the carrier of (TOP-REAL 2)|K1;
    then
    ex p3 being Point of TOP-REAL 2 st q=p3 & p3`1/|.p3.|<= cn & p3`2<=0 &
    p3<>0.TOP-REAL 2 by A3,A35;
    hence thesis;
  end;
  then f2 is continuous by A3,A18,Th124;
  hence thesis by A7,A9,A28,A29,JGRAPH_2:45;
end;

theorem Th129:
  for cn being Real, K03 being Subset of TOP-REAL 2 st K03={p: p
  `1>=(cn)*(|.p.|) & p`2<=0} holds K03 is closed
proof
  defpred Q[Point of TOP-REAL 2] means $1`2<=0;
  let sn be Real, K003 be Subset of TOP-REAL 2;
  assume
A1: K003={p: p`1>=(sn)*(|.p.|) & p`2<=0};
  reconsider KX={p where p is Point of TOP-REAL 2: Q[p]} as Subset of TOP-REAL
  2 from JGRAPH_2:sch 1;
  defpred P[Point of TOP-REAL 2] means ($1`1>=sn*|.$1.|);
  reconsider K1={p7 where p7 is Point of TOP-REAL 2:P[p7]} as Subset of
  TOP-REAL 2 from JGRAPH_2:sch 1;
A2: {p : P[p] & Q[p]} = {p7 where p7 is Point of TOP-REAL 2:P[p7]} /\ {p1
  where p1 is Point of TOP-REAL 2: Q[p1]} from DOMAIN_1:sch 10;
  K1 is closed & KX is closed by Lm8,JORDAN6:9;
  hence thesis by A1,A2,TOPS_1:35;
end;

theorem Th130:
  for cn being Real, K03 being Subset of TOP-REAL 2 st K03={p: p
  `1<=(cn)*(|.p.|) & p`2<=0} holds K03 is closed
proof
  defpred Q[Point of TOP-REAL 2] means $1`2<=0;
  let sn be Real, K003 be Subset of TOP-REAL 2;
  assume
A1: K003={p: p`1<=(sn)*(|.p.|) & p`2<=0};
  reconsider KX={p where p is Point of TOP-REAL 2: Q[p]} as Subset of TOP-REAL
  2 from JGRAPH_2:sch 1;
  defpred P[Point of TOP-REAL 2] means ($1`1<=sn*|.$1.|);
  reconsider K1={p7 where p7 is Point of TOP-REAL 2:P[p7]} as Subset of
  TOP-REAL 2 from JGRAPH_2:sch 1;
A2: {p : P[p] & Q[p]} = {p7 where p7 is Point of TOP-REAL 2:P[p7]} /\ {p1
  where p1 is Point of TOP-REAL 2: Q[p1]} from DOMAIN_1:sch 10;
  K1 is closed & KX is closed by Lm10,JORDAN6:9;
  hence thesis by A1,A2,TOPS_1:35;
end;

theorem Th131:
  for cn being Real, K0,B0 being Subset of TOP-REAL 2, f being
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0 st -1<cn & cn<1 & f=(cn-FanMorphS)|
  K0 & B0=NonZero TOP-REAL 2 & K0={p: p`2<=0 & p<>0.TOP-REAL 2} holds f is
  continuous
proof
  let cn be Real,K0,B0 be Subset of TOP-REAL 2,f be Function of (TOP-REAL 2)|
  K0,(TOP-REAL 2)|B0;
  set sn=-sqrt(1-cn^2);
  set p0=|[cn,sn]|;
A1: p0`2=sn by EUCLID:56;
  p0`1=cn by EUCLID:56;
  then
A2: |.p0.|=sqrt((sn)^2+cn^2) by A1,JGRAPH_3:10;
  assume
A3: -1<cn & cn<1 & f=(cn-FanMorphS)|K0 & B0=NonZero TOP-REAL 2 & K0={p:
  p`2<=0 & p<>0.TOP-REAL 2};
  then cn^2<1^2 by SQUARE_1:120;
  then
A4: 1-cn^2>0 by XREAL_1:52;
  then
A5: -sn>0 by SQUARE_1:93;
A6: now
    assume
    p0=0.TOP-REAL 2;
    then --sn=-0 by EUCLID:56,JGRAPH_2:11;
    hence contradiction by A4,SQUARE_1:93;
  end;
  then p0 in K0 by A3,A1,A5;
  then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
  (-sn)^2=1-cn^2 by A4,SQUARE_1:def 4;
  then
A7: p0`1/|.p0.|=cn by A2,EUCLID:56,SQUARE_1:83;
  then
A8: p0 in {p: p`1/|.p.|>=cn & p`2<=0 & p<>0.TOP-REAL 2} by A1,A6,A5;
  not p0 in {0.TOP-REAL 2} by A6,TARSKI:def 1;
  then reconsider D=B0 as non empty Subset of TOP-REAL 2 by A3,XBOOLE_0:def 5;
  K1 c= D
  proof
    let x be set;
    assume
A9: x in K1;
    then ex p6 being Point of TOP-REAL 2 st p6=x & p6`2<=0 & p6 <>0.TOP-REAL 2
    by A3;
    then not x in {0.TOP-REAL 2} by TARSKI:def 1;
    hence thesis by A3,A9,XBOOLE_0:def 5;
  end;
  then D=K1 \/ D by XBOOLE_1:12;
  then
A10: (TOP-REAL 2)|K1 is SubSpace of (TOP-REAL 2)|D by TOPMETR:5;
A11: {p: p`1/|.p.|<=cn & p`2<=0 & p<>0.TOP-REAL 2} c= K1
  proof
    let x be set;
    assume
    x in {p: p`1/|.p.|<=cn & p`2<=0 & p<>0.TOP-REAL 2};
    then ex p st p=x & p`1/|.p.|<=cn & p`2<=0 & p<>0.TOP-REAL 2;
    hence thesis by A3;
  end;
A12: {p: p`1/|.p.|>=cn & p`2<=0 & p<>0.TOP-REAL 2} c= K1
  proof
    let x be set;
    assume
    x in {p: p`1/|.p.|>=cn & p`2<=0 & p<>0.TOP-REAL 2};
    then ex p st p=x & p`1/|.p.|>=cn & p`2<=0 & p<>0.TOP-REAL 2;
    hence thesis by A3;
  end;
  then reconsider
  K00={p: p`1/|.p.|>=cn & p`2<=0 & p<>0.TOP-REAL 2} as non empty
  Subset of ((TOP-REAL 2)|K1) by A8,PRE_TOPC:29;
  the carrier of (TOP-REAL 2)|D = D by PRE_TOPC:29;
  then
A13: rng (f|K00) c=D;
  p0 in {p: p`1/|.p.|<=cn & p`2<=0 & p<>0.TOP-REAL 2} by A1,A6,A5,A7;
  then reconsider
  K11={p: p`1/|.p.|<=cn & p`2<=0 & p<>0.TOP-REAL 2} as non empty
  Subset of ((TOP-REAL 2)|K1) by A11,PRE_TOPC:29;
  the carrier of (TOP-REAL 2)|D = D by PRE_TOPC:29;
  then
A14: rng (f|K11) c=D;
  the carrier of (TOP-REAL 2)|B0=the carrier of (TOP-REAL 2)|D;
  then
A15: dom f=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1
    .=K1 by PRE_TOPC:29;
  then dom (f|K00)=K00 by A12,RELAT_1:91
    .= the carrier of ((TOP-REAL 2)|K1)|K00 by PRE_TOPC:29;
  then reconsider
  f1=f|K00 as Function of ((TOP-REAL 2)|K1)|K00,(TOP-REAL 2)|D by
  A13,FUNCT_2:4;
  dom (f|K11)=K11 by A11,A15,RELAT_1:91
    .= the carrier of ((TOP-REAL 2)|K1)|K11 by PRE_TOPC:29;
  then reconsider
  f2=f|K11 as Function of ((TOP-REAL 2)|K1)|K11,(TOP-REAL 2)|D by
  A14,FUNCT_2:4;
A16: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
  defpred P[Point of TOP-REAL 2] means $1`1/|.$1.|>=cn & $1`2<=0 & $1<>0.
  TOP-REAL 2;
A17: dom f2=the carrier of ((TOP-REAL 2)|K1)|K11 by FUNCT_2:def 1
    .=K11 by PRE_TOPC:29;
  {p: P[p]} is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
  then reconsider
  K001={p: p`1/|.p.|>=cn & p`2<=0 & p<>0.TOP-REAL 2} as non empty
  Subset of TOP-REAL 2 by A8;
A18: the carrier of (TOP-REAL 2)|K1 =K1 by PRE_TOPC:29;
  defpred P[Point of TOP-REAL 2] means $1`1>=cn*(|.$1.|) & $1`2<=0;
  {p: P[p]} is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
  then reconsider
  K003={p: p`1>=(cn)*(|.p.|) & p`2<=0} as Subset of TOP-REAL 2;
  defpred P[Point of TOP-REAL 2] means $1`1/|.$1.|<=cn & $1`2<=0 & $1<>0.
  TOP-REAL 2;
A19: {p: P[p]} is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
A20: rng ((cn-FanMorphS)|K001) c= K1
  proof
    let y be set;
    assume
    y in rng ((cn-FanMorphS)|K001);
    then consider x being set such that
A21: x in dom ((cn-FanMorphS)|K001) and
A22: y=((cn-FanMorphS)|K001).x by FUNCT_1:def 5;
    reconsider q=x as Point of TOP-REAL 2 by A21;
A23: y=(cn-FanMorphS).q by A21,A22,FUNCT_1:70;
    dom ((cn-FanMorphS)|K001)=(dom (cn-FanMorphS))/\ K001 by RELAT_1:90
      .=(the carrier of TOP-REAL 2)/\ K001 by FUNCT_2:def 1
      .=K001 by XBOOLE_1:28;
    then
A24: ex p2 being Point of TOP-REAL 2 st p2=q & p2`1/|.p2.|>= cn & p2`2<=0 &
    p2<>0.TOP-REAL 2 by A21;
    then
A25: (q`1/|.q.|-cn)>= 0 by XREAL_1:50;
    |.q.|<>0 by A24,TOPRNS_1:25;
    then
A26: (|.q.|)^2>0^2 by SQUARE_1:74;
    set q4= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)), |.q.|*( -sqrt(1-((q`1/|.q.|-cn)
    /(1-cn))^2))]|;
A27: q4`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by EUCLID:56;
A28: 1-cn>0 by A3,XREAL_1:151;
    0<=(q`2)^2 by XREAL_1:65;
    then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
    then (q`1)^2 <= (|.q.|)^2 by JGRAPH_3:10;
    then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by XREAL_1:74;
    then (q`1)^2/(|.q.|)^2 <= 1 by A26,XCMPLX_1:60;
    then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
    then 1>=q`1/|.q.| by SQUARE_1:121;
    then 1-cn>=q`1/|.q.|-cn by XREAL_1:11;
    then -(1-cn)<= -( q`1/|.q.|-cn) by XREAL_1:26;
    then (-(1-cn))/(1-cn)<=(-( q`1/|.q.|-cn))/(1-cn) by A28,XREAL_1:74;
    then -1<=(-( q`1/|.q.|-cn))/(1-cn) by A28,XCMPLX_1:198;
    then ((-(q`1/|.q.|-cn))/(1-cn))^2<=1^2 by A28,A25,SQUARE_1:119;
    then
A29: 1-((-(q`1/|.q.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
    then
A30: 1-(-((q`1/|.q.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
    sqrt(1-((-(q`1/|.q.|-cn))/(1-cn))^2)>=0 by A29,SQUARE_1:def 4;
    then sqrt(1-(-(q`1/|.q.|-cn))^2/(1-cn)^2)>=0 by XCMPLX_1:77;
    then sqrt(1-(q`1/|.q.|-cn)^2/(1-cn)^2)>=0;
    then
A31: sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)>=0 by XCMPLX_1:77;
A32: q4`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)) by EUCLID:56;
    then
A33: (q4`2)^2= (|.q.|)^2*(sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))^2
      .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1-cn))^2) by A30,SQUARE_1:def 4;
    (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
      .=(|.q.|)^2 by A27,A33;
    then
A34: q4<>0.TOP-REAL 2 by A26,TOPRNS_1:24;
    cn-FanMorphS.q= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)), |.q.|*( -sqrt(1-((
    q`1/|.q.|-cn)/(1-cn))^2))]| by A3,A24,Th122;
    hence thesis by A3,A23,A32,A31,A34;
  end;
A35: dom (cn-FanMorphS)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
  then dom ((cn-FanMorphS)|K001)=K001 by RELAT_1:91
    .= the carrier of (TOP-REAL 2)|K001 by PRE_TOPC:29;
  then reconsider
  f3=(cn-FanMorphS)|K001 as Function of (TOP-REAL 2)|K001,(TOP-REAL
  2)|K1 by A18,A20,FUNCT_2:4;
A36: K003 is closed by Th129;
  defpred P[Point of TOP-REAL 2] means $1`1<=(cn)*(|.$1.|) & $1`2<=0;
  {p: P[p]} is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
  then reconsider
  K004={p: p`1<=(cn)*(|.p.|) & p`2<=0} as Subset of (TOP-REAL 2);
A37: K004 /\ K1 c= K11
  proof
    let x be set;
    assume
A38: x in K004 /\ K1;
    then x in K004 by XBOOLE_0:def 4;
    then consider q1 being Point of TOP-REAL 2 such that
A39: q1=x and
A40: q1`1<=(cn)*(|.q1.|) and
    q1`2<=0;
    x in K1 by A38,XBOOLE_0:def 4;
    then
A41: ex q2 being Point of TOP-REAL 2 st q2=x & q2`2<=0 & q2 <>0.TOP-REAL 2
    by A3;
    q1`1/|.q1.|<=(cn)*(|.q1.|)/|.q1.| by A40,XREAL_1:74;
    then q1`1/|.q1.|<=(cn) by A39,A41,TOPRNS_1:25,XCMPLX_1:90;
    hence thesis by A39,A41;
  end;
A42: K004 is closed by Th130;
  the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
  then ((TOP-REAL 2)|K1)|K00=(TOP-REAL 2)|K001 & f1= f3 by A3,FUNCT_1:82
  ,GOBOARD9:4;
  then
A43: f1 is continuous by A3,A10,Th127,PRE_TOPC:56;
A44: [#]((TOP-REAL 2)|K1)=K1 by PRE_TOPC:def 10;
  p0 in {p: p`1/|.p.|<=cn & p`2<=0 & p<>0.TOP-REAL 2} by A1,A6,A5,A7;
  then reconsider
  K111={p: p`1/|.p.|<=cn & p`2<=0 & p<>0.TOP-REAL 2} as non empty
  Subset of TOP-REAL 2 by A19;
A45: rng ((cn-FanMorphS)|K111) c= K1
  proof
    let y be set;
    assume
    y in rng ((cn-FanMorphS)|K111);
    then consider x being set such that
A46: x in dom ((cn-FanMorphS)|K111) and
A47: y=((cn-FanMorphS)|K111).x by FUNCT_1:def 5;
    reconsider q=x as Point of TOP-REAL 2 by A46;
A48: y=(cn-FanMorphS).q by A46,A47,FUNCT_1:70;
    dom ((cn-FanMorphS)|K111)=(dom (cn-FanMorphS))/\ K111 by RELAT_1:90
      .=(the carrier of TOP-REAL 2)/\ K111 by FUNCT_2:def 1
      .=K111 by XBOOLE_1:28;
    then
A49: ex p2 being Point of TOP-REAL 2 st p2=q & p2`1/|.p2.|<= cn & p2`2<=0 &
    p2<>0.TOP-REAL 2 by A46;
    then
A50: (q`1/|.q.|-cn)<=0 by XREAL_1:49;
    |.q.|<>0 by A49,TOPRNS_1:25;
    then
A51: (|.q.|)^2>0^2 by SQUARE_1:74;
    set q4= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)), |.q.|*( -sqrt(1-((q`1/|.q.|-cn)
    /(1+cn))^2))]|;
A52: q4`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by EUCLID:56;
A53: 1+cn>0 by A3,XREAL_1:150;
    0<=(q`2)^2 by XREAL_1:65;
    then (|.q.|)^2 =(q`1)^2+(q`2)^2 & 0+(q`1)^2<=(q`1)^2+(q`2)^2 by
    JGRAPH_3:10 ,XREAL_1:9;
    then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by XREAL_1:74;
    then (q`1)^2/(|.q.|)^2 <= 1 by A51,XCMPLX_1:60;
    then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
    then -1<=q`1/|.q.| by SQUARE_1:121;
    then -1-cn<=q`1/|.q.|-cn by XREAL_1:11;
    then (-(1+cn))/(1+cn)<=(( q`1/|.q.|-cn))/(1+cn) by A53,XREAL_1:74;
    then -1<=(( q`1/|.q.|-cn))/(1+cn) by A53,XCMPLX_1:198;
    then
A54: ( (q`1/|.q.|-cn) /(1+cn))^2<=1^2 by A53,A50,SQUARE_1:119;
    then
A55: 1-((q`1/|.q.|-cn)/(1+cn))^2>=0 by XREAL_1:50;
    1-(-((q`1/|.q.|-cn)/(1+cn)))^2>=0 by A54,XREAL_1:50;
    then 1-((-(q`1/|.q.|-cn))/(1+cn))^2>=0 by XCMPLX_1:188;
    then sqrt(1-((-(q`1/|.q.|-cn))/(1+cn))^2)>=0 by SQUARE_1:def 4;
    then sqrt(1-(-(q`1/|.q.|-cn))^2/(1+cn)^2)>=0 by XCMPLX_1:77;
    then sqrt(1-(q`1/|.q.|-cn)^2/(1+cn)^2)>=0;
    then
A56: sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)>=0 by XCMPLX_1:77;
A57: q4`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)) by EUCLID:56;
    then
A58: (q4`2)^2= (|.q.|)^2*(sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))^2
      .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1+cn))^2) by A55,SQUARE_1:def 4;
    (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
      .=(|.q.|)^2 by A52,A58;
    then
A59: q4<>0.TOP-REAL 2 by A51,TOPRNS_1:24;
    cn-FanMorphS.q= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)), |.q.|*( -sqrt(1-((
    q`1/|.q.|-cn)/(1+cn))^2))]| by A3,A49,Th122;
    hence thesis by A3,A48,A57,A56,A59;
  end;
  dom ((cn-FanMorphS)|K111)=K111 by A35,RELAT_1:91
    .= the carrier of (TOP-REAL 2)|K111 by PRE_TOPC:29;
  then reconsider
  f4=(cn-FanMorphS)|K111 as Function of (TOP-REAL 2)|K111,(TOP-REAL
  2)|K1 by A16,A45,FUNCT_2:4;
  the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
  then ((TOP-REAL 2)|K1)|K11=(TOP-REAL 2)|K111 & f2= f4 by A3,FUNCT_1:82
  ,GOBOARD9:4;
  then
A60: f2 is continuous by A3,A10,Th128,PRE_TOPC:56;
  set T1= ((TOP-REAL 2)|K1)|K00,T2=((TOP-REAL 2)|K1)|K11;
A61: [#](((TOP-REAL 2)|K1)|K11)=K11 by PRE_TOPC:def 10;
  K11 c= K004 /\ K1
  proof
    let x be set;
    assume
    x in K11;
    then consider p such that
A62: p=x and
A63: p`1/|.p.|<=cn and
A64: p`2<=0 and
A65: p<>0.TOP-REAL 2;
    p`1/|.p.|*|.p.|<=(cn)*(|.p.|) by A63,XREAL_1:66;
    then p`1<=(cn)*(|.p.|) by A65,TOPRNS_1:25,XCMPLX_1:88;
    then
A66: x in K004 by A62,A64;
    x in K1 by A3,A62,A64,A65;
    hence thesis by A66,XBOOLE_0:def 4;
  end;
  then K11=K004 /\ [#]((TOP-REAL 2)|K1) by A44,A37,XBOOLE_0:def 10;
  then
A67: K11 is closed by A42,PRE_TOPC:43;
A68: K003 /\ K1 c= K00
  proof
    let x be set;
    assume
A69: x in K003 /\ K1;
    then x in K003 by XBOOLE_0:def 4;
    then consider q1 being Point of TOP-REAL 2 such that
A70: q1=x and
A71: q1`1>=(cn)*(|.q1.|) and
    q1`2<=0;
    x in K1 by A69,XBOOLE_0:def 4;
    then
A72: ex q2 being Point of TOP-REAL 2 st q2=x & q2`2<=0 & q2 <>0.TOP-REAL 2
    by A3;
    q1`1/|.q1.|>=(cn)*(|.q1.|)/|.q1.| by A71,XREAL_1:74;
    then q1`1/|.q1.|>=(cn) by A70,A72,TOPRNS_1:25,XCMPLX_1:90;
    hence thesis by A70,A72;
  end;
A73: the carrier of ((TOP-REAL 2)|K1)=K0 by PRE_TOPC:29;
A74: D<>{};
A75: [#](((TOP-REAL 2)|K1)|K00)=K00 by PRE_TOPC:def 10;
A76: for p being set st p in ([#]T1)/\([#]T2) holds f1.p = f2.p
  proof
    let p be set;
    assume
A77: p in ([#]T1)/\([#]T2);
    then p in K00 by A75,XBOOLE_0:def 4;
    hence f1.p=f.p by FUNCT_1:72
      .=f2.p by A61,A77,FUNCT_1:72;
  end;
  K00 c= K003 /\ K1
  proof
    let x be set;
    assume
    x in K00;
    then consider p such that
A78: p=x and
A79: p`1/|.p.|>=cn and
A80: p`2<=0 and
A81: p<>0.TOP-REAL 2;
    p`1/|.p.|*|.p.|>=(cn)*(|.p.|) by A79,XREAL_1:66;
    then p`1>=(cn)*(|.p.|) by A81,TOPRNS_1:25,XCMPLX_1:88;
    then
A82: x in K003 by A78,A80;
    x in K1 by A3,A78,A80,A81;
    hence thesis by A82,XBOOLE_0:def 4;
  end;
  then K00=K003 /\ [#]((TOP-REAL 2)|K1) by A44,A68,XBOOLE_0:def 10;
  then
A83: K00 is closed by A36,PRE_TOPC:43;
A84: K1 c= K00 \/ K11
  proof
    let x be set;
    assume
    x in K1;
    then consider p such that
A85: p=x & p`2<=0 & p<>0.TOP-REAL 2 by A3;
    per cases;
    suppose
      p`1/|.p.|>=cn;
      then x in K00 by A85;
      hence thesis by XBOOLE_0:def 3;
    end;
    suppose
      p`1/|.p.|<cn;
      then x in K11 by A85;
      hence thesis by XBOOLE_0:def 3;
    end;
  end;
  then [#](((TOP-REAL 2)|K1)|K00) \/ [#](((TOP-REAL 2)|K1)|K11) =[#]((
  TOP-REAL 2)|K1) by A75,A61,A44,XBOOLE_0:def 10;
  then consider h being Function of (TOP-REAL 2)|K1,(TOP-REAL 2)|D such that
A86: h=f1+*f2 and
A87: h is continuous by A75,A61,A83,A67,A43,A60,A76,
  JGRAPH_2:9;
A88: dom h=the carrier of ((TOP-REAL 2)|K1) by FUNCT_2:def 1;
A89: dom f1=the carrier of ((TOP-REAL 2)|K1)|K00 by FUNCT_2:def 1
    .=K00 by PRE_TOPC:29;
A90: for y being set st y in dom h holds h.y=f.y
  proof
    let y be set;
    assume
A91: y in dom h;
    per cases by A84,A88,A73,A91,XBOOLE_0:def 3;
    suppose
A92:  y in K00 & not y in K11;
      then y in dom f1 \/ dom f2 by A89,XBOOLE_0:def 3;
      hence h.y=f1.y by A17,A86,A92,FUNCT_4:def 1
        .=f.y by A92,FUNCT_1:72;
    end;
    suppose
A93:  y in K11;
      then y in dom f1 \/ dom f2 by A17,XBOOLE_0:def 3;
      hence h.y=f2.y by A17,A86,A93,FUNCT_4:def 1
        .=f.y by A93,FUNCT_1:72;
    end;
  end;
  K0=the carrier of ((TOP-REAL 2)|K0) by PRE_TOPC:29
    .=dom f by A74,FUNCT_2:def 1;
  hence thesis by A87,A88,A90,FUNCT_1:9,PRE_TOPC:29;
end;

theorem Th132:
  for cn being Real, K0,B0 being Subset of TOP-REAL 2, f being
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0 st -1<cn & cn<1 & f=(cn-FanMorphS)|
  K0 & B0=NonZero TOP-REAL 2 & K0={p: p`2>=0 & p<>0.TOP-REAL 2} holds f is
  continuous
proof
  let cn be Real,K0,B0 be Subset of TOP-REAL 2,f be Function of (TOP-REAL 2)|
  K0,(TOP-REAL 2)|B0;
  set sn=sqrt(1-cn^2);
  set p0=|[cn,sn]|;
A1: p0`2=sn by EUCLID:56;
  assume
A2: -1<cn & cn<1 & f=(cn-FanMorphS)|K0 & B0=NonZero TOP-REAL 2 & K0={p:
  p`2>=0 & p<>0.TOP-REAL 2};
  then cn^2<1^2 by SQUARE_1:120;
  then
A3: 1-cn^2>0 by XREAL_1:52;
  then sn>0 by SQUARE_1:93;
  then p0 in K0 by A2,A1,JGRAPH_2:11;
  then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
  p0`2>0 by A1,A3,SQUARE_1:93;
  then not p0 in {0.TOP-REAL 2} by JGRAPH_2:11,TARSKI:def 1;
  then reconsider D=B0 as non empty Subset of TOP-REAL 2 by A2,XBOOLE_0:def 5;
A4: K1 c= D
  proof
    let x be set;
    assume
    x in K1;
    then consider p2 being Point of TOP-REAL 2 such that
A5: p2=x and
    p2`2>=0 and
A6: p2<>0.TOP-REAL 2 by A2;
    not p2 in {0.TOP-REAL 2} by A6,TARSKI:def 1;
    hence thesis by A2,A5,XBOOLE_0:def 5;
  end;
  for p being Point of (TOP-REAL 2)|K1,V being Subset of (TOP-REAL 2)|D
st f.p in V & V is open holds ex W being Subset of (TOP-REAL 2)|K1 st p in W &
  W is open & f.:W c= V
  proof
    let p be Point of (TOP-REAL 2)|K1,V be Subset of (TOP-REAL 2)|D;
    assume that
A7: f.p in V and
A8: V is open;
    consider V2 being Subset of TOP-REAL 2 such that
A9: V2 is open and
A10: V2 /\ [#]((TOP-REAL 2)|D)=V by A8,TOPS_2:32;
    reconsider W2=V2 /\ [#]((TOP-REAL 2)|K1) as Subset of (TOP-REAL 2)| K1;
A11: [#]((TOP-REAL 2)|K1)=K1 by PRE_TOPC:def 10;
    then
A12: f.p=(cn-FanMorphS).p by A2,FUNCT_1:72;
A13: f.:W2 c= V
    proof
      let y be set;
      assume
      y in f.:W2;
      then consider x being set such that
A14:  x in dom f and
A15:  x in W2 and
A16:  y=f.x by FUNCT_1:def 12;
      f is Function of (TOP-REAL 2)|K1,(TOP-REAL 2)|D;
      then dom f= K1 by A11,FUNCT_2:def 1;
      then consider p4 being Point of TOP-REAL 2 such that
A17:  x=p4 and
A18:  p4`2>=0 and
      p4<>0.TOP-REAL 2 by A2,A14;
A19:  p4 in V2 by A15,A17,XBOOLE_0:def 4;
      p4 in [#]((TOP-REAL 2)|K1) by A14,A17;
      then p4 in D by A4,A11;
      then
A20:  p4 in [#]((TOP-REAL 2)|D) by PRE_TOPC:def 10;
      f.p4=(cn-FanMorphS).p4 by A2,A11,A14,A17,FUNCT_1:72
        .=p4 by A18,Th120;
      hence thesis by A10,A16,A17,A19,A20,XBOOLE_0:def 4;
    end;
    p in the carrier of (TOP-REAL 2)|K1;
    then consider q being Point of TOP-REAL 2 such that
A21: q=p and
A22: q`2>=0 and
    q <>0.TOP-REAL 2 by A2,A11;
    (cn-FanMorphS).q=q by A22,Th120;
    then p in V2 by A7,A10,A12,A21,XBOOLE_0:def 4;
    then
A23: p in W2 by XBOOLE_0:def 4;
    W2 is open by A9,TOPS_2:32;
    hence thesis by A23,A13;
  end;
  hence thesis by JGRAPH_2:20;
end;

theorem Th133:
  for cn being Real, B0 being Subset of TOP-REAL 2,K0 being
Subset of (TOP-REAL 2)|B0,f being Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2
)|B0) st -1<cn & cn<1 & f=(cn-FanMorphS)|K0 & B0=NonZero TOP-REAL 2 & K0={p: p
  `2<=0 & p<>0.TOP-REAL 2} holds f is continuous
proof
  let cn be Real, B0 be Subset of TOP-REAL 2,K0 be Subset of (TOP-REAL 2)|B0,f
  be Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0);
  the carrier of (TOP-REAL 2)|B0= B0 by PRE_TOPC:29;
  then reconsider K1=K0 as Subset of TOP-REAL 2 by XBOOLE_1:1;
  assume
A1: -1<cn & cn<1 & f=(cn-FanMorphS)|K0 & B0=NonZero TOP-REAL 2 & K0={p:
  p`2<=0 & p<>0.TOP-REAL 2 };
  K0 c= B0
  proof
    let x be set;
    assume
    x in K0;
    then
A2: ex p8 being Point of TOP-REAL 2 st x=p8 & p8`2<=0 & p8 <>0.TOP-REAL 2
    by A1;
    then not x in {0.TOP-REAL 2} by TARSKI:def 1;
    hence thesis by A1,A2,XBOOLE_0:def 5;
  end;
  then ((TOP-REAL 2)|B0)|K0=(TOP-REAL 2)|K1 by PRE_TOPC:28;
  hence thesis by A1,Th131;
end;

theorem Th134:
  for cn being Real, B0 being Subset of TOP-REAL 2,K0 being
Subset of (TOP-REAL 2)|B0,f being Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2
)|B0) st -1<cn & cn<1 & f=(cn-FanMorphS)|K0 & B0=NonZero TOP-REAL 2 & K0={p: p
  `2>=0 & p<>0.TOP-REAL 2} holds f is continuous
proof
  let cn be Real, B0 be Subset of TOP-REAL 2,K0 be Subset of (TOP-REAL 2)|B0,f
  be Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0);
  the carrier of (TOP-REAL 2)|B0=B0 by PRE_TOPC:29;
  then reconsider K1=K0 as Subset of TOP-REAL 2 by XBOOLE_1:1;
  assume
A1: -1<cn & cn<1 & f=(cn-FanMorphS)|K0 & B0=NonZero TOP-REAL 2 & K0={p:
  p`2>=0 & p<>0.TOP-REAL 2};
  K0 c= B0
  proof
    let x be set;
    assume
    x in K0;
    then
A2: ex p8 being Point of TOP-REAL 2 st x=p8 & p8`2>=0 & p8 <>0.TOP-REAL 2
    by A1;
    then not x in {0.TOP-REAL 2} by TARSKI:def 1;
    hence thesis by A1,A2,XBOOLE_0:def 5;
  end;
  then ((TOP-REAL 2)|B0)|K0=(TOP-REAL 2)|K1 by PRE_TOPC:28;
  hence thesis by A1,Th132;
end;

theorem Th135:
  for cn being Real,p being Point of TOP-REAL 2 holds |.(cn
  -FanMorphS).p.|=|.p.|
proof
  let cn be Real,p be Point of TOP-REAL 2;
  set f=cn-FanMorphS;
  set z=f.p;
  set q=p;
  reconsider qz=z as Point of TOP-REAL 2;
  per cases;
  suppose
A1: q`1/|.q.|>=cn & q`2<0;
    then
A2: (cn-FanMorphS).q= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)), |.q.|*( -sqrt(1-(
    (q`1/|.q.|-cn)/(1-cn))^2))]| by Th120;
    then
A3: qz`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)) by EUCLID:56;
A4: qz`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by A2,EUCLID:56;
A5: (q`1/|.q.|-cn)>=0 by A1,XREAL_1:50;
A6: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
    |.q.|<>0 by A1,JGRAPH_2:11,TOPRNS_1:25;
    then
A7: (|.q.|)^2>0 by SQUARE_1:74;
    0<=(q`2)^2 by XREAL_1:65;
    then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
    then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A6,XREAL_1:74;
    then (q`1)^2/(|.q.|)^2 <= 1 by A7,XCMPLX_1:60;
    then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
    then 1>=q`1/|.q.| by SQUARE_1:121;
    then
A8: 1-cn>=q`1/|.q.|-cn by XREAL_1:11;
    per cases;
    suppose
A9:   1-cn=0;
A10:  ((q`1/|.q.|-cn)/(1-cn))=(q`1/|.q.|-cn)*(1-cn)" by XCMPLX_0:def 9
        .= (q`1/|.q.|-cn)*0 by A9
        .=0;
      then 1-((q`1/|.q.|-cn)/(1-cn))^2=1;
      then (cn-FanMorphS).q= |[ |.q.|*0,|.q.|*(-1)]| by A1,A10,Th120,
      SQUARE_1:83
        .=|[0,-(|.q.|)]|;
      then ((cn-FanMorphS).q)`2=(- |.q.|) & ((cn-FanMorphS).q)`1=0 by
      EUCLID:56;
      then |.(cn-FanMorphS).p.|=sqrt((-(|.q.|))^2+0^2) by JGRAPH_3:10
        .=sqrt(((|.q.|))^2)
        .=|.q.| by SQUARE_1:89;
      hence thesis;
    end;
    suppose
A11:  1-cn<>0;
      per cases by A11;
      suppose
A12:    1-cn>0;
        -(1-cn)<= -( q`1/|.q.|-cn) by A8,XREAL_1:26;
        then (-(1-cn))/(1-cn)<=(-( q`1/|.q.|-cn))/(1-cn) by A12,
        XREAL_1:74;
        then -1<=(-( q`1/|.q.|-cn))/(1-cn) by A12,XCMPLX_1:198;
        then ((-(q`1/|.q.|-cn))/(1-cn))^2<=1^2 by A5,A12,SQUARE_1:119;
        then 1-((-(q`1/|.q.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
        then
A13:    1-(-((q`1/|.q.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
A14:    (qz`2)^2= (|.q.|)^2*(sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))^2 by A3
          .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1-cn))^2) by A13,SQUARE_1:def 4;
        (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
          .=(|.q.|)^2 by A4,A14;
        then sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
        hence thesis by SQUARE_1:89;
      end;
      suppose
A15:    1-cn<0;
        0+(q`1)^2<(q`1)^2+(q`2)^2 by A1,SQUARE_1:74,XREAL_1:10;
        then (q`1)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A7,A6,XREAL_1:76;
        then (q`1)^2/(|.q.|)^2 < 1 by A7,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 < 1 by XCMPLX_1:77;
        then
A16:    1 > q`1/|.p.| by SQUARE_1:122;
        q`1/|.q.|-cn>=0 by A1,XREAL_1:50;
        hence thesis by A15,A16,XREAL_1:11;
      end;
    end;
  end;
  suppose
A17: q`1/|.q.|<cn & q`2<0;
    then |.q.|<>0 by JGRAPH_2:11,TOPRNS_1:25;
    then
A18: (|.q.|)^2>0 by SQUARE_1:74;
A19: (q`1/|.q.|-cn)<0 by A17,XREAL_1:51;
A20: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
    0<=(q`2)^2 by XREAL_1:65;
    then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
    then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A20,XREAL_1:74;
    then (q`1)^2/(|.q.|)^2 <= 1 by A18,XCMPLX_1:60;
    then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
    then -1<=q`1/|.q.| by SQUARE_1:121;
    then
A21: -1-cn<=q`1/|.q.|-cn by XREAL_1:11;
A22: (cn-FanMorphS).q= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)), |.q.|*( -sqrt(1-
    ((q`1/|.q.|-cn)/(1+cn))^2))]| by A17,Th121;
    then
A23: qz`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)) by EUCLID:56;
A24: qz`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by A22,EUCLID:56;
    per cases;
    suppose
A25:  1+cn=0;
      ((q`1/|.q.|-cn)/(1+cn))=(q`1/|.q.|-cn)*(1+cn)" by XCMPLX_0:def 9
        .= (q`1/|.q.|-cn)*0 by A25
        .=0;
      then ((cn-FanMorphS).q)`2=-(|.q.|) & ((cn-FanMorphS).q)`1=0 by A22,
      EUCLID:56 ,SQUARE_1:83;
      then |.(cn-FanMorphS).p.|=sqrt((-(|.q.|))^2+0^2) by JGRAPH_3:10
        .=sqrt(((|.q.|))^2)
        .=|.q.| by SQUARE_1:89;
      hence thesis;
    end;
    suppose
A26:  1+cn<>0;
      per cases by A26;
      suppose
A27:    1+cn>0;
        then (-(1+cn))/(1+cn)<=(( q`1/|.q.|-cn))/(1+cn) by A21,
        XREAL_1:74;
        then -1<=(( q`1/|.q.|-cn))/(1+cn) by A27,XCMPLX_1:198;
        then ( (q`1/|.q.|-cn) /(1+cn))^2<=1^2 by A19,A27,SQUARE_1:119;
        then
A28:    1-(((q`1/|.q.|-cn))/(1+cn))^2>=0 by XREAL_1:50;
A29:    (qz`2)^2= (|.q.|)^2*(sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))^2 by A23
          .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1+cn))^2) by A28,SQUARE_1:def 4;
        (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
          .=(|.q.|)^2 by A24,A29;
        then sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
        hence thesis by SQUARE_1:89;
      end;
      suppose
A30:    1+cn<0;
        0+(q`1)^2<(q`1)^2+(q`2)^2 by A17,SQUARE_1:74,XREAL_1:10;
        then (q`1)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A18,A20,
        XREAL_1:76;
        then (q`1)^2/(|.q.|)^2 < 1 by A18,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 < 1 by XCMPLX_1:77;
        then -1 < q`1/|.p.| by SQUARE_1:122;
        then
A31:    q`1/|.q.|-cn>-1-cn by XREAL_1:11;
        -(1+cn)>-0 by A30,XREAL_1:26;
        hence thesis by A17,A31,XREAL_1:51;
      end;
    end;
  end;
  suppose
    q`2>=0;
    hence thesis by Th120;
  end;
end;

theorem Th136:
  for cn being Real,x,K0 being set st -1<cn & cn<1 & x in K0 & K0
  ={p: p`2<=0 & p<>0.TOP-REAL 2} holds (cn-FanMorphS).x in K0
proof
  let cn be Real,x,K0 be set;
  assume
A1: -1<cn & cn<1 & x in K0 & K0={p: p`2<=0 & p<>0.TOP-REAL 2};
  then consider p such that
A2: p=x and
A3: p`2<=0 and
A4: p<>0.TOP-REAL 2;
A5: now
    assume
    |.p.|<=0;
    then |.p.|=0;
    hence contradiction by A4,TOPRNS_1:25;
  end;
  then
A6: (|.p.|)^2>0 by SQUARE_1:74;
  per cases;
  suppose
A7: p`1/|.p.|<=cn;
    reconsider p9= (cn-FanMorphS).p as Point of TOP-REAL 2;
    (cn-FanMorphS).p= |[ |.p.|*((p`1/|.p.|-cn)/(1+cn)), |.p.|*( -sqrt(1-(
    (p`1/|.p.|-cn)/(1+cn))^2))]| by A1,A3,A4,A7,Th122;
    then
A8: p9`2=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)) by EUCLID:56;
A9: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
A10: 1+cn>0 by A1,XREAL_1:150;
    per cases;
    suppose
      p`2=0;
      hence thesis by A1,A2,Th120;
    end;
    suppose
      p`2<>0;
      then 0+(p`1)^2<(p`1)^2+(p`2)^2 by SQUARE_1:74,XREAL_1:10;
      then (p`1)^2/(|.p.|)^2 < (|.p.|)^2/(|.p.|)^2 by A6,A9,XREAL_1:76;
      then (p`1)^2/(|.p.|)^2 < 1 by A6,XCMPLX_1:60;
      then ((p`1)/|.p.|)^2 < 1 by XCMPLX_1:77;
      then -1 < p`1/|.p.| by SQUARE_1:122;
      then -1-cn< p`1/|.p.|-cn by XREAL_1:11;
      then (-1)*(1+cn)/(1+cn)< (p`1/|.p.|-cn)/(1+cn) by A10,XREAL_1:76;
      then
A11:  -1< (p`1/|.p.|-cn)/(1+cn) by A10,XCMPLX_1:90;
      p`1/|.p.|-cn<=0 by A7,XREAL_1:49;
      then 1^2> ((p`1/|.p.|-cn)/(1+cn))^2 by A10,A11,SQUARE_1:120;
      then 1-((p`1/|.p.|-cn)/(1+cn))^2>0 by XREAL_1:52;
      then --sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)>0 by SQUARE_1:93;
      then -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)<0;
      then |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))<0 by A5,
      XREAL_1:134;
      hence thesis by A1,A2,A8,JGRAPH_2:11;
    end;
  end;
  suppose
A12: p`1/|.p.|>cn;
    reconsider p9= (cn-FanMorphS).p as Point of TOP-REAL 2;
    (cn-FanMorphS).p= |[ |.p.|*((p`1/|.p.|-cn)/(1-cn)), |.p.|*( -sqrt(1-(
    (p`1/|.p.|-cn)/(1-cn))^2))]| by A1,A3,A4,A12,Th122;
    then
A13: p9`2=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)) by EUCLID:56;
A14: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
A15: 1-cn>0 by A1,XREAL_1:151;
    per cases;
    suppose
      p`2=0;
      hence thesis by A1,A2,Th120;
    end;
    suppose
      p`2<>0;
      then 0+(p`1)^2<(p`1)^2+(p`2)^2 by SQUARE_1:74,XREAL_1:10;
      then (p`1)^2/(|.p.|)^2 < (|.p.|)^2/(|.p.|)^2 by A6,A14,XREAL_1:76;
      then (p`1)^2/(|.p.|)^2 < 1 by A6,XCMPLX_1:60;
      then ((p`1)/|.p.|)^2 < 1 by XCMPLX_1:77;
      then p`1/|.p.|<1 by SQUARE_1:122;
      then (p`1/|.p.|-cn)<1-cn by XREAL_1:11;
      then (p`1/|.p.|-cn)/(1-cn)<(1-cn)/(1-cn) by A15,XREAL_1:76;
      then
A16:  (p`1/|.p.|-cn)/(1-cn)<1 by A15,XCMPLX_1:60;
      -(1-cn)< -0 & p`1/|.p.|-cn>=cn-cn by A12,A15,XREAL_1:11,26;
      then (-1)*(1-cn)/(1-cn)< (p`1/|.p.|-cn)/(1-cn) by A15,XREAL_1:76;
      then -1< (p`1/|.p.|-cn)/(1-cn) by A15,XCMPLX_1:90;
      then 1^2> ((p`1/|.p.|-cn)/(1-cn))^2 by A16,SQUARE_1:120;
      then 1-((p`1/|.p.|-cn)/(1-cn))^2>0 by XREAL_1:52;
      then --sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)>0 by SQUARE_1:93;
      then -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)<0;
      then p9`2<0 by A5,A13,XREAL_1:134;
      hence thesis by A1,A2,JGRAPH_2:11;
    end;
  end;
end;

theorem Th137:
  for cn being Real,x,K0 being set st -1<cn & cn<1 & x in K0 & K0
  ={p: p`2>=0 & p<>0.TOP-REAL 2} holds (cn-FanMorphS).x in K0
proof
  let cn be Real,x,K0 be set;
  assume
A1: -1<cn & cn<1 & x in K0 & K0={p: p`2>=0 & p<>0.TOP-REAL 2};
  then ex p st p=x & p`2>=0 & p<>0.TOP-REAL 2;
  hence thesis by A1,Th120;
end;

theorem Th138:
  for cn being Real, D being non empty Subset of TOP-REAL 2 st -1
  <cn & cn<1 & D`={0.TOP-REAL 2} holds ex h being Function of (TOP-REAL 2)|D,(
  TOP-REAL 2)|D st h=(cn-FanMorphS)|D & h is continuous
proof
  set Y1=|[0,1]|;
  defpred P[Point of TOP-REAL 2] means $1`2<=0;
  reconsider B0= {0.TOP-REAL 2} as Subset of TOP-REAL 2;
  let cn be Real,D be non empty Subset of TOP-REAL 2;
  assume that
A1: -1<cn & cn<1 and
A2: D`={0.TOP-REAL 2};
A3: the carrier of ((TOP-REAL 2)|D)=D by PRE_TOPC:29;
  dom (cn-FanMorphS)=(the carrier of (TOP-REAL 2)) by FUNCT_2:def 1;
  then
A4: dom ((cn-FanMorphS)|D)=(the carrier of (TOP-REAL 2))/\ D by
  RELAT_1:90
    .=the carrier of ((TOP-REAL 2)|D) by A3,XBOOLE_1:28;
  (|[0,-1]|)`2=-1 & |[0,-1]|<>0.TOP-REAL 2 by EUCLID:56,JGRAPH_2:11;
  then
A5: |[0,-1]| in {p where p is Point of TOP-REAL 2: p`2<=0 & p<>0.TOP-REAL 2};
  Y1`2=1 by EUCLID:56;
  then
A6: Y1 in {p where p is Point of TOP-REAL 2: p`2>=0 & p<>0.TOP-REAL 2} by
  JGRAPH_2:11;
A7: D =B0` by A2
    .=(NonZero TOP-REAL 2) by SUBSET_1:def 5;
  {p: P[p] & p<>0.TOP-REAL 2} c= the carrier of (TOP-REAL 2)|D from
  InclSub(A7);
  then reconsider
  K0={p:p`2<=0 & p<>0.TOP-REAL 2} as non empty Subset of (TOP-REAL
  2)|D by A5;
A8: K0=the carrier of ((TOP-REAL 2)|D)|K0 by PRE_TOPC:29;
  defpred P[Point of TOP-REAL 2] means $1`2>=0;
  {p: P[p] & p<>0.TOP-REAL 2} c= the carrier of (TOP-REAL 2)|D from
  InclSub(A7);
  then reconsider
  K1={p: p`2>=0 & p<>0.TOP-REAL 2} as non empty Subset of (TOP-REAL
  2)|D by A6;
A9: K0 is closed & K1 is closed by A7,Th69,Th70;
A10: the carrier of ((TOP-REAL 2)|D) =D by PRE_TOPC:29;
A11: rng ((cn-FanMorphS)|K0) c= the carrier of ((TOP-REAL 2)|D)|K0
  proof
    let y be set;
    assume
    y in rng ((cn-FanMorphS)|K0);
    then consider x being set such that
A12: x in dom ((cn-FanMorphS)|K0) and
A13: y=((cn-FanMorphS)|K0).x by FUNCT_1:def 5;
    x in (dom (cn-FanMorphS)) /\ K0 by A12,RELAT_1:90;
    then
A14: x in K0 by XBOOLE_0:def 4;
    K0 c= the carrier of TOP-REAL 2 by A10,XBOOLE_1:1;
    then reconsider p=x as Point of TOP-REAL 2 by A14;
    (cn-FanMorphS).p=y by A13,A14,FUNCT_1:72;
    then y in K0 by A1,A14,Th136;
    hence thesis by PRE_TOPC:29;
  end;
A15: K0 c= (the carrier of TOP-REAL 2)
  proof
    let z be set;
    assume
    z in K0;
    then ex p8 being Point of TOP-REAL 2 st p8=z & p8`2<=0 & p8 <>0.TOP-REAL 2;
    hence thesis;
  end;
  dom ((cn-FanMorphS)|K0)= dom ((cn-FanMorphS)) /\ K0 by RELAT_1:90
    .=((the carrier of TOP-REAL 2)) /\ K0 by FUNCT_2:def 1
    .=K0 by A15,XBOOLE_1:28;
  then reconsider f=(cn-FanMorphS)|K0 as Function of ((TOP-REAL 2)|D)|K0, ((
  TOP-REAL 2)|D) by A8,A11,FUNCT_2:4,XBOOLE_1:1;
A16: K1=the carrier of ((TOP-REAL 2)|D)|K1 by PRE_TOPC:29;
A17: rng ((cn-FanMorphS)|K1) c= the carrier of ((TOP-REAL 2)|D)|K1
  proof
    let y be set;
    assume
    y in rng ((cn-FanMorphS)|K1);
    then consider x being set such that
A18: x in dom ((cn-FanMorphS)|K1) and
A19: y=((cn-FanMorphS)|K1).x by FUNCT_1:def 5;
    x in (dom (cn-FanMorphS)) /\ K1 by A18,RELAT_1:90;
    then
A20: x in K1 by XBOOLE_0:def 4;
    K1 c= the carrier of TOP-REAL 2 by A10,XBOOLE_1:1;
    then reconsider p=x as Point of TOP-REAL 2 by A20;
    (cn-FanMorphS).p=y by A19,A20,FUNCT_1:72;
    then y in K1 by A1,A20,Th137;
    hence thesis by PRE_TOPC:29;
  end;
A21: K1 c= (the carrier of TOP-REAL 2)
  proof
    let z be set;
    assume
    z in K1;
    then ex p8 being Point of TOP-REAL 2 st p8=z & p8`2>=0 & p8 <>0.TOP-REAL 2;
    hence thesis;
  end;
  dom ((cn-FanMorphS)|K1)= dom ((cn-FanMorphS)) /\ K1 by RELAT_1:90
    .=((the carrier of TOP-REAL 2)) /\ K1 by FUNCT_2:def 1
    .=K1 by A21,XBOOLE_1:28;
  then reconsider g=(cn-FanMorphS)|K1 as Function of ((TOP-REAL 2)|D)|K1, ((
  TOP-REAL 2)|D) by A16,A17,FUNCT_2:4,XBOOLE_1:1;
A22: K1=[#](((TOP-REAL 2)|D)|K1) by PRE_TOPC:def 10;
A23: D c= K0 \/ K1
  proof
    let x be set;
    assume
A24: x in D;
    then reconsider px=x as Point of TOP-REAL 2;
    not x in {0.TOP-REAL 2} by A7,A24,XBOOLE_0:def 5;
    then px`2>=0 & px<>0.TOP-REAL 2 or px`2<=0 & px<>0.TOP-REAL 2 by
    TARSKI:def 1;
    then x in K1 or x in K0;
    hence thesis by XBOOLE_0:def 3;
  end;
A25: dom f=K0 by A8,FUNCT_2:def 1;
A26: K0=[#](((TOP-REAL 2)|D)|K0) by PRE_TOPC:def 10;
A27: for x be set st x in ([#]((((TOP-REAL 2)|D)|K0))) /\ ([#] ((((TOP-REAL
  2)|D)|K1))) holds f.x = g.x
  proof
    let x be set;
    assume
A28: x in ([#]((((TOP-REAL 2)|D)|K0))) /\ ([#] ((((TOP-REAL 2)|D)|K1))
    );
    then x in K0 by A26,XBOOLE_0:def 4;
    then f.x=(cn-FanMorphS).x by FUNCT_1:72;
    hence thesis by A22,A28,FUNCT_1:72;
  end;
  D= [#]((TOP-REAL 2)|D) by PRE_TOPC:def 10;
  then
A29: ([#](((TOP-REAL 2)|D)|K0)) \/ ([#](((TOP-REAL 2)|D)|K1)) = [#]((
  TOP-REAL 2)|D) by A26,A22,A23,XBOOLE_0:def 10;
A30: f is continuous & g is continuous by A1,A7,Th133,Th134;
  then consider h being Function of (TOP-REAL 2)|D,(TOP-REAL 2)|D such that
A31: h= f+*g and
  h is continuous by A26,A22,A29,A9,A27,JGRAPH_2:9;
A32: dom g=K1 by A16,FUNCT_2:def 1;
  K0=[#](((TOP-REAL 2)|D)|K0) & K1=[#](((TOP-REAL 2)|D)|K1) by PRE_TOPC:
  def 10;
  then
A33: f tolerates g by A27,A25,A32,PARTFUN1:def 6;
A34: the carrier of ((TOP-REAL 2)|D) =(NonZero TOP-REAL 2) by A7,PRE_TOPC:29;
A35: for x being set st x in dom h holds h.x=((cn-FanMorphS)|D).x
  proof
    let x be set;
    assume
A36: x in dom h;
    then reconsider p=x as Point of TOP-REAL 2 by A34,XBOOLE_0:def 5;
    not x in {0.TOP-REAL 2} by A7,A3,A36,XBOOLE_0:def 5;
    then
A37: x <>0.TOP-REAL 2 by TARSKI:def 1;
    per cases;
    suppose
A38:  x in K0;
A39:  (cn-FanMorphS)|D.p=(cn-FanMorphS).p by A3,A36,FUNCT_1:72
        .=f.p by A38,FUNCT_1:72;
      h.p=(g+*f).p by A31,A33,FUNCT_4:35
        .=f.p by A25,A38,FUNCT_4:14;
      hence thesis by A39;
    end;
    suppose
      not x in K0;
      then not p`2<=0 by A37;
      then
A40:  x in K1 by A37;
      (cn-FanMorphS)|D.p=(cn-FanMorphS).p by A3,A36,FUNCT_1:72
        .=g.p by A40,FUNCT_1:72;
      hence thesis by A31,A32,A40,FUNCT_4:14;
    end;
  end;
  dom h=the carrier of ((TOP-REAL 2)|D) by FUNCT_2:def 1;
  then f+*g=(cn-FanMorphS)|D by A31,A4,A35,FUNCT_1:9;
  hence thesis by A26,A22,A29,A30,A9,A27,JGRAPH_2:9;
end;

theorem Th139:
  for cn being Real st -1<cn & cn<1 holds cn-FanMorphS is
  continuous
proof
  reconsider D=NonZero TOP-REAL 2 as non empty Subset of TOP-REAL 2 by
  JGRAPH_2:19;
  let cn be Real;
  assume that
A1: -1<cn and
A2: cn<1;
  reconsider f=cn-FanMorphS as Function of TOP-REAL 2,TOP-REAL 2;
A3: f.(0.TOP-REAL 2)=0.TOP-REAL 2 by Th120,JGRAPH_2:11;
A4: for p being Point of (TOP-REAL 2)|D holds f.p<>f.(0.TOP-REAL 2)
  proof
    let p be Point of (TOP-REAL 2)|D;
A5: [#]((TOP-REAL 2)|D)=D by PRE_TOPC:def 10;
    then reconsider q=p as Point of TOP-REAL 2 by XBOOLE_0:def 5;
    not p in {0.TOP-REAL 2} by A5,XBOOLE_0:def 5;
    then
A6: p<>0.TOP-REAL 2 by TARSKI:def 1;
    per cases;
    suppose
A7:   q`1/|.q.|>=cn & q`2<=0;
      set q9= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)), |.q.|*( -sqrt(1-((q`1/|.q.|-
      cn)/(1-cn))^2))]|;
A8:   q9`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by EUCLID:56;
A9:   q9`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)) by EUCLID:56;
      now
        assume
A10:    q9=0.TOP-REAL 2;
A11:    |.q.|<>0^2 by A6,TOPRNS_1:25;
        then -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)= -sqrt(1-0) by A8,A10,
        JGRAPH_2:11,XCMPLX_1:6
          .=-1 by SQUARE_1:83;
        hence contradiction by A9,A10,A11,JGRAPH_2:11,XCMPLX_1:6;
      end;
      hence thesis by A1,A2,A3,A6,A7,Th122;
    end;
    suppose
A12:  q`1/|.q.|<cn & q`2<=0;
      set q9=|[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)), |.q.|*( -sqrt(1-((q`1/|.q.|-cn
      )/(1+cn))^2))]|;
A13:  q9`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by EUCLID:56;
A14:  q9`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)) by EUCLID:56;
      now
        assume
A15:    q9=0.TOP-REAL 2;
A16:    |.q.|<>0^2 by A6,TOPRNS_1:25;
        then -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)= -sqrt(1-0) by A13,A15,
        JGRAPH_2:11,XCMPLX_1:6
          .=-1 by SQUARE_1:83;
        hence contradiction by A14,A15,A16,JGRAPH_2:11,XCMPLX_1:6;
      end;
      hence thesis by A1,A2,A3,A6,A12,Th122;
    end;
    suppose
      q`2>0;
      then f.p=p by Th120;
      hence thesis by A6,Th120,JGRAPH_2:11;
    end;
  end;
A17: for V being Subset of (TOP-REAL 2) st f.(0.TOP-REAL 2) in V & V is open
ex W being Subset of (TOP-REAL 2) st 0.TOP-REAL 2 in W & W is open & f.:W c= V
  proof
    reconsider u0=0.TOP-REAL 2 as Point of Euclid 2 by EUCLID:71;
    let V be Subset of TOP-REAL 2;
    reconsider VV = V as Subset of TopSpaceMetr Euclid 2 by Lm11;
    assume that
A18: f.(0.TOP-REAL 2) in V and
A19: V is open;
    VV is open by A19,Lm11,PRE_TOPC:60;
    then consider r being real number such that
A20: r>0 and
A21: Ball(u0,r) c= V by A3,A18,TOPMETR:22;
    reconsider r as Real by XREAL_0:def 1;
    the TopStruct of TOP-REAL 2 = TopSpaceMetr Euclid 2 by EUCLID:def 8;
    then reconsider W1=Ball(u0,r) as Subset of TOP-REAL 2;
A22: W1 is open by GOBOARD6:6;
A23: f.:W1 c= W1
    proof
      let z be set;
      assume
      z in f.:W1;
      then consider y being set such that
A24:  y in dom f and
A25:  y in W1 and
A26:  z=f.y by FUNCT_1:def 12;
      z in rng f by A24,A26,FUNCT_1:def 5;
      then reconsider qz=z as Point of TOP-REAL 2;
      reconsider pz=qz as Point of Euclid 2 by EUCLID:71;
      reconsider q=y as Point of TOP-REAL 2 by A24;
      reconsider qy=q as Point of Euclid 2 by EUCLID:71;
      dist(u0,qy)<r by A25,METRIC_1:12;
      then
A27:  |.(0.TOP-REAL 2) - q.|<r by JGRAPH_1:45;
      per cases by JGRAPH_2:11;
      suppose
        q`2>=0;
        hence thesis by A25,A26,Th120;
      end;
      suppose
A28:    q<>0.TOP-REAL 2 & q`1/|.q.|>=cn & q`2<=0;
        then
A29:    (q`1/|.q.|-cn)>= 0 by XREAL_1:50;
        0<=(q`2)^2 by XREAL_1:65;
        then (|.q.|)^2 =(q`1)^2+(q`2)^2 & 0+(q`1)^2<=(q`1)^2+(q`2)^2 by
        JGRAPH_3:10 ,XREAL_1:9;
        then
A30:    (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by XREAL_1:74;
A31:    1-cn>0 by A2,XREAL_1:151;
        |.q.|<>0 by A28,TOPRNS_1:25;
        then (|.q.|)^2>0 by SQUARE_1:74;
        then (q`1)^2/(|.q.|)^2 <= 1 by A30,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then 1>=q`1/|.q.| by SQUARE_1:121;
        then 1-cn>=q`1/|.q.|-cn by XREAL_1:11;
        then -(1-cn)<= -( q`1/|.q.|-cn) by XREAL_1:26;
        then (-(1-cn))/(1-cn)<=(-( q`1/|.q.|-cn))/(1-cn) by A31,
        XREAL_1:74;
        then -1<=(-( q`1/|.q.|-cn))/(1-cn) by A31,XCMPLX_1:198;
        then ((-(q`1/|.q.|-cn))/(1-cn))^2<=1^2 by A31,A29,SQUARE_1:119;
        then 1-((-(q`1/|.q.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
        then
A32:    1-(-((q`1/|.q.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
A33:    (cn-FanMorphS).q= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)) , |.q.|*( -
        sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by A1,A2,A28,Th122;
        then
A34:    qz`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by A26,EUCLID:56;
        qz`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)) by A26,A33,
        EUCLID:56;
        then
A35:    (qz`2)^2= (|.q.|)^2*(sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))^2
          .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1-cn))^2) by A32,SQUARE_1:def 4;
        (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
          .=(|.q.|)^2 by A34,A35;
        then sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
        then
A36:    |.qz.|=|.q.| by SQUARE_1:89;
        |.- q.|<r by A27,EUCLID:31;
        then |.q.|<r by TOPRNS_1:27;
        then |.- qz.|<r by A36,TOPRNS_1:27;
        then |.(0.TOP-REAL 2) - qz.|<r by EUCLID:31;
        then dist(u0,pz)<r by JGRAPH_1:45;
        hence thesis by METRIC_1:12;
      end;
      suppose
A37:    q<>0.TOP-REAL 2 & q`1/|.q.|<cn & q`2<=0;
        0<=(q`2)^2 by XREAL_1:65;
        then (|.q.|)^2 =(q`1)^2+(q`2)^2 & 0+(q`1)^2<=(q`1)^2+(q`2)^2 by
        JGRAPH_3:10 ,XREAL_1:9;
        then
A38:    (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by XREAL_1:74;
A39:    1+cn>0 by A1,XREAL_1:150;
        |.q.|<>0 by A37,TOPRNS_1:25;
        then (|.q.|)^2>0 by SQUARE_1:74;
        then (q`1)^2/(|.q.|)^2 <= 1 by A38,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then -1<=q`1/|.q.| by SQUARE_1:121;
        then --1>=-q`1/|.q.| by XREAL_1:26;
        then 1+cn>=-q`1/|.q.|+cn by XREAL_1:9;
        then
A40:    (-(q`1/|.q.|-cn))/(1+cn)<=1 by A39,XREAL_1:187;
        (cn-q`1/|.q.|)>=0 by A37,XREAL_1:50;
        then -1<=(-( q`1/|.q.|-cn))/(1+cn) by A39;
        then ((-(q`1/|.q.|-cn))/(1+cn))^2<=1^2 by A40,SQUARE_1:119;
        then 1-((-(q`1/|.q.|-cn))/(1+cn))^2>=0 by XREAL_1:50;
        then
A41:    1-(-((q`1/|.q.|-cn))/(1+cn))^2>=0 by XCMPLX_1:188;
A42:    (cn-FanMorphS).q= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)), |.q.|*( -
        sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]| by A1,A2,A37,Th122;
        then
A43:    qz`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by A26,EUCLID:56;
        qz`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)) by A26,A42,
        EUCLID:56;
        then
A44:    (qz`2)^2= (|.q.|)^2*(sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))^2
          .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1+cn))^2) by A41,SQUARE_1:def 4;
        (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
          .=(|.q.|)^2 by A43,A44;
        then sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
        then
A45:    |.qz.|=|.q.| by SQUARE_1:89;
        |.- q.|<r by A27,EUCLID:31;
        then |.q.|<r by TOPRNS_1:27;
        then |.- qz.|<r by A45,TOPRNS_1:27;
        then |.(0.TOP-REAL 2) - qz.|<r by EUCLID:31;
        then dist(u0,pz)<r by JGRAPH_1:45;
        hence thesis by METRIC_1:12;
      end;
    end;
    u0 in W1 by A20,GOBOARD6:4;
    hence thesis by A21,A22,A23,XBOOLE_1:1;
  end;
A46: D`= {0.TOP-REAL 2} by JGRAPH_3:30;
  then
  ex h being Function of (TOP-REAL 2)|D,(TOP-REAL 2)|D st h=(cn-FanMorphS
  )|D & h is continuous by A1,A2,Th138;
  hence thesis by A3,A46,A4,A17,JGRAPH_3:13;
end;

theorem Th140:
  for cn being Real st -1<cn & cn<1 holds cn-FanMorphS is
  one-to-one
proof
  let cn be Real;
  assume that
A1: -1<cn and
A2: cn<1;
  for x1,x2 being set st x1 in dom (cn-FanMorphS) & x2 in dom (cn
  -FanMorphS) & (cn-FanMorphS).x1=(cn-FanMorphS).x2 holds x1=x2
  proof
    let x1,x2 be set;
    assume that
A3: x1 in dom (cn-FanMorphS) and
A4: x2 in dom (cn-FanMorphS) and
A5: (cn-FanMorphS).x1=(cn-FanMorphS).x2;
    reconsider p2=x2 as Point of TOP-REAL 2 by A4;
    reconsider p1=x1 as Point of TOP-REAL 2 by A3;
    set q=p1,p=p2;
A6: 1-cn>0 by A2,XREAL_1:151;
    per cases by JGRAPH_2:11;
    suppose
A7:   q`2>=0;
      then
A8:   (cn-FanMorphS).q=q by Th120;
      per cases by JGRAPH_2:11;
      suppose
        p`2>=0;
        hence thesis by A5,A8,Th120;
      end;
      suppose
A9:     p<>0.TOP-REAL 2 & p`1/|.p.|>=cn & p`2<=0;
        then
A10:    |.p.|<>0 by TOPRNS_1:25;
        then
A11:    (|.p.|)^2>0 by SQUARE_1:74;
A12:    (p`1/|.p.|-cn)>=0 by A9,XREAL_1:50;
A13:    (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
        0<=(p`2)^2 by XREAL_1:65;
        then 0+(p`1)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
        then (p`1)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by A13,XREAL_1:74;
        then (p`1)^2/(|.p.|)^2 <= 1 by A11,XCMPLX_1:60;
        then ((p`1)/|.p.|)^2 <= 1 by XCMPLX_1:77;
        then 1>=p`1/|.p.| by SQUARE_1:121;
        then 1-cn>=p`1/|.p.|-cn by XREAL_1:11;
        then -(1-cn)<= -( p`1/|.p.|-cn) by XREAL_1:26;
        then (-(1-cn))/(1-cn)<=(-( p`1/|.p.|-cn))/(1-cn) by A6,
        XREAL_1:74;
        then
A14:    -1<=(-( p`1/|.p.|-cn))/(1-cn) by A6,XCMPLX_1:198;
A15:    cn-FanMorphS.p= |[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)), |.p.|*( -sqrt(
        1-((p`1/|.p.|-cn)/(1-cn))^2))]| by A1,A2,A9,Th122;
        then
A16:    q`2=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)) by A5,A8,
        EUCLID:56;
        (p`1/|.p.|-cn)>= 0 by A9,XREAL_1:50;
        then ((-(p`1/|.p.|-cn))/(1-cn))^2<=1^2 by A6,A14,SQUARE_1:119;
        then
A17:    1-((-(p`1/|.p.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
        then sqrt(1-((-(p`1/|.p.|-cn))/(1-cn))^2)>=0 by SQUARE_1:def 4;
        then sqrt(1-(-(p`1/|.p.|-cn))^2/(1-cn)^2)>=0 by XCMPLX_1:77;
        then sqrt(1-(p`1/|.p.|-cn)^2/(1-cn)^2)>=0;
        then sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)>=0 by XCMPLX_1:77;
        then q`2=0 by A5,A7,A8,A15,EUCLID:56;
        then
A18:    -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)=-0 by A16,A10,XCMPLX_1:6;
        1-(-((p`1/|.p.|-cn))/(1-cn))^2>=0 by A17,XCMPLX_1:188;
        then 1-((p`1/|.p.|-cn)/(1-cn))^2=0 by A18,SQUARE_1:92;
        then 1= (p`1/|.p.|-cn)/(1-cn) by A6,A12,SQUARE_1:83,89;
        then 1 *(1-cn)=(p`1/|.p.|-cn) by A6,XCMPLX_1:88;
        then 1 *|.p.|=p`1 by A9,TOPRNS_1:25,XCMPLX_1:88;
        then p`2=0 by A13,XCMPLX_1:6;
        hence thesis by A5,A8,Th120;
        set p4= |[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)), |.p.|*( -sqrt(1-((p`1/|.p.|
        -cn)/(1-cn))^2))]|;
      end;
      suppose
A19:    p<>0.TOP-REAL 2 & p`1/|.p.|<cn & p`2<=0;
        then
A20:    cn-FanMorphS.p= |[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)), |.p.|*( -sqrt(
        1-((p`1/|.p.|-cn)/(1+cn))^2))]| by A1,A2,Th122;
        then
A21:    q`2=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)) by A5,A8,
        EUCLID:56;
A22:    (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
A23:    |.p.|<>0 by A19,TOPRNS_1:25;
        then
A24:    (|.p.|)^2>0 by SQUARE_1:74;
A25:    1+cn>0 by A1,XREAL_1:150;
A26:    (p`1/|.p.|-cn)<=0 by A19,XREAL_1:49;
        then
A27:    -1<=(-( p`1/|.p.|-cn))/(1+cn) by A25;
        0<=(p`2)^2 by XREAL_1:65;
        then 0+(p`1)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
        then (p`1)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by A22,XREAL_1:74;
        then (p`1)^2/(|.p.|)^2 <= 1 by A24,XCMPLX_1:60;
        then ((p`1)/|.p.|)^2 <= 1 by XCMPLX_1:77;
        then (-((p`1)/|.p.|))^2 <= 1;
        then 1>= -p`1/|.p.| by SQUARE_1:121;
        then (1+cn)>= -p`1/|.p.|+cn by XREAL_1:9;
        then (-(p`1/|.p.|-cn))/(1+cn)<=1 by A25,XREAL_1:187;
        then ((-(p`1/|.p.|-cn))/(1+cn))^2<=1^2 by A27,SQUARE_1:119;
        then
A28:    1-((-(p`1/|.p.|-cn))/(1+cn))^2>=0 by XREAL_1:50;
        then sqrt(1-((-(p`1/|.p.|-cn))/(1+cn))^2)>=0 by SQUARE_1:def 4;
        then sqrt(1-(-(p`1/|.p.|-cn))^2/(1+cn)^2)>=0 by XCMPLX_1:77;
        then sqrt(1-((p`1/|.p.|-cn))^2/(1+cn)^2)>=0;
        then sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)>=0 by XCMPLX_1:77;
        then q`2=0 by A5,A7,A8,A20,EUCLID:56;
        then
A29:    -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)=-0 by A21,A23,XCMPLX_1:6;
        1-(-((p`1/|.p.|-cn))/(1+cn))^2>=0 by A28,XCMPLX_1:188;
        then 1-((p`1/|.p.|-cn)/(1+cn))^2=0 by A29,SQUARE_1:92;
        then 1=(-((p`1/|.p.|-cn)/(1+cn)))^2;
        then 1= -((p`1/|.p.|-cn)/(1+cn)) by A25,A26,SQUARE_1:83,89;
        then 1= ((-(p`1/|.p.|-cn))/(1+cn)) by XCMPLX_1:188;
        then 1 *(1+cn)=-(p`1/|.p.|-cn) by A25,XCMPLX_1:88;
        then 1+cn-cn=-p`1/|.p.|;
        then 1=(-p`1)/|.p.| by XCMPLX_1:188;
        then 1 *|.p.|=-p`1 by A19,TOPRNS_1:25,XCMPLX_1:88;
        then (p`1)^2-(p`1)^2 =(p`2)^2 by A22,XCMPLX_1:26;
        then p`2=0 by XCMPLX_1:6;
        hence thesis by A5,A8,Th120;
        set p4= |[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)), |.p.|*( -sqrt(1-((p`1/|.p.|
        -cn)/(1+cn))^2))]|;
      end;
    end;
    suppose
A30:  q`1/|.q.|>=cn & q`2<=0 & q<>0.TOP-REAL 2;
      then |.q.|<>0 by TOPRNS_1:25;
      then
A31:  (|.q.|)^2>0 by SQUARE_1:74;
      set q4= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)), |.q.|*( -sqrt(1-((q`1/|.q.|-
      cn)/(1-cn))^2))]|;
A32:  q4`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by EUCLID:56;
A33:  cn-FanMorphS.q= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)), |.q.|*( -sqrt(1-
      ((q`1/|.q.|-cn)/(1-cn))^2))]| by A1,A2,A30,Th122;
      per cases by JGRAPH_2:11;
      suppose
A34:    p`2>=0;
        then
A35:    (cn-FanMorphS).p=p by Th120;
        then
A36:    p`2=|.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)) by A5,A33,
        EUCLID:56;
A37:    (q`1/|.q.|-cn)>=0 by A30,XREAL_1:50;
A38:    1-cn>0 by A2,XREAL_1:151;
A39:    |.q.|<>0 by A30,TOPRNS_1:25;
        then
A40:    (|.q.|)^2>0 by SQUARE_1:74;
A41:    (q`1/|.q.|-cn)>= 0 by A30,XREAL_1:50;
A42:    (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        0<=(q`2)^2 by XREAL_1:65;
        then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A42,XREAL_1:74;
        then (q`1)^2/(|.q.|)^2 <= 1 by A40,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then 1>=q`1/|.q.| by SQUARE_1:121;
        then 1-cn>=q`1/|.q.|-cn by XREAL_1:11;
        then -(1-cn)<= -( q`1/|.q.|-cn) by XREAL_1:26;
        then (-(1-cn))/(1-cn)<=(-( q`1/|.q.|-cn))/(1-cn) by A38, XREAL_1
        :74;
        then -1<=(-( q`1/|.q.|-cn))/(1-cn) by A38,XCMPLX_1:198;
        then ((-(q`1/|.q.|-cn))/(1-cn))^2<=1^2 by A38,A41,SQUARE_1:119;
        then
A43:    1-((-(q`1/|.q.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
        then sqrt(1-((-(q`1/|.q.|-cn))/(1-cn))^2)>=0 by SQUARE_1:def 4;
        then sqrt(1-(-(q`1/|.q.|-cn))^2/(1-cn)^2)>=0 by XCMPLX_1:77;
        then sqrt(1-(q`1/|.q.|-cn)^2/(1-cn)^2)>=0;
        then sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)>=0 by XCMPLX_1:77;
        then p`2=0 by A5,A33,A34,A35,EUCLID:56;
        then
A44:    -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)=-0 by A36,A39,XCMPLX_1:6;
        1-(-((q`1/|.q.|-cn))/(1-cn))^2>=0 by A43,XCMPLX_1:188;
        then 1-((q`1/|.q.|-cn)/(1-cn))^2=0 by A44,SQUARE_1:92;
        then 1= (q`1/|.q.|-cn)/(1-cn) by A38,A37,SQUARE_1:83,89;
        then 1 *(1-cn)=(q`1/|.q.|-cn) by A38,XCMPLX_1:88;
        then 1 *|.q.|=q`1 by A30,TOPRNS_1:25,XCMPLX_1:88;
        then q`2=0 by A42,XCMPLX_1:6;
        hence thesis by A5,A35,Th120;
      end;
      suppose
A45:    p<>0.TOP-REAL 2 & p`1/|.p.|>=cn & p`2<=0;
        0<=(q`2)^2 by XREAL_1:65;
        then (|.q.|)^2 =(q`1)^2+(q`2)^2 & 0+(q`1)^2<=(q`1)^2+(q`2)^2 by
        JGRAPH_3:10 ,XREAL_1:9;
        then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by XREAL_1:74;
        then (q`1)^2/(|.q.|)^2 <= 1 by A31,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then 1>=q`1/|.q.| by SQUARE_1:121;
        then 1-cn>=q`1/|.q.|-cn by XREAL_1:11;
        then -(1-cn)<= -( q`1/|.q.|-cn) by XREAL_1:26;
        then (-(1-cn))/(1-cn)<=(-( q`1/|.q.|-cn))/(1-cn) by A6,XREAL_1:
        74;
        then
A46:    -1<=(-( q`1/|.q.|-cn))/(1-cn) by A6,XCMPLX_1:198;
        (q`1/|.q.|-cn)>= 0 by A30,XREAL_1:50;
        then ((-(q`1/|.q.|-cn))/(1-cn))^2<=1^2 by A6,A46,SQUARE_1:119;
        then 1-((-(q`1/|.q.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
        then
A47:    1-(-((q`1/|.q.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
        q4`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)) by EUCLID:56;
        then
A48:    (q4`2)^2= (|.q.|)^2*(sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))^2
          .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1-cn))^2) by A47,SQUARE_1:def 4;
A49:    q4`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by EUCLID:56;
        (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
          .=(|.q.|)^2 by A49,A48;
        then
A50:    sqrt((|.q4.|)^2)=|.q.| by SQUARE_1:89;
        then
A51:    |.q4.|=|.q.| by SQUARE_1:89;
        0<=(p`2)^2 by XREAL_1:65;
        then (|.p.|)^2 =(p`1)^2+(p`2)^2 & 0+(p`1)^2<=(p`1)^2+(p`2)^2 by
        JGRAPH_3:10 ,XREAL_1:9;
        then
A52:    (p`1)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by XREAL_1:74;
        |.p.|<>0 by A45,TOPRNS_1:25;
        then (|.p.|)^2>0 by SQUARE_1:74;
        then (p`1)^2/(|.p.|)^2 <= 1 by A52,XCMPLX_1:60;
        then ((p`1)/|.p.|)^2 <= 1 by XCMPLX_1:77;
        then 1>=p`1/|.p.| by SQUARE_1:121;
        then 1-cn>=p`1/|.p.|-cn by XREAL_1:11;
        then -(1-cn)<= -( p`1/|.p.|-cn) by XREAL_1:26;
        then (-(1-cn))/(1-cn)<=(-( p`1/|.p.|-cn))/(1-cn) by A6,XREAL_1:
        74;
        then
A53:    -1<=(-( p`1/|.p.|-cn))/(1-cn) by A6,XCMPLX_1:198;
        (p`1/|.p.|-cn)>= 0 by A45,XREAL_1:50;
        then ((-(p`1/|.p.|-cn))/(1-cn))^2<=1^2 by A6,A53,SQUARE_1:119;
        then 1-((-(p`1/|.p.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
        then
A54:    1-(-((p`1/|.p.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
        set p4= |[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)), |.p.|*( -sqrt(1-((p`1/|.p.|
        -cn)/(1-cn))^2))]|;
A55:    p4`1= |.p.|* ((p`1/|.p.|-cn)/(1-cn)) by EUCLID:56;
        p4`2= |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)) by EUCLID:56;
        then
A56:    (p4`2)^2= (|.p.|)^2*(sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))^2
          .= (|.p.|)^2*(1-((p`1/|.p.|-cn)/(1-cn))^2) by A54,SQUARE_1:def 4;
        (|.p4.|)^2=(p4`1)^2+(p4`2)^2 by JGRAPH_3:10
          .=(|.p.|)^2 by A55,A56;
        then
A57:    sqrt((|.p4.|)^2)=|.p.| by SQUARE_1:89;
        then
A58:    |.p4.|=|.p.| by SQUARE_1:89;
A59:    cn-FanMorphS.p= |[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)), |.p.|*( -sqrt
        (1-((p`1/|.p.|-cn)/(1-cn))^2))]| by A1,A2,A45,Th122;
        then ((p`1/|.p.|-cn)/(1-cn)) =|.q.|* ((q`1/|.q.|-cn)/(1-cn))/|.p.| by
        A5,A33,A32,A45,A55, TOPRNS_1:25,XCMPLX_1:90;
        then (p`1/|.p.|-cn)/(1-cn)=(q`1/|.q.|-cn)/(1-cn) by A5,A33,A45,A59,
        A50,A57,TOPRNS_1:25,XCMPLX_1:90;
        then (p`1/|.p.|-cn)/(1-cn)*(1-cn)=q`1/|.q.|-cn by A6,XCMPLX_1:88;
        then p`1/|.p.|-cn=q`1/|.q.|-cn by A6,XCMPLX_1:88;
        then p`1/|.p.|*|.p.|=q`1 by A5,A33,A45,A59,A51,A58, TOPRNS_1
        :25,XCMPLX_1:88;
        then
A60:    p`1=q`1 by A45,TOPRNS_1:25,XCMPLX_1:88;
        |.p.|^2=(p`1)^2+(p`2)^2 & |.q.|^2=(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        then (-p`2)^2=(q`2)^2 by A5,A33,A59,A51,A58,A60;
        then -p`2=sqrt((-q`2)^2) by A45,SQUARE_1:89;
        then
A61:    --p`2=--q`2 by A30,SQUARE_1:89;
        p=|[p`1,p`2]| by EUCLID:57;
        hence thesis by A60,A61,EUCLID:57;
      end;
      suppose
A62:    p<>0.TOP-REAL 2 & p`1/|.p.|<cn & p`2<=0;
        then p`1/|.p.|-cn<0 by XREAL_1:51;
        then
A63:    ((p`1/|.p.|-cn)/(1+cn))<0 by A1,XREAL_1:143,150;
        set p4= |[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)), |.p.|*( -sqrt(1-((p`1/|.p.|
        -cn)/(1+cn))^2))]|;
A64:    p4`1= |.p.|* ((p`1/|.p.|-cn)/(1+cn)) & q`1/|.q.|-cn>=0 by A30,
        EUCLID:56 ,XREAL_1:50;
A65:    1-cn>0 by A2,XREAL_1:151;
        cn-FanMorphS.p= |[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)), |.p.|*( -sqrt
(1-((p`1/|.p .|-cn)/(1+cn))^2))]| & |.p.|<>0 by A1,A2,A62,Th122,TOPRNS_1:25;
        hence thesis by A5,A33,A32,A63,A64,A65,XREAL_1:134;
      end;
    end;
    suppose
A66:  q`1/|.q.|<cn & q`2<=0 & q<>0.TOP-REAL 2;
      then
A67:  |.q.|<>0 by TOPRNS_1:25;
      then
A68:  (|.q.|)^2>0 by SQUARE_1:74;
      set q4= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)), |.q.|*( -sqrt(1-((q`1/|.q.|-
      cn)/(1+cn))^2))]|;
A69:  q4`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by EUCLID:56;
A70:  cn-FanMorphS.q= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)), |.q.|*( -sqrt(1
      -((q`1/|.q.|-cn)/(1+cn))^2))]| by A1,A2,A66,Th122;
      per cases by JGRAPH_2:11;
      suppose
A71:    p`2>=0;
        then
A72:    (cn-FanMorphS).p=p by Th120;
        then
A73:    p`2=|.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)) by A5,A70,
        EUCLID:56;
A74:    (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
A75:    1+cn>0 by A1,XREAL_1:150;
        0<=(q`2)^2 by XREAL_1:65;
        then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A74,XREAL_1:74;
        then (q`1)^2/(|.q.|)^2 <= 1 by A68,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then (-((q`1)/|.q.|))^2 <= 1;
        then 1>= -q`1/|.q.| by SQUARE_1:121;
        then (1+cn)>= -q`1/|.q.|+cn by XREAL_1:9;
        then
A76:    (-(q`1/|.q.|-cn))/(1+cn)<=1 by A75,XREAL_1:187;
A77:    (q`1/|.q.|-cn)<=0 by A66,XREAL_1:49;
        then -1<=(-( q`1/|.q.|-cn))/(1+cn) by A75;
        then ((-(q`1/|.q.|-cn))/(1+cn))^2<=1^2 by A76,SQUARE_1:119;
        then
A78:    1-((-(q`1/|.q.|-cn))/(1+cn))^2>=0 by XREAL_1:50;
        then
A79:    1-(-((q`1/|.q.|-cn))/(1+cn))^2>=0 by XCMPLX_1:188;
        sqrt(1-((-(q`1/|.q.|-cn))/(1+cn))^2)>=0 by A78,SQUARE_1:def 4;
        then sqrt(1-(-(q`1/|.q.|-cn))^2/(1+cn)^2)>=0 by XCMPLX_1:77;
        then sqrt(1-((q`1/|.q.|-cn))^2/(1+cn)^2)>=0;
        then sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)>=0 by XCMPLX_1:77;
        then p`2=0 by A5,A70,A71,A72,EUCLID:56;
        then -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)=-0 by A67,A73,
        XCMPLX_1:6;
        then 1-((q`1/|.q.|-cn)/(1+cn))^2=0 by A79,SQUARE_1:92;
        then 1=(-((q`1/|.q.|-cn)/(1+cn)))^2;
        then 1= -((q`1/|.q.|-cn)/(1+cn)) by A75,A77,SQUARE_1:83,89;
        then 1= ((-(q`1/|.q.|-cn))/(1+cn)) by XCMPLX_1:188;
        then 1 *(1+cn)=-(q`1/|.q.|-cn) by A75,XCMPLX_1:88;
        then 1+cn-cn=-q`1/|.q.|;
        then 1=(-q`1)/|.q.| by XCMPLX_1:188;
        then 1 *|.q.|=-q`1 by A66,TOPRNS_1:25,XCMPLX_1:88;
        then (q`1)^2-(q`1)^2 =(q`2)^2 by A74,XCMPLX_1:26;
        then q`2=0 by XCMPLX_1:6;
        hence thesis by A5,A72,Th120;
      end;
      suppose
A80:    p<>0.TOP-REAL 2 & p`1/|.p.|>=cn & p`2<=0;
        set p4= |[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)), |.p.|*( -sqrt(1-((p`1/|.p.|
        -cn)/(1-cn))^2))]|;
A81:    p4`1= |.p.|* ((p`1/|.p.|-cn)/(1-cn)) & |.q.|<>0 by A66,EUCLID:
        56 ,TOPRNS_1:25;
        q`1/|.q.|-cn<0 by A66,XREAL_1:51;
        then
A82:    ((q`1/|.q.|-cn)/(1+cn))<0 by A1,XREAL_1:143,150;
A83:    1-cn>0 by A2,XREAL_1:151;
        cn-FanMorphS.p= |[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)), |.p.|*( -sqrt
(1-((p`1/|.p .|-cn)/(1-cn))^2))]| & p`1/|.p.|-cn>=0 by A1,A2,A80,Th122,XREAL_1
        :50;
        hence thesis by A5,A70,A69,A82,A81,A83,XREAL_1:134;
      end;
      suppose
A84:    p<>0.TOP-REAL 2 & p`1/|.p.|<cn & p`2<=0;
        0<=(p`2)^2 by XREAL_1:65;
        then (|.p.|)^2 =(p`1)^2+(p`2)^2 & 0+(p`1)^2<=(p`1)^2+(p`2)^2 by
        JGRAPH_3:10 ,XREAL_1:9;
        then
A85:    (p`1)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by XREAL_1:74;
A86:    1+cn>0 by A1,XREAL_1:150;
        0<=(q`2)^2 by XREAL_1:65;
        then (|.q.|)^2 =(q`1)^2+(q`2)^2 & 0+(q`1)^2<=(q`1)^2+(q`2)^2 by
        JGRAPH_3:10 ,XREAL_1:9;
        then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by XREAL_1:74;
        then (q`1)^2/(|.q.|)^2 <= 1 by A68,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then -1<=q`1/|.q.| by SQUARE_1:121;
        then -1-cn<=q`1/|.q.|-cn by XREAL_1:11;
        then -(-1-cn)>= -(q`1/|.q.|-cn) by XREAL_1:26;
        then
A87:    (-(q`1/|.q.|-cn))/(1+cn)<=1 by A86,XREAL_1:187;
        (q`1/|.q.|-cn)<=0 by A66,XREAL_1:49;
        then -1<=(-( q`1/|.q.|-cn))/(1+cn) by A86;
        then ((-(q`1/|.q.|-cn))/(1+cn))^2<=1^2 by A87,SQUARE_1:119;
        then 1-((-(q`1/|.q.|-cn))/(1+cn))^2>=0 by XREAL_1:50;
        then
A88:    1-(-((q`1/|.q.|-cn))/(1+cn))^2>=0 by XCMPLX_1:188;
        q4`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)) by EUCLID:56;
        then
A89:    (q4`2)^2= (|.q.|)^2*(sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))^2
          .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1+cn))^2) by A88,SQUARE_1:def 4;
A90:    q4`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by EUCLID:56;
        set p4= |[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)), |.p.|*( -sqrt(1-((p`1/|.p.|
        -cn)/(1+cn))^2))]|;
A91:    p4`1= |.p.|* ((p`1/|.p.|-cn)/(1+cn)) by EUCLID:56;
        |.p.|<>0 by A84,TOPRNS_1:25;
        then (|.p.|)^2>0 by SQUARE_1:74;
        then (p`1)^2/(|.p.|)^2 <= 1 by A85,XCMPLX_1:60;
        then ((p`1)/|.p.|)^2 <= 1 by XCMPLX_1:77;
        then -1<=p`1/|.p.| by SQUARE_1:121;
        then -1-cn<=p`1/|.p.|-cn by XREAL_1:11;
        then -(-1-cn)>= -(p`1/|.p.|-cn) by XREAL_1:26;
        then
A92:    (-(p`1/|.p.|-cn))/(1+cn)<=1 by A86,XREAL_1:187;
        (p`1/|.p.|-cn)<=0 by A84,XREAL_1:49;
        then -1<=(-( p`1/|.p.|-cn))/(1+cn) by A86;
        then ((-(p`1/|.p.|-cn))/(1+cn))^2<=1^2 by A92,SQUARE_1:119;
        then 1-((-(p`1/|.p.|-cn))/(1+cn))^2>=0 by XREAL_1:50;
        then
A93:    1-(-((p`1/|.p.|-cn))/(1+cn))^2>=0 by XCMPLX_1:188;
        p4`2= |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)) by EUCLID:56;
        then
A94:    (p4`2)^2= (|.p.|)^2*(sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))^2
          .= (|.p.|)^2*(1-((p`1/|.p.|-cn)/(1+cn))^2) by A93,SQUARE_1:def 4;
        (|.p4.|)^2=(p4`1)^2+(p4`2)^2 by JGRAPH_3:10
          .=(|.p.|)^2 by A91,A94;
        then
A95:    sqrt((|.p4.|)^2)=|.p.| by SQUARE_1:89;
        then
A96:    |.p4.|=|.p.| by SQUARE_1:89;
        (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
          .=(|.q.|)^2 by A90,A89;
        then
A97:    sqrt((|.q4.|)^2)=|.q.| by SQUARE_1:89;
        then
A98:    |.q4.|=|.q.| by SQUARE_1:89;
A99:    cn-FanMorphS.p= |[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)), |.p.|*( -sqrt
        (1-((p`1/|.p.|-cn)/(1+cn))^2))]| by A1,A2,A84,Th122;
        then ((p`1/|.p.|-cn)/(1+cn)) =|.q.|* ((q`1/|.q.|-cn)/(1+cn))/|.p.| by
        A5,A70,A69,A84,A91, TOPRNS_1:25,XCMPLX_1:90;
        then (p`1/|.p.|-cn)/(1+cn)=(q`1/|.q.|-cn)/(1+cn) by A5,A70,A84,A99
        ,A97,A95,TOPRNS_1:25,XCMPLX_1:90;
        then (p`1/|.p.|-cn)/(1+cn)*(1+cn)=q`1/|.q.|-cn by A86, XCMPLX_1
        :88;
        then p`1/|.p.|-cn=q`1/|.q.|-cn by A86,XCMPLX_1:88;
        then p`1/|.p.|*|.p.|=q`1 by A5,A70,A84,A99,A98,A96,
        TOPRNS_1:25,XCMPLX_1:88;
        then
A100:   p`1=q`1 by A84,TOPRNS_1:25,XCMPLX_1:88;
        |.p.|^2=(p`1)^2+(p`2)^2 & |.q.|^2=(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        then (-p`2)^2=(q`2)^2 by A5,A70,A99,A98,A96,A100;
        then -p`2=sqrt((-q`2)^2) by A84,SQUARE_1:89;
        then
A101:   --p`2=--q`2 by A66,SQUARE_1:89;
        p=|[p`1,p`2]| by EUCLID:57;
        hence thesis by A100,A101,EUCLID:57;
      end;
    end;
  end;
  hence thesis by FUNCT_1:def 8;
end;

theorem Th141:
  for cn being Real st -1<cn & cn<1 holds (cn-FanMorphS) is
  Function of TOP-REAL 2,TOP-REAL 2 & rng (cn-FanMorphS) = the carrier of
  TOP-REAL 2
proof
  let cn be Real;
  assume that
A1: -1<cn and
A2: cn<1;
  thus (cn-FanMorphS) is Function of TOP-REAL 2,TOP-REAL 2;
  for f being Function of TOP-REAL 2,TOP-REAL 2 st f=cn-FanMorphS holds
  rng (cn-FanMorphS)=the carrier of TOP-REAL 2
  proof
    let f be Function of TOP-REAL 2,TOP-REAL 2;
    assume
A3: f=(cn-FanMorphS);
A4: dom f=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
    the carrier of TOP-REAL 2 c= rng f
    proof
      let y be set;
      assume
      y in the carrier of TOP-REAL 2;
      then reconsider p2=y as Point of TOP-REAL 2;
      set q=p2;
      now
        per cases by JGRAPH_2:11;
        case
          q`2>=0;
          then y=(cn-FanMorphS).q by Th120;
          hence ex x being set st x in dom (cn-FanMorphS) & y=(cn-FanMorphS).x
          by A3,A4;
        end;
        case
A5:       q`1/|.q.|>=0 & q`2<=0 & q<>0.TOP-REAL 2;
          --(1+cn)>0 by A1,XREAL_1:150;
          then
A6:       -(-1-cn)>0;
A7:       1-cn>=0 by A2,XREAL_1:151;
          then q`1/|.q.|*(1-cn)>=0 by A5;
          then -1-cn<= q`1/|.q.|*(1-cn) by A6;
          then
A8:       -1-cn+cn<= q`1/|.q.|*(1-cn)+cn by XREAL_1:9;
          set px=|[ |.q.|*(q`1/|.q.|*(1-cn)+cn), -((|.q.|)*sqrt(1-(q`1/|.q.|*(
          1-cn)+cn)^2))]|;
A9:       px`1 = |.q.|*(q`1/|.q.|*(1-cn)+cn) by EUCLID:56;
          |.q.|<>0 by A5,TOPRNS_1:25;
          then
A10:      |.q.|^2>0 by SQUARE_1:74;
A11:      dom (cn-FanMorphS)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
A12:      1-cn>0 by A2,XREAL_1:151;
          0<=(q`2)^2 by XREAL_1:65;
          then (|.q.|)^2 =(q`1)^2+(q`2)^2 & 0+(q`1)^2<=(q`1)^2+(q`2)^2 by
          JGRAPH_3:10 ,XREAL_1:9;
          then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by XREAL_1:74;
          then (q`1)^2/(|.q.|)^2 <= 1 by A10,XCMPLX_1:60;
          then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
          then q`1/|.q.|<=1 by SQUARE_1:121;
          then q`1/|.q.|*(1-cn) <=1 *(1-cn) by A12,XREAL_1:66;
          then q`1/|.q.|*(1-cn)+cn-cn <=1-cn;
          then (q`1/|.q.|*(1-cn)+cn) <=1 by XREAL_1:11;
          then 1^2>=(q`1/|.q.|*(1-cn)+cn)^2 by A8,SQUARE_1:119;
          then
A13:      1-(q`1/|.q.|*(1-cn)+cn)^2>=0 by XREAL_1:50;
          then
A14:      sqrt(1-(q`1/|.q.|*(1-cn)+cn)^2)>=0 by SQUARE_1:def 4;
A15:      px`2 = -(|.q.|)*sqrt(1-(q`1/|.q.|*(1-cn)+cn)^2) by EUCLID:56;
          then
          |.px.|^2=((- |.q.|)*sqrt(1-(q`1/|.q.|*(1-cn)+cn)^2))^2 +(|.q.|*
          (q`1/|.q.|*(1-cn)+cn))^2 by A9,JGRAPH_3:10
            .=(|.q.|)^2*(sqrt(1-(q`1/|.q.|*(1-cn)+cn)^2))^2 +(|.q.|)^2*((q`1
          /|.q.|*(1-cn)+cn))^2;
          then
A16:      |.px.|^2=(|.q.|)^2*(1-(q`1/|.q.|*(1-cn)+cn)^2) +(|.q.|)^2*((q`1
          /|.q.|*(1-cn)+cn))^2 by A13,SQUARE_1:def 4
            .= (|.q.|)^2;
          then
A17:      |.px.|=sqrt(|.q.|^2) by SQUARE_1:89
            .=|.q.| by SQUARE_1:89;
          then
A18:      px<>0.TOP-REAL 2 by A5,TOPRNS_1:24,25;
          (q`1/|.q.|*(1-cn)+cn)>=0+cn by A5,A7,XREAL_1:9;
          then px`1/|.px.| >=cn by A5,A9,A17,TOPRNS_1:25,XCMPLX_1:90;
          then
A19:      (cn-FanMorphS).px =|[ |.px.|* ((px`1/|.px.|-cn)/(1-cn) ), |.px
.|*( -sqrt(1-((px`1/|.px.|-cn)/(1-cn))^2))]| by A1,A2,A15,A14,A18,Th122;
          |.px.|*( sqrt((-(q`2/|.q.|))^2))=|.q.|*(-(q`2/|.q.|)) by A5,
          A17,SQUARE_1:89
            .= (-q`2)/|.q.|*|.q.| by XCMPLX_1:188
            .=-q`2 by A5,TOPRNS_1:25,XCMPLX_1:88;
          then
A20:      |.px.|*(- sqrt((-(q`2/|.q.|))^2))=q`2;
A21:      |.px.|* ((px`1/|.px.|-cn)/(1-cn)) =|.q.|* (( ((q`1/|.q.|*(1-cn)
          +cn))-cn)/(1-cn)) by A5,A9,A17,TOPRNS_1:25 ,XCMPLX_1:90
            .=|.q.|* ( q`1/|.q.|) by A12,XCMPLX_1:90
            .= q`1 by A5,TOPRNS_1:25,XCMPLX_1:88;
          then
          |.px.|*( -sqrt(1-((px`1/|.px.|-cn)/(1-cn))^2)) = |.px.|*( -sqrt
          (1-(q`1/|.px.|)^2)) by A5,A17,TOPRNS_1:25 ,XCMPLX_1:90
            .= |.px.|*( -sqrt(1-(q`1)^2/(|.px.|)^2)) by XCMPLX_1:77
            .= |.px.|*( -sqrt( (|.px.|)^2/(|.px.|)^2-(q`1)^2/(|.px.|)^2)) by
          A10,A16,XCMPLX_1:60
            .= |.px.|*( -sqrt( ((|.px.|)^2-(q`1)^2)/(|.px.|)^2)) by XCMPLX_1
          :121
            .= |.px.|*( -sqrt( ((q`1)^2+(q`2)^2-(q`1)^2)/(|.px.|)^2)) by A16
          ,JGRAPH_3:10
            .= |.px.|*( -sqrt((q`2/|.q.|)^2)) by A17,XCMPLX_1:77;
          hence ex x being set st x in dom (cn-FanMorphS) & y=(cn-FanMorphS).x
          by A19,A21,A20,A11,EUCLID:57;
        end;
        case
A22:      q`1/|.q.|<0 & q`2<=0 & q<>0.TOP-REAL 2;
A23:      1+cn>=0 by A1,XREAL_1:150;
          1-cn>0 by A2,XREAL_1:151;
          then
A24:      1-cn+cn>= q`1/|.q.|*(1+cn)+cn by A22,A23,XREAL_1:9;
A25:      1+cn>0 by A1,XREAL_1:150;
          |.q.|<>0 by A22,TOPRNS_1:25;
          then
A26:      |.q.|^2>0 by SQUARE_1:74;
          0<=(q`2)^2 by XREAL_1:65;
          then (|.q.|)^2 =(q`1)^2+(q`2)^2 & 0+(q`1)^2<=(q`1)^2+(q`2)^2 by
          JGRAPH_3:10 ,XREAL_1:9;
          then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by XREAL_1:74;
          then (q`1)^2/(|.q.|)^2 <= 1 by A26,XCMPLX_1:60;
          then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
          then q`1/|.q.|>=-1 by SQUARE_1:121;
          then q`1/|.q.|*(1+cn) >=(-1)*(1+cn) by A25,XREAL_1:66;
          then q`1/|.q.|*(1+cn)+cn-cn >=-1-cn;
          then (q`1/|.q.|*(1+cn)+cn) >=-1 by XREAL_1:11;
          then 1^2>=(q`1/|.q.|*(1+cn)+cn)^2 by A24,SQUARE_1:119;
          then
A27:      1-(q`1/|.q.|*(1+cn)+cn)^2>=0 by XREAL_1:50;
          then
A28:      sqrt(1-(q`1/|.q.|*(1+cn)+cn)^2)>=0 by SQUARE_1:def 4;
A29:      dom (cn-FanMorphS)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
          set px=|[ |.q.|*(q`1/|.q.|*(1+cn)+cn), -(|.q.|)*(sqrt(1-(q`1/|.q.|*(
          1+cn)+cn)^2))]|;
A30:      px`1 = |.q.|*(q`1/|.q.|*(1+cn)+cn) by EUCLID:56;
A31:      px`2 = -(|.q.|)*sqrt(1-(q`1/|.q.|*(1+cn)+cn)^2) by EUCLID:56;
          then
          |.px.|^2=(-(|.q.|)*sqrt(1-(q`1/|.q.|*(1+cn)+cn)^2))^2 +(|.q.|*(
          q`1/|.q.|*(1+cn)+cn))^2 by A30,JGRAPH_3:10
            .=(|.q.|)^2*(sqrt(1-(q`1/|.q.|*(1+cn)+cn)^2))^2 +(|.q.|)^2*((q`1
          /|.q.|*(1+cn)+cn))^2;
          then
A32:      |.px.|^2=(|.q.|)^2*(1-(q`1/|.q.|*(1+cn)+cn)^2) +(|.q.|)^2*((q`1
          /|.q.|*(1+cn)+cn))^2 by A27,SQUARE_1:def 4
            .= (|.q.|)^2;
          then
A33:      |.px.|=sqrt(|.q.|^2) by SQUARE_1:89
            .=|.q.| by SQUARE_1:89;
          then
A34:      px<>0.TOP-REAL 2 by A22,TOPRNS_1:24,25;
          (q`1/|.q.|*(1+cn)+cn)<=0+cn by A22,A23,XREAL_1:9;
          then px`1/|.px.| <=cn by A22,A30,A33,TOPRNS_1:25,XCMPLX_1:90;
          then
A35:      (cn-FanMorphS).px =|[ |.px.|* ((px`1/|.px.|-cn)/(1+cn) ), |.px
.|*( -sqrt(1-((px`1/|.px.|-cn)/(1+cn))^2))]| by A1,A2,A31,A28,A34,Th122;
A36:      |.px.|*( -sqrt((q`2/|.q.|)^2)) = |.px.|*( -sqrt((-q`2/|.q.|)^2)
          )
            .=|.px.|*(--(q`2/|.q.|)) by A22,SQUARE_1:89
            .=q`2 by A22,A33,TOPRNS_1:25,XCMPLX_1:88;
A37:      |.px.|* ((px`1/|.px.|-cn)/(1+cn)) =|.q.|* (( ((q`1/|.q.|*(1+cn)
          +cn))-cn)/(1+cn)) by A22,A30,A33,TOPRNS_1:25 ,XCMPLX_1:90
            .=|.q.|* ( q`1/|.q.|) by A25,XCMPLX_1:90
            .= q`1 by A22,TOPRNS_1:25,XCMPLX_1:88;
          then
          |.px.|*( -sqrt(1-((px`1/|.px.|-cn)/(1+cn))^2)) = |.px.|*( -sqrt
          (1-(q`1/|.px.|)^2)) by A22,A33,TOPRNS_1:25 ,XCMPLX_1:90
            .= |.px.|*( -sqrt(1-(q`1)^2/(|.px.|)^2)) by XCMPLX_1:77
            .= |.px.|*( -sqrt( (|.px.|)^2/(|.px.|)^2-(q`1)^2/(|.px.|)^2)) by
          A26,A32,XCMPLX_1:60
            .= |.px.|*( -sqrt( ((|.px.|)^2-(q`1)^2)/(|.px.|)^2)) by XCMPLX_1
          :121
            .= |.px.|*( -sqrt( ((q`1)^2+(q`2)^2-(q`1)^2)/(|.px.|)^2)) by A32
          ,JGRAPH_3:10
            .= |.px.|*( -sqrt((q`2/|.q.|)^2)) by A33,XCMPLX_1:77;
          hence ex x being set st x in dom (cn-FanMorphS) & y=(cn-FanMorphS).x
          by A35,A37,A36,A29,EUCLID:57;
        end;
      end;
      hence thesis by A3,FUNCT_1:def 5;
    end;
    hence thesis by A3,XBOOLE_0:def 10;
  end;
  hence thesis;
end;

theorem Th142:
  for cn being Real,p2 being Point of TOP-REAL 2 st -1<cn & cn<1
ex K being non empty compact Subset of TOP-REAL 2 st K = (cn-FanMorphS).:K & ex
  V2 being Subset of TOP-REAL 2 st p2 in V2 & V2 is open & V2 c= K & (cn
  -FanMorphS).p2 in V2
proof
  reconsider O=0.TOP-REAL 2 as Point of Euclid 2 by EUCLID:71;
  let cn be Real,p2 be Point of TOP-REAL 2;
A1: the TopStruct of TOP-REAL 2 = TopSpaceMetr Euclid 2 by EUCLID:def 8;
  the TopStruct of TOP-REAL 2 = TopSpaceMetr Euclid 2 by EUCLID:def 8;
  then reconsider V0=Ball(O,|.p2.|+1) as Subset of TOP-REAL 2;
  O in V0 & V0 c= cl_Ball(O,|.p2.|+1) by GOBOARD6:4,METRIC_1:15;
  then reconsider
  K0=cl_Ball(O,|.p2.|+1) as non empty compact Subset of TOP-REAL 2
  by A1,Th22;
  set q3= (cn-FanMorphS).p2;
  reconsider VV0 = V0 as Subset of TopSpaceMetr Euclid 2;
  reconsider u2=p2 as Point of Euclid 2 by EUCLID:71;
  reconsider u3=q3 as Point of Euclid 2 by EUCLID:71;
A2: (cn-FanMorphS).:K0 c= K0
  proof
    let y be set;
    assume
    y in (cn-FanMorphS).:K0;
    then consider x being set such that
A3: x in dom (cn-FanMorphS) and
A4: x in K0 and
A5: y=(cn-FanMorphS).x by FUNCT_1:def 12;
    reconsider q=x as Point of TOP-REAL 2 by A3;
    reconsider uq=q as Point of Euclid 2 by EUCLID:71;
    dist(O,uq)<= |.p2.|+1 by A4,METRIC_1:13;
    then |.0.TOP-REAL 2 - q.|<= |.p2.|+1 by JGRAPH_1:45;
    then |. -q.|<= |.p2.|+1 by EUCLID:31;
    then
A6: |.q.|<= |.p2.|+1 by TOPRNS_1:27;
A7: y in rng (cn-FanMorphS) by A3,A5,FUNCT_1:def 5;
    then reconsider u=y as Point of Euclid 2 by EUCLID:71;
    reconsider q4=y as Point of TOP-REAL 2 by A7;
    |.q4.|=|.q.| by A5,Th135;
    then |. -q4.|<= |.p2.|+1 by A6,TOPRNS_1:27;
    then |.0.TOP-REAL 2 - q4.|<= |.p2.|+1 by EUCLID:31;
    then dist(O,u)<= |.p2.|+1 by JGRAPH_1:45;
    hence thesis by METRIC_1:13;
  end;
  VV0 is open by TOPMETR:21;
  then
A8: V0 is open by Lm11,PRE_TOPC:60;
A9: |. p2.|<|.p2.|+1 by XREAL_1:31;
  then |. -p2.|<|.p2.|+1 by TOPRNS_1:27;
  then |.0.TOP-REAL 2 - p2.|<|.p2.|+1 by EUCLID:31;
  then dist(O,u2)<|.p2.|+1 by JGRAPH_1:45;
  then
A10: p2 in V0 by METRIC_1:12;
  |.q3.|=|.p2.| by Th135;
  then |.-q3.|<|.p2.|+1 by A9,TOPRNS_1:27;
  then |.0.TOP-REAL 2 - q3.|<|.p2.|+1 by EUCLID:31;
  then dist(O,u3)< |.p2.|+1 by JGRAPH_1:45;
  then
A11: (cn-FanMorphS).p2 in V0 by METRIC_1:12;
  assume
A12: -1<cn & cn<1;
  K0 c= (cn-FanMorphS).:K0
  proof
    let y be set;
    assume
A13: y in K0;
    then reconsider q4=y as Point of TOP-REAL 2;
    reconsider y as Point of Euclid 2 by A13;
    the carrier of TOP-REAL 2 c= rng (cn-FanMorphS) by A12,Th141;
    then q4 in rng (cn-FanMorphS) by TARSKI:def 3;
    then consider x being set such that
A14: x in dom (cn-FanMorphS) and
A15: y=(cn-FanMorphS).x by FUNCT_1:def 5;
    reconsider x as Point of Euclid 2 by A14,Lm11;
    reconsider q=x as Point of TOP-REAL 2 by A14;
    |.q4.|=|.q.| by A15,Th135;
    then q in K0 by A13,Lm12;
    hence thesis by A14,A15,FUNCT_1:def 12;
  end;
  then K0= (cn-FanMorphS).:K0 by A2,XBOOLE_0:def 10;
  hence thesis by A10,A8,A11,METRIC_1:15;
end;

theorem
  for cn being Real st -1<cn & cn<1 ex f being Function of TOP-REAL 2,
  TOP-REAL 2 st f=cn-FanMorphS & f is being_homeomorphism
proof
  let cn be Real;
  set f=cn-FanMorphS;
  assume
A1: -1<cn & cn<1;
  then
A2: for p2 being Point of TOP-REAL 2 ex K being non empty compact Subset of
  TOP-REAL 2 st K = f.:K & ex V2 being Subset of TOP-REAL 2 st p2 in V2 & V2 is
  open & V2 c= K & f.p2 in V2 by Th142;
  rng (cn-FanMorphS) = the carrier of TOP-REAL 2 & cn-FanMorphS is
  continuous by A1,Th139,Th141;
  then f is being_homeomorphism by A1,A2,Th8,Th140;
  hence thesis;
end;

theorem Th144:
  for cn being Real,q being Point of TOP-REAL 2 st cn<1 & q`2<0 &
q`1/|.q.|>=cn holds for p being Point of TOP-REAL 2 st p=(cn-FanMorphS).q holds
  p`2<0 & p`1>=0
proof
  let cn be Real,q be Point of TOP-REAL 2;
  assume that
A1: cn<1 and
A2: q`2<0 and
A3: q`1/|.q.|>=cn;
A4: 1-cn>0 by A1,XREAL_1:151;
  let p be Point of TOP-REAL 2;
  set qz=p;
  assume
  p=(cn-FanMorphS).q;
  then
A5: p=|[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)), |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-
  cn))^2))]| by A2,A3,Th120;
  then
A6: qz`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)) by EUCLID:56;
A7: (q`1/|.q.|-cn)>= 0 by A3,XREAL_1:50;
A8: |.q.|<>0 by A2,JGRAPH_2:11,TOPRNS_1:25;
  then
A9: (|.q.|)^2>0 by SQUARE_1:74;
  (|.q.|)^2 =(q`1)^2+(q`2)^2 & 0+(q`1)^2<(q`1)^2+(q`2)^2 by A2,JGRAPH_3:
  10 ,SQUARE_1:74,XREAL_1:10;
  then (q`1)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A9,XREAL_1:76;
  then (q`1)^2/(|.q.|)^2 < 1 by A9,XCMPLX_1:60;
  then ((q`1)/|.q.|)^2 < 1 by XCMPLX_1:77;
  then 1>q`1/|.q.| by SQUARE_1:122;
  then 1-cn>q`1/|.q.|-cn by XREAL_1:11;
  then -(1-cn)< -( q`1/|.q.|-cn) by XREAL_1:26;
  then (-(1-cn))/(1-cn)<(-( q`1/|.q.|-cn))/(1-cn) by A4,XREAL_1:76;
  then -1<(-( q`1/|.q.|-cn))/(1-cn) by A4,XCMPLX_1:198;
  then ((-(q`1/|.q.|-cn))/(1-cn))^2<1^2 by A4,A7,SQUARE_1:120;
  hence thesis by A5,A8,A4,A6,A7,Lm13,EUCLID:56,XREAL_1:134;
end;

theorem Th145:
  for cn being Real,q being Point of TOP-REAL 2 st -1<cn & q`2<0
  & q`1/|.q.|<cn holds for p being Point of TOP-REAL 2 st p=(cn-FanMorphS).q
  holds p`2<0 & p`1<0
proof
  let cn be Real,q be Point of TOP-REAL 2;
  assume that
A1: -1<cn and
A2: q`2<0 and
A3: q`1/|.q.|<cn;
A4: 1+cn>0 by A1,XREAL_1:150;
A5: (q`1/|.q.|-cn)< 0 by A3,XREAL_1:51;
  then -( q`1/|.q.|-cn)>0 by XREAL_1:60;
  then (-(1+cn))/(1+cn)<(-( q`1/|.q.|-cn))/(1+cn) by A4,XREAL_1:76;
  then
A6: -1<(-( q`1/|.q.|-cn))/(1+cn) by A4,XCMPLX_1:198;
A7: |.q.|<>0 by A2,JGRAPH_2:11,TOPRNS_1:25;
  then
A8: (|.q.|)^2>0 by SQUARE_1:74;
  (|.q.|)^2 =(q`1)^2+(q`2)^2 & 0+(q`1)^2<(q`1)^2+(q`2)^2 by A2,JGRAPH_3:
  10 ,SQUARE_1:74,XREAL_1:10;
  then (q`1)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A8,XREAL_1:76;
  then (q`1)^2/(|.q.|)^2 < 1 by A8,XCMPLX_1:60;
  then ((q`1)/|.q.|)^2 < 1 by XCMPLX_1:77;
  then -1<q`1/|.q.| by SQUARE_1:122;
  then -1-cn<q`1/|.q.|-cn by XREAL_1:11;
  then --(1+cn)> -(q`1/|.q.|-cn) by XREAL_1:26;
  then (-(q`1/|.q.|-cn))/(1+cn)<1 by A4,XREAL_1:193;
  then ((-(q`1/|.q.|-cn))/(1+cn))^2<1^2 by A6,SQUARE_1:120;
  then 1-((-(q`1/|.q.|-cn))/(1+cn))^2>0 by XREAL_1:52;
  then sqrt(1-((-(q`1/|.q.|-cn))/(1+cn))^2)>0 by SQUARE_1:93;
  then sqrt(1-(-(q`1/|.q.|-cn))^2/(1+cn)^2)> 0 by XCMPLX_1:77;
  then sqrt(1-(q`1/|.q.|-cn)^2/(1+cn)^2)> 0;
  then --sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)> 0 by XCMPLX_1:77;
  then
A9: -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)< 0;
  let p be Point of TOP-REAL 2;
  set qz=p;
  assume
  p=(cn-FanMorphS).q;
  then
  p=|[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)), |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+
  cn))^2))]| by A2,A3,Th121;
  then
A10: qz`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)) & qz`1= |.q.|* ((q`1/
  |.q.| -cn)/(1+cn)) by EUCLID:56;
  ((q`1/|.q.|-cn)/(1+cn))<0 by A1,A5,XREAL_1:143,150;
  hence thesis by A7,A10,A9,XREAL_1:134;
end;

theorem Th146:
  for cn being Real,q1,q2 being Point of TOP-REAL 2 st cn<1 & q1
  `2<0 & q1`1/|.q1.|>=cn & q2`2<0 & q2`1/|.q2.|>=cn & q1`1/|.q1.|<q2`1/|.q2.|
  holds for p1,p2 being Point of TOP-REAL 2 st p1=(cn-FanMorphS).q1 & p2=(cn
  -FanMorphS).q2 holds p1`1/|.p1.|<p2`1/|.p2.|
proof
  let cn be Real,q1,q2 be Point of TOP-REAL 2;
  assume that
A1: cn<1 and
A2: q1`2<0 and
A3: q1`1/|.q1.|>=cn and
A4: q2`2<0 and
A5: q2`1/|.q2.|>=cn and
A6: q1`1/|.q1.|<q2`1/|.q2.|;
A7: q1`1/|.q1.|-cn< q2`1/|.q2.|-cn & 1-cn>0 by A1,A6,XREAL_1:11,151;
  let p1,p2 be Point of TOP-REAL 2;
  assume that
A8: p1=(cn-FanMorphS).q1 and
A9: p2=(cn-FanMorphS).q2;
A10: |.p2.|=|.q2.| by A9,Th135;
  p2=|[ |.q2.|* ((q2`1/|.q2.|-cn)/(1-cn)), |.q2.|*( -sqrt(1-((q2`1/|.q2.|
  -cn)/(1-cn))^2))]| by A4,A5,A9,Th120;
  then
A11: p2`1= |.q2.|* ((q2`1/|.q2.|-cn)/(1-cn)) by EUCLID:56;
  |.q2.|>0 by A4,Lm1,JGRAPH_2:11;
  then
A12: p2`1/|.p2.|= ((q2`1/|.q2.|-cn)/(1-cn)) by A11,A10,XCMPLX_1:90;
  p1=|[ |.q1.|* ((q1`1/|.q1.|-cn)/(1-cn)), |.q1.|*( -sqrt(1-((q1`1/|.q1.|-
  cn)/(1-cn))^2))]| by A2,A3,A8,Th120;
  then
A13: p1`1= |.q1.|* ((q1`1/|.q1.|-cn)/(1-cn)) by EUCLID:56;
A14: |.p1.|=|.q1.| by A8,Th135;
  |.q1.|>0 by A2,Lm1,JGRAPH_2:11;
  then p1`1/|.p1.|= ((q1`1/|.q1.|-cn)/(1-cn)) by A13,A14,XCMPLX_1:90;
  hence thesis by A12,A7,XREAL_1:76;
end;

theorem Th147:
  for cn being Real,q1,q2 being Point of TOP-REAL 2 st -1<cn & q1
`2<0 & q1`1/|.q1.|<cn & q2`2<0 & q2`1/|.q2.|<cn & q1`1/|.q1.|<q2`1/|.q2.| holds
for p1,p2 being Point of TOP-REAL 2 st p1=(cn-FanMorphS).q1 & p2=(cn-FanMorphS)
  .q2 holds p1`1/|.p1.|<p2`1/|.p2.|
proof
  let cn be Real,q1,q2 be Point of TOP-REAL 2;
  assume that
A1: -1<cn and
A2: q1`2<0 and
A3: q1`1/|.q1.|<cn and
A4: q2`2<0 and
A5: q2`1/|.q2.|<cn and
A6: q1`1/|.q1.|<q2`1/|.q2.|;
A7: q1`1/|.q1.|-cn< q2`1/|.q2.|-cn & 1+cn>0 by A1,A6,XREAL_1:11,150;
  let p1,p2 be Point of TOP-REAL 2;
  assume that
A8: p1=(cn-FanMorphS).q1 and
A9: p2=(cn-FanMorphS).q2;
A10: |.p2.|=|.q2.| by A9,Th135;
  p2=|[ |.q2.|* ((q2`1/|.q2.|-cn)/(1+cn)), |.q2.|*( -sqrt(1-((q2`1/|.q2.|
  -cn)/(1+cn))^2))]| by A4,A5,A9,Th121;
  then
A11: p2`1= |.q2.|* ((q2`1/|.q2.|-cn)/(1+cn)) by EUCLID:56;
  |.q2.|>0 by A4,Lm1,JGRAPH_2:11;
  then
A12: p2`1/|.p2.|= (q2`1/|.q2.|-cn)/(1+cn) by A11,A10,XCMPLX_1:90;
  p1=|[ |.q1.|* ((q1`1/|.q1.|-cn)/(1+cn)), |.q1.|*( -sqrt(1-((q1`1/|.q1.|-
  cn)/(1+cn))^2))]| by A2,A3,A8,Th121;
  then
A13: p1`1= |.q1.|* ((q1`1/|.q1.|-cn)/(1+cn)) by EUCLID:56;
A14: |.p1.|=|.q1.| by A8,Th135;
  |.q1.|>0 by A2,Lm1,JGRAPH_2:11;
  then p1`1/|.p1.|= (q1`1/|.q1.|-cn)/(1+cn) by A13,A14,XCMPLX_1:90;
  hence thesis by A12,A7,XREAL_1:76;
end;

theorem
  for cn being Real,q1,q2 being Point of TOP-REAL 2 st -1<cn & cn<1 & q1
`2<0 & q2`2<0 & q1`1/|.q1.|<q2`1/|.q2.| holds for p1,p2 being Point of TOP-REAL
2 st p1=(cn-FanMorphS).q1 & p2=(cn-FanMorphS).q2 holds p1`1/|.p1.|<p2`1/|.p2.|
proof
  let cn be Real,q1,q2 be Point of TOP-REAL 2;
  assume that
A1: -1<cn and
A2: cn<1 and
A3: q1`2<0 and
A4: q2`2<0 and
A5: q1`1/|.q1.|<q2`1/|.q2.|;
  let p1,p2 be Point of TOP-REAL 2;
  assume that
A6: p1=(cn-FanMorphS).q1 and
A7: p2=(cn-FanMorphS).q2;
  per cases;
  suppose
    q1`1/|.q1.|>=cn & q2`1/|.q2.|>=cn;
    hence thesis by A2,A3,A4,A5,A6,A7,Th146;
  end;
  suppose
    q1`1/|.q1.|>=cn & q2`1/|.q2.|<cn;
    hence thesis by A5,XXREAL_0:2;
  end;
  suppose
A8: q1`1/|.q1.|<cn & q2`1/|.q2.|>=cn;
    then p2`1>=0 by A2,A4,A7,Th144;
    then
A9: p2`1/|.p2.|>=0;
    p1`1<0 by A1,A3,A6,A8,Th145;
    hence thesis by A9,Lm1,JGRAPH_2:11,XREAL_1:143;
  end;
  suppose
    q1`1/|.q1.|<cn & q2`1/|.q2.|<cn;
    hence thesis by A1,A3,A4,A5,A6,A7,Th147;
  end;
end;

theorem
  for cn being Real,q being Point of TOP-REAL 2 st q`2<0 & q`1/|.q.|=cn
holds for p being Point of TOP-REAL 2 st p=(cn-FanMorphS).q holds p`2<0 & p`1=0
proof
  let cn be Real,q be Point of TOP-REAL 2;
  assume that
A1: q`2<0 and
A2: q`1/|.q.|=cn;
  let p be Point of TOP-REAL 2;
A3: |.q.|<>0 by A1,JGRAPH_2:11,TOPRNS_1:25;
  assume
  p=(cn-FanMorphS).q;
  then
A4: p=|[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)), |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-
  cn))^2))]| by A1,A2,Th120;
  then p`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)) by EUCLID:56;
  hence thesis by A2,A4,A3,Lm13,EUCLID:56,XREAL_1:134;
end;

theorem
  0.TOP-REAL 2 = (a-FanMorphS).(0.TOP-REAL 2) by Th120,JGRAPH_2:11;

