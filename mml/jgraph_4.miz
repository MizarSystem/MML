:: Fan Homeomorphisms in the Plane
::  by Yatsuka Nakamura
::
:: Received January 8, 2002
:: Copyright (c) 2002 Association of Mizar Users

environ

 vocabularies FUNCT_1, BOOLE, ABSVALUE, EUCLID, PRE_TOPC, JORDAN2C, SQUARE_1,
      RELAT_1, SUBSET_1, ARYTM_3, METRIC_1, RCOMP_1, FUNCT_4, FUNCT_5, TOPMETR,
      COMPTS_1, JGRAPH_4, ORDINAL2, TOPS_2, ARYTM_1, CARD_3, COMPLEX1, MCART_1,
      PARTFUN1, LATTICES, ARYTM;
 notations TARSKI, XBOOLE_0, SUBSET_1, ORDINAL1, NUMBERS, XCMPLX_0, XREAL_0,
      REAL_1, COMPLEX1, RELAT_1, FUNCT_1, RELSET_1, FUNCT_2, DOMAIN_1,
      STRUCT_0, PARTFUN1, TOPMETR, EUCLID, COMPTS_1, TOPS_2, METRIC_1,
      SQUARE_1, TBSP_1, RCOMP_1, PSCOMP_1, PRE_TOPC, JORDAN2C, FUNCT_4,
      XXREAL_0;
 constructors FUNCT_4, REAL_1, SQUARE_1, BINOP_2, COMPLEX1, RCOMP_1, TOPS_2,
      COMPTS_1, TBSP_1, MONOID_0, TOPMETR, PSCOMP_1, JORDAN2C, SEQ_1;
 registrations XBOOLE_0, RELAT_1, NUMBERS, XXREAL_0, XREAL_0, SQUARE_1,
      MEMBERED, STRUCT_0, PRE_TOPC, METRIC_1, BORSUK_1, MONOID_0, EUCLID,
      TOPMETR, TOPREAL1, PSCOMP_1, JORDAN6, FUNCT_2, COMPTS_1;
 requirements REAL, NUMERALS, BOOLE, SUBSET, ARITHM;
 definitions TARSKI, SQUARE_1, EUCLID, STRUCT_0, PCOMPS_1;
 theorems TARSKI, RELAT_1, SUBSET_1, FUNCT_1, FUNCT_2, FUNCT_4, TOPS_1, TOPS_2,
      PARTFUN1, PRE_TOPC, FRECHET, TOPMETR, JORDAN6, EUCLID, JGRAPH_1,
      SQUARE_1, PSCOMP_1, METRIC_1, JGRAPH_2, GOBOARD6, GOBOARD9, TBSP_1,
      TOPREAL6, JGRAPH_3, ABSVALUE, JORDAN2C, TSEP_1, XREAL_0, XBOOLE_0,
      XBOOLE_1, TOPRNS_1, SEQ_2, XCMPLX_0, XCMPLX_1, COMPLEX1, XREAL_1,
      JORDAN2B, XXREAL_0, XXREAL_1;
 schemes FUNCT_2, DOMAIN_1, JGRAPH_2, BINOP_2, JGRAPH_3;

begin :: Preliminaries

reserve x,a for real number;
reserve p,q for Point of TOP-REAL 2;

Lm1: p <> 0.REAL 2 implies |.p.| > 0
proof
  assume p <> 0.REAL 2;
  then |.p.| <> 0 by TOPRNS_1:25;
  hence thesis;
end;

canceled 5;

theorem Th6:
  for X being non empty TopStruct,
  g being Function of X,R^1, B being Subset of X,
  a being real number st g is continuous &
  B = {p where p is Point of X: pi(g,p) > a } holds B is open
proof
  let X be non empty TopStruct,g be Function of X,R^1,B be Subset of X,
  a be real number;
A1: [#]R^1 <> {};
  assume
A2: g is continuous & B={p where p is Point of X:pi(g,p) > a };
  {r where r is Real: r>a} c= the carrier of R^1
  proof
    let x be set;
    assume x in {r where r is Real: r>a};
    then consider r being Real such that
A3: r=x & r>a;
    thus x in the carrier of R^1 by A3,TOPMETR:24;
  end;
  then reconsider D={r where r is Real: r>a} as Subset of R^1;
A4: D is open by JORDAN2B:31;
A5: B c= g"D
  proof
    let x be set;
    assume x in B;
    then consider p being Point of X such that
A6: p=x & pi(g,p) > a by A2;
A7: dom g=the carrier of X by FUNCT_2:def 1;
    pi(g,p) is Real by XREAL_0:def 1;
    then x in dom g & g.x in D by A6,A7;
    hence x in g"D by FUNCT_1:def 13;
  end;
  g"D c= B
  proof
    let x be set;
    assume
A8: x in g"D;
    then x in dom g & g.x in D by FUNCT_1:def 13;
    then consider r being Real such that
A9: r=g.x & r>a;
    reconsider p=x as Point of X by A8;
    pi(g,p)=g.p;
    hence x in B by A2,A9;
  end;
  then B=g"D by A5,XBOOLE_0:def 10;
  hence B is open by A1,A2,A4,TOPS_2:55;
end;

theorem Th7:
  for X being non empty TopStruct,
  g being Function of X,R^1,B being Subset of X,
  a being Real st g is continuous &
  B={p where p is Point of X: pi(g,p) < a } holds B is open
proof
  let X be non empty TopStruct,g be Function of X,R^1,
  B be Subset of X,a be Real;
  assume
A1: g is continuous & B={p where p is Point of X:pi(g,p) < a };
A2: [#]R^1 <> {};
  {r where r is Real: r<a} c= the carrier of R^1
  proof
    let x be set;
    assume x in {r where r is Real: r<a};
    then consider r being Real such that
A3: r=x & r<a;
    thus x in the carrier of R^1 by A3,TOPMETR:24;
  end;
  then reconsider D={r where r is Real: r<a} as Subset of R^1;
A4: D is open by JORDAN2B:30;
A5: B c= g"D
  proof
    let x be set;
    assume x in B;
    then consider p being Point of X such that
A6: p=x & pi(g,p) < a by A1;
A7: dom g=the carrier of X by FUNCT_2:def 1;
    pi(g,p) is Real by XREAL_0:def 1;
    then x in dom g & g.x in D by A6,A7;
    hence x in g"D by FUNCT_1:def 13;
  end;
  g"D c= B
  proof
    let x be set;
    assume
A8: x in g"D;
    then x in dom g & g.x in D by FUNCT_1:def 13;
    then consider r being Real such that
A9: r=g.x & r<a;
    reconsider p=x as Point of X by A8;
    pi(g,p)=g.p;
    hence x in B by A1,A9;
  end;
  then B=g"D by A5,XBOOLE_0:def 10;
  hence B is open by A1,A2,A4,TOPS_2:55;
end;

theorem Th8:
  for f being Function of TOP-REAL 2,TOP-REAL 2 st
  f is continuous one-to-one & rng f=[#](TOP-REAL 2) &
  (for p2 being Point of TOP-REAL 2
  ex K being non empty compact Subset of TOP-REAL 2 st K = f.:K &
  (ex V2 being Subset of TOP-REAL 2 st
  p2 in V2 & V2 is open & V2 c= K & f.p2 in V2)) holds f is being_homeomorphism
proof
  let f be Function of TOP-REAL 2,TOP-REAL 2;
  assume
A1: f is continuous one-to-one & rng f=[#](TOP-REAL 2)
  & (for p2 being Point of TOP-REAL 2
  ex K being non empty compact Subset of TOP-REAL 2 st K = f.:K &
  (ex V2 being Subset of TOP-REAL 2 st
  p2 in V2 & V2 is open & V2 c= K & f.p2 in V2));
A2: dom f=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
  reconsider g=(f qua Function)"
  as Function of TOP-REAL 2,TOP-REAL 2 by A1,FUNCT_2:31;
  for p being Point of TOP-REAL 2, V being Subset of
  TOP-REAL 2 st g.p in V & V is open ex W being Subset of TOP-REAL 2 st
  p in W & W is open & g.:W c= V
  proof
    let p be Point of TOP-REAL 2, V be Subset of TOP-REAL 2;
    assume
A3: g.p in V & V is open;
    consider K being non empty compact Subset of TOP-REAL 2 such that
A4: K = f.:K & (ex V2 being Subset of TOP-REAL 2 st
    g.p in V2 & V2 is open & V2 c= K & f.(g.p) in V2) by A1;
    consider V2 being Subset of TOP-REAL 2 such that
A5: g.p in V2 & V2 is open & V2 c= K & f.(g.p) in V2 by A4;
A6: g.p in V2 & V2 is open & V2 c= K & p in V2 by A1,A5,FUNCT_1:57;
A7: dom (f|K)=dom f /\ K by FUNCT_1:68
      .=(the carrier of TOP-REAL 2)/\ K by FUNCT_2:def 1
      .=K by XBOOLE_1:28
      .=the carrier of ((TOP-REAL 2)|K) by PRE_TOPC:29;
    rng (f|K) c= the carrier of TOP-REAL 2;
    then reconsider h=f|K as Function of (TOP-REAL 2)|K,TOP-REAL 2
    by A7,FUNCT_2:4;
A8: h is continuous by A1,TOPMETR:10;
A9: h is one-to-one by A1,FUNCT_1:84;
A10: dom (f|K)=dom f /\ K by RELAT_1:90
      .=K by A2,XBOOLE_1:28;
A11: K=(f|K).:K by A4,RELAT_1:162
      .=rng (f|K) by A10,RELAT_1:146;
    then consider f1 being Function of (TOP-REAL 2)|K,(TOP-REAL 2)|K such that
A12: h=f1 & f1 is being_homeomorphism by A8,A9,JGRAPH_1:64;
A13: rng f1=[#]((TOP-REAL 2)|K) by A12,TOPS_2:def 5;
    the carrier of ((TOP-REAL 2)|K)=K by PRE_TOPC:29;
    then reconsider R=V /\ V2 /\ K as Subset of (TOP-REAL 2)|K by XBOOLE_1:17;
A14: V /\ V2 is open by A3,A5,TOPS_1:38;
    R=V /\ V2 /\ [#]((TOP-REAL 2)|K) by PRE_TOPC:def 10;
    then
A15: R is open by A14,TOPS_2:32;
A16: g.p in V /\ V2 by A3,A5,XBOOLE_0:def 4;
A17: f1.((f1 qua Function)".p)=p by A6,A9,A11,A12,FUNCT_1:57;
A18: f1.(g.p)=f.(g.p) by A5,A12,FUNCT_1:72
      .=p by A1,FUNCT_1:57;
A19: dom f1=dom f /\ K by A12,FUNCT_1:68
      .=K by A2,XBOOLE_1:28;
A20: rng ((f1 qua Function)")=dom f1 by A9,A12,FUNCT_1:55;
    rng f1=dom ((f1 qua Function)") by A9,A12,FUNCT_1:55;
    then ((f1 qua Function)").p in rng ((f1 qua Function)")
    by A6,A11,A12,FUNCT_1:12;
    then
A21: ((f1 qua Function)").p=g.p by A4,A9,A12,A17,A18,A19,A20,FUNCT_1:def 8;
    reconsider q=p as Point of ((TOP-REAL 2)|K) by A6,PRE_TOPC:29;
A22: ((f1 qua Function)").p in R by A5,A16,A21,XBOOLE_0:def 4;
A23: dom ((f1 qua Function)")=rng f1 by A9,A12,FUNCT_1:54;
A24: rng ((f1 qua Function)")=dom f1 by A9,A12,FUNCT_1:55;
A25: dom f1=the carrier of (TOP-REAL 2)|K by FUNCT_2:def 1;
    reconsider g1=(f1 qua Function)" as Function
    of (TOP-REAL 2)|K,(TOP-REAL 2)|K by A13,A23,A24,FUNCT_2:4;
    g1=f1" by A9,A12,A13,TOPS_2:def 4;
    then g1 is continuous by A12,TOPS_2:def 5;
    then consider W3 being Subset of (TOP-REAL 2)|K such that
A26: q in W3 & W3 is open & ((f1 qua Function)").:W3 c= R
    by A15,A22,JGRAPH_2:20;
A27: ((f qua Function)").:W3 c= R
    proof
      let y be set;
      assume y in ((f qua Function)").:W3;
      then consider x being set such that
A28:  x in dom ((f qua Function)") & x in W3 & y=((f qua Function)").x
      by FUNCT_1:def 12;
      x in rng f by A1,A28,FUNCT_1:55;
      then
A29:  y in dom f & f.y=x by A1,A28,FUNCT_1:54;
A30:  dom ((f1 qua Function)")=the carrier of (TOP-REAL 2)|K by A9,A12,A13,
FUNCT_1:55;
      the carrier of (TOP-REAL 2)|K=K by PRE_TOPC:29;
      then consider z2 being set such that
A31:  z2 in dom f & z2 in K & f.y=f.z2 by A4,A28,A29,FUNCT_1:def 12;
A32:  y in K by A1,A29,A31,FUNCT_1:def 8;
      then
A33:  y in the carrier of ((TOP-REAL 2)|K) by PRE_TOPC:29;
      f1.y=x by A12,A29,A32,FUNCT_1:72;
      then x in dom ((f1 qua Function)") & y=((f1 qua Function)").x
      by A9,A12,A25,A28,A30,A33,FUNCT_1:54;
      then y in ((f1 qua Function)").:W3 by A28,FUNCT_1:def 12;
      hence y in R by A26;
    end;
    consider W5 being Subset of TOP-REAL 2 such that
A34: W5 is open & W3=W5 /\ [#]((TOP-REAL 2)|K) by A26,TOPS_2:32;
    reconsider W4=W5 /\ V2 as Subset of TOP-REAL 2;
    p in W5 by A26,A34,XBOOLE_0:def 4;
    then
A35: p in W4 by A6,XBOOLE_0:def 4;
A36: W4 is open by A5,A34,TOPS_1:38;
    W4=W5 /\ (V2 /\ K) by A5,XBOOLE_1:28
      .=W5 /\ K /\ V2 by XBOOLE_1:16
      .=W3 /\ V2 by A34,PRE_TOPC:def 10;
    then
A37: g.:W4 c= g.:W3 /\ g.:V2 by RELAT_1:154;
    g.:W3 /\ g.:V2 c= g.:W3 by XBOOLE_1:17;
    then g.:W4 c= g.:W3 by A37,XBOOLE_1:1;
    then
A38: g.:W4 c= R by A27,XBOOLE_1:1;
    R=V /\ (V2 /\ K) by XBOOLE_1:16;
    then R c= V by XBOOLE_1:17;
    hence ex W being Subset of TOP-REAL 2 st
    p in W & W is open & g.:W c= V by A35,A36,A38,XBOOLE_1:1;
  end;
  then
A39: g is continuous by JGRAPH_2:20;
  g=f" by A1,TOPS_2:def 4;
  hence f is being_homeomorphism by A1,A2,A39,TOPS_2:def 5;
end;

theorem Th9:
  for X being non empty TopSpace,
  f1,f2 being Function of X,R^1,a,b being real number st f1 is continuous &
  f2 is continuous & b<>0 & (for q being Point of X holds f2.q<>0)
  holds ex g being Function of X,R^1
  st (for p being Point of X,r1,r2 being real number st
  f1.p=r1 & f2.p=r2 holds g.p=(r1/r2-a)/b) & g is continuous
proof
  let X be non empty TopSpace, f1,f2 be Function of X,R^1,a,b be real number;
  assume
A1: f1 is continuous & f2 is continuous & b<>0 &
  (for q being Point of X holds f2.q<>0);
  consider g1 being Function of X,R^1 such that
A2: for p being Point of X holds g1.p=b & g1 is continuous by JGRAPH_2:30;
  consider g2 being Function of X,R^1 such that
A3: for p being Point of X holds g2.p=a & g2 is continuous by JGRAPH_2:30;
  consider g3 being Function of X,R^1 such that
A4: (for p being Point of X,r1,r0 being real number st
  f1.p=r1 & f2.p=r0 holds g3.p=r1/r0) & g3 is continuous by A1,JGRAPH_2:37;
  consider g4 being Function of X,R^1 such that
A5: (for p being Point of X,r1,r0 being real number st
  g3.p=r1 & g2.p=r0 holds g4.p=r1-r0) & g4 is continuous by A3,A4,JGRAPH_2:31;
  for q being Point of X holds g1.q<>0 by A1,A2;
  then consider g5 being Function of X,R^1 such that
A6: (for p being Point of X,r1,r0 being real number st
  g4.p=r1 & g1.p=r0 holds g5.p=r1/r0) & g5 is continuous by A2,A5,JGRAPH_2:37;
  for p being Point of X,r1,r2 being real number st
  f1.p=r1 & f2.p=r2 holds g5.p=(r1/r2-a)/b
  proof
    let p be Point of X,r1,r2 be real number;
    assume
A7: f1.p=r1 & f2.p=r2;
A8: g1.p=b by A2;
A9: g2.p=a by A3;
    set r8=r1/r2;
    g3.p=r8 by A4,A7;
    then g4.p=r8-a by A5,A9;
    hence g5.p=(r1/r2-a)/b by A6,A8;
  end;
  hence thesis by A6;
end;

theorem Th10:
  for X being non empty TopSpace,
  f1,f2 being Function of X,R^1,a,b being Real st f1 is continuous &
  f2 is continuous & b<>0 & (for q being Point of X holds f2.q<>0)
  holds ex g being Function of X,R^1
  st (for p being Point of X,r1,r2 being Real st
  f1.p=r1 & f2.p=r2 holds g.p=r2*((r1/r2-a)/b)) & g is continuous
proof
  let X be non empty TopSpace, f1,f2 be Function of X,R^1,a,b be Real;
  assume
A1: f1 is continuous & f2 is continuous & b<>0 &
  (for q being Point of X holds f2.q<>0);
  consider g1 being Function of X,R^1 such that
A2: for p being Point of X holds g1.p=b & g1 is continuous by JGRAPH_2:30;
  consider g2 being Function of X,R^1 such that
A3: for p being Point of X holds g2.p=a & g2 is continuous by JGRAPH_2:30;
  consider g3 being Function of X,R^1 such that
A4: (for p being Point of X,r1,r0 being real number st
  f1.p=r1 & f2.p=r0 holds g3.p=r1/r0) & g3 is continuous by A1,JGRAPH_2:37;
  consider g4 being Function of X,R^1 such that
A5: (for p being Point of X,r1,r0 being real number st
  g3.p=r1 & g2.p=r0 holds g4.p=r1-r0) & g4 is continuous by A3,A4,JGRAPH_2:31;
  for q being Point of X holds g1.q<>0 by A1,A2;
  then consider g5 being Function of X,R^1 such that
A6: (for p being Point of X,r1,r0 being real number st
  g4.p=r1 & g1.p=r0 holds g5.p=r1/r0) & g5 is continuous by A2,A5,JGRAPH_2:37;
  consider g6 being Function of X,R^1 such that
A7: (for p being Point of X,r1,r0 being real number st
  f2.p=r1 & g5.p=r0 holds g6.p=r1*r0) & g6 is continuous by A1,A6,JGRAPH_2:35;
  for p being Point of X,r1,r2 being Real st
  f1.p=r1 & f2.p=r2 holds g6.p=r2*((r1/r2-a)/b)
  proof
    let p be Point of X,r1,r2 be Real;
    assume
A8: f1.p=r1 & f2.p=r2;
A9: g1.p=b by A2;
A10: g2.p=a by A3;
    set r8=r1/r2;
    g3.p=r8 by A4,A8;
    then g4.p=r8-a by A5,A10;
    then g5.p=(r1/r2-a)/b by A6,A9;
    hence g6.p=r2*((r1/r2-a)/b) by A7,A8;
  end;
  hence thesis by A7;
end;

theorem Th11:

for X being non empty TopSpace, f1 being Function of X,R^1 st f1 is continuous
  holds ex g being Function of X,R^1
  st (for p being Point of X,r1 being real number st f1.p=r1 holds g.p=r1^2) &
  g is continuous
proof
  let X be non empty TopSpace, f1 be Function of X,R^1;
  assume f1 is continuous;
  then consider g1 being Function of X,R^1 such that
A1: (for p being Point of X,r1 being real number st
  f1.p=r1 holds g1.p=r1*r1) & g1 is continuous by JGRAPH_2:32;
  for p being Point of X,r1 being real number st
  f1.p=r1 holds g1.p=r1^2 by A1;
  hence thesis by A1;
end;

theorem Th12:

for X being non empty TopSpace, f1 being Function of X,R^1 st f1 is continuous
  holds ex g being Function of X,R^1
  st (for p being Point of X,r1 being real number st
  f1.p=r1 holds g.p=abs(r1)) & g is continuous
proof
  let X be non empty TopSpace, f1 be Function of X,R^1;
  assume f1 is continuous;
  then consider g1 being Function of X,R^1 such that
A1: (for p being Point of X,r1 being real number st
  f1.p=r1 holds g1.p=r1^2) & g1 is continuous by Th11;
  for q being Point of X ex r being real number st g1.q=r & r>=0
  proof
    let q be Point of X;
    reconsider r11=f1.q as Real by TOPMETR:24;
    g1.q=r11^2 by A1;
    hence ex r being real number st g1.q=r & r>=0 by XREAL_1:65;
  end;
  then consider g2 being Function of X,R^1 such that
A2: (for p being Point of X,r1 being real number st
  g1.p=r1 holds g2.p=sqrt(r1)) & g2 is continuous by A1,JGRAPH_3:15;
  for p being Point of X,r1 being real number st f1.p=r1 holds g2.p=abs(r1)
  proof
    let p be Point of X,r1 be real number;
    assume f1.p=r1;
    then g1.p=r1^2 by A1;
    then g2.p=sqrt(r1^2) by A2
      .=abs(r1) by COMPLEX1:158;
    hence g2.p=abs(r1);
  end;
  hence thesis by A2;
end;

theorem Th13:

for X being non empty TopSpace, f1 being Function of X,R^1 st f1 is continuous
  holds ex g being Function of X,R^1
  st (for p being Point of X,r1 being real number st
  f1.p=r1 holds g.p=-r1) & g is continuous
proof
  let X be non empty TopSpace, f1 be Function of X,R^1;
  assume
A1: f1 is continuous;
  consider g1 being Function of X,R^1 such that
A2: (for p being Point of X holds g1.p=0) & g1 is continuous by JGRAPH_2:30;
  consider g2 being Function of X,R^1 such that
A3: (for p being Point of X,r1,r2 being real number st
  g1.p=r1 & f1.p=r2 holds g2.p=r1-r2) & g2 is continuous by A1,A2,JGRAPH_2:31;
  for p being Point of X,r1 being real number st f1.p=r1 holds g2.p=-r1
  proof
    let p be Point of X,r1 be real number;
    assume
A4: f1.p=r1;
    g1.p=0 by A2;
    then g2.p=0-r1 by A3,A4;
    hence g2.p=-r1;
  end;
  hence thesis by A3;
end;

theorem Th14:
  for X being non empty TopSpace,
  f1,f2 being Function of X,R^1,a,b being real number st f1 is continuous &
  f2 is continuous & b<>0 & (for q being Point of X holds f2.q<>0)
  holds ex g being Function of X,R^1
  st (for p being Point of X,r1,r2 being real number st
  f1.p=r1 & f2.p=r2 holds g.p= r2*(-sqrt(abs(1-((r1/r2-a)/b)^2))))
  & g is continuous
proof
  let X be non empty TopSpace, f1,f2 be Function of X,R^1,a,b be real number;
  assume
A1: f1 is continuous & f2 is continuous & b<>0 &
  (for q being Point of X holds f2.q<>0);
  then consider g1 being Function of X,R^1 such that
A2: (for p being Point of X,r1,r2 being real number st
  f1.p=r1 & f2.p=r2 holds g1.p=(r1/r2-a)/b) & g1 is continuous by Th9;
  consider g2 being Function of X,R^1 such that
A3: (for p being Point of X,s being real number st
  g1.p=s holds g2.p=s^2) & g2 is continuous by A2,Th11;
  consider g0 being Function of X,R^1 such that
A4: (for p being Point of X holds g0.p=1)& g0 is continuous by JGRAPH_2:30;
  consider g3 being Function of X,R^1 such that
A5: (for p being Point of X,s,t being real number st
  g0.p=s & g2.p=t holds g3.p=s-t) & g3 is continuous by A3,A4,JGRAPH_2:31;
  consider g4 being Function of X,R^1 such that
A6: (for p being Point of X,s being real number st g3.p=s holds g4.p=abs s)
  & g4 is continuous by A5,Th12;
  for q being Point of X ex r being real number st g4.q=r & r>=0
  proof
    let q be Point of X;
    reconsider s=g3.q as Real by TOPMETR:24;
    g4.q=abs s by A6;
    hence ex r being real number st g4.q=r & r>=0 by COMPLEX1:132;
  end;
  then consider g5 being Function of X,R^1 such that
A7: (for p being Point of X,s being real number st g4.p=s holds g5.p=sqrt(s))
  & g5 is continuous by A6,JGRAPH_3:15;
  consider g6 being Function of X,R^1 such that
A8: (for p being Point of X,s being real number st
  g5.p=s holds g6.p=-s) & g6 is continuous by A7,Th13;
  consider g7 being Function of X,R^1 such that
A9: (for p being Point of X,r1,r0 being real number st
  f2.p=r1 & g6.p=r0 holds g7.p=r1*r0) & g7 is continuous by A1,A8,JGRAPH_2:35;
  for p being Point of X,r1,r2 being real number st
  f1.p=r1 & f2.p=r2 holds g7.p= r2*(-sqrt(abs(1-((r1/r2-a)/b)^2)))
  proof
    let p be Point of X,r1,r2 be real number;
    assume
A10: f1.p=r1 & f2.p=r2;
A11: g0.p=1 by A4;
    g1.p=(r1/r2-a)/b by A2,A10;
    then g2.p=((r1/r2-a)/b)^2 by A3;
    then g3.p=1-((r1/r2-a)/b)^2 by A5,A11;
    then g4.p= abs(1-((r1/r2-a)/b)^2) by A6;
    then g5.p=sqrt(abs(1-((r1/r2-a)/b)^2)) by A7;
    then g6.p= -sqrt(abs(1-((r1/r2-a)/b)^2)) by A8;
    hence g7.p=r2*(-sqrt(abs(1-((r1/r2-a)/b)^2))) by A9,A10;
  end;
  hence thesis by A9;
end;

theorem Th15:
  for X being non empty TopSpace,
  f1,f2 being Function of X,R^1,a,b being real number st f1 is continuous &
  f2 is continuous & b<>0 & (for q being Point of X holds f2.q<>0)
  holds ex g being Function of X,R^1
  st (for p being Point of X,r1,r2 being real number st
  f1.p=r1 & f2.p=r2 holds g.p= r2*(sqrt(abs(1-((r1/r2-a)/b)^2))))
  & g is continuous
proof
  let X be non empty TopSpace, f1,f2 be Function of X,R^1,a,b be real number;
  assume
A1: f1 is continuous &
  f2 is continuous & b<>0 & (for q being Point of X holds f2.q<>0);
  then consider g1 being Function of X,R^1 such that
A2: (for p being Point of X,r1,r2 being real number st
  f1.p=r1 & f2.p=r2 holds g1.p=(r1/r2-a)/b) & g1 is continuous by Th9;
  consider g2 being Function of X,R^1 such that
A3: (for p being Point of X,s being real number st
  g1.p=s holds g2.p=s^2) & g2 is continuous by A2,Th11;
  consider g0 being Function of X,R^1 such that
A4: (for p being Point of X holds g0.p=1)& g0 is continuous by JGRAPH_2:30;
  consider g3 being Function of X,R^1 such that
A5: (for p being Point of X,s,t being real number st
  g0.p=s & g2.p=t holds g3.p=s-t) & g3 is continuous by A3,A4,JGRAPH_2:31;
  consider g4 being Function of X,R^1 such that
A6: (for p being Point of X,s being real number st g3.p=s holds g4.p=abs s)
  & g4 is continuous by A5,Th12;
  for q being Point of X ex r being real number st g4.q=r & r>=0
  proof
    let q be Point of X;
    reconsider s=g3.q as Real by TOPMETR:24;
    g4.q=abs s by A6;
    hence ex r being real number st g4.q=r & r>=0 by COMPLEX1:132;
  end;
  then consider g5 being Function of X,R^1 such that
A7: (for p being Point of X,s being real number st g4.p=s holds g5.p=sqrt s)
  & g5 is continuous by A6,JGRAPH_3:15;
  consider g7 being Function of X,R^1 such that
A8: (for p being Point of X,r1,r0 being real number st
  f2.p=r1 & g5.p=r0 holds g7.p=r1*r0) & g7 is continuous by A1,A7,JGRAPH_2:35;
  for p being Point of X,r1,r2 being real number st
  f1.p=r1 & f2.p=r2 holds g7.p= r2*( sqrt(abs(1-((r1/r2-a)/b)^2)))
  proof
    let p be Point of X,r1,r2 be real number;
    assume
A9: f1.p=r1 & f2.p=r2;
A10: g0.p=1 by A4;
    g1.p=(r1/r2-a)/b by A2,A9;
    then g2.p=((r1/r2-a)/b)^2 by A3;
    then g3.p=1-((r1/r2-a)/b)^2 by A5,A10;
    then g4.p= abs(1-((r1/r2-a)/b)^2) by A6;
    then g5.p=sqrt(abs(1-((r1/r2-a)/b)^2)) by A7;
    hence g7.p=r2*( sqrt(abs(1-((r1/r2-a)/b)^2))) by A8,A9;
  end;
  hence thesis by A8;
end;

definition
  let n be Element of NAT;
  func n NormF -> Function of TOP-REAL n, R^1 means
  :Def1:
  for q being Point of TOP-REAL n holds it.q=|.q.|;
  existence
  proof
    deffunc F(Point of TOP-REAL n)=|.$1.|;
A1: for x being Element of TOP-REAL n holds
    F(x) in the carrier of R^1 by TOPMETR:24;
    thus ex IT being Function of TOP-REAL n, R^1
    st for q being Point of TOP-REAL n holds
    IT.q = F(q) from FUNCT_2:sch 8(A1);
  end;
  uniqueness
  proof
    deffunc F(Point of TOP-REAL n)=|.$1.|;
    thus for f,g being Function of TOP-REAL n, R^1
    st (for q being Point of TOP-REAL n holds f.q=F(q)) &
    (for q being Point of TOP-REAL n holds g.q=F(q))
    holds f=g from BINOP_2:sch 1;
  end;
end;

theorem
  for n being Element of NAT holds
  dom (n NormF)=the carrier of TOP-REAL n & dom (n NormF)=REAL n
  by FUNCT_2:def 1;

canceled 2;

theorem Th19:
  for n being Element of NAT,f being Function of TOP-REAL n,R^1 st f=n NormF
  holds f is continuous
proof
  let n be Element of NAT,f be Function of TOP-REAL n,R^1;
  assume
A1: f=n NormF;
  for p being Point of TOP-REAL n,V being Subset of R^1
  st f.p in V & V is open holds
  ex W being Subset of TOP-REAL n st p in W & W is open & f.:W c= V
  proof
    let p be Point of TOP-REAL n,V be Subset of R^1;
    assume
A2: f.p in V & V is open;
    reconsider v=p as Point of Euclid n;
    reconsider u=f.p as Point of RealSpace by METRIC_1:def 14,TOPMETR:24;
    reconsider u'=f.p as Real by TOPMETR:24;
A3: f.p=|.p.| by A1,Def1;
    consider r being real number such that
A4: r>0 & Ball(u,r) c= V by A2,TOPMETR:22,def 7;
    reconsider r as Real by XREAL_0:def 1;
A5: Ball(v,r)={q where q is Point of TOP-REAL n:
    |. p-q .| < r} by JGRAPH_2:10;
    defpred P[Point of TOP-REAL n] means |. p-$1 .| < r;
    reconsider W1=Ball(v,r) as Subset of TOP-REAL n;
A6: v in W1 by A4,GOBOARD6:4;
A7: W1 is open by GOBOARD6:6;
    f.:W1 c= Ball(u,r)
    proof
      let y be set;
      assume y in f.:W1;
      then consider x being set such that
A8:   x in dom f & x in W1 & y=f.x by FUNCT_1:def 12;
      reconsider q=x as Point of TOP-REAL n by A8;
      consider q1 being Point of TOP-REAL n such that
A9:   q=q1 & |. p-q1 .| < r by A5,A8;
A10:  f.x=|.q.| by A1,Def1;
A11:  Ball(u,r)=].u'-r,u'+r.[ by A4,FRECHET:7;
      abs(|.p.|-(|.q.|))<= |. p-q .| by JORDAN2C:11;
      then abs(u'-(|.q.|))<r by A3,A9,XXREAL_0:2;
      then
A12:  -r < u'-(|.q.|) & u'-(|.q.|)<r by SEQ_2:9;
      then
A13:  u'-(u'-(|.q.|))>u'-r by XREAL_1:17;
      u'>|.q.|+-r by A12,XREAL_1:22;
      then u' --r > |.q.| +-r--r by XREAL_1:11;
      hence y in Ball(u,r) by A8,A10,A11,A13,XXREAL_1:4;
    end;
    hence thesis by A4,A6,A7,XBOOLE_1:1;
  end;
  hence f is continuous by JGRAPH_2:20;
end;

theorem Th20:
  for n being Element of NAT,K0 being Subset of TOP-REAL n,
  f being Function of (TOP-REAL n)|K0,R^1 st
  (for p being Point of (TOP-REAL n)|K0 holds
  f.p=(n NormF).p) holds f is continuous
proof
  let n be Element of NAT,K0 be Subset of TOP-REAL n,
  f be Function of (TOP-REAL n)|K0,R^1;
  assume
A1: (for p being Point of (TOP-REAL n)|K0 holds f.p=(n NormF).p);
A2: dom f= the carrier of (TOP-REAL n)|K0 by FUNCT_2:def 1;
A3: the carrier of (TOP-REAL n)|K0=K0 by PRE_TOPC:29;
  (the carrier of TOP-REAL n)/\K0=K0 by XBOOLE_1:28;
  then
A4: dom f=dom (n NormF) /\ K0 by A2,A3,FUNCT_2:def 1;
A5: for x being set st x in dom f holds f.x=(n NormF).x by A1;
  reconsider g=(n NormF) as Function of TOP-REAL n,R^1;
  f=g|K0 by A4,A5,FUNCT_1:68;
  hence f is continuous by Th19,TOPMETR:10;
end;

theorem Th21:
  for n being Element of NAT,p being Point of Euclid n,r being Real,
  B being Subset of TOP-REAL n st B=cl_Ball(p,r) holds B is Bounded closed
proof
  let n be Element of NAT,p be Point of Euclid n,r be Real,
  B be Subset of TOP-REAL n;
  assume
A1: B=cl_Ball(p,r);
  cl_Ball(p,r) c= Ball(p,r+1)
  proof
    let x be set;
    assume
A2: x in cl_Ball(p,r);
    then reconsider q=x as Point of Euclid n;
A3: dist(p,q)<=r by A2,METRIC_1:13;
    r<r+1 by XREAL_1:31;
    then dist(p,q)<r+1 by A3,XXREAL_0:2;
    hence x in Ball(p,r+1) by METRIC_1:12;
  end;
  then cl_Ball(p,r) is bounded by TBSP_1:19,21;
  hence B is Bounded by A1,JORDAN2C:def 2;
  thus B is closed by A1,TOPREAL6:65;
end;

theorem Th22:
  for p being Point of Euclid 2,r being Real,
  B being Subset of TOP-REAL 2 st B=cl_Ball(p,r) holds B is compact
proof
  let p be Point of Euclid 2,r be Real, B be Subset of TOP-REAL 2;
  assume B=cl_Ball(p,r);
  then B is Bounded closed by Th21;
  hence B is compact by TOPREAL6:88;
end;

begin :: Fan Morphism for West

definition
  let s be real number, q be Point of TOP-REAL 2;
  func FanW(s,q) -> Point of TOP-REAL 2 equals
  :Def2:
  |.q.|*|[-sqrt(1-((q`2/|.q.|-s)/(1-s))^2),
  (q`2/|.q.|-s)/(1-s)]| if q`2/|.q.|>=s & q`1<0,
  |.q.|*|[-sqrt(1-((q`2/|.q.|-s)/(1+s))^2),
  (q`2/|.q.|-s)/(1+s)]| if q`2/|.q.|<s & q`1<0 otherwise q;
  correctness;
end;

definition
  let s be real number;
  func s-FanMorphW -> Function of TOP-REAL 2, TOP-REAL 2 means
  :Def3:
  for q being Point of TOP-REAL 2 holds it.q=FanW(s,q);
  existence
  proof
    deffunc F(Point of TOP-REAL 2)=FanW(s,$1);
    thus ex IT being Function of TOP-REAL 2, TOP-REAL 2 st
    for q being Point of TOP-REAL 2 holds IT.q=F(q) from FUNCT_2:sch 4;
  end;
  uniqueness
  proof
    deffunc F(Point of TOP-REAL 2)=FanW(s,$1);
    thus for f,g being Function of TOP-REAL 2, TOP-REAL 2 st
    (for q being Point of TOP-REAL 2 holds f.q=F(q)) &
    (for q being Point of TOP-REAL 2 holds g.q=F(q)) holds f=g
    from BINOP_2:sch 1;
  end;
end;

theorem Th23:
  for sn being real number holds (q`2/|.q.|>=sn & q`1<0 implies
  sn-FanMorphW.q= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
  |.q.|* ((q`2/|.q.|-sn)/(1-sn))]|) & (q`1>=0 implies sn-FanMorphW.q=q)
proof
  let sn be real number;
A1: sn-FanMorphW.q=FanW(sn,q) by Def3;
  hereby
    assume q`2/|.q.|>=sn & q`1<0;
    then FanW(sn,q)= |.q.|*|[-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2),
    (q`2/|.q.|-sn)/(1-sn)]| by Def2
      .= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
    |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by EUCLID:62;
    hence sn-FanMorphW.q= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
    |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by Def3;
  end;
  assume q`1>=0;
  hence thesis by A1,Def2;
end;

theorem Th24:
  for sn being Real st q`2/|.q.|<=sn & q`1<0 holds
  sn-FanMorphW.q= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
  |.q.|*((q`2/|.q.|-sn)/(1+sn))]|
proof
  let sn be Real;
  assume
A1: q`2/|.q.|<=sn & q`1<0;
  per cases by A1,XXREAL_0:1;
  suppose q`2/|.q.|<sn;
    then FanW(sn,q)= |.q.|*|[-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2),
    (q`2/|.q.|-sn)/(1+sn)]| by A1,Def2
      .= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
    |.q.|* ((q`2/|.q.|-sn)/(1+sn))]| by EUCLID:62;
    hence thesis by Def3;
  end;
  suppose
A2: q`2/|.q.|=sn;
    then (q`2/|.q.|-sn)/(1-sn)=0;
    hence thesis by A1,A2,Th23;
  end;
end;

theorem Th25:
  for sn being Real st -1<sn & sn<1 holds
  (q`2/|.q.|>=sn & q`1<=0 & q<>0.REAL 2 implies
  sn-FanMorphW.q= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
  |.q.|* ((q`2/|.q.|-sn)/(1-sn))]|) &
  (q`2/|.q.|<=sn & q`1<=0 & q<>0.REAL 2 implies
  sn-FanMorphW.q= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
  |.q.|*((q`2/|.q.|-sn)/(1+sn))]|)
proof
  let sn be Real;
  assume
A1: -1<sn & sn<1;
  per cases;
  suppose
A2: q`2/|.q.|>=sn & q`1<=0 & q<>0.REAL 2;
    per cases;
    suppose
A3:   q`1<0;
      then FanW(sn,q)= |.q.|*|[-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2),
      (q`2/|.q.|-sn)/(1-sn)]| by A2,Def2
        .= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
      |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by EUCLID:62;
      hence thesis by A3,Def3,Th24;
    end;
    suppose
A4:   q`1>=0;
      then
A5:   sn-FanMorphW.q=q by Th23;
A6:   (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
A7:   |.q.|<>0 by A2,TOPRNS_1:25;
      then
A8:   |.q.|^2>0 by SQUARE_1:74;
A9:   q`1=0 by A2,A4;
A10:  sqrt((|.q.|)^2)=|.q.| by SQUARE_1:89;
A11:  1-sn>0 by A1,XREAL_1:151;
A12:  |.q.|>0 by A2,Lm1;
      (q`2)^2/|.q.|^2=1^2 by A6,A8,A9,XCMPLX_1:60;
      then ((q`2)/|.q.|)^2=1^2 by XCMPLX_1:77;
      then
A13:  sqrt(((q`2)/|.q.|)^2)=1 by SQUARE_1:89;
      now
        assume q`2<0;
        then q`2/|.q.|<0 by A12,XREAL_1:143;
        then -((q`2)/|.q.|)=1 by A13,SQUARE_1:90;
        hence contradiction by A1,A2;
      end;
      then
A14:  |.q.|=q`2 by A6,A9,A10,SQUARE_1:89;
      then 1=q`2/|.q.| by A2,TOPRNS_1:25,XCMPLX_1:60;
      then (q`2/|.q.|-sn)/(1-sn)=1 by A11,XCMPLX_1:60;
      hence thesis by A1,A5,A7,A9,A14,EUCLID:57,SQUARE_1:82,XCMPLX_1:60;
    end;
  end;
  suppose
A15: q`2/|.q.|<=sn & q`1<=0 & q<>0.REAL 2;
    per cases;
    suppose q`1<0;
      hence thesis by Th23,Th24;
    end;
    suppose
A16:  q`1>=0;
A17:  (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
A18:  |.q.|<>0 by A15,TOPRNS_1:25;
A19:  q`1=0 by A15,A16;
A20:  |.q.|>0 by A15,Lm1;
A21:  1+sn>0 by A1,XREAL_1:150;
      1>q`2/|.q.| by A1,A15,XXREAL_0:2;
      then 1 *(|.q.|)>q`2/|.q.|*(|.q.|) by A20,XREAL_1:70;
      then
A22:  (|.q.|)>q`2 by A15,TOPRNS_1:25,XCMPLX_1:88;
      then
A23:  |.q.|=-q`2 by A17,A19,SQUARE_1:109;
A24:  q`2= -(|.q.|) by A17,A19,A22,SQUARE_1:109;
      then -1=q`2/|.q.| by A15,TOPRNS_1:25,XCMPLX_1:198;
      then (q`2/|.q.|-sn)/(1+sn) =(-(1+sn))/(1+sn)
        .=-1 by A21,XCMPLX_1:198;
      then |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
      |.q.|* ((q`2/|.q.|-sn)/(1+sn))]| =q by A19,A23,EUCLID:57,SQUARE_1:82;
      hence thesis by A1,A16,A18,A24,Th23,XCMPLX_1:198;
    end;
  end;
  suppose q`1>0 or q=0.REAL 2;
    hence thesis;
  end;
end;

Lm2: for K being non empty Subset of TOP-REAL 2 holds
proj1|K is continuous Function of (TOP-REAL 2)|K,R^1 &
for q being Point of (TOP-REAL 2)|K holds (proj1|K).q=proj1.q
proof
  let K be non empty Subset of TOP-REAL 2;
A1: the carrier of (TOP-REAL 2)|K=K by PRE_TOPC:29;
  reconsider g2=proj1|K as Function of (TOP-REAL 2)|K,R^1
  by TOPMETR:24;
  for q being Point of (TOP-REAL 2)|K holds g2.q=proj1.q
  proof
    let q be Point of (TOP-REAL 2)|K;
A2: q in the carrier of (TOP-REAL 2)|K;
    dom proj1=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
    then q in dom proj1 /\ K by A1,A2,XBOOLE_0:def 4;
    hence g2.q=proj1.q by FUNCT_1:71;
  end;
  hence thesis by JGRAPH_2:39;
end;

Lm3: for K being non empty Subset of TOP-REAL 2 holds
proj2|K is continuous Function of (TOP-REAL 2)|K,R^1 &
for q being Point of (TOP-REAL 2)|K holds (proj2|K).q=proj2.q
proof
  let K be non empty Subset of TOP-REAL 2;
A1: the carrier of (TOP-REAL 2)|K=K by PRE_TOPC:29;
  reconsider g2=proj2|K as Function of (TOP-REAL 2)|K,R^1
  by TOPMETR:24;
  for q being Point of (TOP-REAL 2)|K holds g2.q=proj2.q
  proof
    let q be Point of (TOP-REAL 2)|K;
A2: q in the carrier of (TOP-REAL 2)|K;
    dom proj2=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
    then q in dom proj2 /\ K by A1,A2,XBOOLE_0:def 4;
    hence g2.q=proj2.q by FUNCT_1:71;
  end;
  hence thesis by JGRAPH_2:40;
end;

Lm4: dom (2 NormF)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;

Lm5: for K being non empty Subset of TOP-REAL 2 holds
(2 NormF)|K is continuous Function of (TOP-REAL 2)|K,R^1 &
(for q being Point of (TOP-REAL 2)|K holds ((2 NormF)|K).q=(2 NormF).q)
proof
  let K1 be non empty Subset of TOP-REAL 2;
A1: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
  then reconsider g1=(2 NormF)|K1 as Function
  of (TOP-REAL 2)|K1,R^1 by FUNCT_2:38;
  for q being Point of (TOP-REAL 2)|K1 holds g1.q=(2 NormF).q
  proof
    let q be Point of (TOP-REAL 2)|K1;
    q in the carrier of (TOP-REAL 2)|K1;
    then q in dom (2 NormF) /\ K1 by A1,Lm4,XBOOLE_0:def 4;
    hence g1.q=(2 NormF).q by FUNCT_1:71;
  end;
  hence thesis by Th20;
end;

Lm6: for K1 be non empty Subset of TOP-REAL 2,
g1 be Function of (TOP-REAL 2)|K1,R^1 st g1=(2 NormF)|K1 &
(for q being Point of TOP-REAL 2 st q in
the carrier of (TOP-REAL 2)|K1 holds q<>0.REAL 2) holds
for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0
proof
  let K1 be non empty Subset of TOP-REAL 2,
  g1 be Function of (TOP-REAL 2)|K1,R^1;
A1: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
  assume
A2: g1=(2 NormF)|K1 & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q<>0.REAL 2);
  let q be Point of (TOP-REAL 2)|K1;
  q in the carrier of (TOP-REAL 2)|K1;
  then reconsider q2=q as Point of TOP-REAL 2 by A1;
  g1.q=(2 NormF).q by A2,Lm5
    .= |.q2.| by Def1;
  hence g1.q<>0 by A2,TOPRNS_1:25;
end;

theorem Th26:
  for sn being Real,K1 being non empty Subset of TOP-REAL 2,
  f being Function of (TOP-REAL 2)|K1,R^1 st -1<sn & sn<1 &
  (for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|* ((p`2/|.p.|-sn)/(1-sn)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1<=0 & q<>0.REAL 2) holds
  f is continuous
proof
  let sn be Real,K1 be non empty Subset of TOP-REAL 2,
  f be Function of (TOP-REAL 2)|K1,R^1;
  assume
A1: -1<sn & sn<1 &
  (for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|* ((p`2/|.p.|-sn)/(1-sn)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1<=0 & q<>0.REAL 2);
  set a=sn, b=1-sn;
A2: b>0 by A1,XREAL_1:151;
  reconsider g2=proj2|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm3;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1
  by Lm5;
  for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q<>0.REAL 2 by A1;
  then for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm6;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
A3: (for q being Point of
  (TOP-REAL 2)|K1,r1,r2 being Real st g2.q=r1 & g1.q=r2
  holds g3.q=r2*((r1/r2-a)/b)) & g3 is continuous by A2,Th10;
A4: dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then
A5: dom f=dom g3 by FUNCT_2:def 1;
  for x being set st x in dom f holds f.x=g3.x
  proof
    let x be set;
    assume
A6: x in dom f;
    then x in K1 by A4,A5,PRE_TOPC:29;
    then reconsider r=x as Point of TOP-REAL 2;
    reconsider s=x as Point of (TOP-REAL 2)|K1 by A6;
A7: f.r=(|.r.|)* ((r`2/|.r.|-sn)/(1-sn)) by A1,A6;
A8: g2.s=proj2.s by Lm3;
A9: g1.s=(2 NormF).s by Lm5;
A10: proj2.r=r`2 by PSCOMP_1:def 29;
    (2 NormF).r=|.r.| by Def1;
    hence f.x=g3.x by A3,A7,A8,A9,A10;
  end;
  hence f is continuous by A3,A5,FUNCT_1:9;
end;

theorem Th27:
  for sn being Real,K1 being non empty Subset of TOP-REAL 2,
  f being Function of (TOP-REAL 2)|K1,R^1 st -1<sn & sn<1 &
  (for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|* ((p`2/|.p.|-sn)/(1+sn)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1<=0 & q<>0.REAL 2) holds
  f is continuous
proof
  let sn be Real,K1 be non empty Subset of TOP-REAL 2,
  f be Function of (TOP-REAL 2)|K1,R^1;
  assume
A1: -1<sn & sn<1 &
  (for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|* ((p`2/|.p.|-sn)/(1+sn)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1<=0 & q<>0.REAL 2);
  set a=sn, b=1+sn;
A2: 1+sn>0 by A1,XREAL_1:150;
  reconsider g2=proj2|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm3;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1
  by Lm5;
  for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q<>0.REAL 2 by A1;
  then for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm6;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
A3: (for q being Point of
  (TOP-REAL 2)|K1,r1,r2 being Real st g2.q=r1 & g1.q=r2
  holds g3.q=r2*((r1/r2-a)/b)) & g3 is continuous by A2,Th10;
A4: dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then
A5: dom f=dom g3 by FUNCT_2:def 1;
  for x being set st x in dom f holds f.x=g3.x
  proof
    let x be set;
    assume
A6: x in dom f;
    then x in dom g3 by A4;
    then x in K1 by A4,PRE_TOPC:29;
    then reconsider r=x as Point of TOP-REAL 2;
    reconsider s=x as Point of (TOP-REAL 2)|K1 by A6;
A7: f.r=(|.r.|)* ((r`2/|.r.|-sn)/(1+sn)) by A1,A6;
A8: g2.s=proj2.s by Lm3;
A9: g1.s=(2 NormF).s by Lm5;
A10: proj2.r=r`2 by PSCOMP_1:def 29;
    (2 NormF).r=|.r.| by Def1;
    hence f.x=g3.x by A3,A7,A8,A9,A10;
  end;
  hence f is continuous by A3,A5,FUNCT_1:9;
end;

theorem Th28:
  for sn being Real,K1 being non empty Subset of TOP-REAL 2,
  f being Function of (TOP-REAL 2)|K1,R^1 st -1<sn & sn<1 &
  (for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds
  q`1<=0 & q`2/|.q.|>=sn & q<>0.REAL 2) holds f is continuous
proof
  let sn be Real,K1 be non empty Subset of TOP-REAL 2,
  f be Function of (TOP-REAL 2)|K1,R^1;
  assume
A1: -1<sn & sn<1 &
  (for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1<=0 & q`2/|.q.|>=sn & q<>0.REAL 2);
  set a=sn, b=1-sn;
A2: b>0 by A1,XREAL_1:151;
  reconsider g2=proj2|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm3;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1
  by Lm5;
  for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q<>0.REAL 2 by A1;
  then for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm6;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
A3: (for q being Point of
  (TOP-REAL 2)|K1,r1,r2 being real number st g2.q=r1 & g1.q=r2
  holds g3.q=r2*(-sqrt(abs(1-((r1/r2-a)/b)^2))))
  & g3 is continuous by A2,Th14;
A4: dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then
A5: dom f=dom g3 by FUNCT_2:def 1;
  for x being set st x in dom f holds f.x=g3.x
  proof
    let x be set;
    assume
A6: x in dom f;
    then x in K1 by A4,A5,PRE_TOPC:29;
    then reconsider r=x as Point of TOP-REAL 2;
    reconsider s=x as Point of (TOP-REAL 2)|K1 by A6;
A7: now
      assume |.r.|=0;
      then r=0.REAL 2 by TOPRNS_1:25;
      hence contradiction by A1,A6;
    end;
    |.r.|^2=(r`1)^2+(r`2)^2 by JGRAPH_3:10;
    then
A9: ((r`2) -(|.r.|))*((r`2)+|.r.|) =-(r`1)^2;
    (r`1)^2>=0 by XREAL_1:65;
    then -(r`1)^2 <=0;
    then -(|.r.|)<=r`2 & r`2<= |.r.| by A9,XREAL_1:95;
    then r`2/|.r.| <= |.r.|/|.r.| by XREAL_1:74;
    then r`2/|.r.|<=1 by A7,XCMPLX_1:60;
    then
A10: r`2/|.r.|-sn<=(1-sn) by XREAL_1:11;
A11: now
      assume (1-sn)^2=0;
      then 1-sn+sn=0+sn by XCMPLX_1:6;
      hence contradiction by A1;
    end;
A12: 1-sn>0 by A1,XREAL_1:151;
A13: (1-sn)^2>=0 by XREAL_1:65;
    sn<=r`2/(|.r.|) by A1,A6;
    then sn-r`2/|.r.|<=0 by XREAL_1:49;
    then -(sn- r`2/|.r.|)>=-(1-sn) by A12,XREAL_1:26;
    then (r`2/|.r.|-sn)^2<=(1-sn)^2 by A10,SQUARE_1:119;
    then (r`2/|.r.|-sn)^2/(1-sn)^2<=(1-sn)^2/(1-sn)^2 by A13,XREAL_1:74;
    then (r`2/|.r.|-sn)^2/(1-sn)^2<=1 by A11,XCMPLX_1:60;
    then ((r`2/|.r.|-sn)/(1-sn))^2<=1 by XCMPLX_1:77;
    then 1-((r`2/|.r.|-sn)/(1-sn))^2>=0 by XREAL_1:50;
    then abs(1-((r`2/|.r.|-sn)/(1-sn))^2)
    =1-((r`2/|.r.|-sn)/(1-sn))^2 by ABSVALUE:def 1;
    then
A14: f.r=(|.r.|)*(-sqrt(abs(1-((r`2/|.r.|-sn)/(1-sn))^2))) by A1,A6;
A15: g2.s=proj2.s by Lm3;
A16: g1.s=(2 NormF).s by Lm5;
A17: proj2.r=r`2 by PSCOMP_1:def 29;
    (2 NormF).r=|.r.| by Def1;
    hence f.x=g3.x by A3,A14,A15,A16,A17;
  end;
  hence f is continuous by A3,A5,FUNCT_1:9;
end;

theorem Th29:
  for sn being Real,K1 being non empty Subset of TOP-REAL 2,
  f being Function of (TOP-REAL 2)|K1,R^1 st -1<sn & sn<1 &
  (for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds
  q`1<=0 & q`2/|.q.|<=sn & q<>0.REAL 2) holds f is continuous
proof
  let sn be Real,K1 be non empty Subset of TOP-REAL 2,
  f be Function of (TOP-REAL 2)|K1,R^1;
  assume
A1: -1<sn & sn<1 &
  (for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1<=0 & q`2/|.q.|<=sn & q<>0.REAL 2);
  set a=sn, b=1+sn;
A2: 1+sn>0 by A1,XREAL_1:150;
  reconsider g2=proj2|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm3;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1
  by Lm5;
  for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q<>0.REAL 2 by A1;
  then for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm6;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
A3: (for q being Point of
  (TOP-REAL 2)|K1,r1,r2 being real number st g2.q=r1 & g1.q=r2
  holds g3.q=r2*(-sqrt(abs(1-((r1/r2-a)/b)^2))))
  & g3 is continuous by A2,Th14;
A4: dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then
A5: dom f=dom g3 by FUNCT_2:def 1;
  for x being set st x in dom f holds f.x=g3.x
  proof
    let x be set;
    assume
A6: x in dom f;
    then x in K1 by A4,A5,PRE_TOPC:29;
    then reconsider r=x as Point of TOP-REAL 2;
    reconsider s=x as Point of (TOP-REAL 2)|K1 by A6;
A7: now
      assume |.r.|=0;
      then r=0.REAL 2 by TOPRNS_1:25;
      hence contradiction by A1,A6;
    end;
    |.r.|^2=(r`1)^2+(r`2)^2 by JGRAPH_3:10;
    then
A9: ((r`2) -(|.r.|))*((r`2)+|.r.|) =-(r`1)^2;
    (r`1)^2>=0 by XREAL_1:65;
    then -(r`1)^2 <=0;
    then -(|.r.|)<=r`2 & r`2<= |.r.| by A9,XREAL_1:95;
    then r`2/|.r.| >= (-(|.r.|))/|.r.| by XREAL_1:74;
    then r`2/|.r.|>= -1 by A7,XCMPLX_1:198;
    then r`2/|.r.|-sn>=-1-sn by XREAL_1:11;
    then
A10: r`2/|.r.|-sn>=-(1+sn);
A11: (1+sn)^2>0 by A2,SQUARE_1:74;
    sn>=r`2/(|.r.|) by A1,A6;
    then sn-r`2/|.r.|>=0 by XREAL_1:50;
    then -(sn-r`2/|.r.|)<=-0;
    then (r`2/|.r.|-sn)^2<=(1+sn)^2 by A2,A10,SQUARE_1:119;
    then (r`2/|.r.|-sn)^2/(1+sn)^2<=(1+sn)^2/(1+sn)^2 by A11,XREAL_1:74;
    then (r`2/|.r.|-sn)^2/(1+sn)^2<=1 by A11,XCMPLX_1:60;
    then ((r`2/|.r.|-sn)/(1+sn))^2<=1 by XCMPLX_1:77;
    then 1-((r`2/|.r.|-sn)/(1+sn))^2>=0 by XREAL_1:50;
    then abs(1-((r`2/|.r.|-sn)/(1+sn))^2)
    =1-((r`2/|.r.|-sn)/(1+sn))^2 by ABSVALUE:def 1;
    then
A12: f.r=(|.r.|)*(-sqrt(abs(1-((r`2/|.r.|-sn)/(1+sn))^2))) by A1,A6;
A13: g2.s=proj2.s by Lm3;
A14: g1.s=(2 NormF).s by Lm5;
A15: proj2.r=r`2 by PSCOMP_1:def 29;
    (2 NormF).r=|.r.| by Def1;
    hence f.x=g3.x by A3,A12,A13,A14,A15;
  end;
  hence f is continuous by A3,A5,FUNCT_1:9;
end;

theorem Th30:
  for sn being Real, K0,B0 being Subset of TOP-REAL 2,
  f being Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0 st
  -1<sn & sn<1 & f=(sn-FanMorphW)|K0 &
  B0={q where q is Point of TOP-REAL 2: q`1<=0 & q<>0.REAL 2} &
  K0={p: p`2/|.p.|>=sn & p`1<=0 & p<>0.REAL 2} holds f is continuous
proof
  let sn be Real,K0,B0 be Subset of TOP-REAL 2,
  f be Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0;
  assume
A1: -1<sn & sn<1 & f=(sn-FanMorphW)|K0 &
  B0={q where q is Point of TOP-REAL 2: q`1<=0 & q<>0.REAL 2} &
  K0={p: p`2/|.p.|>=sn & p`1<=0 & p<>0.REAL 2};
  set cn=sqrt(1-sn^2);
  set p0=|[-cn,sn]|;
A2: p0`2=sn by EUCLID:56;
A3: p0`1=-cn by EUCLID:56;
  sn^2<1^2 by A1,SQUARE_1:120;
  then
A4: 1-sn^2>0 by XREAL_1:52;
A5: now
    assume p0=0.REAL 2;
    then --cn=-0 by EUCLID:56,JGRAPH_2:11;
    hence contradiction by A4,SQUARE_1:93;
  end;
  --cn>0 by A4,SQUARE_1:93;
  then
A6: p0`1<0 by A3;
A7: |.p0.|=sqrt((-cn)^2+sn^2) by A2,A3,JGRAPH_3:10
    .=sqrt((cn)^2+sn^2);
  cn^2=1-sn^2 by A4,SQUARE_1:def 4;
  then p0`2/|.p0.|=sn by A7,EUCLID:56,SQUARE_1:83;
  then
A8: p0 in K0 by A1,A5,A6;
  then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
A9: K0 c= B0
  proof
    let x be set;
    assume x in K0;
    then consider p8 being Point of TOP-REAL 2 such that
A10: x=p8 & (p8`2/|.p8.|>=sn & p8`1<=0 & p8<>0.REAL 2) by A1;
    thus x in B0 by A1,A10;
  end;
A11: dom (proj2*((sn-FanMorphW)|K1)) c= dom ((sn-FanMorphW)|K1) by RELAT_1:44;
  dom ((sn-FanMorphW)|K1) c= dom (proj2*((sn-FanMorphW)|K1))
  proof
    let x be set;
    assume
A12: x in dom ((sn-FanMorphW)|K1);
    then
A13: x in dom (sn-FanMorphW) /\ K1 by FUNCT_1:68;
A14: ((sn-FanMorphW)|K1).x=(sn-FanMorphW).x by A12,FUNCT_1:68;
A15: dom proj2 = (the carrier of TOP-REAL 2) by FUNCT_2:def 1;
    x in dom (sn-FanMorphW) by A13,XBOOLE_0:def 4;
    then (sn-FanMorphW).x in rng (sn-FanMorphW) by FUNCT_1:12;
    hence x in dom (proj2*((sn-FanMorphW)|K1)) by A12,A14,A15,FUNCT_1:21;
  end;
  then
A16: dom (proj2*((sn-FanMorphW)|K1))
  =dom ((sn-FanMorphW)|K1) by A11,XBOOLE_0:def 10
    .=dom (sn-FanMorphW) /\ K1 by FUNCT_1:68
    .=(the carrier of TOP-REAL 2)/\ K1 by FUNCT_2:def 1
    .=K1 by XBOOLE_1:28
    .=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
  rng (proj2*((sn-FanMorphW)|K1)) c= the carrier of R^1 by TOPMETR:24;

then reconsider g2=proj2*((sn-FanMorphW)|K1) as Function of (TOP-REAL 2)|K1,R^1
  by A16,FUNCT_2:4;
A17: dom (proj1*((sn-FanMorphW)|K1)) c= dom ((sn-FanMorphW)|K1) by RELAT_1:44;
  dom ((sn-FanMorphW)|K1) c= dom (proj1*((sn-FanMorphW)|K1))
  proof
    let x be set;
    assume
A18: x in dom ((sn-FanMorphW)|K1);
    then
A19: x in dom (sn-FanMorphW) /\ K1 by FUNCT_1:68;
A20: ((sn-FanMorphW)|K1).x=(sn-FanMorphW).x by A18,FUNCT_1:68;
A21: dom proj1 = (the carrier of TOP-REAL 2) by FUNCT_2:def 1;
    x in dom (sn-FanMorphW) by A19,XBOOLE_0:def 4;
    then (sn-FanMorphW).x in rng (sn-FanMorphW) by FUNCT_1:12;
    hence x in dom (proj1*((sn-FanMorphW)|K1)) by A18,A20,A21,FUNCT_1:21;
  end;
  then
A22: dom (proj1*((sn-FanMorphW)|K1))
  =dom ((sn-FanMorphW)|K1) by A17,XBOOLE_0:def 10
    .=dom (sn-FanMorphW) /\ K1 by FUNCT_1:68
    .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
    .=K1 by XBOOLE_1:28
    .=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
  rng (proj1*((sn-FanMorphW)|K1)) c= the carrier of R^1 by TOPMETR:24;

then reconsider g1=proj1*((sn-FanMorphW)|K1) as Function of (TOP-REAL 2)|K1,R^1
  by A22,FUNCT_2:4;
A23: for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1<=0 & q<>0.REAL 2
  proof
    let q be Point of TOP-REAL 2;
    assume
A24: q in the carrier of (TOP-REAL 2)|K1;
    the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then consider p3 being Point of TOP-REAL 2 such that
A25: q=p3 & (p3`2/|.p3.|>=sn & p3`1<=0 & p3<>0.REAL 2) by A1,A24;
    thus q`1<=0 & q<>0.REAL 2 by A25;
  end;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g2.p=|.p.|* ((p`2/|.p.|-sn)/(1-sn))
  proof
    let p be Point of TOP-REAL 2;
    assume
A26: p in the carrier of (TOP-REAL 2)|K1;
A27: dom ((sn-FanMorphW)|K1)=dom (sn-FanMorphW) /\ K1 by FUNCT_1:68
      .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
      .=K1 by XBOOLE_1:28;
A28: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then consider p3 being Point of TOP-REAL 2 such that
A29: p=p3 & (p3`2/|.p3.|>=sn & p3`1<=0 & p3<>0.REAL 2) by A1,A26;
A30: (sn-FanMorphW).p =|[|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
    |.p.|* ((p`2/|.p.|-sn)/(1-sn))]| by A1,A29,Th25;
    ((sn-FanMorphW)|K1).p=(sn-FanMorphW).p by A26,A28,FUNCT_1:72;
    then g2.p=proj2.(|[|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
    |.p.|* ((p`2/|.p.|-sn)/(1-sn))]|) by A26,A27,A28,A30,FUNCT_1:23
      .=(|[|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
    |.p.|* ((p`2/|.p.|-sn)/(1-sn))]|)`2 by PSCOMP_1:def 29
      .=|.p.|* ((p`2/|.p.|-sn)/(1-sn)) by EUCLID:56;
    hence g2.p=|.p.|* ((p`2/|.p.|-sn)/(1-sn));
  end;
  then consider f2 being Function of (TOP-REAL 2)|K1,R^1 such that
A31: for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds f2.p=|.p.|* ((p`2/|.p.|-sn)/(1-sn));
A32: f2 is continuous by A1,A23,A31,Th26;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g1.p=|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2))
  proof
    let p be Point of TOP-REAL 2;
    assume
A33: p in the carrier of (TOP-REAL 2)|K1;
A34: dom ((sn-FanMorphW)|K1)=dom (sn-FanMorphW) /\ K1 by FUNCT_1:68
      .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
      .=K1 by XBOOLE_1:28;
A35: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then consider p3 being Point of TOP-REAL 2 such that
A36: p=p3 & (p3`2/|.p3.|>=sn & p3`1<=0 & p3<>0.REAL 2) by A1,A33;
A37: (sn-FanMorphW).p=|[|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
    |.p.|* ((p`2/|.p.|-sn)/(1-sn))]| by A1,A36,Th25;
    ((sn-FanMorphW)|K1).p=(sn-FanMorphW).p by A33,A35,FUNCT_1:72;
    then g1.p=proj1.(|[|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
    |.p.|* ((p`2/|.p.|-sn)/(1-sn))]|) by A33,A34,A35,A37,FUNCT_1:23
      .=(|[|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
    |.p.|* ((p`2/|.p.|-sn)/(1-sn)) ]|)`1 by PSCOMP_1:def 28
      .= |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)) by EUCLID:56;
    hence g1.p=|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2));
  end;
  then consider f1 being Function of (TOP-REAL 2)|K1,R^1 such that
A38: for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds f1.p=|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2));
  for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1<=0 & q`2/|.q.|>=sn & q<>0.REAL 2
  proof
    let q be Point of TOP-REAL 2;
    assume
A39: q in the carrier of (TOP-REAL 2)|K1;
    the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then consider p3 being Point of TOP-REAL 2 such that
A40: q=p3 & (p3`2/|.p3.|>=sn & p3`1<=0 & p3<>0.REAL 2) by A1,A39;
    thus thesis by A40;
  end;
  then
A41: f1 is continuous by A1,A38,Th28;
  for x,y,r,s being real number st |[x,y]| in K1 &
  r=f1.(|[x,y]|) & s=f2.(|[x,y]|) holds f.(|[x,y]|)=|[r,s]|
  proof
    let x,y,r,s be real number;
    assume
A42: |[x,y]| in K1 & r=f1.(|[x,y]|) & s=f2.(|[x,y]|);
    set p99=|[x,y]|;
A43: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    consider p3 being Point of TOP-REAL 2 such that
A44: p99=p3 & (p3`2/|.p3.|>=sn & p3`1<=0 & p3<>0.REAL 2) by A1,A42;
A45: f1.p99=|.p99.|*(-sqrt(1-((p99`2/|.p99.|-sn)/(1-sn))^2)) by A38,A42,A43;
    ((sn-FanMorphW)|K0).(|[x,y]|)=((sn-FanMorphW)).(|[x,y]|) by A42,FUNCT_1:72
      .= |[|.p99.|*(-sqrt(1-((p99`2/|.p99.|-sn)/(1-sn))^2)),
    |.p99.|* ((p99`2/|.p99.|-sn)/(1-sn))]| by A1,A44,Th25
      .=|[r,s]| by A31,A42,A43,A45;
    hence f.(|[x,y]|)=|[r,s]| by A1;
  end;
  hence f is continuous by A8,A9,A32,A41,JGRAPH_2:45;
end;

theorem Th31:
  for sn being Real, K0,B0 being Subset of TOP-REAL 2,
  f being Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0 st
  -1<sn & sn<1 & f=(sn-FanMorphW)|K0 &
  B0={q where q is Point of TOP-REAL 2: q`1<=0 & q<>0.REAL 2} &
  K0={p: p`2/|.p.|<=sn & p`1<=0 & p<>0.REAL 2} holds f is continuous
proof
  let sn be Real,K0,B0 be Subset of TOP-REAL 2,
  f be Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0;
  assume
A1: -1<sn & sn<1 & f=(sn-FanMorphW)|K0 &
  B0={q where q is Point of TOP-REAL 2: q`1<=0 & q<>0.REAL 2} &
  K0={p: p`2/|.p.|<=sn & p`1<=0 & p<>0.REAL 2};
  set cn=sqrt(1-sn^2);
  set p0=|[-cn,sn]|;
A2: p0`2=sn by EUCLID:56;
A3: p0`1=-cn by EUCLID:56;
  sn^2<1^2 by A1,SQUARE_1:120;
  then
A4: 1-sn^2>0 by XREAL_1:52;
A5: now
    assume p0=0.REAL 2;
    then --cn=-0 by EUCLID:56,JGRAPH_2:11;
    hence contradiction by A4,SQUARE_1:93;
  end;
  --cn>0 by A4,SQUARE_1:93;
  then
A6: p0`1<0 by A3;
A7: |.p0.|=sqrt((-cn)^2+sn^2) by A2,A3,JGRAPH_3:10
    .=sqrt((cn)^2+sn^2);
  cn^2=1-sn^2 by A4,SQUARE_1:def 4;
  then p0`2/|.p0.|=sn by A7,EUCLID:56,SQUARE_1:83;
  then
A8: p0 in K0 by A1,A5,A6;
  then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
A9: K0 c= B0
  proof
    let x be set;
    assume x in K0;
    then consider p8 being Point of TOP-REAL 2 such that
A10: x=p8 & (p8`2/|.p8.|<=sn & p8`1<=0 & p8<>0.REAL 2) by A1;
    thus x in B0 by A1,A10;
  end;
A11: dom (proj2*((sn-FanMorphW)|K1)) c= dom ((sn-FanMorphW)|K1) by RELAT_1:44;
  dom ((sn-FanMorphW)|K1) c= dom (proj2*((sn-FanMorphW)|K1))
  proof
    let x be set;
    assume
A12: x in dom ((sn-FanMorphW)|K1);
    then
A13: x in dom (sn-FanMorphW) /\ K1 by FUNCT_1:68;
A14: ((sn-FanMorphW)|K1).x=(sn-FanMorphW).x by A12,FUNCT_1:68;
A15: dom proj2 = (the carrier of TOP-REAL 2) by FUNCT_2:def 1;
    x in dom (sn-FanMorphW) by A13,XBOOLE_0:def 4;
    then (sn-FanMorphW).x in rng (sn-FanMorphW) by FUNCT_1:12;
    hence x in dom (proj2*((sn-FanMorphW)|K1)) by A12,A14,A15,FUNCT_1:21;
  end;
  then
A16: dom (proj2*((sn-FanMorphW)|K1))
  =dom ((sn-FanMorphW)|K1) by A11,XBOOLE_0:def 10
    .=dom (sn-FanMorphW) /\ K1 by FUNCT_1:68
    .=(the carrier of TOP-REAL 2)/\ K1 by FUNCT_2:def 1
    .=K1 by XBOOLE_1:28
    .=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
  rng (proj2*((sn-FanMorphW)|K1)) c= the carrier of R^1 by TOPMETR:24;

then reconsider g2=proj2*((sn-FanMorphW)|K1) as Function of (TOP-REAL 2)|K1,R^1
  by A16,FUNCT_2:4;
A17: dom (proj1*((sn-FanMorphW)|K1)) c= dom ((sn-FanMorphW)|K1) by RELAT_1:44;
  dom ((sn-FanMorphW)|K1) c= dom (proj1*((sn-FanMorphW)|K1))
  proof
    let x be set;
    assume
A18: x in dom ((sn-FanMorphW)|K1);
    then
A19: x in dom (sn-FanMorphW) /\ K1 by FUNCT_1:68;
A20: ((sn-FanMorphW)|K1).x=(sn-FanMorphW).x by A18,FUNCT_1:68;
A21: dom proj1 = (the carrier of TOP-REAL 2) by FUNCT_2:def 1;
    x in dom (sn-FanMorphW) by A19,XBOOLE_0:def 4;
    then (sn-FanMorphW).x in rng (sn-FanMorphW) by FUNCT_1:12;
    hence x in dom (proj1*((sn-FanMorphW)|K1)) by A18,A20,A21,FUNCT_1:21;
  end;
  then
A22: dom (proj1*((sn-FanMorphW)|K1))
  =dom ((sn-FanMorphW)|K1) by A17,XBOOLE_0:def 10
    .=dom (sn-FanMorphW) /\ K1 by FUNCT_1:68
    .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
    .=K1 by XBOOLE_1:28
    .=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
  rng (proj1*((sn-FanMorphW)|K1)) c= the carrier of R^1 by TOPMETR:24;

then reconsider g1=proj1*((sn-FanMorphW)|K1) as Function of (TOP-REAL 2)|K1,R^1
  by A22,FUNCT_2:4;
A23: for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1<=0 & q<>0.REAL 2
  proof
    let q be Point of TOP-REAL 2;
    assume
A24: q in the carrier of (TOP-REAL 2)|K1;
    the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then consider p3 being Point of TOP-REAL 2 such that
A25: q=p3 & (p3`2/|.p3.|<=sn & p3`1<=0 & p3<>0.REAL 2) by A1,A24;
    thus q`1<=0 & q<>0.REAL 2 by A25;
  end;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g2.p=|.p.|* ((p`2/|.p.|-sn)/(1+sn))
  proof
    let p be Point of TOP-REAL 2;
    assume
A26: p in the carrier of (TOP-REAL 2)|K1;
A27: dom ((sn-FanMorphW)|K1)=dom (sn-FanMorphW) /\ K1 by FUNCT_1:68
      .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
      .=K1 by XBOOLE_1:28;
A28: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then consider p3 being Point of TOP-REAL 2 such that
A29: p=p3 & (p3`2/|.p3.|<=sn & p3`1<=0 & p3<>0.REAL 2) by A1,A26;
A30: (sn-FanMorphW).p =|[|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
    |.p.|* ((p`2/|.p.|-sn)/(1+sn))]| by A1,A29,Th25;
    ((sn-FanMorphW)|K1).p=(sn-FanMorphW).p by A26,A28,FUNCT_1:72;
    then g2.p=proj2.(|[|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
    |.p.|* ((p`2/|.p.|-sn)/(1+sn))]|) by A26,A27,A28,A30,FUNCT_1:23
      .=(|[|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
    |.p.|* ((p`2/|.p.|-sn)/(1+sn))]|)`2 by PSCOMP_1:def 29
      .=|.p.|* ((p`2/|.p.|-sn)/(1+sn)) by EUCLID:56;
    hence g2.p=|.p.|* ((p`2/|.p.|-sn)/(1+sn));
  end;
  then consider f2 being Function of (TOP-REAL 2)|K1,R^1 such that
A31: for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds f2.p=|.p.|* ((p`2/|.p.|-sn)/(1+sn));
A32: f2 is continuous by A1,A23,A31,Th27;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g1.p=|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2))
  proof
    let p be Point of TOP-REAL 2;
    assume
A33: p in the carrier of (TOP-REAL 2)|K1;
A34: dom ((sn-FanMorphW)|K1)=dom (sn-FanMorphW) /\ K1 by FUNCT_1:68
      .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
      .=K1 by XBOOLE_1:28;
A35: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then consider p3 being Point of TOP-REAL 2 such that
A36: p=p3 & (p3`2/|.p3.|<=sn & p3`1<=0 & p3<>0.REAL 2) by A1,A33;
A37: (sn-FanMorphW).p=|[|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
    |.p.|* ((p`2/|.p.|-sn)/(1+sn))]| by A1,A36,Th25;
    ((sn-FanMorphW)|K1).p=(sn-FanMorphW).p by A33,A35,FUNCT_1:72;
    then g1.p=proj1.(|[|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
    |.p.|* ((p`2/|.p.|-sn)/(1+sn))]|) by A33,A34,A35,A37,FUNCT_1:23
      .=(|[|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
    |.p.|* ((p`2/|.p.|-sn)/(1+sn)) ]|)`1 by PSCOMP_1:def 28
      .= |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)) by EUCLID:56;
    hence g1.p=|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2));
  end;
  then consider f1 being Function of (TOP-REAL 2)|K1,R^1 such that
A38: for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds f1.p=|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2));
  for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1<=0 & q`2/|.q.|<=sn & q<>0.REAL 2
  proof
    let q be Point of TOP-REAL 2;
    assume
A39: q in the carrier of (TOP-REAL 2)|K1;
    the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then consider p3 being Point of TOP-REAL 2 such that
A40: q=p3 & (p3`2/|.p3.|<=sn & p3`1<=0 & p3<>0.REAL 2) by A1,A39;
    thus thesis by A40;
  end;
  then
A41: f1 is continuous by A1,A38,Th29;
  for x,y,r,s being real number st |[x,y]| in K1 &
  r=f1.(|[x,y]|) & s=f2.(|[x,y]|) holds f.(|[x,y]|)=|[r,s]|
  proof
    let x,y,r,s be real number;
    assume
A42: |[x,y]| in K1 & r=f1.(|[x,y]|) & s=f2.(|[x,y]|);
    set p99=|[x,y]|;
A43: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    consider p3 being Point of TOP-REAL 2 such that
A44: p99=p3 & (p3`2/|.p3.|<=sn & p3`1<=0 & p3<>0.REAL 2) by A1,A42;
A45: f1.p99=|.p99.|*(-sqrt(1-((p99`2/|.p99.|-sn)/(1+sn))^2)) by A38,A42,A43;
    ((sn-FanMorphW)|K0).(|[x,y]|)=((sn-FanMorphW)).(|[x,y]|) by A42,FUNCT_1:72
      .= |[|.p99.|*(-sqrt(1-((p99`2/|.p99.|-sn)/(1+sn))^2)),
    |.p99.|* ((p99`2/|.p99.|-sn)/(1+sn))]| by A1,A44,Th25
      .=|[r,s]| by A31,A42,A43,A45;
    hence f.(|[x,y]|)=|[r,s]| by A1;
  end;
  hence f is continuous by A8,A9,A32,A41,JGRAPH_2:45;
end;

Lm7: for sn being Real, K1 being Subset of TOP-REAL 2
st K1={p7 where p7 is Point of TOP-REAL 2:p7`2>=sn*|.p7.|} holds K1 is closed
proof
  let sn be Real, K1 be Subset of TOP-REAL 2;
  defpred P[Point of TOP-REAL 2] means ($1`2>=sn*|.$1.|);
  assume K1={p: p`2>=(sn)*(|.p.|)};
  then
A1: K1={p7 where p7 is Point of TOP-REAL 2:P[p7]};
A2: K1`={p7 where p7 is Point of TOP-REAL 2:not P[p7]} from JGRAPH_2:sch 2(A1);
  set K10=[#]TOP-REAL 2;
  reconsider g1=proj2|K10 as continuous Function
  of (TOP-REAL 2)|K10,R^1 by Lm3;
  reconsider g0=(2 NormF)|K10 as continuous Function of (TOP-REAL 2)|K10,R^1
  by Lm5;
  consider g2 being Function of (TOP-REAL 2)|K10,R^1 such that
A3: (for q being Point of (TOP-REAL 2)|K10,r1 being real number st g0.q=r1
  holds g2.q=sn*r1) & g2 is continuous by JGRAPH_2:33;
  consider g3 being Function of (TOP-REAL 2)|K10,R^1 such that
A4: (for q being Point of
  (TOP-REAL 2)|K10,r1,r2 being real number st g2.q=r1 & g1.q=r2
  holds g3.q=r1-r2) & g3 is continuous by A3,JGRAPH_2:31;
A5: (TOP-REAL 2)|K10=TOP-REAL 2 by TSEP_1:3;
A6: for p being Point of TOP-REAL 2 holds g3.p=sn*|.p.|-p`2
  proof
    let p be Point of TOP-REAL 2;
    g0.p=(2 NormF).p by A5,Lm5
      .=|.p.| by Def1;
    then
A7: g2.p=sn*|.p.| by A3,A5;
    g1.p=proj2.p by A5,Lm3
      .=p`2 by PSCOMP_1:def 29;
    hence g3.p=sn*|.p.|-p`2 by A4,A5,A7;
  end;
  reconsider g=g3 as Function of TOP-REAL 2,R^1 by A5;
A8: {p7 where p7 is Point of TOP-REAL 2: pi(g,p7)>0} c= K1`
  proof
    let x be set;
    assume x in {p7 where p7 is Point of TOP-REAL 2: pi(g,p7)>0};
    then consider p7 being Point of TOP-REAL 2 such that
A9: p7=x & pi(g,p7)>0;
    pi(g,p7)=sn*|.p7.|-p7`2 by A6;
    then sn*|.p7.| - p7`2+p7`2>0+p7`2 by A9,XREAL_1:10;
    hence x in K1` by A2,A9;
  end;
  K1` c= {p7 where p7 is Point of TOP-REAL 2:pi(g,p7)>0}
  proof
    let x be set;
    assume x in K1`;
    then consider p9 being Point of TOP-REAL 2 such that
A10: x=p9 & p9`2<sn*|.p9.| by A2;
A11: sn*|.p9.| - p9`2>0 by A10,XREAL_1:52;
    pi(g,p9)=sn*|.p9.|-p9`2 by A6;
    hence x in {p7 where p7 is Point of TOP-REAL 2: pi(g,p7)>0} by A10,A11;
  end;
  then K1`={p7 where p7 is Point of TOP-REAL 2:pi(g,p7)>0} by A8,
XBOOLE_0:def 10;
  then K1` is open by A4,A5,Th6;
  hence thesis by TOPS_1:29;
end;

Lm8: for sn being Real, K1 being Subset of TOP-REAL 2
st K1={p7 where p7 is Point of TOP-REAL 2:p7`1>=sn*|.p7.|} holds K1 is closed
proof
  let sn be Real, K1 be Subset of TOP-REAL 2;
  defpred P[Point of TOP-REAL 2] means ($1`1>=sn*|.$1.|);
  assume K1={p: p`1>=(sn)*(|.p.|)};
  then
A1: K1={p7 where p7 is Point of TOP-REAL 2:P[p7]};
A2: K1`={p7 where p7 is Point of TOP-REAL 2:not P[p7]} from JGRAPH_2:sch 2(A1);
  set K10=[#](TOP-REAL 2);
  reconsider g1=proj1|K10 as continuous Function
  of (TOP-REAL 2)|K10,R^1 by Lm2;
  reconsider g0=(2 NormF)|K10 as continuous Function of (TOP-REAL 2)|K10,R^1
  by Lm5;
  consider g2 being Function of (TOP-REAL 2)|K10,R^1 such that
A3: (for q being Point of (TOP-REAL 2)|K10,r1 being real number st g0.q=r1
  holds g2.q=sn*r1) & g2 is continuous by JGRAPH_2:33;
  consider g3 being Function of (TOP-REAL 2)|K10,R^1 such that
A4: (for q being Point of
  (TOP-REAL 2)|K10,r1,r2 being real number st g2.q=r1 & g1.q=r2
  holds g3.q=r1-r2) & g3 is continuous by A3,JGRAPH_2:31;
A5: (TOP-REAL 2)|K10=TOP-REAL 2 by TSEP_1:3;
A6: for p being Point of TOP-REAL 2 holds g3.p=sn*|.p.|-p`1
  proof
    let p be Point of TOP-REAL 2;
    g0.p=(2 NormF).p by A5,Lm5
      .=|.p.| by Def1;
    then
A7: g2.p=sn*|.p.| by A3,A5;
    g1.p=proj1.p by A5,Lm2
      .=p`1 by PSCOMP_1:def 28;
    hence g3.p=sn*|.p.|-p`1 by A4,A5,A7;
  end;
  reconsider g=g3 as Function of TOP-REAL 2,R^1 by A5;
A8: {p7 where p7 is Point of TOP-REAL 2: pi(g,p7)>0} c= K1`
  proof
    let x be set;
    assume x in {p7 where p7 is Point of TOP-REAL 2: pi(g,p7)>0};
    then consider p7 being Point of TOP-REAL 2 such that
A9: p7=x & pi(g,p7)>0;
    pi(g,p7)=sn*|.p7.|-p7`1 by A6;
    then sn*|.p7.| - p7`1+p7`1>0+p7`1 by A9,XREAL_1:10;
    hence x in K1` by A2,A9;
  end;
  K1` c= {p7 where p7 is Point of TOP-REAL 2:pi(g,p7)>0}
  proof
    let x be set;
    assume x in K1`;
    then consider p9 being Point of TOP-REAL 2 such that
A10: x=p9 & p9`1<sn*|.p9.| by A2;
A11: sn*|.p9.| - p9`1>0 by A10,XREAL_1:52;
    pi(g,p9)=sn*|.p9.|-p9`1 by A6;
    hence x in {p7 where p7 is Point of TOP-REAL 2: pi(g,p7)>0} by A10,A11;
  end;
  then K1`={p7 where p7 is Point of TOP-REAL 2:pi(g,p7)>0} by A8,
XBOOLE_0:def 10;
  then K1` is open by A4,A5,Th6;
  hence thesis by TOPS_1:29;
end;

theorem Th32:
  for sn being Real, K03 being Subset of TOP-REAL 2
  st K03={p: p`2>=sn*(|.p.|) & p`1<=0} holds K03 is closed
proof
  let sn be Real, K003 be Subset of TOP-REAL 2;
  defpred P[Point of TOP-REAL 2] means ($1`2>=sn*|.$1.|);
  assume
A1: K003={p: p`2>=(sn)*(|.p.|) & p`1<=0};
  reconsider K1={p7 where p7 is Point of TOP-REAL 2:P[p7]}
  as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
A2: K1 is closed by Lm7;
  defpred Q[Point of TOP-REAL 2] means $1`1<=0;
  reconsider KX={p where p is Point of TOP-REAL 2: Q[p]}
  as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
A3: KX is closed by JORDAN6:6;
  {p : P[p] & Q[p]} = {p7 where p7 is Point of TOP-REAL 2:P[p7]} /\
  {p1 where p1 is Point of TOP-REAL 2: Q[p1]} from DOMAIN_1:sch 10;
  hence thesis by A1,A2,A3,TOPS_1:35;
end;

Lm9: for sn being Real, K1 being Subset of TOP-REAL 2
st K1={p7 where p7 is Point of TOP-REAL 2:p7`2<=sn*|.p7.|} holds K1 is closed
proof
  let sn be Real, K1 be Subset of TOP-REAL 2;
  defpred P[Point of TOP-REAL 2] means ($1`2<=sn*|.$1.|);
  assume K1={p: p`2<=(sn)*(|.p.|)};
  then
A1: K1={p7 where p7 is Point of TOP-REAL 2:P[p7]};
A2: K1`={p7 where p7 is Point of TOP-REAL 2:not P[p7]} from JGRAPH_2:sch 2(A1);
  set K10=[#](TOP-REAL 2);
  reconsider g1=proj2|K10 as continuous Function
  of (TOP-REAL 2)|K10,R^1 by Lm3;
  reconsider g0=(2 NormF)|K10 as continuous Function of (TOP-REAL 2)|K10,R^1
  by Lm5;
  consider g2 being Function of (TOP-REAL 2)|K10,R^1 such that
A3: (for q being Point of (TOP-REAL 2)|K10,r1 being real number st g0.q=r1
  holds g2.q=sn*r1) & g2 is continuous by JGRAPH_2:33;
  consider g3 being Function of (TOP-REAL 2)|K10,R^1 such that
A4: (for q being Point of
  (TOP-REAL 2)|K10,r1,r2 being real number st g2.q=r1 & g1.q=r2
  holds g3.q=r1-r2) & g3 is continuous by A3,JGRAPH_2:31;
A5: (TOP-REAL 2)|K10=TOP-REAL 2 by TSEP_1:3;
A6: for p being Point of TOP-REAL 2 holds g3.p=sn*|.p.|-p`2
  proof
    let p be Point of TOP-REAL 2;
    g0.p=(2 NormF).p by A5,Lm5
      .=|.p.| by Def1;
    then
A7: g2.p=sn*|.p.| by A3,A5;
    g1.p=proj2.p by A5,Lm3
      .=p`2 by PSCOMP_1:def 29;
    hence g3.p=sn*|.p.|-p`2 by A4,A5,A7;
  end;
  reconsider g=g3 as Function of TOP-REAL 2,R^1 by A5;
A8: {p7 where p7 is Point of TOP-REAL 2: pi(g,p7)<0} c= K1`
  proof
    let x be set;
    assume x in {p7 where p7 is Point of TOP-REAL 2: pi(g,p7)<0};
    then consider p7 being Point of TOP-REAL 2 such that
A9: p7=x & pi(g,p7)<0;
    pi(g,p7)=sn*|.p7.|-p7`2 by A6;
    then sn*|.p7.| - p7`2+p7`2<0+p7`2 by A9,XREAL_1:10;
    hence x in K1` by A2,A9;
  end;
  K1` c= {p7 where p7 is Point of TOP-REAL 2:pi(g,p7)<0}
  proof
    let x be set;
    assume x in K1`;
    then consider p9 being Point of TOP-REAL 2 such that
A10: x=p9 & p9`2>sn*|.p9.| by A2;
A11: sn*|.p9.| - p9`2<0 by A10,XREAL_1:51;
    pi(g,p9)=sn*|.p9.|-p9`2 by A6;
    hence x in {p7 where p7 is Point of TOP-REAL 2: pi(g,p7)<0} by A10,A11;
  end;
  then K1`={p7 where p7 is Point of TOP-REAL 2:pi(g,p7)<0} by A8,
XBOOLE_0:def 10;
  then K1` is open by A4,A5,Th7;
  hence thesis by TOPS_1:29;
end;

Lm10: for sn being Real, K1 being Subset of TOP-REAL 2
st K1={p7 where p7 is Point of TOP-REAL 2:p7`1<=sn*|.p7.|} holds K1 is closed
proof
  let sn be Real, K1 be Subset of TOP-REAL 2;
  defpred P[Point of TOP-REAL 2] means ($1`1<=sn*|.$1.|);
  assume K1={p: p`1<=(sn)*(|.p.|)};
  then
A1: K1={p7 where p7 is Point of TOP-REAL 2:P[p7]};
A2: K1`={p7 where p7 is Point of TOP-REAL 2:not P[p7]} from JGRAPH_2:sch 2(A1);
  set K10=[#](TOP-REAL 2);
  reconsider g1=proj1|K10 as continuous Function of (TOP-REAL 2)|K10,R^1
  by Lm2;
  reconsider g0=(2 NormF)|K10 as continuous Function of (TOP-REAL 2)|K10,R^1
  by Lm5;
  consider g2 being Function of (TOP-REAL 2)|K10,R^1 such that
A3: (for q being Point of (TOP-REAL 2)|K10,r1 being real number st g0.q=r1
  holds g2.q=sn*r1) & g2 is continuous by JGRAPH_2:33;
  consider g3 being Function of (TOP-REAL 2)|K10,R^1 such that
A4: (for q being Point of
  (TOP-REAL 2)|K10,r1,r2 being real number st g2.q=r1 & g1.q=r2
  holds g3.q=r1-r2) & g3 is continuous by A3,JGRAPH_2:31;
A5: (TOP-REAL 2)|K10=TOP-REAL 2 by TSEP_1:3;
A6: for p being Point of TOP-REAL 2 holds g3.p=sn*|.p.|-p`1
  proof
    let p be Point of TOP-REAL 2;
    g0.p=(2 NormF).p by A5,Lm5
      .=|.p.| by Def1;
    then
A7: g2.p=sn*|.p.| by A3,A5;
    g1.p=proj1.p by A5,Lm2
      .=p`1 by PSCOMP_1:def 28;
    hence g3.p=sn*|.p.|-p`1 by A4,A5,A7;
  end;
  reconsider g=g3 as Function of TOP-REAL 2,R^1 by A5;
A8: {p7 where p7 is Point of TOP-REAL 2: pi(g,p7)<0} c= K1`
  proof
    let x be set;
    assume x in {p7 where p7 is Point of TOP-REAL 2: pi(g,p7)<0};
    then consider p7 being Point of TOP-REAL 2 such that
A9: p7=x & pi(g,p7)<0;
    pi(g,p7)=sn*|.p7.|-p7`1 by A6;
    then sn*|.p7.| - p7`1+p7`1<0+p7`1 by A9,XREAL_1:10;
    hence x in K1` by A2,A9;
  end;
  K1` c= {p7 where p7 is Point of TOP-REAL 2:pi(g,p7)<0}
  proof
    let x be set;
    assume x in K1`;
    then consider p9 being Point of TOP-REAL 2 such that
A10: x=p9 & p9`1>sn*|.p9.| by A2;
A11: sn*|.p9.| - p9`1<0 by A10,XREAL_1:51;
    pi(g,p9)=sn*|.p9.|-p9`1 by A6;
    hence x in {p7 where p7 is Point of TOP-REAL 2: pi(g,p7)<0} by A10,A11;
  end;
  then K1`={p7 where p7 is Point of TOP-REAL 2:pi(g,p7)<0} by A8,
XBOOLE_0:def 10;
  then K1` is open by A4,A5,Th7;
  hence thesis by TOPS_1:29;
end;

theorem Th33:
  for sn being Real, K03 being Subset of TOP-REAL 2
  st K03={p: p`2<=(sn)*(|.p.|) & p`1<=0} holds K03 is closed
proof
  let sn be Real, K003 be Subset of TOP-REAL 2;
  defpred P[Point of TOP-REAL 2] means ($1`2<=sn*|.$1.|);
  defpred Q[Point of TOP-REAL 2] means $1`1<=0;
  assume
A1: K003={p: P[p] & Q[p]};
  reconsider K1={p7 where p7 is Point of TOP-REAL 2:P[p7]}
  as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
A2: K1 is closed by Lm9;
  reconsider KX={p where p is Point of TOP-REAL 2: Q[p]}
  as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
A3: KX is closed by JORDAN6:6;
  {p : P[p] & Q[p]} = {p7 where p7 is Point of TOP-REAL 2:P[p7]} /\
  {p1 where p1 is Point of TOP-REAL 2: Q[p1]} from DOMAIN_1:sch 10;
  hence thesis by A1,A2,A3,TOPS_1:35;
end;

theorem Th34:
  for sn being Real, K0,B0 being Subset of TOP-REAL 2,
  f being Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0 st
  -1<sn & sn<1 & f=(sn-FanMorphW)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} &
  K0={p: p`1<=0 & p<>0.REAL 2} holds f is continuous
proof
  let sn be Real,K0,B0 be Subset of TOP-REAL 2,
  f be Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0;
  assume
A1: -1<sn & sn<1 & f=(sn-FanMorphW)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} & K0={p: p`1<=0 & p<>0.REAL 2};
  set cn=sqrt(1-sn^2);
  set p0=|[-cn,sn]|;
A2: p0`2=sn by EUCLID:56;
A3: p0`1=-cn by EUCLID:56;
  sn^2<1^2 by A1,SQUARE_1:120;
  then
A4: 1-sn^2>0 by XREAL_1:52;
A5: now
    assume p0=0.REAL 2;
    then --cn=-0 by EUCLID:56,JGRAPH_2:11;
    hence contradiction by A4,SQUARE_1:93;
  end;
  --cn>0 by A4,SQUARE_1:93;
  then
A6: p0`1<0 by A3;
A7: |.p0.|=sqrt((-cn)^2+sn^2) by A2,A3,JGRAPH_3:10
    .=sqrt((cn)^2+sn^2);
  cn^2=1-sn^2 by A4,SQUARE_1:def 4;
  then
A8: p0`2/|.p0.|=sn by A7,EUCLID:56,SQUARE_1:83;
  p0 in K0 by A1,A5,A6;
  then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
  p0 in the carrier of TOP-REAL 2 & not p0 in {0.REAL 2} by A5,TARSKI:def 1;
  then reconsider D=B0 as non empty Subset of TOP-REAL 2 by A1,XBOOLE_0:def 5;
A9: p0 in {p: p`2/|.p.|>=sn & p`1<=0 & p<>0.REAL 2} by A5,A6,A8;
  defpred P[Point of TOP-REAL 2] means
  $1`2/|.$1.|>=sn & $1`1<=0 & $1<>0.REAL 2;
A10: {p: P[p]} is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
A11: {p: p`2/|.p.|>=sn & p`1<=0 & p<>0.REAL 2} c= K1
  proof
    let x be set;
    assume x in {p: p`2/|.p.|>=sn & p`1<=0 & p<>0.REAL 2};
    then consider p such that
A12: p=x & p`2/|.p.|>=sn & p`1<=0 & p<>0.REAL 2;
    thus x in K1 by A1,A12;
  end;
  then reconsider K00={p: p`2/|.p.|>=sn & p`1<=0 & p<>0.REAL 2}
  as non empty Subset of ((TOP-REAL 2)|K1) by A9,PRE_TOPC:29;
  reconsider K001={p: p`2/|.p.|>=sn & p`1<=0 & p<>0.REAL 2}
  as non empty Subset of TOP-REAL 2 by A9,A10;
  defpred P[Point of TOP-REAL 2] means $1`2>=(sn)*(|.$1.|) & $1`1<=0;
  {p: P[p]} is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
  then reconsider K003={p: p`2>=(sn)*(|.p.|) & p`1<=0}
  as Subset of TOP-REAL 2;
A13: p0 in {p: p`2/|.p.|<=sn & p`1<=0 & p<>0.REAL 2} by A5,A6,A8;
A14: {p: p`2/|.p.|<=sn & p`1<=0 & p<>0.REAL 2} c= K1
  proof
    let x be set;
    assume x in {p: p`2/|.p.|<=sn & p`1<=0 & p<>0.REAL 2};
    then consider p such that
A15: p=x & p`2/|.p.|<=sn & p`1<=0 & p<>0.REAL 2;
    thus x in K1 by A1,A15;
  end;
  then reconsider K11={p: p`2/|.p.|<=sn & p`1<=0 & p<>0.REAL 2}
  as non empty Subset of ((TOP-REAL 2)|K1) by A13,PRE_TOPC:29;
A16: p0 in {p: p`2/|.p.|<=sn & p`1<=0 & p<>0.REAL 2} by A5,A6,A8;
  defpred P[Point of TOP-REAL 2] means
  $1`2/|.$1.|<=sn & $1`1<=0 & $1<>0.REAL 2;
  {p: P[p]} is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
  then reconsider K111={p: p`2/|.p.|<=sn & p`1<=0 & p<>0.REAL 2}
  as non empty Subset of TOP-REAL 2 by A16;
  defpred P[Point of TOP-REAL 2] means $1`2<=(sn)*(|.$1.|) & $1`1<=0;
  {p: P[p]} is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
  then reconsider K004={p: p`2<=(sn)*(|.p.|) & p`1<=0}
  as Subset of TOP-REAL 2;
  the carrier of (TOP-REAL 2)|B0=the carrier of (TOP-REAL 2)|D;
  then
A17: dom f=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1
    .=K1 by PRE_TOPC:29;
  then
A18: dom (f|K00)=K00 by A11,RELAT_1:91
    .= the carrier of ((TOP-REAL 2)|K1)|K00 by PRE_TOPC:29;
  the carrier of (TOP-REAL 2)|D=D by PRE_TOPC:29;
  then rng (f|K00) c=D;
  then reconsider f1=f|K00 as Function of ((TOP-REAL 2)|K1)|K00,(TOP-REAL 2)|D
  by A18,FUNCT_2:4;
A19: dom f1=the carrier of ((TOP-REAL 2)|K1)|K00 by FUNCT_2:def 1
    .=K00 by PRE_TOPC:29;
A20: dom (sn-FanMorphW)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
  then
A21: dom ((sn-FanMorphW)|K001)=K001 by RELAT_1:91
    .= the carrier of (TOP-REAL 2)|K001 by PRE_TOPC:29;
A22: the carrier of (TOP-REAL 2)|K1 = K1 by PRE_TOPC:29;
  rng ((sn-FanMorphW)|K001) c= K1
  proof
    let y be set;
    assume y in rng ((sn-FanMorphW)|K001);
    then consider x being set such that
A23: x in dom ((sn-FanMorphW)|K001) & y=((sn-FanMorphW)|K001).x
    by FUNCT_1:def 5;
A24: dom ((sn-FanMorphW)|K001)=(dom (sn-FanMorphW))/\ K001 by FUNCT_1:68
      .=(the carrier of TOP-REAL 2)/\ K001 by FUNCT_2:def 1
      .=K001 by XBOOLE_1:28;
    reconsider q=x as Point of TOP-REAL 2 by A23;
A25: y=(sn-FanMorphW).q by A23,FUNCT_1:70;
    consider p2 being Point of TOP-REAL 2 such that
A26: p2=q & p2`2/|.p2.|>=sn & p2`1<=0 & p2<>0.REAL 2 by A23,A24;
A27: sn-FanMorphW.q= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
    |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by A1,A26,Th25;
    set q4= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
    |.q.|* ((q`2/|.q.|-sn)/(1-sn))]|;
    |.q.|<>0 by A26,TOPRNS_1:25;
    then
A28: (|.q.|)^2>0^2 by SQUARE_1:74;
A29: 1-sn>0 by A1,XREAL_1:151;
A30: q4`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))&
    q4`2= |.q.|*((q`2/|.q.|-sn)/(1-sn)) by EUCLID:56;
A31: (q`2/|.q.|-sn)>= 0 by A26,XREAL_1:50;
    0<=(q`1)^2 by XREAL_1:65;
    then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
    then (q`2)^2 <= (|.q.|)^2 by JGRAPH_3:10;
    then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by XREAL_1:74;
    then (q`2)^2/(|.q.|)^2 <= 1 by A28,XCMPLX_1:60;
    then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
    then 1>=q`2/|.q.| by SQUARE_1:121;
    then
A32: 1-sn>=q`2/|.q.|-sn by XREAL_1:11;
A33: -(1-sn)<= -0 by A29;
    -(1-sn)<= -( q`2/|.q.|-sn) by A32,XREAL_1:26;
    then (-(1-sn))/(1-sn)<=(-( q`2/|.q.|-sn))/(1-sn) by A29,XREAL_1:74;
    then
A34: -1<=(-( q`2/|.q.|-sn))/(1-sn) by A29,XCMPLX_1:198;
    --(1-sn)>= -(q`2/|.q.|-sn) by A31,A33,XREAL_1:26;
    then (-(q`2/|.q.|-sn))/(1-sn)<=1 by A29,XREAL_1:187;
    then ((-(q`2/|.q.|-sn))/(1-sn))^2<=1^2 by A34,SQUARE_1:119;
    then
A35: 1-((-(q`2/|.q.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
    then
A36: 1-(-((q`2/|.q.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
    sqrt(1-((-(q`2/|.q.|-sn))/(1-sn))^2)>=0 by A35,SQUARE_1:def 4;
    then sqrt(1-(-(q`2/|.q.|-sn))^2/(1-sn)^2)>=0 by XCMPLX_1:77;
    then sqrt(1-(q`2/|.q.|-sn)^2/(1-sn)^2)>=0;
    then sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)>=0 by XCMPLX_1:77;
    then
A37: -sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)<= -0;
A38: (q4`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))^2 by A30
      .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1-sn))^2) by A36,SQUARE_1:def 4;
    (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
      .=(|.q.|)^2 by A30,A38;
    then q4`1<=0^2 & q4<>0.REAL 2 by A28,A30,A37,TOPRNS_1:24
    ;
    hence y in K1 by A1,A25,A27;
  end;
  then reconsider f3=(sn-FanMorphW)|K001
  as Function of (TOP-REAL 2)|K001,(TOP-REAL 2)|K1 by A21,A22,FUNCT_2:4;
A39: dom (f|K11)=K11 by A14,A17,RELAT_1:91
    .= the carrier of ((TOP-REAL 2)|K1)|K11 by PRE_TOPC:29;
  the carrier of (TOP-REAL 2)|D=D by PRE_TOPC:29;
  then rng (f|K11) c=D;
  then reconsider f2=f|K11 as Function of ((TOP-REAL 2)|K1)|K11,(TOP-REAL 2)|D
  by A39,FUNCT_2:4;
A40: dom f2=the carrier of ((TOP-REAL 2)|K1)|K11 by FUNCT_2:def 1
    .=K11 by PRE_TOPC:29;
A41: dom ((sn-FanMorphW)|K111)=K111 by A20,RELAT_1:91
    .= the carrier of (TOP-REAL 2)|K111 by PRE_TOPC:29;
A42: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
  rng ((sn-FanMorphW)|K111) c= K1
  proof
    let y be set;
    assume y in rng ((sn-FanMorphW)|K111);
    then consider x being set such that
A43: x in dom ((sn-FanMorphW)|K111) & y=((sn-FanMorphW)|K111).x
    by FUNCT_1:def 5;
A44: dom ((sn-FanMorphW)|K111)=(dom (sn-FanMorphW))/\ K111 by FUNCT_1:68
      .=(the carrier of TOP-REAL 2)/\ K111 by FUNCT_2:def 1
      .=K111 by XBOOLE_1:28;
    reconsider q=x as Point of TOP-REAL 2 by A43;
A45: y=(sn-FanMorphW).q by A43,FUNCT_1:70;
    consider p2 being Point of TOP-REAL 2 such that
A46: p2=q & p2`2/|.p2.|<=sn & p2`1<=0 & p2<>0.REAL 2 by A43,A44;
A47: sn-FanMorphW.q= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
    |.q.|* ((q`2/|.q.|-sn)/(1+sn))]| by A1,A46,Th25;
    set q4= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
    |.q.|* ((q`2/|.q.|-sn)/(1+sn))]|;
    |.q.|<>0 by A46,TOPRNS_1:25;
    then
A48: (|.q.|)^2>0^2 by SQUARE_1:74;
A49: 1+sn>0 by A1,XREAL_1:150;
A50: q4`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))&
    q4`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by EUCLID:56;
A51: (q`2/|.q.|-sn)<=0 by A46,XREAL_1:49;
A52: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
    0<=(q`1)^2 by XREAL_1:65;
    then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
    then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A52,XREAL_1:74;
    then (q`2)^2/(|.q.|)^2 <= 1 by A48,XCMPLX_1:60;
    then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
    then -1<=q`2/|.q.| by SQUARE_1:121;
    then
A53: -1-sn<=q`2/|.q.|-sn by XREAL_1:11;
    (1+sn)/(1+sn)>=(q`2/|.q.|-sn)/(1+sn) by A49,A51,XREAL_1:74;
    then
A54: 1>=(q`2/|.q.|-sn)/(1+sn) by A49,XCMPLX_1:60;
    (-(1+sn))/(1+sn)<=(( q`2/|.q.|-sn))/(1+sn) by A49,A53,XREAL_1:74;
    then -1<=(( q`2/|.q.|-sn))/(1+sn) by A49,XCMPLX_1:198;
    then
A55: (((q`2/|.q.|-sn))/(1+sn))^2<=1^2 by A54,SQUARE_1:119;
    then
A56: 1-((q`2/|.q.|-sn)/(1+sn))^2>=0 by XREAL_1:50;
    1-(-((q`2/|.q.|-sn)/(1+sn)))^2>=0 by A55,XREAL_1:50;
    then 1-((-(q`2/|.q.|-sn))/(1+sn))^2>=0 by XCMPLX_1:188;
    then sqrt(1-((-(q`2/|.q.|-sn))/(1+sn))^2)>=0 by SQUARE_1:def 4;
    then sqrt(1-(-(q`2/|.q.|-sn))^2/(1+sn)^2)>=0 by XCMPLX_1:77;
    then sqrt(1-(q`2/|.q.|-sn)^2/(1+sn)^2)>=0;
    then sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)>=0 by XCMPLX_1:77;
    then -sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)<= -0;
    then
A57: q4`1<= 0 by A50;
A58: (q4`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))^2 by A50
      .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1+sn))^2) by A56,SQUARE_1:def 4;
    (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
      .=(|.q.|)^2 by A50,A58;
    then q4<>0.REAL 2 by A48,TOPRNS_1:24;
    hence y in K1 by A1,A45,A47,A57;
  end;
  then reconsider f4=(sn-FanMorphW)|K111
  as Function of (TOP-REAL 2)|K111,(TOP-REAL 2)|K1 by A41,A42,FUNCT_2:4;
  set T1= ((TOP-REAL 2)|K1)|K00,T2=((TOP-REAL 2)|K1)|K11;
A59: [#](((TOP-REAL 2)|K1)|K00)=K00 by PRE_TOPC:def 10;
A60: [#](((TOP-REAL 2)|K1)|K11)=K11 by PRE_TOPC:def 10;
A61: [#]((TOP-REAL 2)|K1)=K1 by PRE_TOPC:def 10;
A62: K1 c= K00 \/ K11
  proof
    let x be set;
    assume x in K1;
    then consider p such that
A63: p=x & (p`1<=0 & p<>0.REAL 2) by A1;
    per cases;
    suppose p`2/|.p.|>=sn;
      then x in K00 by A63;
      hence x in K00 \/ K11 by XBOOLE_0:def 3;
    end;
    suppose p`2/|.p.|<sn;
      then x in K11 by A63;
      hence x in K00 \/ K11 by XBOOLE_0:def 3;
    end;
  end;
  then
A64: [#](((TOP-REAL 2)|K1)|K00) \/ [#](((TOP-REAL 2)|K1)|K11)
  =[#]((TOP-REAL 2)|K1) by A59,A60,A61,XBOOLE_0:def 10;
A65: K003 is closed by Th32;
A66: K003 /\ K1 c= K00
  proof
    let x be set;
    assume x in K003 /\ K1;
    then
A67: x in K003 & x in K1 by XBOOLE_0:def 4;
    then consider q1 being Point of TOP-REAL 2 such that
A68: q1=x & q1`2>=(sn)*(|.q1.|) & q1`1<=0;
    consider q2 being Point of TOP-REAL 2 such that
A69: q2=x & q2`1<=0 & q2<>0.REAL 2 by A1,A67;
    q1`2/|.q1.|>=(sn)*(|.q1.|)/|.q1.| by A68,XREAL_1:74;
    then q1`2/|.q1.|>=(sn) by A68,A69,TOPRNS_1:25,XCMPLX_1:90;
    hence x in K00 by A68,A69;
  end;
  K00 c= K003 /\ K1
  proof
    let x be set;
    assume x in K00;
    then consider p such that
A70: p=x & (p`2/|.p.|>=sn & p`1<=0 & p<>0.REAL 2);
    p`2/|.p.|*|.p.|>=(sn)*(|.p.|) by A70,XREAL_1:66;
    then p`2>=(sn)*(|.p.|) by A70,TOPRNS_1:25,XCMPLX_1:88;
    then
A71: x in K003 by A70;
    x in K1 by A1,A70;
    hence x in K003 /\ K1 by A71,XBOOLE_0:def 4;
  end;
  then K00=K003 /\ [#]((TOP-REAL 2)|K1) by A61,A66,XBOOLE_0:def 10;
  then
A72: K00 is closed by A65,PRE_TOPC:43;
A73: K004 is closed by Th33;
A74: K004 /\ K1 c= K11
  proof
    let x be set;
    assume x in K004 /\ K1;
    then
A75: x in K004 & x in K1 by XBOOLE_0:def 4;
    then consider q1 being Point of TOP-REAL 2 such that
A76: q1=x & q1`2<=(sn)*(|.q1.|) & q1`1<=0;
    consider q2 being Point of TOP-REAL 2 such that
A77: q2=x & q2`1<=0 & q2<>0.REAL 2 by A1,A75;
    q1`2/|.q1.|<=(sn)*(|.q1.|)/|.q1.| by A76,XREAL_1:74;
    then q1`2/|.q1.|<=(sn) by A76,A77,TOPRNS_1:25,XCMPLX_1:90;
    hence x in K11 by A76,A77;
  end;
  K11 c= K004 /\ K1
  proof
    let x be set;
    assume x in K11;
    then consider p such that
A78: p=x & (p`2/|.p.|<=sn & p`1<=0 & p<>0.REAL 2);
    p`2/|.p.|*|.p.|<=(sn)*(|.p.|) by A78,XREAL_1:66;
    then p`2<=(sn)*(|.p.|) by A78,TOPRNS_1:25,XCMPLX_1:88;
    then
A79: x in K004 by A78;
    x in K1 by A1,A78;
    hence x in K004 /\ K1 by A79,XBOOLE_0:def 4;
  end;
  then K11=K004 /\ [#]((TOP-REAL 2)|K1) by A61,A74,XBOOLE_0:def 10;
  then
A80: K11 is closed by A73,PRE_TOPC:43;
A81: ((TOP-REAL 2)|K1)|K00=(TOP-REAL 2)|K001 by GOBOARD9:4;
  K1 c= D
  proof
    let x be set;
    assume x in K1;
    then consider p6 being Point of TOP-REAL 2 such that
A82: p6=x & p6`1<=0 & p6<>0.REAL 2 by A1;
    x in the carrier of TOP-REAL 2 & not x in {0.REAL 2} by A82,TARSKI:def 1;
    hence x in D by A1,XBOOLE_0:def 5;
  end;
  then D=K1 \/ D by XBOOLE_1:12;
  then
A83: (TOP-REAL 2)|K1 is SubSpace of (TOP-REAL 2)|D by TOPMETR:5;
  the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
  then f1= f3 by A1,FUNCT_1:82;
  then
A84: f1 is continuous by A1,A81,A83,Th30,PRE_TOPC:56;
A85: ((TOP-REAL 2)|K1)|K11=(TOP-REAL 2)|K111 by GOBOARD9:4;
  the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
  then f2= f4 by A1,FUNCT_1:82;
  then
A86: f2 is continuous by A1,A83,A85,Th31,PRE_TOPC:56;
A87: D<>{};
  for p being set st p in ([#]T1)/\([#]T2) holds f1.p = f2.p
  proof
    let p be set;
    assume
A89: p in ([#]T1)/\([#]T2);
    then p in K00 & p in K11 by A59,A60,XBOOLE_0:def 4;
    hence f1.p=f.p by FUNCT_1:72
      .=f2.p by A60,A89,FUNCT_1:72;
  end;
  then consider h being Function of (TOP-REAL 2)|K1,(TOP-REAL 2)|D such that
A90: h=f1+*f2 & h is continuous by A59,A60,A64,A72,A80,A84,A86,JGRAPH_2:9;
A91: dom h=the carrier of ((TOP-REAL 2)|K1) by FUNCT_2:def 1;
A92: the carrier of ((TOP-REAL 2)|K1)=K0 by PRE_TOPC:29;
A93: K0=the carrier of ((TOP-REAL 2)|K0) by PRE_TOPC:29
    .=dom f by A87,FUNCT_2:def 1;
  for y being set st y in dom h holds h.y=f.y
  proof
    let y be set;
    assume
A94: y in dom h;
    now per cases by A62,A91,A92,A94,XBOOLE_0:def 3;
      case
A95:    y in K00 & not y in K11;
        then y in dom f1 \/ dom f2 by A19,XBOOLE_0:def 3;
        hence h.y=f1.y by A40,A90,A95,FUNCT_4:def 1
          .=f.y by A95,FUNCT_1:72;
      end;
      case
A96:    y in K11;
        then y in dom f1 \/ dom f2 by A40,XBOOLE_0:def 3;
        hence h.y=f2.y by A40,A90,A96,FUNCT_4:def 1
          .=f.y by A96,FUNCT_1:72;
      end;
    end;
    hence h.y=f.y;
  end;
  hence thesis by A90,A91,A92,A93,FUNCT_1:9;
end;

theorem Th35:
  for sn being Real, K0,B0 being Subset of TOP-REAL 2,
  f being Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0 st
  -1<sn & sn<1 & f=(sn-FanMorphW)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} &
  K0={p: p`1>=0 & p<>0.REAL 2} holds f is continuous
proof
  let sn be Real,K0,B0 be Subset of TOP-REAL 2,
  f be Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0;
  assume
A1: -1<sn & sn<1 & f=(sn-FanMorphW)|K0 &
  B0=(the carrier of TOP-REAL 2)\ {0.REAL 2} & K0={p: p`1>=0 & p<>0.REAL 2};
  set cn=sqrt(1-sn^2);
  set p0=|[cn,-sn]|;
A2: p0`1=cn by EUCLID:56;
  sn^2<1^2 by A1,SQUARE_1:120;
  then
A3: 1-sn^2>0 by XREAL_1:52;
  then
A4: p0<>0.REAL 2 by A2,JGRAPH_2:11,SQUARE_1:93;
  p0`1>0 by A2,A3,SQUARE_1:93;
  then p0 in K0 by A1,JGRAPH_2:11;
  then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
  p0 in the carrier of TOP-REAL 2 & not p0 in {0.REAL 2} by A4,TARSKI:def 1;
  then reconsider D=B0 as non empty Subset of TOP-REAL 2 by A1,XBOOLE_0:def 5;
A5: K1 c= D
  proof
    let x be set;
    assume x in K1;
    then consider p2 being Point of TOP-REAL 2 such that
A6: p2=x & p2`1>=0 & p2<>0.REAL 2 by A1;
    not p2 in {0.REAL 2} by A6,TARSKI:def 1;
    hence x in D by A1,A6,XBOOLE_0:def 5;
  end;
  for p being Point of (TOP-REAL 2)|K1,V being Subset of (TOP-REAL 2)|D
  st f.p in V & V is open holds ex W being Subset of (TOP-REAL 2)|K1 st
  p in W & W is open & f.:W c= V
  proof
    let p be Point of (TOP-REAL 2)|K1,V be Subset of (TOP-REAL 2)|D;
    assume
A7: f.p in V & V is open;
    then consider V2 being Subset of TOP-REAL 2 such that
A8: V2 is open & V2 /\ [#]((TOP-REAL 2)|D)=V by TOPS_2:32;
A9: p in the carrier of (TOP-REAL 2)|K1;
A10: [#]((TOP-REAL 2)|K1)=K1 by PRE_TOPC:def 10;
    reconsider W2=V2 /\ [#]((TOP-REAL 2)|K1) as Subset of (TOP-REAL 2)| K1;
A11: W2 is open by A8,TOPS_2:32;
A12: f.p=(sn-FanMorphW).p by A1,A10,FUNCT_1:72;
    consider q being Point of TOP-REAL 2 such that
A13: q=p & q`1>=0 & q <>0.REAL 2 by A1,A9,A10;
    (sn-FanMorphW).q=q by A13,Th23;
    then p in V2 & p in [#]((TOP-REAL 2)|D) by A7,A8,A12,A13,XBOOLE_0:def 4;
    then
A14: p in W2 by XBOOLE_0:def 4;
    f.:W2 c= V
    proof
      let y be set;
      assume y in f.:W2;
      then consider x being set such that
A15:  x in dom f & x in W2 & y=f.x by FUNCT_1:def 12;
      f is Function of (TOP-REAL 2)|K1, (TOP-REAL 2)|D;
      then dom f= K1 by A10,FUNCT_2:def 1;
      then consider p4 being Point of TOP-REAL 2 such that
A16:  x=p4 & p4`1>=0 & p4<>0.REAL 2 by A1,A15;
A17:  f.p4=(sn-FanMorphW).p4 by A1,A10,A15,A16,FUNCT_1:72
        .=p4 by A16,Th23;
A18:  p4 in V2 & p4 in [#]((TOP-REAL 2)|K1) by A15,A16,XBOOLE_0:def 4;
      then p4 in D by A5,A10;
      then p4 in [#]((TOP-REAL 2)|D) by PRE_TOPC:def 10;
      hence y in V by A8,A15,A16,A17,A18,XBOOLE_0:def 4;
    end;
    hence ex W being Subset of (TOP-REAL 2)|K1 st
    p in W & W is open & f.:W c= V by A11,A14;
  end;
  hence f is continuous by JGRAPH_2:20;
end;

theorem Th36:
  for B0 being Subset of TOP-REAL 2, K0 being Subset of (TOP-REAL 2)|B0 st
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} &
  K0={p: p`1<=0 & p<>0.REAL 2} holds K0 is closed
proof
  defpred P[Point of TOP-REAL 2] means $1`1<=0;
  set I1 = {p: P[p] & p<>0.REAL 2};
  set J0 = (the carrier of TOP-REAL 2) \ {0.REAL 2};
  let B0 be Subset of TOP-REAL 2,K0 be Subset of (TOP-REAL 2)|B0;
  assume
A1: B0=J0 & K0=I1;
  reconsider K1={p7 where p7 is Point of TOP-REAL 2:P[p7]}
  as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
A2: K1 is closed by JORDAN6:6;
  I1 = {p7 where p7 is Point of TOP-REAL 2 : P[p7]} /\ J0 from JGRAPH_3:sch 2;
  then K0=K1 /\ [#]((TOP-REAL 2)|B0) by A1,PRE_TOPC:def 10;
  hence K0 is closed by A2,PRE_TOPC:43;
end;

theorem Th37:
  for sn being Real, B0 being Subset of TOP-REAL 2,
  K0 being Subset of (TOP-REAL 2)|B0,
  f being Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0) st
  -1<sn & sn<1 & f=(sn-FanMorphW)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} &
  K0={p: p`1<=0 & p<>0.REAL 2} holds f is continuous
proof
  let sn be Real,B0 be Subset of TOP-REAL 2,K0 be Subset of
  (TOP-REAL 2)|B0,f be Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0);
  defpred P[Point of TOP-REAL 2] means $1`1<=0 & $1<>0.REAL 2;
  assume
A1: -1<sn & sn<1 & f=(sn-FanMorphW)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} & K0={p: p`1<=0 & p<>0.REAL 2 };
  reconsider K1={p: P[p] } as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
  K0 c= B0
  proof
    let x be set;
    assume x in K0;
    then consider p8 being Point of TOP-REAL 2 such that
A2: x=p8 & (p8`1<=0 & p8<>0.REAL 2) by A1;
    not x in {0.REAL 2} by A2,TARSKI:def 1;
    hence x in B0 by A1,A2,XBOOLE_0:def 5;
  end;
  then ((TOP-REAL 2)|B0)|K0=(TOP-REAL 2)|K1 by A1,PRE_TOPC:28;
  hence f is continuous by A1,Th34;
end;

theorem Th38:
  for B0 being Subset of TOP-REAL 2, K0 being Subset of (TOP-REAL 2)|B0
  st B0=(the carrier of TOP-REAL 2) \ {0.REAL 2}
  & K0={p: p`1>=0 & p<>0.REAL 2} holds K0 is closed
proof
  defpred P[Point of TOP-REAL 2] means $1`1>=0;
  set I1 = {p: P[p] & p<>0.REAL 2};
  set J0 = (the carrier of TOP-REAL 2) \ {0.REAL 2};
  let B0 be Subset of TOP-REAL 2,K0 be Subset of (TOP-REAL 2)|B0;
  assume
A1: B0=J0 & K0=I1;
  reconsider K1={p7 where p7 is Point of TOP-REAL 2:P[p7]}
  as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
A2: K1 is closed by JORDAN6:5;
  I1 = {p7 where p7 is Point of TOP-REAL 2 : P[p7]} /\ J0 from JGRAPH_3:sch 2;
  then K0=K1 /\ [#]((TOP-REAL 2)|B0) by A1,PRE_TOPC:def 10;
  hence K0 is closed by A2,PRE_TOPC:43;
end;

theorem Th39:
  for sn being Real, B0 being Subset of TOP-REAL 2,K0 being Subset of
  (TOP-REAL 2)|B0,f being Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0)
  st -1<sn & sn<1 & f=(sn-FanMorphW)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} & K0={p: p`1>=0 & p<>0.REAL 2}
  holds f is continuous
proof
  let sn be Real, B0 be Subset of TOP-REAL 2,K0 be Subset of
  (TOP-REAL 2)|B0,f be Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0);
  assume
A1: -1<sn & sn<1 & f=(sn-FanMorphW)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} & K0={p: p`1>=0 & p<>0.REAL 2};
  the carrier of (TOP-REAL 2)|B0= B0 by PRE_TOPC:29;
  then reconsider K1=K0 as Subset of TOP-REAL 2 by XBOOLE_1:1;
  K0 c= B0
  proof
    let x be set;
    assume x in K0;
    then consider p8 being Point of TOP-REAL 2 such that
A2: x=p8 & (p8`1>=0 & p8<>0.REAL 2) by A1;
    not x in {0.REAL 2} by A2,TARSKI:def 1;
    hence x in B0 by A1,A2,XBOOLE_0:def 5;
  end;
  then ((TOP-REAL 2)|B0)|K0=(TOP-REAL 2)|K1 by PRE_TOPC:28;
  hence thesis by A1,Th35;
end;

theorem Th40:
  for sn being Real,p being Point of TOP-REAL 2 holds
  |.(sn-FanMorphW).p.|=|.p.|
proof
  let sn be Real,p be Point of TOP-REAL 2;
  set z=(sn-FanMorphW).p;
  reconsider q=p,qz=z as Point of TOP-REAL 2;
  per cases;
  suppose
A1: q`2/|.q.|>=sn & q`1<0;
    then (sn-FanMorphW).q= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
    |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by Th23;
    then
A2: qz`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))&
    qz`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by EUCLID:56;
    |.q.|<>0 by A1,JGRAPH_2:11,TOPRNS_1:25;
    then
A3: (|.q.|)^2>0 by SQUARE_1:74;
A4: (q`2/|.q.|-sn)>=0 by A1,XREAL_1:50;
A5: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
    0<=(q`1)^2 by XREAL_1:65;
    then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
    then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A5,XREAL_1:74;
    then (q`2)^2/(|.q.|)^2 <= 1 by A3,XCMPLX_1:60;
    then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
    then 1>=q`2/|.q.| by SQUARE_1:121;
    then
A6: 1-sn>=q`2/|.q.|-sn by XREAL_1:11;
    per cases;
    suppose
A7:   1-sn=0;
A8:   ((q`2/|.q.|-sn)/(1-sn))=(q`2/|.q.|-sn)*(1-sn)" by XCMPLX_0:def 9
        .= (q`2/|.q.|-sn)*0 by A7
        .=0;
      then -sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)=-1 by SQUARE_1:83;
      then (sn-FanMorphW).q= |[|.q.|*(-1),|.q.|*0]| by A1,A8,Th23
        .=|[-(|.q.|),0]|;
      then ((sn-FanMorphW).q)`1=-(|.q.|) & ((sn-FanMorphW).q)`2=0
      by EUCLID:56;
      then |.(sn-FanMorphW).p.|=sqrt((-(|.q.|))^2+0^2) by JGRAPH_3:10
        .=sqrt((|.q.|)^2)
        .=|.q.| by SQUARE_1:89;
      hence |.(sn-FanMorphW).p.|=|.p.|;
    end;
    suppose
A9:   1-sn<>0;
      per cases by A9;
      suppose
A10:    1-sn>0;
        then
A11:    -(1-sn)<= -0;
        -(1-sn)<= -( q`2/|.q.|-sn) by A6,XREAL_1:26;
        then (-(1-sn))/(1-sn)<=(-( q`2/|.q.|-sn))/(1-sn) by A10,XREAL_1:74;
        then
A12:    -1<=(-( q`2/|.q.|-sn))/(1-sn) by A10,XCMPLX_1:198;
        --(1-sn)>= -(q`2/|.q.|-sn) by A4,A11,XREAL_1:26;
        then (-(q`2/|.q.|-sn))/(1-sn)<=1 by A10,XREAL_1:187;
        then ((-(q`2/|.q.|-sn))/(1-sn))^2<=1^2 by A12,SQUARE_1:119;
        then 1-((-(q`2/|.q.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
        then
A13:    1-(-((q`2/|.q.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
A14:    (qz`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))^2 by A2
          .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1-sn))^2) by A13,SQUARE_1:def 4;
        (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
          .=(|.q.|)^2 by A2,A14;
        then sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
        hence |.(sn-FanMorphW).p.|=|.p.| by SQUARE_1:89;
      end;
      suppose
A15:    1-sn<0;
A16:    q`2/|.q.|-sn>=0 by A1,XREAL_1:50;
        0+(q`2)^2<(q`1)^2+(q`2)^2 by A1,SQUARE_1:74,XREAL_1:10;
        then (q`2)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A3,A5,XREAL_1:76;
        then (q`2)^2/(|.q.|)^2 < 1 by A3,XCMPLX_1:60;
        then ((q`2)/|.q.|)^2 < 1 by XCMPLX_1:77;
        then 1 > q`2/|.p.| by SQUARE_1:122;
        hence |.(sn-FanMorphW).p.|=|.p.| by A15,A16,XREAL_1:11;
      end;
    end;
  end;
  suppose
A17: q`2/|.q.|<sn & q`1<0;
    then
A18: (sn-FanMorphW).q= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
    |.q.|* ((q`2/|.q.|-sn)/(1+sn))]| by Th24;
    then
A19: qz`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))&
    qz`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by EUCLID:56;
    |.q.|<>0 by A17,JGRAPH_2:11,TOPRNS_1:25;
    then
A20: (|.q.|)^2>0 by SQUARE_1:74;
A21: (q`2/|.q.|-sn)<0 by A17,XREAL_1:51;
A22: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
    0<=(q`1)^2 by XREAL_1:65;
    then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
    then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A22,XREAL_1:74;
    then (q`2)^2/(|.q.|)^2 <= 1 by A20,XCMPLX_1:60;
    then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
    then -1<=q`2/|.q.| by SQUARE_1:121;
    then
A23: -1-sn<=q`2/|.q.|-sn by XREAL_1:11;
    per cases;
    suppose
A24:  1+sn=0;
      ((q`2/|.q.|-sn)/(1+sn))=(q`2/|.q.|-sn)*(1+sn)" by XCMPLX_0:def 9
        .= (q`2/|.q.|-sn)*0 by A24
        .=0;
      then ((sn-FanMorphW).q)`1=-(|.q.|) & ((sn-FanMorphW).q)`2=0
      by A18,EUCLID:56,SQUARE_1:83;
      then |.(sn-FanMorphW).p.|=sqrt((-(|.q.|))^2+0^2) by JGRAPH_3:10
        .=sqrt((|.q.|)^2)
        .=|.q.| by SQUARE_1:89;
      hence |.(sn-FanMorphW).p.|=|.p.|;
    end;
    suppose
A25:  1+sn<>0;
      per cases by A25;
      suppose
A26:    1+sn>0;
        then (-(1+sn))/(1+sn)<=(( q`2/|.q.|-sn))/(1+sn) by A23,XREAL_1:74;
        then
A27:    -1<=(( q`2/|.q.|-sn))/(1+sn) by A26,XCMPLX_1:198;
        ((q`2/|.q.|-sn))/(1+sn)<=1 by A21,A26;
        then (((q`2/|.q.|-sn))/(1+sn))^2<=1^2 by A27,SQUARE_1:119;
        then
A28:    1-(((q`2/|.q.|-sn))/(1+sn))^2>=0 by XREAL_1:50;
A29:    (qz`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))^2 by A19
          .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1+sn))^2) by A28,SQUARE_1:def 4;
        (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
          .=(|.q.|)^2 by A19,A29;
        then sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
        hence |.(sn-FanMorphW).p.|=|.p.| by SQUARE_1:89;
      end;
      suppose 1+sn<0;
        then
A30:    -(1+sn)>-0 by XREAL_1:26;
        0+(q`2)^2<(q`1)^2+(q`2)^2 by A17,SQUARE_1:74,XREAL_1:10;
        then (q`2)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A20,A22,XREAL_1:76;
        then (q`2)^2/(|.q.|)^2 < 1 by A20,XCMPLX_1:60;
        then ((q`2)/|.q.|)^2 < 1 by XCMPLX_1:77;
        then -1 < q`2/|.p.| by SQUARE_1:122;
        then q`2/|.q.|-sn>-1-sn by XREAL_1:11;
        hence |.(sn-FanMorphW).p.|=|.p.| by A17,A30,XREAL_1:51;
      end;
    end;
  end;
  suppose q`1>=0;
    hence |.(sn-FanMorphW).p.|=|.p.| by Th23;
  end;
end;

theorem Th41:
  for sn being Real,x,K0 being set st
  -1<sn & sn<1 & x in K0 & K0={p: p`1<=0 & p<>0.REAL 2} holds
  (sn-FanMorphW).x in K0
proof
  let sn be Real,x,K0 be set;
  assume
A1: -1<sn & sn<1 & x in K0 & K0={p: p`1<=0 & p<>0.REAL 2};
  then consider p such that
A2: p=x & p`1<=0 & p<>0.REAL 2;
A3: now
    assume |.p.|<=0;
    then |.p.|=0;
    hence contradiction by A2,TOPRNS_1:25;
  end;
  then
A4: (|.p.|)^2>0 by SQUARE_1:74;
  per cases;
  suppose
A5: p`2/|.p.|<=sn;
    then
A6: (sn-FanMorphW).p= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
    |.p.|*((p`2/|.p.|-sn)/(1+sn))]| by A1,A2,Th25;
    reconsider p9= (sn-FanMorphW).p as Point of TOP-REAL 2;
A7: p9`1=|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)) by A6,EUCLID:56;
A8: 1+sn>0 by A1,XREAL_1:150;
A9: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
    per cases;
    suppose p`1=0;
      hence (sn-FanMorphW).x in K0 by A1,A2,Th23;
    end;
    suppose p`1<>0;
      then 0+(p`2)^2<(p`1)^2+(p`2)^2 by SQUARE_1:74,XREAL_1:10;
      then (p`2)^2/(|.p.|)^2 < (|.p.|)^2/(|.p.|)^2 by A4,A9,XREAL_1:76;
      then (p`2)^2/(|.p.|)^2 < 1 by A4,XCMPLX_1:60;
      then
A10:  ((p`2)/|.p.|)^2 < 1 by XCMPLX_1:77;
      p`2/|.p.|-sn<=0 by A5,XREAL_1:49;
      then
A11:  (p`2/|.p.|-sn)/(1+sn)<(1+sn)/(1+sn) by A8,XREAL_1:76;
      -1 < p`2/|.p.| by A10,SQUARE_1:122;
      then -1-sn< p`2/|.p.|-sn by XREAL_1:11;
      then (-1)*(1+sn)/(1+sn)< (p`2/|.p.|-sn)/(1+sn) by A8,XREAL_1:76;
      then -1< (p`2/|.p.|-sn)/(1+sn) & (p`2/|.p.|-sn)/(1+sn)<1
      by A8,A11,XCMPLX_1:60,90;
      then 1^2> ((p`2/|.p.|-sn)/(1+sn))^2 by SQUARE_1:120;
      then 1-((p`2/|.p.|-sn)/(1+sn))^2>0 by XREAL_1:52;
      then --sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)>0 by SQUARE_1:93;
      then -sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)<0;
      then |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2))<0 by A3,XREAL_1:134;
      hence (sn-FanMorphW).x in K0 by A1,A2,A7,JGRAPH_2:11;
    end;
  end;
  suppose
A12: p`2/|.p.|>sn;
    then
A13: (sn-FanMorphW).p= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
    |.p.|*((p`2/|.p.|-sn)/(1-sn))]| by A1,A2,Th25;
    reconsider p9= (sn-FanMorphW).p as Point of TOP-REAL 2;
A14: p9`1=|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)) by A13,EUCLID:56;
A15: 1-sn>0 by A1,XREAL_1:151;
A16: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
    per cases;
    suppose p`1=0;
      hence (sn-FanMorphW).x in K0 by A1,A2,Th23;
    end;
    suppose p`1<>0;
      then 0+(p`2)^2<(p`1)^2+(p`2)^2 by SQUARE_1:74,XREAL_1:10;
      then (p`2)^2/(|.p.|)^2 < (|.p.|)^2/(|.p.|)^2 by A4,A16,XREAL_1:76;
      then (p`2)^2/(|.p.|)^2 < 1 by A4,XCMPLX_1:60;
      then ((p`2)/|.p.|)^2 < 1 by XCMPLX_1:77;
      then p`2/|.p.|<1 by SQUARE_1:122;
      then (p`2/|.p.|-sn)<1-sn by XREAL_1:11;
      then
A17:  (p`2/|.p.|-sn)/(1-sn)<(1-sn)/(1-sn) by A15,XREAL_1:76;
A18:  -(1-sn)< -0 by A15,XREAL_1:26;
      p`2/|.p.|-sn>=sn-sn by A12,XREAL_1:11;
      then (-1)*(1-sn)/(1-sn)< (p`2/|.p.|-sn)/(1-sn) by A15,A18,XREAL_1:76;
      then -1< (p`2/|.p.|-sn)/(1-sn) & (p`2/|.p.|-sn)/(1-sn)<1
      by A15,A17,XCMPLX_1:60,90;
      then 1^2> ((p`2/|.p.|-sn)/(1-sn))^2 by SQUARE_1:120;
      then 1-((p`2/|.p.|-sn)/(1-sn))^2>0 by XREAL_1:52;
      then --sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)>0 by SQUARE_1:93;
      then -sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)<0;
      then p9`1<0 by A3,A14,XREAL_1:134;
      hence (sn-FanMorphW).x in K0 by A1,A2,JGRAPH_2:11;
    end;
  end;
end;

theorem Th42:
  for sn being Real,x,K0 being set
  st -1<sn & sn<1 & x in K0 & K0={p: p`1>=0 & p<>0.REAL 2}
  holds (sn-FanMorphW).x in K0
proof
  let sn be Real,x,K0 be set;
  assume
A1: -1<sn & sn<1 & x in K0 & K0={p: p`1>=0 & p<>0.REAL 2};
  then consider p such that
A2: p=x & p`1>=0 & p<>0.REAL 2;
  thus (sn-FanMorphW).x in K0 by A1,A2,Th23;
end;

scheme InclSub { D() -> non empty Subset of TOP-REAL 2, P[set] } :
  { p : P[p] & p<>0.REAL 2 } c= the carrier of (TOP-REAL 2)|D()
provided
A1: D() = (the carrier of TOP-REAL 2) \ {0.REAL 2}
proof
  let x be set;
A2: D()` = {0.REAL 2} by A1,JGRAPH_3:30;
  assume x in {p: P[p] & p<>0.REAL 2};
  then consider p such that
A3: x=p & P[p] & p<>0.REAL 2;
  now
    assume not x in D();
    then x in (the carrier of TOP-REAL 2) \ D() by A3,XBOOLE_0:def 5;
    then x in D()` by SUBSET_1:def 5;
    hence contradiction by A2,A3,TARSKI:def 1;
  end;
  hence thesis by PRE_TOPC:29;
end;

theorem Th43:
  for sn being Real, D being non empty Subset of TOP-REAL 2
  st -1<sn & sn<1 & D`={0.REAL 2} holds
  ex h being Function of (TOP-REAL 2)|D,(TOP-REAL 2)|D
  st h=(sn-FanMorphW)|D & h is continuous
proof
  let sn be Real,D be non empty Subset of TOP-REAL 2;
  assume
A1: -1<sn & sn<1 & D`={0.REAL 2};
  reconsider B0= {0.REAL 2} as Subset of TOP-REAL 2;
A2: D =(B0)` by A1
    .=((the carrier of TOP-REAL 2)\ {0.REAL 2}) by SUBSET_1:def 5;
  defpred P[Point of TOP-REAL 2] means $1`1<=0;
A3: {p: P[p] & p<>0.REAL 2} c= the carrier of (TOP-REAL 2)|D from InclSub(A2);
  (|[0,1]|)`1=0 & (|[0,1]|)`2=1 by EUCLID:56;
  then |[0,1]| in {p where p is Point of TOP-REAL 2:
  p`1<=0 & p<>0.REAL 2} by JGRAPH_2:11;
  then reconsider K0={p:p`1<=0 & p<>0.REAL 2}
  as non empty Subset of (TOP-REAL 2)|D by A3;
  defpred P[Point of TOP-REAL 2] means $1`1>=0;
A4: {p: P[p] & p<>0.REAL 2} c= the carrier of (TOP-REAL 2)|D from InclSub(A2);
  set Y1=|[0,1]|;
  Y1`1=0 & Y1`2=1 by EUCLID:56;
  then Y1 in {p where p is Point of TOP-REAL 2:
  p`1>=0 & p<>0.REAL 2} by JGRAPH_2:11;
  then reconsider K1={p: p`1>=0 & p<>0.REAL 2}
  as non empty Subset of (TOP-REAL 2)|D by A4;
A5: the carrier of ((TOP-REAL 2)|D) =D by PRE_TOPC:29;
A6: K0 c= (the carrier of TOP-REAL 2)
  proof
    let z be set;
    assume z in K0;
    then consider p8 being Point of TOP-REAL 2 such that
A7: p8=z & p8`1<=0 & p8<>0.REAL 2;
    thus z in (the carrier of TOP-REAL 2) by A7;
  end;
A8: dom ((sn-FanMorphW)|K0)= dom ((sn-FanMorphW)) /\ K0 by FUNCT_1:68
    .=((the carrier of TOP-REAL 2)) /\ K0 by FUNCT_2:def 1
    .=K0 by A6,XBOOLE_1:28;
A9: K0 =the carrier of ((TOP-REAL 2)|D)|K0 by PRE_TOPC:29;
  rng ((sn-FanMorphW)|K0) c= the carrier of ((TOP-REAL 2)|D)|K0
  proof
    let y be set;
    assume y in rng ((sn-FanMorphW)|K0);
    then consider x being set such that
A10: x in dom ((sn-FanMorphW)|K0) & y=((sn-FanMorphW)|K0).x by FUNCT_1:def 5;
    x in (dom (sn-FanMorphW)) /\ K0 by A10,FUNCT_1:68;
    then
A11: x in K0 by XBOOLE_0:def 4;
    K0 c= the carrier of TOP-REAL 2 by A5,XBOOLE_1:1;
    then reconsider p=x as Point of TOP-REAL 2 by A11;
    (sn-FanMorphW).p=y by A10,A11,FUNCT_1:72;
    then y in K0 by A1,A11,Th41;
    hence y in the carrier of ((TOP-REAL 2)|D)|K0 by PRE_TOPC:29;
  end;
  then reconsider f=(sn-FanMorphW)|K0 as Function of ((TOP-REAL 2)|D)|K0,
  ((TOP-REAL 2)|D) by A8,A9,FUNCT_2:4,XBOOLE_1:1;
A12: K1 c= (the carrier of TOP-REAL 2)
  proof
    let z be set;
    assume z in K1;
    then consider p8 being Point of TOP-REAL 2 such that
A13: p8=z & p8`1>=0 & p8<>0.REAL 2;
    thus z in (the carrier of TOP-REAL 2) by A13;
  end;
A14: dom ((sn-FanMorphW)|K1)= dom ((sn-FanMorphW)) /\ K1 by FUNCT_1:68
    .=((the carrier of TOP-REAL 2)) /\ K1 by FUNCT_2:def 1
    .=K1 by A12,XBOOLE_1:28;
A15: K1=the carrier of ((TOP-REAL 2)|D)|K1 by PRE_TOPC:29;
  rng ((sn-FanMorphW)|K1) c= the carrier of ((TOP-REAL 2)|D)|K1
  proof
    let y be set;
    assume y in rng ((sn-FanMorphW)|K1);
    then consider x being set such that
A16: x in dom ((sn-FanMorphW)|K1) & y=((sn-FanMorphW)|K1).x by FUNCT_1:def 5;
    x in (dom (sn-FanMorphW)) /\ K1 by A16,FUNCT_1:68;
    then
A17: x in K1 by XBOOLE_0:def 4;
    K1 c= the carrier of TOP-REAL 2 by A5,XBOOLE_1:1;
    then reconsider p=x as Point of TOP-REAL 2 by A17;
    (sn-FanMorphW).p=y by A16,A17,FUNCT_1:72;
    then y in K1 by A1,A17,Th42;
    hence y in the carrier of ((TOP-REAL 2)|D)|K1 by PRE_TOPC:29;
  end;
  then reconsider g=(sn-FanMorphW)|K1 as Function of ((TOP-REAL 2)|D)|K1,
  ((TOP-REAL 2)|D) by A14,A15,FUNCT_2:4,XBOOLE_1:1;
A18: K0=[#](((TOP-REAL 2)|D)|K0) by PRE_TOPC:def 10;
A19: K1=[#](((TOP-REAL 2)|D)|K1) by PRE_TOPC:def 10;
A20: D= [#]((TOP-REAL 2)|D) by PRE_TOPC:def 10;
  D c= K0 \/ K1
  proof
    let x be set;
    assume
A21: x in D;
    then
A22: x in (the carrier of TOP-REAL 2) & not x in {0.REAL 2}
    by A2,XBOOLE_0:def 5;
    reconsider px=x as Point of TOP-REAL 2 by A21;
    px`1<=0 & px<>0.REAL 2 or px`1>=0 & px<>0.REAL 2 by A22,TARSKI:def 1;
    then x in K0 or x in K1;
    hence x in K0 \/ K1 by XBOOLE_0:def 3;
  end;
  then
A23: ([#](((TOP-REAL 2)|D)|K0)) \/ ([#](((TOP-REAL 2)|D)|K1))
  = [#]((TOP-REAL 2)|D) by A18,A19,A20,XBOOLE_0:def 10;
A24: f is continuous & K0 is closed by A1,A2,Th36,Th37;
A25: g is continuous & K1 is closed by A1,A2,Th38,Th39;
A26: for x be set st x in ([#]((((TOP-REAL 2)|D)|K0)))
  /\ ([#] ((((TOP-REAL 2)|D)|K1))) holds f.x = g.x
  proof
    let x be set;
    assume
A27: x in ([#]((((TOP-REAL 2)|D)|K0))) /\ ([#] ((((TOP-REAL 2)|D)|K1)));
    then x in K0 & x in K1 by A18,A19,XBOOLE_0:def 4;
    then f.x=(sn-FanMorphW).x by FUNCT_1:72;
    hence f.x = g.x by A19,A27,FUNCT_1:72;
  end;
  then consider h being Function of (TOP-REAL 2)|D,(TOP-REAL 2)|D such that
A28: h= f+*g & h is continuous by A18,A19,A23,A24,A25,JGRAPH_2:9;
A29: dom h=the carrier of ((TOP-REAL 2)|D) by FUNCT_2:def 1;
A30: the carrier of ((TOP-REAL 2)|D)=D by PRE_TOPC:29;
A31: the carrier of ((TOP-REAL 2)|D) =
  ((the carrier of TOP-REAL 2)\ {0.REAL 2}) by A2,PRE_TOPC:29;
  dom (sn-FanMorphW)=(the carrier of (TOP-REAL 2)) by FUNCT_2:def 1;
  then
A32: dom ((sn-FanMorphW)|D)=(the carrier of (TOP-REAL 2))/\ D by FUNCT_1:68
    .=the carrier of ((TOP-REAL 2)|D) by A30,XBOOLE_1:28;
A33: dom f=K0 by A9,FUNCT_2:def 1;
A34: K0=[#](((TOP-REAL 2)|D)|K0) by PRE_TOPC:def 10;
A35: dom g=K1 by A15,FUNCT_2:def 1;
  K1=[#](((TOP-REAL 2)|D)|K1) by PRE_TOPC:def 10;
  then
A36: f tolerates g by A26,A33,A34,A35,PARTFUN1:def 6;
  for x being set st x in dom h holds h.x=((sn-FanMorphW)|D).x
  proof
    let x be set;
    assume
A37: x in dom h;
    then x in (the carrier of TOP-REAL 2) & not x in {0.REAL 2}
    by A31,XBOOLE_0:def 5;
    then
A38: x <>0.REAL 2 by TARSKI:def 1;
    reconsider p=x as Point of TOP-REAL 2 by A31,A37,XBOOLE_0:def 5;
A39: x in D`` by A29,A37,PRE_TOPC:29;
    per cases;
    suppose
A40:  x in K0;
A41:  (sn-FanMorphW)|D.p=(sn-FanMorphW).p by A39,FUNCT_1:72
        .=f.p by A40,FUNCT_1:72;
      h.p=(g+*f).p by A28,A36,FUNCT_4:35
        .=f.p by A33,A40,FUNCT_4:14;
      hence h.x=(sn-FanMorphW)|D.x by A41;
    end;
    suppose not x in K0;
      then not (p`1<=0) by A38;
      then
A42:  x in K1 by A38;
      (sn-FanMorphW)|D.p=(sn-FanMorphW).p by A39,FUNCT_1:72
        .=g.p by A42,FUNCT_1:72;
      hence h.x=(sn-FanMorphW)|D.x by A28,A35,A42,FUNCT_4:14;
    end;
  end;
  then f+*g=(sn-FanMorphW)|D by A28,A29,A32,FUNCT_1:9;
  hence thesis by A18,A19,A23,A24,A25,A26,JGRAPH_2:9;
end;

theorem Th44:
  for sn being Real st -1<sn & sn<1 holds
  ex h being Function of (TOP-REAL 2),(TOP-REAL 2)
  st h=(sn-FanMorphW) & h is continuous
proof
  let sn be Real;
  assume
A1: -1<sn & sn<1;
  reconsider f=(sn-FanMorphW) as Function of (TOP-REAL 2),(TOP-REAL 2);
  reconsider D=(the carrier of TOP-REAL 2) \{0.REAL 2}
  as non empty Subset of TOP-REAL 2 by JGRAPH_2:19;
A2: f.(0.REAL 2)=0.REAL 2 by Th23,JGRAPH_2:11;
A3: D`= {0.REAL 2} by JGRAPH_3:30;
A4: for p being Point of (TOP-REAL 2)|D holds f.p<>f.(0.REAL 2)
  proof
    let p be Point of (TOP-REAL 2)|D;
A5: [#]((TOP-REAL 2)|D)=D by PRE_TOPC:def 10;
    then
A6: p in the carrier of TOP-REAL 2 & not p in {0.REAL 2} by XBOOLE_0:def 5;
    reconsider q=p as Point of TOP-REAL 2 by A5,XBOOLE_0:def 5;
A7: p<>0.REAL 2 by A6,TARSKI:def 1;
    per cases;
    suppose
A8:   q`2/|.q.|>=sn & q`1<=0;
      set q9= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
      |.q.|* ((q`2/|.q.|-sn)/(1-sn))]|;
A9:   q9`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)) &
      q9`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by EUCLID:56;
      now
        assume
A10:    q9=0.REAL 2;
A11:    |.q.|<>0^2 by A7,TOPRNS_1:25;
        then -sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)=-sqrt(1-0) by A9,A10,
JGRAPH_2:11,XCMPLX_1:6
          .=-1 by SQUARE_1:83;
        hence contradiction by A9,A10,A11,JGRAPH_2:11,XCMPLX_1:6;
      end;
      hence f.p<>f.(0.REAL 2) by A1,A2,A7,A8,Th25;
    end;
    suppose
A12:  q`2/|.q.|<sn & q`1<=0;
      set q9=|[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
      |.q.|* ((q`2/|.q.|-sn)/(1+sn))]|;
A13:  q9`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)) &
      q9`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by EUCLID:56;
      now
        assume
A14:    q9=0.REAL 2;
A15:    |.q.|<>0^2 by A7,TOPRNS_1:25;
        then -sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)=-sqrt(1-0) by A13,A14,
JGRAPH_2:11,XCMPLX_1:6
          .=-1 by SQUARE_1:83;
        hence contradiction by A13,A14,A15,JGRAPH_2:11,XCMPLX_1:6;
      end;
      hence f.p<>f.(0.REAL 2) by A1,A2,A7,A12,Th25;
    end;
    suppose q`1>0;
      then f.p=p by Th23;
      hence f.p<>f.(0.REAL 2) by A7,Th23,JGRAPH_2:11;
    end;
  end;
A16: ex h being Function of (TOP-REAL 2)|D,(TOP-REAL 2)|D
  st h=(sn-FanMorphW)|D & h is continuous by A1,A3,Th43;
  for V being Subset of (TOP-REAL 2) st f.(0.REAL 2) in V & V is open
  ex W being Subset of (TOP-REAL 2) st 0.REAL 2 in W & W is open & f.:W c= V
  proof
    let V be Subset of TOP-REAL 2;
    assume
A17: f.(0.REAL 2) in V & V is open;
    reconsider u0=0.REAL 2 as Point of Euclid 2;
    consider r being real number such that
A18: r>0 & Ball(u0,r) c= V by A2,A17,TOPMETR:22;
    reconsider r as Real by XREAL_0:def 1;
    reconsider W1=Ball(u0,r) as Subset of TOP-REAL 2;
A19: u0 in W1 by A18,GOBOARD6:4;
A20: W1 is open by GOBOARD6:6;
    f.:W1 c= W1
    proof
      let z be set;
      assume z in f.:W1;
      then consider y being set such that
A21:  y in dom f & y in W1 & z=f.y by FUNCT_1:def 12;
      reconsider q=y as Point of TOP-REAL 2 by A21;
      reconsider qy=q as Point of Euclid 2;
      z in rng f by A21,FUNCT_1:def 5;
      then reconsider qz=z as Point of TOP-REAL 2;
      reconsider pz=qz as Point of Euclid 2;
      dist(u0,qy)<r by A21,METRIC_1:12;
      then
A22:  |.(0.REAL 2) - q.|<r by JGRAPH_1:45;
      per cases by JGRAPH_2:11;
      suppose q`1>=0;
        hence z in W1 by A21,Th23;
      end;
      suppose
A23:    q<>0.REAL 2 & (q`2/|.q.|>=sn & q`1<=0);
        then
A24:    (sn-FanMorphW).q= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn) )^2)),
        |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by A1,Th25;
        |.q.|<>0 by A23,TOPRNS_1:25;
        then
A25:    (|.q.|)^2>0 by SQUARE_1:74;
A26:    1-sn>0 by A1,XREAL_1:151;
A27:    qz`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))&
        qz`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by A21,A24,EUCLID:56;
A28:    (q`2/|.q.|-sn)>= 0 by A23,XREAL_1:50;
A29:    (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        0<=(q`1)^2 by XREAL_1:65;
        then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A29,XREAL_1:74;
        then (q`2)^2/(|.q.|)^2 <= 1 by A25,XCMPLX_1:60;
        then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then 1>=q`2/|.q.| by SQUARE_1:121;
        then
A30:    1-sn>=q`2/|.q.|-sn by XREAL_1:11;
A31:    -(1-sn)<= -0 by A26;
        -(1-sn)<= -( q`2/|.q.|-sn) by A30,XREAL_1:26;
        then (-(1-sn))/(1-sn)<=(-( q`2/|.q.|-sn))/(1-sn) by A26,XREAL_1:74;
        then
A32:    -1<=(-( q`2/|.q.|-sn))/(1-sn) by A26,XCMPLX_1:198;
        --(1-sn)>= -(q`2/|.q.|-sn) by A28,A31,XREAL_1:26;
        then (-(q`2/|.q.|-sn))/(1-sn)<=1 by A26,XREAL_1:187;
        then ((-(q`2/|.q.|-sn))/(1-sn))^2<=1^2 by A32,SQUARE_1:119;
        then 1-((-(q`2/|.q.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
        then
A33:    1-(-((q`2/|.q.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
A34:    (qz`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))^2 by A27
          .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1-sn))^2) by A33,SQUARE_1:def 4;
        (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
          .=(|.q.|)^2 by A27,A34;
        then sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
        then
A35:    |.qz.|=|.q.| by SQUARE_1:89;
        |.(0.REAL 2) +- q.|<r by A22,EUCLID:45;
        then |.- q.|<r by EUCLID:31;
        then |.q.|<r by TOPRNS_1:27;
        then |.- qz.|<r by A35,TOPRNS_1:27;
        then |.(0.REAL 2) +- qz.|<r by EUCLID:31;
        then |.(0.REAL 2) - qz.|<r by EUCLID:45;
        then dist(u0,pz)<r by JGRAPH_1:45;
        hence z in W1 by METRIC_1:12;
      end;
      suppose
A36:    q<>0.REAL 2 & q`2/|.q.|<sn & q`1<=0;
        then
A37:    (sn-FanMorphW).q= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn) )^2)),
        |.q.|* ((q`2/|.q.|-sn)/(1+sn))]| by A1,Th25;
        |.q.|<>0 by A36,TOPRNS_1:25;
        then
A38:    (|.q.|)^2>0 by SQUARE_1:74;
A39:    (sn-q`2/|.q.|)>=0 by A36,XREAL_1:50;
A40:    (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
A41:    1+sn>0 by A1,XREAL_1:150;
A42:    qz`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))&
        qz`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by A21,A37,EUCLID:56;
        0<=(q`1)^2 by XREAL_1:65;
        then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A40,XREAL_1:74;
        then (q`2)^2/(|.q.|)^2 <= 1 by A38,XCMPLX_1:60;
        then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then -1<=q`2/|.q.| by SQUARE_1:121;
        then --1>=-q`2/|.q.| by XREAL_1:26;
        then
A43:    1+sn>=-q`2/|.q.|+sn by XREAL_1:9;
        (-(1+sn))/(1+sn)<=(-( q`2/|.q.|-sn))/(1+sn) by A39,A41,XREAL_1:74;
        then
A44:    -1<=(-( q`2/|.q.|-sn))/(1+sn) by A41,XCMPLX_1:198;
        (-(q`2/|.q.|-sn))/(1+sn)<=1 by A41,A43,XREAL_1:187;
        then ((-(q`2/|.q.|-sn))/(1+sn))^2<=1^2 by A44,SQUARE_1:119;
        then 1-((-(q`2/|.q.|-sn))/(1+sn))^2>=0 by XREAL_1:50;
        then
A45:    1-(-((q`2/|.q.|-sn))/(1+sn))^2>=0 by XCMPLX_1:188;
A46:    (qz`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))^2 by A42
          .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1+sn))^2) by A45,SQUARE_1:def 4;
        (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
          .=(|.q.|)^2 by A42,A46;
        then sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
        then
A47:    |.qz.|=|.q.| by SQUARE_1:89;
        |.(0.REAL 2) +- q.|<r by A22,EUCLID:45;
        then |.- q.|<r by EUCLID:31;
        then |.q.|<r by TOPRNS_1:27;
        then |.- qz.|<r by A47,TOPRNS_1:27;
        then |.(0.REAL 2) +- qz.|<r by EUCLID:31;
        then |.(0.REAL 2) - qz.|<r by EUCLID:45;
        then dist(u0,pz)<r by JGRAPH_1:45;
        hence z in W1 by METRIC_1:12;
      end;
    end;
    hence ex W being Subset of (TOP-REAL 2) st 0.REAL 2 in W
    & W is open & f.:W c= V by A18,A19,A20,XBOOLE_1:1;
  end;
  then f is continuous by A2,A3,A4,A16,JGRAPH_3:13;
  hence thesis;
end;

theorem Th45:
  for sn being Real st -1<sn & sn<1 holds sn-FanMorphW is one-to-one
proof
  let sn be Real;
  assume
A1: -1<sn & sn<1;
  for x1,x2 being set st x1 in dom (sn-FanMorphW) & x2 in dom (sn-FanMorphW)
  & (sn-FanMorphW).x1=(sn-FanMorphW).x2 holds x1=x2
  proof
    let x1,x2 be set;
    assume
A2: x1 in dom (sn-FanMorphW) & x2 in dom (sn-FanMorphW)
    & (sn-FanMorphW).x1=(sn-FanMorphW).x2;
    then reconsider p1=x1 as Point of TOP-REAL 2;
    reconsider p2=x2 as Point of TOP-REAL 2 by A2;
    set q=p1,p=p2;
A3: 1-sn>0 by A1,XREAL_1:151;
    now per cases by JGRAPH_2:11;
      case
A4:     q`1>=0;
        then
A5:     (sn-FanMorphW).q=q by Th23;
        now per cases by JGRAPH_2:11;
          case p`1>=0;
            hence x1=x2 by A2,A5,Th23;
          end;
          case
A6:         p<>0.REAL 2 & (p`2/|.p.|>=sn & p`1<=0);
            then
A7:         sn -FanMorphW.p= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
            |.p.|* ((p`2/|.p.|-sn)/(1-sn))]| by A1,Th25;
            set p4= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
            |.p.|* ((p`2/|.p.|-sn)/(1-sn))]|;
A8:         p4`1= |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)) &
            p4`2= |.p.|* ((p`2/|.p.|-sn)/(1-sn)) by EUCLID:56;
A9:         |.p.|>0 by A6,Lm1;
            then
A10:        (|.p.|)^2>0 by SQUARE_1:74;
A11:        (p`2/|.p.|-sn)>=0 by A6,XREAL_1:50;
A12:        (p`2/|.p.|-sn)>= 0 by A6,XREAL_1:50;
A13:        (p`2/|.p.|-sn)/(1-sn)>=0 by A3,A11;
A14:        (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
            0<=(p`1)^2 by XREAL_1:65;
            then 0+(p`2)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
            then (p`2)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2
             by A14,XREAL_1:74;
            then (p`2)^2/(|.p.|)^2 <= 1 by A10,XCMPLX_1:60;
            then ((p`2)/|.p.|)^2 <= 1 by XCMPLX_1:77;
            then 1>=p`2/|.p.| by SQUARE_1:121;
            then
A15:        1-sn>=p`2/|.p.|-sn by XREAL_1:11;
A16:        -(1-sn)<= -0 by A3;
            -(1-sn)<= -( p`2/|.p.|-sn) by A15,XREAL_1:26;
            then (-(1-sn))/(1-sn)<=(-( p`2/|.p.|-sn))/(1-sn)
             by A3,XREAL_1:74;
            then
A17:        -1<=(-( p`2/|.p.|-sn))/(1-sn) by A3,XCMPLX_1:198;
            --(1-sn)>= -(p`2/|.p.|-sn) by A12,A16,XREAL_1:26;
            then (-(p`2/|.p.|-sn))/(1-sn)<=1 by A3,XREAL_1:187;
            then ((-(p`2/|.p.|-sn))/(1-sn))^2<=1^2 by A17,SQUARE_1:119;
            then
A18:        1-((-(p`2/|.p.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
            then
A19:        1-(-((p`2/|.p.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
            sqrt(1-((-(p`2/|.p.|-sn))/(1-sn))^2)>=0 by A18,SQUARE_1:def 4;
            then sqrt(1-(-(p`2/|.p.|-sn))^2/(1-sn)^2)>=0 by XCMPLX_1:77;
            then sqrt(1-(p`2/|.p.|-sn)^2/(1-sn)^2)>=0;
            then sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)>=0 by XCMPLX_1:77;
            then -sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)<= -0;
            then q`1=0 by A2,A4,A5,A7,A8;
            then (-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2))=0 by A2,A5,A7,A8,A9,
XCMPLX_1:6;
            then 1-((p`2/|.p.|-sn)/(1-sn))^2=0 by A19,SQUARE_1:92;
            then 1= (p`2/|.p.|-sn)/(1-sn) by A13,SQUARE_1:83,89;
            then 1 *(1-sn)=(p`2/|.p.|-sn) by A3,XCMPLX_1:88;
            then 1 *|.p.|=p`2 by A9,XCMPLX_1:88;
            then p`1=0 by A14,XCMPLX_1:6;
            hence x1=x2 by A2,A5,Th23;
          end;
          case
A20:        p<>0.REAL 2 & (p`2/|.p.|<sn & p`1<=0);
            then
A21:        sn -FanMorphW.p= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
            |.p.|* ((p`2/|.p.|-sn)/(1+sn))]| by A1,Th25;
            set p4= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
            |.p.|* ((p`2/|.p.|-sn)/(1+sn))]|;
A22:        p4`1= |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)) &
            p4`2= |.p.|* ((p`2/|.p.|-sn)/(1+sn)) by EUCLID:56;
A23:        |.p.|>0 by A20,Lm1;
            then
A24:        (|.p.|)^2>0 by SQUARE_1:74;
A25:        1+sn>0 by A1,XREAL_1:150;
A26:        (p`2/|.p.|-sn)<=0 by A20,XREAL_1:49;
            then
A27:        -(p`2/|.p.|-sn)>= -0;
            --(p`2/|.p.|-sn)/(1+sn)<=0 by A25,A26;
            then
A28:        -((p`2/|.p.|-sn)/(1+sn))>=0;
A29:        (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
            0<=(p`1)^2 by XREAL_1:65;
            then 0+(p`2)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
            then (p`2)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2
             by A29,XREAL_1:74;
            then (p`2)^2/(|.p.|)^2 <= 1 by A24,XCMPLX_1:60;
            then ((p`2)/|.p.|)^2 <= 1 by XCMPLX_1:77;
            then
A30:        (-((p`2)/|.p.|))^2 <= 1;
            (-(1+sn))/(1+sn)<=(-( p`2/|.p.|-sn))/(1+sn)
            by A25,A27,XREAL_1:74;
            then
A31:        -1<=(-( p`2/|.p.|-sn))/(1+sn) by A25,XCMPLX_1:198;
            1>= -p`2/|.p.| by A30,SQUARE_1:121;
            then (1+sn)>= -p`2/|.p.|+sn by XREAL_1:9;
            then (-(p`2/|.p.|-sn))/(1+sn)<=1 by A25,XREAL_1:187;
            then ((-(p`2/|.p.|-sn))/(1+sn))^2<=1^2 by A31,SQUARE_1:119;
            then
A32:        1-((-(p`2/|.p.|-sn))/(1+sn))^2>=0 by XREAL_1:50;
            then
A33:        1-(-((p`2/|.p.|-sn))/(1+sn))^2>=0 by XCMPLX_1:188;
            sqrt(1-((-(p`2/|.p.|-sn))/(1+sn))^2)>=0 by A32,SQUARE_1:def 4;
            then sqrt(1-(-(p`2/|.p.|-sn))^2/(1+sn)^2)>=0 by XCMPLX_1:77;
            then sqrt(1-((p`2/|.p.|-sn))^2/(1+sn)^2)>=0;
            then sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)>=0 by XCMPLX_1:77;
            then -sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)<= -0;
            then q`1=0 by A2,A4,A5,A21,A22;
            then (-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2))=0 by A2,A5,A21,A22,A23,
XCMPLX_1:6;
            then 1-((p`2/|.p.|-sn)/(1+sn))^2=0 by A33,SQUARE_1:92;
            then 1=sqrt((-((p`2/|.p.|-sn)/(1+sn)))^2) by SQUARE_1:83;
            then 1= -((p`2/|.p.|-sn)/(1+sn)) by A28,SQUARE_1:89;
            then 1= ((-(p`2/|.p.|-sn))/(1+sn)) by XCMPLX_1:188;
            then 1 *(1+sn)=-(p`2/|.p.|-sn) by A25,XCMPLX_1:88;
            then 1+sn-sn=-p`2/|.p.|;
            then 1=(-p`2)/|.p.| by XCMPLX_1:188;
            then 1 *|.p.|=-p`2 by A23,XCMPLX_1:88;
            then (p`2)^2-(p`2)^2 =(p`1)^2 by A29,XCMPLX_1:26;
            then p`1=0 by XCMPLX_1:6;
            hence x1=x2 by A2,A5,Th23;
          end;
        end;
        hence x1=x2;
      end;
      case
A34:    q`2/|.q.|>=sn & q`1<=0 & q<>0.REAL 2;
        then
A35:    sn-FanMorphW.q= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn)) ^2)),
        |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by A1,Th25;
        set q4= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
        |.q.|* ((q`2/|.q.|-sn)/(1-sn))]|;
A36:    q4`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)) &
        q4`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by EUCLID:56;
        |.q.|>0 by A34,Lm1;
        then
A37:    (|.q.|)^2>0 by SQUARE_1:74;
        now per cases by JGRAPH_2:11;
          case
A38:        p`1>=0;
            then
A39:        (sn-FanMorphW).p=p by Th23;
A40:        |.q.|>0 by A34,Lm1;
            then
A41:        (|.q.|)^2>0 by SQUARE_1:74;
A42:        1-sn>0 by A1,XREAL_1:151;
A43:        (q`2/|.q.|-sn)>=0 by A34,XREAL_1:50;
A44:        (q`2/|.q.|-sn)>= 0 by A34,XREAL_1:50;
A45:        (q`2/|.q.|-sn)/(1-sn)>=0 by A42,A43;
A46:        (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
            0<=(q`1)^2 by XREAL_1:65;
            then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
            then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2
             by A46,XREAL_1:74;
            then (q`2)^2/(|.q.|)^2 <= 1 by A41,XCMPLX_1:60;
            then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
            then 1>=q`2/|.q.| by SQUARE_1:121;
            then
A47:        1-sn>=q`2/|.q.|-sn by XREAL_1:11;
A48:        -(1-sn)<= -0 by A42;
            -(1-sn)<= -( q`2/|.q.|-sn) by A47,XREAL_1:26;
            then (-(1-sn))/(1-sn)<=(-( q`2/|.q.|-sn))/(1-sn)
             by A42,XREAL_1:74;
            then
A49:        -1<=(-( q`2/|.q.|-sn))/(1-sn) by A42,XCMPLX_1:198;
            --(1-sn)>= -(q`2/|.q.|-sn) by A44,A48,XREAL_1:26;
            then (-(q`2/|.q.|-sn))/(1-sn)<=1 by A42,XREAL_1:187;
            then ((-(q`2/|.q.|-sn))/(1-sn))^2<=1^2 by A49,SQUARE_1:119;
            then
A50:        1-((-(q`2/|.q.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
            then
A51:        1-(-((q`2/|.q.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
            sqrt(1-((-(q`2/|.q.|-sn))/(1-sn))^2)>=0 by A50,SQUARE_1:def 4;
            then sqrt(1-(-(q`2/|.q.|-sn))^2/(1-sn)^2)>=0 by XCMPLX_1:77;
            then sqrt(1-(q`2/|.q.|-sn)^2/(1-sn)^2)>=0;
            then sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)>=0 by XCMPLX_1:77;
            then -sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)<= -0;
            then p`1=0 by A2,A35,A36,A38,A39;
            then (-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))=0 by A2,A35,A36,A39,A40,
XCMPLX_1:6;
            then 1-((q`2/|.q.|-sn)/(1-sn))^2=0 by A51,SQUARE_1:92;
            then 1= (q`2/|.q.|-sn)/(1-sn) by A45,SQUARE_1:83,89;
            then 1 *(1-sn)=(q`2/|.q.|-sn) by A42,XCMPLX_1:88;
            then 1 *|.q.|=q`2 by A40,XCMPLX_1:88;
            then q`1=0 by A46,XCMPLX_1:6;
            hence x1=x2 by A2,A39,Th23;
          end;
          case
A52:        p<>0.REAL 2 & (p`2/|.p.|>=sn & p`1<=0);
            then
A53:        sn-FanMorphW.p= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/ (1-sn))^2)),
            |.p.|* ((p`2/|.p.|-sn)/(1-sn))]| by A1,Th25;
            set p4 = |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
            |.p.|* ((p`2/|.p.|-sn)/(1-sn))]|;
A54:        p4`1= |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)) &
            p4`2= |.p.|* ((p`2/|.p.|-sn)/(1-sn)) by EUCLID:56;
A55:        q4`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))&
            q4`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by EUCLID:56;
A56:        (q`2/|.q.|-sn)>= 0 by A34,XREAL_1:50;
A57:        (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
            0<=(q`1)^2 by XREAL_1:65;
            then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
            then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2
             by A57,XREAL_1:74;
            then (q`2)^2/(|.q.|)^2 <= 1 by A37,XCMPLX_1:60;
            then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
            then 1>=q`2/|.q.| by SQUARE_1:121;
            then
A58:        1-sn>=q`2/|.q.|-sn by XREAL_1:11;
A59:        -(1-sn)<= -0 by A3;
            -(1-sn)<= -( q`2/|.q.|-sn) by A58,XREAL_1:26;
            then (-(1-sn))/(1-sn)<=(-( q`2/|.q.|-sn))/(1-sn)
             by A3,XREAL_1:74;
            then
A60:        -1<=(-( q`2/|.q.|-sn))/(1-sn) by A3,XCMPLX_1:198;
            --(1-sn)>= -(q`2/|.q.|-sn) by A56,A59,XREAL_1:26;
            then (-(q`2/|.q.|-sn))/(1-sn)<=1 by A3,XREAL_1:187;
            then ((-(q`2/|.q.|-sn))/(1-sn))^2<=1^2 by A60,SQUARE_1:119;
            then 1-((-(q`2/|.q.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
            then
A61:        1-(-((q`2/|.q.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
A62:        (q4`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))^2 by A55
              .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1-sn))^2) by A61,SQUARE_1:def 4;
            (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
              .=(|.q.|)^2 by A55,A62;
            then sqrt((|.q4.|)^2)=|.q.| by SQUARE_1:89;
            then
A63:        |.q4.|=|.q.| by SQUARE_1:89;
A64:        |.p.|>0 by A52,Lm1;
            then
A65:        (|.p.|)^2>0 by SQUARE_1:74;
A66:        (p`2/|.p.|-sn)>= 0 by A52,XREAL_1:50;
A67:        (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
            0<=(p`1)^2 by XREAL_1:65;
            then 0+(p`2)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
            then (p`2)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2
             by A67,XREAL_1:74;
            then (p`2)^2/(|.p.|)^2 <= 1 by A65,XCMPLX_1:60;
            then ((p`2)/|.p.|)^2 <= 1 by XCMPLX_1:77;
            then 1>=p`2/|.p.| by SQUARE_1:121;
            then
A68:        1-sn>=p`2/|.p.|-sn by XREAL_1:11;
A69:        -(1-sn)<= -0 by A3;
            -(1-sn)<= -( p`2/|.p.|-sn) by A68,XREAL_1:26;
            then (-(1-sn))/(1-sn)<=(-( p`2/|.p.|-sn))/(1-sn)
             by A3,XREAL_1:74;
            then
A70:        -1<=(-( p`2/|.p.|-sn))/(1-sn) by A3,XCMPLX_1:198;
            --(1-sn)>= -(p`2/|.p.|-sn) by A66,A69,XREAL_1:26;
            then (-(p`2/|.p.|-sn))/(1-sn)<=1 by A3,XREAL_1:187;
            then ((-(p`2/|.p.|-sn))/(1-sn))^2<=1^2 by A70,SQUARE_1:119;
            then 1-((-(p`2/|.p.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
            then
A71:        1-(-((p`2/|.p.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
A72:        (p4`1)^2= (|.p.|)^2*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2))^2 by A54
              .= (|.p.|)^2*(1-((p`2/|.p.|-sn)/(1-sn))^2) by A71,SQUARE_1:def 4;
            (|.p4.|)^2=(p4`1)^2+(p4`2)^2 by JGRAPH_3:10
              .=(|.p.|)^2 by A54,A72;
            then sqrt((|.p4.|)^2)=|.p.| by SQUARE_1:89;
            then
A73:        |.p4.|=|.p.| by SQUARE_1:89;
            ((p`2/|.p.|-sn)/(1-sn)) =|.q.|* ((q`2/|.q.|-sn)/(1-sn))/|.p.|
            by A2,A35,A36,A53,A54,A64,XCMPLX_1:90;
            then (p`2/|.p.|-sn)/(1-sn)=(q`2/|.q.|-sn)/(1-sn)
            by A2,A35,A53,A63,A64,A73,XCMPLX_1:90;
            then (p`2/|.p.|-sn)/(1-sn)*(1-sn)=q`2/|.q.|-sn by A3,XCMPLX_1:88;
            then p`2/|.p.|-sn=q`2/|.q.|-sn by A3,XCMPLX_1:88;
            then p`2/|.p.|*|.p.|=q`2 by A2,A35,A53,A63,A64,A73,XCMPLX_1:88;
            then
A74:        p`2=q`2 by A64,XCMPLX_1:88;
A75:        |.p.|^2=(p`1)^2+(p`2)^2 by JGRAPH_3:10;
            |.q.|^2=(q`1)^2+(q`2)^2 by JGRAPH_3:10;
            then
A76:        (-p`1)^2=(q`1)^2 by A2,A35,A53,A63,A73,A74,A75;
            --p`1<=0 by A52;
            then -p`1>=0;
            then
A77:        -p`1=sqrt((-q`1)^2) by A76,SQUARE_1:89;
            --q`1<=0 by A34;
            then -q`1>=0;
            then
A78:        --p`1=--q`1 by A77,SQUARE_1:89;
            p=|[p`1,p`2]| by EUCLID:57;
            hence x1=x2 by A74,A78,EUCLID:57;
          end;
          case
A79:        p<>0.REAL 2 & (p`2/|.p.|<sn & p`1<=0);
            then
A80:        sn-FanMorphW.p= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/ (1+sn))^2)),
            |.p.|* ((p`2/|.p.|-sn)/(1+sn))]| by A1,Th25;
            set p4= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
            |.p.|* ((p`2/|.p.|-sn)/(1+sn))]|;
A81:        p4`1= |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)) &
            p4`2= |.p.|* ((p`2/|.p.|-sn)/(1+sn)) by EUCLID:56;
A82:        p`2/|.p.|-sn<0 by A79,XREAL_1:51;
            1+sn>0 by A1,XREAL_1:150;
            then ((p`2/|.p.|-sn)/(1+sn))<0 by A82,XREAL_1:143;
            then
A83:        |.p.|* ((p`2/|.p.|-sn)/(1+sn))<0 by A79,Lm1,XREAL_1:134;
A84:        q`2/|.q.|-sn>=0 by A34,XREAL_1:50;
            1-sn>0 by A1,XREAL_1:151;
            then ((q`2/|.q.|-sn)/(1-sn))>=0 by A84;
            hence x1=x2 by A2,A35,A36,A80,A81,A83;
          end;
        end;
        hence x1=x2;
      end;
      case
A85:    q`2/|.q.|<sn & q`1<=0 & q<>0.REAL 2;
        then
A86:    sn-FanMorphW.q= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn)) ^2)),
        |.q.|* ((q`2/|.q.|-sn)/(1+sn))]| by A1,Th25;
        set q4= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
        |.q.|* ((q`2/|.q.|-sn)/(1+sn))]|;
A87:    q4`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)) &
        q4`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by EUCLID:56;
A88:    |.q.|>0 by A85,Lm1;
        then
A89:    (|.q.|)^2>0 by SQUARE_1:74;
        per cases by JGRAPH_2:11;
        suppose
A90:      p`1>=0;
          then
A91:      (sn-FanMorphW).p=p by Th23;
A92:      1+sn>0 by A1,XREAL_1:150;
A93:      (q`2/|.q.|-sn)<=0 by A85,XREAL_1:49;
          then
A94:      -(q`2/|.q.|-sn)>= -0;
          --(q`2/|.q.|-sn)/(1+sn)<=0 by A92,A93;
          then
A95:      -((q`2/|.q.|-sn)/(1+sn))>=0;
A96:      (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
          0<=(q`1)^2 by XREAL_1:65;
          then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
          then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2
           by A96,XREAL_1:74;
          then (q`2)^2/(|.q.|)^2 <= 1 by A89,XCMPLX_1:60;
          then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
          then
A97:      (-((q`2)/|.q.|))^2 <= 1;
          (-(1+sn))/(1+sn)<=(-( q`2/|.q.|-sn))/(1+sn)
          by A92,A94,XREAL_1:74;
          then
A98:      -1<=(-( q`2/|.q.|-sn))/(1+sn) by A92,XCMPLX_1:198;
          1>= -q`2/|.q.| by A97,SQUARE_1:121;
          then (1+sn)>= -q`2/|.q.|+sn by XREAL_1:9;
          then (-(q`2/|.q.|-sn))/(1+sn)<=1 by A92,XREAL_1:187;
          then ((-(q`2/|.q.|-sn))/(1+sn))^2<=1^2 by A98,SQUARE_1:119;
          then
A99:      1-((-(q`2/|.q.|-sn))/(1+sn))^2>=0 by XREAL_1:50;
          then
A100:     1-(-((q`2/|.q.|-sn))/(1+sn))^2>=0 by XCMPLX_1:188;
          sqrt(1-((-(q`2/|.q.|-sn))/(1+sn))^2)>=0 by A99,SQUARE_1:def 4;
          then sqrt(1-(-(q`2/|.q.|-sn))^2/(1+sn)^2)>=0 by XCMPLX_1:77;
          then sqrt(1-((q`2/|.q.|-sn))^2/(1+sn)^2)>=0;
          then sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)>=0 by XCMPLX_1:77;
          then -sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)<= -0;
          then p`1=0 by A2,A86,A87,A90,A91;
          then (-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))=0 by A2,A86,A87,A88,A91,
XCMPLX_1:6;
          then 1-((q`2/|.q.|-sn)/(1+sn))^2=0 by A100,SQUARE_1:92;
          then 1=sqrt((-((q`2/|.q.|-sn)/(1+sn)))^2) by SQUARE_1:83;
          then 1= -((q`2/|.q.|-sn)/(1+sn)) by A95,SQUARE_1:89;
          then 1= ((-(q`2/|.q.|-sn))/(1+sn)) by XCMPLX_1:188;
          then 1 *(1+sn)=-(q`2/|.q.|-sn) by A92,XCMPLX_1:88;
          then 1+sn-sn=-q`2/|.q.|;
          then 1=(-q`2)/|.q.| by XCMPLX_1:188;
          then 1 *|.q.|=-q`2 by A88,XCMPLX_1:88;
          then (q`2)^2-(q`2)^2 =(q`1)^2 by A96,XCMPLX_1:26;
          then q`1=0 by XCMPLX_1:6;
          hence x1=x2 by A2,A91,Th23;
        end;
        suppose
A101:     p<>0.REAL 2 & (p`2/|.p.|>=sn & p`1<=0);
          then
A102:     sn-FanMorphW.p= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1- sn))^2)),
          |.p.|* ((p`2/|.p.|-sn)/(1-sn))]| by A1,Th25;
          set p4= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
          |.p.|* ((p`2/|.p.|-sn)/(1-sn))]|;
A103:     p4`1= |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)) &
          p4`2= |.p.|* ((p`2/|.p.|-sn)/(1-sn)) by EUCLID:56;
A104:     q`2/|.q.|-sn<0 by A85,XREAL_1:51;
          1+sn>0 by A1,XREAL_1:150;
          then ((q`2/|.q.|-sn)/(1+sn))<0 by A104,XREAL_1:143;
          then
A105:     |.q.|* ((q`2/|.q.|-sn)/(1+sn))<0 by A85,Lm1,XREAL_1:134;
A106:     p`2/|.p.|-sn>=0 by A101,XREAL_1:50;
          1-sn>0 by A1,XREAL_1:151;
          then ((p`2/|.p.|-sn)/(1-sn))>=0 by A106;
          hence x1=x2 by A2,A86,A87,A102,A103,A105;
        end;
        suppose
A107:     p<>0.REAL 2 & (p`2/|.p.|<sn & p`1<=0);
          then
A108:     sn-FanMorphW.p= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+ sn))^2)),
          |.p.|* ((p`2/|.p.|-sn)/(1+sn))]| by A1,Th25;
          set p4= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
          |.p.|* ((p`2/|.p.|-sn)/(1+sn))]|;
A109:     p4`1= |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)) &
          p4`2= |.p.|* ((p`2/|.p.|-sn)/(1+sn)) by EUCLID:56;
A110:     q4`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))&
          q4`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by EUCLID:56;
          (q`2/|.q.|-sn)<=0 by A85,XREAL_1:49;
          then
A111:     -(q`2/|.q.|-sn)>= -0;
A112:     (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
          0<=(q`1)^2 by XREAL_1:65;
          then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
          then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2
           by A112,XREAL_1:74;
          then (q`2)^2/(|.q.|)^2 <= 1 by A89,XCMPLX_1:60;
          then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
          then -1<=q`2/|.q.| by SQUARE_1:121;
          then
A113:     -1-sn<=q`2/|.q.|-sn by XREAL_1:11;
A114:     1+sn>0 by A1,XREAL_1:150;
          (-(1+sn))/(1+sn)<=(-( q`2/|.q.|-sn))/(1+sn) by A111,A114,XREAL_1:74;
          then
A115:     -1<=(-( q`2/|.q.|-sn))/(1+sn) by A114,XCMPLX_1:198;
          -(-1-sn)>= -(q`2/|.q.|-sn) by A113,XREAL_1:26;
          then (-(q`2/|.q.|-sn))/(1+sn)<=1 by A114,XREAL_1:187;
          then ((-(q`2/|.q.|-sn))/(1+sn))^2<=1^2 by A115,SQUARE_1:119;
          then 1-((-(q`2/|.q.|-sn))/(1+sn))^2>=0 by XREAL_1:50;
          then
A116:     1-(-((q`2/|.q.|-sn))/(1+sn))^2>=0 by XCMPLX_1:188;
A117:     (q4`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))^2 by A110
            .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1+sn))^2) by A116,SQUARE_1:def 4;
          (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
            .=(|.q.|)^2 by A110,A117;
          then sqrt((|.q4.|)^2)=|.q.| by SQUARE_1:89;
          then
A118:     |.q4.|=|.q.| by SQUARE_1:89;
A119:     |.p.|>0 by A107,Lm1;
          then
A120:     (|.p.|)^2>0 by SQUARE_1:74;
          (p`2/|.p.|-sn)<=0 by A107,XREAL_1:49;
          then
A121:     -(p`2/|.p.|-sn)>= -0;
A122:     (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
          0<=(p`1)^2 by XREAL_1:65;
          then 0+(p`2)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
          then (p`2)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2
           by A122,XREAL_1:74;
          then (p`2)^2/(|.p.|)^2 <= 1 by A120,XCMPLX_1:60;
          then ((p`2)/|.p.|)^2 <= 1 by XCMPLX_1:77;
          then -1<=p`2/|.p.| by SQUARE_1:121;
          then
A123:     -1-sn<=p`2/|.p.|-sn by XREAL_1:11;
          (-(1+sn))/(1+sn)<=(-( p`2/|.p.|-sn))/(1+sn)
          by A114,A121,XREAL_1:74;
          then
A124:     -1<=(-( p`2/|.p.|-sn))/(1+sn) by A114,XCMPLX_1:198;
          -(-1-sn)>= -(p`2/|.p.|-sn) by A123,XREAL_1:26;
          then (-(p`2/|.p.|-sn))/(1+sn)<=1 by A114,XREAL_1:187;
          then ((-(p`2/|.p.|-sn))/(1+sn))^2<=1^2 by A124,SQUARE_1:119;
          then 1-((-(p`2/|.p.|-sn))/(1+sn))^2>=0 by XREAL_1:50;
          then
A125:     1-(-((p`2/|.p.|-sn))/(1+sn))^2>=0 by XCMPLX_1:188;
A126:     (p4`1)^2= (|.p.|)^2*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2))^2 by A109
            .= (|.p.|)^2*(1-((p`2/|.p.|-sn)/(1+sn))^2) by A125,SQUARE_1:def 4;
          (|.p4.|)^2=(p4`1)^2+(p4`2)^2 by JGRAPH_3:10
            .=(|.p.|)^2 by A109,A126;
          then sqrt((|.p4.|)^2)=|.p.| by SQUARE_1:89;
          then
A127:     |.p4.|=|.p.| by SQUARE_1:89;
          ((p`2/|.p.|-sn)/(1+sn)) =|.q.|* ((q`2/|.q.|-sn)/(1+sn))/|.p.|
          by A2,A86,A87,A108,A109,A119,XCMPLX_1:90;
          then (p`2/|.p.|-sn)/(1+sn)=(q`2/|.q.|-sn)/(1+sn)
          by A2,A86,A108,A118,A119,A127,XCMPLX_1:90;
          then (p`2/|.p.|-sn)/(1+sn)*(1+sn)=q`2/|.q.|-sn by A114,XCMPLX_1:88;
          then p`2/|.p.|-sn=q`2/|.q.|-sn by A114,XCMPLX_1:88;
          then p`2/|.p.|*|.p.|=q`2 by A2,A86,A108,A118,A119,A127,XCMPLX_1:88;
          then
A128:     p`2=q`2 by A119,XCMPLX_1:88;
A129:     |.p.|^2=(p`1)^2+(p`2)^2 by JGRAPH_3:10;
          |.q.|^2=(q`1)^2+(q`2)^2 by JGRAPH_3:10;
          then
A130:     (-p`1)^2=(q`1)^2 by A2,A86,A108,A118,A127,A128,A129;
          --p`1<=0 by A107;
          then -p`1>=0;
          then
A131:     -p`1=sqrt((-q`1)^2) by A130,SQUARE_1:89;
          --q`1<=0 by A85;
          then -q`1>=0;
          then
A132:     --p`1=--q`1 by A131,SQUARE_1:89;
          p=|[p`1,p`2]| by EUCLID:57;
          hence x1=x2 by A128,A132,EUCLID:57;
        end;
      end;
    end;
    hence x1=x2;
  end;
  hence thesis by FUNCT_1:def 8;
end;

theorem Th46:
  for sn being Real st -1<sn & sn<1 holds
  sn-FanMorphW is Function of TOP-REAL 2,TOP-REAL 2 &
  rng (sn-FanMorphW) = the carrier of TOP-REAL 2
proof
  let sn be Real;
  assume
A1: -1<sn & sn<1;
  thus sn-FanMorphW is Function of TOP-REAL 2,TOP-REAL 2;
  for f being Function of TOP-REAL 2,TOP-REAL 2 st f=(sn-FanMorphW) holds
  rng (sn-FanMorphW)=the carrier of TOP-REAL 2
  proof
    let f be Function of TOP-REAL 2,TOP-REAL 2;
    assume
A2: f=sn-FanMorphW;
A3: dom f=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
    the carrier of TOP-REAL 2 c= rng f
    proof
      let y be set;
      assume y in the carrier of TOP-REAL 2;
      then reconsider p2=y as Point of TOP-REAL 2;
      set q=p2;
      now per cases by JGRAPH_2:11;
        case q`1>=0;
          then q in dom (sn-FanMorphW) & y=(sn-FanMorphW).q by A2,A3,Th23;
          hence ex x being set st x in dom (sn-FanMorphW) & y=(sn-FanMorphW).x;
        end;
        case
A4:       q`2/|.q.|>=0 & q`1<=0 & q<>0.REAL 2;
          set px=|[ -(|.q.|)*sqrt(1-(q`2/|.q.|*(1-sn)+sn)^2),
          |.q.|*(q`2/|.q.|*(1-sn)+sn)]|;
A5:       px`1 = -(|.q.|)*sqrt(1-(q`2/|.q.|*(1-sn)+sn)^2) &
          px`2 = |.q.|*(q`2/|.q.|*(1-sn)+sn) by EUCLID:56;
          then
A6:       |.px.|^2=(-(|.q.|)*sqrt(1-(q`2/|.q.|*(1-sn)+sn)^2))^2
          +(|.q.|*(q`2/|.q.|*(1-sn)+sn))^2 by JGRAPH_3:10
            .=(|.q.|)^2*(sqrt(1-(q`2/|.q.|*(1-sn)+sn)^2))^2
          +(|.q.|)^2*((q`2/|.q.|*(1-sn)+sn))^2;
A7:       |.q.|<>0 by A4,TOPRNS_1:25;
          1-sn>=0 by A1,XREAL_1:151;
          then
A8:       q`2/|.q.|*(1-sn)>=0 by A4;
          then
A9:       (q`2/|.q.|*(1-sn)+sn)>=0+sn by XREAL_1:9;
A10:      |.q.|>0 by A4,Lm1;
A11:      |.q.|^2>0 by A7,SQUARE_1:74;
          --(1+sn)>0 by A1,XREAL_1:150;
          then -(1+sn)<= q`2/|.q.|*(1-sn) by A8;
          then
A12:      -1-sn+sn<= q`2/|.q.|*(1-sn)+sn by XREAL_1:9;
A13:      1-sn>0 by A1,XREAL_1:151;
A14:      (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
          0<=(q`1)^2 by XREAL_1:65;
          then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
          then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2
           by A14,XREAL_1:74;
          then (q`2)^2/(|.q.|)^2 <= 1 by A11,XCMPLX_1:60;
          then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
          then q`2/|.q.|<=1 by SQUARE_1:121;
          then q`2/|.q.|*(1-sn) <=1 *(1-sn) by A13,XREAL_1:66;
          then q`2/|.q.|*(1-sn)+sn-sn <=1-sn;
          then (q`2/|.q.|*(1-sn)+sn) <=1 by XREAL_1:11;
          then 1^2>=(q`2/|.q.|*(1-sn)+sn)^2 by A12,SQUARE_1:119;
          then
A15:      1-(q`2/|.q.|*(1-sn)+sn)^2>=0 by XREAL_1:50;
          then
A16:      |.px.|^2=(|.q.|)^2*(1-(q`2/|.q.|*(1-sn)+sn)^2)
          +(|.q.|)^2*((q`2/|.q.|*(1-sn)+sn))^2 by A6,SQUARE_1:def 4
            .= (|.q.|)^2;
          then
A17:      |.px.|=sqrt(|.q.|^2) by SQUARE_1:89
            .=|.q.| by SQUARE_1:89;
          sqrt(1-(q`2/|.q.|*(1-sn)+sn)^2)>=0 by A15,SQUARE_1:def 4;
          then |.q.|*sqrt(1-(q`2/|.q.|*(1-sn)+sn)^2)>=0;
          then px`2/|.px.| >=sn & px`1<=0 & px<>0.REAL 2
          by A5,A7,A9,A17,TOPRNS_1:24,XCMPLX_1:90;
          then
A18:      (sn-FanMorphW).px =|[ |.px.|*(-sqrt(1-((px`2/|.px.|-sn
          )/(1-sn))^2)), |.px.|* ((px`2/|.px.|-sn)/(1-sn))]| by A1,Th25;
A19:      |.px.|* ((px`2/|.px.|-sn)/(1-sn))
          =|.q.|* (( ((q`2/|.q.|*(1-sn)+sn))-sn)/(1-sn))
          by A4,A5,A17,TOPRNS_1:25,XCMPLX_1:90
            .=|.q.|* ( q`2/|.q.|) by A13,XCMPLX_1:90
            .= q`2 by A4,TOPRNS_1:25,XCMPLX_1:88;
          then
A20:      |.px.|*(-sqrt(1-((px`2/|.px.|-sn)/(1-sn))^2))
          = |.px.|*(-sqrt(1-(q`2/|.px.|)^2)) by A4,A17,TOPRNS_1:25,XCMPLX_1:90
            .= |.px.|*(-sqrt(1-(q`2)^2/(|.px.|)^2)) by XCMPLX_1:77
            .= |.px.|*(-sqrt( (|.px.|)^2/(|.px.|)^2-(q`2)^2/(|.px.|)^2))
          by A11,A16,XCMPLX_1:60
            .= |.px.|*(-sqrt( ((|.px.|)^2-(q`2)^2)/(|.px.|)^2))
          by XCMPLX_1:121
            .= |.px.|*(-sqrt( ((q`1)^2+(q`2)^2-(q`2)^2)/(|.px.|)^2))
          by A16,JGRAPH_3:10
            .= |.px.|*(-sqrt((q`1/|.q.|)^2))
          by A17,XCMPLX_1:77;
          q`1/|.q.|<=0 by A4;
          then
A21:      |.px.|*(-sqrt((q`1/|.q.|)^2))=|.px.|*(--(q`1/|.q.|)) by SQUARE_1:90
            .=q`1 by A10,A17,XCMPLX_1:88;
          dom (sn-FanMorphW)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
          hence ex x being set st x in dom (sn-FanMorphW) & y=(sn-FanMorphW).x
          by A18,A19,A20,A21,EUCLID:57;
        end;
        case
A22:      q`2/|.q.|<0 & q`1<=0 & q<>0.REAL 2;
          set px=|[ -(|.q.|)*sqrt(1-(q`2/|.q.|*(1+sn)+sn)^2),
          |.q.|*(q`2/|.q.|*(1+sn)+sn)]|;
A23:      px`1 = -(|.q.|)*sqrt(1-(q`2/|.q.|*(1+sn)+sn)^2) &
          px`2 = |.q.|*(q`2/|.q.|*(1+sn)+sn) by EUCLID:56;
          then
A24:      |.px.|^2=(-(|.q.|)*sqrt(1-(q`2/|.q.|*(1+sn)+sn)^2))^2
          +(|.q.|*(q`2/|.q.|*(1+sn)+sn))^2 by JGRAPH_3:10
            .=(|.q.|)^2*(sqrt(1-(q`2/|.q.|*(1+sn)+sn)^2))^2
          +(|.q.|)^2*((q`2/|.q.|*(1+sn)+sn))^2;
A25:      |.q.|<>0 by A22,TOPRNS_1:25;
          1+sn>=0 by A1,XREAL_1:150;
          then
A26:      q`2/|.q.|*(1+sn)<=0 by A22;
          then
A27:      (q`2/|.q.|*(1+sn)+sn)<=0+sn by XREAL_1:9;
A28:      |.q.|>0 by A22,Lm1;
A29:      |.q.|^2>0 by A25,SQUARE_1:74;
          1-sn>= q`2/|.q.|*(1+sn) by A1,A26,XREAL_1:151;
          then
A30:      1-sn+sn>= q`2/|.q.|*(1+sn)+sn by XREAL_1:9;
A31:      1+sn>0 by A1,XREAL_1:150;
A32:      (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
          0<=(q`1)^2 by XREAL_1:65;
          then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
          then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2
           by A32,XREAL_1:74;
          then (q`2)^2/(|.q.|)^2 <= 1 by A29,XCMPLX_1:60;
          then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
          then q`2/|.q.|>=-1 by SQUARE_1:121;
          then q`2/|.q.|*(1+sn) >=(-1)*(1+sn) by A31,XREAL_1:66;
          then q`2/|.q.|*(1+sn)+sn-sn >=-1-sn;
          then (q`2/|.q.|*(1+sn)+sn) >=-1 by XREAL_1:11;
          then 1^2>=(q`2/|.q.|*(1+sn)+sn)^2 by A30,SQUARE_1:119;
          then
A33:      1-(q`2/|.q.|*(1+sn)+sn)^2>=0 by XREAL_1:50;
          then
A34:      |.px.|^2=(|.q.|)^2*(1-(q`2/|.q.|*(1+sn)+sn)^2)
          +(|.q.|)^2*((q`2/|.q.|*(1+sn)+sn))^2 by A24,SQUARE_1:def 4
            .= (|.q.|)^2;
          then
A35:      |.px.|=sqrt(|.q.|^2) by SQUARE_1:89
            .=|.q.| by SQUARE_1:89;
          sqrt(1-(q`2/|.q.|*(1+sn)+sn)^2)>=0 by A33,SQUARE_1:def 4;
          then |.q.|*sqrt(1-(q`2/|.q.|*(1+sn)+sn)^2)>=0;
          then px`2/|.px.| <=sn & px`1<=0 & px<>0.REAL 2
          by A23,A25,A27,A35,TOPRNS_1:24,XCMPLX_1:90;
          then
A36:      (sn-FanMorphW).px =|[ |.px.|*(-sqrt(1-((px`2/|.px.|-sn
          )/(1+sn))^2)), |.px.|* ((px`2/|.px.|-sn)/(1+sn))]| by A1,Th25;
A37:      |.px.|* ((px`2/|.px.|-sn)/(1+sn))

=|.q.|* (( ((q`2/|.q.|*(1+sn)+sn))-sn)/(1+sn)) by A22,A23,A35,TOPRNS_1:25
,XCMPLX_1:90
            .=|.q.|* ( q`2/|.q.|) by A31,XCMPLX_1:90
            .= q`2 by A22,TOPRNS_1:25,XCMPLX_1:88;
          then
A38:      |.px.|*(-sqrt(1-((px`2/|.px.|-sn)/(1+sn))^2))
          = |.px.|*(-sqrt(1-(q`2/|.px.|)^2)) by A22,A35,TOPRNS_1:25,XCMPLX_1:90
            .= |.px.|*(-sqrt(1-(q`2)^2/(|.px.|)^2)) by XCMPLX_1:77
            .= |.px.|*(-sqrt( (|.px.|)^2/(|.px.|)^2-(q`2)^2/(|.px.|)^2))
          by A29,A34,XCMPLX_1:60
            .= |.px.|*(-sqrt( ((|.px.|)^2-(q`2)^2)/(|.px.|)^2))
          by XCMPLX_1:121
            .= |.px.|*(-sqrt( ((q`1)^2+(q`2)^2-(q`2)^2)/(|.px.|)^2))
          by A34,JGRAPH_3:10
            .= |.px.|*(-sqrt((q`1/|.q.|)^2)) by A35,XCMPLX_1:77;
          q`1/|.q.|<=0 by A22;
          then
A39:      |.px.|*(-sqrt((q`1/|.q.|)^2))=|.px.|*(--(q`1/|.q.|)) by SQUARE_1:90
            .=q`1 by A28,A35,XCMPLX_1:88;
          dom (sn-FanMorphW)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
          hence ex x being set st x in dom (sn-FanMorphW) & y=(sn-FanMorphW).x
          by A36,A37,A38,A39,EUCLID:57;
        end;
      end;
      hence y in rng f by A2,FUNCT_1:def 5;
    end;
    hence rng (sn-FanMorphW)=the carrier of TOP-REAL 2 by A2,XBOOLE_0:def 10;
  end;
  hence rng (sn-FanMorphW)=the carrier of TOP-REAL 2;
end;

Lm11: now
  let K0 be Subset of TOP-REAL 2, q4,q,p2 be Point of TOP-REAL 2,
  O,u,uq be Point of Euclid 2;
  assume
A1: u in cl_Ball(O,|.p2.|+1);
  assume
A2: q = uq & q4 = u & O=0.REAL 2;
  assume
A3: |.q4.|=|.q.|;
  now
    assume not q in cl_Ball(O,|.p2.|+1);
    then not dist(O,uq)<=|.p2.|+1 by A2,METRIC_1:13;
    then |.0.REAL 2 - q.|> |.p2.|+1 by A2,JGRAPH_1:45;
    then |.0.REAL 2 +- q.|> |.p2.|+1 by EUCLID:45;
    then |. -q.|> |.p2.|+1 by EUCLID:31;
    then |.q.|> |.p2.|+1 by TOPRNS_1:27;
    then |. -q4.|> |.p2.|+1 by A3,TOPRNS_1:27;
    then |.0.REAL 2 +- q4.|> |.p2.|+1 by EUCLID:31;
    then |.0.REAL 2 - q4.|> |.p2.|+1 by EUCLID:45;
    then dist(O,u)> |.p2.|+1 by A2,JGRAPH_1:45;
    hence contradiction by A1,METRIC_1:13;
  end;
  hence q in cl_Ball(O,|.p2.|+1);
end;

theorem Th47:
  for sn being Real,p2 being Point of TOP-REAL 2 st -1<sn & sn<1
  ex K being non empty compact Subset of TOP-REAL 2 st K = (sn-FanMorphW).:K &
  (ex V2 being Subset of TOP-REAL 2 st
  p2 in V2 & V2 is open & V2 c= K & (sn-FanMorphW).p2 in V2)
proof
  let sn be Real,p2 be Point of TOP-REAL 2;
  assume
A1: -1<sn & sn<1;
  reconsider O=0.REAL 2 as Point of Euclid 2;
  reconsider V0=Ball(O,|.p2.|+1) as Subset of TOP-REAL 2;
A2: |. p2.|<|.p2.|+1 by XREAL_1:31;
A3: O in V0 by GOBOARD6:4;
A4: V0 c= cl_Ball(O,|.p2.|+1) by METRIC_1:15;
  reconsider K0=cl_Ball(O,|.p2.|+1)
  as non empty compact Subset of TOP-REAL 2 by A3,A4,Th22;
  reconsider u2=p2 as Point of Euclid 2;
A5: (sn-FanMorphW).:K0 c= K0
  proof
    let y be set;
    assume y in (sn-FanMorphW).:K0;
    then consider x being set such that
A6: x in dom (sn-FanMorphW) & x in K0 & y=(sn-FanMorphW).x by FUNCT_1:def 12;
    reconsider q=x as Point of TOP-REAL 2 by A6;
    reconsider uq=q as Point of Euclid 2;
A7: y in rng (sn-FanMorphW) by A6,FUNCT_1:def 5;
    then reconsider u=y as Point of Euclid 2;
    reconsider q4=y as Point of TOP-REAL 2 by A7;
A8: |.q4.|=|.q.| by A6,Th40;
    dist(O,uq)<= |.p2.|+1 by A6,METRIC_1:13;
    then |.0.REAL 2 - q.|<= |.p2.|+1 by JGRAPH_1:45;
    then |.0.REAL 2 +- q.|<= |.p2.|+1 by EUCLID:45;
    then |. -q.|<= |.p2.|+1 by EUCLID:31;
    then |.q.|<= |.p2.|+1 by TOPRNS_1:27;
    then |. -q4.|<= |.p2.|+1 by A8,TOPRNS_1:27;
    then |.0.REAL 2 +- q4.|<= |.p2.|+1 by EUCLID:31;
    then |.0.REAL 2 - q4.|<= |.p2.|+1 by EUCLID:45;
    then dist(O,u)<= |.p2.|+1 by JGRAPH_1:45;
    hence y in K0 by METRIC_1:13;
  end;
  K0 c= (sn-FanMorphW).:K0
  proof
    let y be set;
    assume
A9: y in K0;
    reconsider q4=y as Point of TOP-REAL 2 by A9;
    the carrier of TOP-REAL 2 c= rng (sn-FanMorphW) by A1,Th46;
    then q4 in rng (sn-FanMorphW) by TARSKI:def 3;
    then consider x being set such that
A10: x in dom (sn-FanMorphW) & y=(sn-FanMorphW).x by FUNCT_1:def 5;
    reconsider q=x as Point of TOP-REAL 2 by A10;
    |.q4.|=|.q.| by A10,Th40;
    then q in K0 by A9,Lm11;
    hence y in (sn-FanMorphW).:K0 by A10,FUNCT_1:def 12;
  end;
  then
A11: K0= (sn-FanMorphW).:K0 by A5,XBOOLE_0:def 10;
  |. -p2.|<|.p2.|+1 by A2,TOPRNS_1:27;
  then |.0.REAL 2 +- p2.|<|.p2.|+1 by EUCLID:31;
  then |.0.REAL 2 - p2.|<|.p2.|+1 by EUCLID:45;
  then dist(O,u2)<|.p2.|+1 by JGRAPH_1:45;
  then
A12: p2 in V0 by METRIC_1:12;
A13: V0 is open by TOPMETR:21;
  set q3= (sn-FanMorphW).p2;
  reconsider u3=q3 as Point of Euclid 2;
  |.q3.|=|.p2.| by Th40;
  then |. -q3.|<|.p2.|+1 by A2,TOPRNS_1:27;
  then |.0.REAL 2 +- q3.|<|.p2.|+1 by EUCLID:31;
  then |.0.REAL 2 - q3.|<|.p2.|+1 by EUCLID:45;
  then dist(O,u3)< |.p2.|+1 by JGRAPH_1:45;
  then (sn-FanMorphW).p2 in V0 by METRIC_1:12;
  hence thesis by A11,A12,A13,METRIC_1:15;
end;

theorem
  for sn being Real st -1<sn & sn<1
  ex f being Function of TOP-REAL 2,TOP-REAL 2 st f=(sn-FanMorphW)
  & f is being_homeomorphism
proof
  let sn be Real;
  assume
A1: -1<sn & sn<1;
  then
A2: (sn-FanMorphW) is Function of TOP-REAL 2,TOP-REAL 2 &
  rng (sn-FanMorphW) = the carrier of TOP-REAL 2 by Th46;
  reconsider f=(sn-FanMorphW) as Function of TOP-REAL 2,TOP-REAL 2;
  consider h being Function of (TOP-REAL 2),(TOP-REAL 2) such that
A3: h=(sn-FanMorphW) & h is continuous by A1,Th44;
A4: f is one-to-one by A1,Th45;
  for p2 being Point of TOP-REAL 2
  ex K being non empty compact Subset of TOP-REAL 2 st K = f.:K &
  (ex V2 being Subset of TOP-REAL 2 st
  p2 in V2 & V2 is open & V2 c= K & f.p2 in V2) by A1,Th47;
  then f is being_homeomorphism by A2,A3,A4,Th8;
  hence thesis;
end;

Lm12: now
  let q be Point of TOP-REAL 2, sn,t be Real;
  assume ((-(t/|.q.|-sn))/(1-sn))^2<1^2;
  then 1-((-(t/|.q.|-sn))/(1-sn))^2>0 by XREAL_1:52;
  then sqrt(1-((-(t/|.q.|-sn))/(1-sn))^2)>0 by SQUARE_1:93;
  then sqrt(1-(-(t/|.q.|-sn))^2/(1-sn)^2)> 0 by XCMPLX_1:77;
  then sqrt(1-(t/|.q.|-sn)^2/(1-sn)^2)> 0;
  then sqrt(1-((t/|.q.|-sn)/(1-sn))^2)> 0 by XCMPLX_1:77;
  hence -sqrt(1-((t/|.q.|-sn)/(1-sn))^2)< -0 by XREAL_1:26;
end;

theorem Th49:
  for sn being Real,q being Point of TOP-REAL 2 st -1<sn & sn<1 & q`1<0
  & q`2/|.q.|>=sn holds (for p being Point of TOP-REAL 2 st
  p=(sn-FanMorphW).q holds p`1<0 & p`2>=0)
proof
  let sn be Real,q be Point of TOP-REAL 2;
  assume
A1: -1<sn & sn<1 & q`1<0 & q`2/|.q.|>=sn;
  let p be Point of TOP-REAL 2;
  assume p=(sn-FanMorphW).q;
  then
A2: p=|[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
  |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by A1,Th23;
  set qz=p;
A3: |.q.|>0 by A1,Lm1,JGRAPH_2:11;
  then
A4: (|.q.|)^2>0 by SQUARE_1:74;
A5: 1-sn>0 by A1,XREAL_1:151;
A6: qz`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))&
  qz`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by A2,EUCLID:56;
A7: (q`2/|.q.|-sn)>= 0 by A1,XREAL_1:50;
A8: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
  0+(q`2)^2<(q`1)^2+(q`2)^2 by A1,SQUARE_1:74,XREAL_1:10;
  then (q`2)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A4,A8,XREAL_1:76;
  then (q`2)^2/(|.q.|)^2 < 1 by A4,XCMPLX_1:60;
  then ((q`2)/|.q.|)^2 < 1 by XCMPLX_1:77;
  then 1>q`2/|.q.| by SQUARE_1:122;
  then
A9: 1-sn>q`2/|.q.|-sn by XREAL_1:11;
A10: -(1-sn)< -0 by A5,XREAL_1:26;
  -(1-sn)< -( q`2/|.q.|-sn) by A9,XREAL_1:26;
  then (-(1-sn))/(1-sn)<(-( q`2/|.q.|-sn))/(1-sn) by A5,XREAL_1:76;
  then
A11: -1<(-( q`2/|.q.|-sn))/(1-sn) by A5,XCMPLX_1:198;
  --(1-sn)> -(q`2/|.q.|-sn) by A7,A10,XREAL_1:26;
  then (-(q`2/|.q.|-sn))/(1-sn)<1 by A5,XREAL_1:193;
  then ((-(q`2/|.q.|-sn))/(1-sn))^2<1^2 by A11,SQUARE_1:120;
  then
A12: -sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)< -0 by Lm12;
  ((q`2/|.q.|-sn)/(1-sn))>=0 by A5,A7;
  hence p`1<0 & p`2>=0 by A3,A6,A12,XREAL_1:134;
end;

theorem Th50:
  for sn being Real,q being Point of TOP-REAL 2 st -1<sn & sn<1 & q`1<0
  & q`2/|.q.|<sn holds (for p being Point of TOP-REAL 2 st
  p=(sn-FanMorphW).q holds p`1<0 & p`2<0)
proof
  let sn be Real,q be Point of TOP-REAL 2;
  assume
A1: -1<sn & sn<1 & q`1<0 & q`2/|.q.|<sn;
  let p be Point of TOP-REAL 2;
  assume p=(sn-FanMorphW).q;
  then
A2: p=|[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
  |.q.|* ((q`2/|.q.|-sn)/(1+sn))]| by A1,Th24;
  set qz=p;
  |.q.|>0 by A1,Lm1,JGRAPH_2:11;
  then
A3: (|.q.|)^2>0 by SQUARE_1:74;
A4: (q`2/|.q.|-sn)< 0 by A1,XREAL_1:51;
A5: 1+sn>0 by A1,XREAL_1:150;
A6: qz`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))&
  qz`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by A2,EUCLID:56;
A7: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
  0+(q`2)^2<(q`1)^2+(q`2)^2 by A1,SQUARE_1:74,XREAL_1:10;
  then (q`2)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A3,A7,XREAL_1:76;
  then (q`2)^2/(|.q.|)^2 < 1 by A3,XCMPLX_1:60;
  then ((q`2)/|.q.|)^2 < 1 by XCMPLX_1:77;
  then -1<q`2/|.q.| by SQUARE_1:122;
  then -1-sn<q`2/|.q.|-sn by XREAL_1:11;
  then -(1+sn) < (q`2/|.q.|-sn);
  then
A8: --(1+sn)> -(q`2/|.q.|-sn) by XREAL_1:26;
A9: -( q`2/|.q.|-sn)>0 by A4,XREAL_1:60;
  (-(1+sn))/(1+sn)<(-( q`2/|.q.|-sn))/(1+sn) by A5,A9,XREAL_1:76;
  then
A10: -1<(-( q`2/|.q.|-sn))/(1+sn) by A5,XCMPLX_1:198;
  (-(q`2/|.q.|-sn))/(1+sn)<1 by A5,A8,XREAL_1:193;
  then ((-(q`2/|.q.|-sn))/(1+sn))^2<1^2 by A10,SQUARE_1:120;
  then 1-((-(q`2/|.q.|-sn))/(1+sn))^2>0 by XREAL_1:52;
  then sqrt(1-((-(q`2/|.q.|-sn))/(1+sn))^2)>0 by SQUARE_1:93;
  then sqrt(1-(-(q`2/|.q.|-sn))^2/(1+sn)^2)> 0 by XCMPLX_1:77;
  then sqrt(1-(q`2/|.q.|-sn)^2/(1+sn)^2)> 0;
  then sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)> 0 by XCMPLX_1:77;
  then
A11: -sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)< -0 by XREAL_1:26;
  ((q`2/|.q.|-sn)/(1+sn))<0 by A4,A5,XREAL_1:143;
  hence p`1<0 & p`2<0 by A1,A6,A11,Lm1,JGRAPH_2:11,XREAL_1:134;
end;

theorem Th51:
  for sn being Real,q1,q2 being Point of TOP-REAL 2 st -1<sn & sn<1 & q1`1<0
  & q1`2/|.q1.|>=sn & q2`1<0 & q2`2/|.q2.|>=sn & q1`2/|.q1.|<q2`2/|.q2.|
  holds (for p1,p2 being Point of TOP-REAL 2 st
  p1=(sn-FanMorphW).q1 & p2=(sn-FanMorphW).q2 holds p1`2/|.p1.|<p2`2/|.p2.|)
proof
  let sn be Real,q1,q2 be Point of TOP-REAL 2;
  assume
A1: -1<sn & sn<1 & q1`1<0
  & q1`2/|.q1.|>=sn & q2`1<0 & q2`2/|.q2.|>=sn & q1`2/|.q1.|<q2`2/|.q2.|;
  let p1,p2 be Point of TOP-REAL 2;
  assume
A2: p1=(sn-FanMorphW).q1 & p2=(sn-FanMorphW).q2;
  then p1=|[ |.q1.|*(-sqrt(1-((q1`2/|.q1.|-sn)/(1-sn))^2)),
  |.q1.|* ((q1`2/|.q1.|-sn)/(1-sn))]| by A1,Th23;
  then
A3: p1`1= |.q1.|*(-sqrt(1-((q1`2/|.q1.|-sn)/(1-sn))^2))&
  p1`2= |.q1.|* ((q1`2/|.q1.|-sn)/(1-sn)) by EUCLID:56;
  p2=|[ |.q2.|*(-sqrt(1-((q2`2/|.q2.|-sn)/(1-sn))^2)),
  |.q2.|* ((q2`2/|.q2.|-sn)/(1-sn))]| by A1,A2,Th23;
  then
A4: p2`1= |.q2.|*(-sqrt(1-((q2`2/|.q2.|-sn)/(1-sn))^2))&
  p2`2= |.q2.|* ((q2`2/|.q2.|-sn)/(1-sn)) by EUCLID:56;
A5: |.q1.|>0 & |.q2.|>0 by A1,Lm1,JGRAPH_2:11;
A6: |.p1.|=|.q1.| & |.p2.|=|.q2.| by A2,Th40;
  then
A7: p1`2/|.p1.|= ((q1`2/|.q1.|-sn)/(1-sn)) by A3,A5,XCMPLX_1:90;
A8: p2`2/|.p2.|= ((q2`2/|.q2.|-sn)/(1-sn)) by A4,A5,A6,XCMPLX_1:90;
A9: q1`2/|.q1.|-sn< q2`2/|.q2.|-sn by A1,XREAL_1:11;
  1-sn>0 by A1,XREAL_1:151;
  hence thesis by A7,A8,A9,XREAL_1:76;
end;

theorem Th52:
  for sn being Real,q1,q2 being Point of TOP-REAL 2 st -1<sn & sn<1 & q1`1<0
  & q1`2/|.q1.|<sn & q2`1<0 & q2`2/|.q2.|<sn & q1`2/|.q1.|<q2`2/|.q2.|
  holds (for p1,p2 being Point of TOP-REAL 2 st
  p1=(sn-FanMorphW).q1 & p2=(sn-FanMorphW).q2 holds p1`2/|.p1.|<p2`2/|.p2.|)
proof
  let sn be Real,q1,q2 be Point of TOP-REAL 2;
  assume
A1: -1<sn & sn<1 & q1`1<0
  & q1`2/|.q1.|<sn & q2`1<0 & q2`2/|.q2.|<sn & q1`2/|.q1.|<q2`2/|.q2.|;
  let p1,p2 be Point of TOP-REAL 2;
  assume
A2: p1=(sn-FanMorphW).q1 & p2=(sn-FanMorphW).q2;
  then p1=|[ |.q1.|*(-sqrt(1-((q1`2/|.q1.|-sn)/(1+sn))^2)),
  |.q1.|* ((q1`2/|.q1.|-sn)/(1+sn))]| by A1,Th24;
  then
A3: p1`1= |.q1.|*(-sqrt(1-((q1`2/|.q1.|-sn)/(1+sn))^2))&
  p1`2= |.q1.|* ((q1`2/|.q1.|-sn)/(1+sn)) by EUCLID:56;
  p2=|[ |.q2.|*(-sqrt(1-((q2`2/|.q2.|-sn)/(1+sn))^2)),
  |.q2.|* ((q2`2/|.q2.|-sn)/(1+sn))]| by A1,A2,Th24;
  then
A4: p2`1= |.q2.|*(-sqrt(1-((q2`2/|.q2.|-sn)/(1+sn))^2))&
  p2`2= |.q2.|* ((q2`2/|.q2.|-sn)/(1+sn)) by EUCLID:56;
A5: |.q1.|>0 & |.q2.|>0 by A1,Lm1,JGRAPH_2:11;
A6: |.p1.|=|.q1.| & |.p2.|=|.q2.| by A2,Th40;
  then
A7: p1`2/|.p1.|= ((q1`2/|.q1.|-sn)/(1+sn)) by A3,A5,XCMPLX_1:90;
A8: p2`2/|.p2.|= ((q2`2/|.q2.|-sn)/(1+sn)) by A4,A5,A6,XCMPLX_1:90;
A9: q1`2/|.q1.|-sn< q2`2/|.q2.|-sn by A1,XREAL_1:11;
  1+sn>0 by A1,XREAL_1:150;
  hence p1`2/|.p1.|<p2`2/|.p2.| by A7,A8,A9,XREAL_1:76;
end;

theorem
  for sn being Real,q1,q2 being Point of TOP-REAL 2 st -1<sn & sn<1 & q1`1 < 0
  & q2`1<0 & q1`2/|.q1.|<q2`2/|.q2.|
  holds (for p1,p2 being Point of TOP-REAL 2 st
  p1=(sn-FanMorphW).q1 & p2=(sn-FanMorphW).q2 holds p1`2/|.p1.|<p2`2/|.p2.|)
proof
  let sn be Real,q1,q2 be Point of TOP-REAL 2;
  assume
A1: -1<sn & sn<1 & q1`1<0 & q2`1<0 & q1`2/|.q1.|<q2`2/|.q2.|;
  let p1,p2 be Point of TOP-REAL 2;
  assume
A2: p1=(sn-FanMorphW).q1 & p2=(sn-FanMorphW).q2;
  now per cases;
    case q1`2/|.q1.|>=sn & q2`2/|.q2.|>=sn;
      hence p1`2/|.p1.|<p2`2/|.p2.| by A1,A2,Th51;
    end;
    case q1`2/|.q1.|>=sn & q2`2/|.q2.|<sn;
      hence p1`2/|.p1.|<p2`2/|.p2.| by A1,XXREAL_0:2;
    end;
    case
A3:   q1`2/|.q1.|<sn & q2`2/|.q2.|>=sn;
      then
A4:   p1`1<0 & p1`2<0 by A1,A2,Th50;
      then
A5:   |.p1.|>0 by Lm1,JGRAPH_2:11;
      p2`1<0 & p2`2>=0 by A1,A2,A3,Th49;
      then p2`2/|.p2.|>=0;
      hence p1`2/|.p1.|<p2`2/|.p2.| by A4,A5,XREAL_1:143;
    end;
    case q1`2/|.q1.|<sn & q2`2/|.q2.|<sn;
      hence p1`2/|.p1.|<p2`2/|.p2.| by A1,A2,Th52;
    end;
  end;
  hence p1`2/|.p1.|<p2`2/|.p2.|;
end;

theorem
  for sn being Real,q being Point of TOP-REAL 2 st -1<sn & sn<1 & q`1<0
  & q`2/|.q.|=sn holds (for p being Point of TOP-REAL 2 st
  p=(sn-FanMorphW).q holds p`1<0 & p`2=0)
proof
  let sn be Real,q be Point of TOP-REAL 2;
  assume
A1: -1<sn & sn<1 & q`1<0 & q`2/|.q.|=sn;
  let p be Point of TOP-REAL 2;
  assume p=(sn-FanMorphW).q;
  then
A2: p=|[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
  |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by A1,Th23;
A3: |.q.|>0 by A1,Lm1,JGRAPH_2:11;
  p`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))&
  p`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by A2,EUCLID:56;
  hence thesis by A1,A3,Lm12,XREAL_1:134;
end;

theorem
  for sn being real number holds 0.REAL 2=(sn-FanMorphW).(0.REAL 2)
  by Th23,JGRAPH_2:11;

begin :: Fan Morphism for North

definition
  let s be real number, q be Point of TOP-REAL 2;
  func FanN(s,q) -> Point of TOP-REAL 2 equals
  :Def4:
  |.q.|*|[(q`1/|.q.|-s)/(1-s),
  sqrt(1-((q`1/|.q.|-s)/(1-s))^2)]| if q`1/|.q.|>=s & q`2>0,
  |.q.|*|[(q`1/|.q.|-s)/(1+s),
  sqrt(1-((q`1/|.q.|-s)/(1+s))^2)]| if q`1/|.q.|<s & q`2>0 otherwise q;
  correctness;
end;

definition
  let c be real number;
  func c-FanMorphN -> Function of TOP-REAL 2, TOP-REAL 2 means
  :Def5:
  for q being Point of TOP-REAL 2 holds it.q=FanN(c,q);
  existence
  proof
    deffunc F(Point of TOP-REAL 2)=FanN(c,$1);
    thus ex IT being Function of TOP-REAL 2, TOP-REAL 2 st
    for q being Point of TOP-REAL 2 holds IT.q=F(q) from FUNCT_2:sch 4;
  end;
  uniqueness
  proof
    deffunc F(Point of TOP-REAL 2)=FanN(c,$1);
    thus for a,b being Function of TOP-REAL 2, TOP-REAL 2 st
    (for q being Point of TOP-REAL 2 holds a.q=F(q)) &
    (for q being Point of TOP-REAL 2 holds b.q=F(q)) holds
    a = b from BINOP_2:sch 1;
  end;
end;

theorem Th56:
  for cn being real number holds (q`1/|.q.|>=cn & q`2>0 implies
  cn-FanMorphN.q= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
  |.q.|*(sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]|)&
  (q`2<=0 implies cn-FanMorphN.q=q)
proof
  let cn be real number;
A1: cn-FanMorphN.q=FanN(cn,q) by Def5;
  hereby
    assume q`1/|.q.|>=cn & q`2>0;
    then FanN(cn,q)= |.q.|*|[(q`1/|.q.|-cn)/(1-cn),
    sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)]| by Def4
      .= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
    |.q.|*(sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by EUCLID:62;
    hence cn-FanMorphN.q= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
    |.q.|*(sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by Def5;
  end;
  assume q`2<=0;
  hence thesis by A1,Def4;
end;

theorem Th57:
  for cn being Real holds (q`1/|.q.|<=cn & q`2>0 implies
  cn-FanMorphN.q= |[ |.q.|*((q`1/|.q.|-cn)/(1+cn)),
  |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]|)
proof
  let cn be Real;
  assume
A1: q`1/|.q.|<=cn & q`2>0;
  per cases by A1,XXREAL_0:1;
  suppose q`1/|.q.|<cn;
    then FanN(cn,q)= |.q.|*|[(q`1/|.q.|-cn)/(1+cn),
    sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)]| by A1,Def4
      .= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
    |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]| by EUCLID:62;
    hence thesis by Def5;
  end;
  suppose
A2: q`1/|.q.|=cn;
    then (q`1/|.q.|-cn)/(1-cn)=0;
    hence thesis by A1,A2,Th56;
  end;
end;

theorem Th58:
  for cn being Real st -1<cn & cn<1 holds
  (q`1/|.q.|>=cn & q`2>=0 & q<>0.REAL 2 implies
  cn-FanMorphN.q= |[ |.q.|*((q`1/|.q.|-cn)/(1-cn)),
  |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]|) &
  (q`1/|.q.|<=cn & q`2>=0 & q<>0.REAL 2 implies
  cn-FanMorphN.q= |[ |.q.|*((q`1/|.q.|-cn)/(1+cn)),
  |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]|)
proof
  let cn be Real;
  assume
A1: -1<cn & cn<1;
  per cases;
  suppose
A2: q`1/|.q.|>=cn & q`2>=0 & q<>0.REAL 2;
    per cases;
    suppose
A3:   q`2>0;
      then FanN(cn,q)= |.q.|*|[(q`1/|.q.|-cn)/(1-cn),
      sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)]| by A2,Def4
        .= |[|.q.|* ((q`1/|.q.|-cn)/(1-cn)),
      |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by EUCLID:62;
      hence thesis by A3,Def5,Th57;
    end;
    suppose
A4:   q`2<=0;
      then
A5:   cn-FanMorphN.q=q by Th56;
A6:   (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
A7:   |.q.|<>0 by A2,TOPRNS_1:25;
      then
A8:   |.q.|^2>0 by SQUARE_1:74;
A9:   q`2=0 by A2,A4;
A10:  sqrt((|.q.|)^2)=|.q.| by SQUARE_1:89;
A11:  1-cn>0 by A1,XREAL_1:151;
A12:  |.q.|>0 by A2,Lm1;
      (q`1)^2/|.q.|^2=1^2 by A6,A8,A9,XCMPLX_1:60;
      then ((q`1)/|.q.|)^2=1^2 by XCMPLX_1:77;
      then
A13:  sqrt(((q`1)/|.q.|)^2)=1 by SQUARE_1:89;
      now
        assume q`1<0;
        then q`1/|.q.|<0 by A12,XREAL_1:143;
        then -((q`1)/|.q.|)=1 by A13,SQUARE_1:90;
        hence contradiction by A1,A2;
      end;
      then
A14:  |.q.|=q`1 by A6,A9,A10,SQUARE_1:89;
      then 1=q`1/|.q.| by A2,TOPRNS_1:25,XCMPLX_1:60;
      then (q`1/|.q.|-cn)/(1-cn)=1 by A11,XCMPLX_1:60;
      hence thesis by A1,A5,A7,A9,A14,EUCLID:57,SQUARE_1:82,XCMPLX_1:60;
    end;
  end;
  suppose
A15: q`1/|.q.|<=cn & q`2>=0 & q<>0.REAL 2;
    per cases;
    suppose q`2>0;
      hence thesis by Th56,Th57;
    end;
    suppose
A16:  q`2<=0;
A17:  (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
A18:  |.q.|<>0 by A15,TOPRNS_1:25;
A19:  q`2=0 by A15,A16;
A20:  |.q.|>0 by A15,Lm1;
A21:  1+cn>0 by A1,XREAL_1:150;
      1>q`1/|.q.| by A1,A15,XXREAL_0:2;
      then 1 *(|.q.|)>q`1/|.q.|*(|.q.|) by A20,XREAL_1:70;
      then
A22:  (|.q.|)>q`1 by A15,TOPRNS_1:25,XCMPLX_1:88;
      then
A23:  |.q.|=-q`1 by A17,A19,SQUARE_1:109;
A24:  q`1= -(|.q.|) by A17,A19,A22,SQUARE_1:109;
      then -1=q`1/|.q.| by A15,TOPRNS_1:25,XCMPLX_1:198;
      then (q`1/|.q.|-cn)/(1+cn) =(-(1+cn))/(1+cn)
        .=-1 by A21,XCMPLX_1:198;
      then |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
      |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]|
      =q by A19,A23,EUCLID:57,SQUARE_1:82;
      hence thesis by A1,A16,A18,A24,Th56,XCMPLX_1:198;
    end;
  end;
  suppose q`2<0 or q=0.REAL 2;
    hence thesis;
  end;
end;

theorem Th59:
  for cn being Real,K1 being non empty Subset of TOP-REAL 2,
  f being Function of (TOP-REAL 2)|K1,R^1 st -1<cn & cn<1 &
  (for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|* ((p`1/|.p.|-cn)/(1-cn)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`2>=0 & q<>0.REAL 2) holds
  f is continuous
proof
  let cn be Real,K1 be non empty Subset of TOP-REAL 2,
  f be Function of (TOP-REAL 2)|K1,R^1;
  assume
A1: -1<cn & cn<1 &
  (for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|* ((p`1/|.p.|-cn)/(1-cn)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`2>=0 & q<>0.REAL 2);
  set a=cn, b=(1-cn);
A2: b>0 by A1,XREAL_1:151;
  reconsider g2=proj1|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm2;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1
  by Lm5;
  for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q<>0.REAL 2 by A1;
  then for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm6;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
A3: (for q being Point of
  (TOP-REAL 2)|K1,r1,r2 being Real st g2.q=r1 & g1.q=r2
  holds g3.q=r2*((r1/r2-a)/b)) & g3 is continuous by A2,Th10;
A4: dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then
A5: dom f=dom g3 by FUNCT_2:def 1;
  for x being set st x in dom f holds f.x=g3.x
  proof
    let x be set;
    assume
A6: x in dom f;
    then x in K1 by A4,A5,PRE_TOPC:29;
    then reconsider r=x as Point of TOP-REAL 2;
    reconsider s=x as Point of (TOP-REAL 2)|K1 by A6;
A7: f.r=(|.r.|)* ((r`1/|.r.|-cn)/(1-cn)) by A1,A6;
A8: g2.s=proj1.s by Lm2;
A9: g1.s=(2 NormF).s by Lm5;
A10: proj1.r=r`1 by PSCOMP_1:def 28;
    (2 NormF).r=|.r.| by Def1;
    hence f.x=g3.x by A3,A7,A8,A9,A10;
  end;
  hence f is continuous by A3,A5,FUNCT_1:9;
end;

theorem Th60:
  for cn being Real,K1 being non empty Subset of TOP-REAL 2,
  f being Function of (TOP-REAL 2)|K1,R^1 st -1<cn & cn<1 &
  (for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|* ((p`1/|.p.|-cn)/(1+cn)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`2>=0 & q<>0.REAL 2) holds
  f is continuous
proof
  let cn be Real,K1 be non empty Subset of TOP-REAL 2,
  f be Function of (TOP-REAL 2)|K1,R^1;
  assume
A1: -1<cn & cn<1 &
  (for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|* ((p`1/|.p.|-cn)/(1+cn)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`2>=0 & q<>0.REAL 2);
  set a=cn, b=(1+cn);
A2: 1+cn>0 by A1,XREAL_1:150;
  reconsider g2=proj1|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm2;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1
  by Lm5;
  for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q<>0.REAL 2 by A1;
  then for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm6;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
A3: (for q being Point of
  (TOP-REAL 2)|K1,r1,r2 being Real st g2.q=r1 & g1.q=r2
  holds g3.q=r2*((r1/r2-a)/b)) & g3 is continuous by A2,Th10;
A4: dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then
A5: dom f=dom g3 by FUNCT_2:def 1;
  for x being set st x in dom f holds f.x=g3.x
  proof
    let x be set;
    assume
A6: x in dom f;
    then x in dom g3 by A4;
    then x in K1 by A4,PRE_TOPC:29;
    then reconsider r=x as Point of TOP-REAL 2;
    reconsider s=x as Point of (TOP-REAL 2)|K1 by A6;
A7: f.r=(|.r.|)* ((r`1/|.r.|-cn)/(1+cn)) by A1,A6;
A8: g2.s=proj1.s by Lm2;
A9: g1.s=(2 NormF).s by Lm5;
A10: proj1.r=r`1 by PSCOMP_1:def 28;
    (2 NormF).r=|.r.| by Def1;
    hence f.x=g3.x by A3,A7,A8,A9,A10;
  end;
  hence f is continuous by A3,A5,FUNCT_1:9;
end;

theorem Th61:
  for cn being Real,K1 being non empty Subset of TOP-REAL 2,
  f being Function of (TOP-REAL 2)|K1,R^1 st -1<cn & cn<1 &
  (for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds
  q`2>=0 & q`1/|.q.|>=cn & q<>0.REAL 2) holds f is continuous
proof
  let cn be Real,K1 be non empty Subset of TOP-REAL 2,
  f be Function of (TOP-REAL 2)|K1,R^1;
  assume
A1: -1<cn & cn<1 &
  (for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`2>=0 & q`1/|.q.|>=cn & q<>0.REAL 2);
  set a=cn, b=(1-cn);
A2: b>0 by A1,XREAL_1:151;
  reconsider g2=proj1|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm2;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1
  by Lm5;
  for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q<>0.REAL 2 by A1;
  then for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm6;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
A3: (for q being Point of
  (TOP-REAL 2)|K1,r1,r2 being real number st g2.q=r1 & g1.q=r2
  holds g3.q=r2*( sqrt(abs(1-((r1/r2-a)/b)^2))))
  & g3 is continuous by A2,Th15;
A4: dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then
A5: dom f=dom g3 by FUNCT_2:def 1;
  for x being set st x in dom f holds f.x=g3.x
  proof
    let x be set;
    assume
A6: x in dom f;
    then x in K1 by A4,A5,PRE_TOPC:29;
    then reconsider r=x as Point of TOP-REAL 2;
    reconsider s=x as Point of (TOP-REAL 2)|K1 by A6;
A7: now
      assume |.r.|=0;
      then r=0.REAL 2 by TOPRNS_1:25;
      hence contradiction by A1,A6;
    end;
    |.r.|^2=(r`1)^2+(r`2)^2 by JGRAPH_3:10;
    then
A9: ((r`1) -(|.r.|))*((r`1)+|.r.|) =-(r`2)^2;
    (r`2)^2>=0 by XREAL_1:65;
    then -(r`2)^2 <=0;
    then -(|.r.|)<=r`1 & r`1<= |.r.| by A9,XREAL_1:95;
    then r`1/|.r.| <= |.r.|/|.r.| by XREAL_1:74;
    then r`1/|.r.|<=1 by A7,XCMPLX_1:60;
    then
A10: r`1/|.r.|-cn<=(1-cn) by XREAL_1:11;
A11: now
      assume (1-cn)^2=0;
      then 1-cn+cn=0+cn by XCMPLX_1:6;
      hence contradiction by A1;
    end;
A12: 1-cn>0 by A1,XREAL_1:151;
A13: (1-cn)^2>=0 by XREAL_1:65;
    cn<=r`1/(|.r.|) by A1,A6;
    then cn-r`1/|.r.|<=0 by XREAL_1:49;
    then -(cn- r`1/|.r.|)>=-(1-cn) by A12,XREAL_1:26;
    then (r`1/|.r.|-cn)^2<=(1-cn)^2 by A10,SQUARE_1:119;
    then (r`1/|.r.|-cn)^2/(1-cn)^2<=(1-cn)^2/(1-cn)^2 by A13,XREAL_1:74;
    then (r`1/|.r.|-cn)^2/(1-cn)^2<=1 by A11,XCMPLX_1:60;
    then ((r`1/|.r.|-cn)/(1-cn))^2<=1 by XCMPLX_1:77;
    then 1-((r`1/|.r.|-cn)/(1-cn))^2>=0 by XREAL_1:50;
    then abs(1-((r`1/|.r.|-cn)/(1-cn))^2)
    =1-((r`1/|.r.|-cn)/(1-cn))^2 by ABSVALUE:def 1;
    then
A14: f.r=(|.r.|)*( sqrt(abs(1-((r`1/|.r.|-cn)/(1-cn))^2))) by A1,A6;
A15: g2.s=proj1.s by Lm2;
A16: g1.s=(2 NormF).s by Lm5;
A17: proj1.r=r`1 by PSCOMP_1:def 28;
    (2 NormF).r=|.r.| by Def1;
    hence f.x=g3.x by A3,A14,A15,A16,A17;
  end;
  hence f is continuous by A3,A5,FUNCT_1:9;
end;

theorem Th62:
  for cn being Real,K1 being non empty Subset of TOP-REAL 2,
  f being Function of (TOP-REAL 2)|K1,R^1 st -1<cn & cn<1 &
  (for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds
  q`2>=0 & q`1/|.q.|<=cn & q<>0.REAL 2) holds f is continuous
proof
  let cn be Real,K1 be non empty Subset of TOP-REAL 2,
  f be Function of (TOP-REAL 2)|K1,R^1;
  assume
A1: -1<cn & cn<1 &
  (for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`2>=0 & q`1/|.q.|<=cn & q<>0.REAL 2);
  set a=cn, b=(1+cn);
A2: 1+cn>0 by A1,XREAL_1:150;
  reconsider g2=proj1|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm2;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1
  by Lm5;
  for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q<>0.REAL 2 by A1;
  then for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm6;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
A3: (for q being Point of
  (TOP-REAL 2)|K1,r1,r2 being real number st g2.q=r1 & g1.q=r2
  holds g3.q=r2*( sqrt(abs(1-((r1/r2-a)/b)^2))))
  & g3 is continuous by A2,Th15;
A4: dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then
A5: dom f=dom g3 by FUNCT_2:def 1;
  for x being set st x in dom f holds f.x=g3.x
  proof
    let x be set;
    assume
A6: x in dom f;
    then x in K1 by A4,A5,PRE_TOPC:29;
    then reconsider r=x as Point of TOP-REAL 2;
    reconsider s=x as Point of (TOP-REAL 2)|K1 by A6;
A7: now
      assume |.r.|=0;
      then r=0.REAL 2 by TOPRNS_1:25;
      hence contradiction by A1,A6;
    end;
    |.r.|^2=(r`1)^2+(r`2)^2 by JGRAPH_3:10;
    then
A9: ((r`1) -(|.r.|))*((r`1)+|.r.|) =-(r`2)^2;
    (r`2)^2>=0 by XREAL_1:65;
    then -(r`2)^2 <=0;
    then -(|.r.|)<=r`1 & r`1<= |.r.| by A9,XREAL_1:95;
    then r`1/|.r.| >= (-(|.r.|))/|.r.| by XREAL_1:74;
    then r`1/|.r.|>= -1 by A7,XCMPLX_1:198;
    then r`1/|.r.|-cn>=-1-cn by XREAL_1:11;
    then
A10: r`1/|.r.|-cn>=-(1+cn);
A11: (1+cn)^2>0 by A2,SQUARE_1:74;
    cn>=r`1/(|.r.|) by A1,A6;
    then cn-r`1/|.r.|>=0 by XREAL_1:50;
    then -(cn-r`1/|.r.|)<=-0;
    then (r`1/|.r.|-cn)^2<=(1+cn)^2 by A2,A10,SQUARE_1:119;
    then (r`1/|.r.|-cn)^2/(1+cn)^2<=(1+cn)^2/(1+cn)^2 by A11,XREAL_1:74;
    then (r`1/|.r.|-cn)^2/(1+cn)^2<=1 by A11,XCMPLX_1:60;
    then ((r`1/|.r.|-cn)/(1+cn))^2<=1 by XCMPLX_1:77;
    then 1-((r`1/|.r.|-cn)/(1+cn))^2>=0 by XREAL_1:50;
    then abs(1-((r`1/|.r.|-cn)/(1+cn))^2)
    =1-((r`1/|.r.|-cn)/(1+cn))^2 by ABSVALUE:def 1;
    then
A12: f.r=(|.r.|)*( sqrt(abs(1-((r`1/|.r.|-cn)/(1+cn))^2))) by A1,A6;
A13: g2.s=proj1.s by Lm2;
A14: g1.s=(2 NormF).s by Lm5;
A15: proj1.r=r`1 by PSCOMP_1:def 28;
    (2 NormF).r=|.r.| by Def1;
    hence f.x=g3.x by A3,A12,A13,A14,A15;
  end;
  hence f is continuous by A3,A5,FUNCT_1:9;
end;

theorem Th63:
  for cn being Real, K0,B0 being Subset of TOP-REAL 2,f being
  Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0
  st -1<cn & cn<1 & f=(cn-FanMorphN)|K0 &
  B0={q where q is Point of TOP-REAL 2: q`2>=0 & q<>0.REAL 2}
  & K0={p: p`1/|.p.|>=cn & p`2>=0 & p<>0.REAL 2} holds f is continuous
proof
  let cn be Real,K0,B0 be Subset of TOP-REAL 2,f be
  Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0;
  assume
A1: -1<cn & cn<1 & f=(cn-FanMorphN)|K0 &
  B0={q where q is Point of TOP-REAL 2: q`2>=0 & q<>0.REAL 2} &
  K0={p: p`1/|.p.|>=cn & p`2>=0 & p<>0.REAL 2};
  set sn=sqrt(1-cn^2);
  set p0=|[cn,sn]|;
A2: p0`1=cn by EUCLID:56;
A3: p0`2=sn by EUCLID:56;
  cn^2<1^2 by A1,SQUARE_1:120;
  then
A4: 1-cn^2>0 by XREAL_1:52;
  then
A5: p0`2>0 by A3,SQUARE_1:93;
A6: |.p0.|=sqrt((sn)^2+cn^2) by A2,A3,JGRAPH_3:10;
  sn^2=1-cn^2 by A4,SQUARE_1:def 4;
  then p0`1/|.p0.|=cn by A6,EUCLID:56,SQUARE_1:83;
  then
A7: p0 in K0 by A1,A5,JGRAPH_2:11;
  then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
A8: K0 c= B0
  proof
    let x be set;
    assume x in K0;
    then consider p8 being Point of TOP-REAL 2 such that
A9: x=p8 & (p8`1/|.p8.|>=cn & p8`2>=0 & p8<>0.REAL 2) by A1;
    thus x in B0 by A1,A9;
  end;
A10: dom (proj1*((cn-FanMorphN)|K1)) c= dom ((cn-FanMorphN)|K1) by RELAT_1:44;
  dom ((cn-FanMorphN)|K1) c= dom (proj1*((cn-FanMorphN)|K1))
  proof
    let x be set;
    assume
A11: x in dom ((cn-FanMorphN)|K1);
    then
A12: x in dom (cn-FanMorphN) /\ K1 by FUNCT_1:68;
A13: ((cn-FanMorphN)|K1).x=(cn-FanMorphN).x by A11,FUNCT_1:68;
A14: dom proj1 = (the carrier of TOP-REAL 2) by FUNCT_2:def 1;
    x in dom (cn-FanMorphN) by A12,XBOOLE_0:def 4;
    then (cn-FanMorphN).x in rng (cn-FanMorphN) by FUNCT_1:12;
    hence x in dom (proj1*((cn-FanMorphN)|K1)) by A11,A13,A14,FUNCT_1:21;
  end;
  then
A15: dom (proj1*((cn-FanMorphN)|K1))
  =dom ((cn-FanMorphN)|K1) by A10,XBOOLE_0:def 10
    .=dom (cn-FanMorphN) /\ K1 by FUNCT_1:68
    .=(the carrier of TOP-REAL 2)/\ K1 by FUNCT_2:def 1
    .=K1 by XBOOLE_1:28
    .=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
  rng (proj1*((cn-FanMorphN)|K1)) c= the carrier of R^1 by TOPMETR:24;

then reconsider g2=proj1*((cn-FanMorphN)|K1) as Function of (TOP-REAL 2)|K1,R^1
  by A15,FUNCT_2:4;
A16: dom (proj2*((cn-FanMorphN)|K1)) c= dom ((cn-FanMorphN)|K1) by RELAT_1:44;
  dom ((cn-FanMorphN)|K1) c= dom (proj2*((cn-FanMorphN)|K1))
  proof
    let x be set;
    assume
A17: x in dom ((cn-FanMorphN)|K1);
    then
A18: x in dom (cn-FanMorphN) /\ K1 by FUNCT_1:68;
A19: ((cn-FanMorphN)|K1).x=(cn-FanMorphN).x by A17,FUNCT_1:68;
A20: dom proj2 = (the carrier of TOP-REAL 2) by FUNCT_2:def 1;
    x in dom (cn-FanMorphN) by A18,XBOOLE_0:def 4;
    then (cn-FanMorphN).x in rng (cn-FanMorphN) by FUNCT_1:12;
    hence x in dom (proj2*((cn-FanMorphN)|K1)) by A17,A19,A20,FUNCT_1:21;
  end;
  then
A21: dom (proj2*((cn-FanMorphN)|K1))
  =dom ((cn-FanMorphN)|K1) by A16,XBOOLE_0:def 10
    .=dom (cn-FanMorphN) /\ K1 by FUNCT_1:68
    .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
    .=K1 by XBOOLE_1:28
    .=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
  rng (proj2*((cn-FanMorphN)|K1)) c= the carrier of R^1 by TOPMETR:24;

then reconsider g1=proj2*((cn-FanMorphN)|K1) as Function of (TOP-REAL 2)|K1,R^1
  by A21,FUNCT_2:4;
A22: for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`2>=0 & q<>0.REAL 2
  proof
    let q be Point of TOP-REAL 2;
    assume
A23: q in the carrier of (TOP-REAL 2)|K1;
    the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then consider p3 being Point of TOP-REAL 2 such that
A24: q=p3 & (p3`1/|.p3.|>=cn & p3`2>=0 & p3<>0.REAL 2) by A1,A23;
    thus q`2>=0 & q<>0.REAL 2 by A24;
  end;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g2.p=|.p.|* ((p`1/|.p.|-cn)/(1-cn))
  proof
    let p be Point of TOP-REAL 2;
    assume
A25: p in the carrier of (TOP-REAL 2)|K1;
A26: dom ((cn-FanMorphN)|K1)=dom (cn-FanMorphN) /\ K1 by FUNCT_1:68
      .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
      .=K1 by XBOOLE_1:28;
A27: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then consider p3 being Point of TOP-REAL 2 such that
A28: p=p3 & (p3`1/|.p3.|>=cn & p3`2>=0 & p3<>0.REAL 2) by A1,A25;
A29: (cn-FanMorphN).p =|[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
    |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]| by A1,A28,Th58;
    ((cn-FanMorphN)|K1).p=(cn-FanMorphN).p by A25,A27,FUNCT_1:72;
    then g2.p=proj1.(|[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
    |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]|)
    by A25,A26,A27,A29,FUNCT_1:23
      .=(|[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
    |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]|)`1 by PSCOMP_1:def 28
      .=|.p.|* ((p`1/|.p.|-cn)/(1-cn)) by EUCLID:56;
    hence g2.p=|.p.|* ((p`1/|.p.|-cn)/(1-cn));
  end;
  then consider f2 being Function of (TOP-REAL 2)|K1,R^1 such that
A30: for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds f2.p=|.p.|* ((p`1/|.p.|-cn)/(1-cn));
A31: f2 is continuous by A1,A22,A30,Th59;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g1.p=|.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))
  proof
    let p be Point of TOP-REAL 2;
    assume
A32: p in the carrier of (TOP-REAL 2)|K1;
A33: dom ((cn-FanMorphN)|K1)=dom (cn-FanMorphN) /\ K1 by FUNCT_1:68
      .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
      .=K1 by XBOOLE_1:28;
A34: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then consider p3 being Point of TOP-REAL 2 such that
A35: p=p3 & (p3`1/|.p3.|>=cn & p3`2>=0 & p3<>0.REAL 2) by A1,A32;
A36: (cn-FanMorphN).p=|[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
    |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]| by A1,A35,Th58;
    ((cn-FanMorphN)|K1).p=(cn-FanMorphN).p by A32,A34,FUNCT_1:72;
    then g1.p=proj2.(|[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
    |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]|)
    by A32,A33,A34,A36,FUNCT_1:23
      .=(|[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
    |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]|)`2 by PSCOMP_1:def 29
      .= |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)) by EUCLID:56;
    hence g1.p=|.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2));
  end;
  then consider f1 being Function of (TOP-REAL 2)|K1,R^1 such that
A37: for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds f1.p=|.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2));
  for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`2>=0 & q`1/|.q.|>=cn & q<>0.REAL 2
  proof
    let q be Point of TOP-REAL 2;
    assume
A38: q in the carrier of (TOP-REAL 2)|K1;
    the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then consider p3 being Point of TOP-REAL 2 such that
A39: q=p3 & (p3`1/|.p3.|>=cn & p3`2>=0 & p3<>0.REAL 2) by A1,A38;
    thus thesis by A39;
  end;
  then
A40: f1 is continuous by A1,A37,Th61;
  for x,y,s,r being real number st |[x,y]| in K1 &
  s=f2.(|[x,y]|) & r=f1.(|[x,y]|) holds f.(|[x,y]|)=|[s,r]|
  proof
    let x,y,s,r be real number;
    assume
A41: |[x,y]| in K1 & s=f2.(|[x,y]|) & r=f1.(|[x,y]|);
    set p99=|[x,y]|;
A42: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    consider p3 being Point of TOP-REAL 2 such that
A43: p99=p3 & (p3`1/|.p3.|>=cn & p3`2>=0 & p3<>0.REAL 2) by A1,A41;
A44: f1.p99=|.p99.|*( sqrt(1-((p99`1/|.p99.|-cn)/(1-cn))^2)) by A37,A41,A42;
    ((cn-FanMorphN)|K0).(|[x,y]|)=((cn-FanMorphN)).(|[x,y]|) by A41,FUNCT_1:72
      .= |[ |.p99.|* ((p99`1/|.p99.|-cn)/(1-cn)),
    |.p99.|*( sqrt(1-((p99`1/|.p99.|-cn)/(1-cn))^2))]| by A1,A43,Th58
      .=|[s,r]| by A30,A41,A42,A44;
    hence f.(|[x,y]|)=|[s,r]| by A1;
  end;
  hence f is continuous by A7,A8,A31,A40,JGRAPH_2:45;
end;

theorem Th64:
  for cn being Real, K0,B0 being Subset of TOP-REAL 2,f being
  Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0
  st -1<cn & cn<1 & f=(cn-FanMorphN)|K0 &
  B0={q where q is Point of TOP-REAL 2: q`2>=0 & q<>0.REAL 2}
  & K0={p: p`1/|.p.|<=cn & p`2>=0 & p<>0.REAL 2} holds f is continuous
proof
  let cn be Real,K0,B0 be Subset of TOP-REAL 2,f be
  Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0;
  assume
A1: -1<cn & cn<1 & f=(cn-FanMorphN)|K0 &
  B0={q where q is Point of TOP-REAL 2: q`2>=0 & q<>0.REAL 2} &
  K0={p: p`1/|.p.|<=cn & p`2>=0 & p<>0.REAL 2};
  set sn=sqrt(1-cn^2);
  set p0=|[cn,sn]|;
A2: p0`1=cn by EUCLID:56;
A3: p0`2=sn by EUCLID:56;
  cn^2<1^2 by A1,SQUARE_1:120;
  then
A4: 1-cn^2>0 by XREAL_1:52;
  then
A5: p0`2>0 by A3,SQUARE_1:93;
A6: |.p0.|=sqrt((sn)^2+cn^2) by A2,A3,JGRAPH_3:10;
  sn^2=1-cn^2 by A4,SQUARE_1:def 4;
  then p0`1/|.p0.|=cn by A6,EUCLID:56,SQUARE_1:83;
  then
A7: p0 in K0 by A1,A5,JGRAPH_2:11;
  then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
A8: K0 c= B0
  proof
    let x be set;
    assume x in K0;
    then consider p8 being Point of TOP-REAL 2 such that
A9: x=p8 & ( p8`1/|.p8.|<=cn & p8`2>=0 & p8<>0.REAL 2) by A1;
    thus x in B0 by A1,A9;
  end;
A10: dom (proj1*((cn-FanMorphN)|K1)) c= dom ((cn-FanMorphN)|K1) by RELAT_1:44;
  dom ((cn-FanMorphN)|K1) c= dom (proj1*((cn-FanMorphN)|K1))
  proof
    let x be set;
    assume
A11: x in dom ((cn-FanMorphN)|K1);
    then
A12: x in dom (cn-FanMorphN) /\ K1 by FUNCT_1:68;
A13: ((cn-FanMorphN)|K1).x=(cn-FanMorphN).x by A11,FUNCT_1:68;
A14: dom proj1 = (the carrier of TOP-REAL 2) by FUNCT_2:def 1;
    x in dom (cn-FanMorphN) by A12,XBOOLE_0:def 4;
    then (cn-FanMorphN).x in rng (cn-FanMorphN) by FUNCT_1:12;
    hence x in dom (proj1*((cn-FanMorphN)|K1)) by A11,A13,A14,FUNCT_1:21;
  end;
  then
A15: dom (proj1*((cn-FanMorphN)|K1))
  =dom ((cn-FanMorphN)|K1) by A10,XBOOLE_0:def 10
    .=dom (cn-FanMorphN) /\ K1 by FUNCT_1:68
    .=(the carrier of TOP-REAL 2)/\ K1 by FUNCT_2:def 1
    .=K1 by XBOOLE_1:28
    .=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
  rng (proj1*((cn-FanMorphN)|K1)) c= the carrier of R^1 by TOPMETR:24;

then reconsider g2=proj1*((cn-FanMorphN)|K1) as Function of (TOP-REAL 2)|K1,R^1
  by A15,FUNCT_2:4;
A16: dom (proj2*((cn-FanMorphN)|K1)) c= dom ((cn-FanMorphN)|K1) by RELAT_1:44;
  dom ((cn-FanMorphN)|K1) c= dom (proj2*((cn-FanMorphN)|K1))
  proof
    let x be set;
    assume
A17: x in dom ((cn-FanMorphN)|K1);
    then
A18: x in dom (cn-FanMorphN) /\ K1 by FUNCT_1:68;
A19: ((cn-FanMorphN)|K1).x=(cn-FanMorphN).x by A17,FUNCT_1:68;
A20: dom proj2 = (the carrier of TOP-REAL 2) by FUNCT_2:def 1;
    x in dom (cn-FanMorphN) by A18,XBOOLE_0:def 4;
    then (cn-FanMorphN).x in rng (cn-FanMorphN) by FUNCT_1:12;
    hence x in dom (proj2*((cn-FanMorphN)|K1)) by A17,A19,A20,FUNCT_1:21;
  end;
  then
A21: dom (proj2*((cn-FanMorphN)|K1))
  =dom ((cn-FanMorphN)|K1) by A16,XBOOLE_0:def 10
    .=dom (cn-FanMorphN) /\ K1 by FUNCT_1:68
    .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
    .=K1 by XBOOLE_1:28
    .=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
  rng (proj2*((cn-FanMorphN)|K1)) c= the carrier of R^1 by TOPMETR:24;

then reconsider g1=proj2*((cn-FanMorphN)|K1) as Function of (TOP-REAL 2)|K1,R^1
  by A21,FUNCT_2:4;
A22: for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`2>=0 & q<>0.REAL 2
  proof
    let q be Point of TOP-REAL 2;
    assume
A23: q in the carrier of (TOP-REAL 2)|K1;
    the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then consider p3 being Point of TOP-REAL 2 such that
A24: q=p3 & (p3`1/|.p3.|<=cn & p3`2>=0 & p3<>0.REAL 2) by A1,A23;
    thus q`2>=0 & q<>0.REAL 2 by A24;
  end;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g2.p=|.p.|* ((p`1/|.p.|-cn)/(1+cn))
  proof
    let p be Point of TOP-REAL 2;
    assume
A25: p in the carrier of (TOP-REAL 2)|K1;
A26: dom ((cn-FanMorphN)|K1)=dom (cn-FanMorphN) /\ K1 by FUNCT_1:68
      .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
      .=K1 by XBOOLE_1:28;
A27: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then consider p3 being Point of TOP-REAL 2 such that
A28: p=p3 & (p3`1/|.p3.|<=cn & p3`2>=0 & p3<>0.REAL 2) by A1,A25;
A29: (cn-FanMorphN).p =|[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
    |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]| by A1,A28,Th58;
    ((cn-FanMorphN)|K1).p=(cn-FanMorphN).p by A25,A27,FUNCT_1:72;
    then g2.p=proj1.(|[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
    |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]|)
    by A25,A26,A27,A29,FUNCT_1:23
      .=(|[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
    |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]|)`1 by PSCOMP_1:def 28
      .=|.p.|* ((p`1/|.p.|-cn)/(1+cn)) by EUCLID:56;
    hence g2.p=|.p.|* ((p`1/|.p.|-cn)/(1+cn));
  end;
  then consider f2 being Function of (TOP-REAL 2)|K1,R^1 such that
A30: for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds f2.p=|.p.|* ((p`1/|.p.|-cn)/(1+cn));
A31: f2 is continuous by A1,A22,A30,Th60;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g1.p=|.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))
  proof
    let p be Point of TOP-REAL 2;
    assume
A32: p in the carrier of (TOP-REAL 2)|K1;
A33: dom ((cn-FanMorphN)|K1)=dom (cn-FanMorphN) /\ K1 by FUNCT_1:68
      .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
      .=K1 by XBOOLE_1:28;
A34: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then consider p3 being Point of TOP-REAL 2 such that
A35: p=p3 & (p3`1/|.p3.|<=cn & p3`2>=0 & p3<>0.REAL 2) by A1,A32;
A36: (cn-FanMorphN).p=|[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
    |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]| by A1,A35,Th58;
    ((cn-FanMorphN)|K1).p=(cn-FanMorphN).p by A32,A34,FUNCT_1:72;
    then g1.p=proj2.(|[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
    |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]|)
    by A32,A33,A34,A36,FUNCT_1:23
      .=(|[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
    |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]|)`2 by PSCOMP_1:def 29
      .= |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)) by EUCLID:56;
    hence g1.p=|.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2));
  end;
  then consider f1 being Function of (TOP-REAL 2)|K1,R^1 such that
A37: for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds f1.p=|.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2));
  for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`2>=0 & q`1/|.q.|<=cn & q<>0.REAL 2
  proof
    let q be Point of TOP-REAL 2;
    assume
A38: q in the carrier of (TOP-REAL 2)|K1;
    the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then consider p3 being Point of TOP-REAL 2 such that
A39: q=p3 & (p3`1/|.p3.|<=cn & p3`2>=0 & p3<>0.REAL 2) by A1,A38;
    thus thesis by A39;
  end;
  then
A40: f1 is continuous by A1,A37,Th62;
  for x,y,s,r being real number st |[x,y]| in K1 &
  s=f2.(|[x,y]|) & r=f1.(|[x,y]|) holds f.(|[x,y]|)=|[s,r]|
  proof
    let x,y,s,r be real number;
    assume
A41: |[x,y]| in K1 & s=f2.(|[x,y]|) & r=f1.(|[x,y]|);
    set p99=|[x,y]|;
A42: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    consider p3 being Point of TOP-REAL 2 such that
A43: p99=p3 & (p3`1/|.p3.|<=cn & p3`2>=0 & p3<>0.REAL 2) by A1,A41;
A44: f1.p99=|.p99.|*( sqrt(1-((p99`1/|.p99.|-cn)/(1+cn))^2)) by A37,A41,A42;
    ((cn-FanMorphN)|K0).(|[x,y]|)=((cn-FanMorphN)).(|[x,y]|) by A41,FUNCT_1:72
      .= |[ |.p99.|* ((p99`1/|.p99.|-cn)/(1+cn)),
    |.p99.|*( sqrt(1-((p99`1/|.p99.|-cn)/(1+cn))^2))]| by A1,A43,Th58
      .=|[s,r]| by A30,A41,A42,A44;
    hence f.(|[x,y]|)=|[s,r]| by A1;
  end;
  hence f is continuous by A7,A8,A31,A40,JGRAPH_2:45;
end;

theorem Th65:
  for cn being Real, K03 being Subset of TOP-REAL 2
  st K03={p: p`1>=(cn)*(|.p.|) & p`2>=0} holds K03 is closed
proof
  let sn be Real, K003 be Subset of TOP-REAL 2;
  assume
A1: K003={p: p`1>=(sn)*(|.p.|) & p`2>=0};
  defpred P[Point of TOP-REAL 2] means ($1`1>=sn*|.$1.|);
  reconsider K1={p7 where p7 is Point of TOP-REAL 2:P[p7]}
  as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
A2: K1 is closed by Lm8;
  defpred Q[Point of TOP-REAL 2] means $1`2>=0;
  reconsider KX={p where p is Point of TOP-REAL 2: Q[p]}
  as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
A3: KX is closed by JORDAN6:8;
  {p : P[p] & Q[p]} = {p7 where p7 is Point of TOP-REAL 2:P[p7]} /\
  {p1 where p1 is Point of TOP-REAL 2: Q[p1]} from DOMAIN_1:sch 10;
  hence thesis by A1,A2,A3,TOPS_1:35;
end;

theorem Th66:
  for cn being Real, K03 being Subset of TOP-REAL 2
  st K03={p: p`1<=(cn)*(|.p.|) & p`2>=0} holds K03 is closed
proof
  let sn be Real, K003 be Subset of TOP-REAL 2;
  assume
A1: K003={p: p`1<=(sn)*(|.p.|) & p`2>=0};
  defpred P[Point of TOP-REAL 2] means ($1`1<=sn*|.$1.|);
  reconsider K1={p7 where p7 is Point of TOP-REAL 2:P[p7]}
  as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
A2: K1 is closed by Lm10;
  defpred Q[Point of TOP-REAL 2] means $1`2>=0;
  reconsider KX={p where p is Point of TOP-REAL 2: Q[p]}
  as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
A3: KX is closed by JORDAN6:8;
  {p : P[p] & Q[p]} = {p7 where p7 is Point of TOP-REAL 2:P[p7]} /\
  {p1 where p1 is Point of TOP-REAL 2: Q[p1]} from DOMAIN_1:sch 10;
  hence thesis by A1,A2,A3,TOPS_1:35;
end;

theorem Th67:
  for cn being Real, K0,B0 being Subset of TOP-REAL 2,f being
  Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0
  st -1<cn & cn<1 & f=(cn-FanMorphN)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} & K0={p: p`2>=0 & p<>0.REAL 2}
  holds f is continuous
proof
  let cn be Real,K0,B0 be Subset of TOP-REAL 2,f be
  Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0;
  assume
A1: -1<cn & cn<1 & f=(cn-FanMorphN)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} & K0={p: p`2>=0 & p<>0.REAL 2};
  set sn=sqrt(1-cn^2);
  set p0=|[cn,sn]|;
A2: p0`1=cn by EUCLID:56;
A3: p0`2=sn by EUCLID:56;
  cn^2<1^2 by A1,SQUARE_1:120;
  then
A4: 1-cn^2>0 by XREAL_1:52;
  then
A5: p0<>0.REAL 2 by A3,JGRAPH_2:11,SQUARE_1:93;
A6: p0`2>0 by A3,A4,SQUARE_1:93;
A7: |.p0.|=sqrt((sn)^2+cn^2) by A2,A3,JGRAPH_3:10;
  sn^2=1-cn^2 by A4,SQUARE_1:def 4;
  then
A8: p0`1/|.p0.|=cn by A7,EUCLID:56,SQUARE_1:83;
  p0 in K0 by A1,A6,JGRAPH_2:11;
  then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
  p0 in the carrier of TOP-REAL 2 & not p0 in {0.REAL 2} by A5,TARSKI:def 1;
  then reconsider D=B0 as non empty Subset of TOP-REAL 2 by A1,XBOOLE_0:def 5;
A9: p0 in {p: p`1/|.p.|>=cn & p`2>=0 & p<>0.REAL 2} by A6,A8,JGRAPH_2:11;
  defpred P[Point of TOP-REAL 2] means
  $1`1/|.$1.|>=cn & $1`2>=0 & $1<>0.REAL 2;
A10: {p: P[p]} is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
A11: {p: p`1/|.p.|>=cn & p`2>=0 & p<>0.REAL 2} c= K1
  proof
    let x be set;
    assume x in {p: p`1/|.p.|>=cn & p`2>=0 & p<>0.REAL 2};
    then consider p such that
A12: p=x & p`1/|.p.|>=cn & p`2>=0 & p<>0.REAL 2;
    thus x in K1 by A1,A12;
  end;
  then reconsider K00={p: p`1/|.p.|>=cn & p`2>=0 & p<>0.REAL 2}
  as non empty Subset of ((TOP-REAL 2)|K1) by A9,PRE_TOPC:29;
  reconsider K001={p: p`1/|.p.|>=cn & p`2>=0 & p<>0.REAL 2}
  as non empty Subset of (TOP-REAL 2) by A9,A10;
  defpred P[Point of TOP-REAL 2] means $1`1>=(cn)*(|.$1.|) & $1`2>=0;
  {p: P[p]} is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
  then reconsider K003={p: p`1>=(cn)*(|.p.|) & p`2>=0}
  as Subset of (TOP-REAL 2);
A13: p0 in {p: p`1/|.p.|<=cn & p`2>=0 & p<>0.REAL 2} by A6,A8,JGRAPH_2:11;
A14: {p: p`1/|.p.|<=cn & p`2>=0 & p<>0.REAL 2} c= K1
  proof
    let x be set;
    assume x in {p: p`1/|.p.|<=cn & p`2>=0 & p<>0.REAL 2};
    then consider p such that
A15: p=x & p`1/|.p.|<=cn & p`2>=0 & p<>0.REAL 2;
    thus x in K1 by A1,A15;
  end;
  then reconsider K11={p: p`1/|.p.|<=cn & p`2>=0 & p<>0.REAL 2}
  as non empty Subset of ((TOP-REAL 2)|K1) by A13,PRE_TOPC:29;
A16: p0 in {p: p`1/|.p.|<=cn & p`2>=0 & p<>0.REAL 2} by A6,A8,JGRAPH_2:11;
  defpred P[Point of TOP-REAL 2] means
  $1`1/|.$1.|<=cn & $1`2>=0 & $1<>0.REAL 2;
  {p: P[p]} is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
  then reconsider K111={p: p`1/|.p.|<=cn & p`2>=0 & p<>0.REAL 2}
  as non empty Subset of TOP-REAL 2 by A16;
  defpred P[Point of TOP-REAL 2] means $1`1<=cn*(|.$1.|) & $1`2>=0;
  {p: P[p]} is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
  then reconsider K004={p: p`1<=(cn)*(|.p.|) & p`2>=0}
  as Subset of (TOP-REAL 2);
  the carrier of (TOP-REAL 2)|B0=the carrier of (TOP-REAL 2)|D;
  then
A17: dom f=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1
    .=K1 by PRE_TOPC:29;
  then
A18: dom (f|K00)=K00 by A11,RELAT_1:91
    .= the carrier of ((TOP-REAL 2)|K1)|K00 by PRE_TOPC:29;
  the carrier of (TOP-REAL 2)|D =D by PRE_TOPC:29;
  then rng (f|K00) c=D;
  then reconsider f1=f|K00 as Function of ((TOP-REAL 2)|K1)|K00,(TOP-REAL 2)|D
  by A18,FUNCT_2:4;
A19: dom f1=the carrier of ((TOP-REAL 2)|K1)|K00 by FUNCT_2:def 1
    .=K00 by PRE_TOPC:29;
A20: dom (cn-FanMorphN)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
  then
A21: dom ((cn-FanMorphN)|K001)=K001 by RELAT_1:91
    .= the carrier of (TOP-REAL 2)|K001 by PRE_TOPC:29;
A22: the carrier of (TOP-REAL 2)|K1 = K1 by PRE_TOPC:29;
  rng ((cn-FanMorphN)|K001) c= K1
  proof
    let y be set;
    assume y in rng ((cn-FanMorphN)|K001);
    then consider x being set such that
A23: x in dom ((cn-FanMorphN)|K001) & y=((cn-FanMorphN)|K001).x
    by FUNCT_1:def 5;
A24: dom ((cn-FanMorphN)|K001)=(dom (cn-FanMorphN))/\ K001 by FUNCT_1:68
      .=(the carrier of TOP-REAL 2)/\ K001 by FUNCT_2:def 1
      .=K001 by XBOOLE_1:28;
    reconsider q=x as Point of TOP-REAL 2 by A23;
A25: y=(cn-FanMorphN).q by A23,FUNCT_1:70;
    consider p2 being Point of TOP-REAL 2 such that
A26: p2=q & p2`1/|.p2.|>=cn & p2`2>=0 & p2<>0.REAL 2 by A23,A24;
A27: cn-FanMorphN.q= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
    |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by A1,A26,Th58;
    set q4= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
    |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]|;
    |.q.|<>0 by A26,TOPRNS_1:25;
    then
A28: (|.q.|)^2>0^2 by SQUARE_1:74;
A29: 1-cn>0 by A1,XREAL_1:151;
A30: q4`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))&
    q4`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by EUCLID:56;
A31: (q`1/|.q.|-cn)>= 0 by A26,XREAL_1:50;
    0<=(q`2)^2 by XREAL_1:65;
    then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
    then (q`1)^2 <= (|.q.|)^2 by JGRAPH_3:10;
    then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by XREAL_1:74;
    then (q`1)^2/(|.q.|)^2 <= 1 by A28,XCMPLX_1:60;
    then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
    then 1>=q`1/|.q.| by SQUARE_1:121;
    then
A32: 1-cn>=q`1/|.q.|-cn by XREAL_1:11;
A33: -(1-cn)<= -0 by A29;
    -(1-cn)<= -( q`1/|.q.|-cn) by A32,XREAL_1:26;
    then (-(1-cn))/(1-cn)<=(-( q`1/|.q.|-cn))/(1-cn) by A29,XREAL_1:74;
    then
A34: -1<=(-( q`1/|.q.|-cn))/(1-cn) by A29,XCMPLX_1:198;
    --(1-cn)>= -(q`1/|.q.|-cn) by A31,A33,XREAL_1:26;
    then (-(q`1/|.q.|-cn))/(1-cn)<=1 by A29,XREAL_1:187;
    then ((-(q`1/|.q.|-cn))/(1-cn))^2<=1^2 by A34,SQUARE_1:119;
    then
A35: 1-((-(q`1/|.q.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
    then
A36: 1-(-((q`1/|.q.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
    sqrt(1-((-(q`1/|.q.|-cn))/(1-cn))^2)>=0 by A35,SQUARE_1:def 4;
    then sqrt(1-(-(q`1/|.q.|-cn))^2/(1-cn)^2)>=0 by XCMPLX_1:77;
    then sqrt(1-(q`1/|.q.|-cn)^2/(1-cn)^2)>=0;
    then
A37: sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)>=0 by XCMPLX_1:77;
A38: (q4`2)^2= (|.q.|)^2*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))^2 by A30
      .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1-cn))^2) by A36,SQUARE_1:def 4;
    (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
      .=(|.q.|)^2 by A30,A38;
    then q4`2>=0^2 & q4<>0.REAL 2 by A28,A30,A37,TOPRNS_1:24
    ;
    hence y in K1 by A1,A25,A27;
  end;
  then reconsider f3=(cn-FanMorphN)|K001
  as Function of (TOP-REAL 2)|K001,(TOP-REAL 2)|K1 by A21,A22,FUNCT_2:4;
A39: dom (f|K11)=K11 by A14,A17,RELAT_1:91
    .= the carrier of ((TOP-REAL 2)|K1)|K11 by PRE_TOPC:29;
  the carrier of (TOP-REAL 2)|D =D by PRE_TOPC:29;
  then rng (f|K11) c=D;
  then reconsider f2=f|K11 as Function of ((TOP-REAL 2)|K1)|K11,(TOP-REAL 2)|D
  by A39,FUNCT_2:4;
A40: dom f2=the carrier of ((TOP-REAL 2)|K1)|K11 by FUNCT_2:def 1
    .=K11 by PRE_TOPC:29;
A41: dom ((cn-FanMorphN)|K111)=K111 by A20,RELAT_1:91
    .= the carrier of (TOP-REAL 2)|K111 by PRE_TOPC:29;
A42: the carrier of (TOP-REAL 2)|K1 =K1 by PRE_TOPC:29;
  rng ((cn-FanMorphN)|K111) c= K1
  proof
    let y be set;
    assume y in rng ((cn-FanMorphN)|K111);
    then consider x being set such that
A43: x in dom ((cn-FanMorphN)|K111) & y=((cn-FanMorphN)|K111).x
    by FUNCT_1:def 5;
A44: dom ((cn-FanMorphN)|K111)=(dom (cn-FanMorphN))/\ K111 by FUNCT_1:68
      .=(the carrier of TOP-REAL 2)/\ K111 by FUNCT_2:def 1
      .=K111 by XBOOLE_1:28;
    reconsider q=x as Point of TOP-REAL 2 by A43;
A45: y=(cn-FanMorphN).q by A43,FUNCT_1:70;
    consider p2 being Point of TOP-REAL 2 such that
A46: p2=q & p2`1/|.p2.|<=cn & p2`2>=0 & p2<>0.REAL 2 by A43,A44;
A47: cn-FanMorphN.q= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
    |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]| by A1,A46,Th58;
    set q4= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
    |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]|;
    |.q.|<>0 by A46,TOPRNS_1:25;
    then
A48: (|.q.|)^2>0^2 by SQUARE_1:74;
A49: 1+cn>0 by A1,XREAL_1:150;
A50: q4`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))&
    q4`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by EUCLID:56;
A51: (q`1/|.q.|-cn)<=0 by A46,XREAL_1:49;
A52: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
    0<=(q`2)^2 by XREAL_1:65;
    then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
    then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A52,XREAL_1:74;
    then (q`1)^2/(|.q.|)^2 <= 1 by A48,XCMPLX_1:60;
    then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
    then -1<=q`1/|.q.| by SQUARE_1:121;
    then
A53: -1-cn<=q`1/|.q.|-cn by XREAL_1:11;
    (1+cn)/(1+cn)>=(q`1/|.q.|-cn)/(1+cn) by A49,A51,XREAL_1:74;
    then
A54: 1>=(q`1/|.q.|-cn)/(1+cn) by A49,XCMPLX_1:60;
    (-(1+cn))/(1+cn)<=(( q`1/|.q.|-cn))/(1+cn) by A49,A53,XREAL_1:74;
    then -1<=(( q`1/|.q.|-cn))/(1+cn) by A49,XCMPLX_1:198;
    then
A55: (((q`1/|.q.|-cn))/(1+cn))^2<=1^2 by A54,SQUARE_1:119;
    then
A56: 1-((q`1/|.q.|-cn)/(1+cn))^2>=0 by XREAL_1:50;
    1-(-((q`1/|.q.|-cn)/(1+cn)))^2>=0 by A55,XREAL_1:50;
    then 1-((-(q`1/|.q.|-cn))/(1+cn))^2>=0 by XCMPLX_1:188;
    then sqrt(1-((-(q`1/|.q.|-cn))/(1+cn))^2)>=0 by SQUARE_1:def 4;
    then sqrt(1-(-(q`1/|.q.|-cn))^2/(1+cn)^2)>=0 by XCMPLX_1:77;
    then sqrt(1-(q`1/|.q.|-cn)^2/(1+cn)^2)>=0;
    then sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)>=0 by XCMPLX_1:77;
    then
A57: q4`2>= 0 by A50;
A58: (q4`2)^2= (|.q.|)^2*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))^2 by A50
      .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1+cn))^2) by A56,SQUARE_1:def 4;
    (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
      .=(|.q.|)^2 by A50,A58;
    then q4<>0.REAL 2 by A48,TOPRNS_1:24;
    hence y in K1 by A1,A45,A47,A57;
  end;
  then reconsider f4=(cn-FanMorphN)|K111
  as Function of (TOP-REAL 2)|K111,(TOP-REAL 2)|K1 by A41,A42,FUNCT_2:4;
  set T1= ((TOP-REAL 2)|K1)|K00,T2=((TOP-REAL 2)|K1)|K11;
A59: [#](((TOP-REAL 2)|K1)|K00)=K00 by PRE_TOPC:def 10;
A60: [#](((TOP-REAL 2)|K1)|K11)=K11 by PRE_TOPC:def 10;
A61: [#]((TOP-REAL 2)|K1)=K1 by PRE_TOPC:def 10;
A62: K1 c= K00 \/ K11
  proof
    let x be set;
    assume x in K1;
    then consider p such that
A63: p=x & (p`2>=0 & p<>0.REAL 2) by A1;
    per cases;
    suppose p`1/|.p.|>=cn;
      then x in K00 by A63;
      hence x in K00 \/ K11 by XBOOLE_0:def 3;
    end;
    suppose p`1/|.p.|<cn;
      then x in K11 by A63;
      hence x in K00 \/ K11 by XBOOLE_0:def 3;
    end;
  end;
  then
A64: [#](((TOP-REAL 2)|K1)|K00) \/ [#](((TOP-REAL 2)|K1)|K11)
  =[#]((TOP-REAL 2)|K1) by A59,A60,A61,XBOOLE_0:def 10;
A65: K003 is closed by Th65;
A66: K003 /\ K1 c= K00
  proof
    let x be set;
    assume x in K003 /\ K1;
    then
A67: x in K003 & x in K1 by XBOOLE_0:def 4;
    then consider q1 being Point of TOP-REAL 2 such that
A68: q1=x & q1`1>=(cn)*(|.q1.|) & q1`2>=0;
    consider q2 being Point of TOP-REAL 2 such that
A69: q2=x & q2`2>=0 & q2<>0.REAL 2 by A1,A67;
    q1`1/|.q1.|>=(cn)*(|.q1.|)/|.q1.| by A68,XREAL_1:74;
    then q1`1/|.q1.|>=(cn) by A68,A69,TOPRNS_1:25,XCMPLX_1:90;
    hence x in K00 by A68,A69;
  end;
  K00 c= K003 /\ K1
  proof
    let x be set;
    assume x in K00;
    then consider p such that
A70: p=x & (p`1/|.p.|>=cn & p`2>=0 & p<>0.REAL 2);
    p`1/|.p.|*|.p.|>=(cn)*(|.p.|) by A70,XREAL_1:66;
    then p`1>=(cn)*(|.p.|) by A70,TOPRNS_1:25,XCMPLX_1:88;
    then
A71: x in K003 by A70;
    x in K1 by A1,A70;
    hence x in K003 /\ K1 by A71,XBOOLE_0:def 4;
  end;
  then K00=K003 /\ [#]((TOP-REAL 2)|K1) by A61,A66,XBOOLE_0:def 10;
  then
A72: K00 is closed by A65,PRE_TOPC:43;
A73: K004 is closed by Th66;
A74: K004 /\ K1 c= K11
  proof
    let x be set;
    assume x in K004 /\ K1;
    then
A75: x in K004 & x in K1 by XBOOLE_0:def 4;
    then consider q1 being Point of TOP-REAL 2 such that
A76: q1=x & q1`1<=(cn)*(|.q1.|) & q1`2>=0;
    consider q2 being Point of TOP-REAL 2 such that
A77: q2=x & q2`2>=0 & q2<>0.REAL 2 by A1,A75;
    q1`1/|.q1.|<=(cn)*(|.q1.|)/|.q1.| by A76,XREAL_1:74;
    then q1`1/|.q1.|<=(cn) by A76,A77,TOPRNS_1:25,XCMPLX_1:90;
    hence x in K11 by A76,A77;
  end;
  K11 c= K004 /\ K1
  proof
    let x be set;
    assume x in K11;
    then consider p such that
A78: p=x & (p`1/|.p.|<=cn & p`2>=0 & p<>0.REAL 2);
    p`1/|.p.|*|.p.|<=(cn)*(|.p.|) by A78,XREAL_1:66;
    then p`1<=(cn)*(|.p.|) by A78,TOPRNS_1:25,XCMPLX_1:88;
    then
A79: x in K004 by A78;
    x in K1 by A1,A78;
    hence x in K004 /\ K1 by A79,XBOOLE_0:def 4;
  end;
  then K11=K004 /\ [#]((TOP-REAL 2)|K1) by A61,A74,XBOOLE_0:def 10;
  then
A80: K11 is closed by A73,PRE_TOPC:43;
A81: ((TOP-REAL 2)|K1)|K00=(TOP-REAL 2)|K001 by GOBOARD9:4;
  K1 c= D
  proof
    let x be set;
    assume x in K1;
    then consider p6 being Point of TOP-REAL 2 such that
A82: p6=x & p6`2>=0 & p6<>0.REAL 2 by A1;
    x in the carrier of TOP-REAL 2 & not x in {0.REAL 2} by A82,TARSKI:def 1;
    hence x in D by A1,XBOOLE_0:def 5;
  end;
  then D=K1 \/ D by XBOOLE_1:12;
  then
A83: (TOP-REAL 2)|K1 is SubSpace of (TOP-REAL 2)|D by TOPMETR:5;
  the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
  then f1= f3 by A1,FUNCT_1:82;
  then
A84: f1 is continuous by A1,A81,A83,Th63,PRE_TOPC:56;
A85: ((TOP-REAL 2)|K1)|K11=(TOP-REAL 2)|K111 by GOBOARD9:4;
  the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
  then f2= f4 by A1,FUNCT_1:82;
  then
A86: f2 is continuous by A1,A83,A85,Th64,PRE_TOPC:56;
A87: D<>{};
  for p being set st p in ([#]T1)/\([#]T2) holds f1.p = f2.p
  proof
    let p be set;
    assume
A89: p in ([#]T1)/\([#]T2);
    then p in K00 & p in K11 by A59,A60,XBOOLE_0:def 4;
    hence f1.p=f.p by FUNCT_1:72
      .=f2.p by A60,A89,FUNCT_1:72;
  end;
  then consider h being Function of (TOP-REAL 2)|K1,(TOP-REAL 2)|D such that
A90: h=f1+*f2 & h is continuous by A59,A60,A64,A72,A80,A84,A86,JGRAPH_2:9;
A91: dom h=the carrier of ((TOP-REAL 2)|K1) by FUNCT_2:def 1;
A92: the carrier of ((TOP-REAL 2)|K1)=K0 by PRE_TOPC:29;
A93: K0=the carrier of ((TOP-REAL 2)|K0) by PRE_TOPC:29
    .=dom f by A87,FUNCT_2:def 1;
  for y being set st y in dom h holds h.y=f.y
  proof
    let y be set;
    assume
A94: y in dom h;
    per cases by A62,A91,A92,A94,XBOOLE_0:def 3;
    suppose
A95:  y in K00 & not y in K11;
      then y in dom f1 \/ dom f2 by A19,XBOOLE_0:def 3;
      hence h.y=f1.y by A40,A90,A95,FUNCT_4:def 1
        .=f.y by A95,FUNCT_1:72;
    end;
    suppose
A96:  y in K11;
      then y in dom f1 \/ dom f2 by A40,XBOOLE_0:def 3;
      hence h.y=f2.y by A40,A90,A96,FUNCT_4:def 1
        .=f.y by A96,FUNCT_1:72;
    end;
  end;
  hence thesis by A90,A91,A92,A93,FUNCT_1:9;
end;

theorem Th68:
  for cn being Real, K0,B0 being Subset of TOP-REAL 2,f being
  Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0
  st -1<cn & cn<1 & f=(cn-FanMorphN)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} & K0={p: p`2<=0 & p<>0.REAL 2}
  holds f is continuous
proof
  let cn be Real,K0,B0 be Subset of TOP-REAL 2,f be
  Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0;
  assume
A1: -1<cn & cn<1 & f=(cn-FanMorphN)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} & K0={p: p`2<=0 & p<>0.REAL 2};
  set sn=sqrt(1-cn^2);
  set p0=|[cn,-sn]|;
A2: p0`2=-sn by EUCLID:56;
  cn^2<1^2 by A1,SQUARE_1:120;
  then 1-cn^2>0 by XREAL_1:52;
  then --sn>0 by SQUARE_1:93;
  then
A3: p0`2<0 by A2;
  then p0 in K0 by A1,JGRAPH_2:11;
  then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
  p0 in the carrier of TOP-REAL 2 & not p0 in {0.REAL 2}
  by A3,JGRAPH_2:11,TARSKI:def 1;
  then reconsider D=B0 as non empty Subset of TOP-REAL 2 by A1,XBOOLE_0:def 5;
A4: K1 c= D
  proof
    let x be set;
    assume x in K1;
    then consider p2 being Point of TOP-REAL 2 such that
A5: p2=x & p2`2<=0 & p2<>0.REAL 2 by A1;
    not p2 in {0.REAL 2} by A5,TARSKI:def 1;
    hence x in D by A1,A5,XBOOLE_0:def 5;
  end;
  for p being Point of (TOP-REAL 2)|K1,V being Subset of (TOP-REAL 2)|D
  st f.p in V & V is open holds ex W being Subset of (TOP-REAL 2)|K1 st
  p in W & W is open & f.:W c= V
  proof
    let p be Point of (TOP-REAL 2)|K1,V be Subset of (TOP-REAL 2)|D;
    assume
A6: f.p in V & V is open;
    then consider V2 being Subset of TOP-REAL 2 such that
A7: V2 is open & V2 /\ [#]((TOP-REAL 2)|D)=V by TOPS_2:32;
A8: p in the carrier of (TOP-REAL 2)|K1;
A9: [#]((TOP-REAL 2)|K1)=K1 by PRE_TOPC:def 10;
    reconsider W2=V2 /\ [#]((TOP-REAL 2)|K1) as Subset of (TOP-REAL 2)| K1;
A10: W2 is open by A7,TOPS_2:32;
A11: f.p=(cn-FanMorphN).p by A1,A9,FUNCT_1:72;
    consider q being Point of TOP-REAL 2 such that
A12: q=p & q`2<=0 & q <>0.REAL 2 by A1,A8,A9;
    (cn-FanMorphN).q=q by A12,Th56;
    then p in V2 & p in [#]((TOP-REAL 2)|D) by A6,A7,A11,A12,XBOOLE_0:def 4;
    then
A13: p in W2 by XBOOLE_0:def 4;
    f.:W2 c= V
    proof
      let y be set;
      assume y in f.:W2;
      then consider x being set such that
A14:  x in dom f & x in W2 & y=f.x by FUNCT_1:def 12;
      f is Function of (TOP-REAL 2)|K1, (TOP-REAL 2)|D;
      then dom f= K1 by A9,FUNCT_2:def 1;
      then consider p4 being Point of TOP-REAL 2 such that
A15:  x=p4 & p4`2<=0 & p4<>0.REAL 2 by A1,A14;
A16:  f.p4=(cn-FanMorphN).p4 by A1,A9,A14,A15,FUNCT_1:72
        .=p4 by A15,Th56;
A17:  p4 in V2 & p4 in [#]((TOP-REAL 2)|K1) by A14,A15,XBOOLE_0:def 4;
      then p4 in D by A4,A9;
      then p4 in [#]((TOP-REAL 2)|D) by PRE_TOPC:def 10;
      hence y in V by A7,A14,A15,A16,A17,XBOOLE_0:def 4;
    end;
    hence ex W being Subset of (TOP-REAL 2)|K1 st
    p in W & W is open & f.:W c= V by A10,A13;
  end;
  hence f is continuous by JGRAPH_2:20;
end;

theorem Th69:
  for B0 being Subset of TOP-REAL 2, K0 being Subset of (TOP-REAL 2)|B0
  st B0=(the carrier of TOP-REAL 2) \ {0.REAL 2}
  & K0={p: p`2>=0 & p<>0.REAL 2} holds K0 is closed
proof
  defpred P[Point of TOP-REAL 2] means $1`2>=0;
  set I1 = {p: P[p] & p<>0.REAL 2};
  set J0 = (the carrier of TOP-REAL 2) \ {0.REAL 2};
  let B0 be Subset of TOP-REAL 2,K0 be Subset of (TOP-REAL 2)|B0;
  assume
A1: B0=J0 & K0=I1;
  reconsider K1={p7 where p7 is Point of TOP-REAL 2:P[p7]}
  as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
A2: K1 is closed by JORDAN6:8;
  I1 = {p7 where p7 is Point of TOP-REAL 2 : P[p7]} /\ J0 from JGRAPH_3:sch 2;
  then K0=K1 /\ [#]((TOP-REAL 2)|B0) by A1,PRE_TOPC:def 10;
  hence K0 is closed by A2,PRE_TOPC:43;
end;

theorem Th70:
  for B0 being Subset of TOP-REAL 2, K0 being Subset of (TOP-REAL 2)|B0
  st B0=(the carrier of TOP-REAL 2) \ {0.REAL 2}
  & K0={p: p`2<=0 & p<>0.REAL 2} holds K0 is closed
proof
  defpred P[Point of TOP-REAL 2] means $1`2<=0;
  set I1 = {p: P[p] & p<>0.REAL 2};
  set J0 = (the carrier of TOP-REAL 2) \ {0.REAL 2};
  let B0 be Subset of TOP-REAL 2,K0 be Subset of (TOP-REAL 2)|B0;
  assume
A1: B0=J0 & K0=I1;
  reconsider K1={p7 where p7 is Point of TOP-REAL 2:P[p7]}
  as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
A2: K1 is closed by JORDAN6:9;
  I1 = {p7 where p7 is Point of TOP-REAL 2 : P[p7]} /\ J0 from JGRAPH_3:sch 2;
  then K0=K1 /\ [#]((TOP-REAL 2)|B0) by A1,PRE_TOPC:def 10;
  hence K0 is closed by A2,PRE_TOPC:43;
end;

theorem Th71:
  for cn being Real, B0 being Subset of TOP-REAL 2,K0 being Subset of
  (TOP-REAL 2)|B0,f being Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0)
  st -1<cn & cn<1 & f=(cn-FanMorphN)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} & K0={p: p`2>=0 & p<>0.REAL 2}
  holds f is continuous
proof
  let cn be Real, B0 be Subset of TOP-REAL 2,K0 be Subset of
  (TOP-REAL 2)|B0,f be Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0);
  assume
A1: -1<cn & cn<1 & f=(cn-FanMorphN)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} & K0={p: p`2>=0 & p<>0.REAL 2 };
  the carrier of (TOP-REAL 2)|B0= B0 by PRE_TOPC:29;
  then reconsider K1=K0 as Subset of TOP-REAL 2 by XBOOLE_1:1;
  K0 c= B0
  proof
    let x be set;
    assume x in K0;
    then consider p8 being Point of TOP-REAL 2 such that
A2: x=p8 & (p8`2>=0 & p8<>0.REAL 2) by A1;
    not x in {0.REAL 2} by A2,TARSKI:def 1;
    hence x in B0 by A1,A2,XBOOLE_0:def 5;
  end;
  then ((TOP-REAL 2)|B0)|K0=(TOP-REAL 2)|K1 by PRE_TOPC:28;
  hence thesis by A1,Th67;
end;

theorem Th72:
  for cn being Real, B0 being Subset of TOP-REAL 2,K0 being Subset of
  (TOP-REAL 2)|B0,f being Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0)
  st -1<cn & cn<1 & f=(cn-FanMorphN)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} & K0={p: p`2<=0 & p<>0.REAL 2}
  holds f is continuous
proof
  let cn be Real, B0 be Subset of TOP-REAL 2, K0 be Subset of
  (TOP-REAL 2)|B0,f be Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0);
  assume
A1: -1<cn & cn<1 & f=(cn-FanMorphN)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} & K0={p: p`2<=0 & p<>0.REAL 2};
  the carrier of (TOP-REAL 2)|B0= B0 by PRE_TOPC:29;
  then reconsider K1=K0 as Subset of TOP-REAL 2 by XBOOLE_1:1;
  K0 c= B0
  proof
    let x be set;
    assume x in K0;
    then consider p8 being Point of TOP-REAL 2 such that
A2: x=p8 & (p8`2<=0 & p8<>0.REAL 2) by A1;
    not x in {0.REAL 2} by A2,TARSKI:def 1;
    hence x in B0 by A1,A2,XBOOLE_0:def 5;
  end;
  then ((TOP-REAL 2)|B0)|K0=(TOP-REAL 2)|K1 by PRE_TOPC:28;
  hence thesis by A1,Th68;
end;

theorem Th73:
  for cn being Real,p being Point of TOP-REAL 2
  holds |.(cn-FanMorphN).p.|=|.p.|
proof
  let cn be Real,p be Point of TOP-REAL 2;
  set f=cn-FanMorphN;
  set z=f.p;
  reconsider q=p as Point of TOP-REAL 2;
  reconsider qz=z as Point of TOP-REAL 2;
  per cases;
  suppose
A1: q`1/|.q.|>=cn & q`2>0;
    then (cn-FanMorphN).q= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
    |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by Th56;
    then
A2: qz`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))&
    qz`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by EUCLID:56;
    |.q.|<>0 by A1,JGRAPH_2:11,TOPRNS_1:25;
    then
A3: (|.q.|)^2>0 by SQUARE_1:74;
A4: (q`1/|.q.|-cn)>=0 by A1,XREAL_1:50;
A5: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
    0<=(q`2)^2 by XREAL_1:65;
    then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
    then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A5,XREAL_1:74;
    then (q`1)^2/(|.q.|)^2 <= 1 by A3,XCMPLX_1:60;
    then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
    then 1>=q`1/|.q.| by SQUARE_1:121;
    then
A6: 1-cn>=q`1/|.q.|-cn by XREAL_1:11;
    per cases;
    suppose
A7:   1-cn=0;
A8:   ((q`1/|.q.|-cn)/(1-cn))=(q`1/|.q.|-cn)*(1-cn)" by XCMPLX_0:def 9
        .= (q`1/|.q.|-cn)*0 by A7
        .=0;
      then 1-((q`1/|.q.|-cn)/(1-cn))^2=1;
      then (cn-FanMorphN).q= |[ |.q.|*0,|.q.|*1]| by A1,A8,Th56,SQUARE_1:83
        .=|[0,(|.q.|)]|;
      then ((cn-FanMorphN).q)`2=(|.q.|) & ((cn-FanMorphN).q)`1=0 by EUCLID:56;
      then |.(cn-FanMorphN).p.|=sqrt(((|.q.|))^2+0^2) by JGRAPH_3:10
        .=|.q.| by SQUARE_1:89;
      hence |.(cn-FanMorphN).p.|=|.p.|;
    end;
    suppose
A9:   1-cn<>0;
      per cases by A9;
      suppose
A10:    1-cn>0;
        then
A11:    -(1-cn)<= -0;
        -(1-cn)<= -( q`1/|.q.|-cn) by A6,XREAL_1:26;
        then (-(1-cn))/(1-cn)<=(-( q`1/|.q.|-cn))/(1-cn) by A10,XREAL_1:74;
        then
A12:    -1<=(-( q`1/|.q.|-cn))/(1-cn) by A10,XCMPLX_1:198;
        --(1-cn)>= -(q`1/|.q.|-cn) by A4,A11,XREAL_1:26;
        then (-(q`1/|.q.|-cn))/(1-cn)<=1 by A10,XREAL_1:187;
        then ((-(q`1/|.q.|-cn))/(1-cn))^2<=1^2 by A12,SQUARE_1:119;
        then 1-((-(q`1/|.q.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
        then
A13:    1-(-((q`1/|.q.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
A14:    (qz`2)^2= (|.q.|)^2*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))^2 by A2
          .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1-cn))^2) by A13,SQUARE_1:def 4;
        (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
          .=(|.q.|)^2 by A2,A14;
        then sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
        hence |.(cn-FanMorphN).p.|=|.p.| by SQUARE_1:89;
      end;
      suppose
A15:    1-cn<0;
A16:    q`1/|.q.|-cn>=0 by A1,XREAL_1:50;
        0+(q`1)^2<(q`1)^2+(q`2)^2 by A1,SQUARE_1:74,XREAL_1:10;
        then (q`1)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A3,A5,XREAL_1:76;
        then (q`1)^2/(|.q.|)^2 < 1 by A3,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 < 1 by XCMPLX_1:77;
        then 1 > q`1/|.p.| by SQUARE_1:122;
        hence |.(cn-FanMorphN).p.|=|.p.| by A15,A16,XREAL_1:11;
      end;
    end;
  end;
  suppose
A17: q`1/|.q.|<cn & q`2>0;
    then
A18: (cn-FanMorphN).q= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
    |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]| by Th57;
    then
A19: qz`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))&
    qz`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by EUCLID:56;
    |.q.|<>0 by A17,JGRAPH_2:11,TOPRNS_1:25;
    then
A20: (|.q.|)^2>0 by SQUARE_1:74;
A21: (q`1/|.q.|-cn)<0 by A17,XREAL_1:51;
A22: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
    0<=(q`2)^2 by XREAL_1:65;
    then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
    then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A22,XREAL_1:74;
    then (q`1)^2/(|.q.|)^2 <= 1 by A20,XCMPLX_1:60;
    then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
    then -1<=q`1/|.q.| by SQUARE_1:121;
    then
A23: -1-cn<=q`1/|.q.|-cn by XREAL_1:11;
    per cases;
    suppose
A24:  1+cn=0;
      ((q`1/|.q.|-cn)/(1+cn))=(q`1/|.q.|-cn)*(1+cn)" by XCMPLX_0:def 9
        .= (q`1/|.q.|-cn)*0 by A24
        .=0;
      then ((cn-FanMorphN).q)`2=(|.q.|) & ((cn-FanMorphN).q)`1=0
      by A18,EUCLID:56,SQUARE_1:83;
      then |.(cn-FanMorphN).p.|=sqrt(((|.q.|))^2+0^2) by JGRAPH_3:10
        .=|.q.| by SQUARE_1:89;
      hence |.(cn-FanMorphN).p.|=|.p.|;
    end;
    suppose
A25:  1+cn<>0;
      per cases by A25;
      suppose
A26:    1+cn>0;
        then (-(1+cn))/(1+cn)<=(( q`1/|.q.|-cn))/(1+cn) by A23,XREAL_1:74;
        then
A27:    -1<=(( q`1/|.q.|-cn))/(1+cn) by A26,XCMPLX_1:198;
        ((q`1/|.q.|-cn))/(1+cn)<=1 by A21,A26;
        then (((q`1/|.q.|-cn))/(1+cn))^2<=1^2 by A27,SQUARE_1:119;
        then
A28:    1-(((q`1/|.q.|-cn))/(1+cn))^2>=0 by XREAL_1:50;
A29:    (qz`2)^2= (|.q.|)^2*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))^2 by A19
          .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1+cn))^2) by A28,SQUARE_1:def 4;
        (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
          .=(|.q.|)^2 by A19,A29;
        then sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
        hence |.(cn-FanMorphN).p.|=|.p.| by SQUARE_1:89;
      end;
      suppose 1+cn<0;
        then
A30:    -(1+cn)>-0 by XREAL_1:26;
        0+(q`1)^2<(q`1)^2+(q`2)^2 by A17,SQUARE_1:74,XREAL_1:10;
        then (q`1)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A20,A22,XREAL_1:76;
        then (q`1)^2/(|.q.|)^2 < 1 by A20,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 < 1 by XCMPLX_1:77;
        then -1 < q`1/|.p.| by SQUARE_1:122;
        then q`1/|.q.|-cn>-1-cn by XREAL_1:11;
        hence |.(cn-FanMorphN).p.|=|.p.| by A17,A30,XREAL_1:51;
      end;
    end;
  end;
  suppose q`2<=0;
    hence |.(cn-FanMorphN).p.|=|.p.| by Th56;
  end;
end;

theorem Th74:
  for cn being Real,x,K0 being set st -1<cn & cn<1 & x in K0 &
  K0={p: p`2>=0 & p<>0.REAL 2} holds (cn-FanMorphN).x in K0
proof
  let cn be Real,x,K0 be set;
  assume
A1: -1<cn & cn<1 & x in K0 & K0={p: p`2>=0 & p<>0.REAL 2};
  then consider p such that
A2: p=x & p`2>=0 & p<>0.REAL 2;
A3: now
    assume |.p.|<=0;
    then |.p.|=0;
    hence contradiction by A2,TOPRNS_1:25;
  end;
  then
A4: (|.p.|)^2>0 by SQUARE_1:74;
  per cases;
  suppose
A5: p`1/|.p.|<=cn;
    then
A6: (cn-FanMorphN).p= |[ |.p.|*((p`1/|.p.|-cn)/(1+cn)),
    |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]| by A1,A2,Th58;
    reconsider p9= (cn-FanMorphN).p as Point of TOP-REAL 2;
A7: p9`2=|.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)) by A6,EUCLID:56;
A8: 1+cn>0 by A1,XREAL_1:150;
A9: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
    per cases;
    suppose p`2=0;
      hence (cn-FanMorphN).x in K0 by A1,A2,Th56;
    end;
    suppose p`2<>0;
      then 0+(p`1)^2<(p`1)^2+(p`2)^2 by SQUARE_1:74,XREAL_1:10;
      then (p`1)^2/(|.p.|)^2 < (|.p.|)^2/(|.p.|)^2 by A4,A9,XREAL_1:76;
      then (p`1)^2/(|.p.|)^2 < 1 by A4,XCMPLX_1:60;
      then
A10:  ((p`1)/|.p.|)^2 < 1 by XCMPLX_1:77;
      p`1/|.p.|-cn<=0 by A5,XREAL_1:49;
      then
A11:  (p`1/|.p.|-cn)/(1+cn)<(1+cn)/(1+cn) by A8,XREAL_1:76;
      -1 < p`1/|.p.| by A10,SQUARE_1:122;
      then -1-cn< p`1/|.p.|-cn by XREAL_1:11;
      then (-1)*(1+cn)/(1+cn)< (p`1/|.p.|-cn)/(1+cn) by A8,XREAL_1:76;
      then -1< (p`1/|.p.|-cn)/(1+cn) & (p`1/|.p.|-cn)/(1+cn)<1
      by A8,A11,XCMPLX_1:60,90;
      then 1^2> ((p`1/|.p.|-cn)/(1+cn))^2 by SQUARE_1:120;
      then 1-((p`1/|.p.|-cn)/(1+cn))^2>0 by XREAL_1:52;
      then sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)>0 by SQUARE_1:93;
      then |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))>0 by A3,XREAL_1:131;
      hence (cn-FanMorphN).x in K0 by A1,A2,A7,JGRAPH_2:11;
    end;
  end;
  suppose
A12: p`1/|.p.|>cn;
    then
A13: (cn-FanMorphN).p= |[ |.p.|*((p`1/|.p.|-cn)/(1-cn)),
    |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]| by A1,A2,Th58;
    reconsider p9= (cn-FanMorphN).p as Point of TOP-REAL 2;
A14: p9`2=|.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)) by A13,EUCLID:56;
A15: 1-cn>0 by A1,XREAL_1:151;
A16: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
    per cases;
    suppose p`2=0;
      hence (cn-FanMorphN).x in K0 by A1,A2,Th56;
    end;
    suppose p`2<>0;
      then 0+(p`1)^2<(p`1)^2+(p`2)^2 by SQUARE_1:74,XREAL_1:10;
      then (p`1)^2/(|.p.|)^2 < (|.p.|)^2/(|.p.|)^2 by A4,A16,XREAL_1:76;
      then (p`1)^2/(|.p.|)^2 < 1 by A4,XCMPLX_1:60;
      then ((p`1)/|.p.|)^2 < 1 by XCMPLX_1:77;
      then p`1/|.p.|<1 by SQUARE_1:122;
      then (p`1/|.p.|-cn)<1-cn by XREAL_1:11;
      then
A17:  (p`1/|.p.|-cn)/(1-cn)<(1-cn)/(1-cn) by A15,XREAL_1:76;
A18:  -(1-cn)< -0 by A15,XREAL_1:26;
      p`1/|.p.|-cn>=cn-cn by A12,XREAL_1:11;
      then (-1)*(1-cn)/(1-cn)< (p`1/|.p.|-cn)/(1-cn) by A15,A18,XREAL_1:76;
      then -1< (p`1/|.p.|-cn)/(1-cn) & (p`1/|.p.|-cn)/(1-cn)<1
      by A15,A17,XCMPLX_1:60,90;
      then 1^2> ((p`1/|.p.|-cn)/(1-cn))^2 by SQUARE_1:120;
      then 1-((p`1/|.p.|-cn)/(1-cn))^2>0 by XREAL_1:52;
      then sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)>0 by SQUARE_1:93;
      then p9`2>0 by A3,A14,XREAL_1:131;
      hence (cn-FanMorphN).x in K0 by A1,A2,JGRAPH_2:11;
    end;
  end;
end;

theorem Th75:
  for cn being Real,x,K0 being set st -1<cn & cn<1 & x in K0 &
  K0={p: p`2<=0 & p<>0.REAL 2} holds (cn-FanMorphN).x in K0
proof
  let cn be Real,x,K0 be set;
  assume
A1: -1<cn & cn<1 & x in K0 & K0={p: p`2<=0 & p<>0.REAL 2};
  then consider p such that
A2: p=x & p`2<=0 & p<>0.REAL 2;
  thus thesis by A1,A2,Th56;
end;

theorem Th76:
  for cn being Real, D being non empty Subset of TOP-REAL 2
  st -1<cn & cn<1 & D`={0.REAL 2} holds
  ex h being Function of (TOP-REAL 2)|D,(TOP-REAL 2)|D
  st h=(cn-FanMorphN)|D & h is continuous
proof
  let cn be Real,D be non empty Subset of TOP-REAL 2;
  assume
A1: -1<cn & cn<1 & D`={0.REAL 2};
  defpred P[Point of TOP-REAL 2] means $1`2>=0;
  reconsider B0= {0.REAL 2} as Subset of TOP-REAL 2;
A2: D =(B0)` by A1
    .=((the carrier of TOP-REAL 2)\ {0.REAL 2}) by SUBSET_1:def 5;
A3: {p: P[p] & p<>0.REAL 2} c= the carrier of (TOP-REAL 2)|D from InclSub(A2);
  (|[0,1]|)`1=0 & (|[0,1]|)`2=1 by EUCLID:56;
  then |[0,1]| in {p where p is Point of TOP-REAL 2:
  p`2>=0 & p<>0.REAL 2} by JGRAPH_2:11;
  then reconsider K0={p:p`2>=0 & p<>0.REAL 2}
  as non empty Subset of (TOP-REAL 2)|D by A3;
  defpred P[Point of TOP-REAL 2] means $1`2<=0;
A4: {p: P[p] & p<>0.REAL 2} c= the carrier of (TOP-REAL 2)|D from InclSub(A2);
  set Y1=|[0,-1]|;
A5: Y1`1=0 & Y1`2=-1 by EUCLID:56;
  0.REAL 2 <> Y1 by EUCLID:56,JGRAPH_2:11;
  then Y1 in {p where p is Point of TOP-REAL 2: p`2<=0 & p<>0.REAL 2} by A5;
  then reconsider K1={p: p`2<=0 & p<>0.REAL 2}
  as non empty Subset of (TOP-REAL 2)|D by A4;
A6: the carrier of ((TOP-REAL 2)|D)=D by PRE_TOPC:29;
A7: K0 c= (the carrier of TOP-REAL 2)
  proof
    let z be set;
    assume z in K0;
    then consider p8 being Point of TOP-REAL 2 such that
A8: p8=z & p8`2>=0 & p8<>0.REAL 2;
    thus z in (the carrier of TOP-REAL 2) by A8;
  end;
A9: dom ((cn-FanMorphN)|K0)= dom ((cn-FanMorphN)) /\ K0 by FUNCT_1:68
    .=((the carrier of TOP-REAL 2)) /\ K0 by FUNCT_2:def 1
    .=K0 by A7,XBOOLE_1:28;
A10: K0=the carrier of ((TOP-REAL 2)|D)|K0 by PRE_TOPC:29;
  rng ((cn-FanMorphN)|K0) c= the carrier of ((TOP-REAL 2)|D)|K0
  proof
    let y be set;
    assume y in rng ((cn-FanMorphN)|K0);
    then consider x being set such that
A11: x in dom ((cn-FanMorphN)|K0) & y=((cn-FanMorphN)|K0).x by FUNCT_1:def 5;
    x in (dom (cn-FanMorphN)) /\ K0 by A11,FUNCT_1:68;
    then
A12: x in K0 by XBOOLE_0:def 4;
    K0 c= the carrier of TOP-REAL 2 by A6,XBOOLE_1:1;
    then reconsider p=x as Point of TOP-REAL 2 by A12;
    (cn-FanMorphN).p=y by A11,A12,FUNCT_1:72;
    then y in K0 by A1,A12,Th74;
    hence y in the carrier of ((TOP-REAL 2)|D)|K0 by PRE_TOPC:29;
  end;
  then reconsider f=(cn-FanMorphN)|K0 as Function of ((TOP-REAL 2)|D)|K0,
  ((TOP-REAL 2)|D) by A9,A10,FUNCT_2:4,XBOOLE_1:1;
A13: K1 c= (the carrier of TOP-REAL 2)
  proof
    let z be set;
    assume z in K1;
    then consider p8 being Point of TOP-REAL 2 such that
A14: p8=z & p8`2<=0 & p8<>0.REAL 2;
    thus z in (the carrier of TOP-REAL 2) by A14;
  end;
A15: dom ((cn-FanMorphN)|K1)= dom ((cn-FanMorphN)) /\ K1 by FUNCT_1:68
    .=((the carrier of TOP-REAL 2)) /\ K1 by FUNCT_2:def 1
    .=K1 by A13,XBOOLE_1:28;
A16: K1=the carrier of ((TOP-REAL 2)|D)|K1 by PRE_TOPC:29;
  rng ((cn-FanMorphN)|K1) c= the carrier of ((TOP-REAL 2)|D)|K1
  proof
    let y be set;
    assume y in rng ((cn-FanMorphN)|K1);
    then consider x being set such that
A17: x in dom ((cn-FanMorphN)|K1) & y=((cn-FanMorphN)|K1).x by FUNCT_1:def 5;
    x in (dom (cn-FanMorphN)) /\ K1 by A17,FUNCT_1:68;
    then
A18: x in K1 by XBOOLE_0:def 4;
    K1 c= the carrier of TOP-REAL 2 by A6,XBOOLE_1:1;
    then reconsider p=x as Point of TOP-REAL 2 by A18;
    (cn-FanMorphN).p=y by A17,A18,FUNCT_1:72;
    then y in K1 by A1,A18,Th75;
    hence y in the carrier of ((TOP-REAL 2)|D)|K1 by PRE_TOPC:29;
  end;
  then reconsider g=(cn-FanMorphN)|K1 as Function of ((TOP-REAL 2)|D)|K1,
  ((TOP-REAL 2)|D) by A15,A16,FUNCT_2:4,XBOOLE_1:1;
A19: K0=[#](((TOP-REAL 2)|D)|K0) by PRE_TOPC:def 10;
A20: K1=[#](((TOP-REAL 2)|D)|K1) by PRE_TOPC:def 10;
A21: D= [#]((TOP-REAL 2)|D) by PRE_TOPC:def 10;
  D c= K0 \/ K1
  proof
    let x be set;
    assume
A22: x in D;
    then
A23: x in (the carrier of TOP-REAL 2) & not x in {0.REAL 2}
    by A2,XBOOLE_0:def 5;
    reconsider px=x as Point of TOP-REAL 2 by A22;
    px`2>=0 & px<>0.REAL 2 or px`2<=0 & px<>0.REAL 2 by A23,TARSKI:def 1;
    then x in K0 or x in K1;
    hence x in K0 \/ K1 by XBOOLE_0:def 3;
  end;
  then
A24: ([#](((TOP-REAL 2)|D)|K0)) \/ ([#](((TOP-REAL 2)|D)|K1))
  = [#]((TOP-REAL 2)|D) by A19,A20,A21,XBOOLE_0:def 10;
A25: f is continuous & K0 is closed by A1,A2,Th69,Th71;
A26: g is continuous & K1 is closed by A1,A2,Th70,Th72;
A27: for x be set st x in ([#]((((TOP-REAL 2)|D)|K0)))
  /\ ([#] ((((TOP-REAL 2)|D)|K1))) holds f.x = g.x
  proof
    let x be set;
    assume
A28: x in ([#]((((TOP-REAL 2)|D)|K0))) /\ ([#] ((((TOP-REAL 2)|D)|K1)));
    then x in K0 & x in K1 by A19,A20,XBOOLE_0:def 4;
    then f.x=(cn-FanMorphN).x by FUNCT_1:72;
    hence f.x = g.x by A20,A28,FUNCT_1:72;
  end;
  then consider h being Function of (TOP-REAL 2)|D,(TOP-REAL 2)|D such that
A29: h= f+*g & h is continuous by A19,A20,A24,A25,A26,JGRAPH_2:9;
A30: dom h=the carrier of ((TOP-REAL 2)|D) by FUNCT_2:def 1;
A31: the carrier of ((TOP-REAL 2)|D)=D by PRE_TOPC:29;
A32: the carrier of ((TOP-REAL 2)|D) =
  ((the carrier of TOP-REAL 2)\ {0.REAL 2}) by A2,PRE_TOPC:29;
  dom (cn-FanMorphN)=(the carrier of (TOP-REAL 2)) by FUNCT_2:def 1;
  then
A33: dom ((cn-FanMorphN)|D)=(the carrier of (TOP-REAL 2))/\ D by FUNCT_1:68
    .=the carrier of ((TOP-REAL 2)|D) by A31,XBOOLE_1:28;
A34: dom f=K0 by A10,FUNCT_2:def 1;
A35: K0=[#](((TOP-REAL 2)|D)|K0) by PRE_TOPC:def 10;
A36: dom g=K1 by A16,FUNCT_2:def 1;
  K1=[#](((TOP-REAL 2)|D)|K1) by PRE_TOPC:def 10;
  then
A37: f tolerates g by A27,A34,A35,A36,PARTFUN1:def 6;
  for x being set st x in dom h holds h.x=((cn-FanMorphN)|D).x
  proof
    let x be set;
    assume
A38: x in dom h;
    then x in (the carrier of TOP-REAL 2) & not x in {0.REAL 2}
    by A32,XBOOLE_0:def 5;
    then
A39: x <>0.REAL 2 by TARSKI:def 1;
    reconsider p=x as Point of TOP-REAL 2 by A32,A38,XBOOLE_0:def 5;
A40: x in D`` by A30,A38,PRE_TOPC:29;
    now per cases;
      case
A41:    x in K0;
A42:    (cn-FanMorphN)|D.p=(cn-FanMorphN).p by A40,FUNCT_1:72
          .=f.p by A41,FUNCT_1:72;
        h.p=(g+*f).p by A29,A37,FUNCT_4:35
          .=f.p by A34,A41,FUNCT_4:14;
        hence h.x=(cn-FanMorphN)|D.x by A42;
      end;
      case not x in K0;
        then not (p`2>=0) by A39;
        then
A43:    x in K1 by A39;
        (cn-FanMorphN)|D.p=(cn-FanMorphN).p by A40,FUNCT_1:72
          .=g.p by A43,FUNCT_1:72;
        hence h.x=(cn-FanMorphN)|D.x by A29,A36,A43,FUNCT_4:14;
      end;
    end;
    hence h.x=(cn-FanMorphN)|D.x;
  end;
  then f+*g=(cn-FanMorphN)|D by A29,A30,A33,FUNCT_1:9;
  hence thesis by A19,A20,A24,A25,A26,A27,JGRAPH_2:9;
end;

theorem Th77:
  for cn being Real st -1<cn & cn<1 holds
  ex h being Function of (TOP-REAL 2),(TOP-REAL 2)
  st h=(cn-FanMorphN) & h is continuous
proof
  let cn be Real;
  assume
A1: -1<cn & cn<1;
  reconsider f=(cn-FanMorphN) as Function of (TOP-REAL 2),(TOP-REAL 2);
  reconsider D=(the carrier of TOP-REAL 2) \{0.REAL 2}
  as non empty Subset of TOP-REAL 2 by JGRAPH_2:19;
A2: f.(0.REAL 2)=0.REAL 2 by Th56,JGRAPH_2:11;
A3: D`= {0.REAL 2} by JGRAPH_3:30;
A4: for p being Point of (TOP-REAL 2)|D holds f.p<>f.(0.REAL 2)
  proof
    let p be Point of (TOP-REAL 2)|D;
A5: [#]((TOP-REAL 2)|D)=D by PRE_TOPC:def 10;
    then
A6: p in the carrier of TOP-REAL 2 & not p in {0.REAL 2} by XBOOLE_0:def 5;
    reconsider q=p as Point of TOP-REAL 2 by A5,XBOOLE_0:def 5;
A7: not p=0.REAL 2 by A6,TARSKI:def 1;
    now per cases;
      case
A8:     q`1/|.q.|>=cn & q`2>=0;
        set q9= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
        |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]|;
A9:     q9`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)) &
        q9`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by EUCLID:56;
        now
          assume
A10:      q9=0.REAL 2;
A11:      |.q.|<>0^2 by A7,TOPRNS_1:25;
          then sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)= sqrt(1-0) by A9,A10,
JGRAPH_2:11,XCMPLX_1:6
            .=1 by SQUARE_1:83;
          hence contradiction by A10,A11,EUCLID:56,JGRAPH_2:11;
        end;
        hence f.p<>f.(0.REAL 2) by A1,A2,A7,A8,Th58;
      end;
      case
A12:    q`1/|.q.|<cn & q`2>=0;
        set q9=|[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
        |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]|;
A13:    q9`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)) &
        q9`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by EUCLID:56;
        now
          assume
A14:      q9=0.REAL 2;
A15:      |.q.|<>0^2 by A7,TOPRNS_1:25;
          then sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)= sqrt(1-0) by A13,A14,
JGRAPH_2:11,XCMPLX_1:6
            .=1 by SQUARE_1:83;
          hence contradiction by A14,A15,EUCLID:56,JGRAPH_2:11;
        end;
        hence f.p<>f.(0.REAL 2) by A1,A2,A7,A12,Th58;
      end;
      case q`2<0;
        then f.p=p by Th56;
        hence f.p<>f.(0.REAL 2) by A7,Th56,JGRAPH_2:11;
      end;
    end;
    hence f.p<>f.(0.REAL 2);
  end;
A16: ex h being Function of (TOP-REAL 2)|D,(TOP-REAL 2)|D
  st h=(cn-FanMorphN)|D & h is continuous by A1,A3,Th76;
  for V being Subset of (TOP-REAL 2) st f.(0.REAL 2) in V & V is open
  ex W being Subset of (TOP-REAL 2) st 0.REAL 2 in W & W is open & f.:W c= V
  proof
    let V be Subset of (TOP-REAL 2);
    assume
A17: f.(0.REAL 2) in V & V is open;
    reconsider u0=0.REAL 2 as Point of Euclid 2;
    consider r being real number such that
A18: r>0 & Ball(u0,r) c= V by A2,A17,TOPMETR:22;
    reconsider r as Real by XREAL_0:def 1;
    reconsider W1=Ball(u0,r) as Subset of TOP-REAL 2;
A19: u0 in W1 by A18,GOBOARD6:4;
A20: W1 is open by GOBOARD6:6;
    f.:W1 c= W1
    proof
      let z be set;
      assume z in f.:W1;
      then consider y being set such that
A21:  y in dom f & y in W1 & z=f.y by FUNCT_1:def 12;
      reconsider q=y as Point of TOP-REAL 2 by A21;
      reconsider qy=q as Point of Euclid 2;
      z in rng f by A21,FUNCT_1:def 5;
      then reconsider qz=z as Point of TOP-REAL 2;
      reconsider pz=qz as Point of Euclid 2;
      dist(u0,qy)<r by A21,METRIC_1:12;
      then
A22:  |.(0.REAL 2) - q.|<r by JGRAPH_1:45;
      now per cases by JGRAPH_2:11;
        case q`2<=0;
          hence z in W1 by A21,Th56;
        end;
        case
A23:      q<>0.REAL 2 & (q`1/|.q.|>=cn & q`2>=0);
          then
A24:      (cn-FanMorphN).q= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)) ,
          |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by A1,Th58;
          |.q.|<>0 by A23,TOPRNS_1:25;
          then
A25:      (|.q.|)^2>0 by SQUARE_1:74;
A26:      1-cn>0 by A1,XREAL_1:151;
A27:      qz`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))&
          qz`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by A21,A24,EUCLID:56;
A28:      (q`1/|.q.|-cn)>= 0 by A23,XREAL_1:50;
A29:      (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
          0<=(q`2)^2 by XREAL_1:65;
          then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
          then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2
           by A29,XREAL_1:74;
          then (q`1)^2/(|.q.|)^2 <= 1 by A25,XCMPLX_1:60;
          then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
          then 1>=q`1/|.q.| by SQUARE_1:121;
          then
A30:      1-cn>=q`1/|.q.|-cn by XREAL_1:11;
A31:      -(1-cn)<= -0 by A26;
          -(1-cn)<= -( q`1/|.q.|-cn) by A30,XREAL_1:26;
          then (-(1-cn))/(1-cn)<=(-( q`1/|.q.|-cn))/(1-cn)
           by A26,XREAL_1:74;
          then
A32:      -1<=(-( q`1/|.q.|-cn))/(1-cn) by A26,XCMPLX_1:198;
          --(1-cn)>= -(q`1/|.q.|-cn) by A28,A31,XREAL_1:26;
          then (-(q`1/|.q.|-cn))/(1-cn)<=1 by A26,XREAL_1:187;
          then ((-(q`1/|.q.|-cn))/(1-cn))^2<=1^2 by A32,SQUARE_1:119;
          then 1-((-(q`1/|.q.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
          then
A33:      1-(-((q`1/|.q.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
A34:      (qz`2)^2= (|.q.|)^2*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))^2 by A27
            .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1-cn))^2) by A33,SQUARE_1:def 4;
          (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
            .=(|.q.|)^2 by A27,A34;
          then sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
          then
A35:      |.qz.|=|.q.| by SQUARE_1:89;
          |.(0.REAL 2) +- q.|<r by A22,EUCLID:45;
          then |.- q.|<r by EUCLID:31;
          then |.q.|<r by TOPRNS_1:27;
          then |.- qz.|<r by A35,TOPRNS_1:27;
          then |.(0.REAL 2) +- qz.|<r by EUCLID:31;
          then |.(0.REAL 2) - qz.|<r by EUCLID:45;
          then dist(u0,pz)<r by JGRAPH_1:45;
          hence z in W1 by METRIC_1:12;
        end;
        case
A36:      q<>0.REAL 2 & q`1/|.q.|<cn & q`2>=0;
          then
A37:      (cn-FanMorphN).q= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
          |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]| by A1,Th58;
          |.q.|<>0 by A36,TOPRNS_1:25;
          then
A38:      (|.q.|)^2>0 by SQUARE_1:74;
A39:      (cn-q`1/|.q.|)>=0 by A36,XREAL_1:50;
A40:      (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
A41:      1+cn>0 by A1,XREAL_1:150;
A42:      qz`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))&
          qz`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by A21,A37,EUCLID:56;
          0<=(q`2)^2 by XREAL_1:65;
          then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
          then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2
           by A40,XREAL_1:74;
          then (q`1)^2/(|.q.|)^2 <= 1 by A38,XCMPLX_1:60;
          then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
          then -1<=q`1/|.q.| by SQUARE_1:121;
          then --1>=-q`1/|.q.| by XREAL_1:26;
          then
A43:      1+cn>=-q`1/|.q.|+cn by XREAL_1:9;
          (-(1+cn))/(1+cn)<=(-( q`1/|.q.|-cn))/(1+cn)
          by A39,A41,XREAL_1:74;
          then
A44:      -1<=(-( q`1/|.q.|-cn))/(1+cn) by A41,XCMPLX_1:198;
          (-(q`1/|.q.|-cn))/(1+cn)<=1 by A41,A43,XREAL_1:187;
          then ((-(q`1/|.q.|-cn))/(1+cn))^2<=1^2 by A44,SQUARE_1:119;
          then 1-((-(q`1/|.q.|-cn))/(1+cn))^2>=0 by XREAL_1:50;
          then
A45:      1-(-((q`1/|.q.|-cn))/(1+cn))^2>=0 by XCMPLX_1:188;
A46:      (qz`2)^2= (|.q.|)^2*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))^2 by A42
            .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1+cn))^2) by A45,SQUARE_1:def 4;
          (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
            .=(|.q.|)^2 by A42,A46;
          then sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
          then
A47:      |.qz.|=|.q.| by SQUARE_1:89;
          |.(0.REAL 2) +- q.|<r by A22,EUCLID:45;
          then |.- q.|<r by EUCLID:31;
          then |.q.|<r by TOPRNS_1:27;
          then |.- qz.|<r by A47,TOPRNS_1:27;
          then |.(0.REAL 2) +- qz.|<r by EUCLID:31;
          then |.(0.REAL 2) - qz.|<r by EUCLID:45;
          then dist(u0,pz)<r by JGRAPH_1:45;
          hence z in W1 by METRIC_1:12;
        end;
      end;
      hence z in W1;
    end;
    hence ex W being Subset of (TOP-REAL 2) st 0.REAL 2 in W
    & W is open & f.:W c= V by A18,A19,A20,XBOOLE_1:1;
  end;
  then f is continuous by A2,A3,A4,A16,JGRAPH_3:13;
  hence thesis;
end;

theorem Th78:
  for cn being Real st -1<cn & cn<1 holds cn-FanMorphN is one-to-one
proof
  let cn be Real;
  assume
A1: -1<cn & cn<1;
  for x1,x2 being set st x1 in dom (cn-FanMorphN) & x2 in dom (cn-FanMorphN)
  & (cn-FanMorphN).x1=(cn-FanMorphN).x2 holds x1=x2
  proof
    let x1,x2 be set;
    assume
A2: x1 in dom (cn-FanMorphN) & x2 in dom (cn-FanMorphN)
    & (cn-FanMorphN).x1=(cn-FanMorphN).x2;
    then reconsider p1=x1 as Point of TOP-REAL 2;
    reconsider p2=x2 as Point of TOP-REAL 2 by A2;
    set q=p1,p=p2;
A3: 1-cn>0 by A1,XREAL_1:151;
    now per cases by JGRAPH_2:11;
      case
A4:     q`2<=0;
        then
A5:     (cn-FanMorphN).q=q by Th56;
        now per cases by JGRAPH_2:11;
          case p`2<=0;
            hence x1=x2 by A2,A5,Th56;
          end;
          case
A6:         p<>0.REAL 2 & (p`1/|.p.|>=cn & p`2>=0);
            then
A7:         cn-FanMorphN.p= |[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
            |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]| by A1,Th58;
            set p4= |[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
            |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]|;
A8:         p4`2= |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)) &
            p4`1= |.p.|* ((p`1/|.p.|-cn)/(1-cn)) by EUCLID:56;
A9:         |.p.|>0 by A6,Lm1;
            then
A10:        (|.p.|)^2>0 by SQUARE_1:74;
A11:        (p`1/|.p.|-cn)>=0 by A6,XREAL_1:50;
A12:        (p`1/|.p.|-cn)>= 0 by A6,XREAL_1:50;
A13:        (p`1/|.p.|-cn)/(1-cn)>=0 by A3,A11;
A14:        (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
            0<=(p`2)^2 by XREAL_1:65;
            then 0+(p`1)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
            then (p`1)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2
             by A14,XREAL_1:74;
            then (p`1)^2/(|.p.|)^2 <= 1 by A10,XCMPLX_1:60;
            then ((p`1)/|.p.|)^2 <= 1 by XCMPLX_1:77;
            then 1>=p`1/|.p.| by SQUARE_1:121;
            then
A15:        1-cn>=p`1/|.p.|-cn by XREAL_1:11;
A16:        -(1-cn)<= -0 by A3;
            -(1-cn)<= -( p`1/|.p.|-cn) by A15,XREAL_1:26;
            then (-(1-cn))/(1-cn)<=(-( p`1/|.p.|-cn))/(1-cn)
             by A3,XREAL_1:74;
            then
A17:        -1<=(-( p`1/|.p.|-cn))/(1-cn) by A3,XCMPLX_1:198;
            --(1-cn)>= -(p`1/|.p.|-cn) by A12,A16,XREAL_1:26;
            then (-(p`1/|.p.|-cn))/(1-cn)<=1 by A3,XREAL_1:187;
            then ((-(p`1/|.p.|-cn))/(1-cn))^2<=1^2 by A17,SQUARE_1:119;
            then
A18:        1-((-(p`1/|.p.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
            then
A19:        1-(-((p`1/|.p.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
            sqrt(1-((-(p`1/|.p.|-cn))/(1-cn))^2)>=0 by A18,SQUARE_1:def 4;
            then sqrt(1-(-(p`1/|.p.|-cn))^2/(1-cn)^2)>=0 by XCMPLX_1:77;
            then sqrt(1-(p`1/|.p.|-cn)^2/(1-cn)^2)>=0;
            then sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)>=0 by XCMPLX_1:77;
            then q`2=0 by A2,A4,A5,A7,A8;
            then ( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))=0 by A2,A5,A7,A8,A9,
XCMPLX_1:6;
            then 1-((p`1/|.p.|-cn)/(1-cn))^2=0 by A19,SQUARE_1:92;
            then 1= (p`1/|.p.|-cn)/(1-cn) by A13,SQUARE_1:83,89;
            then 1 *(1-cn)=(p`1/|.p.|-cn) by A3,XCMPLX_1:88;
            then 1 *|.p.|=p`1 by A9,XCMPLX_1:88;
            then p`2=0 by A14,XCMPLX_1:6;
            hence x1=x2 by A2,A5,Th56;
          end;
          case
A20:        p<>0.REAL 2 & (p`1/|.p.|<cn & p`2>=0);
            then
A21:        cn-FanMorphN.p= |[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
            |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]| by A1,Th58;
            set p4= |[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
            |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]|;
A22:        p4`2= |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)) &
            p4`1= |.p.|* ((p`1/|.p.|-cn)/(1+cn)) by EUCLID:56;
A23:        |.p.|<>0 by A20,TOPRNS_1:25;
            then
A24:        (|.p.|)^2>0 by SQUARE_1:74;
A25:        1+cn>0 by A1,XREAL_1:150;
A26:        (p`1/|.p.|-cn)<=0 by A20,XREAL_1:49;
            then
A27:        -(p`1/|.p.|-cn)>= -0;
            --(p`1/|.p.|-cn)/(1+cn)<=0 by A25,A26;
            then
A28:        -((p`1/|.p.|-cn)/(1+cn))>=0;
A29:        (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
            0<=(p`2)^2 by XREAL_1:65;
            then 0+(p`1)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
            then (p`1)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2
             by A29,XREAL_1:74;
            then (p`1)^2/(|.p.|)^2 <= 1 by A24,XCMPLX_1:60;
            then ((p`1)/|.p.|)^2 <= 1 by XCMPLX_1:77;
            then
A30:        (-((p`1)/|.p.|))^2 <= 1;
            (-(1+cn))/(1+cn)<=(-( p`1/|.p.|-cn))/(1+cn)
            by A25,A27,XREAL_1:74;
            then
A31:        -1<=(-( p`1/|.p.|-cn))/(1+cn) by A25,XCMPLX_1:198;
            1>= -p`1/|.p.| by A30,SQUARE_1:121;
            then (1+cn)>= -p`1/|.p.|+cn by XREAL_1:9;
            then (-(p`1/|.p.|-cn))/(1+cn)<=1 by A25,XREAL_1:187;
            then ((-(p`1/|.p.|-cn))/(1+cn))^2<=1^2 by A31,SQUARE_1:119;
            then
A32:        1-((-(p`1/|.p.|-cn))/(1+cn))^2>=0 by XREAL_1:50;
            then
A33:        1-(-((p`1/|.p.|-cn))/(1+cn))^2>=0 by XCMPLX_1:188;
            sqrt(1-((-(p`1/|.p.|-cn))/(1+cn))^2)>=0 by A32,SQUARE_1:def 4;
            then sqrt(1-(-(p`1/|.p.|-cn))^2/(1+cn)^2)>=0 by XCMPLX_1:77;
            then sqrt(1-((p`1/|.p.|-cn))^2/(1+cn)^2)>=0;
            then sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)>=0 by XCMPLX_1:77;
            then q`2=0 by A2,A4,A5,A21,A22;
            then ( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))=0 by A2,A5,A21,A22,A23,
XCMPLX_1:6;
            then 1-((p`1/|.p.|-cn)/(1+cn))^2=0 by A33,SQUARE_1:92;
            then 1=sqrt((-((p`1/|.p.|-cn)/(1+cn)))^2) by SQUARE_1:83;
            then 1= -((p`1/|.p.|-cn)/(1+cn)) by A28,SQUARE_1:89;
            then 1= ((-(p`1/|.p.|-cn))/(1+cn)) by XCMPLX_1:188;
            then 1 *(1+cn)=-(p`1/|.p.|-cn) by A25,XCMPLX_1:88;
            then 1+cn-cn=-p`1/|.p.|;
            then 1=(-p`1)/|.p.| by XCMPLX_1:188;
            then 1 *|.p.|=-p`1 by A20,TOPRNS_1:25,XCMPLX_1:88;
            then (p`1)^2-(p`1)^2 =(p`2)^2 by A29,XCMPLX_1:26;
            then p`2=0 by XCMPLX_1:6;
            hence x1=x2 by A2,A5,Th56;
          end;
        end;
        hence x1=x2;
      end;
      case
A34:    q`1/|.q.|>=cn & q`2>=0 & q<>0.REAL 2;
        then
A35:    cn-FanMorphN.q= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
        |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by A1,Th58;
        set q4= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
        |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]|;
A36:    q4`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)) &
        q4`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by EUCLID:56;
        |.q.|<>0 by A34,TOPRNS_1:25;
        then
A37:    (|.q.|)^2>0 by SQUARE_1:74;
        now per cases by JGRAPH_2:11;
          case
A38:        p`2<=0;
            then
A39:        (cn-FanMorphN).p=p by Th56;
A40:        |.q.|<>0 by A34,TOPRNS_1:25;
            then
A41:        (|.q.|)^2>0 by SQUARE_1:74;
A42:        1-cn>0 by A1,XREAL_1:151;
A43:        (q`1/|.q.|-cn)>=0 by A34,XREAL_1:50;
A44:        (q`1/|.q.|-cn)>= 0 by A34,XREAL_1:50;
A45:        (q`1/|.q.|-cn)/(1-cn)>=0 by A42,A43;
A46:        (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
            0<=(q`2)^2 by XREAL_1:65;
            then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
            then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2
             by A46,XREAL_1:74;
            then (q`1)^2/(|.q.|)^2 <= 1 by A41,XCMPLX_1:60;
            then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
            then 1>=q`1/|.q.| by SQUARE_1:121;
            then
A47:        1-cn>=q`1/|.q.|-cn by XREAL_1:11;
A48:        -(1-cn)<= -0 by A42;
            -(1-cn)<= -( q`1/|.q.|-cn) by A47,XREAL_1:26;
            then (-(1-cn))/(1-cn)<=(-( q`1/|.q.|-cn))/(1-cn)
             by A42,XREAL_1:74;
            then
A49:        -1<=(-( q`1/|.q.|-cn))/(1-cn) by A42,XCMPLX_1:198;
            --(1-cn)>= -(q`1/|.q.|-cn) by A44,A48,XREAL_1:26;
            then (-(q`1/|.q.|-cn))/(1-cn)<=1 by A42,XREAL_1:187;
            then ((-(q`1/|.q.|-cn))/(1-cn))^2<=1^2 by A49,SQUARE_1:119;
            then
A50:        1-((-(q`1/|.q.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
            then
A51:        1-(-((q`1/|.q.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
            sqrt(1-((-(q`1/|.q.|-cn))/(1-cn))^2)>=0 by A50,SQUARE_1:def 4;
            then sqrt(1-(-(q`1/|.q.|-cn))^2/(1-cn)^2)>=0 by XCMPLX_1:77;
            then sqrt(1-(q`1/|.q.|-cn)^2/(1-cn)^2)>=0;
            then sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)>=0 by XCMPLX_1:77;
            then p`2=0 by A2,A35,A36,A38,A39;
            then ( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))=0 by A2,A35,A36,A39,A40,
XCMPLX_1:6;
            then 1-((q`1/|.q.|-cn)/(1-cn))^2=0 by A51,SQUARE_1:92;
            then 1= (q`1/|.q.|-cn)/(1-cn) by A45,SQUARE_1:83,89;
            then 1 *(1-cn)=(q`1/|.q.|-cn) by A42,XCMPLX_1:88;
            then 1 *|.q.|=q`1 by A34,TOPRNS_1:25,XCMPLX_1:88;
            then q`2=0 by A46,XCMPLX_1:6;
            hence x1=x2 by A2,A39,Th56;
          end;
          case
A52:        p<>0.REAL 2 & (p`1/|.p.|>=cn & p`2>=0);
            then
A53:        cn-FanMorphN.p= |[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
            |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]| by A1,Th58;
            set p4= |[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
            |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]|;
A54:        p4`2= |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)) &
            p4`1= |.p.|* ((p`1/|.p.|-cn)/(1-cn)) by EUCLID:56;
A55:        q4`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))&
            q4`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by EUCLID:56;
A56:        (q`1/|.q.|-cn)>= 0 by A34,XREAL_1:50;
A57:        (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
            0<=(q`2)^2 by XREAL_1:65;
            then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
            then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2
             by A57,XREAL_1:74;
            then (q`1)^2/(|.q.|)^2 <= 1 by A37,XCMPLX_1:60;
            then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
            then 1>=q`1/|.q.| by SQUARE_1:121;
            then
A58:        1-cn>=q`1/|.q.|-cn by XREAL_1:11;
A59:        -(1-cn)<= -0 by A3;
            -(1-cn)<= -( q`1/|.q.|-cn) by A58,XREAL_1:26;
            then (-(1-cn))/(1-cn)<=(-( q`1/|.q.|-cn))/(1-cn)
             by A3,XREAL_1:74;
            then
A60:        -1<=(-( q`1/|.q.|-cn))/(1-cn) by A3,XCMPLX_1:198;
            --(1-cn)>= -(q`1/|.q.|-cn) by A56,A59,XREAL_1:26;
            then (-(q`1/|.q.|-cn))/(1-cn)<=1 by A3,XREAL_1:187;
            then ((-(q`1/|.q.|-cn))/(1-cn))^2<=1^2 by A60,SQUARE_1:119;
            then 1-((-(q`1/|.q.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
            then
A61:        1-(-((q`1/|.q.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
A62:        (q4`2)^2= (|.q.|)^2*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))^2 by A55
              .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1-cn))^2) by A61,SQUARE_1:def 4;
            (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
              .=(|.q.|)^2 by A55,A62;
            then
A63:        sqrt((|.q4.|)^2)=|.q.| by SQUARE_1:89;
            then
A64:        |.q4.|=|.q.| by SQUARE_1:89;
            |.p.|<>0 by A52,TOPRNS_1:25;
            then
A65:        (|.p.|)^2>0 by SQUARE_1:74;
A66:        (p`1/|.p.|-cn)>= 0 by A52,XREAL_1:50;
A67:        (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
            0<=(p`2)^2 by XREAL_1:65;
            then 0+(p`1)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
            then (p`1)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2
             by A67,XREAL_1:74;
            then (p`1)^2/(|.p.|)^2 <= 1 by A65,XCMPLX_1:60;
            then ((p`1)/|.p.|)^2 <= 1 by XCMPLX_1:77;
            then 1>=p`1/|.p.| by SQUARE_1:121;
            then
A68:        1-cn>=p`1/|.p.|-cn by XREAL_1:11;
A69:        -(1-cn)<= -0 by A3;
            -(1-cn)<= -( p`1/|.p.|-cn) by A68,XREAL_1:26;
            then (-(1-cn))/(1-cn)<=(-( p`1/|.p.|-cn))/(1-cn)
             by A3,XREAL_1:74;
            then
A70:        -1<=(-( p`1/|.p.|-cn))/(1-cn) by A3,XCMPLX_1:198;
            --(1-cn)>= -(p`1/|.p.|-cn) by A66,A69,XREAL_1:26;
            then (-(p`1/|.p.|-cn))/(1-cn)<=1 by A3,XREAL_1:187;
            then ((-(p`1/|.p.|-cn))/(1-cn))^2<=1^2 by A70,SQUARE_1:119;
            then 1-((-(p`1/|.p.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
            then
A71:        1-(-((p`1/|.p.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
A72:        (p4`2)^2= (|.p.|)^2*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))^2 by A54
              .= (|.p.|)^2*(1-((p`1/|.p.|-cn)/(1-cn))^2) by A71,SQUARE_1:def 4;
            (|.p4.|)^2=(p4`1)^2+(p4`2)^2 by JGRAPH_3:10
              .=(|.p.|)^2 by A54,A72;
            then
A73:        sqrt((|.p4.|)^2)=|.p.| by SQUARE_1:89;
            then
A74:        |.p4.|=|.p.| by SQUARE_1:89;
            ((p`1/|.p.|-cn)/(1-cn))
            =|.q.|* ((q`1/|.q.|-cn)/(1-cn))/|.p.| by A2,A35,A36,A52,A53,A54,
TOPRNS_1:25,XCMPLX_1:90;

then (p`1/|.p.|-cn)/(1-cn)=(q`1/|.q.|-cn)/(1-cn) by A2,A35,A52,A53,A63,A73,
TOPRNS_1:25,XCMPLX_1:90;
            then (p`1/|.p.|-cn)/(1-cn)*(1-cn)=q`1/|.q.|-cn by A3,XCMPLX_1:88;
            then p`1/|.p.|-cn=q`1/|.q.|-cn by A3,XCMPLX_1:88;
            then p`1/|.p.|*|.p.|=q`1 by A2,A35,A52,A53,A64,A74,TOPRNS_1:25
,XCMPLX_1:88;
            then
A75:        p`1=q`1 by A52,TOPRNS_1:25,XCMPLX_1:88;
A76:        |.p.|^2=(p`1)^2+(p`2)^2 by JGRAPH_3:10;
            |.q.|^2=(q`1)^2+(q`2)^2 by JGRAPH_3:10;

then p`2=sqrt((q`2)^2) by A2,A35,A52,A53,A64,A74,A75,A76,SQUARE_1:89;
            then
A77:        p`2=q`2 by A34,SQUARE_1:89;
            p=|[p`1,p`2]| by EUCLID:57;
            hence x1=x2 by A75,A77,EUCLID:57;
          end;
          case
A78:        p<>0.REAL 2 & (p`1/|.p.|<cn & p`2>=0);
            then
A79:        cn-FanMorphN.p= |[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
            |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]| by A1,Th58;
            set p4= |[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
            |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]|;
A80:        p4`2= |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)) &
            p4`1= |.p.|* ((p`1/|.p.|-cn)/(1+cn)) by EUCLID:56;
A81:        p`1/|.p.|-cn<0 by A78,XREAL_1:51;
            1+cn>0 by A1,XREAL_1:150;
            then
A82:        ((p`1/|.p.|-cn)/(1+cn))<0 by A81,XREAL_1:143;
            |.p.|<>0 by A78,TOPRNS_1:25;
            then
A84:        |.p.|* ((p`1/|.p.|-cn)/(1+cn))<0 by A82,XREAL_1:134;
A85:        q`1/|.q.|-cn>=0 by A34,XREAL_1:50;
            1-cn>0 by A1,XREAL_1:151;
            then ((q`1/|.q.|-cn)/(1-cn))>=0 by A85;
            hence x1=x2 by A2,A35,A36,A79,A80,A84;
          end;
        end;
        hence x1=x2;
      end;
      case
A86:    q`1/|.q.|<cn & q`2>=0 & q<>0.REAL 2;
        then
A87:    cn-FanMorphN.q= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
        |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]| by A1,Th58;
        set q4= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
        |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]|;
A88:    q4`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)) &
        q4`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by EUCLID:56;
A89:    |.q.|<>0 by A86,TOPRNS_1:25;
        then
A90:    (|.q.|)^2>0 by SQUARE_1:74;
        now per cases by JGRAPH_2:11;
          case
A91:        p`2<=0;
            then
A92:        (cn-FanMorphN).p=p by Th56;
A93:        1+cn>0 by A1,XREAL_1:150;
A94:        (q`1/|.q.|-cn)<=0 by A86,XREAL_1:49;
            then
A95:        -(q`1/|.q.|-cn)>= -0;
            --(q`1/|.q.|-cn)/(1+cn)<=0 by A93,A94;
            then
A96:        -((q`1/|.q.|-cn)/(1+cn))>=0;
A97:        (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
            0<=(q`2)^2 by XREAL_1:65;
            then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
            then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2
             by A97,XREAL_1:74;
            then (q`1)^2/(|.q.|)^2 <= 1 by A90,XCMPLX_1:60;
            then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
            then
A98:        (-((q`1)/|.q.|))^2 <= 1;

(-(1+cn))/(1+cn)<=(-( q`1/|.q.|-cn))/(1+cn) by A93,A95,XREAL_1:74;
            then
A99:        -1<=(-( q`1/|.q.|-cn))/(1+cn) by A93,XCMPLX_1:198;
            1>= -q`1/|.q.| by A98,SQUARE_1:121;
            then (1+cn)>= -q`1/|.q.|+cn by XREAL_1:9;
            then (-(q`1/|.q.|-cn))/(1+cn)<=1 by A93,XREAL_1:187;
            then ((-(q`1/|.q.|-cn))/(1+cn))^2<=1^2 by A99,SQUARE_1:119;
            then
A100:       1-((-(q`1/|.q.|-cn))/(1+cn))^2>=0 by XREAL_1:50;
            then
A101:       1-(-((q`1/|.q.|-cn))/(1+cn))^2>=0 by XCMPLX_1:188;
            sqrt(1-((-(q`1/|.q.|-cn))/(1+cn))^2)>=0 by A100,SQUARE_1:def 4;
            then sqrt(1-(-(q`1/|.q.|-cn))^2/(1+cn)^2)>=0 by XCMPLX_1:77;
            then sqrt(1-((q`1/|.q.|-cn))^2/(1+cn)^2)>=0;
            then sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)>=0 by XCMPLX_1:77;
            then p`2=0 by A2,A87,A88,A91,A92;
            then ( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))=0 by A2,A87,A88,A89,A92,
XCMPLX_1:6;
            then 1-((q`1/|.q.|-cn)/(1+cn))^2=0 by A101,SQUARE_1:92;
            then 1=sqrt((-((q`1/|.q.|-cn)/(1+cn)))^2) by SQUARE_1:83;
            then 1= -((q`1/|.q.|-cn)/(1+cn)) by A96,SQUARE_1:89;
            then 1= ((-(q`1/|.q.|-cn))/(1+cn)) by XCMPLX_1:188;
            then 1 *(1+cn)=-(q`1/|.q.|-cn) by A93,XCMPLX_1:88;
            then 1+cn-cn=-q`1/|.q.|;
            then 1=(-q`1)/|.q.| by XCMPLX_1:188;
            then 1 *|.q.|=-q`1 by A86,TOPRNS_1:25,XCMPLX_1:88;
            then (q`1)^2-(q`1)^2 =(q`2)^2 by A97,XCMPLX_1:26;
            then q`2=0 by XCMPLX_1:6;
            hence x1=x2 by A2,A92,Th56;
          end;
          case
A102:       p<>0.REAL 2 & (p`1/|.p.|>=cn & p`2>=0);
            then
A103:       cn-FanMorphN.p= |[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
            |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]| by A1,Th58;
            set p4= |[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
            |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]|;
A104:       p4`2= |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)) &
            p4`1= |.p.|* ((p`1/|.p.|-cn)/(1-cn)) by EUCLID:56;
A105:       q`1/|.q.|-cn<0 by A86,XREAL_1:51;
            1+cn>0 by A1,XREAL_1:150;
            then
A106:       ((q`1/|.q.|-cn)/(1+cn))<0 by A105,XREAL_1:143;
            |.q.|<>0 by A86,TOPRNS_1:25;
            then
A108:       |.q.|* ((q`1/|.q.|-cn)/(1+cn))<0 by A106,XREAL_1:134;
A109:       p`1/|.p.|-cn>=0 by A102,XREAL_1:50;
            1-cn>0 by A1,XREAL_1:151;
            then ((p`1/|.p.|-cn)/(1-cn))>=0 by A109;
            hence x1=x2 by A2,A87,A88,A103,A104,A108;
          end;
          case
A110:       p<>0.REAL 2 & (p`1/|.p.|<cn & p`2>=0);
            then
A111:       cn-FanMorphN.p= |[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
            |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]| by A1,Th58;
            set p4= |[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
            |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]|;
A112:       p4`2= |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)) &
            p4`1= |.p.|* ((p`1/|.p.|-cn)/(1+cn)) by EUCLID:56;
A113:       q4`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))&
            q4`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by EUCLID:56;
            (q`1/|.q.|-cn)<=0 by A86,XREAL_1:49;
            then
A114:       -(q`1/|.q.|-cn)>= -0;
A115:       (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
            0<=(q`2)^2 by XREAL_1:65;
            then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;

then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A115,XREAL_1:74;
            then (q`1)^2/(|.q.|)^2 <= 1 by A90,XCMPLX_1:60;
            then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
            then -1<=q`1/|.q.| by SQUARE_1:121;
            then
A116:       -1-cn<=q`1/|.q.|-cn by XREAL_1:11;
A117:       1+cn>0 by A1,XREAL_1:150;
            (-(1+cn))/(1+cn)<=(-( q`1/|.q.|-cn))/(1+cn)
            by A114,A117,XREAL_1:74;
            then
A118:       -1<=(-( q`1/|.q.|-cn))/(1+cn) by A117,XCMPLX_1:198;
            -(-1-cn)>= -(q`1/|.q.|-cn) by A116,XREAL_1:26;
            then (-(q`1/|.q.|-cn))/(1+cn)<=1 by A117,XREAL_1:187;
            then ((-(q`1/|.q.|-cn))/(1+cn))^2<=1^2 by A118,SQUARE_1:119;
            then 1-((-(q`1/|.q.|-cn))/(1+cn))^2>=0 by XREAL_1:50;
            then
A119:       1-(-((q`1/|.q.|-cn))/(1+cn))^2>=0 by XCMPLX_1:188;
A120:       (q4`2)^2= (|.q.|)^2*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))^2 by A113

.= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1+cn))^2) by A119,SQUARE_1:def 4;
            (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
              .=(|.q.|)^2 by A113,A120;
            then
A121:       sqrt((|.q4.|)^2)=|.q.| by SQUARE_1:89;
            then
A122:       |.q4.|=|.q.| by SQUARE_1:89;
            |.p.|<>0 by A110,TOPRNS_1:25;
            then
A123:       (|.p.|)^2>0 by SQUARE_1:74;
            (p`1/|.p.|-cn)<=0 by A110,XREAL_1:49;
            then
A124:       -(p`1/|.p.|-cn)>= -0;
A125:       (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
            0<=(p`2)^2 by XREAL_1:65;
            then 0+(p`1)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;

then (p`1)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by A125,XREAL_1:74;
            then (p`1)^2/(|.p.|)^2 <= 1 by A123,XCMPLX_1:60;
            then ((p`1)/|.p.|)^2 <= 1 by XCMPLX_1:77;
            then -1<=p`1/|.p.| by SQUARE_1:121;
            then
A126:       -1-cn<=p`1/|.p.|-cn by XREAL_1:11;

(-(1+cn))/(1+cn)<=(-( p`1/|.p.|-cn))/(1+cn) by A117,A124,XREAL_1:74;
            then
A127:       -1<=(-( p`1/|.p.|-cn))/(1+cn) by A117,XCMPLX_1:198;
            -(-1-cn)>= -(p`1/|.p.|-cn) by A126,XREAL_1:26;
            then (-(p`1/|.p.|-cn))/(1+cn)<=1 by A117,XREAL_1:187;
            then ((-(p`1/|.p.|-cn))/(1+cn))^2<=1^2 by A127,SQUARE_1:119;
            then 1-((-(p`1/|.p.|-cn))/(1+cn))^2>=0 by XREAL_1:50;
            then
A128:       1-(-((p`1/|.p.|-cn))/(1+cn))^2>=0 by XCMPLX_1:188;
A129:       (p4`2)^2= (|.p.|)^2*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))^2 by A112
              .= (|.p.|)^2*(1-((p`1/|.p.|-cn)/(1+cn))^2)
            by A128,SQUARE_1:def 4;
            (|.p4.|)^2=(p4`1)^2+(p4`2)^2 by JGRAPH_3:10
              .=(|.p.|)^2 by A112,A129;
            then
A130:       sqrt((|.p4.|)^2)=|.p.| by SQUARE_1:89;
            then
A131:       |.p4.|=|.p.| by SQUARE_1:89;
            ((p`1/|.p.|-cn)/(1+cn))=|.q.|* ((q`1/|.q.|-cn)/(1+cn))/|.p.|
            by A2,A87,A88,A110,A111,A112,TOPRNS_1:25,XCMPLX_1:90;
            then (p`1/|.p.|-cn)/(1+cn)=(q`1/|.q.|-cn)/(1+cn)
            by A2,A87,A110,A111,A121,A130,TOPRNS_1:25,XCMPLX_1:90;
            then (p`1/|.p.|-cn)/(1+cn)*(1+cn)=q`1/|.q.|-cn
            by A117,XCMPLX_1:88;
            then p`1/|.p.|-cn=q`1/|.q.|-cn by A117,XCMPLX_1:88;
            then p`1/|.p.|*|.p.|=q`1 by A2,A87,A110,A111,A122,A131,TOPRNS_1:25
,XCMPLX_1:88;
            then
A132:       p`1=q`1 by A110,TOPRNS_1:25,XCMPLX_1:88;
A133:       |.p.|^2=(p`1)^2+(p`2)^2 by JGRAPH_3:10;
            |.q.|^2=(q`1)^2+(q`2)^2 by JGRAPH_3:10;
            then p`2=sqrt((q`2)^2) by A2,A87,A110,A111,A122,A131,A132,A133,
SQUARE_1:89;
            then
A134:       p`2=q`2 by A86,SQUARE_1:89;
            p=|[p`1,p`2]| by EUCLID:57;
            hence x1=x2 by A132,A134,EUCLID:57;
          end;
        end;
        hence x1=x2;
      end;
    end;
    hence x1=x2;
  end;
  hence thesis by FUNCT_1:def 8;
end;

theorem Th79:
  for cn being Real st -1<cn & cn<1 holds
  (cn-FanMorphN) is Function of TOP-REAL 2,TOP-REAL 2 &
  rng (cn-FanMorphN) = the carrier of TOP-REAL 2
proof
  let cn be Real;
  assume
A1: -1<cn & cn<1;
  thus (cn-FanMorphN) is Function of TOP-REAL 2,TOP-REAL 2;
  for f being Function of TOP-REAL 2,TOP-REAL 2 st f=(cn-FanMorphN) holds
  rng (cn-FanMorphN)=the carrier of TOP-REAL 2
  proof
    let f be Function of TOP-REAL 2,TOP-REAL 2;
    assume
A2: f=(cn-FanMorphN);
A3: dom f=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
    the carrier of TOP-REAL 2 c= rng f
    proof
      let y be set;
      assume y in the carrier of TOP-REAL 2;
      then reconsider p2=y as Point of TOP-REAL 2;
      set q=p2;
      now per cases by JGRAPH_2:11;
        case q`2<=0;
          then q in dom (cn-FanMorphN) & y=(cn-FanMorphN).q by A2,A3,Th56;
          hence ex x being set st x in dom (cn-FanMorphN) & y=(cn-FanMorphN).x;
        end;
        case
A4:       q`1/|.q.|>=0 & q`2>=0 & q<>0.REAL 2;
          set px=|[ |.q.|*(q`1/|.q.|*(1-cn)+cn),
          (|.q.|)*sqrt(1-(q`1/|.q.|*(1-cn)+cn)^2)]|;
A5:       px`2 = (|.q.|)*sqrt(1-(q`1/|.q.|*(1-cn)+cn)^2) &
          px`1 = |.q.|*(q`1/|.q.|*(1-cn)+cn) by EUCLID:56;
          then
A6:       |.px.|^2=((|.q.|)*sqrt(1-(q`1/|.q.|*(1-cn)+cn)^2))^2
          +(|.q.|*(q`1/|.q.|*(1-cn)+cn))^2 by JGRAPH_3:10
            .=(|.q.|)^2*(sqrt(1-(q`1/|.q.|*(1-cn)+cn)^2))^2
          +(|.q.|)^2*((q`1/|.q.|*(1-cn)+cn))^2;
A7:       |.q.|<>0 by A4,TOPRNS_1:25;
          1-cn>=0 by A1,XREAL_1:151;
          then
A8:       q`1/|.q.|*(1-cn)>=0 by A4;
          then
A9:       (q`1/|.q.|*(1-cn)+cn)>=0+cn by XREAL_1:9;
A10:      |.q.|^2>0 by A7,SQUARE_1:74;
          --(1+cn)>0 by A1,XREAL_1:150;
          then -(-1-cn)>0;
          then -1-cn<= q`1/|.q.|*(1-cn) by A8;
          then
A11:      -1-cn+cn<= q`1/|.q.|*(1-cn)+cn by XREAL_1:9;
A12:      1-cn>0 by A1,XREAL_1:151;
A13:      (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
          0<=(q`2)^2 by XREAL_1:65;
          then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
          then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2
           by A13,XREAL_1:74;
          then (q`1)^2/(|.q.|)^2 <= 1 by A10,XCMPLX_1:60;
          then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
          then q`1/|.q.|<=1 by SQUARE_1:121;
          then q`1/|.q.|*(1-cn) <=1 *(1-cn) by A12,XREAL_1:66;
          then q`1/|.q.|*(1-cn)+cn-cn <=1-cn;
          then (q`1/|.q.|*(1-cn)+cn) <=1 by XREAL_1:11;
          then 1^2>=(q`1/|.q.|*(1-cn)+cn)^2 by A11,SQUARE_1:119;
          then
A14:      1-(q`1/|.q.|*(1-cn)+cn)^2>=0 by XREAL_1:50;
          then
A15:      |.px.|^2=(|.q.|)^2*(1-(q`1/|.q.|*(1-cn)+cn)^2)
          +(|.q.|)^2*((q`1/|.q.|*(1-cn)+cn))^2 by A6,SQUARE_1:def 4
            .= (|.q.|)^2;
          then
A16:      |.px.|=sqrt(|.q.|^2) by SQUARE_1:89
            .=|.q.| by SQUARE_1:89;
          sqrt(1-(q`1/|.q.|*(1-cn)+cn)^2)>=0 by A14,SQUARE_1:def 4;
          then px`1/|.px.| >=cn & px`2>=0 & px<>0.REAL 2
          by A5,A7,A9,A16,TOPRNS_1:24,XCMPLX_1:90;
          then
A17:      (cn-FanMorphN).px =|[ |.px.|* ((px`1/|.px.|-cn)/(1-cn) ),
          |.px.|*( sqrt(1-((px`1/|.px.|-cn)/(1-cn))^2))]| by A1,Th58;
A18:      |.px.|* ((px`1/|.px.|-cn)/(1-cn))

=|.q.|* (( ((q`1/|.q.|*(1-cn)+cn))-cn)/(1-cn)) by A4,A5,A16,TOPRNS_1:25
,XCMPLX_1:90
            .=|.q.|* ( q`1/|.q.|) by A12,XCMPLX_1:90
            .= q`1 by A4,TOPRNS_1:25,XCMPLX_1:88;
          then
A19:      |.px.|*( sqrt(1-((px`1/|.px.|-cn)/(1-cn))^2))
          = |.px.|*( sqrt(1-(q`1/|.px.|)^2)) by A4,A16,TOPRNS_1:25,XCMPLX_1:90
            .= |.px.|*( sqrt(1-(q`1)^2/(|.px.|)^2)) by XCMPLX_1:77
            .= |.px.|*( sqrt( (|.px.|)^2/(|.px.|)^2-(q`1)^2/(|.px.|)^2))
          by A10,A15,XCMPLX_1:60
            .= |.px.|*( sqrt( ((|.px.|)^2-(q`1)^2)/(|.px.|)^2))
          by XCMPLX_1:121
            .= |.px.|*( sqrt( ((q`1)^2+(q`2)^2-(q`1)^2)/(|.px.|)^2))
          by A15,JGRAPH_3:10
            .= |.px.|*( sqrt((q`2/|.q.|)^2)) by A16,XCMPLX_1:77;
          q`2/|.q.|>=0 by A4;
          then
A20:      |.px.|*( sqrt((q`2/|.q.|)^2))=|.q.|*(q`2/|.q.|) by A16,SQUARE_1:89
            .=q`2 by A4,TOPRNS_1:25,XCMPLX_1:88;
          dom (cn-FanMorphN)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
          hence ex x being set st x in dom (cn-FanMorphN) & y=(cn-FanMorphN).x
          by A17,A18,A19,A20,EUCLID:57;
        end;
        case
A21:      q`1/|.q.|<0 & q`2>=0 & q<>0.REAL 2;
          set px=|[ |.q.|*(q`1/|.q.|*(1+cn)+cn),
          (|.q.|)*sqrt(1-(q`1/|.q.|*(1+cn)+cn)^2)]|;
A22:      px`2 = (|.q.|)*sqrt(1-(q`1/|.q.|*(1+cn)+cn)^2) &
          px`1 = |.q.|*(q`1/|.q.|*(1+cn)+cn) by EUCLID:56;
          then
A23:      |.px.|^2=((|.q.|)*sqrt(1-(q`1/|.q.|*(1+cn)+cn)^2))^2
          +(|.q.|*(q`1/|.q.|*(1+cn)+cn))^2 by JGRAPH_3:10
            .=(|.q.|)^2*(sqrt(1-(q`1/|.q.|*(1+cn)+cn)^2))^2
          +(|.q.|)^2*((q`1/|.q.|*(1+cn)+cn))^2;
A24:      |.q.|<>0 by A21,TOPRNS_1:25;
          1+cn>=0 by A1,XREAL_1:150;
          then
A25:      q`1/|.q.|*(1+cn)<=0 by A21;
          then
A26:      (q`1/|.q.|*(1+cn)+cn)<=0+cn by XREAL_1:9;
A27:      |.q.|^2>0 by A24,SQUARE_1:74;
          (1-cn)>0 by A1,XREAL_1:151;
          then
A28:      1-cn+cn>= q`1/|.q.|*(1+cn)+cn by A25,XREAL_1:9;
A29:      1+cn>0 by A1,XREAL_1:150;
A30:      (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
          0<=(q`2)^2 by XREAL_1:65;
          then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
          then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2
           by A30,XREAL_1:74;
          then (q`1)^2/(|.q.|)^2 <= 1 by A27,XCMPLX_1:60;
          then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
          then q`1/|.q.|>=-1 by SQUARE_1:121;
          then q`1/|.q.|*(1+cn) >=(-1)*(1+cn) by A29,XREAL_1:66;
          then q`1/|.q.|*(1+cn)+cn-cn >=-1-cn;
          then (q`1/|.q.|*(1+cn)+cn) >=-1 by XREAL_1:11;
          then 1^2>=(q`1/|.q.|*(1+cn)+cn)^2 by A28,SQUARE_1:119;
          then
A31:      1-(q`1/|.q.|*(1+cn)+cn)^2>=0 by XREAL_1:50;
          then
A32:      |.px.|^2=(|.q.|)^2*(1-(q`1/|.q.|*(1+cn)+cn)^2)
          +(|.q.|)^2*((q`1/|.q.|*(1+cn)+cn))^2 by A23,SQUARE_1:def 4
            .= (|.q.|)^2;
          then
A33:      |.px.|=sqrt(|.q.|^2) by SQUARE_1:89
            .=|.q.| by SQUARE_1:89;
          sqrt(1-(q`1/|.q.|*(1+cn)+cn)^2)>=0 by A31,SQUARE_1:def 4;
          then px`1/|.px.| <=cn & px`2>=0 & px<>0.REAL 2
          by A22,A24,A26,A33,TOPRNS_1:24,XCMPLX_1:90;
          then
A34:      (cn-FanMorphN).px =|[ |.px.|* ((px`1/|.px.|-cn)/(1+cn) ),
          |.px.|*( sqrt(1-((px`1/|.px.|-cn)/(1+cn))^2))]| by A1,Th58;
A35:      |.px.|* ((px`1/|.px.|-cn)/(1+cn))

=|.q.|* (( ((q`1/|.q.|*(1+cn)+cn))-cn)/(1+cn)) by A21,A22,A33,TOPRNS_1:25
,XCMPLX_1:90
            .=|.q.|* ( q`1/|.q.|) by A29,XCMPLX_1:90
            .= q`1 by A21,TOPRNS_1:25,XCMPLX_1:88;
          then
A36:      |.px.|*( sqrt(1-((px`1/|.px.|-cn)/(1+cn))^2))
          = |.px.|*( sqrt(1-(q`1/|.px.|)^2)) by A21,A33,TOPRNS_1:25,XCMPLX_1:90
            .= |.px.|*( sqrt(1-(q`1)^2/(|.px.|)^2)) by XCMPLX_1:77
            .= |.px.|*( sqrt( (|.px.|)^2/(|.px.|)^2-(q`1)^2/(|.px.|)^2))
          by A27,A32,XCMPLX_1:60
            .= |.px.|*( sqrt( ((|.px.|)^2-(q`1)^2)/(|.px.|)^2))
          by XCMPLX_1:121
            .= |.px.|*( sqrt( ((q`1)^2+(q`2)^2-(q`1)^2)/(|.px.|)^2))
          by A32,JGRAPH_3:10
            .= |.px.|*( sqrt((q`2/|.q.|)^2)) by A33,XCMPLX_1:77;
          q`2/|.q.|>=0 by A21;
          then
A37:      |.px.|*( sqrt((q`2/|.q.|)^2))=|.q.|*(q`2/|.q.|) by A33,SQUARE_1:89
            .=q`2 by A21,TOPRNS_1:25,XCMPLX_1:88;
          dom (cn-FanMorphN)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
          hence ex x being set st x in dom (cn-FanMorphN) & y=(cn-FanMorphN).x
          by A34,A35,A36,A37,EUCLID:57;
        end;
      end;
      hence y in rng f by A2,FUNCT_1:def 5;
    end;
    hence rng (cn-FanMorphN)=the carrier of TOP-REAL 2 by A2,XBOOLE_0:def 10;
  end;
  hence thesis;
end;

theorem Th80:
  for cn being Real,p2 being Point of TOP-REAL 2 st -1<cn & cn<1
  ex K being non empty compact Subset of TOP-REAL 2 st K = (cn-FanMorphN).:K &
  (ex V2 being Subset of TOP-REAL 2 st
  p2 in V2 & V2 is open & V2 c= K & (cn-FanMorphN).p2 in V2)
proof
  let cn be Real,p2 be Point of TOP-REAL 2;
  assume
A1: -1<cn & cn<1;
  reconsider O=0.REAL 2 as Point of Euclid 2;
  reconsider V0=Ball(O,|.p2.|+1) as Subset of TOP-REAL 2;
A2: |. p2.|<|.p2.|+1 by XREAL_1:31;
A3: O in V0 by GOBOARD6:4;
A4: V0 c= cl_Ball(O,|.p2.|+1) by METRIC_1:15;
  reconsider K0=cl_Ball(O,|.p2.|+1)
  as non empty compact Subset of TOP-REAL 2 by A3,A4,Th22;
  reconsider u2=p2 as Point of Euclid 2;
A5: (cn-FanMorphN).:K0 c= K0
  proof
    let y be set;
    assume y in (cn-FanMorphN).:K0;
    then consider x being set such that
A6: x in dom (cn-FanMorphN) & x in K0 & y=(cn-FanMorphN).x by FUNCT_1:def 12;
    reconsider q=x as Point of TOP-REAL 2 by A6;
    reconsider uq=q as Point of Euclid 2;
A7: y in rng (cn-FanMorphN) by A6,FUNCT_1:def 5;
    then reconsider u=y as Point of Euclid 2;
    reconsider q4=y as Point of TOP-REAL 2 by A7;
A8: |.q4.|=|.q.| by A6,Th73;
    dist(O,uq)<= |.p2.|+1 by A6,METRIC_1:13;
    then |.0.REAL 2 - q.|<= |.p2.|+1 by JGRAPH_1:45;
    then |.0.REAL 2 +- q.|<= |.p2.|+1 by EUCLID:45;
    then |. -q.|<= |.p2.|+1 by EUCLID:31;
    then |.q.|<= |.p2.|+1 by TOPRNS_1:27;
    then |. -q4.|<= |.p2.|+1 by A8,TOPRNS_1:27;
    then |.0.REAL 2 +- q4.|<= |.p2.|+1 by EUCLID:31;
    then |.0.REAL 2 - q4.|<= |.p2.|+1 by EUCLID:45;
    then dist(O,u)<= |.p2.|+1 by JGRAPH_1:45;
    hence y in K0 by METRIC_1:13;
  end;
  K0 c= (cn-FanMorphN).:K0
  proof
    let y be set;
    assume
A9: y in K0;
    reconsider q4=y as Point of TOP-REAL 2 by A9;
    the carrier of TOP-REAL 2 c= rng (cn-FanMorphN) by A1,Th79;
    then q4 in rng (cn-FanMorphN) by TARSKI:def 3;
    then consider x being set such that
A10: x in dom (cn-FanMorphN) & y=(cn-FanMorphN).x by FUNCT_1:def 5;
    reconsider q=x as Point of TOP-REAL 2 by A10;
    |.q4.|=|.q.| by A10,Th73;
    then q in K0 by A9,Lm11;
    hence y in (cn-FanMorphN).:K0 by A10,FUNCT_1:def 12;
  end;
  then
A11: K0= (cn-FanMorphN).:K0 by A5,XBOOLE_0:def 10;
  |. -p2.|<|.p2.|+1 by A2,TOPRNS_1:27;
  then |.0.REAL 2 +- p2.|<|.p2.|+1 by EUCLID:31;
  then |.0.REAL 2 - p2.|<|.p2.|+1 by EUCLID:45;
  then dist(O,u2)<|.p2.|+1 by JGRAPH_1:45;
  then
A12: p2 in V0 by METRIC_1:12;
A13: V0 is open by TOPMETR:21;
  set q3= (cn-FanMorphN).p2;
  reconsider u3=q3 as Point of Euclid 2;
  |.q3.|=|.p2.| by Th73;
  then |. -q3.|<|.p2.|+1 by A2,TOPRNS_1:27;
  then |.0.REAL 2 +- q3.|<|.p2.|+1 by EUCLID:31;
  then |.0.REAL 2 - q3.|<|.p2.|+1 by EUCLID:45;
  then dist(O,u3)< |.p2.|+1 by JGRAPH_1:45;
  then (cn-FanMorphN).p2 in V0 by METRIC_1:12;
  hence thesis by A11,A12,A13,METRIC_1:15;
end;

theorem
  for cn being Real st -1<cn & cn<1
  ex f being Function of TOP-REAL 2,TOP-REAL 2 st f=cn-FanMorphN
  & f is being_homeomorphism
proof
  let cn be Real;
  assume
A1: -1<cn & cn<1;
  then
A2: (cn-FanMorphN) is Function of TOP-REAL 2,TOP-REAL 2 &
  rng (cn-FanMorphN) = the carrier of TOP-REAL 2 by Th79;
  reconsider f=(cn-FanMorphN) as Function of TOP-REAL 2,TOP-REAL 2;
  consider h being Function of (TOP-REAL 2),(TOP-REAL 2) such that
A3: h=(cn-FanMorphN) & h is continuous by A1,Th77;
A4: f is one-to-one by A1,Th78;
  for p2 being Point of TOP-REAL 2
  ex K being non empty compact Subset of TOP-REAL 2 st K = f.:K &
  (ex V2 being Subset of TOP-REAL 2 st
  p2 in V2 & V2 is open & V2 c= K & f.p2 in V2) by A1,Th80;
  then f is being_homeomorphism by A2,A3,A4,Th8;
  hence thesis;
end;

theorem Th82:
  for cn being Real,q being Point of TOP-REAL 2 st -1<cn & cn<1 & q`2>0
  & q`1/|.q.|>=cn holds (for p being Point of TOP-REAL 2 st
  p=(cn-FanMorphN).q holds p`2>0 & p`1>=0)
proof
  let cn be Real,q be Point of TOP-REAL 2;
  assume
A1: -1<cn & cn<1 & q`2>0 & q`1/|.q.|>=cn;
  let p be Point of TOP-REAL 2;
  assume p=(cn-FanMorphN).q;
  then
A3: p=|[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
  |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by A1,Th56;
  set qz=p;
A4: |.q.|<>0 by A1,JGRAPH_2:11,TOPRNS_1:25;
  then
A5: (|.q.|)^2>0 by SQUARE_1:74;
A6: 1-cn>0 by A1,XREAL_1:151;
A7: qz`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))&
  qz`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by A3,EUCLID:56;
A8: (q`1/|.q.|-cn)>= 0 by A1,XREAL_1:50;
A9: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
  0+(q`1)^2<(q`1)^2+(q`2)^2 by A1,SQUARE_1:74,XREAL_1:10;
  then (q`1)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A5,A9,XREAL_1:76;
  then (q`1)^2/(|.q.|)^2 < 1 by A5,XCMPLX_1:60;
  then ((q`1)/|.q.|)^2 < 1 by XCMPLX_1:77;
  then 1>q`1/|.q.| by SQUARE_1:122;
  then
A10: 1-cn>q`1/|.q.|-cn by XREAL_1:11;
A11: -(1-cn)< -0 by A6,XREAL_1:26;
  -(1-cn)< -( q`1/|.q.|-cn) by A10,XREAL_1:26;
  then (-(1-cn))/(1-cn)<(-( q`1/|.q.|-cn))/(1-cn) by A6,XREAL_1:76;
  then
A12: -1<(-( q`1/|.q.|-cn))/(1-cn) by A6,XCMPLX_1:198;
  --(1-cn)> -(q`1/|.q.|-cn) by A8,A11,XREAL_1:26;
  then (-(q`1/|.q.|-cn))/(1-cn)<1 by A6,XREAL_1:193;
  then ((-(q`1/|.q.|-cn))/(1-cn))^2<1^2 by A12,SQUARE_1:120;
  then 1-((-(q`1/|.q.|-cn))/(1-cn))^2>0 by XREAL_1:52;
  then sqrt(1-((-(q`1/|.q.|-cn))/(1-cn))^2)>0 by SQUARE_1:93;
  then sqrt(1-(-(q`1/|.q.|-cn))^2/(1-cn)^2)> 0 by XCMPLX_1:77;
  then sqrt(1-(q`1/|.q.|-cn)^2/(1-cn)^2)> 0;
  then
A13: sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)> 0 by XCMPLX_1:77;
  ((q`1/|.q.|-cn)/(1-cn))>=0 by A6,A8;
  hence p`2>0 & p`1>=0 by A4,A7,A13,XREAL_1:131;
end;

theorem Th83:
  for cn being Real,q being Point of TOP-REAL 2 st -1<cn & cn<1 & q`2>0
  & q`1/|.q.|<cn holds (for p being Point of TOP-REAL 2 st
  p=(cn-FanMorphN).q holds p`2>0 & p`1<0)
proof
  let cn be Real,q be Point of TOP-REAL 2;
  assume
A1: -1<cn & cn<1 & q`2>0 & q`1/|.q.|<cn;
  let p be Point of TOP-REAL 2;
  assume p=(cn-FanMorphN).q;
  then
A3: p=|[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
  |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]| by A1,Th57;
  set qz=p;
A4: |.q.|<>0 by A1,JGRAPH_2:11,TOPRNS_1:25;
  then
A5: (|.q.|)^2>0 by SQUARE_1:74;
A6: (q`1/|.q.|-cn)< 0 by A1,XREAL_1:51;
A7: 1+cn>0 by A1,XREAL_1:150;
A8: qz`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))&
  qz`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by A3,EUCLID:56;
A9: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
  0+(q`1)^2<(q`1)^2+(q`2)^2 by A1,SQUARE_1:74,XREAL_1:10;
  then (q`1)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A5,A9,XREAL_1:76;
  then (q`1)^2/(|.q.|)^2 < 1 by A5,XCMPLX_1:60;
  then ((q`1)/|.q.|)^2 < 1 by XCMPLX_1:77;
  then -1<q`1/|.q.| by SQUARE_1:122;
  then -1-cn<q`1/|.q.|-cn by XREAL_1:11;
  then -(1+cn) < (q`1/|.q.|-cn);
  then
A10: --(1+cn)> -(q`1/|.q.|-cn) by XREAL_1:26;
A11: -( q`1/|.q.|-cn)>0 by A6,XREAL_1:60;
  (-(1+cn))/(1+cn)<(-( q`1/|.q.|-cn))/(1+cn) by A7,A11,XREAL_1:76;
  then
A12: -1<(-( q`1/|.q.|-cn))/(1+cn) by A7,XCMPLX_1:198;
  (-(q`1/|.q.|-cn))/(1+cn)<1 by A7,A10,XREAL_1:193;
  then ((-(q`1/|.q.|-cn))/(1+cn))^2<1^2 by A12,SQUARE_1:120;
  then 1-((-(q`1/|.q.|-cn))/(1+cn))^2>0 by XREAL_1:52;
  then sqrt(1-((-(q`1/|.q.|-cn))/(1+cn))^2)>0 by SQUARE_1:93;
  then sqrt(1-(-(q`1/|.q.|-cn))^2/(1+cn)^2)> 0 by XCMPLX_1:77;
  then sqrt(1-(q`1/|.q.|-cn)^2/(1+cn)^2)> 0;
  then
A13: sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)> 0 by XCMPLX_1:77;
  ((q`1/|.q.|-cn)/(1+cn))<0 by A6,A7,XREAL_1:143;
  hence p`2>0 & p`1<0 by A4,A8,A13,XREAL_1:131,134;
end;

theorem Th84:
  for cn being Real,q1,q2 being Point of TOP-REAL 2 st -1<cn & cn<1 & q1`2>0
  & q1`1/|.q1.|>=cn & q2`2>0 & q2`1/|.q2.|>=cn & q1`1/|.q1.|<q2`1/|.q2.|
  holds (for p1,p2 being Point of TOP-REAL 2 st
  p1=(cn-FanMorphN).q1 & p2=(cn-FanMorphN).q2 holds p1`1/|.p1.|<p2`1/|.p2.|)
proof
  let cn be Real,q1,q2 be Point of TOP-REAL 2;
  assume
A1: -1<cn & cn<1 & q1`2>0
  & q1`1/|.q1.|>=cn & q2`2>0 & q2`1/|.q2.|>=cn & q1`1/|.q1.|<q2`1/|.q2.|;
  let p1,p2 be Point of TOP-REAL 2;
  assume
A2: p1=(cn-FanMorphN).q1 & p2=(cn-FanMorphN).q2;
  then p1=|[ |.q1.|* ((q1`1/|.q1.|-cn)/(1-cn)),
  |.q1.|*( sqrt(1-((q1`1/|.q1.|-cn)/(1-cn))^2))]| by A1,Th56;
  then
A3: p1`2= |.q1.|*( sqrt(1-((q1`1/|.q1.|-cn)/(1-cn))^2))&
  p1`1= |.q1.|* ((q1`1/|.q1.|-cn)/(1-cn)) by EUCLID:56;
  p2=|[ |.q2.|* ((q2`1/|.q2.|-cn)/(1-cn)),
  |.q2.|*( sqrt(1-((q2`1/|.q2.|-cn)/(1-cn))^2))]| by A1,A2,Th56;
  then
A4: p2`2= |.q2.|*( sqrt(1-((q2`1/|.q2.|-cn)/(1-cn))^2))&
  p2`1= |.q2.|* ((q2`1/|.q2.|-cn)/(1-cn)) by EUCLID:56;
A5: |.q1.|>0 & |.q2.|>0 by A1,Lm1,JGRAPH_2:11;
A6: |.p1.|=|.q1.| & |.p2.|=|.q2.| by A2,Th73;
  then
A7: p1`1/|.p1.|= ((q1`1/|.q1.|-cn)/(1-cn)) by A3,A5,XCMPLX_1:90;
A8: p2`1/|.p2.|= ((q2`1/|.q2.|-cn)/(1-cn)) by A4,A5,A6,XCMPLX_1:90;
A9: q1`1/|.q1.|-cn< q2`1/|.q2.|-cn by A1,XREAL_1:11;
  1-cn>0 by A1,XREAL_1:151;
  hence thesis by A7,A8,A9,XREAL_1:76;
end;

theorem Th85:
  for cn being Real,q1,q2 being Point of TOP-REAL 2 st -1<cn & cn<1 & q1`2>0
  & q1`1/|.q1.|<cn & q2`2>0 & q2`1/|.q2.|<cn & q1`1/|.q1.|<q2`1/|.q2.|
  holds (for p1,p2 being Point of TOP-REAL 2 st
  p1=(cn-FanMorphN).q1 & p2=(cn-FanMorphN).q2 holds p1`1/|.p1.|<p2`1/|.p2.|)
proof
  let cn be Real,q1,q2 be Point of TOP-REAL 2;
  assume
A1: -1<cn & cn<1 & q1`2>0
  & q1`1/|.q1.|<cn & q2`2>0 & q2`1/|.q2.|<cn & q1`1/|.q1.|<q2`1/|.q2.|;
  let p1,p2 be Point of TOP-REAL 2;
  assume
A2: p1=(cn-FanMorphN).q1 & p2=(cn-FanMorphN).q2;
  then p1=|[ |.q1.|* ((q1`1/|.q1.|-cn)/(1+cn)),
  |.q1.|*( sqrt(1-((q1`1/|.q1.|-cn)/(1+cn))^2))]| by A1,Th57;
  then
A3: p1`2= |.q1.|*( sqrt(1-((q1`1/|.q1.|-cn)/(1+cn))^2))&
  p1`1= |.q1.|* ((q1`1/|.q1.|-cn)/(1+cn)) by EUCLID:56;
  p2=|[ |.q2.|* ((q2`1/|.q2.|-cn)/(1+cn)),
  |.q2.|*( sqrt(1-((q2`1/|.q2.|-cn)/(1+cn))^2))]| by A1,A2,Th57;
  then
A4: p2`2= |.q2.|*( sqrt(1-((q2`1/|.q2.|-cn)/(1+cn))^2))&
  p2`1= |.q2.|* ((q2`1/|.q2.|-cn)/(1+cn)) by EUCLID:56;
A5: |.q1.|>0 & |.q2.|>0 by A1,Lm1,JGRAPH_2:11;
A6: |.p1.|=|.q1.| & |.p2.|=|.q2.| by A2,Th73;
  then
A7: p1`1/|.p1.|= ((q1`1/|.q1.|-cn)/(1+cn)) by A3,A5,XCMPLX_1:90;
A8: p2`1/|.p2.|= ((q2`1/|.q2.|-cn)/(1+cn)) by A4,A5,A6,XCMPLX_1:90;
A9: q1`1/|.q1.|-cn< q2`1/|.q2.|-cn by A1,XREAL_1:11;
  1+cn>0 by A1,XREAL_1:150;
  hence p1`1/|.p1.|<p2`1/|.p2.| by A7,A8,A9,XREAL_1:76;
end;

theorem
  for cn being Real,q1,q2 being Point of TOP-REAL 2 st -1<cn & cn<1 & q1`2 > 0
  & q2`2>0 & q1`1/|.q1.|<q2`1/|.q2.|
  holds (for p1,p2 being Point of TOP-REAL 2 st
  p1=(cn-FanMorphN).q1 & p2=(cn-FanMorphN).q2 holds p1`1/|.p1.|<p2`1/|.p2.|)
proof
  let cn be Real,q1,q2 be Point of TOP-REAL 2;
  assume
A1: -1<cn & cn<1 & q1`2>0 & q2`2>0 & q1`1/|.q1.|<q2`1/|.q2.|;
  let p1,p2 be Point of TOP-REAL 2;
  assume
A2: p1=(cn-FanMorphN).q1 & p2=(cn-FanMorphN).q2;
  per cases;
  suppose q1`1/|.q1.|>=cn & q2`1/|.q2.|>=cn;
    hence p1`1/|.p1.|<p2`1/|.p2.| by A1,A2,Th84;
  end;
  suppose q1`1/|.q1.|>=cn & q2`1/|.q2.|<cn;
    hence p1`1/|.p1.|<p2`1/|.p2.| by A1,XXREAL_0:2;
  end;
  suppose
A3: q1`1/|.q1.|<cn & q2`1/|.q2.|>=cn;
    then
A4: p1`2>0 & p1`1<0 by A1,A2,Th83;
    then
A5: |.p1.|>0 by Lm1,JGRAPH_2:11;
    p2`2>0 & p2`1>=0 by A1,A2,A3,Th82;
    then p2`1/|.p2.|>=0;
    hence p1`1/|.p1.|<p2`1/|.p2.| by A4,A5,XREAL_1:143;
  end;
  suppose q1`1/|.q1.|<cn & q2`1/|.q2.|<cn;
    hence p1`1/|.p1.|<p2`1/|.p2.| by A1,A2,Th85;
  end;
end;

theorem
  for cn being Real,q being Point of TOP-REAL 2 st -1<cn & cn<1 & q`2>0
  & q`1/|.q.|=cn holds (for p being Point of TOP-REAL 2 st
  p=(cn-FanMorphN).q holds p`2>0 & p`1=0)
proof
  let cn be Real,q be Point of TOP-REAL 2;
  assume
A1: -1<cn & cn<1 & q`2>0 & q`1/|.q.|=cn;
  let p be Point of TOP-REAL 2;
  assume p=(cn-FanMorphN).q;
  then
A3: p=|[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
  |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by A1,Th56;
A4: |.q.|<>0 by A1,JGRAPH_2:11,TOPRNS_1:25;
A5: p`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))&
  p`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by A3,EUCLID:56;
  sqrt(1-((-(q`1/|.q.|-cn))/(1-cn))^2)>0 by A1,SQUARE_1:93;
  hence thesis by A1,A4,A5,XREAL_1:131;
end;

theorem
  for cn being real number holds 0.REAL 2=(cn-FanMorphN).(0.REAL 2)
  by Th56,JGRAPH_2:11;

begin :: Fan Morphism for East

definition
  let s be real number, q be Point of TOP-REAL 2;
  func FanE(s,q) -> Point of TOP-REAL 2 equals
  :Def6:
  |.q.|*|[sqrt(1-((q`2/|.q.|-s)/(1-s))^2),
  (q`2/|.q.|-s)/(1-s)]| if q`2/|.q.|>=s & q`1>0,
  |.q.|*|[sqrt(1-((q`2/|.q.|-s)/(1+s))^2),
  (q`2/|.q.|-s)/(1+s)]| if q`2/|.q.|<s & q`1>0 otherwise q;
  correctness;
end;

definition
  let s be real number;
  func s-FanMorphE -> Function of TOP-REAL 2, TOP-REAL 2 means
  :Def7:
  for q being Point of TOP-REAL 2 holds it.q=FanE(s,q);
  existence
  proof
    deffunc F(Point of TOP-REAL 2)=FanE(s,$1);
    thus ex IT being Function of TOP-REAL 2, TOP-REAL 2 st
    for q being Point of TOP-REAL 2 holds IT.q=F(q)from FUNCT_2:sch 4;
  end;
  uniqueness
  proof
    deffunc F(Point of TOP-REAL 2)=FanE(s,$1);
    thus for a,b being Function of TOP-REAL 2, TOP-REAL 2 st
    (for q being Point of TOP-REAL 2 holds a.q=F(q)) &
    (for q being Point of TOP-REAL 2 holds b.q=F(q)) holds a=b
    from BINOP_2:sch 1;
  end;
end;

theorem Th89:
  for sn being real number holds (q`2/|.q.|>=sn & q`1>0 implies
  sn-FanMorphE.q= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
  |.q.|* ((q`2/|.q.|-sn)/(1-sn))]|)& (q`1<=0 implies sn-FanMorphE.q=q)
proof
  let sn be real number;
A1: sn-FanMorphE.q=FanE(sn,q) by Def7;
  hereby
    assume q`2/|.q.|>=sn & q`1>0;
    then FanE(sn,q)= |.q.|*|[sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2),
    (q`2/|.q.|-sn)/(1-sn)]| by Def6
      .= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
    |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by EUCLID:62;
    hence sn-FanMorphE.q= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
    |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by Def7;
  end;
  assume q`1<=0;
  hence thesis by A1,Def6;
end;

theorem Th90:
  for sn being Real holds (q`2/|.q.|<=sn & q`1>0 implies
  sn-FanMorphE.q= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
  |.q.|*((q`2/|.q.|-sn)/(1+sn))]|)
proof
  let sn be Real;
  assume
A1: q`2/|.q.|<=sn & q`1>0;
  now per cases by A1,XXREAL_0:1;
    case q`2/|.q.|<sn;
      then FanE(sn,q)= |.q.|*|[sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2),
      (q`2/|.q.|-sn)/(1+sn)]| by A1,Def6
        .= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
      |.q.|* ((q`2/|.q.|-sn)/(1+sn))]| by EUCLID:62;
      hence sn-FanMorphE.q= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
      |.q.|*((q`2/|.q.|-sn)/(1+sn))]| by Def7;
    end;
    case
A2:   q`2/|.q.|=sn;
      then (q`2/|.q.|-sn)/(1-sn)=0;
      hence sn-FanMorphE.q= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
      |.q.|*((q`2/|.q.|-sn)/(1+sn))]| by A1,A2,Th89;
    end;
  end;
  hence thesis;
end;

theorem Th91:
  for sn being Real st -1<sn & sn<1 holds
  (q`2/|.q.|>=sn & q`1>=0 & q<>0.REAL 2 implies
  sn-FanMorphE.q = |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
  |.q.|* ((q`2/|.q.|-sn)/(1-sn))]|) &
  (q`2/|.q.|<=sn & q`1>=0 & q<>0.REAL 2 implies
  sn-FanMorphE.q = |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
  |.q.|*((q`2/|.q.|-sn)/(1+sn))]|)
proof
  let sn be Real;
  assume
A1: -1<sn & sn<1;
  per cases;
  suppose
A2: q`2/|.q.|>=sn & q`1>=0 & q<>0.REAL 2;
    per cases;
    suppose
A3:   q`1>0;
      then FanE(sn,q)= |.q.|*|[sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2),
      (q`2/|.q.|-sn)/(1-sn)]| by A2,Def6
        .= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
      |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by EUCLID:62;
      hence thesis by A3,Def7,Th90;
    end;
    suppose
A4:   q`1<=0;
      then
A5:   sn-FanMorphE.q=q by Th89;
A6:   (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
A7:   |.q.|<>0 by A2,TOPRNS_1:25;
      then
A8:   |.q.|^2>0 by SQUARE_1:74;
A9:   q`1=0 by A2,A4;
A11:  sqrt((|.q.|)^2)=|.q.| by SQUARE_1:89;
A12:  1-sn>0 by A1,XREAL_1:151;
      (q`2)^2/|.q.|^2=1^2 by A6,A8,A9,XCMPLX_1:60;
      then ((q`2)/|.q.|)^2=1^2 by XCMPLX_1:77;
      then
A13:  sqrt(((q`2)/|.q.|)^2)=1 by SQUARE_1:89;
      now
        assume q`2<0;
        then q`2/|.q.|<0 by A7,XREAL_1:143;
        then -((q`2)/|.q.|)=1 by A13,SQUARE_1:90;
        hence contradiction by A1,A2;
      end;
      then
A14:  |.q.|=q`2 by A6,A9,A11,SQUARE_1:89;
      then 1=q`2/|.q.| by A2,TOPRNS_1:25,XCMPLX_1:60;
      then (q`2/|.q.|-sn)/(1-sn)=1 by A12,XCMPLX_1:60;
      hence thesis by A1,A5,A7,A9,A14,EUCLID:57,SQUARE_1:82,XCMPLX_1:60;
    end;
  end;
  suppose
A15: q`2/|.q.|<=sn & q`1>=0 & q<>0.REAL 2;
    per cases;
    suppose q`1>0;
      hence thesis by Th89,Th90;
    end;
    suppose
A16:  q`1<=0;
A17:  (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
A18:  |.q.|<>0 by A15,TOPRNS_1:25;
A19:  q`1=0 by A15,A16;
A21:  1+sn>0 by A1,XREAL_1:150;
      1>q`2/|.q.| by A1,A15,XXREAL_0:2;
      then 1 *(|.q.|)>q`2/|.q.|*(|.q.|) by A18,XREAL_1:70;
      then
A22:  (|.q.|)>q`2 by A15,TOPRNS_1:25,XCMPLX_1:88;
      then
A23:  |.q.|=-q`2 by A17,A19,SQUARE_1:109;
A24:  q`2= -(|.q.|) by A17,A19,A22,SQUARE_1:109;
      then -1=q`2/|.q.| by A15,TOPRNS_1:25,XCMPLX_1:198;
      then (q`2/|.q.|-sn)/(1+sn) =(-(1+sn))/(1+sn)
        .=-1 by A21,XCMPLX_1:198;
      then |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
      |.q.|* ((q`2/|.q.|-sn)/(1+sn))]| =q by A19,A23,EUCLID:57,SQUARE_1:82;
      hence thesis by A1,A16,A18,A24,Th89,XCMPLX_1:198;
    end;
  end;
  suppose q`1<0 or q=0.REAL 2;
    hence thesis;
  end;
end;

theorem Th92:
  for sn being Real,K1 being non empty Subset of TOP-REAL 2,
  f being Function of (TOP-REAL 2)|K1,R^1 st -1<sn & sn<1 &
  (for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|* ((p`2/|.p.|-sn)/(1-sn)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1>=0 & q<>0.REAL 2) holds
  f is continuous
proof
  let sn be Real,K1 be non empty Subset of TOP-REAL 2,
  f be Function of (TOP-REAL 2)|K1,R^1;
  assume
A1: -1<sn & sn<1 &
  (for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|* ((p`2/|.p.|-sn)/(1-sn)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1>=0 & q<>0.REAL 2);
  set a=sn, b=(1-sn);
A2: b>0 by A1,XREAL_1:151;
  reconsider g2=proj2|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm3;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1
  by Lm5;
  for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q<>0.REAL 2 by A1;
  then for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm6;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
A3: (for q being Point of
  (TOP-REAL 2)|K1,r1,r2 being Real st g2.q=r1 & g1.q=r2
  holds g3.q=r2*((r1/r2-a)/b)) & g3 is continuous by A2,Th10;
A4: dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then
A5: dom f=dom g3 by FUNCT_2:def 1;
  for x being set st x in dom f holds f.x=g3.x
  proof
    let x be set;
    assume
A6: x in dom f;
    then x in K1 by A4,A5,PRE_TOPC:29;
    then reconsider r=x as Point of (TOP-REAL 2);
    reconsider s=x as Point of (TOP-REAL 2)|K1 by A6;
A7: f.r=(|.r.|)* ((r`2/|.r.|-sn)/(1-sn)) by A1,A6;
A8: g2.s=proj2.s by Lm3;
A9: g1.s=(2 NormF).s by Lm5;
A10: proj2.r=r`2 by PSCOMP_1:def 29;
    (2 NormF).r=|.r.| by Def1;
    hence f.x=g3.x by A3,A7,A8,A9,A10;
  end;
  hence f is continuous by A3,A5,FUNCT_1:9;
end;

theorem Th93:
  for sn being Real,K1 being non empty Subset of TOP-REAL 2,
  f being Function of (TOP-REAL 2)|K1,R^1 st -1<sn & sn<1 &
  (for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|* ((p`2/|.p.|-sn)/(1+sn)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1>=0 & q<>0.REAL 2) holds
  f is continuous
proof
  let sn be Real,K1 be non empty Subset of TOP-REAL 2,
  f be Function of (TOP-REAL 2)|K1,R^1;
  assume
A1: -1<sn & sn<1 &
  (for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|* ((p`2/|.p.|-sn)/(1+sn)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1>=0 & q<>0.REAL 2);
  set a=sn, b=(1+sn);
A2: 1+sn>0 by A1,XREAL_1:150;
  reconsider g2=proj2|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm3;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1
  by Lm5;
  for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q<>0.REAL 2 by A1;
  then for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm6;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
A3: (for q being Point of
  (TOP-REAL 2)|K1,r1,r2 being Real st g2.q=r1 & g1.q=r2
  holds g3.q=r2*((r1/r2-a)/b)) & g3 is continuous by A2,Th10;
A4: dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then
A5: dom f=dom g3 by FUNCT_2:def 1;
  for x being set st x in dom f holds f.x=g3.x
  proof
    let x be set;
    assume
A6: x in dom f;
    then x in dom g3 by A4;
    then x in K1 by A4,PRE_TOPC:29;
    then reconsider r=x as Point of (TOP-REAL 2);
    reconsider s=x as Point of (TOP-REAL 2)|K1 by A6;
A7: f.r=(|.r.|)* ((r`2/|.r.|-sn)/(1+sn)) by A1,A6;
A8: g2.s=proj2.s by Lm3;
A9: g1.s=(2 NormF).s by Lm5;
A10: proj2.r=r`2 by PSCOMP_1:def 29;
    (2 NormF).r=|.r.| by Def1;
    hence f.x=g3.x by A3,A7,A8,A9,A10;
  end;
  hence f is continuous by A3,A5,FUNCT_1:9;
end;

theorem Th94:
  for sn being Real,K1 being non empty Subset of TOP-REAL 2,
  f being Function of (TOP-REAL 2)|K1,R^1 st -1<sn & sn<1 &
  (for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds
  q`1>=0 & q`2/|.q.|>=sn & q<>0.REAL 2) holds f is continuous
proof
  let sn be Real,K1 be non empty Subset of TOP-REAL 2,
  f be Function of (TOP-REAL 2)|K1,R^1;
  assume
A1: -1<sn & sn<1 &
  (for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1>=0 & q`2/|.q.|>=sn & q<>0.REAL 2);
  set a=sn, b=(1-sn);
A2: b>0 by A1,XREAL_1:151;
  reconsider g2=proj2|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm3;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1
  by Lm5;
  for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q<>0.REAL 2 by A1;
  then for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm6;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
A3: (for q being Point of
  (TOP-REAL 2)|K1,r1,r2 being real number st g2.q=r1 & g1.q=r2
  holds g3.q=r2*(sqrt(abs(1-((r1/r2-a)/b)^2)))) & g3 is continuous by A2,Th15;
A4: dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then
A5: dom f=dom g3 by FUNCT_2:def 1;
  for x being set st x in dom f holds f.x=g3.x
  proof
    let x be set;
    assume
A6: x in dom f;
    then x in K1 by A4,A5,PRE_TOPC:29;
    then reconsider r=x as Point of (TOP-REAL 2);
    reconsider s=x as Point of (TOP-REAL 2)|K1 by A6;
A7: now
      assume |.r.|=0;
      then r=0.REAL 2 by TOPRNS_1:25;
      hence contradiction by A1,A6;
    end;
    |.r.|^2=(r`1)^2+(r`2)^2 by JGRAPH_3:10;
    then
A9: ((r`2) -(|.r.|))*((r`2)+|.r.|) =-(r`1)^2;
    (r`1)^2>=0 by XREAL_1:65;
    then -(r`1)^2 <=0;
    then -(|.r.|)<=r`2 & r`2<= |.r.| by A9,XREAL_1:95;
    then r`2/|.r.| <= |.r.|/|.r.| by XREAL_1:74;
    then r`2/|.r.|<=1 by A7,XCMPLX_1:60;
    then
A10: r`2/|.r.|-sn<=(1-sn) by XREAL_1:11;
A11: now
      assume (1-sn)^2=0;
      then 1-sn+sn=0+sn by XCMPLX_1:6;
      hence contradiction by A1;
    end;
A12: 1-sn>0 by A1,XREAL_1:151;
A13: (1-sn)^2>=0 by XREAL_1:65;
    sn<=r`2/(|.r.|) by A1,A6;
    then sn-r`2/|.r.|<=0 by XREAL_1:49;
    then -(sn- r`2/|.r.|)>=-(1-sn) by A12,XREAL_1:26;
    then (r`2/|.r.|-sn)^2<=(1-sn)^2 by A10,SQUARE_1:119;
    then (r`2/|.r.|-sn)^2/(1-sn)^2<=(1-sn)^2/(1-sn)^2 by A13,XREAL_1:74;
    then (r`2/|.r.|-sn)^2/(1-sn)^2<=1 by A11,XCMPLX_1:60;
    then ((r`2/|.r.|-sn)/(1-sn))^2<=1 by XCMPLX_1:77;
    then 1-((r`2/|.r.|-sn)/(1-sn))^2>=0 by XREAL_1:50;
    then abs(1-((r`2/|.r.|-sn)/(1-sn))^2)
    =1-((r`2/|.r.|-sn)/(1-sn))^2 by ABSVALUE:def 1;
    then
A14: f.r=(|.r.|)*(sqrt(abs(1-((r`2/|.r.|-sn)/(1-sn))^2))) by A1,A6;
A15: g2.s=proj2.s by Lm3;
A16: g1.s=(2 NormF).s by Lm5;
A17: proj2.r=r`2 by PSCOMP_1:def 29;
    (2 NormF).r=|.r.| by Def1;
    hence f.x=g3.x by A3,A14,A15,A16,A17;
  end;
  hence f is continuous by A3,A5,FUNCT_1:9;
end;

theorem Th95:
  for sn being Real,K1 being non empty Subset of TOP-REAL 2,
  f being Function of (TOP-REAL 2)|K1,R^1 st -1<sn & sn<1 &
  (for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds
  q`1>=0 & q`2/|.q.|<=sn & q<>0.REAL 2) holds f is continuous
proof
  let sn be Real,K1 be non empty Subset of TOP-REAL 2,
  f be Function of (TOP-REAL 2)|K1,R^1;
  assume
A1: -1<sn & sn<1 &
  (for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1>=0 & q`2/|.q.|<=sn & q<>0.REAL 2);
  set a=sn, b=(1+sn);
A2: 1+sn>0 by A1,XREAL_1:150;
  reconsider g2=proj2|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm3;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1
  by Lm5;
  for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q<>0.REAL 2 by A1;
  then for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm6;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
A3: (for q being Point of
  (TOP-REAL 2)|K1,r1,r2 being real number st g2.q=r1 & g1.q=r2
  holds g3.q=r2*(sqrt(abs(1-((r1/r2-a)/b)^2)))) & g3 is continuous by A2,Th15;
A4: dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then
A5: dom f=dom g3 by FUNCT_2:def 1;
  for x being set st x in dom f holds f.x=g3.x
  proof
    let x be set;
    assume
A6: x in dom f;
    then x in K1 by A4,A5,PRE_TOPC:29;
    then reconsider r=x as Point of (TOP-REAL 2);
    reconsider s=x as Point of (TOP-REAL 2)|K1 by A6;
A7: now
      assume |.r.|=0;
      then r=0.REAL 2 by TOPRNS_1:25;
      hence contradiction by A1,A6;
    end;
    |.r.|^2=(r`1)^2+(r`2)^2 by JGRAPH_3:10;
    then
A9: ((r`2) -(|.r.|))*((r`2)+|.r.|) =-(r`1)^2;
    (r`1)^2>=0 by XREAL_1:65;
    then -(r`1)^2 <=0;
    then -(|.r.|)<=r`2 & r`2<= |.r.| by A9,XREAL_1:95;
    then r`2/|.r.| >= (-(|.r.|))/|.r.| by XREAL_1:74;
    then r`2/|.r.|>= -1 by A7,XCMPLX_1:198;
    then r`2/|.r.|-sn>=-1-sn by XREAL_1:11;
    then
A10: r`2/|.r.|-sn>=-(1+sn);
A11: (1+sn)^2>0 by A2,SQUARE_1:74;
    sn>=r`2/(|.r.|) by A1,A6;
    then sn-r`2/|.r.|>=0 by XREAL_1:50;
    then -(sn-r`2/|.r.|)<=-0;
    then (r`2/|.r.|-sn)^2<=(1+sn)^2 by A2,A10,SQUARE_1:119;
    then (r`2/|.r.|-sn)^2/(1+sn)^2<=(1+sn)^2/(1+sn)^2 by A11,XREAL_1:74;
    then (r`2/|.r.|-sn)^2/(1+sn)^2<=1 by A11,XCMPLX_1:60;
    then ((r`2/|.r.|-sn)/(1+sn))^2<=1 by XCMPLX_1:77;
    then 1-((r`2/|.r.|-sn)/(1+sn))^2>=0 by XREAL_1:50;
    then abs(1-((r`2/|.r.|-sn)/(1+sn))^2)
    =1-((r`2/|.r.|-sn)/(1+sn))^2 by ABSVALUE:def 1;
    then
A12: f.r=(|.r.|)*(sqrt(abs(1-((r`2/|.r.|-sn)/(1+sn))^2))) by A1,A6;
A13: g2.s=proj2.s by Lm3;
A14: g1.s=(2 NormF).s by Lm5;
A15: proj2.r=r`2 by PSCOMP_1:def 29;
    (2 NormF).r=|.r.| by Def1;
    hence f.x=g3.x by A3,A12,A13,A14,A15;
  end;
  hence f is continuous by A3,A5,FUNCT_1:9;
end;

theorem Th96:
  for sn being Real, K0,B0 being Subset of TOP-REAL 2,f being
  Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0
  st -1<sn & sn<1 & f=(sn-FanMorphE)|K0 &
  B0={q where q is Point of TOP-REAL 2: q`1>=0 & q<>0.REAL 2}
  & K0={p: p`2/|.p.|>=sn & p`1>=0 & p<>0.REAL 2} holds f is continuous
proof
  let sn be Real,K0,B0 be Subset of TOP-REAL 2,f be
  Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0;
  assume
A1: -1<sn & sn<1 & f=(sn-FanMorphE)|K0 &
  B0={q where q is Point of TOP-REAL 2: q`1>=0 & q<>0.REAL 2} &
  K0={p: p`2/|.p.|>=sn & p`1>=0 & p<>0.REAL 2};
  set cn=sqrt(1-sn^2);
  set p0=|[cn,sn]|;
A2: p0`2=sn by EUCLID:56;
A3: p0`1=cn by EUCLID:56;
  sn^2<1^2 by A1,SQUARE_1:120;
  then
A4: 1-sn^2>0 by XREAL_1:52;
  then
A5: --cn>0 by SQUARE_1:93;
A6: |.p0.|=sqrt((cn)^2+sn^2) by A2,A3,JGRAPH_3:10;
  cn^2=1-sn^2 by A4,SQUARE_1:def 4;
  then p0`2/|.p0.|=sn by A6,EUCLID:56,SQUARE_1:83;
  then
A7: p0 in K0 by A1,A3,A5,JGRAPH_2:11;
  then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
A8: K0 c= B0
  proof
    let x be set;
    assume x in K0;
    then consider p8 being Point of TOP-REAL 2 such that
A9: x=p8 & (p8`2/|.p8.|>=sn & p8`1>=0 & p8<>0.REAL 2) by A1;
    thus x in B0 by A1,A9;
  end;
A10: dom (proj2*((sn-FanMorphE)|K1)) c= dom ((sn-FanMorphE)|K1) by RELAT_1:44;
  dom ((sn-FanMorphE)|K1) c= dom (proj2*((sn-FanMorphE)|K1))
  proof
    let x be set;
    assume
A11: x in dom ((sn-FanMorphE)|K1);
    then
A12: x in dom (sn-FanMorphE) /\ K1 by FUNCT_1:68;
A13: ((sn-FanMorphE)|K1).x=(sn-FanMorphE).x by A11,FUNCT_1:68;
A14: dom proj2 = (the carrier of TOP-REAL 2) by FUNCT_2:def 1;
    x in dom (sn-FanMorphE) by A12,XBOOLE_0:def 4;
    then (sn-FanMorphE).x in rng (sn-FanMorphE) by FUNCT_1:12;
    hence x in dom (proj2*((sn-FanMorphE)|K1)) by A11,A13,A14,FUNCT_1:21;
  end;
  then
A15: dom (proj2*((sn-FanMorphE)|K1))
  =dom ((sn-FanMorphE)|K1) by A10,XBOOLE_0:def 10
    .=dom (sn-FanMorphE) /\ K1 by FUNCT_1:68
    .=(the carrier of TOP-REAL 2)/\ K1 by FUNCT_2:def 1
    .=K1 by XBOOLE_1:28
    .=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
  rng (proj2*((sn-FanMorphE)|K1)) c= the carrier of R^1 by TOPMETR:24;

then reconsider g2=proj2*((sn-FanMorphE)|K1) as Function of (TOP-REAL 2)|K1,R^1
  by A15,FUNCT_2:4;
A16: dom (proj1*((sn-FanMorphE)|K1)) c= dom ((sn-FanMorphE)|K1) by RELAT_1:44;
  dom ((sn-FanMorphE)|K1) c= dom (proj1*((sn-FanMorphE)|K1))
  proof
    let x be set;
    assume
A17: x in dom ((sn-FanMorphE)|K1);
    then
A18: x in dom (sn-FanMorphE) /\ K1 by FUNCT_1:68;
A19: ((sn-FanMorphE)|K1).x=(sn-FanMorphE).x by A17,FUNCT_1:68;
A20: dom proj1 = (the carrier of TOP-REAL 2) by FUNCT_2:def 1;
    x in dom (sn-FanMorphE) by A18,XBOOLE_0:def 4;
    then (sn-FanMorphE).x in rng (sn-FanMorphE) by FUNCT_1:12;
    hence x in dom (proj1*((sn-FanMorphE)|K1)) by A17,A19,A20,FUNCT_1:21;
  end;
  then
A21: dom (proj1*((sn-FanMorphE)|K1))
  =dom ((sn-FanMorphE)|K1) by A16,XBOOLE_0:def 10
    .=dom (sn-FanMorphE) /\ K1 by FUNCT_1:68
    .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
    .=K1 by XBOOLE_1:28
    .=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
  rng (proj1*((sn-FanMorphE)|K1)) c= the carrier of R^1 by TOPMETR:24;

then reconsider g1=proj1*((sn-FanMorphE)|K1) as Function of (TOP-REAL 2)|K1,R^1
  by A21,FUNCT_2:4;
A22: for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1>=0 & q<>0.REAL 2
  proof
    let q be Point of TOP-REAL 2;
    assume
A23: q in the carrier of (TOP-REAL 2)|K1;
    the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then consider p3 being Point of TOP-REAL 2 such that
A24: q=p3 & (p3`2/|.p3.|>=sn & p3`1>=0 & p3<>0.REAL 2) by A1,A23;
    thus q`1>=0 & q<>0.REAL 2 by A24;
  end;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g2.p=|.p.|* ((p`2/|.p.|-sn)/(1-sn))
  proof
    let p be Point of TOP-REAL 2;
    assume
A25: p in the carrier of (TOP-REAL 2)|K1;
A26: dom ((sn-FanMorphE)|K1)=dom (sn-FanMorphE) /\ K1 by FUNCT_1:68
      .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
      .=K1 by XBOOLE_1:28;
A27: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then consider p3 being Point of TOP-REAL 2 such that
A28: p=p3 & (p3`2/|.p3.|>=sn & p3`1>=0 & p3<>0.REAL 2) by A1,A25;
A29: (sn-FanMorphE).p =|[|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
    |.p.|* ((p`2/|.p.|-sn)/(1-sn))]| by A1,A28,Th91;
    ((sn-FanMorphE)|K1).p=(sn-FanMorphE).p by A25,A27,FUNCT_1:72;
    then g2.p=proj2.(|[|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
    |.p.|* ((p`2/|.p.|-sn)/(1-sn))]|) by A25,A26,A27,A29,FUNCT_1:23
      .=(|[|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
    |.p.|* ((p`2/|.p.|-sn)/(1-sn))]|)`2 by PSCOMP_1:def 29
      .=|.p.|* ((p`2/|.p.|-sn)/(1-sn)) by EUCLID:56;
    hence g2.p=|.p.|* ((p`2/|.p.|-sn)/(1-sn));
  end;
  then consider f2 being Function of (TOP-REAL 2)|K1,R^1 such that
A30: for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds f2.p=|.p.|* ((p`2/|.p.|-sn)/(1-sn));
A31: f2 is continuous by A1,A22,A30,Th92;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g1.p=|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2))
  proof
    let p be Point of TOP-REAL 2;
    assume
A32: p in the carrier of (TOP-REAL 2)|K1;
A33: dom ((sn-FanMorphE)|K1)=dom (sn-FanMorphE) /\ K1 by FUNCT_1:68
      .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
      .=K1 by XBOOLE_1:28;
A34: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then consider p3 being Point of TOP-REAL 2 such that
A35: p=p3 & (p3`2/|.p3.|>=sn & p3`1>=0 & p3<>0.REAL 2) by A1,A32;
A36: (sn-FanMorphE).p=|[|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
    |.p.|* ((p`2/|.p.|-sn)/(1-sn))]| by A1,A35,Th91;
    ((sn-FanMorphE)|K1).p=(sn-FanMorphE).p by A32,A34,FUNCT_1:72;
    then g1.p=proj1.(|[|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
    |.p.|* ((p`2/|.p.|-sn)/(1-sn))]|) by A32,A33,A34,A36,FUNCT_1:23
      .=(|[|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
    |.p.|* ((p`2/|.p.|-sn)/(1-sn)) ]|)`1 by PSCOMP_1:def 28
      .= |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)) by EUCLID:56;
    hence g1.p=|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2));
  end;
  then consider f1 being Function of (TOP-REAL 2)|K1,R^1 such that
A37: for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds f1.p=|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2));
  for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1>=0 & q`2/|.q.|>=sn & q<>0.REAL 2
  proof
    let q be Point of TOP-REAL 2;
    assume
A38: q in the carrier of (TOP-REAL 2)|K1;
    the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then consider p3 being Point of TOP-REAL 2 such that
A39: q=p3 & (p3`2/|.p3.|>=sn & p3`1>=0 & p3<>0.REAL 2) by A1,A38;
    thus thesis by A39;
  end;
  then
A40: f1 is continuous by A1,A37,Th94;
  for x,y,r,s being real number st |[x,y]| in K1 &
  r=f1.(|[x,y]|) & s=f2.(|[x,y]|) holds f.(|[x,y]|)=|[r,s]|
  proof
    let x,y,r,s be real number;
    assume
A41: |[x,y]| in K1 & r=f1.(|[x,y]|) & s=f2.(|[x,y]|);
    set p99=|[x,y]|;
A42: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    consider p3 being Point of TOP-REAL 2 such that
A43: p99=p3 & (p3`2/|.p3.|>=sn & p3`1>=0 & p3<>0.REAL 2) by A1,A41;
A44: f1.p99=|.p99.|*(sqrt(1-((p99`2/|.p99.|-sn)/(1-sn))^2)) by A37,A41,A42;
    ((sn-FanMorphE)|K0).(|[x,y]|)=((sn-FanMorphE)).(|[x,y]|) by A41,FUNCT_1:72
      .= |[|.p99.|*(sqrt(1-((p99`2/|.p99.|-sn)/(1-sn))^2)),
    |.p99.|* ((p99`2/|.p99.|-sn)/(1-sn))]| by A1,A43,Th91
      .=|[r,s]| by A30,A41,A42,A44;
    hence f.(|[x,y]|)=|[r,s]| by A1;
  end;
  hence f is continuous by A7,A8,A31,A40,JGRAPH_2:45;
end;

theorem Th97:
  for sn being Real, K0,B0 being Subset of TOP-REAL 2,f being
  Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0
  st -1<sn & sn<1 & f=(sn-FanMorphE)|K0 &
  B0={q where q is Point of TOP-REAL 2: q`1>=0 & q<>0.REAL 2}
  & K0={p: p`2/|.p.|<=sn & p`1>=0 & p<>0.REAL 2} holds f is continuous
proof
  let sn be Real,K0,B0 be Subset of TOP-REAL 2,f be
  Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0;
  assume
A1: -1<sn & sn<1 & f=(sn-FanMorphE)|K0 &
  B0={q where q is Point of TOP-REAL 2: q`1>=0 & q<>0.REAL 2} &
  K0={p: p`2/|.p.|<=sn & p`1>=0 & p<>0.REAL 2};
  set cn=sqrt(1-sn^2);
  set p0=|[cn,sn]|;
A2: p0`2=sn by EUCLID:56;
A3: p0`1=cn by EUCLID:56;
  sn^2<1^2 by A1,SQUARE_1:120;
  then
A4: 1-sn^2>0 by XREAL_1:52;
  then
A5: --cn>0 by SQUARE_1:93;
A6: |.p0.|=sqrt((cn)^2+sn^2) by A2,A3,JGRAPH_3:10;
  cn^2=1-sn^2 by A4,SQUARE_1:def 4;
  then p0`2/|.p0.|=sn by A6,EUCLID:56,SQUARE_1:83;
  then
A7: p0 in K0 by A1,A3,A5,JGRAPH_2:11;
  then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
A8: K0 c= B0
  proof
    let x be set;
    assume x in K0;
    then consider p8 being Point of TOP-REAL 2 such that
A9: x=p8 & ( p8`2/|.p8.|<=sn & p8`1>=0 & p8<>0.REAL 2) by A1;
    thus x in B0 by A1,A9;
  end;
A10: dom (proj2*((sn-FanMorphE)|K1)) c= dom ((sn-FanMorphE)|K1) by RELAT_1:44;
  dom ((sn-FanMorphE)|K1) c= dom (proj2*((sn-FanMorphE)|K1))
  proof
    let x be set;
    assume
A11: x in dom ((sn-FanMorphE)|K1);
    then
A12: x in dom (sn-FanMorphE) /\ K1 by FUNCT_1:68;
A13: ((sn-FanMorphE)|K1).x=(sn-FanMorphE).x by A11,FUNCT_1:68;
A14: dom proj2 = (the carrier of TOP-REAL 2) by FUNCT_2:def 1;
    x in dom (sn-FanMorphE) by A12,XBOOLE_0:def 4;
    then (sn-FanMorphE).x in rng (sn-FanMorphE) by FUNCT_1:12;
    hence x in dom (proj2*((sn-FanMorphE)|K1)) by A11,A13,A14,FUNCT_1:21;
  end;
  then
A15: dom (proj2*((sn-FanMorphE)|K1))
  =dom ((sn-FanMorphE)|K1) by A10,XBOOLE_0:def 10
    .=dom (sn-FanMorphE) /\ K1 by FUNCT_1:68
    .=(the carrier of TOP-REAL 2)/\ K1 by FUNCT_2:def 1
    .=K1 by XBOOLE_1:28
    .=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
  rng (proj2*((sn-FanMorphE)|K1)) c= the carrier of R^1 by TOPMETR:24;

then reconsider g2=proj2*((sn-FanMorphE)|K1) as Function of (TOP-REAL 2)|K1,R^1
  by A15,FUNCT_2:4;
A16: dom (proj1*((sn-FanMorphE)|K1)) c= dom ((sn-FanMorphE)|K1) by RELAT_1:44;
  dom ((sn-FanMorphE)|K1) c= dom (proj1*((sn-FanMorphE)|K1))
  proof
    let x be set;
    assume
A17: x in dom ((sn-FanMorphE)|K1);
    then
A18: x in dom (sn-FanMorphE) /\ K1 by FUNCT_1:68;
A19: ((sn-FanMorphE)|K1).x=(sn-FanMorphE).x by A17,FUNCT_1:68;
A20: dom proj1 = (the carrier of TOP-REAL 2) by FUNCT_2:def 1;
    x in dom (sn-FanMorphE) by A18,XBOOLE_0:def 4;
    then (sn-FanMorphE).x in rng (sn-FanMorphE) by FUNCT_1:12;
    hence x in dom (proj1*((sn-FanMorphE)|K1)) by A17,A19,A20,FUNCT_1:21;
  end;
  then
A21: dom (proj1*((sn-FanMorphE)|K1))
  =dom ((sn-FanMorphE)|K1) by A16,XBOOLE_0:def 10
    .=dom (sn-FanMorphE) /\ K1 by FUNCT_1:68
    .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
    .=K1 by XBOOLE_1:28
    .=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
  rng (proj1*((sn-FanMorphE)|K1)) c= the carrier of R^1 by TOPMETR:24;

then reconsider g1=proj1*((sn-FanMorphE)|K1) as Function of (TOP-REAL 2)|K1,R^1
  by A21,FUNCT_2:4;
A22: for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1>=0 & q<>0.REAL 2
  proof
    let q be Point of TOP-REAL 2;
    assume
A23: q in the carrier of (TOP-REAL 2)|K1;
    the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then consider p3 being Point of TOP-REAL 2 such that
A24: q=p3 & (p3`2/|.p3.|<=sn & p3`1>=0 & p3<>0.REAL 2) by A1,A23;
    thus q`1>=0 & q<>0.REAL 2 by A24;
  end;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g2.p=|.p.|* ((p`2/|.p.|-sn)/(1+sn))
  proof
    let p be Point of TOP-REAL 2;
    assume
A25: p in the carrier of (TOP-REAL 2)|K1;
A26: dom ((sn-FanMorphE)|K1)=dom (sn-FanMorphE) /\ K1 by FUNCT_1:68
      .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
      .=K1 by XBOOLE_1:28;
A27: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then consider p3 being Point of TOP-REAL 2 such that
A28: p=p3 & (p3`2/|.p3.|<=sn & p3`1>=0 & p3<>0.REAL 2) by A1,A25;
A29: (sn-FanMorphE).p =|[|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
    |.p.|* ((p`2/|.p.|-sn)/(1+sn))]| by A1,A28,Th91;
    ((sn-FanMorphE)|K1).p=(sn-FanMorphE).p by A25,A27,FUNCT_1:72;
    then g2.p=proj2.(|[|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
    |.p.|* ((p`2/|.p.|-sn)/(1+sn))]|) by A25,A26,A27,A29,FUNCT_1:23
      .=(|[|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
    |.p.|* ((p`2/|.p.|-sn)/(1+sn))]|)`2 by PSCOMP_1:def 29
      .=|.p.|* ((p`2/|.p.|-sn)/(1+sn)) by EUCLID:56;
    hence g2.p=|.p.|* ((p`2/|.p.|-sn)/(1+sn));
  end;
  then consider f2 being Function of (TOP-REAL 2)|K1,R^1 such that
A30: for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds f2.p=|.p.|* ((p`2/|.p.|-sn)/(1+sn));
A31: f2 is continuous by A1,A22,A30,Th93;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g1.p=|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2))
  proof
    let p be Point of TOP-REAL 2;
    assume
A32: p in the carrier of (TOP-REAL 2)|K1;
A33: dom ((sn-FanMorphE)|K1)=dom (sn-FanMorphE) /\ K1 by FUNCT_1:68
      .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
      .=K1 by XBOOLE_1:28;
A34: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then consider p3 being Point of TOP-REAL 2 such that
A35: p=p3 & (p3`2/|.p3.|<=sn & p3`1>=0 & p3<>0.REAL 2) by A1,A32;
A36: (sn-FanMorphE).p=|[|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
    |.p.|* ((p`2/|.p.|-sn)/(1+sn))]| by A1,A35,Th91;
    ((sn-FanMorphE)|K1).p=(sn-FanMorphE).p by A32,A34,FUNCT_1:72;
    then g1.p=proj1.(|[|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
    |.p.|* ((p`2/|.p.|-sn)/(1+sn))]|) by A32,A33,A34,A36,FUNCT_1:23
      .=(|[|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
    |.p.|* ((p`2/|.p.|-sn)/(1+sn)) ]|)`1 by PSCOMP_1:def 28
      .= |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)) by EUCLID:56;
    hence g1.p=|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2));
  end;
  then consider f1 being Function of (TOP-REAL 2)|K1,R^1 such that
A37: for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds f1.p=|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2));
  for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1>=0 & q`2/|.q.|<=sn & q<>0.REAL 2
  proof
    let q be Point of TOP-REAL 2;
    assume
A38: q in the carrier of (TOP-REAL 2)|K1;
    the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then consider p3 being Point of TOP-REAL 2 such that
A39: q=p3 & (p3`2/|.p3.|<=sn & p3`1>=0 & p3<>0.REAL 2) by A1,A38;
    thus thesis by A39;
  end;
  then
A40: f1 is continuous by A1,A37,Th95;
  for x,y,r,s being real number st |[x,y]| in K1 &
  r=f1.(|[x,y]|) & s=f2.(|[x,y]|) holds f.(|[x,y]|)=|[r,s]|
  proof
    let x,y,r,s be real number;
    assume
A41: |[x,y]| in K1 & r=f1.(|[x,y]|) & s=f2.(|[x,y]|);
    set p99=|[x,y]|;
A42: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    consider p3 being Point of TOP-REAL 2 such that
A43: p99=p3 & (p3`2/|.p3.|<=sn & p3`1>=0 & p3<>0.REAL 2) by A1,A41;
A44: f1.p99=|.p99.|*(sqrt(1-((p99`2/|.p99.|-sn)/(1+sn))^2)) by A37,A41,A42;
    ((sn-FanMorphE)|K0).(|[x,y]|)=((sn-FanMorphE)).(|[x,y]|) by A41,FUNCT_1:72
      .= |[|.p99.|*(sqrt(1-((p99`2/|.p99.|-sn)/(1+sn))^2)),
    |.p99.|* ((p99`2/|.p99.|-sn)/(1+sn))]| by A1,A43,Th91
      .=|[r,s]| by A30,A41,A42,A44;
    hence f.(|[x,y]|)=|[r,s]| by A1;
  end;
  hence f is continuous by A7,A8,A31,A40,JGRAPH_2:45;
end;

theorem Th98:
  for sn being Real, K03 being Subset of TOP-REAL 2
  st K03={p: p`2>=(sn)*(|.p.|) & p`1>=0} holds K03 is closed
proof
  let sn be Real, K003 be Subset of TOP-REAL 2;
  assume
A1: K003={p: p`2>=(sn)*(|.p.|) & p`1>=0};
  defpred P[Point of TOP-REAL 2] means ($1`2>=sn*|.$1.|);
  reconsider K1={p7 where p7 is Point of TOP-REAL 2:P[p7]}
  as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
A2: K1 is closed by Lm7;
  defpred Q[Point of TOP-REAL 2] means $1`1>=0;
  reconsider KX={p where p is Point of TOP-REAL 2: Q[p]}
  as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
A3: KX is closed by JORDAN6:5;
  {p : P[p] & Q[p]} = {p7 where p7 is Point of TOP-REAL 2:P[p7]} /\
  {p1 where p1 is Point of TOP-REAL 2: Q[p1]} from DOMAIN_1:sch 10;
  hence thesis by A1,A2,A3,TOPS_1:35;
end;

theorem Th99:
  for sn being Real, K03 being Subset of TOP-REAL 2
  st K03={p: p`2<=(sn)*(|.p.|) & p`1>=0} holds K03 is closed
proof
  let sn be Real, K003 be Subset of TOP-REAL 2;
  assume
A1: K003={p: p`2<=(sn)*(|.p.|) & p`1>=0};
  defpred P[Point of TOP-REAL 2] means ($1`2<=sn*|.$1.|);
  reconsider K1={p7 where p7 is Point of TOP-REAL 2:P[p7]}
  as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
A2: K1 is closed by Lm9;
  defpred Q[Point of TOP-REAL 2] means $1`1>=0;
  reconsider KX={p where p is Point of TOP-REAL 2: Q[p]}
  as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
A3: KX is closed by JORDAN6:5;
  {p : P[p] & Q[p]} = {p7 where p7 is Point of TOP-REAL 2:P[p7]} /\
  {p1 where p1 is Point of TOP-REAL 2: Q[p1]} from DOMAIN_1:sch 10;
  hence thesis by A1,A2,A3,TOPS_1:35;
end;

theorem Th100:
  for sn being Real, K0,B0 being Subset of TOP-REAL 2,f being
  Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0
  st -1<sn & sn<1 & f=(sn-FanMorphE)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} & K0={p: p`1>=0 & p<>0.REAL 2}
  holds f is continuous
proof
  let sn be Real,K0,B0 be Subset of TOP-REAL 2,f be
  Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0;
  assume
A1: -1<sn & sn<1 & f=(sn-FanMorphE)|K0 & B0=(the carrier of TOP-REAL 2)
  \ {0.REAL 2} & K0={p: p`1>=0 & p<>0.REAL 2};
  set cn=sqrt(1-sn^2);
  set p0=|[cn,sn]|;
A2: p0`2=sn by EUCLID:56;
A3: p0`1=cn by EUCLID:56;
  sn^2<1^2 by A1,SQUARE_1:120;
  then
A4: 1-sn^2>0 by XREAL_1:52;
  then
A5: p0<>0.REAL 2 by A3,JGRAPH_2:11,SQUARE_1:93;
A6: --cn>0 by A4,SQUARE_1:93;
A7: p0`1>0 by A3,A4,SQUARE_1:93;
A8: |.p0.|=sqrt((cn)^2+sn^2) by A2,A3,JGRAPH_3:10;
  cn^2=1-sn^2 by A4,SQUARE_1:def 4;
  then
A9: p0`2/|.p0.|=sn by A8,EUCLID:56,SQUARE_1:83;
  p0 in K0 by A1,A7,JGRAPH_2:11;
  then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
  p0 in the carrier of TOP-REAL 2 & not p0 in {0.REAL 2} by A5,TARSKI:def 1;
  then reconsider D=B0 as non empty Subset of TOP-REAL 2 by A1,XBOOLE_0:def 5;
A10: p0 in {p: p`2/|.p.|>=sn & p`1>=0 & p<>0.REAL 2} by A7,A9,JGRAPH_2:11;
  defpred P[Point of TOP-REAL 2] means
  $1`2/|.$1.|>=sn & $1`1>=0 & $1<>0.REAL 2;
A11: {p: P[p]} is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
A12: {p: p`2/|.p.|>=sn & p`1>=0 & p<>0.REAL 2} c= K1
  proof
    let x be set;
    assume x in {p: p`2/|.p.|>=sn & p`1>=0 & p<>0.REAL 2};
    then consider p such that
A13: p=x & p`2/|.p.|>=sn & p`1>=0 & p<>0.REAL 2;
    thus x in K1 by A1,A13;
  end;
  then reconsider K00={p: p`2/|.p.|>=sn & p`1>=0 & p<>0.REAL 2}
  as non empty Subset of ((TOP-REAL 2)|K1) by A10,PRE_TOPC:29;
  reconsider K001={p: p`2/|.p.|>=sn & p`1>=0 & p<>0.REAL 2}
  as non empty Subset of (TOP-REAL 2) by A10,A11;
  defpred P[Point of TOP-REAL 2] means $1`2>=(sn)*(|.$1.|) & $1`1>=0;
  {p: P[p]} is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
  then reconsider K003={p: p`2>=(sn)*(|.p.|) & p`1>=0}
  as Subset of (TOP-REAL 2);
A14: p0 in {p: p`2/|.p.|<=sn & p`1>=0 & p<>0.REAL 2} by A3,A6,A9,JGRAPH_2:11;
A15: {p: p`2/|.p.|<=sn & p`1>=0 & p<>0.REAL 2} c= K1
  proof
    let x be set;
    assume x in {p: p`2/|.p.|<=sn & p`1>=0 & p<>0.REAL 2};
    then consider p such that
A16: p=x & p`2/|.p.|<=sn & p`1>=0 & p<>0.REAL 2;
    thus x in K1 by A1,A16;
  end;
  then reconsider K11={p: p`2/|.p.|<=sn & p`1>=0 & p<>0.REAL 2}
  as non empty Subset of ((TOP-REAL 2)|K1) by A14,PRE_TOPC:29;
A17: p0 in {p: p`2/|.p.|<=sn & p`1>=0 & p<>0.REAL 2} by A3,A6,A9,JGRAPH_2:11;
  defpred P[Point of TOP-REAL 2] means
  $1`2/|.$1.|<=sn & $1`1>=0 & $1<>0.REAL 2;
  {p: P[p]} is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
  then reconsider K111={p: p`2/|.p.|<=sn & p`1>=0 & p<>0.REAL 2}
  as non empty Subset of (TOP-REAL 2) by A17;
  defpred P[Point of TOP-REAL 2] means $1`2<=(sn)*(|.$1.|) & $1`1>=0;
  {p: P[p]} is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
  then reconsider K004={p: p`2<=(sn)*(|.p.|) & p`1>=0}
  as Subset of (TOP-REAL 2);
  the carrier of (TOP-REAL 2)|B0=the carrier of (TOP-REAL 2)|D;
  then
A18: dom f=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1
    .=K1 by PRE_TOPC:29;
  then
A19: dom (f|K00)=K00 by A12,RELAT_1:91
    .= the carrier of ((TOP-REAL 2)|K1)|K00 by PRE_TOPC:29;
  the carrier of (TOP-REAL 2)|D=D by PRE_TOPC:29;
  then rng (f|K00) c=D;
  then reconsider f1=f|K00 as Function of ((TOP-REAL 2)|K1)|K00,(TOP-REAL 2)|D
  by A19,FUNCT_2:4;
A20: dom f1=the carrier of ((TOP-REAL 2)|K1)|K00 by FUNCT_2:def 1
    .=K00 by PRE_TOPC:29;
A21: dom (sn-FanMorphE)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
  then
A22: dom ((sn-FanMorphE)|K001)=K001 by RELAT_1:91
    .= the carrier of (TOP-REAL 2)|K001 by PRE_TOPC:29;
A23: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
  rng ((sn-FanMorphE)|K001) c= K1
  proof
    let y be set;
    assume y in rng ((sn-FanMorphE)|K001);
    then consider x being set such that
A24: x in dom ((sn-FanMorphE)|K001) & y=((sn-FanMorphE)|K001).x
    by FUNCT_1:def 5;
A25: dom ((sn-FanMorphE)|K001)=(dom (sn-FanMorphE))/\ K001 by FUNCT_1:68
      .=(the carrier of TOP-REAL 2)/\ K001 by FUNCT_2:def 1
      .=K001 by XBOOLE_1:28;
    reconsider q=x as Point of TOP-REAL 2 by A24;
A26: y=(sn-FanMorphE).q by A24,FUNCT_1:70;
    consider p2 being Point of TOP-REAL 2 such that
A27: p2=q & p2`2/|.p2.|>=sn & p2`1>=0 & p2<>0.REAL 2 by A24,A25;
A28: sn-FanMorphE.q= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
    |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by A1,A27,Th91;
    set q4= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
    |.q.|* ((q`2/|.q.|-sn)/(1-sn))]|;
    |.q.|<>0 by A27,TOPRNS_1:25;
    then
A29: (|.q.|)^2>0^2 by SQUARE_1:74;
A30: 1-sn>0 by A1,XREAL_1:151;
A31: q4`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))&
    q4`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by EUCLID:56;
A32: (q`2/|.q.|-sn)>= 0 by A27,XREAL_1:50;
    0<=(q`1)^2 by XREAL_1:65;
    then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
    then (q`2)^2 <= (|.q.|)^2 by JGRAPH_3:10;
    then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by XREAL_1:74;
    then (q`2)^2/(|.q.|)^2 <= 1 by A29,XCMPLX_1:60;
    then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
    then 1>=q`2/|.q.| by SQUARE_1:121;
    then
A33: 1-sn>=q`2/|.q.|-sn by XREAL_1:11;
A34: -(1-sn)<= -0 by A30;
    -(1-sn)<= -( q`2/|.q.|-sn) by A33,XREAL_1:26;
    then (-(1-sn))/(1-sn)<=(-( q`2/|.q.|-sn))/(1-sn) by A30,XREAL_1:74;
    then
A35: -1<=(-( q`2/|.q.|-sn))/(1-sn) by A30,XCMPLX_1:198;
    --(1-sn)>= -(q`2/|.q.|-sn) by A32,A34,XREAL_1:26;
    then (-(q`2/|.q.|-sn))/(1-sn)<=1 by A30,XREAL_1:187;
    then ((-(q`2/|.q.|-sn))/(1-sn))^2<=1^2 by A35,SQUARE_1:119;
    then
A36: 1-((-(q`2/|.q.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
    then
A37: 1-(-((q`2/|.q.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
    sqrt(1-((-(q`2/|.q.|-sn))/(1-sn))^2)>=0 by A36,SQUARE_1:def 4;
    then sqrt(1-(-(q`2/|.q.|-sn))^2/(1-sn)^2)>=0 by XCMPLX_1:77;
    then sqrt(1-(q`2/|.q.|-sn)^2/(1-sn)^2)>=0;
    then
A38: sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)>=0 by XCMPLX_1:77;
A39: (q4`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))^2 by A31
      .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1-sn))^2) by A37,SQUARE_1:def 4;
    (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
      .=(|.q.|)^2 by A31,A39;
    then q4`1>=0^2 & q4<>0.REAL 2 by A29,A31,A38,TOPRNS_1:24
    ;
    hence y in K1 by A1,A26,A28;
  end;
  then reconsider f3=(sn-FanMorphE)|K001
  as Function of (TOP-REAL 2)|K001,(TOP-REAL 2)|K1 by A22,A23,FUNCT_2:4;
A40: dom (f|K11)=K11 by A15,A18,RELAT_1:91
    .= the carrier of ((TOP-REAL 2)|K1)|K11 by PRE_TOPC:29;
  the carrier of (TOP-REAL 2)|D =D by PRE_TOPC:29;
  then rng (f|K11) c=D;
  then reconsider f2=f|K11 as Function of ((TOP-REAL 2)|K1)|K11,(TOP-REAL 2)|D
  by A40,FUNCT_2:4;
A41: dom f2=the carrier of ((TOP-REAL 2)|K1)|K11 by FUNCT_2:def 1
    .=K11 by PRE_TOPC:29;
A42: dom ((sn-FanMorphE)|K111)=K111 by A21,RELAT_1:91
    .= the carrier of (TOP-REAL 2)|K111 by PRE_TOPC:29;
A43: the carrier of (TOP-REAL 2)|K1 =K1 by PRE_TOPC:29;
  rng ((sn-FanMorphE)|K111) c= K1
  proof
    let y be set;
    assume y in rng ((sn-FanMorphE)|K111);
    then consider x being set such that
A44: x in dom ((sn-FanMorphE)|K111) & y=((sn-FanMorphE)|K111).x
    by FUNCT_1:def 5;
A45: dom ((sn-FanMorphE)|K111)=(dom (sn-FanMorphE))/\ K111 by FUNCT_1:68
      .=(the carrier of TOP-REAL 2)/\ K111 by FUNCT_2:def 1
      .=K111 by XBOOLE_1:28;
    reconsider q=x as Point of TOP-REAL 2 by A44;
A46: y=(sn-FanMorphE).q by A44,FUNCT_1:70;
    consider p2 being Point of TOP-REAL 2 such that
A47: p2=q & p2`2/|.p2.|<=sn & p2`1>=0 & p2<>0.REAL 2 by A44,A45;
A48: sn-FanMorphE.q= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
    |.q.|* ((q`2/|.q.|-sn)/(1+sn))]| by A1,A47,Th91;
    set q4= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
    |.q.|* ((q`2/|.q.|-sn)/(1+sn))]|;
    |.q.|<>0 by A47,TOPRNS_1:25;
    then
A49: (|.q.|)^2>0^2 by SQUARE_1:74;
A50: 1+sn>0 by A1,XREAL_1:150;
A51: q4`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))&
    q4`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by EUCLID:56;
A52: (q`2/|.q.|-sn)<=0 by A47,XREAL_1:49;
A53: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
    0<=(q`1)^2 by XREAL_1:65;
    then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
    then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A53,XREAL_1:74;
    then (q`2)^2/(|.q.|)^2 <= 1 by A49,XCMPLX_1:60;
    then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
    then -1<=q`2/|.q.| by SQUARE_1:121;
    then
A54: -1-sn<=q`2/|.q.|-sn by XREAL_1:11;
    (1+sn)/(1+sn)>=(q`2/|.q.|-sn)/(1+sn) by A50,A52,XREAL_1:74;
    then
A55: 1>=(q`2/|.q.|-sn)/(1+sn) by A50,XCMPLX_1:60;
    (-(1+sn))/(1+sn)<=(( q`2/|.q.|-sn))/(1+sn) by A50,A54,XREAL_1:74;
    then -1<=(( q`2/|.q.|-sn))/(1+sn) by A50,XCMPLX_1:198;
    then
A56: (((q`2/|.q.|-sn))/(1+sn))^2<=1^2 by A55,SQUARE_1:119;
    then
A57: 1-((q`2/|.q.|-sn)/(1+sn))^2>=0 by XREAL_1:50;
    1-(-((q`2/|.q.|-sn)/(1+sn)))^2>=0 by A56,XREAL_1:50;
    then 1-((-(q`2/|.q.|-sn))/(1+sn))^2>=0 by XCMPLX_1:188;
    then sqrt(1-((-(q`2/|.q.|-sn))/(1+sn))^2)>=0 by SQUARE_1:def 4;
    then sqrt(1-(-(q`2/|.q.|-sn))^2/(1+sn)^2)>=0 by XCMPLX_1:77;
    then sqrt(1-(q`2/|.q.|-sn)^2/(1+sn)^2)>=0;
    then sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)>=0 by XCMPLX_1:77;
    then
A58: q4`1>= 0 by A51;
A59: (q4`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))^2 by A51
      .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1+sn))^2) by A57,SQUARE_1:def 4;
    (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
      .=(|.q.|)^2 by A51,A59;
    then q4<>0.REAL 2 by A49,TOPRNS_1:24;
    hence y in K1 by A1,A46,A48,A58;
  end;
  then reconsider f4=(sn-FanMorphE)|K111
  as Function of (TOP-REAL 2)|K111,(TOP-REAL 2)|K1 by A42,A43,FUNCT_2:4;
  set T1= ((TOP-REAL 2)|K1)|K00,T2=((TOP-REAL 2)|K1)|K11;
A60: [#](((TOP-REAL 2)|K1)|K00)=K00 by PRE_TOPC:def 10;
A61: [#](((TOP-REAL 2)|K1)|K11)=K11 by PRE_TOPC:def 10;
A62: [#]((TOP-REAL 2)|K1)=K1 by PRE_TOPC:def 10;
A63: K1 c= K00 \/ K11
  proof
    let x be set;
    assume x in K1;
    then consider p such that
A64: p=x & (p`1>=0 & p<>0.REAL 2) by A1;
    per cases;
    suppose p`2/|.p.|>=sn;
      then x in K00 by A64;
      hence x in K00 \/ K11 by XBOOLE_0:def 3;
    end;
    suppose p`2/|.p.|<sn;
      then x in K11 by A64;
      hence x in K00 \/ K11 by XBOOLE_0:def 3;
    end;
  end;
  then
A65: [#](((TOP-REAL 2)|K1)|K00) \/ [#](((TOP-REAL 2)|K1)|K11)
  =[#]((TOP-REAL 2)|K1) by A60,A61,A62,XBOOLE_0:def 10;
A66: K003 is closed by Th98;
A67: K003 /\ K1 c= K00
  proof
    let x be set;
    assume x in K003 /\ K1;
    then
A68: x in K003 & x in K1 by XBOOLE_0:def 4;
    then consider q1 being Point of TOP-REAL 2 such that
A69: q1=x & q1`2>=(sn)*(|.q1.|) & q1`1>=0;
    consider q2 being Point of TOP-REAL 2 such that
A70: q2=x & q2`1>=0 & q2<>0.REAL 2 by A1,A68;
    q1`2/|.q1.|>=(sn)*(|.q1.|)/|.q1.| by A69,XREAL_1:74;
    then q1`2/|.q1.|>=(sn) by A69,A70,TOPRNS_1:25,XCMPLX_1:90;
    hence x in K00 by A69,A70;
  end;
  K00 c= K003 /\ K1
  proof
    let x be set;
    assume x in K00;
    then consider p such that
A72: p=x & (p`2/|.p.|>=sn & p`1>=0 & p<>0.REAL 2);
    p`2/|.p.|*|.p.|>=(sn)*(|.p.|) by A72,XREAL_1:66;
    then p`2>=(sn)*(|.p.|) by A72,TOPRNS_1:25,XCMPLX_1:88;
    then
A73: x in K003 by A72;
    x in K1 by A1,A72;
    hence x in K003 /\ K1 by A73,XBOOLE_0:def 4;
  end;
  then K00=K003 /\ [#]((TOP-REAL 2)|K1) by A62,A67,XBOOLE_0:def 10;
  then
A74: K00 is closed by A66,PRE_TOPC:43;
A75: K004 is closed by Th99;
A76: K004 /\ K1 c= K11
  proof
    let x be set;
    assume x in K004 /\ K1;
    then
A77: x in K004 & x in K1 by XBOOLE_0:def 4;
    then consider q1 being Point of TOP-REAL 2 such that
A78: q1=x & q1`2<=(sn)*(|.q1.|) & q1`1>=0;
    consider q2 being Point of TOP-REAL 2 such that
A79: q2=x & q2`1>=0 & q2<>0.REAL 2 by A1,A77;
    q1`2/|.q1.|<=(sn)*(|.q1.|)/|.q1.| by A78,XREAL_1:74;
    then q1`2/|.q1.|<=(sn) by A78,A79,TOPRNS_1:25,XCMPLX_1:90;
    hence x in K11 by A78,A79;
  end;
  K11 c= K004 /\ K1
  proof
    let x be set;
    assume x in K11;
    then consider p such that
A81: p=x & (p`2/|.p.|<=sn & p`1>=0 & p<>0.REAL 2);
    p`2/|.p.|*|.p.|<=(sn)*(|.p.|) by A81,XREAL_1:66;
    then p`2<=(sn)*(|.p.|) by A81,TOPRNS_1:25,XCMPLX_1:88;
    then
A82: x in K004 by A81;
    x in K1 by A1,A81;
    hence x in K004 /\ K1 by A82,XBOOLE_0:def 4;
  end;
  then K11=K004 /\ [#]((TOP-REAL 2)|K1) by A62,A76,XBOOLE_0:def 10;
  then
A83: K11 is closed by A75,PRE_TOPC:43;
A84: ((TOP-REAL 2)|K1)|K00=(TOP-REAL 2)|K001 by GOBOARD9:4;
  K1 c= D
  proof
    let x be set;
    assume x in K1;
    then consider p6 being Point of TOP-REAL 2 such that
A85: p6=x & p6`1>=0 & p6<>0.REAL 2 by A1;
    x in the carrier of TOP-REAL 2 & not x in {0.REAL 2} by A85,TARSKI:def 1;
    hence x in D by A1,XBOOLE_0:def 5;
  end;
  then D=K1 \/ D by XBOOLE_1:12;
  then
A86: (TOP-REAL 2)|K1 is SubSpace of (TOP-REAL 2)|D by TOPMETR:5;
  the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
  then f1= f3 by A1,FUNCT_1:82;
  then
A87: f1 is continuous by A1,A84,A86,Th96,PRE_TOPC:56;
A88: ((TOP-REAL 2)|K1)|K11=(TOP-REAL 2)|K111 by GOBOARD9:4;
  the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
  then f2= f4 by A1,FUNCT_1:82;
  then
A89: f2 is continuous by A1,A86,A88,Th97,PRE_TOPC:56;
A90: D<>{};
  for p being set st p in ([#]T1)/\([#]T2) holds f1.p = f2.p
  proof
    let p be set;
    assume
A92: p in ([#]T1)/\([#]T2);
    then p in K00 & p in K11 by A60,A61,XBOOLE_0:def 4;
    hence f1.p=f.p by FUNCT_1:72
      .=f2.p by A61,A92,FUNCT_1:72;
  end;
  then consider h being Function of (TOP-REAL 2)|K1,(TOP-REAL 2)|D such that
A93: h=f1+*f2 & h is continuous by A60,A61,A65,A74,A83,A87,A89,JGRAPH_2:9;
A94: dom h=the carrier of ((TOP-REAL 2)|K1) by FUNCT_2:def 1;
A95: the carrier of ((TOP-REAL 2)|K1)=K0 by PRE_TOPC:29;
A96: K0=the carrier of ((TOP-REAL 2)|K0) by PRE_TOPC:29
    .=dom f by A90,FUNCT_2:def 1;
  for y being set st y in dom h holds h.y=f.y
  proof
    let y be set;
    assume
A97: y in dom h;
    now per cases by A63,A94,A95,A97,XBOOLE_0:def 3;
      suppose
A98:    y in K00 & not y in K11;
        then y in dom f1 \/ dom f2 by A20,XBOOLE_0:def 3;
        hence h.y=f1.y by A41,A93,A98,FUNCT_4:def 1
          .=f.y by A98,FUNCT_1:72;
      end;
      suppose
A99:    y in K11;
        then y in dom f1 \/ dom f2 by A41,XBOOLE_0:def 3;
        hence h.y=f2.y by A41,A93,A99,FUNCT_4:def 1
          .=f.y by A99,FUNCT_1:72;
      end;
    end;
    hence h.y=f.y;
  end;
  hence thesis by A93,A94,A95,A96,FUNCT_1:9;
end;

theorem Th101:
  for sn being Real, K0,B0 being Subset of TOP-REAL 2,f being
  Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0
  st -1<sn & sn<1 & f=(sn-FanMorphE)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} & K0={p: p`1<=0 & p<>0.REAL 2}
  holds f is continuous
proof
  let sn be Real,K0,B0 be Subset of TOP-REAL 2,f be
  Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0;
  assume
A1: -1<sn & sn<1 & f=(sn-FanMorphE)|K0 & B0=(the carrier of TOP-REAL 2)
  \ {0.REAL 2} & K0={p: p`1<=0 & p<>0.REAL 2};
  set cn=sqrt(1-sn^2);
  set p0=|[-cn,-sn]|;
A2: p0`1=-cn by EUCLID:56;
  sn^2<1^2 by A1,SQUARE_1:120;
  then 1-sn^2>0 by XREAL_1:52;
  then --cn>0 by SQUARE_1:93;
  then
A3: -cn<0;
  then p0 in K0 by A1,A2,JGRAPH_2:11;
  then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
  p0 in the carrier of TOP-REAL 2 & not p0 in {0.REAL 2}
  by A2,A3,JGRAPH_2:11,TARSKI:def 1;
  then reconsider D=B0 as non empty Subset of TOP-REAL 2 by A1,XBOOLE_0:def 5;
A4: K1 c= D
  proof
    let x be set;
    assume x in K1;
    then consider p2 being Point of TOP-REAL 2 such that
A5: p2=x & p2`1<=0 & p2<>0.REAL 2 by A1;
    not p2 in {0.REAL 2} by A5,TARSKI:def 1;
    hence x in D by A1,A5,XBOOLE_0:def 5;
  end;
  for p being Point of (TOP-REAL 2)|K1,V being Subset of (TOP-REAL 2)|D
  st f.p in V & V is open holds ex W being Subset of (TOP-REAL 2)|K1 st
  p in W & W is open & f.:W c= V
  proof
    let p be Point of (TOP-REAL 2)|K1,V be Subset of (TOP-REAL 2)|D;
    assume
A6: f.p in V & V is open;
    then consider V2 being Subset of TOP-REAL 2 such that
A7: V2 is open & V2 /\ [#]((TOP-REAL 2)|D)=V by TOPS_2:32;
A8: p in the carrier of (TOP-REAL 2)|K1;
A9: [#]((TOP-REAL 2)|K1)=K1 by PRE_TOPC:def 10;
    reconsider W2=V2 /\ [#]((TOP-REAL 2)|K1) as Subset of (TOP-REAL 2)| K1;
A10: W2 is open by A7,TOPS_2:32;
A11: f.p=(sn-FanMorphE).p by A1,A9,FUNCT_1:72;
    consider q being Point of TOP-REAL 2 such that
A12: q=p & q`1<=0 & q <>0.REAL 2 by A1,A8,A9;
    (sn-FanMorphE).q=q by A12,Th89;
    then p in V2 & p in [#]((TOP-REAL 2)|D) by A6,A7,A11,A12,XBOOLE_0:def 4;
    then
A13: p in W2 by XBOOLE_0:def 4;
    f.:W2 c= V
    proof
      let y be set;
      assume y in f.:W2;
      then consider x being set such that
A14:  x in dom f & x in W2 & y=f.x by FUNCT_1:def 12;
      f is Function of (TOP-REAL 2)|K1, (TOP-REAL 2)|D;
      then dom f= K1 by A9,FUNCT_2:def 1;
      then consider p4 being Point of TOP-REAL 2 such that
A15:  x=p4 & p4`1<=0 & p4<>0.REAL 2 by A1,A14;
A16:  f.p4=(sn-FanMorphE).p4 by A1,A9,A14,A15,FUNCT_1:72
        .=p4 by A15,Th89;
A17:  p4 in V2 & p4 in [#]((TOP-REAL 2)|K1) by A14,A15,XBOOLE_0:def 4;
      then p4 in D by A4,A9;
      then p4 in [#]((TOP-REAL 2)|D) by PRE_TOPC:def 10;
      hence y in V by A7,A14,A15,A16,A17,XBOOLE_0:def 4;
    end;
    hence ex W being Subset of (TOP-REAL 2)|K1 st
    p in W & W is open & f.:W c= V by A10,A13;
  end;
  hence f is continuous by JGRAPH_2:20;
end;

theorem Th102:
  for sn being Real, B0 being Subset of TOP-REAL 2,K0 being Subset of
  (TOP-REAL 2)|B0,f being Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0)
  st -1<sn & sn<1 & f=(sn-FanMorphE)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} & K0={p: p`1>=0 & p<>0.REAL 2}
  holds f is continuous
proof
  let sn be Real, B0 be Subset of TOP-REAL 2,K0 be Subset of
  (TOP-REAL 2)|B0,f be Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0);
  assume
A1: -1<sn & sn<1 & f=(sn-FanMorphE)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} & K0={p: p`1>=0 & p<>0.REAL 2 };
  the carrier of (TOP-REAL 2)|B0= B0 by PRE_TOPC:29;
  then reconsider K1=K0 as Subset of TOP-REAL 2 by XBOOLE_1:1;
  K0 c= B0
  proof
    let x be set;
    assume x in K0;
    then consider p8 being Point of TOP-REAL 2 such that
A2: x=p8 & (p8`1>=0 & p8<>0.REAL 2) by A1;
    not x in {0.REAL 2} by A2,TARSKI:def 1;
    hence x in B0 by A1,A2,XBOOLE_0:def 5;
  end;
  then ((TOP-REAL 2)|B0)|K0=(TOP-REAL 2)|K1 by PRE_TOPC:28;
  hence f is continuous by A1,Th100;
end;

theorem Th103:
  for sn being Real, B0 being Subset of TOP-REAL 2,K0 being Subset of
  (TOP-REAL 2)|B0,f being Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0)
  st -1<sn & sn<1 & f=(sn-FanMorphE)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} & K0={p: p`1<=0 & p<>0.REAL 2}
  holds f is continuous
proof
  let sn be Real, B0 be Subset of TOP-REAL 2,K0 be Subset of
  (TOP-REAL 2)|B0,f be Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0);
  assume
A1: -1<sn & sn<1 & f=(sn-FanMorphE)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} & K0={p: p`1<=0 & p<>0.REAL 2};
  the carrier of (TOP-REAL 2)|B0= B0 by PRE_TOPC:29;
  then reconsider K1=K0 as Subset of TOP-REAL 2 by XBOOLE_1:1;
  K0 c= B0
  proof
    let x be set;
    assume x in K0;
    then consider p8 being Point of TOP-REAL 2 such that
A2: x=p8 & (p8`1<=0 & p8<>0.REAL 2) by A1;
    not x in {0.REAL 2} by A2,TARSKI:def 1;
    hence x in B0 by A1,A2,XBOOLE_0:def 5;
  end;
  then ((TOP-REAL 2)|B0)|K0=(TOP-REAL 2)|K1 by PRE_TOPC:28;
  hence f is continuous by A1,Th101;
end;

theorem Th104:
  for sn being Real,p being Point of TOP-REAL 2 holds
  |.(sn-FanMorphE).p.|=|.p.|
proof
  let sn be Real,p be Point of TOP-REAL 2;
  set f=sn-FanMorphE;
  set z=f.p;
  reconsider q=p as Point of TOP-REAL 2;
  reconsider qz=z as Point of TOP-REAL 2;
  per cases;
  suppose
A1: q`2/|.q.|>=sn & q`1>0;
    then (sn-FanMorphE).q= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
    |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by Th89;
    then
A2: qz`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))&
    qz`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by EUCLID:56;
    |.q.|<>0 by A1,JGRAPH_2:11,TOPRNS_1:25;
    then
A3: (|.q.|)^2>0 by SQUARE_1:74;
A4: (q`2/|.q.|-sn)>=0 by A1,XREAL_1:50;
A5: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
    0<=(q`1)^2 by XREAL_1:65;
    then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
    then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A5,XREAL_1:74;
    then (q`2)^2/(|.q.|)^2 <= 1 by A3,XCMPLX_1:60;
    then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
    then 1>=q`2/|.q.| by SQUARE_1:121;
    then
A6: 1-sn>=q`2/|.q.|-sn by XREAL_1:11;
    per cases;
    suppose
A7:   1-sn=0;
A8:   ((q`2/|.q.|-sn)/(1-sn))=(q`2/|.q.|-sn)*(1-sn)" by XCMPLX_0:def 9
        .= (q`2/|.q.|-sn)*0 by A7
        .=0;
      then 1-((q`2/|.q.|-sn)/(1-sn))^2=1;
      then (sn-FanMorphE).q= |[|.q.|*1,|.q.|*0]| by A1,A8,Th89,SQUARE_1:83
        .=|[(|.q.|),0]|;
      then ((sn-FanMorphE).q)`1=(|.q.|) & ((sn-FanMorphE).q)`2=0 by EUCLID:56;
      then |.(sn-FanMorphE).p.|=sqrt(((|.q.|))^2+0^2) by JGRAPH_3:10
        .=|.q.| by SQUARE_1:89;
      hence |.(sn-FanMorphE).p.|=|.p.|;
    end;
    suppose
A9:   1-sn<>0;
      per cases by A9;
      suppose
A10:    1-sn>0;
        then
A11:    -(1-sn)<= -0;
        -(1-sn)<= -( q`2/|.q.|-sn) by A6,XREAL_1:26;
        then (-(1-sn))/(1-sn)<=(-( q`2/|.q.|-sn))/(1-sn) by A10,XREAL_1:74;
        then
A12:    -1<=(-( q`2/|.q.|-sn))/(1-sn) by A10,XCMPLX_1:198;
        --(1-sn)>= -(q`2/|.q.|-sn) by A4,A11,XREAL_1:26;
        then (-(q`2/|.q.|-sn))/(1-sn)<=1 by A10,XREAL_1:187;
        then ((-(q`2/|.q.|-sn))/(1-sn))^2<=1^2 by A12,SQUARE_1:119;
        then 1-((-(q`2/|.q.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
        then
A13:    1-(-((q`2/|.q.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
A14:    (qz`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))^2 by A2
          .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1-sn))^2) by A13,SQUARE_1:def 4;
        (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
          .=(|.q.|)^2 by A2,A14;
        then sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
        hence |.(sn-FanMorphE).p.|=|.p.| by SQUARE_1:89;
      end;
      suppose
A15:    1-sn<0;
A16:    q`2/|.q.|-sn>=0 by A1,XREAL_1:50;
        0+(q`2)^2<(q`1)^2+(q`2)^2 by A1,SQUARE_1:74,XREAL_1:10;
        then (q`2)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A3,A5,XREAL_1:76;
        then (q`2)^2/(|.q.|)^2 < 1 by A3,XCMPLX_1:60;
        then ((q`2)/|.q.|)^2 < 1 by XCMPLX_1:77;
        then 1 > q`2/|.p.| by SQUARE_1:122;
        hence |.(sn-FanMorphE).p.|=|.p.| by A15,A16,XREAL_1:11;
      end;
    end;
  end;
  suppose
A17: q`2/|.q.|<sn & q`1>0;
    then
A18: (sn-FanMorphE).q= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
    |.q.|* ((q`2/|.q.|-sn)/(1+sn))]| by Th90;
    then
A19: qz`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))&
    qz`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by EUCLID:56;
    |.q.|<>0 by A17,JGRAPH_2:11,TOPRNS_1:25;
    then
A20: (|.q.|)^2>0 by SQUARE_1:74;
A21: (q`2/|.q.|-sn)<0 by A17,XREAL_1:51;
A22: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
    0<=(q`1)^2 by XREAL_1:65;
    then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
    then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A22,XREAL_1:74;
    then (q`2)^2/(|.q.|)^2 <= 1 by A20,XCMPLX_1:60;
    then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
    then -1<=q`2/|.q.| by SQUARE_1:121;
    then
A23: -1-sn<=q`2/|.q.|-sn by XREAL_1:11;
    per cases;
    suppose
A24:  1+sn=0;
      ((q`2/|.q.|-sn)/(1+sn))=(q`2/|.q.|-sn)*(1+sn)" by XCMPLX_0:def 9
        .= (q`2/|.q.|-sn)*0 by A24
        .=0;
      then ((sn-FanMorphE).q)`1=(|.q.|) & ((sn-FanMorphE).q)`2=0
      by A18,EUCLID:56,SQUARE_1:83;
      then |.(sn-FanMorphE).p.|=sqrt(((|.q.|))^2+0^2) by JGRAPH_3:10
        .=|.q.| by SQUARE_1:89;
      hence |.(sn-FanMorphE).p.|=|.p.|;
    end;
    suppose
A25:  1+sn<>0;
      per cases by A25;
      suppose
A26:    1+sn>0;
        then (-(1+sn))/(1+sn)<=(( q`2/|.q.|-sn))/(1+sn) by A23,XREAL_1:74;
        then
A27:    -1<=(( q`2/|.q.|-sn))/(1+sn) by A26,XCMPLX_1:198;
        ((q`2/|.q.|-sn))/(1+sn)<=1 by A21,A26;
        then (((q`2/|.q.|-sn))/(1+sn))^2<=1^2 by A27,SQUARE_1:119;
        then
A28:    1-(((q`2/|.q.|-sn))/(1+sn))^2>=0 by XREAL_1:50;
A29:    (qz`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))^2 by A19
          .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1+sn))^2) by A28,SQUARE_1:def 4;
        (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
          .=(|.q.|)^2 by A19,A29;
        then sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
        hence |.(sn-FanMorphE).p.|=|.p.| by SQUARE_1:89;
      end;
      suppose 1+sn<0;
        then
A30:    -(1+sn)>-0 by XREAL_1:26;
        0+(q`2)^2<(q`1)^2+(q`2)^2 by A17,SQUARE_1:74,XREAL_1:10;
        then (q`2)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A20,A22,XREAL_1:76;
        then (q`2)^2/(|.q.|)^2 < 1 by A20,XCMPLX_1:60;
        then ((q`2)/|.q.|)^2 < 1 by XCMPLX_1:77;
        then -1 < q`2/|.p.| by SQUARE_1:122;
        then q`2/|.q.|-sn>-1-sn by XREAL_1:11;
        hence |.(sn-FanMorphE).p.|=|.p.| by A17,A30,XREAL_1:51;
      end;
    end;
  end;
  suppose q`1<=0;
    hence |.(sn-FanMorphE).p.|=|.p.| by Th89;
  end;
end;

theorem Th105:
  for sn being Real,x,K0 being set st -1<sn & sn<1 & x in K0 &
  K0={p: p`1>=0 & p<>0.REAL 2} holds (sn-FanMorphE).x in K0
proof
  let sn be Real,x,K0 be set;
  assume
A1: -1<sn & sn<1 & x in K0 & K0={p: p`1>=0 & p<>0.REAL 2};
  then consider p such that
A2: p=x & p`1>=0 & p<>0.REAL 2;
A3: now
    assume |.p.|<=0;
    then |.p.|=0;
    hence contradiction by A2,TOPRNS_1:25;
  end;
  then
A4: (|.p.|)^2>0 by SQUARE_1:74;
  per cases;
  suppose
A5: p`2/|.p.|<=sn;
    then
A6: (sn-FanMorphE).p= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
    |.p.|*((p`2/|.p.|-sn)/(1+sn))]| by A1,A2,Th91;
    reconsider p9= (sn-FanMorphE).p as Point of TOP-REAL 2;
A7: p9`1=|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)) by A6,EUCLID:56;
A8: 1+sn>0 by A1,XREAL_1:150;
A9: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
    per cases;
    suppose p`1=0;
      hence (sn-FanMorphE).x in K0 by A1,A2,Th89;
    end;
    suppose p`1<>0;
      then 0+(p`2)^2<(p`1)^2+(p`2)^2 by SQUARE_1:74,XREAL_1:10;
      then (p`2)^2/(|.p.|)^2 < (|.p.|)^2/(|.p.|)^2 by A4,A9,XREAL_1:76;
      then (p`2)^2/(|.p.|)^2 < 1 by A4,XCMPLX_1:60;
      then
A10:  ((p`2)/|.p.|)^2 < 1 by XCMPLX_1:77;
      p`2/|.p.|-sn<=0 by A5,XREAL_1:49;
      then
A11:  (p`2/|.p.|-sn)/(1+sn)<(1+sn)/(1+sn) by A8,XREAL_1:76;
      -1 < p`2/|.p.| by A10,SQUARE_1:122;
      then -1-sn< p`2/|.p.|-sn by XREAL_1:11;
      then (-1)*(1+sn)/(1+sn)< (p`2/|.p.|-sn)/(1+sn) by A8,XREAL_1:76;
      then -1< (p`2/|.p.|-sn)/(1+sn) & (p`2/|.p.|-sn)/(1+sn)<1
      by A8,A11,XCMPLX_1:60,90;
      then 1^2> ((p`2/|.p.|-sn)/(1+sn))^2 by SQUARE_1:120;
      then 1-((p`2/|.p.|-sn)/(1+sn))^2>0 by XREAL_1:52;
      then sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)>0 by SQUARE_1:93;
      then |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2))>0 by A3,XREAL_1:131;
      hence (sn-FanMorphE).x in K0 by A1,A2,A7,JGRAPH_2:11;
    end;
  end;
  suppose
A12: p`2/|.p.|>sn;
    then
A13: (sn-FanMorphE).p= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
    |.p.|*((p`2/|.p.|-sn)/(1-sn))]| by A1,A2,Th91;
    reconsider p9= (sn-FanMorphE).p as Point of TOP-REAL 2;
A14: p9`1=|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)) by A13,EUCLID:56;
A15: 1-sn>0 by A1,XREAL_1:151;
A16: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
    per cases;
    suppose p`1=0;
      hence (sn-FanMorphE).x in K0 by A1,A2,Th89;
    end;
    suppose p`1<>0;
      then 0+(p`2)^2<(p`1)^2+(p`2)^2 by SQUARE_1:74,XREAL_1:10;
      then (p`2)^2/(|.p.|)^2 < (|.p.|)^2/(|.p.|)^2 by A4,A16,XREAL_1:76;
      then (p`2)^2/(|.p.|)^2 < 1 by A4,XCMPLX_1:60;
      then ((p`2)/|.p.|)^2 < 1 by XCMPLX_1:77;
      then p`2/|.p.|<1 by SQUARE_1:122;
      then (p`2/|.p.|-sn)<1-sn by XREAL_1:11;
      then
A17:  (p`2/|.p.|-sn)/(1-sn)<(1-sn)/(1-sn) by A15,XREAL_1:76;
A18:  -(1-sn)< -0 by A15,XREAL_1:26;
      p`2/|.p.|-sn>=sn-sn by A12,XREAL_1:11;
      then (-1)*(1-sn)/(1-sn)< (p`2/|.p.|-sn)/(1-sn) by A15,A18,XREAL_1:76;
      then -1< (p`2/|.p.|-sn)/(1-sn) & (p`2/|.p.|-sn)/(1-sn)<1
      by A15,A17,XCMPLX_1:60,90;
      then 1^2> ((p`2/|.p.|-sn)/(1-sn))^2 by SQUARE_1:120;
      then 1-((p`2/|.p.|-sn)/(1-sn))^2>0 by XREAL_1:52;
      then sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)>0 by SQUARE_1:93;
      then p9`1>0 by A3,A14,XREAL_1:131;
      hence (sn-FanMorphE).x in K0 by A1,A2,JGRAPH_2:11;
    end;
  end;
end;

theorem Th106:
  for sn being Real,x,K0 being set st -1<sn & sn<1 & x in K0 &
  K0={p: p`1<=0 & p<>0.REAL 2} holds (sn-FanMorphE).x in K0
proof
  let sn be Real,x,K0 be set;
  assume
A1: -1<sn & sn<1 & x in K0 & K0={p: p`1<=0 & p<>0.REAL 2};
  then consider p such that
A2: p=x & p`1<=0 & p<>0.REAL 2;
  thus (sn-FanMorphE).x in K0 by A1,A2,Th89;
end;

theorem Th107:
  for sn being Real, D being non empty Subset of TOP-REAL 2
  st -1<sn & sn<1 & D`={0.REAL 2} holds
  ex h being Function of (TOP-REAL 2)|D,(TOP-REAL 2)|D
  st h=(sn-FanMorphE)|D & h is continuous
proof
  let sn be Real,D be non empty Subset of TOP-REAL 2;
  assume
A1: -1<sn & sn<1 & D`={0.REAL 2};
  reconsider B0= {0.REAL 2} as Subset of TOP-REAL 2;
A2: D =(B0)` by A1
    .=((the carrier of TOP-REAL 2)\ {0.REAL 2}) by SUBSET_1:def 5;
  defpred P[Point of TOP-REAL 2] means $1`1>=0;
A3: {p: P[p] & p<>0.REAL 2} c= the carrier of (TOP-REAL 2)|D from InclSub(A2);
  (|[0,1]|)`1=0 & (|[0,1]|)`2=1 by EUCLID:56;
  then |[0,1]| in {p where p is Point of TOP-REAL 2:
  p`1>=0 & p<>0.REAL 2} by JGRAPH_2:11;
  then reconsider K0={p:p`1>=0 & p<>0.REAL 2}
  as non empty Subset of (TOP-REAL 2)|D by A3;
  defpred P[Point of TOP-REAL 2] means $1`1<=0;
A4: {p: P[p] & p<>0.REAL 2} c= the carrier of (TOP-REAL 2)|D from InclSub(A2);
  set Y1=|[0,1]|;
  Y1`1=0 & Y1`2=1 by EUCLID:56;
  then Y1 in {p where p is Point of TOP-REAL 2:
  p`1<=0 & p<>0.REAL 2} by JGRAPH_2:11;
  then reconsider K1={p: p`1<=0 & p<>0.REAL 2}
  as non empty Subset of (TOP-REAL 2)|D by A4;
A5: the carrier of ((TOP-REAL 2)|D)=D by PRE_TOPC:29;
A6: K0 c= (the carrier of TOP-REAL 2)
  proof
    let z be set;
    assume z in K0;
    then consider p8 being Point of TOP-REAL 2 such that
A7: p8=z & p8`1>=0 & p8<>0.REAL 2;
    thus z in (the carrier of TOP-REAL 2) by A7;
  end;
A8: dom ((sn-FanMorphE)|K0)= dom ((sn-FanMorphE)) /\ K0 by FUNCT_1:68
    .=((the carrier of TOP-REAL 2)) /\ K0 by FUNCT_2:def 1
    .=K0 by A6,XBOOLE_1:28;
A9: K0=the carrier of ((TOP-REAL 2)|D)|K0 by PRE_TOPC:29;
  rng ((sn-FanMorphE)|K0) c= the carrier of ((TOP-REAL 2)|D)|K0
  proof
    let y be set;
    assume y in rng ((sn-FanMorphE)|K0);
    then consider x being set such that
A10: x in dom ((sn-FanMorphE)|K0) & y=((sn-FanMorphE)|K0).x by FUNCT_1:def 5;
    x in (dom (sn-FanMorphE)) /\ K0 by A10,FUNCT_1:68;
    then
A11: x in K0 by XBOOLE_0:def 4;
    K0 c= the carrier of TOP-REAL 2 by A5,XBOOLE_1:1;
    then reconsider p=x as Point of TOP-REAL 2 by A11;
    (sn-FanMorphE).p=y by A10,A11,FUNCT_1:72;
    then y in K0 by A1,A11,Th105;
    hence y in the carrier of ((TOP-REAL 2)|D)|K0 by PRE_TOPC:29;
  end;
  then reconsider f=(sn-FanMorphE)|K0 as Function of ((TOP-REAL 2)|D)|K0,
  ((TOP-REAL 2)|D) by A8,A9,FUNCT_2:4,XBOOLE_1:1;
A12: K1 c= (the carrier of TOP-REAL 2)
  proof
    let z be set;
    assume z in K1;
    then consider p8 being Point of TOP-REAL 2 such that
A13: p8=z & p8`1<=0 & p8<>0.REAL 2;
    thus z in (the carrier of TOP-REAL 2) by A13;
  end;
A14: dom ((sn-FanMorphE)|K1)= dom ((sn-FanMorphE)) /\ K1 by FUNCT_1:68
    .=((the carrier of TOP-REAL 2)) /\ K1 by FUNCT_2:def 1
    .=K1 by A12,XBOOLE_1:28;
A15: K1=the carrier of ((TOP-REAL 2)|D)|K1 by PRE_TOPC:29;
  rng ((sn-FanMorphE)|K1) c= the carrier of ((TOP-REAL 2)|D)|K1
  proof
    let y be set;
    assume y in rng ((sn-FanMorphE)|K1);
    then consider x being set such that
A16: x in dom ((sn-FanMorphE)|K1) & y=((sn-FanMorphE)|K1).x by FUNCT_1:def 5;
    x in (dom (sn-FanMorphE)) /\ K1 by A16,FUNCT_1:68;
    then
A17: x in K1 by XBOOLE_0:def 4;
    K1 c= the carrier of TOP-REAL 2 by A5,XBOOLE_1:1;
    then reconsider p=x as Point of TOP-REAL 2 by A17;
    (sn-FanMorphE).p=y by A16,A17,FUNCT_1:72;
    then y in K1 by A1,A17,Th106;
    hence y in the carrier of ((TOP-REAL 2)|D)|K1 by PRE_TOPC:29;
  end;
  then reconsider g=(sn-FanMorphE)|K1 as Function of ((TOP-REAL 2)|D)|K1,
  ((TOP-REAL 2)|D) by A14,A15,FUNCT_2:4,XBOOLE_1:1;
A18: K0=[#](((TOP-REAL 2)|D)|K0) by PRE_TOPC:def 10;
A19: K1=[#](((TOP-REAL 2)|D)|K1) by PRE_TOPC:def 10;
A20: D= [#]((TOP-REAL 2)|D) by PRE_TOPC:def 10;
  D c= K0 \/ K1
  proof
    let x be set;
    assume
A21: x in D;
    then
A22: x in (the carrier of TOP-REAL 2) & not x in {0.REAL 2}
    by A2,XBOOLE_0:def 5;
    reconsider px=x as Point of TOP-REAL 2 by A21;
    px`1>=0 & px<>0.REAL 2 or px`1<=0 & px<>0.REAL 2 by A22,TARSKI:def 1;
    then x in K0 or x in K1;
    hence x in K0 \/ K1 by XBOOLE_0:def 3;
  end;
  then
A23: ([#](((TOP-REAL 2)|D)|K0)) \/ ([#](((TOP-REAL 2)|D)|K1))
  = [#]((TOP-REAL 2)|D) by A18,A19,A20,XBOOLE_0:def 10;
A24: f is continuous & K0 is closed by A1,A2,Th38,Th102;
A25: g is continuous & K1 is closed by A1,A2,Th36,Th103;
A26: for x be set st x in ([#]((((TOP-REAL 2)|D)|K0)))
  /\ ([#] ((((TOP-REAL 2)|D)|K1))) holds f.x = g.x
  proof
    let x be set;
    assume
A27: x in ([#]((((TOP-REAL 2)|D)|K0))) /\ ([#] ((((TOP-REAL 2)|D)|K1)));
    then x in K0 & x in K1 by A18,A19,XBOOLE_0:def 4;
    then f.x=(sn-FanMorphE).x by FUNCT_1:72;
    hence f.x = g.x by A19,A27,FUNCT_1:72;
  end;
  then consider h being Function of (TOP-REAL 2)|D,(TOP-REAL 2)|D such that
A28: h= f+*g & h is continuous by A18,A19,A23,A24,A25,JGRAPH_2:9;
A29: dom h=the carrier of ((TOP-REAL 2)|D) by FUNCT_2:def 1;
A30: the carrier of ((TOP-REAL 2)|D)=D by PRE_TOPC:29;
A31: the carrier of ((TOP-REAL 2)|D)=
  ((the carrier of TOP-REAL 2)\ {0.REAL 2}) by A2,PRE_TOPC:29;
  dom (sn-FanMorphE)=(the carrier of (TOP-REAL 2)) by FUNCT_2:def 1;
  then
A32: dom ((sn-FanMorphE)|D)=(the carrier of (TOP-REAL 2))/\ D by FUNCT_1:68
    .=the carrier of ((TOP-REAL 2)|D) by A30,XBOOLE_1:28;
A33: dom f=K0 by A9,FUNCT_2:def 1;
A34: K0=[#](((TOP-REAL 2)|D)|K0) by PRE_TOPC:def 10;
A35: dom g=K1 by A15,FUNCT_2:def 1;
  K1=[#](((TOP-REAL 2)|D)|K1) by PRE_TOPC:def 10;
  then
A36: f tolerates g by A26,A33,A34,A35,PARTFUN1:def 6;
  for x being set st x in dom h holds h.x=((sn-FanMorphE)|D).x
  proof
    let x be set;
    assume
A37: x in dom h;
    then x in (the carrier of TOP-REAL 2) & not x in {0.REAL 2}
    by A31,XBOOLE_0:def 5;
    then
A38: x <>0.REAL 2 by TARSKI:def 1;
    reconsider p=x as Point of TOP-REAL 2 by A31,A37,XBOOLE_0:def 5;
A39: x in D`` by A29,A37,PRE_TOPC:29;
    now per cases;
      case
A40:    x in K0;
A41:    (sn-FanMorphE)|D.p=(sn-FanMorphE).p by A39,FUNCT_1:72
          .=f.p by A40,FUNCT_1:72;
        h.p=(g+*f).p by A28,A36,FUNCT_4:35
          .=f.p by A33,A40,FUNCT_4:14;
        hence h.x=(sn-FanMorphE)|D.x by A41;
      end;
      case not x in K0;
        then not (p`1>=0) by A38;
        then
A42:    x in K1 by A38;
        (sn-FanMorphE)|D.p=(sn-FanMorphE).p by A39,FUNCT_1:72
          .=g.p by A42,FUNCT_1:72;
        hence h.x=(sn-FanMorphE)|D.x by A28,A35,A42,FUNCT_4:14;
      end;
    end;
    hence h.x=(sn-FanMorphE)|D.x;
  end;
  then f+*g=(sn-FanMorphE)|D by A28,A29,A32,FUNCT_1:9;
  hence thesis by A18,A19,A23,A24,A25,A26,JGRAPH_2:9;
end;

theorem Th108:
  for sn being Real st -1<sn & sn<1 holds
  ex h being Function of (TOP-REAL 2),(TOP-REAL 2)
  st h=(sn-FanMorphE) & h is continuous
proof
  let sn be Real;
  assume
A1: -1<sn & sn<1;
  reconsider f=(sn-FanMorphE) as Function of (TOP-REAL 2),(TOP-REAL 2);
  reconsider D=(the carrier of TOP-REAL 2) \{0.REAL 2}
  as non empty Subset of TOP-REAL 2 by JGRAPH_2:19;
A2: f.(0.REAL 2)=0.REAL 2 by Th89,JGRAPH_2:11;
A3: D`= {0.REAL 2} by JGRAPH_3:30;
A4: for p being Point of (TOP-REAL 2)|D holds f.p<>f.(0.REAL 2)
  proof
    let p be Point of (TOP-REAL 2)|D;
A5: [#]((TOP-REAL 2)|D)=D by PRE_TOPC:def 10;
    then
A6: p in the carrier of TOP-REAL 2 & not p in {0.REAL 2} by XBOOLE_0:def 5;
    reconsider q=p as Point of TOP-REAL 2 by A5,XBOOLE_0:def 5;
A7: not p=0.REAL 2 by A6,TARSKI:def 1;
    now per cases;
      case
A8:     q`2/|.q.|>=sn & q`1>=0;
        set q9= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
        |.q.|* ((q`2/|.q.|-sn)/(1-sn))]|;
A9:     q9`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)) &
        q9`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by EUCLID:56;
        now
          assume
A10:      q9=0.REAL 2;
A11:      |.q.|<>0 by A7,TOPRNS_1:25;

then sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)=sqrt(1-0^2) by A9,A10,JGRAPH_2:11
,XCMPLX_1:6
            .=1 by SQUARE_1:83;
          hence contradiction by A10,A11,EUCLID:56,JGRAPH_2:11;
        end;
        hence f.p<>f.(0.REAL 2) by A1,A2,A7,A8,Th91;
      end;
      case
A12:    q`2/|.q.|<sn & q`1>=0;
        set q9=|[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
        |.q.|* ((q`2/|.q.|-sn)/(1+sn))]|;
A13:    q9`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)) &
        q9`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by EUCLID:56;
        now
          assume
A14:      q9=0.REAL 2;
A15:      |.q.|<>0 by A7,TOPRNS_1:25;

then sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)=sqrt(1-0^2) by A13,A14,JGRAPH_2:11
,XCMPLX_1:6
            .=1 by SQUARE_1:83;
          hence contradiction by A14,A15,EUCLID:56,JGRAPH_2:11;
        end;
        hence f.p<>f.(0.REAL 2) by A1,A2,A7,A12,Th91;
      end;
      case q`1<0;
        then f.p=p by Th89;
        hence f.p<>f.(0.REAL 2) by A7,Th89,JGRAPH_2:11;
      end;
    end;
    hence f.p<>f.(0.REAL 2);
  end;
A16: ex h being Function of (TOP-REAL 2)|D,(TOP-REAL 2)|D
  st h=(sn-FanMorphE)|D & h is continuous by A1,A3,Th107;
  for V being Subset of (TOP-REAL 2) st f.(0.REAL 2) in V & V is open
  ex W being Subset of (TOP-REAL 2) st 0.REAL 2 in W & W is open & f.:W c= V
  proof
    let V be Subset of (TOP-REAL 2);
    assume
A17: f.(0.REAL 2) in V & V is open;
    reconsider u0=0.REAL 2 as Point of Euclid 2;
    consider r being real number such that
A18: r>0 & Ball(u0,r) c= V by A2,A17,TOPMETR:22;
    reconsider r as Real by XREAL_0:def 1;
    reconsider W1=Ball(u0,r) as Subset of TOP-REAL 2;
A19: u0 in W1 by A18,GOBOARD6:4;
A20: W1 is open by GOBOARD6:6;
    f.:W1 c= W1
    proof
      let z be set;
      assume z in f.:W1;
      then consider y being set such that
A21:  y in dom f & y in W1 & z=f.y by FUNCT_1:def 12;
      reconsider q=y as Point of TOP-REAL 2 by A21;
      reconsider qy=q as Point of Euclid 2;
      z in rng f by A21,FUNCT_1:def 5;
      then reconsider qz=z as Point of TOP-REAL 2;
      reconsider pz=qz as Point of Euclid 2;
      dist(u0,qy)<r by A21,METRIC_1:12;
      then
A22:  |.(0.REAL 2) - q.|<r by JGRAPH_1:45;
      now per cases by JGRAPH_2:11;
        case q`1<=0;
          hence z in W1 by A21,Th89;
        end;
        case
A23:      q<>0.REAL 2 & (q`2/|.q.|>=sn & q`1>=0);
          then
A24:      (sn-FanMorphE).q= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1- sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by A1,Th91;
          |.q.|<>0 by A23,TOPRNS_1:25;
          then
A25:      (|.q.|)^2>0 by SQUARE_1:74;
A26:      1-sn>0 by A1,XREAL_1:151;
A27:      qz`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))&
          qz`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by A21,A24,EUCLID:56;
A28:      (q`2/|.q.|-sn)>= 0 by A23,XREAL_1:50;
A29:      (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
          0<=(q`1)^2 by XREAL_1:65;
          then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
          then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2
           by A29,XREAL_1:74;
          then (q`2)^2/(|.q.|)^2 <= 1 by A25,XCMPLX_1:60;
          then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
          then 1>=q`2/|.q.| by SQUARE_1:121;
          then
A30:      1-sn>=q`2/|.q.|-sn by XREAL_1:11;
A31:      -(1-sn)<= -0 by A26;
          -(1-sn)<= -( q`2/|.q.|-sn) by A30,XREAL_1:26;
          then (-(1-sn))/(1-sn)<=(-( q`2/|.q.|-sn))/(1-sn)
           by A26,XREAL_1:74;
          then
A32:      -1<=(-( q`2/|.q.|-sn))/(1-sn) by A26,XCMPLX_1:198;
          --(1-sn)>= -(q`2/|.q.|-sn) by A28,A31,XREAL_1:26;
          then (-(q`2/|.q.|-sn))/(1-sn)<=1 by A26,XREAL_1:187;
          then ((-(q`2/|.q.|-sn))/(1-sn))^2<=1^2 by A32,SQUARE_1:119;
          then 1-((-(q`2/|.q.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
          then
A33:      1-(-((q`2/|.q.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
A34:      (qz`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))^2 by A27
            .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1-sn))^2) by A33,SQUARE_1:def 4;
          (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
            .=(|.q.|)^2 by A27,A34;
          then sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
          then
A35:      |.qz.|=|.q.| by SQUARE_1:89;
          |.(0.REAL 2) +- q.|<r by A22,EUCLID:45;
          then |.- q.|<r by EUCLID:31;
          then |.q.|<r by TOPRNS_1:27;
          then |.- qz.|<r by A35,TOPRNS_1:27;
          then |.(0.REAL 2) +- qz.|<r by EUCLID:31;
          then |.(0.REAL 2) - qz.|<r by EUCLID:45;
          then dist(u0,pz)<r by JGRAPH_1:45;
          hence z in W1 by METRIC_1:12;
        end;
        case
A36:      q<>0.REAL 2 & q`2/|.q.|<sn & q`1>=0;
          then
A37:      (sn-FanMorphE).q= |[|.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+ sn))^2) ),
          |.q.|* ((q`2/|.q.|-sn)/(1+sn))]| by A1,Th91;
          |.q.|<>0 by A36,TOPRNS_1:25;
          then
A38:      (|.q.|)^2>0 by SQUARE_1:74;
A39:      (sn-q`2/|.q.|)>=0 by A36,XREAL_1:50;
A40:      (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
A41:      1+sn>0 by A1,XREAL_1:150;
A42:      qz`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))&
          qz`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by A21,A37,EUCLID:56;
          0<=(q`1)^2 by XREAL_1:65;
          then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
          then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2
           by A40,XREAL_1:74;
          then (q`2)^2/(|.q.|)^2 <= 1 by A38,XCMPLX_1:60;
          then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
          then -1<=q`2/|.q.| by SQUARE_1:121;
          then --1>=-q`2/|.q.| by XREAL_1:26;
          then
A43:      1+sn>=-q`2/|.q.|+sn by XREAL_1:9;

(-(1+sn))/(1+sn)<=(-( q`2/|.q.|-sn))/(1+sn) by A39,A41,XREAL_1:74;
          then
A44:      -1<=(-( q`2/|.q.|-sn))/(1+sn) by A41,XCMPLX_1:198;
          (-(q`2/|.q.|-sn))/(1+sn)<=1 by A41,A43,XREAL_1:187;
          then ((-(q`2/|.q.|-sn))/(1+sn))^2<=1^2 by A44,SQUARE_1:119;
          then 1-((-(q`2/|.q.|-sn))/(1+sn))^2>=0 by XREAL_1:50;
          then
A45:      1-(-((q`2/|.q.|-sn))/(1+sn))^2>=0 by XCMPLX_1:188;
A46:      (qz`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))^2 by A42
            .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1+sn))^2) by A45,SQUARE_1:def 4;
          (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
            .=(|.q.|)^2 by A42,A46;
          then sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
          then
A47:      |.qz.|=|.q.| by SQUARE_1:89;
          |.(0.REAL 2) +- q.|<r by A22,EUCLID:45;
          then |.- q.|<r by EUCLID:31;
          then |.q.|<r by TOPRNS_1:27;
          then |.- qz.|<r by A47,TOPRNS_1:27;
          then |.(0.REAL 2) +- qz.|<r by EUCLID:31;
          then |.(0.REAL 2) - qz.|<r by EUCLID:45;
          then dist(u0,pz)<r by JGRAPH_1:45;
          hence z in W1 by METRIC_1:12;
        end;
      end;
      hence z in W1;
    end;
    hence ex W being Subset of (TOP-REAL 2) st 0.REAL 2 in W
    & W is open & f.:W c= V by A18,A19,A20,XBOOLE_1:1;
  end;
  then f is continuous by A2,A3,A4,A16,JGRAPH_3:13;
  hence thesis;
end;

theorem Th109:
  for sn being Real st -1<sn & sn<1 holds sn-FanMorphE is one-to-one
proof
  let sn be Real;
  assume
A1: -1<sn & sn<1;
  for x1,x2 being set st x1 in dom (sn-FanMorphE) & x2 in dom (sn-FanMorphE)
  & (sn-FanMorphE).x1=(sn-FanMorphE).x2 holds x1=x2
  proof
    let x1,x2 be set;
    assume
A2: x1 in dom (sn-FanMorphE) & x2 in dom (sn-FanMorphE)
    & (sn-FanMorphE).x1=(sn-FanMorphE).x2;
    then reconsider p1=x1 as Point of TOP-REAL 2;
    reconsider p2=x2 as Point of TOP-REAL 2 by A2;
    set q=p1,p=p2;
A3: 1-sn>0 by A1,XREAL_1:151;
    now per cases by JGRAPH_2:11;
      case
A4:     q`1<=0;
        then
A5:     (sn-FanMorphE).q=q by Th89;
        now per cases by JGRAPH_2:11;
          case p`1<=0;
            hence x1=x2 by A2,A5,Th89;
          end;
          case
A6:         p<>0.REAL 2 & (p`2/|.p.|>=sn & p`1>=0);
            then
A7:         sn -FanMorphE.p= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
            |.p.|* ((p`2/|.p.|-sn)/(1-sn))]| by A1,Th91;
            set p4= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
            |.p.|* ((p`2/|.p.|-sn)/(1-sn))]|;
A8:         p4`1= |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)) &
            p4`2= |.p.|* ((p`2/|.p.|-sn)/(1-sn)) by EUCLID:56;
A9:         |.p.|<>0 by A6,TOPRNS_1:25;
            then
A10:        (|.p.|)^2>0 by SQUARE_1:74;
A11:        (p`2/|.p.|-sn)>=0 by A6,XREAL_1:50;
A12:        (p`2/|.p.|-sn)>= 0 by A6,XREAL_1:50;
A13:        (p`2/|.p.|-sn)/(1-sn)>=0 by A3,A11;
A14:        (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
            0<=(p`1)^2 by XREAL_1:65;
            then 0+(p`2)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
            then (p`2)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2
             by A14,XREAL_1:74;
            then (p`2)^2/(|.p.|)^2 <= 1 by A10,XCMPLX_1:60;
            then ((p`2)/|.p.|)^2 <= 1 by XCMPLX_1:77;
            then 1>=p`2/|.p.| by SQUARE_1:121;
            then
A15:        1-sn>=p`2/|.p.|-sn by XREAL_1:11;
A16:        -(1-sn)<= -0 by A3;
            -(1-sn)<= -( p`2/|.p.|-sn) by A15,XREAL_1:26;
            then (-(1-sn))/(1-sn)<=(-( p`2/|.p.|-sn))/(1-sn)
             by A3,XREAL_1:74;
            then
A17:        -1<=(-( p`2/|.p.|-sn))/(1-sn) by A3,XCMPLX_1:198;
            --(1-sn)>= -(p`2/|.p.|-sn) by A12,A16,XREAL_1:26;
            then (-(p`2/|.p.|-sn))/(1-sn)<=1 by A3,XREAL_1:187;
            then ((-(p`2/|.p.|-sn))/(1-sn))^2<=1^2 by A17,SQUARE_1:119;
            then
A18:        1-((-(p`2/|.p.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
            then
A19:        1-(-((p`2/|.p.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
            sqrt(1-((-(p`2/|.p.|-sn))/(1-sn))^2)>=0 by A18,SQUARE_1:def 4;
            then sqrt(1-(-(p`2/|.p.|-sn))^2/(1-sn)^2)>=0 by XCMPLX_1:77;
            then sqrt(1-(p`2/|.p.|-sn)^2/(1-sn)^2)>=0;
            then sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)>=0 by XCMPLX_1:77;
            then q`1=0 by A2,A4,A5,A7,A8;

then (sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2))=0 by A2,A5,A7,A8,A9,XCMPLX_1:6;
            then 1-((p`2/|.p.|-sn)/(1-sn))^2=0 by A19,SQUARE_1:92;
            then 1= (p`2/|.p.|-sn)/(1-sn) by A13,SQUARE_1:83,89;
            then 1 *(1-sn)=(p`2/|.p.|-sn) by A3,XCMPLX_1:88;
            then 1 *|.p.|=p`2 by A6,TOPRNS_1:25,XCMPLX_1:88;
            then p`1=0 by A14,XCMPLX_1:6;
            hence x1=x2 by A2,A5,Th89;
          end;
          case
A20:        p<>0.REAL 2 & (p`2/|.p.|<sn & p`1>=0);
            then
A21:        sn -FanMorphE.p= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
            |.p.|* ((p`2/|.p.|-sn)/(1+sn))]| by A1,Th91;
            set p4= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
            |.p.|* ((p`2/|.p.|-sn)/(1+sn))]|;
A22:        p4`1= |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)) &
            p4`2= |.p.|* ((p`2/|.p.|-sn)/(1+sn)) by EUCLID:56;
A23:        |.p.|<>0 by A20,TOPRNS_1:25;
            then
A24:        (|.p.|)^2>0 by SQUARE_1:74;
A25:        1+sn>0 by A1,XREAL_1:150;
A26:        (p`2/|.p.|-sn)<=0 by A20,XREAL_1:49;
            then
A27:        -(p`2/|.p.|-sn)>= -0;
            --(p`2/|.p.|-sn)/(1+sn)<=0 by A25,A26;
            then
A28:        -((p`2/|.p.|-sn)/(1+sn))>=0;
A29:        (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
            0<=(p`1)^2 by XREAL_1:65;
            then 0+(p`2)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
            then (p`2)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2
             by A29,XREAL_1:74;
            then (p`2)^2/(|.p.|)^2 <= 1 by A24,XCMPLX_1:60;
            then ((p`2)/|.p.|)^2 <= 1 by XCMPLX_1:77;
            then
A30:        (-((p`2)/|.p.|))^2 <= 1;

(-(1+sn))/(1+sn)<=(-( p`2/|.p.|-sn))/(1+sn) by A25,A27,XREAL_1:74;
            then
A31:        -1<=(-( p`2/|.p.|-sn))/(1+sn) by A25,XCMPLX_1:198;
            1>= -p`2/|.p.| by A30,SQUARE_1:121;
            then (1+sn)>= -p`2/|.p.|+sn by XREAL_1:9;
            then (-(p`2/|.p.|-sn))/(1+sn)<=1 by A25,XREAL_1:187;
            then ((-(p`2/|.p.|-sn))/(1+sn))^2<=1^2 by A31,SQUARE_1:119;
            then
A32:        1-((-(p`2/|.p.|-sn))/(1+sn))^2>=0 by XREAL_1:50;
            then
A33:        1-(-((p`2/|.p.|-sn))/(1+sn))^2>=0 by XCMPLX_1:188;
            sqrt(1-((-(p`2/|.p.|-sn))/(1+sn))^2)>=0 by A32,SQUARE_1:def 4;
            then sqrt(1-(-(p`2/|.p.|-sn))^2/(1+sn)^2)>=0 by XCMPLX_1:77;
            then sqrt(1-((p`2/|.p.|-sn))^2/(1+sn)^2)>=0;
            then sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)>=0 by XCMPLX_1:77;
            then q`1=0 by A2,A4,A5,A21,A22;
            then (sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2))=0 by A2,A5,A21,A22,A23,
XCMPLX_1:6;
            then 1-((p`2/|.p.|-sn)/(1+sn))^2=0 by A33,SQUARE_1:92;
            then 1=sqrt((-((p`2/|.p.|-sn)/(1+sn)))^2) by SQUARE_1:83;
            then 1= -((p`2/|.p.|-sn)/(1+sn)) by A28,SQUARE_1:89;
            then 1= ((-(p`2/|.p.|-sn))/(1+sn)) by XCMPLX_1:188;
            then 1 *(1+sn)=-(p`2/|.p.|-sn) by A25,XCMPLX_1:88;
            then 1+sn-sn=-p`2/|.p.|;
            then 1=(-p`2)/|.p.| by XCMPLX_1:188;
            then 1 *|.p.|=-p`2 by A20,TOPRNS_1:25,XCMPLX_1:88;
            then (p`2)^2-(p`2)^2 =(p`1)^2 by A29,XCMPLX_1:26;
            then p`1=0 by XCMPLX_1:6;
            hence x1=x2 by A2,A5,Th89;
          end;
        end;
        hence x1=x2;
      end;
      case
A34:    q`2/|.q.|>=sn & q`1>=0 & q<>0.REAL 2;
        then
A35:    sn-FanMorphE.q= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2 )),
        |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by A1,Th91;
        set q4= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
        |.q.|* ((q`2/|.q.|-sn)/(1-sn))]|;
A36:    q4`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)) &
        q4`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by EUCLID:56;
        |.q.|<>0 by A34,TOPRNS_1:25;
        then
A37:    (|.q.|)^2>0 by SQUARE_1:74;
        now per cases by JGRAPH_2:11;
          case
A38:        p`1<=0;
            then
A39:        (sn-FanMorphE).p=p by Th89;
A40:        |.q.|<>0 by A34,TOPRNS_1:25;
            then
A41:        (|.q.|)^2>0 by SQUARE_1:74;
A42:        1-sn>0 by A1,XREAL_1:151;
A43:        (q`2/|.q.|-sn)>=0 by A34,XREAL_1:50;
A44:        (q`2/|.q.|-sn)>= 0 by A34,XREAL_1:50;
A45:        (q`2/|.q.|-sn)/(1-sn)>=0 by A42,A43;
A46:        (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
            0<=(q`1)^2 by XREAL_1:65;
            then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
            then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2
             by A46,XREAL_1:74;
            then (q`2)^2/(|.q.|)^2 <= 1 by A41,XCMPLX_1:60;
            then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
            then 1>=q`2/|.q.| by SQUARE_1:121;
            then
A47:        1-sn>=q`2/|.q.|-sn by XREAL_1:11;
A48:        -(1-sn)<= -0 by A42;
            -(1-sn)<= -( q`2/|.q.|-sn) by A47,XREAL_1:26;
            then (-(1-sn))/(1-sn)<=(-( q`2/|.q.|-sn))/(1-sn)
             by A42,XREAL_1:74;
            then
A49:        -1<=(-( q`2/|.q.|-sn))/(1-sn) by A42,XCMPLX_1:198;
            --(1-sn)>= -(q`2/|.q.|-sn) by A44,A48,XREAL_1:26;
            then (-(q`2/|.q.|-sn))/(1-sn)<=1 by A42,XREAL_1:187;
            then ((-(q`2/|.q.|-sn))/(1-sn))^2<=1^2 by A49,SQUARE_1:119;
            then
A50:        1-((-(q`2/|.q.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
            then
A51:        1-(-((q`2/|.q.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
            sqrt(1-((-(q`2/|.q.|-sn))/(1-sn))^2)>=0 by A50,SQUARE_1:def 4;
            then sqrt(1-(-(q`2/|.q.|-sn))^2/(1-sn)^2)>=0 by XCMPLX_1:77;
            then sqrt(1-(q`2/|.q.|-sn)^2/(1-sn)^2)>=0;
            then sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)>=0 by XCMPLX_1:77;
            then p`1=0 by A2,A35,A36,A38,A39;
            then (sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))=0 by A2,A35,A36,A39,A40,
XCMPLX_1:6;
            then 1-((q`2/|.q.|-sn)/(1-sn))^2=0 by A51,SQUARE_1:92;
            then 1= (q`2/|.q.|-sn)/(1-sn) by A45,SQUARE_1:83,89;
            then 1 *(1-sn)=(q`2/|.q.|-sn) by A42,XCMPLX_1:88;
            then 1 *|.q.|=q`2 by A34,TOPRNS_1:25,XCMPLX_1:88;
            then q`1=0 by A46,XCMPLX_1:6;
            hence x1=x2 by A2,A39,Th89;
          end;
          case
A52:        p<>0.REAL 2 & (p`2/|.p.|>=sn & p`1>=0);
            then
A53:        sn -FanMorphE.p= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
            |.p.|* ((p`2/|.p.|-sn)/(1-sn))]| by A1,Th91;
            set p4= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
            |.p.|* ((p`2/|.p.|-sn)/(1-sn))]|;
A54:        p4`1= |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)) &
            p4`2= |.p.|* ((p`2/|.p.|-sn)/(1-sn)) by EUCLID:56;
A55:        q4`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))&
            q4`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by EUCLID:56;
A56:        (q`2/|.q.|-sn)>= 0 by A34,XREAL_1:50;
A57:        (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
            0<=(q`1)^2 by XREAL_1:65;
            then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
            then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2
             by A57,XREAL_1:74;
            then (q`2)^2/(|.q.|)^2 <= 1 by A37,XCMPLX_1:60;
            then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
            then 1>=q`2/|.q.| by SQUARE_1:121;
            then
A58:        1-sn>=q`2/|.q.|-sn by XREAL_1:11;
A59:        -(1-sn)<= -0 by A3;
            -(1-sn)<= -( q`2/|.q.|-sn) by A58,XREAL_1:26;
            then (-(1-sn))/(1-sn)<=(-( q`2/|.q.|-sn))/(1-sn)
             by A3,XREAL_1:74;
            then
A60:        -1<=(-( q`2/|.q.|-sn))/(1-sn) by A3,XCMPLX_1:198;
            --(1-sn)>= -(q`2/|.q.|-sn) by A56,A59,XREAL_1:26;
            then (-(q`2/|.q.|-sn))/(1-sn)<=1 by A3,XREAL_1:187;
            then ((-(q`2/|.q.|-sn))/(1-sn))^2<=1^2 by A60,SQUARE_1:119;
            then 1-((-(q`2/|.q.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
            then
A61:        1-(-((q`2/|.q.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
A62:        (q4`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))^2 by A55
              .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1-sn))^2) by A61,SQUARE_1:def 4;
            (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
              .=(|.q.|)^2 by A55,A62;
            then
A63:        sqrt((|.q4.|)^2)=|.q.| by SQUARE_1:89;
            then
A64:        |.q4.|=|.q.| by SQUARE_1:89;
            |.p.|<>0 by A52,TOPRNS_1:25;
            then
A65:        (|.p.|)^2>0 by SQUARE_1:74;
A66:        (p`2/|.p.|-sn)>= 0 by A52,XREAL_1:50;
A67:        (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
            0<=(p`1)^2 by XREAL_1:65;
            then 0+(p`2)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
            then (p`2)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2
             by A67,XREAL_1:74;
            then (p`2)^2/(|.p.|)^2 <= 1 by A65,XCMPLX_1:60;
            then ((p`2)/|.p.|)^2 <= 1 by XCMPLX_1:77;
            then 1>=p`2/|.p.| by SQUARE_1:121;
            then
A68:        1-sn>=p`2/|.p.|-sn by XREAL_1:11;
A69:        -(1-sn)<= -0 by A3;
            -(1-sn)<= -( p`2/|.p.|-sn) by A68,XREAL_1:26;
            then (-(1-sn))/(1-sn)<=(-( p`2/|.p.|-sn))/(1-sn)
             by A3,XREAL_1:74;
            then
A70:        -1<=(-( p`2/|.p.|-sn))/(1-sn) by A3,XCMPLX_1:198;
            --(1-sn)>= -(p`2/|.p.|-sn) by A66,A69,XREAL_1:26;
            then (-(p`2/|.p.|-sn))/(1-sn)<=1 by A3,XREAL_1:187;
            then ((-(p`2/|.p.|-sn))/(1-sn))^2<=1^2 by A70,SQUARE_1:119;
            then 1-((-(p`2/|.p.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
            then
A71:        1-(-((p`2/|.p.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
A72:        (p4`1)^2= (|.p.|)^2*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2))^2 by A54
              .= (|.p.|)^2*(1-((p`2/|.p.|-sn)/(1-sn))^2) by A71,SQUARE_1:def 4;
            (|.p4.|)^2=(p4`1)^2+(p4`2)^2 by JGRAPH_3:10
              .=(|.p.|)^2 by A54,A72;
            then
A73:        sqrt((|.p4.|)^2)=|.p.| by SQUARE_1:89;
            then
A74:        |.p4.|=|.p.| by SQUARE_1:89;
            ((p`2/|.p.|-sn)/(1-sn))
            =|.q.|* ((q`2/|.q.|-sn)/(1-sn))/|.p.| by A2,A35,A36,A52,A53,A54,
TOPRNS_1:25,XCMPLX_1:90;
            then (p`2/|.p.|-sn)/(1-sn)=(q`2/|.q.|-sn)/(1-sn)
            by A2,A35,A52,A53,A63,A73,TOPRNS_1:25,XCMPLX_1:90;
            then (p`2/|.p.|-sn)/(1-sn)*(1-sn)=q`2/|.q.|-sn by A3,XCMPLX_1:88;
            then p`2/|.p.|-sn=q`2/|.q.|-sn by A3,XCMPLX_1:88;
            then p`2/|.p.|*|.p.|=q`2 by A2,A35,A52,A53,A64,A74,TOPRNS_1:25
,XCMPLX_1:88;
            then
A75:        p`2=q`2 by A52,TOPRNS_1:25,XCMPLX_1:88;
A76:        |.p.|^2=(p`1)^2+(p`2)^2 by JGRAPH_3:10;
            |.q.|^2=(q`1)^2+(q`2)^2 by JGRAPH_3:10;

then p`1=sqrt((q`1)^2) by A2,A35,A52,A53,A64,A74,A75,A76,SQUARE_1:89;
            then
A77:        p`1=q`1 by A34,SQUARE_1:89;
            p=|[p`1,p`2]| by EUCLID:57;
            hence x1=x2 by A75,A77,EUCLID:57;
          end;
          case
A78:        p<>0.REAL 2 & (p`2/|.p.|<sn & p`1>=0);
            then
A79:        sn -FanMorphE.p= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
            |.p.|* ((p`2/|.p.|-sn)/(1+sn))]| by A1,Th91;
            set p4= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
            |.p.|* ((p`2/|.p.|-sn)/(1+sn))]|;
A80:        p4`1= |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)) &
            p4`2= |.p.|* ((p`2/|.p.|-sn)/(1+sn)) by EUCLID:56;
A81:        p`2/|.p.|-sn<0 by A78,XREAL_1:51;
            1+sn>0 by A1,XREAL_1:150;
            then
A82:        ((p`2/|.p.|-sn)/(1+sn))<0 by A81,XREAL_1:143;
            |.p.|<>0 by A78,TOPRNS_1:25;
            then
A84:        |.p.|* ((p`2/|.p.|-sn)/(1+sn))<0 by A82,XREAL_1:134;
A85:        q`2/|.q.|-sn>=0 by A34,XREAL_1:50;
            1-sn>0 by A1,XREAL_1:151;
            then ((q`2/|.q.|-sn)/(1-sn))>=0 by A85;
            hence x1=x2 by A2,A35,A36,A79,A80,A84;
          end;
        end;
        hence x1=x2;
      end;
      case
A86:    q`2/|.q.|<sn & q`1>=0 & q<>0.REAL 2;
        then
A87:    sn-FanMorphE.q= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2 )),
        |.q.|* ((q`2/|.q.|-sn)/(1+sn))]| by A1,Th91;
        set q4= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
        |.q.|* ((q`2/|.q.|-sn)/(1+sn))]|;
A88:    q4`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)) &
        q4`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by EUCLID:56;
A89:    |.q.|<>0 by A86,TOPRNS_1:25;
        then
A90:    (|.q.|)^2>0 by SQUARE_1:74;
        now per cases by JGRAPH_2:11;
          case
A91:        p`1<=0;
            then
A92:        (sn-FanMorphE).p=p by Th89;
A93:        1+sn>0 by A1,XREAL_1:150;
A94:        (q`2/|.q.|-sn)<=0 by A86,XREAL_1:49;
            then
A95:        -(q`2/|.q.|-sn)>= -0;
            --(q`2/|.q.|-sn)/(1+sn)<=0 by A93,A94;
            then
A96:        -((q`2/|.q.|-sn)/(1+sn))>=0;
A97:        (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
            0<=(q`1)^2 by XREAL_1:65;
            then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
            then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2
             by A97,XREAL_1:74;
            then (q`2)^2/(|.q.|)^2 <= 1 by A90,XCMPLX_1:60;
            then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
            then
A98:        (-((q`2)/|.q.|))^2 <= 1;

(-(1+sn))/(1+sn)<=(-( q`2/|.q.|-sn))/(1+sn) by A93,A95,XREAL_1:74;
            then
A99:        -1<=(-( q`2/|.q.|-sn))/(1+sn) by A93,XCMPLX_1:198;
            1>= -q`2/|.q.| by A98,SQUARE_1:121;
            then (1+sn)>= -q`2/|.q.|+sn by XREAL_1:9;
            then (-(q`2/|.q.|-sn))/(1+sn)<=1 by A93,XREAL_1:187;
            then ((-(q`2/|.q.|-sn))/(1+sn))^2<=1^2 by A99,SQUARE_1:119;
            then
A100:       1-((-(q`2/|.q.|-sn))/(1+sn))^2>=0 by XREAL_1:50;
            then
A101:       1-(-((q`2/|.q.|-sn))/(1+sn))^2>=0 by XCMPLX_1:188;
            sqrt(1-((-(q`2/|.q.|-sn))/(1+sn))^2)>=0 by A100,SQUARE_1:def 4;
            then sqrt(1-(-(q`2/|.q.|-sn))^2/(1+sn)^2)>=0 by XCMPLX_1:77;
            then sqrt(1-((q`2/|.q.|-sn))^2/(1+sn)^2)>=0;
            then sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)>=0 by XCMPLX_1:77;
            then p`1=0 by A2,A87,A88,A91,A92;
            then (sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))=0 by A2,A87,A88,A89,A92,
XCMPLX_1:6;
            then 1-((q`2/|.q.|-sn)/(1+sn))^2=0 by A101,SQUARE_1:92;
            then 1=sqrt((-((q`2/|.q.|-sn)/(1+sn)))^2) by SQUARE_1:83;
            then 1= -((q`2/|.q.|-sn)/(1+sn)) by A96,SQUARE_1:89;
            then 1= ((-(q`2/|.q.|-sn))/(1+sn)) by XCMPLX_1:188;
            then 1 *(1+sn)=-(q`2/|.q.|-sn) by A93,XCMPLX_1:88;
            then 1+sn-sn=-q`2/|.q.|;
            then 1=(-q`2)/|.q.| by XCMPLX_1:188;
            then 1 *|.q.|=-q`2 by A86,TOPRNS_1:25,XCMPLX_1:88;
            then (q`2)^2-(q`2)^2 =(q`1)^2 by A97,XCMPLX_1:26;
            then q`1=0 by XCMPLX_1:6;
            hence x1=x2 by A2,A92,Th89;
          end;
          case
A102:       p<>0.REAL 2 & (p`2/|.p.|>=sn & p`1>=0);
            then
A103:       sn -FanMorphE.p= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
            |.p.|* ((p`2/|.p.|-sn)/(1-sn))]| by A1,Th91;
            set p4= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
            |.p.|* ((p`2/|.p.|-sn)/(1-sn))]|;
A104:       p4`1= |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)) &
            p4`2= |.p.|* ((p`2/|.p.|-sn)/(1-sn)) by EUCLID:56;
A105:       q`2/|.q.|-sn<0 by A86,XREAL_1:51;
            1+sn>0 by A1,XREAL_1:150;
            then
A106:       ((q`2/|.q.|-sn)/(1+sn))<0 by A105,XREAL_1:143;
            |.q.|<>0 by A86,TOPRNS_1:25;
            then
A108:       |.q.|* ((q`2/|.q.|-sn)/(1+sn))<0 by A106,XREAL_1:134;
A109:       p`2/|.p.|-sn>=0 by A102,XREAL_1:50;
            1-sn>0 by A1,XREAL_1:151;
            then ((p`2/|.p.|-sn)/(1-sn))>=0 by A109;
            hence x1=x2 by A2,A87,A88,A103,A104,A108;
          end;
          case
A110:       p<>0.REAL 2 & (p`2/|.p.|<sn & p`1>=0);
            then
A111:       sn -FanMorphE.p= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
            |.p.|* ((p`2/|.p.|-sn)/(1+sn))]| by A1,Th91;
            set p4= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
            |.p.|* ((p`2/|.p.|-sn)/(1+sn))]|;
A112:       p4`1= |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)) &
            p4`2= |.p.|* ((p`2/|.p.|-sn)/(1+sn)) by EUCLID:56;
A113:       q4`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))&
            q4`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by EUCLID:56;
            (q`2/|.q.|-sn)<=0 by A86,XREAL_1:49;
            then
A114:       -(q`2/|.q.|-sn)>= -0;
A115:       (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
            0<=(q`1)^2 by XREAL_1:65;
            then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;

then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A115,XREAL_1:74;
            then (q`2)^2/(|.q.|)^2 <= 1 by A90,XCMPLX_1:60;
            then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
            then -1<=q`2/|.q.| by SQUARE_1:121;
            then
A116:       -1-sn<=q`2/|.q.|-sn by XREAL_1:11;
A117:       1+sn>0 by A1,XREAL_1:150;

(-(1+sn))/(1+sn)<=(-( q`2/|.q.|-sn))/(1+sn) by A114,A117,XREAL_1:74;
            then
A118:       -1<=(-( q`2/|.q.|-sn))/(1+sn) by A117,XCMPLX_1:198;
            -(-1-sn)>= -(q`2/|.q.|-sn) by A116,XREAL_1:26;
            then (-(q`2/|.q.|-sn))/(1+sn)<=1 by A117,XREAL_1:187;
            then ((-(q`2/|.q.|-sn))/(1+sn))^2<=1^2 by A118,SQUARE_1:119;
            then 1-((-(q`2/|.q.|-sn))/(1+sn))^2>=0 by XREAL_1:50;
            then
A119:       1-(-((q`2/|.q.|-sn))/(1+sn))^2>=0 by XCMPLX_1:188;
A120:       (q4`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))^2 by A113

.= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1+sn))^2) by A119,SQUARE_1:def 4;
            (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
              .=(|.q.|)^2 by A113,A120;
            then
A121:       sqrt((|.q4.|)^2)=|.q.| by SQUARE_1:89;
            then
A122:       |.q4.|=|.q.| by SQUARE_1:89;
            |.p.|<>0 by A110,TOPRNS_1:25;
            then
A123:       (|.p.|)^2>0 by SQUARE_1:74;
            (p`2/|.p.|-sn)<=0 by A110,XREAL_1:49;
            then
A124:       -(p`2/|.p.|-sn)>= -0;
A125:       (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
            0<=(p`1)^2 by XREAL_1:65;
            then 0+(p`2)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;

then (p`2)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by A125,XREAL_1:74;
            then (p`2)^2/(|.p.|)^2 <= 1 by A123,XCMPLX_1:60;
            then ((p`2)/|.p.|)^2 <= 1 by XCMPLX_1:77;
            then -1<=p`2/|.p.| by SQUARE_1:121;
            then
A126:       -1-sn<=p`2/|.p.|-sn by XREAL_1:11;

(-(1+sn))/(1+sn)<=(-( p`2/|.p.|-sn))/(1+sn) by A117,A124,XREAL_1:74;
            then
A127:       -1<=(-( p`2/|.p.|-sn))/(1+sn) by A117,XCMPLX_1:198;
            -(-1-sn)>= -(p`2/|.p.|-sn) by A126,XREAL_1:26;
            then (-(p`2/|.p.|-sn))/(1+sn)<=1 by A117,XREAL_1:187;
            then ((-(p`2/|.p.|-sn))/(1+sn))^2<=1^2 by A127,SQUARE_1:119;
            then 1-((-(p`2/|.p.|-sn))/(1+sn))^2>=0 by XREAL_1:50;
            then
A128:       1-(-((p`2/|.p.|-sn))/(1+sn))^2>=0 by XCMPLX_1:188;
A129:       (p4`1)^2= (|.p.|)^2*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2))^2 by A112
              .= (|.p.|)^2*(1-((p`2/|.p.|-sn)/(1+sn))^2)
            by A128,SQUARE_1:def 4;
            (|.p4.|)^2=(p4`1)^2+(p4`2)^2 by JGRAPH_3:10
              .=(|.p.|)^2 by A112,A129;
            then
A130:       sqrt((|.p4.|)^2)=|.p.| by SQUARE_1:89;
            then
A131:       |.p4.|=|.p.| by SQUARE_1:89;
            ((p`2/|.p.|-sn)/(1+sn))
            =|.q.|* ((q`2/|.q.|-sn)/(1+sn))/|.p.| by A2,A87,A88,A110,A111,A112,
TOPRNS_1:25,XCMPLX_1:90;
            then (p`2/|.p.|-sn)/(1+sn)=(q`2/|.q.|-sn)/(1+sn)
            by A2,A87,A110,A111,A121,A130,TOPRNS_1:25,XCMPLX_1:90;
            then (p`2/|.p.|-sn)/(1+sn)*(1+sn)=q`2/|.q.|-sn by A117,XCMPLX_1:88;
            then p`2/|.p.|-sn=q`2/|.q.|-sn by A117,XCMPLX_1:88;
            then p`2/|.p.|*|.p.|=q`2 by A2,A87,A110,A111,A122,A131,TOPRNS_1:25
,XCMPLX_1:88;
            then
A132:       p`2=q`2 by A110,TOPRNS_1:25,XCMPLX_1:88;
A133:       |.p.|^2=(p`1)^2+(p`2)^2 by JGRAPH_3:10;
            |.q.|^2=(q`1)^2+(q`2)^2 by JGRAPH_3:10;
            then p`1=sqrt((q`1)^2) by A2,A87,A110,A111,A122,A131,A132,A133,
SQUARE_1:89;
            then
A134:       p`1=q`1 by A86,SQUARE_1:89;
            p=|[p`1,p`2]| by EUCLID:57;
            hence x1=x2 by A132,A134,EUCLID:57;
          end;
        end;
        hence x1=x2;
      end;
    end;
    hence x1=x2;
  end;
  hence thesis by FUNCT_1:def 8;
end;

theorem Th110:
  for sn being Real st -1<sn & sn<1 holds
  (sn-FanMorphE) is Function of TOP-REAL 2,TOP-REAL 2 &
  rng (sn-FanMorphE) = the carrier of TOP-REAL 2
proof
  let sn be Real;
  assume
A1: -1<sn & sn<1;
  thus (sn-FanMorphE) is Function of TOP-REAL 2,TOP-REAL 2;
  for f being Function of TOP-REAL 2,TOP-REAL 2 st f=(sn-FanMorphE) holds
  rng (sn-FanMorphE)=the carrier of TOP-REAL 2
  proof
    let f be Function of TOP-REAL 2,TOP-REAL 2;
    assume
A2: f=(sn-FanMorphE);
A3: dom f=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
    the carrier of TOP-REAL 2 c= rng f
    proof
      let y be set;
      assume y in the carrier of TOP-REAL 2;
      then reconsider p2=y as Point of TOP-REAL 2;
      set q=p2;
      now per cases by JGRAPH_2:11;
        suppose q`1<=0;
          then q in dom (sn-FanMorphE) & y=(sn-FanMorphE).q by A2,A3,Th89;
          hence ex x being set st x in dom (sn-FanMorphE) & y=(sn-FanMorphE).x;
        end;
        suppose
A4:       q`2/|.q.|>=0 & q`1>=0 & q<>0.REAL 2;
          set px=|[ (|.q.|)*sqrt(1-(q`2/|.q.|*(1-sn)+sn)^2),
          |.q.|*(q`2/|.q.|*(1-sn)+sn)]|;
A5:       px`1 = (|.q.|)*sqrt(1-(q`2/|.q.|*(1-sn)+sn)^2) &
          px`2 = |.q.|*(q`2/|.q.|*(1-sn)+sn) by EUCLID:56;
          then
A6:       |.px.|^2=((|.q.|)*sqrt(1-(q`2/|.q.|*(1-sn)+sn)^2))^2
          +(|.q.|*(q`2/|.q.|*(1-sn)+sn))^2 by JGRAPH_3:10
            .=(|.q.|)^2*(sqrt(1-(q`2/|.q.|*(1-sn)+sn)^2))^2
          +(|.q.|)^2*((q`2/|.q.|*(1-sn)+sn))^2;
A7:       |.q.|<>0 by A4,TOPRNS_1:25;
          1-sn>=0 by A1,XREAL_1:151;
          then
A8:       q`2/|.q.|*(1-sn)>=0 by A4;
          then
A9:       (q`2/|.q.|*(1-sn)+sn)>=0+sn by XREAL_1:9;
A10:      |.q.|^2>0 by A7,SQUARE_1:74;
          --(1+sn)>0 by A1,XREAL_1:150;
          then -(-1-sn)>0;
          then -1-sn<= q`2/|.q.|*(1-sn) by A8;
          then
A11:      -1-sn+sn<= q`2/|.q.|*(1-sn)+sn by XREAL_1:9;
A12:      1-sn>0 by A1,XREAL_1:151;
A13:      (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
          0<=(q`1)^2 by XREAL_1:65;
          then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
          then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2
           by A13,XREAL_1:74;
          then (q`2)^2/(|.q.|)^2 <= 1 by A10,XCMPLX_1:60;
          then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
          then q`2/|.q.|<=1 by SQUARE_1:121;
          then q`2/|.q.|*(1-sn) <= 1 *(1-sn) by A12,XREAL_1:66;
          then q`2/|.q.|*(1-sn)+sn-sn <=1-sn;
          then (q`2/|.q.|*(1-sn)+sn) <=1 by XREAL_1:11;
          then 1^2>=(q`2/|.q.|*(1-sn)+sn)^2 by A11,SQUARE_1:119;
          then
A14:      1-(q`2/|.q.|*(1-sn)+sn)^2>=0 by XREAL_1:50;
          then
A15:      |.px.|^2=(|.q.|)^2*(1-(q`2/|.q.|*(1-sn)+sn)^2)
          +(|.q.|)^2*((q`2/|.q.|*(1-sn)+sn))^2 by A6,SQUARE_1:def 4
            .= (|.q.|)^2;
          then
A16:      |.px.|=sqrt(|.q.|^2) by SQUARE_1:89
            .=|.q.| by SQUARE_1:89;
          sqrt(1-(q`2/|.q.|*(1-sn)+sn)^2)>=0 by A14,SQUARE_1:def 4;
          then px`2/|.px.| >=sn & px`1>=0 & px<>0.REAL 2
          by A5,A7,A9,A16,TOPRNS_1:24,XCMPLX_1:90;
          then
A17:      (sn-FanMorphE).px =|[ |.px.|*(sqrt(1-((px`2/|.px.|-sn) /(1-sn))^2)),
          |.px.|* ((px`2/|.px.|-sn)/(1-sn))]| by A1,Th91;
A18:      |.px.|* ((px`2/|.px.|-sn)/(1-sn))

=|.q.|* (( ((q`2/|.q.|*(1-sn)+sn))-sn)/(1-sn)) by A4,A5,A16,TOPRNS_1:25
,XCMPLX_1:90
            .=|.q.|* ( q`2/|.q.|) by A12,XCMPLX_1:90
            .= q`2 by A4,TOPRNS_1:25,XCMPLX_1:88;
          then
A19:      |.px.|*(sqrt(1-((px`2/|.px.|-sn)/(1-sn))^2))
          = |.px.|*(sqrt(1-(q`2/|.px.|)^2)) by A4,A16,TOPRNS_1:25,XCMPLX_1:90
            .= |.px.|*(sqrt(1-(q`2)^2/(|.px.|)^2)) by XCMPLX_1:77
            .= |.px.|*(sqrt( (|.px.|)^2/(|.px.|)^2-(q`2)^2/(|.px.|)^2))
          by A10,A15,XCMPLX_1:60
            .= |.px.|*(sqrt( ((|.px.|)^2-(q`2)^2)/(|.px.|)^2)) by XCMPLX_1:121
            .= |.px.|*(sqrt( ((q`1)^2+(q`2)^2-(q`2)^2)/(|.px.|)^2))
          by A15,JGRAPH_3:10
            .= |.px.|*(sqrt((q`1/|.q.|)^2)) by A16,XCMPLX_1:77;
          q`1/|.q.|>=0 by A4;
          then
A20:      |.px.|*(sqrt((q`1/|.q.|)^2))=|.q.|*(q`1/|.q.|) by A16,SQUARE_1:89
            .=q`1 by A4,TOPRNS_1:25,XCMPLX_1:88;
          dom (sn-FanMorphE)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
          hence ex x being set st x in dom (sn-FanMorphE) & y=(sn-FanMorphE).x
          by A17,A18,A19,A20,EUCLID:57;
        end;
        suppose
A21:      q`2/|.q.|<0 & q`1>=0 & q<>0.REAL 2;
          set px=|[ (|.q.|)*sqrt(1-(q`2/|.q.|*(1+sn)+sn)^2),
          |.q.|*(q`2/|.q.|*(1+sn)+sn)]|;
A22:      px`1 = (|.q.|)*sqrt(1-(q`2/|.q.|*(1+sn)+sn)^2) &
          px`2 = |.q.|*(q`2/|.q.|*(1+sn)+sn) by EUCLID:56;
          then
A23:      |.px.|^2=((|.q.|)*sqrt(1-(q`2/|.q.|*(1+sn)+sn)^2))^2
          +(|.q.|*(q`2/|.q.|*(1+sn)+sn))^2 by JGRAPH_3:10
            .=(|.q.|)^2*(sqrt(1-(q`2/|.q.|*(1+sn)+sn)^2))^2
          +(|.q.|)^2*((q`2/|.q.|*(1+sn)+sn))^2;
A24:      |.q.|<>0 by A21,TOPRNS_1:25;
          1+sn>=0 by A1,XREAL_1:150;
          then
A25:      q`2/|.q.|*(1+sn)<=0 by A21;
          then
A26:      (q`2/|.q.|*(1+sn)+sn)<=0+sn by XREAL_1:9;
A27:      |.q.|^2>0 by A24,SQUARE_1:74;
          (1-sn)>0 by A1,XREAL_1:151;
          then
A28:      1-sn+sn>= q`2/|.q.|*(1+sn)+sn by A25,XREAL_1:9;
A29:      1+sn>0 by A1,XREAL_1:150;
A30:      (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
          0<=(q`1)^2 by XREAL_1:65;
          then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
          then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2
           by A30,XREAL_1:74;
          then (q`2)^2/(|.q.|)^2 <= 1 by A27,XCMPLX_1:60;
          then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
          then q`2/|.q.|>=-1 by SQUARE_1:121;
          then q`2/|.q.|*(1+sn) >=(-1)*(1+sn) by A29,XREAL_1:66;
          then q`2/|.q.|*(1+sn)+sn-sn >=-1-sn;
          then (q`2/|.q.|*(1+sn)+sn) >=-1 by XREAL_1:11;
          then 1^2>=(q`2/|.q.|*(1+sn)+sn)^2 by A28,SQUARE_1:119;
          then
A31:      1-(q`2/|.q.|*(1+sn)+sn)^2>=0 by XREAL_1:50;
          then
A32:      |.px.|^2=(|.q.|)^2*(1-(q`2/|.q.|*(1+sn)+sn)^2)
          +(|.q.|)^2*((q`2/|.q.|*(1+sn)+sn))^2 by A23,SQUARE_1:def 4
            .= (|.q.|)^2;
          then
A33:      |.px.|=sqrt(|.q.|^2) by SQUARE_1:89
            .=|.q.| by SQUARE_1:89;
          sqrt(1-(q`2/|.q.|*(1+sn)+sn)^2)>=0 by A31,SQUARE_1:def 4;
          then px`2/|.px.| <=sn & px`1>=0 & px<>0.REAL 2
          by A22,A24,A26,A33,TOPRNS_1:24,XCMPLX_1:90;
          then
A34:      (sn-FanMorphE).px =|[ |.px.|*(sqrt(1-((px`2/|.px.|-sn) /(1+sn))^2)),
          |.px.|* ((px`2/|.px.|-sn)/(1+sn))]| by A1,Th91;
A35:      |.px.|* ((px`2/|.px.|-sn)/(1+sn))

=|.q.|* (( ((q`2/|.q.|*(1+sn)+sn))-sn)/(1+sn)) by A21,A22,A33,TOPRNS_1:25
,XCMPLX_1:90
            .=|.q.|* ( q`2/|.q.|) by A29,XCMPLX_1:90
            .= q`2 by A21,TOPRNS_1:25,XCMPLX_1:88;
          then
A36:      |.px.|*(sqrt(1-((px`2/|.px.|-sn)/(1+sn))^2))
          = |.px.|*(sqrt(1-(q`2/|.px.|)^2)) by A21,A33,TOPRNS_1:25,XCMPLX_1:90
            .= |.px.|*(sqrt(1-(q`2)^2/(|.px.|)^2)) by XCMPLX_1:77
            .= |.px.|*(sqrt( (|.px.|)^2/(|.px.|)^2-(q`2)^2/(|.px.|)^2))
          by A27,A32,XCMPLX_1:60
            .= |.px.|*(sqrt( ((|.px.|)^2-(q`2)^2)/(|.px.|)^2)) by XCMPLX_1:121
            .= |.px.|*(sqrt( ((q`1)^2+(q`2)^2-(q`2)^2)/(|.px.|)^2))
          by A32,JGRAPH_3:10
            .= |.px.|*(sqrt((q`1/|.q.|)^2)) by A33,XCMPLX_1:77;
          q`1/|.q.|>=0 by A21;
          then
A37:      |.px.|*(sqrt((q`1/|.q.|)^2)) =|.q.|*(q`1/|.q.|) by A33,SQUARE_1:89
            .=q`1 by A21,TOPRNS_1:25,XCMPLX_1:88;
          dom (sn-FanMorphE)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
          hence ex x being set st x in dom (sn-FanMorphE) & y=(sn-FanMorphE).x
          by A34,A35,A36,A37,EUCLID:57;
        end;
      end;
      hence y in rng f by A2,FUNCT_1:def 5;
    end;
    hence rng (sn-FanMorphE)=the carrier of TOP-REAL 2 by A2,XBOOLE_0:def 10;
  end;
  hence rng (sn-FanMorphE)=the carrier of TOP-REAL 2;
end;

theorem Th111:
  for sn being Real,p2 being Point of TOP-REAL 2 st -1<sn & sn<1
  ex K being non empty compact Subset of TOP-REAL 2 st K = (sn-FanMorphE).:K &
  (ex V2 being Subset of TOP-REAL 2 st
  p2 in V2 & V2 is open & V2 c= K & (sn-FanMorphE).p2 in V2)
proof
  let sn be Real,p2 be Point of TOP-REAL 2;
  assume
A1: -1<sn & sn<1;
  reconsider O=0.REAL 2 as Point of Euclid 2;
  reconsider V0=Ball(O,|.p2.|+1) as Subset of TOP-REAL 2;
A2: |. p2.|<|.p2.|+1 by XREAL_1:31;
A3: O in V0 by GOBOARD6:4;
A4: V0 c= cl_Ball(O,|.p2.|+1) by METRIC_1:15;
  reconsider K0=cl_Ball(O,|.p2.|+1)
  as non empty compact Subset of TOP-REAL 2 by A3,A4,Th22;
  reconsider u2=p2 as Point of Euclid 2;
A5: (sn-FanMorphE).:K0 c= K0
  proof
    let y be set;
    assume y in (sn-FanMorphE).:K0;
    then consider x being set such that
A6: x in dom (sn-FanMorphE) & x in K0 & y=(sn-FanMorphE).x by FUNCT_1:def 12;
    reconsider q=x as Point of TOP-REAL 2 by A6;
    reconsider uq=q as Point of Euclid 2;
A7: y in rng (sn-FanMorphE) by A6,FUNCT_1:def 5;
    then reconsider u=y as Point of Euclid 2;
    reconsider q4=y as Point of TOP-REAL 2 by A7;
A8: |.q4.|=|.q.| by A6,Th104;
    dist(O,uq)<= |.p2.|+1 by A6,METRIC_1:13;
    then |.0.REAL 2 - q.|<= |.p2.|+1 by JGRAPH_1:45;
    then |.0.REAL 2 +- q.|<= |.p2.|+1 by EUCLID:45;
    then |. -q.|<= |.p2.|+1 by EUCLID:31;
    then |.q.|<= |.p2.|+1 by TOPRNS_1:27;
    then |. -q4.|<= |.p2.|+1 by A8,TOPRNS_1:27;
    then |.0.REAL 2 +- q4.|<= |.p2.|+1 by EUCLID:31;
    then |.0.REAL 2 - q4.|<= |.p2.|+1 by EUCLID:45;
    then dist(O,u)<= |.p2.|+1 by JGRAPH_1:45;
    hence y in K0 by METRIC_1:13;
  end;
  K0 c= (sn-FanMorphE).:K0
  proof
    let y be set;
    assume
A9: y in K0;
    reconsider q4=y as Point of TOP-REAL 2 by A9;
    the carrier of TOP-REAL 2 c= rng (sn-FanMorphE) by A1,Th110;
    then q4 in rng (sn-FanMorphE) by TARSKI:def 3;
    then consider x being set such that
A10: x in dom (sn-FanMorphE) & y=(sn-FanMorphE).x by FUNCT_1:def 5;
    reconsider q=x as Point of TOP-REAL 2 by A10;
    |.q4.|=|.q.| by A10,Th104;
    then q in K0 by A9,Lm11;
    hence y in (sn-FanMorphE).:K0 by A10,FUNCT_1:def 12;
  end;
  then
A11: K0= (sn-FanMorphE).:K0 by A5,XBOOLE_0:def 10;
  |. -p2.|<|.p2.|+1 by A2,TOPRNS_1:27;
  then |.0.REAL 2 +- p2.|<|.p2.|+1 by EUCLID:31;
  then |.0.REAL 2 - p2.|<|.p2.|+1 by EUCLID:45;
  then dist(O,u2)<|.p2.|+1 by JGRAPH_1:45;
  then
A12: p2 in V0 by METRIC_1:12;
A13: V0 is open by TOPMETR:21;
  set q3= (sn-FanMorphE).p2;
  reconsider u3=q3 as Point of Euclid 2;
  |.q3.|=|.p2.| by Th104;
  then |. -q3.|<|.p2.|+1 by A2,TOPRNS_1:27;
  then |.0.REAL 2 +- q3.|<|.p2.|+1 by EUCLID:31;
  then |.0.REAL 2 - q3.|<|.p2.|+1 by EUCLID:45;
  then dist(O,u3)< |.p2.|+1 by JGRAPH_1:45;
  then (sn-FanMorphE).p2 in V0 by METRIC_1:12;
  hence thesis by A11,A12,A13,METRIC_1:15;
end;

theorem
  for sn being Real st -1<sn & sn<1
  ex f being Function of TOP-REAL 2,TOP-REAL 2 st f=(sn-FanMorphE)
  & f is being_homeomorphism
proof
  let sn be Real;
  assume
A1: -1<sn & sn<1;
  then
A2: (sn-FanMorphE) is Function of TOP-REAL 2,TOP-REAL 2 &
  rng (sn-FanMorphE) = the carrier of TOP-REAL 2 by Th110;
  reconsider f=(sn-FanMorphE) as Function of TOP-REAL 2,TOP-REAL 2;
  consider h being Function of (TOP-REAL 2),(TOP-REAL 2) such that
A3: h=(sn-FanMorphE) & h is continuous by A1,Th108;
A4: f is one-to-one by A1,Th109;
  for p2 being Point of TOP-REAL 2
  ex K being non empty compact Subset of TOP-REAL 2 st K = f.:K &
  (ex V2 being Subset of TOP-REAL 2 st
  p2 in V2 & V2 is open & V2 c= K & f.p2 in V2) by A1,Th111;
  then f is being_homeomorphism by A2,A3,A4,Th8;
  hence thesis;
end;

theorem Th113:
  for sn being Real,q being Point of TOP-REAL 2 st -1<sn & sn<1 & q`1>0
  & q`2/|.q.|>=sn holds (for p being Point of TOP-REAL 2 st
  p=(sn-FanMorphE).q holds p`1>0 & p`2>=0)
proof
  let sn be Real,q be Point of TOP-REAL 2;
  assume
A1: -1<sn & sn<1 & q`1>0 & q`2/|.q.|>=sn;
  let p be Point of TOP-REAL 2;
  assume p=(sn-FanMorphE).q;
  then
A3: p=|[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
  |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by A1,Th89;
  set qz=p;
A4: |.q.|<>0 by A1,JGRAPH_2:11,TOPRNS_1:25;
  then
A5: (|.q.|)^2>0 by SQUARE_1:74;
A6: 1-sn>0 by A1,XREAL_1:151;
A7: qz`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))&
  qz`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by A3,EUCLID:56;
A8: (q`2/|.q.|-sn)>= 0 by A1,XREAL_1:50;
A9: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
  0+(q`2)^2<(q`1)^2+(q`2)^2 by A1,SQUARE_1:74,XREAL_1:10;
  then (q`2)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A5,A9,XREAL_1:76;
  then (q`2)^2/(|.q.|)^2 < 1 by A5,XCMPLX_1:60;
  then ((q`2)/|.q.|)^2 < 1 by XCMPLX_1:77;
  then 1>q`2/|.q.| by SQUARE_1:122;
  then
A10: 1-sn>q`2/|.q.|-sn by XREAL_1:11;
A11: -(1-sn)< -0 by A6,XREAL_1:26;
  -(1-sn)< -( q`2/|.q.|-sn) by A10,XREAL_1:26;
  then (-(1-sn))/(1-sn)<(-( q`2/|.q.|-sn))/(1-sn) by A6,XREAL_1:76;
  then
A12: -1<(-( q`2/|.q.|-sn))/(1-sn) by A6,XCMPLX_1:198;
  --(1-sn)> -(q`2/|.q.|-sn) by A8,A11,XREAL_1:26;
  then (-(q`2/|.q.|-sn))/(1-sn)<1 by A6,XREAL_1:193;
  then ((-(q`2/|.q.|-sn))/(1-sn))^2<1^2 by A12,SQUARE_1:120;
  then 1-((-(q`2/|.q.|-sn))/(1-sn))^2>0 by XREAL_1:52;
  then sqrt(1-((-(q`2/|.q.|-sn))/(1-sn))^2)>0 by SQUARE_1:93;
  then sqrt(1-(-(q`2/|.q.|-sn))^2/(1-sn)^2)> 0 by XCMPLX_1:77;
  then sqrt(1-(q`2/|.q.|-sn)^2/(1-sn)^2)> 0;
  then
A13: sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)> 0 by XCMPLX_1:77;
  ((q`2/|.q.|-sn)/(1-sn))>=0 by A6,A8;
  hence p`1>0 & p`2>=0 by A4,A7,A13,XREAL_1:131;
end;

theorem Th114:
  for sn being Real,q being Point of TOP-REAL 2 st -1<sn & sn<1 & q`1>0
  & q`2/|.q.|<sn holds (for p being Point of TOP-REAL 2 st
  p=(sn-FanMorphE).q holds p`1>0 & p`2<0)
proof
  let sn be Real,q be Point of TOP-REAL 2;
  assume
A1: -1<sn & sn<1 & q`1>0 & q`2/|.q.|<sn;
  let p be Point of TOP-REAL 2;
  assume p=(sn-FanMorphE).q;
  then
A3: p=|[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
  |.q.|* ((q`2/|.q.|-sn)/(1+sn))]| by A1,Th90;
  set qz=p;
A4: |.q.|<>0 by A1,JGRAPH_2:11,TOPRNS_1:25;
  then
A5: (|.q.|)^2>0 by SQUARE_1:74;
A6: (q`2/|.q.|-sn)< 0 by A1,XREAL_1:51;
A7: 1+sn>0 by A1,XREAL_1:150;
A8: qz`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))&
  qz`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by A3,EUCLID:56;
A9: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
  0+(q`2)^2<(q`1)^2+(q`2)^2 by A1,SQUARE_1:74,XREAL_1:10;
  then (q`2)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A5,A9,XREAL_1:76;
  then (q`2)^2/(|.q.|)^2 < 1 by A5,XCMPLX_1:60;
  then ((q`2)/|.q.|)^2 < 1 by XCMPLX_1:77;
  then -1<q`2/|.q.| by SQUARE_1:122;
  then -1-sn<q`2/|.q.|-sn by XREAL_1:11;
  then -(1+sn) < (q`2/|.q.|-sn);
  then
A10: --(1+sn)> -(q`2/|.q.|-sn) by XREAL_1:26;
A11: -( q`2/|.q.|-sn)>0 by A6,XREAL_1:60;
  (-(1+sn))/(1+sn)<(-( q`2/|.q.|-sn))/(1+sn) by A7,A11,XREAL_1:76;
  then
A12: -1<(-( q`2/|.q.|-sn))/(1+sn) by A7,XCMPLX_1:198;
  (-(q`2/|.q.|-sn))/(1+sn)<1 by A7,A10,XREAL_1:193;
  then ((-(q`2/|.q.|-sn))/(1+sn))^2<1^2 by A12,SQUARE_1:120;
  then 1-((-(q`2/|.q.|-sn))/(1+sn))^2>0 by XREAL_1:52;
  then sqrt(1-((-(q`2/|.q.|-sn))/(1+sn))^2)>0 by SQUARE_1:93;
  then sqrt(1-(-(q`2/|.q.|-sn))^2/(1+sn)^2)> 0 by XCMPLX_1:77;
  then sqrt(1-(q`2/|.q.|-sn)^2/(1+sn)^2)> 0;
  then
A13: sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)> 0 by XCMPLX_1:77;
  ((q`2/|.q.|-sn)/(1+sn))<0 by A6,A7,XREAL_1:143;
  hence p`1>0 & p`2<0 by A4,A8,A13,XREAL_1:131,134;
end;

theorem Th115:
  for sn being Real,q1,q2 being Point of TOP-REAL 2 st -1<sn & sn<1 & q1`1>0
  & q1`2/|.q1.|>=sn & q2`1>0 & q2`2/|.q2.|>=sn & q1`2/|.q1.|<q2`2/|.q2.|
  holds (for p1,p2 being Point of TOP-REAL 2 st
  p1=(sn-FanMorphE).q1 & p2=(sn-FanMorphE).q2 holds p1`2/|.p1.|<p2`2/|.p2.|)
proof
  let sn be Real,q1,q2 be Point of TOP-REAL 2;
  assume
A1: -1<sn & sn<1 & q1`1>0
  & q1`2/|.q1.|>=sn & q2`1>0 & q2`2/|.q2.|>=sn & q1`2/|.q1.|<q2`2/|.q2.|;
  let p1,p2 be Point of TOP-REAL 2;
  assume
A2: p1=(sn-FanMorphE).q1 & p2=(sn-FanMorphE).q2;
  then p1=|[ |.q1.|*(sqrt(1-((q1`2/|.q1.|-sn)/(1-sn))^2)),
  |.q1.|* ((q1`2/|.q1.|-sn)/(1-sn))]| by A1,Th89;
  then
A3: p1`1= |.q1.|*(sqrt(1-((q1`2/|.q1.|-sn)/(1-sn))^2))&
  p1`2= |.q1.|* ((q1`2/|.q1.|-sn)/(1-sn)) by EUCLID:56;
  p2=|[ |.q2.|*(sqrt(1-((q2`2/|.q2.|-sn)/(1-sn))^2)),
  |.q2.|* ((q2`2/|.q2.|-sn)/(1-sn))]| by A1,A2,Th89;
  then
A4: p2`1= |.q2.|*(sqrt(1-((q2`2/|.q2.|-sn)/(1-sn))^2))&
  p2`2= |.q2.|* ((q2`2/|.q2.|-sn)/(1-sn)) by EUCLID:56;
A5: |.q1.|>0 & |.q2.|>0 by A1,Lm1,JGRAPH_2:11;
A6: |.p1.|=|.q1.| & |.p2.|=|.q2.| by A2,Th104;
  then
A7: p1`2/|.p1.|= ((q1`2/|.q1.|-sn)/(1-sn)) by A3,A5,XCMPLX_1:90;
A8: p2`2/|.p2.|= ((q2`2/|.q2.|-sn)/(1-sn)) by A4,A5,A6,XCMPLX_1:90;
A9: q1`2/|.q1.|-sn< q2`2/|.q2.|-sn by A1,XREAL_1:11;
  1-sn>0 by A1,XREAL_1:151;
  hence thesis by A7,A8,A9,XREAL_1:76;
end;

theorem Th116:
  for sn being Real,q1,q2 being Point of TOP-REAL 2 st -1<sn & sn<1 & q1`1>0
  & q1`2/|.q1.|<sn & q2`1>0 & q2`2/|.q2.|<sn & q1`2/|.q1.|<q2`2/|.q2.|
  holds (for p1,p2 being Point of TOP-REAL 2 st
  p1=(sn-FanMorphE).q1 & p2=(sn-FanMorphE).q2 holds p1`2/|.p1.|<p2`2/|.p2.|)
proof
  let sn be Real,q1,q2 be Point of TOP-REAL 2;
  assume
A1: -1<sn & sn<1 & q1`1>0
  & q1`2/|.q1.|<sn & q2`1>0 & q2`2/|.q2.|<sn & q1`2/|.q1.|<q2`2/|.q2.|;
  let p1,p2 be Point of TOP-REAL 2;
  assume
A2: p1=(sn-FanMorphE).q1 & p2=(sn-FanMorphE).q2;
  then p1=|[ |.q1.|*(sqrt(1-((q1`2/|.q1.|-sn)/(1+sn))^2)),
  |.q1.|* ((q1`2/|.q1.|-sn)/(1+sn))]| by A1,Th90;
  then
A3: p1`1= |.q1.|*(sqrt(1-((q1`2/|.q1.|-sn)/(1+sn))^2))&
  p1`2= |.q1.|* ((q1`2/|.q1.|-sn)/(1+sn)) by EUCLID:56;
  p2=|[ |.q2.|*(sqrt(1-((q2`2/|.q2.|-sn)/(1+sn))^2)),
  |.q2.|* ((q2`2/|.q2.|-sn)/(1+sn))]| by A1,A2,Th90;
  then
A4: p2`1= |.q2.|*(sqrt(1-((q2`2/|.q2.|-sn)/(1+sn))^2))&
  p2`2= |.q2.|* ((q2`2/|.q2.|-sn)/(1+sn)) by EUCLID:56;
A5: |.q1.|>0 & |.q2.|>0 by A1,Lm1,JGRAPH_2:11;
A6: |.p1.|=|.q1.| & |.p2.|=|.q2.| by A2,Th104;
  then
A7: p1`2/|.p1.|= (q1`2/|.q1.|-sn)/(1+sn) by A3,A5,XCMPLX_1:90;
A8: p2`2/|.p2.|= (q2`2/|.q2.|-sn)/(1+sn) by A4,A5,A6,XCMPLX_1:90;
A9: q1`2/|.q1.|-sn< q2`2/|.q2.|-sn by A1,XREAL_1:11;
  1+sn>0 by A1,XREAL_1:150;
  hence p1`2/|.p1.|<p2`2/|.p2.| by A7,A8,A9,XREAL_1:76;
end;

theorem
  for sn being Real,q1,q2 being Point of TOP-REAL 2 st -1<sn & sn<1 & q1`1>0
  & q2`1>0 & q1`2/|.q1.|<q2`2/|.q2.|
  holds (for p1,p2 being Point of TOP-REAL 2 st
  p1=(sn-FanMorphE).q1 & p2=(sn-FanMorphE).q2 holds p1`2/|.p1.|<p2`2/|.p2.|)
proof
  let sn be Real,q1,q2 be Point of TOP-REAL 2;
  assume
A1: -1<sn & sn<1 & q1`1>0 & q2`1>0 & q1`2/|.q1.|<q2`2/|.q2.|;
  let p1,p2 be Point of TOP-REAL 2;
  assume
A2: p1=(sn-FanMorphE).q1 & p2=(sn-FanMorphE).q2;
  per cases;
  suppose q1`2/|.q1.|>=sn & q2`2/|.q2.|>=sn;
    hence p1`2/|.p1.|<p2`2/|.p2.| by A1,A2,Th115;
  end;
  suppose q1`2/|.q1.|>=sn & q2`2/|.q2.|<sn;
    hence p1`2/|.p1.|<p2`2/|.p2.| by A1,XXREAL_0:2;
  end;
  suppose
A3: q1`2/|.q1.|<sn & q2`2/|.q2.|>=sn;
    then
A4: p1`1>0 & p1`2<0 by A1,A2,Th114;
    then
A5: |.p1.|>0 by Lm1,JGRAPH_2:11;
    p2`1>0 & p2`2>=0 by A1,A2,A3,Th113;
    then p2`2/|.p2.|>=0;
    hence p1`2/|.p1.|<p2`2/|.p2.| by A4,A5,XREAL_1:143;
  end;
  suppose q1`2/|.q1.|<sn & q2`2/|.q2.|<sn;
    hence p1`2/|.p1.|<p2`2/|.p2.| by A1,A2,Th116;
  end;
end;

theorem
  for sn being Real,q being Point of TOP-REAL 2 st -1<sn & sn<1 & q`1>0
  & q`2/|.q.|=sn holds (for p being Point of TOP-REAL 2 st
  p=(sn-FanMorphE).q holds p`1>0 & p`2=0)
proof
  let sn be Real,q be Point of TOP-REAL 2;
  assume
A1: -1<sn & sn<1 & q`1>0 & q`2/|.q.|=sn;
  let p be Point of TOP-REAL 2;
  assume p=(sn-FanMorphE).q;
  then
A3: p=|[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
  |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by A1,Th89;
A4: |.q.|<>0 by A1,JGRAPH_2:11,TOPRNS_1:25;
A5: p`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))&
  p`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by A3,EUCLID:56;
  sqrt(1-((-(q`2/|.q.|-sn))/(1-sn))^2)>0 by A1,SQUARE_1:93;
  hence thesis by A1,A4,A5,XREAL_1:131;
end;

theorem
  for sn being real number holds 0.REAL 2=(sn-FanMorphE).(0.REAL 2)
  by Th89,JGRAPH_2:11;

begin :: Fan Morphism for South

definition
  let s be real number, q be Point of TOP-REAL 2;
  func FanS(s,q) -> Point of TOP-REAL 2 equals
  :Def8:
  |.q.|*|[(q`1/|.q.|-s)/(1-s),
  -sqrt(1-((q`1/|.q.|-s)/(1-s))^2)]| if q`1/|.q.|>=s & q`2<0,
  |.q.|*|[(q`1/|.q.|-s)/(1+s),
  -sqrt(1-((q`1/|.q.|-s)/(1+s))^2)]| if q`1/|.q.|<s & q`2<0 otherwise q;
  correctness;
end;

definition
  let c be real number;
  func c-FanMorphS -> Function of TOP-REAL 2, TOP-REAL 2 means
  :Def9:
  for q being Point of TOP-REAL 2 holds it.q=FanS(c,q);
  existence
  proof
    deffunc F(Point of TOP-REAL 2)=FanS(c,$1);
    thus ex IT being Function of TOP-REAL 2, TOP-REAL 2 st
    for q being Point of TOP-REAL 2 holds IT.q=F(q)from FUNCT_2:sch 4;
  end;
  uniqueness
  proof
    deffunc F(Point of TOP-REAL 2)=FanS(c,$1);
    thus for a,b being Function of TOP-REAL 2, TOP-REAL 2 st
    (for q being Point of TOP-REAL 2 holds a.q=F(q)) &
    (for q being Point of TOP-REAL 2 holds b.q=F(q)) holds
    a=b from BINOP_2:sch 1;
  end;
end;

theorem Th120:
  for cn being real number holds (q`1/|.q.|>=cn & q`2<0 implies
  cn-FanMorphS.q= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
  |.q.|*(-sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]|)&
  (q`2>=0 implies cn-FanMorphS.q=q)
proof
  let cn be real number;
A1: cn-FanMorphS.q=FanS(cn,q) by Def9;
  hereby
    assume q`1/|.q.|>=cn & q`2<0;
    then FanS(cn,q)= |.q.|*|[(q`1/|.q.|-cn)/(1-cn),
    -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)]| by Def8
      .= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
    |.q.|*(-sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by EUCLID:62;
    hence cn-FanMorphS.q= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
    |.q.|*(-sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by Def9;
  end;
  assume q`2>=0;
  hence thesis by A1,Def8;
end;

theorem Th121:
  for cn being Real holds (q`1/|.q.|<=cn & q`2<0 implies
  cn-FanMorphS.q= |[ |.q.|*((q`1/|.q.|-cn)/(1+cn)),
  |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]|)
proof
  let cn be Real;
  assume
A1: q`1/|.q.|<=cn & q`2<0;
  per cases by A1,XXREAL_0:1;
  suppose q`1/|.q.|<cn;
    then FanS(cn,q)= |.q.|*|[(q`1/|.q.|-cn)/(1+cn),
    -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)]| by A1,Def8
      .= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
    |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]| by EUCLID:62;
    hence thesis by Def9;
  end;
  suppose
A2: q`1/|.q.|=cn;
    then (q`1/|.q.|-cn)/(1-cn)=0;
    hence thesis by A1,A2,Th120;
  end;
end;

theorem Th122:
  for cn being Real st -1<cn & cn<1 holds
  (q`1/|.q.|>=cn & q`2<=0 & q<>0.REAL 2 implies
  cn-FanMorphS.q = |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
  |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]|) &
  (q`1/|.q.|<=cn & q`2<=0 & q<>0.REAL 2 implies
  cn-FanMorphS.q = |[ |.q.|*((q`1/|.q.|-cn)/(1+cn)),
  |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]|)
proof
  let cn be Real;
  assume
A1: -1<cn & cn<1;
  per cases;
  suppose
A2: q`1/|.q.|>=cn & q`2<=0 & q<>0.REAL 2;
    per cases;
    suppose
A3:   q`2<0;
      then FanS(cn,q)= |.q.|*|[(q`1/|.q.|-cn)/(1-cn),
      -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)]| by A2,Def8
        .= |[|.q.|* ((q`1/|.q.|-cn)/(1-cn)),
      |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by EUCLID:62;
      hence thesis by A3,Def9,Th121;
    end;
    suppose
A4:   q`2>=0;
      then
A5:   cn-FanMorphS.q=q by Th120;
A6:   (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
A7:   |.q.|<>0 by A2,TOPRNS_1:25;
      then
A8:   |.q.|^2>0 by SQUARE_1:74;
A9:   q`2=0 by A2,A4;
A11:  sqrt((|.q.|)^2)=|.q.| by SQUARE_1:89;
A12:  1-cn>0 by A1,XREAL_1:151;
      (q`1)^2/|.q.|^2=1^2 by A6,A8,A9,XCMPLX_1:60;
      then ((q`1)/|.q.|)^2=1^2 by XCMPLX_1:77;
      then
A13:  sqrt(((q`1)/|.q.|)^2)=1 by SQUARE_1:89;
      now
        assume q`1<0;
        then q`1/|.q.|<0 by A7,XREAL_1:143;
        then -((q`1)/|.q.|)=1 by A13,SQUARE_1:90;
        hence contradiction by A1,A2;
      end;
      then
A14:  |.q.|=q`1 by A6,A9,A11,SQUARE_1:89;
      then 1=q`1/|.q.| by A2,TOPRNS_1:25,XCMPLX_1:60;
      then (q`1/|.q.|-cn)/(1-cn)=1 by A12,XCMPLX_1:60;
      hence thesis by A1,A5,A7,A9,A14,EUCLID:57,SQUARE_1:82,XCMPLX_1:60;
    end;
  end;
  suppose
A15: q`1/|.q.|<=cn & q`2<=0 & q<>0.REAL 2;
    per cases;
    suppose q`2<0;
      hence thesis by Th120,Th121;
    end;
    suppose
A16:  q`2>=0;
A17:  (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
A18:  |.q.|<>0 by A15,TOPRNS_1:25;
A19:  q`2=0 by A15,A16;
A21:  1+cn>0 by A1,XREAL_1:150;
      1>q`1/|.q.| by A1,A15,XXREAL_0:2;
      then 1 *(|.q.|)>q`1/|.q.|*(|.q.|) by A18,XREAL_1:70;
      then
A22:  (|.q.|)>q`1 by A15,TOPRNS_1:25,XCMPLX_1:88;
      then
A23:  |.q.|=-q`1 by A17,A19,SQUARE_1:109;
A24:  q`1= -(|.q.|) by A17,A19,A22,SQUARE_1:109;
      then -1=q`1/|.q.| by A15,TOPRNS_1:25,XCMPLX_1:198;
      then (q`1/|.q.|-cn)/(1+cn) =(-(1+cn))/(1+cn)
        .=-1 by A21,XCMPLX_1:198;
      then |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
      |.q.|*(-sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]|
      =q by A19,A23,EUCLID:57,SQUARE_1:82;
      hence thesis by A1,A16,A18,A24,Th120,XCMPLX_1:198;
    end;
  end;
  suppose q`2>0 or q=0.REAL 2;
    hence thesis;
  end;
end;

theorem Th123:
  for cn being Real,K1 being non empty Subset of TOP-REAL 2,
  f being Function of (TOP-REAL 2)|K1,R^1 st -1<cn & cn<1 &
  (for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|* ((p`1/|.p.|-cn)/(1-cn)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`2<=0 & q<>0.REAL 2) holds
  f is continuous
proof
  let cn be Real,K1 be non empty Subset of TOP-REAL 2,
  f be Function of (TOP-REAL 2)|K1,R^1;
  assume
A1: -1<cn & cn<1 &
  (for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|* ((p`1/|.p.|-cn)/(1-cn)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`2<=0 & q<>0.REAL 2);
  set a=cn, b=(1-cn);
A2: b>0 by A1,XREAL_1:151;
  reconsider g2=proj1|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm2;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1
  by Lm5;
  for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q<>0.REAL 2 by A1;
  then for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm6;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
A3: (for q being Point of
  (TOP-REAL 2)|K1,r1,r2 being Real st g2.q=r1 & g1.q=r2
  holds g3.q=r2*((r1/r2-a)/b)) & g3 is continuous by A2,Th10;
A4: dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then
A5: dom f=dom g3 by FUNCT_2:def 1;
  for x being set st x in dom f holds f.x=g3.x
  proof
    let x be set;
    assume
A6: x in dom f;
    then x in K1 by A4,A5,PRE_TOPC:29;
    then reconsider r=x as Point of (TOP-REAL 2);
    reconsider s=x as Point of (TOP-REAL 2)|K1 by A6;
A7: f.r=(|.r.|)* ((r`1/|.r.|-cn)/(1-cn)) by A1,A6;
A8: g2.s=proj1.s by Lm2;
A9: g1.s=(2 NormF).s by Lm5;
A10: proj1.r=r`1 by PSCOMP_1:def 28;
    (2 NormF).r=|.r.| by Def1;
    hence f.x=g3.x by A3,A7,A8,A9,A10;
  end;
  hence f is continuous by A3,A5,FUNCT_1:9;
end;

theorem Th124:
  for cn being Real,K1 being non empty Subset of TOP-REAL 2,
  f being Function of (TOP-REAL 2)|K1,R^1 st -1<cn & cn<1 &
  (for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|* ((p`1/|.p.|-cn)/(1+cn)))
  & (for q being Point of TOP-REAL 2 st
  q in the carrier of (TOP-REAL 2)|K1 holds q`2<=0 & q<>0.REAL 2) holds
  f is continuous
proof
  let cn be Real,K1 be non empty Subset of TOP-REAL 2,
  f be Function of (TOP-REAL 2)|K1,R^1;
  assume
A1: -1<cn & cn<1 &
  (for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|* ((p`1/|.p.|-cn)/(1+cn)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`2<=0 & q<>0.REAL 2);
  set a=cn, b=1+cn;
A2: 1+cn>0 by A1,XREAL_1:150;
  reconsider g2=proj1|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm2;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1
  by Lm5;
  for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q<>0.REAL 2 by A1;
  then for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm6;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
A3: (for q being Point of
  (TOP-REAL 2)|K1,r1,r2 being Real st g2.q=r1 & g1.q=r2
  holds g3.q=r2*((r1/r2-a)/b)) & g3 is continuous by A2,Th10;
A4: dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then
A5: dom f=dom g3 by FUNCT_2:def 1;
  for x being set st x in dom f holds f.x=g3.x
  proof
    let x be set;
    assume
A6: x in dom f;
    then x in dom g3 by A4;
    then x in K1 by A4,PRE_TOPC:29;
    then reconsider r=x as Point of (TOP-REAL 2);
    reconsider s=x as Point of (TOP-REAL 2)|K1 by A6;
A7: f.r=(|.r.|)* ((r`1/|.r.|-cn)/(1+cn)) by A1,A6;
A8: g2.s=proj1.s by Lm2;
A9: g1.s=(2 NormF).s by Lm5;
A10: proj1.r=r`1 by PSCOMP_1:def 28;
    (2 NormF).r=|.r.| by Def1;
    hence f.x=g3.x by A3,A7,A8,A9,A10;
  end;
  hence f is continuous by A3,A5,FUNCT_1:9;
end;

theorem Th125:
  for cn being Real,K1 being non empty Subset of TOP-REAL 2,
  f being Function of (TOP-REAL 2)|K1,R^1 st -1<cn & cn<1 &
  (for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds
  q`2<=0 & q`1/|.q.|>=cn & q<>0.REAL 2) holds f is continuous
proof
  let cn be Real,K1 be non empty Subset of TOP-REAL 2,
  f be Function of (TOP-REAL 2)|K1,R^1;
  assume
A1: -1<cn & cn<1 &
  (for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`2<=0 & q`1/|.q.|>=cn & q<>0.REAL 2);
  set a=cn, b=1-cn;
A2: b>0 by A1,XREAL_1:151;
  reconsider g2=proj1|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm2;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1
  by Lm5;
  for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q<>0.REAL 2 by A1;
  then for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm6;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
A3: (for q being Point of
  (TOP-REAL 2)|K1,r1,r2 being real number st g2.q=r1 & g1.q=r2
  holds g3.q=r2*( -sqrt(abs(1-((r1/r2-a)/b)^2))))
  & g3 is continuous by A2,Th14;
A4: dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then
A5: dom f=dom g3 by FUNCT_2:def 1;
  for x being set st x in dom f holds f.x=g3.x
  proof
    let x be set;
    assume
A6: x in dom f;
    then x in K1 by A4,A5,PRE_TOPC:29;
    then reconsider r=x as Point of (TOP-REAL 2);
    reconsider s=x as Point of (TOP-REAL 2)|K1 by A6;
A7: now
      assume |.r.|=0;
      then r=0.REAL 2 by TOPRNS_1:25;
      hence contradiction by A1,A6;
    end;
    |.r.|^2=(r`1)^2+(r`2)^2 by JGRAPH_3:10;
    then
A9: ((r`1) -(|.r.|))*((r`1)+|.r.|) =-(r`2)^2;
    (r`2)^2>=0 by XREAL_1:65;
    then -(r`2)^2 <=0;
    then -(|.r.|)<=r`1 & r`1<= |.r.| by A9,XREAL_1:95;
    then r`1/|.r.| <= |.r.|/|.r.| by XREAL_1:74;
    then r`1/|.r.|<=1 by A7,XCMPLX_1:60;
    then
A10: r`1/|.r.|-cn<=(1-cn) by XREAL_1:11;
A11: now
      assume (1-cn)^2=0;
      then 1-cn+cn=0+cn by XCMPLX_1:6;
      hence contradiction by A1;
    end;
A12: 1-cn>0 by A1,XREAL_1:151;
A13: (1-cn)^2>=0 by XREAL_1:65;
    cn<=r`1/(|.r.|) by A1,A6;
    then cn-r`1/|.r.|<=0 by XREAL_1:49;
    then -(cn- r`1/|.r.|)>=-(1-cn) by A12,XREAL_1:26;
    then (r`1/|.r.|-cn)^2<=(1-cn)^2 by A10,SQUARE_1:119;
    then (r`1/|.r.|-cn)^2/(1-cn)^2<=(1-cn)^2/(1-cn)^2 by A13,XREAL_1:74;
    then (r`1/|.r.|-cn)^2/(1-cn)^2<=1 by A11,XCMPLX_1:60;
    then ((r`1/|.r.|-cn)/(1-cn))^2<=1 by XCMPLX_1:77;
    then 1-((r`1/|.r.|-cn)/(1-cn))^2>=0 by XREAL_1:50;
    then abs(1-((r`1/|.r.|-cn)/(1-cn))^2)
    =1-((r`1/|.r.|-cn)/(1-cn))^2 by ABSVALUE:def 1;
    then
A14: f.r=(|.r.|)*(-sqrt(abs(1-((r`1/|.r.|-cn)/(1-cn))^2))) by A1,A6;
A15: g2.s=proj1.s by Lm2;
A16: g1.s=(2 NormF).s by Lm5;
A17: proj1.r=r`1 by PSCOMP_1:def 28;
    (2 NormF).r=|.r.| by Def1;
    hence f.x=g3.x by A3,A14,A15,A16,A17;
  end;
  hence f is continuous by A3,A5,FUNCT_1:9;
end;

theorem Th126:
  for cn being Real,K1 being non empty Subset of TOP-REAL 2,
  f being Function of (TOP-REAL 2)|K1,R^1 st -1<cn & cn<1 &
  (for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds
  q`2<=0 & q`1/|.q.|<=cn & q<>0.REAL 2) holds f is continuous
proof
  let cn be Real,K1 be non empty Subset of TOP-REAL 2,
  f be Function of (TOP-REAL 2)|K1,R^1;
  assume
A1: -1<cn & cn<1 &
  (for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`2<=0 & q`1/|.q.|<=cn & q<>0.REAL 2);
  set a=cn, b=1+cn;
A2: 1+cn>0 by A1,XREAL_1:150;
  reconsider g2=proj1|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm2;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1
  by Lm5;
  for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q<>0.REAL 2 by A1;
  then for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm6;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
A3: (for q being Point of
  (TOP-REAL 2)|K1,r1,r2 being real number st g2.q=r1 & g1.q=r2
  holds g3.q=r2*( -sqrt(abs(1-((r1/r2-a)/b)^2))))
  & g3 is continuous by A2,Th14;
A4: dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then
A5: dom f=dom g3 by FUNCT_2:def 1;
  for x being set st x in dom f holds f.x=g3.x
  proof
    let x be set;
    assume
A6: x in dom f;
    then x in K1 by A4,A5,PRE_TOPC:29;
    then reconsider r=x as Point of (TOP-REAL 2);
    reconsider s=x as Point of (TOP-REAL 2)|K1 by A6;
A7: now
      assume |.r.|=0;
      then r=0.REAL 2 by TOPRNS_1:25;
      hence contradiction by A1,A6;
    end;
    |.r.|^2=(r`1)^2+(r`2)^2 by JGRAPH_3:10;
    then
A9: ((r`1) -(|.r.|))*((r`1)+|.r.|) =-(r`2)^2;
    (r`2)^2>=0 by XREAL_1:65;
    then -(r`2)^2 <=0;
    then -(|.r.|)<=r`1 & r`1<= |.r.| by A9,XREAL_1:95;
    then r`1/|.r.| >= (-(|.r.|))/|.r.| by XREAL_1:74;
    then r`1/|.r.|>= -1 by A7,XCMPLX_1:198;
    then r`1/|.r.|-cn>=-1-cn by XREAL_1:11;
    then
A10: r`1/|.r.|-cn>=-(1+cn);
A11: (1+cn)^2>0 by A2,SQUARE_1:74;
    cn>=r`1/(|.r.|) by A1,A6;
    then cn-r`1/|.r.|>=0 by XREAL_1:50;
    then -(cn-r`1/|.r.|)<=-0;
    then (r`1/|.r.|-cn)^2<=(1+cn)^2 by A2,A10,SQUARE_1:119;
    then (r`1/|.r.|-cn)^2/(1+cn)^2<=(1+cn)^2/(1+cn)^2 by A11,XREAL_1:74;
    then (r`1/|.r.|-cn)^2/(1+cn)^2<=1 by A11,XCMPLX_1:60;
    then ((r`1/|.r.|-cn)/(1+cn))^2<=1 by XCMPLX_1:77;
    then 1-((r`1/|.r.|-cn)/(1+cn))^2>=0 by XREAL_1:50;
    then abs(1-((r`1/|.r.|-cn)/(1+cn))^2)
    =1-((r`1/|.r.|-cn)/(1+cn))^2 by ABSVALUE:def 1;
    then
A12: f.r=(|.r.|)*( -sqrt(abs(1-((r`1/|.r.|-cn)/(1+cn))^2))) by A1,A6;
A13: g2.s=proj1.s by Lm2;
A14: g1.s=(2 NormF).s by Lm5;
A15: proj1.r=r`1 by PSCOMP_1:def 28;
    (2 NormF).r=|.r.| by Def1;
    hence f.x=g3.x by A3,A12,A13,A14,A15;
  end;
  hence f is continuous by A3,A5,FUNCT_1:9;
end;

theorem Th127:
  for cn being Real, K0,B0 being Subset of TOP-REAL 2,f being
  Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0
  st -1<cn & cn<1 & f=(cn-FanMorphS)|K0 &
  B0={q where q is Point of TOP-REAL 2: q`2<=0 & q<>0.REAL 2}
  & K0={p: p`1/|.p.|>=cn & p`2<=0 & p<>0.REAL 2} holds f is continuous
proof
  let cn be Real,K0,B0 be Subset of TOP-REAL 2,f be
  Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0;
  assume
A1: -1<cn & cn<1 & f=(cn-FanMorphS)|K0 &
  B0={q where q is Point of TOP-REAL 2: q`2<=0 & q<>0.REAL 2} &
  K0={p: p`1/|.p.|>=cn & p`2<=0 & p<>0.REAL 2};
  set sn=-sqrt(1-cn^2);
  set p0=|[cn,sn]|;
A2: p0`1=cn by EUCLID:56;
A3: p0`2=sn by EUCLID:56;
  cn^2<1^2 by A1,SQUARE_1:120;
  then
A4: 1-cn^2>0 by XREAL_1:52;
A5: now
    assume p0=0.REAL 2;
    then --sn=-0 by EUCLID:56,JGRAPH_2:11;
    hence contradiction by A4,SQUARE_1:93;
  end;
  -sn>0 by A4,SQUARE_1:93;
  then
A6: sn<0;
A7: |.p0.|=sqrt((sn)^2+cn^2) by A2,A3,JGRAPH_3:10;
  (-sn)^2=1-cn^2 by A4,SQUARE_1:def 4;
  then p0`1/|.p0.|=cn by A7,EUCLID:56,SQUARE_1:83;
  then
A8: p0 in K0 by A1,A3,A5,A6;
  then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
A9: K0 c= B0
  proof
    let x be set;
    assume x in K0;
    then consider p8 being Point of TOP-REAL 2 such that
A10: x=p8 & (p8`1/|.p8.|>=cn & p8`2<=0 & p8<>0.REAL 2) by A1;
    thus x in B0 by A1,A10;
  end;
A11: dom (proj1*((cn-FanMorphS)|K1)) c= dom ((cn-FanMorphS)|K1) by RELAT_1:44;
  dom ((cn-FanMorphS)|K1) c= dom (proj1*((cn-FanMorphS)|K1))
  proof
    let x be set;
    assume
A12: x in dom ((cn-FanMorphS)|K1);
    then
A13: x in dom (cn-FanMorphS) /\ K1 by FUNCT_1:68;
A14: ((cn-FanMorphS)|K1).x=(cn-FanMorphS).x by A12,FUNCT_1:68;
A15: dom proj1 = (the carrier of TOP-REAL 2) by FUNCT_2:def 1;
    x in dom (cn-FanMorphS) by A13,XBOOLE_0:def 4;
    then (cn-FanMorphS).x in rng (cn-FanMorphS) by FUNCT_1:12;
    hence x in dom (proj1*((cn-FanMorphS)|K1)) by A12,A14,A15,FUNCT_1:21;
  end;
  then
A16: dom (proj1*((cn-FanMorphS)|K1))
  =dom ((cn-FanMorphS)|K1) by A11,XBOOLE_0:def 10
    .=dom (cn-FanMorphS) /\ K1 by FUNCT_1:68
    .=(the carrier of TOP-REAL 2)/\ K1 by FUNCT_2:def 1
    .=K1 by XBOOLE_1:28
    .=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
  rng (proj1*((cn-FanMorphS)|K1)) c= the carrier of R^1 by TOPMETR:24;

then reconsider g2=proj1*((cn-FanMorphS)|K1) as Function of (TOP-REAL 2)|K1,R^1
  by A16,FUNCT_2:4;
A17: dom (proj2*((cn-FanMorphS)|K1)) c= dom ((cn-FanMorphS)|K1) by RELAT_1:44;
  dom ((cn-FanMorphS)|K1) c= dom (proj2*((cn-FanMorphS)|K1))
  proof
    let x be set;
    assume
A18: x in dom ((cn-FanMorphS)|K1);
    then
A19: x in dom (cn-FanMorphS) /\ K1 by FUNCT_1:68;
A20: ((cn-FanMorphS)|K1).x=(cn-FanMorphS).x by A18,FUNCT_1:68;
A21: dom proj2 = (the carrier of TOP-REAL 2) by FUNCT_2:def 1;
    x in dom (cn-FanMorphS) by A19,XBOOLE_0:def 4;
    then (cn-FanMorphS).x in rng (cn-FanMorphS) by FUNCT_1:12;
    hence x in dom (proj2*((cn-FanMorphS)|K1)) by A18,A20,A21,FUNCT_1:21;
  end;
  then
A22: dom (proj2*((cn-FanMorphS)|K1))
  =dom ((cn-FanMorphS)|K1) by A17,XBOOLE_0:def 10
    .=dom (cn-FanMorphS) /\ K1 by FUNCT_1:68
    .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
    .=K1 by XBOOLE_1:28
    .=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
  rng (proj2*((cn-FanMorphS)|K1)) c= the carrier of R^1 by TOPMETR:24;

then reconsider g1=proj2*((cn-FanMorphS)|K1) as Function of (TOP-REAL 2)|K1,R^1
  by A22,FUNCT_2:4;
A23: for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`2<=0 & q<>0.REAL 2
  proof
    let q be Point of TOP-REAL 2;
    assume
A24: q in the carrier of (TOP-REAL 2)|K1;
    the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then consider p3 being Point of TOP-REAL 2 such that
A25: q=p3 & (p3`1/|.p3.|>=cn & p3`2<=0 & p3<>0.REAL 2) by A1,A24;
    thus q`2<=0 & q<>0.REAL 2 by A25;
  end;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g2.p=|.p.|* ((p`1/|.p.|-cn)/(1-cn))
  proof
    let p be Point of TOP-REAL 2;
    assume
A26: p in the carrier of (TOP-REAL 2)|K1;
A27: dom ((cn-FanMorphS)|K1)=dom (cn-FanMorphS) /\ K1 by FUNCT_1:68
      .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
      .=K1 by XBOOLE_1:28;
A28: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then consider p3 being Point of TOP-REAL 2 such that
A29: p=p3 & (p3`1/|.p3.|>=cn & p3`2<=0 & p3<>0.REAL 2) by A1,A26;
A30: (cn-FanMorphS).p =|[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
    |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]| by A1,A29,Th122;
    ((cn-FanMorphS)|K1).p=(cn-FanMorphS).p by A26,A28,FUNCT_1:72;
    then g2.p=proj1.(|[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
    |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]|)
    by A26,A27,A28,A30,FUNCT_1:23
      .=(|[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
    |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]|)`1 by PSCOMP_1:def 28
      .=|.p.|* ((p`1/|.p.|-cn)/(1-cn)) by EUCLID:56;
    hence g2.p=|.p.|* ((p`1/|.p.|-cn)/(1-cn));
  end;
  then consider f2 being Function of (TOP-REAL 2)|K1,R^1 such that
A31: for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds f2.p=|.p.|* ((p`1/|.p.|-cn)/(1-cn));
A32: f2 is continuous by A1,A23,A31,Th123;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g1.p=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))
  proof
    let p be Point of TOP-REAL 2;
    assume
A33: p in the carrier of (TOP-REAL 2)|K1;
A34: dom ((cn-FanMorphS)|K1)=dom (cn-FanMorphS) /\ K1 by FUNCT_1:68
      .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
      .=K1 by XBOOLE_1:28;
A35: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then consider p3 being Point of TOP-REAL 2 such that
A36: p=p3 & (p3`1/|.p3.|>=cn & p3`2<=0 & p3<>0.REAL 2) by A1,A33;
A37: (cn-FanMorphS).p=|[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
    |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]| by A1,A36,Th122;
    ((cn-FanMorphS)|K1).p=(cn-FanMorphS).p by A33,A35,FUNCT_1:72;
    then g1.p=proj2.(|[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
    |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]|)
    by A33,A34,A35,A37,FUNCT_1:23
      .=(|[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
    |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]|)`2 by PSCOMP_1:def 29
      .= |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)) by EUCLID:56;
    hence g1.p=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2));
  end;
  then consider f1 being Function of (TOP-REAL 2)|K1,R^1 such that
A38: for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds f1.p=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2));
  for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`2<=0 & q`1/|.q.|>=cn & q<>0.REAL 2
  proof
    let q be Point of TOP-REAL 2;
    assume
A39: q in the carrier of (TOP-REAL 2)|K1;
    the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then consider p3 being Point of TOP-REAL 2 such that
A40: q=p3 & (p3`1/|.p3.|>=cn & p3`2<=0 & p3<>0.REAL 2) by A1,A39;
    thus thesis by A40;
  end;
  then
A41: f1 is continuous by A1,A38,Th125;
  for x,y,s,r being real number st |[x,y]| in K1 &
  s=f2.(|[x,y]|) & r=f1.(|[x,y]|) holds f.(|[x,y]|)=|[s,r]|
  proof
    let x,y,s,r be real number;
    assume
A42: |[x,y]| in K1 & s=f2.(|[x,y]|) & r=f1.(|[x,y]|);
    set p99=|[x,y]|;
A43: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    consider p3 being Point of TOP-REAL 2 such that
A44: p99=p3 & (p3`1/|.p3.|>=cn & p3`2<=0 & p3<>0.REAL 2) by A1,A42;
A45: f1.p99=|.p99.|*( -sqrt(1-((p99`1/|.p99.|-cn)/(1-cn))^2)) by A38,A42,A43;
    ((cn-FanMorphS)|K0).(|[x,y]|)=((cn-FanMorphS)).(|[x,y]|) by A42,FUNCT_1:72
      .= |[ |.p99.|* ((p99`1/|.p99.|-cn)/(1-cn)),
    |.p99.|*( -sqrt(1-((p99`1/|.p99.|-cn)/(1-cn))^2))]| by A1,A44,Th122
      .=|[s,r]| by A31,A42,A43,A45;
    hence f.(|[x,y]|)=|[s,r]| by A1;
  end;
  hence f is continuous by A8,A9,A32,A41,JGRAPH_2:45;
end;

theorem Th128:
  for cn being Real, K0,B0 being Subset of TOP-REAL 2,
  f being Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0 st
  -1<cn & cn<1 & f=(cn-FanMorphS)|K0 &
  B0={q where q is Point of TOP-REAL 2: q`2<=0 & q<>0.REAL 2} &
  K0={p: p`1/|.p.|<=cn & p`2<=0 & p<>0.REAL 2} holds f is continuous
proof
  let cn be Real,K0,B0 be Subset of TOP-REAL 2,f be
  Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0;
  assume
A1: -1<cn & cn<1 & f=(cn-FanMorphS)|K0 &
  B0={q where q is Point of TOP-REAL 2: q`2<=0 & q<>0.REAL 2} &
  K0={p: p`1/|.p.|<=cn & p`2<=0 & p<>0.REAL 2};
  set sn=-sqrt(1-cn^2);
  set p0=|[cn,sn]|;
A2: p0`1=cn by EUCLID:56;
A3: p0`2=sn by EUCLID:56;
  cn^2<1^2 by A1,SQUARE_1:120;
  then
A4: 1-cn^2>0 by XREAL_1:52;
A5: now
    assume p0=0.REAL 2;
    then --sn=-0 by EUCLID:56,JGRAPH_2:11;
    hence contradiction by A4,SQUARE_1:93;
  end;
  -sn>0 by A4,SQUARE_1:93;
  then
A6: sn<0;
A7: |.p0.|=sqrt((sn)^2+cn^2) by A2,A3,JGRAPH_3:10;
  (-sn)^2=1-cn^2 by A4,SQUARE_1:def 4;
  then p0`1/|.p0.|=cn by A7,EUCLID:56,SQUARE_1:83;
  then
A8: p0 in K0 by A1,A3,A5,A6;
  then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
A9: K0 c= B0
  proof
    let x be set;
    assume x in K0;
    then consider p8 being Point of TOP-REAL 2 such that
A10: x=p8 & (p8`1/|.p8.|<=cn & p8`2<=0 & p8<>0.REAL 2) by A1;
    thus x in B0 by A1,A10;
  end;
A11: dom (proj1*((cn-FanMorphS)|K1)) c= dom ((cn-FanMorphS)|K1) by RELAT_1:44;
  dom ((cn-FanMorphS)|K1) c= dom (proj1*((cn-FanMorphS)|K1))
  proof
    let x be set;
    assume
A12: x in dom ((cn-FanMorphS)|K1);
    then
A13: x in dom (cn-FanMorphS) /\ K1 by FUNCT_1:68;
A14: ((cn-FanMorphS)|K1).x=(cn-FanMorphS).x by A12,FUNCT_1:68;
A15: dom proj1 = (the carrier of TOP-REAL 2) by FUNCT_2:def 1;
    x in dom (cn-FanMorphS) by A13,XBOOLE_0:def 4;
    then (cn-FanMorphS).x in rng (cn-FanMorphS) by FUNCT_1:12;
    hence x in dom (proj1*((cn-FanMorphS)|K1)) by A12,A14,A15,FUNCT_1:21;
  end;
  then
A16: dom (proj1*((cn-FanMorphS)|K1))
  =dom ((cn-FanMorphS)|K1) by A11,XBOOLE_0:def 10
    .=dom (cn-FanMorphS) /\ K1 by FUNCT_1:68
    .=(the carrier of TOP-REAL 2)/\ K1 by FUNCT_2:def 1
    .=K1 by XBOOLE_1:28
    .=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
  rng (proj1*((cn-FanMorphS)|K1)) c= the carrier of R^1 by TOPMETR:24;

then reconsider g2=proj1*((cn-FanMorphS)|K1) as Function of (TOP-REAL 2)|K1,R^1
  by A16,FUNCT_2:4;
A17: dom (proj2*((cn-FanMorphS)|K1)) c= dom ((cn-FanMorphS)|K1) by RELAT_1:44;
  dom ((cn-FanMorphS)|K1) c= dom (proj2*((cn-FanMorphS)|K1))
  proof
    let x be set;
    assume
A18: x in dom ((cn-FanMorphS)|K1);
    then
A19: x in dom (cn-FanMorphS) /\ K1 by FUNCT_1:68;
A20: ((cn-FanMorphS)|K1).x=(cn-FanMorphS).x by A18,FUNCT_1:68;
A21: dom proj2 = (the carrier of TOP-REAL 2) by FUNCT_2:def 1;
    x in dom (cn-FanMorphS) by A19,XBOOLE_0:def 4;
    then (cn-FanMorphS).x in rng (cn-FanMorphS) by FUNCT_1:12;
    hence x in dom (proj2*((cn-FanMorphS)|K1)) by A18,A20,A21,FUNCT_1:21;
  end;
  then
A22: dom (proj2*((cn-FanMorphS)|K1))
  =dom ((cn-FanMorphS)|K1) by A17,XBOOLE_0:def 10
    .=dom (cn-FanMorphS) /\ K1 by FUNCT_1:68
    .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
    .=K1 by XBOOLE_1:28
    .=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
  rng (proj2*((cn-FanMorphS)|K1)) c= the carrier of R^1 by TOPMETR:24;

then reconsider g1=proj2*((cn-FanMorphS)|K1) as Function of (TOP-REAL 2)|K1,R^1
  by A22,FUNCT_2:4;
A23: for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`2<=0 & q<>0.REAL 2
  proof
    let q be Point of TOP-REAL 2;
    assume
A24: q in the carrier of (TOP-REAL 2)|K1;
    the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then consider p3 being Point of TOP-REAL 2 such that
A25: q=p3 & (p3`1/|.p3.|<=cn & p3`2<=0 & p3<>0.REAL 2) by A1,A24;
    thus q`2<=0 & q<>0.REAL 2 by A25;
  end;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g2.p=|.p.|* ((p`1/|.p.|-cn)/(1+cn))
  proof
    let p be Point of TOP-REAL 2;
    assume
A26: p in the carrier of (TOP-REAL 2)|K1;
A27: dom ((cn-FanMorphS)|K1)=dom (cn-FanMorphS) /\ K1 by FUNCT_1:68
      .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
      .=K1 by XBOOLE_1:28;
A28: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then consider p3 being Point of TOP-REAL 2 such that
A29: p=p3 & (p3`1/|.p3.|<=cn & p3`2<=0 & p3<>0.REAL 2) by A1,A26;
A30: (cn-FanMorphS).p =|[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
    |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]| by A1,A29,Th122;
    ((cn-FanMorphS)|K1).p=(cn-FanMorphS).p by A26,A28,FUNCT_1:72;
    then g2.p=proj1.(|[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
    |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]|)
    by A26,A27,A28,A30,FUNCT_1:23
      .=(|[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
    |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]|)`1 by PSCOMP_1:def 28
      .=|.p.|* ((p`1/|.p.|-cn)/(1+cn)) by EUCLID:56;
    hence g2.p=|.p.|* ((p`1/|.p.|-cn)/(1+cn));
  end;
  then consider f2 being Function of (TOP-REAL 2)|K1,R^1 such that
A31: for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds f2.p=|.p.|* ((p`1/|.p.|-cn)/(1+cn));
A32: f2 is continuous by A1,A23,A31,Th124;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g1.p=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))
  proof
    let p be Point of TOP-REAL 2;
    assume
A33: p in the carrier of (TOP-REAL 2)|K1;
A34: dom ((cn-FanMorphS)|K1)=dom (cn-FanMorphS) /\ K1 by FUNCT_1:68
      .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
      .=K1 by XBOOLE_1:28;
A35: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then consider p3 being Point of TOP-REAL 2 such that
A36: p=p3 & (p3`1/|.p3.|<=cn & p3`2<=0 & p3<>0.REAL 2) by A1,A33;
A37: (cn-FanMorphS).p=|[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
    |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]| by A1,A36,Th122;
    ((cn-FanMorphS)|K1).p=(cn-FanMorphS).p by A33,A35,FUNCT_1:72;
    then g1.p=proj2.(|[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
    |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]|)
    by A33,A34,A35,A37,FUNCT_1:23
      .=(|[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
    |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]|)`2 by PSCOMP_1:def 29
      .= |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)) by EUCLID:56;
    hence g1.p=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2));
  end;
  then consider f1 being Function of (TOP-REAL 2)|K1,R^1 such that
A38: for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds f1.p=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2));
  for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`2<=0 & q`1/|.q.|<=cn & q<>0.REAL 2
  proof
    let q be Point of TOP-REAL 2;
    assume
A39: q in the carrier of (TOP-REAL 2)|K1;
    the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    then consider p3 being Point of TOP-REAL 2 such that
A40: q=p3 & (p3`1/|.p3.|<=cn & p3`2<=0 & p3<>0.REAL 2) by A1,A39;
    thus thesis by A40;
  end;
  then
A41: f1 is continuous by A1,A38,Th126;
  for x,y,s,r being real number st |[x,y]| in K1 &
  s=f2.(|[x,y]|) & r=f1.(|[x,y]|) holds f.(|[x,y]|)=|[s,r]|
  proof
    let x,y,s,r be real number;
    assume
A42: |[x,y]| in K1 & s=f2.(|[x,y]|) & r=f1.(|[x,y]|);
    set p99=|[x,y]|;
A43: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    consider p3 being Point of TOP-REAL 2 such that
A44: p99=p3 & (p3`1/|.p3.|<=cn & p3`2<=0 & p3<>0.REAL 2) by A1,A42;
A45: f1.p99=|.p99.|*( -sqrt(1-((p99`1/|.p99.|-cn)/(1+cn))^2)) by A38,A42,A43;
    ((cn-FanMorphS)|K0).(|[x,y]|)=((cn-FanMorphS)).(|[x,y]|) by A42,FUNCT_1:72
      .= |[ |.p99.|* ((p99`1/|.p99.|-cn)/(1+cn)),
    |.p99.|*( -sqrt(1-((p99`1/|.p99.|-cn)/(1+cn))^2))]| by A1,A44,Th122
      .=|[s,r]| by A31,A42,A43,A45;
    hence f.(|[x,y]|)=|[s,r]| by A1;
  end;
  hence f is continuous by A8,A9,A32,A41,JGRAPH_2:45;
end;

theorem Th129:
  for cn being Real, K03 being Subset of TOP-REAL 2
  st K03={p: p`1>=(cn)*(|.p.|) & p`2<=0} holds K03 is closed
proof
  let sn be Real, K003 be Subset of TOP-REAL 2;
  assume
A1: K003={p: p`1>=(sn)*(|.p.|) & p`2<=0};
  defpred P[Point of TOP-REAL 2] means ($1`1>=sn*|.$1.|);
  reconsider K1={p7 where p7 is Point of TOP-REAL 2:P[p7]}
  as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
A2: K1 is closed by Lm8;
  defpred Q[Point of TOP-REAL 2] means $1`2<=0;
  reconsider KX={p where p is Point of TOP-REAL 2: Q[p]}
  as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
A3: KX is closed by JORDAN6:9;
  {p : P[p] & Q[p]} = {p7 where p7 is Point of TOP-REAL 2:P[p7]} /\
  {p1 where p1 is Point of TOP-REAL 2: Q[p1]} from DOMAIN_1:sch 10;
  hence thesis by A1,A2,A3,TOPS_1:35;
end;

theorem Th130:
  for cn being Real, K03 being Subset of TOP-REAL 2
  st K03={p: p`1<=(cn)*(|.p.|) & p`2<=0} holds K03 is closed
proof
  let sn be Real, K003 be Subset of TOP-REAL 2;
  assume
A1: K003={p: p`1<=(sn)*(|.p.|) & p`2<=0};
  defpred P[Point of TOP-REAL 2] means ($1`1<=sn*|.$1.|);
  reconsider K1={p7 where p7 is Point of TOP-REAL 2:P[p7]}
  as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
A2: K1 is closed by Lm10;
  defpred Q[Point of TOP-REAL 2] means $1`2<=0;
  reconsider KX={p where p is Point of TOP-REAL 2: Q[p]}
  as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
A3: KX is closed by JORDAN6:9;
  {p : P[p] & Q[p]} = {p7 where p7 is Point of TOP-REAL 2:P[p7]} /\
  {p1 where p1 is Point of TOP-REAL 2: Q[p1]} from DOMAIN_1:sch 10;
  hence thesis by A1,A2,A3,TOPS_1:35;
end;

theorem Th131:
  for cn being Real, K0,B0 being Subset of TOP-REAL 2,
  f being Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0 st
  -1<cn & cn<1 & f=(cn-FanMorphS)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} &
  K0={p: p`2<=0 & p<>0.REAL 2} holds f is continuous
proof
  let cn be Real,K0,B0 be Subset of TOP-REAL 2,f be
  Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0;
  assume
A1: -1<cn & cn<1 & f=(cn-FanMorphS)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} & K0={p: p`2<=0 & p<>0.REAL 2};
  set sn=-sqrt(1-cn^2);
  set p0=|[cn,sn]|;
A2: p0`1=cn by EUCLID:56;
A3: p0`2=sn by EUCLID:56;
  cn^2<1^2 by A1,SQUARE_1:120;
  then
A4: 1-cn^2>0 by XREAL_1:52;
A5: now
    assume p0=0.REAL 2;
    then --sn=-0 by EUCLID:56,JGRAPH_2:11;
    hence contradiction by A4,SQUARE_1:93;
  end;
  -sn>0 by A4,SQUARE_1:93;
  then
A6: sn<0;
A7: |.p0.|=sqrt((sn)^2+cn^2) by A2,A3,JGRAPH_3:10;
  (-sn)^2=1-cn^2 by A4,SQUARE_1:def 4;
  then
A8: p0`1/|.p0.|=cn by A7,EUCLID:56,SQUARE_1:83;
  p0 in K0 by A1,A3,A5,A6;
  then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
  p0 in the carrier of TOP-REAL 2 & not p0 in {0.REAL 2} by A5,TARSKI:def 1;
  then reconsider D=B0 as non empty Subset of TOP-REAL 2 by A1,XBOOLE_0:def 5;
A9: p0 in {p: p`1/|.p.|>=cn & p`2<=0 & p<>0.REAL 2} by A3,A5,A6,A8;
  defpred P[Point of TOP-REAL 2] means
  $1`1/|.$1.|>=cn & $1`2<=0 & $1<>0.REAL 2;
A10: {p: P[p]} is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
A11: {p: p`1/|.p.|>=cn & p`2<=0 & p<>0.REAL 2} c= K1
  proof
    let x be set;
    assume x in {p: p`1/|.p.|>=cn & p`2<=0 & p<>0.REAL 2};
    then consider p such that
A12: p=x & p`1/|.p.|>=cn & p`2<=0 & p<>0.REAL 2;
    thus x in K1 by A1,A12;
  end;
  then reconsider K00={p: p`1/|.p.|>=cn & p`2<=0 & p<>0.REAL 2}
  as non empty Subset of ((TOP-REAL 2)|K1) by A9,PRE_TOPC:29;
  reconsider K001={p: p`1/|.p.|>=cn & p`2<=0 & p<>0.REAL 2}
  as non empty Subset of TOP-REAL 2 by A9,A10;
  defpred P[Point of TOP-REAL 2] means $1`1>=cn*(|.$1.|) & $1`2<=0;
  {p: P[p]} is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
  then reconsider K003={p: p`1>=(cn)*(|.p.|) & p`2<=0}
  as Subset of TOP-REAL 2;
A13: p0 in {p: p`1/|.p.|<=cn & p`2<=0 & p<>0.REAL 2} by A3,A5,A6,A8;
A14: {p: p`1/|.p.|<=cn & p`2<=0 & p<>0.REAL 2} c= K1
  proof
    let x be set;
    assume x in {p: p`1/|.p.|<=cn & p`2<=0 & p<>0.REAL 2};
    then consider p such that
A15: p=x & p`1/|.p.|<=cn & p`2<=0 & p<>0.REAL 2;
    thus x in K1 by A1,A15;
  end;
  then reconsider K11={p: p`1/|.p.|<=cn & p`2<=0 & p<>0.REAL 2}
  as non empty Subset of ((TOP-REAL 2)|K1) by A13,PRE_TOPC:29;
A16: p0 in {p: p`1/|.p.|<=cn & p`2<=0 & p<>0.REAL 2} by A3,A5,A6,A8;
  defpred P[Point of TOP-REAL 2] means
  $1`1/|.$1.|<=cn & $1`2<=0 & $1<>0.REAL 2;
  {p: P[p]} is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
  then reconsider K111={p: p`1/|.p.|<=cn & p`2<=0 & p<>0.REAL 2}
  as non empty Subset of TOP-REAL 2 by A16;
  defpred P[Point of TOP-REAL 2] means $1`1<=(cn)*(|.$1.|) & $1`2<=0;
  {p: P[p]} is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
  then reconsider K004={p: p`1<=(cn)*(|.p.|) & p`2<=0}
  as Subset of (TOP-REAL 2);
  the carrier of (TOP-REAL 2)|B0=the carrier of (TOP-REAL 2)|D;
  then
A17: dom f=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1
    .=K1 by PRE_TOPC:29;
  then
A18: dom (f|K00)=K00 by A11,RELAT_1:91
    .= the carrier of ((TOP-REAL 2)|K1)|K00 by PRE_TOPC:29;
  the carrier of (TOP-REAL 2)|D = D by PRE_TOPC:29;
  then rng (f|K00) c=D;
  then reconsider f1=f|K00 as Function of ((TOP-REAL 2)|K1)|K00,(TOP-REAL 2)|D
  by A18,FUNCT_2:4;
A19: dom f1=the carrier of ((TOP-REAL 2)|K1)|K00 by FUNCT_2:def 1
    .=K00 by PRE_TOPC:29;
A20: dom (cn-FanMorphS)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
  then
A21: dom ((cn-FanMorphS)|K001)=K001 by RELAT_1:91
    .= the carrier of (TOP-REAL 2)|K001 by PRE_TOPC:29;
A22: the carrier of (TOP-REAL 2)|K1 =K1 by PRE_TOPC:29;
  rng ((cn-FanMorphS)|K001) c= K1
  proof
    let y be set;
    assume y in rng ((cn-FanMorphS)|K001);
    then consider x being set such that
A23: x in dom ((cn-FanMorphS)|K001) & y=((cn-FanMorphS)|K001).x
    by FUNCT_1:def 5;
A24: dom ((cn-FanMorphS)|K001)=(dom (cn-FanMorphS))/\ K001 by FUNCT_1:68
      .=(the carrier of TOP-REAL 2)/\ K001 by FUNCT_2:def 1
      .=K001 by XBOOLE_1:28;
    reconsider q=x as Point of TOP-REAL 2 by A23;
A25: y=(cn-FanMorphS).q by A23,FUNCT_1:70;
    consider p2 being Point of TOP-REAL 2 such that
A26: p2=q & p2`1/|.p2.|>=cn & p2`2<=0 & p2<>0.REAL 2 by A23,A24;
A27: cn-FanMorphS.q= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
    |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by A1,A26,Th122;
    set q4= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
    |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]|;
    |.q.|<>0 by A26,TOPRNS_1:25;
    then
A28: (|.q.|)^2>0^2 by SQUARE_1:74;
A29: 1-cn>0 by A1,XREAL_1:151;
A30: q4`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))&
    q4`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by EUCLID:56;
A31: (q`1/|.q.|-cn)>= 0 by A26,XREAL_1:50;
    0<=(q`2)^2 by XREAL_1:65;
    then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
    then (q`1)^2 <= (|.q.|)^2 by JGRAPH_3:10;
    then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by XREAL_1:74;
    then (q`1)^2/(|.q.|)^2 <= 1 by A28,XCMPLX_1:60;
    then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
    then 1>=q`1/|.q.| by SQUARE_1:121;
    then
A32: 1-cn>=q`1/|.q.|-cn by XREAL_1:11;
A33: -(1-cn)<= -0 by A29;
    -(1-cn)<= -( q`1/|.q.|-cn) by A32,XREAL_1:26;
    then (-(1-cn))/(1-cn)<=(-( q`1/|.q.|-cn))/(1-cn) by A29,XREAL_1:74;
    then
A34: -1<=(-( q`1/|.q.|-cn))/(1-cn) by A29,XCMPLX_1:198;
    --(1-cn)>= -(q`1/|.q.|-cn) by A31,A33,XREAL_1:26;
    then (-(q`1/|.q.|-cn))/(1-cn)<=1 by A29,XREAL_1:187;
    then ((-(q`1/|.q.|-cn))/(1-cn))^2<=1^2 by A34,SQUARE_1:119;
    then
A35: 1-((-(q`1/|.q.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
    then
A36: 1-(-((q`1/|.q.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
    sqrt(1-((-(q`1/|.q.|-cn))/(1-cn))^2)>=0 by A35,SQUARE_1:def 4;
    then sqrt(1-(-(q`1/|.q.|-cn))^2/(1-cn)^2)>=0 by XCMPLX_1:77;
    then sqrt(1-(q`1/|.q.|-cn)^2/(1-cn)^2)>=0;
    then sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)>=0 by XCMPLX_1:77;
    then
A37: -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)<=0;
A38: (q4`2)^2= (|.q.|)^2*(sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))^2 by A30
      .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1-cn))^2) by A36,SQUARE_1:def 4;
    (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
      .=(|.q.|)^2 by A30,A38;
    then q4`2<=0^2 & q4<>0.REAL 2 by A28,A30,A37,TOPRNS_1:24
    ;
    hence y in K1 by A1,A25,A27;
  end;
  then reconsider f3=(cn-FanMorphS)|K001
  as Function of (TOP-REAL 2)|K001,(TOP-REAL 2)|K1 by A21,A22,FUNCT_2:4;
A39: dom (f|K11)=K11 by A14,A17,RELAT_1:91
    .= the carrier of ((TOP-REAL 2)|K1)|K11 by PRE_TOPC:29;
  the carrier of (TOP-REAL 2)|D = D by PRE_TOPC:29;
  then rng (f|K11) c=D;
  then reconsider f2=f|K11 as Function of ((TOP-REAL 2)|K1)|K11,(TOP-REAL 2)|D
  by A39,FUNCT_2:4;
A40: dom f2=the carrier of ((TOP-REAL 2)|K1)|K11 by FUNCT_2:def 1
    .=K11 by PRE_TOPC:29;
A41: dom ((cn-FanMorphS)|K111)=K111 by A20,RELAT_1:91
    .= the carrier of (TOP-REAL 2)|K111 by PRE_TOPC:29;
A42: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
  rng ((cn-FanMorphS)|K111) c= K1
  proof
    let y be set;
    assume y in rng ((cn-FanMorphS)|K111);
    then consider x being set such that
A43: x in dom ((cn-FanMorphS)|K111) & y=((cn-FanMorphS)|K111).x
    by FUNCT_1:def 5;
A44: dom ((cn-FanMorphS)|K111)=(dom (cn-FanMorphS))/\ K111 by FUNCT_1:68
      .=(the carrier of TOP-REAL 2)/\ K111 by FUNCT_2:def 1
      .=K111 by XBOOLE_1:28;
    reconsider q=x as Point of TOP-REAL 2 by A43;
A45: y=(cn-FanMorphS).q by A43,FUNCT_1:70;
    consider p2 being Point of TOP-REAL 2 such that
A46: p2=q & p2`1/|.p2.|<=cn & p2`2<=0 & p2<>0.REAL 2 by A43,A44;
A47: cn-FanMorphS.q= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
    |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]| by A1,A46,Th122;
    set q4= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
    |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]|;
    |.q.|<>0 by A46,TOPRNS_1:25;
    then
A48: (|.q.|)^2>0^2 by SQUARE_1:74;
A49: 1+cn>0 by A1,XREAL_1:150;
A50: q4`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))&
    q4`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by EUCLID:56;
A51: (q`1/|.q.|-cn)<=0 by A46,XREAL_1:49;
A52: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
    0<=(q`2)^2 by XREAL_1:65;
    then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
    then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A52,XREAL_1:74;
    then (q`1)^2/(|.q.|)^2 <= 1 by A48,XCMPLX_1:60;
    then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
    then -1<=q`1/|.q.| by SQUARE_1:121;
    then
A53: -1-cn<=q`1/|.q.|-cn by XREAL_1:11;
    (1+cn)/(1+cn)>=(q`1/|.q.|-cn)/(1+cn) by A49,A51,XREAL_1:74;
    then
A54: 1>=(q`1/|.q.|-cn)/(1+cn) by A49,XCMPLX_1:60;
    (-(1+cn))/(1+cn)<=(( q`1/|.q.|-cn))/(1+cn) by A49,A53,XREAL_1:74;
    then -1<=(( q`1/|.q.|-cn))/(1+cn) by A49,XCMPLX_1:198;
    then
A55: (((q`1/|.q.|-cn))/(1+cn))^2<=1^2 by A54,SQUARE_1:119;
    then
A56: 1-((q`1/|.q.|-cn)/(1+cn))^2>=0 by XREAL_1:50;
    1-(-((q`1/|.q.|-cn)/(1+cn)))^2>=0 by A55,XREAL_1:50;
    then 1-((-(q`1/|.q.|-cn))/(1+cn))^2>=0 by XCMPLX_1:188;
    then sqrt(1-((-(q`1/|.q.|-cn))/(1+cn))^2)>=0 by SQUARE_1:def 4;
    then sqrt(1-(-(q`1/|.q.|-cn))^2/(1+cn)^2)>=0 by XCMPLX_1:77;
    then sqrt(1-(q`1/|.q.|-cn)^2/(1+cn)^2)>=0;
    then sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)>=0 by XCMPLX_1:77;
    then -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)<=0;
    then
A57: q4`2<= 0 by A50;
A58: (q4`2)^2= (|.q.|)^2*(sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))^2 by A50
      .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1+cn))^2) by A56,SQUARE_1:def 4;
    (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
      .=(|.q.|)^2 by A50,A58;
    then q4<>0.REAL 2 by A48,TOPRNS_1:24;
    hence y in K1 by A1,A45,A47,A57;
  end;
  then reconsider f4=(cn-FanMorphS)|K111
  as Function of (TOP-REAL 2)|K111,(TOP-REAL 2)|K1 by A41,A42,FUNCT_2:4;
  set T1= ((TOP-REAL 2)|K1)|K00,T2=((TOP-REAL 2)|K1)|K11;
A59: [#](((TOP-REAL 2)|K1)|K00)=K00 by PRE_TOPC:def 10;
A60: [#](((TOP-REAL 2)|K1)|K11)=K11 by PRE_TOPC:def 10;
A61: [#]((TOP-REAL 2)|K1)=K1 by PRE_TOPC:def 10;
A62: K1 c= K00 \/ K11
  proof
    let x be set;
    assume x in K1;
    then consider p such that
A63: p=x & (p`2<=0 & p<>0.REAL 2) by A1;
    per cases;
    suppose p`1/|.p.|>=cn;
      then x in K00 by A63;
      hence x in K00 \/ K11 by XBOOLE_0:def 3;
    end;
    suppose p`1/|.p.|<cn;
      then x in K11 by A63;
      hence x in K00 \/ K11 by XBOOLE_0:def 3;
    end;
  end;
  then
A64: [#](((TOP-REAL 2)|K1)|K00) \/ [#](((TOP-REAL 2)|K1)|K11)
  =[#]((TOP-REAL 2)|K1) by A59,A60,A61,XBOOLE_0:def 10;
A65: K003 is closed by Th129;
A66: K003 /\ K1 c= K00
  proof
    let x be set;
    assume x in K003 /\ K1;
    then
A67: x in K003 & x in K1 by XBOOLE_0:def 4;
    then consider q1 being Point of TOP-REAL 2 such that
A68: q1=x & q1`1>=(cn)*(|.q1.|) & q1`2<=0;
    consider q2 being Point of TOP-REAL 2 such that
A69: q2=x & q2`2<=0 & q2<>0.REAL 2 by A1,A67;
    q1`1/|.q1.|>=(cn)*(|.q1.|)/|.q1.| by A68,XREAL_1:74;
    then q1`1/|.q1.|>=(cn) by A68,A69,TOPRNS_1:25,XCMPLX_1:90;
    hence x in K00 by A68,A69;
  end;
  K00 c= K003 /\ K1
  proof
    let x be set;
    assume x in K00;
    then consider p such that
A71: p=x & (p`1/|.p.|>=cn & p`2<=0 & p<>0.REAL 2);
    p`1/|.p.|*|.p.|>=(cn)*(|.p.|) by A71,XREAL_1:66;
    then p`1>=(cn)*(|.p.|) by A71,TOPRNS_1:25,XCMPLX_1:88;
    then
A72: x in K003 by A71;
    x in K1 by A1,A71;
    hence x in K003 /\ K1 by A72,XBOOLE_0:def 4;
  end;
  then K00=K003 /\ [#]((TOP-REAL 2)|K1) by A61,A66,XBOOLE_0:def 10;
  then
A73: K00 is closed by A65,PRE_TOPC:43;
A74: K004 is closed by Th130;
A75: K004 /\ K1 c= K11
  proof
    let x be set;
    assume x in K004 /\ K1;
    then
A76: x in K004 & x in K1 by XBOOLE_0:def 4;
    then consider q1 being Point of TOP-REAL 2 such that
A77: q1=x & q1`1<=(cn)*(|.q1.|) & q1`2<=0;
    consider q2 being Point of TOP-REAL 2 such that
A78: q2=x & q2`2<=0 & q2<>0.REAL 2 by A1,A76;
    q1`1/|.q1.|<=(cn)*(|.q1.|)/|.q1.| by A77,XREAL_1:74;
    then q1`1/|.q1.|<=(cn) by A77,A78,TOPRNS_1:25,XCMPLX_1:90;
    hence x in K11 by A77,A78;
  end;
  K11 c= K004 /\ K1
  proof
    let x be set;
    assume x in K11;
    then consider p such that
A80: p=x & (p`1/|.p.|<=cn & p`2<=0 & p<>0.REAL 2);
    p`1/|.p.|*|.p.|<=(cn)*(|.p.|) by A80,XREAL_1:66;
    then p`1<=(cn)*(|.p.|) by A80,TOPRNS_1:25,XCMPLX_1:88;
    then
A81: x in K004 by A80;
    x in K1 by A1,A80;
    hence x in K004 /\ K1 by A81,XBOOLE_0:def 4;
  end;
  then K11=K004 /\ [#]((TOP-REAL 2)|K1) by A61,A75,XBOOLE_0:def 10;
  then
A82: K11 is closed by A74,PRE_TOPC:43;
A83: ((TOP-REAL 2)|K1)|K00=(TOP-REAL 2)|K001 by GOBOARD9:4;
  K1 c= D
  proof
    let x be set;
    assume x in K1;
    then consider p6 being Point of TOP-REAL 2 such that
A84: p6=x & p6`2<=0 & p6<>0.REAL 2 by A1;
    x in the carrier of TOP-REAL 2 & not x in {0.REAL 2} by A84,TARSKI:def 1;
    hence x in D by A1,XBOOLE_0:def 5;
  end;
  then D=K1 \/ D by XBOOLE_1:12;
  then
A85: (TOP-REAL 2)|K1 is SubSpace of (TOP-REAL 2)|D by TOPMETR:5;
  the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
  then f1= f3 by A1,FUNCT_1:82;
  then
A86: f1 is continuous by A1,A83,A85,Th127,PRE_TOPC:56;
A87: ((TOP-REAL 2)|K1)|K11=(TOP-REAL 2)|K111 by GOBOARD9:4;
  the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
  then f2= f4 by A1,FUNCT_1:82;
  then
A88: f2 is continuous by A1,A85,A87,Th128,PRE_TOPC:56;
A89: D<>{};
  for p being set st p in ([#]T1)/\([#]T2) holds f1.p = f2.p
  proof
    let p be set;
    assume
A91: p in ([#]T1)/\([#]T2);
    then p in K00 & p in K11 by A59,A60,XBOOLE_0:def 4;
    hence f1.p=f.p by FUNCT_1:72
      .=f2.p by A60,A91,FUNCT_1:72;
  end;
  then consider h being Function of (TOP-REAL 2)|K1,(TOP-REAL 2)|D such that
A92: h=f1+*f2 & h is continuous by A59,A60,A64,A73,A82,A86,A88,JGRAPH_2:9;
A93: dom h=the carrier of ((TOP-REAL 2)|K1) by FUNCT_2:def 1;
A94: the carrier of ((TOP-REAL 2)|K1)=K0 by PRE_TOPC:29;
A95: K0=the carrier of ((TOP-REAL 2)|K0) by PRE_TOPC:29
    .=dom f by A89,FUNCT_2:def 1;
  for y being set st y in dom h holds h.y=f.y
  proof
    let y be set;
    assume
A96: y in dom h;
    per cases by A62,A93,A94,A96,XBOOLE_0:def 3;
    suppose
A97:  y in K00 & not y in K11;
      then y in dom f1 \/ dom f2 by A19,XBOOLE_0:def 3;
      hence h.y=f1.y by A40,A92,A97,FUNCT_4:def 1
        .=f.y by A97,FUNCT_1:72;
    end;
    suppose
A98:  y in K11;
      then y in dom f1 \/ dom f2 by A40,XBOOLE_0:def 3;
      hence h.y=f2.y by A40,A92,A98,FUNCT_4:def 1
        .=f.y by A98,FUNCT_1:72;
    end;
  end;
  hence thesis by A92,A93,A94,A95,FUNCT_1:9;
end;

theorem Th132:
  for cn being Real, K0,B0 being Subset of TOP-REAL 2,
  f being Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0 st
  -1<cn & cn<1 & f=(cn-FanMorphS)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} & K0={p: p`2>=0 & p<>0.REAL 2}
  holds f is continuous
proof
  let cn be Real,K0,B0 be Subset of TOP-REAL 2,f be
  Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0;
  assume
A1: -1<cn & cn<1 & f=(cn-FanMorphS)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} & K0={p: p`2>=0 & p<>0.REAL 2};
  set sn=sqrt(1-cn^2);
  set p0=|[cn,sn]|;
A2: p0`2=sn by EUCLID:56;
  cn^2<1^2 by A1,SQUARE_1:120;
  then
A3: 1-cn^2>0 by XREAL_1:52;
  then
A4: sn>0 by SQUARE_1:93;
A5: p0`2>0 by A2,A3,SQUARE_1:93;
  p0 in K0 by A1,A2,A4,JGRAPH_2:11;
  then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
  p0 in the carrier of TOP-REAL 2 & not p0 in {0.REAL 2}
  by A5,JGRAPH_2:11,TARSKI:def 1;
  then reconsider D=B0 as non empty Subset of TOP-REAL 2 by A1,XBOOLE_0:def 5;
A6: K1 c= D
  proof
    let x be set;
    assume x in K1;
    then consider p2 being Point of TOP-REAL 2 such that
A7: p2=x & p2`2>=0 & p2<>0.REAL 2 by A1;
    not p2 in {0.REAL 2} by A7,TARSKI:def 1;
    hence x in D by A1,A7,XBOOLE_0:def 5;
  end;
  for p being Point of (TOP-REAL 2)|K1,V being Subset of (TOP-REAL 2)|D
  st f.p in V & V is open holds ex W being Subset of (TOP-REAL 2)|K1 st
  p in W & W is open & f.:W c= V
  proof
    let p be Point of (TOP-REAL 2)|K1,V be Subset of (TOP-REAL 2)|D;
    assume
A8: f.p in V & V is open;
    then consider V2 being Subset of TOP-REAL 2 such that
A9: V2 is open & V2 /\ [#]((TOP-REAL 2)|D)=V by TOPS_2:32;
A10: p in the carrier of (TOP-REAL 2)|K1;
A11: [#]((TOP-REAL 2)|K1)=K1 by PRE_TOPC:def 10;
    reconsider W2=V2 /\ [#]((TOP-REAL 2)|K1) as Subset of (TOP-REAL 2)| K1;
A12: W2 is open by A9,TOPS_2:32;
A13: f.p=(cn-FanMorphS).p by A1,A11,FUNCT_1:72;
    consider q being Point of TOP-REAL 2 such that
A14: q=p & q`2>=0 & q <>0.REAL 2 by A1,A10,A11;
    (cn-FanMorphS).q=q by A14,Th120;
    then p in V2 & p in [#]((TOP-REAL 2)|D) by A8,A9,A13,A14,XBOOLE_0:def 4;
    then
A15: p in W2 by XBOOLE_0:def 4;
    f.:W2 c= V
    proof
      let y be set;
      assume y in f.:W2;
      then consider x being set such that
A16:  x in dom f & x in W2 & y=f.x by FUNCT_1:def 12;
      f is Function of (TOP-REAL 2)|K1,(TOP-REAL 2)|D;
      then dom f= K1 by A11,FUNCT_2:def 1;
      then consider p4 being Point of TOP-REAL 2 such that
A17:  x=p4 & p4`2>=0 & p4<>0.REAL 2 by A1,A16;
A18:  f.p4=(cn-FanMorphS).p4 by A1,A11,A16,A17,FUNCT_1:72
        .=p4 by A17,Th120;
A19:  p4 in V2 & p4 in [#]((TOP-REAL 2)|K1) by A16,A17,XBOOLE_0:def 4;
      then p4 in D by A6,A11;
      then p4 in [#]((TOP-REAL 2)|D) by PRE_TOPC:def 10;
      hence y in V by A9,A16,A17,A18,A19,XBOOLE_0:def 4;
    end;
    hence ex W being Subset of (TOP-REAL 2)|K1 st
    p in W & W is open & f.:W c= V by A12,A15;
  end;
  hence f is continuous by JGRAPH_2:20;
end;

theorem Th133:
  for cn being Real, B0 being Subset of TOP-REAL 2,K0 being Subset of
  (TOP-REAL 2)|B0,f being Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0)
  st -1<cn & cn<1 & f=(cn-FanMorphS)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} & K0={p: p`2<=0 & p<>0.REAL 2}
  holds f is continuous
proof
  let cn be Real, B0 be Subset of TOP-REAL 2,K0 be Subset of
  (TOP-REAL 2)|B0,f be Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0);
  assume
A1: -1<cn & cn<1 & f=(cn-FanMorphS)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} & K0={p: p`2<=0 & p<>0.REAL 2 };
  the carrier of (TOP-REAL 2)|B0= B0 by PRE_TOPC:29;
  then reconsider K1=K0 as Subset of TOP-REAL 2 by XBOOLE_1:1;
  K0 c= B0
  proof
    let x be set;
    assume x in K0;
    then consider p8 being Point of TOP-REAL 2 such that
A2: x=p8 & (p8`2<=0 & p8<>0.REAL 2) by A1;
    not x in {0.REAL 2} by A2,TARSKI:def 1;
    hence x in B0 by A1,A2,XBOOLE_0:def 5;
  end;
  then ((TOP-REAL 2)|B0)|K0=(TOP-REAL 2)|K1 by PRE_TOPC:28;
  hence f is continuous by A1,Th131;
end;

theorem Th134:
  for cn being Real, B0 being Subset of TOP-REAL 2,K0 being Subset of
  (TOP-REAL 2)|B0,f being Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0)
  st -1<cn & cn<1 & f=(cn-FanMorphS)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} & K0={p: p`2>=0 & p<>0.REAL 2}
  holds f is continuous
proof
  let cn be Real, B0 be Subset of TOP-REAL 2,K0 be Subset of
  (TOP-REAL 2)|B0,f be Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0);
  assume
A1: -1<cn & cn<1 & f=(cn-FanMorphS)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} & K0={p: p`2>=0 & p<>0.REAL 2};
  the carrier of (TOP-REAL 2)|B0=B0 by PRE_TOPC:29;
  then reconsider K1=K0 as Subset of TOP-REAL 2 by XBOOLE_1:1;
  K0 c= B0
  proof
    let x be set;
    assume x in K0;
    then consider p8 being Point of TOP-REAL 2 such that
A2: x=p8 & (p8`2>=0 & p8<>0.REAL 2) by A1;
    not x in {0.REAL 2} by A2,TARSKI:def 1;
    hence x in B0 by A1,A2,XBOOLE_0:def 5;
  end;
  then ((TOP-REAL 2)|B0)|K0=(TOP-REAL 2)|K1 by PRE_TOPC:28;
  hence f is continuous by A1,Th132;
end;

theorem Th135:
  for cn being Real,p being Point of TOP-REAL 2
  holds |.(cn-FanMorphS).p.|=|.p.|
proof
  let cn be Real,p be Point of TOP-REAL 2;
  set f=cn-FanMorphS;
  set z=f.p;
  set q=p;
  reconsider qz=z as Point of TOP-REAL 2;
  per cases;
  suppose
A1: q`1/|.q.|>=cn & q`2<0;
    then (cn-FanMorphS).q= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
    |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by Th120;
    then
A2: qz`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))&
    qz`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by EUCLID:56;
    |.q.|<>0 by A1,JGRAPH_2:11,TOPRNS_1:25;
    then
A3: (|.q.|)^2>0 by SQUARE_1:74;
A4: (q`1/|.q.|-cn)>=0 by A1,XREAL_1:50;
A5: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
    0<=(q`2)^2 by XREAL_1:65;
    then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
    then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A5,XREAL_1:74;
    then (q`1)^2/(|.q.|)^2 <= 1 by A3,XCMPLX_1:60;
    then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
    then 1>=q`1/|.q.| by SQUARE_1:121;
    then
A6: 1-cn>=q`1/|.q.|-cn by XREAL_1:11;
    per cases;
    suppose
A7:   1-cn=0;
A8:   ((q`1/|.q.|-cn)/(1-cn))=(q`1/|.q.|-cn)*(1-cn)" by XCMPLX_0:def 9
        .= (q`1/|.q.|-cn)*0 by A7
        .=0;
      then 1-((q`1/|.q.|-cn)/(1-cn))^2=1;
      then (cn-FanMorphS).q= |[ |.q.|*0,|.q.|*(-1)]| by A1,A8,Th120,SQUARE_1:83
        .=|[0,-(|.q.|)]|;
      then ((cn-FanMorphS).q)`2=(- |.q.|) & ((cn-FanMorphS).q)`1=0
      by EUCLID:56;
      then |.(cn-FanMorphS).p.|=sqrt((-(|.q.|))^2+0^2) by JGRAPH_3:10
        .=sqrt(((|.q.|))^2)
        .=|.q.| by SQUARE_1:89;
      hence |.(cn-FanMorphS).p.|=|.p.|;
    end;
    suppose
A9:   1-cn<>0;
      per cases by A9;
      suppose
A10:    1-cn>0;
        then
A11:    -(1-cn)<= -0;
        -(1-cn)<= -( q`1/|.q.|-cn) by A6,XREAL_1:26;
        then (-(1-cn))/(1-cn)<=(-( q`1/|.q.|-cn))/(1-cn) by A10,XREAL_1:74;
        then
A12:    -1<=(-( q`1/|.q.|-cn))/(1-cn) by A10,XCMPLX_1:198;
        --(1-cn)>= -(q`1/|.q.|-cn) by A4,A11,XREAL_1:26;
        then (-(q`1/|.q.|-cn))/(1-cn)<=1 by A10,XREAL_1:187;
        then ((-(q`1/|.q.|-cn))/(1-cn))^2<=1^2 by A12,SQUARE_1:119;
        then 1-((-(q`1/|.q.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
        then
A13:    1-(-((q`1/|.q.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
A14:    (qz`2)^2= (|.q.|)^2*(sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))^2 by A2
          .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1-cn))^2) by A13,SQUARE_1:def 4;
        (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
          .=(|.q.|)^2 by A2,A14;
        then sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
        hence |.(cn-FanMorphS).p.|=|.p.| by SQUARE_1:89;
      end;
      suppose
A15:    1-cn<0;
A16:    q`1/|.q.|-cn>=0 by A1,XREAL_1:50;
        0+(q`1)^2<(q`1)^2+(q`2)^2 by A1,SQUARE_1:74,XREAL_1:10;
        then (q`1)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A3,A5,XREAL_1:76;
        then (q`1)^2/(|.q.|)^2 < 1 by A3,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 < 1 by XCMPLX_1:77;
        then 1 > q`1/|.p.| by SQUARE_1:122;
        hence |.(cn-FanMorphS).p.|=|.p.| by A15,A16,XREAL_1:11;
      end;
    end;
  end;
  suppose
A17: q`1/|.q.|<cn & q`2<0;
    then
A18: (cn-FanMorphS).q= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
    |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]| by Th121;
    then
A19: qz`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))&
    qz`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by EUCLID:56;
    |.q.|<>0 by A17,JGRAPH_2:11,TOPRNS_1:25;
    then
A20: (|.q.|)^2>0 by SQUARE_1:74;
A21: (q`1/|.q.|-cn)<0 by A17,XREAL_1:51;
A22: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
    0<=(q`2)^2 by XREAL_1:65;
    then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
    then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A22,XREAL_1:74;
    then (q`1)^2/(|.q.|)^2 <= 1 by A20,XCMPLX_1:60;
    then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
    then -1<=q`1/|.q.| by SQUARE_1:121;
    then
A23: -1-cn<=q`1/|.q.|-cn by XREAL_1:11;
    per cases;
    suppose
A24:  1+cn=0;
      ((q`1/|.q.|-cn)/(1+cn))=(q`1/|.q.|-cn)*(1+cn)" by XCMPLX_0:def 9
        .= (q`1/|.q.|-cn)*0 by A24
        .=0;
      then ((cn-FanMorphS).q)`2=-(|.q.|) & ((cn-FanMorphS).q)`1=0
      by A18,EUCLID:56,SQUARE_1:83;
      then |.(cn-FanMorphS).p.|=sqrt((-(|.q.|))^2+0^2) by JGRAPH_3:10
        .=sqrt(((|.q.|))^2)
        .=|.q.| by SQUARE_1:89;
      hence |.(cn-FanMorphS).p.|=|.p.|;
    end;
    suppose
A25:  1+cn<>0;
      per cases by A25;
      suppose
A26:    1+cn>0;
        then (-(1+cn))/(1+cn)<=(( q`1/|.q.|-cn))/(1+cn) by A23,XREAL_1:74;
        then
A27:    -1<=(( q`1/|.q.|-cn))/(1+cn) by A26,XCMPLX_1:198;
        ((q`1/|.q.|-cn))/(1+cn)<=1 by A21,A26;
        then (((q`1/|.q.|-cn))/(1+cn))^2<=1^2 by A27,SQUARE_1:119;
        then
A28:    1-(((q`1/|.q.|-cn))/(1+cn))^2>=0 by XREAL_1:50;
A29:    (qz`2)^2= (|.q.|)^2*(sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))^2 by A19
          .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1+cn))^2) by A28,SQUARE_1:def 4;
        (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
          .=(|.q.|)^2 by A19,A29;
        then sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
        hence |.(cn-FanMorphS).p.|=|.p.| by SQUARE_1:89;
      end;
      suppose 1+cn<0;
        then
A30:    -(1+cn)>-0 by XREAL_1:26;
        0+(q`1)^2<(q`1)^2+(q`2)^2 by A17,SQUARE_1:74,XREAL_1:10;
        then (q`1)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A20,A22,XREAL_1:76;
        then (q`1)^2/(|.q.|)^2 < 1 by A20,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 < 1 by XCMPLX_1:77;
        then -1 < q`1/|.p.| by SQUARE_1:122;
        then q`1/|.q.|-cn>-1-cn by XREAL_1:11;
        hence |.(cn-FanMorphS).p.|=|.p.| by A17,A30,XREAL_1:51;
      end;
    end;
  end;
  suppose q`2>=0;
    hence |.(cn-FanMorphS).p.|=|.p.| by Th120;
  end;
end;

theorem Th136:
  for cn being Real,x,K0 being set st -1<cn & cn<1 & x in K0 &
  K0={p: p`2<=0 & p<>0.REAL 2} holds (cn-FanMorphS).x in K0
proof
  let cn be Real,x,K0 be set;
  assume
A1: -1<cn & cn<1 & x in K0 & K0={p: p`2<=0 & p<>0.REAL 2};
  then consider p such that
A2: p=x & p`2<=0 & p<>0.REAL 2;
A3: now
    assume |.p.|<=0;
    then |.p.|=0;
    hence contradiction by A2,TOPRNS_1:25;
  end;
  then
A4: (|.p.|)^2>0 by SQUARE_1:74;
  per cases;
  suppose
A5: p`1/|.p.|<=cn;
    then
A6: (cn-FanMorphS).p= |[ |.p.|*((p`1/|.p.|-cn)/(1+cn)),
    |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]| by A1,A2,Th122;
    reconsider p9= (cn-FanMorphS).p as Point of TOP-REAL 2;
A7: p9`2=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)) by A6,EUCLID:56;
A8: 1+cn>0 by A1,XREAL_1:150;
A9: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
    per cases;
    suppose p`2=0;
      hence (cn-FanMorphS).x in K0 by A1,A2,Th120;
    end;
    suppose p`2<>0;
      then 0+(p`1)^2<(p`1)^2+(p`2)^2 by SQUARE_1:74,XREAL_1:10;
      then (p`1)^2/(|.p.|)^2 < (|.p.|)^2/(|.p.|)^2 by A4,A9,XREAL_1:76;
      then (p`1)^2/(|.p.|)^2 < 1 by A4,XCMPLX_1:60;
      then
A10:  ((p`1)/|.p.|)^2 < 1 by XCMPLX_1:77;
      p`1/|.p.|-cn<=0 by A5,XREAL_1:49;
      then
A11:  (p`1/|.p.|-cn)/(1+cn)<(1+cn)/(1+cn) by A8,XREAL_1:76;
      -1 < p`1/|.p.| by A10,SQUARE_1:122;
      then -1-cn< p`1/|.p.|-cn by XREAL_1:11;
      then (-1)*(1+cn)/(1+cn)< (p`1/|.p.|-cn)/(1+cn) by A8,XREAL_1:76;
      then -1< (p`1/|.p.|-cn)/(1+cn) & (p`1/|.p.|-cn)/(1+cn)<1
      by A8,A11,XCMPLX_1:60,90;
      then 1^2> ((p`1/|.p.|-cn)/(1+cn))^2 by SQUARE_1:120;
      then 1-((p`1/|.p.|-cn)/(1+cn))^2>0 by XREAL_1:52;
      then --sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)>0 by SQUARE_1:93;
      then -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)<0;
      then |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))<0 by A3,XREAL_1:134;
      hence (cn-FanMorphS).x in K0 by A1,A2,A7,JGRAPH_2:11;
    end;
  end;
  suppose
A12: p`1/|.p.|>cn;
    then
A13: (cn-FanMorphS).p= |[ |.p.|*((p`1/|.p.|-cn)/(1-cn)),
    |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]| by A1,A2,Th122;
    reconsider p9= (cn-FanMorphS).p as Point of TOP-REAL 2;
A14: p9`2=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)) by A13,EUCLID:56;
A15: 1-cn>0 by A1,XREAL_1:151;
A16: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
    per cases;
    suppose p`2=0;
      hence (cn-FanMorphS).x in K0 by A1,A2,Th120;
    end;
    suppose p`2<>0;
      then 0+(p`1)^2<(p`1)^2+(p`2)^2 by SQUARE_1:74,XREAL_1:10;
      then (p`1)^2/(|.p.|)^2 < (|.p.|)^2/(|.p.|)^2 by A4,A16,XREAL_1:76;
      then (p`1)^2/(|.p.|)^2 < 1 by A4,XCMPLX_1:60;
      then ((p`1)/|.p.|)^2 < 1 by XCMPLX_1:77;
      then p`1/|.p.|<1 by SQUARE_1:122;
      then (p`1/|.p.|-cn)<1-cn by XREAL_1:11;
      then
A17:  (p`1/|.p.|-cn)/(1-cn)<(1-cn)/(1-cn) by A15,XREAL_1:76;
A18:  -(1-cn)< -0 by A15,XREAL_1:26;
      p`1/|.p.|-cn>=cn-cn by A12,XREAL_1:11;
      then (-1)*(1-cn)/(1-cn)< (p`1/|.p.|-cn)/(1-cn) by A15,A18,XREAL_1:76;
      then -1< (p`1/|.p.|-cn)/(1-cn) & (p`1/|.p.|-cn)/(1-cn)<1
      by A15,A17,XCMPLX_1:60,90;
      then 1^2> ((p`1/|.p.|-cn)/(1-cn))^2 by SQUARE_1:120;
      then 1-((p`1/|.p.|-cn)/(1-cn))^2>0 by XREAL_1:52;
      then --sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)>0 by SQUARE_1:93;
      then -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)<0;
      then p9`2<0 by A3,A14,XREAL_1:134;
      hence (cn-FanMorphS).x in K0 by A1,A2,JGRAPH_2:11;
    end;
  end;
end;

theorem Th137:
  for cn being Real,x,K0 being set st -1<cn & cn<1 & x in K0 &
  K0={p: p`2>=0 & p<>0.REAL 2} holds (cn-FanMorphS).x in K0
proof
  let cn be Real,x,K0 be set;
  assume
A1: -1<cn & cn<1 & x in K0 & K0={p: p`2>=0 & p<>0.REAL 2};
  then consider p such that
A2: p=x & p`2>=0 & p<>0.REAL 2;
  thus (cn-FanMorphS).x in K0 by A1,A2,Th120;
end;

theorem Th138:
  for cn being Real, D being non empty Subset of TOP-REAL 2
  st -1<cn & cn<1 & D`={0.REAL 2} holds
  ex h being Function of (TOP-REAL 2)|D,(TOP-REAL 2)|D
  st h=(cn-FanMorphS)|D & h is continuous
proof
  let cn be Real,D be non empty Subset of TOP-REAL 2;
  assume
A1: -1<cn & cn<1 & D`={0.REAL 2};
  reconsider B0= {0.REAL 2} as Subset of TOP-REAL 2;
A2: D =B0` by A1
    .=((the carrier of TOP-REAL 2)\ {0.REAL 2}) by SUBSET_1:def 5;
  defpred P[Point of TOP-REAL 2] means $1`2<=0;
A3: {p: P[p] & p<>0.REAL 2} c= the carrier of (TOP-REAL 2)|D from InclSub(A2);
A4: (|[0,-1]|)`1=0 & (|[0,-1]|)`2=-1 by EUCLID:56;
  |[0,-1]|<>0.REAL 2 by EUCLID:56,JGRAPH_2:11;
  then |[0,-1]| in {p where p is Point of TOP-REAL 2:
  p`2<=0 & p<>0.REAL 2} by A4;
  then reconsider K0={p:p`2<=0 & p<>0.REAL 2}
  as non empty Subset of (TOP-REAL 2)|D by A3;
  defpred P[Point of TOP-REAL 2] means $1`2>=0;
A5: {p: P[p] & p<>0.REAL 2} c= the carrier of (TOP-REAL 2)|D from InclSub(A2);
  set Y1=|[0,1]|;
  Y1`1=0 & Y1`2=1 by EUCLID:56;
  then Y1 in {p where p is Point of TOP-REAL 2:
  p`2>=0 & p<>0.REAL 2} by JGRAPH_2:11;
  then reconsider K1={p: p`2>=0 & p<>0.REAL 2}
  as non empty Subset of (TOP-REAL 2)|D by A5;
A6: the carrier of ((TOP-REAL 2)|D) =D by PRE_TOPC:29;
A7: K0 c= (the carrier of TOP-REAL 2)
  proof
    let z be set;
    assume z in K0;
    then consider p8 being Point of TOP-REAL 2 such that
A8: p8=z & p8`2<=0 & p8<>0.REAL 2;
    thus z in (the carrier of TOP-REAL 2) by A8;
  end;
A9: dom ((cn-FanMorphS)|K0)= dom ((cn-FanMorphS)) /\ K0 by FUNCT_1:68
    .=((the carrier of TOP-REAL 2)) /\ K0 by FUNCT_2:def 1
    .=K0 by A7,XBOOLE_1:28;
A10: K0=the carrier of ((TOP-REAL 2)|D)|K0 by PRE_TOPC:29;
  rng ((cn-FanMorphS)|K0) c= the carrier of ((TOP-REAL 2)|D)|K0
  proof
    let y be set;
    assume y in rng ((cn-FanMorphS)|K0);
    then consider x being set such that
A11: x in dom ((cn-FanMorphS)|K0) & y=((cn-FanMorphS)|K0).x by FUNCT_1:def 5;
    x in (dom (cn-FanMorphS)) /\ K0 by A11,FUNCT_1:68;
    then
A12: x in K0 by XBOOLE_0:def 4;
    K0 c= the carrier of TOP-REAL 2 by A6,XBOOLE_1:1;
    then reconsider p=x as Point of TOP-REAL 2 by A12;
    (cn-FanMorphS).p=y by A11,A12,FUNCT_1:72;
    then y in K0 by A1,A12,Th136;
    hence y in the carrier of ((TOP-REAL 2)|D)|K0 by PRE_TOPC:29;
  end;
  then reconsider f=(cn-FanMorphS)|K0 as Function of ((TOP-REAL 2)|D)|K0,
  ((TOP-REAL 2)|D) by A9,A10,FUNCT_2:4,XBOOLE_1:1;
A13: K1 c= (the carrier of TOP-REAL 2)
  proof
    let z be set;
    assume z in K1;
    then consider p8 being Point of TOP-REAL 2 such that
A14: p8=z & p8`2>=0 & p8<>0.REAL 2;
    thus z in (the carrier of TOP-REAL 2) by A14;
  end;
A15: dom ((cn-FanMorphS)|K1)= dom ((cn-FanMorphS)) /\ K1 by FUNCT_1:68
    .=((the carrier of TOP-REAL 2)) /\ K1 by FUNCT_2:def 1
    .=K1 by A13,XBOOLE_1:28;
A16: K1=the carrier of ((TOP-REAL 2)|D)|K1 by PRE_TOPC:29;
  rng ((cn-FanMorphS)|K1) c= the carrier of ((TOP-REAL 2)|D)|K1
  proof
    let y be set;
    assume y in rng ((cn-FanMorphS)|K1);
    then consider x being set such that
A17: x in dom ((cn-FanMorphS)|K1) & y=((cn-FanMorphS)|K1).x by FUNCT_1:def 5;
    x in (dom (cn-FanMorphS)) /\ K1 by A17,FUNCT_1:68;
    then
A18: x in K1 by XBOOLE_0:def 4;
    K1 c= the carrier of TOP-REAL 2 by A6,XBOOLE_1:1;
    then reconsider p=x as Point of TOP-REAL 2 by A18;
    (cn-FanMorphS).p=y by A17,A18,FUNCT_1:72;
    then y in K1 by A1,A18,Th137;
    hence y in the carrier of ((TOP-REAL 2)|D)|K1 by PRE_TOPC:29;
  end;
  then reconsider g=(cn-FanMorphS)|K1 as Function of ((TOP-REAL 2)|D)|K1,
  ((TOP-REAL 2)|D) by A15,A16,FUNCT_2:4,XBOOLE_1:1;
A19: K0=[#](((TOP-REAL 2)|D)|K0) by PRE_TOPC:def 10;
A20: K1=[#](((TOP-REAL 2)|D)|K1) by PRE_TOPC:def 10;
A21: D= [#]((TOP-REAL 2)|D) by PRE_TOPC:def 10;
  D c= K0 \/ K1
  proof
    let x be set;
    assume
A22: x in D;
    then
A23: x in (the carrier of TOP-REAL 2) & not x in {0.REAL 2}
    by A2,XBOOLE_0:def 5;
    reconsider px=x as Point of TOP-REAL 2 by A22;
    px`2>=0 & px<>0.REAL 2 or px`2<=0 & px<>0.REAL 2 by A23,TARSKI:def 1;
    then x in K1 or x in K0;
    hence x in K0 \/ K1 by XBOOLE_0:def 3;
  end;
  then
A24: ([#](((TOP-REAL 2)|D)|K0)) \/ ([#](((TOP-REAL 2)|D)|K1))
  = [#]((TOP-REAL 2)|D) by A19,A20,A21,XBOOLE_0:def 10;
A25: f is continuous & K0 is closed by A1,A2,Th70,Th133;
A26: g is continuous & K1 is closed by A1,A2,Th69,Th134;
A27: for x be set st x in ([#]((((TOP-REAL 2)|D)|K0)))
  /\ ([#] ((((TOP-REAL 2)|D)|K1))) holds f.x = g.x
  proof
    let x be set;
    assume
A28: x in ([#]((((TOP-REAL 2)|D)|K0))) /\ ([#] ((((TOP-REAL 2)|D)|K1)));
    then x in K0 & x in K1 by A19,A20,XBOOLE_0:def 4;
    then f.x=(cn-FanMorphS).x by FUNCT_1:72;
    hence f.x = g.x by A20,A28,FUNCT_1:72;
  end;
  then consider h being Function of (TOP-REAL 2)|D,(TOP-REAL 2)|D such that
A29: h= f+*g & h is continuous by A19,A20,A24,A25,A26,JGRAPH_2:9;
A30: dom h=the carrier of ((TOP-REAL 2)|D) by FUNCT_2:def 1;
A31: the carrier of ((TOP-REAL 2)|D)=D by PRE_TOPC:29;
A32: the carrier of ((TOP-REAL 2)|D)
  =((the carrier of TOP-REAL 2)\ {0.REAL 2}) by A2,PRE_TOPC:29;
  dom (cn-FanMorphS)=(the carrier of (TOP-REAL 2)) by FUNCT_2:def 1;
  then
A33: dom ((cn-FanMorphS)|D)=(the carrier of (TOP-REAL 2))/\ D by FUNCT_1:68
    .=the carrier of ((TOP-REAL 2)|D) by A31,XBOOLE_1:28;
A34: dom f=K0 by A10,FUNCT_2:def 1;
A35: K0=[#](((TOP-REAL 2)|D)|K0) by PRE_TOPC:def 10;
A36: dom g=K1 by A16,FUNCT_2:def 1;
  K1=[#](((TOP-REAL 2)|D)|K1) by PRE_TOPC:def 10;
  then
A37: f tolerates g by A27,A34,A35,A36,PARTFUN1:def 6;
  for x being set st x in dom h holds h.x=((cn-FanMorphS)|D).x
  proof
    let x be set;
    assume
A38: x in dom h;
    then x in (the carrier of TOP-REAL 2) & not x in {0.REAL 2}
    by A2,A31,XBOOLE_0:def 5;
    then
A39: x <>0.REAL 2 by TARSKI:def 1;
    reconsider p=x as Point of TOP-REAL 2 by A32,A38,XBOOLE_0:def 5;
    per cases;
    suppose
A40:  x in K0;
A41:  (cn-FanMorphS)|D.p=(cn-FanMorphS).p by A31,A38,FUNCT_1:72
        .=f.p by A40,FUNCT_1:72;
      h.p=(g+*f).p by A29,A37,FUNCT_4:35
        .=f.p by A34,A40,FUNCT_4:14;
      hence h.x=(cn-FanMorphS)|D.x by A41;
    end;
    suppose not x in K0;
      then not p`2<=0 by A39;
      then
A42:  x in K1 by A39;
      (cn-FanMorphS)|D.p=(cn-FanMorphS).p by A31,A38,FUNCT_1:72
        .=g.p by A42,FUNCT_1:72;
      hence h.x=(cn-FanMorphS)|D.x by A29,A36,A42,FUNCT_4:14;
    end;
  end;
  then f+*g=(cn-FanMorphS)|D by A29,A30,A33,FUNCT_1:9;
  hence thesis by A19,A20,A24,A25,A26,A27,JGRAPH_2:9;
end;

theorem Th139:
  for cn being Real st -1<cn & cn<1 holds cn-FanMorphS is continuous
proof
  let cn be Real;
  assume
A1: -1<cn & cn<1;
  reconsider f=cn-FanMorphS as Function of TOP-REAL 2,TOP-REAL 2;
  reconsider D=(the carrier of TOP-REAL 2) \{0.REAL 2}
  as non empty Subset of TOP-REAL 2 by JGRAPH_2:19;
A2: f.(0.REAL 2)=0.REAL 2 by Th120,JGRAPH_2:11;
A3: D`= {0.REAL 2} by JGRAPH_3:30;
A4: for p being Point of (TOP-REAL 2)|D holds f.p<>f.(0.REAL 2)
  proof
    let p be Point of (TOP-REAL 2)|D;
A5: [#]((TOP-REAL 2)|D)=D by PRE_TOPC:def 10;
    then
A6: p in the carrier of TOP-REAL 2 & not p in {0.REAL 2} by XBOOLE_0:def 5;
    reconsider q=p as Point of TOP-REAL 2 by A5,XBOOLE_0:def 5;
A7: p<>0.REAL 2 by A6,TARSKI:def 1;
    per cases;
    suppose
A8:   q`1/|.q.|>=cn & q`2<=0;
      set q9= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
      |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]|;
A9:   q9`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)) &
      q9`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by EUCLID:56;
      now
        assume
A10:    q9=0.REAL 2;
A11:    |.q.|<>0^2 by A7,TOPRNS_1:25;
        then -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)= -sqrt(1-0) by A9,A10,
JGRAPH_2:11,XCMPLX_1:6
          .=-1 by SQUARE_1:83;
        hence contradiction by A9,A10,A11,JGRAPH_2:11,XCMPLX_1:6;
      end;
      hence f.p<>f.(0.REAL 2) by A1,A2,A7,A8,Th122;
    end;
    suppose
A12:  q`1/|.q.|<cn & q`2<=0;
      set q9=|[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
      |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]|;
A13:  q9`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)) &
      q9`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by EUCLID:56;
      now
        assume
A14:    q9=0.REAL 2;
A15:    |.q.|<>0^2 by A7,TOPRNS_1:25;
        then -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)= -sqrt(1-0) by A13,A14,
JGRAPH_2:11,XCMPLX_1:6
          .=-1 by SQUARE_1:83;
        hence contradiction by A13,A14,A15,JGRAPH_2:11,XCMPLX_1:6;
      end;
      hence f.p<>f.(0.REAL 2) by A1,A2,A7,A12,Th122;
    end;
    suppose q`2>0;
      then f.p=p by Th120;
      hence f.p<>f.(0.REAL 2) by A7,Th120,JGRAPH_2:11;
    end;
  end;
A16: ex h being Function of (TOP-REAL 2)|D,(TOP-REAL 2)|D
  st h=(cn-FanMorphS)|D & h is continuous by A1,A3,Th138;
  for V being Subset of (TOP-REAL 2) st f.(0.REAL 2) in V & V is open
  ex W being Subset of (TOP-REAL 2) st 0.REAL 2 in W & W is open & f.:W c= V
  proof
    let V be Subset of TOP-REAL 2;
    assume
A17: f.(0.REAL 2) in V & V is open;
    reconsider u0=0.REAL 2 as Point of Euclid 2;
    consider r being real number such that
A18: r>0 & Ball(u0,r) c= V by A2,A17,TOPMETR:22;
    reconsider r as Real by XREAL_0:def 1;
    reconsider W1=Ball(u0,r) as Subset of TOP-REAL 2;
A19: u0 in W1 by A18,GOBOARD6:4;
A20: W1 is open by GOBOARD6:6;
    f.:W1 c= W1
    proof
      let z be set;
      assume z in f.:W1;
      then consider y being set such that
A21:  y in dom f & y in W1 & z=f.y by FUNCT_1:def 12;
      reconsider q=y as Point of TOP-REAL 2 by A21;
      reconsider qy=q as Point of Euclid 2;
      z in rng f by A21,FUNCT_1:def 5;
      then reconsider qz=z as Point of TOP-REAL 2;
      reconsider pz=qz as Point of Euclid 2;
      dist(u0,qy)<r by A21,METRIC_1:12;
      then
A22:  |.(0.REAL 2) - q.|<r by JGRAPH_1:45;
      per cases by JGRAPH_2:11;
      suppose q`2>=0;
        hence z in W1 by A21,Th120;
      end;
      suppose
A23:    q<>0.REAL 2 & (q`1/|.q.|>=cn & q`2<=0);
        then
A24:    (cn-FanMorphS).q= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)) ,
        |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by A1,Th122;
        |.q.|<>0 by A23,TOPRNS_1:25;
        then
A25:    (|.q.|)^2>0 by SQUARE_1:74;
A26:    1-cn>0 by A1,XREAL_1:151;
A27:    qz`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))&
        qz`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by A21,A24,EUCLID:56;
A28:    (q`1/|.q.|-cn)>= 0 by A23,XREAL_1:50;
A29:    (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        0<=(q`2)^2 by XREAL_1:65;
        then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A29,XREAL_1:74;
        then (q`1)^2/(|.q.|)^2 <= 1 by A25,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then 1>=q`1/|.q.| by SQUARE_1:121;
        then
A30:    1-cn>=q`1/|.q.|-cn by XREAL_1:11;
A31:    -(1-cn)<= -0 by A26;
        -(1-cn)<= -( q`1/|.q.|-cn) by A30,XREAL_1:26;
        then (-(1-cn))/(1-cn)<=(-( q`1/|.q.|-cn))/(1-cn) by A26,XREAL_1:74;
        then
A32:    -1<=(-( q`1/|.q.|-cn))/(1-cn) by A26,XCMPLX_1:198;
        --(1-cn)>= -(q`1/|.q.|-cn) by A28,A31,XREAL_1:26;
        then (-(q`1/|.q.|-cn))/(1-cn)<=1 by A26,XREAL_1:187;
        then ((-(q`1/|.q.|-cn))/(1-cn))^2<=1^2 by A32,SQUARE_1:119;
        then 1-((-(q`1/|.q.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
        then
A33:    1-(-((q`1/|.q.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
A34:    (qz`2)^2= (|.q.|)^2*(sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))^2 by A27
          .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1-cn))^2) by A33,SQUARE_1:def 4;
        (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
          .=(|.q.|)^2 by A27,A34;
        then sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
        then
A35:    |.qz.|=|.q.| by SQUARE_1:89;
        |.(0.REAL 2) +- q.|<r by A22,EUCLID:45;
        then |.- q.|<r by EUCLID:31;
        then |.q.|<r by TOPRNS_1:27;
        then |.- qz.|<r by A35,TOPRNS_1:27;
        then |.(0.REAL 2) +- qz.|<r by EUCLID:31;
        then |.(0.REAL 2) - qz.|<r by EUCLID:45;
        then dist(u0,pz)<r by JGRAPH_1:45;
        hence z in W1 by METRIC_1:12;
      end;
      suppose
A36:    q<>0.REAL 2 & q`1/|.q.|<cn & q`2<=0;
        then
A37:    (cn-FanMorphS).q= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
        |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]| by A1,Th122;
        |.q.|<>0 by A36,TOPRNS_1:25;
        then
A38:    (|.q.|)^2>0 by SQUARE_1:74;
A39:    (cn-q`1/|.q.|)>=0 by A36,XREAL_1:50;
A40:    (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
A41:    1+cn>0 by A1,XREAL_1:150;
A42:    qz`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))&
        qz`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by A21,A37,EUCLID:56;
        0<=(q`2)^2 by XREAL_1:65;
        then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A40,XREAL_1:74;
        then (q`1)^2/(|.q.|)^2 <= 1 by A38,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then -1<=q`1/|.q.| by SQUARE_1:121;
        then --1>=-q`1/|.q.| by XREAL_1:26;
        then
A43:    1+cn>=-q`1/|.q.|+cn by XREAL_1:9;
        (-(1+cn))/(1+cn)<=(-( q`1/|.q.|-cn))/(1+cn) by A39,A41,XREAL_1:74;
        then
A44:    -1<=(-( q`1/|.q.|-cn))/(1+cn) by A41,XCMPLX_1:198;
        (-(q`1/|.q.|-cn))/(1+cn)<=1 by A41,A43,XREAL_1:187;
        then ((-(q`1/|.q.|-cn))/(1+cn))^2<=1^2 by A44,SQUARE_1:119;
        then 1-((-(q`1/|.q.|-cn))/(1+cn))^2>=0 by XREAL_1:50;
        then
A45:    1-(-((q`1/|.q.|-cn))/(1+cn))^2>=0 by XCMPLX_1:188;
A46:    (qz`2)^2= (|.q.|)^2*(sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))^2 by A42
          .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1+cn))^2) by A45,SQUARE_1:def 4;
        (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
          .=(|.q.|)^2 by A42,A46;
        then sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
        then
A47:    |.qz.|=|.q.| by SQUARE_1:89;
        |.(0.REAL 2) +- q.|<r by A22,EUCLID:45;
        then |.- q.|<r by EUCLID:31;
        then |.q.|<r by TOPRNS_1:27;
        then |.- qz.|<r by A47,TOPRNS_1:27;
        then |.(0.REAL 2) +- qz.|<r by EUCLID:31;
        then |.(0.REAL 2) - qz.|<r by EUCLID:45;
        then dist(u0,pz)<r by JGRAPH_1:45;
        hence z in W1 by METRIC_1:12;
      end;
    end;
    hence ex W being Subset of (TOP-REAL 2) st 0.REAL 2 in W
    & W is open & f.:W c= V by A18,A19,A20,XBOOLE_1:1;
  end;
  hence thesis by A2,A3,A4,A16,JGRAPH_3:13;
end;

theorem Th140:
  for cn being Real st -1<cn & cn<1 holds cn-FanMorphS is one-to-one
proof
  let cn be Real;
  assume
A1: -1<cn & cn<1;
  for x1,x2 being set st x1 in dom (cn-FanMorphS) & x2 in dom (cn-FanMorphS)
  & (cn-FanMorphS).x1=(cn-FanMorphS).x2 holds x1=x2
  proof
    let x1,x2 be set;
    assume
A2: x1 in dom (cn-FanMorphS) & x2 in dom (cn-FanMorphS)
    & (cn-FanMorphS).x1=(cn-FanMorphS).x2;
    then reconsider p1=x1 as Point of TOP-REAL 2;
    reconsider p2=x2 as Point of TOP-REAL 2 by A2;
    set q=p1,p=p2;
A3: 1-cn>0 by A1,XREAL_1:151;
    per cases by JGRAPH_2:11;
    suppose
A4:   q`2>=0;
      then
A5:   (cn-FanMorphS).q=q by Th120;
      per cases by JGRAPH_2:11;
      suppose p`2>=0;
        hence x1=x2 by A2,A5,Th120;
      end;
      suppose
A6:     p<>0.REAL 2 & (p`1/|.p.|>=cn & p`2<=0);
        then
A7:     cn-FanMorphS.p= |[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
        |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]| by A1,Th122;
        set p4= |[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
        |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]|;
A8:     p4`2= |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)) &
        p4`1= |.p.|* ((p`1/|.p.|-cn)/(1-cn)) by EUCLID:56;
A9:     q`2=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)) &
        q`1=|.p.|* ((p`1/|.p.|-cn)/(1-cn)) by A2,A5,A7,EUCLID:56;
A10:    |.p.|<>0 by A6,TOPRNS_1:25;
        then
A11:    (|.p.|)^2>0 by SQUARE_1:74;
A12:    (p`1/|.p.|-cn)>=0 by A6,XREAL_1:50;
A13:    (p`1/|.p.|-cn)>= 0 by A6,XREAL_1:50;
A14:    (p`1/|.p.|-cn)/(1-cn)>=0 by A3,A12;
A15:    (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
        0<=(p`2)^2 by XREAL_1:65;
        then 0+(p`1)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
        then (p`1)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by A15,XREAL_1:74;
        then (p`1)^2/(|.p.|)^2 <= 1 by A11,XCMPLX_1:60;
        then ((p`1)/|.p.|)^2 <= 1 by XCMPLX_1:77;
        then 1>=p`1/|.p.| by SQUARE_1:121;
        then
A16:    1-cn>=p`1/|.p.|-cn by XREAL_1:11;
A17:    -(1-cn)<= -0 by A3;
        -(1-cn)<= -( p`1/|.p.|-cn) by A16,XREAL_1:26;
        then (-(1-cn))/(1-cn)<=(-( p`1/|.p.|-cn))/(1-cn) by A3,XREAL_1:74;
        then
A18:    -1<=(-( p`1/|.p.|-cn))/(1-cn) by A3,XCMPLX_1:198;
        --(1-cn)>= -(p`1/|.p.|-cn) by A13,A17,XREAL_1:26;
        then (-(p`1/|.p.|-cn))/(1-cn)<=1 by A3,XREAL_1:187;
        then ((-(p`1/|.p.|-cn))/(1-cn))^2<=1^2 by A18,SQUARE_1:119;
        then
A19:    1-((-(p`1/|.p.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
        then
A20:    1-(-((p`1/|.p.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
        sqrt(1-((-(p`1/|.p.|-cn))/(1-cn))^2)>=0 by A19,SQUARE_1:def 4;
        then sqrt(1-(-(p`1/|.p.|-cn))^2/(1-cn)^2)>=0 by XCMPLX_1:77;
        then sqrt(1-(p`1/|.p.|-cn)^2/(1-cn)^2)>=0;
        then sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)>=0 by XCMPLX_1:77;
        then -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)<=0;
        then q`2=0 by A2,A4,A5,A7,A8;
        then -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)=-0 by A9,A10,XCMPLX_1:6;
        then 1-((p`1/|.p.|-cn)/(1-cn))^2=0 by A20,SQUARE_1:92;
        then 1= (p`1/|.p.|-cn)/(1-cn) by A14,SQUARE_1:83,89;
        then 1 *(1-cn)=(p`1/|.p.|-cn) by A3,XCMPLX_1:88;
        then 1 *|.p.|=p`1 by A6,TOPRNS_1:25,XCMPLX_1:88;
        then p`2=0 by A15,XCMPLX_1:6;
        hence x1=x2 by A2,A5,Th120;
      end;
      suppose
A21:    p<>0.REAL 2 & (p`1/|.p.|<cn & p`2<=0);
        then
A22:    cn-FanMorphS.p= |[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
        |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]| by A1,Th122;
        set p4= |[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
        |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]|;
A23:    p4`2= |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)) &
        p4`1= |.p.|* ((p`1/|.p.|-cn)/(1+cn)) by EUCLID:56;
A24:    q`2=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)) &
        q`1=|.p.|* ((p`1/|.p.|-cn)/(1+cn)) by A2,A5,A22,EUCLID:56;
A25:    |.p.|<>0 by A21,TOPRNS_1:25;
        then
A26:    (|.p.|)^2>0 by SQUARE_1:74;
A27:    1+cn>0 by A1,XREAL_1:150;
A28:    (p`1/|.p.|-cn)<=0 by A21,XREAL_1:49;
        then
A29:    -(p`1/|.p.|-cn)>= -0;
        --(p`1/|.p.|-cn)/(1+cn)<=0 by A27,A28;
        then
A30:    -((p`1/|.p.|-cn)/(1+cn))>=0;
A31:    (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
        0<=(p`2)^2 by XREAL_1:65;
        then 0+(p`1)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
        then (p`1)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by A31,XREAL_1:74;
        then (p`1)^2/(|.p.|)^2 <= 1 by A26,XCMPLX_1:60;
        then ((p`1)/|.p.|)^2 <= 1 by XCMPLX_1:77;
        then
A32:    (-((p`1)/|.p.|))^2 <= 1;
        (-(1+cn))/(1+cn)<=(-( p`1/|.p.|-cn))/(1+cn) by A27,A29,XREAL_1:74;
        then
A33:    -1<=(-( p`1/|.p.|-cn))/(1+cn) by A27,XCMPLX_1:198;
        1>= -p`1/|.p.| by A32,SQUARE_1:121;
        then (1+cn)>= -p`1/|.p.|+cn by XREAL_1:9;
        then (-(p`1/|.p.|-cn))/(1+cn)<=1 by A27,XREAL_1:187;
        then ((-(p`1/|.p.|-cn))/(1+cn))^2<=1^2 by A33,SQUARE_1:119;
        then
A34:    1-((-(p`1/|.p.|-cn))/(1+cn))^2>=0 by XREAL_1:50;
        then
A35:    1-(-((p`1/|.p.|-cn))/(1+cn))^2>=0 by XCMPLX_1:188;
        sqrt(1-((-(p`1/|.p.|-cn))/(1+cn))^2)>=0 by A34,SQUARE_1:def 4;
        then sqrt(1-(-(p`1/|.p.|-cn))^2/(1+cn)^2)>=0 by XCMPLX_1:77;
        then sqrt(1-((p`1/|.p.|-cn))^2/(1+cn)^2)>=0;
        then sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)>=0 by XCMPLX_1:77;
        then -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)<=0;
        then q`2=0 by A2,A4,A5,A22,A23;
        then -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)=-0 by A24,A25,XCMPLX_1:6;
        then 1-((p`1/|.p.|-cn)/(1+cn))^2=0 by A35,SQUARE_1:92;
        then 1=(-((p`1/|.p.|-cn)/(1+cn)))^2;
        then 1= -((p`1/|.p.|-cn)/(1+cn)) by A30,SQUARE_1:83,89;
        then 1= ((-(p`1/|.p.|-cn))/(1+cn)) by XCMPLX_1:188;
        then 1 *(1+cn)=-(p`1/|.p.|-cn) by A27,XCMPLX_1:88;
        then 1+cn-cn=-p`1/|.p.|;
        then 1=(-p`1)/|.p.| by XCMPLX_1:188;
        then 1 *|.p.|=-p`1 by A21,TOPRNS_1:25,XCMPLX_1:88;
        then (p`1)^2-(p`1)^2 =(p`2)^2 by A31,XCMPLX_1:26;
        then p`2=0 by XCMPLX_1:6;
        hence x1=x2 by A2,A5,Th120;
      end;
    end;
    suppose
A36:  q`1/|.q.|>=cn & q`2<=0 & q<>0.REAL 2;
      then
A37:  cn-FanMorphS.q= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
      |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by A1,Th122;
      set q4= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
      |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]|;
A38:  q4`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)) &
      q4`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by EUCLID:56;
      |.q.|<>0 by A36,TOPRNS_1:25;
      then
A39:  (|.q.|)^2>0 by SQUARE_1:74;
      per cases by JGRAPH_2:11;
      suppose
A40:    p`2>=0;
        then
A41:    (cn-FanMorphS).p=p by Th120;
        then
A42:    p`2=|.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)) &
        p`1=|.q.|* ((q`1/|.q.|-cn)/(1-cn)) by A2,A37,EUCLID:56;
A43:    |.q.|<>0 by A36,TOPRNS_1:25;
        then
A44:    (|.q.|)^2>0 by SQUARE_1:74;
A45:    1-cn>0 by A1,XREAL_1:151;
A46:    (q`1/|.q.|-cn)>=0 by A36,XREAL_1:50;
A47:    (q`1/|.q.|-cn)>= 0 by A36,XREAL_1:50;
A48:    (q`1/|.q.|-cn)/(1-cn)>=0 by A45,A46;
A49:    (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        0<=(q`2)^2 by XREAL_1:65;
        then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A49,XREAL_1:74;
        then (q`1)^2/(|.q.|)^2 <= 1 by A44,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then 1>=q`1/|.q.| by SQUARE_1:121;
        then
A50:    1-cn>=q`1/|.q.|-cn by XREAL_1:11;
A51:    -(1-cn)<= -0 by A45;
        -(1-cn)<= -( q`1/|.q.|-cn) by A50,XREAL_1:26;
        then (-(1-cn))/(1-cn)<=(-( q`1/|.q.|-cn))/(1-cn) by A45,XREAL_1:74;
        then
A52:    -1<=(-( q`1/|.q.|-cn))/(1-cn) by A45,XCMPLX_1:198;
        --(1-cn)>= -(q`1/|.q.|-cn) by A47,A51,XREAL_1:26;
        then (-(q`1/|.q.|-cn))/(1-cn)<=1 by A45,XREAL_1:187;
        then ((-(q`1/|.q.|-cn))/(1-cn))^2<=1^2 by A52,SQUARE_1:119;
        then
A53:    1-((-(q`1/|.q.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
        then
A54:    1-(-((q`1/|.q.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
        sqrt(1-((-(q`1/|.q.|-cn))/(1-cn))^2)>=0 by A53,SQUARE_1:def 4;
        then sqrt(1-(-(q`1/|.q.|-cn))^2/(1-cn)^2)>=0 by XCMPLX_1:77;
        then sqrt(1-(q`1/|.q.|-cn)^2/(1-cn)^2)>=0;
        then sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)>=0 by XCMPLX_1:77;
        then -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)<=0;
        then p`2=0 by A2,A37,A38,A40,A41;
        then -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)=-0 by A42,A43,XCMPLX_1:6;
        then 1-((q`1/|.q.|-cn)/(1-cn))^2=0 by A54,SQUARE_1:92;
        then 1= (q`1/|.q.|-cn)/(1-cn) by A48,SQUARE_1:83,89;
        then 1 *(1-cn)=(q`1/|.q.|-cn) by A45,XCMPLX_1:88;
        then 1 *|.q.|=q`1 by A36,TOPRNS_1:25,XCMPLX_1:88;
        then q`2=0 by A49,XCMPLX_1:6;
        hence x1=x2 by A2,A41,Th120;
      end;
      suppose
A55:    p<>0.REAL 2 & (p`1/|.p.|>=cn & p`2<=0);
        then
A56:    cn-FanMorphS.p= |[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
        |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]| by A1,Th122;
        set p4= |[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
        |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]|;
A57:    p4`2= |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)) &
        p4`1= |.p.|* ((p`1/|.p.|-cn)/(1-cn)) by EUCLID:56;
A58:    q4`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))&
        q4`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by EUCLID:56;
A59:    (q`1/|.q.|-cn)>= 0 by A36,XREAL_1:50;
A60:    (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        0<=(q`2)^2 by XREAL_1:65;
        then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A60,XREAL_1:74;
        then (q`1)^2/(|.q.|)^2 <= 1 by A39,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then 1>=q`1/|.q.| by SQUARE_1:121;
        then
A61:    1-cn>=q`1/|.q.|-cn by XREAL_1:11;
A62:    -(1-cn)<= -0 by A3;
        -(1-cn)<= -( q`1/|.q.|-cn) by A61,XREAL_1:26;
        then (-(1-cn))/(1-cn)<=(-( q`1/|.q.|-cn))/(1-cn) by A3,XREAL_1:74;
        then
A63:    -1<=(-( q`1/|.q.|-cn))/(1-cn) by A3,XCMPLX_1:198;
        --(1-cn)>= -(q`1/|.q.|-cn) by A59,A62,XREAL_1:26;
        then (-(q`1/|.q.|-cn))/(1-cn)<=1 by A3,XREAL_1:187;
        then ((-(q`1/|.q.|-cn))/(1-cn))^2<=1^2 by A63,SQUARE_1:119;
        then 1-((-(q`1/|.q.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
        then
A64:    1-(-((q`1/|.q.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
A65:    (q4`2)^2= (|.q.|)^2*(sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))^2 by A58
          .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1-cn))^2) by A64,SQUARE_1:def 4;
        (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
          .=(|.q.|)^2 by A58,A65;
        then
A66:    sqrt((|.q4.|)^2)=|.q.| by SQUARE_1:89;
        then
A67:    |.q4.|=|.q.| by SQUARE_1:89;
        |.p.|<>0 by A55,TOPRNS_1:25;
        then
A68:    (|.p.|)^2>0 by SQUARE_1:74;
A69:    (p`1/|.p.|-cn)>= 0 by A55,XREAL_1:50;
A70:    (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
        0<=(p`2)^2 by XREAL_1:65;
        then 0+(p`1)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
        then (p`1)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by A70,XREAL_1:74;
        then (p`1)^2/(|.p.|)^2 <= 1 by A68,XCMPLX_1:60;
        then ((p`1)/|.p.|)^2 <= 1 by XCMPLX_1:77;
        then 1>=p`1/|.p.| by SQUARE_1:121;
        then
A71:    1-cn>=p`1/|.p.|-cn by XREAL_1:11;
A72:    -(1-cn)<= -0 by A3;
        -(1-cn)<= -( p`1/|.p.|-cn) by A71,XREAL_1:26;
        then (-(1-cn))/(1-cn)<=(-( p`1/|.p.|-cn))/(1-cn) by A3,XREAL_1:74;
        then
A73:    -1<=(-( p`1/|.p.|-cn))/(1-cn) by A3,XCMPLX_1:198;
        --(1-cn)>= -(p`1/|.p.|-cn) by A69,A72,XREAL_1:26;
        then (-(p`1/|.p.|-cn))/(1-cn)<=1 by A3,XREAL_1:187;
        then ((-(p`1/|.p.|-cn))/(1-cn))^2<=1^2 by A73,SQUARE_1:119;
        then 1-((-(p`1/|.p.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
        then
A74:    1-(-((p`1/|.p.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
A75:    (p4`2)^2= (|.p.|)^2*(sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))^2 by A57
          .= (|.p.|)^2*(1-((p`1/|.p.|-cn)/(1-cn))^2) by A74,SQUARE_1:def 4;
        (|.p4.|)^2=(p4`1)^2+(p4`2)^2 by JGRAPH_3:10
          .=(|.p.|)^2 by A57,A75;
        then
A76:    sqrt((|.p4.|)^2)=|.p.| by SQUARE_1:89;
        then
A77:    |.p4.|=|.p.| by SQUARE_1:89;
        ((p`1/|.p.|-cn)/(1-cn))
        =|.q.|* ((q`1/|.q.|-cn)/(1-cn))/|.p.| by A2,A37,A38,A55,A56,A57,
TOPRNS_1:25,XCMPLX_1:90;
        then (p`1/|.p.|-cn)/(1-cn)=(q`1/|.q.|-cn)/(1-cn)
        by A2,A37,A55,A56,A66,A76,TOPRNS_1:25,XCMPLX_1:90;
        then (p`1/|.p.|-cn)/(1-cn)*(1-cn)=q`1/|.q.|-cn by A3,XCMPLX_1:88;
        then p`1/|.p.|-cn=q`1/|.q.|-cn by A3,XCMPLX_1:88;
        then p`1/|.p.|*|.p.|=q`1 by A2,A37,A55,A56,A67,A77,TOPRNS_1:25
,XCMPLX_1:88;
        then
A78:    p`1=q`1 by A55,TOPRNS_1:25,XCMPLX_1:88;
A79:    |.p.|^2=(p`1)^2+(p`2)^2 by JGRAPH_3:10;
        |.q.|^2=(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        then
A80:    (-p`2)^2=(q`2)^2 by A2,A37,A56,A67,A77,A78,A79;
        --q`2<=0 by A36;
        then
A81:    -q`2>=0;
        --p`2<=0 by A55;
        then -p`2>=0;
        then -p`2=sqrt((-q`2)^2) by A80,SQUARE_1:89;
        then
A82:    --p`2=--q`2 by A81,SQUARE_1:89;
        p=|[p`1,p`2]| by EUCLID:57;
        hence x1=x2 by A78,A82,EUCLID:57;
      end;
      suppose
A83:    p<>0.REAL 2 & (p`1/|.p.|<cn & p`2<=0);
        then
A84:    cn-FanMorphS.p= |[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
        |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]| by A1,Th122;
        set p4= |[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
        |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]|;
A85:    p4`2= |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)) &
        p4`1= |.p.|* ((p`1/|.p.|-cn)/(1+cn)) by EUCLID:56;
A86:    p`1/|.p.|-cn<0 by A83,XREAL_1:51;
        1+cn>0 by A1,XREAL_1:150;
        then
A87:    ((p`1/|.p.|-cn)/(1+cn))<0 by A86,XREAL_1:143;
        |.p.|<>0 by A83,TOPRNS_1:25;
        then
A89:    |.p.|* ((p`1/|.p.|-cn)/(1+cn))<0 by A87,XREAL_1:134;
A90:    q`1/|.q.|-cn>=0 by A36,XREAL_1:50;
        1-cn>0 by A1,XREAL_1:151;
        then ((q`1/|.q.|-cn)/(1-cn))>=0 by A90;
        hence x1=x2 by A2,A37,A38,A84,A85,A89;
      end;
    end;
    suppose
A91:  q`1/|.q.|<cn & q`2<=0 & q<>0.REAL 2;
      then
A92:  cn-FanMorphS.q= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
      |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]| by A1,Th122;
      set q4= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
      |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]|;
A93:  q4`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)) &
      q4`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by EUCLID:56;
A94:  |.q.|<>0 by A91,TOPRNS_1:25;
      then
A95:  (|.q.|)^2>0 by SQUARE_1:74;
      per cases by JGRAPH_2:11;
      suppose
A96:    p`2>=0;
        then
A97:    (cn-FanMorphS).p=p by Th120;
        then
A98:    p`2=|.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)) &
        p`1=|.q.|* ((q`1/|.q.|-cn)/(1+cn)) by A2,A92,EUCLID:56;
A99:    1+cn>0 by A1,XREAL_1:150;
A100:   (q`1/|.q.|-cn)<=0 by A91,XREAL_1:49;
        then
A101:   -(q`1/|.q.|-cn)>= -0;
        --(q`1/|.q.|-cn)/(1+cn)<=0 by A99,A100;
        then
A102:   -((q`1/|.q.|-cn)/(1+cn))>=0;
A103:   (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        0<=(q`2)^2 by XREAL_1:65;
        then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2
         by A103,XREAL_1:74;
        then (q`1)^2/(|.q.|)^2 <= 1 by A95,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then
A104:   (-((q`1)/|.q.|))^2 <= 1;
        (-(1+cn))/(1+cn)<=(-( q`1/|.q.|-cn))/(1+cn)
        by A99,A101,XREAL_1:74;
        then
A105:   -1<=(-( q`1/|.q.|-cn))/(1+cn) by A99,XCMPLX_1:198;
        1>= -q`1/|.q.| by A104,SQUARE_1:121;
        then (1+cn)>= -q`1/|.q.|+cn by XREAL_1:9;
        then (-(q`1/|.q.|-cn))/(1+cn)<=1 by A99,XREAL_1:187;
        then ((-(q`1/|.q.|-cn))/(1+cn))^2<=1^2 by A105,SQUARE_1:119;
        then
A106:   1-((-(q`1/|.q.|-cn))/(1+cn))^2>=0 by XREAL_1:50;
        then
A107:   1-(-((q`1/|.q.|-cn))/(1+cn))^2>=0 by XCMPLX_1:188;
        sqrt(1-((-(q`1/|.q.|-cn))/(1+cn))^2)>=0 by A106,SQUARE_1:def 4;
        then sqrt(1-(-(q`1/|.q.|-cn))^2/(1+cn)^2)>=0 by XCMPLX_1:77;
        then sqrt(1-((q`1/|.q.|-cn))^2/(1+cn)^2)>=0;
        then sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)>=0 by XCMPLX_1:77;
        then -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)<=0;
        then p`2=0 by A2,A92,A93,A96,A97;
        then -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)=-0 by A94,A98,XCMPLX_1:6;
        then 1-((q`1/|.q.|-cn)/(1+cn))^2=0 by A107,SQUARE_1:92;
        then 1=(-((q`1/|.q.|-cn)/(1+cn)))^2;
        then 1= -((q`1/|.q.|-cn)/(1+cn)) by A102,SQUARE_1:83,89;
        then 1= ((-(q`1/|.q.|-cn))/(1+cn)) by XCMPLX_1:188;
        then 1 *(1+cn)=-(q`1/|.q.|-cn) by A99,XCMPLX_1:88;
        then 1+cn-cn=-q`1/|.q.|;
        then 1=(-q`1)/|.q.| by XCMPLX_1:188;
        then 1 *|.q.|=-q`1 by A91,TOPRNS_1:25,XCMPLX_1:88;
        then (q`1)^2-(q`1)^2 =(q`2)^2 by A103,XCMPLX_1:26;
        then q`2=0 by XCMPLX_1:6;
        hence x1=x2 by A2,A97,Th120;
      end;
      suppose
A108:   p<>0.REAL 2 & (p`1/|.p.|>=cn & p`2<=0);
        then
A109:   cn-FanMorphS.p= |[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
        |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]| by A1,Th122;
        set p4= |[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
        |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]|;
A110:   p4`2= |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)) &
        p4`1= |.p.|* ((p`1/|.p.|-cn)/(1-cn)) by EUCLID:56;
A111:   q`1/|.q.|-cn<0 by A91,XREAL_1:51;
        1+cn>0 by A1,XREAL_1:150;
        then
A112:   ((q`1/|.q.|-cn)/(1+cn))<0 by A111,XREAL_1:143;
        |.q.|<>0 by A91,TOPRNS_1:25;
        then
A114:   |.q.|* ((q`1/|.q.|-cn)/(1+cn))<0 by A112,XREAL_1:134;
A115:   p`1/|.p.|-cn>=0 by A108,XREAL_1:50;
        1-cn>0 by A1,XREAL_1:151;
        then ((p`1/|.p.|-cn)/(1-cn))>=0 by A115;
        hence x1=x2 by A2,A92,A93,A109,A110,A114;
      end;
      suppose
A116:   p<>0.REAL 2 & (p`1/|.p.|<cn & p`2<=0);
        then
A117:   cn-FanMorphS.p= |[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
        |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]| by A1,Th122;
        set p4= |[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
        |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]|;
A118:   p4`2= |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)) &
        p4`1= |.p.|* ((p`1/|.p.|-cn)/(1+cn)) by EUCLID:56;
A119:   q4`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))&
        q4`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by EUCLID:56;
        (q`1/|.q.|-cn)<=0 by A91,XREAL_1:49;
        then
A120:   -(q`1/|.q.|-cn)>= -0;
A121:   (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        0<=(q`2)^2 by XREAL_1:65;
        then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2
         by A121,XREAL_1:74;
        then (q`1)^2/(|.q.|)^2 <= 1 by A95,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then -1<=q`1/|.q.| by SQUARE_1:121;
        then
A122:   -1-cn<=q`1/|.q.|-cn by XREAL_1:11;
A123:   1+cn>0 by A1,XREAL_1:150;
        (-(1+cn))/(1+cn)<=(-( q`1/|.q.|-cn))/(1+cn)
        by A120,A123,XREAL_1:74;
        then
A124:   -1<=(-( q`1/|.q.|-cn))/(1+cn) by A123,XCMPLX_1:198;
        -(-1-cn)>= -(q`1/|.q.|-cn) by A122,XREAL_1:26;
        then (-(q`1/|.q.|-cn))/(1+cn)<=1 by A123,XREAL_1:187;
        then ((-(q`1/|.q.|-cn))/(1+cn))^2<=1^2 by A124,SQUARE_1:119;
        then 1-((-(q`1/|.q.|-cn))/(1+cn))^2>=0 by XREAL_1:50;
        then
A125:   1-(-((q`1/|.q.|-cn))/(1+cn))^2>=0 by XCMPLX_1:188;
A126:   (q4`2)^2= (|.q.|)^2*(sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))^2 by A119
          .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1+cn))^2) by A125,SQUARE_1:def 4;
        (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
          .=(|.q.|)^2 by A119,A126;
        then
A127:   sqrt((|.q4.|)^2)=|.q.| by SQUARE_1:89;
        then
A128:   |.q4.|=|.q.| by SQUARE_1:89;
        |.p.|<>0 by A116,TOPRNS_1:25;
        then
A129:   (|.p.|)^2>0 by SQUARE_1:74;
        (p`1/|.p.|-cn)<=0 by A116,XREAL_1:49;
        then
A130:   -(p`1/|.p.|-cn)>= -0;
A131:   (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
        0<=(p`2)^2 by XREAL_1:65;
        then 0+(p`1)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
        then (p`1)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2
         by A131,XREAL_1:74;
        then (p`1)^2/(|.p.|)^2 <= 1 by A129,XCMPLX_1:60;
        then ((p`1)/|.p.|)^2 <= 1 by XCMPLX_1:77;
        then -1<=p`1/|.p.| by SQUARE_1:121;
        then
A132:   -1-cn<=p`1/|.p.|-cn by XREAL_1:11;
        (-(1+cn))/(1+cn)<=(-( p`1/|.p.|-cn))/(1+cn)
        by A123,A130,XREAL_1:74;
        then
A133:   -1<=(-( p`1/|.p.|-cn))/(1+cn) by A123,XCMPLX_1:198;
        -(-1-cn)>= -(p`1/|.p.|-cn) by A132,XREAL_1:26;
        then (-(p`1/|.p.|-cn))/(1+cn)<=1 by A123,XREAL_1:187;
        then ((-(p`1/|.p.|-cn))/(1+cn))^2<=1^2 by A133,SQUARE_1:119;
        then 1-((-(p`1/|.p.|-cn))/(1+cn))^2>=0 by XREAL_1:50;
        then
A134:   1-(-((p`1/|.p.|-cn))/(1+cn))^2>=0 by XCMPLX_1:188;
A135:   (p4`2)^2= (|.p.|)^2*(sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))^2 by A118
          .= (|.p.|)^2*(1-((p`1/|.p.|-cn)/(1+cn))^2) by A134,SQUARE_1:def 4;
        (|.p4.|)^2=(p4`1)^2+(p4`2)^2 by JGRAPH_3:10
          .=(|.p.|)^2 by A118,A135;
        then
A136:   sqrt((|.p4.|)^2)=|.p.| by SQUARE_1:89;
        then
A137:   |.p4.|=|.p.| by SQUARE_1:89;
        ((p`1/|.p.|-cn)/(1+cn))
        =|.q.|* ((q`1/|.q.|-cn)/(1+cn))/|.p.| by A2,A92,A93,A116,A117,A118,
TOPRNS_1:25,XCMPLX_1:90;
        then (p`1/|.p.|-cn)/(1+cn)=(q`1/|.q.|-cn)/(1+cn)
        by A2,A92,A116,A117,A127,A136,TOPRNS_1:25,XCMPLX_1:90;
        then (p`1/|.p.|-cn)/(1+cn)*(1+cn)=q`1/|.q.|-cn by A123,XCMPLX_1:88;
        then p`1/|.p.|-cn=q`1/|.q.|-cn by A123,XCMPLX_1:88;
        then p`1/|.p.|*|.p.|=q`1 by A2,A92,A116,A117,A128,A137,TOPRNS_1:25
,XCMPLX_1:88;
        then
A138:   p`1=q`1 by A116,TOPRNS_1:25,XCMPLX_1:88;
A139:   |.p.|^2=(p`1)^2+(p`2)^2 by JGRAPH_3:10;
        |.q.|^2=(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        then
A140:   (-p`2)^2=(q`2)^2 by A2,A92,A117,A128,A137,A138,A139;
        --q`2<=0 by A91;
        then
A141:   -q`2>=0;
        --p`2<=0 by A116;
        then -p`2>=0;
        then -p`2=sqrt((-q`2)^2) by A140,SQUARE_1:89;
        then
A142:   --p`2=--q`2 by A141,SQUARE_1:89;
        p=|[p`1,p`2]| by EUCLID:57;
        hence x1=x2 by A138,A142,EUCLID:57;
      end;
    end;
  end;
  hence thesis by FUNCT_1:def 8;
end;

theorem Th141:
  for cn being Real st -1<cn & cn<1 holds
  (cn-FanMorphS) is Function of TOP-REAL 2,TOP-REAL 2 &
  rng (cn-FanMorphS) = the carrier of TOP-REAL 2
proof
  let cn be Real;
  assume
A1: -1<cn & cn<1;
  thus (cn-FanMorphS) is Function of TOP-REAL 2,TOP-REAL 2;
  for f being Function of TOP-REAL 2,TOP-REAL 2 st f=cn-FanMorphS holds
  rng (cn-FanMorphS)=the carrier of TOP-REAL 2
  proof
    let f be Function of TOP-REAL 2,TOP-REAL 2;
    assume
A2: f=(cn-FanMorphS);
A3: dom f=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
    the carrier of TOP-REAL 2 c= rng f
    proof
      let y be set;
      assume y in the carrier of TOP-REAL 2;
      then reconsider p2=y as Point of TOP-REAL 2;
      set q=p2;
      now per cases by JGRAPH_2:11;
        case q`2>=0;
          then q in dom (cn-FanMorphS) & y=(cn-FanMorphS).q by A2,A3,Th120;
          hence ex x being set st x in dom (cn-FanMorphS) & y=(cn-FanMorphS).x;
        end;
        case
A4:       q`1/|.q.|>=0 & q`2<=0 & q<>0.REAL 2;
          set px=|[ |.q.|*(q`1/|.q.|*(1-cn)+cn),
          -((|.q.|)*sqrt(1-(q`1/|.q.|*(1-cn)+cn)^2))]|;
A5:       px`2 = -(|.q.|)*sqrt(1-(q`1/|.q.|*(1-cn)+cn)^2) &
          px`1 = |.q.|*(q`1/|.q.|*(1-cn)+cn) by EUCLID:56;
          then
A6:       |.px.|^2=((- |.q.|)*sqrt(1-(q`1/|.q.|*(1-cn)+cn)^2))^2
          +(|.q.|*(q`1/|.q.|*(1-cn)+cn))^2 by JGRAPH_3:10
            .=(|.q.|)^2*(sqrt(1-(q`1/|.q.|*(1-cn)+cn)^2))^2
          +(|.q.|)^2*((q`1/|.q.|*(1-cn)+cn))^2;
A7:       |.q.|<>0 by A4,TOPRNS_1:25;
          1-cn>=0 by A1,XREAL_1:151;
          then
A8:       q`1/|.q.|*(1-cn)>=0 by A4;
          then
A9:       (q`1/|.q.|*(1-cn)+cn)>=0+cn by XREAL_1:9;
A11:      |.q.|^2>0 by A7,SQUARE_1:74;
          --(1+cn)>0 by A1,XREAL_1:150;
          then -(-1-cn)>0;
          then -1-cn<= q`1/|.q.|*(1-cn) by A8;
          then
A12:      -1-cn+cn<= q`1/|.q.|*(1-cn)+cn by XREAL_1:9;
A13:      1-cn>0 by A1,XREAL_1:151;
A14:      (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
          0<=(q`2)^2 by XREAL_1:65;
          then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
          then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2
           by A14,XREAL_1:74;
          then (q`1)^2/(|.q.|)^2 <= 1 by A11,XCMPLX_1:60;
          then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
          then q`1/|.q.|<=1 by SQUARE_1:121;
          then q`1/|.q.|*(1-cn) <=1 *(1-cn) by A13,XREAL_1:66;
          then q`1/|.q.|*(1-cn)+cn-cn <=1-cn;
          then (q`1/|.q.|*(1-cn)+cn) <=1 by XREAL_1:11;
          then 1^2>=(q`1/|.q.|*(1-cn)+cn)^2 by A12,SQUARE_1:119;
          then
A15:      1-(q`1/|.q.|*(1-cn)+cn)^2>=0 by XREAL_1:50;
          then
A16:      |.px.|^2=(|.q.|)^2*(1-(q`1/|.q.|*(1-cn)+cn)^2)
          +(|.q.|)^2*((q`1/|.q.|*(1-cn)+cn))^2 by A6,SQUARE_1:def 4
            .= (|.q.|)^2;
          then
A17:      |.px.|=sqrt(|.q.|^2) by SQUARE_1:89
            .=|.q.| by SQUARE_1:89;
          sqrt(1-(q`1/|.q.|*(1-cn)+cn)^2)>=0 by A15,SQUARE_1:def 4;
          then (q`1/|.q.|*(1-cn)+cn)>=cn &
          (|.q.|)*sqrt(1-(q`1/|.q.|*(1-cn)+cn)^2)>=0 by A9;
          then px`1/|.px.| >=cn & px`2<=0 & px<>0.REAL 2
          by A5,A7,A17,TOPRNS_1:24,XCMPLX_1:90;
          then
A18:      (cn-FanMorphS).px =|[ |.px.|* ((px`1/|.px.|-cn)/(1-cn) ),
          |.px.|*( -sqrt(1-((px`1/|.px.|-cn)/(1-cn))^2))]| by A1,Th122;
A19:      |.px.|* ((px`1/|.px.|-cn)/(1-cn))

=|.q.|* (( ((q`1/|.q.|*(1-cn)+cn))-cn)/(1-cn)) by A4,A5,A17,TOPRNS_1:25
,XCMPLX_1:90
            .=|.q.|* ( q`1/|.q.|) by A13,XCMPLX_1:90
            .= q`1 by A4,TOPRNS_1:25,XCMPLX_1:88;
          then
A20:      |.px.|*( -sqrt(1-((px`1/|.px.|-cn)/(1-cn))^2))
          = |.px.|*( -sqrt(1-(q`1/|.px.|)^2)) by A4,A17,TOPRNS_1:25,XCMPLX_1:90
            .= |.px.|*( -sqrt(1-(q`1)^2/(|.px.|)^2)) by XCMPLX_1:77
            .= |.px.|*( -sqrt( (|.px.|)^2/(|.px.|)^2-(q`1)^2/(|.px.|)^2))
          by A11,A16,XCMPLX_1:60
            .= |.px.|*( -sqrt( ((|.px.|)^2-(q`1)^2)/(|.px.|)^2))
          by XCMPLX_1:121
            .= |.px.|*( -sqrt( ((q`1)^2+(q`2)^2-(q`1)^2)/(|.px.|)^2))
          by A16,JGRAPH_3:10
            .= |.px.|*( -sqrt((q`2/|.q.|)^2)) by A17,XCMPLX_1:77;
          --(q`2/|.q.|)<=0 by A4;
          then -(q`2/|.q.|)>=0;
          then |.px.|*( sqrt((-(q`2/|.q.|))^2))=|.q.|*(-(q`2/|.q.|)) by A17,
SQUARE_1:89
            .= (-q`2)/|.q.|*|.q.| by XCMPLX_1:188
            .=-q`2 by A4,TOPRNS_1:25,XCMPLX_1:88;
          then
A21:      |.px.|*(- sqrt((-(q`2/|.q.|))^2))=q`2;
          dom (cn-FanMorphS)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
          hence ex x being set st x in dom (cn-FanMorphS) & y=(cn-FanMorphS).x
          by A18,A19,A20,A21,EUCLID:57;
        end;
        case
A22:      q`1/|.q.|<0 & q`2<=0 & q<>0.REAL 2;
          set px=|[ |.q.|*(q`1/|.q.|*(1+cn)+cn),
          -(|.q.|)*(sqrt(1-(q`1/|.q.|*(1+cn)+cn)^2))]|;
A23:      px`2 = -(|.q.|)*sqrt(1-(q`1/|.q.|*(1+cn)+cn)^2) &
          px`1 = |.q.|*(q`1/|.q.|*(1+cn)+cn) by EUCLID:56;
          then
A24:      |.px.|^2=(-(|.q.|)*sqrt(1-(q`1/|.q.|*(1+cn)+cn)^2))^2
          +(|.q.|*(q`1/|.q.|*(1+cn)+cn))^2 by JGRAPH_3:10
            .=(|.q.|)^2*(sqrt(1-(q`1/|.q.|*(1+cn)+cn)^2))^2
          +(|.q.|)^2*((q`1/|.q.|*(1+cn)+cn))^2;
A25:      |.q.|<>0 by A22,TOPRNS_1:25;
          1+cn>=0 by A1,XREAL_1:150;
          then
A26:      q`1/|.q.|*(1+cn)<=0 by A22;
          then
A27:      (q`1/|.q.|*(1+cn)+cn)<=0+cn by XREAL_1:9;
A29:      |.q.|^2>0 by A25,SQUARE_1:74;
          1-cn>0 by A1,XREAL_1:151;
          then
A30:      1-cn+cn>= q`1/|.q.|*(1+cn)+cn by A26,XREAL_1:9;
A31:      1+cn>0 by A1,XREAL_1:150;
A32:      (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
          0<=(q`2)^2 by XREAL_1:65;
          then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
          then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2
           by A32,XREAL_1:74;
          then (q`1)^2/(|.q.|)^2 <= 1 by A29,XCMPLX_1:60;
          then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
          then q`1/|.q.|>=-1 by SQUARE_1:121;
          then q`1/|.q.|*(1+cn) >=(-1)*(1+cn) by A31,XREAL_1:66;
          then q`1/|.q.|*(1+cn)+cn-cn >=-1-cn;
          then (q`1/|.q.|*(1+cn)+cn) >=-1 by XREAL_1:11;
          then 1^2>=(q`1/|.q.|*(1+cn)+cn)^2 by A30,SQUARE_1:119;
          then
A33:      1-(q`1/|.q.|*(1+cn)+cn)^2>=0 by XREAL_1:50;
          then
A34:      |.px.|^2=(|.q.|)^2*(1-(q`1/|.q.|*(1+cn)+cn)^2)
          +(|.q.|)^2*((q`1/|.q.|*(1+cn)+cn))^2 by A24,SQUARE_1:def 4
            .= (|.q.|)^2;
          then
A35:      |.px.|=sqrt(|.q.|^2) by SQUARE_1:89
            .=|.q.| by SQUARE_1:89;
          then
A36:      |.px.|<>0 by A22,TOPRNS_1:25;
          sqrt(1-(q`1/|.q.|*(1+cn)+cn)^2)>=0 by A33,SQUARE_1:def 4;
          then -sqrt(1-(q`1/|.q.|*(1+cn)+cn)^2)<=0;
          then (q`1/|.q.|*(1+cn)+cn)<=cn &
          (|.q.|)*(-sqrt(1-(q`1/|.q.|*(1+cn)+cn)^2))<=0 by A27;
          then px`1/|.px.| <=cn & px`2<=0 & px<>0.REAL 2
          by A23,A35,A36,TOPRNS_1:24,XCMPLX_1:90;
          then
A37:      (cn-FanMorphS).px =|[ |.px.|* ((px`1/|.px.|-cn)/(1+cn) ),
          |.px.|*( -sqrt(1-((px`1/|.px.|-cn)/(1+cn))^2))]| by A1,Th122;
A38:      |.px.|* ((px`1/|.px.|-cn)/(1+cn))

=|.q.|* (( ((q`1/|.q.|*(1+cn)+cn))-cn)/(1+cn)) by A22,A23,A35,TOPRNS_1:25
,XCMPLX_1:90
            .=|.q.|* ( q`1/|.q.|) by A31,XCMPLX_1:90
            .= q`1 by A22,TOPRNS_1:25,XCMPLX_1:88;
          then
A39:      |.px.|*( -sqrt(1-((px`1/|.px.|-cn)/(1+cn))^2))
          = |.px.|*( -sqrt(1-(q`1/|.px.|)^2)) by A22,A35,TOPRNS_1:25
,XCMPLX_1:90
            .= |.px.|*( -sqrt(1-(q`1)^2/(|.px.|)^2)) by XCMPLX_1:77
            .= |.px.|*( -sqrt( (|.px.|)^2/(|.px.|)^2-(q`1)^2/(|.px.|)^2))
          by A29,A34,XCMPLX_1:60
            .= |.px.|*( -sqrt( ((|.px.|)^2-(q`1)^2)/(|.px.|)^2))
          by XCMPLX_1:121
            .= |.px.|*( -sqrt( ((q`1)^2+(q`2)^2-(q`1)^2)/(|.px.|)^2))
          by A34,JGRAPH_3:10
            .= |.px.|*( -sqrt((q`2/|.q.|)^2)) by A35,XCMPLX_1:77;
          --q`2/|.q.|<=0 by A22;
          then
A40:      -q`2/|.q.|>=0;
A41:      |.px.|*( -sqrt((q`2/|.q.|)^2)) = |.px.|*( -sqrt((-q`2/|.q.|)^2))
            .=|.px.|*(--(q`2/|.q.|)) by A40,SQUARE_1:89
            .=q`2 by A22,A35,TOPRNS_1:25,XCMPLX_1:88;
          dom (cn-FanMorphS)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
          hence ex x being set st x in dom (cn-FanMorphS) & y=(cn-FanMorphS).x
          by A37,A38,A39,A41,EUCLID:57;
        end;
      end;
      hence y in rng f by A2,FUNCT_1:def 5;
    end;
    hence rng (cn-FanMorphS)=the carrier of TOP-REAL 2 by A2,XBOOLE_0:def 10;
  end;
  hence thesis;
end;

theorem Th142:
  for cn being Real,p2 being Point of TOP-REAL 2 st -1<cn & cn<1
  ex K being non empty compact Subset of TOP-REAL 2 st K = (cn-FanMorphS).:K &
  (ex V2 being Subset of TOP-REAL 2 st
  p2 in V2 & V2 is open & V2 c= K & (cn-FanMorphS).p2 in V2)
proof
  let cn be Real,p2 be Point of TOP-REAL 2;
  assume
A1: -1<cn & cn<1;
  reconsider O=0.REAL 2 as Point of Euclid 2;
  reconsider V0=Ball(O,|.p2.|+1) as Subset of TOP-REAL 2;
A2: |. p2.|<|.p2.|+1 by XREAL_1:31;
A3: O in V0 by GOBOARD6:4;
A4: V0 c= cl_Ball(O,|.p2.|+1) by METRIC_1:15;
  reconsider K0=cl_Ball(O,|.p2.|+1)
  as non empty compact Subset of TOP-REAL 2 by A3,A4,Th22;
  reconsider u2=p2 as Point of Euclid 2;
A5: (cn-FanMorphS).:K0 c= K0
  proof
    let y be set;
    assume y in (cn-FanMorphS).:K0;
    then consider x being set such that
A6: x in dom (cn-FanMorphS) & x in K0 & y=(cn-FanMorphS).x by FUNCT_1:def 12;
    reconsider q=x as Point of TOP-REAL 2 by A6;
    reconsider uq=q as Point of Euclid 2;
A7: y in rng (cn-FanMorphS) by A6,FUNCT_1:def 5;
    then reconsider u=y as Point of Euclid 2;
    reconsider q4=y as Point of TOP-REAL 2 by A7;
A8: |.q4.|=|.q.| by A6,Th135;
    dist(O,uq)<= |.p2.|+1 by A6,METRIC_1:13;
    then |.0.REAL 2 - q.|<= |.p2.|+1 by JGRAPH_1:45;
    then |.0.REAL 2 +- q.|<= |.p2.|+1 by EUCLID:45;
    then |. -q.|<= |.p2.|+1 by EUCLID:31;
    then |.q.|<= |.p2.|+1 by TOPRNS_1:27;
    then |. -q4.|<= |.p2.|+1 by A8,TOPRNS_1:27;
    then |.0.REAL 2 +- q4.|<= |.p2.|+1 by EUCLID:31;
    then |.0.REAL 2 - q4.|<= |.p2.|+1 by EUCLID:45;
    then dist(O,u)<= |.p2.|+1 by JGRAPH_1:45;
    hence y in K0 by METRIC_1:13;
  end;
  K0 c= (cn-FanMorphS).:K0
  proof
    let y be set;
    assume
A9: y in K0;
    reconsider q4=y as Point of TOP-REAL 2 by A9;
    the carrier of TOP-REAL 2 c= rng (cn-FanMorphS) by A1,Th141;
    then q4 in rng (cn-FanMorphS) by TARSKI:def 3;
    then consider x being set such that
A10: x in dom (cn-FanMorphS) & y=(cn-FanMorphS).x by FUNCT_1:def 5;
    reconsider q=x as Point of TOP-REAL 2 by A10;
    |.q4.|=|.q.| by A10,Th135;
    then q in K0 by A9,Lm11;
    hence y in (cn-FanMorphS).:K0 by A10,FUNCT_1:def 12;
  end;
  then
A11: K0= (cn-FanMorphS).:K0 by A5,XBOOLE_0:def 10;
  |. -p2.|<|.p2.|+1 by A2,TOPRNS_1:27;
  then |.0.REAL 2 +- p2.|<|.p2.|+1 by EUCLID:31;
  then |.0.REAL 2 - p2.|<|.p2.|+1 by EUCLID:45;
  then dist(O,u2)<|.p2.|+1 by JGRAPH_1:45;
  then
A12: p2 in V0 by METRIC_1:12;
A13: V0 is open by TOPMETR:21;
  set q3= (cn-FanMorphS).p2;
  reconsider u3=q3 as Point of Euclid 2;
  |.q3.|=|.p2.| by Th135;
  then |.-q3.|<|.p2.|+1 by A2,TOPRNS_1:27;
  then |.0.REAL 2 +- q3.|<|.p2.|+1 by EUCLID:31;
  then |.0.REAL 2 - q3.|<|.p2.|+1 by EUCLID:45;
  then dist(O,u3)< |.p2.|+1 by JGRAPH_1:45;
  then (cn-FanMorphS).p2 in V0 by METRIC_1:12;
  hence thesis by A11,A12,A13,METRIC_1:15;
end;

theorem
  for cn being Real st -1<cn & cn<1
  ex f being Function of TOP-REAL 2,TOP-REAL 2 st f=cn-FanMorphS
  & f is being_homeomorphism
proof
  let cn be Real;
  assume
A1: -1<cn & cn<1;
  then
A2: cn-FanMorphS is Function of TOP-REAL 2,TOP-REAL 2 &
  rng (cn-FanMorphS) = the carrier of TOP-REAL 2 by Th141;
  set f=cn-FanMorphS;
A3: cn-FanMorphS is continuous by A1,Th139;
A4: f is one-to-one by A1,Th140;
  for p2 being Point of TOP-REAL 2
  ex K being non empty compact Subset of TOP-REAL 2 st K = f.:K &
  (ex V2 being Subset of TOP-REAL 2 st
  p2 in V2 & V2 is open & V2 c= K & f.p2 in V2) by A1,Th142;
  then f is being_homeomorphism by A2,A3,A4,Th8;
  hence thesis;
end;

theorem Th144:
  for cn being Real,q being Point of TOP-REAL 2 st -1<cn & cn<1 & q`2<0
  & q`1/|.q.|>=cn holds (for p being Point of TOP-REAL 2 st
  p=(cn-FanMorphS).q holds p`2<0 & p`1>=0)
proof
  let cn be Real,q be Point of TOP-REAL 2;
  assume
A1: -1<cn & cn<1 & q`2<0 & q`1/|.q.|>=cn;
  let p be Point of TOP-REAL 2;
  assume p=(cn-FanMorphS).q;
  then
A3: p=|[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
  |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by A1,Th120;
  set qz=p;
A4: |.q.|<>0 by A1,JGRAPH_2:11,TOPRNS_1:25;
  then
A5: (|.q.|)^2>0 by SQUARE_1:74;
A6: 1-cn>0 by A1,XREAL_1:151;
A7: qz`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))&
  qz`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by A3,EUCLID:56;
A8: (q`1/|.q.|-cn)>= 0 by A1,XREAL_1:50;
A9: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
  0+(q`1)^2<(q`1)^2+(q`2)^2 by A1,SQUARE_1:74,XREAL_1:10;
  then (q`1)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A5,A9,XREAL_1:76;
  then (q`1)^2/(|.q.|)^2 < 1 by A5,XCMPLX_1:60;
  then ((q`1)/|.q.|)^2 < 1 by XCMPLX_1:77;
  then 1>q`1/|.q.| by SQUARE_1:122;
  then
A10: 1-cn>q`1/|.q.|-cn by XREAL_1:11;
A11: -(1-cn)< -0 by A6,XREAL_1:26;
  -(1-cn)< -( q`1/|.q.|-cn) by A10,XREAL_1:26;
  then (-(1-cn))/(1-cn)<(-( q`1/|.q.|-cn))/(1-cn) by A6,XREAL_1:76;
  then
A12: -1<(-( q`1/|.q.|-cn))/(1-cn) by A6,XCMPLX_1:198;
  --(1-cn)> -(q`1/|.q.|-cn) by A8,A11,XREAL_1:26;
  then (-(q`1/|.q.|-cn))/(1-cn)<1 by A6,XREAL_1:193;
  then ((-(q`1/|.q.|-cn))/(1-cn))^2<1^2 by A12,SQUARE_1:120;
  then
A13: -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)< 0 by Lm12;
  ((q`1/|.q.|-cn)/(1-cn))>=0 by A6,A8;
  hence thesis by A4,A7,A13,XREAL_1:134;
end;

theorem Th145:
  for cn being Real,q being Point of TOP-REAL 2 st -1<cn & cn<1 & q`2<0
  & q`1/|.q.|<cn holds (for p being Point of TOP-REAL 2 st
  p=(cn-FanMorphS).q holds p`2<0 & p`1<0)
proof
  let cn be Real,q be Point of TOP-REAL 2;
  assume
A1: -1<cn & cn<1 & q`2<0 & q`1/|.q.|<cn;
  let p be Point of TOP-REAL 2;
  assume p=(cn-FanMorphS).q;
  then
A3: p=|[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
  |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]| by A1,Th121;
  set qz=p;
A4: |.q.|<>0 by A1,JGRAPH_2:11,TOPRNS_1:25;
  then
A5: (|.q.|)^2>0 by SQUARE_1:74;
A6: (q`1/|.q.|-cn)< 0 by A1,XREAL_1:51;
A7: 1+cn>0 by A1,XREAL_1:150;
A8: qz`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))&
  qz`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by A3,EUCLID:56;
A9: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
  0+(q`1)^2<(q`1)^2+(q`2)^2 by A1,SQUARE_1:74,XREAL_1:10;
  then (q`1)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A5,A9,XREAL_1:76;
  then (q`1)^2/(|.q.|)^2 < 1 by A5,XCMPLX_1:60;
  then ((q`1)/|.q.|)^2 < 1 by XCMPLX_1:77;
  then -1<q`1/|.q.| by SQUARE_1:122;
  then -1-cn<q`1/|.q.|-cn by XREAL_1:11;
  then -(1+cn) < (q`1/|.q.|-cn);
  then
A10: --(1+cn)> -(q`1/|.q.|-cn) by XREAL_1:26;
A11: -( q`1/|.q.|-cn)>0 by A6,XREAL_1:60;
  (-(1+cn))/(1+cn)<(-( q`1/|.q.|-cn))/(1+cn) by A7,A11,XREAL_1:76;
  then
A12: -1<(-( q`1/|.q.|-cn))/(1+cn) by A7,XCMPLX_1:198;
  (-(q`1/|.q.|-cn))/(1+cn)<1 by A7,A10,XREAL_1:193;
  then ((-(q`1/|.q.|-cn))/(1+cn))^2<1^2 by A12,SQUARE_1:120;
  then 1-((-(q`1/|.q.|-cn))/(1+cn))^2>0 by XREAL_1:52;
  then sqrt(1-((-(q`1/|.q.|-cn))/(1+cn))^2)>0 by SQUARE_1:93;
  then sqrt(1-(-(q`1/|.q.|-cn))^2/(1+cn)^2)> 0 by XCMPLX_1:77;
  then sqrt(1-(q`1/|.q.|-cn)^2/(1+cn)^2)> 0;
  then --sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)> 0 by XCMPLX_1:77;
  then
A13: -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)< 0;
  ((q`1/|.q.|-cn)/(1+cn))<0 by A6,A7,XREAL_1:143;
  hence thesis by A4,A8,A13,XREAL_1:134;
end;

theorem Th146:
  for cn being Real,q1,q2 being Point of TOP-REAL 2 st -1<cn & cn<1 & q1`2<0
  & q1`1/|.q1.|>=cn & q2`2<0 & q2`1/|.q2.|>=cn & q1`1/|.q1.|<q2`1/|.q2.|
  holds (for p1,p2 being Point of TOP-REAL 2 st
  p1=(cn-FanMorphS).q1 & p2=(cn-FanMorphS).q2 holds p1`1/|.p1.|<p2`1/|.p2.|)
proof
  let cn be Real,q1,q2 be Point of TOP-REAL 2;
  assume
A1: -1<cn & cn<1 & q1`2<0
  & q1`1/|.q1.|>=cn & q2`2<0 & q2`1/|.q2.|>=cn & q1`1/|.q1.|<q2`1/|.q2.|;
  let p1,p2 be Point of TOP-REAL 2;
  assume
A2: p1=(cn-FanMorphS).q1 & p2=(cn-FanMorphS).q2;
  then p1=|[ |.q1.|* ((q1`1/|.q1.|-cn)/(1-cn)),
  |.q1.|*( -sqrt(1-((q1`1/|.q1.|-cn)/(1-cn))^2))]| by A1,Th120;
  then
A3: p1`2= |.q1.|*( -sqrt(1-((q1`1/|.q1.|-cn)/(1-cn))^2))&
  p1`1= |.q1.|* ((q1`1/|.q1.|-cn)/(1-cn)) by EUCLID:56;
  p2=|[ |.q2.|* ((q2`1/|.q2.|-cn)/(1-cn)),
  |.q2.|*( -sqrt(1-((q2`1/|.q2.|-cn)/(1-cn))^2))]| by A1,A2,Th120;
  then
A4: p2`2= |.q2.|*( -sqrt(1-((q2`1/|.q2.|-cn)/(1-cn))^2))&
  p2`1= |.q2.|* ((q2`1/|.q2.|-cn)/(1-cn)) by EUCLID:56;
A5: |.q1.|>0 & |.q2.|>0 by A1,Lm1,JGRAPH_2:11;
A6: |.p1.|=|.q1.| & |.p2.|=|.q2.| by A2,Th135;
  then
A7: p1`1/|.p1.|= ((q1`1/|.q1.|-cn)/(1-cn)) by A3,A5,XCMPLX_1:90;
A8: p2`1/|.p2.|= ((q2`1/|.q2.|-cn)/(1-cn)) by A4,A5,A6,XCMPLX_1:90;
A9: q1`1/|.q1.|-cn< q2`1/|.q2.|-cn by A1,XREAL_1:11;
  1-cn>0 by A1,XREAL_1:151;
  hence thesis by A7,A8,A9,XREAL_1:76;
end;

theorem Th147:
  for cn being Real,q1,q2 being Point of TOP-REAL 2 st -1<cn & cn<1 & q1`2<0
  & q1`1/|.q1.|<cn & q2`2<0 & q2`1/|.q2.|<cn & q1`1/|.q1.|<q2`1/|.q2.|
  holds (for p1,p2 being Point of TOP-REAL 2 st
  p1=(cn-FanMorphS).q1 & p2=(cn-FanMorphS).q2 holds p1`1/|.p1.|<p2`1/|.p2.|)
proof
  let cn be Real,q1,q2 be Point of TOP-REAL 2;
  assume
A1: -1<cn & cn<1 & q1`2<0
  & q1`1/|.q1.|<cn & q2`2<0 & q2`1/|.q2.|<cn & q1`1/|.q1.|<q2`1/|.q2.|;
  let p1,p2 be Point of TOP-REAL 2;
  assume
A2: p1=(cn-FanMorphS).q1 & p2=(cn-FanMorphS).q2;
  then p1=|[ |.q1.|* ((q1`1/|.q1.|-cn)/(1+cn)),
  |.q1.|*( -sqrt(1-((q1`1/|.q1.|-cn)/(1+cn))^2))]| by A1,Th121;
  then
A3: p1`2= |.q1.|*( -sqrt(1-((q1`1/|.q1.|-cn)/(1+cn))^2))&
  p1`1= |.q1.|* ((q1`1/|.q1.|-cn)/(1+cn)) by EUCLID:56;
  p2=|[ |.q2.|* ((q2`1/|.q2.|-cn)/(1+cn)),
  |.q2.|*( -sqrt(1-((q2`1/|.q2.|-cn)/(1+cn))^2))]| by A1,A2,Th121;
  then
A4: p2`2= |.q2.|*( -sqrt(1-((q2`1/|.q2.|-cn)/(1+cn))^2))&
  p2`1= |.q2.|* ((q2`1/|.q2.|-cn)/(1+cn)) by EUCLID:56;
A5: |.q1.|>0 & |.q2.|>0 by A1,Lm1,JGRAPH_2:11;
A6: |.p1.|=|.q1.| & |.p2.|=|.q2.| by A2,Th135;
  then
A7: p1`1/|.p1.|= (q1`1/|.q1.|-cn)/(1+cn) by A3,A5,XCMPLX_1:90;
A8: p2`1/|.p2.|= (q2`1/|.q2.|-cn)/(1+cn) by A4,A5,A6,XCMPLX_1:90;
A9: q1`1/|.q1.|-cn< q2`1/|.q2.|-cn by A1,XREAL_1:11;
  1+cn>0 by A1,XREAL_1:150;
  hence p1`1/|.p1.|<p2`1/|.p2.| by A7,A8,A9,XREAL_1:76;
end;

theorem
  for cn being Real,q1,q2 being Point of TOP-REAL 2 st -1<cn & cn<1 & q1`2<0
  & q2`2<0 & q1`1/|.q1.|<q2`1/|.q2.|
  holds (for p1,p2 being Point of TOP-REAL 2 st
  p1=(cn-FanMorphS).q1 & p2=(cn-FanMorphS).q2 holds p1`1/|.p1.|<p2`1/|.p2.|)
proof
  let cn be Real,q1,q2 be Point of TOP-REAL 2;
  assume
A1: -1<cn & cn<1 & q1`2<0 & q2`2<0 & q1`1/|.q1.|<q2`1/|.q2.|;
  let p1,p2 be Point of TOP-REAL 2;
  assume
A2: p1=(cn-FanMorphS).q1 & p2=(cn-FanMorphS).q2;
  per cases;
  suppose q1`1/|.q1.|>=cn & q2`1/|.q2.|>=cn;
    hence p1`1/|.p1.|<p2`1/|.p2.| by A1,A2,Th146;
  end;
  suppose q1`1/|.q1.|>=cn & q2`1/|.q2.|<cn;
    hence p1`1/|.p1.|<p2`1/|.p2.| by A1,XXREAL_0:2;
  end;
  suppose
A3: q1`1/|.q1.|<cn & q2`1/|.q2.|>=cn;
    then
A4: p1`2<0 & p1`1<0 by A1,A2,Th145;
    then
A5: |.p1.|>0 by Lm1,JGRAPH_2:11;
    p2`2<0 & p2`1>=0 by A1,A2,A3,Th144;
    then p2`1/|.p2.|>=0;
    hence p1`1/|.p1.|<p2`1/|.p2.| by A4,A5,XREAL_1:143;
  end;
  suppose q1`1/|.q1.|<cn & q2`1/|.q2.|<cn;
    hence p1`1/|.p1.|<p2`1/|.p2.| by A1,A2,Th147;
  end;
end;

theorem
  for cn being Real,q being Point of TOP-REAL 2 st -1<cn & cn<1 & q`2<0
  & q`1/|.q.|=cn holds (for p being Point of TOP-REAL 2 st
  p=(cn-FanMorphS).q holds p`2<0 & p`1=0)
proof
  let cn be Real,q be Point of TOP-REAL 2;
  assume
A1: -1<cn & cn<1 & q`2<0 & q`1/|.q.|=cn;
  let p be Point of TOP-REAL 2;
  assume p=(cn-FanMorphS).q;
  then
A3: p=|[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
  |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by A1,Th120;
A4: |.q.|<>0 by A1,JGRAPH_2:11,TOPRNS_1:25;
  p`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))&
  p`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by A3,EUCLID:56;
  hence thesis by A1,A4,Lm12,XREAL_1:134;
end;

theorem
  for cn being real number holds 0.REAL 2=(cn-FanMorphS).(0.REAL 2)
  by Th120,JGRAPH_2:11;

