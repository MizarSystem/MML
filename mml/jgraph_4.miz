:: Fan Homeomorphisms in the Plane
::  by Yatsuka Nakamura
::
:: Received January 8, 2002
:: Copyright (c) 2002 Association of Mizar Users

environ

 vocabularies FUNCT_1, BOOLE, ABSVALUE, EUCLID, PRE_TOPC, JORDAN2C, SQUARE_1,
      RELAT_1, SUBSET_1, ARYTM_3, METRIC_1, RCOMP_1, FUNCT_4, FUNCT_5, TOPMETR,
      COMPTS_1, JGRAPH_4, ORDINAL2, TOPS_2, ARYTM_1, CARD_3, COMPLEX1, MCART_1,
      PARTFUN1, LATTICES, ARYTM, NAT_1;
 notations TARSKI, XBOOLE_0, SUBSET_1, ORDINAL1, NUMBERS, XCMPLX_0, XREAL_0,
      REAL_1, COMPLEX1, RELAT_1, FUNCT_1, RELSET_1, FUNCT_2, DOMAIN_1,
      STRUCT_0, PARTFUN1, TOPMETR, EUCLID, COMPTS_1, TOPS_2, METRIC_1,
      SQUARE_1, TBSP_1, RCOMP_1, PSCOMP_1, PRE_TOPC, JORDAN2C, FUNCT_4,
      XXREAL_0;
 constructors FUNCT_4, REAL_1, SQUARE_1, BINOP_2, COMPLEX1, RCOMP_1, FINSEQ_4,
      TOPS_2, COMPTS_1, TBSP_1, MONOID_0, TOPMETR, PSCOMP_1, JORDAN2C;
 registrations XBOOLE_0, RELAT_1, NUMBERS, XXREAL_0, XREAL_0, SQUARE_1,
      MEMBERED, STRUCT_0, PRE_TOPC, METRIC_1, BORSUK_1, MONOID_0, EUCLID,
      TOPMETR, TOPREAL1, PSCOMP_1, JORDAN6;
 requirements REAL, NUMERALS, BOOLE, SUBSET, ARITHM;
 definitions TARSKI, SQUARE_1, EUCLID, STRUCT_0, PCOMPS_1;
 theorems TARSKI, RELAT_1, SUBSET_1, FUNCT_1, FUNCT_2, FUNCT_4, TOPS_1, TOPS_2,
      PARTFUN1, PRE_TOPC, FRECHET, TOPMETR, JORDAN6, EUCLID, REAL_1, REAL_2,
      JGRAPH_1, SQUARE_1, PSCOMP_1, METRIC_1, JGRAPH_2, GOBOARD6, GOBOARD9,
      TBSP_1, TOPREAL3, TOPREAL6, JGRAPH_3, ABSVALUE, JORDAN2C, TSEP_1,
      XREAL_0, XBOOLE_0, XBOOLE_1, TOPRNS_1, SEQ_2, XCMPLX_0, XCMPLX_1,
      COMPLEX1, XREAL_1, JORDAN2B, RCOMP_1, XXREAL_0;
 schemes FUNCT_2, DOMAIN_1, JGRAPH_2, BINOP_2, JGRAPH_3;

begin :: Preliminaries

 reserve x,a for real number;
 reserve p,q for Point of TOP-REAL 2;

Lm1:p <> 0.REAL 2 implies |.p.| > 0
proof
  assume p <> 0.REAL 2;
then |.p.| <> 0 by TOPRNS_1:25;
  hence thesis;
end;

 Lm2: for a being real number st a^2<=1 holds -1<=a & a<=1
by SQUARE_1:121;

 Lm3: for a being real number st a^2<1 holds -1<a & a<1
by SQUARE_1:122;

canceled 5;

theorem Th6:
for X being non empty TopStruct,
    g being Function of X,R^1, B being Subset of X,
    a being real number st g is continuous &
B = {p where p is Point of X: pi(g,p) > a } holds B is open
proof let X be non empty TopStruct,g be Function of X,R^1,B be Subset of X,
          a be real number;
 assume A1: g is continuous & B={p where p is Point of X:pi(g,p) > a };
   {r where r is Real: r>a} c= the carrier of R^1
   proof let x be set;assume x in {r where r is Real: r>a};
    then consider r being Real such that
A2: r=x & r>a;
    thus x in the carrier of R^1 by A2,TOPMETR:24;
   end;
  then reconsider D={r where r is Real: r>a} as Subset of R^1;
  A3: D is open by JORDAN2B:31;
  A4: B c= g"D
   proof let x be set;assume x in B;
     then consider p being Point of X such that
     A5:  p=x & pi(g,p) > a by A1;
     A6: dom g=the carrier of X by FUNCT_2:def 1;
A7:   pi(g,p) is Real by XREAL_0:def 1;
      pi(g,p)=g.p by JORDAN2C:def 10;
     then x in dom g & g.x in D by A5,A6,A7;
    hence x in g"D by FUNCT_1:def 13;
   end;
   g"D c= B
   proof let x be set;assume
A8:  x in g"D;
     then x in dom g & g.x in D by FUNCT_1:def 13;
     then consider r being Real such that
A9:  r=g.x & r>a;
     reconsider p=x as Point of X by A8;
     pi(g,p)=g.p by JORDAN2C:def 10;
    hence x in B by A1,A9;
   end;
  then B=g"D by A4,XBOOLE_0:def 10;
 hence B is open by A1,A3,TOPS_2:55;
end;

theorem Th7:
 for X being non empty TopStruct,
     g being Function of X,R^1,B being Subset of X,
     a being Real st g is continuous &
 B={p where p is Point of X: pi(g,p) < a } holds B is open
proof let X be non empty TopStruct,g be Function of X,R^1,
B be Subset of X,a be Real;
 assume A1: g is continuous & B={p where p is Point of X:pi(g,p) < a };
      {r where r is Real: r<a} c= the carrier of R^1
   proof let x be set;assume x in {r where r is Real: r<a};
     then consider r being Real such that
A2: r=x & r<a;
    thus x in the carrier of R^1 by A2,TOPMETR:24;
   end;
  then reconsider D={r where r is Real: r<a} as Subset of R^1;
  A3: D is open by JORDAN2B:30;
  A4: B c= g"D
   proof let x be set;assume x in B;
     then consider p being Point of X such that
A5:  p=x & pi(g,p) < a by A1;
A6:  dom g=the carrier of X by FUNCT_2:def 1;
A7:  pi(g,p) is Real by XREAL_0:def 1;
     pi(g,p)=g.p by JORDAN2C:def 10;
     then x in dom g & g.x in D by A5,A6,A7;
    hence x in g"D by FUNCT_1:def 13;
   end;
   g"D c= B
   proof let x be set;assume
A8:  x in g"D;
     then x in dom g & g.x in D by FUNCT_1:def 13;
     then consider r being Real such that
A9:  r=g.x & r<a;
     reconsider p=x as Point of X by A8;
     pi(g,p)=g.p by JORDAN2C:def 10;
    hence x in B by A1,A9;
   end;
  then B=g"D by A4,XBOOLE_0:def 10;
 hence B is open by A1,A3,TOPS_2:55;
end;

theorem Th8: for f being Function of TOP-REAL 2,TOP-REAL 2 st
 f is continuous one-to-one & rng f=[#](TOP-REAL 2) &
   (for p2 being Point of TOP-REAL 2
   ex K being non empty compact Subset of TOP-REAL 2 st K = f.:K &
  (ex V2 being Subset of TOP-REAL 2 st
   p2 in V2 & V2 is open & V2 c= K & f.p2 in V2))
holds f is_homeomorphism
proof let f be Function of TOP-REAL 2,TOP-REAL 2;
  assume A1: f is continuous one-to-one & rng f=[#](TOP-REAL 2)
  & (for p2 being Point of TOP-REAL 2
  ex K being non empty compact Subset of TOP-REAL 2 st K = f.:K &
 (ex V2 being Subset of TOP-REAL 2 st
  p2 in V2 & V2 is open & V2 c= K & f.p2 in V2));
  A2: dom f=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
  then A3: dom f=[#](TOP-REAL 2);
  reconsider g=(f qua Function)"
          as Function of TOP-REAL 2,TOP-REAL 2 by A1,FUNCT_2:31;
  for p being Point of TOP-REAL 2, V being Subset of
  TOP-REAL 2 st g.p in V & V is open ex W being Subset of TOP-REAL 2 st
  p in W & W is open & g.:W c= V
   proof let p be Point of TOP-REAL 2, V be Subset of TOP-REAL 2;
    assume A4: g.p in V & V is open;
  consider K being non empty compact Subset of TOP-REAL 2 such that
  A5: K = f.:K & (ex V2 being Subset of TOP-REAL 2 st
  g.p in V2 & V2 is open & V2 c= K & f.(g.p) in V2) by A1;
  consider V2 being Subset of TOP-REAL 2 such that
  A6: g.p in V2 & V2 is open & V2 c= K & f.(g.p) in V2 by A5;
     A7: g.p in V2 & V2 is open & V2 c= K & p in V2 by A1,A6,FUNCT_1:57;
     A8: dom (f|K)=dom f /\ K by FUNCT_1:68
      .=(the carrier of TOP-REAL 2)/\ K by FUNCT_2:def 1
      .=K by XBOOLE_1:28
      .=the carrier of ((TOP-REAL 2)|K) by PRE_TOPC:29;
     rng (f|K) c= the carrier of TOP-REAL 2;
     then reconsider h=f|K as Function of (TOP-REAL 2)|K,TOP-REAL 2
                           by A8,FUNCT_2:4;
     A9: h is continuous by A1,TOPMETR:10;
     A10: h is one-to-one by A1,FUNCT_1:84;
     A11: dom (f|K)=dom f /\ K by RELAT_1:90 .=K by A2,XBOOLE_1:28;
     A12:K=(f|K).:K by A5,RELAT_1:162 .=rng (f|K)
                      by A11,RELAT_1:146;
     then consider f1 being Function of (TOP-REAL 2)|K,(TOP-REAL 2)|K such that
     A13: h=f1 & f1 is_homeomorphism by A9,A10,JGRAPH_1:64;
     A14: rng f1=[#]((TOP-REAL 2)|K) by A13,TOPS_2:def 5;
     the carrier of ((TOP-REAL 2)|K)=K by PRE_TOPC:29;
     then reconsider R=V /\ V2 /\ K as Subset of (TOP-REAL 2)|K
                                by XBOOLE_1:17;
     A15: V /\ V2 is open by A4,A6,TOPS_1:38;
     R=V /\ V2 /\ [#]((TOP-REAL 2)|K) by PRE_TOPC:def 10;
     then A16: R is open by A15,TOPS_2:32;
     A17: g.p in V /\ V2 by A4,A6,XBOOLE_0:def 3;
     A18: f1.((f1 qua Function)".p)=p by A7,A10,A12,A13,FUNCT_1:57;
     A19: f1.(g.p)=f.(g.p) by A6,A13,FUNCT_1:72.=p
                                  by A1,FUNCT_1:57;
     A20: dom f1=dom f /\ K by A13,FUNCT_1:68 .=K by A2,XBOOLE_1:28;
     A21: rng ((f1 qua Function)")=dom f1 by A10,A13,FUNCT_1:55;
      rng f1=dom ((f1 qua Function)") by A10,A13,FUNCT_1:55;
      then ((f1 qua Function)").p in rng ((f1 qua Function)")
                         by A7,A12,A13,FUNCT_1:12;
     then A22: ((f1 qua Function)").p=g.p by A5,A10,A13,A18,A19,A20,A21,
FUNCT_1:def 8;
     reconsider q=p as Point of ((TOP-REAL 2)|K) by A7,PRE_TOPC:29;
A23: ((f1 qua Function)").p in R by A6,A17,A22,XBOOLE_0:def 3;
A24: dom ((f1 qua Function)")=rng f1 by A10,A13,FUNCT_1:54;
A25: rng ((f1 qua Function)")=dom f1 by A10,A13,FUNCT_1:55;
A26: dom f1=the carrier of (TOP-REAL 2)|K by FUNCT_2:def 1;
A27: rng f1 = the carrier of (TOP-REAL 2)|K by A14;
     then reconsider g1=(f1 qua Function)" as Function
 of (TOP-REAL 2)|K,(TOP-REAL 2)|K by A24,A25,FUNCT_2:4;
     g1=f1" by A10,A13,A14,TOPS_2:def 4;
     then g1 is continuous by A13,TOPS_2:def 5;
     then consider W3 being Subset of (TOP-REAL 2)|K such that
A28: q in W3 & W3 is open & ((f1 qua Function)").:W3 c= R
                        by A16,A23,JGRAPH_2:20;
A29: ((f qua Function)").:W3 c= R
     proof let y be set;assume y in ((f qua Function)").:W3;
       then consider x being set such that
       A30: x in dom ((f qua Function)") & x in W3 & y=((f qua Function)").x
               by FUNCT_1:def 12;
           x in rng f by A1,A30,FUNCT_1:55;
       then A31: y in dom f & f.y=x by A1,A30,FUNCT_1:54;
       A32: dom ((f1 qua Function)")=the carrier of (TOP-REAL 2)|K by A10,A13
,A27,FUNCT_1:55;
       the carrier of (TOP-REAL 2)|K=K by PRE_TOPC:29;
       then consider z2 being set such that
A33:   z2 in dom f & z2 in K & f.y=f.z2 by A5,A30,A31,FUNCT_1:def 12;
A34:   y in K by A1,A31,A33,FUNCT_1:def 8;
       then A35: y in the carrier of ((TOP-REAL 2)|K) by PRE_TOPC:29;
       f1.y=x by A13,A31,A34,FUNCT_1:72;
       then x in dom ((f1 qua Function)") & y=((f1 qua Function)").x
                         by A10,A13,A26,A30,A32,A35,FUNCT_1:54;
       then y in ((f1 qua Function)").:W3 by A30,FUNCT_1:def 12;
      hence y in R by A28;
     end;
     consider W5 being Subset of TOP-REAL 2 such that
A36: W5 is open & W3=W5 /\ [#]((TOP-REAL 2)|K) by A28,TOPS_2:32;
     reconsider W4=W5 /\ V2 as Subset of TOP-REAL 2;
     p in W5 by A28,A36,XBOOLE_0:def 3;
     then A37: p in W4 by A7,XBOOLE_0:def 3;
A38: W4 is open by A6,A36,TOPS_1:38;
         W4=W5 /\ (V2 /\ K) by A6,XBOOLE_1:28
       .=W5 /\ K /\ V2 by XBOOLE_1:16
       .=W3 /\ V2 by A36,PRE_TOPC:def 10;
     then A39: g.:W4 c= g.:W3 /\ g.:V2 by RELAT_1:154;
     g.:W3 /\ g.:V2 c= g.:W3 by XBOOLE_1:17;
     then g.:W4 c= g.:W3 by A39,XBOOLE_1:1;
     then A40: g.:W4 c= R by A29,XBOOLE_1:1;
     R=V /\ (V2 /\ K) by XBOOLE_1:16;
     then R c= V by XBOOLE_1:17;
     then g.:W4 c= V by A40,XBOOLE_1:1;
    hence ex W being Subset of TOP-REAL 2 st
     p in W & W is open & g.:W c= V by A37,A38;
   end;
  then A41: g is continuous by JGRAPH_2:20;
  g=f" by A1,TOPS_2:def 4;
 hence f is_homeomorphism by A1,A3,A41,TOPS_2:def 5;
end;

theorem Th9: for X being non empty TopSpace,
 f1,f2 being Function of X,R^1,a,b being real number st f1 is continuous &
 f2 is continuous & b<>0 & (for q being Point of X holds f2.q<>0)
 holds ex g being Function of X,R^1
  st (for p being Point of X,r1,r2 being real number st
  f1.p=r1 & f2.p=r2 holds g.p=(r1/r2-a)/b) & g is continuous
proof let X be non empty TopSpace,
  f1,f2 be Function of X,R^1,a,b be real number;
 assume A1:f1 is continuous & f2 is continuous & b<>0 &
   (for q being Point of X holds f2.q<>0);
   consider g1 being Function of X,R^1 such that A2: for p being Point of X
    holds g1.p=b & g1 is continuous by JGRAPH_2:30;
   consider g2 being Function of X,R^1 such that A3: for p being Point of X
    holds g2.p=a & g2 is continuous by JGRAPH_2:30;
   consider g3 being Function of X,R^1 such that
A4: (for p being Point of X,r1,r0 being real number st
    f1.p=r1 & f2.p=r0 holds g3.p=r1/r0) & g3 is continuous
                          by A1,JGRAPH_2:37;
   consider g4 being Function of X,R^1 such that
A5: (for p being Point of X,r1,r0 being real number st
    g3.p=r1 & g2.p=r0 holds g4.p=r1-r0) & g4 is continuous
                          by A3,A4,JGRAPH_2:31;
   for q being Point of X holds g1.q<>0 by A1,A2;
   then consider g5 being Function of X,R^1
    such that A6: (for p being Point of X,r1,r0 being real number st
    g4.p=r1 & g1.p=r0 holds g5.p=r1/r0) & g5 is continuous
                          by A2,A5,JGRAPH_2:37;
    for p being Point of X,r1,r2 being real number st
    f1.p=r1 & f2.p=r2 holds g5.p=(r1/r2-a)/b
    proof let p be Point of X,r1,r2 be real number;
     assume A7:f1.p=r1 & f2.p=r2;
A8:  g1.p=b by A2;
A9:  g2.p=a by A3;
     set r8=r1/r2;
     g3.p=r8 by A4,A7;
     then g4.p=r8-a by A5,A9;
     hence g5.p=(r1/r2-a)/b by A6,A8;
    end;
  hence thesis by A6;
end;

theorem Th10: for X being non empty TopSpace,
 f1,f2 being Function of X,R^1,a,b being Real st f1 is continuous &
 f2 is continuous & b<>0 & (for q being Point of X holds f2.q<>0)
 holds ex g being Function of X,R^1
  st (for p being Point of X,r1,r2 being Real st
  f1.p=r1 & f2.p=r2 holds g.p=r2*((r1/r2-a)/b)) & g is continuous
proof let X be non empty TopSpace, f1,f2 be Function of X,R^1,a,b be Real;
 assume A1:f1 is continuous & f2 is continuous & b<>0 &
   (for q being Point of X holds f2.q<>0);
   consider g1 being Function of X,R^1 such that
A2: for p being Point of X
    holds g1.p=b & g1 is continuous by JGRAPH_2:30;
    consider g2 being Function of X,R^1 such that
A3: for p being Point of X
    holds g2.p=a & g2 is continuous by JGRAPH_2:30;
    consider g3 being Function of X,R^1 such that
A4: (for p being Point of X,r1,r0 being real number st
    f1.p=r1 & f2.p=r0 holds g3.p=r1/r0) & g3 is continuous
                          by A1,JGRAPH_2:37;
   consider g4 being Function of X,R^1 such that
A5: (for p being Point of X,r1,r0 being real number st
    g3.p=r1 & g2.p=r0 holds g4.p=r1-r0) & g4 is continuous
                          by A3,A4,JGRAPH_2:31;
   for q being Point of X holds g1.q<>0 by A1,A2;
   then consider g5 being Function of X,R^1 such that
A6: (for p being Point of X,r1,r0 being real number st
    g4.p=r1 & g1.p=r0 holds g5.p=r1/r0) & g5 is continuous
                          by A2,A5,JGRAPH_2:37;
   consider g6 being Function of X,R^1
    such that A7: (for p being Point of X,r1,r0 being real number st
    f2.p=r1 & g5.p=r0 holds g6.p=r1*r0) & g6 is continuous
                          by A1,A6,JGRAPH_2:35;
    for p being Point of X,r1,r2 being Real st
    f1.p=r1 & f2.p=r2 holds g6.p=r2*((r1/r2-a)/b)
    proof let p be Point of X,r1,r2 be Real;
     assume A8:f1.p=r1 & f2.p=r2;
A9:  g1.p=b by A2;
A10: g2.p=a by A3;
     set r8=r1/r2;
     g3.p=r8 by A4,A8;
     then g4.p=r8-a by A5,A10;
     then g5.p=(r1/r2-a)/b by A6,A9;
     hence g6.p=r2*((r1/r2-a)/b) by A7,A8;
    end;
  hence thesis by A7;
end;

theorem Th11:
for X being non empty TopSpace, f1 being Function of X,R^1 st f1 is continuous
holds ex g being Function of X,R^1
st (for p being Point of X,r1 being real number st f1.p=r1 holds g.p=r1^2) &
 g is continuous
proof let X be non empty TopSpace, f1 be Function of X,R^1;
  assume f1 is continuous;
  then consider g1 being Function of X,R^1 such that
A1:(for p being Point of X,r1 being real number st
  f1.p=r1 holds g1.p=r1*r1) & g1 is continuous by JGRAPH_2:32;
  for p being Point of X,r1 being real number st
  f1.p=r1 holds g1.p=r1^2 by A1;
  hence thesis by A1;
end;

theorem Th12:
for X being non empty TopSpace, f1 being Function of X,R^1 st f1 is continuous
holds ex g being Function of X,R^1
st (for p being Point of X,r1 being real number st
f1.p=r1 holds g.p=abs(r1)) & g is continuous
proof let X be non empty TopSpace,
  f1 be Function of X,R^1;
  assume f1 is continuous;
   then consider g1 being Function of X,R^1 such that
A1: (for p being Point of X,r1 being real number st
    f1.p=r1 holds g1.p=r1^2) & g1 is continuous by Th11;
   for q being Point of X ex r being real number st g1.q=r & r>=0
   proof let q be Point of X;
    reconsider r11=f1.q as Real by TOPMETR:24;
A2: g1.q=r11^2 by A1;
    r11^2>=0 by XREAL_1:65;
   hence ex r being real number st g1.q=r & r>=0 by A2;
   end;
   then consider g2 being Function of X,R^1 such that
    A3: (for p being Point of X,r1 being real number st
    g1.p=r1 holds g2.p=sqrt(r1)) & g2 is continuous by A1,JGRAPH_3:15;
       for p being Point of X,r1 being real number st
    f1.p=r1 holds g2.p=abs(r1)
    proof let p be Point of X,r1 be real number;
     assume f1.p=r1;
      then g1.p=r1^2 by A1;
      then g2.p=sqrt(r1^2) by A3 .=abs(r1) by COMPLEX1:158;
     hence g2.p=abs(r1);
    end;
 hence thesis by A3;
end;

theorem Th13:
for X being non empty TopSpace, f1 being Function of X,R^1 st f1 is continuous
holds ex g being Function of X,R^1
st (for p being Point of X,r1 being real number st
f1.p=r1 holds g.p=-r1) & g is continuous
proof let X be non empty TopSpace,
f1 be Function of X,R^1;
 assume A1: f1 is continuous;
  consider g1 being Function of X,R^1 such that
  A2: (for p being Point of X holds g1.p=0) & g1 is continuous
                       by JGRAPH_2:30;
  consider g2 being Function of X,R^1
   such that A3: (for p being Point of X,r1,r2 being real number st
   g1.p=r1 & f1.p=r2 holds g2.p=r1-r2) & g2 is continuous
                   by A1,A2,JGRAPH_2:31;
   for p being Point of X,r1 being real number st
   f1.p=r1 holds g2.p=-r1
   proof let p be Point of X,r1 be real number;
    assume A4: f1.p=r1;
    g1.p=0 by A2;
    then g2.p=0-r1 by A3,A4;
    hence g2.p=-r1;
   end;
 hence thesis by A3;
end;

theorem Th14: for X being non empty TopSpace,
 f1,f2 being Function of X,R^1,a,b being real number st f1 is continuous &
 f2 is continuous & b<>0 & (for q being Point of X holds f2.q<>0)
 holds ex g being Function of X,R^1
  st (for p being Point of X,r1,r2 being real number st
  f1.p=r1 & f2.p=r2 holds g.p= r2*(-sqrt(abs(1-((r1/r2-a)/b)^2))))
  & g is continuous
 proof let X be non empty TopSpace,
   f1,f2 be Function of X,R^1,a,b be real number;
   assume A1: f1 is continuous & f2 is continuous & b<>0 &
   (for q being Point of X holds f2.q<>0);
   then consider g1 being Function of X,R^1 such that
A2: (for p being Point of X,r1,r2 being real number st
    f1.p=r1 & f2.p=r2 holds g1.p=(r1/r2-a)/b) & g1 is continuous by Th9;
   consider g2 being Function of X,R^1 such that
A3: (for p being Point of X,s being real number st
    g1.p=s holds g2.p=s^2) & g2 is continuous by A2,Th11;
   consider g0 being Function of X,R^1 such that
A4: (for p being Point of X
     holds g0.p=1)& g0 is continuous by JGRAPH_2:30;
   consider g3 being Function of X,R^1 such that
    A5: (for p being Point of X,s,t being real number st
    g0.p=s & g2.p=t holds g3.p=s-t)
    & g3 is continuous by A3,A4,JGRAPH_2:31;
   consider g4 being Function of X,R^1 such that
    A6: (for p being Point of X,s being real number st
    g3.p=s holds g4.p=abs s)
    & g4 is continuous by A5,Th12;
       for q being Point of X ex r being real number st g4.q=r & r>=0
   proof let q be Point of X;
     reconsider s=g3.q as Real by TOPMETR:24;
     A7: g4.q=abs s by A6;
         abs s>=0 by COMPLEX1:132;
    hence ex r being real number st g4.q=r & r>=0 by A7;
   end;
   then consider g5 being Function of X,R^1 such that
A8: (for p being Point of X,s being real number st
    g4.p=s holds g5.p=sqrt(s))
    & g5 is continuous by A6,JGRAPH_3:15;
   consider g6 being Function of X,R^1 such that
    A9: (for p being Point of X,s being real number st
    g5.p=s holds g6.p=-s) & g6 is continuous by A8,Th13;
   consider g7 being Function of X,R^1
    such that A10: (for p being Point of X,r1,r0 being real number st
    f2.p=r1 & g6.p=r0 holds g7.p=r1*r0) & g7 is continuous
                          by A1,A9,JGRAPH_2:35;
    for p being Point of X,r1,r2 being real number st
    f1.p=r1 & f2.p=r2 holds g7.p= r2*(-sqrt(abs(1-((r1/r2-a)/b)^2)))
    proof let p be Point of X,r1,r2 be real number;
     assume A11: f1.p=r1 & f2.p=r2;
      A12: g0.p=1 by A4;
      g1.p=(r1/r2-a)/b by A2,A11;
      then g2.p=((r1/r2-a)/b)^2 by A3;
      then g3.p=1-((r1/r2-a)/b)^2 by A5,A12;
      then g4.p= abs(1-((r1/r2-a)/b)^2) by A6;
      then g5.p=sqrt(abs(1-((r1/r2-a)/b)^2)) by A8;
      then g6.p= -sqrt(abs(1-((r1/r2-a)/b)^2)) by A9;
     hence g7.p=r2*(-sqrt(abs(1-((r1/r2-a)/b)^2))) by A10,A11;
    end;
  hence thesis by A10;
 end;

theorem Th15: for X being non empty TopSpace,
 f1,f2 being Function of X,R^1,a,b being real number st
 f1 is continuous &
 f2 is continuous & b<>0 & (for q being Point of X holds f2.q<>0)
 holds ex g being Function of X,R^1
  st (for p being Point of X,r1,r2 being real number st
  f1.p=r1 & f2.p=r2 holds g.p= r2*(sqrt(abs(1-((r1/r2-a)/b)^2))))
  & g is continuous
 proof let X be non empty TopSpace,
   f1,f2 be Function of X,R^1,a,b be real number;
   assume A1: f1 is continuous &
   f2 is continuous & b<>0 & (for q being Point of X holds f2.q<>0);
   then consider g1 being Function of X,R^1 such that
A2: (for p being Point of X,r1,r2 being real number st
    f1.p=r1 & f2.p=r2 holds g1.p=(r1/r2-a)/b) & g1 is continuous by Th9;
   consider g2 being Function of X,R^1 such that
A3: (for p being Point of X,s being real number st
    g1.p=s holds g2.p=s^2) & g2 is continuous by A2,Th11;
   consider g0 being Function of X,R^1 such that
A4: (for p being Point of X
     holds g0.p=1)& g0 is continuous by JGRAPH_2:30;
   consider g3 being Function of X,R^1 such that
A5: (for p being Point of X,s,t being real number st
    g0.p=s & g2.p=t holds g3.p=s-t)
    & g3 is continuous by A3,A4,JGRAPH_2:31;
   consider g4 being Function of X,R^1 such that
    A6: (for p being Point of X,s being real number st
    g3.p=s holds g4.p=abs s)
    & g4 is continuous by A5,Th12;
       for q being Point of X ex r being real number st g4.q=r & r>=0
   proof let q be Point of X;
    reconsider s=g3.q as Real by TOPMETR:24;
A7: g4.q=abs s by A6;
    abs s>=0 by COMPLEX1:132;
    hence ex r being real number st g4.q=r & r>=0 by A7;
   end;
   then consider g5 being Function of X,R^1 such that
A8: (for p being Point of X,s being real number st
    g4.p=s holds g5.p=sqrt s)
    & g5 is continuous by A6,JGRAPH_3:15;
   consider g7 being Function of X,R^1 such that
A9: (for p being Point of X,r1,r0 being real number st
    f2.p=r1 & g5.p=r0 holds g7.p=r1*r0) & g7 is continuous
                          by A1,A8,JGRAPH_2:35;
       for p being Point of X,r1,r2 being real number st
    f1.p=r1 & f2.p=r2 holds g7.p= r2*( sqrt(abs(1-((r1/r2-a)/b)^2)))
    proof let p be Point of X,r1,r2 be real number;
     assume A10: f1.p=r1 & f2.p=r2;
A11:  g0.p=1 by A4;
      g1.p=(r1/r2-a)/b by A2,A10;
      then g2.p=((r1/r2-a)/b)^2 by A3;
      then g3.p=1-((r1/r2-a)/b)^2 by A5,A11;
      then g4.p= abs(1-((r1/r2-a)/b)^2) by A6;
      then g5.p=sqrt(abs(1-((r1/r2-a)/b)^2)) by A8;
     hence g7.p=r2*( sqrt(abs(1-((r1/r2-a)/b)^2))) by A9,A10;
    end;
  hence thesis by A9;
 end;

definition let n be Element of NAT;
  func n NormF -> Function of TOP-REAL n, R^1 means
  :Def1: for q being Point of TOP-REAL n holds
     it.q=|.q.|;
existence
 proof
   deffunc F(Point of TOP-REAL n)=|.$1.|;
A1:  for x being Element of TOP-REAL n holds
   F(x) in the carrier of R^1 by TOPMETR:24;
   thus ex IT being Function of TOP-REAL n, R^1
   st for q being Point of TOP-REAL n holds
   IT.q = F(q) from FUNCT_2:sch 8(A1);
 end;
 uniqueness
  proof
   deffunc F(Point of TOP-REAL n)=|.$1.|;
   thus for f,g being Function of TOP-REAL n, R^1
st (for q being Point of TOP-REAL n holds f.q=F(q)) &
   (for q being Point of TOP-REAL n holds g.q=F(q))
   holds f=g from BINOP_2:sch 1;
  end;
end;

theorem Th16: for n being Element of NAT holds
dom (n NormF)=the carrier of TOP-REAL n & dom (n NormF)=REAL n
proof let n be Element of NAT;
  thus dom (n NormF)=the carrier of TOP-REAL n by FUNCT_2:def 1;
 hence thesis;
end;

canceled 2;

theorem Th19:for n being Element of NAT,f being Function of TOP-REAL n,R^1
 st f=n NormF
holds f is continuous
proof let n be Element of NAT,f be Function of TOP-REAL n,R^1;
 assume A1: f=n NormF;
  for p being Point of TOP-REAL n,V being Subset of R^1
  st f.p in V & V is open holds
  ex W being Subset of TOP-REAL n st p in W & W is open & f.:W c= V
  proof let p be Point of TOP-REAL n,V be Subset of R^1;
    assume A2: f.p in V & V is open;
     reconsider v=p as Point of Euclid n;
     reconsider u=f.p as Point of RealSpace by METRIC_1:def 14,TOPMETR:24;
     reconsider u'=f.p as Real by TOPMETR:24;
     A3: f.p=|.p.| by A1,Def1;
     consider r being real number such that
     A4: r>0 & Ball(u,r) c= V by A2,TOPMETR:22,def 7;
     reconsider r as Real by XREAL_0:def 1;
     A5: Ball(v,r)={q where q is Point of TOP-REAL n:
                          |. p-q .| < r} by JGRAPH_2:10;
     defpred P[Point of TOP-REAL n] means |. p-$1 .| < r;
     reconsider W1=Ball(v,r) as Subset of TOP-REAL n;
     A6: v in W1 by A4,GOBOARD6:4;
     A7: W1 is open by GOBOARD6:6;
      f.:W1 c= Ball(u,r)
      proof let y be set;assume y in f.:W1;
        then consider x being set such that
        A8: x in dom f & x in W1 & y=f.x by FUNCT_1:def 12;
        reconsider q=x as Point of TOP-REAL n by A8;
        consider q1 being Point of TOP-REAL n such that
        A9: q=q1 & |. p-q1 .| < r by A5,A8;
        A10: f.x=|.q.| by A1,Def1;
        A11: Ball(u,r)=].u'-r,u'+r.[ by A4,FRECHET:7;
        abs(|.p.|-(|.q.|))<= |. p-q .| by JORDAN2C:11;
        then abs(u'-(|.q.|))<r by A3,A9,XXREAL_0:2;
        then A12: -r < u'-(|.q.|) & u'-(|.q.|)<r by SEQ_2:9;
        then A13: u'-(u'-(|.q.|))>u'-r by REAL_1:92;
        u'>|.q.|+-r by A12,XREAL_1:22;
        then u' --r > |.q.| +-r--r by XREAL_1:11;
       hence y in Ball(u,r) by A8,A10,A11,A13,RCOMP_1:47;
      end;
       then f.:W1 c= V by A4,XBOOLE_1:1;
    hence thesis by A6,A7;
  end;
 hence f is continuous by JGRAPH_2:20;
end;

theorem Th20: for n being Element of NAT,K0 being Subset of TOP-REAL n,
f being Function of (TOP-REAL n)|K0,R^1 st
(for p being Point of (TOP-REAL n)|K0 holds
f.p=(n NormF).p) holds f is continuous
proof let n be Element of NAT,K0 be Subset of TOP-REAL n,
f be Function of (TOP-REAL n)|K0,R^1;
assume A1: (for p being Point of (TOP-REAL n)|K0 holds f.p=(n NormF).p);
A2:dom f= the carrier of (TOP-REAL n)|K0 by FUNCT_2:def 1;
A3: the carrier of (TOP-REAL n)|K0=K0 by PRE_TOPC:29;
  (the carrier of TOP-REAL n)/\K0=K0 by XBOOLE_1:28;
  then A4:dom f=dom (n NormF) /\ K0 by A2,A3,Th16;
A5:for x being set st x in dom f holds f.x=(n NormF).x by A1;
  reconsider g=(n NormF) as Function of TOP-REAL n,R^1;
A6:f=g|K0 by A4,A5,FUNCT_1:68;
  g is continuous by Th19;
 hence f is continuous by A6,TOPMETR:10;
end;

theorem Th21:
  for n being Element of NAT,p being Point of Euclid n,r being Real,
      B being Subset of TOP-REAL n st B=cl_Ball(p,r) holds
    B is Bounded closed
 proof let n be Element of NAT,p be Point of Euclid n,r be Real,
           B be Subset of TOP-REAL n;
   assume A1: B=cl_Ball(p,r);
A2: cl_Ball(p,r) c= Ball(p,r+1)
    proof let x be set;assume A3: x in cl_Ball(p,r);
      then reconsider q=x as Point of Euclid n;
A4:   dist(p,q)<=r by A3,METRIC_1:13;
      r<r+1 by XREAL_1:31;
      then dist(p,q)<r+1 by A4,XXREAL_0:2;
     hence x in Ball(p,r+1) by METRIC_1:12;
    end;
    Ball(p,r+1) is bounded by TBSP_1:19;
   then cl_Ball(p,r) is bounded by A2,TBSP_1:21;
  hence B is Bounded by A1,JORDAN2C:def 2;
  thus B is closed by A1,TOPREAL6:65;
 end;

theorem Th22: for p being Point of Euclid 2,r being Real,
 B being Subset of TOP-REAL 2 st B=cl_Ball(p,r) holds B is compact
 proof let p be Point of Euclid 2,r be Real,
   B be Subset of TOP-REAL 2;
   assume B=cl_Ball(p,r);
   then B is Bounded closed by Th21;
  hence B is compact by TOPREAL6:88;
 end;

begin :: Fan Morphism for West

definition let s be real number, q be Point of TOP-REAL 2;
  func FanW(s,q) -> Point of TOP-REAL 2 equals
  :Def2: |.q.|*|[-sqrt(1-((q`2/|.q.|-s)/(1-s))^2),
          (q`2/|.q.|-s)/(1-s)]| if q`2/|.q.|>=s & q`1<0,
       |.q.|*|[-sqrt(1-((q`2/|.q.|-s)/(1+s))^2),
          (q`2/|.q.|-s)/(1+s)]| if q`2/|.q.|<s & q`1<0
   otherwise q;
 correctness;
end;

definition let s be real number;
  func s-FanMorphW -> Function of TOP-REAL 2, TOP-REAL 2 means
  :Def3: for q being Point of TOP-REAL 2 holds
       it.q=FanW(s,q);
 existence
  proof
    deffunc F(Point of TOP-REAL 2)=FanW(s,$1);
    thus ex IT being Function of TOP-REAL 2, TOP-REAL 2 st
  for q being Point of TOP-REAL 2 holds
       IT.q=F(q) from FUNCT_2:sch 4;
  end;
 uniqueness
   proof
    deffunc F(Point of TOP-REAL 2)=FanW(s,$1);
     thus for f,g being Function of TOP-REAL 2, TOP-REAL 2 st
  (for q being Point of TOP-REAL 2 holds f.q=F(q)) &
  (for q being Point of TOP-REAL 2 holds g.q=F(q)) holds f=g
  from BINOP_2:sch 1;
   end;
end;

theorem Th23: for sn being real number holds
  (q`2/|.q.|>=sn & q`1<0 implies
    sn-FanMorphW.q= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1-sn))]|) &
  (q`1>=0 implies sn-FanMorphW.q=q)
proof let sn be real number;
  A1: sn-FanMorphW.q=FanW(sn,q) by Def3;
   hereby assume q`2/|.q.|>=sn & q`1<0;
    then FanW(sn,q)= |.q.|*|[-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2),
          (q`2/|.q.|-sn)/(1-sn)]| by Def2
          .= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by EUCLID:62;
     hence sn-FanMorphW.q= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by Def3;
   end;
   assume q`1>=0; hence thesis by A1,Def2;
end;

theorem Th24: for sn being Real st q`2/|.q.|<=sn & q`1<0 holds
    sn-FanMorphW.q= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
           |.q.|*((q`2/|.q.|-sn)/(1+sn))]|
proof let sn be Real;
   assume A1: q`2/|.q.|<=sn & q`1<0;
  per cases by A1,REAL_1:def 5;
   suppose q`2/|.q.|<sn;
    then FanW(sn,q)= |.q.|*|[-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2),
          (q`2/|.q.|-sn)/(1+sn)]| by A1,Def2
          .= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1+sn))]| by EUCLID:62;
    hence thesis by Def3;
   end;
   suppose A2: q`2/|.q.|=sn;
     (q`2/|.q.|-sn)/(1-sn)=0 by A2;
    hence thesis by A1,A2,Th23;
   end;
end;

theorem Th25: for sn being Real st -1<sn & sn<1 holds
  (q`2/|.q.|>=sn & q`1<=0 & q<>0.REAL 2 implies
    sn-FanMorphW.q= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1-sn))]|) &
  (q`2/|.q.|<=sn & q`1<=0 & q<>0.REAL 2 implies
    sn-FanMorphW.q= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
           |.q.|*((q`2/|.q.|-sn)/(1+sn))]|)
proof let sn be Real;
 assume A1: -1<sn & sn<1;
 per cases;
   suppose A2: q`2/|.q.|>=sn & q`1<=0 & q<>0.REAL 2;
   per cases;
    suppose A3: q`1<0;
      then FanW(sn,q)= |.q.|*|[-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2),
          (q`2/|.q.|-sn)/(1-sn)]| by A2,Def2
          .= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by EUCLID:62;
     hence thesis by A3,Def3,Th24;
    end;
    suppose A4: q`1>=0;
     then A5: sn-FanMorphW.q=q by Th23;
     A6: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
     A7: |.q.|<>0 by A2,TOPRNS_1:25;
     then A8: |.q.|^2>0 by SQUARE_1:74;
     A9: q`1=0 by A2,A4;
     A10: sqrt((|.q.|)^2)=|.q.| by SQUARE_1:89;
     A11: 1-sn>0 by A1,XREAL_1:151;
     A12: |.q.|>0 by A2,Lm1;
     (q`2)^2/|.q.|^2=1^2 by A6,A8,A9,XCMPLX_1:60;
     then ((q`2)/|.q.|)^2=1^2 by XCMPLX_1:77;
     then A13: sqrt(((q`2)/|.q.|)^2)=1 by SQUARE_1:89;
     now assume q`2<0;
      then q`2/|.q.|<0 by A12,REAL_2:128;
      then -((q`2)/|.q.|)=1 by A13,SQUARE_1:90;
      hence contradiction by A1,A2;
     end;
     then A14: |.q.|=q`2 by A6,A9,A10,SQUARE_1:89;
     then 1=q`2/|.q.| by A7,XCMPLX_1:60; then
A15:  (q`2/|.q.|-sn)/(1-sn)=1 by A11,XCMPLX_1:60;
     sn-FanMorphW.q = |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
          |.q.|*((q`2/|.q.|-sn)/(1-sn))]| by  A5,A9,A14,A15,EUCLID:57,
 SQUARE_1:82;
     hence thesis by A1,A7,A14,XCMPLX_1:60;
    end;
   end;
   suppose A16: q`2/|.q.|<=sn & q`1<=0 & q<>0.REAL 2;
    per cases;
    suppose q`1<0;
     hence thesis by Th23,Th24;
    end;
    suppose A17: q`1>=0;
     A18: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
     A19: |.q.|<>0 by A16,TOPRNS_1:25;
     A20: q`1=0 by A16,A17;
     A21: |.q.|>0 by A16,Lm1;
     A22: 1+sn>0 by A1,XREAL_1:150;
     1>q`2/|.q.| by A1,A16,XXREAL_0:2;
     then 1 *(|.q.|)>q`2/|.q.|*(|.q.|) by A21,XREAL_1:70;
     then A23: (|.q.|)>q`2 by A19,XCMPLX_1:88;
     then A24: |.q.|=-q`2 by A18,A20,SQUARE_1:109;
     A25: q`2= -(|.q.|) by A18,A20,A23,SQUARE_1:109;
     then -1=q`2/|.q.| by A19,XCMPLX_1:198;
     then (q`2/|.q.|-sn)/(1+sn)
     =(-(1+sn))/(1+sn) .=-1 by A22,XCMPLX_1:198;
     then |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
       |.q.|* ((q`2/|.q.|-sn)/(1+sn))]|
      =q by  SQUARE_1:82,A20,A24,EUCLID:57;
     hence thesis by A1,A17,A19,A25,Th23,XCMPLX_1:198;
    end;
   end;
   suppose q`1>0 or q=0.REAL 2;
    hence thesis;
   end;
end;

Lm4: for K being non empty Subset of TOP-REAL 2 holds
  proj1|K is continuous Function of (TOP-REAL 2)|K,R^1 &
  for q being Point of (TOP-REAL 2)|K holds (proj1|K).q=proj1.q
proof
  let K be non empty Subset of TOP-REAL 2;
  A1: the carrier of (TOP-REAL 2)|K=K by PRE_TOPC:29;
  then reconsider g2=proj1|K as Function of (TOP-REAL 2)|K,R^1
  by FUNCT_2:38,TOPMETR:24;
  for q being Point of (TOP-REAL 2)|K holds g2.q=proj1.q
  proof let q be Point of (TOP-REAL 2)|K;
A2:q in the carrier of (TOP-REAL 2)|K;
   dom proj1=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
   then q in dom proj1 /\ K by A1,A2,XBOOLE_0:def 3;
   hence g2.q=proj1.q by FUNCT_1:71;
  end;
  hence thesis by JGRAPH_2:39;
end;

Lm5: for K being non empty Subset of TOP-REAL 2 holds
  proj2|K is continuous Function of (TOP-REAL 2)|K,R^1 &
  for q being Point of (TOP-REAL 2)|K holds (proj2|K).q=proj2.q
proof
  let K be non empty Subset of TOP-REAL 2;
  A1: the carrier of (TOP-REAL 2)|K=K by PRE_TOPC:29;
  then reconsider g2=proj2|K as Function of (TOP-REAL 2)|K,R^1
  by FUNCT_2:38,TOPMETR:24;
  for q being Point of (TOP-REAL 2)|K holds g2.q=proj2.q
  proof let q be Point of (TOP-REAL 2)|K;
A2:q in the carrier of (TOP-REAL 2)|K;
   dom proj2=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
   then q in dom proj2 /\ K by A1,A2,XBOOLE_0:def 3;
   hence g2.q=proj2.q by FUNCT_1:71;
  end;
  hence thesis by JGRAPH_2:40;
end;

Lm6: dom (2 NormF)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;

Lm7: for K being non empty Subset of TOP-REAL 2 holds
  (2 NormF)|K is continuous Function of (TOP-REAL 2)|K,R^1 &
  (for q being Point of (TOP-REAL 2)|K holds ((2 NormF)|K).q=(2 NormF).q)
proof
  let K1 be non empty Subset of TOP-REAL 2;
A1:the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
  then reconsider g1=(2 NormF)|K1 as Function
    of (TOP-REAL 2)|K1,R^1 by FUNCT_2:38;
  for q being Point of (TOP-REAL 2)|K1 holds g1.q=(2 NormF).q
  proof let q be Point of (TOP-REAL 2)|K1;
   q in the carrier of (TOP-REAL 2)|K1;
   then q in dom (2 NormF) /\ K1 by A1,Lm6,XBOOLE_0:def 3;
   hence g1.q=(2 NormF).q by FUNCT_1:71;
  end;
  hence thesis by Th20;
end;

Lm8:
for K1 be non empty Subset of TOP-REAL 2,
    g1 be Function of (TOP-REAL 2)|K1,R^1 st g1=(2 NormF)|K1 &
(for q being Point of TOP-REAL 2 st q in
     the carrier of (TOP-REAL 2)|K1 holds q<>0.REAL 2) holds
for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0
  proof
    let K1 be non empty Subset of TOP-REAL 2,
        g1 be Function of (TOP-REAL 2)|K1,R^1;
A1: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
    assume A2: g1=(2 NormF)|K1 & (for q being Point of TOP-REAL 2 st q in
    the carrier of (TOP-REAL 2)|K1 holds q<>0.REAL 2);
    let q be Point of (TOP-REAL 2)|K1;
    q in the carrier of (TOP-REAL 2)|K1;
    then reconsider q2=q as Point of TOP-REAL 2 by A1;
A3: g1.q=(2 NormF).q by A2,Lm7 .= |.q2.| by Def1;
    now assume |.q2.|=0; then q2=0.REAL 2 by TOPRNS_1:25;
     hence contradiction by A2;
    end;
   hence g1.q<>0 by A3;
  end;

theorem Th26:
 for sn being Real,K1 being non empty Subset of TOP-REAL 2,
f being Function of (TOP-REAL 2)|K1,R^1 st -1<sn & sn<1 &
(for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|* ((p`2/|.p.|-sn)/(1-sn)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1<=0 & q<>0.REAL 2) holds
f is continuous
proof
 let sn be Real,K1 be non empty Subset of TOP-REAL 2,
     f be Function of (TOP-REAL 2)|K1,R^1;
 assume A1: -1<sn & sn<1 &
(for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|* ((p`2/|.p.|-sn)/(1-sn)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1<=0 & q<>0.REAL 2);
  set a=sn, b=1-sn;
  A2: b>0 by A1,XREAL_1:151;
  reconsider g2=proj2|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm5;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1
    by Lm7;
  for q being Point of TOP-REAL 2 st q in
    the carrier of (TOP-REAL 2)|K1 holds q<>0.REAL 2 by A1;
  then for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm8;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
  A3: (for q being Point of
  (TOP-REAL 2)|K1,r1,r2 being Real st g2.q=r1 & g1.q=r2
  holds g3.q=r2*((r1/r2-a)/b)) & g3 is continuous by A2,Th10;
  A4:dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then A5:dom f=dom g3 by FUNCT_2:def 1;
  for x being set st x in dom f holds f.x=g3.x
   proof let x be set;assume
A6:  x in dom f;
     then x in K1 by A4,A5,PRE_TOPC:29;
     then reconsider r=x as Point of TOP-REAL 2;
     reconsider s=x as Point of (TOP-REAL 2)|K1 by A6;
A7:  f.r=(|.r.|)* ((r`2/|.r.|-sn)/(1-sn)) by A1,A6;
A8:  g2.s=proj2.s by Lm5;
A9:  g1.s=(2 NormF).s by Lm7;
A10: proj2.r=r`2 by PSCOMP_1:def 29;
     (2 NormF).r=|.r.| by Def1;
    hence f.x=g3.x by A3,A7,A8,A9,A10;
   end;
hence f is continuous by A3,A5,FUNCT_1:9;
end;

theorem Th27:
 for sn being Real,K1 being non empty Subset of TOP-REAL 2,
     f being Function of (TOP-REAL 2)|K1,R^1 st -1<sn & sn<1 &
(for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|* ((p`2/|.p.|-sn)/(1+sn)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1<=0 & q<>0.REAL 2) holds
f is continuous
proof
 let sn be Real,K1 be non empty Subset of TOP-REAL 2,
     f be Function of (TOP-REAL 2)|K1,R^1;
 assume A1:-1<sn & sn<1 &
(for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|* ((p`2/|.p.|-sn)/(1+sn)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1<=0 & q<>0.REAL 2);
  set a=sn, b=1+sn;
  A2: 1+sn>0 by A1,XREAL_1:150;
  reconsider g2=proj2|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm5;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1
     by Lm7;
  for q being Point of TOP-REAL 2 st q in
    the carrier of (TOP-REAL 2)|K1 holds q<>0.REAL 2 by A1;
  then for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm8;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
  A3: (for q being Point of
  (TOP-REAL 2)|K1,r1,r2 being Real st g2.q=r1 & g1.q=r2
  holds g3.q=r2*((r1/r2-a)/b)) & g3 is continuous by A2,Th10;
  A4:dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then A5:dom f=dom g3 by FUNCT_2:def 1;
      for x being set st x in dom f holds f.x=g3.x
   proof let x be set;assume
     A6: x in dom f; then A7: x in dom g3 by A4;
     then x in K1 by A4,PRE_TOPC:29;
     then reconsider r=x as Point of TOP-REAL 2;
     reconsider s=x as Point of (TOP-REAL 2)|K1 by A6;
     A8:f.r=(|.r.|)* ((r`2/|.r.|-sn)/(1+sn)) by A1,A7;
     A9:g2.s=proj2.s by Lm5;
     A10:g1.s=(2 NormF).s by Lm7;
     A11:proj2.r=r`2 by PSCOMP_1:def 29;
     (2 NormF).r=|.r.| by Def1;
    hence f.x=g3.x by A3,A8,A9,A10,A11;
   end;
hence f is continuous by A3,A5,FUNCT_1:9;
end;

theorem Th28:
 for sn being Real,K1 being non empty Subset of TOP-REAL 2,
f being Function of (TOP-REAL 2)|K1,R^1 st -1<sn & sn<1 &
(for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds
        q`1<=0 & q`2/|.q.|>=sn & q<>0.REAL 2) holds f is continuous
proof
 let sn be Real,K1 be non empty Subset of TOP-REAL 2,
     f be Function of (TOP-REAL 2)|K1,R^1;
 assume A1: -1<sn & sn<1 &
(for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds
     q`1<=0 & q`2/|.q.|>=sn & q<>0.REAL 2);
  set a=sn, b=1-sn;
  A2: b>0 by A1,XREAL_1:151;
  reconsider g2=proj2|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm5;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1
                          by Lm7;
  for q being Point of TOP-REAL 2 st q in
    the carrier of (TOP-REAL 2)|K1 holds q<>0.REAL 2 by A1;
  then for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm8;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
  A3: (for q being Point of
  (TOP-REAL 2)|K1,r1,r2 being real number st g2.q=r1 & g1.q=r2
  holds g3.q=r2*(-sqrt(abs(1-((r1/r2-a)/b)^2))))
          & g3 is continuous by A2,Th14;
  A4:dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then A5:dom f=dom g3 by FUNCT_2:def 1;
  for x being set st x in dom f holds f.x=g3.x
   proof let x be set;assume
     A6: x in dom f;
     then x in K1 by A4,A5,PRE_TOPC:29;
     then reconsider r=x as Point of TOP-REAL 2;
     reconsider s=x as Point of (TOP-REAL 2)|K1 by A6;
A7:  now assume |.r.|=0; then r=0.REAL 2 by TOPRNS_1:25;
      hence contradiction by A1,A6;
     end;
     A8: |.r.|>=0;
     |.r.|^2=(r`1)^2+(r`2)^2 by JGRAPH_3:10;
     then (r`2)^2 -(|.r.|)^2 =-(r`1)^2;
     then A9: ((r`2) -(|.r.|))*((r`2)+|.r.|) =-(r`1)^2;
     (r`1)^2>=0 by XREAL_1:65;
     then -(r`1)^2 <=0 by XREAL_1:60;
     then -(|.r.|)<=r`2 & r`2<= |.r.| by A9,XREAL_1:95;
     then r`2/|.r.| <= |.r.|/|.r.| by A7,A8,REAL_1:73;
     then r`2/|.r.|<=1 by A7,XCMPLX_1:60;
     then A10: r`2/|.r.|-sn<=(1-sn) by XREAL_1:11;
     A11: now assume (1-sn)^2=0;
       then 1-sn+sn=0+sn by XCMPLX_1:6;
      hence contradiction by A1;
     end;
     A12: 1-sn>0 by A1,XREAL_1:151;
      A13: (1-sn)^2>=0 by XREAL_1:65;
     sn<=r`2/(|.r.|) by A1,A6;
     then sn-r`2/|.r.|<=0 by REAL_2:106;
     then -(sn- r`2/|.r.|)>=-(1-sn) by A12,XREAL_1:26;
     then (r`2/|.r.|-sn)^2<=(1-sn)^2 by A10,SQUARE_1:119;
     then (r`2/|.r.|-sn)^2/(1-sn)^2<=(1-sn)^2/(1-sn)^2 by A11,A13,REAL_1:73;
     then (r`2/|.r.|-sn)^2/(1-sn)^2<=1 by A11,XCMPLX_1:60;
     then ((r`2/|.r.|-sn)/(1-sn))^2<=1 by XCMPLX_1:77;
     then 1-((r`2/|.r.|-sn)/(1-sn))^2>=0 by XREAL_1:50;
     then abs(1-((r`2/|.r.|-sn)/(1-sn))^2)
          =1-((r`2/|.r.|-sn)/(1-sn))^2 by ABSVALUE:def 1;
     then A14:f.r=(|.r.|)*(-sqrt(abs(1-((r`2/|.r.|-sn)/(1-sn))^2))) by A1,A6;
    A15:g2.s=proj2.s by Lm5;
    A16:g1.s=(2 NormF).s by Lm7;
    A17:proj2.r=r`2 by PSCOMP_1:def 29;
    (2 NormF).r=|.r.| by Def1;
    hence f.x=g3.x by A3,A14,A15,A16,A17;
   end;
hence f is continuous by A3,A5,FUNCT_1:9;
end;

theorem Th29:
 for sn being Real,K1 being non empty Subset of TOP-REAL 2,
f being Function of (TOP-REAL 2)|K1,R^1 st -1<sn & sn<1 &
(for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds
   q`1<=0 & q`2/|.q.|<=sn & q<>0.REAL 2) holds f is continuous
proof
 let sn be Real,K1 be non empty Subset of TOP-REAL 2,
f be Function of (TOP-REAL 2)|K1,R^1;
 assume A1: -1<sn & sn<1 &
(for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1<=0 & q`2/|.q.|<=sn & q<>0.REAL 2);
  set a=sn, b=1+sn;
  A2: 1+sn>0 by A1,XREAL_1:150;
  reconsider g2=proj2|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm5;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1
                          by Lm7;
      for q being Point of TOP-REAL 2 st q in
    the carrier of (TOP-REAL 2)|K1 holds q<>0.REAL 2 by A1;
  then for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm8;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
  A3: (for q being Point of
  (TOP-REAL 2)|K1,r1,r2 being real number st g2.q=r1 & g1.q=r2
  holds g3.q=r2*(-sqrt(abs(1-((r1/r2-a)/b)^2))))
          & g3 is continuous by A2,Th14;
  A4:dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then A5:dom f=dom g3 by FUNCT_2:def 1;
      for x being set st x in dom f holds f.x=g3.x
   proof let x be set;assume
     A6:x in dom f;
     then x in K1 by A4,A5,PRE_TOPC:29;
     then reconsider r=x as Point of TOP-REAL 2;
     reconsider s=x as Point of (TOP-REAL 2)|K1 by A6;
     A7: now assume |.r.|=0; then r=0.REAL 2 by TOPRNS_1:25;
      hence contradiction by A1,A6;
     end;
     A8: |.r.|>=0;
     |.r.|^2=(r`1)^2+(r`2)^2 by JGRAPH_3:10;
     then (r`2)^2 -(|.r.|)^2 =-(r`1)^2;
     then A9: ((r`2) -(|.r.|))*((r`2)+|.r.|) =-(r`1)^2;
     (r`1)^2>=0 by XREAL_1:65;
     then -(r`1)^2 <=0 by XREAL_1:60;
     then -(|.r.|)<=r`2 & r`2<= |.r.| by A9,XREAL_1:95;
     then r`2/|.r.| >= (-(|.r.|))/|.r.| by A7,A8,REAL_1:73;
     then r`2/|.r.|>= -1 by A7,XCMPLX_1:198;
     then r`2/|.r.|-sn>=-1-sn by XREAL_1:11;
     then A10: r`2/|.r.|-sn>=-(1+sn);
     A11: (1+sn)^2>0 by A2,SQUARE_1:74;
     sn>=r`2/(|.r.|) by A1,A6;
     then sn-r`2/|.r.|>=0 by XREAL_1:50;
     then -(sn-r`2/|.r.|)<=-0 by XREAL_1:26;
     then (r`2/|.r.|-sn)^2<=(1+sn)^2 by A2,A10,SQUARE_1:119;
     then (r`2/|.r.|-sn)^2/(1+sn)^2<=(1+sn)^2/(1+sn)^2 by A11,REAL_1:73;
     then (r`2/|.r.|-sn)^2/(1+sn)^2<=1 by A11,XCMPLX_1:60;
     then ((r`2/|.r.|-sn)/(1+sn))^2<=1 by XCMPLX_1:77;
     then 1-((r`2/|.r.|-sn)/(1+sn))^2>=0 by XREAL_1:50;
     then abs(1-((r`2/|.r.|-sn)/(1+sn))^2)
          =1-((r`2/|.r.|-sn)/(1+sn))^2 by ABSVALUE:def 1;
     then A12:f.r=(|.r.|)*(-sqrt(abs(1-((r`2/|.r.|-sn)/(1+sn))^2))) by A1,A6;
     A13:g2.s=proj2.s by Lm5;
     A14:g1.s=(2 NormF).s by Lm7;
     A15:proj2.r=r`2 by PSCOMP_1:def 29;
     (2 NormF).r=|.r.| by Def1;
    hence f.x=g3.x by A3,A12,A13,A14,A15;
   end;
hence f is continuous by A3,A5,FUNCT_1:9;
end;

theorem Th30:
  for sn being Real, K0,B0 being Subset of TOP-REAL 2,
      f being Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0 st
   -1<sn & sn<1 & f=(sn-FanMorphW)|K0 &
   B0={q where q is Point of TOP-REAL 2: q`1<=0 & q<>0.REAL 2} &
   K0={p: p`2/|.p.|>=sn & p`1<=0 & p<>0.REAL 2} holds f is continuous
proof let sn be Real,K0,B0 be Subset of TOP-REAL 2,
  f be Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0;
assume A1: -1<sn & sn<1 & f=(sn-FanMorphW)|K0 &
B0={q where q is Point of TOP-REAL 2: q`1<=0 & q<>0.REAL 2} &
K0={p: p`2/|.p.|>=sn & p`1<=0 & p<>0.REAL 2};
 set cn=sqrt(1-sn^2);
 set p0=|[-cn,sn]|;
 A2: p0`2=sn by EUCLID:56;
 A3: p0`1=-cn by EUCLID:56;
 sn^2<1^2 by A1,SQUARE_1:120;
 then A4: 1-sn^2>0 by XREAL_1:52;
 A5: now assume p0=0.REAL 2;
   then --cn=-0 by EUCLID:56,JGRAPH_2:11;
  hence contradiction by A4,SQUARE_1:93;
 end;
 --cn>0 by A4,SQUARE_1:93;
 then A6: p0`1<0 by A3,XREAL_1:60;
 A7: |.p0.|=sqrt((-cn)^2+sn^2) by A2,A3,JGRAPH_3:10
     .=sqrt((cn)^2+sn^2);
 cn^2=1-sn^2 by A4,SQUARE_1:def 4;
 then p0`2/|.p0.|=sn by A7,EUCLID:56,SQUARE_1:83;
 then A8: p0 in K0 by A1,A5,A6;
then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
  A9: K0 c= B0
   proof let x be set;assume x in K0;
      then consider p8 being Point of TOP-REAL 2 such that
      A10: x=p8 & (p8`2/|.p8.|>=sn & p8`1<=0 & p8<>0.REAL 2) by A1;
    thus x in B0 by A1,A10;
   end;
A11:dom (proj2*((sn-FanMorphW)|K1)) c= dom ((sn-FanMorphW)|K1) by RELAT_1:44;
   dom ((sn-FanMorphW)|K1) c= dom (proj2*((sn-FanMorphW)|K1))
proof let x be set;assume A12:x in dom ((sn-FanMorphW)|K1);
   then A13:x in dom (sn-FanMorphW) /\ K1 by FUNCT_1:68;
   A14:((sn-FanMorphW)|K1).x=(sn-FanMorphW).x by A12,FUNCT_1:68;
   A15: dom proj2 = (the carrier of TOP-REAL 2) by FUNCT_2:def 1;
   x in dom (sn-FanMorphW) by A13,XBOOLE_0:def 3;
   then (sn-FanMorphW).x in rng (sn-FanMorphW) by FUNCT_1:12;
  hence x in dom (proj2*((sn-FanMorphW)|K1)) by A12,A14,A15,FUNCT_1:21;
end;
then A16:dom (proj2*((sn-FanMorphW)|K1))
=dom ((sn-FanMorphW)|K1) by A11,XBOOLE_0:def 10
.=dom (sn-FanMorphW) /\ K1 by FUNCT_1:68
.=(the carrier of TOP-REAL 2)/\ K1 by FUNCT_2:def 1
.=K1 by XBOOLE_1:28
.=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
A17:rng (proj2*((sn-FanMorphW)|K1)) c= rng proj2 by RELAT_1:45;
    rng proj2 c= the carrier of R^1 by TOPMETR:24;
then rng (proj2*((sn-FanMorphW)|K1)) c= the carrier of R^1 by A17,XBOOLE_1:1;
then reconsider g2=proj2*((sn-FanMorphW)|K1) as Function of (TOP-REAL 2)|K1,R^1
                                 by A16,FUNCT_2:4;
A18:dom (proj1*((sn-FanMorphW)|K1))
                     c= dom ((sn-FanMorphW)|K1) by RELAT_1:44;
   dom ((sn-FanMorphW)|K1) c= dom (proj1*((sn-FanMorphW)|K1))
proof let x be set;assume A19:x in dom ((sn-FanMorphW)|K1);
   then A20:x in dom (sn-FanMorphW) /\ K1 by FUNCT_1:68;
   A21:((sn-FanMorphW)|K1).x=(sn-FanMorphW).x by A19,FUNCT_1:68;
   A22: dom proj1 = (the carrier of TOP-REAL 2) by FUNCT_2:def 1;
   x in dom (sn-FanMorphW) by A20,XBOOLE_0:def 3;
   then (sn-FanMorphW).x in rng (sn-FanMorphW) by FUNCT_1:12;
  hence x in dom (proj1*((sn-FanMorphW)|K1)) by A19,A21,A22,FUNCT_1:21;
end;
then A23:dom (proj1*((sn-FanMorphW)|K1))
=dom ((sn-FanMorphW)|K1) by A18,XBOOLE_0:def 10
.=dom (sn-FanMorphW) /\ K1 by FUNCT_1:68
.=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
.=K1 by XBOOLE_1:28
.=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
A24:rng (proj1*((sn-FanMorphW)|K1)) c= rng proj1 by RELAT_1:45;
    rng proj1 c= the carrier of R^1 by TOPMETR:24;
then rng (proj1*((sn-FanMorphW)|K1)) c= the carrier of R^1 by A24,XBOOLE_1:1;
then reconsider g1=proj1*((sn-FanMorphW)|K1) as Function of (TOP-REAL 2)|K1,R^1
                                 by A23,FUNCT_2:4;
A25: for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1<=0 & q<>0.REAL 2
   proof let q be Point of TOP-REAL 2;
    assume A26:q in the carrier of (TOP-REAL 2)|K1;
     the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     then consider p3 being Point of TOP-REAL 2 such that
     A27: q=p3 & (p3`2/|.p3.|>=sn & p3`1<=0 & p3<>0.REAL 2) by A1,A26;
    thus q`1<=0 & q<>0.REAL 2 by A27;
   end;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g2.p=|.p.|* ((p`2/|.p.|-sn)/(1-sn))
   proof let p be Point of TOP-REAL 2;
    assume A28: p in the carrier of (TOP-REAL 2)|K1;
     A29:dom ((sn-FanMorphW)|K1)=dom (sn-FanMorphW) /\ K1 by FUNCT_1:68
     .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
     .=K1 by XBOOLE_1:28;
     A30:the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     then consider p3 being Point of TOP-REAL 2 such that
     A31: p=p3 & (p3`2/|.p3.|>=sn & p3`1<=0 & p3<>0.REAL 2) by A1,A28;
     A32:(sn-FanMorphW).p
     =|[|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
      |.p.|* ((p`2/|.p.|-sn)/(1-sn))]| by A1,A31,Th25;
        ((sn-FanMorphW)|K1).p=(sn-FanMorphW).p by A28,A30,FUNCT_1:72;
     then g2.p=proj2.(|[|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
       |.p.|* ((p`2/|.p.|-sn)/(1-sn))]|) by A28,A29,A30,A32,FUNCT_1:23
      .=(|[|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
        |.p.|* ((p`2/|.p.|-sn)/(1-sn))]|)`2 by PSCOMP_1:def 29
      .=|.p.|* ((p`2/|.p.|-sn)/(1-sn)) by EUCLID:56;
    hence g2.p=|.p.|* ((p`2/|.p.|-sn)/(1-sn));
   end;
then consider f2 being Function of (TOP-REAL 2)|K1,R^1 such that
  A33:for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds f2.p=|.p.|* ((p`2/|.p.|-sn)/(1-sn));
A34:f2 is continuous by A1,A25,A33,Th26;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g1.p=|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2))
   proof let p be Point of TOP-REAL 2;
    assume A35: p in the carrier of (TOP-REAL 2)|K1;
     A36:dom ((sn-FanMorphW)|K1)=dom (sn-FanMorphW) /\ K1 by FUNCT_1:68
     .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
     .=K1 by XBOOLE_1:28;
     A37:the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     then consider p3 being Point of TOP-REAL 2 such that
     A38: p=p3 & (p3`2/|.p3.|>=sn & p3`1<=0 & p3<>0.REAL 2) by A1,A35;
     A39:(sn-FanMorphW).p=|[|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
      |.p.|* ((p`2/|.p.|-sn)/(1-sn))]| by A1,A38,Th25;
        ((sn-FanMorphW)|K1).p=(sn-FanMorphW).p by A35,A37,FUNCT_1:72;
     then g1.p=proj1.(|[|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
          |.p.|* ((p`2/|.p.|-sn)/(1-sn))]|)
                             by A35,A36,A37,A39,FUNCT_1:23
        .=(|[|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
          |.p.|* ((p`2/|.p.|-sn)/(1-sn)) ]|)`1 by PSCOMP_1:def 28
        .= |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)) by EUCLID:56;
    hence g1.p=|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2));
   end;
then consider f1 being Function of (TOP-REAL 2)|K1,R^1 such that
  A40:for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds f1.p=|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2));
  for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1<=0 & q`2/|.q.|>=sn & q<>0.REAL 2
   proof let q be Point of TOP-REAL 2;
    assume A41:q in the carrier of (TOP-REAL 2)|K1;
     the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     then consider p3 being Point of TOP-REAL 2 such that
A42: q=p3 & (p3`2/|.p3.|>=sn & p3`1<=0 & p3<>0.REAL 2) by A1,A41;
    thus thesis by A42;
   end;
then A43:f1 is continuous by A1,A40,Th28;
    for x,y,r,s being real number st |[x,y]| in K1 &
  r=f1.(|[x,y]|) & s=f2.(|[x,y]|) holds
  f.(|[x,y]|)=|[r,s]|
  proof let x,y,r,s be real number;
   assume A44: |[x,y]| in K1 & r=f1.(|[x,y]|) & s=f2.(|[x,y]|);
     set p99=|[x,y]|;
     A45:the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     consider p3 being Point of TOP-REAL 2 such that
     A46: p99=p3 & (p3`2/|.p3.|>=sn & p3`1<=0 & p3<>0.REAL 2) by A1,A44;
     A47:f1.p99=|.p99.|*(-sqrt(1-((p99`2/|.p99.|-sn)/(1-sn))^2))
                          by A40,A44,A45;
        ((sn-FanMorphW)|K0).(|[x,y]|)=((sn-FanMorphW)).(|[x,y]|) by A44,
FUNCT_1:72
    .= |[|.p99.|*(-sqrt(1-((p99`2/|.p99.|-sn)/(1-sn))^2)),
      |.p99.|* ((p99`2/|.p99.|-sn)/(1-sn))]| by A1,A46,Th25
    .=|[r,s]| by A33,A44,A45,A47;
   hence f.(|[x,y]|)=|[r,s]| by A1;
  end;
hence f is continuous by A8,A9,A34,A43,JGRAPH_2:45;
end;

theorem Th31: for sn being Real, K0,B0 being Subset of TOP-REAL 2,
  f being Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0 st
  -1<sn & sn<1 & f=(sn-FanMorphW)|K0 &
  B0={q where q is Point of TOP-REAL 2: q`1<=0 & q<>0.REAL 2} &
  K0={p: p`2/|.p.|<=sn & p`1<=0 & p<>0.REAL 2} holds f is continuous
proof let sn be Real,K0,B0 be Subset of TOP-REAL 2,
  f be Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0;
assume A1: -1<sn & sn<1 & f=(sn-FanMorphW)|K0 &
B0={q where q is Point of TOP-REAL 2: q`1<=0 & q<>0.REAL 2} &
K0={p: p`2/|.p.|<=sn & p`1<=0 & p<>0.REAL 2};
 set cn=sqrt(1-sn^2);
 set p0=|[-cn,sn]|;
 A2: p0`2=sn by EUCLID:56;
 A3: p0`1=-cn by EUCLID:56;
 sn^2<1^2 by A1,SQUARE_1:120;
 then A4: 1-sn^2>0 by XREAL_1:52;
 A5: now assume p0=0.REAL 2;
  then --cn=-0 by EUCLID:56,JGRAPH_2:11;
  hence contradiction by A4,SQUARE_1:93;
 end;
 --cn>0 by A4,SQUARE_1:93;
 then A6: p0`1<0 by A3,XREAL_1:60;
A7: |.p0.|=sqrt((-cn)^2+sn^2) by A2,A3,JGRAPH_3:10
       .=sqrt((cn)^2+sn^2);
 cn^2=1-sn^2 by A4,SQUARE_1:def 4;
 then p0`2/|.p0.|=sn by A7,EUCLID:56,SQUARE_1:83;
 then A8: p0 in K0 by A1,A5,A6;
 then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
  A9: K0 c= B0
   proof let x be set;assume x in K0;
    then consider p8 being Point of TOP-REAL 2 such that
    A10: x=p8 & (p8`2/|.p8.|<=sn & p8`1<=0 & p8<>0.REAL 2) by A1;
    thus x in B0 by A1,A10;
   end;
A11:dom (proj2*((sn-FanMorphW)|K1)) c= dom ((sn-FanMorphW)|K1)
                                  by RELAT_1:44;
   dom ((sn-FanMorphW)|K1) c= dom (proj2*((sn-FanMorphW)|K1))
proof let x be set;assume A12:x in dom ((sn-FanMorphW)|K1);
   then A13:x in dom (sn-FanMorphW) /\ K1 by FUNCT_1:68;
   A14:((sn-FanMorphW)|K1).x=(sn-FanMorphW).x by A12,FUNCT_1:68;
   A15: dom proj2 = (the carrier of TOP-REAL 2) by FUNCT_2:def 1;
       x in dom (sn-FanMorphW) by A13,XBOOLE_0:def 3;
   then (sn-FanMorphW).x in rng (sn-FanMorphW) by FUNCT_1:12;
  hence x in dom (proj2*((sn-FanMorphW)|K1)) by A12,A14,A15,FUNCT_1:21;
end;
then A16:dom (proj2*((sn-FanMorphW)|K1))
=dom ((sn-FanMorphW)|K1) by A11,XBOOLE_0:def 10
.=dom (sn-FanMorphW) /\ K1 by FUNCT_1:68
.=(the carrier of TOP-REAL 2)/\ K1 by FUNCT_2:def 1
.=K1 by XBOOLE_1:28
.=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
A17:rng (proj2*((sn-FanMorphW)|K1)) c= rng proj2 by RELAT_1:45;
    rng proj2 c= the carrier of R^1 by TOPMETR:24;
then rng (proj2*((sn-FanMorphW)|K1)) c= the carrier of R^1 by A17,XBOOLE_1:1;
then reconsider g2=proj2*((sn-FanMorphW)|K1) as Function of (TOP-REAL 2)|K1,R^1
                                 by A16,FUNCT_2:4;
A18:dom (proj1*((sn-FanMorphW)|K1))
                     c= dom ((sn-FanMorphW)|K1) by RELAT_1:44;
   dom ((sn-FanMorphW)|K1) c= dom (proj1*((sn-FanMorphW)|K1))
proof let x be set;assume A19:x in dom ((sn-FanMorphW)|K1);
   then A20:x in dom (sn-FanMorphW) /\ K1 by FUNCT_1:68;
   A21:((sn-FanMorphW)|K1).x=(sn-FanMorphW).x by A19,FUNCT_1:68;
   A22: dom proj1 = (the carrier of TOP-REAL 2) by FUNCT_2:def 1;
   x in dom (sn-FanMorphW) by A20,XBOOLE_0:def 3;
   then (sn-FanMorphW).x in rng (sn-FanMorphW) by FUNCT_1:12;
  hence x in dom (proj1*((sn-FanMorphW)|K1)) by A19,A21,A22,FUNCT_1:21;
end;
then A23:dom (proj1*((sn-FanMorphW)|K1))
=dom ((sn-FanMorphW)|K1) by A18,XBOOLE_0:def 10
.=dom (sn-FanMorphW) /\ K1 by FUNCT_1:68
.=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
.=K1 by XBOOLE_1:28
.=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
A24:rng (proj1*((sn-FanMorphW)|K1)) c= rng proj1 by RELAT_1:45;
    rng proj1 c= the carrier of R^1 by TOPMETR:24;
then rng (proj1*((sn-FanMorphW)|K1)) c= the carrier of R^1 by A24,XBOOLE_1:1;
then reconsider g1=proj1*((sn-FanMorphW)|K1) as Function of (TOP-REAL 2)|K1,R^1
                                 by A23,FUNCT_2:4;
A25: for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1<=0 & q<>0.REAL 2
   proof let q be Point of TOP-REAL 2;
    assume A26:q in the carrier of (TOP-REAL 2)|K1;
          the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     then consider p3 being Point of TOP-REAL 2 such that
     A27: q=p3 & (p3`2/|.p3.|<=sn & p3`1<=0 & p3<>0.REAL 2) by A1,A26;
    thus q`1<=0 & q<>0.REAL 2 by A27;
   end;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g2.p=|.p.|* ((p`2/|.p.|-sn)/(1+sn))
   proof let p be Point of TOP-REAL 2;
    assume A28: p in the carrier of (TOP-REAL 2)|K1;
     A29:dom ((sn-FanMorphW)|K1)=dom (sn-FanMorphW) /\ K1 by FUNCT_1:68
     .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
     .=K1 by XBOOLE_1:28;
     A30:the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     then consider p3 being Point of TOP-REAL 2 such that
     A31: p=p3 & (p3`2/|.p3.|<=sn & p3`1<=0 & p3<>0.REAL 2) by A1,A28;
     A32:(sn-FanMorphW).p
     =|[|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
      |.p.|* ((p`2/|.p.|-sn)/(1+sn))]| by A1,A31,Th25;
        ((sn-FanMorphW)|K1).p=(sn-FanMorphW).p by A28,A30,FUNCT_1:72;
     then g2.p=proj2.(|[|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
            |.p.|* ((p`2/|.p.|-sn)/(1+sn))]|)
                             by A28,A29,A30,A32,FUNCT_1:23
      .=(|[|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
        |.p.|* ((p`2/|.p.|-sn)/(1+sn))]|)`2 by PSCOMP_1:def 29
      .=|.p.|* ((p`2/|.p.|-sn)/(1+sn)) by EUCLID:56;
    hence g2.p=|.p.|* ((p`2/|.p.|-sn)/(1+sn));
   end;
then consider f2 being Function of (TOP-REAL 2)|K1,R^1 such that
  A33:for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds f2.p=|.p.|* ((p`2/|.p.|-sn)/(1+sn));
A34:f2 is continuous by A1,A25,A33,Th27;
      for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g1.p=|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2))
   proof let p be Point of TOP-REAL 2;
    assume A35: p in the carrier of (TOP-REAL 2)|K1;
     A36:dom ((sn-FanMorphW)|K1)=dom (sn-FanMorphW) /\ K1 by FUNCT_1:68
     .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
     .=K1 by XBOOLE_1:28;
     A37:the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     then consider p3 being Point of TOP-REAL 2 such that
     A38: p=p3 & (p3`2/|.p3.|<=sn & p3`1<=0 & p3<>0.REAL 2) by A1,A35;
     A39:(sn-FanMorphW).p=|[|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
      |.p.|* ((p`2/|.p.|-sn)/(1+sn))]| by A1,A38,Th25;
        ((sn-FanMorphW)|K1).p=(sn-FanMorphW).p by A35,A37,FUNCT_1:72;
     then g1.p=proj1.(|[|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
          |.p.|* ((p`2/|.p.|-sn)/(1+sn))]|)
                             by A35,A36,A37,A39,FUNCT_1:23
        .=(|[|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
          |.p.|* ((p`2/|.p.|-sn)/(1+sn)) ]|)`1 by PSCOMP_1:def 28
        .= |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)) by EUCLID:56;
    hence g1.p=|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2));
   end;
then consider f1 being Function of (TOP-REAL 2)|K1,R^1 such that
  A40:for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds f1.p=|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2));
      for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1<=0 & q`2/|.q.|<=sn & q<>0.REAL 2
   proof let q be Point of TOP-REAL 2;
    assume A41:q in the carrier of (TOP-REAL 2)|K1;
          the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     then consider p3 being Point of TOP-REAL 2 such that
     A42: q=p3 & (p3`2/|.p3.|<=sn & p3`1<=0 & p3<>0.REAL 2) by A1,A41;
    thus thesis by A42;
   end;
then A43:f1 is continuous by A1,A40,Th29;
    for x,y,r,s being real number st |[x,y]| in K1 &
  r=f1.(|[x,y]|) & s=f2.(|[x,y]|) holds
  f.(|[x,y]|)=|[r,s]|
  proof let x,y,r,s be real number;
   assume A44: |[x,y]| in K1 & r=f1.(|[x,y]|) & s=f2.(|[x,y]|);
     set p99=|[x,y]|;
     A45:the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     consider p3 being Point of TOP-REAL 2 such that
     A46: p99=p3 & (p3`2/|.p3.|<=sn & p3`1<=0 & p3<>0.REAL 2) by A1,A44;
     A47:f1.p99=|.p99.|*(-sqrt(1-((p99`2/|.p99.|-sn)/(1+sn))^2))
                          by A40,A44,A45;
        ((sn-FanMorphW)|K0).(|[x,y]|)=((sn-FanMorphW)).(|[x,y]|) by A44,
FUNCT_1:72
    .= |[|.p99.|*(-sqrt(1-((p99`2/|.p99.|-sn)/(1+sn))^2)),
      |.p99.|* ((p99`2/|.p99.|-sn)/(1+sn))]| by A1,A46,Th25
    .=|[r,s]| by A33,A44,A45,A47;
   hence f.(|[x,y]|)=|[r,s]| by A1;
  end;
hence f is continuous by A8,A9,A34,A43,JGRAPH_2:45;
end;

Lm9: for sn being Real, K1 being Subset of TOP-REAL 2
 st K1={p7 where p7 is Point of TOP-REAL 2:p7`2>=sn*|.p7.|}
 holds K1 is closed
proof let sn be Real, K1 be Subset of TOP-REAL 2;
 defpred P[Point of TOP-REAL 2] means ($1`2>=sn*|.$1.|);
 assume K1={p: p`2>=(sn)*(|.p.|)};
then A1:K1={p7 where p7 is Point of TOP-REAL 2:P[p7]};
A2: K1`={p7 where p7 is Point of TOP-REAL 2:not P[p7]} from JGRAPH_2:sch 2(A1);
  set K10=[#]TOP-REAL 2;
  reconsider g1=proj2|K10 as continuous Function
 of (TOP-REAL 2)|K10,R^1 by Lm5;
  reconsider g0=(2 NormF)|K10 as continuous Function of (TOP-REAL 2)|K10,R^1
                          by Lm7;
  consider g2 being Function of (TOP-REAL 2)|K10,R^1 such that
  A3: (for q being Point of
  (TOP-REAL 2)|K10,r1 being real number st g0.q=r1
  holds g2.q=sn*r1) & g2 is continuous by JGRAPH_2:33;
  consider g3 being Function of (TOP-REAL 2)|K10,R^1 such that
  A4: (for q being Point of
  (TOP-REAL 2)|K10,r1,r2 being real number st g2.q=r1 & g1.q=r2
  holds g3.q=r1-r2) & g3 is continuous by A3,JGRAPH_2:31;
  A5: (TOP-REAL 2)|K10=TOP-REAL 2 by TSEP_1:3;
   A6: for p being Point of TOP-REAL 2 holds g3.p=sn*|.p.|-p`2
   proof let p be Point of TOP-REAL 2;
         g0.p=(2 NormF).p by A5,Lm7 .=|.p.| by Def1;
     then A7: g2.p=sn*|.p.| by A3,A5;
         g1.p=proj2.p by A5,Lm5 .=p`2 by PSCOMP_1:def 29;
    hence g3.p=sn*|.p.|-p`2 by A4,A5,A7;
   end;
   reconsider g=g3 as Function of TOP-REAL 2,R^1 by A5;
  A8: {p7 where p7 is Point of TOP-REAL 2: pi(g,p7)>0} c= K1`
    proof let x be set;assume x in
      {p7 where p7 is Point of TOP-REAL 2: pi(g,p7)>0};
     then consider p7 being Point of TOP-REAL 2 such that
      A9: p7=x & pi(g,p7)>0;
      pi(g,p7)=g.p7 by JORDAN2C:def 10
       .=sn*|.p7.|-p7`2 by A6;
      then sn*|.p7.| - p7`2+p7`2>0+p7`2 by A9,XREAL_1:10;
     hence x in K1` by A2,A9;
    end;
      K1` c= {p7 where p7 is Point of TOP-REAL 2:pi(g,p7)>0}
   proof let x be set;assume x in K1`;
     then consider p9 being Point of TOP-REAL 2 such that
     A10: x=p9 & p9`2<sn*|.p9.| by A2;
     A11: sn*|.p9.| - p9`2>0 by A10,XREAL_1:52;
         pi(g,p9)=g.p9 by JORDAN2C:def 10
       .=sn*|.p9.|-p9`2 by A6;
    hence x in {p7 where p7 is Point of TOP-REAL 2:
    pi(g,p7)>0} by A10,A11;
   end;
  then K1`={p7 where p7 is Point of TOP-REAL 2:pi(g,p7)>0} by A8,
XBOOLE_0:def 10;
  then K1` is open by A4,A5,Th6;
 hence thesis by TOPS_1:29;
end;

Lm10: for sn being Real, K1 being Subset of TOP-REAL 2
 st K1={p7 where p7 is Point of TOP-REAL 2:p7`1>=sn*|.p7.|}
 holds K1 is closed
proof let sn be Real, K1 be Subset of TOP-REAL 2;
  defpred P[Point of TOP-REAL 2] means ($1`1>=sn*|.$1.|);
 assume K1={p: p`1>=(sn)*(|.p.|)};
then A1:K1={p7 where p7 is Point of TOP-REAL 2:P[p7]};
A2: K1`={p7 where p7 is Point of TOP-REAL 2:not P[p7]} from JGRAPH_2:sch 2(A1);
  set K10=[#](TOP-REAL 2);
  reconsider g1=proj1|K10 as continuous Function
 of (TOP-REAL 2)|K10,R^1 by Lm4;
  reconsider g0=(2 NormF)|K10 as continuous Function of (TOP-REAL 2)|K10,R^1
                          by Lm7;
  consider g2 being Function of (TOP-REAL 2)|K10,R^1 such that
  A3: (for q being Point of
  (TOP-REAL 2)|K10,r1 being real number st g0.q=r1
  holds g2.q=sn*r1) & g2 is continuous by JGRAPH_2:33;
  consider g3 being Function of (TOP-REAL 2)|K10,R^1 such that
  A4: (for q being Point of
  (TOP-REAL 2)|K10,r1,r2 being real number st g2.q=r1 & g1.q=r2
  holds g3.q=r1-r2) & g3 is continuous by A3,JGRAPH_2:31;
  A5: (TOP-REAL 2)|K10=TOP-REAL 2 by TSEP_1:3;
   A6: for p being Point of TOP-REAL 2 holds g3.p=sn*|.p.|-p`1
   proof let p be Point of TOP-REAL 2;
     g0.p=(2 NormF).p by A5,Lm7 .=|.p.| by Def1;
     then A7: g2.p=sn*|.p.| by A3,A5;
     g1.p=proj1.p by A5,Lm4 .=p`1 by PSCOMP_1:def 28;
    hence g3.p=sn*|.p.|-p`1 by A4,A5,A7;
   end;
   reconsider g=g3 as Function of TOP-REAL 2,R^1 by A5;
  A8: {p7 where p7 is Point of TOP-REAL 2: pi(g,p7)>0} c= K1`
    proof let x be set;assume x in
      {p7 where p7 is Point of TOP-REAL 2: pi(g,p7)>0};
     then consider p7 being Point of TOP-REAL 2 such that
      A9: p7=x & pi(g,p7)>0;
          pi(g,p7)=g.p7 by JORDAN2C:def 10
       .=sn*|.p7.|-p7`1 by A6;
      then sn*|.p7.| - p7`1+p7`1>0+p7`1 by A9,XREAL_1:10;
     hence x in K1` by A2,A9;
    end;
   K1` c= {p7 where p7 is Point of TOP-REAL 2:pi(g,p7)>0}
   proof let x be set;assume x in K1`;
     then consider p9 being Point of TOP-REAL 2 such that
     A10: x=p9 & p9`1<sn*|.p9.| by A2;
     A11: sn*|.p9.| - p9`1>0 by A10,XREAL_1:52;
     pi(g,p9)=g.p9 by JORDAN2C:def 10
       .=sn*|.p9.|-p9`1 by A6;
    hence x in {p7 where p7 is Point of TOP-REAL 2: pi(g,p7)>0} by A10,A11;
   end;
  then K1`={p7 where p7 is Point of TOP-REAL 2:pi(g,p7)>0} by A8,
XBOOLE_0:def 10;
  then K1` is open by A4,A5,Th6;
 hence thesis by TOPS_1:29;
end;

theorem Th32: for sn being Real, K03 being Subset of TOP-REAL 2
 st K03={p: p`2>=sn*(|.p.|) & p`1<=0}
 holds K03 is closed
proof
 let sn be Real, K003 be Subset of TOP-REAL 2;
 defpred P[Point of TOP-REAL 2] means ($1`2>=sn*|.$1.|);
 assume A1: K003={p: p`2>=(sn)*(|.p.|) & p`1<=0};
  reconsider K1={p7 where p7 is Point of TOP-REAL 2:P[p7]}
  as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
  A2: K1 is closed by Lm9;
  defpred Q[Point of TOP-REAL 2] means $1`1<=0;
  reconsider KX={p where p is Point of TOP-REAL 2: Q[p]}
    as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
A3: KX is closed by JORDAN6:6;
   {p : P[p] & Q[p]}
    = {p7 where p7 is Point of TOP-REAL 2:P[p7]} /\
     {p1 where p1 is Point of TOP-REAL 2: Q[p1]} from DOMAIN_1:sch 10;
  hence thesis by A1,A2,A3,TOPS_1:35;
end;

Lm11: for sn being Real, K1 being Subset of TOP-REAL 2
 st K1={p7 where p7 is Point of TOP-REAL 2:p7`2<=sn*|.p7.|} holds
   K1 is closed
proof let sn be Real, K1 be Subset of TOP-REAL 2;
  defpred P[Point of TOP-REAL 2] means ($1`2<=sn*|.$1.|);
 assume K1={p: p`2<=(sn)*(|.p.|)};
then A1:K1={p7 where p7 is Point of TOP-REAL 2:P[p7]};
A2:K1`={p7 where p7 is Point of TOP-REAL 2:not P[p7]} from JGRAPH_2:sch 2(A1);
  set K10=[#](TOP-REAL 2);
  reconsider g1=proj2|K10 as continuous Function
 of (TOP-REAL 2)|K10,R^1 by Lm5;
  reconsider g0=(2 NormF)|K10 as continuous Function of (TOP-REAL 2)|K10,R^1
                          by Lm7;
  consider g2 being Function of (TOP-REAL 2)|K10,R^1 such that
  A3: (for q being Point of
  (TOP-REAL 2)|K10,r1 being real number st g0.q=r1
  holds g2.q=sn*r1) & g2 is continuous by JGRAPH_2:33;
  consider g3 being Function of (TOP-REAL 2)|K10,R^1 such that
  A4: (for q being Point of
  (TOP-REAL 2)|K10,r1,r2 being real number st g2.q=r1 & g1.q=r2
  holds g3.q=r1-r2) & g3 is continuous by A3,JGRAPH_2:31;
  A5: (TOP-REAL 2)|K10=TOP-REAL 2 by TSEP_1:3;
   A6: for p being Point of TOP-REAL 2 holds g3.p=sn*|.p.|-p`2
   proof let p be Point of TOP-REAL 2;
     g0.p=(2 NormF).p by A5,Lm7 .=|.p.| by Def1;
     then A7: g2.p=sn*|.p.| by A3,A5;
     g1.p=proj2.p by A5,Lm5 .=p`2 by PSCOMP_1:def 29;
    hence g3.p=sn*|.p.|-p`2 by A4,A5,A7;
   end;
   reconsider g=g3 as Function of TOP-REAL 2,R^1 by A5;
  A8: {p7 where p7 is Point of TOP-REAL 2: pi(g,p7)<0} c= K1`
    proof let x be set;assume x in
      {p7 where p7 is Point of TOP-REAL 2: pi(g,p7)<0};
     then consider p7 being Point of TOP-REAL 2 such that
      A9: p7=x & pi(g,p7)<0;
      pi(g,p7)=g.p7 by JORDAN2C:def 10
       .=sn*|.p7.|-p7`2 by A6;
      then sn*|.p7.| - p7`2+p7`2<0+p7`2 by A9,XREAL_1:10;
     hence x in K1` by A2,A9;
    end;
   K1` c= {p7 where p7 is Point of TOP-REAL 2:pi(g,p7)<0}
   proof let x be set;assume x in K1`;
     then consider p9 being Point of TOP-REAL 2 such that
     A10: x=p9 & p9`2>sn*|.p9.| by A2;
     A11: sn*|.p9.| - p9`2<0 by A10,REAL_2:105;
     pi(g,p9)=g.p9 by JORDAN2C:def 10
       .=sn*|.p9.|-p9`2 by A6;
    hence x in {p7 where p7 is Point of TOP-REAL 2:
    pi(g,p7)<0} by A10,A11;
   end;
  then K1`={p7 where p7 is Point of TOP-REAL 2:pi(g,p7)<0} by A8,
XBOOLE_0:def 10;
  then K1` is open by A4,A5,Th7;
 hence thesis by TOPS_1:29;
end;

Lm12: for sn being Real, K1 being Subset of TOP-REAL 2
 st K1={p7 where p7 is Point of TOP-REAL 2:p7`1<=sn*|.p7.|}
 holds K1 is closed
proof let sn be Real, K1 be Subset of TOP-REAL 2;
  defpred P[Point of TOP-REAL 2] means ($1`1<=sn*|.$1.|);
 assume K1={p: p`1<=(sn)*(|.p.|)};
then A1:K1={p7 where p7 is Point of TOP-REAL 2:P[p7]};
A2:K1`={p7 where p7 is Point of TOP-REAL 2:not P[p7]} from JGRAPH_2:sch 2(A1);
  set K10=[#](TOP-REAL 2);
  reconsider g1=proj1|K10 as continuous Function of (TOP-REAL 2)|K10,R^1
    by Lm4;
  reconsider g0=(2 NormF)|K10 as continuous Function of (TOP-REAL 2)|K10,R^1
                          by Lm7;
  consider g2 being Function of (TOP-REAL 2)|K10,R^1 such that
  A3: (for q being Point of
  (TOP-REAL 2)|K10,r1 being real number st g0.q=r1
  holds g2.q=sn*r1) & g2 is continuous by JGRAPH_2:33;
  consider g3 being Function of (TOP-REAL 2)|K10,R^1 such that
  A4: (for q being Point of
  (TOP-REAL 2)|K10,r1,r2 being real number st g2.q=r1 & g1.q=r2
  holds g3.q=r1-r2) & g3 is continuous by A3,JGRAPH_2:31;
  A5: (TOP-REAL 2)|K10=TOP-REAL 2 by TSEP_1:3;
   A6: for p being Point of TOP-REAL 2 holds g3.p=sn*|.p.|-p`1
   proof let p be Point of TOP-REAL 2;
    g0.p=(2 NormF).p by A5,Lm7 .=|.p.| by Def1;
    then A7: g2.p=sn*|.p.| by A3,A5;
    g1.p=proj1.p by A5,Lm4 .=p`1 by PSCOMP_1:def 28;
    hence g3.p=sn*|.p.|-p`1 by A4,A5,A7;
   end;
   reconsider g=g3 as Function of TOP-REAL 2,R^1 by A5;
  A8: {p7 where p7 is Point of TOP-REAL 2: pi(g,p7)<0} c= K1`
    proof let x be set;assume x in
      {p7 where p7 is Point of TOP-REAL 2: pi(g,p7)<0};
     then consider p7 being Point of TOP-REAL 2 such that
      A9: p7=x & pi(g,p7)<0;
          pi(g,p7)=g.p7 by JORDAN2C:def 10
       .=sn*|.p7.|-p7`1 by A6;
      then sn*|.p7.| - p7`1+p7`1<0+p7`1 by A9,XREAL_1:10;
     hence x in K1` by A2,A9;
    end;
   K1` c= {p7 where p7 is Point of TOP-REAL 2:pi(g,p7)<0}
   proof let x be set;assume x in K1`;
     then consider p9 being Point of TOP-REAL 2 such that
     A10: x=p9 & p9`1>sn*|.p9.| by A2;
     A11: sn*|.p9.| - p9`1<0 by A10,REAL_2:105;
     pi(g,p9)=g.p9 by JORDAN2C:def 10
       .=sn*|.p9.|-p9`1 by A6;
    hence x in {p7 where p7 is Point of TOP-REAL 2: pi(g,p7)<0} by A10,A11;
   end;
  then K1`={p7 where p7 is Point of TOP-REAL 2:pi(g,p7)<0} by A8,
XBOOLE_0:def 10;
  then K1` is open by A4,A5,Th7;
 hence thesis by TOPS_1:29;
end;

theorem Th33: for sn being Real, K03 being Subset of TOP-REAL 2
 st K03={p: p`2<=(sn)*(|.p.|) & p`1<=0}
 holds K03 is closed
proof let sn be Real, K003 be Subset of TOP-REAL 2;
  defpred P[Point of TOP-REAL 2] means ($1`2<=sn*|.$1.|);
  defpred Q[Point of TOP-REAL 2] means $1`1<=0;
 assume A1: K003={p: P[p] & Q[p]};
  reconsider K1={p7 where p7 is Point of TOP-REAL 2:P[p7]}
  as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
  A2: K1 is closed by Lm11;
  reconsider KX={p where p is Point of TOP-REAL 2: Q[p]}
    as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
A3: KX is closed by JORDAN6:6;
    {p : P[p] & Q[p]}
    = {p7 where p7 is Point of TOP-REAL 2:P[p7]} /\
     {p1 where p1 is Point of TOP-REAL 2: Q[p1]} from DOMAIN_1:sch 10;
  hence thesis by A1,A2,A3,TOPS_1:35;
end;

theorem Th34:
  for sn being Real, K0,B0 being Subset of TOP-REAL 2,
      f being Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0 st
    -1<sn & sn<1 & f=(sn-FanMorphW)|K0 &
    B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} &
    K0={p: p`1<=0 & p<>0.REAL 2} holds f is continuous
proof let sn be Real,K0,B0 be Subset of TOP-REAL 2,
   f be Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0;
assume A1: -1<sn & sn<1 & f=(sn-FanMorphW)|K0 &
B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} & K0={p: p`1<=0 & p<>0.REAL 2};
 set cn=sqrt(1-sn^2);
 set p0=|[-cn,sn]|;
 A2: p0`2=sn by EUCLID:56;
 A3: p0`1=-cn by EUCLID:56;
       sn^2<1 by A1,SQUARE_1:120,59;
 then A4: 1-sn^2>0 by XREAL_1:52;
 A5: now assume p0=0.REAL 2;
   then --cn=-0 by EUCLID:56,JGRAPH_2:11;
  hence contradiction by A4,SQUARE_1:93;
 end;
 --cn>0 by A4,SQUARE_1:93;
 then A6: p0`1<0 by A3,XREAL_1:60;
 A7: |.p0.|=sqrt((-cn)^2+sn^2) by A2,A3,JGRAPH_3:10
       .=sqrt((cn)^2+sn^2);
 cn^2=1-sn^2 by A4,SQUARE_1:def 4;
 then A8: p0`2/|.p0.|=sn by A7,EUCLID:56,SQUARE_1:83;
 p0 in K0 by A1,A5,A6;
 then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
 p0 in the carrier of TOP-REAL 2 & not p0 in {0.REAL 2}
               by A5,TARSKI:def 1;
  then reconsider D=B0 as non empty Subset of TOP-REAL 2 by A1,XBOOLE_0:def 4;
   A9: p0 in {p: p`2/|.p.|>=sn & p`1<=0 & p<>0.REAL 2} by A5,A6,A8;
   defpred P[Point of TOP-REAL 2] means
   $1`2/|.$1.|>=sn & $1`1<=0 & $1<>0.REAL 2;
   A10: {p: P[p]}
     is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
   A11: {p: p`2/|.p.|>=sn & p`1<=0 & p<>0.REAL 2} c= K1
    proof let x be set;assume x in
      {p: p`2/|.p.|>=sn & p`1<=0 & p<>0.REAL 2};
      then consider p such that
        A12:p=x & p`2/|.p.|>=sn & p`1<=0 & p<>0.REAL 2;
     thus x in K1 by A1,A12;
    end;
   then reconsider K00={p: p`2/|.p.|>=sn & p`1<=0 & p<>0.REAL 2}
      as non empty Subset of ((TOP-REAL 2)|K1) by A9,PRE_TOPC:29;
   reconsider K001={p: p`2/|.p.|>=sn & p`1<=0 & p<>0.REAL 2}
            as non empty Subset of TOP-REAL 2 by A9,A10;
     defpred P[Point of TOP-REAL 2] means $1`2>=(sn)*(|.$1.|) & $1`1<=0;
       {p: P[p]} is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
   then reconsider K003={p: p`2>=(sn)*(|.p.|) & p`1<=0}
            as Subset of TOP-REAL 2;
   A13: p0 in {p: p`2/|.p.|<=sn & p`1<=0 & p<>0.REAL 2} by A5,A6,A8;
   A14: {p: p`2/|.p.|<=sn & p`1<=0 & p<>0.REAL 2} c= K1
    proof let x be set;assume x in
      {p: p`2/|.p.|<=sn & p`1<=0 & p<>0.REAL 2};
      then consider p such that
      A15: p=x & p`2/|.p.|<=sn & p`1<=0 & p<>0.REAL 2;
     thus x in K1 by A1,A15;
    end;
   then reconsider K11={p: p`2/|.p.|<=sn & p`1<=0 & p<>0.REAL 2}
            as non empty Subset of ((TOP-REAL 2)|K1)
            by A13,PRE_TOPC:29;
    A16: p0 in {p: p`2/|.p.|<=sn & p`1<=0 & p<>0.REAL 2} by A5,A6,A8;
    defpred P[Point of TOP-REAL 2] means
    $1`2/|.$1.|<=sn & $1`1<=0 & $1<>0.REAL 2;
    {p: P[p]} is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
   then reconsider K111={p: p`2/|.p.|<=sn & p`1<=0 & p<>0.REAL 2}
            as non empty Subset of TOP-REAL 2 by A16;
   defpred P[Point of TOP-REAL 2] means $1`2<=(sn)*(|.$1.|) & $1`1<=0;
   {p: P[p]} is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
   then reconsider K004={p: p`2<=(sn)*(|.p.|) & p`1<=0}
            as Subset of TOP-REAL 2;
      the carrier of (TOP-REAL 2)|B0=the carrier of (TOP-REAL 2)|D;
  then A17: dom f=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1
    .=K1 by PRE_TOPC:29;
  then A18: dom (f|K00)=K00 by A11,RELAT_1:91
  .= the carrier of ((TOP-REAL 2)|K1)|K00 by PRE_TOPC:29;
  A19: the carrier of (TOP-REAL 2)|D=D by PRE_TOPC:29;
  rng (f|K00) c=D by A19;
  then reconsider f1=f|K00 as Function of ((TOP-REAL 2)|K1)|K00,(TOP-REAL 2)|D
                            by A18,FUNCT_2:4;
  A20: dom f1=the carrier of ((TOP-REAL 2)|K1)|K00 by FUNCT_2:def 1
  .=K00 by PRE_TOPC:29;
  A21: dom (sn-FanMorphW)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
  then A22: dom ((sn-FanMorphW)|K001)=K001 by RELAT_1:91
  .= the carrier of (TOP-REAL 2)|K001 by PRE_TOPC:29;
  A23: the carrier of (TOP-REAL 2)|K1 = K1 by PRE_TOPC:29;
      rng ((sn-FanMorphW)|K001) c= K1
   proof let y be set;assume y in rng ((sn-FanMorphW)|K001);
     then consider x being set such that
     A24: x in dom ((sn-FanMorphW)|K001) & y=((sn-FanMorphW)|K001).x
        by FUNCT_1:def 5;
     A25: dom ((sn-FanMorphW)|K001)=(dom (sn-FanMorphW))/\ K001 by FUNCT_1:68
     .=(the carrier of TOP-REAL 2)/\ K001 by FUNCT_2:def 1
     .=K001 by XBOOLE_1:28;
     reconsider q=x as Point of TOP-REAL 2 by A24;
     A26: y=(sn-FanMorphW).q by A24,FUNCT_1:70;
     consider p2 being Point of TOP-REAL 2 such that
     A27: p2=q & p2`2/|.p2.|>=sn & p2`1<=0 & p2<>0.REAL 2 by A24,A25;
     A28: sn-FanMorphW.q= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
     |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by A1,A27,Th25;
     set q4= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
     |.q.|* ((q`2/|.q.|-sn)/(1-sn))]|;
     |.q.|<>0 by A27,TOPRNS_1:25;
     then A29: (|.q.|)^2>0 by SQUARE_1:74;
     A30: 1-sn>0 by A1,XREAL_1:151;
        A31: q4`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))&
        q4`2= |.q.|*((q`2/|.q.|-sn)/(1-sn)) by EUCLID:56;
        A32: (q`2/|.q.|-sn)>= 0 by A27,XREAL_1:50;
        0<=(q`1)^2 by XREAL_1:65;
        then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`2)^2 <= (|.q.|)^2 by JGRAPH_3:10;
        then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A29,REAL_1:73;
        then (q`2)^2/(|.q.|)^2 <= 1 by A29,XCMPLX_1:60;
        then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then 1>=q`2/|.q.| by Lm2;
        then A33: 1-sn>=q`2/|.q.|-sn by XREAL_1:11;
        A34: -(1-sn)<= -0 by A30,XREAL_1:26;
             -(1-sn)<= -( q`2/|.q.|-sn) by A33,XREAL_1:26;
         then (-(1-sn))/(1-sn)<=(-( q`2/|.q.|-sn))/(1-sn) by A30,REAL_1:73;
        then A35: -1<=(-( q`2/|.q.|-sn))/(1-sn) by A30,XCMPLX_1:198;
           --(1-sn)>= -(q`2/|.q.|-sn) by A32,A34,XREAL_1:26;
       then (-(q`2/|.q.|-sn))/(1-sn)<=1 by A30,REAL_2:117;
       then ((-(q`2/|.q.|-sn))/(1-sn))^2<=1 by A35,SQUARE_1:119,59;
       then A36: 1-((-(q`2/|.q.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
       then 1-(-((q`2/|.q.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
       then A37: 1-((q`2/|.q.|-sn)/(1-sn))^2>=0;
           sqrt(1-((-(q`2/|.q.|-sn))/(1-sn))^2)>=0 by A36,SQUARE_1:def 4;
       then sqrt(1-(-(q`2/|.q.|-sn))^2/(1-sn)^2)>=0 by XCMPLX_1:77;
       then sqrt(1-(q`2/|.q.|-sn)^2/(1-sn)^2)>=0;
       then sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)>=0 by XCMPLX_1:77;
       then A38: -sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)<= -0 by XREAL_1:26;
        A39: (q4`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))^2 by A31
         .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1-sn))^2) by A37,SQUARE_1:def 4;
        A40: (q4`2)^2= (|.q.|)^2*((q`2/|.q.|-sn)/(1-sn))^2
                         by A31;
            (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
        .=(|.q.|)^2 by A39,A40;
     then q4`1<=0 & q4<>0.REAL 2 by A29,A31,A38,XREAL_1:133,SQUARE_1:
60,TOPRNS_1:24;
    hence y in K1 by A1,A26,A28;
   end;
  then reconsider f3=(sn-FanMorphW)|K001
   as Function of (TOP-REAL 2)|K001,(TOP-REAL 2)|K1  by A22,A23,FUNCT_2:4;
  A41: dom (f|K11)=K11 by A14,A17,RELAT_1:91
  .= the carrier of ((TOP-REAL 2)|K1)|K11 by PRE_TOPC:29;
  A42: the carrier of (TOP-REAL 2)|D=D by PRE_TOPC:29;
  rng (f|K11) c=D by A42;
  then reconsider f2=f|K11 as Function of ((TOP-REAL 2)|K1)|K11,(TOP-REAL 2)|D
                    by A41,FUNCT_2:4;
  A43: dom f2=the carrier of ((TOP-REAL 2)|K1)|K11 by FUNCT_2:def 1
  .=K11 by PRE_TOPC:29;
  A44: dom ((sn-FanMorphW)|K111)=K111 by A21,RELAT_1:91
  .= the carrier of (TOP-REAL 2)|K111 by PRE_TOPC:29;
  A45: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
      rng ((sn-FanMorphW)|K111) c= K1
   proof let y be set;assume y in rng ((sn-FanMorphW)|K111);
     then consider x being set such that
     A46: x in dom ((sn-FanMorphW)|K111) & y=((sn-FanMorphW)|K111).x
        by FUNCT_1:def 5;
     A47: dom ((sn-FanMorphW)|K111)=(dom (sn-FanMorphW))/\ K111 by FUNCT_1:68
     .=(the carrier of TOP-REAL 2)/\ K111 by FUNCT_2:def 1
     .=K111 by XBOOLE_1:28;
     reconsider q=x as Point of TOP-REAL 2 by A46;
     A48: y=(sn-FanMorphW).q by A46,FUNCT_1:70;
     consider p2 being Point of TOP-REAL 2 such that
     A49: p2=q & p2`2/|.p2.|<=sn & p2`1<=0 & p2<>0.REAL 2 by A46,A47;
     A50: sn-FanMorphW.q= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1+sn))]| by A1,A49,Th25;
     set q4= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1+sn))]|;
         |.q.|<>0 by A49,TOPRNS_1:25;
     then A51: (|.q.|)^2>0 by SQUARE_1:74;
   A52: 1+sn>0 by A1,XREAL_1:150;
        A53: q4`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))&
        q4`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by EUCLID:56;
        A54: (q`2/|.q.|-sn)<=0 by A49,REAL_2:106;
        A55: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        0<=(q`1)^2 by XREAL_1:65;
        then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A51,A55,REAL_1:73;
        then (q`2)^2/(|.q.|)^2 <= 1 by A51,XCMPLX_1:60;
        then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then -1<=q`2/|.q.| by Lm2;
        then A56: -1-sn<=q`2/|.q.|-sn by XREAL_1:11;
        (1+sn)/(1+sn)>=(q`2/|.q.|-sn)/(1+sn) by A52,A54,REAL_1:73;
        then A57: 1>=(q`2/|.q.|-sn)/(1+sn) by A52,XCMPLX_1:60;
        (-(1+sn))/(1+sn)<=(( q`2/|.q.|-sn))/(1+sn) by A52,A56,REAL_1:73;
        then -1<=(( q`2/|.q.|-sn))/(1+sn) by A52,XCMPLX_1:198;
       then (((q`2/|.q.|-sn))/(1+sn))^2<=1^2 by A57,SQUARE_1:119;
       then A58: 1-((q`2/|.q.|-sn)/(1+sn))^2>=0 by XREAL_1:50;
       then 1-(-((q`2/|.q.|-sn)/(1+sn)))^2>=0;
       then 1-((-(q`2/|.q.|-sn))/(1+sn))^2>=0 by XCMPLX_1:188;
       then sqrt(1-((-(q`2/|.q.|-sn))/(1+sn))^2)>=0 by SQUARE_1:def 4;
       then sqrt(1-(-(q`2/|.q.|-sn))^2/(1+sn)^2)>=0 by XCMPLX_1:77;
       then sqrt(1-(q`2/|.q.|-sn)^2/(1+sn)^2)>=0;
       then sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)>=0 by XCMPLX_1:77;
       then -sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)<= -0 by XREAL_1:26;
       then A59: q4`1<= 0 by A53,XREAL_1:133;
       A60: (q4`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))^2 by A53
         .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1+sn))^2) by A58,SQUARE_1:def 4;
       A61: (q4`2)^2= (|.q.|)^2*((q`2/|.q.|-sn)/(1+sn))^2
                         by A53;
       (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
        .=(|.q.|)^2 by A60,A61;
       then q4<>0.REAL 2 by A51,SQUARE_1:60,TOPRNS_1:24;
    hence y in K1 by A1,A48,A50,A59;
   end;
  then reconsider f4=(sn-FanMorphW)|K111
   as Function of (TOP-REAL 2)|K111,(TOP-REAL 2)|K1  by A44,A45,FUNCT_2:4;
  set T1= ((TOP-REAL 2)|K1)|K00,T2=((TOP-REAL 2)|K1)|K11;
  A62: [#](((TOP-REAL 2)|K1)|K00)=K00 by PRE_TOPC:def 10;
  A63: [#](((TOP-REAL 2)|K1)|K11)=K11 by PRE_TOPC:def 10;
  A64: [#]((TOP-REAL 2)|K1)=K1 by PRE_TOPC:def 10;
  A65: K1 c= K00 \/ K11
   proof let x be set;assume x in K1;
     then consider p such that
     A66: p=x & (p`1<=0 & p<>0.REAL 2) by A1;
     per cases;
     suppose p`2/|.p.|>=sn;
      then x in K00 by A66;
      hence x in K00 \/ K11 by XBOOLE_0:def 2;
     end;
     suppose p`2/|.p.|<sn;
      then x in K11 by A66;
      hence x in K00 \/ K11 by XBOOLE_0:def 2;
     end;
   end;
  then A67: [#](((TOP-REAL 2)|K1)|K00) \/ [#](((TOP-REAL 2)|K1)|K11)
        =[#]((TOP-REAL 2)|K1) by A62,A63,A64,XBOOLE_0:def 10;
  A68: K003 is closed by Th32;
  A69: K003 /\ K1 c= K00
   proof let x be set;assume x in K003 /\ K1;
     then A70: x in K003 & x in K1 by XBOOLE_0:def 3;
     then consider q1 being Point of TOP-REAL 2 such that
     A71: q1=x & q1`2>=(sn)*(|.q1.|) & q1`1<=0;
     consider q2 being Point of TOP-REAL 2 such that
     A72: q2=x & q2`1<=0 & q2<>0.REAL 2 by A1,A70;
     A73: |.q2.|<>0 by A72,TOPRNS_1:25;
     |.q1.|>0 by A71,A72,Lm1;
     then q1`2/|.q1.|>=(sn)*(|.q1.|)/|.q1.| by A71,REAL_1:73;
     then q1`2/|.q1.|>=(sn) by A71,A72,A73,XCMPLX_1:90;
    hence x in K00 by A71,A72;
   end;
   K00 c= K003 /\ K1
   proof let x be set;assume x in K00;
     then consider p such that
     A74: p=x & (p`2/|.p.|>=sn & p`1<=0 & p<>0.REAL 2);
     A75: |.p.|<>0 by A74,TOPRNS_1:25;
     p`2/|.p.|*|.p.|>=(sn)*(|.p.|) by A74,XREAL_1:66;
     then p`2>=(sn)*(|.p.|) by A75,XCMPLX_1:88;
     then A76: x in K003 by A74;
     x in K1 by A1,A74;
    hence x in K003 /\ K1 by A76,XBOOLE_0:def 3;
   end;
  then K00=K003 /\ [#]((TOP-REAL 2)|K1) by A64,A69,XBOOLE_0:def 10;
  then A77: K00 is closed by A68,PRE_TOPC:43;
  A78: K004 is closed by Th33;
  A79: K004 /\ K1 c= K11
   proof let x be set;assume x in K004 /\ K1;
     then A80: x in K004 & x in K1 by XBOOLE_0:def 3;
     then consider q1 being Point of TOP-REAL 2 such that
     A81: q1=x & q1`2<=(sn)*(|.q1.|) & q1`1<=0;
     consider q2 being Point of TOP-REAL 2 such that
     A82: q2=x & q2`1<=0 & q2<>0.REAL 2 by A1,A80;
     A83: |.q2.|<>0 by A82,TOPRNS_1:25;
     |.q1.|>0 by A81,A82,Lm1;
     then q1`2/|.q1.|<=(sn)*(|.q1.|)/|.q1.| by A81,REAL_1:73;
     then q1`2/|.q1.|<=(sn) by A81,A82,A83,XCMPLX_1:90;
    hence x in K11 by A81,A82;
   end;
   K11 c= K004 /\ K1
   proof let x be set;assume x in K11;
     then consider p such that
     A84: p=x & (p`2/|.p.|<=sn & p`1<=0 & p<>0.REAL 2);
     A85: |.p.|<>0 by A84,TOPRNS_1:25;
     p`2/|.p.|*|.p.|<=(sn)*(|.p.|) by A84,XREAL_1:66;
     then p`2<=(sn)*(|.p.|) by A85,XCMPLX_1:88;
     then A86: x in K004 by A84;
         x in K1 by A1,A84;
    hence x in K004 /\ K1 by A86,XBOOLE_0:def 3;
   end;
  then K11=K004 /\ [#]((TOP-REAL 2)|K1) by A64,A79,XBOOLE_0:def 10;
  then A87: K11 is closed by A78,PRE_TOPC:43;
  A88: ((TOP-REAL 2)|K1)|K00=(TOP-REAL 2)|K001 by GOBOARD9:4;
   K1 c= D
   proof let x be set;assume x in K1;
     then consider p6 being Point of TOP-REAL 2 such that
     A89: p6=x & p6`1<=0 & p6<>0.REAL 2 by A1;
    x in the carrier of TOP-REAL 2 & not x in {0.REAL 2} by A89,TARSKI:def 1;
    hence x in D by A1,XBOOLE_0:def 4;
   end;
  then D=K1 \/ D by XBOOLE_1:12;
  then A90: (TOP-REAL 2)|K1 is SubSpace of (TOP-REAL 2)|D by TOPMETR:5;
  the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
  then A91: f1= f3 by A1,FUNCT_1:82;
  f3 is continuous by A1,Th30;
  then A92: f1 is continuous by A88,A90,A91,TOPMETR:7;
  A93: ((TOP-REAL 2)|K1)|K11=(TOP-REAL 2)|K111 by GOBOARD9:4;
  the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
  then A94: f2= f4 by A1,FUNCT_1:82;
  f4 is continuous by A1,Th31;
  then A95: f2 is continuous by A90,A93,A94,TOPMETR:7;
  A96: D<>{};
  A97: the carrier of (TOP-REAL 2)|B0=B0 by PRE_TOPC:29;
  for p being set st p in ([#]T1)/\([#]T2) holds f1.p = f2.p
   proof let p be set;
    assume p in ([#]T1)/\([#]T2);
    then A98: p in K00 & p in K11 by A62,A63,XBOOLE_0:def 3;
    hence f1.p=f.p by FUNCT_1:72 .=f2.p by A98,FUNCT_1:72;
   end;
  then consider h being Function of (TOP-REAL 2)|K1,(TOP-REAL 2)|D such that
  A99: h=f1+*f2 & h is continuous by A62,A63,A67,A77,A87,A92,A95,JGRAPH_2:9;
  A100: dom h=the carrier of ((TOP-REAL 2)|K1) by FUNCT_2:def 1;
  A101: the carrier of ((TOP-REAL 2)|K1)=K0 by PRE_TOPC:29;
  A102: K0=the carrier of ((TOP-REAL 2)|K0) by PRE_TOPC:29
  .=dom f by A96,A97,FUNCT_2:def 1;
  for y being set st y in dom h holds h.y=f.y
   proof let y be set;assume
    A103: y in dom h;
    now per cases by A65,A100,A101,A103,XBOOLE_0:def 2;
    case A104: y in K00 & not y in K11;
     then y in dom f1 \/ dom f2 by A20,XBOOLE_0:def 2;
     hence h.y=f1.y by A43,A99,A104,FUNCT_4:def 1 .=f.y by A104,FUNCT_1:72;
    end;
    case A105: y in K11;
     then y in dom f1 \/ dom f2 by A43,XBOOLE_0:def 2;
     hence h.y=f2.y by A43,A99,A105,FUNCT_4:def 1 .=f.y by A105,FUNCT_1:72;
    end;
    end;
   hence h.y=f.y;
   end;
 hence thesis by A99,A100,A101,A102,FUNCT_1:9;
end;

theorem Th35:
  for sn being Real, K0,B0 being Subset of TOP-REAL 2,
      f being Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0 st
    -1<sn & sn<1 & f=(sn-FanMorphW)|K0 &
    B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} &
    K0={p: p`1>=0 & p<>0.REAL 2} holds f is continuous
proof let sn be Real,K0,B0 be Subset of TOP-REAL 2,
          f be Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0;
assume A1: -1<sn & sn<1 & f=(sn-FanMorphW)|K0 &
B0=(the carrier of TOP-REAL 2)\ {0.REAL 2} &
K0={p: p`1>=0 & p<>0.REAL 2};
 set cn=sqrt(1-sn^2);
 set p0=|[cn,-sn]|;
 A2: p0`1=cn by EUCLID:56;
       sn^2<1^2 by A1,SQUARE_1:120;
 then A3: 1-sn^2>0 by XREAL_1:52;
 then A4: p0<>0.REAL 2 by A2,JGRAPH_2:11,SQUARE_1:93;
     p0`1>0 by A2,A3,SQUARE_1:93;
 then p0 in K0 by A1,JGRAPH_2:11;
then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
     p0 in the carrier of TOP-REAL 2 & not p0 in {0.REAL 2}
               by A4,TARSKI:def 1;
  then reconsider D=B0 as non empty Subset of TOP-REAL 2 by A1,XBOOLE_0:def 4;
   A5: K1 c= D
    proof let x be set;assume x in K1;
     then consider p2 being Point of TOP-REAL 2 such that
 A6: p2=x & p2`1>=0 & p2<>0.REAL 2 by A1;
     not p2 in {0.REAL 2} by A6,TARSKI:def 1;
     hence x in D by A1,A6,XBOOLE_0:def 4;
    end;
    for p being Point of (TOP-REAL 2)|K1,V being Subset of (TOP-REAL 2)|D
      st f.p in V & V is open holds
      ex W being Subset of (TOP-REAL 2)|K1 st
      p in W & W is open & f.:W c= V
    proof let p be Point of (TOP-REAL 2)|K1,V be Subset of (TOP-REAL 2)|D;
      assume A7: f.p in V & V is open;
      then consider V2 being Subset of TOP-REAL 2 such that
      A8: V2 is open & V2 /\ [#]((TOP-REAL 2)|D)=V by TOPS_2:32;
      A9: p in the carrier of (TOP-REAL 2)|K1;
      A10: [#]((TOP-REAL 2)|K1)=K1 by PRE_TOPC:def 10;
      reconsider W2=V2 /\ [#]((TOP-REAL 2)|K1) as Subset of (TOP-REAL 2)|
K1;
      A11: W2 is open by A8,TOPS_2:32;
      A12: f.p=(sn-FanMorphW).p by A1,A10,FUNCT_1:72;
      consider q being Point of TOP-REAL 2 such that
      A13: q=p & q`1>=0 & q <>0.REAL 2 by A1,A9,A10;
      (sn-FanMorphW).q=q by A13,Th23;
      then p in V2 & p in [#]((TOP-REAL 2)|D) by A7,A8,A12,A13,XBOOLE_0:def 3;
      then A14: p in W2 by XBOOLE_0:def 3;
      f.:W2 c= V
       proof let y be set;assume y in f.:W2;
         then consider x being set such that
         A15: x in dom f & x in W2 & y=f.x by FUNCT_1:def 12;
             f is Function of (TOP-REAL 2)|K1, (TOP-REAL 2)|D;
         then dom f= K1 by A10,FUNCT_2:def 1;
         then consider p4 being Point of TOP-REAL 2 such that
         A16: x=p4 & p4`1>=0 & p4<>0.REAL 2 by A1,A15;
         A17: f.p4=(sn-FanMorphW).p4 by A1,A10,A15,A16,FUNCT_1:72
         .=p4 by A16,Th23;
         A18: p4 in V2 & p4 in [#]((TOP-REAL 2)|K1) by A15,A16,XBOOLE_0:def 3;
         then p4 in D by A5,A10;
         then p4 in [#]((TOP-REAL 2)|D) by PRE_TOPC:def 10;
        hence y in V by A8,A15,A16,A17,A18,XBOOLE_0:def 3;
       end;
     hence ex W being Subset of (TOP-REAL 2)|K1 st
      p in W & W is open & f.:W c= V by A11,A14;
    end;
  hence f is continuous by JGRAPH_2:20;
end;

theorem Th36:
 for B0 being Subset of TOP-REAL 2,
     K0 being Subset of (TOP-REAL 2)|B0 st
   B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} &
   K0={p: p`1<=0 & p<>0.REAL 2} holds K0 is closed
proof
 defpred P[Point of TOP-REAL 2] means $1`1<=0;
 set I1 = {p: P[p] & p<>0.REAL 2};
 set J0 = (the carrier of TOP-REAL 2) \ {0.REAL 2};
 let B0 be Subset of TOP-REAL 2,K0 be Subset of (TOP-REAL 2)|B0;
  assume A1: B0=J0 & K0=I1;
  reconsider K1={p7 where p7 is Point of TOP-REAL 2:P[p7]}
  as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
  A2:K1 is closed by JORDAN6:6;
      I1 = {p7 where p7 is Point of TOP-REAL 2 : P[p7]} /\ J0
    from JGRAPH_3:sch 2;
  then K0=K1 /\ [#]((TOP-REAL 2)|B0) by A1,PRE_TOPC:def 10;
hence K0 is closed by A2,PRE_TOPC:43;
end;

theorem Th37:
  for sn being Real, B0 being Subset of TOP-REAL 2,
      K0 being Subset of (TOP-REAL 2)|B0,
      f being Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0) st
    -1<sn & sn<1 & f=(sn-FanMorphW)|K0 &
    B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} &
    K0={p: p`1<=0 & p<>0.REAL 2} holds f is continuous
proof let sn be Real,B0 be Subset of TOP-REAL 2,K0 be Subset of
(TOP-REAL 2)|B0,f be Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0);
defpred P[Point of TOP-REAL 2] means $1`1<=0 & $1<>0.REAL 2;
assume A1:  -1<sn & sn<1 & f=(sn-FanMorphW)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2}
   & K0={p: p`1<=0 & p<>0.REAL 2 };
  reconsider K1={p: P[p] } as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
   K0 c= B0
   proof let x be set;assume x in K0;
    then consider p8 being Point of TOP-REAL 2 such that
    A2: x=p8 & (p8`1<=0 & p8<>0.REAL 2) by A1;
    not x in {0.REAL 2} by A2,TARSKI:def 1;
    hence x in B0 by A1,A2,XBOOLE_0:def 4;
   end;
  then ((TOP-REAL 2)|B0)|K0=(TOP-REAL 2)|K1 by A1,PRE_TOPC:28;
hence f is continuous by A1,Th34;
end;

theorem Th38:
 for B0 being Subset of TOP-REAL 2,
     K0 being Subset of (TOP-REAL 2)|B0
st B0=(the carrier of TOP-REAL 2) \ {0.REAL 2}
& K0={p: p`1>=0 & p<>0.REAL 2} holds K0 is closed
proof
 defpred P[Point of TOP-REAL 2] means $1`1>=0;
 set I1 = {p: P[p] & p<>0.REAL 2};
 set J0 = (the carrier of TOP-REAL 2) \ {0.REAL 2};
 let B0 be Subset of TOP-REAL 2,K0 be Subset of (TOP-REAL 2)|B0;
 assume A1: B0=J0 & K0=I1;
  reconsider K1={p7 where p7 is Point of TOP-REAL 2:P[p7]}
    as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
  A2:K1 is closed by JORDAN6:5;
      I1 = {p7 where p7 is Point of TOP-REAL 2 : P[p7]} /\ J0
    from JGRAPH_3:sch 2;
  then K0=K1 /\ [#]((TOP-REAL 2)|B0) by A1,PRE_TOPC:def 10;
hence K0 is closed by A2,PRE_TOPC:43;
end;

theorem Th39: for sn being Real,
 B0 being Subset of TOP-REAL 2,K0 being Subset of
(TOP-REAL 2)|B0,f being Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0)
st -1<sn & sn<1 & f=(sn-FanMorphW)|K0 &
B0=(the carrier of TOP-REAL 2) \ {0.REAL 2}
& K0={p: p`1>=0 & p<>0.REAL 2}
holds f is continuous
proof let sn be Real,
 B0 be Subset of TOP-REAL 2,K0 be Subset of
(TOP-REAL 2)|B0,f be Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0);
 assume A1:  -1<sn & sn<1 & f=(sn-FanMorphW)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2}
  & K0={p: p`1>=0 & p<>0.REAL 2};
  the carrier of (TOP-REAL 2)|B0= B0 by PRE_TOPC:29;
  then reconsider K1=K0 as Subset of TOP-REAL 2 by XBOOLE_1:1;
   K0 c= B0
   proof let x be set;assume x in K0;
    then consider p8 being Point of TOP-REAL 2 such that
A2: x=p8 & (p8`1>=0 & p8<>0.REAL 2) by A1;
    not x in {0.REAL 2} by A2,TARSKI:def 1;
    hence x in B0 by A1,A2,XBOOLE_0:def 4;
   end;
  then ((TOP-REAL 2)|B0)|K0=(TOP-REAL 2)|K1 by PRE_TOPC:28;
hence thesis by A1,Th35;
end;

theorem Th40:
  for sn being Real,p being Point of TOP-REAL 2 holds
    |.(sn-FanMorphW).p.|=|.p.|
proof let sn be Real,p be Point of TOP-REAL 2;
  set z=(sn-FanMorphW).p;
  reconsider q=p,qz=z as Point of TOP-REAL 2;
  per cases;
    suppose A1: q`2/|.q.|>=sn & q`1<0;
      then (sn-FanMorphW).q= |[
      |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
      |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by Th23;
      then A2: qz`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))&
      qz`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by EUCLID:56;
      |.q.|<>0 by A1,JGRAPH_2:11,TOPRNS_1:25;
      then A3: (|.q.|)^2>0 by SQUARE_1:74;
      A4: (q`2/|.q.|-sn)>=0 by A1,XREAL_1:50;
      A5: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
      0<=(q`1)^2 by XREAL_1:65;
      then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
      then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A3,A5,REAL_1:73;
      then (q`2)^2/(|.q.|)^2 <= 1 by A3,XCMPLX_1:60;
      then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
      then 1>=q`2/|.q.| by Lm2;
      then A6: 1-sn>=q`2/|.q.|-sn by XREAL_1:11;
      per cases;
        suppose A7: 1-sn=0;
          A8:((q`2/|.q.|-sn)/(1-sn))=(q`2/|.q.|-sn)*(1-sn)" by XCMPLX_0:def 9
             .= (q`2/|.q.|-sn)*0 by A7,XCMPLX_0:def 7 .=0;
             then -sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)=-1 by SQUARE_1:83;
             then (sn-FanMorphW).q= |[|.q.|*(-1),|.q.|*0]| by A1,A8,Th23
            .=|[-(|.q.|),0]|;
             then ((sn-FanMorphW).q)`1=-(|.q.|) & ((sn-FanMorphW).q)`2=0
                              by EUCLID:56;
            then |.(sn-FanMorphW).p.|=sqrt((-(|.q.|))^2+0) by JGRAPH_3:10
,SQUARE_1:60
            .=sqrt((|.q.|)^2)
            .=|.q.| by SQUARE_1:89;
           hence |.(sn-FanMorphW).p.|=|.p.|;
          end;
          suppose A9: 1-sn<>0;
          per cases by A9;
            suppose A10: 1-sn>0;
              then A11: -(1-sn)<= -0 by XREAL_1:26;
                  -(1-sn)<= -( q`2/|.q.|-sn) by A6,XREAL_1:26;
              then (-(1-sn))/(1-sn)<=(-( q`2/|.q.|-sn))/(1-sn)
                        by A10,REAL_1:73;
              then A12: -1<=(-( q`2/|.q.|-sn))/(1-sn)
                        by A10,XCMPLX_1:198;
                 --(1-sn)>= -(q`2/|.q.|-sn) by A4,A11,XREAL_1:26;
              then (-(q`2/|.q.|-sn))/(1-sn)<=1 by A10,REAL_2:117;
              then ((-(q`2/|.q.|-sn))/(1-sn))^2<=1^2 by A12,SQUARE_1:119;
              then 1-((-(q`2/|.q.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
              then 1-(-((q`2/|.q.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
              then A13: 1-((q`2/|.q.|-sn)/(1-sn))^2>=0;
              A14: (qz`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))^2
 by A2
                  .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1-sn))^2)
                            by A13,SQUARE_1:def 4;
        A15: (qz`2)^2= (|.q.|)^2*((q`2/|.q.|-sn)/(1-sn))^2
                         by A2;
             (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
               .=(|.q.|)^2 by A14,A15;
             then A16: sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
             thus |.(sn-FanMorphW).p.|=|.p.| by A16,SQUARE_1:89;
            end;
            suppose A17: 1-sn<0;
              A18: q`2/|.q.|-sn>=0 by A1,XREAL_1:50;
              0<(q`1)^2 by A1,SQUARE_1:74;
              then 0+(q`2)^2<(q`1)^2+(q`2)^2 by XREAL_1:10;
              then (q`2)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A3,A5,REAL_1:73;
              then (q`2)^2/(|.q.|)^2 < 1 by A3,XCMPLX_1:60;
              then ((q`2)/|.q.|)^2 < 1 by XCMPLX_1:77;
              then 1 > q`2/|.p.| by Lm3;
             hence |.(sn-FanMorphW).p.|=|.p.| by A17,A18,XREAL_1:11;
            end;
          end;
        end;
        suppose A19: q`2/|.q.|<sn & q`1<0;
          then A20:(sn-FanMorphW).q= |[
          |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1+sn))]| by Th24;
          then A21: qz`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))&
                  qz`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by EUCLID:56;
          |.q.|<>0 by A19,JGRAPH_2:11,TOPRNS_1:25;
          then A22: (|.q.|)^2>0 by SQUARE_1:74;
          A23: (q`2/|.q.|-sn)<0 by A19,REAL_2:105;
          A24: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
          0<=(q`1)^2 by XREAL_1:65;
          then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
          then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A22,A24,REAL_1:73;
          then (q`2)^2/(|.q.|)^2 <= 1 by A22,XCMPLX_1:60;
          then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
          then -1<=q`2/|.q.| by Lm2;
          then A25: -1-sn<=q`2/|.q.|-sn by XREAL_1:11;
          per cases;
            suppose A26: 1+sn=0;
             ((q`2/|.q.|-sn)/(1+sn))=(q`2/|.q.|-sn)*(1+sn)" by XCMPLX_0:def 9
             .= (q`2/|.q.|-sn)*0 by A26,XCMPLX_0:def 7 .=0;
            then (sn-FanMorphW).q=|[-(|.q.|),0]| by A20,SQUARE_1:83
;
             then ((sn-FanMorphW).q)`1=-(|.q.|) & ((sn-FanMorphW).q)`2=0
                              by EUCLID:56;
            then |.(sn-FanMorphW).p.|=sqrt((-(|.q.|))^2+0) by JGRAPH_3:10
,SQUARE_1:60
            .=sqrt((|.q.|)^2)
            .=|.q.| by SQUARE_1:89;
           hence |.(sn-FanMorphW).p.|=|.p.|;
          end;
          suppose A27: 1+sn<>0;
          per cases by A27;
            suppose A28: 1+sn>0;
              then (-(1+sn))/(1+sn)<=(( q`2/|.q.|-sn))/(1+sn)
                        by A25,REAL_1:73;
              then A29: -1<=(( q`2/|.q.|-sn))/(1+sn) by A28,XCMPLX_1:198;
              ((q`2/|.q.|-sn))/(1+sn)<=1 by A28,REAL_2:117,A23;
              then (((q`2/|.q.|-sn))/(1+sn))^2<=1 by A29,SQUARE_1:119
,59
;
              then A30: 1-(((q`2/|.q.|-sn))/(1+sn))^2>=0 by XREAL_1:50;
              A31: (qz`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))^2
 by A21
                  .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1+sn))^2)
                            by A30,SQUARE_1:def 4;
              A32: (qz`2)^2= (|.q.|)^2*((q`2/|.q.|-sn)/(1+sn))^2
                         by A21;
             (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
               .=(|.q.|)^2 by A31,A32;
              then A33: sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
             thus |.(sn-FanMorphW).p.|=|.p.| by A33,SQUARE_1:89;
            end;
            suppose 1+sn<0;
              then A34: -(1+sn)>-0 by XREAL_1:26;
              0<(q`1)^2 by A19,SQUARE_1:74;
              then 0+(q`2)^2<(q`1)^2+(q`2)^2 by XREAL_1:10;
              then (q`2)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A22,A24,REAL_1:73
;
              then (q`2)^2/(|.q.|)^2 < 1 by A22,XCMPLX_1:60;
              then ((q`2)/|.q.|)^2 < 1 by XCMPLX_1:77;
              then -1 < q`2/|.p.| by Lm3;
              then q`2/|.q.|-sn>-1-sn by XREAL_1:11;
             hence |.(sn-FanMorphW).p.|=|.p.| by A23,A34;
            end;
          end;
        end;
        suppose q`1>=0;
         hence |.(sn-FanMorphW).p.|=|.p.| by Th23;
        end;
end;

theorem Th41:
  for sn being Real,x,K0 being set st
  -1<sn & sn<1 & x in K0 & K0={p: p`1<=0 & p<>0.REAL 2} holds
  (sn-FanMorphW).x in K0
proof let sn be Real,x,K0 be set;
 assume A1:  -1<sn & sn<1 & x in K0 & K0={p: p`1<=0 & p<>0.REAL 2};
  then consider p such that
  A2: p=x & p`1<=0 & p<>0.REAL 2;
  A3:now assume |.p.|<=0;
    then |.p.|=0;
   hence contradiction by A2,TOPRNS_1:25;
  end;
  then A4: (|.p.|)^2>0 by SQUARE_1:74;
  per cases;
  suppose A5: p`2/|.p.|<=sn;
   then A6: (sn-FanMorphW).p= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
           |.p.|*((p`2/|.p.|-sn)/(1+sn))]| by A1,A2,Th25;
   reconsider p9= (sn-FanMorphW).p as Point of TOP-REAL 2;
   A7: p9`1=|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)) by A6,EUCLID:56;
   A8: 1+sn>0 by A1,XREAL_1:150;
       A9: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
      per cases;
       suppose p`1=0;
        hence (sn-FanMorphW).x in K0 by A1,A2,Th23;
       end;
       suppose p`1<>0;
         then 0<(p`1)^2 by SQUARE_1:74;
         then 0+(p`2)^2<(p`1)^2+(p`2)^2 by XREAL_1:10;
         then (p`2)^2/(|.p.|)^2 < (|.p.|)^2/(|.p.|)^2 by A4,A9,REAL_1:73;
         then (p`2)^2/(|.p.|)^2 < 1 by A4,XCMPLX_1:60;
         then A10: ((p`2)/|.p.|)^2 < 1 by XCMPLX_1:77;
         p`2/|.p.|-sn<=0 by A5,REAL_2:106;
         then A11: (p`2/|.p.|-sn)/(1+sn)<(1+sn)/(1+sn) by A8,REAL_1:73;
         -1 < p`2/|.p.| by A10,Lm3;
         then -1-sn< p`2/|.p.|-sn by XREAL_1:11;
         then (-1)*(1+sn)/(1+sn)< (p`2/|.p.|-sn)/(1+sn)
                       by A8,REAL_1:73;
         then -1< (p`2/|.p.|-sn)/(1+sn) & (p`2/|.p.|-sn)/(1+sn)<1
                           by A8,A11,XCMPLX_1:60,90;
         then 1^2> ((p`2/|.p.|-sn)/(1+sn))^2 by SQUARE_1:120;
         then 1-((p`2/|.p.|-sn)/(1+sn))^2>0 by XREAL_1:52;
         then --sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)>0 by SQUARE_1:93;
         then -sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)<0 by XREAL_1:60;
         then |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2))<0
                           by A3,XREAL_1:134;
        hence (sn-FanMorphW).x in K0 by A1,A2,A7,JGRAPH_2:11;
        end;
  end;
  suppose A12: p`2/|.p.|>sn;
   then A13: (sn-FanMorphW).p= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
   |.p.|*((p`2/|.p.|-sn)/(1-sn))]| by A1,A2,Th25;
   reconsider p9= (sn-FanMorphW).p as Point of TOP-REAL 2;
   A14: p9`1=|.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)) by A13,EUCLID:56;
    A15: 1-sn>0 by A1,XREAL_1:151;
       A16: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
       per cases;
       suppose p`1=0;
        hence (sn-FanMorphW).x in K0 by A1,A2,Th23;
       end;
       suppose p`1<>0;
         then 0<(p`1)^2 by SQUARE_1:74;
         then 0+(p`2)^2<(p`1)^2+(p`2)^2 by XREAL_1:10;
         then (p`2)^2/(|.p.|)^2 < (|.p.|)^2/(|.p.|)^2 by A4,A16,REAL_1:73;
         then (p`2)^2/(|.p.|)^2 < 1 by A4,XCMPLX_1:60;
         then ((p`2)/|.p.|)^2 < 1 by XCMPLX_1:77;
         then p`2/|.p.|<1 by Lm3;
         then (p`2/|.p.|-sn)<1-sn by XREAL_1:11;
         then A17: (p`2/|.p.|-sn)/(1-sn)<(1-sn)/(1-sn) by A15,REAL_1:73;
         A18: -(1-sn)< -0 by A15,XREAL_1:26;
         p`2/|.p.|-sn>=sn-sn by A12,XREAL_1:11;
         then (-1)*(1-sn)/(1-sn)< (p`2/|.p.|-sn)/(1-sn)
                  by A15,A18,REAL_1:73;
         then -1< (p`2/|.p.|-sn)/(1-sn) & (p`2/|.p.|-sn)/(1-sn)<1
                  by A15,A17,XCMPLX_1:60,90;
         then 1> ((p`2/|.p.|-sn)/(1-sn))^2 by SQUARE_1:120,59;
         then 1-((p`2/|.p.|-sn)/(1-sn))^2>0 by XREAL_1:52;
         then --sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)>0 by SQUARE_1:93;
         then -sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)<0 by XREAL_1:60;
         then p9`1<0 by A3,A14,XREAL_1:134;
        hence (sn-FanMorphW).x in K0 by A1,A2,JGRAPH_2:11;
       end;
      end;
end;

theorem Th42: for sn being Real,x,K0 being set
 st -1<sn & sn<1 & x in K0 & K0={p: p`1>=0 & p<>0.REAL 2}
holds (sn-FanMorphW).x in K0
proof let sn be Real,x,K0 be set;
 assume A1:  -1<sn & sn<1 & x in K0 &
 K0={p: p`1>=0 & p<>0.REAL 2};
 then consider p such that
 A2: p=x & p`1>=0 & p<>0.REAL 2;
 thus (sn-FanMorphW).x in K0 by A1,A2,Th23;
end;

scheme InclSub { D() -> non empty Subset of TOP-REAL 2, P[set] } :
  { p : P[p] & p<>0.REAL 2 } c= the carrier of (TOP-REAL 2)|D()
  provided
A1:  D() = (the carrier of TOP-REAL 2) \ {0.REAL 2}
proof
  let x be set;
A2:D()` = {0.REAL 2} by A1,JGRAPH_3:30;
  assume x in {p: P[p] & p<>0.REAL 2};
  then consider p such that A3: x=p & P[p] & p<>0.REAL 2;
  now assume not x in D();
    then x in (the carrier of TOP-REAL 2) \ D() by A3,XBOOLE_0:def 4;
    then x in D()` by SUBSET_1:def 5;
    hence contradiction by A2,A3,TARSKI:def 1;
  end;
  hence thesis by PRE_TOPC:29;
end;

theorem Th43:for sn being Real,
 D being non empty Subset of TOP-REAL 2
st -1<sn & sn<1 & D`={0.REAL 2} holds
ex h being Function of (TOP-REAL 2)|D,(TOP-REAL 2)|D
st h=(sn-FanMorphW)|D & h is continuous
proof let sn be Real,D be non empty Subset of TOP-REAL 2;
assume A1:  -1<sn & sn<1 & D`={0.REAL 2};
  reconsider B0= {0.REAL 2} as Subset of TOP-REAL 2;
  A2: D =(B0)` by A1
     .=((the carrier of TOP-REAL 2)\ {0.REAL 2}) by SUBSET_1:def 5;
     defpred P[Point of TOP-REAL 2] means $1`1<=0;
    A3:{p: P[p] & p<>0.REAL 2} c= the carrier of (TOP-REAL 2)|D
      from InclSub(A2);
      (|[0,1]|)`1=0 & (|[0,1]|)`2=1 by EUCLID:56;
      then |[0,1]| in {p where p is Point of TOP-REAL 2:
      p`1<=0 & p<>0.REAL 2} by JGRAPH_2:11;
      then reconsider K0={p:p`1<=0 & p<>0.REAL 2}
          as non empty Subset of (TOP-REAL 2)|D by A3;
      defpred P[Point of TOP-REAL 2] means $1`1>=0;
    A4:{p: P[p] & p<>0.REAL 2} c= the carrier of (TOP-REAL 2)|D
       from InclSub(A2);
     set Y1=|[0,1]|;
        Y1`1=0 & Y1`2=1 by EUCLID:56;
     then Y1 in {p where p is Point of TOP-REAL 2:
     p`1>=0 & p<>0.REAL 2} by JGRAPH_2:11;
  then reconsider K1={p: p`1>=0 & p<>0.REAL 2}
       as non empty Subset of (TOP-REAL 2)|D by A4;
   A5:the carrier of ((TOP-REAL 2)|D) =D by PRE_TOPC:29;
   A6:K0 c= (the carrier of TOP-REAL 2)
   proof let z be set;assume z in K0;
    then consider p8 being Point of TOP-REAL 2 such that
    A7: p8=z & p8`1<=0 & p8<>0.REAL 2;
    thus z in (the carrier of TOP-REAL 2) by A7;
   end;
  A8:dom ((sn-FanMorphW)|K0)= dom ((sn-FanMorphW)) /\ K0 by FUNCT_1:68
       .=((the carrier of TOP-REAL 2)) /\ K0 by FUNCT_2:def 1
       .=K0 by A6,XBOOLE_1:28;
  A9: K0 =the carrier of ((TOP-REAL 2)|D)|K0 by PRE_TOPC:29;
      rng ((sn-FanMorphW)|K0) c= the carrier of ((TOP-REAL 2)|D)|K0
   proof let y be set;assume y in rng ((sn-FanMorphW)|K0);
     then consider x being set such that
     A10:x in dom ((sn-FanMorphW)|K0)
     & y=((sn-FanMorphW)|K0).x by FUNCT_1:def 5;
         x in (dom (sn-FanMorphW)) /\ K0 by A10,FUNCT_1:68;
     then A11:x in K0 by XBOOLE_0:def 3;
         K0 c= the carrier of TOP-REAL 2 by A5,XBOOLE_1:1;
     then reconsider p=x as Point of TOP-REAL 2 by A11;
        (sn-FanMorphW).p=y by A10,A11,FUNCT_1:72;
     then y in K0 by A1,A11,Th41;
    hence y in the carrier of ((TOP-REAL 2)|D)|K0 by PRE_TOPC:29;
   end;
  then rng ((sn-FanMorphW)|K0)c= the carrier of ((TOP-REAL 2)|D)
                            by A9,XBOOLE_1:1;
  then reconsider f=(sn-FanMorphW)|K0 as Function of ((TOP-REAL 2)|D)|K0,
  ((TOP-REAL 2)|D)  by A8,A9,FUNCT_2:4;
   A12:K1 c= (the carrier of TOP-REAL 2)
   proof let z be set;assume z in K1;
    then consider p8 being Point of TOP-REAL 2 such that
    A13: p8=z & p8`1>=0 & p8<>0.REAL 2;
    thus z in (the carrier of TOP-REAL 2) by A13;
   end;
  A14:dom ((sn-FanMorphW)|K1)= dom ((sn-FanMorphW)) /\ K1 by FUNCT_1:68
       .=((the carrier of TOP-REAL 2)) /\ K1 by FUNCT_2:def 1
       .=K1 by A12,XBOOLE_1:28;
  A15: K1=the carrier of ((TOP-REAL 2)|D)|K1 by PRE_TOPC:29;
      rng ((sn-FanMorphW)|K1) c= the carrier of ((TOP-REAL 2)|D)|K1
   proof let y be set;assume y in rng ((sn-FanMorphW)|K1);
     then consider x being set such that
     A16:x in dom ((sn-FanMorphW)|K1)
     & y=((sn-FanMorphW)|K1).x by FUNCT_1:def 5;
     x in (dom (sn-FanMorphW)) /\ K1 by A16,FUNCT_1:68;
     then A17:x in K1 by XBOOLE_0:def 3;
     K1 c= the carrier of TOP-REAL 2 by A5,XBOOLE_1:1;
     then reconsider p=x as Point of TOP-REAL 2 by A17;
     (sn-FanMorphW).p=y by A16,A17,FUNCT_1:72;
     then y in K1 by A1,A17,Th42;
    hence y in the carrier of ((TOP-REAL 2)|D)|K1 by PRE_TOPC:29;
   end;
  then rng ((sn-FanMorphW)|K1)c= the carrier of ((TOP-REAL 2)|D)
                     by A15,XBOOLE_1:1;
  then reconsider g=(sn-FanMorphW)|K1 as Function of ((TOP-REAL 2)|D)|K1,
  ((TOP-REAL 2)|D)  by A14,A15,FUNCT_2:4;
  A18:K0=[#](((TOP-REAL 2)|D)|K0) by PRE_TOPC:def 10;
  A19:K1=[#](((TOP-REAL 2)|D)|K1) by PRE_TOPC:def 10;
  A20:D= [#]((TOP-REAL 2)|D) by PRE_TOPC:def 10;
   D c= K0 \/ K1
   proof let x be set;assume A21: x in D;
     then A22:x in (the carrier of TOP-REAL 2) & not x in {0.REAL 2}
                                     by A2,XBOOLE_0:def 4;
     reconsider px=x as Point of TOP-REAL 2 by A21;
         px`1<=0 & px<>0.REAL 2 or
       px`1>=0 & px<>0.REAL 2 by A22,TARSKI:def 1;
     then x in K0 or x in K1;
    hence x in K0 \/ K1 by XBOOLE_0:def 2;
   end;
  then A23:([#](((TOP-REAL 2)|D)|K0)) \/ ([#](((TOP-REAL 2)|D)|K1))
  = [#]((TOP-REAL 2)|D) by A18,A19,A20,XBOOLE_0:def 10;
  A24: f is continuous & K0 is closed by A1,A2,Th36,Th37;
  A25: g is continuous & K1 is closed by A1,A2,Th38,Th39;
  A26: for x be set st x in ([#]((((TOP-REAL 2)|D)|K0)))
        /\ ([#] ((((TOP-REAL 2)|D)|K1))) holds f.x = g.x
   proof let x be set;assume x in ([#]((((TOP-REAL 2)|D)|K0)))
        /\ ([#] ((((TOP-REAL 2)|D)|K1)));
     then A27:x in K0 & x in K1 by A18,A19,XBOOLE_0:def 3;
     then f.x=(sn-FanMorphW).x by FUNCT_1:72;
    hence f.x = g.x by A27,FUNCT_1:72;
   end;
  then consider h being Function of (TOP-REAL 2)|D,(TOP-REAL 2)|D
  such that A28: h= f+*g & h is continuous
                          by A18,A19,A23,A24,A25,JGRAPH_2:9;
  A29:dom h=the carrier of ((TOP-REAL 2)|D) by FUNCT_2:def 1;
  A30:the carrier of ((TOP-REAL 2)|D)=D by PRE_TOPC:29;
  A31:the carrier of ((TOP-REAL 2)|D) =
((the carrier of TOP-REAL 2)\ {0.REAL 2}) by A2,PRE_TOPC:29;
      dom (sn-FanMorphW)=(the carrier of (TOP-REAL 2))
                    by FUNCT_2:def 1;
  then A32:dom ((sn-FanMorphW)|D)=(the carrier of (TOP-REAL 2))/\ D
                    by FUNCT_1:68
              .=the carrier of ((TOP-REAL 2)|D) by A30,XBOOLE_1:28;
  A33:dom f=K0 by A9,FUNCT_2:def 1;
  A34:K0=[#](((TOP-REAL 2)|D)|K0) by PRE_TOPC:def 10;
  A35:dom g=K1 by A15,FUNCT_2:def 1;
     K1=[#](((TOP-REAL 2)|D)|K1) by PRE_TOPC:def 10;
  then A36: f tolerates g by A26,A33,A34,A35,PARTFUN1:def 6;
      for x being set st x in dom h holds h.x=((sn-FanMorphW)|D).x
   proof let x be set;assume A37: x in dom h;
     then x in (the carrier of TOP-REAL 2) & not x in {0.REAL 2}
                     by A31,XBOOLE_0:def 4;
     then A38:x <>0.REAL 2 by TARSKI:def 1;
     reconsider p=x as Point of TOP-REAL 2 by A31,A37,XBOOLE_0:def 4;
     A39: x in D`` by A29,A37,PRE_TOPC:29;
     per cases;
     suppose A40:x in K0;
       A41:(sn-FanMorphW)|D.p=(sn-FanMorphW).p by A39,FUNCT_1:72
          .=f.p by A40,FUNCT_1:72;
           h.p=(g+*f).p by A28,A36,FUNCT_4:35
       .=f.p by A33,A40,FUNCT_4:14;
      hence h.x=(sn-FanMorphW)|D.x by A41;
     end;
     suppose not x in K0;
       then not (p`1<=0) by A38;
       then A42:x in K1 by A38;
       (sn-FanMorphW)|D.p=(sn-FanMorphW).p by A39,FUNCT_1:72
                           .=g.p by A42,FUNCT_1:72;
      hence h.x=(sn-FanMorphW)|D.x by A28,A35,A42,FUNCT_4:14;
     end;
   end;
  then f+*g=(sn-FanMorphW)|D by A28,A29,A32,FUNCT_1:9;
 hence thesis by A18,A19,A23,A24,A25,A26,JGRAPH_2:9;
end;

theorem Th44: for sn being Real
  st -1<sn & sn<1 holds
  ex h being Function of (TOP-REAL 2),(TOP-REAL 2)
  st h=(sn-FanMorphW) & h is continuous
proof let sn be Real;
 assume A1: -1<sn & sn<1;
 reconsider f=(sn-FanMorphW) as Function of (TOP-REAL 2),(TOP-REAL 2)
                         ;
 reconsider D=(the carrier of TOP-REAL 2) \{0.REAL 2}
   as non empty Subset of TOP-REAL 2 by JGRAPH_2:19;
A2: f.(0.REAL 2)=0.REAL 2 by Th23,JGRAPH_2:11;
A3: D`= {0.REAL 2} by JGRAPH_3:30;
A4: for p being Point of (TOP-REAL 2)|D holds f.p<>f.(0.REAL 2)
  proof let p be Point of (TOP-REAL 2)|D;
A5: [#]((TOP-REAL 2)|D)=D by PRE_TOPC:def 10;
    then A6:p in the carrier of TOP-REAL 2 & not p in {0.REAL 2}
                         by XBOOLE_0:def 4;
    reconsider q=p as Point of TOP-REAL 2 by A5,XBOOLE_0:def 4;
A7: p<>0.REAL 2 by A6,TARSKI:def 1;
    per cases;
    suppose A8: q`2/|.q.|>=sn & q`1<=0;
      set q9= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1-sn))]|;
      A9:q9`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)) &
      q9`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by EUCLID:56;
       now assume A10: q9=0.REAL 2;
       A11: |.q.|<>0 by A7,TOPRNS_1:25;
       then -sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)=-sqrt(1-0) by A9,A10,
JGRAPH_2:11,SQUARE_1:60,XCMPLX_1:6
       .=-1 by SQUARE_1:83;
      hence contradiction by A9,A10,A11,JGRAPH_2:11,XCMPLX_1:6;
     end;
     hence f.p<>f.(0.REAL 2) by A1,A2,A7,A8,Th25;
    end;
    suppose A12: q`2/|.q.|<sn & q`1<=0;
      set q9=|[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
              |.q.|* ((q`2/|.q.|-sn)/(1+sn))]|;
      A13:q9`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)) &
          q9`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by EUCLID:56;
          now assume A14: q9=0.REAL 2;
       A15: |.q.|<>0 by A7,TOPRNS_1:25;
       then -sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)=-sqrt(1-0) by A13,A14,
JGRAPH_2:11,SQUARE_1:60,XCMPLX_1:6
       .=-1 by SQUARE_1:83;
      hence contradiction by A13,A14,A15,JGRAPH_2:11,XCMPLX_1:6;
     end;
     hence f.p<>f.(0.REAL 2) by A1,A2,A7,A12,Th25;
     end;
     suppose q`1>0; then f.p=p by Th23;
     hence f.p<>f.(0.REAL 2) by A7,Th23,JGRAPH_2:11;
    end;
  end;
 A16:ex h being Function of (TOP-REAL 2)|D,(TOP-REAL 2)|D
  st h=(sn-FanMorphW)|D & h is continuous by A1,A3,Th43;
     for V being Subset of (TOP-REAL 2) st f.(0.REAL 2) in V & V is open
 ex W being Subset of (TOP-REAL 2) st 0.REAL 2 in W & W is open & f.:W c= V
  proof let V be Subset of TOP-REAL 2;
    assume A17:f.(0.REAL 2) in V & V is open;
     reconsider u0=0.REAL 2 as Point of Euclid 2;
     consider r being real number such that
A18: r>0 & Ball(u0,r) c= V by A2,A17,TOPMETR:22;
     reconsider r as Real by XREAL_0:def 1;
     reconsider W1=Ball(u0,r) as Subset of TOP-REAL 2;
     A19:u0 in W1 by A18,GOBOARD6:4;
     A20:W1 is open by GOBOARD6:6;
     f.:W1 c= W1
      proof let z be set;assume z in f.:W1;
        then consider y being set such that
        A21: y in dom f & y in W1 & z=f.y by FUNCT_1:def 12;
        reconsider q=y as Point of TOP-REAL 2 by A21;
        reconsider qy=q as Point of Euclid 2;
        z in rng f by A21,FUNCT_1:def 5;
        then reconsider qz=z as Point of TOP-REAL 2;
        reconsider pz=qz as Point of Euclid 2;
        dist(u0,qy)<r by A21,METRIC_1:12;
        then A22: |.(0.REAL 2) - q.|<r by JGRAPH_1:45;
        per cases by JGRAPH_2:11;
        suppose q`1>=0;
         hence z in W1 by A21,Th23;
        end;
        suppose A23: q<>0.REAL 2 &
          (q`2/|.q.|>=sn & q`1<=0);
          then A24:(sn-FanMorphW).q= |[
          |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by A1,Th25;
              |.q.|<>0 by A23,TOPRNS_1:25;
          then A25: (|.q.|)^2>0 by SQUARE_1:74;
        A26: 1-sn>0 by A1,XREAL_1:151;
        A27: qz`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))&
        qz`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn))
                     by A21,A24,EUCLID:56;
        A28: (q`2/|.q.|-sn)>= 0 by A23,XREAL_1:50;
        A29: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        0<=(q`1)^2 by XREAL_1:65;
        then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A25,A29,REAL_1:73;
        then (q`2)^2/(|.q.|)^2 <= 1 by A25,XCMPLX_1:60;
        then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then 1>=q`2/|.q.| by Lm2;
        then A30: 1-sn>=q`2/|.q.|-sn by XREAL_1:11;
        A31: -(1-sn)<= -0 by A26,XREAL_1:26;
         -(1-sn)<= -( q`2/|.q.|-sn) by A30,XREAL_1:26;
         then (-(1-sn))/(1-sn)<=(-( q`2/|.q.|-sn))/(1-sn)
                        by A26,REAL_1:73;
        then A32: -1<=(-( q`2/|.q.|-sn))/(1-sn) by A26,XCMPLX_1:198;
           --(1-sn)>= -(q`2/|.q.|-sn) by A28,A31,XREAL_1:26;
       then (-(q`2/|.q.|-sn))/(1-sn)<=1 by A26,REAL_2:117;
       then ((-(q`2/|.q.|-sn))/(1-sn))^2<=1^2 by A32,SQUARE_1:119;
       then 1-((-(q`2/|.q.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
       then 1-(-((q`2/|.q.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
       then A33: 1-((q`2/|.q.|-sn)/(1-sn))^2>=0;
        A34: (qz`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))^2 by A27
         .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1-sn))^2) by A33,SQUARE_1:def 4;
        A35: (qz`2)^2= (|.q.|)^2*((q`2/|.q.|-sn)/(1-sn))^2
                         by A27;
            (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
        .=(|.q.|)^2 by A34,A35;
        then A36: sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
          A37: |.qz.|=|.q.| by A36,SQUARE_1:89;
          |.(0.REAL 2) +- q.|<r by A22,EUCLID:45;
          then |.- q.|<r by EUCLID:31;
          then |.q.|<r by TOPRNS_1:27;
          then |.- qz.|<r by A37,TOPRNS_1:27;
          then |.(0.REAL 2) +- qz.|<r by EUCLID:31;
          then |.(0.REAL 2) - qz.|<r by EUCLID:45;
          then dist(u0,pz)<r by JGRAPH_1:45;
         hence z in W1 by METRIC_1:12;
        end;
        suppose A38: q<>0.REAL 2 &
          q`2/|.q.|<sn & q`1<=0;
          then A39:(sn-FanMorphW).q= |[
          |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1+sn))]| by A1,Th25;
          |.q.|<>0 by A38,TOPRNS_1:25;
          then A40: (|.q.|)^2>0 by SQUARE_1:74;
        A41: (sn-q`2/|.q.|)>=0 by A38,XREAL_1:50;
        A42: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        A43: 1+sn>0 by A1,XREAL_1:150;
        A44: qz`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))&
        qz`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by A21,A39,EUCLID:56;
        0<=(q`1)^2 by XREAL_1:65;
        then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A40,A42,REAL_1:73;
        then (q`2)^2/(|.q.|)^2 <= 1 by A40,XCMPLX_1:60;
        then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then -1<=q`2/|.q.| by Lm2;
        then --1>=-q`2/|.q.| by XREAL_1:26;
        then A45: 1+sn>=-q`2/|.q.|+sn by XREAL_1:9;
         -(1+sn)<= -0 by A43,XREAL_1:26;
         then (-(1+sn))/(1+sn)<=(-( q`2/|.q.|-sn))/(1+sn)
                        by A41,A43,REAL_1:73;
        then A46: -1<=(-( q`2/|.q.|-sn))/(1+sn) by A43,XCMPLX_1:198;
        (-(q`2/|.q.|-sn))/(1+sn)<=1 by A43,A45,REAL_2:117;
       then ((-(q`2/|.q.|-sn))/(1+sn))^2<=1^2 by A46,SQUARE_1:119;
       then 1-((-(q`2/|.q.|-sn))/(1+sn))^2>=0 by XREAL_1:50;
       then 1-(-((q`2/|.q.|-sn))/(1+sn))^2>=0 by XCMPLX_1:188;
       then A47: 1-((q`2/|.q.|-sn)/(1+sn))^2>=0;
        A48: (qz`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))^2 by A44
         .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1+sn))^2) by A47,SQUARE_1:def 4;
        A49: (qz`2)^2= (|.q.|)^2*((q`2/|.q.|-sn)/(1+sn))^2
                         by A44;
            (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
        .=(|.q.|)^2 by A48,A49;
        then A50: sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
          A51: |.qz.|=|.q.| by A50,SQUARE_1:89;
          |.(0.REAL 2) +- q.|<r by A22,EUCLID:45;
          then |.- q.|<r by EUCLID:31;
          then |.q.|<r by TOPRNS_1:27;
          then |.- qz.|<r by A51,TOPRNS_1:27;
          then |.(0.REAL 2) +- qz.|<r by EUCLID:31;
          then |.(0.REAL 2) - qz.|<r by EUCLID:45;
          then dist(u0,pz)<r by JGRAPH_1:45;
         hence z in W1 by METRIC_1:12;
        end;
      end;
     then f.:W1 c= V by A18,XBOOLE_1:1;
   hence ex W being Subset of (TOP-REAL 2) st 0.REAL 2 in W
       & W is open & f.:W c= V by A19,A20;
  end;
  then f is continuous by A2,A3,A4,A16,JGRAPH_3:13;
 hence thesis;
end;

theorem Th45:
  for sn being Real st -1<sn & sn<1 holds sn-FanMorphW is one-to-one
proof let sn be Real;
 assume A1:  -1<sn & sn<1;
 for x1,x2 being set st x1 in dom (sn-FanMorphW) & x2 in dom (sn-FanMorphW)
   & (sn-FanMorphW).x1=(sn-FanMorphW).x2 holds x1=x2
  proof let x1,x2 be set;
   assume A2: x1 in dom (sn-FanMorphW) & x2 in dom (sn-FanMorphW)
    & (sn-FanMorphW).x1=(sn-FanMorphW).x2;
    then reconsider p1=x1 as Point of TOP-REAL 2;
    reconsider p2=x2 as Point of TOP-REAL 2 by A2;
    set q=p1,p=p2;
    A3: 1-sn>0 by A1,XREAL_1:151;
        now per cases by JGRAPH_2:11;
    case A4: q`1>=0;
      then A5:(sn-FanMorphW).q=q by Th23;
      now per cases by JGRAPH_2:11;
      case p`1>=0;
       hence x1=x2 by A2,A5,Th23;
      end;
      case A6:p<>0.REAL 2 &
          (p`2/|.p.|>=sn & p`1<=0);
        then A7:
         sn-FanMorphW.p= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
          |.p.|* ((p`2/|.p.|-sn)/(1-sn))]| by A1,Th25;
         set p4= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
          |.p.|* ((p`2/|.p.|-sn)/(1-sn))]|;
        A8: p4`1= |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)) &
          p4`2= |.p.|* ((p`2/|.p.|-sn)/(1-sn)) by EUCLID:56;
     A9: |.p.|>0 by A6,Lm1;
     then A10: (|.p.|)^2>0 by SQUARE_1:74;
        A11: (p`2/|.p.|-sn)>=0 by A6,XREAL_1:50;
        A12: (p`2/|.p.|-sn)>= 0 by A6,XREAL_1:50;
        A13: (p`2/|.p.|-sn)/(1-sn)>=0 by A3,A11,REAL_2:125;
        A14: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
        0<=(p`1)^2 by XREAL_1:65;
        then 0+(p`2)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
        then (p`2)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by A10,A14,REAL_1:73;
        then (p`2)^2/(|.p.|)^2 <= 1 by A10,XCMPLX_1:60;
        then ((p`2)/|.p.|)^2 <= 1 by XCMPLX_1:77;
        then 1>=p`2/|.p.| by Lm2;
        then A15: 1-sn>=p`2/|.p.|-sn by XREAL_1:11;
        A16: -(1-sn)<= -0 by A3,XREAL_1:26;
             -(1-sn)<= -( p`2/|.p.|-sn) by A15,XREAL_1:26;
         then (-(1-sn))/(1-sn)<=(-( p`2/|.p.|-sn))/(1-sn)
                        by A3,REAL_1:73;
        then A17: -1<=(-( p`2/|.p.|-sn))/(1-sn)
                        by A3,XCMPLX_1:198;
           --(1-sn)>= -(p`2/|.p.|-sn) by A12,A16,XREAL_1:26;
       then (-(p`2/|.p.|-sn))/(1-sn)<=1 by A3,REAL_2:117;
       then ((-(p`2/|.p.|-sn))/(1-sn))^2<=1^2 by A17,SQUARE_1:119;
       then A18: 1-((-(p`2/|.p.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
       then 1-(-((p`2/|.p.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
       then A19: 1-((p`2/|.p.|-sn)/(1-sn))^2>=0;
           sqrt(1-((-(p`2/|.p.|-sn))/(1-sn))^2)>=0 by A18,SQUARE_1:def 4;
       then sqrt(1-(-(p`2/|.p.|-sn))^2/(1-sn)^2)>=0 by XCMPLX_1:77;
       then sqrt(1-(p`2/|.p.|-sn)^2/(1-sn)^2)>=0;
       then sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)>=0 by XCMPLX_1:77;
       then -sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)<= -0 by XREAL_1:26;
        then q`1=0 by A2,A4,A5,A7,A8,XREAL_1:133;
        then (-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2))=0 by A2,A5,A7,A8,A9,
XCMPLX_1:6;
        then sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)=0;
        then 1-((p`2/|.p.|-sn)/(1-sn))^2=0 by A19,SQUARE_1:92;
        then 1=0+((p`2/|.p.|-sn)/(1-sn))^2;
        then 1= (p`2/|.p.|-sn)/(1-sn) by A13,SQUARE_1:83,89;
        then 1 *(1-sn)=(p`2/|.p.|-sn) by A3,XCMPLX_1:88;
        then 1-sn+sn=p`2/|.p.|;
        then 1=p`2/|.p.|;
        then 1 *|.p.|=p`2 by A9,XCMPLX_1:88;
        then (p`2)^2-(p`2)^2 =(p`1)^2 by A14;
        then 0= (p`1)^2;
        then p`1=0 by XCMPLX_1:6;
       hence x1=x2 by A2,A5,Th23;
      end;
      case A20:p<>0.REAL 2 &
        (p`2/|.p.|<sn & p`1<=0);
        then A21:
         sn-FanMorphW.p= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
          |.p.|* ((p`2/|.p.|-sn)/(1+sn))]| by A1,Th25;
         set p4= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
          |.p.|* ((p`2/|.p.|-sn)/(1+sn))]|;
        A22: p4`1= |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)) &
          p4`2= |.p.|* ((p`2/|.p.|-sn)/(1+sn)) by EUCLID:56;
     A23: |.p.|>0 by A20,Lm1;
     then A24: (|.p.|)^2>0 by SQUARE_1:74;
     A25: 1+sn>0 by A1,XREAL_1:150;
        A26: (p`2/|.p.|-sn)<=0 by A20,REAL_2:106;
        then A27: -(p`2/|.p.|-sn)>= -0 by XREAL_1:26;
            --(p`2/|.p.|-sn)/(1+sn)<=0 by A25,A26,REAL_2:126;
        then A28: -((p`2/|.p.|-sn)/(1+sn))>=0 by XREAL_1:60;
        A29: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
            0<=(p`1)^2 by XREAL_1:65;
        then 0+(p`2)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
        then (p`2)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by A24,A29,REAL_1:73;
        then (p`2)^2/(|.p.|)^2 <= 1 by A24,XCMPLX_1:60;
        then ((p`2)/|.p.|)^2 <= 1 by XCMPLX_1:77;
        then A30: (-((p`2)/|.p.|))^2 <= 1;
            -(1+sn)<= -0 by A25,XREAL_1:26;
        then (-(1+sn))/(1+sn)<=(-( p`2/|.p.|-sn))/(1+sn)
                        by A25,A27,REAL_1:73;
        then A31: -1<=(-( p`2/|.p.|-sn))/(1+sn) by A25,XCMPLX_1:198;
           1>= -p`2/|.p.| by A30,Lm2;
       then (1+sn)>= -p`2/|.p.|+sn by XREAL_1:9;
       then (-(p`2/|.p.|-sn))/(1+sn)<=1 by A25,REAL_2:117;
       then ((-(p`2/|.p.|-sn))/(1+sn))^2<=1^2 by A31,SQUARE_1:119;
       then A32: 1-((-(p`2/|.p.|-sn))/(1+sn))^2>=0 by XREAL_1:50;
       then 1-(-((p`2/|.p.|-sn))/(1+sn))^2>=0 by XCMPLX_1:188;
       then A33: 1-((p`2/|.p.|-sn)/(1+sn))^2>=0;
           sqrt(1-((-(p`2/|.p.|-sn))/(1+sn))^2)>=0 by A32,SQUARE_1:def 4;
       then sqrt(1-(-(p`2/|.p.|-sn))^2/(1+sn)^2)>=0 by XCMPLX_1:77;
       then sqrt(1-((p`2/|.p.|-sn))^2/(1+sn)^2)>=0;
       then sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)>=0 by XCMPLX_1:77;
       then -sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)<= -0 by XREAL_1:26;
        then q`1=0 by A2,A4,A5,A21,A22,XREAL_1:133;
        then (-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2))=0 by A2,A5,A21,A22,A23,
XCMPLX_1:6;
        then sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)=0;
        then 1-((p`2/|.p.|-sn)/(1+sn))^2=0 by A33,SQUARE_1:92;
        then 1=0+((p`2/|.p.|-sn)/(1+sn))^2;
        then 1=sqrt((-((p`2/|.p.|-sn)/(1+sn)))^2) by SQUARE_1:83;
        then 1= -((p`2/|.p.|-sn)/(1+sn)) by A28,SQUARE_1:89;
        then 1= ((-(p`2/|.p.|-sn))/(1+sn)) by XCMPLX_1:188;
        then 1 *(1+sn)=-(p`2/|.p.|-sn) by A25,XCMPLX_1:88;
        then (1+sn)=-p`2/|.p.|+sn;
        then 1+sn-sn=-p`2/|.p.|;
        then 1=-p`2/|.p.|;
        then 1=(-p`2)/|.p.| by XCMPLX_1:188;
        then 1 *|.p.|=-p`2 by A23,XCMPLX_1:88;
        then (-p`2)^2-(p`2)^2 =(p`1)^2 by A29,XCMPLX_1:26;
        then (p`2)^2-(p`2)^2 =(p`1)^2;
        then 0= (p`1)^2;
        then p`1=0 by XCMPLX_1:6;
       hence x1=x2 by A2,A5,Th23;
      end;
      end;
     hence x1=x2;
    end;
    case A34: q`2/|.q.|>=sn & q`1<=0 & q<>0.REAL 2;
    then A35: sn-FanMorphW.q= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by A1,Th25;
         set q4= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1-sn))]|;
        A36: q4`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)) &
          q4`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by EUCLID:56;
      |.q.|>0 by A34,Lm1;
     then A37: (|.q.|)^2>0 by SQUARE_1:74;
          now per cases by JGRAPH_2:11;
      case A38: p`1>=0;
        then A39: (sn-FanMorphW).p=p by Th23;
        A40: |.q.|>0 by A34,Lm1;
        then A41: (|.q.|)^2>0 by SQUARE_1:74;
        A42: 1-sn>0 by A1,XREAL_1:151;
        A43: (q`2/|.q.|-sn)>=0 by A34,XREAL_1:50;
        A44: (q`2/|.q.|-sn)>= 0 by A34,XREAL_1:50;
        A45: (q`2/|.q.|-sn)/(1-sn)>=0 by A42,A43,REAL_2:125;
        A46: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        0<=(q`1)^2 by XREAL_1:65;
        then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A41,A46,REAL_1:73;
        then (q`2)^2/(|.q.|)^2 <= 1 by A41,XCMPLX_1:60;
        then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then 1>=q`2/|.q.| by Lm2;
        then A47: 1-sn>=q`2/|.q.|-sn by XREAL_1:11;
        A48: -(1-sn)<= -0 by A42,XREAL_1:26;
             -(1-sn)<= -( q`2/|.q.|-sn) by A47,XREAL_1:26;
         then (-(1-sn))/(1-sn)<=(-( q`2/|.q.|-sn))/(1-sn)
                        by A42,REAL_1:73;
        then A49: -1<=(-( q`2/|.q.|-sn))/(1-sn)
                        by A42,XCMPLX_1:198;
           --(1-sn)>= -(q`2/|.q.|-sn) by A44,A48,XREAL_1:26;
       then (-(q`2/|.q.|-sn))/(1-sn)<=1 by A42,REAL_2:117;
       then ((-(q`2/|.q.|-sn))/(1-sn))^2<=1^2 by A49,SQUARE_1:119;
       then A50: 1-((-(q`2/|.q.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
       then 1-(-((q`2/|.q.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
       then A51: 1-((q`2/|.q.|-sn)/(1-sn))^2>=0;
           sqrt(1-((-(q`2/|.q.|-sn))/(1-sn))^2)>=0 by A50,SQUARE_1:def 4;
       then sqrt(1-(-(q`2/|.q.|-sn))^2/(1-sn)^2)>=0 by XCMPLX_1:77;
       then sqrt(1-(q`2/|.q.|-sn)^2/(1-sn)^2)>=0;
       then sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)>=0 by XCMPLX_1:77;
       then -sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)<= -0 by XREAL_1:26;
        then p`1=0 by A2,A35,A36,A38,A39,XREAL_1:133;
        then (-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))=0 by A2,A35,A36,A39,A40,
XCMPLX_1:6;
        then sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)=0;
        then 1-((q`2/|.q.|-sn)/(1-sn))^2=0 by A51,SQUARE_1:92;
        then 1=0+((q`2/|.q.|-sn)/(1-sn))^2;
        then 1= (q`2/|.q.|-sn)/(1-sn) by A45,SQUARE_1:83,89;
        then 1 *(1-sn)=(q`2/|.q.|-sn) by A42,XCMPLX_1:88;
        then 1-sn+sn=q`2/|.q.|;
        then 1=q`2/|.q.|;
        then 1 *|.q.|=q`2 by A40,XCMPLX_1:88;
        then (q`2)^2-(q`2)^2 =(q`1)^2 by A46;
        then 0= (q`1)^2;
        then q`1=0 by XCMPLX_1:6;
       hence x1=x2 by A2,A39,Th23;
      end;
      case A52:p<>0.REAL 2 & (p`2/|.p.|>=sn & p`1<=0);then
A53:    sn-FanMorphW.p= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
          |.p.|* ((p`2/|.p.|-sn)/(1-sn))]| by A1,Th25;
        set p4 = |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
          |.p.|* ((p`2/|.p.|-sn)/(1-sn))]|;
        A54: p4`1= |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)) &
          p4`2= |.p.|* ((p`2/|.p.|-sn)/(1-sn)) by EUCLID:56;
        A55: q4`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))&
        q4`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by EUCLID:56;
        A56: (q`2/|.q.|-sn)>= 0 by A34,XREAL_1:50;
        A57: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        0<=(q`1)^2 by XREAL_1:65;
        then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A37,A57,REAL_1:73;
        then (q`2)^2/(|.q.|)^2 <= 1 by A37,XCMPLX_1:60;
        then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then 1>=q`2/|.q.| by Lm2;
        then A58: 1-sn>=q`2/|.q.|-sn by XREAL_1:11;
        A59: -(1-sn)<= -0 by A3,XREAL_1:26;
        -(1-sn)<= -( q`2/|.q.|-sn) by A58,XREAL_1:26;
        then (-(1-sn))/(1-sn)<=(-( q`2/|.q.|-sn))/(1-sn) by A3,REAL_1:73;
        then A60: -1<=(-( q`2/|.q.|-sn))/(1-sn) by A3,XCMPLX_1:198;
        --(1-sn)>= -(q`2/|.q.|-sn) by A56,A59,XREAL_1:26;
       then (-(q`2/|.q.|-sn))/(1-sn)<=1 by A3,REAL_2:117;
       then ((-(q`2/|.q.|-sn))/(1-sn))^2<=1^2 by A60,SQUARE_1:119;
       then 1-((-(q`2/|.q.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
       then 1-(-((q`2/|.q.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
       then A61: 1-((q`2/|.q.|-sn)/(1-sn))^2>=0;
        A62: (q4`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))^2 by A55
         .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1-sn))^2) by A61,SQUARE_1:def 4;
        A63: (q4`2)^2= (|.q.|)^2*((q`2/|.q.|-sn)/(1-sn))^2
                         by A55;
        (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
        .=(|.q.|)^2 by A62,A63;
        then sqrt((|.q4.|)^2)=|.q.| by SQUARE_1:89;
        then A64: |.q4.|=|.q.| by SQUARE_1:89;
        A65: |.p.|>0 by A52,Lm1;
        then A66: (|.p.|)^2>0 by SQUARE_1:74;
        A67: (p`2/|.p.|-sn)>= 0 by A52,XREAL_1:50;
        A68: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
        0<=(p`1)^2 by XREAL_1:65;
        then 0+(p`2)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
        then (p`2)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by A66,A68,REAL_1:73;
        then (p`2)^2/(|.p.|)^2 <= 1 by A66,XCMPLX_1:60;
        then ((p`2)/|.p.|)^2 <= 1 by XCMPLX_1:77;
        then 1>=p`2/|.p.| by Lm2;
        then A69: 1-sn>=p`2/|.p.|-sn by XREAL_1:11;
        A70: -(1-sn)<= -0 by A3,XREAL_1:26;
         -(1-sn)<= -( p`2/|.p.|-sn) by A69,XREAL_1:26;
         then (-(1-sn))/(1-sn)<=(-( p`2/|.p.|-sn))/(1-sn) by A3,REAL_1:73;
        then A71: -1<=(-( p`2/|.p.|-sn))/(1-sn) by A3,XCMPLX_1:198;
        --(1-sn)>= -(p`2/|.p.|-sn) by A67,A70,XREAL_1:26;
       then (-(p`2/|.p.|-sn))/(1-sn)<=1 by A3,REAL_2:117;
       then ((-(p`2/|.p.|-sn))/(1-sn))^2<=1^2 by A71,SQUARE_1:119;
       then 1-((-(p`2/|.p.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
       then 1-(-((p`2/|.p.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
       then A72: 1-((p`2/|.p.|-sn)/(1-sn))^2>=0;
        A73: (p4`1)^2= (|.p.|)^2*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2))^2 by A54
         .= (|.p.|)^2*(1-((p`2/|.p.|-sn)/(1-sn))^2) by A72,SQUARE_1:def 4;
        A74: (p4`2)^2= (|.p.|)^2*((p`2/|.p.|-sn)/(1-sn))^2
                         by A54;
            (|.p4.|)^2=(p4`1)^2+(p4`2)^2 by JGRAPH_3:10
        .=(|.p.|)^2 by A73,A74;
        then sqrt((|.p4.|)^2)=|.p.| by SQUARE_1:89;
        then A75: |.p4.|=|.p.| by SQUARE_1:89;
          ((p`2/|.p.|-sn)/(1-sn))
        =|.q.|* ((q`2/|.q.|-sn)/(1-sn))/|.p.|
                         by A2,A35,A36,A53,A54,A65,XCMPLX_1:90;
        then (p`2/|.p.|-sn)/(1-sn)=(q`2/|.q.|-sn)/(1-sn)
                              by A2,A35,A53,A64,A65,A75,XCMPLX_1:90;
        then (p`2/|.p.|-sn)/(1-sn)*(1-sn)=q`2/|.q.|-sn
                            by A3,XCMPLX_1:88;
        then p`2/|.p.|-sn=q`2/|.q.|-sn by A3,XCMPLX_1:88;
        then p`2/|.p.|-sn+sn=q`2/|.q.|;
        then p`2/|.p.|=q`2/|.q.|;
        then p`2/|.p.|*|.p.|=q`2 by A2,A35,A53,A64,A65,A75,XCMPLX_1:88;
        then A76: p`2=q`2 by A65,XCMPLX_1:88;
        A77: |.p.|^2=(p`1)^2+(p`2)^2 by JGRAPH_3:10;
            |.q.|^2=(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        then (p`1)^2+(p`2)^2-(p`2)^2=(q`1)^2 by A2,A35,A53,A64,A75,A76,A77;
        then (p`1)^2=(q`1)^2;
        then (-p`1)^2=(q`1)^2;
        then A78: sqrt((-p`1)^2)=sqrt((-q`1)^2);
        --p`1<=0 by A52;
        then -p`1>=0 by XREAL_1:60;
        then A79: -p`1=sqrt((-q`1)^2) by A78,SQUARE_1:89;
        --q`1<=0 by A34;
        then -q`1>=0 by XREAL_1:60;
        then A80: --p`1=--q`1 by A79,SQUARE_1:89;
        p=|[p`1,p`2]| by EUCLID:57;
       hence x1=x2 by A76,A80,EUCLID:57;
      end;
      case A81: p<>0.REAL 2 & (p`2/|.p.|<sn & p`1<=0);then
      A82: sn-FanMorphW.p= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
          |.p.|* ((p`2/|.p.|-sn)/(1+sn))]| by A1,Th25;
         set p4= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
          |.p.|* ((p`2/|.p.|-sn)/(1+sn))]|;
        A83: p4`1= |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)) &
          p4`2= |.p.|* ((p`2/|.p.|-sn)/(1+sn)) by EUCLID:56;
         A84: p`2/|.p.|-sn<0 by A81,REAL_2:105;
             1+sn>0 by A1,XREAL_1:150;
         then A85: ((p`2/|.p.|-sn)/(1+sn))<0 by A84,REAL_2:128;
             |.p.|>0 by A81,Lm1;
         then A86: |.p.|* ((p`2/|.p.|-sn)/(1+sn))<0 by A85,XREAL_1:134;
         A87: q`2/|.q.|-sn>=0 by A34,XREAL_1:50;
             1-sn>0 by A1,XREAL_1:151;
         then ((q`2/|.q.|-sn)/(1-sn))>=0 by A87,REAL_2:125;
       hence x1=x2 by A2,A35,A36,A82,A83,A86,REAL_2:121;
      end;
      end;
     hence x1=x2;
    end;
    case A88: q`2/|.q.|<sn & q`1<=0 & q<>0.REAL 2;then
    A89: sn-FanMorphW.q= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1+sn))]| by A1,Th25;
         set q4= |[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1+sn))]|;
        A90: q4`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)) &
          q4`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by EUCLID:56;
     A91: |.q.|>0 by A88,Lm1;
     then A92: (|.q.|)^2>0 by SQUARE_1:74;
     per cases by JGRAPH_2:11;
      suppose A93: p`1>=0;
        then A94:(sn-FanMorphW).p=p by Th23;
        A95: 1+sn>0 by A1,XREAL_1:150;
        A96: (q`2/|.q.|-sn)<=0 by A88,REAL_2:106;
        then A97: -(q`2/|.q.|-sn)>= -0 by XREAL_1:26;
        --(q`2/|.q.|-sn)/(1+sn)<=0 by A95,A96,REAL_2:126;
        then A98: -((q`2/|.q.|-sn)/(1+sn))>=0 by XREAL_1:60;
        A99: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        0<=(q`1)^2 by XREAL_1:65;
        then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A92,A99,REAL_1:73;
        then (q`2)^2/(|.q.|)^2 <= 1 by A92,XCMPLX_1:60;
        then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then A100: (-((q`2)/|.q.|))^2 <= 1;
        -(1+sn)<= -0 by A95,XREAL_1:26;
        then (-(1+sn))/(1+sn)<=(-( q`2/|.q.|-sn))/(1+sn)
                        by A95,A97,REAL_1:73;
        then A101: -1<=(-( q`2/|.q.|-sn))/(1+sn) by A95,XCMPLX_1:198;
       1>= -q`2/|.q.| by A100,Lm2;
       then (1+sn)>= -q`2/|.q.|+sn by XREAL_1:9;
       then (-(q`2/|.q.|-sn))/(1+sn)<=1 by A95,REAL_2:117;
       then ((-(q`2/|.q.|-sn))/(1+sn))^2<=1^2 by A101,SQUARE_1:119;
       then A102: 1-((-(q`2/|.q.|-sn))/(1+sn))^2>=0 by XREAL_1:50;
       then 1-(-((q`2/|.q.|-sn))/(1+sn))^2>=0 by XCMPLX_1:188;
       then A103: 1-((q`2/|.q.|-sn)/(1+sn))^2>=0;
       sqrt(1-((-(q`2/|.q.|-sn))/(1+sn))^2)>=0 by A102,SQUARE_1:def 4;
       then sqrt(1-(-(q`2/|.q.|-sn))^2/(1+sn)^2)>=0 by XCMPLX_1:77;
       then sqrt(1-((q`2/|.q.|-sn))^2/(1+sn)^2)>=0;
       then sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)>=0 by XCMPLX_1:77;
       then -sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)<= -0 by XREAL_1:26;
        then p`1=0 by A2,A89,A90,A93,A94,XREAL_1:133;
        then (-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))=0 by A2,A89,A90,A91,A94,
XCMPLX_1:6;
        then sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)=0;
        then 1-((q`2/|.q.|-sn)/(1+sn))^2=0 by A103,SQUARE_1:92;
        then 1=0+((q`2/|.q.|-sn)/(1+sn))^2;
        then 1=sqrt((-((q`2/|.q.|-sn)/(1+sn)))^2) by SQUARE_1:83;
        then 1= -((q`2/|.q.|-sn)/(1+sn)) by A98,SQUARE_1:89;
        then 1= ((-(q`2/|.q.|-sn))/(1+sn)) by XCMPLX_1:188;
        then 1 *(1+sn)=-(q`2/|.q.|-sn) by A95,XCMPLX_1:88;
        then (1+sn)=-q`2/|.q.|+sn;
        then 1+sn-sn=-q`2/|.q.|;
        then 1=-q`2/|.q.|;
        then 1=(-q`2)/|.q.| by XCMPLX_1:188;
        then 1 *|.q.|=-q`2 by A91,XCMPLX_1:88;
        then (-q`2)^2-(q`2)^2 =(q`1)^2 by A99,XCMPLX_1:26;
        then (q`2)^2-(q`2)^2 =(q`1)^2;
        then 0= (q`1)^2;
        then q`1=0 by XCMPLX_1:6;
       hence x1=x2 by A2,A94,Th23;
      end;
      suppose A104:p<>0.REAL 2 & (p`2/|.p.|>=sn & p`1<=0); then
A105:  sn-FanMorphW.p= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
          |.p.|* ((p`2/|.p.|-sn)/(1-sn))]| by A1,Th25;
         set p4= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
          |.p.|* ((p`2/|.p.|-sn)/(1-sn))]|;
        A106: p4`1= |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)) &
          p4`2= |.p.|* ((p`2/|.p.|-sn)/(1-sn)) by EUCLID:56;
         A107: q`2/|.q.|-sn<0 by A88,REAL_2:105;
         1+sn>0 by A1,XREAL_1:150;
         then A108: ((q`2/|.q.|-sn)/(1+sn))<0 by A107,REAL_2:128;
         |.q.|>0 by A88,Lm1;
         then A109: |.q.|* ((q`2/|.q.|-sn)/(1+sn))<0 by A108,XREAL_1:134;
         A110: p`2/|.p.|-sn>=0 by A104,XREAL_1:50;
         1-sn>0 by A1,XREAL_1:151;
         then A111: ((p`2/|.p.|-sn)/(1-sn))>=0 by A110,REAL_2:125;
       thus x1=x2 by A2,A89,A90,A105,A106,A109,A111,REAL_2:121;
      end;
      suppose A112:p<>0.REAL 2 & (p`2/|.p.|<sn & p`1<=0);then
A113:   sn-FanMorphW.p= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
          |.p.|* ((p`2/|.p.|-sn)/(1+sn))]| by A1,Th25;
         set p4= |[ |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
          |.p.|* ((p`2/|.p.|-sn)/(1+sn))]|;
        A114: p4`1= |.p.|*(-sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)) &
          p4`2= |.p.|* ((p`2/|.p.|-sn)/(1+sn)) by EUCLID:56;
        A115: q4`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))&
        q4`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by EUCLID:56;
        (q`2/|.q.|-sn)<=0 by A88,REAL_2:106;
        then A116: -(q`2/|.q.|-sn)>= -0 by XREAL_1:26;
        A117: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        0<=(q`1)^2 by XREAL_1:65;
        then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A92,A117,REAL_1:73;
        then (q`2)^2/(|.q.|)^2 <= 1 by A92,XCMPLX_1:60;
        then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then -1<=q`2/|.q.| by Lm2;
        then A118: -1-sn<=q`2/|.q.|-sn by XREAL_1:11;
        A119: 1+sn>0 by A1,XREAL_1:150;
        then -(1+sn)<= -0 by XREAL_1:26;
        then (-(1+sn))/(1+sn)<=(-( q`2/|.q.|-sn))/(1+sn) by A116,A119,REAL_1:73
;
        then A120: -1<=(-( q`2/|.q.|-sn))/(1+sn) by A119,XCMPLX_1:198;
         -(-1-sn)>= -(q`2/|.q.|-sn) by A118,XREAL_1:26; then
         --(1+sn)>= -(q`2/|.q.|-sn);
       then (-(q`2/|.q.|-sn))/(1+sn)<=1 by A119,REAL_2:117;
       then ((-(q`2/|.q.|-sn))/(1+sn))^2<=1^2 by A120,SQUARE_1:119;
       then 1-((-(q`2/|.q.|-sn))/(1+sn))^2>=0 by XREAL_1:50;
       then 1-(-((q`2/|.q.|-sn))/(1+sn))^2>=0 by XCMPLX_1:188;
       then A121: 1-((q`2/|.q.|-sn)/(1+sn))^2>=0;
        A122: (q4`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))^2 by A115
         .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1+sn))^2) by A121,SQUARE_1:def 4;
        A123: (q4`2)^2= (|.q.|)^2*((q`2/|.q.|-sn)/(1+sn))^2
                         by A115;
        (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
        .=(|.q.|)^2 by A122,A123;
        then sqrt((|.q4.|)^2)=|.q.| by SQUARE_1:89;
        then A124: |.q4.|=|.q.| by SQUARE_1:89;
        A125: |.p.|>0 by A112,Lm1;
        then A126: (|.p.|)^2>0 by SQUARE_1:74;
        (p`2/|.p.|-sn)<=0 by A112,REAL_2:106;
        then A127: -(p`2/|.p.|-sn)>= -0 by XREAL_1:26;
        A128: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
        0<=(p`1)^2 by XREAL_1:65;
        then 0+(p`2)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
        then (p`2)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by A126,A128,REAL_1:73;
        then (p`2)^2/(|.p.|)^2 <= 1 by A126,XCMPLX_1:60;
        then ((p`2)/|.p.|)^2 <= 1 by XCMPLX_1:77;
        then -1<=p`2/|.p.| by Lm2;
        then A129: -1-sn<=p`2/|.p.|-sn by XREAL_1:11;
        -(1+sn)<= -0 by A119,XREAL_1:26;
        then (-(1+sn))/(1+sn)<=(-( p`2/|.p.|-sn))/(1+sn)
                        by A119,A127,REAL_1:73;
        then A130: -1<=(-( p`2/|.p.|-sn))/(1+sn) by A119,XCMPLX_1:198;
         -(-1-sn)>= -(p`2/|.p.|-sn) by A129,XREAL_1:26; then
         --(1+sn)>= -(p`2/|.p.|-sn);
       then (-(p`2/|.p.|-sn))/(1+sn)<=1 by A119,REAL_2:117;
       then ((-(p`2/|.p.|-sn))/(1+sn))^2<=1^2 by A130,SQUARE_1:119;
       then 1-((-(p`2/|.p.|-sn))/(1+sn))^2>=0 by XREAL_1:50;
       then 1-(-((p`2/|.p.|-sn))/(1+sn))^2>=0 by XCMPLX_1:188;
       then A131: 1-((p`2/|.p.|-sn)/(1+sn))^2>=0;
        A132: (p4`1)^2= (|.p.|)^2*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2))^2 by A114
         .= (|.p.|)^2*(1-((p`2/|.p.|-sn)/(1+sn))^2)
                      by A131,SQUARE_1:def 4;
        A133: (p4`2)^2= (|.p.|)^2*((p`2/|.p.|-sn)/(1+sn))^2
                         by A114;
            (|.p4.|)^2=(p4`1)^2+(p4`2)^2 by JGRAPH_3:10
        .=(|.p.|)^2 by A132,A133;
        then sqrt((|.p4.|)^2)=|.p.| by SQUARE_1:89;
        then A134: |.p4.|=|.p.| by SQUARE_1:89;
          ((p`2/|.p.|-sn)/(1+sn))
        =|.q.|* ((q`2/|.q.|-sn)/(1+sn))/|.p.|
                         by A2,A89,A90,A113,A114,A125,XCMPLX_1:90;
        then (p`2/|.p.|-sn)/(1+sn)=(q`2/|.q.|-sn)/(1+sn)
                              by A2,A89,A113,A124,A125,A134,XCMPLX_1:90;
        then (p`2/|.p.|-sn)/(1+sn)*(1+sn)=q`2/|.q.|-sn
                            by A119,XCMPLX_1:88;
        then p`2/|.p.|-sn=q`2/|.q.|-sn by A119,XCMPLX_1:88;
        then p`2/|.p.|-sn+sn=q`2/|.q.|;
        then p`2/|.p.|=q`2/|.q.|;
        then p`2/|.p.|*|.p.|=q`2 by A2,A89,A113,A124,A125,A134,XCMPLX_1:88;
        then A135: p`2=q`2 by A125,XCMPLX_1:88;
        A136: |.p.|^2=(p`1)^2+(p`2)^2 by JGRAPH_3:10;
            |.q.|^2=(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        then (p`1)^2+(p`2)^2-(p`2)^2=(q`1)^2 by A2,A89,A113,A124,A134,A135,A136
;
        then (p`1)^2=(q`1)^2;
        then (-p`1)^2=(q`1)^2;
        then A137: sqrt((-p`1)^2)=sqrt((-q`1)^2);
        --p`1<=0 by A112;
        then -p`1>=0 by XREAL_1:60;
        then A138: -p`1=sqrt((-q`1)^2) by A137,SQUARE_1:89;
        --q`1<=0 by A88;
        then -q`1>=0 by XREAL_1:60;
        then A139: --p`1=--q`1 by A138,SQUARE_1:89;
        p=|[p`1,p`2]| by EUCLID:57;
       hence x1=x2 by A135,A139,EUCLID:57;
      end;
    end;
    end;
   hence x1=x2;
  end;
 hence thesis by FUNCT_1:def 8;
end;

theorem Th46:
  for sn being Real st -1<sn & sn<1 holds
    sn-FanMorphW is Function of TOP-REAL 2,TOP-REAL 2 &
    rng (sn-FanMorphW) = the carrier of TOP-REAL 2
proof let sn be Real;
  assume A1:  -1<sn & sn<1;
thus sn-FanMorphW is Function of TOP-REAL 2,TOP-REAL 2;
   for f being Function of TOP-REAL 2,TOP-REAL 2 st f=(sn-FanMorphW) holds
    rng (sn-FanMorphW)=the carrier of TOP-REAL 2
  proof let f be Function of TOP-REAL 2,TOP-REAL 2;
    assume A2:f=sn-FanMorphW;
    A3:dom f=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
    the carrier of TOP-REAL 2 c= rng f
    proof let y be set;assume y in the carrier of TOP-REAL 2;
     then reconsider p2=y as Point of TOP-REAL 2;
     set q=p2;
     now per cases by JGRAPH_2:11;
     case q`1>=0;
       then q in dom (sn-FanMorphW) & y=(sn-FanMorphW).q by A2,A3,Th23;
      hence ex x being set st x in dom (sn-FanMorphW) & y=(sn-FanMorphW).x;
     end;
     case A4: q`2/|.q.|>=0 & q`1<=0 & q<>0.REAL 2;
          set px=|[ -(|.q.|)*sqrt(1-(q`2/|.q.|*(1-sn)+sn)^2),
                   |.q.|*(q`2/|.q.|*(1-sn)+sn)]|;
        A5: px`1 = -(|.q.|)*sqrt(1-(q`2/|.q.|*(1-sn)+sn)^2) &
         px`2 = |.q.|*(q`2/|.q.|*(1-sn)+sn) by EUCLID:56;
        then A6: |.px.|^2=(-(|.q.|)*sqrt(1-(q`2/|.q.|*(1-sn)+sn)^2))^2
        +(|.q.|*(q`2/|.q.|*(1-sn)+sn))^2 by JGRAPH_3:10
        .=(|.q.|)^2*(sqrt(1-(q`2/|.q.|*(1-sn)+sn)^2))^2
        +(|.q.|)^2*((q`2/|.q.|*(1-sn)+sn))^2;
       A7: |.q.|<>0 by A4,TOPRNS_1:25;
           1-sn>=0 by A1,XREAL_1:151;
       then A8: q`2/|.q.|*(1-sn)>=0 by A4,REAL_2:121;
       then A9: (q`2/|.q.|*(1-sn)+sn)>=0+sn by XREAL_1:9;
       A10: |.q.|>0 by A4,Lm1;
       A11: |.q.|^2>0 by A7,SQUARE_1:74;
       --(1+sn)>0 by A1,XREAL_1:150;
       then -(1+sn)<= q`2/|.q.|*(1-sn) by A8,XREAL_1:60;
       then A12: -1-sn+sn<= q`2/|.q.|*(1-sn)+sn by XREAL_1:9;
       A13: 1-sn>0 by A1,XREAL_1:151;
       A14: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
       0<=(q`1)^2 by XREAL_1:65;
       then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
       then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A11,A14,REAL_1:73;
       then (q`2)^2/(|.q.|)^2 <= 1 by A11,XCMPLX_1:60;
       then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
       then q`2/|.q.|<=1 by Lm2;
       then q`2/|.q.|*(1-sn) <=1 *(1-sn) by A13,XREAL_1:66;
       then q`2/|.q.|*(1-sn)+sn-sn <=1-sn;
       then (q`2/|.q.|*(1-sn)+sn) <=1 by XREAL_1:11;
       then 1^2>=(q`2/|.q.|*(1-sn)+sn)^2 by A12,SQUARE_1:119;
       then A15: 1-(q`2/|.q.|*(1-sn)+sn)^2>=0 by XREAL_1:50;
       then A16: |.px.|^2=(|.q.|)^2*(1-(q`2/|.q.|*(1-sn)+sn)^2)
        +(|.q.|)^2*((q`2/|.q.|*(1-sn)+sn))^2 by A6,SQUARE_1:def 4
        .= (|.q.|)^2;
        A17: |.px.|=sqrt(|.q.|^2) by A16,SQUARE_1:89
        .=|.q.| by SQUARE_1:89;
        then A18: |.px.|<>0 by A4,TOPRNS_1:25;
           sqrt(1-(q`2/|.q.|*(1-sn)+sn)^2)>=0 by A15,SQUARE_1:def 4;
       then |.q.|*sqrt(1-(q`2/|.q.|*(1-sn)+sn)^2)>=0 by REAL_2:121;
        then px`2/|.px.| >=sn & px`1<=0 & px<>0.REAL 2
                           by A5,A7,A9,A17,XREAL_1:60,TOPRNS_1:24,XCMPLX_1:90;
    then A19: (sn-FanMorphW).px
       =|[ |.px.|*(-sqrt(1-((px`2/|.px.|-sn)/(1-sn))^2)),
               |.px.|* ((px`2/|.px.|-sn)/(1-sn))]| by A1,Th25;
        A20: |.px.|* ((px`2/|.px.|-sn)/(1-sn))
        =|.q.|* (( ((q`2/|.q.|*(1-sn)+sn))-sn)/(1-sn))
                            by A5,A7,A17,XCMPLX_1:90
        .=|.q.|* ( q`2/|.q.|) by A13,XCMPLX_1:90
        .= q`2 by A7,XCMPLX_1:88;
        then A21: |.px.|*(-sqrt(1-((px`2/|.px.|-sn)/(1-sn))^2))
           = |.px.|*(-sqrt(1-(q`2/|.px.|)^2)) by A18,XCMPLX_1:90
           .= |.px.|*(-sqrt(1-(q`2)^2/(|.px.|)^2)) by XCMPLX_1:77
           .= |.px.|*(-sqrt( (|.px.|)^2/(|.px.|)^2-(q`2)^2/(|.px.|)^2))
                            by A11,A16,XCMPLX_1:60
           .= |.px.|*(-sqrt( ((|.px.|)^2-(q`2)^2)/(|.px.|)^2))
                            by XCMPLX_1:121
           .= |.px.|*(-sqrt( ((q`1)^2+(q`2)^2-(q`2)^2)/(|.px.|)^2))
                            by A16,JGRAPH_3:10
           .= |.px.|*(-sqrt((q`1/|.q.|)^2))
                            by A17,XCMPLX_1:77;
             q`1/|.q.|<=0 by A4,A10,REAL_2:126;
         then |.px.|*(-sqrt((q`1/|.q.|)^2))=|.px.|*(--(q`1/|.q.|))
                            by SQUARE_1:90
         .=q`1 by A10,A17,XCMPLX_1:88;
        then A22:q=(sn-FanMorphW).px by A19,A20,A21,EUCLID:57;
            dom (sn-FanMorphW)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
      hence ex x being set st x in dom (sn-FanMorphW) & y=(sn-FanMorphW).x
                               by A22;
     end;
     case A23: q`2/|.q.|<0 & q`1<=0 & q<>0.REAL 2;
          set px=|[ -(|.q.|)*sqrt(1-(q`2/|.q.|*(1+sn)+sn)^2),
                   |.q.|*(q`2/|.q.|*(1+sn)+sn)]|;
        A24: px`1 = -(|.q.|)*sqrt(1-(q`2/|.q.|*(1+sn)+sn)^2) &
         px`2 = |.q.|*(q`2/|.q.|*(1+sn)+sn) by EUCLID:56;
        then A25: |.px.|^2=(-(|.q.|)*sqrt(1-(q`2/|.q.|*(1+sn)+sn)^2))^2
        +(|.q.|*(q`2/|.q.|*(1+sn)+sn))^2 by JGRAPH_3:10
        .=(|.q.|)^2*(sqrt(1-(q`2/|.q.|*(1+sn)+sn)^2))^2
        +(|.q.|)^2*((q`2/|.q.|*(1+sn)+sn))^2;
       A26: |.q.|<>0 by A23,TOPRNS_1:25;
           1+sn>=0 by A1,XREAL_1:150;
       then A27: q`2/|.q.|*(1+sn)<=0 by A23,XREAL_1:133;
       then A28: (q`2/|.q.|*(1+sn)+sn)<=0+sn by XREAL_1:9;
       A29: |.q.|>0 by A23,Lm1;
       A30: |.q.|^2>0 by A26,SQUARE_1:74;
       1-sn>= q`2/|.q.|*(1+sn) by A27,A1,XREAL_1:151;
       then A31: 1-sn+sn>= q`2/|.q.|*(1+sn)+sn by XREAL_1:9;
       A32: 1+sn>0 by A1,XREAL_1:150;
       A33: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
           0<=(q`1)^2 by XREAL_1:65;
       then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
       then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A30,A33,REAL_1:73;
       then (q`2)^2/(|.q.|)^2 <= 1 by A30,XCMPLX_1:60;
       then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
       then q`2/|.q.|>=-1 by Lm2;
       then q`2/|.q.|*(1+sn) >=(-1)*(1+sn) by A32,XREAL_1:66;
       then q`2/|.q.|*(1+sn)+sn-sn >=-1-sn;
       then (q`2/|.q.|*(1+sn)+sn) >=-1 by XREAL_1:11;
       then 1^2>=(q`2/|.q.|*(1+sn)+sn)^2 by A31,SQUARE_1:119;
       then A34: 1-(q`2/|.q.|*(1+sn)+sn)^2>=0 by XREAL_1:50;
       then A35: |.px.|^2=(|.q.|)^2*(1-(q`2/|.q.|*(1+sn)+sn)^2)
        +(|.q.|)^2*((q`2/|.q.|*(1+sn)+sn))^2 by A25,SQUARE_1:def 4
        .= (|.q.|)^2;
        A36: |.px.|=sqrt(|.q.|^2) by A35,SQUARE_1:89
        .=|.q.| by SQUARE_1:89;
        then A37: |.px.|<>0 by A23,TOPRNS_1:25;
           sqrt(1-(q`2/|.q.|*(1+sn)+sn)^2)>=0 by A34,SQUARE_1:def 4;
       then |.q.|*sqrt(1-(q`2/|.q.|*(1+sn)+sn)^2)>=0 by REAL_2:121;
        then px`2/|.px.| <=sn & px`1<=0 & px<>0.REAL 2
               by A24,A26,A28,A36,XREAL_1:60,TOPRNS_1:24,XCMPLX_1:90;
    then A38: (sn-FanMorphW).px
       =|[ |.px.|*(-sqrt(1-((px`2/|.px.|-sn)/(1+sn))^2)),
               |.px.|* ((px`2/|.px.|-sn)/(1+sn))]|
                            by A1,Th25;
        A39: |.px.|* ((px`2/|.px.|-sn)/(1+sn))
        =|.q.|* (( ((q`2/|.q.|*(1+sn)+sn))-sn)/(1+sn)) by A24,A26,A36,
XCMPLX_1:90
        .=|.q.|* ( q`2/|.q.|) by A32,XCMPLX_1:90
        .= q`2 by A26,XCMPLX_1:88;
        then A40: |.px.|*(-sqrt(1-((px`2/|.px.|-sn)/(1+sn))^2))
           = |.px.|*(-sqrt(1-(q`2/|.px.|)^2)) by A37,XCMPLX_1:90
           .= |.px.|*(-sqrt(1-(q`2)^2/(|.px.|)^2)) by XCMPLX_1:77
           .= |.px.|*(-sqrt( (|.px.|)^2/(|.px.|)^2-(q`2)^2/(|.px.|)^2))
                            by A30,A35,XCMPLX_1:60
           .= |.px.|*(-sqrt( ((|.px.|)^2-(q`2)^2)/(|.px.|)^2))
                            by XCMPLX_1:121
           .= |.px.|*(-sqrt( ((q`1)^2+(q`2)^2-(q`2)^2)/(|.px.|)^2))
                            by A35,JGRAPH_3:10
           .= |.px.|*(-sqrt((q`1/|.q.|)^2)) by A36,XCMPLX_1:77;
             q`1/|.q.|<=0 by A23,A29,REAL_2:126;
         then |.px.|*(-sqrt((q`1/|.q.|)^2))=|.px.|*(--(q`1/|.q.|))
                            by SQUARE_1:90
         .=q`1 by A29,A36,XCMPLX_1:88;
        then A41:q=(sn-FanMorphW).px by A38,A39,A40,EUCLID:57;
            dom (sn-FanMorphW)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
      hence ex x being set st x in dom (sn-FanMorphW) & y=(sn-FanMorphW).x
                               by A41;
     end;
     end;
    hence y in rng f by A2,FUNCT_1:def 5;
   end;
   hence rng (sn-FanMorphW)=the carrier of TOP-REAL 2
                 by A2,XBOOLE_0:def 10;
  end;
 hence rng (sn-FanMorphW)=the carrier of TOP-REAL 2;
end;

Lm13:now let K0 be Subset of TOP-REAL 2, q4,q,p2 be Point of TOP-REAL 2,
        O,u,uq be Point of Euclid 2;
  assume A1: u in cl_Ball(O,|.p2.|+1);
  assume A2: q = uq & q4 = u & O=0.REAL 2;
  assume A3: |.q4.|=|.q.|;
  now assume not q in cl_Ball(O,|.p2.|+1);
    then not dist(O,uq)<=|.p2.|+1 by A2,METRIC_1:13;
    then |.0.REAL 2 - q.|> |.p2.|+1 by A2,JGRAPH_1:45;
    then |.0.REAL 2 +- q.|> |.p2.|+1 by EUCLID:45;
    then |. -q.|> |.p2.|+1 by EUCLID:31;
    then |.q.|> |.p2.|+1 by TOPRNS_1:27;
    then |. -q4.|> |.p2.|+1 by A3,TOPRNS_1:27;
    then |.0.REAL 2 +- q4.|> |.p2.|+1 by EUCLID:31;
    then |.0.REAL 2 - q4.|> |.p2.|+1 by EUCLID:45;
    then dist(O,u)> |.p2.|+1 by A2,JGRAPH_1:45;
   hence contradiction by A1,METRIC_1:13;
  end; hence q in cl_Ball(O,|.p2.|+1);
end;

theorem Th47: for sn being Real,p2 being Point of TOP-REAL 2
  st -1<sn & sn<1
  ex K being non empty compact Subset of TOP-REAL 2 st
  K = (sn-FanMorphW).:K &
 (ex V2 being Subset of TOP-REAL 2 st
  p2 in V2 & V2 is open & V2 c= K & (sn-FanMorphW).p2 in V2)
 proof let sn be Real,p2 be Point of TOP-REAL 2;
  assume A1: -1<sn & sn<1;
    reconsider O=0.REAL 2 as Point of Euclid 2;
    reconsider V0=Ball(O,|.p2.|+1) as Subset of TOP-REAL 2;
    A2: |. p2.|<|.p2.|+1 by XREAL_1:31;
    A3: O in V0 by GOBOARD6:4;
    A4: V0 c= cl_Ball(O,|.p2.|+1) by METRIC_1:15;
    reconsider K01=cl_Ball(O,|.p2.|+1) as Subset of TOP-REAL 2;
        K01 is compact by Th22;
    then reconsider K0=cl_Ball(O,|.p2.|+1)
          as non empty compact Subset of TOP-REAL 2 by A3,A4;
    reconsider u2=p2 as Point of Euclid 2;
    A5: (sn-FanMorphW).:K0 c= K0
     proof let y be set;assume y in (sn-FanMorphW).:K0;
       then consider x being set such that
       A6: x in dom (sn-FanMorphW) & x in K0 & y=(sn-FanMorphW).x
                     by FUNCT_1:def 12;
       reconsider q=x as Point of TOP-REAL 2 by A6;
       reconsider uq=q as Point of Euclid 2;
       A7: y in rng (sn-FanMorphW) by A6,FUNCT_1:def 5;
       then reconsider u=y as Point of Euclid 2;
       reconsider q4=y as Point of TOP-REAL 2 by A7;
       A8: |.q4.|=|.q.| by A6,Th40;
           dist(O,uq)<= |.p2.|+1 by A6,METRIC_1:13;
       then |.0.REAL 2 - q.|<= |.p2.|+1 by JGRAPH_1:45;
       then |.0.REAL 2 +- q.|<= |.p2.|+1 by EUCLID:45;
       then |. -q.|<= |.p2.|+1 by EUCLID:31;
       then |.q.|<= |.p2.|+1 by TOPRNS_1:27;
       then |. -q4.|<= |.p2.|+1 by A8,TOPRNS_1:27;
       then |.0.REAL 2 +- q4.|<= |.p2.|+1 by EUCLID:31;
       then |.0.REAL 2 - q4.|<= |.p2.|+1 by EUCLID:45;
       then dist(O,u)<= |.p2.|+1 by JGRAPH_1:45;
      hence y in K0 by METRIC_1:13;
     end;
     K0 c= (sn-FanMorphW).:K0
     proof let y be set;assume A9: y in K0;
       then reconsider u=y as Point of Euclid 2;
       reconsider q4=y as Point of TOP-REAL 2 by A9;
       the carrier of TOP-REAL 2 c= rng (sn-FanMorphW) by A1,Th46;
       then q4 in rng (sn-FanMorphW) by TARSKI:def 3;
       then consider x being set such that
       A10: x in dom (sn-FanMorphW) & y=(sn-FanMorphW).x by FUNCT_1:def 5;
       reconsider q=x as Point of TOP-REAL 2 by A10;
       reconsider uq=q as Point of Euclid 2;
       A11: |.q4.|=|.q.| by A10,Th40;
       q in K0 by A9,A11,Lm13;
      hence y in (sn-FanMorphW).:K0 by A10,FUNCT_1:def 12;
     end;
    then A12: K0= (sn-FanMorphW).:K0 by A5,XBOOLE_0:def 10;
    |. -p2.|<|.p2.|+1 by A2,TOPRNS_1:27;
    then |.0.REAL 2 +- p2.|<|.p2.|+1 by EUCLID:31;
    then |.0.REAL 2 - p2.|<|.p2.|+1 by EUCLID:45;
    then dist(O,u2)<|.p2.|+1 by JGRAPH_1:45;
    then A13: p2 in V0 by METRIC_1:12;
    A14: V0 is open by TOPMETR:21;
    set q3= (sn-FanMorphW).p2;
    reconsider u3=q3 as Point of Euclid 2;
    |.q3.|=|.p2.| by Th40;
    then |. -q3.|<|.p2.|+1 by A2,TOPRNS_1:27;
    then |.0.REAL 2 +- q3.|<|.p2.|+1 by EUCLID:31;
    then |.0.REAL 2 - q3.|<|.p2.|+1 by EUCLID:45;
    then dist(O,u3)< |.p2.|+1 by JGRAPH_1:45;
    then (sn-FanMorphW).p2 in V0 by METRIC_1:12;
   hence thesis by A4,A12,A13,A14;
 end;

theorem   for sn being Real st -1<sn & sn<1
 ex f being Function of TOP-REAL 2,TOP-REAL 2 st f=(sn-FanMorphW)
   & f is_homeomorphism
proof let sn be Real;assume A1:  -1<sn & sn<1;
  then A2: (sn-FanMorphW) is Function of TOP-REAL 2,TOP-REAL 2 &
  rng (sn-FanMorphW) = the carrier of TOP-REAL 2 by Th46;
  reconsider f=(sn-FanMorphW) as Function of TOP-REAL 2,TOP-REAL 2;
  consider h being Function of (TOP-REAL 2),(TOP-REAL 2)
  such that A3: h=(sn-FanMorphW) & h is continuous by A1,Th44;
  A4: f is one-to-one by A1,Th45;
  A5: rng f=[#](TOP-REAL 2) by A2;
  for p2 being Point of TOP-REAL 2
  ex K being non empty compact Subset of TOP-REAL 2 st K = f.:K &
 (ex V2 being Subset of TOP-REAL 2 st
  p2 in V2 & V2 is open & V2 c= K & f.p2 in V2) by A1,Th47;
  then f is_homeomorphism by A3,A4,A5,Th8;
 hence thesis;
end;

Lm14:now let q be Point of TOP-REAL 2, sn,t be Real;
  assume ((-(t/|.q.|-sn))/(1-sn))^2<1^2;
  then 1-((-(t/|.q.|-sn))/(1-sn))^2>0 by XREAL_1:52;
  then sqrt(1-((-(t/|.q.|-sn))/(1-sn))^2)>0 by SQUARE_1:93;
  then sqrt(1-(-(t/|.q.|-sn))^2/(1-sn)^2)> 0 by XCMPLX_1:77;
  then sqrt(1-(t/|.q.|-sn)^2/(1-sn)^2)> 0;
  then sqrt(1-((t/|.q.|-sn)/(1-sn))^2)> 0 by XCMPLX_1:77;
  hence -sqrt(1-((t/|.q.|-sn)/(1-sn))^2)< -0 by XREAL_1:26;
end;

theorem Th49:
 for sn being Real,q being Point of TOP-REAL 2 st -1<sn & sn<1 & q`1<0
 & q`2/|.q.|>=sn holds (for p being Point of TOP-REAL 2 st
 p=(sn-FanMorphW).q holds p`1<0 & p`2>=0)
 proof let sn be Real,q be Point of TOP-REAL 2;
  assume A1: -1<sn & sn<1 &
  q`1<0 & q`2/|.q.|>=sn;
  let p be Point of TOP-REAL 2;
    assume p=(sn-FanMorphW).q;
    then A2: p=|[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by A1,Th23;
      set qz=p;
      A3: |.q.|>0 by A1,Lm1,JGRAPH_2:11;
      then A4: (|.q.|)^2>0 by SQUARE_1:74;
     A5: 1-sn>0 by A1,XREAL_1:151;
        A6: qz`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))&
        qz`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by A2,EUCLID:56;
        A7: (q`2/|.q.|-sn)>= 0 by A1,XREAL_1:50;
        A8: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
            0<(q`1)^2 by A1,SQUARE_1:74;
        then 0+(q`2)^2<(q`1)^2+(q`2)^2 by XREAL_1:10;
        then (q`2)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A4,A8,REAL_1:73;
        then (q`2)^2/(|.q.|)^2 < 1 by A4,XCMPLX_1:60;
        then ((q`2)/|.q.|)^2 < 1 by XCMPLX_1:77;
        then 1>q`2/|.q.| by Lm3;
        then A9: 1-sn>q`2/|.q.|-sn by XREAL_1:11;
        A10: -(1-sn)< -0 by A5,XREAL_1:26;
             -(1-sn)< -( q`2/|.q.|-sn) by A9,XREAL_1:26;
         then (-(1-sn))/(1-sn)<(-( q`2/|.q.|-sn))/(1-sn)
                        by A5,REAL_1:73;
        then A11: -1<(-( q`2/|.q.|-sn))/(1-sn) by A5,XCMPLX_1:198;
           --(1-sn)> -(q`2/|.q.|-sn) by A7,A10,XREAL_1:26;
       then (-(q`2/|.q.|-sn))/(1-sn)<1 by A5,REAL_2:118;
       then ((-(q`2/|.q.|-sn))/(1-sn))^2<1^2 by A11,SQUARE_1:120;
       then A12: -sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)< -0 by Lm14;
           ((q`2/|.q.|-sn)/(1-sn))>=0 by A5,A7,XREAL_1:138;
   hence p`1<0 & p`2>=0 by A3,A6,A12,XREAL_1:129,134;
 end;

theorem Th50:
 for sn being Real,q being Point of TOP-REAL 2 st -1<sn & sn<1 & q`1<0
 & q`2/|.q.|<sn holds (for p being Point of TOP-REAL 2 st
 p=(sn-FanMorphW).q holds p`1<0 & p`2<0)
 proof let sn be Real,q be Point of TOP-REAL 2;
  assume A1: -1<sn & sn<1 & q`1<0 & q`2/|.q.|<sn;
  let p be Point of TOP-REAL 2;
    assume p=(sn-FanMorphW).q;
    then A2: p=|[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1+sn))]| by A1,Th24;
      set qz=p;
      A3: |.q.|>0 by A1,Lm1,JGRAPH_2:11;
      then A4: (|.q.|)^2>0 by SQUARE_1:74;
      A5: (q`2/|.q.|-sn)< 0 by A1,REAL_2:105;
     A6: 1+sn>0 by A1,XREAL_1:150;
        A7: qz`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))&
        qz`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by A2,EUCLID:56;
        A8: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
            0<(q`1)^2 by A1,SQUARE_1:74;
        then 0+(q`2)^2<(q`1)^2+(q`2)^2 by XREAL_1:10;
        then (q`2)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A4,A8,REAL_1:73;
        then (q`2)^2/(|.q.|)^2 < 1 by A4,XCMPLX_1:60;
        then ((q`2)/|.q.|)^2 < 1 by XCMPLX_1:77;
        then -1<q`2/|.q.| by Lm3;
        then -1-sn<q`2/|.q.|-sn by XREAL_1:11;
        then -(1+sn) < (q`2/|.q.|-sn);
        then A9: --(1+sn)> -(q`2/|.q.|-sn) by XREAL_1:26;
        A10: -( q`2/|.q.|-sn)>0 by A5,XREAL_1:60;
         -(1+sn)< -0 by A6,XREAL_1:26;
         then (-(1+sn))/(1+sn)<(-( q`2/|.q.|-sn))/(1+sn) by A10,A6,REAL_1:73;
        then A11: -1<(-( q`2/|.q.|-sn))/(1+sn) by A6,XCMPLX_1:198;
           (-(q`2/|.q.|-sn))/(1+sn)<1 by A6,A9,REAL_2:118;
       then ((-(q`2/|.q.|-sn))/(1+sn))^2<1^2 by A11,SQUARE_1:120;
       then 1-((-(q`2/|.q.|-sn))/(1+sn))^2>0 by XREAL_1:52;
       then sqrt(1-((-(q`2/|.q.|-sn))/(1+sn))^2)>0 by SQUARE_1:93;
       then sqrt(1-(-(q`2/|.q.|-sn))^2/(1+sn)^2)> 0 by XCMPLX_1:77;
       then sqrt(1-(q`2/|.q.|-sn)^2/(1+sn)^2)> 0;
       then sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)> 0 by XCMPLX_1:77;
       then A12: -sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)< -0 by XREAL_1:26;
           ((q`2/|.q.|-sn)/(1+sn))<0 by A5,A6,REAL_2:128;
   hence p`1<0 & p`2<0 by A3,A7,A12,XREAL_1:134;
 end;

theorem Th51:
 for sn being Real,q1,q2 being Point of TOP-REAL 2 st -1<sn & sn<1 & q1`1<0
 & q1`2/|.q1.|>=sn & q2`1<0 & q2`2/|.q2.|>=sn & q1`2/|.q1.|<q2`2/|.q2.|
 holds (for p1,p2 being Point of TOP-REAL 2 st
 p1=(sn-FanMorphW).q1 & p2=(sn-FanMorphW).q2 holds p1`2/|.p1.|<p2`2/|.p2.|)
 proof let sn be Real,q1,q2 be Point of TOP-REAL 2;
  assume A1: -1<sn & sn<1 & q1`1<0
   & q1`2/|.q1.|>=sn & q2`1<0 & q2`2/|.q2.|>=sn & q1`2/|.q1.|<q2`2/|.q2.|;
  let p1,p2 be Point of TOP-REAL 2;
   assume A2: p1=(sn-FanMorphW).q1 & p2=(sn-FanMorphW).q2;
    then p1=|[ |.q1.|*(-sqrt(1-((q1`2/|.q1.|-sn)/(1-sn))^2)),
          |.q1.|* ((q1`2/|.q1.|-sn)/(1-sn))]| by A1,Th23;
    then A3: p1`1= |.q1.|*(-sqrt(1-((q1`2/|.q1.|-sn)/(1-sn))^2))&
        p1`2= |.q1.|* ((q1`2/|.q1.|-sn)/(1-sn)) by EUCLID:56;
        p2=|[ |.q2.|*(-sqrt(1-((q2`2/|.q2.|-sn)/(1-sn))^2)),
          |.q2.|* ((q2`2/|.q2.|-sn)/(1-sn))]| by A1,A2,Th23;
    then A4: p2`1= |.q2.|*(-sqrt(1-((q2`2/|.q2.|-sn)/(1-sn))^2))&
        p2`2= |.q2.|* ((q2`2/|.q2.|-sn)/(1-sn)) by EUCLID:56;
    A5: |.q1.|>0 & |.q2.|>0 by A1,Lm1,JGRAPH_2:11;
    A6: |.p1.|=|.q1.| & |.p2.|=|.q2.| by A2,Th40;
    then A7: p1`2/|.p1.|= ((q1`2/|.q1.|-sn)/(1-sn)) by A3,A5,XCMPLX_1:90
;
    A8: p2`2/|.p2.|= ((q2`2/|.q2.|-sn)/(1-sn)) by A4,A5,A6,XCMPLX_1:90
;
    A9: q1`2/|.q1.|-sn< q2`2/|.q2.|-sn by A1,XREAL_1:11;
        1-sn>0 by A1,XREAL_1:151;
   hence thesis by A7,A8,A9,REAL_1:73;
 end;

theorem Th52:
 for sn being Real,q1,q2 being Point of TOP-REAL 2 st -1<sn & sn<1 & q1`1<0
 & q1`2/|.q1.|<sn & q2`1<0 & q2`2/|.q2.|<sn & q1`2/|.q1.|<q2`2/|.q2.|
 holds (for p1,p2 being Point of TOP-REAL 2 st
 p1=(sn-FanMorphW).q1 & p2=(sn-FanMorphW).q2 holds p1`2/|.p1.|<p2`2/|.p2.|)
 proof let sn be Real,q1,q2 be Point of TOP-REAL 2;
  assume A1: -1<sn & sn<1 & q1`1<0
   & q1`2/|.q1.|<sn & q2`1<0 & q2`2/|.q2.|<sn & q1`2/|.q1.|<q2`2/|.q2.|;
  let p1,p2 be Point of TOP-REAL 2;
   assume A2: p1=(sn-FanMorphW).q1 & p2=(sn-FanMorphW).q2;
    then p1=|[ |.q1.|*(-sqrt(1-((q1`2/|.q1.|-sn)/(1+sn))^2)),
          |.q1.|* ((q1`2/|.q1.|-sn)/(1+sn))]| by A1,Th24;
    then A3: p1`1= |.q1.|*(-sqrt(1-((q1`2/|.q1.|-sn)/(1+sn))^2))&
        p1`2= |.q1.|* ((q1`2/|.q1.|-sn)/(1+sn)) by EUCLID:56;
        p2=|[ |.q2.|*(-sqrt(1-((q2`2/|.q2.|-sn)/(1+sn))^2)),
          |.q2.|* ((q2`2/|.q2.|-sn)/(1+sn))]| by A1,A2,Th24;
    then A4: p2`1= |.q2.|*(-sqrt(1-((q2`2/|.q2.|-sn)/(1+sn))^2))&
        p2`2= |.q2.|* ((q2`2/|.q2.|-sn)/(1+sn)) by EUCLID:56;
    A5: |.q1.|>0 & |.q2.|>0 by A1,Lm1,JGRAPH_2:11;
    A6: |.p1.|=|.q1.| & |.p2.|=|.q2.| by A2,Th40;
    then A7: p1`2/|.p1.|= ((q1`2/|.q1.|-sn)/(1+sn)) by A3,A5,XCMPLX_1:90
;
    A8: p2`2/|.p2.|= ((q2`2/|.q2.|-sn)/(1+sn)) by A4,A5,A6,XCMPLX_1:90
;
    A9: q1`2/|.q1.|-sn< q2`2/|.q2.|-sn by A1,XREAL_1:11;
        1+sn>0 by A1,XREAL_1:150;
   hence p1`2/|.p1.|<p2`2/|.p2.| by A7,A8,A9,REAL_1:73;
 end;

theorem
     for sn being Real,q1,q2 being Point of TOP-REAL 2 st -1<sn & sn<1 & q1`1<0
 & q2`1<0 & q1`2/|.q1.|<q2`2/|.q2.|
 holds (for p1,p2 being Point of TOP-REAL 2 st
 p1=(sn-FanMorphW).q1 & p2=(sn-FanMorphW).q2 holds p1`2/|.p1.|<p2`2/|.p2.|)
 proof let sn be Real,q1,q2 be Point of TOP-REAL 2;
  assume A1: -1<sn & sn<1 & q1`1<0
    & q2`1<0 & q1`2/|.q1.|<q2`2/|.q2.|;
  let p1,p2 be Point of TOP-REAL 2;
   assume A2: p1=(sn-FanMorphW).q1 & p2=(sn-FanMorphW).q2;
        now per cases;
    case q1`2/|.q1.|>=sn & q2`2/|.q2.|>=sn;
     hence p1`2/|.p1.|<p2`2/|.p2.| by A1,A2,Th51;
    end;
    case q1`2/|.q1.|>=sn & q2`2/|.q2.|<sn;
     hence p1`2/|.p1.|<p2`2/|.p2.| by A1,XXREAL_0:2;
    end;
    case A3: q1`2/|.q1.|<sn & q2`2/|.q2.|>=sn;
       then A4: p1`1<0 & p1`2<0 by A1,A2,Th50;
       then A5: |.p1.|>0 by Lm1,JGRAPH_2:11;
       A6: p2`1<0 & p2`2>=0 by A1,A2,A3,Th49;
       p2`2/|.p2.|>=0 by A6,REAL_2:125;
     hence p1`2/|.p1.|<p2`2/|.p2.| by A4,A5,REAL_2:128;
    end;
    case q1`2/|.q1.|<sn & q2`2/|.q2.|<sn;
     hence p1`2/|.p1.|<p2`2/|.p2.| by A1,A2,Th52;
    end;
    end;
   hence p1`2/|.p1.|<p2`2/|.p2.|;
 end;

theorem
     for sn being Real,q being Point of TOP-REAL 2 st -1<sn & sn<1 & q`1<0
 & q`2/|.q.|=sn holds (for p being Point of TOP-REAL 2 st
 p=(sn-FanMorphW).q holds p`1<0 & p`2=0)
 proof let sn be Real,q be Point of TOP-REAL 2;
  assume A1: -1<sn & sn<1 & q`1<0 & q`2/|.q.|=sn;
  let p be Point of TOP-REAL 2;
   assume p=(sn-FanMorphW).q;
    then A2: p=|[ |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by A1,Th23;
    A3: |.q.|>0 by A1,Lm1,JGRAPH_2:11;
     A4: p`1= |.q.|*(-sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))&
        p`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by A2,EUCLID:56;
           ((-(q`2/|.q.|-sn))/(1-sn))^2<1^2 by A1;
       then -sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)< -0 by Lm14;
   hence thesis by A1,A3,A4,XREAL_1:134;
 end;

theorem
  for sn being real number holds 0.REAL 2=(sn-FanMorphW).(0.REAL 2)
   by Th23,JGRAPH_2:11;

begin :: Fan Morphism for North

definition let s be real number, q be Point of TOP-REAL 2;
  func FanN(s,q) -> Point of TOP-REAL 2 equals
  :Def4: |.q.|*|[(q`1/|.q.|-s)/(1-s),
     sqrt(1-((q`1/|.q.|-s)/(1-s))^2)]| if q`1/|.q.|>=s & q`2>0,
       |.q.|*|[(q`1/|.q.|-s)/(1+s),
     sqrt(1-((q`1/|.q.|-s)/(1+s))^2)]| if q`1/|.q.|<s & q`2>0
   otherwise q;
 correctness;
end;

definition let c be real number;
  func c-FanMorphN -> Function of TOP-REAL 2, TOP-REAL 2 means
  :Def5: for q being Point of TOP-REAL 2 holds
       it.q=FanN(c,q);
 existence
  proof
    deffunc F(Point of TOP-REAL 2)=FanN(c,$1);
    thus ex IT being Function of TOP-REAL 2, TOP-REAL 2 st
    for q being Point of TOP-REAL 2 holds
     IT.q=F(q) from FUNCT_2:sch 4;
  end;
 uniqueness
  proof
deffunc F(Point of TOP-REAL 2)=FanN(c,$1);
    thus for a,b being Function of TOP-REAL 2, TOP-REAL 2 st
 (for q being Point of TOP-REAL 2 holds a.q=F(q)) &
 (for q being Point of TOP-REAL 2 holds b.q=F(q)) holds
 a = b from BINOP_2:sch 1;
  end;
end;

theorem Th56: for cn being real number holds
  (q`1/|.q.|>=cn & q`2>0 implies
    cn-FanMorphN.q= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
    |.q.|*(sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]|)&
  (q`2<=0 implies cn-FanMorphN.q=q)
proof let cn be real number;
  A1: cn-FanMorphN.q=FanN(cn,q) by Def5;
   hereby assume q`1/|.q.|>=cn & q`2>0;
    then FanN(cn,q)= |.q.|*|[(q`1/|.q.|-cn)/(1-cn),
         sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)]| by Def4
          .= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
          |.q.|*(sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by EUCLID:62;
     hence cn-FanMorphN.q= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
    |.q.|*(sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by Def5;
   end;
   assume q`2<=0; hence thesis by A1,Def4;
end;

theorem Th57: for cn being Real holds
  (q`1/|.q.|<=cn & q`2>0 implies
    cn-FanMorphN.q= |[ |.q.|*((q`1/|.q.|-cn)/(1+cn)),
       |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]|)
proof let cn be Real;
   assume A1: q`1/|.q.|<=cn & q`2>0;
   per cases by A1,REAL_1:def 5;
   suppose q`1/|.q.|<cn;
    then FanN(cn,q)= |.q.|*|[(q`1/|.q.|-cn)/(1+cn),
        sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)]| by A1,Def4
          .= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
           |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]| by EUCLID:62;
    hence thesis by Def5;
   end;
   suppose A2: q`1/|.q.|=cn;
    (q`1/|.q.|-cn)/(1-cn)=0 by A2;
    hence thesis by A1,A2,Th56;
   end;
end;

theorem Th58: for cn being Real st -1<cn & cn<1 holds
  (q`1/|.q.|>=cn & q`2>=0 & q<>0.REAL 2 implies
    cn-FanMorphN.q= |[ |.q.|*((q`1/|.q.|-cn)/(1-cn)),
        |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]|) &
  (q`1/|.q.|<=cn & q`2>=0 & q<>0.REAL 2 implies
    cn-FanMorphN.q= |[ |.q.|*((q`1/|.q.|-cn)/(1+cn)),
        |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]|)
proof let cn be Real;
 assume A1: -1<cn & cn<1;
 per cases;
   suppose A2: q`1/|.q.|>=cn & q`2>=0 & q<>0.REAL 2;
   per cases;
    suppose A3: q`2>0;
      then FanN(cn,q)= |.q.|*|[(q`1/|.q.|-cn)/(1-cn),
          sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)]| by A2,Def4
          .= |[|.q.|* ((q`1/|.q.|-cn)/(1-cn)),
          |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by EUCLID:62;
     hence thesis by A3,Def5,Th57;
    end;
    suppose A4: q`2<=0;
     then A5: cn-FanMorphN.q=q by Th56;
     A6: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
     A7: |.q.|<>0 by A2,TOPRNS_1:25;
     then A8: |.q.|^2>0 by SQUARE_1:74;
     A9: q`2=0 by A2,A4;
     A10: sqrt((|.q.|)^2)=|.q.| by SQUARE_1:89;
     A11: 1-cn>0 by A1,XREAL_1:151;
     A12: |.q.|>0 by A2,Lm1;
         (q`1)^2/|.q.|^2=1^2 by A6,A8,A9,XCMPLX_1:60;
      then ((q`1)/|.q.|)^2=1^2 by XCMPLX_1:77;
      then A13: sqrt(((q`1)/|.q.|)^2)=1 by SQUARE_1:89;
      now assume q`1<0;
       then q`1/|.q.|<0 by A12,REAL_2:128;
       then -((q`1)/|.q.|)=1 by A13,SQUARE_1:90;
      hence contradiction by A1,A2;
     end;
     then A14: |.q.|=q`1 by A6,A9,A10,SQUARE_1:89;
     then 1=q`1/|.q.| by A7,XCMPLX_1:60; then
A15:  (q`1/|.q.|-cn)/(1-cn)=1 by A11,XCMPLX_1:60;
     cn-FanMorphN.q = |[ |.q.|*((q`1/|.q.|-cn)/(1-cn)),
          |.q.|*(sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)) ]| by  A5,A9,A14,A15,
EUCLID:57, SQUARE_1:82; then
     cn-FanMorphN.q = |[ |.q.|*((q`1/|.q.|-cn)/(1-cn)),
       |.q.|*(sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)) ]|;
     hence thesis by A1,A7,A14,XCMPLX_1:60;
    end;
   end;
   suppose A16: q`1/|.q.|<=cn & q`2>=0 & q<>0.REAL 2;
    per cases;
    suppose q`2>0;
     hence thesis by Th56,Th57;
    end;
    suppose A17: q`2<=0;
     A18: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
     A19: |.q.|<>0 by A16,TOPRNS_1:25;
     A20: q`2=0 by A16,A17;
     A21: |.q.|>0 by A16,Lm1;
     A22: 1+cn>0 by A1,XREAL_1:150;
      1>q`1/|.q.| by A1,A16,XXREAL_0:2;
     then 1 *(|.q.|)>q`1/|.q.|*(|.q.|) by A21,XREAL_1:70;
     then A23: (|.q.|)>q`1 by A19,XCMPLX_1:88;
     then A24: |.q.|=-q`1 by A18,A20,SQUARE_1:109;
     A25: q`1= -(|.q.|) by A18,A20,A23,SQUARE_1:109;
     then -1=q`1/|.q.| by A19,XCMPLX_1:198;
     then (q`1/|.q.|-cn)/(1+cn)
     =(-(1+cn))/(1+cn) .=-1 by A22,XCMPLX_1:198;
     then |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
     |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]|
      =q by A20,A24,EUCLID:57,SQUARE_1:82;
     hence thesis by A1,A17,A19,A25,Th56,XCMPLX_1:198;
    end;
   end;
   suppose q`2<0 or q=0.REAL 2;
    hence thesis;
   end;
end;

theorem Th59:
 for cn being Real,K1 being non empty Subset of TOP-REAL 2,
f being Function of (TOP-REAL 2)|K1,R^1 st -1<cn & cn<1 &
(for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|* ((p`1/|.p.|-cn)/(1-cn)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`2>=0 & q<>0.REAL 2) holds
f is continuous
proof
 let cn be Real,K1 be non empty Subset of TOP-REAL 2,
f be Function of (TOP-REAL 2)|K1,R^1;
 assume A1: -1<cn & cn<1 &
(for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|* ((p`1/|.p.|-cn)/(1-cn)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`2>=0 & q<>0.REAL 2);
  set a=cn, b=(1-cn);
  A2: b>0 by A1,XREAL_1:151;
  reconsider g2=proj1|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm4;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1
                          by Lm7;
      for q being Point of TOP-REAL 2 st q in
    the carrier of (TOP-REAL 2)|K1 holds q<>0.REAL 2 by A1;
  then for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm8;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
  A3: (for q being Point of
  (TOP-REAL 2)|K1,r1,r2 being Real st g2.q=r1 & g1.q=r2
  holds g3.q=r2*((r1/r2-a)/b)) & g3 is continuous by A2,Th10;
  A4:dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then A5:dom f=dom g3 by FUNCT_2:def 1;
      for x being set st x in dom f holds f.x=g3.x
   proof let x be set;assume
     A6: x in dom f;
     then x in K1 by A4,A5,PRE_TOPC:29;
     then reconsider r=x as Point of TOP-REAL 2;
     reconsider s=x as Point of (TOP-REAL 2)|K1 by A6;
     A7:f.r=(|.r.|)* ((r`1/|.r.|-cn)/(1-cn)) by A1,A6;
     A8:g2.s=proj1.s by Lm4;
     A9:g1.s=(2 NormF).s by Lm7;
     A10:proj1.r=r`1 by PSCOMP_1:def 28;
         (2 NormF).r=|.r.| by Def1;
    hence f.x=g3.x by A3,A7,A8,A9,A10;
   end;
hence f is continuous by A3,A5,FUNCT_1:9;
end;

theorem Th60:
 for cn being Real,K1 being non empty Subset of TOP-REAL 2,
f being Function of (TOP-REAL 2)|K1,R^1 st
  -1<cn & cn<1 &
(for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|* ((p`1/|.p.|-cn)/(1+cn)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`2>=0 & q<>0.REAL 2) holds
f is continuous
proof
 let cn be Real,K1 be non empty Subset of TOP-REAL 2,
f be Function of (TOP-REAL 2)|K1,R^1;
 assume A1:  -1<cn & cn<1 &
(for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|* ((p`1/|.p.|-cn)/(1+cn)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`2>=0 & q<>0.REAL 2);
  set a=cn, b=(1+cn);
  A2: 1+cn>0 by A1,XREAL_1:150;
  reconsider g2=proj1|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm4;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1
                          by Lm7;
      for q being Point of TOP-REAL 2 st q in
    the carrier of (TOP-REAL 2)|K1 holds q<>0.REAL 2 by A1;
  then for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm8;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
  A3: (for q being Point of
  (TOP-REAL 2)|K1,r1,r2 being Real st g2.q=r1 & g1.q=r2
  holds g3.q=r2*((r1/r2-a)/b)) & g3 is continuous by A2,Th10;
  A4:dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then A5:dom f=dom g3 by FUNCT_2:def 1;
      for x being set st x in dom f holds f.x=g3.x
   proof let x be set;assume
     A6: x in dom f; then A7: x in dom g3 by A4;
     then x in K1 by A4,PRE_TOPC:29;
     then reconsider r=x as Point of TOP-REAL 2;
     reconsider s=x as Point of (TOP-REAL 2)|K1 by A6;
     A8:f.r=(|.r.|)* ((r`1/|.r.|-cn)/(1+cn)) by A1,A7;
     A9:g2.s=proj1.s by Lm4;
     A10:g1.s=(2 NormF).s by Lm7;
     A11:proj1.r=r`1 by PSCOMP_1:def 28;
         (2 NormF).r=|.r.| by Def1;
    hence f.x=g3.x by A3,A8,A9,A10,A11;
   end;
hence f is continuous by A3,A5,FUNCT_1:9;
end;

theorem Th61:
 for cn being Real,K1 being non empty Subset of TOP-REAL 2,
f being Function of (TOP-REAL 2)|K1,R^1 st -1<cn & cn<1 &
(for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds
        q`2>=0 & q`1/|.q.|>=cn & q<>0.REAL 2) holds
f is continuous
proof
 let cn be Real,K1 be non empty Subset of TOP-REAL 2,
f be Function of (TOP-REAL 2)|K1,R^1;
 assume A1: -1<cn & cn<1 &
(for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds
            q`2>=0 & q`1/|.q.|>=cn & q<>0.REAL 2);
  set a=cn, b=(1-cn);
  A2: b>0 by A1,XREAL_1:151;
  reconsider g2=proj1|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm4;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1
                          by Lm7;
      for q being Point of TOP-REAL 2 st q in
    the carrier of (TOP-REAL 2)|K1 holds q<>0.REAL 2 by A1;
  then for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm8;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
  A3: (for q being Point of
  (TOP-REAL 2)|K1,r1,r2 being real number st g2.q=r1 & g1.q=r2
  holds g3.q=r2*( sqrt(abs(1-((r1/r2-a)/b)^2))))
          & g3 is continuous by A2,Th15;
  A4:dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then A5:dom f=dom g3 by FUNCT_2:def 1;
      for x being set st x in dom f holds f.x=g3.x
   proof let x be set;assume
     A6: x in dom f;
     then x in K1 by A4,A5,PRE_TOPC:29;
     then reconsider r=x as Point of TOP-REAL 2;
     reconsider s=x as Point of (TOP-REAL 2)|K1 by A6;
     A7: now assume |.r.|=0; then r=0.REAL 2 by TOPRNS_1:25;
      hence contradiction by A1,A6;
     end;
     A8: |.r.|>=0;
     |.r.|^2=(r`1)^2+(r`2)^2 by JGRAPH_3:10;
     then (r`1)^2 -(|.r.|)^2 =-(r`2)^2;
     then A9: ((r`1) -(|.r.|))*((r`1)+|.r.|) =-(r`2)^2;
     (r`2)^2>=0 by XREAL_1:65;
     then -(r`2)^2 <=0 by XREAL_1:60;
     then -(|.r.|)<=r`1 & r`1<= |.r.| by A9,XREAL_1:95;
     then r`1/|.r.| <= |.r.|/|.r.| by A7,A8,REAL_1:73;
     then r`1/|.r.|<=1 by A7,XCMPLX_1:60;
     then A10: r`1/|.r.|-cn<=(1-cn) by XREAL_1:11;
     A11: now assume (1-cn)^2=0;
      then 1-cn+cn=0+cn by XCMPLX_1:6;
      hence contradiction by A1;
     end;
     A12: 1-cn>0 by A1,XREAL_1:151;
      A13: (1-cn)^2>=0 by XREAL_1:65;
     cn<=r`1/(|.r.|) by A1,A6;
     then cn-r`1/|.r.|<=0 by REAL_2:106;
     then -(cn- r`1/|.r.|)>=-(1-cn) by A12,XREAL_1:26;
     then (r`1/|.r.|-cn)^2<=(1-cn)^2 by A10,SQUARE_1:119;
     then (r`1/|.r.|-cn)^2/(1-cn)^2<=(1-cn)^2/(1-cn)^2 by A11,A13,REAL_1:73;
     then (r`1/|.r.|-cn)^2/(1-cn)^2<=1 by A11,XCMPLX_1:60;
     then ((r`1/|.r.|-cn)/(1-cn))^2<=1 by XCMPLX_1:77;
     then 1-((r`1/|.r.|-cn)/(1-cn))^2>=0 by XREAL_1:50;
     then abs(1-((r`1/|.r.|-cn)/(1-cn))^2)
          =1-((r`1/|.r.|-cn)/(1-cn))^2 by ABSVALUE:def 1;
     then A14:f.r=(|.r.|)*( sqrt(abs(1-((r`1/|.r.|-cn)/(1-cn))^2)))
       by A1,A6;
     A15:g2.s=proj1.s by Lm4;
     A16:g1.s=(2 NormF).s by Lm7;
     A17:proj1.r=r`1 by PSCOMP_1:def 28;
     (2 NormF).r=|.r.| by Def1;
    hence f.x=g3.x by A3,A14,A15,A16,A17;
   end;
hence f is continuous by A3,A5,FUNCT_1:9;
end;

theorem Th62:
 for cn being Real,K1 being non empty Subset of TOP-REAL 2,
f being Function of (TOP-REAL 2)|K1,R^1 st -1<cn & cn<1 &
(for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds
        q`2>=0 & q`1/|.q.|<=cn & q<>0.REAL 2) holds
f is continuous
proof
 let cn be Real,K1 be non empty Subset of TOP-REAL 2,
     f be Function of (TOP-REAL 2)|K1,R^1;
 assume A1: -1<cn & cn<1 &
(for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds
            q`2>=0 & q`1/|.q.|<=cn & q<>0.REAL 2);
  set a=cn, b=(1+cn);
  A2: 1+cn>0 by A1,XREAL_1:150;
  reconsider g2=proj1|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm4;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1
                          by Lm7;
      for q being Point of TOP-REAL 2 st q in
    the carrier of (TOP-REAL 2)|K1 holds q<>0.REAL 2 by A1;
  then for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm8;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
  A3: (for q being Point of
  (TOP-REAL 2)|K1,r1,r2 being real number st g2.q=r1 & g1.q=r2
  holds g3.q=r2*( sqrt(abs(1-((r1/r2-a)/b)^2))))
          & g3 is continuous by A2,Th15;
  A4:dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then A5:dom f=dom g3 by FUNCT_2:def 1;
      for x being set st x in dom f holds f.x=g3.x
   proof let x be set;assume
     A6:x in dom f;
     then x in K1 by A4,A5,PRE_TOPC:29;
     then reconsider r=x as Point of TOP-REAL 2;
     reconsider s=x as Point of (TOP-REAL 2)|K1 by A6;
     A7: now assume |.r.|=0; then r=0.REAL 2 by TOPRNS_1:25;
      hence contradiction by A1,A6;
     end;
     A8: |.r.|>=0;
         |.r.|^2=(r`1)^2+(r`2)^2 by JGRAPH_3:10;
     then (r`1)^2 -(|.r.|)^2 =-(r`2)^2;
     then A9: ((r`1) -(|.r.|))*((r`1)+|.r.|) =-(r`2)^2;
     (r`2)^2>=0 by XREAL_1:65;
     then -(r`2)^2 <=0 by XREAL_1:60;
     then -(|.r.|)<=r`1 & r`1<= |.r.| by A9,XREAL_1:95;
     then r`1/|.r.| >= (-(|.r.|))/|.r.| by A7,A8,REAL_1:73;
     then r`1/|.r.|>= -1 by A7,XCMPLX_1:198;
     then r`1/|.r.|-cn>=-1-cn by XREAL_1:11;
     then A10: r`1/|.r.|-cn>=-(1+cn);
     A11: (1+cn)^2>0 by A2,SQUARE_1:74;
     cn>=r`1/(|.r.|) by A1,A6;
     then cn-r`1/|.r.|>=0 by XREAL_1:50;
     then -(cn-r`1/|.r.|)<=-0 by XREAL_1:26;
     then (r`1/|.r.|-cn)^2<=(1+cn)^2 by A10,A2,SQUARE_1:119;
     then (r`1/|.r.|-cn)^2/(1+cn)^2<=(1+cn)^2/(1+cn)^2 by A11,REAL_1:73;
     then (r`1/|.r.|-cn)^2/(1+cn)^2<=1 by A11,XCMPLX_1:60;
     then ((r`1/|.r.|-cn)/(1+cn))^2<=1 by XCMPLX_1:77;
     then 1-((r`1/|.r.|-cn)/(1+cn))^2>=0 by XREAL_1:50;
     then abs(1-((r`1/|.r.|-cn)/(1+cn))^2)
          =1-((r`1/|.r.|-cn)/(1+cn))^2 by ABSVALUE:def 1;
     then A12:f.r=(|.r.|)*( sqrt(abs(1-((r`1/|.r.|-cn)/(1+cn))^2)))
     by A1,A6;
     A13:g2.s=proj1.s by Lm4;
     A14:g1.s=(2 NormF).s by Lm7;
     A15:proj1.r=r`1 by PSCOMP_1:def 28;
     (2 NormF).r=|.r.| by Def1;
    hence f.x=g3.x by A3,A12,A13,A14,A15;
   end;
hence f is continuous by A3,A5,FUNCT_1:9;
end;

theorem Th63: for cn being Real,
K0,B0 being Subset of TOP-REAL 2,f being
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0
st -1<cn & cn<1 & f=(cn-FanMorphN)|K0 &
B0={q where q is Point of TOP-REAL 2: q`2>=0 & q<>0.REAL 2}
& K0={p: p`1/|.p.|>=cn & p`2>=0 & p<>0.REAL 2}
holds f is continuous
proof let cn be Real,K0,B0 be Subset of TOP-REAL 2,f be
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0;
assume A1: -1<cn & cn<1 & f=(cn-FanMorphN)|K0 &
B0={q where q is Point of TOP-REAL 2: q`2>=0 & q<>0.REAL 2} &
K0={p: p`1/|.p.|>=cn & p`2>=0 & p<>0.REAL 2};
 set sn=sqrt(1-cn^2);
 set p0=|[cn,sn]|;
 A2: p0`1=cn by EUCLID:56;
 A3: p0`2=sn by EUCLID:56;
 cn^2<1^2 by A1,SQUARE_1:120;
 then A4: 1-cn^2>0 by XREAL_1:52;
 then A5: p0`2>0 by A3,SQUARE_1:93;
 A6: |.p0.|=sqrt((sn)^2+cn^2) by A2,A3,JGRAPH_3:10;
 sn^2=1-cn^2 by A4,SQUARE_1:def 4;
 then p0`1/|.p0.|=cn by A6,EUCLID:56,SQUARE_1:83;
 then A7: p0 in K0 by A1,A5,JGRAPH_2:11;
 then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
  A8: K0 c= B0
   proof let x be set;assume x in K0;
      then consider p8 being Point of TOP-REAL 2 such that
      A9: x=p8 & (p8`1/|.p8.|>=cn & p8`2>=0 & p8<>0.REAL 2) by A1;
    thus x in B0 by A1,A9;
   end;
A10:dom (proj1*((cn-FanMorphN)|K1)) c= dom ((cn-FanMorphN)|K1)
                                  by RELAT_1:44;
   dom ((cn-FanMorphN)|K1) c= dom (proj1*((cn-FanMorphN)|K1))
proof let x be set;assume A11:x in dom ((cn-FanMorphN)|K1);
   then A12:x in dom (cn-FanMorphN) /\ K1 by FUNCT_1:68;
   A13:((cn-FanMorphN)|K1).x=(cn-FanMorphN).x by A11,FUNCT_1:68;
   A14: dom proj1 = (the carrier of TOP-REAL 2) by FUNCT_2:def 1;
       x in dom (cn-FanMorphN) by A12,XBOOLE_0:def 3;
   then (cn-FanMorphN).x in rng (cn-FanMorphN) by FUNCT_1:12;
  hence x in dom (proj1*((cn-FanMorphN)|K1)) by A11,A13,A14,FUNCT_1:21;
end;
then A15:dom (proj1*((cn-FanMorphN)|K1))
=dom ((cn-FanMorphN)|K1) by A10,XBOOLE_0:def 10
.=dom (cn-FanMorphN) /\ K1 by FUNCT_1:68
.=(the carrier of TOP-REAL 2)/\ K1 by FUNCT_2:def 1
.=K1 by XBOOLE_1:28
.=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
A16:rng (proj1*((cn-FanMorphN)|K1)) c= rng proj1 by RELAT_1:45;
    rng proj1 c= the carrier of R^1 by TOPMETR:24;
then rng (proj1*((cn-FanMorphN)|K1)) c= the carrier of R^1 by A16,XBOOLE_1:1;
then reconsider g2=proj1*((cn-FanMorphN)|K1) as Function of (TOP-REAL 2)|K1,R^1
                                 by A15,FUNCT_2:4;
A17:dom (proj2*((cn-FanMorphN)|K1))
                     c= dom ((cn-FanMorphN)|K1) by RELAT_1:44;
     dom ((cn-FanMorphN)|K1) c= dom (proj2*((cn-FanMorphN)|K1))
proof let x be set;assume A18:x in dom ((cn-FanMorphN)|K1);
   then A19:x in dom (cn-FanMorphN) /\ K1 by FUNCT_1:68;
   A20:((cn-FanMorphN)|K1).x=(cn-FanMorphN).x by A18,FUNCT_1:68;
   A21: dom proj2 = (the carrier of TOP-REAL 2) by FUNCT_2:def 1;
       x in dom (cn-FanMorphN) by A19,XBOOLE_0:def 3;
   then (cn-FanMorphN).x in rng (cn-FanMorphN) by FUNCT_1:12;
  hence x in dom (proj2*((cn-FanMorphN)|K1)) by A18,A20,A21,FUNCT_1:21;
end;
then A22:dom (proj2*((cn-FanMorphN)|K1))
=dom ((cn-FanMorphN)|K1) by A17,XBOOLE_0:def 10
.=dom (cn-FanMorphN) /\ K1 by FUNCT_1:68
.=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
.=K1 by XBOOLE_1:28
.=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
A23:rng (proj2*((cn-FanMorphN)|K1)) c= rng proj2 by RELAT_1:45;
    rng proj2 c= the carrier of R^1 by TOPMETR:24;
then rng (proj2*((cn-FanMorphN)|K1)) c= the carrier of R^1 by A23,XBOOLE_1:1;
then reconsider g1=proj2*((cn-FanMorphN)|K1) as Function of (TOP-REAL 2)|K1,R^1
                                 by A22,FUNCT_2:4;
A24: for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`2>=0 & q<>0.REAL 2
   proof let q be Point of TOP-REAL 2;
    assume A25:q in the carrier of (TOP-REAL 2)|K1;
          the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     then consider p3 being Point of TOP-REAL 2 such that
     A26: q=p3 & (p3`1/|.p3.|>=cn & p3`2>=0 & p3<>0.REAL 2) by A1,A25;
    thus q`2>=0 & q<>0.REAL 2 by A26;
   end;
      for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g2.p=|.p.|* ((p`1/|.p.|-cn)/(1-cn))
   proof let p be Point of TOP-REAL 2;
    assume A27: p in the carrier of (TOP-REAL 2)|K1;
     A28:dom ((cn-FanMorphN)|K1)=dom (cn-FanMorphN) /\ K1 by FUNCT_1:68
     .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
     .=K1 by XBOOLE_1:28;
     A29:the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     then consider p3 being Point of TOP-REAL 2 such that
     A30: p=p3 & (p3`1/|.p3.|>=cn & p3`2>=0 & p3<>0.REAL 2) by A1,A27;
     A31:(cn-FanMorphN).p
     =|[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
        |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]| by A1,A30,Th58;
        ((cn-FanMorphN)|K1).p=(cn-FanMorphN).p by A27,A29,FUNCT_1:72;
     then g2.p=proj1.(|[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
        |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]|)
                             by A27,A28,A29,A31,FUNCT_1:23
      .=(|[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
        |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]|)`1 by PSCOMP_1:def 28
      .=|.p.|* ((p`1/|.p.|-cn)/(1-cn)) by EUCLID:56;
    hence g2.p=|.p.|* ((p`1/|.p.|-cn)/(1-cn));
   end;
then consider f2 being Function of (TOP-REAL 2)|K1,R^1 such that
  A32:for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds f2.p=|.p.|* ((p`1/|.p.|-cn)/(1-cn));
A33:f2 is continuous by A1,A24,A32,Th59;
      for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g1.p=|.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))
   proof let p be Point of TOP-REAL 2;
    assume A34: p in the carrier of (TOP-REAL 2)|K1;
     A35:dom ((cn-FanMorphN)|K1)=dom (cn-FanMorphN) /\ K1 by FUNCT_1:68
     .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
     .=K1 by XBOOLE_1:28;
     A36:the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     then consider p3 being Point of TOP-REAL 2 such that
     A37: p=p3 & (p3`1/|.p3.|>=cn & p3`2>=0 & p3<>0.REAL 2) by A1,A34;
     A38:(cn-FanMorphN).p=|[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
       |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]| by A1,A37,Th58;
        ((cn-FanMorphN)|K1).p=(cn-FanMorphN).p by A34,A36,FUNCT_1:72;
     then g1.p=proj2.(|[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
          |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]|)
                             by A34,A35,A36,A38,FUNCT_1:23
        .=(|[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
          |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]|)`2 by PSCOMP_1:def 29
        .= |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)) by EUCLID:56;
    hence g1.p=|.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2));
   end;
then consider f1 being Function of (TOP-REAL 2)|K1,R^1 such that
  A39:for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds f1.p=|.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2));
      for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`2>=0 & q`1/|.q.|>=cn & q<>0.REAL 2
   proof let q be Point of TOP-REAL 2;
    assume A40:q in the carrier of (TOP-REAL 2)|K1;
          the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     then consider p3 being Point of TOP-REAL 2 such that
     A41: q=p3 & (p3`1/|.p3.|>=cn & p3`2>=0 & p3<>0.REAL 2) by A1,A40;
    thus thesis by A41;
   end;
then A42:f1 is continuous by A1,A39,Th61;
    for x,y,s,r being real number st |[x,y]| in K1 &
  s=f2.(|[x,y]|) & r=f1.(|[x,y]|) holds f.(|[x,y]|)=|[s,r]|
  proof let x,y,s,r be real number;
   assume A43: |[x,y]| in K1 & s=f2.(|[x,y]|) & r=f1.(|[x,y]|);
     set p99=|[x,y]|;
     A44:the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     consider p3 being Point of TOP-REAL 2 such that
     A45: p99=p3 & (p3`1/|.p3.|>=cn & p3`2>=0 & p3<>0.REAL 2) by A1,A43;
     A46:f1.p99=|.p99.|*( sqrt(1-((p99`1/|.p99.|-cn)/(1-cn))^2))
                          by A39,A43,A44;
     ((cn-FanMorphN)|K0).(|[x,y]|)=((cn-FanMorphN)).(|[x,y]|)
          by A43,FUNCT_1:72
    .= |[ |.p99.|* ((p99`1/|.p99.|-cn)/(1-cn)),
      |.p99.|*( sqrt(1-((p99`1/|.p99.|-cn)/(1-cn))^2))]| by A1,A45,Th58
    .=|[s,r]| by A32,A43,A44,A46;
   hence f.(|[x,y]|)=|[s,r]| by A1;
  end;
hence f is continuous by A7,A8,A33,A42,JGRAPH_2:45;
end;

theorem Th64: for cn being Real,
K0,B0 being Subset of TOP-REAL 2,f being
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0
st -1<cn & cn<1 & f=(cn-FanMorphN)|K0 &
B0={q where q is Point of TOP-REAL 2: q`2>=0 & q<>0.REAL 2}
& K0={p: p`1/|.p.|<=cn & p`2>=0 & p<>0.REAL 2}
holds f is continuous
proof let cn be Real,K0,B0 be Subset of TOP-REAL 2,f be
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0;
assume A1: -1<cn & cn<1 & f=(cn-FanMorphN)|K0 &
B0={q where q is Point of TOP-REAL 2: q`2>=0 & q<>0.REAL 2} &
K0={p: p`1/|.p.|<=cn & p`2>=0 & p<>0.REAL 2};
 set sn=sqrt(1-cn^2);
 set p0=|[cn,sn]|;
 A2: p0`1=cn by EUCLID:56;
 A3: p0`2=sn by EUCLID:56;
 cn^2<1^2 by A1,SQUARE_1:120;
 then A4: 1-cn^2>0 by XREAL_1:52;
 then A5: p0`2>0 by A3,SQUARE_1:93;
 A6: |.p0.|=sqrt((sn)^2+cn^2) by A2,A3,JGRAPH_3:10;
 sn^2=1-cn^2 by A4,SQUARE_1:def 4;
 then p0`1/|.p0.|=cn by A6,EUCLID:56,SQUARE_1:83;
 then A7: p0 in K0 by A1,A5,JGRAPH_2:11;
 then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
  A8: K0 c= B0
   proof let x be set;assume x in K0;
      then consider p8 being Point of TOP-REAL 2 such that
      A9: x=p8 & (
      p8`1/|.p8.|<=cn & p8`2>=0 & p8<>0.REAL 2) by A1;
    thus x in B0 by A1,A9;
   end;
A10:dom (proj1*((cn-FanMorphN)|K1)) c= dom ((cn-FanMorphN)|K1) by RELAT_1:44;
   dom ((cn-FanMorphN)|K1) c= dom (proj1*((cn-FanMorphN)|K1))
proof let x be set;assume A11:x in dom ((cn-FanMorphN)|K1);
   then A12:x in dom (cn-FanMorphN) /\ K1 by FUNCT_1:68;
   A13:((cn-FanMorphN)|K1).x=(cn-FanMorphN).x by A11,FUNCT_1:68;
   A14: dom proj1 = (the carrier of TOP-REAL 2) by FUNCT_2:def 1;
       x in dom (cn-FanMorphN) by A12,XBOOLE_0:def 3;
   then (cn-FanMorphN).x in rng (cn-FanMorphN) by FUNCT_1:12;
  hence x in dom (proj1*((cn-FanMorphN)|K1)) by A11,A13,A14,FUNCT_1:21;
end;
then A15:dom (proj1*((cn-FanMorphN)|K1))
=dom ((cn-FanMorphN)|K1) by A10,XBOOLE_0:def 10
.=dom (cn-FanMorphN) /\ K1 by FUNCT_1:68
.=(the carrier of TOP-REAL 2)/\ K1 by FUNCT_2:def 1
.=K1 by XBOOLE_1:28
.=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
A16:rng (proj1*((cn-FanMorphN)|K1)) c= rng proj1 by RELAT_1:45;
    rng proj1 c= the carrier of R^1 by TOPMETR:24;
then rng (proj1*((cn-FanMorphN)|K1)) c= the carrier of R^1 by A16,XBOOLE_1:1;
then reconsider g2=proj1*((cn-FanMorphN)|K1) as Function of (TOP-REAL 2)|K1,R^1
                                 by A15,FUNCT_2:4;
A17:dom (proj2*((cn-FanMorphN)|K1))
                     c= dom ((cn-FanMorphN)|K1) by RELAT_1:44;
   dom ((cn-FanMorphN)|K1) c= dom (proj2*((cn-FanMorphN)|K1))
proof let x be set;assume A18:x in dom ((cn-FanMorphN)|K1);
   then A19:x in dom (cn-FanMorphN) /\ K1 by FUNCT_1:68;
   A20:((cn-FanMorphN)|K1).x=(cn-FanMorphN).x by A18,FUNCT_1:68;
   A21: dom proj2 = (the carrier of TOP-REAL 2) by FUNCT_2:def 1;
       x in dom (cn-FanMorphN) by A19,XBOOLE_0:def 3;
   then (cn-FanMorphN).x in rng (cn-FanMorphN) by FUNCT_1:12;
  hence x in dom (proj2*((cn-FanMorphN)|K1)) by A18,A20,A21,FUNCT_1:21;
end;
then A22:dom (proj2*((cn-FanMorphN)|K1))
=dom ((cn-FanMorphN)|K1) by A17,XBOOLE_0:def 10
.=dom (cn-FanMorphN) /\ K1 by FUNCT_1:68
.=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
.=K1 by XBOOLE_1:28
.=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
A23:rng (proj2*((cn-FanMorphN)|K1)) c= rng proj2 by RELAT_1:45;
    rng proj2 c= the carrier of R^1 by TOPMETR:24;
then rng (proj2*((cn-FanMorphN)|K1)) c= the carrier of R^1 by A23,XBOOLE_1:1;
then reconsider g1=proj2*((cn-FanMorphN)|K1) as Function of (TOP-REAL 2)|K1,R^1
                                 by A22,FUNCT_2:4;
A24: for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`2>=0 & q<>0.REAL 2
   proof let q be Point of TOP-REAL 2;
    assume A25:q in the carrier of (TOP-REAL 2)|K1;
          the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     then consider p3 being Point of TOP-REAL 2 such that
     A26: q=p3 & (p3`1/|.p3.|<=cn & p3`2>=0 & p3<>0.REAL 2) by A1,A25;
    thus q`2>=0 & q<>0.REAL 2 by A26;
   end;
      for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g2.p=|.p.|* ((p`1/|.p.|-cn)/(1+cn))
   proof let p be Point of TOP-REAL 2;
    assume A27: p in the carrier of (TOP-REAL 2)|K1;
     A28:dom ((cn-FanMorphN)|K1)=dom (cn-FanMorphN) /\ K1 by FUNCT_1:68
     .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
     .=K1 by XBOOLE_1:28;
     A29:the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     then consider p3 being Point of TOP-REAL 2 such that
     A30: p=p3 & (p3`1/|.p3.|<=cn & p3`2>=0 & p3<>0.REAL 2) by A1,A27;
     A31:(cn-FanMorphN).p
     =|[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
       |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]| by A1,A30,Th58;
        ((cn-FanMorphN)|K1).p=(cn-FanMorphN).p by A27,A29,FUNCT_1:72;
     then g2.p=proj1.(|[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
        |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]|)
                             by A27,A28,A29,A31,FUNCT_1:23
      .=(|[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
       |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]|)`1 by PSCOMP_1:def 28
      .=|.p.|* ((p`1/|.p.|-cn)/(1+cn)) by EUCLID:56;
    hence g2.p=|.p.|* ((p`1/|.p.|-cn)/(1+cn));
   end;
then consider f2 being Function of (TOP-REAL 2)|K1,R^1 such that
  A32:for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds f2.p=|.p.|* ((p`1/|.p.|-cn)/(1+cn));
A33:f2 is continuous by A1,A24,A32,Th60;
      for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g1.p=|.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))
   proof let p be Point of TOP-REAL 2;
    assume A34: p in the carrier of (TOP-REAL 2)|K1;
     A35:dom ((cn-FanMorphN)|K1)=dom (cn-FanMorphN) /\ K1 by FUNCT_1:68
     .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
     .=K1 by XBOOLE_1:28;
     A36:the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     then consider p3 being Point of TOP-REAL 2 such that
     A37: p=p3 & (p3`1/|.p3.|<=cn & p3`2>=0 & p3<>0.REAL 2) by A1,A34;
     A38:(cn-FanMorphN).p=|[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
       |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]| by A1,A37,Th58;
        ((cn-FanMorphN)|K1).p=(cn-FanMorphN).p by A34,A36,FUNCT_1:72;
     then g1.p=proj2.(|[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
          |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]|)
                             by A34,A35,A36,A38,FUNCT_1:23
        .=(|[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
          |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]|)`2 by PSCOMP_1:def 29
        .= |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)) by EUCLID:56;
    hence g1.p=|.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2));
   end;
then consider f1 being Function of (TOP-REAL 2)|K1,R^1 such that
  A39:for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds f1.p=|.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2));
      for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`2>=0 & q`1/|.q.|<=cn & q<>0.REAL 2
   proof let q be Point of TOP-REAL 2;
    assume A40:q in the carrier of (TOP-REAL 2)|K1;
          the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     then consider p3 being Point of TOP-REAL 2 such that
     A41: q=p3 & (p3`1/|.p3.|<=cn & p3`2>=0 & p3<>0.REAL 2) by A1,A40;
    thus thesis by A41;
   end;
then A42:f1 is continuous by A1,A39,Th62;
    for x,y,s,r being real number st |[x,y]| in K1 &
  s=f2.(|[x,y]|) & r=f1.(|[x,y]|) holds f.(|[x,y]|)=|[s,r]|
  proof let x,y,s,r be real number;
   assume A43: |[x,y]| in K1 & s=f2.(|[x,y]|) & r=f1.(|[x,y]|);
     set p99=|[x,y]|;
     A44:the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     consider p3 being Point of TOP-REAL 2 such that
     A45: p99=p3 & (p3`1/|.p3.|<=cn & p3`2>=0 & p3<>0.REAL 2) by A1,A43;
     A46:f1.p99=|.p99.|*( sqrt(1-((p99`1/|.p99.|-cn)/(1+cn))^2))
                          by A39,A43,A44;
        ((cn-FanMorphN)|K0).(|[x,y]|)=((cn-FanMorphN)).(|[x,y]|) by A43,
FUNCT_1:72
    .= |[ |.p99.|* ((p99`1/|.p99.|-cn)/(1+cn)),
      |.p99.|*( sqrt(1-((p99`1/|.p99.|-cn)/(1+cn))^2))]| by A1,A45,Th58
    .=|[s,r]| by A32,A43,A44,A46;
   hence f.(|[x,y]|)=|[s,r]| by A1;
  end;
hence f is continuous by A7,A8,A33,A42,JGRAPH_2:45;
end;

theorem Th65: for cn being Real, K03 being Subset of TOP-REAL 2
 st K03={p: p`1>=(cn)*(|.p.|) & p`2>=0}
 holds K03 is closed
proof let sn be Real, K003 be Subset of TOP-REAL 2;
 assume A1: K003={p: p`1>=(sn)*(|.p.|) & p`2>=0};
 defpred P[Point of TOP-REAL 2] means ($1`1>=sn*|.$1.|);
  reconsider K1={p7 where p7 is Point of TOP-REAL 2:P[p7]}
  as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
  A2: K1 is closed by Lm10;
  defpred Q[Point of TOP-REAL 2] means $1`2>=0;
  reconsider KX={p where p is Point of TOP-REAL 2: Q[p]}
    as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
A3: KX is closed by JORDAN6:8;
       {p : P[p] & Q[p]}
    = {p7 where p7 is Point of TOP-REAL 2:P[p7]} /\
     {p1 where p1 is Point of TOP-REAL 2: Q[p1]} from DOMAIN_1:sch 10;
  hence thesis by A1,A2,A3,TOPS_1:35;
end;

theorem Th66: for cn being Real, K03 being Subset of TOP-REAL 2
 st K03={p: p`1<=(cn)*(|.p.|) & p`2>=0}
 holds K03 is closed
proof let sn be Real, K003 be Subset of TOP-REAL 2;
 assume A1: K003={p: p`1<=(sn)*(|.p.|) & p`2>=0};
 defpred P[Point of TOP-REAL 2] means ($1`1<=sn*|.$1.|);
  reconsider K1={p7 where p7 is Point of TOP-REAL 2:P[p7]}
  as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
  A2: K1 is closed by Lm12;
  defpred Q[Point of TOP-REAL 2] means $1`2>=0;
  reconsider KX={p where p is Point of TOP-REAL 2: Q[p]}
    as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
A3: KX is closed by JORDAN6:8;
       {p : P[p] & Q[p]}
    = {p7 where p7 is Point of TOP-REAL 2:P[p7]} /\
     {p1 where p1 is Point of TOP-REAL 2: Q[p1]} from DOMAIN_1:sch 10;
  hence thesis by A1,A2,A3,TOPS_1:35;
end;

theorem Th67: for cn being Real,
K0,B0 being Subset of TOP-REAL 2,f being
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0
st -1<cn & cn<1 & f=(cn-FanMorphN)|K0 &
B0=(the carrier of TOP-REAL 2) \ {0.REAL 2}
& K0={p: p`2>=0 & p<>0.REAL 2}
holds f is continuous
proof let cn be Real,K0,B0 be Subset of TOP-REAL 2,f be
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0;
assume A1: -1<cn & cn<1 & f=(cn-FanMorphN)|K0 &
B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} &
K0={p: p`2>=0 & p<>0.REAL 2};
 set sn=sqrt(1-cn^2);
 set p0=|[cn,sn]|;
 A2: p0`1=cn by EUCLID:56;
 A3: p0`2=sn by EUCLID:56;
       cn^2<1 by A1,SQUARE_1:120,59;
 then A4: 1-cn^2>0 by XREAL_1:52;
 then A5: p0<>0.REAL 2 by A3,JGRAPH_2:11,SQUARE_1:93;
 A6: p0`2>0 by A3,A4,SQUARE_1:93;
 A7: |.p0.|=sqrt((sn)^2+cn^2) by A2,A3,JGRAPH_3:10;
     sn^2=1-cn^2 by A4,SQUARE_1:def 4;
 then A8: p0`1/|.p0.|=cn by A7,EUCLID:56,SQUARE_1:83;
     p0 in K0 by A1,A6,JGRAPH_2:11;
 then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
      p0 in the carrier of TOP-REAL 2 & not p0 in {0.REAL 2}
               by A5,TARSKI:def 1;
  then reconsider D=B0 as non empty Subset of TOP-REAL 2 by A1,XBOOLE_0:def 4;
   A9: p0 in {p: p`1/|.p.|>=cn & p`2>=0 & p<>0.REAL 2} by A6,A8,JGRAPH_2:11;
   defpred P[Point of TOP-REAL 2] means
   $1`1/|.$1.|>=cn & $1`2>=0 & $1<>0.REAL 2;
   A10: {p: P[p]}
     is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
   A11: {p: p`1/|.p.|>=cn & p`2>=0 & p<>0.REAL 2} c= K1
    proof let x be set;assume x in
      {p: p`1/|.p.|>=cn & p`2>=0 & p<>0.REAL 2};
      then consider p such that
        A12:p=x & p`1/|.p.|>=cn & p`2>=0 & p<>0.REAL 2;
     thus x in K1 by A1,A12;
    end;
   then reconsider K00={p: p`1/|.p.|>=cn & p`2>=0 & p<>0.REAL 2}
      as non empty Subset of ((TOP-REAL 2)|K1)
                 by A9,PRE_TOPC:29;
   reconsider K001={p: p`1/|.p.|>=cn & p`2>=0 & p<>0.REAL 2}
            as non empty Subset of (TOP-REAL 2)
                       by A9,A10;
   defpred P[Point of TOP-REAL 2] means $1`1>=(cn)*(|.$1.|) & $1`2>=0;
       {p: P[p]} is Subset of
   TOP-REAL 2 from DOMAIN_1:sch 7;
   then reconsider K003={p: p`1>=(cn)*(|.p.|) & p`2>=0}
            as Subset of (TOP-REAL 2);
   A13: p0 in {p: p`1/|.p.|<=cn & p`2>=0 & p<>0.REAL 2} by A6,A8,JGRAPH_2:11;
   A14: {p: p`1/|.p.|<=cn & p`2>=0 & p<>0.REAL 2} c= K1
    proof let x be set;assume x in
      {p: p`1/|.p.|<=cn & p`2>=0 & p<>0.REAL 2};
      then consider p such that
        A15: p=x & p`1/|.p.|<=cn & p`2>=0 & p<>0.REAL 2;
     thus x in K1 by A1,A15;
    end;
   then reconsider K11={p: p`1/|.p.|<=cn & p`2>=0 & p<>0.REAL 2}
            as non empty Subset of ((TOP-REAL 2)|K1)
            by A13,PRE_TOPC:29;
    A16: p0 in {p: p`1/|.p.|<=cn & p`2>=0 & p<>0.REAL 2} by A6,A8,JGRAPH_2:11;
    defpred P[Point of TOP-REAL 2] means
    $1`1/|.$1.|<=cn & $1`2>=0 & $1<>0.REAL 2;
       {p: P[p]} is Subset of
   TOP-REAL 2 from DOMAIN_1:sch 7;
   then reconsider K111={p: p`1/|.p.|<=cn & p`2>=0 & p<>0.REAL 2}
            as non empty Subset of TOP-REAL 2 by A16;
    defpred P[Point of TOP-REAL 2] means $1`1<=cn*(|.$1.|) & $1`2>=0;
       {p: P[p]} is Subset of
   TOP-REAL 2 from DOMAIN_1:sch 7;
   then reconsider K004={p: p`1<=(cn)*(|.p.|) & p`2>=0}
            as Subset of (TOP-REAL 2);
      the carrier of (TOP-REAL 2)|B0=the carrier of (TOP-REAL 2)|D;
  then A17: dom f=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1
    .=K1 by PRE_TOPC:29;
  then A18: dom (f|K00)=K00 by A11,RELAT_1:91
  .= the carrier of ((TOP-REAL 2)|K1)|K00 by PRE_TOPC:29;
  A19: the carrier of (TOP-REAL 2)|D =D by PRE_TOPC:29;
  rng (f|K00) c=D by A19;
  then reconsider f1=f|K00 as Function of ((TOP-REAL 2)|K1)|K00,(TOP-REAL 2)|D
                            by A18,FUNCT_2:4;
  A20: dom f1=the carrier of ((TOP-REAL 2)|K1)|K00 by FUNCT_2:def 1
  .=K00 by PRE_TOPC:29;
  A21: dom (cn-FanMorphN)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
  then A22: dom ((cn-FanMorphN)|K001)=K001 by RELAT_1:91
  .= the carrier of (TOP-REAL 2)|K001 by PRE_TOPC:29;
  A23: the carrier of (TOP-REAL 2)|K1 = K1 by PRE_TOPC:29;
      rng ((cn-FanMorphN)|K001) c= K1
   proof let y be set;assume y in rng ((cn-FanMorphN)|K001);
     then consider x being set such that
     A24: x in dom ((cn-FanMorphN)|K001) & y=((cn-FanMorphN)|K001).x
        by FUNCT_1:def 5;
     A25: dom ((cn-FanMorphN)|K001)=(dom (cn-FanMorphN))/\ K001 by FUNCT_1:68
     .=(the carrier of TOP-REAL 2)/\ K001 by FUNCT_2:def 1
     .=K001 by XBOOLE_1:28;
     reconsider q=x as Point of TOP-REAL 2 by A24;
     A26: y=(cn-FanMorphN).q by A24,FUNCT_1:70;
     consider p2 being Point of TOP-REAL 2 such that
     A27: p2=q & p2`1/|.p2.|>=cn & p2`2>=0 & p2<>0.REAL 2 by A24,A25;
     A28: cn-FanMorphN.q= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
        |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by A1,A27,Th58;
     set q4= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
        |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]|;
         |.q.|<>0 by A27,TOPRNS_1:25;
     then A29: (|.q.|)^2>0 by SQUARE_1:74;
     A30: 1-cn>0 by A1,XREAL_1:151;
        A31: q4`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))&
        q4`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by EUCLID:56;
        A32: (q`1/|.q.|-cn)>= 0 by A27,XREAL_1:50;
            0<=(q`2)^2 by XREAL_1:65;
        then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`1)^2 <= (|.q.|)^2 by JGRAPH_3:10;
        then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A29,REAL_1:73;
        then (q`1)^2/(|.q.|)^2 <= 1 by A29,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then 1>=q`1/|.q.| by Lm2;
        then A33: 1-cn>=q`1/|.q.|-cn by XREAL_1:11;
        A34: -(1-cn)<= -0 by A30,XREAL_1:26;
             -(1-cn)<= -( q`1/|.q.|-cn) by A33,XREAL_1:26;
         then (-(1-cn))/(1-cn)<=(-( q`1/|.q.|-cn))/(1-cn)
                        by A30,REAL_1:73;
        then A35: -1<=(-( q`1/|.q.|-cn))/(1-cn) by A30,XCMPLX_1:198;
           --(1-cn)>= -(q`1/|.q.|-cn) by A32,A34,XREAL_1:26;
       then (-(q`1/|.q.|-cn))/(1-cn)<=1 by A30,REAL_2:117;
       then ((-(q`1/|.q.|-cn))/(1-cn))^2<=1 by A35,SQUARE_1:119,59;
       then A36: 1-((-(q`1/|.q.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
       then 1-(-((q`1/|.q.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
       then A37: 1-((q`1/|.q.|-cn)/(1-cn))^2>=0;
           sqrt(1-((-(q`1/|.q.|-cn))/(1-cn))^2)>=0 by A36,SQUARE_1:def 4;
       then sqrt(1-(-(q`1/|.q.|-cn))^2/(1-cn)^2)>=0 by XCMPLX_1:77;
       then sqrt(1-(q`1/|.q.|-cn)^2/(1-cn)^2)>=0;
       then A38: sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)>=0 by XCMPLX_1:77;
        A39: (q4`2)^2= (|.q.|)^2*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))^2
                         by A31
         .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1-cn))^2) by A37,SQUARE_1:def 4;
        A40: (q4`1)^2= (|.q.|)^2*((q`1/|.q.|-cn)/(1-cn))^2
                         by A31;
            (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
        .=(|.q.|)^2 by A39,A40;
     then q4`2>=0 & q4<>0.REAL 2 by A29,A31,A38,XREAL_1:129,SQUARE_1:
60,TOPRNS_1:24;
    hence y in K1 by A1,A26,A28;
   end;
  then reconsider f3=(cn-FanMorphN)|K001
   as Function of (TOP-REAL 2)|K001,(TOP-REAL 2)|K1  by A22,A23,FUNCT_2:4;
  A41: dom (f|K11)=K11 by A14,A17,RELAT_1:91
  .= the carrier of ((TOP-REAL 2)|K1)|K11 by PRE_TOPC:29;
  A42: the carrier of (TOP-REAL 2)|D =D by PRE_TOPC:29;
  rng (f|K11) c=D by A42;
  then reconsider f2=f|K11 as Function of ((TOP-REAL 2)|K1)|K11,(TOP-REAL 2)|D
                    by A41,FUNCT_2:4;
  A43: dom f2=the carrier of ((TOP-REAL 2)|K1)|K11 by FUNCT_2:def 1
  .=K11 by PRE_TOPC:29;
  A44: dom ((cn-FanMorphN)|K111)=K111 by A21,RELAT_1:91
  .= the carrier of (TOP-REAL 2)|K111 by PRE_TOPC:29;
  A45: the carrier of (TOP-REAL 2)|K1 =K1 by PRE_TOPC:29;
      rng ((cn-FanMorphN)|K111) c= K1
   proof let y be set;assume y in rng ((cn-FanMorphN)|K111);
     then consider x being set such that
     A46: x in dom ((cn-FanMorphN)|K111) & y=((cn-FanMorphN)|K111).x
        by FUNCT_1:def 5;
     A47: dom ((cn-FanMorphN)|K111)=(dom (cn-FanMorphN))/\ K111 by FUNCT_1:68
     .=(the carrier of TOP-REAL 2)/\ K111 by FUNCT_2:def 1
     .=K111 by XBOOLE_1:28;
     reconsider q=x as Point of TOP-REAL 2 by A46;
     A48: y=(cn-FanMorphN).q by A46,FUNCT_1:70;
     consider p2 being Point of TOP-REAL 2 such that
     A49: p2=q & p2`1/|.p2.|<=cn & p2`2>=0 & p2<>0.REAL 2 by A46,A47;
     A50: cn-FanMorphN.q= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
        |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]| by A1,A49,Th58;
     set q4= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
       |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]|;
         |.q.|<>0 by A49,TOPRNS_1:25;
     then A51: (|.q.|)^2>0 by SQUARE_1:74;
   A52: 1+cn>0 by A1,XREAL_1:150;
        A53: q4`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))&
        q4`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by EUCLID:56;
        A54: (q`1/|.q.|-cn)<=0 by A49,REAL_2:106;
        A55: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        0<=(q`2)^2 by XREAL_1:65;
        then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A51,A55,REAL_1:73;
        then (q`1)^2/(|.q.|)^2 <= 1 by A51,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then -1<=q`1/|.q.| by Lm2;
        then A56: -1-cn<=q`1/|.q.|-cn by XREAL_1:11;
           (1+cn)/(1+cn)>=(q`1/|.q.|-cn)/(1+cn) by A52,A54,REAL_1:73;
        then A57: 1>=(q`1/|.q.|-cn)/(1+cn) by A52,XCMPLX_1:60;
             (-(1+cn))/(1+cn)<=(( q`1/|.q.|-cn))/(1+cn)
                        by A52,A56,REAL_1:73;
        then -1<=(( q`1/|.q.|-cn))/(1+cn)
                        by A52,XCMPLX_1:198;
       then (((q`1/|.q.|-cn))/(1+cn))^2<=1^2 by A57,SQUARE_1:119;
       then A58: 1-((q`1/|.q.|-cn)/(1+cn))^2>=0 by XREAL_1:50;
       then 1-(-((q`1/|.q.|-cn)/(1+cn)))^2>=0;
       then 1-((-(q`1/|.q.|-cn))/(1+cn))^2>=0 by XCMPLX_1:188;
       then sqrt(1-((-(q`1/|.q.|-cn))/(1+cn))^2)>=0 by SQUARE_1:def 4;
       then sqrt(1-(-(q`1/|.q.|-cn))^2/(1+cn)^2)>=0 by XCMPLX_1:77;
       then sqrt(1-(q`1/|.q.|-cn)^2/(1+cn)^2)>=0;
       then sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)>=0 by XCMPLX_1:77;
       then A59: q4`2>= 0 by A53,XREAL_1:129;
        A60: (q4`2)^2= (|.q.|)^2*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))^2
                         by A53
         .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1+cn))^2) by A58,SQUARE_1:def 4;
        A61: (q4`1)^2= (|.q.|)^2*((q`1/|.q.|-cn)/(1+cn))^2
                         by A53;
            (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
        .=(|.q.|)^2 by A60,A61;
        then q4<>0.REAL 2 by A51,SQUARE_1:60,TOPRNS_1:24;
    hence y in K1 by A1,A48,A50,A59;
   end;
  then reconsider f4=(cn-FanMorphN)|K111
   as Function of (TOP-REAL 2)|K111,(TOP-REAL 2)|K1  by A44,A45,FUNCT_2:4;
  set T1= ((TOP-REAL 2)|K1)|K00,T2=((TOP-REAL 2)|K1)|K11;
  A62: [#](((TOP-REAL 2)|K1)|K00)=K00 by PRE_TOPC:def 10;
  A63: [#](((TOP-REAL 2)|K1)|K11)=K11 by PRE_TOPC:def 10;
  A64: [#]((TOP-REAL 2)|K1)=K1 by PRE_TOPC:def 10;
  A65: K1 c= K00 \/ K11
   proof let x be set;assume x in K1;
     then consider p such that
     A66: p=x & (p`2>=0 & p<>0.REAL 2) by A1;
     per cases;
     suppose p`1/|.p.|>=cn;
       then x in K00 by A66;
      hence x in K00 \/ K11 by XBOOLE_0:def 2;
     end;
     suppose p`1/|.p.|<cn;
      then x in K11 by A66;
      hence x in K00 \/ K11 by XBOOLE_0:def 2;
     end;
   end;
  then A67: [#](((TOP-REAL 2)|K1)|K00) \/ [#](((TOP-REAL 2)|K1)|K11)
        =[#]((TOP-REAL 2)|K1) by A62,A63,A64,XBOOLE_0:def 10;
  A68: K003 is closed by Th65;
  A69: K003 /\ K1 c= K00
   proof let x be set;assume x in K003 /\ K1;
     then A70: x in K003 & x in K1 by XBOOLE_0:def 3;
     then consider q1 being Point of TOP-REAL 2 such that
     A71: q1=x & q1`1>=(cn)*(|.q1.|) & q1`2>=0;
     consider q2 being Point of TOP-REAL 2 such that
     A72: q2=x & q2`2>=0 & q2<>0.REAL 2 by A1,A70;
     A73: |.q2.|<>0 by A72,TOPRNS_1:25;
         |.q1.|>0 by A71,A72,Lm1;
     then q1`1/|.q1.|>=(cn)*(|.q1.|)/|.q1.| by A71,REAL_1:73;
     then q1`1/|.q1.|>=(cn) by A71,A72,A73,XCMPLX_1:90;
    hence x in K00 by A71,A72;
   end;
   K00 c= K003 /\ K1
   proof let x be set;assume x in K00;
     then consider p such that
     A74: p=x & (p`1/|.p.|>=cn & p`2>=0 & p<>0.REAL 2);
     A75: |.p.|<>0 by A74,TOPRNS_1:25;
     p`1/|.p.|*|.p.|>=(cn)*(|.p.|) by A74,XREAL_1:66;
     then p`1>=(cn)*(|.p.|) by A75,XCMPLX_1:88;
     then A76: x in K003 by A74;
     x in K1 by A1,A74;
    hence x in K003 /\ K1 by A76,XBOOLE_0:def 3;
   end;
  then K00=K003 /\ [#]((TOP-REAL 2)|K1) by A64,A69,XBOOLE_0:def 10;
  then A77: K00 is closed by A68,PRE_TOPC:43;
  A78: K004 is closed by Th66;
  A79: K004 /\ K1 c= K11
   proof let x be set;assume x in K004 /\ K1;
     then A80: x in K004 & x in K1 by XBOOLE_0:def 3;
     then consider q1 being Point of TOP-REAL 2 such that
     A81: q1=x & q1`1<=(cn)*(|.q1.|) & q1`2>=0;
     consider q2 being Point of TOP-REAL 2 such that
     A82: q2=x & q2`2>=0 & q2<>0.REAL 2 by A1,A80;
     A83: |.q2.|<>0 by A82,TOPRNS_1:25;
     |.q1.|>0 by A81,A82,Lm1;
     then q1`1/|.q1.|<=(cn)*(|.q1.|)/|.q1.| by A81,REAL_1:73;
     then q1`1/|.q1.|<=(cn) by A81,A82,A83,XCMPLX_1:90;
    hence x in K11 by A81,A82;
   end;
   K11 c= K004 /\ K1
   proof let x be set;assume x in K11;
     then consider p such that
     A84: p=x & (p`1/|.p.|<=cn & p`2>=0 & p<>0.REAL 2);
     A85: |.p.|<>0 by A84,TOPRNS_1:25;
     p`1/|.p.|*|.p.|<=(cn)*(|.p.|) by A84,XREAL_1:66;
     then p`1<=(cn)*(|.p.|) by A85,XCMPLX_1:88;
     then A86: x in K004 by A84;
     x in K1 by A1,A84;
    hence x in K004 /\ K1 by A86,XBOOLE_0:def 3;
   end;
  then K11=K004 /\ [#]((TOP-REAL 2)|K1) by A64,A79,XBOOLE_0:def 10;
  then A87: K11 is closed by A78,PRE_TOPC:43;
  A88: ((TOP-REAL 2)|K1)|K00=(TOP-REAL 2)|K001 by GOBOARD9:4;
      K1 c= D
   proof let x be set;assume x in K1;
     then consider p6 being Point of TOP-REAL 2 such that
     A89: p6=x & p6`2>=0 & p6<>0.REAL 2 by A1;
         x in the carrier of TOP-REAL 2 & not x in {0.REAL 2} by A89,
TARSKI:def 1
;
    hence x in D by A1,XBOOLE_0:def 4;
   end;
  then D=K1 \/ D by XBOOLE_1:12;
  then A90: (TOP-REAL 2)|K1 is SubSpace of (TOP-REAL 2)|D by TOPMETR:5;
  the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
  then A91: f1= f3 by A1,FUNCT_1:82;
  f3 is continuous by A1,Th63;
  then A92: f1 is continuous by A88,A90,A91,TOPMETR:7;
  A93: ((TOP-REAL 2)|K1)|K11=(TOP-REAL 2)|K111 by GOBOARD9:4;
  the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
  then A94: f2= f4 by A1,FUNCT_1:82;
  f4 is continuous by A1,Th64;
  then A95: f2 is continuous by A90,A93,A94,TOPMETR:7;
  A96: D<>{};
  A97: the carrier of (TOP-REAL 2)|B0=B0 by PRE_TOPC:29;
  for p being set st p in ([#]T1)/\([#]T2) holds f1.p = f2.p
   proof let p be set;
    assume p in ([#]T1)/\([#]T2);
     then A98: p in K00 & p in K11 by A62,A63,XBOOLE_0:def 3;
    hence f1.p=f.p by FUNCT_1:72 .=f2.p by A98,FUNCT_1:72;
   end;
  then consider h being Function of (TOP-REAL 2)|K1,(TOP-REAL 2)|D
  such that
  A99: h=f1+*f2 & h is continuous by A62,A63,A67,A77,A87,A92,A95,JGRAPH_2:9;
  A100: dom h=the carrier of ((TOP-REAL 2)|K1) by FUNCT_2:def 1;
  A101: the carrier of ((TOP-REAL 2)|K1)=K0 by PRE_TOPC:29;
  A102: K0=the carrier of ((TOP-REAL 2)|K0) by PRE_TOPC:29
  .=dom f by A96,A97,FUNCT_2:def 1;
  for y being set st y in dom h holds h.y=f.y
   proof let y be set;assume
    A103: y in dom h;
    per cases by A65,A100,A101,A103,XBOOLE_0:def 2;
    suppose A104: y in K00 & not y in K11;
      then y in dom f1 \/ dom f2 by A20,XBOOLE_0:def 2;
     hence h.y=f1.y by A43,A99,A104,FUNCT_4:def 1 .=f.y by A104,FUNCT_1:72;
    end;
    suppose A105: y in K11;
      then y in dom f1 \/ dom f2 by A43,XBOOLE_0:def 2;
     hence h.y=f2.y by A43,A99,A105,FUNCT_4:def 1 .=f.y by A105,FUNCT_1:72;
    end;
   end;
 hence thesis by A99,A100,A101,A102,FUNCT_1:9;
end;

theorem Th68: for cn being Real,
K0,B0 being Subset of TOP-REAL 2,f being
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0
st -1<cn & cn<1 & f=(cn-FanMorphN)|K0 &
B0=(the carrier of TOP-REAL 2) \ {0.REAL 2}
& K0={p: p`2<=0 & p<>0.REAL 2}
holds f is continuous
proof let cn be Real,K0,B0 be Subset of TOP-REAL 2,f be
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0;
assume A1:  -1<cn & cn<1 & f=(cn-FanMorphN)|K0 &
B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} &
K0={p: p`2<=0 & p<>0.REAL 2};
 set sn=sqrt(1-cn^2);
 set p0=|[cn,-sn]|;
 A2: p0`2=-sn by EUCLID:56;
 cn^2<1^2 by A1,SQUARE_1:120;
 then 1-cn^2>0 by XREAL_1:52;
 then --sn>0 by SQUARE_1:93;
 then A3: p0`2<0 by A2,XREAL_1:60;
 then p0 in K0 by A1,JGRAPH_2:11;
then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
     p0 in the carrier of TOP-REAL 2 & not p0 in {0.REAL 2}
               by A3,JGRAPH_2:11,TARSKI:def 1;
  then reconsider D=B0 as non empty Subset of TOP-REAL 2 by A1,XBOOLE_0:def 4;
   A4: K1 c= D
    proof let x be set;assume x in K1;
      then consider p2 being Point of TOP-REAL 2 such that
      A5: p2=x & p2`2<=0 & p2<>0.REAL 2 by A1;
          not p2 in {0.REAL 2} by A5,TARSKI:def 1;
     hence x in D by A1,A5,XBOOLE_0:def 4;
    end;
    for p being Point of (TOP-REAL 2)|K1,V being Subset of (TOP-REAL 2)|D
      st f.p in V & V is open holds
      ex W being Subset of (TOP-REAL 2)|K1 st
      p in W & W is open & f.:W c= V
    proof let p be Point of (TOP-REAL 2)|K1,V be Subset of (TOP-REAL 2)|D;
      assume A6: f.p in V & V is open;
      then consider V2 being Subset of TOP-REAL 2 such that
      A7: V2 is open & V2 /\ [#]((TOP-REAL 2)|D)=V by TOPS_2:32;
      A8: p in the carrier of (TOP-REAL 2)|K1;
      A9: [#]((TOP-REAL 2)|K1)=K1 by PRE_TOPC:def 10;
      reconsider W2=V2 /\ [#]((TOP-REAL 2)|K1) as Subset of (TOP-REAL 2)|
K1;
      A10: W2 is open by A7,TOPS_2:32;
      A11: f.p=(cn-FanMorphN).p by A1,A9,FUNCT_1:72;
      consider q being Point of TOP-REAL 2 such that
      A12: q=p & q`2<=0 & q <>0.REAL 2 by A1,A8,A9;
      (cn-FanMorphN).q=q by A12,Th56;
      then p in V2 & p in [#]((TOP-REAL 2)|D)
        by A6,A7,A11,A12,XBOOLE_0:def 3;
      then A13: p in W2 by XBOOLE_0:def 3;
      f.:W2 c= V
       proof let y be set;assume y in f.:W2;
         then consider x being set such that
         A14: x in dom f & x in W2 & y=f.x by FUNCT_1:def 12;
             f is Function of (TOP-REAL 2)|K1, (TOP-REAL 2)|D;
         then dom f= K1 by A9,FUNCT_2:def 1;
         then consider p4 being Point of TOP-REAL 2 such that
         A15: x=p4 & p4`2<=0 & p4<>0.REAL 2 by A1,A14;
         A16: f.p4=(cn-FanMorphN).p4 by A1,A9,A14,A15,FUNCT_1:72
         .=p4 by A15,Th56;
         A17: p4 in V2 & p4 in [#]((TOP-REAL 2)|K1) by A14,A15,XBOOLE_0:def 3
;
         then p4 in D by A4,A9;
         then p4 in [#]((TOP-REAL 2)|D) by PRE_TOPC:def 10;
        hence y in V by A7,A14,A15,A16,A17,XBOOLE_0:def 3;
       end;
     hence ex W being Subset of (TOP-REAL 2)|K1 st
      p in W & W is open & f.:W c= V by A10,A13;
    end;
  hence f is continuous by JGRAPH_2:20;
end;

theorem Th69:
 for B0 being Subset of TOP-REAL 2,
     K0 being Subset of (TOP-REAL 2)|B0
st B0=(the carrier of TOP-REAL 2) \ {0.REAL 2}
& K0={p: p`2>=0 & p<>0.REAL 2} holds K0 is closed
proof
 defpred P[Point of TOP-REAL 2] means $1`2>=0;
 set I1 = {p: P[p] & p<>0.REAL 2};
 set J0 = (the carrier of TOP-REAL 2) \ {0.REAL 2};
 let B0 be Subset of TOP-REAL 2,K0 be Subset of (TOP-REAL 2)|B0;
 assume A1: B0=J0 & K0=I1;
  reconsider K1={p7 where p7 is Point of TOP-REAL 2:P[p7]}
    as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
  A2:K1 is closed by JORDAN6:8;
  I1 = {p7 where p7 is Point of TOP-REAL 2 : P[p7]} /\ J0
    from JGRAPH_3:sch 2;
  then K0=K1 /\ [#]((TOP-REAL 2)|B0) by A1,PRE_TOPC:def 10;
hence K0 is closed by A2,PRE_TOPC:43;
end;

theorem Th70:
 for B0 being Subset of TOP-REAL 2,
     K0 being Subset of (TOP-REAL 2)|B0
st B0=(the carrier of TOP-REAL 2) \ {0.REAL 2}
& K0={p: p`2<=0 & p<>0.REAL 2} holds K0 is closed
proof
defpred P[Point of TOP-REAL 2] means $1`2<=0;
 set I1 = {p: P[p] & p<>0.REAL 2};
 set J0 = (the carrier of TOP-REAL 2) \ {0.REAL 2};
 let B0 be Subset of TOP-REAL 2,K0 be Subset of (TOP-REAL 2)|B0;
 assume A1: B0=J0 & K0=I1;
  reconsider K1={p7 where p7 is Point of TOP-REAL 2:P[p7]}
    as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
  A2:K1 is closed by JORDAN6:9;
      I1 = {p7 where p7 is Point of TOP-REAL 2 : P[p7]} /\ J0
    from JGRAPH_3:sch 2;
  then K0=K1 /\ [#]((TOP-REAL 2)|B0) by A1,PRE_TOPC:def 10;
hence K0 is closed by A2,PRE_TOPC:43;
end;

theorem Th71: for cn being Real,
 B0 being Subset of TOP-REAL 2,K0 being Subset of
(TOP-REAL 2)|B0,f being Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0)
st -1<cn & cn<1 & f=(cn-FanMorphN)|K0 &
B0=(the carrier of TOP-REAL 2) \ {0.REAL 2}
& K0={p: p`2>=0 & p<>0.REAL 2}
holds f is continuous
proof let cn be Real, B0 be Subset of TOP-REAL 2,K0 be Subset of
(TOP-REAL 2)|B0,f be Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0);
assume A1:  -1<cn & cn<1 & f=(cn-FanMorphN)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2}
   & K0={p: p`2>=0 & p<>0.REAL 2 };
      the carrier of (TOP-REAL 2)|B0= B0 by PRE_TOPC:29;
  then reconsider K1=K0 as Subset of TOP-REAL 2 by XBOOLE_1:1;
   K0 c= B0
   proof let x be set;assume x in K0;
    then consider p8 being Point of TOP-REAL 2 such that
A2: x=p8 & (p8`2>=0 & p8<>0.REAL 2) by A1;
    not x in {0.REAL 2} by A2,TARSKI:def 1;
    hence x in B0 by A1,A2,XBOOLE_0:def 4;
   end;
  then ((TOP-REAL 2)|B0)|K0=(TOP-REAL 2)|K1 by PRE_TOPC:28;
hence thesis by A1,Th67;
end;

theorem Th72: for cn being Real,
 B0 being Subset of TOP-REAL 2,K0 being Subset of
(TOP-REAL 2)|B0,f being Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0)
st -1<cn & cn<1 & f=(cn-FanMorphN)|K0 &
B0=(the carrier of TOP-REAL 2) \ {0.REAL 2}
& K0={p: p`2<=0 & p<>0.REAL 2}
holds f is continuous
proof let cn be Real, B0 be Subset of TOP-REAL 2,
  K0 be Subset of
(TOP-REAL 2)|B0,f be Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0);
 assume A1:  -1<cn & cn<1 & f=(cn-FanMorphN)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2}
  & K0={p: p`2<=0 & p<>0.REAL 2};
      the carrier of (TOP-REAL 2)|B0= B0 by PRE_TOPC:29;
  then reconsider K1=K0 as Subset of TOP-REAL 2 by XBOOLE_1:1;
   K0 c= B0
   proof let x be set;assume x in K0;
    then consider p8 being Point of TOP-REAL 2 such that
A2: x=p8 & (p8`2<=0 & p8<>0.REAL 2) by A1;
    not x in {0.REAL 2} by A2,TARSKI:def 1;
    hence x in B0 by A1,A2,XBOOLE_0:def 4;
   end;
  then ((TOP-REAL 2)|B0)|K0=(TOP-REAL 2)|K1 by PRE_TOPC:28;
hence thesis by A1,Th68;
end;

theorem Th73: for cn being Real,p being Point of TOP-REAL 2
holds |.(cn-FanMorphN).p.|=|.p.|
proof let cn be Real,p be Point of TOP-REAL 2;
  set f=cn-FanMorphN;
  set z=f.p;
  reconsider q=p as Point of TOP-REAL 2;
  reconsider qz=z as Point of TOP-REAL 2;
  per cases;
  suppose A1: q`1/|.q.|>=cn & q`2>0;
    then (cn-FanMorphN).q= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
    |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by Th56;
    then A2: qz`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))&
      qz`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by EUCLID:56;
    |.q.|<>0 by A1,JGRAPH_2:11,TOPRNS_1:25;
    then A3: (|.q.|)^2>0 by SQUARE_1:74;
A4: (q`1/|.q.|-cn)>=0 by A1,XREAL_1:50;
A5: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
    0<=(q`2)^2 by XREAL_1:65;
    then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
    then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A3,A5,REAL_1:73;
    then (q`1)^2/(|.q.|)^2 <= 1 by A3,XCMPLX_1:60;
    then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
    then 1>=q`1/|.q.| by Lm2;
    then A6: 1-cn>=q`1/|.q.|-cn by XREAL_1:11;
    per cases;
    suppose A7: 1-cn=0;
A8:   ((q`1/|.q.|-cn)/(1-cn))=(q`1/|.q.|-cn)*(1-cn)" by XCMPLX_0:def 9
       .= (q`1/|.q.|-cn)*0 by A7,XCMPLX_0:def 7 .=0;
      then 1-((q`1/|.q.|-cn)/(1-cn))^2=1;
      then (cn-FanMorphN).q= |[ |.q.|*0,|.q.|*1]| by A1,A8,Th56,
SQUARE_1:83
      .=|[0,(|.q.|)]|;
       then ((cn-FanMorphN).q)`2=(|.q.|) & ((cn-FanMorphN).q)`1=0
                        by EUCLID:56;
      then |.(cn-FanMorphN).p.|=sqrt(((|.q.|))^2+0) by JGRAPH_3:10
,SQUARE_1:60
      .=|.q.| by SQUARE_1:89;
     hence |.(cn-FanMorphN).p.|=|.p.|;
    end;
    suppose A9: 1-cn<>0;
    per cases by A9;
      suppose A10: 1-cn>0;
        then A11: -(1-cn)<= -0 by XREAL_1:26;
            -(1-cn)<= -( q`1/|.q.|-cn) by A6,XREAL_1:26;
        then (-(1-cn))/(1-cn)<=(-( q`1/|.q.|-cn))/(1-cn)
                  by A10,REAL_1:73;
        then A12: -1<=(-( q`1/|.q.|-cn))/(1-cn) by A10,XCMPLX_1:198;
           --(1-cn)>= -(q`1/|.q.|-cn) by A4,A11,XREAL_1:26;
        then (-(q`1/|.q.|-cn))/(1-cn)<=1 by A10,REAL_2:117;
        then ((-(q`1/|.q.|-cn))/(1-cn))^2<=1^2 by A12,SQUARE_1:119;
        then 1-((-(q`1/|.q.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
        then 1-(-((q`1/|.q.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
        then A13: 1-((q`1/|.q.|-cn)/(1-cn))^2>=0;
        A14: (qz`2)^2= (|.q.|)^2*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))^2
                   by A2
            .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1-cn))^2)
                      by A13,SQUARE_1:def 4;
        A15: (qz`1)^2= (|.q.|)^2*((q`1/|.q.|-cn)/(1-cn))^2
                   by A2;
            (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
         .=(|.q.|)^2 by A14,A15;
        then A16: sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
       thus |.(cn-FanMorphN).p.|=|.p.| by A16,SQUARE_1:89;
      end;
      suppose A17: 1-cn<0;
        A18: q`1/|.q.|-cn>=0 by A1,XREAL_1:50;
            0<(q`2)^2 by A1,SQUARE_1:74;
        then 0+(q`1)^2<(q`1)^2+(q`2)^2 by XREAL_1:10;
        then (q`1)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A3,A5,REAL_1:73;
        then (q`1)^2/(|.q.|)^2 < 1 by A3,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 < 1 by XCMPLX_1:77;
        then 1 > q`1/|.p.| by Lm3;
       hence |.(cn-FanMorphN).p.|=|.p.| by A17,A18,XREAL_1:11;
      end;
    end;
  end;
  suppose A19: q`1/|.q.|<cn & q`2>0;
    then A20:(cn-FanMorphN).q= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
    |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]| by Th57;
    then A21: qz`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))&
            qz`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by EUCLID:56;
    |.q.|<>0 by A19,JGRAPH_2:11,TOPRNS_1:25;
    then A22: (|.q.|)^2>0 by SQUARE_1:74;
A23: (q`1/|.q.|-cn)<0 by A19,REAL_2:105;
    A24: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        0<=(q`2)^2 by XREAL_1:65;
    then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
    then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A22,A24,REAL_1:73;
    then (q`1)^2/(|.q.|)^2 <= 1 by A22,XCMPLX_1:60;
    then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
    then -1<=q`1/|.q.| by Lm2;
    then A25: -1-cn<=q`1/|.q.|-cn by XREAL_1:11;
    per cases;
    suppose A26: 1+cn=0;
         ((q`1/|.q.|-cn)/(1+cn))=(q`1/|.q.|-cn)*(1+cn)" by XCMPLX_0:def 9
       .= (q`1/|.q.|-cn)*0 by A26,XCMPLX_0:def 7 .=0;
       then ((cn-FanMorphN).q)`2=(|.q.|) & ((cn-FanMorphN).q)`1=0
                        by A20,EUCLID:56,SQUARE_1:83;
      then |.(cn-FanMorphN).p.|=sqrt(((|.q.|))^2+0) by JGRAPH_3:10
,SQUARE_1:60
      .=|.q.| by SQUARE_1:89;
     hence |.(cn-FanMorphN).p.|=|.p.|;
    end;
    suppose A27: 1+cn<>0;
      per cases by A27;
      suppose A28: 1+cn>0;
        then (-(1+cn))/(1+cn)<=(( q`1/|.q.|-cn))/(1+cn)
          by A25,REAL_1:73;
        then A29: -1<=(( q`1/|.q.|-cn))/(1+cn) by A28,XCMPLX_1:198;
        ((q`1/|.q.|-cn))/(1+cn)<=1 by A28,A23,REAL_2:117;
        then (((q`1/|.q.|-cn))/(1+cn))^2<=1 by A29,SQUARE_1:119,59;
        then A30: 1-(((q`1/|.q.|-cn))/(1+cn))^2>=0 by XREAL_1:50;
        A31: (qz`2)^2= (|.q.|)^2*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))^2
                  by A21
            .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1+cn))^2)
                  by A30,SQUARE_1:def 4;
        A32: (qz`1)^2= (|.q.|)^2*((q`1/|.q.|-cn)/(1+cn))^2
                  by A21;
            (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
         .=(|.q.|)^2 by A31,A32;
        then A33: sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
       thus |.(cn-FanMorphN).p.|=|.p.| by A33,SQUARE_1:89;
      end;
      suppose 1+cn<0;
        then A34: -(1+cn)>-0 by XREAL_1:26;
        0<(q`2)^2 by A19,SQUARE_1:74;
        then 0+(q`1)^2<(q`1)^2+(q`2)^2 by XREAL_1:10;
        then (q`1)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A22,A24,REAL_1:73;
        then (q`1)^2/(|.q.|)^2 < 1 by A22,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 < 1 by XCMPLX_1:77;
        then -1 < q`1/|.p.| by Lm3;
        then q`1/|.q.|-cn>-1-cn by XREAL_1:11;
       hence |.(cn-FanMorphN).p.|=|.p.| by A23,A34;
      end;
    end;
    end;
  suppose q`2<=0;
   hence |.(cn-FanMorphN).p.|=|.p.| by Th56;
  end;
end;

theorem Th74: for cn being Real,x,K0 being set
 st -1<cn & cn<1 & x in K0 &
 K0={p: p`2>=0 & p<>0.REAL 2}
holds (cn-FanMorphN).x in K0
proof let cn be Real,x,K0 be set;
 assume A1:  -1<cn & cn<1 & x in K0 & K0={p: p`2>=0 & p<>0.REAL 2};
  then consider p such that
  A2: p=x & p`2>=0 & p<>0.REAL 2;
  A3:now assume |.p.|<=0;
    then |.p.|=0;
   hence contradiction by A2,TOPRNS_1:25;
  end;
  then A4: (|.p.|)^2>0 by SQUARE_1:74;
  per cases;
  suppose A5: p`1/|.p.|<=cn;
   then A6: (cn-FanMorphN).p= |[ |.p.|*((p`1/|.p.|-cn)/(1+cn)),
   |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]| by A1,A2,Th58;
   reconsider p9= (cn-FanMorphN).p as Point of TOP-REAL 2;
A7: p9`2=|.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)) by A6,EUCLID:56;
A8: 1+cn>0 by A1,XREAL_1:150;
A9: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
    per cases;
    suppose p`2=0;
     hence (cn-FanMorphN).x in K0 by A1,A2,Th56;
    end;
    suppose p`2<>0;
      then 0<(p`2)^2 by SQUARE_1:74;
      then 0+(p`1)^2<(p`1)^2+(p`2)^2 by XREAL_1:10;
      then (p`1)^2/(|.p.|)^2 < (|.p.|)^2/(|.p.|)^2 by A4,A9,REAL_1:73;
      then (p`1)^2/(|.p.|)^2 < 1 by A4,XCMPLX_1:60;
      then A10: ((p`1)/|.p.|)^2 < 1 by XCMPLX_1:77;
          p`1/|.p.|-cn<=0 by A5,REAL_2:106;
      then A11: (p`1/|.p.|-cn)/(1+cn)<(1+cn)/(1+cn) by A8,REAL_1:73;
          -1 < p`1/|.p.| by A10,Lm3;
      then -1-cn< p`1/|.p.|-cn by XREAL_1:11;
      then (-1)*(1+cn)/(1+cn)< (p`1/|.p.|-cn)/(1+cn)
                    by A8,REAL_1:73;
      then -1< (p`1/|.p.|-cn)/(1+cn) & (p`1/|.p.|-cn)/(1+cn)<1
                        by A8,A11,XCMPLX_1:60,90;
      then 1^2> ((p`1/|.p.|-cn)/(1+cn))^2 by SQUARE_1:120;
      then 1-((p`1/|.p.|-cn)/(1+cn))^2>0 by XREAL_1:52;
      then sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)>0 by SQUARE_1:93;
      then |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))>0
                        by A3,XREAL_1:131;
     hence (cn-FanMorphN).x in K0 by A1,A2,A7,JGRAPH_2:11;
     end;
  end;
  suppose A12: p`1/|.p.|>cn;
   then A13: (cn-FanMorphN).p= |[ |.p.|*((p`1/|.p.|-cn)/(1-cn)),
   |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]| by A1,A2,Th58;
   reconsider p9= (cn-FanMorphN).p as Point of TOP-REAL 2;
A14: p9`2=|.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)) by A13,EUCLID:56;
A15: 1-cn>0 by A1,XREAL_1:151;
A16: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
       per cases;
       suppose p`2=0;
        hence (cn-FanMorphN).x in K0 by A1,A2,Th56;
       end;
       suppose p`2<>0;
         then 0<(p`2)^2 by SQUARE_1:74;
         then 0+(p`1)^2<(p`1)^2+(p`2)^2 by XREAL_1:10;
         then (p`1)^2/(|.p.|)^2 < (|.p.|)^2/(|.p.|)^2 by A4,A16,REAL_1:73;
         then (p`1)^2/(|.p.|)^2 < 1 by A4,XCMPLX_1:60;
         then ((p`1)/|.p.|)^2 < 1 by XCMPLX_1:77;
         then p`1/|.p.|<1 by Lm3;
         then (p`1/|.p.|-cn)<1-cn by XREAL_1:11;
         then A17: (p`1/|.p.|-cn)/(1-cn)<(1-cn)/(1-cn) by A15,REAL_1:73;
A18:     -(1-cn)< -0 by A15,XREAL_1:26;
         p`1/|.p.|-cn>=cn-cn by A12,XREAL_1:11;
         then (-1)*(1-cn)/(1-cn)< (p`1/|.p.|-cn)/(1-cn)
           by A15,A18,REAL_1:73;
         then -1< (p`1/|.p.|-cn)/(1-cn) & (p`1/|.p.|-cn)/(1-cn)<1
           by A15,A17,XCMPLX_1:60,90;
         then 1> ((p`1/|.p.|-cn)/(1-cn))^2 by SQUARE_1:120,59;
         then 1-((p`1/|.p.|-cn)/(1-cn))^2>0 by XREAL_1:52;
         then sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)>0 by SQUARE_1:93;
         then p9`2>0 by A3,A14,XREAL_1:131;
        hence (cn-FanMorphN).x in K0 by A1,A2,JGRAPH_2:11;
       end;
     end;
end;

theorem Th75:
  for cn being Real,x,K0 being set st -1<cn & cn<1 & x in K0 &
 K0={p: p`2<=0 & p<>0.REAL 2} holds (cn-FanMorphN).x in K0
proof let cn be Real,x,K0 be set;
 assume A1:  -1<cn & cn<1 & x in K0 & K0={p: p`2<=0 & p<>0.REAL 2};
 then consider p such that
A2: p=x & p`2<=0 & p<>0.REAL 2;
 thus thesis by A1,A2,Th56;
end;

theorem Th76:for cn being Real,
 D being non empty Subset of TOP-REAL 2
st -1<cn & cn<1 & D`={0.REAL 2} holds
ex h being Function of (TOP-REAL 2)|D,(TOP-REAL 2)|D
st h=(cn-FanMorphN)|D & h is continuous
proof let cn be Real,D be non empty Subset of TOP-REAL 2;
assume A1:  -1<cn & cn<1 & D`={0.REAL 2};
defpred P[Point of TOP-REAL 2] means $1`2>=0;
  reconsider B0= {0.REAL 2} as Subset of TOP-REAL 2;
  A2: D =(B0)` by A1
     .=((the carrier of TOP-REAL 2)\ {0.REAL 2}) by SUBSET_1:def 5;
    A3:{p: P[p] & p<>0.REAL 2} c= the carrier of (TOP-REAL 2)|D
        from InclSub(A2);
          (|[0,1]|)`1=0 & (|[0,1]|)`2=1 by EUCLID:56;
      then |[0,1]| in {p where p is Point of TOP-REAL 2:
        p`2>=0 & p<>0.REAL 2} by JGRAPH_2:11;
      then reconsider K0={p:p`2>=0 & p<>0.REAL 2}
          as non empty Subset of (TOP-REAL 2)|D by A3;
          defpred P[Point of TOP-REAL 2] means $1`2<=0;
    A4:{p: P[p] & p<>0.REAL 2} c= the carrier of (TOP-REAL 2)|D
        from InclSub(A2);
     set Y1=|[0,-1]|;
     A5:Y1`1=0 & Y1`2=-1 by EUCLID:56;
         0.REAL 2 <> Y1 by EUCLID:56,JGRAPH_2:11;
     then Y1 in {p where p is Point of TOP-REAL 2:
     p`2<=0 & p<>0.REAL 2} by A5;
  then reconsider K1={p: p`2<=0 & p<>0.REAL 2}
       as non empty Subset of (TOP-REAL 2)|D by A4;
   A6:the carrier of ((TOP-REAL 2)|D)=D by PRE_TOPC:29;
   A7:K0 c= (the carrier of TOP-REAL 2)
   proof let z be set;assume z in K0;
        then consider p8 being Point of TOP-REAL 2 such that
        A8: p8=z & p8`2>=0 & p8<>0.REAL 2;
    thus z in (the carrier of TOP-REAL 2) by A8;
   end;
  A9:dom ((cn-FanMorphN)|K0)= dom ((cn-FanMorphN)) /\ K0 by FUNCT_1:68
       .=((the carrier of TOP-REAL 2)) /\ K0 by FUNCT_2:def 1
       .=K0 by A7,XBOOLE_1:28;
  A10: K0=the carrier of ((TOP-REAL 2)|D)|K0 by PRE_TOPC:29;
      rng ((cn-FanMorphN)|K0) c= the carrier of ((TOP-REAL 2)|D)|K0
   proof let y be set;assume y in rng ((cn-FanMorphN)|K0);
     then consider x being set such that
     A11:x in dom ((cn-FanMorphN)|K0)
     & y=((cn-FanMorphN)|K0).x by FUNCT_1:def 5;
         x in (dom (cn-FanMorphN)) /\ K0 by A11,FUNCT_1:68;
     then A12:x in K0 by XBOOLE_0:def 3;
         K0 c= the carrier of TOP-REAL 2 by A6,XBOOLE_1:1;
     then reconsider p=x as Point of TOP-REAL 2 by A12;
        (cn-FanMorphN).p=y by A11,A12,FUNCT_1:72;
     then y in K0 by A1,A12,Th74;
    hence y in the carrier of ((TOP-REAL 2)|D)|K0 by PRE_TOPC:29;
   end;
  then rng ((cn-FanMorphN)|K0)c= the carrier of ((TOP-REAL 2)|D)
                            by A10,XBOOLE_1:1;
  then reconsider f=(cn-FanMorphN)|K0 as Function of ((TOP-REAL 2)|D)|K0,
  ((TOP-REAL 2)|D)  by A9,A10,FUNCT_2:4;
   A13:K1 c= (the carrier of TOP-REAL 2)
   proof let z be set;assume z in K1;
        then consider p8 being Point of TOP-REAL 2 such that
        A14: p8=z & p8`2<=0 & p8<>0.REAL 2;
    thus z in (the carrier of TOP-REAL 2) by A14;
   end;
  A15:dom ((cn-FanMorphN)|K1)= dom ((cn-FanMorphN)) /\ K1 by FUNCT_1:68
       .=((the carrier of TOP-REAL 2)) /\ K1 by FUNCT_2:def 1
       .=K1 by A13,XBOOLE_1:28;
  A16: K1=the carrier of ((TOP-REAL 2)|D)|K1 by PRE_TOPC:29;
      rng ((cn-FanMorphN)|K1) c= the carrier of ((TOP-REAL 2)|D)|K1
   proof let y be set;assume y in rng ((cn-FanMorphN)|K1);
     then consider x being set such that
     A17:x in dom ((cn-FanMorphN)|K1)
     & y=((cn-FanMorphN)|K1).x by FUNCT_1:def 5;
         x in (dom (cn-FanMorphN)) /\ K1 by A17,FUNCT_1:68;
     then A18:x in K1 by XBOOLE_0:def 3;
         K1 c= the carrier of TOP-REAL 2 by A6,XBOOLE_1:1;
     then reconsider p=x as Point of TOP-REAL 2 by A18;
        (cn-FanMorphN).p=y by A17,A18,FUNCT_1:72;
     then y in K1 by A1,A18,Th75;
    hence y in the carrier of ((TOP-REAL 2)|D)|K1 by PRE_TOPC:29;
   end;
  then rng ((cn-FanMorphN)|K1)c= the carrier of ((TOP-REAL 2)|D)
                     by A16,XBOOLE_1:1;
  then reconsider g=(cn-FanMorphN)|K1 as Function of ((TOP-REAL 2)|D)|K1,
  ((TOP-REAL 2)|D)  by A15,A16,FUNCT_2:4;
  A19:K0=[#](((TOP-REAL 2)|D)|K0) by PRE_TOPC:def 10;
  A20:K1=[#](((TOP-REAL 2)|D)|K1) by PRE_TOPC:def 10;
  A21:D= [#]((TOP-REAL 2)|D) by PRE_TOPC:def 10;
   D c= K0 \/ K1
   proof let x be set;assume A22: x in D;
     then A23:x in (the carrier of TOP-REAL 2) & not x in {0.REAL 2}
                                     by A2,XBOOLE_0:def 4;
     reconsider px=x as Point of TOP-REAL 2 by A22;
     px`2>=0 & px<>0.REAL 2 or
       px`2<=0 & px<>0.REAL 2 by A23,TARSKI:def 1;
     then x in K0 or x in K1;
    hence x in K0 \/ K1 by XBOOLE_0:def 2;
   end;
  then A24:([#](((TOP-REAL 2)|D)|K0)) \/ ([#](((TOP-REAL 2)|D)|K1))
  = [#]((TOP-REAL 2)|D) by A19,A20,A21,XBOOLE_0:def 10;
  A25: f is continuous & K0 is closed by A1,A2,Th69,Th71;
  A26: g is continuous & K1 is closed by A1,A2,Th70,Th72;
  A27: for x be set st x in ([#]((((TOP-REAL 2)|D)|K0)))
        /\ ([#] ((((TOP-REAL 2)|D)|K1))) holds f.x = g.x
   proof let x be set;assume x in ([#]((((TOP-REAL 2)|D)|K0)))
        /\ ([#] ((((TOP-REAL 2)|D)|K1)));
     then A28:x in K0 & x in K1 by A19,A20,XBOOLE_0:def 3;
     then f.x=(cn-FanMorphN).x by FUNCT_1:72;
    hence f.x = g.x by A28,FUNCT_1:72;
   end;
  then consider h being Function of (TOP-REAL 2)|D,(TOP-REAL 2)|D such that
A29: h= f+*g & h is continuous by A19,A20,A24,A25,A26,JGRAPH_2:9;
  A30:dom h=the carrier of ((TOP-REAL 2)|D) by FUNCT_2:def 1;
  A31:the carrier of ((TOP-REAL 2)|D)=D by PRE_TOPC:29;
  A32:the carrier of ((TOP-REAL 2)|D) =
((the carrier of TOP-REAL 2)\ {0.REAL 2}) by A2,PRE_TOPC:29;
      dom (cn-FanMorphN)=(the carrier of (TOP-REAL 2))
                    by FUNCT_2:def 1;
  then A33:dom ((cn-FanMorphN)|D)=(the carrier of (TOP-REAL 2))/\ D
                    by FUNCT_1:68
              .=the carrier of ((TOP-REAL 2)|D) by A31,XBOOLE_1:28;
  A34:dom f=K0 by A10,FUNCT_2:def 1;
  A35:K0=[#](((TOP-REAL 2)|D)|K0) by PRE_TOPC:def 10;
  A36:dom g=K1 by A16,FUNCT_2:def 1;
     K1=[#](((TOP-REAL 2)|D)|K1) by PRE_TOPC:def 10;
  then A37: f tolerates g by A27,A34,A35,A36,PARTFUN1:def 6;
      for x being set st x in dom h holds h.x=((cn-FanMorphN)|D).x
   proof let x be set;assume A38: x in dom h;
     then x in (the carrier of TOP-REAL 2) & not x in {0.REAL 2}
                     by A32,XBOOLE_0:def 4;
     then A39:x <>0.REAL 2 by TARSKI:def 1;
     reconsider p=x as Point of TOP-REAL 2 by A32,A38,XBOOLE_0:def 4;
     A40: x in D`` by A30,A38,PRE_TOPC:29;
         now per cases;
     case A41:x in K0;
       A42:(cn-FanMorphN)|D.p=(cn-FanMorphN).p by A40,FUNCT_1:72
          .=f.p by A41,FUNCT_1:72;
           h.p=(g+*f).p by A29,A37,FUNCT_4:35
       .=f.p by A34,A41,FUNCT_4:14;
      hence h.x=(cn-FanMorphN)|D.x by A42;
     end;
     case not x in K0;
       then not (p`2>=0) by A39;
       then A43:x in K1 by A39;
          (cn-FanMorphN)|D.p=(cn-FanMorphN).p by A40,FUNCT_1:72
                           .=g.p by A43,FUNCT_1:72;
      hence h.x=(cn-FanMorphN)|D.x by A29,A36,A43,FUNCT_4:14;
     end;
     end;
    hence h.x=(cn-FanMorphN)|D.x;
   end;
  then f+*g=(cn-FanMorphN)|D by A29,A30,A33,FUNCT_1:9;
 hence thesis by A19,A20,A24,A25,A26,A27,JGRAPH_2:9;
end;

theorem Th77: for cn being Real
  st -1<cn & cn<1 holds
  ex h being Function of (TOP-REAL 2),(TOP-REAL 2)
  st h=(cn-FanMorphN) & h is continuous
proof let cn be Real;
 assume A1:  -1<cn & cn<1;
 reconsider f=(cn-FanMorphN) as Function of (TOP-REAL 2),(TOP-REAL 2)
                         ;
 reconsider D=(the carrier of TOP-REAL 2) \{0.REAL 2}
   as non empty Subset of TOP-REAL 2 by JGRAPH_2:19;
 A2: f.(0.REAL 2)=0.REAL 2 by Th56,JGRAPH_2:11;
 A3: D`= {0.REAL 2} by JGRAPH_3:30;
 A4: for p being Point of (TOP-REAL 2)|D holds f.p<>f.(0.REAL 2)
  proof let p be Point of (TOP-REAL 2)|D;
    A5:[#]((TOP-REAL 2)|D)=D by PRE_TOPC:def 10;
    then A6:p in the carrier of TOP-REAL 2 & not p in {0.REAL 2}
                         by XBOOLE_0:def 4;
    reconsider q=p as Point of TOP-REAL 2 by A5,XBOOLE_0:def 4;
    A7:not p=0.REAL 2 by A6,TARSKI:def 1;
        now per cases;
    case A8: q`1/|.q.|>=cn & q`2>=0;
      set q9= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
        |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]|;
      A9:q9`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)) &
      q9`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by EUCLID:56;
          now assume A10: q9=0.REAL 2;
       A11: |.q.|<>0 by A7,TOPRNS_1:25;
        then sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)= sqrt(1-0) by A9,A10,
JGRAPH_2:11,SQUARE_1:60,XCMPLX_1:6
       .=1 by SQUARE_1:83;
      hence contradiction by A10,A11,EUCLID:56,JGRAPH_2:11;
     end;
     hence f.p<>f.(0.REAL 2) by A1,A2,A7,A8,Th58;
    end;
    case A12: q`1/|.q.|<cn & q`2>=0;
      set q9=|[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
         |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]|;
      A13:q9`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)) &
          q9`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by EUCLID:56;
          now assume A14: q9=0.REAL 2;
       A15: |.q.|<>0 by A7,TOPRNS_1:25;
        then sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)= sqrt(1-0) by A13,A14,
JGRAPH_2:11,SQUARE_1:60,XCMPLX_1:6
       .=1 by SQUARE_1:83;
      hence contradiction by A14,A15,EUCLID:56,JGRAPH_2:11;
     end;
     hence f.p<>f.(0.REAL 2) by A1,A2,A7,A12,Th58;
     end;
     case q`2<0; then f.p=p by Th56;
     hence f.p<>f.(0.REAL 2) by A7,Th56,JGRAPH_2:11;
    end;
    end;
   hence f.p<>f.(0.REAL 2);
  end;
 A16:ex h being Function of (TOP-REAL 2)|D,(TOP-REAL 2)|D
  st h=(cn-FanMorphN)|D & h is continuous by A1,A3,Th76;
     for V being Subset of (TOP-REAL 2) st f.(0.REAL 2) in V & V is open
 ex W being Subset of (TOP-REAL 2) st 0.REAL 2 in W
 & W is open & f.:W c= V
  proof let V be Subset of (TOP-REAL 2);
    assume A17:f.(0.REAL 2) in V & V is open;
     reconsider u0=0.REAL 2 as Point of Euclid 2;
     consider r being real number such that A18:r>0 & Ball(u0,r) c= V
                                   by A2,A17,TOPMETR:22;
     reconsider r as Real by XREAL_0:def 1;
     reconsider W1=Ball(u0,r) as Subset of TOP-REAL 2;
     A19:u0 in W1 by A18,GOBOARD6:4;
     A20:W1 is open by GOBOARD6:6;
         f.:W1 c= W1
      proof let z be set;assume z in f.:W1;
        then consider y being set such that
        A21: y in dom f & y in W1 & z=f.y by FUNCT_1:def 12;
        reconsider q=y as Point of TOP-REAL 2 by A21;
        reconsider qy=q as Point of Euclid 2;
            z in rng f by A21,FUNCT_1:def 5;
        then reconsider qz=z as Point of TOP-REAL 2;
        reconsider pz=qz as Point of Euclid 2;
            dist(u0,qy)<r by A21,METRIC_1:12;
        then A22: |.(0.REAL 2) - q.|<r by JGRAPH_1:45;
            now per cases by JGRAPH_2:11;
        case q`2<=0;
         hence z in W1 by A21,Th56;
        end;
        case A23: q<>0.REAL 2 &
          (q`1/|.q.|>=cn & q`2>=0);
          then A24:(cn-FanMorphN).q= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)) ,
          |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by A1,Th58;
              |.q.|<>0 by A23,TOPRNS_1:25;
          then A25: (|.q.|)^2>0 by SQUARE_1:74;
        A26: 1-cn>0 by A1,XREAL_1:151;
        A27: qz`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))&
        qz`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn))
                     by A21,A24,EUCLID:56;
        A28: (q`1/|.q.|-cn)>= 0 by A23,XREAL_1:50;
        A29: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
            0<=(q`2)^2 by XREAL_1:65;
        then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A25,A29,REAL_1:73;
        then (q`1)^2/(|.q.|)^2 <= 1 by A25,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then 1>=q`1/|.q.| by Lm2;
        then A30: 1-cn>=q`1/|.q.|-cn by XREAL_1:11;
        A31: -(1-cn)<= -0 by A26,XREAL_1:26;
             -(1-cn)<= -( q`1/|.q.|-cn) by A30,XREAL_1:26;
         then (-(1-cn))/(1-cn)<=(-( q`1/|.q.|-cn))/(1-cn)
                        by A26,REAL_1:73;
        then A32: -1<=(-( q`1/|.q.|-cn))/(1-cn)
                        by A26,XCMPLX_1:198;
           --(1-cn)>= -(q`1/|.q.|-cn) by A28,A31,XREAL_1:26;
       then (-(q`1/|.q.|-cn))/(1-cn)<=1 by A26,REAL_2:117;
       then ((-(q`1/|.q.|-cn))/(1-cn))^2<=1^2 by A32,SQUARE_1:119;
       then 1-((-(q`1/|.q.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
       then 1-(-((q`1/|.q.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
       then A33: 1-((q`1/|.q.|-cn)/(1-cn))^2>=0;
        A34: (qz`2)^2= (|.q.|)^2*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))^2
                         by A27
         .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1-cn))^2) by A33,SQUARE_1:def 4;
        A35: (qz`1)^2= (|.q.|)^2*((q`1/|.q.|-cn)/(1-cn))^2
                         by A27;
            (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
        .=(|.q.|)^2 by A34,A35;
        then A36: sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
          A37: |.qz.|=|.q.| by A36,SQUARE_1:89;
              |.(0.REAL 2) +- q.|<r by A22,EUCLID:45;
          then |.- q.|<r by EUCLID:31;
          then |.q.|<r by TOPRNS_1:27;
          then |.- qz.|<r by A37,TOPRNS_1:27;
          then |.(0.REAL 2) +- qz.|<r by EUCLID:31;
          then |.(0.REAL 2) - qz.|<r by EUCLID:45;
          then dist(u0,pz)<r by JGRAPH_1:45;
         hence z in W1 by METRIC_1:12;
        end;
        case A38: q<>0.REAL 2 &
          q`1/|.q.|<cn & q`2>=0;
          then A39:(cn-FanMorphN).q= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
          |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]| by A1,Th58;
              |.q.|<>0 by A38,TOPRNS_1:25;
          then A40: (|.q.|)^2>0 by SQUARE_1:74;
        A41: (cn-q`1/|.q.|)>=0 by A38,XREAL_1:50;
        A42: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        A43: 1+cn>0 by A1,XREAL_1:150;
        A44: qz`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))&
        qz`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn))
                     by A21,A39,EUCLID:56;
            0<=(q`2)^2 by XREAL_1:65;
        then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A40,A42,REAL_1:73;
        then (q`1)^2/(|.q.|)^2 <= 1 by A40,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then -1<=q`1/|.q.| by Lm2;
        then --1>=-q`1/|.q.| by XREAL_1:26;
        then A45: 1+cn>=-q`1/|.q.|+cn by XREAL_1:9;
            -(1+cn)<= -0 by A43,XREAL_1:26;
         then (-(1+cn))/(1+cn)<=(-( q`1/|.q.|-cn))/(1+cn)
                        by A41,A43,REAL_1:73;
        then A46: -1<=(-( q`1/|.q.|-cn))/(1+cn)
                        by A43,XCMPLX_1:198;
        (-(q`1/|.q.|-cn))/(1+cn)<=1 by A43,A45,REAL_2:117;
       then ((-(q`1/|.q.|-cn))/(1+cn))^2<=1^2 by A46,SQUARE_1:119;
       then 1-((-(q`1/|.q.|-cn))/(1+cn))^2>=0 by XREAL_1:50;
       then 1-(-((q`1/|.q.|-cn))/(1+cn))^2>=0 by XCMPLX_1:188;
       then A47: 1-((q`1/|.q.|-cn)/(1+cn))^2>=0;
        A48: (qz`2)^2= (|.q.|)^2*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))^2
                         by A44
         .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1+cn))^2) by A47,SQUARE_1:def 4;
        A49: (qz`1)^2= (|.q.|)^2*((q`1/|.q.|-cn)/(1+cn))^2
                         by A44;
            (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
        .=(|.q.|)^2 by A48,A49;
        then A50: sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
          A51: |.qz.|=|.q.| by A50,SQUARE_1:89;
              |.(0.REAL 2) +- q.|<r by A22,EUCLID:45;
          then |.- q.|<r by EUCLID:31;
          then |.q.|<r by TOPRNS_1:27;
          then |.- qz.|<r by A51,TOPRNS_1:27;
          then |.(0.REAL 2) +- qz.|<r by EUCLID:31;
          then |.(0.REAL 2) - qz.|<r by EUCLID:45;
          then dist(u0,pz)<r by JGRAPH_1:45;
         hence z in W1 by METRIC_1:12;
        end;
        end;
       hence z in W1;
      end;
     then f.:W1 c= V by A18,XBOOLE_1:1;
   hence ex W being Subset of (TOP-REAL 2) st 0.REAL 2 in W
       & W is open & f.:W c= V by A19,A20;
  end;
  then f is continuous by A2,A3,A4,A16,JGRAPH_3:13;
 hence thesis;
end;

theorem Th78:
  for cn being Real st -1<cn & cn<1 holds cn-FanMorphN is one-to-one
proof let cn be Real;
 assume A1: -1<cn & cn<1;
 for x1,x2 being set st x1 in dom (cn-FanMorphN) & x2 in dom (cn-FanMorphN)
   & (cn-FanMorphN).x1=(cn-FanMorphN).x2 holds x1=x2
  proof let x1,x2 be set;
   assume A2: x1 in dom (cn-FanMorphN) & x2 in dom (cn-FanMorphN)
    & (cn-FanMorphN).x1=(cn-FanMorphN).x2;
    then reconsider p1=x1 as Point of TOP-REAL 2;
    reconsider p2=x2 as Point of TOP-REAL 2 by A2;
    set q=p1,p=p2;
    A3: 1-cn>0 by A1,XREAL_1:151;
        now per cases by JGRAPH_2:11;
    case A4: q`2<=0;
      then A5:(cn-FanMorphN).q=q by Th56;
          now per cases by JGRAPH_2:11;
      case p`2<=0;
       hence x1=x2 by A2,A5,Th56;
      end;
      case A6:p<>0.REAL 2 &
          (p`1/|.p.|>=cn & p`2>=0);
    then A7:cn-FanMorphN.p= |[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
           |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]| by A1,Th58;
         set p4= |[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
           |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]|;
        A8: p4`2= |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)) &
          p4`1= |.p.|* ((p`1/|.p.|-cn)/(1-cn)) by EUCLID:56;
     A9: |.p.|>0 by A6,Lm1;
     then A10: (|.p.|)^2>0 by SQUARE_1:74;
        A11: (p`1/|.p.|-cn)>=0 by A6,XREAL_1:50;
        A12: (p`1/|.p.|-cn)>= 0 by A6,XREAL_1:50;
        A13: (p`1/|.p.|-cn)/(1-cn)>=0 by A3,A11,REAL_2:125;
        A14: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
            0<=(p`2)^2 by XREAL_1:65;
        then 0+(p`1)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
        then (p`1)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by A10,A14,REAL_1:73;
        then (p`1)^2/(|.p.|)^2 <= 1 by A10,XCMPLX_1:60;
        then ((p`1)/|.p.|)^2 <= 1 by XCMPLX_1:77;
        then 1>=p`1/|.p.| by Lm2;
        then A15: 1-cn>=p`1/|.p.|-cn by XREAL_1:11;
        A16: -(1-cn)<= -0 by A3,XREAL_1:26;
             -(1-cn)<= -( p`1/|.p.|-cn) by A15,XREAL_1:26;
         then (-(1-cn))/(1-cn)<=(-( p`1/|.p.|-cn))/(1-cn)
                        by A3,REAL_1:73;
        then A17: -1<=(-( p`1/|.p.|-cn))/(1-cn) by A3,XCMPLX_1:198;
           --(1-cn)>= -(p`1/|.p.|-cn) by A12,A16,XREAL_1:26;
       then (-(p`1/|.p.|-cn))/(1-cn)<=1 by A3,REAL_2:117;
       then ((-(p`1/|.p.|-cn))/(1-cn))^2<=1^2 by A17,SQUARE_1:119;
       then A18: 1-((-(p`1/|.p.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
       then 1-(-((p`1/|.p.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
       then A19: 1-((p`1/|.p.|-cn)/(1-cn))^2>=0;
           sqrt(1-((-(p`1/|.p.|-cn))/(1-cn))^2)>=0 by A18,SQUARE_1:def 4;
       then sqrt(1-(-(p`1/|.p.|-cn))^2/(1-cn)^2)>=0 by XCMPLX_1:77;
       then sqrt(1-(p`1/|.p.|-cn)^2/(1-cn)^2)>=0;
       then sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)>=0 by XCMPLX_1:77;
        then q`2=0 by A2,A4,A5,A7,A8,XREAL_1:129;
        then ( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))=0 by A2,A5,A7,A8,A9,
XCMPLX_1:6;
        then 1-((p`1/|.p.|-cn)/(1-cn))^2=0 by A19,SQUARE_1:92;
        then 1=0+((p`1/|.p.|-cn)/(1-cn))^2;
        then 1= (p`1/|.p.|-cn)/(1-cn) by A13,SQUARE_1:83,89;
        then 1 *(1-cn)=(p`1/|.p.|-cn) by A3,XCMPLX_1:88;
        then 1-cn+cn=p`1/|.p.|;
        then 1=p`1/|.p.|;
        then 1 *|.p.|=p`1 by A9,XCMPLX_1:88;
        then (p`1)^2-(p`1)^2 =(p`2)^2 by A14;
        then 0= (p`2)^2;
        then p`2=0 by XCMPLX_1:6;
       hence x1=x2 by A2,A5,Th56;
      end;
      case A20:p<>0.REAL 2 &
        (p`1/|.p.|<cn & p`2>=0);
    then A21: cn-FanMorphN.p= |[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
           |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]| by A1,Th58;
         set p4= |[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
           |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]|;
        A22: p4`2= |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)) &
          p4`1= |.p.|* ((p`1/|.p.|-cn)/(1+cn)) by EUCLID:56;
     A23: |.p.|<>0 by A20,TOPRNS_1:25;
     then A24: (|.p.|)^2>0 by SQUARE_1:74;
     A25: 1+cn>0 by A1,XREAL_1:150;
        A26: (p`1/|.p.|-cn)<=0 by A20,REAL_2:106;
        then A27: -(p`1/|.p.|-cn)>= -0 by XREAL_1:26;
        --(p`1/|.p.|-cn)/(1+cn)<=0 by A25,A26,REAL_2:126;
        then A28: -((p`1/|.p.|-cn)/(1+cn))>=0 by XREAL_1:60;
        A29: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
        0<=(p`2)^2 by XREAL_1:65;
        then 0+(p`1)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
        then (p`1)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by A24,A29,REAL_1:73;
        then (p`1)^2/(|.p.|)^2 <= 1 by A24,XCMPLX_1:60;
        then ((p`1)/|.p.|)^2 <= 1 by XCMPLX_1:77;
        then A30: (-((p`1)/|.p.|))^2 <= 1;
            -(1+cn)<= -0 by A25,XREAL_1:26;
        then (-(1+cn))/(1+cn)<=(-( p`1/|.p.|-cn))/(1+cn)
                        by A25,A27,REAL_1:73;
        then A31: -1<=(-( p`1/|.p.|-cn))/(1+cn) by A25,XCMPLX_1:198;
       1>= -p`1/|.p.| by A30,Lm2;
       then (1+cn)>= -p`1/|.p.|+cn by XREAL_1:9;
       then (-(p`1/|.p.|-cn))/(1+cn)<=1 by A25,REAL_2:117;
       then ((-(p`1/|.p.|-cn))/(1+cn))^2<=1^2 by A31,SQUARE_1:119;
       then A32: 1-((-(p`1/|.p.|-cn))/(1+cn))^2>=0 by XREAL_1:50;
       then 1-(-((p`1/|.p.|-cn))/(1+cn))^2>=0 by XCMPLX_1:188;
       then A33: 1-((p`1/|.p.|-cn)/(1+cn))^2>=0;
       sqrt(1-((-(p`1/|.p.|-cn))/(1+cn))^2)>=0 by A32,SQUARE_1:def 4;
       then sqrt(1-(-(p`1/|.p.|-cn))^2/(1+cn)^2)>=0 by XCMPLX_1:77;
       then sqrt(1-((p`1/|.p.|-cn))^2/(1+cn)^2)>=0;
       then sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)>=0 by XCMPLX_1:77;
       then q`2=0 by A2,A4,A5,A21,A22,XREAL_1:129;
       then ( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))=0 by A2,A5,A21,A22,A23,
XCMPLX_1:6;
        then 1-((p`1/|.p.|-cn)/(1+cn))^2=0 by A33,SQUARE_1:92;
        then 1=0+((p`1/|.p.|-cn)/(1+cn))^2;
        then 1=sqrt((-((p`1/|.p.|-cn)/(1+cn)))^2) by SQUARE_1:83;
        then 1= -((p`1/|.p.|-cn)/(1+cn)) by A28,SQUARE_1:89;
        then 1= ((-(p`1/|.p.|-cn))/(1+cn)) by XCMPLX_1:188;
        then 1 *(1+cn)=-(p`1/|.p.|-cn) by A25,XCMPLX_1:88;
        then 1+cn=-p`1/|.p.|+cn;
        then 1+cn-cn=-p`1/|.p.|;
        then 1=-p`1/|.p.|;
        then 1=(-p`1)/|.p.| by XCMPLX_1:188;
        then 1 *|.p.|=-p`1 by A23,XCMPLX_1:88;
        then (-p`1)^2-(p`1)^2 =(p`2)^2 by A29,XCMPLX_1:26;
        then (p`1)^2-(p`1)^2 =(p`2)^2;
        then 0= (p`2)^2;
        then p`2=0 by XCMPLX_1:6;
       hence x1=x2 by A2,A5,Th56;
      end;
      end;
     hence x1=x2;
    end;
    case A34: q`1/|.q.|>=cn & q`2>=0 & q<>0.REAL 2;
        then A35:
         cn-FanMorphN.q= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
           |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by A1,Th58;
         set q4= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
           |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]|;
        A36: q4`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)) &
          q4`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by EUCLID:56;
         |.q.|<>0 by A34,TOPRNS_1:25;
     then A37: (|.q.|)^2>0 by SQUARE_1:74;
          now per cases by JGRAPH_2:11;
      case A38: p`2<=0;
        then A39: (cn-FanMorphN).p=p by Th56;
        A40: |.q.|<>0 by A34,TOPRNS_1:25;
        then A41: (|.q.|)^2>0 by SQUARE_1:74;
        A42: 1-cn>0 by A1,XREAL_1:151;
        A43: (q`1/|.q.|-cn)>=0 by A34,XREAL_1:50;
        A44: (q`1/|.q.|-cn)>= 0 by A34,XREAL_1:50;
        A45: (q`1/|.q.|-cn)/(1-cn)>=0 by A42,A43,REAL_2:125;
        A46: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        0<=(q`2)^2 by XREAL_1:65;
        then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A41,A46,REAL_1:73;
        then (q`1)^2/(|.q.|)^2 <= 1 by A41,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then 1>=q`1/|.q.| by Lm2;
        then A47: 1-cn>=q`1/|.q.|-cn by XREAL_1:11;
        A48: -(1-cn)<= -0 by A42,XREAL_1:26;
         -(1-cn)<= -( q`1/|.q.|-cn) by A47,XREAL_1:26;
         then (-(1-cn))/(1-cn)<=(-( q`1/|.q.|-cn))/(1-cn)
                        by A42,REAL_1:73;
        then A49: -1<=(-( q`1/|.q.|-cn))/(1-cn) by A42,XCMPLX_1:198;
           --(1-cn)>= -(q`1/|.q.|-cn) by A44,A48,XREAL_1:26;
       then (-(q`1/|.q.|-cn))/(1-cn)<=1 by A42,REAL_2:117;
       then ((-(q`1/|.q.|-cn))/(1-cn))^2<=1^2 by A49,SQUARE_1:119;
       then A50: 1-((-(q`1/|.q.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
       then 1-(-((q`1/|.q.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
       then A51: 1-((q`1/|.q.|-cn)/(1-cn))^2>=0;
           sqrt(1-((-(q`1/|.q.|-cn))/(1-cn))^2)>=0 by A50,SQUARE_1:def 4;
       then sqrt(1-(-(q`1/|.q.|-cn))^2/(1-cn)^2)>=0 by XCMPLX_1:77;
       then sqrt(1-(q`1/|.q.|-cn)^2/(1-cn)^2)>=0;
       then sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)>=0 by XCMPLX_1:77;
        then p`2=0 by A2,A35,A36,A38,A39,XREAL_1:129;
        then ( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))=0 by A2,A35,A36,A39,A40,
XCMPLX_1:6;
        then 1-((q`1/|.q.|-cn)/(1-cn))^2=0 by A51,SQUARE_1:92;
        then 1=0+((q`1/|.q.|-cn)/(1-cn))^2;
        then 1= (q`1/|.q.|-cn)/(1-cn) by A45,SQUARE_1:83,89;
        then 1 *(1-cn)=(q`1/|.q.|-cn) by A42,XCMPLX_1:88;
        then 1-cn+cn=q`1/|.q.|;
        then 1=q`1/|.q.|;
        then 1 *|.q.|=q`1 by A40,XCMPLX_1:88;
        then (q`1)^2-(q`1)^2 =(q`2)^2 by A46;
        then 0= (q`2)^2;
        then q`2=0 by XCMPLX_1:6;
       hence x1=x2 by A2,A39,Th56;
      end;
      case A52:p<>0.REAL 2 &
          (p`1/|.p.|>=cn & p`2>=0);
       then A53: cn-FanMorphN.p= |[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
           |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]| by A1,Th58;
         set p4= |[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
           |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]|;
        A54: p4`2= |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)) &
          p4`1= |.p.|* ((p`1/|.p.|-cn)/(1-cn)) by EUCLID:56;
        A55: q4`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))&
        q4`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by EUCLID:56;
        A56: (q`1/|.q.|-cn)>= 0 by A34,XREAL_1:50;
        A57: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        0<=(q`2)^2 by XREAL_1:65;
        then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A37,A57,REAL_1:73;
        then (q`1)^2/(|.q.|)^2 <= 1 by A37,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then 1>=q`1/|.q.| by Lm2;
        then A58: 1-cn>=q`1/|.q.|-cn by XREAL_1:11;
        A59: -(1-cn)<= -0 by A3,XREAL_1:26;
             -(1-cn)<= -( q`1/|.q.|-cn) by A58,XREAL_1:26;
         then (-(1-cn))/(1-cn)<=(-( q`1/|.q.|-cn))/(1-cn)
                        by A3,REAL_1:73;
        then A60: -1<=(-( q`1/|.q.|-cn))/(1-cn) by A3,XCMPLX_1:198;
           --(1-cn)>= -(q`1/|.q.|-cn) by A56,A59,XREAL_1:26;
       then (-(q`1/|.q.|-cn))/(1-cn)<=1 by A3,REAL_2:117;
       then ((-(q`1/|.q.|-cn))/(1-cn))^2<=1^2 by A60,SQUARE_1:119;
       then 1-((-(q`1/|.q.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
       then 1-(-((q`1/|.q.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
       then A61: 1-((q`1/|.q.|-cn)/(1-cn))^2>=0;
        A62: (q4`2)^2= (|.q.|)^2*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))^2
                         by A55
         .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1-cn))^2) by A61,SQUARE_1:def 4;
        A63: (q4`1)^2= (|.q.|)^2*((q`1/|.q.|-cn)/(1-cn))^2
                         by A55;
            (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
        .=(|.q.|)^2 by A62,A63;
        then A64: sqrt((|.q4.|)^2)=|.q.| by SQUARE_1:89;
        then A65: |.q4.|=|.q.| by SQUARE_1:89;
        A66: |.p.|<>0 by A52,TOPRNS_1:25;
        then A67: (|.p.|)^2>0 by SQUARE_1:74;
        A68: (p`1/|.p.|-cn)>= 0 by A52,XREAL_1:50;
        A69: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
            0<=(p`2)^2 by XREAL_1:65;
        then 0+(p`1)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
        then (p`1)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by A67,A69,REAL_1:73;
        then (p`1)^2/(|.p.|)^2 <= 1 by A67,XCMPLX_1:60;
        then ((p`1)/|.p.|)^2 <= 1 by XCMPLX_1:77;
        then 1>=p`1/|.p.| by Lm2;
        then A70: 1-cn>=p`1/|.p.|-cn by XREAL_1:11;
        A71: -(1-cn)<= -0 by A3,XREAL_1:26;
             -(1-cn)<= -( p`1/|.p.|-cn) by A70,XREAL_1:26;
         then (-(1-cn))/(1-cn)<=(-( p`1/|.p.|-cn))/(1-cn)
                        by A3,REAL_1:73;
        then A72: -1<=(-( p`1/|.p.|-cn))/(1-cn) by A3,XCMPLX_1:198;
           --(1-cn)>= -(p`1/|.p.|-cn) by A68,A71,XREAL_1:26;
       then (-(p`1/|.p.|-cn))/(1-cn)<=1 by A3,REAL_2:117;
       then ((-(p`1/|.p.|-cn))/(1-cn))^2<=1^2 by A72,SQUARE_1:119;
       then 1-((-(p`1/|.p.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
       then 1-(-((p`1/|.p.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
       then A73: 1-((p`1/|.p.|-cn)/(1-cn))^2>=0;
        A74: (p4`2)^2= (|.p.|)^2*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))^2
                         by A54
         .= (|.p.|)^2*(1-((p`1/|.p.|-cn)/(1-cn))^2) by A73,SQUARE_1:def 4;
        A75: (p4`1)^2= (|.p.|)^2*((p`1/|.p.|-cn)/(1-cn))^2
                         by A54;
            (|.p4.|)^2=(p4`1)^2+(p4`2)^2 by JGRAPH_3:10
        .=(|.p.|)^2 by A74,A75;
        then A76: sqrt((|.p4.|)^2)=|.p.| by SQUARE_1:89;
        then A77: |.p4.|=|.p.| by SQUARE_1:89;
          ((p`1/|.p.|-cn)/(1-cn))
        =|.q.|* ((q`1/|.q.|-cn)/(1-cn))/|.p.| by A2,A35,A36,A53,A54,A66,
XCMPLX_1:90;
        then (p`1/|.p.|-cn)/(1-cn)=(q`1/|.q.|-cn)/(1-cn) by A2,A35,A53,A64,A66
,A76,XCMPLX_1:90;
        then (p`1/|.p.|-cn)/(1-cn)*(1-cn)=q`1/|.q.|-cn by A3,XCMPLX_1:88;
        then p`1/|.p.|-cn=q`1/|.q.|-cn by A3,XCMPLX_1:88;
        then p`1/|.p.|-cn+cn=q`1/|.q.|;
        then p`1/|.p.|=q`1/|.q.|;
        then p`1/|.p.|*|.p.|=q`1 by A2,A35,A53,A65,A66,A77,XCMPLX_1:88;
        then A78: p`1=q`1 by A66,XCMPLX_1:88;
        A79: |.p.|^2=(p`1)^2+(p`2)^2 by JGRAPH_3:10;
            |.q.|^2=(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        then (p`1)^2+(p`2)^2-(p`1)^2=(q`2)^2 by A2,A35,A53,A65,A77,A78,A79;
        then (p`2)^2=(q`2)^2;
        then p`2=sqrt((q`2)^2) by A52,SQUARE_1:89;
        then A80: p`2=q`2 by A34,SQUARE_1:89;
            p=|[p`1,p`2]| by EUCLID:57;
       hence x1=x2 by A78,A80,EUCLID:57;
      end;
      case A81: p<>0.REAL 2 &
        (p`1/|.p.|<cn & p`2>=0);
        then A82: cn-FanMorphN.p= |[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
           |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]| by A1,Th58;
         set p4= |[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
           |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]|;
        A83: p4`2= |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)) &
          p4`1= |.p.|* ((p`1/|.p.|-cn)/(1+cn)) by EUCLID:56;
         A84: p`1/|.p.|-cn<0 by A81,REAL_2:105;
             1+cn>0 by A1,XREAL_1:150;
         then A85: ((p`1/|.p.|-cn)/(1+cn))<0 by A84,REAL_2:128;
        A86: |.p.|>=0;
            |.p.|<>0 by A81,TOPRNS_1:25;
         then A87: |.p.|* ((p`1/|.p.|-cn)/(1+cn))<0 by A85,A86,XREAL_1:134;
         A88: q`1/|.q.|-cn>=0 by A34,XREAL_1:50;
             1-cn>0 by A1,XREAL_1:151;
         then ((q`1/|.q.|-cn)/(1-cn))>=0 by A88,REAL_2:125;
       hence x1=x2 by A2,A35,A36,A82,A83,A87,REAL_2:121;
      end;
      end;
     hence x1=x2;
    end;
    case A89:
      q`1/|.q.|<cn & q`2>=0 & q<>0.REAL 2;
        then A90: cn-FanMorphN.q= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
           |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]| by A1,Th58;
         set q4= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
           |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]|;
        A91: q4`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)) &
          q4`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by EUCLID:56;
     A92: |.q.|<>0 by A89,TOPRNS_1:25;
     then A93: (|.q.|)^2>0 by SQUARE_1:74;
          now per cases by JGRAPH_2:11;
      case A94: p`2<=0;
        then A95:(cn-FanMorphN).p=p by Th56;
        A96: 1+cn>0 by A1,XREAL_1:150;
        A97: (q`1/|.q.|-cn)<=0 by A89,REAL_2:106;
        then A98: -(q`1/|.q.|-cn)>= -0 by XREAL_1:26;
            --(q`1/|.q.|-cn)/(1+cn)<=0 by A96,A97,REAL_2:126;
        then A99: -((q`1/|.q.|-cn)/(1+cn))>=0 by XREAL_1:60;
        A100: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
            0<=(q`2)^2 by XREAL_1:65;
        then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A93,A100,REAL_1:73;
        then (q`1)^2/(|.q.|)^2 <= 1 by A93,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then A101: (-((q`1)/|.q.|))^2 <= 1;
            -(1+cn)<= -0 by A96,XREAL_1:26;
        then (-(1+cn))/(1+cn)<=(-( q`1/|.q.|-cn))/(1+cn) by A96,A98,REAL_1:73
;
        then A102: -1<=(-( q`1/|.q.|-cn))/(1+cn) by A96,XCMPLX_1:198;
           1>= -q`1/|.q.| by A101,Lm2;
       then (1+cn)>= -q`1/|.q.|+cn by XREAL_1:9;
       then (-(q`1/|.q.|-cn))/(1+cn)<=1 by A96,REAL_2:117;
       then ((-(q`1/|.q.|-cn))/(1+cn))^2<=1^2 by A102,SQUARE_1:119;
       then A103: 1-((-(q`1/|.q.|-cn))/(1+cn))^2>=0 by XREAL_1:50;
       then 1-(-((q`1/|.q.|-cn))/(1+cn))^2>=0 by XCMPLX_1:188;
       then A104: 1-((q`1/|.q.|-cn)/(1+cn))^2>=0;
           sqrt(1-((-(q`1/|.q.|-cn))/(1+cn))^2)>=0 by A103,SQUARE_1:def 4;
       then sqrt(1-(-(q`1/|.q.|-cn))^2/(1+cn)^2)>=0 by XCMPLX_1:77;
       then sqrt(1-((q`1/|.q.|-cn))^2/(1+cn)^2)>=0;
       then sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)>=0 by XCMPLX_1:77;
        then p`2=0 by A2,A90,A91,A94,A95,XREAL_1:129;
        then ( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))=0 by A2,A90,A91,A92,A95,
XCMPLX_1:6;
        then 1-((q`1/|.q.|-cn)/(1+cn))^2=0 by A104,SQUARE_1:92;
        then 1=0+((q`1/|.q.|-cn)/(1+cn))^2;
        then 1=sqrt((-((q`1/|.q.|-cn)/(1+cn)))^2) by SQUARE_1:83;
        then 1= -((q`1/|.q.|-cn)/(1+cn)) by A99,SQUARE_1:89;
        then 1= ((-(q`1/|.q.|-cn))/(1+cn)) by XCMPLX_1:188;
        then 1 *(1+cn)=-(q`1/|.q.|-cn) by A96,XCMPLX_1:88;
        then (1+cn)=-q`1/|.q.|+cn;
        then 1+cn-cn=-q`1/|.q.|;
        then 1=-q`1/|.q.|;
        then 1=(-q`1)/|.q.| by XCMPLX_1:188;
        then 1 *|.q.|=-q`1 by A92,XCMPLX_1:88;
        then (-q`1)^2-(q`1)^2 =(q`2)^2 by A100,XCMPLX_1:26;
        then (q`1)^2-(q`1)^2 =(q`2)^2;
        then 0= (q`2)^2;
        then q`2=0 by XCMPLX_1:6;
       hence x1=x2 by A2,A95,Th56;
      end;
      case A105:p<>0.REAL 2 &
          (p`1/|.p.|>=cn & p`2>=0);
        then A106: cn-FanMorphN.p= |[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
           |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]| by A1,Th58;
         set p4= |[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
           |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]|;
        A107: p4`2= |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)) &
          p4`1= |.p.|* ((p`1/|.p.|-cn)/(1-cn)) by EUCLID:56;
         A108: q`1/|.q.|-cn<0 by A89,REAL_2:105;
             1+cn>0 by A1,XREAL_1:150;
         then A109: ((q`1/|.q.|-cn)/(1+cn))<0 by A108,REAL_2:128;
        A110: |.q.|>=0;
            |.q.|<>0 by A89,TOPRNS_1:25;
         then A111: |.q.|* ((q`1/|.q.|-cn)/(1+cn))<0 by A109,A110,XREAL_1:134;
         A112: p`1/|.p.|-cn>=0 by A105,XREAL_1:50;
             1-cn>0 by A1,XREAL_1:151;
         then A113: ((p`1/|.p.|-cn)/(1-cn))>=0 by A112,REAL_2:125;
       thus x1=x2 by A2,A90,A91,A106,A107,A111,A113,REAL_2:121;
      end;
      case A114:p<>0.REAL 2 &
          (p`1/|.p.|<cn & p`2>=0);
        then A115:
         cn-FanMorphN.p= |[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
           |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]| by A1,Th58;
         set p4= |[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
           |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]|;
        A116: p4`2= |.p.|*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)) &
          p4`1= |.p.|* ((p`1/|.p.|-cn)/(1+cn)) by EUCLID:56;
        A117: q4`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))&
        q4`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by EUCLID:56;
            (q`1/|.q.|-cn)<=0 by A89,REAL_2:106;
        then A118: -(q`1/|.q.|-cn)>= -0 by XREAL_1:26;
        A119: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
            0<=(q`2)^2 by XREAL_1:65;
        then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A93,A119,REAL_1:73;
        then (q`1)^2/(|.q.|)^2 <= 1 by A93,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then -1<=q`1/|.q.| by Lm2;
        then A120: -1-cn<=q`1/|.q.|-cn by XREAL_1:11;
        A121: 1+cn>0 by A1,XREAL_1:150;
        then -(1+cn)<= -0 by XREAL_1:26;
        then (-(1+cn))/(1+cn)<=(-( q`1/|.q.|-cn))/(1+cn)
                        by A118,A121,REAL_1:73;
        then A122: -1<=(-( q`1/|.q.|-cn))/(1+cn) by A121,XCMPLX_1:198;
         -(-1-cn)>= -(q`1/|.q.|-cn) by A120,XREAL_1:26;
       then (-(q`1/|.q.|-cn))/(1+cn)<=1 by A121,REAL_2:117;
       then ((-(q`1/|.q.|-cn))/(1+cn))^2<=1^2 by A122,SQUARE_1:119;
       then 1-((-(q`1/|.q.|-cn))/(1+cn))^2>=0 by XREAL_1:50;
       then 1-(-((q`1/|.q.|-cn))/(1+cn))^2>=0 by XCMPLX_1:188;
       then A123: 1-((q`1/|.q.|-cn)/(1+cn))^2>=0;
        A124: (q4`2)^2= (|.q.|)^2*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))^2
                         by A117
         .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1+cn))^2) by A123,SQUARE_1:def 4;
        A125: (q4`1)^2= (|.q.|)^2*((q`1/|.q.|-cn)/(1+cn))^2
                         by A117;
            (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
        .=(|.q.|)^2 by A124,A125;
        then A126: sqrt((|.q4.|)^2)=|.q.| by SQUARE_1:89;
        then A127: |.q4.|=|.q.| by SQUARE_1:89;
        A128: |.p.|<>0 by A114,TOPRNS_1:25;
        then A129: (|.p.|)^2>0 by SQUARE_1:74;
            (p`1/|.p.|-cn)<=0 by A114,REAL_2:106;
        then A130: -(p`1/|.p.|-cn)>= -0 by XREAL_1:26;
        A131: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
            0<=(p`2)^2 by XREAL_1:65;
        then 0+(p`1)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
        then (p`1)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by A129,A131,REAL_1:73;
        then (p`1)^2/(|.p.|)^2 <= 1 by A129,XCMPLX_1:60;
        then ((p`1)/|.p.|)^2 <= 1 by XCMPLX_1:77;
        then -1<=p`1/|.p.| by Lm2;
        then A132: -1-cn<=p`1/|.p.|-cn by XREAL_1:11;
            -(1+cn)<= -0 by A121,XREAL_1:26;
        then (-(1+cn))/(1+cn)<=(-( p`1/|.p.|-cn))/(1+cn) by A121,A130,REAL_1:73
;
        then A133: -1<=(-( p`1/|.p.|-cn))/(1+cn) by A121,XCMPLX_1:198;
         -(-1-cn)>= -(p`1/|.p.|-cn) by A132,XREAL_1:26;
       then (-(p`1/|.p.|-cn))/(1+cn)<=1 by A121,REAL_2:117;
       then ((-(p`1/|.p.|-cn))/(1+cn))^2<=1^2 by A133,SQUARE_1:119;
       then 1-((-(p`1/|.p.|-cn))/(1+cn))^2>=0 by XREAL_1:50;
       then 1-(-((p`1/|.p.|-cn))/(1+cn))^2>=0 by XCMPLX_1:188;
       then A134: 1-((p`1/|.p.|-cn)/(1+cn))^2>=0;
        A135: (p4`2)^2= (|.p.|)^2*( sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))^2
                         by A116
         .= (|.p.|)^2*(1-((p`1/|.p.|-cn)/(1+cn))^2)
                      by A134,SQUARE_1:def 4;
        A136: (p4`1)^2= (|.p.|)^2*((p`1/|.p.|-cn)/(1+cn))^2
                         by A116;
            (|.p4.|)^2=(p4`1)^2+(p4`2)^2 by JGRAPH_3:10
        .=(|.p.|)^2 by A135,A136;
        then A137: sqrt((|.p4.|)^2)=|.p.| by SQUARE_1:89;
        then A138: |.p4.|=|.p.| by SQUARE_1:89;
            ((p`1/|.p.|-cn)/(1+cn))=|.q.|* ((q`1/|.q.|-cn)/(1+cn))/|.p.|
                         by A2,A90,A91,A115,A116,A128,XCMPLX_1:90;
        then (p`1/|.p.|-cn)/(1+cn)=(q`1/|.q.|-cn)/(1+cn)
                              by A2,A90,A115,A126,A128,A137,XCMPLX_1:90
;
        then (p`1/|.p.|-cn)/(1+cn)*(1+cn)=q`1/|.q.|-cn
                            by A121,XCMPLX_1:88;
        then p`1/|.p.|-cn=q`1/|.q.|-cn by A121,XCMPLX_1:88;
        then p`1/|.p.|-cn+cn=q`1/|.q.|;
        then p`1/|.p.|=q`1/|.q.|;
        then p`1/|.p.|*|.p.|=q`1 by A2,A90,A115,A127,A128,A138,XCMPLX_1:88;
        then A139: p`1=q`1 by A128,XCMPLX_1:88;
        A140: |.p.|^2=(p`1)^2+(p`2)^2 by JGRAPH_3:10;
            |.q.|^2=(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        then (p`2)^2+(p`1)^2-(p`1)^2=(q`2)^2 by A2,A90,A115,A127,A138,A139,A140
;
        then (p`2)^2=(q`2)^2;
        then p`2=sqrt((q`2)^2) by A114,SQUARE_1:89;
        then A141: p`2=q`2 by A89,SQUARE_1:89;
            p=|[p`1,p`2]| by EUCLID:57;
       hence x1=x2 by A139,A141,EUCLID:57;
      end;
      end;
     hence x1=x2;
    end;
    end;
   hence x1=x2;
  end;
 hence thesis by FUNCT_1:def 8;
end;

theorem Th79: for cn being Real
  st -1<cn & cn<1 holds
  (cn-FanMorphN) is Function of TOP-REAL 2,TOP-REAL 2 &
 rng (cn-FanMorphN) = the carrier of TOP-REAL 2
proof let cn be Real;
  assume A1:  -1<cn & cn<1;
thus (cn-FanMorphN) is Function of TOP-REAL 2,TOP-REAL 2;
   for f being Function of TOP-REAL 2,TOP-REAL 2 st f=(cn-FanMorphN) holds
    rng (cn-FanMorphN)=the carrier of TOP-REAL 2
  proof let f be Function of TOP-REAL 2,TOP-REAL 2;
    assume A2:f=(cn-FanMorphN);
    A3:dom f=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
        the carrier of TOP-REAL 2 c= rng f
    proof let y be set;assume y in the carrier of TOP-REAL 2;
     then reconsider p2=y as Point of TOP-REAL 2;
     set q=p2;
         now per cases by JGRAPH_2:11;
     case q`2<=0;
       then q in dom (cn-FanMorphN) & y=(cn-FanMorphN).q by A2,A3,Th56;
      hence ex x being set st x in dom (cn-FanMorphN) & y=(cn-FanMorphN).x;
     end;
     case A4: q`1/|.q.|>=0 & q`2>=0 & q<>0.REAL 2;
          set px=|[ |.q.|*(q`1/|.q.|*(1-cn)+cn),
            (|.q.|)*sqrt(1-(q`1/|.q.|*(1-cn)+cn)^2)]|;
        A5: px`2 = (|.q.|)*sqrt(1-(q`1/|.q.|*(1-cn)+cn)^2) &
         px`1 = |.q.|*(q`1/|.q.|*(1-cn)+cn) by EUCLID:56;
        then A6: |.px.|^2=((|.q.|)*sqrt(1-(q`1/|.q.|*(1-cn)+cn)^2))^2
        +(|.q.|*(q`1/|.q.|*(1-cn)+cn))^2 by JGRAPH_3:10
        .=(|.q.|)^2*(sqrt(1-(q`1/|.q.|*(1-cn)+cn)^2))^2
        +(|.q.|)^2*((q`1/|.q.|*(1-cn)+cn))^2;
       A7: |.q.|<>0 by A4,TOPRNS_1:25;
           1-cn>=0 by A1,XREAL_1:151;
       then A8: q`1/|.q.|*(1-cn)>=0 by A4,REAL_2:121;
       then A9: (q`1/|.q.|*(1-cn)+cn)>=0+cn by XREAL_1:9;
       A10: |.q.|^2>0 by A7,SQUARE_1:74;
       --(1+cn)>0 by A1,XREAL_1:150; then
       -(-1-cn)>0;
       then -1-cn<= q`1/|.q.|*(1-cn) by A8,XREAL_1:60;
       then A11: -1-cn+cn<= q`1/|.q.|*(1-cn)+cn by XREAL_1:9;
       A12: 1-cn>0 by A1,XREAL_1:151;
       A13: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
           0<=(q`2)^2 by XREAL_1:65;
       then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
       then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A10,A13,REAL_1:73;
       then (q`1)^2/(|.q.|)^2 <= 1 by A10,XCMPLX_1:60;
       then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
       then q`1/|.q.|<=1 by Lm2;
       then q`1/|.q.|*(1-cn) <=1 *(1-cn) by A12,XREAL_1:66;
       then q`1/|.q.|*(1-cn)+cn-cn <=1-cn;
       then (q`1/|.q.|*(1-cn)+cn) <=1 by XREAL_1:11;
       then 1^2>=(q`1/|.q.|*(1-cn)+cn)^2 by A11,SQUARE_1:119;
       then A14: 1-(q`1/|.q.|*(1-cn)+cn)^2>=0 by XREAL_1:50;
       then A15: |.px.|^2=(|.q.|)^2*(1-(q`1/|.q.|*(1-cn)+cn)^2)
        +(|.q.|)^2*((q`1/|.q.|*(1-cn)+cn))^2 by A6,SQUARE_1:def 4
        .= (|.q.|)^2;
        A16: |.px.|=sqrt(|.q.|^2) by A15,SQUARE_1:89
        .=|.q.| by SQUARE_1:89;
        then A17: |.px.|<>0 by A4,TOPRNS_1:25;
           sqrt(1-(q`1/|.q.|*(1-cn)+cn)^2)>=0 by A14,SQUARE_1:def 4;
        then px`1/|.px.| >=cn & px`2>=0 & px<>0.REAL 2
                                by A5,A7,A9,A16,REAL_2:121,TOPRNS_1:24
,XCMPLX_1:90;
    then A18: (cn-FanMorphN).px
       =|[ |.px.|* ((px`1/|.px.|-cn)/(1-cn)),
         |.px.|*( sqrt(1-((px`1/|.px.|-cn)/(1-cn))^2))]| by A1,Th58;
        A19: |.px.|* ((px`1/|.px.|-cn)/(1-cn))
        =|.q.|* (( ((q`1/|.q.|*(1-cn)+cn))-cn)/(1-cn)) by A5,A7,A16,XCMPLX_1:90
        .=|.q.|* ( q`1/|.q.|) by A12,XCMPLX_1:90
        .= q`1 by A7,XCMPLX_1:88;
        then A20: |.px.|*( sqrt(1-((px`1/|.px.|-cn)/(1-cn))^2))
           = |.px.|*( sqrt(1-(q`1/|.px.|)^2)) by A17,XCMPLX_1:90
           .= |.px.|*( sqrt(1-(q`1)^2/(|.px.|)^2)) by XCMPLX_1:77
           .= |.px.|*( sqrt( (|.px.|)^2/(|.px.|)^2-(q`1)^2/(|.px.|)^2))
                            by A10,A15,XCMPLX_1:60
           .= |.px.|*( sqrt( ((|.px.|)^2-(q`1)^2)/(|.px.|)^2))
                            by XCMPLX_1:121
           .= |.px.|*( sqrt( ((q`1)^2+(q`2)^2-(q`1)^2)/(|.px.|)^2))
                            by A15,JGRAPH_3:10
           .= |.px.|*( sqrt((q`2/|.q.|)^2)) by A16,XCMPLX_1:77;
             q`2/|.q.|>=0 by A4,REAL_2:125;
         then |.px.|*( sqrt((q`2/|.q.|)^2))=|.q.|*(q`2/|.q.|) by A16,
SQUARE_1:89
         .=q`2 by A7,XCMPLX_1:88;
        then A21:q=(cn-FanMorphN).px by A18,A19,A20,EUCLID:57;
            dom (cn-FanMorphN)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
      hence ex x being set st x in dom (cn-FanMorphN) & y=(cn-FanMorphN).x
                               by A21;
     end;
     case A22: q`1/|.q.|<0 & q`2>=0 & q<>0.REAL 2;
          set px=|[ |.q.|*(q`1/|.q.|*(1+cn)+cn),
            (|.q.|)*sqrt(1-(q`1/|.q.|*(1+cn)+cn)^2)]|;
        A23: px`2 = (|.q.|)*sqrt(1-(q`1/|.q.|*(1+cn)+cn)^2) &
         px`1 = |.q.|*(q`1/|.q.|*(1+cn)+cn) by EUCLID:56;
        then A24: |.px.|^2=((|.q.|)*sqrt(1-(q`1/|.q.|*(1+cn)+cn)^2))^2
        +(|.q.|*(q`1/|.q.|*(1+cn)+cn))^2 by JGRAPH_3:10
        .=(|.q.|)^2*(sqrt(1-(q`1/|.q.|*(1+cn)+cn)^2))^2
        +(|.q.|)^2*((q`1/|.q.|*(1+cn)+cn))^2;
       A25: |.q.|<>0 by A22,TOPRNS_1:25;
           1+cn>=0 by A1,XREAL_1:150;
       then A26: q`1/|.q.|*(1+cn)<=0 by A22,XREAL_1:133;
       then A27: (q`1/|.q.|*(1+cn)+cn)<=0+cn by XREAL_1:9;
       A28: |.q.|^2>0 by A25,SQUARE_1:74;
       (1-cn)>0 by A1,XREAL_1:151;
       then A29: 1-cn+cn>= q`1/|.q.|*(1+cn)+cn by A26,XREAL_1:9;
       A30: 1+cn>0 by A1,XREAL_1:150;
       A31: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
           0<=(q`2)^2 by XREAL_1:65;
       then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
       then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A28,A31,REAL_1:73;
       then (q`1)^2/(|.q.|)^2 <= 1 by A28,XCMPLX_1:60;
       then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
       then q`1/|.q.|>=-1 by Lm2;
       then q`1/|.q.|*(1+cn) >=(-1)*(1+cn) by A30,XREAL_1:66;
       then q`1/|.q.|*(1+cn)+cn-cn >=-1-cn;
       then (q`1/|.q.|*(1+cn)+cn) >=-1 by XREAL_1:11;
       then 1^2>=(q`1/|.q.|*(1+cn)+cn)^2 by A29,SQUARE_1:119;
       then A32: 1-(q`1/|.q.|*(1+cn)+cn)^2>=0 by XREAL_1:50;
       then A33: |.px.|^2=(|.q.|)^2*(1-(q`1/|.q.|*(1+cn)+cn)^2)
        +(|.q.|)^2*((q`1/|.q.|*(1+cn)+cn))^2 by A24,SQUARE_1:def 4
        .= (|.q.|)^2;
        A34: |.px.|=sqrt(|.q.|^2) by A33,SQUARE_1:89
        .=|.q.| by SQUARE_1:89;
        then A35: |.px.|<>0 by A22,TOPRNS_1:25;
           sqrt(1-(q`1/|.q.|*(1+cn)+cn)^2)>=0 by A32,SQUARE_1:def 4;
        then px`1/|.px.| <=cn & px`2>=0 & px<>0.REAL 2
                           by A23,A25,A27,A34,REAL_2:121,TOPRNS_1:24
,XCMPLX_1:90;
    then A36: (cn-FanMorphN).px
       =|[ |.px.|* ((px`1/|.px.|-cn)/(1+cn)),
         |.px.|*( sqrt(1-((px`1/|.px.|-cn)/(1+cn))^2))]|
                            by A1,Th58;
        A37: |.px.|* ((px`1/|.px.|-cn)/(1+cn))
        =|.q.|* (( ((q`1/|.q.|*(1+cn)+cn))-cn)/(1+cn)) by A23,A25,A34,
XCMPLX_1:90
        .=|.q.|* ( q`1/|.q.|) by A30,XCMPLX_1:90
        .= q`1 by A25,XCMPLX_1:88;
        then A38: |.px.|*( sqrt(1-((px`1/|.px.|-cn)/(1+cn))^2))
           = |.px.|*( sqrt(1-(q`1/|.px.|)^2)) by A35,XCMPLX_1:90
           .= |.px.|*( sqrt(1-(q`1)^2/(|.px.|)^2)) by XCMPLX_1:77
           .= |.px.|*( sqrt( (|.px.|)^2/(|.px.|)^2-(q`1)^2/(|.px.|)^2))
                            by A28,A33,XCMPLX_1:60
           .= |.px.|*( sqrt( ((|.px.|)^2-(q`1)^2)/(|.px.|)^2))
                            by XCMPLX_1:121
           .= |.px.|*( sqrt( ((q`1)^2+(q`2)^2-(q`1)^2)/(|.px.|)^2))
                            by A33,JGRAPH_3:10
           .= |.px.|*( sqrt((q`2/|.q.|)^2)) by A34,XCMPLX_1:77;
             q`2/|.q.|>=0 by A22,REAL_2:125;
         then |.px.|*( sqrt((q`2/|.q.|)^2))=|.q.|*(q`2/|.q.|) by A34,
SQUARE_1:89
         .=q`2 by A25,XCMPLX_1:88;
        then A39:q=(cn-FanMorphN).px by A36,A37,A38,EUCLID:57;
            dom (cn-FanMorphN)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
      hence ex x being set st x in dom (cn-FanMorphN) & y=(cn-FanMorphN).x
                               by A39;
     end;
     end;
    hence y in rng f by A2,FUNCT_1:def 5;
   end;
   hence rng (cn-FanMorphN)=the carrier of TOP-REAL 2 by A2,XBOOLE_0:def 10;
  end;
 hence thesis;
end;

theorem Th80: for cn being Real,p2 being Point of TOP-REAL 2
  st -1<cn & cn<1
  ex K being non empty compact Subset of TOP-REAL 2 st
  K = (cn-FanMorphN).:K &
 (ex V2 being Subset of TOP-REAL 2 st
  p2 in V2 & V2 is open & V2 c= K & (cn-FanMorphN).p2 in V2)
 proof let cn be Real,p2 be Point of TOP-REAL 2;
  assume A1: -1<cn & cn<1;
    reconsider O=0.REAL 2 as Point of Euclid 2;
    reconsider V0=Ball(O,|.p2.|+1) as Subset of TOP-REAL 2;
    A2: |. p2.|<|.p2.|+1 by XREAL_1:31;
    A3: O in V0 by GOBOARD6:4;
    A4: V0 c= cl_Ball(O,|.p2.|+1) by METRIC_1:15;
    reconsider K01=cl_Ball(O,|.p2.|+1) as Subset of TOP-REAL 2;
        K01 is compact by Th22;
    then reconsider K0=cl_Ball(O,|.p2.|+1)
          as non empty compact Subset of TOP-REAL 2 by A3,A4;
    reconsider u2=p2 as Point of Euclid 2;
    A5: (cn-FanMorphN).:K0 c= K0
     proof let y be set;assume y in (cn-FanMorphN).:K0;
       then consider x being set such that
       A6: x in dom (cn-FanMorphN) & x in K0 & y=(cn-FanMorphN).x
                     by FUNCT_1:def 12;
       reconsider q=x as Point of TOP-REAL 2 by A6;
       reconsider uq=q as Point of Euclid 2;
       A7: y in rng (cn-FanMorphN) by A6,FUNCT_1:def 5;
       then reconsider u=y as Point of Euclid 2;
       reconsider q4=y as Point of TOP-REAL 2 by A7;
       A8: |.q4.|=|.q.| by A6,Th73;
           dist(O,uq)<= |.p2.|+1 by A6,METRIC_1:13;
       then |.0.REAL 2 - q.|<= |.p2.|+1 by JGRAPH_1:45;
       then |.0.REAL 2 +- q.|<= |.p2.|+1 by EUCLID:45;
       then |. -q.|<= |.p2.|+1 by EUCLID:31;
       then |.q.|<= |.p2.|+1 by TOPRNS_1:27;
       then |. -q4.|<= |.p2.|+1 by A8,TOPRNS_1:27;
       then |.0.REAL 2 +- q4.|<= |.p2.|+1 by EUCLID:31;
       then |.0.REAL 2 - q4.|<= |.p2.|+1 by EUCLID:45;
       then dist(O,u)<= |.p2.|+1 by JGRAPH_1:45;
      hence y in K0 by METRIC_1:13;
     end;
     K0 c= (cn-FanMorphN).:K0
     proof let y be set;assume A9: y in K0;
       then reconsider u=y as Point of Euclid 2;
       reconsider q4=y as Point of TOP-REAL 2 by A9;
       the carrier of TOP-REAL 2 c= rng (cn-FanMorphN) by A1,Th79;
       then q4 in rng (cn-FanMorphN) by TARSKI:def 3;
       then consider x being set such that
       A10: x in dom (cn-FanMorphN) & y=(cn-FanMorphN).x by FUNCT_1:def 5;
       reconsider q=x as Point of TOP-REAL 2 by A10;
       reconsider uq=q as Point of Euclid 2;
       A11: |.q4.|=|.q.| by A10,Th73;
      q in K0 by A9,A11,Lm13;
      hence y in (cn-FanMorphN).:K0 by A10,FUNCT_1:def 12;
     end;
    then A12: K0= (cn-FanMorphN).:K0 by A5,XBOOLE_0:def 10;
        |. -p2.|<|.p2.|+1 by A2,TOPRNS_1:27;
    then |.0.REAL 2 +- p2.|<|.p2.|+1 by EUCLID:31;
    then |.0.REAL 2 - p2.|<|.p2.|+1 by EUCLID:45;
    then dist(O,u2)<|.p2.|+1 by JGRAPH_1:45;
    then A13: p2 in V0 by METRIC_1:12;
    A14: V0 is open by TOPMETR:21;
    set q3= (cn-FanMorphN).p2;
    reconsider u3=q3 as Point of Euclid 2;
    |.q3.|=|.p2.| by Th73;
    then |. -q3.|<|.p2.|+1 by A2,TOPRNS_1:27;
    then |.0.REAL 2 +- q3.|<|.p2.|+1 by EUCLID:31;
    then |.0.REAL 2 - q3.|<|.p2.|+1 by EUCLID:45;
    then dist(O,u3)< |.p2.|+1 by JGRAPH_1:45;
    then (cn-FanMorphN).p2 in V0 by METRIC_1:12;
   hence thesis by A4,A12,A13,A14;
 end;

theorem
  for cn being Real st -1<cn & cn<1
  ex f being Function of TOP-REAL 2,TOP-REAL 2 st f=cn-FanMorphN
   & f is_homeomorphism
proof let cn be Real;assume A1: -1<cn & cn<1;
  then A2: (cn-FanMorphN) is Function of TOP-REAL 2,TOP-REAL 2 &
  rng (cn-FanMorphN) = the carrier of TOP-REAL 2 by Th79;
  reconsider f=(cn-FanMorphN) as Function of TOP-REAL 2,TOP-REAL 2;
  consider h being Function of (TOP-REAL 2),(TOP-REAL 2)
  such that A3: h=(cn-FanMorphN) & h is continuous by A1,Th77;
  A4: f is one-to-one by A1,Th78;
  A5: rng f=[#](TOP-REAL 2) by A2;
     for p2 being Point of TOP-REAL 2
  ex K being non empty compact Subset of TOP-REAL 2 st K = f.:K &
 (ex V2 being Subset of TOP-REAL 2 st
  p2 in V2 & V2 is open & V2 c= K & f.p2 in V2) by A1,Th80;
  then f is_homeomorphism by A3,A4,A5,Th8;
 hence thesis;
end;

theorem Th82:
 for cn being Real,q being Point of TOP-REAL 2 st -1<cn & cn<1 & q`2>0
 & q`1/|.q.|>=cn holds (for p being Point of TOP-REAL 2 st
 p=(cn-FanMorphN).q holds p`2>0 & p`1>=0)
 proof let cn be Real,q be Point of TOP-REAL 2;
  assume A1: -1<cn & cn<1 &
  q`2>0 & q`1/|.q.|>=cn;
  A2: |.q.|>=0;
  let p be Point of TOP-REAL 2;
    assume p=(cn-FanMorphN).q;
    then A3: p=|[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
         |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by A1,Th56;
      set qz=p;
      A4: |.q.|<>0 by A1,JGRAPH_2:11,TOPRNS_1:25;
      then A5: (|.q.|)^2>0 by SQUARE_1:74;
     A6: 1-cn>0 by A1,XREAL_1:151;
        A7: qz`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))&
        qz`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by A3,EUCLID:56;
        A8: (q`1/|.q.|-cn)>= 0 by A1,XREAL_1:50;
        A9: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
            0<(q`2)^2 by A1,SQUARE_1:74;
        then 0+(q`1)^2<(q`1)^2+(q`2)^2 by XREAL_1:10;
        then (q`1)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A5,A9,REAL_1:73;
        then (q`1)^2/(|.q.|)^2 < 1 by A5,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 < 1 by XCMPLX_1:77;
        then 1>q`1/|.q.| by Lm3;
        then A10: 1-cn>q`1/|.q.|-cn by XREAL_1:11;
        A11: -(1-cn)< -0 by A6,XREAL_1:26;
             -(1-cn)< -( q`1/|.q.|-cn) by A10,XREAL_1:26;
         then (-(1-cn))/(1-cn)<(-( q`1/|.q.|-cn))/(1-cn)
                        by A6,REAL_1:73;
        then A12: -1<(-( q`1/|.q.|-cn))/(1-cn) by A6,XCMPLX_1:198;
           --(1-cn)> -(q`1/|.q.|-cn) by A8,A11,XREAL_1:26;
       then (-(q`1/|.q.|-cn))/(1-cn)<1 by A6,REAL_2:118;
       then ((-(q`1/|.q.|-cn))/(1-cn))^2<1^2 by A12,SQUARE_1:120;
       then 1-((-(q`1/|.q.|-cn))/(1-cn))^2>0 by XREAL_1:52;
       then sqrt(1-((-(q`1/|.q.|-cn))/(1-cn))^2)>0 by SQUARE_1:93;
       then sqrt(1-(-(q`1/|.q.|-cn))^2/(1-cn)^2)> 0 by XCMPLX_1:77;
       then sqrt(1-(q`1/|.q.|-cn)^2/(1-cn)^2)> 0;
       then A13: sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)> 0 by XCMPLX_1:77;
           ((q`1/|.q.|-cn)/(1-cn))>=0 by A6,A8,XREAL_1:138;
   hence p`2>0 & p`1>=0 by A2,A4,A7,A13,XREAL_1:129,131;
 end;

theorem Th83:
 for cn being Real,q being Point of TOP-REAL 2 st -1<cn & cn<1 & q`2>0
 & q`1/|.q.|<cn holds (for p being Point of TOP-REAL 2 st
 p=(cn-FanMorphN).q holds p`2>0 & p`1<0)
 proof let cn be Real,q be Point of TOP-REAL 2;
  assume A1: -1<cn & cn<1 & q`2>0 & q`1/|.q.|<cn;
  A2: |.q.|>=0;
  let p be Point of TOP-REAL 2;
    assume p=(cn-FanMorphN).q;
    then A3: p=|[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
      |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]| by A1,Th57;
      set qz=p;
          A4: |.q.|<>0 by A1,JGRAPH_2:11,TOPRNS_1:25;
      then A5: (|.q.|)^2>0 by SQUARE_1:74;
      A6: (q`1/|.q.|-cn)< 0 by A1,REAL_2:105;
     A7: 1+cn>0 by A1,XREAL_1:150;
        A8: qz`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))&
        qz`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by A3,EUCLID:56;
        A9: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
            0<(q`2)^2 by A1,SQUARE_1:74;
        then 0+(q`1)^2<(q`1)^2+(q`2)^2 by XREAL_1:10;
        then (q`1)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A5,A9,REAL_1:73;
        then (q`1)^2/(|.q.|)^2 < 1 by A5,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 < 1 by XCMPLX_1:77;
        then -1<q`1/|.q.| by Lm3;
        then -1-cn<q`1/|.q.|-cn by XREAL_1:11;
        then -(1+cn) < (q`1/|.q.|-cn);
        then A10: --(1+cn)> -(q`1/|.q.|-cn) by XREAL_1:26;
        A11: -( q`1/|.q.|-cn)>0 by A6,XREAL_1:60;
            -(1+cn)< -0 by A7,XREAL_1:26;
         then (-(1+cn))/(1+cn)<(-( q`1/|.q.|-cn))/(1+cn) by A11,A7,REAL_1:73;
        then A12: -1<(-( q`1/|.q.|-cn))/(1+cn) by A7,XCMPLX_1:198;
           (-(q`1/|.q.|-cn))/(1+cn)<1 by A7,A10,REAL_2:118;
       then ((-(q`1/|.q.|-cn))/(1+cn))^2<1^2 by A12,SQUARE_1:120;
       then 1-((-(q`1/|.q.|-cn))/(1+cn))^2>0 by XREAL_1:52;
       then sqrt(1-((-(q`1/|.q.|-cn))/(1+cn))^2)>0 by SQUARE_1:93;
       then sqrt(1-(-(q`1/|.q.|-cn))^2/(1+cn)^2)> 0 by XCMPLX_1:77;
       then sqrt(1-(q`1/|.q.|-cn)^2/(1+cn)^2)> 0;
       then A13: sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)> 0 by XCMPLX_1:77;
           ((q`1/|.q.|-cn)/(1+cn))<0 by A6,A7,REAL_2:128;
   hence p`2>0 & p`1<0 by A2,A4,A8,A13,XREAL_1:131,134;
 end;

theorem Th84:
 for cn being Real,q1,q2 being Point of TOP-REAL 2 st -1<cn & cn<1 & q1`2>0
 & q1`1/|.q1.|>=cn & q2`2>0 & q2`1/|.q2.|>=cn & q1`1/|.q1.|<q2`1/|.q2.|
 holds (for p1,p2 being Point of TOP-REAL 2 st
 p1=(cn-FanMorphN).q1 & p2=(cn-FanMorphN).q2 holds p1`1/|.p1.|<p2`1/|.p2.|)
 proof let cn be Real,q1,q2 be Point of TOP-REAL 2;
  assume A1: -1<cn & cn<1 & q1`2>0
   & q1`1/|.q1.|>=cn & q2`2>0 & q2`1/|.q2.|>=cn & q1`1/|.q1.|<q2`1/|.q2.|;
  let p1,p2 be Point of TOP-REAL 2;
   assume A2: p1=(cn-FanMorphN).q1 & p2=(cn-FanMorphN).q2;
    then p1=|[ |.q1.|* ((q1`1/|.q1.|-cn)/(1-cn)),
       |.q1.|*( sqrt(1-((q1`1/|.q1.|-cn)/(1-cn))^2))]| by A1,Th56;
    then A3: p1`2= |.q1.|*( sqrt(1-((q1`1/|.q1.|-cn)/(1-cn))^2))&
        p1`1= |.q1.|* ((q1`1/|.q1.|-cn)/(1-cn)) by EUCLID:56;
        p2=|[ |.q2.|* ((q2`1/|.q2.|-cn)/(1-cn)),
      |.q2.|*( sqrt(1-((q2`1/|.q2.|-cn)/(1-cn))^2))]| by A1,A2,Th56;
    then A4: p2`2= |.q2.|*( sqrt(1-((q2`1/|.q2.|-cn)/(1-cn))^2))&
        p2`1= |.q2.|* ((q2`1/|.q2.|-cn)/(1-cn)) by EUCLID:56;
    A5: |.q1.|>0 & |.q2.|>0 by A1,Lm1,JGRAPH_2:11;
    A6: |.p1.|=|.q1.| & |.p2.|=|.q2.| by A2,Th73;
    then A7: p1`1/|.p1.|= ((q1`1/|.q1.|-cn)/(1-cn)) by A3,A5,XCMPLX_1:90;
    A8: p2`1/|.p2.|= ((q2`1/|.q2.|-cn)/(1-cn)) by A4,A5,A6,XCMPLX_1:90;
    A9: q1`1/|.q1.|-cn< q2`1/|.q2.|-cn by A1,XREAL_1:11;
        1-cn>0 by A1,XREAL_1:151;
   hence thesis by A7,A8,A9,REAL_1:73;
 end;

theorem Th85:
 for cn being Real,q1,q2 being Point of TOP-REAL 2 st -1<cn & cn<1 & q1`2>0
 & q1`1/|.q1.|<cn & q2`2>0 & q2`1/|.q2.|<cn & q1`1/|.q1.|<q2`1/|.q2.|
 holds (for p1,p2 being Point of TOP-REAL 2 st
 p1=(cn-FanMorphN).q1 & p2=(cn-FanMorphN).q2 holds p1`1/|.p1.|<p2`1/|.p2.|)
 proof let cn be Real,q1,q2 be Point of TOP-REAL 2;
  assume A1: -1<cn & cn<1 & q1`2>0
   & q1`1/|.q1.|<cn & q2`2>0 & q2`1/|.q2.|<cn & q1`1/|.q1.|<q2`1/|.q2.|;
  let p1,p2 be Point of TOP-REAL 2;
   assume A2: p1=(cn-FanMorphN).q1 & p2=(cn-FanMorphN).q2;
    then p1=|[ |.q1.|* ((q1`1/|.q1.|-cn)/(1+cn)),
      |.q1.|*( sqrt(1-((q1`1/|.q1.|-cn)/(1+cn))^2))]| by A1,Th57;
    then A3: p1`2= |.q1.|*( sqrt(1-((q1`1/|.q1.|-cn)/(1+cn))^2))&
        p1`1= |.q1.|* ((q1`1/|.q1.|-cn)/(1+cn)) by EUCLID:56;
        p2=|[ |.q2.|* ((q2`1/|.q2.|-cn)/(1+cn)),
      |.q2.|*( sqrt(1-((q2`1/|.q2.|-cn)/(1+cn))^2))]| by A1,A2,Th57;
    then A4: p2`2= |.q2.|*( sqrt(1-((q2`1/|.q2.|-cn)/(1+cn))^2))&
        p2`1= |.q2.|* ((q2`1/|.q2.|-cn)/(1+cn)) by EUCLID:56;
    A5: |.q1.|>0 & |.q2.|>0 by A1,Lm1,JGRAPH_2:11;
    A6: |.p1.|=|.q1.| & |.p2.|=|.q2.| by A2,Th73;
    then A7: p1`1/|.p1.|= ((q1`1/|.q1.|-cn)/(1+cn)) by A3,A5,XCMPLX_1:90;
    A8: p2`1/|.p2.|= ((q2`1/|.q2.|-cn)/(1+cn)) by A4,A5,A6,XCMPLX_1:90;
    A9: q1`1/|.q1.|-cn< q2`1/|.q2.|-cn by A1,XREAL_1:11;
        1+cn>0 by A1,XREAL_1:150;
   hence p1`1/|.p1.|<p2`1/|.p2.| by A7,A8,A9,REAL_1:73;
 end;

theorem
     for cn being Real,q1,q2 being Point of TOP-REAL 2 st -1<cn & cn<1 & q1`2>0
 & q2`2>0 & q1`1/|.q1.|<q2`1/|.q2.|
 holds (for p1,p2 being Point of TOP-REAL 2 st
 p1=(cn-FanMorphN).q1 & p2=(cn-FanMorphN).q2 holds p1`1/|.p1.|<p2`1/|.p2.|)
 proof let cn be Real,q1,q2 be Point of TOP-REAL 2;
  assume A1: -1<cn & cn<1 & q1`2>0
    & q2`2>0 & q1`1/|.q1.|<q2`1/|.q2.|;
  let p1,p2 be Point of TOP-REAL 2;
   assume A2: p1=(cn-FanMorphN).q1 & p2=(cn-FanMorphN).q2;
    per cases;
    suppose q1`1/|.q1.|>=cn & q2`1/|.q2.|>=cn;
     hence p1`1/|.p1.|<p2`1/|.p2.| by A1,A2,Th84;
    end;
    suppose q1`1/|.q1.|>=cn & q2`1/|.q2.|<cn;
     hence p1`1/|.p1.|<p2`1/|.p2.| by A1,XXREAL_0:2;
    end;
    suppose A3: q1`1/|.q1.|<cn & q2`1/|.q2.|>=cn;
       then A4: p1`2>0 & p1`1<0 by A1,A2,Th83;
       then A5: |.p1.|>0 by Lm1,JGRAPH_2:11;
       A6: p2`2>0 & p2`1>=0 by A1,A2,A3,Th82;
       p2`1/|.p2.|>=0 by A6,REAL_2:125;
     hence p1`1/|.p1.|<p2`1/|.p2.| by A4,A5,REAL_2:128;
    end;
    suppose q1`1/|.q1.|<cn & q2`1/|.q2.|<cn;
     hence p1`1/|.p1.|<p2`1/|.p2.| by A1,A2,Th85;
    end;
 end;

theorem
 for cn being Real,q being Point of TOP-REAL 2 st -1<cn & cn<1 & q`2>0
 & q`1/|.q.|=cn holds (for p being Point of TOP-REAL 2 st
 p=(cn-FanMorphN).q holds p`2>0 & p`1=0)
 proof let cn be Real,q be Point of TOP-REAL 2;
  assume A1: -1<cn & cn<1 & q`2>0 & q`1/|.q.|=cn;
  A2: |.q.|>=0;
  let p be Point of TOP-REAL 2;
   assume p=(cn-FanMorphN).q;
    then A3: p=|[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
      |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by A1,Th56;
     A4: |.q.|<>0 by A1,JGRAPH_2:11,TOPRNS_1:25;
     A5: p`2= |.q.|*( sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))&
        p`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by A3,EUCLID:56;
           ((-(q`1/|.q.|-cn))/(1-cn))^2<1^2 by A1;
       then 1-((-(q`1/|.q.|-cn))/(1-cn))^2>0 by XREAL_1:52;
       then sqrt(1-((-(q`1/|.q.|-cn))/(1-cn))^2)>0 by SQUARE_1:93;
       then sqrt(1-(-(q`1/|.q.|-cn))^2/(1-cn)^2)> 0 by XCMPLX_1:77;
       then sqrt(1-(q`1/|.q.|-cn)^2/(1-cn)^2)> 0;
       then sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)> 0 by XCMPLX_1:77;
   hence thesis by A1,A2,A4,A5,XREAL_1:131;
 end;

theorem
  for cn being real number holds 0.REAL 2=(cn-FanMorphN).(0.REAL 2)
   by Th56,JGRAPH_2:11;

begin :: Fan Morphism for East

definition let s be real number, q be Point of TOP-REAL 2;
  func FanE(s,q) -> Point of TOP-REAL 2 equals
  :Def6: |.q.|*|[sqrt(1-((q`2/|.q.|-s)/(1-s))^2),
          (q`2/|.q.|-s)/(1-s)]| if q`2/|.q.|>=s & q`1>0,
       |.q.|*|[sqrt(1-((q`2/|.q.|-s)/(1+s))^2),
          (q`2/|.q.|-s)/(1+s)]| if q`2/|.q.|<s & q`1>0
   otherwise q;
 correctness;
end;

definition let s be real number;
  func s-FanMorphE -> Function of TOP-REAL 2, TOP-REAL 2 means
  :Def7: for q being Point of TOP-REAL 2 holds
       it.q=FanE(s,q);
 existence
  proof
    deffunc F(Point of TOP-REAL 2)=FanE(s,$1);
    thus ex IT being Function of TOP-REAL 2, TOP-REAL 2 st
  for q being Point of TOP-REAL 2 holds
       IT.q=F(q)from FUNCT_2:sch 4;
  end;
 uniqueness
  proof
    deffunc F(Point of TOP-REAL 2)=FanE(s,$1);
    thus for a,b being Function of TOP-REAL 2, TOP-REAL 2 st
  (for q being Point of TOP-REAL 2 holds a.q=F(q)) &
  (for q being Point of TOP-REAL 2 holds b.q=F(q)) holds a=b
    from BINOP_2:sch 1;
  end;
end;

theorem Th89: for sn being real number holds
  (q`2/|.q.|>=sn & q`1>0 implies
    sn-FanMorphE.q= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1-sn))]|)&
  (q`1<=0 implies sn-FanMorphE.q=q)
proof let sn be real number;
  A1: sn-FanMorphE.q=FanE(sn,q) by Def7;
   hereby assume q`2/|.q.|>=sn & q`1>0;
    then FanE(sn,q)= |.q.|*|[sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2),
          (q`2/|.q.|-sn)/(1-sn)]| by Def6
          .= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by EUCLID:62;
     hence sn-FanMorphE.q= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by Def7;
    end;
   assume q`1<=0; hence thesis by A1,Def6;
end;

theorem Th90: for sn being Real holds
  (q`2/|.q.|<=sn & q`1>0 implies
    sn-FanMorphE.q= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
           |.q.|*((q`2/|.q.|-sn)/(1+sn))]|)
proof let sn be Real;
   assume A1: q`2/|.q.|<=sn & q`1>0;
       now per cases by A1,REAL_1:def 5;
   case q`2/|.q.|<sn;
    then FanE(sn,q)= |.q.|*|[sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2),
          (q`2/|.q.|-sn)/(1+sn)]| by A1,Def6
          .= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1+sn))]| by EUCLID:62;
    hence sn-FanMorphE.q= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
           |.q.|*((q`2/|.q.|-sn)/(1+sn))]| by Def7;
   end;
   case A2: q`2/|.q.|=sn;
     (q`2/|.q.|-sn)/(1-sn)=0 by A2;
    hence sn-FanMorphE.q= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
           |.q.|*((q`2/|.q.|-sn)/(1+sn))]| by A1,A2,Th89;
   end;
   end;
   hence thesis;
end;

theorem Th91: for sn being Real st -1<sn & sn<1 holds
  (q`2/|.q.|>=sn & q`1>=0 & q<>0.REAL 2 implies
    sn-FanMorphE.q = |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1-sn))]|) &
  (q`2/|.q.|<=sn & q`1>=0 & q<>0.REAL 2 implies
    sn-FanMorphE.q = |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
           |.q.|*((q`2/|.q.|-sn)/(1+sn))]|)
proof let sn be Real;
 assume A1: -1<sn & sn<1;
  per cases;
   suppose A2: q`2/|.q.|>=sn & q`1>=0 & q<>0.REAL 2;
   per cases;
    suppose A3: q`1>0;
      then FanE(sn,q)= |.q.|*|[sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2),
          (q`2/|.q.|-sn)/(1-sn)]| by A2,Def6
          .= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by EUCLID:62;
     hence thesis by A3,Def7,Th90;
    end;
    suppose A4: q`1<=0;
     then A5: sn-FanMorphE.q=q by Th89;
     A6: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
     A7: |.q.|<>0 by A2,TOPRNS_1:25;
     then A8: |.q.|^2>0 by SQUARE_1:74;
     A9: q`1=0 by A2,A4;
     A10: |.q.|>=0;
     A11: sqrt((|.q.|)^2)=|.q.| by SQUARE_1:89;
     A12: 1-sn>0 by A1,XREAL_1:151;
      (q`2)^2/|.q.|^2=1^2 by A6,A8,A9,XCMPLX_1:60;
      then ((q`2)/|.q.|)^2=1^2 by XCMPLX_1:77;
      then A13: sqrt(((q`2)/|.q.|)^2)=1 by SQUARE_1:89;
      now assume q`2<0;
       then q`2/|.q.|<0 by A7,A10,REAL_2:128;
       then -((q`2)/|.q.|)=1 by A13,SQUARE_1:90;
      hence contradiction by A1,A2;
     end;
     then A14: |.q.|=q`2 by A6,A9,A11,SQUARE_1:89;
     then 1=q`2/|.q.| by A7,XCMPLX_1:60;
     then A15:(q`2/|.q.|-sn)/(1-sn)=1 by A12,XCMPLX_1:60;
     sn-FanMorphE.q = |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by  A5,A9,A14,A15,EUCLID:57,
 SQUARE_1:82;
     hence thesis by A1,A7,A14,XCMPLX_1:60;
    end;
   end;
   suppose A16: q`2/|.q.|<=sn & q`1>=0 & q<>0.REAL 2;
    per cases;
    suppose q`1>0;
     hence thesis by Th89,Th90;
    end;
    suppose A17: q`1<=0;
     A18: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
     A19: |.q.|<>0 by A16,TOPRNS_1:25;
     A20: q`1=0 by A16,A17;
      A21: |.q.|>=0;
     A22: 1+sn>0 by A1,XREAL_1:150;
      1>q`2/|.q.| by A1,A16,XXREAL_0:2;
     then 1 *(|.q.|)>q`2/|.q.|*(|.q.|) by A19,A21,XREAL_1:70;
     then A23: (|.q.|)>q`2 by A19,XCMPLX_1:88;
     then A24: |.q.|=-q`2 by A18,A20,SQUARE_1:109;
     A25: q`2= -(|.q.|) by A18,A20,A23,SQUARE_1:109;
     then -1=q`2/|.q.| by A19,XCMPLX_1:198;
     then (q`2/|.q.|-sn)/(1+sn)
     =(-(1+sn))/(1+sn) .=-1 by A22,XCMPLX_1:198;
     then |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
     |.q.|* ((q`2/|.q.|-sn)/(1+sn))]|
      =q by A20,A24,EUCLID:57,SQUARE_1:82;
     hence thesis by A1,A17,A19,A25,Th89,XCMPLX_1:198;
    end;
   end;
   suppose q`1<0 or q=0.REAL 2;
    hence thesis;
   end;
end;

theorem Th92:
 for sn being Real,K1 being non empty Subset of TOP-REAL 2,
f being Function of (TOP-REAL 2)|K1,R^1 st
  -1<sn & sn<1 &
(for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|* ((p`2/|.p.|-sn)/(1-sn)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1>=0 & q<>0.REAL 2) holds
f is continuous
proof
 let sn be Real,K1 be non empty Subset of TOP-REAL 2,
f be Function of (TOP-REAL 2)|K1,R^1;
 assume A1: -1<sn & sn<1 &
(for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|* ((p`2/|.p.|-sn)/(1-sn)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1>=0 & q<>0.REAL 2);
  set a=sn, b=(1-sn);
  A2: b>0 by A1,XREAL_1:151;
  reconsider g2=proj2|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm5;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1
                          by Lm7;
      for q being Point of TOP-REAL 2 st q in
    the carrier of (TOP-REAL 2)|K1 holds q<>0.REAL 2 by A1;
  then for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm8;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
  A3: (for q being Point of
  (TOP-REAL 2)|K1,r1,r2 being Real st g2.q=r1 & g1.q=r2
  holds g3.q=r2*((r1/r2-a)/b)) & g3 is continuous by A2,Th10;
  A4:dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then A5:dom f=dom g3 by FUNCT_2:def 1;
      for x being set st x in dom f holds f.x=g3.x
   proof let x be set;assume
     A6: x in dom f;
     then x in K1 by A4,A5,PRE_TOPC:29;
     then reconsider r=x as Point of (TOP-REAL 2);
     reconsider s=x as Point of (TOP-REAL 2)|K1 by A6;
     A7:f.r=(|.r.|)* ((r`2/|.r.|-sn)/(1-sn)) by A1,A6;
     A8:g2.s=proj2.s by Lm5;
     A9:g1.s=(2 NormF).s by Lm7;
     A10:proj2.r=r`2 by PSCOMP_1:def 29;
         (2 NormF).r=|.r.| by Def1;
    hence f.x=g3.x by A3,A7,A8,A9,A10;
   end;
hence f is continuous by A3,A5,FUNCT_1:9;
end;

theorem Th93:
 for sn being Real,K1 being non empty Subset of TOP-REAL 2,
f being Function of (TOP-REAL 2)|K1,R^1 st
  -1<sn & sn<1 &
(for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|* ((p`2/|.p.|-sn)/(1+sn)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1>=0 & q<>0.REAL 2) holds
f is continuous
proof
 let sn be Real,K1 be non empty Subset of TOP-REAL 2,
f be Function of (TOP-REAL 2)|K1,R^1;
 assume A1: -1<sn & sn<1 &
(for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|* ((p`2/|.p.|-sn)/(1+sn)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1>=0 & q<>0.REAL 2);
  set a=sn, b=(1+sn);
  A2: 1+sn>0 by A1,XREAL_1:150;
  reconsider g2=proj2|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm5;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1
                          by Lm7;
      for q being Point of TOP-REAL 2 st q in
    the carrier of (TOP-REAL 2)|K1 holds q<>0.REAL 2 by A1;
  then for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm8;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
  A3: (for q being Point of
  (TOP-REAL 2)|K1,r1,r2 being Real st g2.q=r1 & g1.q=r2
  holds g3.q=r2*((r1/r2-a)/b)) & g3 is continuous by A2,Th10;
  A4:dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then A5:dom f=dom g3 by FUNCT_2:def 1;
      for x being set st x in dom f holds f.x=g3.x
   proof let x be set;assume
     A6: x in dom f; then A7: x in dom g3 by A4;
     then x in K1 by A4,PRE_TOPC:29;
     then reconsider r=x as Point of (TOP-REAL 2);
     reconsider s=x as Point of (TOP-REAL 2)|K1 by A6;
     A8:f.r=(|.r.|)* ((r`2/|.r.|-sn)/(1+sn)) by A1,A7;
     A9:g2.s=proj2.s by Lm5;
     A10:g1.s=(2 NormF).s by Lm7;
     A11:proj2.r=r`2 by PSCOMP_1:def 29;
         (2 NormF).r=|.r.| by Def1;
    hence f.x=g3.x by A3,A8,A9,A10,A11;
   end;
hence f is continuous by A3,A5,FUNCT_1:9;
end;

theorem Th94:
 for sn being Real,K1 being non empty Subset of TOP-REAL 2,
f being Function of (TOP-REAL 2)|K1,R^1 st -1<sn & sn<1 &
(for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds
        q`1>=0 & q`2/|.q.|>=sn & q<>0.REAL 2) holds
f is continuous
proof
 let sn be Real,K1 be non empty Subset of TOP-REAL 2,
f be Function of (TOP-REAL 2)|K1,R^1;
 assume A1: -1<sn & sn<1 &
(for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds
            q`1>=0 & q`2/|.q.|>=sn & q<>0.REAL 2);
  set a=sn, b=(1-sn);
  A2: b>0 by A1,XREAL_1:151;
  reconsider g2=proj2|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm5;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1
                          by Lm7;
      for q being Point of TOP-REAL 2 st q in
    the carrier of (TOP-REAL 2)|K1 holds q<>0.REAL 2 by A1;
  then for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm8;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
  A3: (for q being Point of
  (TOP-REAL 2)|K1,r1,r2 being real number st g2.q=r1 & g1.q=r2
  holds g3.q=r2*(sqrt(abs(1-((r1/r2-a)/b)^2))))
          & g3 is continuous by A2,Th15;
  A4:dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then A5:dom f=dom g3 by FUNCT_2:def 1;
      for x being set st x in dom f holds f.x=g3.x
   proof let x be set;assume
     A6: x in dom f;
     then x in K1 by A4,A5,PRE_TOPC:29;
     then reconsider r=x as Point of (TOP-REAL 2);
     reconsider s=x as Point of (TOP-REAL 2)|K1 by A6;
     A7: now assume |.r.|=0; then r=0.REAL 2 by TOPRNS_1:25;
      hence contradiction by A1,A6;
     end;
     A8: |.r.|>=0;
         |.r.|^2=(r`1)^2+(r`2)^2 by JGRAPH_3:10;
     then (r`2)^2 -(|.r.|)^2 =-(r`1)^2;
     then A9: ((r`2) -(|.r.|))*((r`2)+|.r.|) =-(r`1)^2;
         (r`1)^2>=0 by XREAL_1:65;
     then -(r`1)^2 <=0 by XREAL_1:60;
     then -(|.r.|)<=r`2 & r`2<= |.r.| by A9,XREAL_1:95;
     then r`2/|.r.| <= |.r.|/|.r.| by A7,A8,REAL_1:73;
     then r`2/|.r.|<=1 by A7,XCMPLX_1:60;
     then A10: r`2/|.r.|-sn<=(1-sn) by XREAL_1:11;
     A11: now assume (1-sn)^2=0;
       then 1-sn+sn=0+sn by XCMPLX_1:6;
      hence contradiction by A1;
     end;
     A12: 1-sn>0 by A1,XREAL_1:151;
      A13: (1-sn)^2>=0 by XREAL_1:65;
         sn<=r`2/(|.r.|) by A1,A6;
     then sn-r`2/|.r.|<=0 by REAL_2:106;
     then -(sn- r`2/|.r.|)>=-(1-sn) by A12,XREAL_1:26;
     then (r`2/|.r.|-sn)^2<=(1-sn)^2 by A10,SQUARE_1:119;
     then (r`2/|.r.|-sn)^2/(1-sn)^2<=(1-sn)^2/(1-sn)^2 by A11,A13,REAL_1:73;
     then (r`2/|.r.|-sn)^2/(1-sn)^2<=1 by A11,XCMPLX_1:60;
     then ((r`2/|.r.|-sn)/(1-sn))^2<=1 by XCMPLX_1:77;
     then 1-((r`2/|.r.|-sn)/(1-sn))^2>=0 by XREAL_1:50;
     then abs(1-((r`2/|.r.|-sn)/(1-sn))^2)
          =1-((r`2/|.r.|-sn)/(1-sn))^2 by ABSVALUE:def 1;
     then A14:f.r=(|.r.|)*(sqrt(abs(1-((r`2/|.r.|-sn)/(1-sn))^2))) by A1,A6;
     A15:g2.s=proj2.s by Lm5;
     A16:g1.s=(2 NormF).s by Lm7;
     A17:proj2.r=r`2 by PSCOMP_1:def 29;
         (2 NormF).r=|.r.| by Def1;
    hence f.x=g3.x by A3,A14,A15,A16,A17;
   end;
hence f is continuous by A3,A5,FUNCT_1:9;
end;

theorem Th95:
 for sn being Real,K1 being non empty Subset of TOP-REAL 2,
f being Function of (TOP-REAL 2)|K1,R^1 st
  -1<sn & sn<1 &
(for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds
        q`1>=0 & q`2/|.q.|<=sn & q<>0.REAL 2) holds
f is continuous
proof
 let sn be Real,K1 be non empty Subset of TOP-REAL 2,
f be Function of (TOP-REAL 2)|K1,R^1;
 assume A1:-1<sn & sn<1 &
(for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds
            q`1>=0 & q`2/|.q.|<=sn & q<>0.REAL 2);
  set a=sn, b=(1+sn);
  A2: 1+sn>0 by A1,XREAL_1:150;
  reconsider g2=proj2|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm5;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1
                          by Lm7;
      for q being Point of TOP-REAL 2 st q in
    the carrier of (TOP-REAL 2)|K1 holds q<>0.REAL 2 by A1;
  then for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm8;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
  A3: (for q being Point of
  (TOP-REAL 2)|K1,r1,r2 being real number st g2.q=r1 & g1.q=r2
  holds g3.q=r2*(sqrt(abs(1-((r1/r2-a)/b)^2))))
          & g3 is continuous by A2,Th15;
  A4:dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then A5:dom f=dom g3 by FUNCT_2:def 1;
      for x being set st x in dom f holds f.x=g3.x
   proof let x be set;assume
     A6:x in dom f;
     then x in K1 by A4,A5,PRE_TOPC:29;
     then reconsider r=x as Point of (TOP-REAL 2);
     reconsider s=x as Point of (TOP-REAL 2)|K1 by A6;
     A7: now assume |.r.|=0; then r=0.REAL 2 by TOPRNS_1:25;
      hence contradiction by A1,A6;
     end;
     A8: |.r.|>=0;
         |.r.|^2=(r`1)^2+(r`2)^2 by JGRAPH_3:10;
     then (r`2)^2 -(|.r.|)^2 =-(r`1)^2;
     then A9: ((r`2) -(|.r.|))*((r`2)+|.r.|) =-(r`1)^2;
         (r`1)^2>=0 by XREAL_1:65;
     then -(r`1)^2 <=0 by XREAL_1:60;
     then -(|.r.|)<=r`2 & r`2<= |.r.| by A9,XREAL_1:95;
     then r`2/|.r.| >= (-(|.r.|))/|.r.| by A7,A8,REAL_1:73;
     then r`2/|.r.|>= -1 by A7,XCMPLX_1:198;
     then r`2/|.r.|-sn>=-1-sn by XREAL_1:11;
     then A10: r`2/|.r.|-sn>=-(1+sn);
     A11: (1+sn)^2>0 by A2,SQUARE_1:74;
         sn>=r`2/(|.r.|) by A1,A6;
     then sn-r`2/|.r.|>=0 by XREAL_1:50;
     then -(sn-r`2/|.r.|)<=-0 by XREAL_1:26;
     then (r`2/|.r.|-sn)^2<=(1+sn)^2 by A10,A2,SQUARE_1:119;
     then (r`2/|.r.|-sn)^2/(1+sn)^2<=(1+sn)^2/(1+sn)^2 by A11,REAL_1:73;
     then (r`2/|.r.|-sn)^2/(1+sn)^2<=1 by A11,XCMPLX_1:60;
     then ((r`2/|.r.|-sn)/(1+sn))^2<=1 by XCMPLX_1:77;
     then 1-((r`2/|.r.|-sn)/(1+sn))^2>=0 by XREAL_1:50;
     then abs(1-((r`2/|.r.|-sn)/(1+sn))^2)
          =1-((r`2/|.r.|-sn)/(1+sn))^2 by ABSVALUE:def 1;
     then A12:f.r=(|.r.|)*(sqrt(abs(1-((r`2/|.r.|-sn)/(1+sn))^2))) by A1,A6;
     A13:g2.s=proj2.s by Lm5;
     A14:g1.s=(2 NormF).s by Lm7;
     A15:proj2.r=r`2 by PSCOMP_1:def 29;
         (2 NormF).r=|.r.| by Def1;
    hence f.x=g3.x by A3,A12,A13,A14,A15;
   end;
hence f is continuous by A3,A5,FUNCT_1:9;
end;

theorem Th96: for sn being Real,
K0,B0 being Subset of TOP-REAL 2,f being
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0
st -1<sn & sn<1 & f=(sn-FanMorphE)|K0 &
B0={q where q is Point of TOP-REAL 2: q`1>=0 & q<>0.REAL 2}
& K0={p: p`2/|.p.|>=sn & p`1>=0 & p<>0.REAL 2}
holds f is continuous
proof let sn be Real,K0,B0 be Subset of TOP-REAL 2,f be
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0;
assume A1: -1<sn & sn<1 & f=(sn-FanMorphE)|K0 &
B0={q where q is Point of TOP-REAL 2: q`1>=0 & q<>0.REAL 2} &
K0={p: p`2/|.p.|>=sn & p`1>=0 & p<>0.REAL 2};
 set cn=sqrt(1-sn^2);
 set p0=|[cn,sn]|;
 A2: p0`2=sn by EUCLID:56;
 A3: p0`1=cn by EUCLID:56;
       sn^2<1^2 by A1,SQUARE_1:120;
 then A4: 1-sn^2>0 by XREAL_1:52;
 then A5: --cn>0 by SQUARE_1:93;
 A6: |.p0.|=sqrt((cn)^2+sn^2) by A2,A3,JGRAPH_3:10;
     cn^2=1-sn^2 by A4,SQUARE_1:def 4;
 then p0`2/|.p0.|=sn by A6,EUCLID:56,SQUARE_1:83;
 then A7: p0 in K0 by A1,A3,A5,JGRAPH_2:11;
then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
  A8: K0 c= B0
   proof let x be set;assume x in K0;
      then consider p8 being Point of TOP-REAL 2 such that
      A9: x=p8 & (p8`2/|.p8.|>=sn & p8`1>=0 & p8<>0.REAL 2) by A1;
    thus x in B0 by A1,A9;
   end;
A10:dom (proj2*((sn-FanMorphE)|K1)) c= dom ((sn-FanMorphE)|K1)
                                  by RELAT_1:44;
   dom ((sn-FanMorphE)|K1) c= dom (proj2*((sn-FanMorphE)|K1))
proof let x be set;assume A11:x in dom ((sn-FanMorphE)|K1);
   then A12:x in dom (sn-FanMorphE) /\ K1 by FUNCT_1:68;
   A13:((sn-FanMorphE)|K1).x=(sn-FanMorphE).x by A11,FUNCT_1:68;
   A14: dom proj2 = (the carrier of TOP-REAL 2) by FUNCT_2:def 1;
       x in dom (sn-FanMorphE) by A12,XBOOLE_0:def 3;
   then (sn-FanMorphE).x in rng (sn-FanMorphE) by FUNCT_1:12;
  hence x in dom (proj2*((sn-FanMorphE)|K1)) by A11,A13,A14,FUNCT_1:21;
end;
then A15:dom (proj2*((sn-FanMorphE)|K1))
=dom ((sn-FanMorphE)|K1) by A10,XBOOLE_0:def 10
.=dom (sn-FanMorphE) /\ K1 by FUNCT_1:68
.=(the carrier of TOP-REAL 2)/\ K1 by FUNCT_2:def 1
.=K1 by XBOOLE_1:28
.=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
A16:rng (proj2*((sn-FanMorphE)|K1)) c= rng proj2 by RELAT_1:45;
    rng proj2 c= the carrier of R^1 by TOPMETR:24;
then rng (proj2*((sn-FanMorphE)|K1)) c= the carrier of R^1 by A16,XBOOLE_1:1
;
then reconsider g2=proj2*((sn-FanMorphE)|K1) as Function of (TOP-REAL 2)|K1,R^1
                                 by A15,FUNCT_2:4;
A17:dom (proj1*((sn-FanMorphE)|K1))
                     c= dom ((sn-FanMorphE)|K1) by RELAT_1:44;
   dom ((sn-FanMorphE)|K1) c= dom (proj1*((sn-FanMorphE)|K1))
proof let x be set;assume A18:x in dom ((sn-FanMorphE)|K1);
   then A19:x in dom (sn-FanMorphE) /\ K1 by FUNCT_1:68;
   A20:((sn-FanMorphE)|K1).x=(sn-FanMorphE).x by A18,FUNCT_1:68;
   A21: dom proj1 = (the carrier of TOP-REAL 2) by FUNCT_2:def 1;
       x in dom (sn-FanMorphE) by A19,XBOOLE_0:def 3;
   then (sn-FanMorphE).x in rng (sn-FanMorphE) by FUNCT_1:12;
  hence x in dom (proj1*((sn-FanMorphE)|K1)) by A18,A20,A21,FUNCT_1:21;
end;
then A22:dom (proj1*((sn-FanMorphE)|K1))
=dom ((sn-FanMorphE)|K1) by A17,XBOOLE_0:def 10
.=dom (sn-FanMorphE) /\ K1 by FUNCT_1:68
.=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
.=K1 by XBOOLE_1:28
.=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
A23:rng (proj1*((sn-FanMorphE)|K1)) c= rng proj1 by RELAT_1:45;
    rng proj1 c= the carrier of R^1 by TOPMETR:24;
then rng (proj1*((sn-FanMorphE)|K1)) c= the carrier of R^1 by A23,XBOOLE_1:1
;
then reconsider g1=proj1*((sn-FanMorphE)|K1) as Function of (TOP-REAL 2)|K1,R^1
                                 by A22,FUNCT_2:4;
A24: for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1>=0 & q<>0.REAL 2
   proof let q be Point of TOP-REAL 2;
    assume A25:q in the carrier of (TOP-REAL 2)|K1;
          the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     then consider p3 being Point of TOP-REAL 2 such that
     A26: q=p3 & (p3`2/|.p3.|>=sn & p3`1>=0 & p3<>0.REAL 2) by A1,A25;
    thus q`1>=0 & q<>0.REAL 2 by A26;
   end;
      for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g2.p=|.p.|* ((p`2/|.p.|-sn)/(1-sn))
   proof let p be Point of TOP-REAL 2;
    assume A27: p in the carrier of (TOP-REAL 2)|K1;
     A28:dom ((sn-FanMorphE)|K1)=dom (sn-FanMorphE) /\ K1 by FUNCT_1:68
     .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
     .=K1 by XBOOLE_1:28;
     A29:the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     then consider p3 being Point of TOP-REAL 2 such that
     A30: p=p3 & (p3`2/|.p3.|>=sn & p3`1>=0 & p3<>0.REAL 2) by A1,A27;
     A31:(sn-FanMorphE).p
     =|[|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
      |.p.|* ((p`2/|.p.|-sn)/(1-sn))]| by A1,A30,Th91;
        ((sn-FanMorphE)|K1).p=(sn-FanMorphE).p by A27,A29,FUNCT_1:72;
     then g2.p=proj2.(|[|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
            |.p.|* ((p`2/|.p.|-sn)/(1-sn))]|)
                             by A27,A28,A29,A31,FUNCT_1:23
      .=(|[|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
        |.p.|* ((p`2/|.p.|-sn)/(1-sn))]|)`2 by PSCOMP_1:def 29
      .=|.p.|* ((p`2/|.p.|-sn)/(1-sn)) by EUCLID:56;
    hence g2.p=|.p.|* ((p`2/|.p.|-sn)/(1-sn));
   end;
then consider f2 being Function of (TOP-REAL 2)|K1,R^1 such that
  A32:for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds f2.p=|.p.|* ((p`2/|.p.|-sn)/(1-sn));
A33:f2 is continuous by A1,A24,A32,Th92;
      for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g1.p=|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2))
   proof let p be Point of TOP-REAL 2;
    assume A34: p in the carrier of (TOP-REAL 2)|K1;
     A35:dom ((sn-FanMorphE)|K1)=dom (sn-FanMorphE) /\ K1 by FUNCT_1:68
     .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
     .=K1 by XBOOLE_1:28;
     A36:the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     then consider p3 being Point of TOP-REAL 2 such that
     A37: p=p3 & (p3`2/|.p3.|>=sn & p3`1>=0 & p3<>0.REAL 2) by A1,A34;
     A38:(sn-FanMorphE).p=|[|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
      |.p.|* ((p`2/|.p.|-sn)/(1-sn))]| by A1,A37,Th91;
        ((sn-FanMorphE)|K1).p=(sn-FanMorphE).p by A34,A36,FUNCT_1:72;
     then g1.p=proj1.(|[|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
          |.p.|* ((p`2/|.p.|-sn)/(1-sn))]|)
                             by A34,A35,A36,A38,FUNCT_1:23
        .=(|[|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
          |.p.|* ((p`2/|.p.|-sn)/(1-sn)) ]|)`1 by PSCOMP_1:def 28
        .= |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)) by EUCLID:56;
    hence g1.p=|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2));
   end;
then consider f1 being Function of (TOP-REAL 2)|K1,R^1 such that
  A39:for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds f1.p=|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2));
      for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1>=0 & q`2/|.q.|>=sn & q<>0.REAL 2
   proof let q be Point of TOP-REAL 2;
    assume A40:q in the carrier of (TOP-REAL 2)|K1;
          the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     then consider p3 being Point of TOP-REAL 2 such that
     A41: q=p3 & (p3`2/|.p3.|>=sn & p3`1>=0 & p3<>0.REAL 2) by A1,A40;
    thus thesis by A41;
   end;
then A42:f1 is continuous by A1,A39,Th94;
    for x,y,r,s being real number st |[x,y]| in K1 &
  r=f1.(|[x,y]|) & s=f2.(|[x,y]|) holds f.(|[x,y]|)=|[r,s]|
  proof let x,y,r,s be real number;
   assume A43: |[x,y]| in K1 & r=f1.(|[x,y]|) & s=f2.(|[x,y]|);
     set p99=|[x,y]|;
     A44:the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     consider p3 being Point of TOP-REAL 2 such that
     A45: p99=p3 & (p3`2/|.p3.|>=sn & p3`1>=0 & p3<>0.REAL 2) by A1,A43;
     A46:f1.p99=|.p99.|*(sqrt(1-((p99`2/|.p99.|-sn)/(1-sn))^2))
                          by A39,A43,A44;
        ((sn-FanMorphE)|K0).(|[x,y]|)=((sn-FanMorphE)).(|[x,y]|) by A43,
FUNCT_1:72
    .= |[|.p99.|*(sqrt(1-((p99`2/|.p99.|-sn)/(1-sn))^2)),
      |.p99.|* ((p99`2/|.p99.|-sn)/(1-sn))]| by A1,A45,Th91
    .=|[r,s]| by A32,A43,A44,A46;
   hence f.(|[x,y]|)=|[r,s]| by A1;
  end;
hence f is continuous by A7,A8,A33,A42,JGRAPH_2:45;
end;

theorem Th97: for sn being Real,
K0,B0 being Subset of TOP-REAL 2,f being
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0
st -1<sn & sn<1 & f=(sn-FanMorphE)|K0 &
B0={q where q is Point of TOP-REAL 2: q`1>=0 & q<>0.REAL 2}
& K0={p: p`2/|.p.|<=sn & p`1>=0 & p<>0.REAL 2}
holds f is continuous
proof let sn be Real,K0,B0 be Subset of TOP-REAL 2,f be
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0;
assume A1: -1<sn & sn<1 & f=(sn-FanMorphE)|K0 &
B0={q where q is Point of TOP-REAL 2: q`1>=0 & q<>0.REAL 2} &
K0={p: p`2/|.p.|<=sn & p`1>=0 & p<>0.REAL 2};
 set cn=sqrt(1-sn^2);
 set p0=|[cn,sn]|;
 A2: p0`2=sn by EUCLID:56;
 A3: p0`1=cn by EUCLID:56;
       sn^2<1^2 by A1,SQUARE_1:120;
 then A4: 1-sn^2>0 by XREAL_1:52;
 then A5: --cn>0 by SQUARE_1:93;
 A6: |.p0.|=sqrt((cn)^2+sn^2) by A2,A3,JGRAPH_3:10;
     cn^2=1-sn^2 by A4,SQUARE_1:def 4;
 then p0`2/|.p0.|=sn by A6,EUCLID:56,SQUARE_1:83;
 then A7: p0 in K0 by A1,A3,A5,JGRAPH_2:11;
 then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
  A8: K0 c= B0
   proof let x be set;assume x in K0;
      then consider p8 being Point of TOP-REAL 2 such that
      A9: x=p8 & (
      p8`2/|.p8.|<=sn & p8`1>=0 & p8<>0.REAL 2) by A1;
    thus x in B0 by A1,A9;
   end;
A10:dom (proj2*((sn-FanMorphE)|K1)) c= dom ((sn-FanMorphE)|K1)
                                  by RELAT_1:44;
   dom ((sn-FanMorphE)|K1) c= dom (proj2*((sn-FanMorphE)|K1))
proof let x be set;assume A11:x in dom ((sn-FanMorphE)|K1);
   then A12:x in dom (sn-FanMorphE) /\ K1 by FUNCT_1:68;
   A13:((sn-FanMorphE)|K1).x=(sn-FanMorphE).x by A11,FUNCT_1:68;
   A14: dom proj2 = (the carrier of TOP-REAL 2) by FUNCT_2:def 1;
       x in dom (sn-FanMorphE) by A12,XBOOLE_0:def 3;
   then (sn-FanMorphE).x in rng (sn-FanMorphE) by FUNCT_1:12;
  hence x in dom (proj2*((sn-FanMorphE)|K1)) by A11,A13,A14,FUNCT_1:21;
end;
then A15:dom (proj2*((sn-FanMorphE)|K1))
=dom ((sn-FanMorphE)|K1) by A10,XBOOLE_0:def 10
.=dom (sn-FanMorphE) /\ K1 by FUNCT_1:68
.=(the carrier of TOP-REAL 2)/\ K1 by FUNCT_2:def 1
.=K1 by XBOOLE_1:28
.=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
A16:rng (proj2*((sn-FanMorphE)|K1)) c= rng proj2 by RELAT_1:45;
    rng proj2 c= the carrier of R^1 by TOPMETR:24;
then rng (proj2*((sn-FanMorphE)|K1)) c= the carrier of R^1 by A16,XBOOLE_1:1
;
then reconsider g2=proj2*((sn-FanMorphE)|K1) as Function of (TOP-REAL 2)|K1,R^1
                                 by A15,FUNCT_2:4;
A17:dom (proj1*((sn-FanMorphE)|K1))
                     c= dom ((sn-FanMorphE)|K1) by RELAT_1:44;
   dom ((sn-FanMorphE)|K1) c= dom (proj1*((sn-FanMorphE)|K1))
proof let x be set;assume A18:x in dom ((sn-FanMorphE)|K1);
   then A19:x in dom (sn-FanMorphE) /\ K1 by FUNCT_1:68;
   A20:((sn-FanMorphE)|K1).x=(sn-FanMorphE).x by A18,FUNCT_1:68;
   A21: dom proj1 = (the carrier of TOP-REAL 2) by FUNCT_2:def 1;
       x in dom (sn-FanMorphE) by A19,XBOOLE_0:def 3;
   then (sn-FanMorphE).x in rng (sn-FanMorphE) by FUNCT_1:12;
  hence x in dom (proj1*((sn-FanMorphE)|K1)) by A18,A20,A21,FUNCT_1:21;
end;
then A22:dom (proj1*((sn-FanMorphE)|K1))
=dom ((sn-FanMorphE)|K1) by A17,XBOOLE_0:def 10
.=dom (sn-FanMorphE) /\ K1 by FUNCT_1:68
.=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
.=K1 by XBOOLE_1:28
.=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
A23:rng (proj1*((sn-FanMorphE)|K1)) c= rng proj1 by RELAT_1:45;
    rng proj1 c= the carrier of R^1 by TOPMETR:24;
then rng (proj1*((sn-FanMorphE)|K1)) c= the carrier of R^1 by A23,XBOOLE_1:1
;
then reconsider g1=proj1*((sn-FanMorphE)|K1) as Function of (TOP-REAL 2)|K1,R^1
                                 by A22,FUNCT_2:4;
A24: for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1>=0 & q<>0.REAL 2
   proof let q be Point of TOP-REAL 2;
    assume A25:q in the carrier of (TOP-REAL 2)|K1;
          the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     then consider p3 being Point of TOP-REAL 2 such that
     A26: q=p3 & (p3`2/|.p3.|<=sn & p3`1>=0 & p3<>0.REAL 2) by A1,A25;
    thus q`1>=0 & q<>0.REAL 2 by A26;
   end;
      for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g2.p=|.p.|* ((p`2/|.p.|-sn)/(1+sn))
   proof let p be Point of TOP-REAL 2;
    assume A27: p in the carrier of (TOP-REAL 2)|K1;
     A28:dom ((sn-FanMorphE)|K1)=dom (sn-FanMorphE) /\ K1 by FUNCT_1:68
     .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
     .=K1 by XBOOLE_1:28;
     A29:the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     then consider p3 being Point of TOP-REAL 2 such that
     A30: p=p3 & (p3`2/|.p3.|<=sn & p3`1>=0 & p3<>0.REAL 2) by A1,A27;
     A31:(sn-FanMorphE).p
     =|[|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
      |.p.|* ((p`2/|.p.|-sn)/(1+sn))]| by A1,A30,Th91;
        ((sn-FanMorphE)|K1).p=(sn-FanMorphE).p by A27,A29,FUNCT_1:72;
     then g2.p=proj2.(|[|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
            |.p.|* ((p`2/|.p.|-sn)/(1+sn))]|)
                             by A27,A28,A29,A31,FUNCT_1:23
      .=(|[|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
        |.p.|* ((p`2/|.p.|-sn)/(1+sn))]|)`2 by PSCOMP_1:def 29
      .=|.p.|* ((p`2/|.p.|-sn)/(1+sn)) by EUCLID:56;
    hence g2.p=|.p.|* ((p`2/|.p.|-sn)/(1+sn));
   end;
then consider f2 being Function of (TOP-REAL 2)|K1,R^1 such that
  A32:for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds f2.p=|.p.|* ((p`2/|.p.|-sn)/(1+sn));
A33:f2 is continuous by A1,A24,A32,Th93;
      for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g1.p=|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2))
   proof let p be Point of TOP-REAL 2;
    assume A34: p in the carrier of (TOP-REAL 2)|K1;
     A35:dom ((sn-FanMorphE)|K1)=dom (sn-FanMorphE) /\ K1 by FUNCT_1:68
     .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
     .=K1 by XBOOLE_1:28;
     A36:the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     then consider p3 being Point of TOP-REAL 2 such that
     A37: p=p3 & (p3`2/|.p3.|<=sn & p3`1>=0 & p3<>0.REAL 2) by A1,A34;
     A38:(sn-FanMorphE).p=|[|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
      |.p.|* ((p`2/|.p.|-sn)/(1+sn))]| by A1,A37,Th91;
        ((sn-FanMorphE)|K1).p=(sn-FanMorphE).p by A34,A36,FUNCT_1:72;
     then g1.p=proj1.(|[|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
          |.p.|* ((p`2/|.p.|-sn)/(1+sn))]|)
                             by A34,A35,A36,A38,FUNCT_1:23
        .=(|[|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
          |.p.|* ((p`2/|.p.|-sn)/(1+sn)) ]|)`1 by PSCOMP_1:def 28
        .= |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)) by EUCLID:56;
    hence g1.p=|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2));
   end;
then consider f1 being Function of (TOP-REAL 2)|K1,R^1 such that
  A39:for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds f1.p=|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2));
      for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`1>=0 & q`2/|.q.|<=sn & q<>0.REAL 2
   proof let q be Point of TOP-REAL 2;
    assume A40:q in the carrier of (TOP-REAL 2)|K1;
          the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     then consider p3 being Point of TOP-REAL 2 such that
     A41: q=p3 & (p3`2/|.p3.|<=sn & p3`1>=0 & p3<>0.REAL 2) by A1,A40;
    thus thesis by A41;
   end;
then A42:f1 is continuous by A1,A39,Th95;
    for x,y,r,s being real number st |[x,y]| in K1 &
  r=f1.(|[x,y]|) & s=f2.(|[x,y]|) holds f.(|[x,y]|)=|[r,s]|
  proof let x,y,r,s be real number;
   assume A43: |[x,y]| in K1 & r=f1.(|[x,y]|) & s=f2.(|[x,y]|);
     set p99=|[x,y]|;
     A44:the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     consider p3 being Point of TOP-REAL 2 such that
     A45: p99=p3 & (p3`2/|.p3.|<=sn & p3`1>=0 & p3<>0.REAL 2) by A1,A43;
     A46:f1.p99=|.p99.|*(sqrt(1-((p99`2/|.p99.|-sn)/(1+sn))^2))
                          by A39,A43,A44;
        ((sn-FanMorphE)|K0).(|[x,y]|)=((sn-FanMorphE)).(|[x,y]|) by A43,
FUNCT_1:72
    .= |[|.p99.|*(sqrt(1-((p99`2/|.p99.|-sn)/(1+sn))^2)),
      |.p99.|* ((p99`2/|.p99.|-sn)/(1+sn))]| by A1,A45,Th91
    .=|[r,s]| by A32,A43,A44,A46;
   hence f.(|[x,y]|)=|[r,s]| by A1;
  end;
hence f is continuous by A7,A8,A33,A42,JGRAPH_2:45;
end;

theorem Th98: for sn being Real, K03 being Subset of TOP-REAL 2
 st K03={p: p`2>=(sn)*(|.p.|) & p`1>=0}
 holds K03 is closed
proof let sn be Real, K003 be Subset of TOP-REAL 2;
 assume A1:K003={p: p`2>=(sn)*(|.p.|) & p`1>=0};
 defpred P[Point of TOP-REAL 2] means ($1`2>=sn*|.$1.|);
  reconsider K1={p7 where p7 is Point of TOP-REAL 2:P[p7]}
  as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
  A2: K1 is closed by Lm9;
  defpred Q[Point of TOP-REAL 2] means $1`1>=0;
  reconsider KX={p where p is Point of TOP-REAL 2: Q[p]}
    as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
A3: KX is closed by JORDAN6:5;
       {p : P[p] & Q[p]}
    = {p7 where p7 is Point of TOP-REAL 2:P[p7]} /\
     {p1 where p1 is Point of TOP-REAL 2: Q[p1]} from DOMAIN_1:sch 10;
  hence thesis by A1,A2,A3,TOPS_1:35;
end;

theorem Th99: for sn being Real, K03 being Subset of TOP-REAL 2
 st K03={p: p`2<=(sn)*(|.p.|) & p`1>=0}
 holds K03 is closed
proof let sn be Real, K003 be Subset of TOP-REAL 2;
 assume A1: K003={p: p`2<=(sn)*(|.p.|) & p`1>=0};
 defpred P[Point of TOP-REAL 2] means ($1`2<=sn*|.$1.|);
  reconsider K1={p7 where p7 is Point of TOP-REAL 2:P[p7]}
  as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
  A2: K1 is closed by Lm11;
  defpred Q[Point of TOP-REAL 2] means $1`1>=0;
  reconsider KX={p where p is Point of TOP-REAL 2: Q[p]}
    as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
A3: KX is closed by JORDAN6:5;
       {p : P[p] & Q[p]}
    = {p7 where p7 is Point of TOP-REAL 2:P[p7]} /\
     {p1 where p1 is Point of TOP-REAL 2: Q[p1]} from DOMAIN_1:sch 10;
  hence thesis by A1,A2,A3,TOPS_1:35;
end;

theorem Th100: for sn being Real,
K0,B0 being Subset of TOP-REAL 2,f being
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0
st -1<sn & sn<1 & f=(sn-FanMorphE)|K0 &
B0=(the carrier of TOP-REAL 2) \ {0.REAL 2}
& K0={p: p`1>=0 & p<>0.REAL 2}
holds f is continuous
proof let sn be Real,K0,B0 be Subset of TOP-REAL 2,f be
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0;
assume A1: -1<sn & sn<1 & f=(sn-FanMorphE)|K0 &
B0=(the carrier of TOP-REAL 2)
\ {0.REAL 2} &
K0={p: p`1>=0 & p<>0.REAL 2};
 set cn=sqrt(1-sn^2);
 set p0=|[cn,sn]|;
 A2: p0`2=sn by EUCLID:56;
 A3: p0`1=cn by EUCLID:56;
       sn^2<1 by A1,SQUARE_1:120,59;
 then A4: 1-sn^2>0 by XREAL_1:52;
 then A5: p0<>0.REAL 2 by A3,JGRAPH_2:11,SQUARE_1:93;
 A6: --cn>0 by A4,SQUARE_1:93;
 A7: p0`1>0 by A3,A4,SQUARE_1:93;
 A8: |.p0.|=sqrt((cn)^2+sn^2) by A2,A3,JGRAPH_3:10;
     cn^2=1-sn^2 by A4,SQUARE_1:def 4;
 then A9: p0`2/|.p0.|=sn by A8,EUCLID:56,SQUARE_1:83;
     p0 in K0 by A1,A7,JGRAPH_2:11;
then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
      p0 in the carrier of TOP-REAL 2 & not p0 in {0.REAL 2}
               by A5,TARSKI:def 1;
  then reconsider D=B0 as non empty Subset of TOP-REAL 2 by A1,XBOOLE_0:def 4;
   A10: p0 in {p: p`2/|.p.|>=sn & p`1>=0 & p<>0.REAL 2} by A7,A9,JGRAPH_2:11;
   defpred P[Point of TOP-REAL 2] means
   $1`2/|.$1.|>=sn & $1`1>=0 & $1<>0.REAL 2;
   A11: {p: P[p]}
     is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
   A12: {p: p`2/|.p.|>=sn & p`1>=0 & p<>0.REAL 2} c= K1
    proof let x be set;assume x in
      {p: p`2/|.p.|>=sn & p`1>=0 & p<>0.REAL 2};
      then consider p such that
        A13:p=x & p`2/|.p.|>=sn & p`1>=0 & p<>0.REAL 2;
     thus x in K1 by A1,A13;
    end;
   then reconsider K00={p: p`2/|.p.|>=sn & p`1>=0 & p<>0.REAL 2}
      as non empty Subset of ((TOP-REAL 2)|K1)
                 by A10,PRE_TOPC:29;
   reconsider K001={p: p`2/|.p.|>=sn & p`1>=0 & p<>0.REAL 2}
            as non empty Subset of (TOP-REAL 2)
                       by A10,A11;
   defpred P[Point of TOP-REAL 2] means $1`2>=(sn)*(|.$1.|) & $1`1>=0;
       {p: P[p]} is Subset of
   TOP-REAL 2 from DOMAIN_1:sch 7;
   then reconsider K003={p: p`2>=(sn)*(|.p.|) & p`1>=0}
            as Subset of (TOP-REAL 2);
   A14: p0 in {p: p`2/|.p.|<=sn & p`1>=0 & p<>0.REAL 2} by A3,A6,A9,JGRAPH_2:11
;
   A15: {p: p`2/|.p.|<=sn & p`1>=0 & p<>0.REAL 2} c= K1
    proof let x be set;assume x in
      {p: p`2/|.p.|<=sn & p`1>=0 & p<>0.REAL 2};
      then consider p such that
        A16: p=x & p`2/|.p.|<=sn & p`1>=0 & p<>0.REAL 2;
     thus x in K1 by A1,A16;
    end;
   then reconsider K11={p: p`2/|.p.|<=sn & p`1>=0 & p<>0.REAL 2}
            as non empty Subset of ((TOP-REAL 2)|K1)
            by A14,PRE_TOPC:29;
    A17: p0 in {p: p`2/|.p.|<=sn & p`1>=0 & p<>0.REAL 2} by A3,A6,A9,
JGRAPH_2:11;
defpred P[Point of TOP-REAL 2] means
$1`2/|.$1.|<=sn & $1`1>=0 & $1<>0.REAL 2;
       {p: P[p]} is Subset of
   TOP-REAL 2 from DOMAIN_1:sch 7;
   then reconsider K111={p: p`2/|.p.|<=sn & p`1>=0 & p<>0.REAL 2}
            as non empty Subset of (TOP-REAL 2)
                       by A17;
    defpred P[Point of TOP-REAL 2] means
    $1`2<=(sn)*(|.$1.|) & $1`1>=0;
       {p: P[p]} is Subset of
   TOP-REAL 2 from DOMAIN_1:sch 7;
   then reconsider K004={p: p`2<=(sn)*(|.p.|) & p`1>=0}
            as Subset of (TOP-REAL 2);
      the carrier of (TOP-REAL 2)|B0=the carrier of (TOP-REAL 2)|D;
  then A18: dom f=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1
    .=K1 by PRE_TOPC:29;
  then A19: dom (f|K00)=K00 by A12,RELAT_1:91
  .= the carrier of ((TOP-REAL 2)|K1)|K00 by PRE_TOPC:29;
  A20: the carrier of (TOP-REAL 2)|D=D by PRE_TOPC:29;
  rng (f|K00) c=D by A20;
  then reconsider f1=f|K00 as Function of ((TOP-REAL 2)|K1)|K00,(TOP-REAL 2)|D
                            by A19,FUNCT_2:4;
  A21: dom f1=the carrier of ((TOP-REAL 2)|K1)|K00 by FUNCT_2:def 1
  .=K00 by PRE_TOPC:29;
  A22: dom (sn-FanMorphE)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
  then A23: dom ((sn-FanMorphE)|K001)=K001 by RELAT_1:91
  .= the carrier of (TOP-REAL 2)|K001 by PRE_TOPC:29;
  A24: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
      rng ((sn-FanMorphE)|K001) c= K1
   proof let y be set;assume y in rng ((sn-FanMorphE)|K001);
     then consider x being set such that
     A25: x in dom ((sn-FanMorphE)|K001) & y=((sn-FanMorphE)|K001).x
        by FUNCT_1:def 5;
     A26: dom ((sn-FanMorphE)|K001)=(dom (sn-FanMorphE))/\ K001 by FUNCT_1:68
     .=(the carrier of TOP-REAL 2)/\ K001 by FUNCT_2:def 1
     .=K001 by XBOOLE_1:28;
     reconsider q=x as Point of TOP-REAL 2 by A25;
     A27: y=(sn-FanMorphE).q by A25,FUNCT_1:70;
     consider p2 being Point of TOP-REAL 2 such that
     A28: p2=q & p2`2/|.p2.|>=sn & p2`1>=0 & p2<>0.REAL 2 by A25,A26;
     A29: sn-FanMorphE.q= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by A1,A28,Th91;
     set q4= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1-sn))]|;
         |.q.|<>0 by A28,TOPRNS_1:25;
     then A30: (|.q.|)^2>0 by SQUARE_1:74;
     A31: 1-sn>0 by A1,XREAL_1:151;
        A32: q4`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))&
        q4`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by EUCLID:56;
        A33: (q`2/|.q.|-sn)>= 0 by A28,XREAL_1:50;
            0<=(q`1)^2 by XREAL_1:65;
        then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`2)^2 <= (|.q.|)^2 by JGRAPH_3:10;
        then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A30,REAL_1:73;
        then (q`2)^2/(|.q.|)^2 <= 1 by A30,XCMPLX_1:60;
        then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then 1>=q`2/|.q.| by Lm2;
        then A34: 1-sn>=q`2/|.q.|-sn by XREAL_1:11;
        A35: -(1-sn)<= -0 by A31,XREAL_1:26;
             -(1-sn)<= -( q`2/|.q.|-sn) by A34,XREAL_1:26;
         then (-(1-sn))/(1-sn)<=(-( q`2/|.q.|-sn))/(1-sn)
                        by A31,REAL_1:73;
        then A36: -1<=(-( q`2/|.q.|-sn))/(1-sn)
                        by A31,XCMPLX_1:198;
           --(1-sn)>= -(q`2/|.q.|-sn) by A33,A35,XREAL_1:26;
       then (-(q`2/|.q.|-sn))/(1-sn)<=1 by A31,REAL_2:117;
       then ((-(q`2/|.q.|-sn))/(1-sn))^2<=1 by A36,SQUARE_1:119,59;
       then A37: 1-((-(q`2/|.q.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
       then 1-(-((q`2/|.q.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
       then A38: 1-((q`2/|.q.|-sn)/(1-sn))^2>=0;
           sqrt(1-((-(q`2/|.q.|-sn))/(1-sn))^2)>=0 by A37,SQUARE_1:def 4;
       then sqrt(1-(-(q`2/|.q.|-sn))^2/(1-sn)^2)>=0 by XCMPLX_1:77;
       then sqrt(1-(q`2/|.q.|-sn)^2/(1-sn)^2)>=0;
       then A39: sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)>=0 by XCMPLX_1:77;
        A40: (q4`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))^2
                         by A32
         .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1-sn))^2) by A38,SQUARE_1:def 4;
        A41: (q4`2)^2= (|.q.|)^2*((q`2/|.q.|-sn)/(1-sn))^2
                         by A32;
            (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
        .=(|.q.|)^2 by A40,A41;
     then q4`1>=0 & q4<>0.REAL 2 by A30,A32,A39,XREAL_1:129,SQUARE_1:
60,TOPRNS_1:24
;
    hence y in K1 by A1,A27,A29;
   end;
  then reconsider f3=(sn-FanMorphE)|K001
   as Function of (TOP-REAL 2)|K001,(TOP-REAL 2)|K1  by A23,A24,FUNCT_2:4;
  A42: dom (f|K11)=K11 by A15,A18,RELAT_1:91
  .= the carrier of ((TOP-REAL 2)|K1)|K11 by PRE_TOPC:29;
  A43: the carrier of (TOP-REAL 2)|D =D by PRE_TOPC:29;
  rng (f|K11) c=D by A43;
  then reconsider f2=f|K11 as Function of ((TOP-REAL 2)|K1)|K11,(TOP-REAL 2)|D
                    by A42,FUNCT_2:4;
  A44: dom f2=the carrier of ((TOP-REAL 2)|K1)|K11 by FUNCT_2:def 1
  .=K11 by PRE_TOPC:29;
  A45: dom ((sn-FanMorphE)|K111)=K111 by A22,RELAT_1:91
  .= the carrier of (TOP-REAL 2)|K111 by PRE_TOPC:29;
  A46: the carrier of (TOP-REAL 2)|K1 =K1 by PRE_TOPC:29;
      rng ((sn-FanMorphE)|K111) c= K1
   proof let y be set;assume y in rng ((sn-FanMorphE)|K111);
     then consider x being set such that
     A47: x in dom ((sn-FanMorphE)|K111) & y=((sn-FanMorphE)|K111).x
        by FUNCT_1:def 5;
     A48: dom ((sn-FanMorphE)|K111)=(dom (sn-FanMorphE))/\ K111 by FUNCT_1:68
     .=(the carrier of TOP-REAL 2)/\ K111 by FUNCT_2:def 1
     .=K111 by XBOOLE_1:28;
     reconsider q=x as Point of TOP-REAL 2 by A47;
     A49: y=(sn-FanMorphE).q by A47,FUNCT_1:70;
     consider p2 being Point of TOP-REAL 2 such that
     A50: p2=q & p2`2/|.p2.|<=sn & p2`1>=0 & p2<>0.REAL 2 by A47,A48;
     A51: sn-FanMorphE.q= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1+sn))]| by A1,A50,Th91;
     set q4= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1+sn))]|;
         |.q.|<>0 by A50,TOPRNS_1:25;
     then A52: (|.q.|)^2>0 by SQUARE_1:74;
   A53: 1+sn>0 by A1,XREAL_1:150;
        A54: q4`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))&
        q4`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by EUCLID:56;
        A55: (q`2/|.q.|-sn)<=0 by A50,REAL_2:106;
        A56: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
            0<=(q`1)^2 by XREAL_1:65;
        then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A52,A56,REAL_1:73;
        then (q`2)^2/(|.q.|)^2 <= 1 by A52,XCMPLX_1:60;
        then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then -1<=q`2/|.q.| by Lm2;
        then A57: -1-sn<=q`2/|.q.|-sn by XREAL_1:11;
           (1+sn)/(1+sn)>=(q`2/|.q.|-sn)/(1+sn) by A53,A55,REAL_1:73;
        then A58: 1>=(q`2/|.q.|-sn)/(1+sn) by A53,XCMPLX_1:60;
             (-(1+sn))/(1+sn)<=(( q`2/|.q.|-sn))/(1+sn)
                        by A53,A57,REAL_1:73;
        then -1<=(( q`2/|.q.|-sn))/(1+sn)
                        by A53,XCMPLX_1:198;
       then (((q`2/|.q.|-sn))/(1+sn))^2<=1^2 by A58,SQUARE_1:119;
       then A59: 1-((q`2/|.q.|-sn)/(1+sn))^2>=0 by XREAL_1:50;
       then 1-(-((q`2/|.q.|-sn)/(1+sn)))^2>=0;
       then 1-((-(q`2/|.q.|-sn))/(1+sn))^2>=0 by XCMPLX_1:188;
       then sqrt(1-((-(q`2/|.q.|-sn))/(1+sn))^2)>=0 by SQUARE_1:def 4;
       then sqrt(1-(-(q`2/|.q.|-sn))^2/(1+sn)^2)>=0 by XCMPLX_1:77;
       then sqrt(1-(q`2/|.q.|-sn)^2/(1+sn)^2)>=0;
       then sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)>=0 by XCMPLX_1:77;
       then A60: q4`1>= 0 by A54,XREAL_1:129;
       A61: (q4`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))^2
                         by A54
         .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1+sn))^2) by A59,SQUARE_1:def 4;
        A62: (q4`2)^2= (|.q.|)^2*((q`2/|.q.|-sn)/(1+sn))^2
                         by A54;
            (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
        .=(|.q.|)^2 by A61,A62;
        then q4<>0.REAL 2 by A52,SQUARE_1:60,TOPRNS_1:24;
    hence y in K1 by A1,A49,A51,A60;
   end;
  then reconsider f4=(sn-FanMorphE)|K111
   as Function of (TOP-REAL 2)|K111,(TOP-REAL 2)|K1  by A45,A46,FUNCT_2:4;
  set T1= ((TOP-REAL 2)|K1)|K00,T2=((TOP-REAL 2)|K1)|K11;
  A63: [#](((TOP-REAL 2)|K1)|K00)=K00 by PRE_TOPC:def 10;
  A64: [#](((TOP-REAL 2)|K1)|K11)=K11 by PRE_TOPC:def 10;
  A65: [#]((TOP-REAL 2)|K1)=K1 by PRE_TOPC:def 10;
  A66: K1 c= K00 \/ K11
   proof let x be set;assume x in K1;
     then consider p such that
     A67: p=x & (p`1>=0 & p<>0.REAL 2) by A1;
    per cases;
     suppose p`2/|.p.|>=sn;
       then x in K00 by A67;
      hence x in K00 \/ K11 by XBOOLE_0:def 2;
     end;
     suppose p`2/|.p.|<sn;
       then x in K11 by A67;
      hence x in K00 \/ K11 by XBOOLE_0:def 2;
     end;
   end;
  then A68: [#](((TOP-REAL 2)|K1)|K00) \/ [#](((TOP-REAL 2)|K1)|K11)
        =[#]((TOP-REAL 2)|K1) by A63,A64,A65,XBOOLE_0:def 10;
  A69: K003 is closed by Th98;
  A70: K003 /\ K1 c= K00
   proof let x be set;assume x in K003 /\ K1;
     then A71: x in K003 & x in K1 by XBOOLE_0:def 3;
     then consider q1 being Point of TOP-REAL 2 such that
     A72: q1=x & q1`2>=(sn)*(|.q1.|) & q1`1>=0;
     consider q2 being Point of TOP-REAL 2 such that
     A73: q2=x & q2`1>=0 & q2<>0.REAL 2 by A1,A71;
     A74: |.q2.|<>0 by A73,TOPRNS_1:25;
         |.q1.|>=0;
     then q1`2/|.q1.|>=(sn)*(|.q1.|)/|.q1.| by A72,A73,A74,REAL_1:73;
     then q1`2/|.q1.|>=(sn) by A72,A73,A74,XCMPLX_1:90;
    hence x in K00 by A72,A73;
   end;
   K00 c= K003 /\ K1
   proof let x be set;assume x in K00;
     then consider p such that
     A75: p=x & (p`2/|.p.|>=sn & p`1>=0 & p<>0.REAL 2);
     A76: |.p.|<>0 by A75,TOPRNS_1:25;
     p`2/|.p.|*|.p.|>=(sn)*(|.p.|) by A75,XREAL_1:66;
     then p`2>=(sn)*(|.p.|) by A76,XCMPLX_1:88;
     then A77: x in K003 by A75;
     x in K1 by A1,A75;
    hence x in K003 /\ K1 by A77,XBOOLE_0:def 3;
   end;
  then K00=K003 /\ [#]((TOP-REAL 2)|K1) by A65,A70,XBOOLE_0:def 10;
  then A78: K00 is closed by A69,PRE_TOPC:43;
  A79: K004 is closed by Th99;
  A80: K004 /\ K1 c= K11
   proof let x be set;assume x in K004 /\ K1;
     then A81: x in K004 & x in K1 by XBOOLE_0:def 3;
     then consider q1 being Point of TOP-REAL 2 such that
     A82: q1=x & q1`2<=(sn)*(|.q1.|) & q1`1>=0;
     consider q2 being Point of TOP-REAL 2 such that
     A83: q2=x & q2`1>=0 & q2<>0.REAL 2 by A1,A81;
     A84: |.q2.|<>0 by A83,TOPRNS_1:25;
     |.q1.|>=0;
     then q1`2/|.q1.|<=(sn)*(|.q1.|)/|.q1.| by A82,A83,A84,REAL_1:73;
     then q1`2/|.q1.|<=(sn) by A82,A83,A84,XCMPLX_1:90;
    hence x in K11 by A82,A83;
   end;
   K11 c= K004 /\ K1
   proof let x be set;assume x in K11;
     then consider p such that
     A85: p=x & (p`2/|.p.|<=sn & p`1>=0 & p<>0.REAL 2);
     A86: |.p.|<>0 by A85,TOPRNS_1:25;
     p`2/|.p.|*|.p.|<=(sn)*(|.p.|) by A85,XREAL_1:66;
     then p`2<=(sn)*(|.p.|) by A86,XCMPLX_1:88;
     then A87: x in K004 by A85;
         x in K1 by A1,A85;
    hence x in K004 /\ K1 by A87,XBOOLE_0:def 3;
   end;
  then K11=K004 /\ [#]((TOP-REAL 2)|K1) by A65,A80,XBOOLE_0:def 10;
  then A88: K11 is closed by A79,PRE_TOPC:43;
  A89: ((TOP-REAL 2)|K1)|K00=(TOP-REAL 2)|K001 by GOBOARD9:4;
   K1 c= D
   proof let x be set;assume x in K1;
     then consider p6 being Point of TOP-REAL 2 such that
     A90: p6=x & p6`1>=0 & p6<>0.REAL 2 by A1;
     x in the carrier of TOP-REAL 2 & not x in {0.REAL 2} by A90,TARSKI:def 1;
    hence x in D by A1,XBOOLE_0:def 4;
   end;
  then D=K1 \/ D by XBOOLE_1:12;
  then A91: (TOP-REAL 2)|K1 is SubSpace of (TOP-REAL 2)|D by TOPMETR:5;
  the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
  then A92: f1= f3 by A1,FUNCT_1:82;
  f3 is continuous by A1,Th96;
  then A93: f1 is continuous by A89,A91,A92,TOPMETR:7;
  A94: ((TOP-REAL 2)|K1)|K11=(TOP-REAL 2)|K111 by GOBOARD9:4;
  the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
  then A95: f2= f4 by A1,FUNCT_1:82;
  f4 is continuous by A1,Th97;
  then A96: f2 is continuous by A91,A94,A95,TOPMETR:7;
  A97: D<>{};
  A98: the carrier of (TOP-REAL 2)|B0=B0 by PRE_TOPC:29;
  for p being set st p in ([#]T1)/\([#]T2) holds f1.p = f2.p
   proof let p be set;
    assume p in ([#]T1)/\([#]T2);
     then A99: p in K00 & p in K11 by A63,A64,XBOOLE_0:def 3;
    hence f1.p=f.p by FUNCT_1:72 .=f2.p by A99,FUNCT_1:72;
   end;
  then consider h being Function of (TOP-REAL 2)|K1,(TOP-REAL 2)|D
  such that
  A100: h=f1+*f2 & h is continuous by A63,A64,A68,A78,A88,A93,A96,JGRAPH_2:9;
  A101: dom h=the carrier of ((TOP-REAL 2)|K1) by FUNCT_2:def 1;
  A102: the carrier of ((TOP-REAL 2)|K1)=K0 by PRE_TOPC:29;
  A103: K0=the carrier of ((TOP-REAL 2)|K0) by PRE_TOPC:29
  .=dom f by A97,A98,FUNCT_2:def 1;
   for y being set st y in dom h holds h.y=f.y
   proof let y be set;assume A104: y in dom h;
   now per cases by A66,A101,A102,A104,XBOOLE_0:def 2;
    suppose A105: y in K00 & not y in K11;
      then y in dom f1 \/ dom f2 by A21,XBOOLE_0:def 2;
     hence h.y=f1.y by A44,A100,A105,FUNCT_4:def 1 .=f.y by A105,FUNCT_1:72;
    end;
    suppose A106: y in K11;
      then y in dom f1 \/ dom f2 by A44,XBOOLE_0:def 2;
     hence h.y=f2.y by A44,A100,A106,FUNCT_4:def 1 .=f.y by A106,FUNCT_1:72;
    end;
    end;
   hence h.y=f.y;
   end;
 hence thesis by A100,A101,A102,A103,FUNCT_1:9;
end;

theorem Th101: for sn being Real,
K0,B0 being Subset of TOP-REAL 2,f being
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0
st -1<sn & sn<1 & f=(sn-FanMorphE)|K0 &
B0=(the carrier of TOP-REAL 2) \ {0.REAL 2}
& K0={p: p`1<=0 & p<>0.REAL 2}
holds f is continuous
proof let sn be Real,K0,B0 be Subset of TOP-REAL 2,f be
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0;
assume A1:  -1<sn & sn<1 & f=(sn-FanMorphE)|K0 &
B0=(the carrier of TOP-REAL 2)
\ {0.REAL 2} &
K0={p: p`1<=0 & p<>0.REAL 2};
 set cn=sqrt(1-sn^2);
 set p0=|[-cn,-sn]|;
 A2: p0`1=-cn by EUCLID:56;
       sn^2<1^2 by A1,SQUARE_1:120;
 then 1-sn^2>0 by XREAL_1:52;
 then --cn>0 by SQUARE_1:93;
 then A3: -cn<0 by XREAL_1:60;
 then p0 in K0 by A1,A2,JGRAPH_2:11;
then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
     p0 in the carrier of TOP-REAL 2 & not p0 in {0.REAL 2}
               by A2,A3,JGRAPH_2:11,TARSKI:def 1;
  then reconsider D=B0 as non empty Subset of TOP-REAL 2 by A1,XBOOLE_0:def 4;
   A4: K1 c= D
    proof let x be set;assume x in K1;
      then consider p2 being Point of TOP-REAL 2 such that
      A5: p2=x & p2`1<=0 & p2<>0.REAL 2 by A1;
          not p2 in {0.REAL 2} by A5,TARSKI:def 1;
     hence x in D by A1,A5,XBOOLE_0:def 4;
    end;
       for p being Point of (TOP-REAL 2)|K1,V being Subset of (TOP-REAL 2)|D
      st f.p in V & V is open holds
      ex W being Subset of (TOP-REAL 2)|K1 st
      p in W & W is open & f.:W c= V
    proof let p be Point of (TOP-REAL 2)|K1,V be Subset of (TOP-REAL 2)|D;
      assume A6: f.p in V & V is open;
      then consider V2 being Subset of TOP-REAL 2 such that
      A7: V2 is open & V2 /\ [#]((TOP-REAL 2)|D)=V by TOPS_2:32;
      A8: p in the carrier of (TOP-REAL 2)|K1;
      A9: [#]((TOP-REAL 2)|K1)=K1 by PRE_TOPC:def 10;
      reconsider W2=V2 /\ [#]((TOP-REAL 2)|K1) as Subset of (TOP-REAL 2)|
K1;
      A10: W2 is open by A7,TOPS_2:32;
      A11: f.p=(sn-FanMorphE).p by A1,A9,FUNCT_1:72;
      consider q being Point of TOP-REAL 2 such that
      A12: q=p & q`1<=0 & q <>0.REAL 2 by A1,A8,A9;
          (sn-FanMorphE).q=q by A12,Th89;
      then p in V2 & p in [#]((TOP-REAL 2)|D)
                       by A6,A7,A11,A12,XBOOLE_0:def 3;
      then A13: p in W2 by XBOOLE_0:def 3;
       f.:W2 c= V
       proof let y be set;assume y in f.:W2;
         then consider x being set such that
         A14: x in dom f & x in W2 & y=f.x by FUNCT_1:def 12;
             f is Function of (TOP-REAL 2)|K1, (TOP-REAL 2)|D;
         then dom f= K1 by A9,FUNCT_2:def 1;
         then consider p4 being Point of TOP-REAL 2 such that
         A15: x=p4 & p4`1<=0 & p4<>0.REAL 2 by A1,A14;
         A16: f.p4=(sn-FanMorphE).p4 by A1,A9,A14,A15,FUNCT_1:72
         .=p4 by A15,Th89;
    A17: p4 in V2 & p4 in [#]((TOP-REAL 2)|K1) by A14,A15,XBOOLE_0:def 3;
         then p4 in D by A4,A9;
         then p4 in [#]((TOP-REAL 2)|D) by PRE_TOPC:def 10;
        hence y in V by A7,A14,A15,A16,A17,XBOOLE_0:def 3;
       end;
     hence ex W being Subset of (TOP-REAL 2)|K1 st
      p in W & W is open & f.:W c= V by A10,A13;
    end;
  hence f is continuous by JGRAPH_2:20;
end;

theorem Th102: for sn being Real,
 B0 being Subset of TOP-REAL 2,K0 being Subset of
(TOP-REAL 2)|B0,f being Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0)
st -1<sn & sn<1 & f=(sn-FanMorphE)|K0 &
B0=(the carrier of TOP-REAL 2) \ {0.REAL 2}
& K0={p: p`1>=0 & p<>0.REAL 2}
holds f is continuous
proof let sn be Real,
 B0 be Subset of TOP-REAL 2,K0 be Subset of
(TOP-REAL 2)|B0,f be Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0);
assume A1:  -1<sn & sn<1 & f=(sn-FanMorphE)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2}
   & K0={p: p`1>=0 & p<>0.REAL 2 };
      the carrier of (TOP-REAL 2)|B0= B0 by PRE_TOPC:29;
  then reconsider K1=K0 as Subset of TOP-REAL 2 by XBOOLE_1:1;
      K0 c= B0
   proof let x be set;assume x in K0;
      then consider p8 being Point of TOP-REAL 2 such that
      A2: x=p8 & (p8`1>=0 & p8<>0.REAL 2) by A1;
         not x in {0.REAL 2} by A2,TARSKI:def 1;
    hence x in B0 by A1,A2,XBOOLE_0:def 4;
   end;
  then ((TOP-REAL 2)|B0)|K0=(TOP-REAL 2)|K1 by PRE_TOPC:28;
hence f is continuous by A1,Th100;
end;

theorem Th103: for sn being Real,
 B0 being Subset of TOP-REAL 2,K0 being Subset of
(TOP-REAL 2)|B0,f being Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0)
st -1<sn & sn<1 & f=(sn-FanMorphE)|K0 &
B0=(the carrier of TOP-REAL 2) \ {0.REAL 2}
& K0={p: p`1<=0 & p<>0.REAL 2}
holds f is continuous
proof let sn be Real,
 B0 be Subset of TOP-REAL 2,K0 be Subset of
(TOP-REAL 2)|B0,f be Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0);
 assume A1:  -1<sn & sn<1 & f=(sn-FanMorphE)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2}
  & K0={p: p`1<=0 & p<>0.REAL 2};
      the carrier of (TOP-REAL 2)|B0= B0 by PRE_TOPC:29;
  then reconsider K1=K0 as Subset of TOP-REAL 2 by XBOOLE_1:1;
      K0 c= B0
   proof let x be set;assume x in K0;
      then consider p8 being Point of TOP-REAL 2 such that
      A2: x=p8 & (p8`1<=0 & p8<>0.REAL 2) by A1;
         not x in {0.REAL 2} by A2,TARSKI:def 1;
    hence x in B0 by A1,A2,XBOOLE_0:def 4;
   end;
  then ((TOP-REAL 2)|B0)|K0=(TOP-REAL 2)|K1 by PRE_TOPC:28;
hence f is continuous by A1,Th101;
end;

theorem Th104:
  for sn being Real,p being Point of TOP-REAL 2 holds
    |.(sn-FanMorphE).p.|=|.p.|
proof let sn be Real,p be Point of TOP-REAL 2;
  set f=sn-FanMorphE;
  set z=f.p;
  reconsider q=p as Point of TOP-REAL 2;
  reconsider qz=z as Point of TOP-REAL 2;
  per cases;
   suppose A1: q`2/|.q.|>=sn & q`1>0;
     then (sn-FanMorphE).q= |[
     |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
     |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by Th89;
     then A2: qz`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))&
             qz`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by EUCLID:56;
     |.q.|<>0 by A1,JGRAPH_2:11,TOPRNS_1:25;
     then A3: (|.q.|)^2>0 by SQUARE_1:74;
     A4: (q`2/|.q.|-sn)>=0 by A1,XREAL_1:50;
     A5: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
     0<=(q`1)^2 by XREAL_1:65;
     then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
     then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A3,A5,REAL_1:73;
     then (q`2)^2/(|.q.|)^2 <= 1 by A3,XCMPLX_1:60;
     then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
     then 1>=q`2/|.q.| by Lm2;
     then A6: 1-sn>=q`2/|.q.|-sn by XREAL_1:11;
     per cases;
     suppose A7: 1-sn=0;
       A8:((q`2/|.q.|-sn)/(1-sn))=(q`2/|.q.|-sn)*(1-sn)" by XCMPLX_0:def 9
        .= (q`2/|.q.|-sn)*0 by A7,XCMPLX_0:def 7 .=0;
       then 1-((q`2/|.q.|-sn)/(1-sn))^2=1;
       then (sn-FanMorphE).q= |[|.q.|*1,|.q.|*0]| by A1,A8,Th89,
SQUARE_1:83
       .=|[(|.q.|),0]|;
       then ((sn-FanMorphE).q)`1=(|.q.|) & ((sn-FanMorphE).q)`2=0
                         by EUCLID:56;
       then |.(sn-FanMorphE).p.|=sqrt(((|.q.|))^2+0) by JGRAPH_3:10
,SQUARE_1:60
       .=|.q.| by SQUARE_1:89;
      hence |.(sn-FanMorphE).p.|=|.p.|;
     end;
     suppose A9: 1-sn<>0;
      per cases by A9;
       suppose A10: 1-sn>0;
         then A11: -(1-sn)<= -0 by XREAL_1:26;
         -(1-sn)<= -( q`2/|.q.|-sn) by A6,XREAL_1:26;
         then (-(1-sn))/(1-sn)<=(-( q`2/|.q.|-sn))/(1-sn)
           by A10,REAL_1:73;
         then A12: -1<=(-( q`2/|.q.|-sn))/(1-sn) by A10,XCMPLX_1:198;
         --(1-sn)>= -(q`2/|.q.|-sn) by A4,A11,XREAL_1:26;
         then (-(q`2/|.q.|-sn))/(1-sn)<=1 by A10,REAL_2:117;
         then ((-(q`2/|.q.|-sn))/(1-sn))^2<=1^2 by A12,SQUARE_1:119;
         then 1-((-(q`2/|.q.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
         then 1-(-((q`2/|.q.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
         then A13: 1-((q`2/|.q.|-sn)/(1-sn))^2>=0;
         A14: (qz`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))^2
                    by A2
             .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1-sn))^2)
                       by A13,SQUARE_1:def 4;
         A15: (qz`2)^2= (|.q.|)^2*((q`2/|.q.|-sn)/(1-sn))^2
                    by A2;
             (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
          .=(|.q.|)^2 by A14,A15;
         then A16: sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
        thus |.(sn-FanMorphE).p.|=|.p.| by A16,SQUARE_1:89;
       end;
       suppose A17: 1-sn<0;
         A18: q`2/|.q.|-sn>=0 by A1,XREAL_1:50;
         0<(q`1)^2 by A1,SQUARE_1:74;
         then 0+(q`2)^2<(q`1)^2+(q`2)^2 by XREAL_1:10;
         then (q`2)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A3,A5,REAL_1:73;
         then (q`2)^2/(|.q.|)^2 < 1 by A3,XCMPLX_1:60;
         then ((q`2)/|.q.|)^2 < 1 by XCMPLX_1:77;
         then 1 > q`2/|.p.| by Lm3;
        hence |.(sn-FanMorphE).p.|=|.p.| by A17,A18,XREAL_1:11;
       end;
     end;
   end;
   suppose A19: q`2/|.q.|<sn & q`1>0;
     then A20:(sn-FanMorphE).q= |[
     |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
     |.q.|* ((q`2/|.q.|-sn)/(1+sn))]| by Th90;
     then A21: qz`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))&
      qz`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by EUCLID:56;
     |.q.|<>0 by A19,JGRAPH_2:11,TOPRNS_1:25;
     then A22: (|.q.|)^2>0 by SQUARE_1:74;
     A23: (q`2/|.q.|-sn)<0 by A19,REAL_2:105;
     A24: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
     0<=(q`1)^2 by XREAL_1:65;
     then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
     then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A22,A24,REAL_1:73;
     then (q`2)^2/(|.q.|)^2 <= 1 by A22,XCMPLX_1:60;
     then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
     then -1<=q`2/|.q.| by Lm2;
     then A25: -1-sn<=q`2/|.q.|-sn by XREAL_1:11;
     per cases;
     suppose A26: 1+sn=0;
      ((q`2/|.q.|-sn)/(1+sn))=(q`2/|.q.|-sn)*(1+sn)" by XCMPLX_0:def 9
        .= (q`2/|.q.|-sn)*0 by A26,XCMPLX_0:def 7 .=0;
       then ((sn-FanMorphE).q)`1=(|.q.|) & ((sn-FanMorphE).q)`2=0
                         by A20,EUCLID:56,SQUARE_1:83;
       then |.(sn-FanMorphE).p.|=sqrt(((|.q.|))^2+0) by JGRAPH_3:10
,SQUARE_1:60
       .=|.q.| by SQUARE_1:89;
      hence |.(sn-FanMorphE).p.|=|.p.|;
     end;
     suppose A27: 1+sn<>0;
      per cases by A27;
       suppose A28: 1+sn>0;
         then (-(1+sn))/(1+sn)<=(( q`2/|.q.|-sn))/(1+sn) by A25,REAL_1:73;
         then A29: -1<=(( q`2/|.q.|-sn))/(1+sn) by A28,XCMPLX_1:198;
         ((q`2/|.q.|-sn))/(1+sn)<=1 by A23,A28,REAL_2:117;
         then (((q`2/|.q.|-sn))/(1+sn))^2<=1 by A29,SQUARE_1:119,59;
         then A30: 1-(((q`2/|.q.|-sn))/(1+sn))^2>=0 by XREAL_1:50;
         A31: (qz`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))^2
                    by A21
             .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1+sn))^2)
                       by A30,SQUARE_1:def 4;
         A32: (qz`2)^2= (|.q.|)^2*((q`2/|.q.|-sn)/(1+sn))^2
                    by A21;
             (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
          .=(|.q.|)^2 by A31,A32;
         then A33: sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
        thus |.(sn-FanMorphE).p.|=|.p.| by A33,SQUARE_1:89;
       end;
       suppose 1+sn<0;
         then A34: -(1+sn)>-0 by XREAL_1:26;
         0<(q`1)^2 by A19,SQUARE_1:74;
         then 0+(q`2)^2<(q`1)^2+(q`2)^2 by XREAL_1:10;
         then (q`2)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A22,A24,REAL_1:73;
         then (q`2)^2/(|.q.|)^2 < 1 by A22,XCMPLX_1:60;
         then ((q`2)/|.q.|)^2 < 1 by XCMPLX_1:77;
         then -1 < q`2/|.p.| by Lm3;
         then q`2/|.q.|-sn>-1-sn by XREAL_1:11;
        hence |.(sn-FanMorphE).p.|=|.p.| by A23,A34;
       end;
     end;
   end;
   suppose q`1<=0;
    hence |.(sn-FanMorphE).p.|=|.p.| by Th89;
   end;
end;

theorem Th105:
  for sn being Real,x,K0 being set st -1<sn & sn<1 & x in K0 &
    K0={p: p`1>=0 & p<>0.REAL 2} holds (sn-FanMorphE).x in K0
proof let sn be Real,x,K0 be set;
 assume A1:  -1<sn & sn<1 & x in K0 & K0={p: p`1>=0 & p<>0.REAL 2};
  then consider p such that
  A2: p=x & p`1>=0 & p<>0.REAL 2;
  A3:now assume |.p.|<=0;
    then |.p.|=0;
   hence contradiction by A2,TOPRNS_1:25;
  end;
  then A4: (|.p.|)^2>0 by SQUARE_1:74;
  per cases;
  suppose A5: p`2/|.p.|<=sn;
   then A6: (sn-FanMorphE).p= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
           |.p.|*((p`2/|.p.|-sn)/(1+sn))]| by A1,A2,Th91;
   reconsider p9= (sn-FanMorphE).p as Point of TOP-REAL 2;
   A7: p9`1=|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)) by A6,EUCLID:56;
   A8: 1+sn>0 by A1,XREAL_1:150;
       A9: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
      per cases;
       suppose p`1=0;
        hence (sn-FanMorphE).x in K0 by A1,A2,Th89;
       end;
       suppose p`1<>0;
         then 0<(p`1)^2 by SQUARE_1:74;
         then 0+(p`2)^2<(p`1)^2+(p`2)^2 by XREAL_1:10;
         then (p`2)^2/(|.p.|)^2 < (|.p.|)^2/(|.p.|)^2 by A4,A9,REAL_1:73;
         then (p`2)^2/(|.p.|)^2 < 1 by A4,XCMPLX_1:60;
         then A10: ((p`2)/|.p.|)^2 < 1 by XCMPLX_1:77;
         p`2/|.p.|-sn<=0 by A5,REAL_2:106;
         then A11: (p`2/|.p.|-sn)/(1+sn)<(1+sn)/(1+sn) by A8,REAL_1:73;
          -1 < p`2/|.p.| by A10,Lm3;
         then -1-sn< p`2/|.p.|-sn by XREAL_1:11;
         then (-1)*(1+sn)/(1+sn)< (p`2/|.p.|-sn)/(1+sn)
               by A8,REAL_1:73;
         then -1< (p`2/|.p.|-sn)/(1+sn) & (p`2/|.p.|-sn)/(1+sn)<1
               by A8,A11,XCMPLX_1:60,90;
         then 1^2> ((p`2/|.p.|-sn)/(1+sn))^2 by SQUARE_1:120;
         then 1-((p`2/|.p.|-sn)/(1+sn))^2>0 by XREAL_1:52;
         then sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)>0 by SQUARE_1:93;
         then |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2))>0
               by A3,XREAL_1:131;
        hence (sn-FanMorphE).x in K0 by A1,A2,A7,JGRAPH_2:11;
        end;
  end;
  suppose A12: p`2/|.p.|>sn;
   then A13: (sn-FanMorphE).p= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
      |.p.|*((p`2/|.p.|-sn)/(1-sn))]| by A1,A2,Th91;
   reconsider p9= (sn-FanMorphE).p as Point of TOP-REAL 2;
   A14: p9`1=|.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)) by A13,EUCLID:56;
   A15: 1-sn>0 by A1,XREAL_1:151;
   A16: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
      per cases;
       suppose p`1=0;
        hence (sn-FanMorphE).x in K0 by A1,A2,Th89;
       end;
       suppose p`1<>0;
         then 0<(p`1)^2 by SQUARE_1:74;
         then 0+(p`2)^2<(p`1)^2+(p`2)^2 by XREAL_1:10;
         then (p`2)^2/(|.p.|)^2 < (|.p.|)^2/(|.p.|)^2 by A4,A16,REAL_1:73;
         then (p`2)^2/(|.p.|)^2 < 1 by A4,XCMPLX_1:60;
         then ((p`2)/|.p.|)^2 < 1 by XCMPLX_1:77;
         then p`2/|.p.|<1 by Lm3;
         then (p`2/|.p.|-sn)<1-sn by XREAL_1:11;
         then A17: (p`2/|.p.|-sn)/(1-sn)<(1-sn)/(1-sn) by A15,REAL_1:73;
         A18: -(1-sn)< -0 by A15,XREAL_1:26;
         p`2/|.p.|-sn>=sn-sn by A12,XREAL_1:11;
         then (-1)*(1-sn)/(1-sn)< (p`2/|.p.|-sn)/(1-sn)
                       by A15,A18,REAL_1:73;
         then -1< (p`2/|.p.|-sn)/(1-sn) & (p`2/|.p.|-sn)/(1-sn)<1
                           by A15,A17,XCMPLX_1:60,90;
         then 1> ((p`2/|.p.|-sn)/(1-sn))^2 by SQUARE_1:120,59;
         then 1-((p`2/|.p.|-sn)/(1-sn))^2>0 by XREAL_1:52;
         then sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)>0 by SQUARE_1:93;
         then p9`1>0 by A3,A14,XREAL_1:131;
        hence (sn-FanMorphE).x in K0 by A1,A2,JGRAPH_2:11;
       end;
        end;
end;

theorem Th106:
  for sn being Real,x,K0 being set st -1<sn & sn<1 & x in K0 &
    K0={p: p`1<=0 & p<>0.REAL 2} holds (sn-FanMorphE).x in K0
proof let sn be Real,x,K0 be set;
 assume A1:  -1<sn & sn<1 & x in K0 &
 K0={p: p`1<=0 & p<>0.REAL 2};
 then consider p such that
 A2: p=x & p`1<=0 & p<>0.REAL 2;
 thus (sn-FanMorphE).x in K0 by A1,A2,Th89;
end;

theorem Th107:for sn being Real,
 D being non empty Subset of TOP-REAL 2
st -1<sn & sn<1 & D`={0.REAL 2} holds
ex h being Function of (TOP-REAL 2)|D,(TOP-REAL 2)|D
st h=(sn-FanMorphE)|D & h is continuous
proof let sn be Real,D be non empty Subset of TOP-REAL 2;
assume A1:  -1<sn & sn<1 & D`={0.REAL 2};
  reconsider B0= {0.REAL 2} as Subset of TOP-REAL 2;
  A2: D =(B0)` by A1
     .=((the carrier of TOP-REAL 2)\ {0.REAL 2}) by SUBSET_1:def 5;
     defpred P[Point of TOP-REAL 2] means $1`1>=0;
    A3:{p: P[p] & p<>0.REAL 2} c= the carrier of (TOP-REAL 2)|D
         from InclSub(A2);
          (|[0,1]|)`1=0 & (|[0,1]|)`2=1 by EUCLID:56;
      then |[0,1]| in {p where p is Point of TOP-REAL 2:
        p`1>=0 & p<>0.REAL 2} by JGRAPH_2:11;
      then reconsider K0={p:p`1>=0 & p<>0.REAL 2}
          as non empty Subset of (TOP-REAL 2)|D by A3;
          defpred P[Point of TOP-REAL 2] means $1`1<=0;
    A4:{p: P[p] & p<>0.REAL 2} c= the carrier of (TOP-REAL 2)|D
           from InclSub(A2);
     set Y1=|[0,1]|;
        Y1`1=0 & Y1`2=1 by EUCLID:56;
     then Y1 in {p where p is Point of TOP-REAL 2:
     p`1<=0 & p<>0.REAL 2} by JGRAPH_2:11;
  then reconsider K1={p: p`1<=0 & p<>0.REAL 2}
       as non empty Subset of (TOP-REAL 2)|D by A4;
   A5:the carrier of ((TOP-REAL 2)|D)=D by PRE_TOPC:29;
   A6:K0 c= (the carrier of TOP-REAL 2)
   proof let z be set;assume z in K0;
        then consider p8 being Point of TOP-REAL 2 such that
        A7: p8=z & p8`1>=0 & p8<>0.REAL 2;
    thus z in (the carrier of TOP-REAL 2) by A7;
   end;
  A8:dom ((sn-FanMorphE)|K0)= dom ((sn-FanMorphE)) /\ K0 by FUNCT_1:68
       .=((the carrier of TOP-REAL 2)) /\ K0 by FUNCT_2:def 1
       .=K0 by A6,XBOOLE_1:28;
  A9: K0=the carrier of ((TOP-REAL 2)|D)|K0 by PRE_TOPC:29;
      rng ((sn-FanMorphE)|K0) c= the carrier of ((TOP-REAL 2)|D)|K0
   proof let y be set;assume y in rng ((sn-FanMorphE)|K0);
     then consider x being set such that
     A10:x in dom ((sn-FanMorphE)|K0)
     & y=((sn-FanMorphE)|K0).x by FUNCT_1:def 5;
         x in (dom (sn-FanMorphE)) /\ K0 by A10,FUNCT_1:68;
     then A11:x in K0 by XBOOLE_0:def 3;
         K0 c= the carrier of TOP-REAL 2 by A5,XBOOLE_1:1;
     then reconsider p=x as Point of TOP-REAL 2 by A11;
        (sn-FanMorphE).p=y by A10,A11,FUNCT_1:72;
     then y in K0 by A1,A11,Th105;
    hence y in the carrier of ((TOP-REAL 2)|D)|K0 by PRE_TOPC:29;
   end;
  then rng ((sn-FanMorphE)|K0)c= the carrier of ((TOP-REAL 2)|D)
                            by A9,XBOOLE_1:1;
  then reconsider f=(sn-FanMorphE)|K0 as Function of ((TOP-REAL 2)|D)|K0,
  ((TOP-REAL 2)|D)  by A8,A9,FUNCT_2:4;
   A12:K1 c= (the carrier of TOP-REAL 2)
   proof let z be set;assume z in K1;
        then consider p8 being Point of TOP-REAL 2 such that
        A13: p8=z & p8`1<=0 & p8<>0.REAL 2;
    thus z in (the carrier of TOP-REAL 2) by A13;
   end;
  A14:dom ((sn-FanMorphE)|K1)= dom ((sn-FanMorphE)) /\ K1 by FUNCT_1:68
       .=((the carrier of TOP-REAL 2)) /\ K1 by FUNCT_2:def 1
       .=K1 by A12,XBOOLE_1:28;
  A15: K1=the carrier of ((TOP-REAL 2)|D)|K1 by PRE_TOPC:29;
      rng ((sn-FanMorphE)|K1) c= the carrier of ((TOP-REAL 2)|D)|K1
   proof let y be set;assume y in rng ((sn-FanMorphE)|K1);
     then consider x being set such that
     A16:x in dom ((sn-FanMorphE)|K1)
     & y=((sn-FanMorphE)|K1).x by FUNCT_1:def 5;
         x in (dom (sn-FanMorphE)) /\ K1 by A16,FUNCT_1:68;
     then A17:x in K1 by XBOOLE_0:def 3;
         K1 c= the carrier of TOP-REAL 2 by A5,XBOOLE_1:1;
     then reconsider p=x as Point of TOP-REAL 2 by A17;
        (sn-FanMorphE).p=y by A16,A17,FUNCT_1:72;
     then y in K1 by A1,A17,Th106;
    hence y in the carrier of ((TOP-REAL 2)|D)|K1 by PRE_TOPC:29;
   end;
  then rng ((sn-FanMorphE)|K1)c= the carrier of ((TOP-REAL 2)|D)
                     by A15,XBOOLE_1:1;
  then reconsider g=(sn-FanMorphE)|K1 as Function of ((TOP-REAL 2)|D)|K1,
  ((TOP-REAL 2)|D)  by A14,A15,FUNCT_2:4;
  A18:K0=[#](((TOP-REAL 2)|D)|K0) by PRE_TOPC:def 10;
  A19:K1=[#](((TOP-REAL 2)|D)|K1) by PRE_TOPC:def 10;
  A20:D= [#]((TOP-REAL 2)|D) by PRE_TOPC:def 10;
      D c= K0 \/ K1
   proof let x be set;assume A21: x in D;
     then A22:x in (the carrier of TOP-REAL 2) & not x in {0.REAL 2}
                                     by A2,XBOOLE_0:def 4;
     reconsider px=x as Point of TOP-REAL 2 by A21;
         px`1>=0 & px<>0.REAL 2 or
       px`1<=0 & px<>0.REAL 2 by A22,TARSKI:def 1;
     then x in K0 or x in K1;
    hence x in K0 \/ K1 by XBOOLE_0:def 2;
   end;
  then A23:([#](((TOP-REAL 2)|D)|K0)) \/ ([#](((TOP-REAL 2)|D)|K1))
  = [#]((TOP-REAL 2)|D) by A18,A19,A20,XBOOLE_0:def 10;
  A24: f is continuous & K0 is closed by A1,A2,Th38,Th102;
  A25: g is continuous & K1 is closed by A1,A2,Th36,Th103;
  A26: for x be set st x in ([#]((((TOP-REAL 2)|D)|K0)))
        /\ ([#] ((((TOP-REAL 2)|D)|K1))) holds f.x = g.x
   proof let x be set;assume x in ([#]((((TOP-REAL 2)|D)|K0)))
        /\ ([#] ((((TOP-REAL 2)|D)|K1)));
     then A27:x in K0 & x in K1 by A18,A19,XBOOLE_0:def 3;
     then f.x=(sn-FanMorphE).x by FUNCT_1:72;
    hence f.x = g.x by A27,FUNCT_1:72;
   end;
  then consider h being Function of (TOP-REAL 2)|D,(TOP-REAL 2)|D
  such that A28: h= f+*g & h is continuous
                          by A18,A19,A23,A24,A25,JGRAPH_2:9;
  A29:dom h=the carrier of ((TOP-REAL 2)|D) by FUNCT_2:def 1;
  A30:the carrier of ((TOP-REAL 2)|D)=D by PRE_TOPC:29;
  A31:the carrier of ((TOP-REAL 2)|D)=
((the carrier of TOP-REAL 2)\ {0.REAL 2}) by A2,PRE_TOPC:29;
      dom (sn-FanMorphE)=(the carrier of (TOP-REAL 2))
                    by FUNCT_2:def 1;
  then A32:dom ((sn-FanMorphE)|D)=(the carrier of (TOP-REAL 2))/\ D
                    by FUNCT_1:68
              .=the carrier of ((TOP-REAL 2)|D) by A30,XBOOLE_1:28;
  A33:dom f=K0 by A9,FUNCT_2:def 1;
  A34:K0=[#](((TOP-REAL 2)|D)|K0) by PRE_TOPC:def 10;
  A35:dom g=K1 by A15,FUNCT_2:def 1;
     K1=[#](((TOP-REAL 2)|D)|K1) by PRE_TOPC:def 10;
  then A36: f tolerates g by A26,A33,A34,A35,PARTFUN1:def 6;
      for x being set st x in dom h holds h.x=((sn-FanMorphE)|D).x
   proof let x be set;assume A37: x in dom h;
     then x in (the carrier of TOP-REAL 2) & not x in {0.REAL 2}
                     by A31,XBOOLE_0:def 4;
     then A38:x <>0.REAL 2 by TARSKI:def 1;
     reconsider p=x as Point of TOP-REAL 2 by A31,A37,XBOOLE_0:def 4;
     A39: x in D`` by A29,A37,PRE_TOPC:29;
         now per cases;
     case A40:x in K0;
       A41:(sn-FanMorphE)|D.p=(sn-FanMorphE).p by A39,FUNCT_1:72
          .=f.p by A40,FUNCT_1:72;
           h.p=(g+*f).p by A28,A36,FUNCT_4:35
       .=f.p by A33,A40,FUNCT_4:14;
      hence h.x=(sn-FanMorphE)|D.x by A41;
     end;
     case not x in K0;
       then not (p`1>=0) by A38;
       then A42:x in K1 by A38;
          (sn-FanMorphE)|D.p=(sn-FanMorphE).p by A39,FUNCT_1:72
                           .=g.p by A42,FUNCT_1:72;
      hence h.x=(sn-FanMorphE)|D.x by A28,A35,A42,FUNCT_4:14;
     end;
     end;
    hence h.x=(sn-FanMorphE)|D.x;
   end;
  then f+*g=(sn-FanMorphE)|D by A28,A29,A32,FUNCT_1:9;
 hence thesis by A18,A19,A23,A24,A25,A26,JGRAPH_2:9;
end;

theorem Th108: for sn being Real
  st -1<sn & sn<1 holds
  ex h being Function of (TOP-REAL 2),(TOP-REAL 2)
  st h=(sn-FanMorphE) & h is continuous
proof let sn be Real;
 assume A1:  -1<sn & sn<1;
 reconsider f=(sn-FanMorphE) as Function of (TOP-REAL 2),(TOP-REAL 2)
                         ;
 reconsider D=(the carrier of TOP-REAL 2) \{0.REAL 2}
   as non empty Subset of TOP-REAL 2 by JGRAPH_2:19;
 A2: f.(0.REAL 2)=0.REAL 2 by Th89,JGRAPH_2:11;
 A3: D`= {0.REAL 2} by JGRAPH_3:30;
 A4: for p being Point of (TOP-REAL 2)|D holds f.p<>f.(0.REAL 2)
  proof let p be Point of (TOP-REAL 2)|D;
    A5:[#]((TOP-REAL 2)|D)=D by PRE_TOPC:def 10;
    then A6:p in the carrier of TOP-REAL 2 & not p in {0.REAL 2}
                         by XBOOLE_0:def 4;
    reconsider q=p as Point of TOP-REAL 2 by A5,XBOOLE_0:def 4;
    A7:not p=0.REAL 2 by A6,TARSKI:def 1;
        now per cases;
    case A8: q`2/|.q.|>=sn & q`1>=0;
      set q9= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1-sn))]|;
      A9:q9`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)) &
      q9`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by EUCLID:56;
          now assume A10: q9=0.REAL 2;
       A11: |.q.|<>0 by A7,TOPRNS_1:25;
       then sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)=sqrt(1-0) by A9,A10,JGRAPH_2:11
,SQUARE_1:60,XCMPLX_1:6
       .=1 by SQUARE_1:83;
      hence contradiction by A10,A11,EUCLID:56,JGRAPH_2:11;
     end;
     hence f.p<>f.(0.REAL 2) by A1,A2,A7,A8,Th91;
    end;
    case A12: q`2/|.q.|<sn & q`1>=0;
      set q9=|[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
              |.q.|* ((q`2/|.q.|-sn)/(1+sn))]|;
      A13:q9`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)) &
          q9`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by EUCLID:56;
          now assume A14: q9=0.REAL 2;
       A15: |.q.|<>0 by A7,TOPRNS_1:25;
       then sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)=sqrt(1-0) by A13,A14,JGRAPH_2:11
,SQUARE_1:60,XCMPLX_1:6
       .=1 by SQUARE_1:83;
      hence contradiction by A14,A15,EUCLID:56,JGRAPH_2:11;
     end;
     hence f.p<>f.(0.REAL 2) by A1,A2,A7,A12,Th91;
     end;
     case q`1<0; then f.p=p by Th89;
     hence f.p<>f.(0.REAL 2) by A7,Th89,JGRAPH_2:11;
    end;
    end;
   hence f.p<>f.(0.REAL 2);
  end;
 A16:ex h being Function of (TOP-REAL 2)|D,(TOP-REAL 2)|D
  st h=(sn-FanMorphE)|D & h is continuous by A1,A3,Th107;
     for V being Subset of (TOP-REAL 2) st f.(0.REAL 2) in V & V is open
 ex W being Subset of (TOP-REAL 2) st 0.REAL 2 in W
 & W is open & f.:W c= V
  proof let V be Subset of (TOP-REAL 2);
    assume A17:f.(0.REAL 2) in V & V is open;
     reconsider u0=0.REAL 2 as Point of Euclid 2;
     consider r being real number such that A18:r>0 & Ball(u0,r) c= V
                                   by A2,A17,TOPMETR:22;
     reconsider r as Real by XREAL_0:def 1;
     reconsider W1=Ball(u0,r) as Subset of TOP-REAL 2;
     A19:u0 in W1 by A18,GOBOARD6:4;
     A20:W1 is open by GOBOARD6:6;
         f.:W1 c= W1
      proof let z be set;assume z in f.:W1;
        then consider y being set such that
        A21: y in dom f & y in W1 & z=f.y by FUNCT_1:def 12;
        reconsider q=y as Point of TOP-REAL 2 by A21;
        reconsider qy=q as Point of Euclid 2;
            z in rng f by A21,FUNCT_1:def 5;
        then reconsider qz=z as Point of TOP-REAL 2;
        reconsider pz=qz as Point of Euclid 2;
            dist(u0,qy)<r by A21,METRIC_1:12;
        then A22: |.(0.REAL 2) - q.|<r by JGRAPH_1:45;
            now per cases by JGRAPH_2:11;
        case q`1<=0;
         hence z in W1 by A21,Th89;
        end;
        case A23: q<>0.REAL 2 &
          (q`2/|.q.|>=sn & q`1>=0);
          then A24:(sn-FanMorphE).q= |[
          |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by A1,Th91;
              |.q.|<>0 by A23,TOPRNS_1:25;
          then A25: (|.q.|)^2>0 by SQUARE_1:74;
        A26: 1-sn>0 by A1,XREAL_1:151;
        A27: qz`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))&
        qz`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by A21,A24,EUCLID:56;
        A28: (q`2/|.q.|-sn)>= 0 by A23,XREAL_1:50;
        A29: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
            0<=(q`1)^2 by XREAL_1:65;
        then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A25,A29,REAL_1:73;
        then (q`2)^2/(|.q.|)^2 <= 1 by A25,XCMPLX_1:60;
        then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then 1>=q`2/|.q.| by Lm2;
        then A30: 1-sn>=q`2/|.q.|-sn by XREAL_1:11;
        A31: -(1-sn)<= -0 by A26,XREAL_1:26;
             -(1-sn)<= -( q`2/|.q.|-sn) by A30,XREAL_1:26;
         then (-(1-sn))/(1-sn)<=(-( q`2/|.q.|-sn))/(1-sn) by A26,REAL_1:73;
        then A32: -1<=(-( q`2/|.q.|-sn))/(1-sn) by A26,XCMPLX_1:198;
           --(1-sn)>= -(q`2/|.q.|-sn) by A28,A31,XREAL_1:26;
       then (-(q`2/|.q.|-sn))/(1-sn)<=1 by A26,REAL_2:117;
       then ((-(q`2/|.q.|-sn))/(1-sn))^2<=1^2 by A32,SQUARE_1:119;
       then 1-((-(q`2/|.q.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
       then 1-(-((q`2/|.q.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
       then A33: 1-((q`2/|.q.|-sn)/(1-sn))^2>=0;
        A34: (qz`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))^2
                         by A27
         .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1-sn))^2) by A33,SQUARE_1:def 4;
        A35: (qz`2)^2= (|.q.|)^2*((q`2/|.q.|-sn)/(1-sn))^2
                         by A27;
            (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
        .=(|.q.|)^2 by A34,A35;
        then A36: sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
          A37: |.qz.|=|.q.| by A36,SQUARE_1:89;
              |.(0.REAL 2) +- q.|<r by A22,EUCLID:45;
          then |.- q.|<r by EUCLID:31;
          then |.q.|<r by TOPRNS_1:27;
          then |.- qz.|<r by A37,TOPRNS_1:27;
          then |.(0.REAL 2) +- qz.|<r by EUCLID:31;
          then |.(0.REAL 2) - qz.|<r by EUCLID:45;
          then dist(u0,pz)<r by JGRAPH_1:45;
         hence z in W1 by METRIC_1:12;
        end;
        case A38: q<>0.REAL 2 & q`2/|.q.|<sn & q`1>=0;
          then A39:(sn-FanMorphE).q= |[|.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)
),
          |.q.|* ((q`2/|.q.|-sn)/(1+sn))]| by A1,Th91;
              |.q.|<>0 by A38,TOPRNS_1:25;
          then A40: (|.q.|)^2>0 by SQUARE_1:74;
        A41: (sn-q`2/|.q.|)>=0 by A38,XREAL_1:50;
        A42: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        A43: 1+sn>0 by A1,XREAL_1:150;
        A44: qz`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))&
        qz`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn))
                     by A21,A39,EUCLID:56;
            0<=(q`1)^2 by XREAL_1:65;
        then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A40,A42,REAL_1:73;
        then (q`2)^2/(|.q.|)^2 <= 1 by A40,XCMPLX_1:60;
        then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then -1<=q`2/|.q.| by Lm2;
        then --1>=-q`2/|.q.| by XREAL_1:26;
        then A45: 1+sn>=-q`2/|.q.|+sn by XREAL_1:9;
            -(1+sn)<= -0 by A43,XREAL_1:26;
         then (-(1+sn))/(1+sn)<=(-( q`2/|.q.|-sn))/(1+sn) by A41,A43,REAL_1:73
;
        then A46: -1<=(-( q`2/|.q.|-sn))/(1+sn) by A43,XCMPLX_1:198;
        (-(q`2/|.q.|-sn))/(1+sn)<=1 by A43,A45,REAL_2:117;
       then ((-(q`2/|.q.|-sn))/(1+sn))^2<=1^2 by A46,SQUARE_1:119;
       then 1-((-(q`2/|.q.|-sn))/(1+sn))^2>=0 by XREAL_1:50;
       then 1-(-((q`2/|.q.|-sn))/(1+sn))^2>=0 by XCMPLX_1:188;
       then A47: 1-((q`2/|.q.|-sn)/(1+sn))^2>=0;
        A48: (qz`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))^2
                         by A44
         .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1+sn))^2) by A47,SQUARE_1:def 4;
        A49: (qz`2)^2= (|.q.|)^2*((q`2/|.q.|-sn)/(1+sn))^2
                         by A44;
            (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
        .=(|.q.|)^2 by A48,A49;
        then A50: sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
          A51: |.qz.|=|.q.| by A50,SQUARE_1:89;
              |.(0.REAL 2) +- q.|<r by A22,EUCLID:45;
          then |.- q.|<r by EUCLID:31;
          then |.q.|<r by TOPRNS_1:27;
          then |.- qz.|<r by A51,TOPRNS_1:27;
          then |.(0.REAL 2) +- qz.|<r by EUCLID:31;
          then |.(0.REAL 2) - qz.|<r by EUCLID:45;
          then dist(u0,pz)<r by JGRAPH_1:45;
         hence z in W1 by METRIC_1:12;
        end;
        end;
       hence z in W1;
      end;
     then f.:W1 c= V by A18,XBOOLE_1:1;
   hence ex W being Subset of (TOP-REAL 2) st 0.REAL 2 in W
       & W is open & f.:W c= V by A19,A20;
  end;
  then f is continuous by A2,A3,A4,A16,JGRAPH_3:13;
 hence thesis;
end;

theorem Th109:
  for sn being Real st -1<sn & sn<1 holds sn-FanMorphE is one-to-one
proof let sn be Real;
 assume A1:  -1<sn & sn<1;
  for x1,x2 being set st x1 in dom (sn-FanMorphE) & x2 in dom (sn-FanMorphE)
   & (sn-FanMorphE).x1=(sn-FanMorphE).x2 holds x1=x2
  proof let x1,x2 be set;
   assume A2: x1 in dom (sn-FanMorphE) & x2 in dom (sn-FanMorphE)
    & (sn-FanMorphE).x1=(sn-FanMorphE).x2;
    then reconsider p1=x1 as Point of TOP-REAL 2;
    reconsider p2=x2 as Point of TOP-REAL 2 by A2;
    set q=p1,p=p2;
    A3: 1-sn>0 by A1,XREAL_1:151;
        now per cases by JGRAPH_2:11;
    case A4: q`1<=0;
      then A5:(sn-FanMorphE).q=q by Th89;
          now per cases by JGRAPH_2:11;
      case p`1<=0;
       hence x1=x2 by A2,A5,Th89;
      end;
      case A6:p<>0.REAL 2 &
          (p`2/|.p.|>=sn & p`1>=0);
        then A7:
         sn-FanMorphE.p= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
          |.p.|* ((p`2/|.p.|-sn)/(1-sn))]| by A1,Th91;
         set p4= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
          |.p.|* ((p`2/|.p.|-sn)/(1-sn))]|;
        A8: p4`1= |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)) &
          p4`2= |.p.|* ((p`2/|.p.|-sn)/(1-sn)) by EUCLID:56;
     A9: |.p.|<>0 by A6,TOPRNS_1:25;
     then A10: (|.p.|)^2>0 by SQUARE_1:74;
        A11: (p`2/|.p.|-sn)>=0 by A6,XREAL_1:50;
        A12: (p`2/|.p.|-sn)>= 0 by A6,XREAL_1:50;
        A13: (p`2/|.p.|-sn)/(1-sn)>=0 by A3,A11,REAL_2:125;
        A14: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
            0<=(p`1)^2 by XREAL_1:65;
        then 0+(p`2)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
        then (p`2)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by A10,A14,REAL_1:73;
        then (p`2)^2/(|.p.|)^2 <= 1 by A10,XCMPLX_1:60;
        then ((p`2)/|.p.|)^2 <= 1 by XCMPLX_1:77;
        then 1>=p`2/|.p.| by Lm2;
        then A15: 1-sn>=p`2/|.p.|-sn by XREAL_1:11;
        A16: -(1-sn)<= -0 by A3,XREAL_1:26;
             -(1-sn)<= -( p`2/|.p.|-sn) by A15,XREAL_1:26;
         then (-(1-sn))/(1-sn)<=(-( p`2/|.p.|-sn))/(1-sn) by A3,REAL_1:73;
        then A17: -1<=(-( p`2/|.p.|-sn))/(1-sn) by A3,XCMPLX_1:198;
           --(1-sn)>= -(p`2/|.p.|-sn) by A12,A16,XREAL_1:26;
       then (-(p`2/|.p.|-sn))/(1-sn)<=1 by A3,REAL_2:117;
       then ((-(p`2/|.p.|-sn))/(1-sn))^2<=1^2 by A17,SQUARE_1:119;
       then A18: 1-((-(p`2/|.p.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
       then 1-(-((p`2/|.p.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
       then A19: 1-((p`2/|.p.|-sn)/(1-sn))^2>=0;
           sqrt(1-((-(p`2/|.p.|-sn))/(1-sn))^2)>=0 by A18,SQUARE_1:def 4;
       then sqrt(1-(-(p`2/|.p.|-sn))^2/(1-sn)^2)>=0 by XCMPLX_1:77;
       then sqrt(1-(p`2/|.p.|-sn)^2/(1-sn)^2)>=0;
       then sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)>=0 by XCMPLX_1:77;
        then q`1=0 by A2,A4,A5,A7,A8,XREAL_1:129;
        then (sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2))=0 by A2,A5,A7,A8,A9,
XCMPLX_1:6;
        then 1-((p`2/|.p.|-sn)/(1-sn))^2=0 by A19,SQUARE_1:92;
        then 1=0+((p`2/|.p.|-sn)/(1-sn))^2;
        then 1= (p`2/|.p.|-sn)/(1-sn) by A13,SQUARE_1:83,89;
        then 1 *(1-sn)=(p`2/|.p.|-sn) by A3,XCMPLX_1:88;
        then 1-sn+sn=p`2/|.p.|;
        then 1=p`2/|.p.|;
        then 1 *|.p.|=p`2 by A9,XCMPLX_1:88;
        then (p`2)^2-(p`2)^2 =(p`1)^2 by A14;
        then 0= (p`1)^2;
        then p`1=0 by XCMPLX_1:6;
       hence x1=x2 by A2,A5,Th89;
      end;
      case A20:p<>0.REAL 2 &
        (p`2/|.p.|<sn & p`1>=0);
        then A21:
         sn-FanMorphE.p= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
          |.p.|* ((p`2/|.p.|-sn)/(1+sn))]| by A1,Th91;
         set p4= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
          |.p.|* ((p`2/|.p.|-sn)/(1+sn))]|;
        A22: p4`1= |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)) &
          p4`2= |.p.|* ((p`2/|.p.|-sn)/(1+sn)) by EUCLID:56;
     A23: |.p.|<>0 by A20,TOPRNS_1:25;
     then A24: (|.p.|)^2>0 by SQUARE_1:74;
     A25: 1+sn>0 by A1,XREAL_1:150;
        A26: (p`2/|.p.|-sn)<=0 by A20,REAL_2:106;
        then A27: -(p`2/|.p.|-sn)>= -0 by XREAL_1:26;
        --(p`2/|.p.|-sn)/(1+sn)<=0 by A25,A26,REAL_2:126;
        then A28: -((p`2/|.p.|-sn)/(1+sn))>=0 by XREAL_1:60;
        A29: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
        0<=(p`1)^2 by XREAL_1:65;
        then 0+(p`2)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
        then (p`2)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by A24,A29,REAL_1:73;
        then (p`2)^2/(|.p.|)^2 <= 1 by A24,XCMPLX_1:60;
        then ((p`2)/|.p.|)^2 <= 1 by XCMPLX_1:77;
        then A30: (-((p`2)/|.p.|))^2 <= 1;
        -(1+sn)<= -0 by A25,XREAL_1:26;
        then (-(1+sn))/(1+sn)<=(-( p`2/|.p.|-sn))/(1+sn) by A25,A27,REAL_1:73;
        then A31: -1<=(-( p`2/|.p.|-sn))/(1+sn) by A25,XCMPLX_1:198;
           1>= -p`2/|.p.| by A30,Lm2;
       then (1+sn)>= -p`2/|.p.|+sn by XREAL_1:9;
       then (-(p`2/|.p.|-sn))/(1+sn)<=1 by A25,REAL_2:117;
       then ((-(p`2/|.p.|-sn))/(1+sn))^2<=1^2 by A31,SQUARE_1:119;
       then A32: 1-((-(p`2/|.p.|-sn))/(1+sn))^2>=0 by XREAL_1:50;
       then 1-(-((p`2/|.p.|-sn))/(1+sn))^2>=0 by XCMPLX_1:188;
       then A33: 1-((p`2/|.p.|-sn)/(1+sn))^2>=0;
           sqrt(1-((-(p`2/|.p.|-sn))/(1+sn))^2)>=0 by A32,SQUARE_1:def 4;
       then sqrt(1-(-(p`2/|.p.|-sn))^2/(1+sn)^2)>=0 by XCMPLX_1:77;
       then sqrt(1-((p`2/|.p.|-sn))^2/(1+sn)^2)>=0;
       then sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)>=0 by XCMPLX_1:77;
        then q`1=0 by A2,A4,A5,A21,A22,XREAL_1:129;
        then (sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2))=0 by A2,A5,A21,A22,A23,
XCMPLX_1:6;
        then 1-((p`2/|.p.|-sn)/(1+sn))^2=0 by A33,SQUARE_1:92;
        then 1=0+((p`2/|.p.|-sn)/(1+sn))^2;
        then 1=sqrt((-((p`2/|.p.|-sn)/(1+sn)))^2) by SQUARE_1:83;
        then 1= -((p`2/|.p.|-sn)/(1+sn)) by A28,SQUARE_1:89;
        then 1= ((-(p`2/|.p.|-sn))/(1+sn)) by XCMPLX_1:188;
        then 1 *(1+sn)=-(p`2/|.p.|-sn) by A25,XCMPLX_1:88;
        then 1+sn=-p`2/|.p.|+sn;
        then 1+sn-sn=-p`2/|.p.|;
        then 1=-p`2/|.p.|;
        then 1=(-p`2)/|.p.| by XCMPLX_1:188;
        then 1 *|.p.|=-p`2 by A23,XCMPLX_1:88;
        then (-p`2)^2-(p`2)^2 =(p`1)^2 by A29,XCMPLX_1:26;
        then (p`2)^2-(p`2)^2 =(p`1)^2;
        then 0= (p`1)^2;
        then p`1=0 by XCMPLX_1:6;
       hence x1=x2 by A2,A5,Th89;
      end;
      end;
     hence x1=x2;
    end;
    case A34: q`2/|.q.|>=sn & q`1>=0 & q<>0.REAL 2;
        then A35:
         sn-FanMorphE.q= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by A1,Th91;
         set q4= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1-sn))]|;
        A36: q4`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)) &
          q4`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by EUCLID:56;
         |.q.|<>0 by A34,TOPRNS_1:25;
     then A37: (|.q.|)^2>0 by SQUARE_1:74;
          now per cases by JGRAPH_2:11;
      case A38: p`1<=0;
        then A39: (sn-FanMorphE).p=p by Th89;
        A40: |.q.|<>0 by A34,TOPRNS_1:25;
        then A41: (|.q.|)^2>0 by SQUARE_1:74;
        A42: 1-sn>0 by A1,XREAL_1:151;
        A43: (q`2/|.q.|-sn)>=0 by A34,XREAL_1:50;
        A44: (q`2/|.q.|-sn)>= 0 by A34,XREAL_1:50;
        A45: (q`2/|.q.|-sn)/(1-sn)>=0 by A42,A43,REAL_2:125;
        A46: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        0<=(q`1)^2 by XREAL_1:65;
        then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A41,A46,REAL_1:73;
        then (q`2)^2/(|.q.|)^2 <= 1 by A41,XCMPLX_1:60;
        then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then 1>=q`2/|.q.| by Lm2;
        then A47: 1-sn>=q`2/|.q.|-sn by XREAL_1:11;
        A48: -(1-sn)<= -0 by A42,XREAL_1:26;
         -(1-sn)<= -( q`2/|.q.|-sn) by A47,XREAL_1:26;
         then (-(1-sn))/(1-sn)<=(-( q`2/|.q.|-sn))/(1-sn)
                        by A42,REAL_1:73;
        then A49: -1<=(-( q`2/|.q.|-sn))/(1-sn) by A42,XCMPLX_1:198;
           --(1-sn)>= -(q`2/|.q.|-sn) by A44,A48,XREAL_1:26;
       then (-(q`2/|.q.|-sn))/(1-sn)<=1 by A42,REAL_2:117;
       then ((-(q`2/|.q.|-sn))/(1-sn))^2<=1^2 by A49,SQUARE_1:119;
       then A50: 1-((-(q`2/|.q.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
       then 1-(-((q`2/|.q.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
       then A51: 1-((q`2/|.q.|-sn)/(1-sn))^2>=0;
           sqrt(1-((-(q`2/|.q.|-sn))/(1-sn))^2)>=0 by A50,SQUARE_1:def 4;
       then sqrt(1-(-(q`2/|.q.|-sn))^2/(1-sn)^2)>=0 by XCMPLX_1:77;
       then sqrt(1-(q`2/|.q.|-sn)^2/(1-sn)^2)>=0;
       then sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)>=0 by XCMPLX_1:77;
        then p`1=0 by A2,A35,A36,A38,A39,XREAL_1:129;
        then (sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))=0 by A2,A35,A36,A39,A40,
XCMPLX_1:6;
        then 1-((q`2/|.q.|-sn)/(1-sn))^2=0 by A51,SQUARE_1:92;
        then 1=0+((q`2/|.q.|-sn)/(1-sn))^2;
        then 1= (q`2/|.q.|-sn)/(1-sn) by A45,SQUARE_1:83,89;
        then 1 *(1-sn)=(q`2/|.q.|-sn) by A42,XCMPLX_1:88;
        then 1-sn+sn=q`2/|.q.|;
        then 1=q`2/|.q.|;
        then 1 *|.q.|=q`2 by A40,XCMPLX_1:88;
        then (q`2)^2-(q`2)^2 =(q`1)^2 by A46;
        then 0= (q`1)^2;
        then q`1=0 by XCMPLX_1:6;
       hence x1=x2 by A2,A39,Th89;
      end;
      case A52:p<>0.REAL 2 &
          (p`2/|.p.|>=sn & p`1>=0);
        then A53:
         sn-FanMorphE.p= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
          |.p.|* ((p`2/|.p.|-sn)/(1-sn))]| by A1,Th91;
         set p4= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
          |.p.|* ((p`2/|.p.|-sn)/(1-sn))]|;
        A54: p4`1= |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)) &
          p4`2= |.p.|* ((p`2/|.p.|-sn)/(1-sn)) by EUCLID:56;
        A55: q4`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))&
        q4`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by EUCLID:56;
        A56: (q`2/|.q.|-sn)>= 0 by A34,XREAL_1:50;
        A57: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
            0<=(q`1)^2 by XREAL_1:65;
        then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A37,A57,REAL_1:73;
        then (q`2)^2/(|.q.|)^2 <= 1 by A37,XCMPLX_1:60;
        then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then 1>=q`2/|.q.| by Lm2;
        then A58: 1-sn>=q`2/|.q.|-sn by XREAL_1:11;
        A59: -(1-sn)<= -0 by A3,XREAL_1:26;
             -(1-sn)<= -( q`2/|.q.|-sn) by A58,XREAL_1:26;
         then (-(1-sn))/(1-sn)<=(-( q`2/|.q.|-sn))/(1-sn) by A3,REAL_1:73;
        then A60: -1<=(-( q`2/|.q.|-sn))/(1-sn) by A3,XCMPLX_1:198;
           --(1-sn)>= -(q`2/|.q.|-sn) by A56,A59,XREAL_1:26;
       then (-(q`2/|.q.|-sn))/(1-sn)<=1 by A3,REAL_2:117;
       then ((-(q`2/|.q.|-sn))/(1-sn))^2<=1^2 by A60,SQUARE_1:119;
       then 1-((-(q`2/|.q.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
       then 1-(-((q`2/|.q.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
       then A61: 1-((q`2/|.q.|-sn)/(1-sn))^2>=0;
        A62: (q4`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))^2
                         by A55
         .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1-sn))^2) by A61,SQUARE_1:def 4;
        A63: (q4`2)^2= (|.q.|)^2*((q`2/|.q.|-sn)/(1-sn))^2
                         by A55;
            (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
        .=(|.q.|)^2 by A62,A63;
        then A64: sqrt((|.q4.|)^2)=|.q.| by SQUARE_1:89;
        then A65: |.q4.|=|.q.| by SQUARE_1:89;
        A66: |.p.|<>0 by A52,TOPRNS_1:25;
        then A67: (|.p.|)^2>0 by SQUARE_1:74;
        A68: (p`2/|.p.|-sn)>= 0 by A52,XREAL_1:50;
        A69: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
            0<=(p`1)^2 by XREAL_1:65;
        then 0+(p`2)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
        then (p`2)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by A67,A69,REAL_1:73;
        then (p`2)^2/(|.p.|)^2 <= 1 by A67,XCMPLX_1:60;
        then ((p`2)/|.p.|)^2 <= 1 by XCMPLX_1:77;
        then 1>=p`2/|.p.| by Lm2;
        then A70: 1-sn>=p`2/|.p.|-sn by XREAL_1:11;
        A71: -(1-sn)<= -0 by A3,XREAL_1:26;
             -(1-sn)<= -( p`2/|.p.|-sn) by A70,XREAL_1:26;
         then (-(1-sn))/(1-sn)<=(-( p`2/|.p.|-sn))/(1-sn) by A3,REAL_1:73;
        then A72: -1<=(-( p`2/|.p.|-sn))/(1-sn) by A3,XCMPLX_1:198;
           --(1-sn)>= -(p`2/|.p.|-sn) by A68,A71,XREAL_1:26;
       then (-(p`2/|.p.|-sn))/(1-sn)<=1 by A3,REAL_2:117;
       then ((-(p`2/|.p.|-sn))/(1-sn))^2<=1^2 by A72,SQUARE_1:119;
       then 1-((-(p`2/|.p.|-sn))/(1-sn))^2>=0 by XREAL_1:50;
       then 1-(-((p`2/|.p.|-sn))/(1-sn))^2>=0 by XCMPLX_1:188;
       then A73: 1-((p`2/|.p.|-sn)/(1-sn))^2>=0;
        A74: (p4`1)^2= (|.p.|)^2*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2))^2
                         by A54
         .= (|.p.|)^2*(1-((p`2/|.p.|-sn)/(1-sn))^2) by A73,SQUARE_1:def 4;
        A75: (p4`2)^2= (|.p.|)^2*((p`2/|.p.|-sn)/(1-sn))^2
                         by A54;
            (|.p4.|)^2=(p4`1)^2+(p4`2)^2 by JGRAPH_3:10
        .=(|.p.|)^2 by A74,A75;
        then A76: sqrt((|.p4.|)^2)=|.p.| by SQUARE_1:89;
        then A77: |.p4.|=|.p.| by SQUARE_1:89;
          ((p`2/|.p.|-sn)/(1-sn))
        =|.q.|* ((q`2/|.q.|-sn)/(1-sn))/|.p.| by A2,A35,A36,A53,A54,A66,
XCMPLX_1:90;
        then (p`2/|.p.|-sn)/(1-sn)=(q`2/|.q.|-sn)/(1-sn)
                              by A2,A35,A53,A64,A66,A76,XCMPLX_1:90;
        then (p`2/|.p.|-sn)/(1-sn)*(1-sn)=q`2/|.q.|-sn by A3,XCMPLX_1:88;
        then p`2/|.p.|-sn=q`2/|.q.|-sn by A3,XCMPLX_1:88;
        then p`2/|.p.|-sn+sn=q`2/|.q.|;
        then p`2/|.p.|=q`2/|.q.|;
        then p`2/|.p.|*|.p.|=q`2 by A2,A35,A53,A65,A66,A77,XCMPLX_1:88;
        then A78: p`2=q`2 by A66,XCMPLX_1:88;
        A79: |.p.|^2=(p`1)^2+(p`2)^2 by JGRAPH_3:10;
            |.q.|^2=(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        then (p`1)^2+(p`2)^2-(p`2)^2=(q`1)^2 by A2,A35,A53,A65,A77,A78,A79;
        then (p`1)^2=(q`1)^2;
        then p`1=sqrt((q`1)^2) by A52,SQUARE_1:89;
        then A80: p`1=q`1 by A34,SQUARE_1:89;
            p=|[p`1,p`2]| by EUCLID:57;
       hence x1=x2 by A78,A80,EUCLID:57;
      end;
      case A81: p<>0.REAL 2 &
        (p`2/|.p.|<sn & p`1>=0);
        then A82:
         sn-FanMorphE.p= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
          |.p.|* ((p`2/|.p.|-sn)/(1+sn))]| by A1,Th91;
         set p4= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
          |.p.|* ((p`2/|.p.|-sn)/(1+sn))]|;
        A83: p4`1= |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)) &
          p4`2= |.p.|* ((p`2/|.p.|-sn)/(1+sn)) by EUCLID:56;
         A84: p`2/|.p.|-sn<0 by A81,REAL_2:105;
             1+sn>0 by A1,XREAL_1:150;
         then A85: ((p`2/|.p.|-sn)/(1+sn))<0 by A84,REAL_2:128;
        A86: |.p.|>=0;
            |.p.|<>0 by A81,TOPRNS_1:25;
         then A87: |.p.|* ((p`2/|.p.|-sn)/(1+sn))<0 by A85,A86,XREAL_1:134;
         A88: q`2/|.q.|-sn>=0 by A34,XREAL_1:50;
             1-sn>0 by A1,XREAL_1:151;
         then ((q`2/|.q.|-sn)/(1-sn))>=0 by A88,REAL_2:125;
       hence x1=x2 by A2,A35,A36,A82,A83,A87,REAL_2:121;
      end;
      end;
     hence x1=x2;
    end;
    case A89:
      q`2/|.q.|<sn & q`1>=0 & q<>0.REAL 2;
        then A90:
         sn-FanMorphE.q= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1+sn))]| by A1,Th91;
         set q4= |[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1+sn))]|;
        A91: q4`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)) &
          q4`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by EUCLID:56;
     A92: |.q.|<>0 by A89,TOPRNS_1:25;
     then A93: (|.q.|)^2>0 by SQUARE_1:74;
          now per cases by JGRAPH_2:11;
      case A94: p`1<=0;
        then A95:(sn-FanMorphE).p=p by Th89;
        A96: 1+sn>0 by A1,XREAL_1:150;
        A97: (q`2/|.q.|-sn)<=0 by A89,REAL_2:106;
        then A98: -(q`2/|.q.|-sn)>= -0 by XREAL_1:26;
            --(q`2/|.q.|-sn)/(1+sn)<=0 by A96,A97,REAL_2:126;
        then A99: -((q`2/|.q.|-sn)/(1+sn))>=0 by XREAL_1:60;
        A100: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
            0<=(q`1)^2 by XREAL_1:65;
        then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A93,A100,REAL_1:73;
        then (q`2)^2/(|.q.|)^2 <= 1 by A93,XCMPLX_1:60;
        then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then A101: (-((q`2)/|.q.|))^2 <= 1;
            -(1+sn)<= -0 by A96,XREAL_1:26;
        then (-(1+sn))/(1+sn)<=(-( q`2/|.q.|-sn))/(1+sn) by A96,A98,REAL_1:73
;
        then A102: -1<=(-( q`2/|.q.|-sn))/(1+sn) by A96,XCMPLX_1:198;
           1>= -q`2/|.q.| by A101,Lm2;
       then (1+sn)>= -q`2/|.q.|+sn by XREAL_1:9;
       then (-(q`2/|.q.|-sn))/(1+sn)<=1 by A96,REAL_2:117;
       then ((-(q`2/|.q.|-sn))/(1+sn))^2<=1^2 by A102,SQUARE_1:119;
       then A103: 1-((-(q`2/|.q.|-sn))/(1+sn))^2>=0 by XREAL_1:50;
       then 1-(-((q`2/|.q.|-sn))/(1+sn))^2>=0 by XCMPLX_1:188;
       then A104: 1-((q`2/|.q.|-sn)/(1+sn))^2>=0;
           sqrt(1-((-(q`2/|.q.|-sn))/(1+sn))^2)>=0 by A103,SQUARE_1:def 4;
       then sqrt(1-(-(q`2/|.q.|-sn))^2/(1+sn)^2)>=0 by XCMPLX_1:77;
       then sqrt(1-((q`2/|.q.|-sn))^2/(1+sn)^2)>=0;
       then sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)>=0 by XCMPLX_1:77;
        then p`1=0 by A2,A90,A91,A94,A95,XREAL_1:129;
        then (sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))=0 by A2,A90,A91,A92,A95,
XCMPLX_1:6;
        then 1-((q`2/|.q.|-sn)/(1+sn))^2=0 by A104,SQUARE_1:92;
        then 1=0+((q`2/|.q.|-sn)/(1+sn))^2;
        then 1=sqrt((-((q`2/|.q.|-sn)/(1+sn)))^2) by SQUARE_1:83;
        then 1= -((q`2/|.q.|-sn)/(1+sn)) by A99,SQUARE_1:89;
        then 1= ((-(q`2/|.q.|-sn))/(1+sn)) by XCMPLX_1:188;
        then 1 *(1+sn)=-(q`2/|.q.|-sn) by A96,XCMPLX_1:88;
        then (1+sn)=-q`2/|.q.|+sn;
        then 1+sn-sn=-q`2/|.q.|;
        then 1=-q`2/|.q.|;
        then 1=(-q`2)/|.q.| by XCMPLX_1:188;
        then 1 *|.q.|=-q`2 by A92,XCMPLX_1:88;
        then (-q`2)^2-(q`2)^2 =(q`1)^2 by A100,XCMPLX_1:26;
        then (q`2)^2-(q`2)^2 =(q`1)^2;
        then 0= (q`1)^2;
        then q`1=0 by XCMPLX_1:6;
       hence x1=x2 by A2,A95,Th89;
      end;
      case A105:p<>0.REAL 2 &
          (p`2/|.p.|>=sn & p`1>=0);
        then A106:
         sn-FanMorphE.p= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
          |.p.|* ((p`2/|.p.|-sn)/(1-sn))]| by A1,Th91;
         set p4= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)),
          |.p.|* ((p`2/|.p.|-sn)/(1-sn))]|;
        A107: p4`1= |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1-sn))^2)) &
          p4`2= |.p.|* ((p`2/|.p.|-sn)/(1-sn)) by EUCLID:56;
         A108: q`2/|.q.|-sn<0 by A89,REAL_2:105;
             1+sn>0 by A1,XREAL_1:150;
         then A109: ((q`2/|.q.|-sn)/(1+sn))<0 by A108,REAL_2:128;
        A110: |.q.|>=0;
            |.q.|<>0 by A89,TOPRNS_1:25;
         then A111: |.q.|* ((q`2/|.q.|-sn)/(1+sn))<0 by A109,A110,XREAL_1:134;
         A112: p`2/|.p.|-sn>=0 by A105,XREAL_1:50;
             1-sn>0 by A1,XREAL_1:151;
         then A113: ((p`2/|.p.|-sn)/(1-sn))>=0 by A112,REAL_2:125;
       thus x1=x2 by A2,A90,A91,A106,A107,A111,A113,REAL_2:121;
      end;
      case A114:p<>0.REAL 2 &
          (p`2/|.p.|<sn & p`1>=0);
        then A115:
         sn-FanMorphE.p= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
          |.p.|* ((p`2/|.p.|-sn)/(1+sn))]| by A1,Th91;
         set p4= |[ |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)),
          |.p.|* ((p`2/|.p.|-sn)/(1+sn))]|;
        A116: p4`1= |.p.|*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2)) &
          p4`2= |.p.|* ((p`2/|.p.|-sn)/(1+sn)) by EUCLID:56;
        A117: q4`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))&
        q4`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by EUCLID:56;
            (q`2/|.q.|-sn)<=0 by A89,REAL_2:106;
        then A118: -(q`2/|.q.|-sn)>= -0 by XREAL_1:26;
        A119: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
            0<=(q`1)^2 by XREAL_1:65;
        then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A93,A119,REAL_1:73;
        then (q`2)^2/(|.q.|)^2 <= 1 by A93,XCMPLX_1:60;
        then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then -1<=q`2/|.q.| by Lm2;
        then A120: -1-sn<=q`2/|.q.|-sn by XREAL_1:11;
        A121: 1+sn>0 by A1,XREAL_1:150;
        then -(1+sn)<= -0 by XREAL_1:26;
        then (-(1+sn))/(1+sn)<=(-( q`2/|.q.|-sn))/(1+sn) by A118,A121,REAL_1:73
;
        then A122: -1<=(-( q`2/|.q.|-sn))/(1+sn) by A121,XCMPLX_1:198;
         -(-1-sn)>= -(q`2/|.q.|-sn) by A120,XREAL_1:26;
       then (-(q`2/|.q.|-sn))/(1+sn)<=1 by A121,REAL_2:117;
       then ((-(q`2/|.q.|-sn))/(1+sn))^2<=1^2 by A122,SQUARE_1:119;
       then 1-((-(q`2/|.q.|-sn))/(1+sn))^2>=0 by XREAL_1:50;
       then 1-(-((q`2/|.q.|-sn))/(1+sn))^2>=0 by XCMPLX_1:188;
       then A123: 1-((q`2/|.q.|-sn)/(1+sn))^2>=0;
        A124: (q4`1)^2= (|.q.|)^2*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))^2
                         by A117
         .= (|.q.|)^2*(1-((q`2/|.q.|-sn)/(1+sn))^2) by A123,SQUARE_1:def 4;
        A125: (q4`2)^2= (|.q.|)^2*((q`2/|.q.|-sn)/(1+sn))^2
                         by A117;
            (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
        .=(|.q.|)^2 by A124,A125;
        then A126: sqrt((|.q4.|)^2)=|.q.| by SQUARE_1:89;
        then A127: |.q4.|=|.q.| by SQUARE_1:89;
        A128: |.p.|<>0 by A114,TOPRNS_1:25;
        then A129: (|.p.|)^2>0 by SQUARE_1:74;
            (p`2/|.p.|-sn)<=0 by A114,REAL_2:106;
        then A130: -(p`2/|.p.|-sn)>= -0 by XREAL_1:26;
        A131: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
            0<=(p`1)^2 by XREAL_1:65;
        then 0+(p`2)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
        then (p`2)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by A129,A131,REAL_1:73;
        then (p`2)^2/(|.p.|)^2 <= 1 by A129,XCMPLX_1:60;
        then ((p`2)/|.p.|)^2 <= 1 by XCMPLX_1:77;
        then -1<=p`2/|.p.| by Lm2;
        then A132: -1-sn<=p`2/|.p.|-sn by XREAL_1:11;
            -(1+sn)<= -0 by A121,XREAL_1:26;
        then (-(1+sn))/(1+sn)<=(-( p`2/|.p.|-sn))/(1+sn) by A121,A130,REAL_1:73
;
        then A133: -1<=(-( p`2/|.p.|-sn))/(1+sn) by A121,XCMPLX_1:198;
         -(-1-sn)>= -(p`2/|.p.|-sn) by A132,XREAL_1:26;
       then (-(p`2/|.p.|-sn))/(1+sn)<=1 by A121,REAL_2:117;
       then ((-(p`2/|.p.|-sn))/(1+sn))^2<=1^2 by A133,SQUARE_1:119;
       then 1-((-(p`2/|.p.|-sn))/(1+sn))^2>=0 by XREAL_1:50;
       then 1-(-((p`2/|.p.|-sn))/(1+sn))^2>=0 by XCMPLX_1:188;
       then A134: 1-((p`2/|.p.|-sn)/(1+sn))^2>=0;
        A135: (p4`1)^2= (|.p.|)^2*(sqrt(1-((p`2/|.p.|-sn)/(1+sn))^2))^2
                         by A116
         .= (|.p.|)^2*(1-((p`2/|.p.|-sn)/(1+sn))^2)
                      by A134,SQUARE_1:def 4;
        A136: (p4`2)^2= (|.p.|)^2*((p`2/|.p.|-sn)/(1+sn))^2
                         by A116;
            (|.p4.|)^2=(p4`1)^2+(p4`2)^2 by JGRAPH_3:10
        .=(|.p.|)^2 by A135,A136;
        then A137: sqrt((|.p4.|)^2)=|.p.| by SQUARE_1:89;
        then A138: |.p4.|=|.p.| by SQUARE_1:89;
          ((p`2/|.p.|-sn)/(1+sn))
        =|.q.|* ((q`2/|.q.|-sn)/(1+sn))/|.p.| by A2,A90,A91,A115,A116,A128,
XCMPLX_1:90;
        then (p`2/|.p.|-sn)/(1+sn)=(q`2/|.q.|-sn)/(1+sn)
                              by A2,A90,A115,A126,A128,A137,XCMPLX_1:90
;
        then (p`2/|.p.|-sn)/(1+sn)*(1+sn)=q`2/|.q.|-sn by A121,XCMPLX_1:88;
        then p`2/|.p.|-sn=q`2/|.q.|-sn by A121,XCMPLX_1:88;
        then p`2/|.p.|-sn+sn=q`2/|.q.|;
        then p`2/|.p.|=q`2/|.q.|;
        then p`2/|.p.|*|.p.|=q`2 by A2,A90,A115,A127,A128,A138,XCMPLX_1:88;
        then A139: p`2=q`2 by A128,XCMPLX_1:88;
        A140: |.p.|^2=(p`1)^2+(p`2)^2 by JGRAPH_3:10;
            |.q.|^2=(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        then (p`1)^2+(p`2)^2-(p`2)^2=(q`1)^2 by A2,A90,A115,A127,A138,A139,A140
;
        then (p`1)^2=(q`1)^2;
        then p`1=sqrt((q`1)^2) by A114,SQUARE_1:89;
        then A141: p`1=q`1 by A89,SQUARE_1:89;
            p=|[p`1,p`2]| by EUCLID:57;
       hence x1=x2 by A139,A141,EUCLID:57;
      end;
      end;
     hence x1=x2;
    end;
    end;
   hence x1=x2;
  end;
 hence thesis by FUNCT_1:def 8;
end;

theorem Th110: for sn being Real
  st -1<sn & sn<1 holds
  (sn-FanMorphE) is Function of TOP-REAL 2,TOP-REAL 2 &
 rng (sn-FanMorphE) = the carrier of TOP-REAL 2
proof let sn be Real;
  assume A1:  -1<sn & sn<1;
  thus (sn-FanMorphE) is Function of TOP-REAL 2,TOP-REAL 2;
   for f being Function of TOP-REAL 2,TOP-REAL 2 st f=(sn-FanMorphE) holds
    rng (sn-FanMorphE)=the carrier of TOP-REAL 2
  proof let f be Function of TOP-REAL 2,TOP-REAL 2;
    assume A2:f=(sn-FanMorphE);
A3:dom f=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
    the carrier of TOP-REAL 2 c= rng f
    proof let y be set;assume y in the carrier of TOP-REAL 2;
     then reconsider p2=y as Point of TOP-REAL 2;
     set q=p2;
     now per cases by JGRAPH_2:11;
     suppose q`1<=0;
      then q in dom (sn-FanMorphE) & y=(sn-FanMorphE).q by A2,A3,Th89;
      hence ex x being set st x in dom (sn-FanMorphE) & y=(sn-FanMorphE).x;
     end;
     suppose A4: q`2/|.q.|>=0 & q`1>=0 & q<>0.REAL 2;
       set px=|[ (|.q.|)*sqrt(1-(q`2/|.q.|*(1-sn)+sn)^2),
          |.q.|*(q`2/|.q.|*(1-sn)+sn)]|;
        A5: px`1 = (|.q.|)*sqrt(1-(q`2/|.q.|*(1-sn)+sn)^2) &
         px`2 = |.q.|*(q`2/|.q.|*(1-sn)+sn) by EUCLID:56;
        then A6: |.px.|^2=((|.q.|)*sqrt(1-(q`2/|.q.|*(1-sn)+sn)^2))^2
        +(|.q.|*(q`2/|.q.|*(1-sn)+sn))^2 by JGRAPH_3:10
        .=(|.q.|)^2*(sqrt(1-(q`2/|.q.|*(1-sn)+sn)^2))^2
        +(|.q.|)^2*((q`2/|.q.|*(1-sn)+sn))^2;
   A7: |.q.|<>0 by A4,TOPRNS_1:25;
       1-sn>=0 by A1,XREAL_1:151;
       then A8: q`2/|.q.|*(1-sn)>=0 by A4,REAL_2:121;
       then A9: (q`2/|.q.|*(1-sn)+sn)>=0+sn by XREAL_1:9;
       A10: |.q.|^2>0 by A7,SQUARE_1:74;
       --(1+sn)>0 by A1,XREAL_1:150; then
       -(-1-sn)>0;
       then -1-sn<= q`2/|.q.|*(1-sn) by A8,XREAL_1:60;
       then A11: -1-sn+sn<= q`2/|.q.|*(1-sn)+sn by XREAL_1:9;
       A12: 1-sn>0 by A1,XREAL_1:151;
       A13: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
       0<=(q`1)^2 by XREAL_1:65;
       then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
       then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A10,A13,REAL_1:73;
       then (q`2)^2/(|.q.|)^2 <= 1 by A10,XCMPLX_1:60;
       then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
       then q`2/|.q.|<=1 by Lm2;
       then q`2/|.q.|*(1-sn) <= 1 *(1-sn) by A12,XREAL_1:66;
       then q`2/|.q.|*(1-sn)+sn-sn <=1-sn;
       then (q`2/|.q.|*(1-sn)+sn) <=1 by XREAL_1:11;
       then 1^2>=(q`2/|.q.|*(1-sn)+sn)^2 by A11,SQUARE_1:119;
       then A14: 1-(q`2/|.q.|*(1-sn)+sn)^2>=0 by XREAL_1:50;
       then A15: |.px.|^2=(|.q.|)^2*(1-(q`2/|.q.|*(1-sn)+sn)^2)
        +(|.q.|)^2*((q`2/|.q.|*(1-sn)+sn))^2 by A6,SQUARE_1:def 4
        .= (|.q.|)^2;
        A16: |.px.|=sqrt(|.q.|^2) by A15,SQUARE_1:89
        .=|.q.| by SQUARE_1:89;
        then A17: |.px.|<>0 by A4,TOPRNS_1:25;
        sqrt(1-(q`2/|.q.|*(1-sn)+sn)^2)>=0 by A14,SQUARE_1:def 4;
        then px`2/|.px.| >=sn & px`1>=0 & px<>0.REAL 2
          by A5,A7,A9,A16,REAL_2:121,TOPRNS_1:24,XCMPLX_1:90;
    then A18: (sn-FanMorphE).px
       =|[ |.px.|*(sqrt(1-((px`2/|.px.|-sn)/(1-sn))^2)),
               |.px.|* ((px`2/|.px.|-sn)/(1-sn))]| by A1,Th91;
        A19: |.px.|* ((px`2/|.px.|-sn)/(1-sn))
        =|.q.|* (( ((q`2/|.q.|*(1-sn)+sn))-sn)/(1-sn)) by A5,A7,A16,XCMPLX_1:90
        .=|.q.|* ( q`2/|.q.|) by A12,XCMPLX_1:90
        .= q`2 by A7,XCMPLX_1:88;
        then A20: |.px.|*(sqrt(1-((px`2/|.px.|-sn)/(1-sn))^2))
           = |.px.|*(sqrt(1-(q`2/|.px.|)^2)) by A17,XCMPLX_1:90
           .= |.px.|*(sqrt(1-(q`2)^2/(|.px.|)^2)) by XCMPLX_1:77
           .= |.px.|*(sqrt( (|.px.|)^2/(|.px.|)^2-(q`2)^2/(|.px.|)^2))
                            by A10,A15,XCMPLX_1:60
           .= |.px.|*(sqrt( ((|.px.|)^2-(q`2)^2)/(|.px.|)^2))
                            by XCMPLX_1:121
           .= |.px.|*(sqrt( ((q`1)^2+(q`2)^2-(q`2)^2)/(|.px.|)^2))
                            by A15,JGRAPH_3:10
           .= |.px.|*(sqrt((q`1/|.q.|)^2)) by A16,XCMPLX_1:77;
             q`1/|.q.|>=0 by A4,REAL_2:125;
         then |.px.|*(sqrt((q`1/|.q.|)^2))=|.q.|*(q`1/|.q.|) by A16,SQUARE_1:89
         .=q`1 by A7,XCMPLX_1:88;
        then A21:q=(sn-FanMorphE).px by A18,A19,A20,EUCLID:57;
            dom (sn-FanMorphE)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
      hence ex x being set st x in dom (sn-FanMorphE) & y=(sn-FanMorphE).x
                               by A21;
     end;
     suppose A22: q`2/|.q.|<0 & q`1>=0 & q<>0.REAL 2;
          set px=|[ (|.q.|)*sqrt(1-(q`2/|.q.|*(1+sn)+sn)^2),
                   |.q.|*(q`2/|.q.|*(1+sn)+sn)]|;
        A23: px`1 = (|.q.|)*sqrt(1-(q`2/|.q.|*(1+sn)+sn)^2) &
         px`2 = |.q.|*(q`2/|.q.|*(1+sn)+sn) by EUCLID:56;
        then A24: |.px.|^2=((|.q.|)*sqrt(1-(q`2/|.q.|*(1+sn)+sn)^2))^2
        +(|.q.|*(q`2/|.q.|*(1+sn)+sn))^2 by JGRAPH_3:10
        .=(|.q.|)^2*(sqrt(1-(q`2/|.q.|*(1+sn)+sn)^2))^2
        +(|.q.|)^2*((q`2/|.q.|*(1+sn)+sn))^2;
       A25: |.q.|<>0 by A22,TOPRNS_1:25;
           1+sn>=0 by A1,XREAL_1:150;
       then A26: q`2/|.q.|*(1+sn)<=0 by A22,XREAL_1:133;
       then A27: (q`2/|.q.|*(1+sn)+sn)<=0+sn by XREAL_1:9;
       A28: |.q.|^2>0 by A25,SQUARE_1:74;
       (1-sn)>0 by A1,XREAL_1:151;
       then A29: 1-sn+sn>= q`2/|.q.|*(1+sn)+sn by A26,XREAL_1:9;
       A30: 1+sn>0 by A1,XREAL_1:150;
       A31: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
       0<=(q`1)^2 by XREAL_1:65;
       then 0+(q`2)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
       then (q`2)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A28,A31,REAL_1:73;
       then (q`2)^2/(|.q.|)^2 <= 1 by A28,XCMPLX_1:60;
       then ((q`2)/|.q.|)^2 <= 1 by XCMPLX_1:77;
       then q`2/|.q.|>=-1 by Lm2;
       then q`2/|.q.|*(1+sn) >=(-1)*(1+sn) by A30,XREAL_1:66;
       then q`2/|.q.|*(1+sn)+sn-sn >=-1-sn;
       then (q`2/|.q.|*(1+sn)+sn) >=-1 by XREAL_1:11;
       then 1^2>=(q`2/|.q.|*(1+sn)+sn)^2 by A29,SQUARE_1:119;
       then A32: 1-(q`2/|.q.|*(1+sn)+sn)^2>=0 by XREAL_1:50;
       then A33: |.px.|^2=(|.q.|)^2*(1-(q`2/|.q.|*(1+sn)+sn)^2)
        +(|.q.|)^2*((q`2/|.q.|*(1+sn)+sn))^2 by A24,SQUARE_1:def 4
        .= (|.q.|)^2;
        A34: |.px.|=sqrt(|.q.|^2) by A33,SQUARE_1:89
        .=|.q.| by SQUARE_1:89;
        then A35: |.px.|<>0 by A22,TOPRNS_1:25;
           sqrt(1-(q`2/|.q.|*(1+sn)+sn)^2)>=0 by A32,SQUARE_1:def 4;
        then px`2/|.px.| <=sn & px`1>=0 & px<>0.REAL 2
                           by A23,A25,A27,A34,REAL_2:121,TOPRNS_1:24
,XCMPLX_1:90;
    then A36: (sn-FanMorphE).px
       =|[ |.px.|*(sqrt(1-((px`2/|.px.|-sn)/(1+sn))^2)),
               |.px.|* ((px`2/|.px.|-sn)/(1+sn))]| by A1,Th91;
        A37: |.px.|* ((px`2/|.px.|-sn)/(1+sn))
        =|.q.|* (( ((q`2/|.q.|*(1+sn)+sn))-sn)/(1+sn)) by A23,A25,A34,
XCMPLX_1:90
        .=|.q.|* ( q`2/|.q.|) by A30,XCMPLX_1:90
        .= q`2 by A25,XCMPLX_1:88;
        then A38: |.px.|*(sqrt(1-((px`2/|.px.|-sn)/(1+sn))^2))
           = |.px.|*(sqrt(1-(q`2/|.px.|)^2)) by A35,XCMPLX_1:90
           .= |.px.|*(sqrt(1-(q`2)^2/(|.px.|)^2)) by XCMPLX_1:77
           .= |.px.|*(sqrt( (|.px.|)^2/(|.px.|)^2-(q`2)^2/(|.px.|)^2))
                            by A28,A33,XCMPLX_1:60
           .= |.px.|*(sqrt( ((|.px.|)^2-(q`2)^2)/(|.px.|)^2))
                            by XCMPLX_1:121
           .= |.px.|*(sqrt( ((q`1)^2+(q`2)^2-(q`2)^2)/(|.px.|)^2))
                            by A33,JGRAPH_3:10
           .= |.px.|*(sqrt((q`1/|.q.|)^2)) by A34,XCMPLX_1:77;
             q`1/|.q.|>=0 by A22,REAL_2:125;
         then |.px.|*(sqrt((q`1/|.q.|)^2))
         =|.q.|*(q`1/|.q.|) by A34,SQUARE_1:89
         .=q`1 by A25,XCMPLX_1:88;
        then A39:q=(sn-FanMorphE).px by A36,A37,A38,EUCLID:57;
            dom (sn-FanMorphE)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
      hence ex x being set st x in dom (sn-FanMorphE) & y=(sn-FanMorphE).x
                               by A39;
     end;
     end;
    hence y in rng f by A2,FUNCT_1:def 5;
   end;
   hence rng (sn-FanMorphE)=the carrier of TOP-REAL 2
                 by A2,XBOOLE_0:def 10;
  end;
 hence rng (sn-FanMorphE)=the carrier of TOP-REAL 2;
end;

theorem Th111: for sn being Real,p2 being Point of TOP-REAL 2
  st -1<sn & sn<1
  ex K being non empty compact Subset of TOP-REAL 2 st
  K = (sn-FanMorphE).:K &
 (ex V2 being Subset of TOP-REAL 2 st
  p2 in V2 & V2 is open & V2 c= K & (sn-FanMorphE).p2 in V2)
 proof let sn be Real,p2 be Point of TOP-REAL 2;
  assume A1: -1<sn & sn<1;
    reconsider O=0.REAL 2 as Point of Euclid 2;
    reconsider V0=Ball(O,|.p2.|+1) as Subset of TOP-REAL 2;
    A2: |. p2.|<|.p2.|+1 by XREAL_1:31;
    A3: O in V0 by GOBOARD6:4;
    A4: V0 c= cl_Ball(O,|.p2.|+1) by METRIC_1:15;
    reconsider K01=cl_Ball(O,|.p2.|+1) as Subset of TOP-REAL 2;
    K01 is compact by Th22;
    then reconsider K0=cl_Ball(O,|.p2.|+1)
          as non empty compact Subset of TOP-REAL 2 by A3,A4;
    reconsider u2=p2 as Point of Euclid 2;
    A5: (sn-FanMorphE).:K0 c= K0
     proof let y be set;assume y in (sn-FanMorphE).:K0;
       then consider x being set such that
       A6: x in dom (sn-FanMorphE) & x in K0 & y=(sn-FanMorphE).x
                     by FUNCT_1:def 12;
       reconsider q=x as Point of TOP-REAL 2 by A6;
       reconsider uq=q as Point of Euclid 2;
       A7: y in rng (sn-FanMorphE) by A6,FUNCT_1:def 5;
       then reconsider u=y as Point of Euclid 2;
       reconsider q4=y as Point of TOP-REAL 2 by A7;
       A8: |.q4.|=|.q.| by A6,Th104;
           dist(O,uq)<= |.p2.|+1 by A6,METRIC_1:13;
       then |.0.REAL 2 - q.|<= |.p2.|+1 by JGRAPH_1:45;
       then |.0.REAL 2 +- q.|<= |.p2.|+1 by EUCLID:45;
       then |. -q.|<= |.p2.|+1 by EUCLID:31;
       then |.q.|<= |.p2.|+1 by TOPRNS_1:27;
       then |. -q4.|<= |.p2.|+1 by A8,TOPRNS_1:27;
       then |.0.REAL 2 +- q4.|<= |.p2.|+1 by EUCLID:31;
       then |.0.REAL 2 - q4.|<= |.p2.|+1 by EUCLID:45;
       then dist(O,u)<= |.p2.|+1 by JGRAPH_1:45;
      hence y in K0 by METRIC_1:13;
     end;
     K0 c= (sn-FanMorphE).:K0
     proof let y be set;assume A9: y in K0;
       then reconsider u=y as Point of Euclid 2;
       reconsider q4=y as Point of TOP-REAL 2 by A9;
       the carrier of TOP-REAL 2 c= rng (sn-FanMorphE) by A1,Th110;
       then q4 in rng (sn-FanMorphE) by TARSKI:def 3;
       then consider x being set such that
       A10: x in dom (sn-FanMorphE) & y=(sn-FanMorphE).x by FUNCT_1:def 5;
       reconsider q=x as Point of TOP-REAL 2 by A10;
       reconsider uq=q as Point of Euclid 2;
       A11: |.q4.|=|.q.| by A10,Th104;
       q in K0 by A9,A11,Lm13;
      hence y in (sn-FanMorphE).:K0 by A10,FUNCT_1:def 12;
     end;
    then A12: K0= (sn-FanMorphE).:K0 by A5,XBOOLE_0:def 10;
        |. -p2.|<|.p2.|+1 by A2,TOPRNS_1:27;
    then |.0.REAL 2 +- p2.|<|.p2.|+1 by EUCLID:31;
    then |.0.REAL 2 - p2.|<|.p2.|+1 by EUCLID:45;
    then dist(O,u2)<|.p2.|+1 by JGRAPH_1:45;
    then A13: p2 in V0 by METRIC_1:12;
    A14: V0 is open by TOPMETR:21;
    set q3= (sn-FanMorphE).p2;
    reconsider u3=q3 as Point of Euclid 2;
    |.q3.|=|.p2.| by Th104;
    then |. -q3.|<|.p2.|+1 by A2,TOPRNS_1:27;
    then |.0.REAL 2 +- q3.|<|.p2.|+1 by EUCLID:31;
    then |.0.REAL 2 - q3.|<|.p2.|+1 by EUCLID:45;
    then dist(O,u3)< |.p2.|+1 by JGRAPH_1:45;
    then (sn-FanMorphE).p2 in V0 by METRIC_1:12;
   hence thesis by A4,A12,A13,A14;
 end;

theorem   for sn being Real st -1<sn & sn<1
 ex f being Function of TOP-REAL 2,TOP-REAL 2 st f=(sn-FanMorphE)
   & f is_homeomorphism
proof let sn be Real;assume A1:  -1<sn & sn<1;
  then A2: (sn-FanMorphE) is Function of TOP-REAL 2,TOP-REAL 2 &
  rng (sn-FanMorphE) = the carrier of TOP-REAL 2 by Th110;
  reconsider f=(sn-FanMorphE) as Function of TOP-REAL 2,TOP-REAL 2;
  consider h being Function of (TOP-REAL 2),(TOP-REAL 2)
  such that A3: h=(sn-FanMorphE) & h is continuous by A1,Th108;
  A4: f is one-to-one by A1,Th109;
  A5: rng f=[#](TOP-REAL 2) by A2;
     for p2 being Point of TOP-REAL 2
  ex K being non empty compact Subset of TOP-REAL 2 st K = f.:K &
 (ex V2 being Subset of TOP-REAL 2 st
  p2 in V2 & V2 is open & V2 c= K & f.p2 in V2) by A1,Th111;
  then f is_homeomorphism by A3,A4,A5,Th8;
 hence thesis;
end;

theorem Th113:
 for sn being Real,q being Point of TOP-REAL 2 st -1<sn & sn<1 & q`1>0
 & q`2/|.q.|>=sn holds (for p being Point of TOP-REAL 2 st
 p=(sn-FanMorphE).q holds p`1>0 & p`2>=0)
 proof let sn be Real,q be Point of TOP-REAL 2;
  assume A1: -1<sn & sn<1 & q`1>0 & q`2/|.q.|>=sn;
  A2: |.q.|>=0;
  let p be Point of TOP-REAL 2;
    assume p=(sn-FanMorphE).q;
    then A3: p=|[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by A1,Th89;
      set qz=p;
      A4: |.q.|<>0 by A1,JGRAPH_2:11,TOPRNS_1:25;
      then A5: (|.q.|)^2>0 by SQUARE_1:74;
     A6: 1-sn>0 by A1,XREAL_1:151;
        A7: qz`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))&
        qz`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by A3,EUCLID:56;
        A8: (q`2/|.q.|-sn)>= 0 by A1,XREAL_1:50;
        A9: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
            0<(q`1)^2 by A1,SQUARE_1:74;
        then 0+(q`2)^2<(q`1)^2+(q`2)^2 by XREAL_1:10;
        then (q`2)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A5,A9,REAL_1:73;
        then (q`2)^2/(|.q.|)^2 < 1 by A5,XCMPLX_1:60;
        then ((q`2)/|.q.|)^2 < 1 by XCMPLX_1:77;
        then 1>q`2/|.q.| by Lm3;
        then A10: 1-sn>q`2/|.q.|-sn by XREAL_1:11;
        A11: -(1-sn)< -0 by A6,XREAL_1:26;
             -(1-sn)< -( q`2/|.q.|-sn) by A10,XREAL_1:26;
         then (-(1-sn))/(1-sn)<(-( q`2/|.q.|-sn))/(1-sn)
                        by A6,REAL_1:73;
        then A12: -1<(-( q`2/|.q.|-sn))/(1-sn) by A6,XCMPLX_1:198;
           --(1-sn)> -(q`2/|.q.|-sn) by A8,A11,XREAL_1:26;
       then (-(q`2/|.q.|-sn))/(1-sn)<1 by A6,REAL_2:118;
       then ((-(q`2/|.q.|-sn))/(1-sn))^2<1^2 by A12,SQUARE_1:120;
       then 1-((-(q`2/|.q.|-sn))/(1-sn))^2>0 by XREAL_1:52;
       then sqrt(1-((-(q`2/|.q.|-sn))/(1-sn))^2)>0 by SQUARE_1:93;
       then sqrt(1-(-(q`2/|.q.|-sn))^2/(1-sn)^2)> 0 by XCMPLX_1:77;
       then sqrt(1-(q`2/|.q.|-sn)^2/(1-sn)^2)> 0;
       then A13: sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)> 0 by XCMPLX_1:77;
           ((q`2/|.q.|-sn)/(1-sn))>=0 by A6,A8,XREAL_1:138;
   hence p`1>0 & p`2>=0 by A2,A4,A7,A13,XREAL_1:129,131;
 end;

theorem Th114:
 for sn being Real,q being Point of TOP-REAL 2 st -1<sn & sn<1 & q`1>0
 & q`2/|.q.|<sn holds (for p being Point of TOP-REAL 2 st
 p=(sn-FanMorphE).q holds p`1>0 & p`2<0)
 proof let sn be Real,q be Point of TOP-REAL 2;
  assume A1: -1<sn & sn<1 & q`1>0
   & q`2/|.q.|<sn;
  A2: |.q.|>=0;
  let p be Point of TOP-REAL 2;
    assume p=(sn-FanMorphE).q;
    then A3: p=|[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)),
          |.q.|* ((q`2/|.q.|-sn)/(1+sn))]| by A1,Th90;
      set qz=p;
          A4: |.q.|<>0 by A1,JGRAPH_2:11,TOPRNS_1:25;
      then A5: (|.q.|)^2>0 by SQUARE_1:74;
      A6: (q`2/|.q.|-sn)< 0 by A1,REAL_2:105;
     A7: 1+sn>0 by A1,XREAL_1:150;
        A8: qz`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2))&
        qz`2= |.q.|* ((q`2/|.q.|-sn)/(1+sn)) by A3,EUCLID:56;
        A9: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
            0<(q`1)^2 by A1,SQUARE_1:74;
        then 0+(q`2)^2<(q`1)^2+(q`2)^2 by XREAL_1:10;
        then (q`2)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A5,A9,REAL_1:73;
        then (q`2)^2/(|.q.|)^2 < 1 by A5,XCMPLX_1:60;
        then ((q`2)/|.q.|)^2 < 1 by XCMPLX_1:77;
        then -1<q`2/|.q.| by Lm3;
        then -1-sn<q`2/|.q.|-sn by XREAL_1:11;
        then -(1+sn) < (q`2/|.q.|-sn);
        then A10: --(1+sn)> -(q`2/|.q.|-sn) by XREAL_1:26;
        A11: -( q`2/|.q.|-sn)>0 by A6,XREAL_1:60;
            -(1+sn)< -0 by A7,XREAL_1:26;
         then (-(1+sn))/(1+sn)<(-( q`2/|.q.|-sn))/(1+sn) by A11,A7,REAL_1:73;
        then A12: -1<(-( q`2/|.q.|-sn))/(1+sn) by A7,XCMPLX_1:198;
           (-(q`2/|.q.|-sn))/(1+sn)<1 by A7,A10,REAL_2:118;
       then ((-(q`2/|.q.|-sn))/(1+sn))^2<1^2 by A12,SQUARE_1:120;
       then 1-((-(q`2/|.q.|-sn))/(1+sn))^2>0 by XREAL_1:52;
       then sqrt(1-((-(q`2/|.q.|-sn))/(1+sn))^2)>0 by SQUARE_1:93;
       then sqrt(1-(-(q`2/|.q.|-sn))^2/(1+sn)^2)> 0 by XCMPLX_1:77;
       then sqrt(1-(q`2/|.q.|-sn)^2/(1+sn)^2)> 0;
       then A13: sqrt(1-((q`2/|.q.|-sn)/(1+sn))^2)> 0 by XCMPLX_1:77;
           ((q`2/|.q.|-sn)/(1+sn))<0 by A6,A7,REAL_2:128;
   hence p`1>0 & p`2<0 by A2,A4,A8,A13,XREAL_1:131,134;
 end;

theorem Th115:
 for sn being Real,q1,q2 being Point of TOP-REAL 2 st -1<sn & sn<1 & q1`1>0
 & q1`2/|.q1.|>=sn & q2`1>0 & q2`2/|.q2.|>=sn & q1`2/|.q1.|<q2`2/|.q2.|
 holds (for p1,p2 being Point of TOP-REAL 2 st
 p1=(sn-FanMorphE).q1 & p2=(sn-FanMorphE).q2 holds p1`2/|.p1.|<p2`2/|.p2.|)
 proof let sn be Real,q1,q2 be Point of TOP-REAL 2;
  assume A1: -1<sn & sn<1 & q1`1>0
   & q1`2/|.q1.|>=sn & q2`1>0 & q2`2/|.q2.|>=sn & q1`2/|.q1.|<q2`2/|.q2.|;
  let p1,p2 be Point of TOP-REAL 2;
   assume A2: p1=(sn-FanMorphE).q1 & p2=(sn-FanMorphE).q2;
    then p1=|[ |.q1.|*(sqrt(1-((q1`2/|.q1.|-sn)/(1-sn))^2)),
          |.q1.|* ((q1`2/|.q1.|-sn)/(1-sn))]| by A1,Th89;
    then A3: p1`1= |.q1.|*(sqrt(1-((q1`2/|.q1.|-sn)/(1-sn))^2))&
        p1`2= |.q1.|* ((q1`2/|.q1.|-sn)/(1-sn)) by EUCLID:56;
        p2=|[ |.q2.|*(sqrt(1-((q2`2/|.q2.|-sn)/(1-sn))^2)),
          |.q2.|* ((q2`2/|.q2.|-sn)/(1-sn))]| by A1,A2,Th89;
    then A4: p2`1= |.q2.|*(sqrt(1-((q2`2/|.q2.|-sn)/(1-sn))^2))&
        p2`2= |.q2.|* ((q2`2/|.q2.|-sn)/(1-sn)) by EUCLID:56;
    A5: |.q1.|>0 & |.q2.|>0 by A1,Lm1,JGRAPH_2:11;
    A6: |.p1.|=|.q1.| & |.p2.|=|.q2.| by A2,Th104;
    then A7: p1`2/|.p1.|= ((q1`2/|.q1.|-sn)/(1-sn)) by A3,A5,XCMPLX_1:90;
    A8: p2`2/|.p2.|= ((q2`2/|.q2.|-sn)/(1-sn)) by A4,A5,A6,XCMPLX_1:90;
    A9: q1`2/|.q1.|-sn< q2`2/|.q2.|-sn by A1,XREAL_1:11;
        1-sn>0 by A1,XREAL_1:151;
   hence thesis by A7,A8,A9,REAL_1:73;
 end;

theorem Th116:
 for sn being Real,q1,q2 being Point of TOP-REAL 2 st -1<sn & sn<1 & q1`1>0
 & q1`2/|.q1.|<sn & q2`1>0 & q2`2/|.q2.|<sn & q1`2/|.q1.|<q2`2/|.q2.|
 holds (for p1,p2 being Point of TOP-REAL 2 st
 p1=(sn-FanMorphE).q1 & p2=(sn-FanMorphE).q2 holds p1`2/|.p1.|<p2`2/|.p2.|)
 proof let sn be Real,q1,q2 be Point of TOP-REAL 2;
  assume A1: -1<sn & sn<1 & q1`1>0
   & q1`2/|.q1.|<sn & q2`1>0 & q2`2/|.q2.|<sn & q1`2/|.q1.|<q2`2/|.q2.|;
  let p1,p2 be Point of TOP-REAL 2;
   assume A2: p1=(sn-FanMorphE).q1 & p2=(sn-FanMorphE).q2;
    then p1=|[ |.q1.|*(sqrt(1-((q1`2/|.q1.|-sn)/(1+sn))^2)),
          |.q1.|* ((q1`2/|.q1.|-sn)/(1+sn))]| by A1,Th90;
    then A3: p1`1= |.q1.|*(sqrt(1-((q1`2/|.q1.|-sn)/(1+sn))^2))&
        p1`2= |.q1.|* ((q1`2/|.q1.|-sn)/(1+sn)) by EUCLID:56;
        p2=|[ |.q2.|*(sqrt(1-((q2`2/|.q2.|-sn)/(1+sn))^2)),
          |.q2.|* ((q2`2/|.q2.|-sn)/(1+sn))]| by A1,A2,Th90;
    then A4: p2`1= |.q2.|*(sqrt(1-((q2`2/|.q2.|-sn)/(1+sn))^2))&
        p2`2= |.q2.|* ((q2`2/|.q2.|-sn)/(1+sn)) by EUCLID:56;
    A5: |.q1.|>0 & |.q2.|>0 by A1,Lm1,JGRAPH_2:11;
    A6: |.p1.|=|.q1.| & |.p2.|=|.q2.| by A2,Th104;
    then A7: p1`2/|.p1.|= (q1`2/|.q1.|-sn)/(1+sn) by A3,A5,XCMPLX_1:90;
    A8: p2`2/|.p2.|= (q2`2/|.q2.|-sn)/(1+sn) by A4,A5,A6,XCMPLX_1:90;
    A9: q1`2/|.q1.|-sn< q2`2/|.q2.|-sn by A1,XREAL_1:11;
   1+sn>0 by A1,XREAL_1:150;
   hence p1`2/|.p1.|<p2`2/|.p2.| by A7,A8,A9,REAL_1:73;
 end;

theorem
  for sn being Real,q1,q2 being Point of TOP-REAL 2 st -1<sn & sn<1 & q1`1>0
 & q2`1>0 & q1`2/|.q1.|<q2`2/|.q2.|
 holds (for p1,p2 being Point of TOP-REAL 2 st
 p1=(sn-FanMorphE).q1 & p2=(sn-FanMorphE).q2 holds p1`2/|.p1.|<p2`2/|.p2.|)
 proof let sn be Real,q1,q2 be Point of TOP-REAL 2;
  assume A1: -1<sn & sn<1 & q1`1>0 & q2`1>0 & q1`2/|.q1.|<q2`2/|.q2.|;
  let p1,p2 be Point of TOP-REAL 2;
   assume A2: p1=(sn-FanMorphE).q1 & p2=(sn-FanMorphE).q2;
    per cases;
    suppose q1`2/|.q1.|>=sn & q2`2/|.q2.|>=sn;
     hence p1`2/|.p1.|<p2`2/|.p2.| by A1,A2,Th115;
    end;
    suppose q1`2/|.q1.|>=sn & q2`2/|.q2.|<sn;
     hence p1`2/|.p1.|<p2`2/|.p2.| by A1,XXREAL_0:2;
    end;
    suppose A3: q1`2/|.q1.|<sn & q2`2/|.q2.|>=sn;
     then A4: p1`1>0 & p1`2<0 by A1,A2,Th114;
     then A5: |.p1.|>0 by Lm1,JGRAPH_2:11;
A6:  p2`1>0 & p2`2>=0 by A1,A2,A3,Th113;
     p2`2/|.p2.|>=0 by A6,REAL_2:125;
     hence p1`2/|.p1.|<p2`2/|.p2.| by A4,A5,REAL_2:128;
    end;
    suppose q1`2/|.q1.|<sn & q2`2/|.q2.|<sn;
     hence p1`2/|.p1.|<p2`2/|.p2.| by A1,A2,Th116;
    end;
 end;

theorem
  for sn being Real,q being Point of TOP-REAL 2 st -1<sn & sn<1 & q`1>0
 & q`2/|.q.|=sn holds (for p being Point of TOP-REAL 2 st
 p=(sn-FanMorphE).q holds p`1>0 & p`2=0)
 proof let sn be Real,q be Point of TOP-REAL 2;
  assume A1: -1<sn & sn<1 & q`1>0 & q`2/|.q.|=sn;
A2: |.q.|>=0;
  let p be Point of TOP-REAL 2;
   assume p=(sn-FanMorphE).q;
    then A3: p=|[ |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)),
    |.q.|* ((q`2/|.q.|-sn)/(1-sn))]| by A1,Th89;
A4: |.q.|<>0 by A1,JGRAPH_2:11,TOPRNS_1:25;
A5: p`1= |.q.|*(sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2))&
    p`2= |.q.|* ((q`2/|.q.|-sn)/(1-sn)) by A3,EUCLID:56;
    ((-(q`2/|.q.|-sn))/(1-sn))^2<1^2 by A1;
    then 1-((-(q`2/|.q.|-sn))/(1-sn))^2>0 by XREAL_1:52;
    then sqrt(1-((-(q`2/|.q.|-sn))/(1-sn))^2)>0 by SQUARE_1:93;
    then sqrt(1-(-(q`2/|.q.|-sn))^2/(1-sn)^2)> 0 by XCMPLX_1:77;
    then sqrt(1-(q`2/|.q.|-sn)^2/(1-sn)^2)> 0;
    then sqrt(1-((q`2/|.q.|-sn)/(1-sn))^2)> 0 by XCMPLX_1:77;
   hence thesis by A1,A2,A4,A5,XREAL_1:131;
 end;

theorem
  for sn being real number holds 0.REAL 2=(sn-FanMorphE).(0.REAL 2)
   by Th89,JGRAPH_2:11;

begin :: Fan Morphism for South

definition let s be real number, q be Point of TOP-REAL 2;
  func FanS(s,q) -> Point of TOP-REAL 2 equals
  :Def8: |.q.|*|[(q`1/|.q.|-s)/(1-s),
     -sqrt(1-((q`1/|.q.|-s)/(1-s))^2)]| if q`1/|.q.|>=s & q`2<0,
       |.q.|*|[(q`1/|.q.|-s)/(1+s),
     -sqrt(1-((q`1/|.q.|-s)/(1+s))^2)]| if q`1/|.q.|<s & q`2<0
   otherwise q;
 correctness;
end;

definition let c be real number;
  func c-FanMorphS -> Function of TOP-REAL 2, TOP-REAL 2 means
  :Def9: for q being Point of TOP-REAL 2 holds
       it.q=FanS(c,q);
 existence
  proof
    deffunc F(Point of TOP-REAL 2)=FanS(c,$1);
    thus ex IT being Function of TOP-REAL 2, TOP-REAL 2 st
    for q being Point of TOP-REAL 2 holds IT.q=F(q)from FUNCT_2:sch 4;
  end;
 uniqueness
  proof
    deffunc F(Point of TOP-REAL 2)=FanS(c,$1);
    thus for a,b being Function of TOP-REAL 2, TOP-REAL 2 st
  (for q being Point of TOP-REAL 2 holds a.q=F(q)) &
  (for q being Point of TOP-REAL 2 holds b.q=F(q)) holds
  a=b from BINOP_2:sch 1;
  end;
end;

theorem Th120: for cn being real number holds
  (q`1/|.q.|>=cn & q`2<0 implies
    cn-FanMorphS.q= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
    |.q.|*(-sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]|)&
  (q`2>=0 implies cn-FanMorphS.q=q)
proof let cn be real number;
  A1: cn-FanMorphS.q=FanS(cn,q) by Def9;
   hereby assume q`1/|.q.|>=cn & q`2<0;
    then FanS(cn,q)= |.q.|*|[(q`1/|.q.|-cn)/(1-cn),
         -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)]| by Def8
          .= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
          |.q.|*(-sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by EUCLID:62;
     hence cn-FanMorphS.q= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
    |.q.|*(-sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by Def9;
   end;
   assume q`2>=0; hence thesis by A1,Def8;
end;

theorem Th121: for cn being Real holds
  (q`1/|.q.|<=cn & q`2<0 implies
    cn-FanMorphS.q= |[ |.q.|*((q`1/|.q.|-cn)/(1+cn)),
       |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]|)
proof let cn be Real;
   assume A1: q`1/|.q.|<=cn & q`2<0;
   per cases by A1,REAL_1:def 5;
   suppose q`1/|.q.|<cn;
    then FanS(cn,q)= |.q.|*|[(q`1/|.q.|-cn)/(1+cn),
        -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)]| by A1,Def8
          .= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
           |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]| by EUCLID:62;
    hence thesis by Def9;
   end;
   suppose A2: q`1/|.q.|=cn;
     (q`1/|.q.|-cn)/(1-cn)=0 by A2;
    hence thesis by A1,A2,Th120;
   end;
end;

theorem Th122: for cn being Real st -1<cn & cn<1 holds
  (q`1/|.q.|>=cn & q`2<=0 & q<>0.REAL 2 implies
    cn-FanMorphS.q = |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
        |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]|) &
  (q`1/|.q.|<=cn & q`2<=0 & q<>0.REAL 2 implies
    cn-FanMorphS.q = |[ |.q.|*((q`1/|.q.|-cn)/(1+cn)),
        |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]|)
proof let cn be Real;
 assume A1: -1<cn & cn<1;
   per cases;
   suppose A2: q`1/|.q.|>=cn & q`2<=0 & q<>0.REAL 2;
    per cases;
    suppose A3: q`2<0;
      then FanS(cn,q)= |.q.|*|[(q`1/|.q.|-cn)/(1-cn),
      -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)]| by A2,Def8
      .= |[|.q.|* ((q`1/|.q.|-cn)/(1-cn)),
      |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by EUCLID:62;
     hence thesis by A3,Def9,Th121;
    end;
    suppose A4: q`2>=0;
     then A5: cn-FanMorphS.q=q by Th120;
A6:  (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
A7:  |.q.|<>0 by A2,TOPRNS_1:25;
     then A8: |.q.|^2>0 by SQUARE_1:74;
A9:  q`2=0 by A2,A4;
A10: |.q.|>=0;
     A11: sqrt((|.q.|)^2)=|.q.| by SQUARE_1:89;
A12: 1-cn>0 by A1,XREAL_1:151;
     (q`1)^2/|.q.|^2=1^2 by A6,A8,A9,XCMPLX_1:60;
     then ((q`1)/|.q.|)^2=1^2 by XCMPLX_1:77;
     then A13: sqrt(((q`1)/|.q.|)^2)=1 by SQUARE_1:89;
     now assume q`1<0;
       then q`1/|.q.|<0 by A7,A10,REAL_2:128;
       then -((q`1)/|.q.|)=1 by A13,SQUARE_1:90;
       hence contradiction by A1,A2;
     end;
     then A14: |.q.|=q`1 by A6,A9,A11,SQUARE_1:89;
     then 1=q`1/|.q.| by A7,XCMPLX_1:60;
     then A15: (q`1/|.q.|-cn)/(1-cn)=1 by A12,XCMPLX_1:60;
     cn-FanMorphS.q = |[ |.q.|*((q`1/|.q.|-cn)/(1-cn)),
          |.q.|*(-sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)) ]| by  A5,A9,A14,A15,
EUCLID:57, SQUARE_1:82; then
     cn-FanMorphS.q = |[ |.q.|*((q`1/|.q.|-cn)/(1-cn)),
        |.q.|*(-sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]|;
     hence thesis by A1,A7,A14,XCMPLX_1:60;
    end;
   end;
   suppose A16: q`1/|.q.|<=cn & q`2<=0 & q<>0.REAL 2;
   per cases;
    suppose q`2<0;
     hence thesis by Th120,Th121;
    end;
    suppose A17: q`2>=0;
     A18: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
     A19: |.q.|<>0 by A16,TOPRNS_1:25;
     A20: q`2=0 by A16,A17;
     A21: |.q.|>=0;
     A22: 1+cn>0 by A1,XREAL_1:150;
     1>q`1/|.q.| by A1,A16,XXREAL_0:2;
     then 1 *(|.q.|)>q`1/|.q.|*(|.q.|) by A19,A21,XREAL_1:70;
     then A23: (|.q.|)>q`1 by A19,XCMPLX_1:88;
     then A24: |.q.|=-q`1 by A18,A20,SQUARE_1:109;
     A25: q`1= -(|.q.|) by A18,A20,A23,SQUARE_1:109;
     then -1=q`1/|.q.| by A19,XCMPLX_1:198;
     then (q`1/|.q.|-cn)/(1+cn)
     =(-(1+cn))/(1+cn) .=-1 by A22,XCMPLX_1:198;
     then |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
     |.q.|*(-sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]|
      =q by A20,A24,EUCLID:57,SQUARE_1:82;
     hence thesis by A1,A17,A19,A25,Th120,XCMPLX_1:198;
    end;
   end;
   suppose q`2>0 or q=0.REAL 2;
    hence thesis;
   end;
end;

theorem Th123:
 for cn being Real,K1 being non empty Subset of TOP-REAL 2,
f being Function of (TOP-REAL 2)|K1,R^1 st -1<cn & cn<1 &
(for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|* ((p`1/|.p.|-cn)/(1-cn)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`2<=0 & q<>0.REAL 2) holds
f is continuous
proof
 let cn be Real,K1 be non empty Subset of TOP-REAL 2,
f be Function of (TOP-REAL 2)|K1,R^1;
 assume A1: -1<cn & cn<1 &
(for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|* ((p`1/|.p.|-cn)/(1-cn)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`2<=0 & q<>0.REAL 2);
  set a=cn, b=(1-cn);
  A2: b>0 by A1,XREAL_1:151;
  reconsider g2=proj1|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm4;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1
                          by Lm7;
  for q being Point of TOP-REAL 2 st q in
    the carrier of (TOP-REAL 2)|K1 holds q<>0.REAL 2 by A1;
  then for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm8;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
  A3: (for q being Point of
  (TOP-REAL 2)|K1,r1,r2 being Real st g2.q=r1 & g1.q=r2
  holds g3.q=r2*((r1/r2-a)/b)) & g3 is continuous by A2,Th10;
  A4:dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then A5:dom f=dom g3 by FUNCT_2:def 1;
  for x being set st x in dom f holds f.x=g3.x
   proof let x be set;assume
     A6: x in dom f;
     then x in K1 by A4,A5,PRE_TOPC:29;
     then reconsider r=x as Point of (TOP-REAL 2);
     reconsider s=x as Point of (TOP-REAL 2)|K1 by A6;
     A7:f.r=(|.r.|)* ((r`1/|.r.|-cn)/(1-cn)) by A1,A6;
     A8:g2.s=proj1.s by Lm4;
     A9:g1.s=(2 NormF).s by Lm7;
     A10:proj1.r=r`1 by PSCOMP_1:def 28;
    (2 NormF).r=|.r.| by Def1;
    hence f.x=g3.x by A3,A7,A8,A9,A10;
   end;
  hence f is continuous by A3,A5,FUNCT_1:9;
end;

theorem Th124:
 for cn being Real,K1 being non empty Subset of TOP-REAL 2,
     f being Function of (TOP-REAL 2)|K1,R^1 st -1<cn & cn<1 &
(for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|* ((p`1/|.p.|-cn)/(1+cn)))
  & (for q being Point of TOP-REAL 2 st
  q in the carrier of (TOP-REAL 2)|K1 holds q`2<=0 & q<>0.REAL 2) holds
   f is continuous
proof
 let cn be Real,K1 be non empty Subset of TOP-REAL 2,
     f be Function of (TOP-REAL 2)|K1,R^1;
 assume A1: -1<cn & cn<1 &
 (for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|* ((p`1/|.p.|-cn)/(1+cn)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`2<=0 & q<>0.REAL 2);
  set a=cn, b=1+cn;
  A2: 1+cn>0 by A1,XREAL_1:150;
  reconsider g2=proj1|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm4;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1
                          by Lm7;
  for q being Point of TOP-REAL 2 st q in
    the carrier of (TOP-REAL 2)|K1 holds q<>0.REAL 2 by A1;
  then for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm8;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
A3: (for q being Point of
  (TOP-REAL 2)|K1,r1,r2 being Real st g2.q=r1 & g1.q=r2
  holds g3.q=r2*((r1/r2-a)/b)) & g3 is continuous by A2,Th10;
  A4:dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then A5:dom f=dom g3 by FUNCT_2:def 1;
  for x being set st x in dom f holds f.x=g3.x
   proof let x be set;assume
     A6: x in dom f; then A7: x in dom g3 by A4;
     then x in K1 by A4,PRE_TOPC:29;
     then reconsider r=x as Point of (TOP-REAL 2);
     reconsider s=x as Point of (TOP-REAL 2)|K1 by A6;
     A8:f.r=(|.r.|)* ((r`1/|.r.|-cn)/(1+cn)) by A1,A7;
     A9:g2.s=proj1.s by Lm4;
     A10:g1.s=(2 NormF).s by Lm7;
     A11:proj1.r=r`1 by PSCOMP_1:def 28;
    (2 NormF).r=|.r.| by Def1;
    hence f.x=g3.x by A3,A8,A9,A10,A11;
   end;
hence f is continuous by A3,A5,FUNCT_1:9;
end;

theorem Th125:
 for cn being Real,K1 being non empty Subset of TOP-REAL 2,
f being Function of (TOP-REAL 2)|K1,R^1 st
  -1<cn & cn<1 &
(for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds
        q`2<=0 & q`1/|.q.|>=cn & q<>0.REAL 2) holds
f is continuous
proof
 let cn be Real,K1 be non empty Subset of TOP-REAL 2,
f be Function of (TOP-REAL 2)|K1,R^1;
 assume A1: -1<cn & cn<1 &
(for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds
            q`2<=0 & q`1/|.q.|>=cn & q<>0.REAL 2);
  set a=cn, b=1-cn;
  A2: b>0 by A1,XREAL_1:151;
  reconsider g2=proj1|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm4;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1
                          by Lm7;
      for q being Point of TOP-REAL 2 st q in
    the carrier of (TOP-REAL 2)|K1 holds q<>0.REAL 2 by A1;
  then for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm8;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
  A3: (for q being Point of
  (TOP-REAL 2)|K1,r1,r2 being real number st g2.q=r1 & g1.q=r2
  holds g3.q=r2*( -sqrt(abs(1-((r1/r2-a)/b)^2))))
          & g3 is continuous by A2,Th14;
  A4:dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then A5:dom f=dom g3 by FUNCT_2:def 1;
  for x being set st x in dom f holds f.x=g3.x
   proof let x be set;assume
     A6: x in dom f;
     then x in K1 by A4,A5,PRE_TOPC:29;
     then reconsider r=x as Point of (TOP-REAL 2);
     reconsider s=x as Point of (TOP-REAL 2)|K1 by A6;
     A7: now assume |.r.|=0; then r=0.REAL 2 by TOPRNS_1:25;
      hence contradiction by A1,A6;
     end;
A8:  |.r.|>=0;
     |.r.|^2=(r`1)^2+(r`2)^2 by JGRAPH_3:10;
     then (r`1)^2 -(|.r.|)^2 =-(r`2)^2;
     then A9: ((r`1) -(|.r.|))*((r`1)+|.r.|) =-(r`2)^2;
     (r`2)^2>=0 by XREAL_1:65;
     then -(r`2)^2 <=0 by XREAL_1:60;
     then -(|.r.|)<=r`1 & r`1<= |.r.| by A9,XREAL_1:95;
     then r`1/|.r.| <= |.r.|/|.r.| by A7,A8,REAL_1:73;
     then r`1/|.r.|<=1 by A7,XCMPLX_1:60;
     then A10: r`1/|.r.|-cn<=(1-cn) by XREAL_1:11;
     A11: now assume (1-cn)^2=0;
       then 1-cn+cn=0+cn by XCMPLX_1:6;
      hence contradiction by A1;
     end;
     A12: 1-cn>0 by A1,XREAL_1:151;
     A13: (1-cn)^2>=0 by XREAL_1:65;
     cn<=r`1/(|.r.|) by A1,A6;
     then cn-r`1/|.r.|<=0 by REAL_2:106;
     then -(cn- r`1/|.r.|)>=-(1-cn) by A12,XREAL_1:26;
     then (r`1/|.r.|-cn)^2<=(1-cn)^2 by A10,SQUARE_1:119;
     then (r`1/|.r.|-cn)^2/(1-cn)^2<=(1-cn)^2/(1-cn)^2
                         by A11,A13,REAL_1:73;
     then (r`1/|.r.|-cn)^2/(1-cn)^2<=1 by A11,XCMPLX_1:60;
     then ((r`1/|.r.|-cn)/(1-cn))^2<=1 by XCMPLX_1:77;
     then 1-((r`1/|.r.|-cn)/(1-cn))^2>=0 by XREAL_1:50;
     then abs(1-((r`1/|.r.|-cn)/(1-cn))^2)
          =1-((r`1/|.r.|-cn)/(1-cn))^2 by ABSVALUE:def 1;
     then A14:f.r=(|.r.|)*(-sqrt(abs(1-((r`1/|.r.|-cn)/(1-cn))^2)))
                             by A1,A6;
     A15:g2.s=proj1.s by Lm4;
     A16:g1.s=(2 NormF).s by Lm7;
     A17:proj1.r=r`1 by PSCOMP_1:def 28;
     (2 NormF).r=|.r.| by Def1;
    hence f.x=g3.x by A3,A14,A15,A16,A17;
   end;
hence f is continuous by A3,A5,FUNCT_1:9;
end;

theorem Th126:
 for cn being Real,K1 being non empty Subset of TOP-REAL 2,
     f being Function of (TOP-REAL 2)|K1,R^1 st -1<cn & cn<1 &
(for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds
        q`2<=0 & q`1/|.q.|<=cn & q<>0.REAL 2) holds
f is continuous
proof
 let cn be Real,K1 be non empty Subset of TOP-REAL 2,
     f be Function of (TOP-REAL 2)|K1,R^1;
 assume A1: -1<cn & cn<1 &
(for p being Point of (TOP-REAL 2) st p in the carrier of (TOP-REAL 2)|K1
  holds f.p=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)))
  & (for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds
            q`2<=0 & q`1/|.q.|<=cn & q<>0.REAL 2);
  set a=cn, b=1+cn;
  A2: 1+cn>0 by A1,XREAL_1:150;
  reconsider g2=proj1|K1 as continuous Function of (TOP-REAL 2)|K1,R^1 by Lm4;
  reconsider g1=(2 NormF)|K1 as continuous Function of (TOP-REAL 2)|K1,R^1
                          by Lm7;
  for q being Point of TOP-REAL 2 st q in
    the carrier of (TOP-REAL 2)|K1 holds q<>0.REAL 2 by A1;
  then for q being Point of (TOP-REAL 2)|K1 holds g1.q<>0 by Lm8;
  then consider g3 being Function of (TOP-REAL 2)|K1,R^1 such that
  A3: (for q being Point of
  (TOP-REAL 2)|K1,r1,r2 being real number st g2.q=r1 & g1.q=r2
  holds g3.q=r2*( -sqrt(abs(1-((r1/r2-a)/b)^2))))
          & g3 is continuous by A2,Th14;
  A4:dom g3=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1;
  then A5:dom f=dom g3 by FUNCT_2:def 1;
      for x being set st x in dom f holds f.x=g3.x
   proof let x be set;assume
     A6:x in dom f;
     then x in K1 by A4,A5,PRE_TOPC:29;
     then reconsider r=x as Point of (TOP-REAL 2);
     reconsider s=x as Point of (TOP-REAL 2)|K1 by A6;
     A7: now assume |.r.|=0; then r=0.REAL 2 by TOPRNS_1:25;
      hence contradiction by A1,A6;
     end;
     A8: |.r.|>=0;
     |.r.|^2=(r`1)^2+(r`2)^2 by JGRAPH_3:10;
     then (r`1)^2 -(|.r.|)^2 =-(r`2)^2;
     then A9: ((r`1) -(|.r.|))*((r`1)+|.r.|) =-(r`2)^2;
     (r`2)^2>=0 by XREAL_1:65;
     then -(r`2)^2 <=0 by XREAL_1:60;
     then -(|.r.|)<=r`1 & r`1<= |.r.| by A9,XREAL_1:95;
     then r`1/|.r.| >= (-(|.r.|))/|.r.| by A7,A8,REAL_1:73;
     then r`1/|.r.|>= -1 by A7,XCMPLX_1:198;
     then r`1/|.r.|-cn>=-1-cn by XREAL_1:11;
     then A10: r`1/|.r.|-cn>=-(1+cn);
     A11: (1+cn)^2>0 by A2,SQUARE_1:74;
     cn>=r`1/(|.r.|) by A1,A6;
     then cn-r`1/|.r.|>=0 by XREAL_1:50;
     then -(cn-r`1/|.r.|)<=-0 by XREAL_1:26;
     then (r`1/|.r.|-cn)^2<=(1+cn)^2 by A2,A10,SQUARE_1:119;
     then (r`1/|.r.|-cn)^2/(1+cn)^2<=(1+cn)^2/(1+cn)^2 by A11,REAL_1:73;
     then (r`1/|.r.|-cn)^2/(1+cn)^2<=1 by A11,XCMPLX_1:60;
     then ((r`1/|.r.|-cn)/(1+cn))^2<=1 by XCMPLX_1:77;
     then 1-((r`1/|.r.|-cn)/(1+cn))^2>=0 by XREAL_1:50;
     then abs(1-((r`1/|.r.|-cn)/(1+cn))^2)
         =1-((r`1/|.r.|-cn)/(1+cn))^2 by ABSVALUE:def 1;
     then A12:f.r=(|.r.|)*( -sqrt(abs(1-((r`1/|.r.|-cn)/(1+cn))^2))) by A1,A6;
     A13:g2.s=proj1.s by Lm4;
     A14:g1.s=(2 NormF).s by Lm7;
     A15:proj1.r=r`1 by PSCOMP_1:def 28;
     (2 NormF).r=|.r.| by Def1;
    hence f.x=g3.x by A3,A12,A13,A14,A15;
   end;
hence f is continuous by A3,A5,FUNCT_1:9;
end;

theorem Th127: for cn being Real,
K0,B0 being Subset of TOP-REAL 2,f being
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0
st -1<cn & cn<1 & f=(cn-FanMorphS)|K0 &
B0={q where q is Point of TOP-REAL 2: q`2<=0 & q<>0.REAL 2}
& K0={p: p`1/|.p.|>=cn & p`2<=0 & p<>0.REAL 2}
holds f is continuous
proof let cn be Real,K0,B0 be Subset of TOP-REAL 2,f be
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0;
assume A1: -1<cn & cn<1 & f=(cn-FanMorphS)|K0 &
B0={q where q is Point of TOP-REAL 2: q`2<=0 & q<>0.REAL 2} &
K0={p: p`1/|.p.|>=cn & p`2<=0 & p<>0.REAL 2};
 set sn=-sqrt(1-cn^2);
 set p0=|[cn,sn]|;
 A2: p0`1=cn by EUCLID:56;
 A3: p0`2=sn by EUCLID:56;
 cn^2<1^2 by A1,SQUARE_1:120;
 then A4: 1-cn^2>0 by XREAL_1:52;
 A5: now assume p0=0.REAL 2;
   then --sn=-0 by EUCLID:56,JGRAPH_2:11;
  hence contradiction by A4,SQUARE_1:93;
 end;
 -sn>0 by A4,SQUARE_1:93;
 then A6: sn<0 by XREAL_1:60;
 A7: |.p0.|=sqrt((sn)^2+cn^2) by A2,A3,JGRAPH_3:10;
 (-sn)^2=1-cn^2 by A4,SQUARE_1:def 4;
 then (sn)^2=1-cn^2;
 then p0`1/|.p0.|=cn by A7,EUCLID:56,SQUARE_1:83;
 then A8: p0 in K0 by A1,A3,A5,A6;
then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
  A9: K0 c= B0
   proof let x be set;assume x in K0;
     then consider p8 being Point of TOP-REAL 2 such that
     A10: x=p8 & (p8`1/|.p8.|>=cn & p8`2<=0 & p8<>0.REAL 2) by A1;
    thus x in B0 by A1,A10;
   end;
A11:dom (proj1*((cn-FanMorphS)|K1)) c= dom ((cn-FanMorphS)|K1) by RELAT_1:44;
   dom ((cn-FanMorphS)|K1) c= dom (proj1*((cn-FanMorphS)|K1))
proof let x be set;assume A12:x in dom ((cn-FanMorphS)|K1);
   then A13:x in dom (cn-FanMorphS) /\ K1 by FUNCT_1:68;
   A14:((cn-FanMorphS)|K1).x=(cn-FanMorphS).x by A12,FUNCT_1:68;
   A15: dom proj1 = (the carrier of TOP-REAL 2) by FUNCT_2:def 1;
       x in dom (cn-FanMorphS) by A13,XBOOLE_0:def 3;
   then (cn-FanMorphS).x in rng (cn-FanMorphS) by FUNCT_1:12;
  hence x in dom (proj1*((cn-FanMorphS)|K1)) by A12,A14,A15,FUNCT_1:21;
end;
then A16:dom (proj1*((cn-FanMorphS)|K1))
=dom ((cn-FanMorphS)|K1) by A11,XBOOLE_0:def 10
.=dom (cn-FanMorphS) /\ K1 by FUNCT_1:68
.=(the carrier of TOP-REAL 2)/\ K1 by FUNCT_2:def 1
.=K1 by XBOOLE_1:28
.=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
A17:rng (proj1*((cn-FanMorphS)|K1)) c= rng proj1 by RELAT_1:45;
    rng proj1 c= the carrier of R^1 by TOPMETR:24;
then rng (proj1*((cn-FanMorphS)|K1)) c= the carrier of R^1 by A17,XBOOLE_1:1;
then reconsider g2=proj1*((cn-FanMorphS)|K1) as Function of (TOP-REAL 2)|K1,R^1
                                 by A16,FUNCT_2:4;
A18:dom (proj2*((cn-FanMorphS)|K1))
                     c= dom ((cn-FanMorphS)|K1) by RELAT_1:44;
     dom ((cn-FanMorphS)|K1) c= dom (proj2*((cn-FanMorphS)|K1))
proof let x be set;assume A19:x in dom ((cn-FanMorphS)|K1);
   then A20:x in dom (cn-FanMorphS) /\ K1 by FUNCT_1:68;
   A21:((cn-FanMorphS)|K1).x=(cn-FanMorphS).x by A19,FUNCT_1:68;
   A22: dom proj2 = (the carrier of TOP-REAL 2) by FUNCT_2:def 1;
       x in dom (cn-FanMorphS) by A20,XBOOLE_0:def 3;
   then (cn-FanMorphS).x in rng (cn-FanMorphS) by FUNCT_1:12;
  hence x in dom (proj2*((cn-FanMorphS)|K1)) by A19,A21,A22,FUNCT_1:21;
end;
then A23:dom (proj2*((cn-FanMorphS)|K1))
=dom ((cn-FanMorphS)|K1) by A18,XBOOLE_0:def 10
.=dom (cn-FanMorphS) /\ K1 by FUNCT_1:68
.=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
.=K1 by XBOOLE_1:28
.=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
A24:rng (proj2*((cn-FanMorphS)|K1)) c= rng proj2 by RELAT_1:45;
    rng proj2 c= the carrier of R^1 by TOPMETR:24;
then rng (proj2*((cn-FanMorphS)|K1)) c= the carrier of R^1 by A24,XBOOLE_1:1;
then reconsider g1=proj2*((cn-FanMorphS)|K1) as Function of (TOP-REAL 2)|K1,R^1
                                 by A23,FUNCT_2:4;
A25: for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`2<=0 & q<>0.REAL 2
   proof let q be Point of TOP-REAL 2;
    assume A26:q in the carrier of (TOP-REAL 2)|K1;
     the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     then consider p3 being Point of TOP-REAL 2 such that
     A27: q=p3 & (p3`1/|.p3.|>=cn & p3`2<=0 & p3<>0.REAL 2) by A1,A26;
    thus q`2<=0 & q<>0.REAL 2 by A27;
   end;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g2.p=|.p.|* ((p`1/|.p.|-cn)/(1-cn))
   proof let p be Point of TOP-REAL 2;
    assume A28: p in the carrier of (TOP-REAL 2)|K1;
     A29:dom ((cn-FanMorphS)|K1)=dom (cn-FanMorphS) /\ K1 by FUNCT_1:68
     .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
     .=K1 by XBOOLE_1:28;
     A30:the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     then consider p3 being Point of TOP-REAL 2 such that
     A31: p=p3 & (p3`1/|.p3.|>=cn & p3`2<=0 & p3<>0.REAL 2) by A1,A28;
     A32:(cn-FanMorphS).p
     =|[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
        |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]| by A1,A31,Th122;
        ((cn-FanMorphS)|K1).p=(cn-FanMorphS).p by A28,A30,FUNCT_1:72;
     then g2.p=proj1.(|[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
        |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]|)
                             by A28,A29,A30,A32,FUNCT_1:23
      .=(|[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
        |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]|)`1 by PSCOMP_1:def 28
      .=|.p.|* ((p`1/|.p.|-cn)/(1-cn)) by EUCLID:56;
    hence g2.p=|.p.|* ((p`1/|.p.|-cn)/(1-cn));
   end;
then consider f2 being Function of (TOP-REAL 2)|K1,R^1 such that
  A33:for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds f2.p=|.p.|* ((p`1/|.p.|-cn)/(1-cn));
A34:f2 is continuous by A1,A25,A33,Th123;
  for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g1.p=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))
   proof let p be Point of TOP-REAL 2;
    assume A35: p in the carrier of (TOP-REAL 2)|K1;
     A36:dom ((cn-FanMorphS)|K1)=dom (cn-FanMorphS) /\ K1 by FUNCT_1:68
     .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
       .=K1 by XBOOLE_1:28;
     A37:the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     then consider p3 being Point of TOP-REAL 2 such that
     A38: p=p3 & (p3`1/|.p3.|>=cn & p3`2<=0 & p3<>0.REAL 2) by A1,A35;
     A39:(cn-FanMorphS).p=|[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
       |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]| by A1,A38,Th122;
        ((cn-FanMorphS)|K1).p=(cn-FanMorphS).p by A35,A37,FUNCT_1:72;
     then g1.p=proj2.(|[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
          |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]|)
                             by A35,A36,A37,A39,FUNCT_1:23
        .=(|[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
          |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]|)`2 by PSCOMP_1:def 29
        .= |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)) by EUCLID:56;
    hence g1.p=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2));
   end;
then consider f1 being Function of (TOP-REAL 2)|K1,R^1 such that
  A40:for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds f1.p=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2));
      for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`2<=0 & q`1/|.q.|>=cn & q<>0.REAL 2
   proof let q be Point of TOP-REAL 2;
    assume A41:q in the carrier of (TOP-REAL 2)|K1;
          the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     then consider p3 being Point of TOP-REAL 2 such that
     A42: q=p3 & (p3`1/|.p3.|>=cn & p3`2<=0 & p3<>0.REAL 2) by A1,A41;
    thus thesis by A42;
   end;
  then A43:f1 is continuous by A1,A40,Th125;
   for x,y,s,r being real number st |[x,y]| in K1 &
  s=f2.(|[x,y]|) & r=f1.(|[x,y]|) holds f.(|[x,y]|)=|[s,r]|
  proof let x,y,s,r be real number;
   assume A44: |[x,y]| in K1 & s=f2.(|[x,y]|) & r=f1.(|[x,y]|);
     set p99=|[x,y]|;
     A45:the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     consider p3 being Point of TOP-REAL 2 such that
     A46: p99=p3 & (p3`1/|.p3.|>=cn & p3`2<=0 & p3<>0.REAL 2) by A1,A44;
     A47:f1.p99=|.p99.|*( -sqrt(1-((p99`1/|.p99.|-cn)/(1-cn))^2))
                          by A40,A44,A45;
        ((cn-FanMorphS)|K0).(|[x,y]|)=((cn-FanMorphS)).(|[x,y]|) by A44,
FUNCT_1:72
    .= |[ |.p99.|* ((p99`1/|.p99.|-cn)/(1-cn)),
      |.p99.|*( -sqrt(1-((p99`1/|.p99.|-cn)/(1-cn))^2))]| by A1,A46,Th122
    .=|[s,r]| by A33,A44,A45,A47;
   hence f.(|[x,y]|)=|[s,r]| by A1;
  end;
hence f is continuous by A8,A9,A34,A43,JGRAPH_2:45;
end;

theorem Th128:
  for cn being Real, K0,B0 being Subset of TOP-REAL 2,
      f being Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0 st
    -1<cn & cn<1 & f=(cn-FanMorphS)|K0 &
    B0={q where q is Point of TOP-REAL 2: q`2<=0 & q<>0.REAL 2} &
    K0={p: p`1/|.p.|<=cn & p`2<=0 & p<>0.REAL 2} holds f is continuous
proof let cn be Real,K0,B0 be Subset of TOP-REAL 2,f be
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0;
assume A1: -1<cn & cn<1 & f=(cn-FanMorphS)|K0 &
B0={q where q is Point of TOP-REAL 2: q`2<=0 & q<>0.REAL 2} &
K0={p: p`1/|.p.|<=cn & p`2<=0 & p<>0.REAL 2};
 set sn=-sqrt(1-cn^2);
 set p0=|[cn,sn]|;
 A2: p0`1=cn by EUCLID:56;
 A3: p0`2=sn by EUCLID:56;
       cn^2<1^2 by A1,SQUARE_1:120;
 then A4: 1-cn^2>0 by XREAL_1:52;
 A5: now assume p0=0.REAL 2;
   then --sn=-0 by EUCLID:56,JGRAPH_2:11;
  hence contradiction by A4,SQUARE_1:93;
 end;
 -sn>0 by A4,SQUARE_1:93;
 then A6: sn<0 by XREAL_1:60;
 A7: |.p0.|=sqrt((sn)^2+cn^2) by A2,A3,JGRAPH_3:10;
 (-sn)^2=1-cn^2 by A4,SQUARE_1:def 4;
 then sn^2=1-cn^2;
 then p0`1/|.p0.|=cn by A7,EUCLID:56,SQUARE_1:83;
 then A8: p0 in K0 by A1,A3,A5,A6;
 then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
  A9: K0 c= B0
   proof let x be set;assume x in K0;
      then consider p8 being Point of TOP-REAL 2 such that
      A10: x=p8 & (p8`1/|.p8.|<=cn & p8`2<=0 & p8<>0.REAL 2) by A1;
    thus x in B0 by A1,A10;
   end;
A11:dom (proj1*((cn-FanMorphS)|K1)) c= dom ((cn-FanMorphS)|K1)
                                  by RELAT_1:44;
   dom ((cn-FanMorphS)|K1) c= dom (proj1*((cn-FanMorphS)|K1))
proof let x be set;assume A12:x in dom ((cn-FanMorphS)|K1);
   then A13:x in dom (cn-FanMorphS) /\ K1 by FUNCT_1:68;
   A14:((cn-FanMorphS)|K1).x=(cn-FanMorphS).x by A12,FUNCT_1:68;
   A15: dom proj1 = (the carrier of TOP-REAL 2) by FUNCT_2:def 1;
   x in dom (cn-FanMorphS) by A13,XBOOLE_0:def 3;
   then (cn-FanMorphS).x in rng (cn-FanMorphS) by FUNCT_1:12;
  hence x in dom (proj1*((cn-FanMorphS)|K1)) by A12,A14,A15,FUNCT_1:21;
end;
then A16:dom (proj1*((cn-FanMorphS)|K1))
=dom ((cn-FanMorphS)|K1) by A11,XBOOLE_0:def 10
.=dom (cn-FanMorphS) /\ K1 by FUNCT_1:68
.=(the carrier of TOP-REAL 2)/\ K1 by FUNCT_2:def 1
.=K1 by XBOOLE_1:28
.=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
A17:rng (proj1*((cn-FanMorphS)|K1)) c= rng proj1 by RELAT_1:45;
    rng proj1 c= the carrier of R^1 by TOPMETR:24;
then rng (proj1*((cn-FanMorphS)|K1)) c= the carrier of R^1 by A17,XBOOLE_1:1;
then reconsider g2=proj1*((cn-FanMorphS)|K1) as Function of (TOP-REAL 2)|K1,R^1
                                 by A16,FUNCT_2:4;
A18:dom (proj2*((cn-FanMorphS)|K1))
                     c= dom ((cn-FanMorphS)|K1) by RELAT_1:44;
   dom ((cn-FanMorphS)|K1) c= dom (proj2*((cn-FanMorphS)|K1))
proof let x be set;assume A19:x in dom ((cn-FanMorphS)|K1);
   then A20:x in dom (cn-FanMorphS) /\ K1 by FUNCT_1:68;
   A21:((cn-FanMorphS)|K1).x=(cn-FanMorphS).x by A19,FUNCT_1:68;
   A22: dom proj2 = (the carrier of TOP-REAL 2) by FUNCT_2:def 1;
       x in dom (cn-FanMorphS) by A20,XBOOLE_0:def 3;
   then (cn-FanMorphS).x in rng (cn-FanMorphS) by FUNCT_1:12;
  hence x in dom (proj2*((cn-FanMorphS)|K1)) by A19,A21,A22,FUNCT_1:21;
end;
then A23:dom (proj2*((cn-FanMorphS)|K1))
=dom ((cn-FanMorphS)|K1) by A18,XBOOLE_0:def 10
.=dom (cn-FanMorphS) /\ K1 by FUNCT_1:68
.=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
.=K1 by XBOOLE_1:28
.=the carrier of (TOP-REAL 2)|K1 by PRE_TOPC:29;
A24:rng (proj2*((cn-FanMorphS)|K1)) c= rng proj2 by RELAT_1:45;
    rng proj2 c= the carrier of R^1 by TOPMETR:24;
then rng (proj2*((cn-FanMorphS)|K1)) c= the carrier of R^1 by A24,XBOOLE_1:1;
then reconsider g1=proj2*((cn-FanMorphS)|K1) as Function of (TOP-REAL 2)|K1,R^1
                                 by A23,FUNCT_2:4;
A25: for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`2<=0 & q<>0.REAL 2
   proof let q be Point of TOP-REAL 2;
    assume A26:q in the carrier of (TOP-REAL 2)|K1;
          the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     then consider p3 being Point of TOP-REAL 2 such that
     A27: q=p3 & (p3`1/|.p3.|<=cn & p3`2<=0 & p3<>0.REAL 2) by A1,A26;
    thus q`2<=0 & q<>0.REAL 2 by A27;
   end;
   for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g2.p=|.p.|* ((p`1/|.p.|-cn)/(1+cn))
   proof let p be Point of TOP-REAL 2;
    assume A28: p in the carrier of (TOP-REAL 2)|K1;
     A29:dom ((cn-FanMorphS)|K1)=dom (cn-FanMorphS) /\ K1 by FUNCT_1:68
     .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
     .=K1 by XBOOLE_1:28;
     A30:the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     then consider p3 being Point of TOP-REAL 2 such that
     A31: p=p3 & (p3`1/|.p3.|<=cn & p3`2<=0 & p3<>0.REAL 2) by A1,A28;
     A32:(cn-FanMorphS).p
     =|[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
       |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]| by A1,A31,Th122;
        ((cn-FanMorphS)|K1).p=(cn-FanMorphS).p by A28,A30,FUNCT_1:72;
     then g2.p=proj1.(|[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
        |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]|)
                             by A28,A29,A30,A32,FUNCT_1:23
      .=(|[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
       |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]|)`1 by PSCOMP_1:def 28
      .=|.p.|* ((p`1/|.p.|-cn)/(1+cn)) by EUCLID:56;
    hence g2.p=|.p.|* ((p`1/|.p.|-cn)/(1+cn));
   end;
then consider f2 being Function of (TOP-REAL 2)|K1,R^1 such that
  A33:for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds f2.p=|.p.|* ((p`1/|.p.|-cn)/(1+cn));
A34:f2 is continuous by A1,A25,A33,Th124;
      for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds g1.p=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))
   proof let p be Point of TOP-REAL 2;
    assume A35: p in the carrier of (TOP-REAL 2)|K1;
     A36:dom ((cn-FanMorphS)|K1)=dom (cn-FanMorphS) /\ K1 by FUNCT_1:68
     .=((the carrier of TOP-REAL 2))/\ K1 by FUNCT_2:def 1
     .=K1 by XBOOLE_1:28;
     A37:the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     then consider p3 being Point of TOP-REAL 2 such that
     A38: p=p3 & (p3`1/|.p3.|<=cn & p3`2<=0 & p3<>0.REAL 2) by A1,A35;
     A39:(cn-FanMorphS).p=|[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
       |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]| by A1,A38,Th122;
        ((cn-FanMorphS)|K1).p=(cn-FanMorphS).p by A35,A37,FUNCT_1:72;
     then g1.p=proj2.(|[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
          |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]|)
                             by A35,A36,A37,A39,FUNCT_1:23
        .=(|[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
          |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]|)`2 by PSCOMP_1:def 29
        .= |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)) by EUCLID:56;
    hence g1.p=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2));
   end;
then consider f1 being Function of (TOP-REAL 2)|K1,R^1 such that
  A40:for p being Point of TOP-REAL 2 st p in the carrier of (TOP-REAL 2)|K1
  holds f1.p=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2));
      for q being Point of TOP-REAL 2 st q in
  the carrier of (TOP-REAL 2)|K1 holds q`2<=0 & q`1/|.q.|<=cn & q<>0.REAL 2
   proof let q be Point of TOP-REAL 2;
    assume A41:q in the carrier of (TOP-REAL 2)|K1;
     the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     then consider p3 being Point of TOP-REAL 2 such that
     A42: q=p3 & (p3`1/|.p3.|<=cn & p3`2<=0 & p3<>0.REAL 2) by A1,A41;
    thus thesis by A42;
   end;
then A43:f1 is continuous by A1,A40,Th126;
    for x,y,s,r being real number st |[x,y]| in K1 &
  s=f2.(|[x,y]|) & r=f1.(|[x,y]|) holds f.(|[x,y]|)=|[s,r]|
  proof let x,y,s,r be real number;
   assume A44: |[x,y]| in K1 & s=f2.(|[x,y]|) & r=f1.(|[x,y]|);
     set p99=|[x,y]|;
     A45:the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
     consider p3 being Point of TOP-REAL 2 such that
     A46: p99=p3 & (p3`1/|.p3.|<=cn & p3`2<=0 & p3<>0.REAL 2) by A1,A44;
     A47:f1.p99=|.p99.|*( -sqrt(1-((p99`1/|.p99.|-cn)/(1+cn))^2))
                          by A40,A44,A45;
     ((cn-FanMorphS)|K0).(|[x,y]|)=((cn-FanMorphS)).(|[x,y]|) by A44,
FUNCT_1:72
    .= |[ |.p99.|* ((p99`1/|.p99.|-cn)/(1+cn)),
      |.p99.|*( -sqrt(1-((p99`1/|.p99.|-cn)/(1+cn))^2))]| by A1,A46,Th122
    .=|[s,r]| by A33,A44,A45,A47;
   hence f.(|[x,y]|)=|[s,r]| by A1;
  end;
hence f is continuous by A8,A9,A34,A43,JGRAPH_2:45;
end;

theorem Th129: for cn being Real, K03 being Subset of TOP-REAL 2
 st K03={p: p`1>=(cn)*(|.p.|) & p`2<=0}
 holds K03 is closed
proof let sn be Real, K003 be Subset of TOP-REAL 2;
 assume A1: K003={p: p`1>=(sn)*(|.p.|) & p`2<=0};
 defpred P[Point of TOP-REAL 2] means
 ($1`1>=sn*|.$1.|);
  reconsider K1={p7 where p7 is Point of TOP-REAL 2:P[p7]}
  as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
  A2: K1 is closed by Lm10;
  defpred Q[Point of TOP-REAL 2] means $1`2<=0;
  reconsider KX={p where p is Point of TOP-REAL 2: Q[p]}
    as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
A3: KX is closed by JORDAN6:9;
   {p : P[p] & Q[p]}
    = {p7 where p7 is Point of TOP-REAL 2:P[p7]} /\
     {p1 where p1 is Point of TOP-REAL 2: Q[p1]} from DOMAIN_1:sch 10;
  hence thesis by A1,A2,A3,TOPS_1:35;
end;

theorem Th130: for cn being Real, K03 being Subset of TOP-REAL 2
 st K03={p: p`1<=(cn)*(|.p.|) & p`2<=0}
 holds K03 is closed
proof let sn be Real, K003 be Subset of TOP-REAL 2;
 assume A1: K003={p: p`1<=(sn)*(|.p.|) & p`2<=0};
 defpred P[Point of TOP-REAL 2] means ($1`1<=sn*|.$1.|);
  reconsider K1={p7 where p7 is Point of TOP-REAL 2:P[p7]}
  as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
  A2: K1 is closed by Lm12;
  defpred Q[Point of TOP-REAL 2] means $1`2<=0;
  reconsider KX={p where p is Point of TOP-REAL 2: Q[p]}
    as Subset of TOP-REAL 2 from JGRAPH_2:sch 1;
A3: KX is closed by JORDAN6:9;
   {p : P[p] & Q[p]}
    = {p7 where p7 is Point of TOP-REAL 2:P[p7]} /\
     {p1 where p1 is Point of TOP-REAL 2: Q[p1]} from DOMAIN_1:sch 10;
  hence thesis by A1,A2,A3,TOPS_1:35;
end;

theorem Th131:
  for cn being Real, K0,B0 being Subset of TOP-REAL 2,
      f being Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0 st
    -1<cn & cn<1 & f=(cn-FanMorphS)|K0 &
    B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} &
    K0={p: p`2<=0 & p<>0.REAL 2} holds f is continuous
proof let cn be Real,K0,B0 be Subset of TOP-REAL 2,f be
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0;
assume A1: -1<cn & cn<1 & f=(cn-FanMorphS)|K0 &
B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} & K0={p: p`2<=0 & p<>0.REAL 2};
 set sn=-sqrt(1-cn^2);
 set p0=|[cn,sn]|;
 A2: p0`1=cn by EUCLID:56;
 A3: p0`2=sn by EUCLID:56;
       cn^2<1 by A1,SQUARE_1:120,59;
 then A4: 1-cn^2>0 by XREAL_1:52;
 A5: now assume p0=0.REAL 2;
   then --sn=-0 by EUCLID:56,JGRAPH_2:11;
  hence contradiction by A4,SQUARE_1:93;
 end;
 -sn>0 by A4,SQUARE_1:93;
 then A6: sn<0 by XREAL_1:60;
 A7: |.p0.|=sqrt((sn)^2+cn^2) by A2,A3,JGRAPH_3:10;
 (-sn)^2=1-cn^2 by A4,SQUARE_1:def 4;
 then sn^2=1-cn^2;
 then A8: p0`1/|.p0.|=cn by A7,EUCLID:56,SQUARE_1:83;
 p0 in K0 by A1,A3,A5,A6;
then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
 p0 in the carrier of TOP-REAL 2 & not p0 in {0.REAL 2} by A5,TARSKI:def 1;
  then reconsider D=B0 as non empty Subset of TOP-REAL 2 by A1,XBOOLE_0:def 4;
   A9: p0 in {p: p`1/|.p.|>=cn & p`2<=0 & p<>0.REAL 2} by A3,A5,A6,A8;
   defpred P[Point of TOP-REAL 2] means
   $1`1/|.$1.|>=cn & $1`2<=0 & $1<>0.REAL 2;
   A10: {p: P[p]}
     is Subset of TOP-REAL 2 from DOMAIN_1:sch 7;
   A11: {p: p`1/|.p.|>=cn & p`2<=0 & p<>0.REAL 2} c= K1
    proof let x be set;assume x in
      {p: p`1/|.p.|>=cn & p`2<=0 & p<>0.REAL 2};
      then consider p such that
      A12:p=x & p`1/|.p.|>=cn & p`2<=0 & p<>0.REAL 2;
     thus x in K1 by A1,A12;
    end;
   then reconsider K00={p: p`1/|.p.|>=cn & p`2<=0 & p<>0.REAL 2}
      as non empty Subset of ((TOP-REAL 2)|K1) by A9,PRE_TOPC:29;
   reconsider K001={p: p`1/|.p.|>=cn & p`2<=0 & p<>0.REAL 2}
            as non empty Subset of TOP-REAL 2 by A9,A10;
   defpred P[Point of TOP-REAL 2] means $1`1>=cn*(|.$1.|) & $1`2<=0;
       {p: P[p]} is Subset of
   TOP-REAL 2 from DOMAIN_1:sch 7;
   then reconsider K003={p: p`1>=(cn)*(|.p.|) & p`2<=0}
            as Subset of TOP-REAL 2;
   A13: p0 in {p: p`1/|.p.|<=cn & p`2<=0 & p<>0.REAL 2} by A3,A5,A6,A8;
   A14: {p: p`1/|.p.|<=cn & p`2<=0 & p<>0.REAL 2} c= K1
    proof let x be set;assume x in
      {p: p`1/|.p.|<=cn & p`2<=0 & p<>0.REAL 2};
      then consider p such that
        A15: p=x & p`1/|.p.|<=cn & p`2<=0 & p<>0.REAL 2;
     thus x in K1 by A1,A15;
    end;
   then reconsider K11={p: p`1/|.p.|<=cn & p`2<=0 & p<>0.REAL 2}
            as non empty Subset of ((TOP-REAL 2)|K1)
            by A13,PRE_TOPC:29;
    A16: p0 in {p: p`1/|.p.|<=cn & p`2<=0 & p<>0.REAL 2} by A3,A5,A6,A8;
    defpred P[Point of TOP-REAL 2] means
    $1`1/|.$1.|<=cn & $1`2<=0 & $1<>0.REAL 2;
       {p: P[p]} is Subset of
   TOP-REAL 2 from DOMAIN_1:sch 7;
   then reconsider K111={p: p`1/|.p.|<=cn & p`2<=0 & p<>0.REAL 2}
            as non empty Subset of TOP-REAL 2 by A16;
   defpred P[Point of TOP-REAL 2] means $1`1<=(cn)*(|.$1.|) & $1`2<=0;
       {p: P[p]} is Subset of
   TOP-REAL 2 from DOMAIN_1:sch 7;
   then reconsider K004={p: p`1<=(cn)*(|.p.|) & p`2<=0}
            as Subset of (TOP-REAL 2);
      the carrier of (TOP-REAL 2)|B0=the carrier of (TOP-REAL 2)|D;
  then A17: dom f=the carrier of (TOP-REAL 2)|K1 by FUNCT_2:def 1
    .=K1 by PRE_TOPC:29;
  then A18: dom (f|K00)=K00 by A11,RELAT_1:91
  .= the carrier of ((TOP-REAL 2)|K1)|K00 by PRE_TOPC:29;
  A19: the carrier of (TOP-REAL 2)|D = D by PRE_TOPC:29;
  rng (f|K00) c=D by A19;
  then reconsider f1=f|K00 as Function of ((TOP-REAL 2)|K1)|K00,(TOP-REAL 2)|D
                            by A18,FUNCT_2:4;
  A20: dom f1=the carrier of ((TOP-REAL 2)|K1)|K00 by FUNCT_2:def 1
  .=K00 by PRE_TOPC:29;
  A21: dom (cn-FanMorphS)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
  then A22: dom ((cn-FanMorphS)|K001)=K001 by RELAT_1:91
  .= the carrier of (TOP-REAL 2)|K001 by PRE_TOPC:29;
  A23: the carrier of (TOP-REAL 2)|K1 =K1 by PRE_TOPC:29;
      rng ((cn-FanMorphS)|K001) c= K1
   proof let y be set;assume y in rng ((cn-FanMorphS)|K001);
     then consider x being set such that
     A24: x in dom ((cn-FanMorphS)|K001) & y=((cn-FanMorphS)|K001).x
        by FUNCT_1:def 5;
     A25: dom ((cn-FanMorphS)|K001)=(dom (cn-FanMorphS))/\ K001 by FUNCT_1:68
     .=(the carrier of TOP-REAL 2)/\ K001 by FUNCT_2:def 1
     .=K001 by XBOOLE_1:28;
     reconsider q=x as Point of TOP-REAL 2 by A24;
     A26: y=(cn-FanMorphS).q by A24,FUNCT_1:70;
     consider p2 being Point of TOP-REAL 2 such that
     A27: p2=q & p2`1/|.p2.|>=cn & p2`2<=0 & p2<>0.REAL 2 by A24,A25;
     A28: cn-FanMorphS.q= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
        |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by A1,A27,Th122;
     set q4= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
        |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]|;
         |.q.|<>0 by A27,TOPRNS_1:25;
     then A29: (|.q.|)^2>0 by SQUARE_1:74;
     A30: 1-cn>0 by A1,XREAL_1:151;
        A31: q4`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))&
        q4`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by EUCLID:56;
        A32: (q`1/|.q.|-cn)>= 0 by A27,XREAL_1:50;
            0<=(q`2)^2 by XREAL_1:65;
        then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`1)^2 <= (|.q.|)^2 by JGRAPH_3:10;
        then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A29,REAL_1:73;
        then (q`1)^2/(|.q.|)^2 <= 1 by A29,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then 1>=q`1/|.q.| by Lm2;
        then A33: 1-cn>=q`1/|.q.|-cn by XREAL_1:11;
        A34: -(1-cn)<= -0 by A30,XREAL_1:26;
             -(1-cn)<= -( q`1/|.q.|-cn) by A33,XREAL_1:26;
         then (-(1-cn))/(1-cn)<=(-( q`1/|.q.|-cn))/(1-cn)
                        by A30,REAL_1:73;
        then A35: -1<=(-( q`1/|.q.|-cn))/(1-cn) by A30,XCMPLX_1:198;
           --(1-cn)>= -(q`1/|.q.|-cn) by A32,A34,XREAL_1:26;
       then (-(q`1/|.q.|-cn))/(1-cn)<=1 by A30,REAL_2:117;
       then ((-(q`1/|.q.|-cn))/(1-cn))^2<=1 by A35,SQUARE_1:119,59;
       then A36: 1-((-(q`1/|.q.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
       then 1-(-((q`1/|.q.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
       then A37: 1-((q`1/|.q.|-cn)/(1-cn))^2>=0;
           sqrt(1-((-(q`1/|.q.|-cn))/(1-cn))^2)>=0 by A36,SQUARE_1:def 4;
       then sqrt(1-(-(q`1/|.q.|-cn))^2/(1-cn)^2)>=0 by XCMPLX_1:77;
       then sqrt(1-(q`1/|.q.|-cn)^2/(1-cn)^2)>=0;
       then sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)>=0 by XCMPLX_1:77;
       then A38: -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)<=0 by XREAL_1:60;
        A39: (q4`2)^2= (|.q.|)^2*(sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))^2 by A31
         .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1-cn))^2) by A37,SQUARE_1:def 4;
        A40: (q4`1)^2= (|.q.|)^2*((q`1/|.q.|-cn)/(1-cn))^2
                         by A31;
            (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
        .=(|.q.|)^2 by A39,A40;
     then q4`2<=0 & q4<>0.REAL 2 by A29,A31,A38,XREAL_1:133,SQUARE_1:
60,TOPRNS_1:24
;
    hence y in K1 by A1,A26,A28;
   end;
  then reconsider f3=(cn-FanMorphS)|K001
   as Function of (TOP-REAL 2)|K001,(TOP-REAL 2)|K1  by A22,A23,FUNCT_2:4;
  A41: dom (f|K11)=K11 by A14,A17,RELAT_1:91
  .= the carrier of ((TOP-REAL 2)|K1)|K11 by PRE_TOPC:29;
  A42: the carrier of (TOP-REAL 2)|D = D by PRE_TOPC:29;
  rng (f|K11) c=D by A42;
  then reconsider f2=f|K11 as Function of ((TOP-REAL 2)|K1)|K11,(TOP-REAL 2)|D
                    by A41,FUNCT_2:4;
  A43: dom f2=the carrier of ((TOP-REAL 2)|K1)|K11 by FUNCT_2:def 1
  .=K11 by PRE_TOPC:29;
  A44: dom ((cn-FanMorphS)|K111)=K111 by A21,RELAT_1:91
  .= the carrier of (TOP-REAL 2)|K111 by PRE_TOPC:29;
  A45: the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
      rng ((cn-FanMorphS)|K111) c= K1
   proof let y be set;assume y in rng ((cn-FanMorphS)|K111);
     then consider x being set such that
     A46: x in dom ((cn-FanMorphS)|K111) & y=((cn-FanMorphS)|K111).x
        by FUNCT_1:def 5;
     A47: dom ((cn-FanMorphS)|K111)=(dom (cn-FanMorphS))/\ K111 by FUNCT_1:68
     .=(the carrier of TOP-REAL 2)/\ K111 by FUNCT_2:def 1
     .=K111 by XBOOLE_1:28;
     reconsider q=x as Point of TOP-REAL 2 by A46;
     A48: y=(cn-FanMorphS).q by A46,FUNCT_1:70;
     consider p2 being Point of TOP-REAL 2 such that
     A49: p2=q & p2`1/|.p2.|<=cn & p2`2<=0 & p2<>0.REAL 2 by A46,A47;
     A50: cn-FanMorphS.q= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
        |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]| by A1,A49,Th122;
     set q4= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
       |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]|;
         |.q.|<>0 by A49,TOPRNS_1:25;
     then A51: (|.q.|)^2>0 by SQUARE_1:74;
   A52: 1+cn>0 by A1,XREAL_1:150;
        A53: q4`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))&
        q4`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by EUCLID:56;
        A54: (q`1/|.q.|-cn)<=0 by A49,REAL_2:106;
        A55: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
            0<=(q`2)^2 by XREAL_1:65;
        then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A51,A55,REAL_1:73;
        then (q`1)^2/(|.q.|)^2 <= 1 by A51,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then -1<=q`1/|.q.| by Lm2;
        then A56: -1-cn<=q`1/|.q.|-cn by XREAL_1:11;
           (1+cn)/(1+cn)>=(q`1/|.q.|-cn)/(1+cn) by A52,A54,REAL_1:73;
        then A57: 1>=(q`1/|.q.|-cn)/(1+cn) by A52,XCMPLX_1:60;
             (-(1+cn))/(1+cn)<=(( q`1/|.q.|-cn))/(1+cn)
                        by A52,A56,REAL_1:73;
        then -1<=(( q`1/|.q.|-cn))/(1+cn) by A52,XCMPLX_1:198;
       then (((q`1/|.q.|-cn))/(1+cn))^2<=1^2 by A57,SQUARE_1:119;
       then A58: 1-((q`1/|.q.|-cn)/(1+cn))^2>=0 by XREAL_1:50;
       then 1-(-((q`1/|.q.|-cn)/(1+cn)))^2>=0;
       then 1-((-(q`1/|.q.|-cn))/(1+cn))^2>=0 by XCMPLX_1:188;
       then sqrt(1-((-(q`1/|.q.|-cn))/(1+cn))^2)>=0 by SQUARE_1:def 4;
       then sqrt(1-(-(q`1/|.q.|-cn))^2/(1+cn)^2)>=0 by XCMPLX_1:77;
       then sqrt(1-(q`1/|.q.|-cn)^2/(1+cn)^2)>=0;
       then sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)>=0 by XCMPLX_1:77;
       then -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)<=0 by XREAL_1:60;
       then A59: q4`2<= 0 by A53,XREAL_1:133;
        A60: (q4`2)^2= (|.q.|)^2*(sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))^2 by A53
         .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1+cn))^2) by A58,SQUARE_1:def 4;
        A61: (q4`1)^2= (|.q.|)^2*((q`1/|.q.|-cn)/(1+cn))^2
                         by A53;
            (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
        .=(|.q.|)^2 by A60,A61;
        then q4<>0.REAL 2 by A51,SQUARE_1:60,TOPRNS_1:24;
    hence y in K1 by A1,A48,A50,A59;
   end;
  then reconsider f4=(cn-FanMorphS)|K111
   as Function of (TOP-REAL 2)|K111,(TOP-REAL 2)|K1  by A44,A45,FUNCT_2:4;
  set T1= ((TOP-REAL 2)|K1)|K00,T2=((TOP-REAL 2)|K1)|K11;
  A62: [#](((TOP-REAL 2)|K1)|K00)=K00 by PRE_TOPC:def 10;
  A63: [#](((TOP-REAL 2)|K1)|K11)=K11 by PRE_TOPC:def 10;
  A64: [#]((TOP-REAL 2)|K1)=K1 by PRE_TOPC:def 10;
  A65: K1 c= K00 \/ K11
   proof let x be set;assume x in K1;
     then consider p such that
A66: p=x & (p`2<=0 & p<>0.REAL 2) by A1;
     per cases;
     suppose p`1/|.p.|>=cn;
       then x in K00 by A66;
      hence x in K00 \/ K11 by XBOOLE_0:def 2;
     end;
     suppose p`1/|.p.|<cn;
       then x in K11 by A66;
      hence x in K00 \/ K11 by XBOOLE_0:def 2;
     end;
   end;
  then A67: [#](((TOP-REAL 2)|K1)|K00) \/ [#](((TOP-REAL 2)|K1)|K11)
        =[#]((TOP-REAL 2)|K1) by A62,A63,A64,XBOOLE_0:def 10;
  A68: K003 is closed by Th129;
  A69: K003 /\ K1 c= K00
   proof let x be set;assume x in K003 /\ K1;
     then A70: x in K003 & x in K1 by XBOOLE_0:def 3;
     then consider q1 being Point of TOP-REAL 2 such that
     A71: q1=x & q1`1>=(cn)*(|.q1.|) & q1`2<=0;
     consider q2 being Point of TOP-REAL 2 such that
     A72: q2=x & q2`2<=0 & q2<>0.REAL 2 by A1,A70;
     A73: |.q2.|<>0 by A72,TOPRNS_1:25;
     |.q1.|>=0;
     then q1`1/|.q1.|>=(cn)*(|.q1.|)/|.q1.| by A71,A72,A73,REAL_1:73;
     then q1`1/|.q1.|>=(cn) by A71,A72,A73,XCMPLX_1:90;
    hence x in K00 by A71,A72;
   end;
   K00 c= K003 /\ K1
   proof let x be set;assume x in K00;
     then consider p such that
     A74: p=x & (p`1/|.p.|>=cn & p`2<=0 & p<>0.REAL 2);
     A75: |.p.|<>0 by A74,TOPRNS_1:25;
     p`1/|.p.|*|.p.|>=(cn)*(|.p.|) by A74,XREAL_1:66;
     then p`1>=(cn)*(|.p.|) by A75,XCMPLX_1:88;
     then A76: x in K003 by A74;
     x in K1 by A1,A74;
    hence x in K003 /\ K1 by A76,XBOOLE_0:def 3;
   end;
  then K00=K003 /\ [#]((TOP-REAL 2)|K1) by A64,A69,XBOOLE_0:def 10;
  then A77: K00 is closed by A68,PRE_TOPC:43;
  A78: K004 is closed by Th130;
  A79: K004 /\ K1 c= K11
   proof let x be set;assume x in K004 /\ K1;
     then A80: x in K004 & x in K1 by XBOOLE_0:def 3;
     then consider q1 being Point of TOP-REAL 2 such that
     A81: q1=x & q1`1<=(cn)*(|.q1.|) & q1`2<=0;
     consider q2 being Point of TOP-REAL 2 such that
     A82: q2=x & q2`2<=0 & q2<>0.REAL 2 by A1,A80;
     A83: |.q2.|<>0 by A82,TOPRNS_1:25;
     |.q1.|>=0;
     then q1`1/|.q1.|<=(cn)*(|.q1.|)/|.q1.| by A81,A82,A83,REAL_1:73;
     then q1`1/|.q1.|<=(cn) by A81,A82,A83,XCMPLX_1:90;
    hence x in K11 by A81,A82;
   end;
   K11 c= K004 /\ K1
   proof let x be set;assume x in K11;
     then consider p such that
     A84: p=x & (p`1/|.p.|<=cn & p`2<=0 & p<>0.REAL 2);
     A85: |.p.|<>0 by A84,TOPRNS_1:25;
     p`1/|.p.|*|.p.|<=(cn)*(|.p.|) by A84,XREAL_1:66;
     then p`1<=(cn)*(|.p.|) by A85,XCMPLX_1:88;
     then A86: x in K004 by A84;
     x in K1 by A1,A84;
    hence x in K004 /\ K1 by A86,XBOOLE_0:def 3;
   end;
  then K11=K004 /\ [#]((TOP-REAL 2)|K1) by A64,A79,XBOOLE_0:def 10;
  then A87: K11 is closed by A78,PRE_TOPC:43;
  A88: ((TOP-REAL 2)|K1)|K00=(TOP-REAL 2)|K001 by GOBOARD9:4;
      K1 c= D
   proof let x be set;assume x in K1;
     then consider p6 being Point of TOP-REAL 2 such that
     A89: p6=x & p6`2<=0 & p6<>0.REAL 2 by A1;
         x in the carrier of TOP-REAL 2 & not x in {0.REAL 2} by A89,
TARSKI:def 1;
    hence x in D by A1,XBOOLE_0:def 4;
   end;
  then D=K1 \/ D by XBOOLE_1:12;
  then A90: (TOP-REAL 2)|K1 is SubSpace of (TOP-REAL 2)|D by TOPMETR:5;
  the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
  then A91: f1= f3 by A1,FUNCT_1:82;
  f3 is continuous by A1,Th127;
  then A92: f1 is continuous by A88,A90,A91,TOPMETR:7;
  A93: ((TOP-REAL 2)|K1)|K11=(TOP-REAL 2)|K111 by GOBOARD9:4;
  the carrier of (TOP-REAL 2)|K1=K1 by PRE_TOPC:29;
  then A94: f2= f4 by A1,FUNCT_1:82;
  f4 is continuous by A1,Th128;
  then A95: f2 is continuous by A90,A93,A94,TOPMETR:7;
  A96: D<>{};
  A97: the carrier of (TOP-REAL 2)|B0=B0 by PRE_TOPC:29;
  for p being set st p in ([#]T1)/\([#]T2) holds f1.p = f2.p
   proof let p be set;
    assume p in ([#]T1)/\([#]T2);
     then A98: p in K00 & p in K11 by A62,A63,XBOOLE_0:def 3;
    hence f1.p=f.p by FUNCT_1:72 .=f2.p by A98,FUNCT_1:72;
   end;
  then consider h being Function of (TOP-REAL 2)|K1,(TOP-REAL 2)|D such that
  A99: h=f1+*f2 & h is continuous by A62,A63,A67,A77,A87,A92,A95,JGRAPH_2:9;
  A100: dom h=the carrier of ((TOP-REAL 2)|K1) by FUNCT_2:def 1;
  A101: the carrier of ((TOP-REAL 2)|K1)=K0 by PRE_TOPC:29;
  A102: K0=the carrier of ((TOP-REAL 2)|K0) by PRE_TOPC:29
  .=dom f by A96,A97,FUNCT_2:def 1;
      for y being set st y in dom h holds h.y=f.y
   proof let y be set;assume
    A103: y in dom h;
    per cases by A65,A100,A101,A103,XBOOLE_0:def 2;
    suppose A104: y in K00 & not y in K11;
      then y in dom f1 \/ dom f2 by A20,XBOOLE_0:def 2;
     hence h.y=f1.y by A43,A99,A104,FUNCT_4:def 1 .=f.y by A104,FUNCT_1:72;
    end;
    suppose A105: y in K11;
      then y in dom f1 \/ dom f2 by A43,XBOOLE_0:def 2;
     hence h.y=f2.y by A43,A99,A105,FUNCT_4:def 1 .=f.y by A105,FUNCT_1:72;
    end;
   end;
 hence thesis by A99,A100,A101,A102,FUNCT_1:9;
end;

theorem Th132:
  for cn being Real, K0,B0 being Subset of TOP-REAL 2,
  f being Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0 st
    -1<cn & cn<1 & f=(cn-FanMorphS)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} & K0={p: p`2>=0 & p<>0.REAL 2}
holds f is continuous
proof let cn be Real,K0,B0 be Subset of TOP-REAL 2,f be
Function of (TOP-REAL 2)|K0,(TOP-REAL 2)|B0;
assume A1:  -1<cn & cn<1 & f=(cn-FanMorphS)|K0 &
B0=(the carrier of TOP-REAL 2) \ {0.REAL 2} & K0={p: p`2>=0 & p<>0.REAL 2};
 set sn=sqrt(1-cn^2);
 set p0=|[cn,sn]|;
 A2: p0`2=sn by EUCLID:56;
       cn^2<1^2 by A1,SQUARE_1:120;
 then A3: 1-cn^2>0 by XREAL_1:52;
 then A4: sn>0 by SQUARE_1:93;
 A5: p0`2>0 by A2,A3,SQUARE_1:93;
     p0 in K0 by A1,A2,A4,JGRAPH_2:11;
then reconsider K1=K0 as non empty Subset of TOP-REAL 2;
     p0 in the carrier of TOP-REAL 2 & not p0 in {0.REAL 2}
               by A5,JGRAPH_2:11,TARSKI:def 1;
  then reconsider D=B0 as non empty Subset of TOP-REAL 2 by A1,XBOOLE_0:def 4;
   A6: K1 c= D
    proof let x be set;assume x in K1;
      then consider p2 being Point of TOP-REAL 2 such that
      A7: p2=x & p2`2>=0 & p2<>0.REAL 2 by A1;
          not p2 in {0.REAL 2} by A7,TARSKI:def 1;
     hence x in D by A1,A7,XBOOLE_0:def 4;
    end;
    for p being Point of (TOP-REAL 2)|K1,V being Subset of (TOP-REAL 2)|D
      st f.p in V & V is open holds
      ex W being Subset of (TOP-REAL 2)|K1 st
      p in W & W is open & f.:W c= V
    proof let p be Point of (TOP-REAL 2)|K1,V be Subset of (TOP-REAL 2)|D;
      assume A8: f.p in V & V is open;
      then consider V2 being Subset of TOP-REAL 2 such that
      A9: V2 is open & V2 /\ [#]((TOP-REAL 2)|D)=V by TOPS_2:32;
      A10: p in the carrier of (TOP-REAL 2)|K1;
      A11: [#]((TOP-REAL 2)|K1)=K1 by PRE_TOPC:def 10;
      reconsider W2=V2 /\ [#]((TOP-REAL 2)|K1) as Subset of (TOP-REAL 2)|
K1;
      A12: W2 is open by A9,TOPS_2:32;
      A13: f.p=(cn-FanMorphS).p by A1,A11,FUNCT_1:72;
      consider q being Point of TOP-REAL 2 such that
      A14: q=p & q`2>=0 & q <>0.REAL 2 by A1,A10,A11;
          (cn-FanMorphS).q=q by A14,Th120;
      then p in V2 & p in [#]((TOP-REAL 2)|D)
                       by A8,A9,A13,A14,XBOOLE_0:def 3;
      then A15: p in W2 by XBOOLE_0:def 3;
      f.:W2 c= V
       proof let y be set;assume y in f.:W2;
         then consider x being set such that
         A16: x in dom f & x in W2 & y=f.x by FUNCT_1:def 12;
         f is Function of (TOP-REAL 2)|K1,(TOP-REAL 2)|D;
         then dom f= K1 by A11,FUNCT_2:def 1;
         then consider p4 being Point of TOP-REAL 2 such that
         A17: x=p4 & p4`2>=0 & p4<>0.REAL 2 by A1,A16;
         A18: f.p4=(cn-FanMorphS).p4 by A1,A11,A16,A17,FUNCT_1:72
         .=p4 by A17,Th120;
A19:     p4 in V2 & p4 in [#]((TOP-REAL 2)|K1) by A16,A17,XBOOLE_0:def 3;
         then p4 in D by A6,A11;
         then p4 in [#]((TOP-REAL 2)|D) by PRE_TOPC:def 10;
        hence y in V by A9,A16,A17,A18,A19,XBOOLE_0:def 3;
       end;
     hence ex W being Subset of (TOP-REAL 2)|K1 st
      p in W & W is open & f.:W c= V by A12,A15;
    end;
  hence f is continuous by JGRAPH_2:20;
end;

theorem Th133: for cn being Real,
 B0 being Subset of TOP-REAL 2,K0 being Subset of
(TOP-REAL 2)|B0,f being Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0)
st -1<cn & cn<1 & f=(cn-FanMorphS)|K0 &
B0=(the carrier of TOP-REAL 2) \ {0.REAL 2}
& K0={p: p`2<=0 & p<>0.REAL 2}
holds f is continuous
proof let cn be Real,
 B0 be Subset of TOP-REAL 2,K0 be Subset of
(TOP-REAL 2)|B0,f be Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0);
assume A1:  -1<cn & cn<1 & f=(cn-FanMorphS)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2}
   & K0={p: p`2<=0 & p<>0.REAL 2 };
      the carrier of (TOP-REAL 2)|B0= B0 by PRE_TOPC:29;
  then reconsider K1=K0 as Subset of TOP-REAL 2 by XBOOLE_1:1;
      K0 c= B0
   proof let x be set;assume x in K0;
      then consider p8 being Point of TOP-REAL 2 such that
      A2: x=p8 & (p8`2<=0 & p8<>0.REAL 2) by A1;
         not x in {0.REAL 2} by A2,TARSKI:def 1;
    hence x in B0 by A1,A2,XBOOLE_0:def 4;
   end;
  then ((TOP-REAL 2)|B0)|K0=(TOP-REAL 2)|K1 by PRE_TOPC:28;
hence f is continuous by A1,Th131;
end;

theorem Th134: for cn being Real,
 B0 being Subset of TOP-REAL 2,K0 being Subset of
(TOP-REAL 2)|B0,f being Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0)
st -1<cn & cn<1 & f=(cn-FanMorphS)|K0 &
B0=(the carrier of TOP-REAL 2) \ {0.REAL 2}
& K0={p: p`2>=0 & p<>0.REAL 2}
holds f is continuous
proof let cn be Real,
 B0 be Subset of TOP-REAL 2,K0 be Subset of
(TOP-REAL 2)|B0,f be Function of ((TOP-REAL 2)|B0)|K0,((TOP-REAL 2)|B0);
 assume A1:  -1<cn & cn<1 & f=(cn-FanMorphS)|K0 &
  B0=(the carrier of TOP-REAL 2) \ {0.REAL 2}
  & K0={p: p`2>=0 & p<>0.REAL 2};
  the carrier of (TOP-REAL 2)|B0=B0 by PRE_TOPC:29;
  then reconsider K1=K0 as Subset of TOP-REAL 2 by XBOOLE_1:1;
  K0 c= B0
   proof let x be set;assume x in K0;
     then consider p8 being Point of TOP-REAL 2 such that
 A2: x=p8 & (p8`2>=0 & p8<>0.REAL 2) by A1;
     not x in {0.REAL 2} by A2,TARSKI:def 1;
    hence x in B0 by A1,A2,XBOOLE_0:def 4;
   end;
  then ((TOP-REAL 2)|B0)|K0=(TOP-REAL 2)|K1 by PRE_TOPC:28;
hence f is continuous by A1,Th132;
end;

theorem Th135: for cn being Real,p being Point of TOP-REAL 2
holds |.(cn-FanMorphS).p.|=|.p.|
proof let cn be Real,p be Point of TOP-REAL 2;
  set f=cn-FanMorphS;
  set z=f.p;
   set q=p;
   reconsider qz=z as Point of TOP-REAL 2;
   per cases;
   suppose A1: q`1/|.q.|>=cn & q`2<0;
     then (cn-FanMorphS).q= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
     |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by Th120;
     then A2: qz`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))&
        qz`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by EUCLID:56;
     |.q.|<>0 by A1,JGRAPH_2:11,TOPRNS_1:25;
     then A3: (|.q.|)^2>0 by SQUARE_1:74;
     A4: (q`1/|.q.|-cn)>=0 by A1,XREAL_1:50;
     A5: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
     0<=(q`2)^2 by XREAL_1:65;
     then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
     then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A3,A5,REAL_1:73;
     then (q`1)^2/(|.q.|)^2 <= 1 by A3,XCMPLX_1:60;
     then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
     then 1>=q`1/|.q.| by Lm2;
     then A6: 1-cn>=q`1/|.q.|-cn by XREAL_1:11;
     per cases;
     suppose A7: 1-cn=0;
       A8:((q`1/|.q.|-cn)/(1-cn))=(q`1/|.q.|-cn)*(1-cn)" by XCMPLX_0:def 9
        .= (q`1/|.q.|-cn)*0 by A7,XCMPLX_0:def 7 .=0;
       then 1-((q`1/|.q.|-cn)/(1-cn))^2=1;
        then (cn-FanMorphS).q= |[ |.q.|*0,|.q.|*(-1)]| by A1,A8,Th120,
SQUARE_1:83
       .=|[0,-(|.q.|)]|;
        then ((cn-FanMorphS).q)`2=(- |.q.|) & ((cn-FanMorphS).q)`1=0
                         by EUCLID:56;
       then |.(cn-FanMorphS).p.|=sqrt((-(|.q.|))^2+0) by JGRAPH_3:10
,SQUARE_1:60
       .=sqrt(((|.q.|))^2)
       .=|.q.| by SQUARE_1:89;
      hence |.(cn-FanMorphS).p.|=|.p.|;
     end;
     suppose A9: 1-cn<>0;
      per cases by A9;
       suppose A10: 1-cn>0;
         then A11: -(1-cn)<= -0 by XREAL_1:26;
         -(1-cn)<= -( q`1/|.q.|-cn) by A6,XREAL_1:26;
         then (-(1-cn))/(1-cn)<=(-( q`1/|.q.|-cn))/(1-cn)
           by A10,REAL_1:73;
         then A12: -1<=(-( q`1/|.q.|-cn))/(1-cn) by A10,XCMPLX_1:198;
         --(1-cn)>= -(q`1/|.q.|-cn) by A4,A11,XREAL_1:26;
         then (-(q`1/|.q.|-cn))/(1-cn)<=1 by A10,REAL_2:117;
         then ((-(q`1/|.q.|-cn))/(1-cn))^2<=1^2 by A12,SQUARE_1:119;
         then 1-((-(q`1/|.q.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
         then 1-(-((q`1/|.q.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
         then A13: 1-((q`1/|.q.|-cn)/(1-cn))^2>=0;
         A14: (qz`2)^2= (|.q.|)^2*(sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))^2 by A2
             .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1-cn))^2)
                       by A13,SQUARE_1:def 4;
         A15: (qz`1)^2= (|.q.|)^2*((q`1/|.q.|-cn)/(1-cn))^2
                    by A2;
         (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
          .=(|.q.|)^2 by A14,A15;
         then A16: sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
        thus |.(cn-FanMorphS).p.|=|.p.| by A16,SQUARE_1:89;
       end;
       suppose A17: 1-cn<0;
         A18: q`1/|.q.|-cn>=0 by A1,XREAL_1:50;
         0<(q`2)^2 by A1,SQUARE_1:74;
         then 0+(q`1)^2<(q`1)^2+(q`2)^2 by XREAL_1:10;
         then (q`1)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A3,A5,REAL_1:73;
         then (q`1)^2/(|.q.|)^2 < 1 by A3,XCMPLX_1:60;
         then ((q`1)/|.q.|)^2 < 1 by XCMPLX_1:77;
         then 1 > q`1/|.p.| by Lm3;
        hence |.(cn-FanMorphS).p.|=|.p.| by A17,A18,XREAL_1:11;
       end;
     end;
   end;
   suppose A19: q`1/|.q.|<cn & q`2<0;
     then A20:(cn-FanMorphS).q= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
     |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]| by Th121;
     then A21: qz`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))&
       qz`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by EUCLID:56;
     |.q.|<>0 by A19,JGRAPH_2:11,TOPRNS_1:25;
     then A22: (|.q.|)^2>0 by SQUARE_1:74;
     A23: (q`1/|.q.|-cn)<0 by A19,REAL_2:105;
     A24: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
     0<=(q`2)^2 by XREAL_1:65;
     then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
     then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A22,A24,REAL_1:73;
     then (q`1)^2/(|.q.|)^2 <= 1 by A22,XCMPLX_1:60;
     then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
     then -1<=q`1/|.q.| by Lm2;
     then A25: -1-cn<=q`1/|.q.|-cn by XREAL_1:11;
     per cases;
     suppose A26: 1+cn=0;
          ((q`1/|.q.|-cn)/(1+cn))=(q`1/|.q.|-cn)*(1+cn)" by XCMPLX_0:def 9
        .= (q`1/|.q.|-cn)*0 by A26,XCMPLX_0:def 7 .=0;
       then (cn-FanMorphS).q=|[0,-(|.q.|)]| by A20,SQUARE_1:83
;
        then ((cn-FanMorphS).q)`2=-(|.q.|) & ((cn-FanMorphS).q)`1=0
                         by EUCLID:56;
       then |.(cn-FanMorphS).p.|=sqrt((-(|.q.|))^2+0) by JGRAPH_3:10
,SQUARE_1:60
       .=sqrt(((|.q.|))^2)
       .=|.q.| by SQUARE_1:89;
      hence |.(cn-FanMorphS).p.|=|.p.|;
     end;
     suppose A27: 1+cn<>0;
     per cases by A27;
       suppose A28: 1+cn>0;
         then (-(1+cn))/(1+cn)<=(( q`1/|.q.|-cn))/(1+cn)
           by A25,REAL_1:73;
         then A29: -1<=(( q`1/|.q.|-cn))/(1+cn) by A28,XCMPLX_1:198;
         ((q`1/|.q.|-cn))/(1+cn)<=1 by A28,A23,REAL_2:117;
         then (((q`1/|.q.|-cn))/(1+cn))^2<=1 by A29,SQUARE_1:119,59;
         then A30: 1-(((q`1/|.q.|-cn))/(1+cn))^2>=0 by XREAL_1:50;
         A31: (qz`2)^2= (|.q.|)^2*(sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))^2 by A21
             .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1+cn))^2)
                       by A30,SQUARE_1:def 4;
         A32: (qz`1)^2= (|.q.|)^2*((q`1/|.q.|-cn)/(1+cn))^2
                    by A21;
             (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
          .=(|.q.|)^2 by A31,A32;
         then A33: sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
        thus |.(cn-FanMorphS).p.|=|.p.| by A33,SQUARE_1:89;
       end;
       suppose 1+cn<0;
         then A34: -(1+cn)>-0 by XREAL_1:26;
         0<(q`2)^2 by A19,SQUARE_1:74;
         then 0+(q`1)^2<(q`1)^2+(q`2)^2 by XREAL_1:10;
         then (q`1)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A22,A24,REAL_1:73;
         then (q`1)^2/(|.q.|)^2 < 1 by A22,XCMPLX_1:60;
         then ((q`1)/|.q.|)^2 < 1 by XCMPLX_1:77;
         then -1 < q`1/|.p.| by Lm3;
         then q`1/|.q.|-cn>-1-cn by XREAL_1:11;
        hence |.(cn-FanMorphS).p.|=|.p.| by A23,A34;
       end;
     end;
   end;
   suppose q`2>=0;
    hence |.(cn-FanMorphS).p.|=|.p.| by Th120;
   end;
end;

theorem Th136: for cn being Real,x,K0 being set st -1<cn & cn<1 & x in K0 &
 K0={p: p`2<=0 & p<>0.REAL 2}
holds (cn-FanMorphS).x in K0
proof let cn be Real,x,K0 be set;
 assume A1:  -1<cn & cn<1 & x in K0 & K0={p: p`2<=0 & p<>0.REAL 2};
  then consider p such that
A2: p=x & p`2<=0 & p<>0.REAL 2;
A3:now assume |.p.|<=0;
    then |.p.|=0;
   hence contradiction by A2,TOPRNS_1:25;
  end;
  then A4: (|.p.|)^2>0 by SQUARE_1:74;
  per cases;
  suppose A5: p`1/|.p.|<=cn;
   then A6: (cn-FanMorphS).p= |[ |.p.|*((p`1/|.p.|-cn)/(1+cn)),
   |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]| by A1,A2,Th122;
   reconsider p9= (cn-FanMorphS).p as Point of TOP-REAL 2;
A7: p9`2=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)) by A6,EUCLID:56;
A8: 1+cn>0 by A1,XREAL_1:150;
A9: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
    per cases;
     suppose p`2=0;
      hence (cn-FanMorphS).x in K0 by A1,A2,Th120;
     end;
     suppose p`2<>0;
       then 0<(p`2)^2 by SQUARE_1:74;
       then 0+(p`1)^2<(p`1)^2+(p`2)^2 by XREAL_1:10;
       then (p`1)^2/(|.p.|)^2 < (|.p.|)^2/(|.p.|)^2 by A4,A9,REAL_1:73;
       then (p`1)^2/(|.p.|)^2 < 1 by A4,XCMPLX_1:60;
       then A10: ((p`1)/|.p.|)^2 < 1 by XCMPLX_1:77;
       p`1/|.p.|-cn<=0 by A5,REAL_2:106;
       then A11: (p`1/|.p.|-cn)/(1+cn)<(1+cn)/(1+cn) by A8,REAL_1:73;
       -1 < p`1/|.p.| by A10,Lm3;
       then -1-cn< p`1/|.p.|-cn by XREAL_1:11;
       then (-1)*(1+cn)/(1+cn)< (p`1/|.p.|-cn)/(1+cn)
         by A8,REAL_1:73;
       then -1< (p`1/|.p.|-cn)/(1+cn) & (p`1/|.p.|-cn)/(1+cn)<1
         by A8,A11,XCMPLX_1:60,90;
       then 1^2> ((p`1/|.p.|-cn)/(1+cn))^2 by SQUARE_1:120;
       then 1-((p`1/|.p.|-cn)/(1+cn))^2>0 by XREAL_1:52;
       then --sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)>0 by SQUARE_1:93;
       then -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)<0 by XREAL_1:60;
       then |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))<0
         by A3,XREAL_1:134;
       hence (cn-FanMorphS).x in K0 by A1,A2,A7,JGRAPH_2:11;
      end;
  end;
  suppose A12: p`1/|.p.|>cn;
   then A13: (cn-FanMorphS).p= |[ |.p.|*((p`1/|.p.|-cn)/(1-cn)),
       |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]| by A1,A2,Th122;
   reconsider p9= (cn-FanMorphS).p as Point of TOP-REAL 2;
A14: p9`2=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)) by A13,EUCLID:56;
A15: 1-cn>0 by A1,XREAL_1:151;
A16: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
     per cases;
      suppose p`2=0;
       hence (cn-FanMorphS).x in K0 by A1,A2,Th120;
      end;
      suppose p`2<>0;
        then 0<(p`2)^2 by SQUARE_1:74;
        then 0+(p`1)^2<(p`1)^2+(p`2)^2 by XREAL_1:10;
        then (p`1)^2/(|.p.|)^2 < (|.p.|)^2/(|.p.|)^2 by A4,A16,REAL_1:73;
        then (p`1)^2/(|.p.|)^2 < 1 by A4,XCMPLX_1:60;
        then ((p`1)/|.p.|)^2 < 1 by XCMPLX_1:77;
        then p`1/|.p.|<1 by Lm3;
        then (p`1/|.p.|-cn)<1-cn by XREAL_1:11;
        then A17: (p`1/|.p.|-cn)/(1-cn)<(1-cn)/(1-cn) by A15,REAL_1:73;
   A18: -(1-cn)< -0 by A15,XREAL_1:26;
        p`1/|.p.|-cn>=cn-cn by A12,XREAL_1:11;
        then (-1)*(1-cn)/(1-cn)< (p`1/|.p.|-cn)/(1-cn)
          by A15,A18,REAL_1:73;
        then -1< (p`1/|.p.|-cn)/(1-cn) & (p`1/|.p.|-cn)/(1-cn)<1
          by A15,A17,XCMPLX_1:60,90;
        then 1> ((p`1/|.p.|-cn)/(1-cn))^2 by SQUARE_1:120,59;
        then 1-((p`1/|.p.|-cn)/(1-cn))^2>0 by XREAL_1:52;
        then --sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)>0 by SQUARE_1:93;
        then -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)<0 by XREAL_1:60;
        then p9`2<0 by A3,A14,XREAL_1:134;
       hence (cn-FanMorphS).x in K0 by A1,A2,JGRAPH_2:11;
      end;
    end;
end;

theorem Th137:
  for cn being Real,x,K0 being set st -1<cn & cn<1 & x in K0 &
    K0={p: p`2>=0 & p<>0.REAL 2} holds
      (cn-FanMorphS).x in K0
proof let cn be Real,x,K0 be set;
 assume A1: -1<cn & cn<1 & x in K0 & K0={p: p`2>=0 & p<>0.REAL 2};
 then consider p such that
A2: p=x & p`2>=0 & p<>0.REAL 2;
 thus (cn-FanMorphS).x in K0 by A1,A2,Th120;
end;

theorem Th138:for cn being Real,
 D being non empty Subset of TOP-REAL 2
st -1<cn & cn<1 & D`={0.REAL 2} holds
ex h being Function of (TOP-REAL 2)|D,(TOP-REAL 2)|D
st h=(cn-FanMorphS)|D & h is continuous
proof let cn be Real,D be non empty Subset of TOP-REAL 2;
assume A1:  -1<cn & cn<1 & D`={0.REAL 2};
  reconsider B0= {0.REAL 2} as Subset of TOP-REAL 2;
  A2: D =B0` by A1
     .=((the carrier of TOP-REAL 2)\ {0.REAL 2}) by SUBSET_1:def 5;
     defpred P[Point of TOP-REAL 2] means $1`2<=0;
    A3:{p: P[p] & p<>0.REAL 2} c= the carrier of (TOP-REAL 2)|D
           from InclSub(A2);
      A4: (|[0,-1]|)`1=0 & (|[0,-1]|)`2=-1 by EUCLID:56;
          |[0,-1]|<>0.REAL 2 by EUCLID:56,JGRAPH_2:11;
      then |[0,-1]| in {p where p is Point of TOP-REAL 2:
        p`2<=0 & p<>0.REAL 2} by A4;
      then reconsider K0={p:p`2<=0 & p<>0.REAL 2}
          as non empty Subset of (TOP-REAL 2)|D by A3;
          defpred P[Point of TOP-REAL 2] means $1`2>=0;
    A5:{p: P[p] & p<>0.REAL 2} c= the carrier of (TOP-REAL 2)|D
           from InclSub(A2);
     set Y1=|[0,1]|;
     Y1`1=0 & Y1`2=1 by EUCLID:56;
     then Y1 in {p where p is Point of TOP-REAL 2:
     p`2>=0 & p<>0.REAL 2} by JGRAPH_2:11;
  then reconsider K1={p: p`2>=0 & p<>0.REAL 2}
       as non empty Subset of (TOP-REAL 2)|D by A5;
   A6:the carrier of ((TOP-REAL 2)|D) =D by PRE_TOPC:29;
   A7:K0 c= (the carrier of TOP-REAL 2)
   proof let z be set;assume z in K0;
    then consider p8 being Point of TOP-REAL 2 such that
A8: p8=z & p8`2<=0 & p8<>0.REAL 2;
    thus z in (the carrier of TOP-REAL 2) by A8;
   end;
  A9:dom ((cn-FanMorphS)|K0)= dom ((cn-FanMorphS)) /\ K0 by FUNCT_1:68
       .=((the carrier of TOP-REAL 2)) /\ K0 by FUNCT_2:def 1
       .=K0 by A7,XBOOLE_1:28;
  A10: K0=the carrier of ((TOP-REAL 2)|D)|K0 by PRE_TOPC:29;
   rng ((cn-FanMorphS)|K0) c= the carrier of ((TOP-REAL 2)|D)|K0
   proof let y be set;assume y in rng ((cn-FanMorphS)|K0);
     then consider x being set such that
     A11:x in dom ((cn-FanMorphS)|K0)
     & y=((cn-FanMorphS)|K0).x by FUNCT_1:def 5;
     x in (dom (cn-FanMorphS)) /\ K0 by A11,FUNCT_1:68;
     then A12:x in K0 by XBOOLE_0:def 3;
     K0 c= the carrier of TOP-REAL 2 by A6,XBOOLE_1:1;
     then reconsider p=x as Point of TOP-REAL 2 by A12;
     (cn-FanMorphS).p=y by A11,A12,FUNCT_1:72;
     then y in K0 by A1,A12,Th136;
    hence y in the carrier of ((TOP-REAL 2)|D)|K0 by PRE_TOPC:29;
   end;
  then rng ((cn-FanMorphS)|K0)c= the carrier of ((TOP-REAL 2)|D)
                            by A10,XBOOLE_1:1;
  then reconsider f=(cn-FanMorphS)|K0 as Function of ((TOP-REAL 2)|D)|K0,
  ((TOP-REAL 2)|D)  by A9,A10,FUNCT_2:4;
   A13:K1 c= (the carrier of TOP-REAL 2)
   proof let z be set;assume z in K1;
    then consider p8 being Point of TOP-REAL 2 such that
A14:p8=z & p8`2>=0 & p8<>0.REAL 2;
    thus z in (the carrier of TOP-REAL 2) by A14;
   end;
  A15:dom ((cn-FanMorphS)|K1)= dom ((cn-FanMorphS)) /\ K1 by FUNCT_1:68
       .=((the carrier of TOP-REAL 2)) /\ K1 by FUNCT_2:def 1
       .=K1 by A13,XBOOLE_1:28;
  A16: K1=the carrier of ((TOP-REAL 2)|D)|K1 by PRE_TOPC:29;
   rng ((cn-FanMorphS)|K1) c= the carrier of ((TOP-REAL 2)|D)|K1
   proof let y be set;assume y in rng ((cn-FanMorphS)|K1);
     then consider x being set such that
     A17:x in dom ((cn-FanMorphS)|K1)
     & y=((cn-FanMorphS)|K1).x by FUNCT_1:def 5;
     x in (dom (cn-FanMorphS)) /\ K1 by A17,FUNCT_1:68;
     then A18:x in K1 by XBOOLE_0:def 3;
     K1 c= the carrier of TOP-REAL 2 by A6,XBOOLE_1:1;
     then reconsider p=x as Point of TOP-REAL 2 by A18;
     (cn-FanMorphS).p=y by A17,A18,FUNCT_1:72;
     then y in K1 by A1,A18,Th137;
    hence y in the carrier of ((TOP-REAL 2)|D)|K1 by PRE_TOPC:29;
   end;
  then rng ((cn-FanMorphS)|K1)c= the carrier of ((TOP-REAL 2)|D)
                     by A16,XBOOLE_1:1;
  then reconsider g=(cn-FanMorphS)|K1 as Function of ((TOP-REAL 2)|D)|K1,
  ((TOP-REAL 2)|D)  by A15,A16,FUNCT_2:4;
  A19:K0=[#](((TOP-REAL 2)|D)|K0) by PRE_TOPC:def 10;
  A20:K1=[#](((TOP-REAL 2)|D)|K1) by PRE_TOPC:def 10;
  A21:D= [#]((TOP-REAL 2)|D) by PRE_TOPC:def 10;
   D c= K0 \/ K1
   proof let x be set;assume A22: x in D;
     then A23:x in (the carrier of TOP-REAL 2) & not x in {0.REAL 2}
                                     by A2,XBOOLE_0:def 4;
     reconsider px=x as Point of TOP-REAL 2 by A22;
     px`2>=0 & px<>0.REAL 2 or
     px`2<=0 & px<>0.REAL 2 by A23,TARSKI:def 1;
     then x in K1 or x in K0;
    hence x in K0 \/ K1 by XBOOLE_0:def 2;
   end;
  then A24:([#](((TOP-REAL 2)|D)|K0)) \/ ([#](((TOP-REAL 2)|D)|K1))
  = [#]((TOP-REAL 2)|D) by A19,A20,A21,XBOOLE_0:def 10;
  A25: f is continuous & K0 is closed by A1,A2,Th70,Th133;
  A26: g is continuous & K1 is closed by A1,A2,Th69,Th134;
  A27: for x be set st x in ([#]((((TOP-REAL 2)|D)|K0)))
      /\ ([#] ((((TOP-REAL 2)|D)|K1))) holds f.x = g.x
   proof let x be set;assume x in ([#]((((TOP-REAL 2)|D)|K0)))
      /\ ([#] ((((TOP-REAL 2)|D)|K1)));
     then A28:x in K0 & x in K1 by A19,A20,XBOOLE_0:def 3;
     then f.x=(cn-FanMorphS).x by FUNCT_1:72;
    hence f.x = g.x by A28,FUNCT_1:72;
   end;
  then consider h being Function of (TOP-REAL 2)|D,(TOP-REAL 2)|D
  such that A29: h= f+*g & h is continuous
                          by A19,A20,A24,A25,A26,JGRAPH_2:9;
  A30:dom h=the carrier of ((TOP-REAL 2)|D) by FUNCT_2:def 1;
  A31:the carrier of ((TOP-REAL 2)|D)=D by PRE_TOPC:29;
  A32:the carrier of ((TOP-REAL 2)|D)
       =((the carrier of TOP-REAL 2)\ {0.REAL 2}) by A2,PRE_TOPC:29;
  dom (cn-FanMorphS)=(the carrier of (TOP-REAL 2))
                    by FUNCT_2:def 1;
  then A33:dom ((cn-FanMorphS)|D)=(the carrier of (TOP-REAL 2))/\ D
                    by FUNCT_1:68
              .=the carrier of ((TOP-REAL 2)|D) by A31,XBOOLE_1:28;
  A34:dom f=K0 by A10,FUNCT_2:def 1;
  A35:K0=[#](((TOP-REAL 2)|D)|K0) by PRE_TOPC:def 10;
  A36:dom g=K1 by A16,FUNCT_2:def 1;
     K1=[#](((TOP-REAL 2)|D)|K1) by PRE_TOPC:def 10;
  then A37: f tolerates g by A27,A34,A35,A36,PARTFUN1:def 6;
      for x being set st x in dom h holds h.x=((cn-FanMorphS)|D).x
   proof let x be set;assume A38: x in dom h;
     then x in (the carrier of TOP-REAL 2) & not x in {0.REAL 2}
                     by A2,A31,XBOOLE_0:def 4;
     then A39:x <>0.REAL 2 by TARSKI:def 1;
     reconsider p=x as Point of TOP-REAL 2 by A32,A38,XBOOLE_0:def 4;
     per cases;
     suppose A40:x in K0;
A41: (cn-FanMorphS)|D.p=(cn-FanMorphS).p by A31,A38,FUNCT_1:72
          .=f.p by A40,FUNCT_1:72;
           h.p=(g+*f).p by A29,A37,FUNCT_4:35
       .=f.p by A34,A40,FUNCT_4:14;
      hence h.x=(cn-FanMorphS)|D.x by A41;
     end;
     suppose not x in K0;
       then not p`2<=0 by A39;
       then A42:x in K1 by A39;
       (cn-FanMorphS)|D.p=(cn-FanMorphS).p by A31,A38,FUNCT_1:72
                           .=g.p by A42,FUNCT_1:72;
      hence h.x=(cn-FanMorphS)|D.x by A29,A36,A42,FUNCT_4:14;
     end;
   end;
  then f+*g=(cn-FanMorphS)|D by A29,A30,A33,FUNCT_1:9;
 hence thesis by A19,A20,A24,A25,A26,A27,JGRAPH_2:9;
end;

theorem Th139: for cn being Real
  st -1<cn & cn<1 holds cn-FanMorphS is continuous
proof let cn be Real;
 assume A1:  -1<cn & cn<1;
 reconsider f=cn-FanMorphS as Function of TOP-REAL 2,TOP-REAL 2;
 reconsider D=(the carrier of TOP-REAL 2) \{0.REAL 2}
   as non empty Subset of TOP-REAL 2 by JGRAPH_2:19;
 A2: f.(0.REAL 2)=0.REAL 2 by Th120,JGRAPH_2:11;
 A3: D`= {0.REAL 2} by JGRAPH_3:30;
 A4: for p being Point of (TOP-REAL 2)|D holds f.p<>f.(0.REAL 2)
  proof let p be Point of (TOP-REAL 2)|D;
    A5:[#]((TOP-REAL 2)|D)=D by PRE_TOPC:def 10;
    then A6:p in the carrier of TOP-REAL 2 & not p in {0.REAL 2}
                         by XBOOLE_0:def 4;
    reconsider q=p as Point of TOP-REAL 2 by A5,XBOOLE_0:def 4;
    A7:p<>0.REAL 2 by A6,TARSKI:def 1;
    per cases;
    suppose A8: q`1/|.q.|>=cn & q`2<=0;
      set q9= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
        |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]|;
      A9:q9`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)) &
      q9`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by EUCLID:56;
          now assume A10: q9=0.REAL 2;
       A11: |.q.|<>0 by A7,TOPRNS_1:25;
        then -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)= -sqrt(1-0) by A9,A10,
JGRAPH_2:11,SQUARE_1:60,XCMPLX_1:6
       .=-1 by SQUARE_1:83;
      hence contradiction by A9,A10,A11,JGRAPH_2:11,XCMPLX_1:6;
     end;
     hence f.p<>f.(0.REAL 2) by A1,A2,A7,A8,Th122;
    end;
    suppose A12: q`1/|.q.|<cn & q`2<=0;
     set q9=|[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
         |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]|;
A13: q9`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)) &
       q9`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by EUCLID:56;
     now assume A14: q9=0.REAL 2;
       A15: |.q.|<>0 by A7,TOPRNS_1:25;
        then -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)= -sqrt(1-0) by A13,A14,
JGRAPH_2:11,SQUARE_1:60,XCMPLX_1:6
       .=-1 by SQUARE_1:83;
      hence contradiction by A13,A14,A15,JGRAPH_2:11,XCMPLX_1:6;
     end;
     hence f.p<>f.(0.REAL 2) by A1,A2,A7,A12,Th122;
     end;
     suppose q`2>0; then f.p=p by Th120;
     hence f.p<>f.(0.REAL 2) by A7,Th120,JGRAPH_2:11;
    end;
  end;
 A16:ex h being Function of (TOP-REAL 2)|D,(TOP-REAL 2)|D
  st h=(cn-FanMorphS)|D & h is continuous by A1,A3,Th138;
     for V being Subset of (TOP-REAL 2) st f.(0.REAL 2) in V & V is open
 ex W being Subset of (TOP-REAL 2) st 0.REAL 2 in W
 & W is open & f.:W c= V
  proof let V be Subset of TOP-REAL 2;
    assume A17:f.(0.REAL 2) in V & V is open;
     reconsider u0=0.REAL 2 as Point of Euclid 2;
     consider r being real number such that
A18: r>0 & Ball(u0,r) c= V by A2,A17,TOPMETR:22;
     reconsider r as Real by XREAL_0:def 1;
     reconsider W1=Ball(u0,r) as Subset of TOP-REAL 2;
     A19:u0 in W1 by A18,GOBOARD6:4;
     A20:W1 is open by GOBOARD6:6;
     f.:W1 c= W1
      proof let z be set;assume z in f.:W1;
        then consider y being set such that
        A21: y in dom f & y in W1 & z=f.y by FUNCT_1:def 12;
        reconsider q=y as Point of TOP-REAL 2 by A21;
        reconsider qy=q as Point of Euclid 2;
        z in rng f by A21,FUNCT_1:def 5;
        then reconsider qz=z as Point of TOP-REAL 2;
        reconsider pz=qz as Point of Euclid 2;
        dist(u0,qy)<r by A21,METRIC_1:12;
        then A22: |.(0.REAL 2) - q.|<r by JGRAPH_1:45;
        per cases by JGRAPH_2:11;
        suppose q`2>=0;
         hence z in W1 by A21,Th120;
        end;
        suppose A23: q<>0.REAL 2 &
          (q`1/|.q.|>=cn & q`2<=0);
          then A24:(cn-FanMorphS).q= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)) ,
          |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by A1,Th122;
          |.q.|<>0 by A23,TOPRNS_1:25;
          then A25: (|.q.|)^2>0 by SQUARE_1:74;
        A26: 1-cn>0 by A1,XREAL_1:151;
        A27: qz`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))&
        qz`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by A21,A24,EUCLID:56;
        A28: (q`1/|.q.|-cn)>= 0 by A23,XREAL_1:50;
        A29: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        0<=(q`2)^2 by XREAL_1:65;
        then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A25,A29,REAL_1:73;
        then (q`1)^2/(|.q.|)^2 <= 1 by A25,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then 1>=q`1/|.q.| by Lm2;
        then A30: 1-cn>=q`1/|.q.|-cn by XREAL_1:11;
        A31: -(1-cn)<= -0 by A26,XREAL_1:26;
         -(1-cn)<= -( q`1/|.q.|-cn) by A30,XREAL_1:26;
         then (-(1-cn))/(1-cn)<=(-( q`1/|.q.|-cn))/(1-cn)
           by A26,REAL_1:73;
        then A32: -1<=(-( q`1/|.q.|-cn))/(1-cn) by A26,XCMPLX_1:198;
       --(1-cn)>= -(q`1/|.q.|-cn) by A28,A31,XREAL_1:26;
       then (-(q`1/|.q.|-cn))/(1-cn)<=1 by A26,REAL_2:117;
       then ((-(q`1/|.q.|-cn))/(1-cn))^2<=1^2 by A32,SQUARE_1:119;
       then 1-((-(q`1/|.q.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
       then 1-(-((q`1/|.q.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
       then A33: 1-((q`1/|.q.|-cn)/(1-cn))^2>=0;
        A34: (qz`2)^2= (|.q.|)^2*(sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))^2 by A27
         .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1-cn))^2) by A33,SQUARE_1:def 4;
        A35: (qz`1)^2= (|.q.|)^2*((q`1/|.q.|-cn)/(1-cn))^2
                         by A27;
        (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
        .=(|.q.|)^2 by A34,A35;
        then A36: sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
          A37: |.qz.|=|.q.| by A36,SQUARE_1:89;
          |.(0.REAL 2) +- q.|<r by A22,EUCLID:45;
          then |.- q.|<r by EUCLID:31;
          then |.q.|<r by TOPRNS_1:27;
          then |.- qz.|<r by A37,TOPRNS_1:27;
          then |.(0.REAL 2) +- qz.|<r by EUCLID:31;
          then |.(0.REAL 2) - qz.|<r by EUCLID:45;
          then dist(u0,pz)<r by JGRAPH_1:45;
         hence z in W1 by METRIC_1:12;
        end;
        suppose A38: q<>0.REAL 2 &
          q`1/|.q.|<cn & q`2<=0;
          then A39:(cn-FanMorphS).q= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
          |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]| by A1,Th122;
        |.q.|<>0 by A38,TOPRNS_1:25;
        then A40: (|.q.|)^2>0 by SQUARE_1:74;
        A41: (cn-q`1/|.q.|)>=0 by A38,XREAL_1:50;
        A42: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        A43: 1+cn>0 by A1,XREAL_1:150;
        A44: qz`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))&
        qz`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by A21,A39,EUCLID:56;
        0<=(q`2)^2 by XREAL_1:65;
        then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A40,A42,REAL_1:73;
        then (q`1)^2/(|.q.|)^2 <= 1 by A40,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then -1<=q`1/|.q.| by Lm2;
        then --1>=-q`1/|.q.| by XREAL_1:26;
        then A45: 1+cn>=-q`1/|.q.|+cn by XREAL_1:9;
        -(1+cn)<= -0 by A43,XREAL_1:26;
        then (-(1+cn))/(1+cn)<=(-( q`1/|.q.|-cn))/(1+cn) by A41,A43,REAL_1:73
;
        then A46: -1<=(-( q`1/|.q.|-cn))/(1+cn) by A43,XCMPLX_1:198;
        (-(q`1/|.q.|-cn))/(1+cn)<=1 by A43,A45,REAL_2:117;
       then ((-(q`1/|.q.|-cn))/(1+cn))^2<=1^2 by A46,SQUARE_1:119;
       then 1-((-(q`1/|.q.|-cn))/(1+cn))^2>=0 by XREAL_1:50;
       then 1-(-((q`1/|.q.|-cn))/(1+cn))^2>=0 by XCMPLX_1:188;
       then A47: 1-((q`1/|.q.|-cn)/(1+cn))^2>=0;
        A48: (qz`2)^2= (|.q.|)^2*(sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))^2 by A44
         .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1+cn))^2) by A47,SQUARE_1:def 4;
        A49: (qz`1)^2= (|.q.|)^2*((q`1/|.q.|-cn)/(1+cn))^2
                         by A44;
            (|.qz.|)^2=(qz`1)^2+(qz`2)^2 by JGRAPH_3:10
        .=(|.q.|)^2 by A48,A49;
        then A50: sqrt((|.qz.|)^2)=|.q.| by SQUARE_1:89;
          A51: |.qz.|=|.q.| by A50,SQUARE_1:89;
          |.(0.REAL 2) +- q.|<r by A22,EUCLID:45;
          then |.- q.|<r by EUCLID:31;
          then |.q.|<r by TOPRNS_1:27;
          then |.- qz.|<r by A51,TOPRNS_1:27;
          then |.(0.REAL 2) +- qz.|<r by EUCLID:31;
          then |.(0.REAL 2) - qz.|<r by EUCLID:45;
          then dist(u0,pz)<r by JGRAPH_1:45;
         hence z in W1 by METRIC_1:12;
        end;
      end;
     then f.:W1 c= V by A18,XBOOLE_1:1;
   hence ex W being Subset of (TOP-REAL 2) st 0.REAL 2 in W
       & W is open & f.:W c= V by A19,A20;
  end;
  then f is continuous by A2,A3,A4,A16,JGRAPH_3:13;
 hence thesis;
end;

theorem Th140:
  for cn being Real st -1<cn & cn<1 holds cn-FanMorphS is one-to-one
proof let cn be Real;
 assume A1: -1<cn & cn<1;
  for x1,x2 being set st x1 in dom (cn-FanMorphS) & x2 in dom (cn-FanMorphS)
   & (cn-FanMorphS).x1=(cn-FanMorphS).x2 holds x1=x2
  proof let x1,x2 be set;
   assume A2: x1 in dom (cn-FanMorphS) & x2 in dom (cn-FanMorphS)
    & (cn-FanMorphS).x1=(cn-FanMorphS).x2;
    then reconsider p1=x1 as Point of TOP-REAL 2;
    reconsider p2=x2 as Point of TOP-REAL 2 by A2;
    set q=p1,p=p2;
    A3: 1-cn>0 by A1,XREAL_1:151;
    per cases by JGRAPH_2:11;
    suppose A4: q`2>=0;
      then A5:(cn-FanMorphS).q=q by Th120;
      per cases by JGRAPH_2:11;
      suppose p`2>=0;
       hence x1=x2 by A2,A5,Th120;
      end;
      suppose A6:p<>0.REAL 2 & (p`1/|.p.|>=cn & p`2<=0);
        then A7:cn-FanMorphS.p= |[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
           |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]| by A1,Th122;
         set p4= |[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
           |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]|;
        A8: p4`2= |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)) &
          p4`1= |.p.|* ((p`1/|.p.|-cn)/(1-cn)) by EUCLID:56;
        A9: q`2=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)) &
          q`1=|.p.|* ((p`1/|.p.|-cn)/(1-cn)) by A2,A5,A7,EUCLID:56;
     A10: |.p.|<>0 by A6,TOPRNS_1:25;
     then A11: (|.p.|)^2>0 by SQUARE_1:74;
        A12: (p`1/|.p.|-cn)>=0 by A6,XREAL_1:50;
        A13: (p`1/|.p.|-cn)>= 0 by A6,XREAL_1:50;
        A14: (p`1/|.p.|-cn)/(1-cn)>=0 by A3,A12,REAL_2:125;
        A15: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
        0<=(p`2)^2 by XREAL_1:65;
        then 0+(p`1)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
        then (p`1)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by A11,A15,REAL_1:73;
        then (p`1)^2/(|.p.|)^2 <= 1 by A11,XCMPLX_1:60;
        then ((p`1)/|.p.|)^2 <= 1 by XCMPLX_1:77;
        then 1>=p`1/|.p.| by Lm2;
        then A16: 1-cn>=p`1/|.p.|-cn by XREAL_1:11;
        A17: -(1-cn)<= -0 by A3,XREAL_1:26;
         -(1-cn)<= -( p`1/|.p.|-cn) by A16,XREAL_1:26;
         then (-(1-cn))/(1-cn)<=(-( p`1/|.p.|-cn))/(1-cn) by A3,REAL_1:73;
        then A18: -1<=(-( p`1/|.p.|-cn))/(1-cn) by A3,XCMPLX_1:198;
       --(1-cn)>= -(p`1/|.p.|-cn) by A13,A17,XREAL_1:26;
       then (-(p`1/|.p.|-cn))/(1-cn)<=1 by A3,REAL_2:117;
       then ((-(p`1/|.p.|-cn))/(1-cn))^2<=1^2 by A18,SQUARE_1:119;
       then A19: 1-((-(p`1/|.p.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
       then 1-(-((p`1/|.p.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
       then A20: 1-((p`1/|.p.|-cn)/(1-cn))^2>=0;
       sqrt(1-((-(p`1/|.p.|-cn))/(1-cn))^2)>=0 by A19,SQUARE_1:def 4;
       then sqrt(1-(-(p`1/|.p.|-cn))^2/(1-cn)^2)>=0 by XCMPLX_1:77;
       then sqrt(1-(p`1/|.p.|-cn)^2/(1-cn)^2)>=0;
       then sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)>=0 by XCMPLX_1:77;
       then -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)<=0 by XREAL_1:60;
        then q`2=0 by A2,A4,A5,A7,A8,XREAL_1:133;
        then -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)=-0 by A9,A10,XCMPLX_1:6;
        then 1-((p`1/|.p.|-cn)/(1-cn))^2=0 by A20,SQUARE_1:92;
        then 1=0+((p`1/|.p.|-cn)/(1-cn))^2;
        then 1= (p`1/|.p.|-cn)/(1-cn) by A14,SQUARE_1:83,89;
        then 1 *(1-cn)=(p`1/|.p.|-cn) by A3,XCMPLX_1:88;
        then 1-cn+cn=p`1/|.p.|;
        then 1=p`1/|.p.|;
        then 1 *|.p.|=p`1 by A10,XCMPLX_1:88;
        then (p`1)^2-(p`1)^2 =(p`2)^2 by A15;
        then 0= (p`2)^2;
        then p`2=0 by XCMPLX_1:6;
       hence x1=x2 by A2,A5,Th120;
      end;
      suppose A21:p<>0.REAL 2 & (p`1/|.p.|<cn & p`2<=0);
        then A22:cn-FanMorphS.p= |[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
           |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]| by A1,Th122;
         set p4= |[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
           |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]|;
        A23: p4`2= |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)) &
          p4`1= |.p.|* ((p`1/|.p.|-cn)/(1+cn)) by EUCLID:56;
        A24: q`2=|.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)) &
          q`1=|.p.|* ((p`1/|.p.|-cn)/(1+cn)) by A2,A5,A22,EUCLID:56;
     A25: |.p.|<>0 by A21,TOPRNS_1:25;
     then A26: (|.p.|)^2>0 by SQUARE_1:74;
     A27: 1+cn>0 by A1,XREAL_1:150;
        A28: (p`1/|.p.|-cn)<=0 by A21,REAL_2:106;
        then A29: -(p`1/|.p.|-cn)>= -0 by XREAL_1:26;
        --(p`1/|.p.|-cn)/(1+cn)<=0 by A27,A28,REAL_2:126;
        then A30: -((p`1/|.p.|-cn)/(1+cn))>=0 by XREAL_1:60;
        A31: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
        0<=(p`2)^2 by XREAL_1:65;
        then 0+(p`1)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
        then (p`1)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by A26,A31,REAL_1:73;
        then (p`1)^2/(|.p.|)^2 <= 1 by A26,XCMPLX_1:60;
        then ((p`1)/|.p.|)^2 <= 1 by XCMPLX_1:77;
        then A32: (-((p`1)/|.p.|))^2 <= 1;
        -(1+cn)<= -0 by A27,XREAL_1:26;
        then (-(1+cn))/(1+cn)<=(-( p`1/|.p.|-cn))/(1+cn) by A27,A29,REAL_1:73;
        then A33: -1<=(-( p`1/|.p.|-cn))/(1+cn) by A27,XCMPLX_1:198;
       1>= -p`1/|.p.| by A32,Lm2;
       then (1+cn)>= -p`1/|.p.|+cn by XREAL_1:9;
       then (-(p`1/|.p.|-cn))/(1+cn)<=1 by A27,REAL_2:117;
       then ((-(p`1/|.p.|-cn))/(1+cn))^2<=1^2 by A33,SQUARE_1:119;
       then A34: 1-((-(p`1/|.p.|-cn))/(1+cn))^2>=0 by XREAL_1:50;
       then 1-(-((p`1/|.p.|-cn))/(1+cn))^2>=0 by XCMPLX_1:188;
       then A35: 1-((p`1/|.p.|-cn)/(1+cn))^2>=0;
       sqrt(1-((-(p`1/|.p.|-cn))/(1+cn))^2)>=0 by A34,SQUARE_1:def 4;
       then sqrt(1-(-(p`1/|.p.|-cn))^2/(1+cn)^2)>=0 by XCMPLX_1:77;
       then sqrt(1-((p`1/|.p.|-cn))^2/(1+cn)^2)>=0;
       then sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)>=0 by XCMPLX_1:77;
       then -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)<=0 by XREAL_1:60;
        then q`2=0 by A2,A4,A5,A22,A23,XREAL_1:133;
        then -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)=-0 by A24,A25,XCMPLX_1:6;
        then 1-((p`1/|.p.|-cn)/(1+cn))^2=0 by A35,SQUARE_1:92;
        then 1=0+((p`1/|.p.|-cn)/(1+cn))^2;
        then 1=(-((p`1/|.p.|-cn)/(1+cn)))^2;
        then 1= -((p`1/|.p.|-cn)/(1+cn)) by A30,SQUARE_1:83,89;
        then 1= ((-(p`1/|.p.|-cn))/(1+cn)) by XCMPLX_1:188;
        then 1 *(1+cn)=-(p`1/|.p.|-cn) by A27,XCMPLX_1:88;
        then (1+cn)=-p`1/|.p.|+cn;
        then 1+cn-cn=-p`1/|.p.|;
        then 1=-p`1/|.p.|;
        then 1=(-p`1)/|.p.| by XCMPLX_1:188;
        then 1 *|.p.|=-p`1 by A25,XCMPLX_1:88;
        then (-p`1)^2-(p`1)^2 =(p`2)^2 by A31,XCMPLX_1:26;
        then (p`1)^2-(p`1)^2 =(p`2)^2;
        then 0= (p`2)^2;
        then p`2=0 by XCMPLX_1:6;
       hence x1=x2 by A2,A5,Th120;
      end;
    end;
    suppose A36: q`1/|.q.|>=cn & q`2<=0 & q<>0.REAL 2;
    then A37: cn-FanMorphS.q= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
           |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by A1,Th122;
         set q4= |[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
           |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]|;
        A38: q4`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)) &
          q4`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by EUCLID:56;
     |.q.|<>0 by A36,TOPRNS_1:25;
     then A39: (|.q.|)^2>0 by SQUARE_1:74;
     per cases by JGRAPH_2:11;
      suppose A40: p`2>=0;
        then A41: (cn-FanMorphS).p=p by Th120;
        then A42: p`2=|.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)) &
        p`1=|.q.|* ((q`1/|.q.|-cn)/(1-cn)) by A2,A37,EUCLID:56;
        A43: |.q.|<>0 by A36,TOPRNS_1:25;
        then A44: (|.q.|)^2>0 by SQUARE_1:74;
A45:    1-cn>0 by A1,XREAL_1:151;
A46:    (q`1/|.q.|-cn)>=0 by A36,XREAL_1:50;
A47:    (q`1/|.q.|-cn)>= 0 by A36,XREAL_1:50;
A48:    (q`1/|.q.|-cn)/(1-cn)>=0 by A45,A46,REAL_2:125;
A49:    (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        0<=(q`2)^2 by XREAL_1:65;
        then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A44,A49,REAL_1:73;
        then (q`1)^2/(|.q.|)^2 <= 1 by A44,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then 1>=q`1/|.q.| by Lm2;
        then A50: 1-cn>=q`1/|.q.|-cn by XREAL_1:11;
  A51: -(1-cn)<= -0 by A45,XREAL_1:26;
       -(1-cn)<= -( q`1/|.q.|-cn) by A50,XREAL_1:26;
       then (-(1-cn))/(1-cn)<=(-( q`1/|.q.|-cn))/(1-cn) by A45,REAL_1:73;
       then A52: -1<=(-( q`1/|.q.|-cn))/(1-cn) by A45,XCMPLX_1:198;
       --(1-cn)>= -(q`1/|.q.|-cn) by A47,A51,XREAL_1:26;
       then (-(q`1/|.q.|-cn))/(1-cn)<=1 by A45,REAL_2:117;
       then ((-(q`1/|.q.|-cn))/(1-cn))^2<=1^2 by A52,SQUARE_1:119;
       then A53: 1-((-(q`1/|.q.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
       then 1-(-((q`1/|.q.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
       then A54: 1-((q`1/|.q.|-cn)/(1-cn))^2>=0;
       sqrt(1-((-(q`1/|.q.|-cn))/(1-cn))^2)>=0 by A53,SQUARE_1:def 4;
       then sqrt(1-(-(q`1/|.q.|-cn))^2/(1-cn)^2)>=0 by XCMPLX_1:77;
       then sqrt(1-(q`1/|.q.|-cn)^2/(1-cn)^2)>=0;
       then sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)>=0 by XCMPLX_1:77;
       then -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)<=0 by XREAL_1:60;
        then p`2=0 by A2,A37,A38,A40,A41,XREAL_1:133;
        then -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)=-0 by A42,A43,XCMPLX_1:6;
        then 1-((q`1/|.q.|-cn)/(1-cn))^2=0 by A54,SQUARE_1:92;
        then 1=0+((q`1/|.q.|-cn)/(1-cn))^2;
        then 1= (q`1/|.q.|-cn)/(1-cn) by A48,SQUARE_1:83,89;
        then 1 *(1-cn)=(q`1/|.q.|-cn) by A45,XCMPLX_1:88;
        then 1-cn+cn=q`1/|.q.|;
        then 1=q`1/|.q.|;
        then 1 *|.q.|=q`1 by A43,XCMPLX_1:88;
        then (q`1)^2-(q`1)^2 =(q`2)^2 by A49;
        then 0= (q`2)^2;
        then q`2=0 by XCMPLX_1:6;
       hence x1=x2 by A2,A41,Th120;
      end;
      suppose A55:p<>0.REAL 2 & (p`1/|.p.|>=cn & p`2<=0);
        then A56: cn-FanMorphS.p= |[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
           |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]| by A1,Th122;
        set p4= |[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
           |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]|;
        A57: p4`2= |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)) &
        p4`1= |.p.|* ((p`1/|.p.|-cn)/(1-cn)) by EUCLID:56;
        A58: q4`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))&
        q4`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by EUCLID:56;
        A59: (q`1/|.q.|-cn)>= 0 by A36,XREAL_1:50;
        A60: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        0<=(q`2)^2 by XREAL_1:65;
        then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A39,A60,REAL_1:73;
        then (q`1)^2/(|.q.|)^2 <= 1 by A39,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then 1>=q`1/|.q.| by Lm2;
        then A61: 1-cn>=q`1/|.q.|-cn by XREAL_1:11;
       A62: -(1-cn)<= -0 by A3,XREAL_1:26;
       -(1-cn)<= -( q`1/|.q.|-cn) by A61,XREAL_1:26;
       then (-(1-cn))/(1-cn)<=(-( q`1/|.q.|-cn))/(1-cn)
          by A3,REAL_1:73;
       then A63: -1<=(-( q`1/|.q.|-cn))/(1-cn) by A3,XCMPLX_1:198;
       --(1-cn)>= -(q`1/|.q.|-cn) by A59,A62,XREAL_1:26;
       then (-(q`1/|.q.|-cn))/(1-cn)<=1 by A3,REAL_2:117;
       then ((-(q`1/|.q.|-cn))/(1-cn))^2<=1^2 by A63,SQUARE_1:119;
       then 1-((-(q`1/|.q.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
       then 1-(-((q`1/|.q.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
       then A64: 1-((q`1/|.q.|-cn)/(1-cn))^2>=0;
        A65: (q4`2)^2= (|.q.|)^2*(sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))^2 by A58
         .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1-cn))^2) by A64,SQUARE_1:def 4;
        A66: (q4`1)^2= (|.q.|)^2*((q`1/|.q.|-cn)/(1-cn))^2
                         by A58;
            (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
        .=(|.q.|)^2 by A65,A66;
        then A67: sqrt((|.q4.|)^2)=|.q.| by SQUARE_1:89;
        then A68: |.q4.|=|.q.| by SQUARE_1:89;
        A69: |.p.|<>0 by A55,TOPRNS_1:25;
        then A70: (|.p.|)^2>0 by SQUARE_1:74;
        A71: (p`1/|.p.|-cn)>= 0 by A55,XREAL_1:50;
        A72: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
        0<=(p`2)^2 by XREAL_1:65;
        then 0+(p`1)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
        then (p`1)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by A70,A72,REAL_1:73;
        then (p`1)^2/(|.p.|)^2 <= 1 by A70,XCMPLX_1:60;
        then ((p`1)/|.p.|)^2 <= 1 by XCMPLX_1:77;
        then 1>=p`1/|.p.| by Lm2;
        then A73: 1-cn>=p`1/|.p.|-cn by XREAL_1:11;
        A74: -(1-cn)<= -0 by A3,XREAL_1:26;
             -(1-cn)<= -( p`1/|.p.|-cn) by A73,XREAL_1:26;
         then (-(1-cn))/(1-cn)<=(-( p`1/|.p.|-cn))/(1-cn)
                        by A3,REAL_1:73;
        then A75: -1<=(-( p`1/|.p.|-cn))/(1-cn) by A3,XCMPLX_1:198;
       --(1-cn)>= -(p`1/|.p.|-cn) by A71,A74,XREAL_1:26;
       then (-(p`1/|.p.|-cn))/(1-cn)<=1 by A3,REAL_2:117;
       then ((-(p`1/|.p.|-cn))/(1-cn))^2<=1^2 by A75,SQUARE_1:119;
       then 1-((-(p`1/|.p.|-cn))/(1-cn))^2>=0 by XREAL_1:50;
       then 1-(-((p`1/|.p.|-cn))/(1-cn))^2>=0 by XCMPLX_1:188;
       then A76: 1-((p`1/|.p.|-cn)/(1-cn))^2>=0;
        A77: (p4`2)^2= (|.p.|)^2*(sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))^2 by A57
         .= (|.p.|)^2*(1-((p`1/|.p.|-cn)/(1-cn))^2) by A76,SQUARE_1:def 4;
        A78: (p4`1)^2= (|.p.|)^2*((p`1/|.p.|-cn)/(1-cn))^2
                         by A57;
            (|.p4.|)^2=(p4`1)^2+(p4`2)^2 by JGRAPH_3:10
        .=(|.p.|)^2 by A77,A78;
        then A79: sqrt((|.p4.|)^2)=|.p.| by SQUARE_1:89;
        then A80: |.p4.|=|.p.| by SQUARE_1:89;
          ((p`1/|.p.|-cn)/(1-cn))
        =|.q.|* ((q`1/|.q.|-cn)/(1-cn))/|.p.| by A2,A37,A38,A56,A57,A69,
XCMPLX_1:90;
        then (p`1/|.p.|-cn)/(1-cn)=(q`1/|.q.|-cn)/(1-cn)
                              by A2,A37,A56,A67,A69,A79,XCMPLX_1:90;
        then (p`1/|.p.|-cn)/(1-cn)*(1-cn)=q`1/|.q.|-cn by A3,XCMPLX_1:88;
        then p`1/|.p.|-cn=q`1/|.q.|-cn by A3,XCMPLX_1:88;
        then p`1/|.p.|-cn+cn=q`1/|.q.|;
        then p`1/|.p.|=q`1/|.q.|;
        then p`1/|.p.|*|.p.|=q`1 by A2,A37,A56,A68,A69,A80,XCMPLX_1:88;
        then A81: p`1=q`1 by A69,XCMPLX_1:88;
        A82: |.p.|^2=(p`1)^2+(p`2)^2 by JGRAPH_3:10;
            |.q.|^2=(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        then (p`1)^2+(p`2)^2-(p`1)^2=(q`2)^2 by A2,A37,A56,A68,A80,A81,A82;
        then (p`2)^2=(q`2)^2;
        then (-p`2)^2=(q`2)^2;
        then A83: (-p`2)^2=(-q`2)^2;
        --q`2<=0 by A36;
        then A84: -q`2>=0 by XREAL_1:60;
        --p`2<=0 by A55; then -p`2>=0 by XREAL_1:60;
        then -p`2=sqrt((-q`2)^2) by A83,SQUARE_1:89;
        then A85: --p`2=--q`2 by A84,SQUARE_1:89;
            p=|[p`1,p`2]| by EUCLID:57;
       hence x1=x2 by A81,A85,EUCLID:57;
      end;
      suppose A86: p<>0.REAL 2 & (p`1/|.p.|<cn & p`2<=0);
        then A87: cn-FanMorphS.p= |[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
           |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]| by A1,Th122;
         set p4= |[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
           |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]|;
        A88: p4`2= |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)) &
         p4`1= |.p.|* ((p`1/|.p.|-cn)/(1+cn)) by EUCLID:56;
         A89: p`1/|.p.|-cn<0 by A86,REAL_2:105;
         1+cn>0 by A1,XREAL_1:150;
         then A90: ((p`1/|.p.|-cn)/(1+cn))<0 by A89,REAL_2:128;
        A91: |.p.|>=0;
         |.p.|<>0 by A86,TOPRNS_1:25;
         then A92: |.p.|* ((p`1/|.p.|-cn)/(1+cn))<0 by A90,A91,XREAL_1:134;
         A93: q`1/|.q.|-cn>=0 by A36,XREAL_1:50;
         1-cn>0 by A1,XREAL_1:151;
         then ((q`1/|.q.|-cn)/(1-cn))>=0 by A93,REAL_2:125;
       hence x1=x2 by A2,A37,A38,A87,A88,A92,REAL_2:121;
      end;
    end;
    suppose A94: q`1/|.q.|<cn & q`2<=0 & q<>0.REAL 2;
        then A95:cn-FanMorphS.q= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
           |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]| by A1,Th122;
         set q4= |[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
           |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]|;
        A96: q4`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)) &
          q4`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by EUCLID:56;
     A97: |.q.|<>0 by A94,TOPRNS_1:25;
     then A98: (|.q.|)^2>0 by SQUARE_1:74;
     per cases by JGRAPH_2:11;
      suppose A99: p`2>=0;
        then A100:(cn-FanMorphS).p=p by Th120;
        then A101: p`2=|.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)) &
          p`1=|.q.|* ((q`1/|.q.|-cn)/(1+cn)) by A2,A95,EUCLID:56;
        A102: 1+cn>0 by A1,XREAL_1:150;
        A103: (q`1/|.q.|-cn)<=0 by A94,REAL_2:106;
        then A104: -(q`1/|.q.|-cn)>= -0 by XREAL_1:26;
        --(q`1/|.q.|-cn)/(1+cn)<=0 by A102,A103,REAL_2:126;
        then A105: -((q`1/|.q.|-cn)/(1+cn))>=0 by XREAL_1:60;
        A106: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        0<=(q`2)^2 by XREAL_1:65;
        then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A98,A106,REAL_1:73;
        then (q`1)^2/(|.q.|)^2 <= 1 by A98,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then A107: (-((q`1)/|.q.|))^2 <= 1;
        -(1+cn)<= -0 by A102,XREAL_1:26;
        then (-(1+cn))/(1+cn)<=(-( q`1/|.q.|-cn))/(1+cn)
           by A102,A104,REAL_1:73;
        then A108: -1<=(-( q`1/|.q.|-cn))/(1+cn) by A102,XCMPLX_1:198;
        1>= -q`1/|.q.| by A107,Lm2;
       then (1+cn)>= -q`1/|.q.|+cn by XREAL_1:9;
       then (-(q`1/|.q.|-cn))/(1+cn)<=1 by A102,REAL_2:117;
       then ((-(q`1/|.q.|-cn))/(1+cn))^2<=1^2 by A108,SQUARE_1:119;
       then A109: 1-((-(q`1/|.q.|-cn))/(1+cn))^2>=0 by XREAL_1:50;
       then 1-(-((q`1/|.q.|-cn))/(1+cn))^2>=0 by XCMPLX_1:188;
       then A110: 1-((q`1/|.q.|-cn)/(1+cn))^2>=0;
       sqrt(1-((-(q`1/|.q.|-cn))/(1+cn))^2)>=0 by A109,SQUARE_1:def 4;
       then sqrt(1-(-(q`1/|.q.|-cn))^2/(1+cn)^2)>=0 by XCMPLX_1:77;
       then sqrt(1-((q`1/|.q.|-cn))^2/(1+cn)^2)>=0;
       then sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)>=0 by XCMPLX_1:77;
       then -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)<=0 by XREAL_1:60;
        then p`2=0 by A2,A95,A96,A99,A100,XREAL_1:133;
        then -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)=-0 by A97,A101,XCMPLX_1:6;
        then 1-((q`1/|.q.|-cn)/(1+cn))^2=0 by A110,SQUARE_1:92;
        then 1=0+((q`1/|.q.|-cn)/(1+cn))^2;
        then 1=(-((q`1/|.q.|-cn)/(1+cn)))^2;
        then 1= -((q`1/|.q.|-cn)/(1+cn)) by A105,SQUARE_1:83,89;
        then 1= ((-(q`1/|.q.|-cn))/(1+cn)) by XCMPLX_1:188;
        then 1 *(1+cn)=-(q`1/|.q.|-cn) by A102,XCMPLX_1:88;
        then 1+cn =-q`1/|.q.|+cn;
        then 1+cn-cn=-q`1/|.q.|;
        then 1=-q`1/|.q.|;
        then 1=(-q`1)/|.q.| by XCMPLX_1:188;
        then 1 *|.q.|=-q`1 by A97,XCMPLX_1:88;
        then (-q`1)^2-(q`1)^2 =(q`2)^2 by A106,XCMPLX_1:26;
        then (q`1)^2-(q`1)^2 =(q`2)^2;
        then 0= (q`2)^2;
        then q`2=0 by XCMPLX_1:6;
       hence x1=x2 by A2,A100,Th120;
      end;
      suppose A111:p<>0.REAL 2 & (p`1/|.p.|>=cn & p`2<=0);
        then A112: cn-FanMorphS.p= |[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
           |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]| by A1,Th122;
         set p4= |[ |.p.|* ((p`1/|.p.|-cn)/(1-cn)),
           |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2))]|;
        A113: p4`2= |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1-cn))^2)) &
          p4`1= |.p.|* ((p`1/|.p.|-cn)/(1-cn)) by EUCLID:56;
         A114: q`1/|.q.|-cn<0 by A94,REAL_2:105;
             1+cn>0 by A1,XREAL_1:150;
         then A115: ((q`1/|.q.|-cn)/(1+cn))<0 by A114,REAL_2:128;
        A116: |.q.|>=0;
            |.q.|<>0 by A94,TOPRNS_1:25;
         then A117: |.q.|* ((q`1/|.q.|-cn)/(1+cn))<0 by A115,A116,XREAL_1:134;
         A118: p`1/|.p.|-cn>=0 by A111,XREAL_1:50;
             1-cn>0 by A1,XREAL_1:151;
         then A119: ((p`1/|.p.|-cn)/(1-cn))>=0 by A118,REAL_2:125;
       thus x1=x2 by A2,A95,A96,A112,A113,A117,A119,REAL_2:121;
      end;
      suppose A120:p<>0.REAL 2 & (p`1/|.p.|<cn & p`2<=0);
        then A121: cn-FanMorphS.p= |[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
           |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]| by A1,Th122;
        set p4= |[ |.p.|* ((p`1/|.p.|-cn)/(1+cn)),
           |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))]|;
        A122: p4`2= |.p.|*( -sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2)) &
        p4`1= |.p.|* ((p`1/|.p.|-cn)/(1+cn)) by EUCLID:56;
        A123: q4`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))&
        q4`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by EUCLID:56;
        (q`1/|.q.|-cn)<=0 by A94,REAL_2:106;
        then A124: -(q`1/|.q.|-cn)>= -0 by XREAL_1:26;
        A125: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        0<=(q`2)^2 by XREAL_1:65;
        then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
        then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A98,A125,REAL_1:73;
        then (q`1)^2/(|.q.|)^2 <= 1 by A98,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
        then -1<=q`1/|.q.| by Lm2;
        then A126: -1-cn<=q`1/|.q.|-cn by XREAL_1:11;
        A127: 1+cn>0 by A1,XREAL_1:150;
        then -(1+cn)<= -0 by XREAL_1:26;
        then (-(1+cn))/(1+cn)<=(-( q`1/|.q.|-cn))/(1+cn)
                        by A124,A127,REAL_1:73;
        then A128: -1<=(-( q`1/|.q.|-cn))/(1+cn) by A127,XCMPLX_1:198;
         -(-1-cn)>= -(q`1/|.q.|-cn) by A126,XREAL_1:26;
       then (-(q`1/|.q.|-cn))/(1+cn)<=1 by A127,REAL_2:117;
       then ((-(q`1/|.q.|-cn))/(1+cn))^2<=1^2 by A128,SQUARE_1:119;
       then 1-((-(q`1/|.q.|-cn))/(1+cn))^2>=0 by XREAL_1:50;
       then 1-(-((q`1/|.q.|-cn))/(1+cn))^2>=0 by XCMPLX_1:188;
       then A129: 1-((q`1/|.q.|-cn)/(1+cn))^2>=0;
        A130: (q4`2)^2= (|.q.|)^2*(sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))^2 by A123
         .= (|.q.|)^2*(1-((q`1/|.q.|-cn)/(1+cn))^2) by A129,SQUARE_1:def 4;
        A131: (q4`1)^2= (|.q.|)^2*((q`1/|.q.|-cn)/(1+cn))^2
                         by A123;
            (|.q4.|)^2=(q4`1)^2+(q4`2)^2 by JGRAPH_3:10
        .=(|.q.|)^2 by A130,A131;
        then A132: sqrt((|.q4.|)^2)=|.q.| by SQUARE_1:89;
        then A133: |.q4.|=|.q.| by SQUARE_1:89;
        A134: |.p.|<>0 by A120,TOPRNS_1:25;
        then A135: (|.p.|)^2>0 by SQUARE_1:74;
            (p`1/|.p.|-cn)<=0 by A120,REAL_2:106;
        then A136: -(p`1/|.p.|-cn)>= -0 by XREAL_1:26;
        A137: (|.p.|)^2 =(p`1)^2+(p`2)^2 by JGRAPH_3:10;
            0<=(p`2)^2 by XREAL_1:65;
        then 0+(p`1)^2<=(p`1)^2+(p`2)^2 by XREAL_1:9;
        then (p`1)^2/(|.p.|)^2 <= (|.p.|)^2/(|.p.|)^2 by A135,A137,REAL_1:73;
        then (p`1)^2/(|.p.|)^2 <= 1 by A135,XCMPLX_1:60;
        then ((p`1)/|.p.|)^2 <= 1 by XCMPLX_1:77;
        then -1<=p`1/|.p.| by Lm2;
        then A138: -1-cn<=p`1/|.p.|-cn by XREAL_1:11;
            -(1+cn)<= -0 by A127,XREAL_1:26;
        then (-(1+cn))/(1+cn)<=(-( p`1/|.p.|-cn))/(1+cn)
                        by A127,A136,REAL_1:73;
        then A139: -1<=(-( p`1/|.p.|-cn))/(1+cn) by A127,XCMPLX_1:198;
         -(-1-cn)>= -(p`1/|.p.|-cn) by A138,XREAL_1:26;
       then (-(p`1/|.p.|-cn))/(1+cn)<=1 by A127,REAL_2:117;
       then ((-(p`1/|.p.|-cn))/(1+cn))^2<=1^2 by A139,SQUARE_1:119;
       then 1-((-(p`1/|.p.|-cn))/(1+cn))^2>=0 by XREAL_1:50;
       then 1-(-((p`1/|.p.|-cn))/(1+cn))^2>=0 by XCMPLX_1:188;
       then A140: 1-((p`1/|.p.|-cn)/(1+cn))^2>=0;
        A141: (p4`2)^2= (|.p.|)^2*(sqrt(1-((p`1/|.p.|-cn)/(1+cn))^2))^2 by A122
         .= (|.p.|)^2*(1-((p`1/|.p.|-cn)/(1+cn))^2)
                      by A140,SQUARE_1:def 4;
        A142: (p4`1)^2= (|.p.|)^2*((p`1/|.p.|-cn)/(1+cn))^2
                      by A122;
        (|.p4.|)^2=(p4`1)^2+(p4`2)^2 by JGRAPH_3:10
        .=(|.p.|)^2 by A141,A142;
        then A143: sqrt((|.p4.|)^2)=|.p.| by SQUARE_1:89;
        then A144: |.p4.|=|.p.| by SQUARE_1:89;
        ((p`1/|.p.|-cn)/(1+cn))
        =|.q.|* ((q`1/|.q.|-cn)/(1+cn))/|.p.| by A2,A95,A96,A121,A122,A134,
XCMPLX_1:90;
        then (p`1/|.p.|-cn)/(1+cn)=(q`1/|.q.|-cn)/(1+cn)
                        by A2,A95,A121,A132,A134,A143,XCMPLX_1:90;
        then (p`1/|.p.|-cn)/(1+cn)*(1+cn)=q`1/|.q.|-cn by A127,XCMPLX_1:88;
        then p`1/|.p.|-cn=q`1/|.q.|-cn by A127,XCMPLX_1:88;
        then p`1/|.p.|-cn+cn=q`1/|.q.|;
        then p`1/|.p.|=q`1/|.q.|;
        then p`1/|.p.|*|.p.|=q`1 by A2,A95,A121,A133,A134,A144,XCMPLX_1:88;
        then A145: p`1=q`1 by A134,XCMPLX_1:88;
        A146: |.p.|^2=(p`1)^2+(p`2)^2 by JGRAPH_3:10;
        |.q.|^2=(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        then (p`2)^2+(p`1)^2-(p`1)^2=(q`2)^2 by A2,A95,A121,A133,A144,A145
,A146;
        then (p`2)^2=(q`2)^2;
        then (-p`2)^2=(q`2)^2;
        then A147: (-p`2)^2=(-q`2)^2;
        --q`2<=0 by A94;
        then A148: -q`2>=0 by XREAL_1:60;
        --p`2<=0 by A120; then -p`2>=0 by XREAL_1:60;
        then -p`2=sqrt((-q`2)^2) by A147,SQUARE_1:89;
        then A149: --p`2=--q`2 by A148,SQUARE_1:89;
        p=|[p`1,p`2]| by EUCLID:57;
       hence x1=x2 by A145,A149,EUCLID:57;
      end;
    end;
  end;
 hence thesis by FUNCT_1:def 8;
end;

theorem Th141: for cn being Real
  st -1<cn & cn<1 holds
  (cn-FanMorphS) is Function of TOP-REAL 2,TOP-REAL 2 &
 rng (cn-FanMorphS) = the carrier of TOP-REAL 2
proof let cn be Real;
  assume A1:  -1<cn & cn<1;
  thus (cn-FanMorphS) is Function of TOP-REAL 2,TOP-REAL 2;
  for f being Function of TOP-REAL 2,TOP-REAL 2 st f=cn-FanMorphS holds
    rng (cn-FanMorphS)=the carrier of TOP-REAL 2
  proof let f be Function of TOP-REAL 2,TOP-REAL 2;
    assume A2:f=(cn-FanMorphS);
    A3:dom f=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
    the carrier of TOP-REAL 2 c= rng f
    proof let y be set;assume y in the carrier of TOP-REAL 2;
     then reconsider p2=y as Point of TOP-REAL 2;
     set q=p2;
     now per cases by JGRAPH_2:11;
     case q`2>=0;
      then q in dom (cn-FanMorphS) & y=(cn-FanMorphS).q by A2,A3,Th120;
      hence ex x being set st x in dom (cn-FanMorphS) & y=(cn-FanMorphS).x;
     end;
     case A4: q`1/|.q.|>=0 & q`2<=0 & q<>0.REAL 2;
        set px=|[ |.q.|*(q`1/|.q.|*(1-cn)+cn),
            -((|.q.|)*sqrt(1-(q`1/|.q.|*(1-cn)+cn)^2))]|;
A5:     px`2 = -(|.q.|)*sqrt(1-(q`1/|.q.|*(1-cn)+cn)^2) &
        px`1 = |.q.|*(q`1/|.q.|*(1-cn)+cn) by EUCLID:56;
        then A6: |.px.|^2=((- |.q.|)*sqrt(1-(q`1/|.q.|*(1-cn)+cn)^2))^2
        +(|.q.|*(q`1/|.q.|*(1-cn)+cn))^2 by JGRAPH_3:10
        .=(|.q.|)^2*(sqrt(1-(q`1/|.q.|*(1-cn)+cn)^2))^2
        +(|.q.|)^2*((q`1/|.q.|*(1-cn)+cn))^2;
       A7: |.q.|<>0 by A4,TOPRNS_1:25;
       1-cn>=0 by A1,XREAL_1:151;
       then A8: q`1/|.q.|*(1-cn)>=0 by A4,REAL_2:121;
       then A9: (q`1/|.q.|*(1-cn)+cn)>=0+cn by XREAL_1:9;
       A10: |.q.|>=0;
       A11: |.q.|^2>0 by A7,SQUARE_1:74;
       --(1+cn)>0 by A1,XREAL_1:150;then
       -(-1-cn)>0;
       then -1-cn<= q`1/|.q.|*(1-cn) by A8,XREAL_1:60;
       then A12: -1-cn+cn<= q`1/|.q.|*(1-cn)+cn by XREAL_1:9;
       A13: 1-cn>0 by A1,XREAL_1:151;
       A14: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
       0<=(q`2)^2 by XREAL_1:65;
       then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
       then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A11,A14,REAL_1:73;
       then (q`1)^2/(|.q.|)^2 <= 1 by A11,XCMPLX_1:60;
       then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
       then q`1/|.q.|<=1 by Lm2;
       then q`1/|.q.|*(1-cn) <=1 *(1-cn) by A13,XREAL_1:66;
       then q`1/|.q.|*(1-cn)+cn-cn <=1-cn;
       then (q`1/|.q.|*(1-cn)+cn) <=1 by XREAL_1:11;
       then 1^2>=(q`1/|.q.|*(1-cn)+cn)^2 by A12,SQUARE_1:119;
       then A15: 1-(q`1/|.q.|*(1-cn)+cn)^2>=0 by XREAL_1:50;
       then A16: |.px.|^2=(|.q.|)^2*(1-(q`1/|.q.|*(1-cn)+cn)^2)
        +(|.q.|)^2*((q`1/|.q.|*(1-cn)+cn))^2 by A6,SQUARE_1:def 4
        .= (|.q.|)^2;
        A17: |.px.|=sqrt(|.q.|^2) by A16,SQUARE_1:89
        .=|.q.| by SQUARE_1:89;
        then A18: |.px.|<>0 by A4,TOPRNS_1:25;
        sqrt(1-(q`1/|.q.|*(1-cn)+cn)^2)>=0 by A15,SQUARE_1:def 4;
       then (q`1/|.q.|*(1-cn)+cn)>=cn &
       (|.q.|)*sqrt(1-(q`1/|.q.|*(1-cn)+cn)^2)>=0 by A9,REAL_2:121;
        then px`1/|.px.| >=cn & px`2<=0 & px<>0.REAL 2
              by A5,A7,A17,XREAL_1:60,TOPRNS_1:24,XCMPLX_1:90;
    then A19: (cn-FanMorphS).px
       =|[ |.px.|* ((px`1/|.px.|-cn)/(1-cn)),
         |.px.|*( -sqrt(1-((px`1/|.px.|-cn)/(1-cn))^2))]| by A1,Th122;
        A20: |.px.|* ((px`1/|.px.|-cn)/(1-cn))
        =|.q.|* (( ((q`1/|.q.|*(1-cn)+cn))-cn)/(1-cn)) by A5,A7,A17,XCMPLX_1:90
        .=|.q.|* ( q`1/|.q.|) by A13,XCMPLX_1:90
        .= q`1 by A7,XCMPLX_1:88;
        then A21: |.px.|*( -sqrt(1-((px`1/|.px.|-cn)/(1-cn))^2))
           = |.px.|*( -sqrt(1-(q`1/|.px.|)^2)) by A18,XCMPLX_1:90
           .= |.px.|*( -sqrt(1-(q`1)^2/(|.px.|)^2)) by XCMPLX_1:77
           .= |.px.|*( -sqrt( (|.px.|)^2/(|.px.|)^2-(q`1)^2/(|.px.|)^2))
                            by A11,A16,XCMPLX_1:60
           .= |.px.|*( -sqrt( ((|.px.|)^2-(q`1)^2)/(|.px.|)^2))
                            by XCMPLX_1:121
           .= |.px.|*( -sqrt( ((q`1)^2+(q`2)^2-(q`1)^2)/(|.px.|)^2))
                            by A16,JGRAPH_3:10
           .= |.px.|*( -sqrt((q`2/|.q.|)^2)) by A17,XCMPLX_1:77;
         --(q`2/|.q.|)<=0 by A4,A7,A10,REAL_2:126;
         then -(q`2/|.q.|)>=0 by XREAL_1:60;
         then |.px.|*( sqrt((-(q`2/|.q.|))^2))=|.q.|*(-(q`2/|.q.|)) by A17,
SQUARE_1:89
         .= (-q`2)/|.q.|*|.q.| by XCMPLX_1:188
         .=-q`2 by A7,XCMPLX_1:88;
         then - |.px.|*( sqrt((-(q`2/|.q.|))^2))=q`2;
          then |.px.|*(- sqrt((-(q`2/|.q.|))^2))=q`2;
        then |.px.|*(- sqrt(((q`2/|.q.|))^2))=q`2;
        then A22:q=(cn-FanMorphS).px by A19,A20,A21,EUCLID:57;
        dom (cn-FanMorphS)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
      hence ex x being set st x in dom (cn-FanMorphS) & y=(cn-FanMorphS).x
                               by A22;
     end;
     case A23: q`1/|.q.|<0 & q`2<=0 & q<>0.REAL 2;
        set px=|[ |.q.|*(q`1/|.q.|*(1+cn)+cn),
            -(|.q.|)*(sqrt(1-(q`1/|.q.|*(1+cn)+cn)^2))]|;
        A24: px`2 = -(|.q.|)*sqrt(1-(q`1/|.q.|*(1+cn)+cn)^2) &
         px`1 = |.q.|*(q`1/|.q.|*(1+cn)+cn) by EUCLID:56;
        then A25: |.px.|^2=(-(|.q.|)*sqrt(1-(q`1/|.q.|*(1+cn)+cn)^2))^2
        +(|.q.|*(q`1/|.q.|*(1+cn)+cn))^2 by JGRAPH_3:10
        .=(|.q.|)^2*(sqrt(1-(q`1/|.q.|*(1+cn)+cn)^2))^2
        +(|.q.|)^2*((q`1/|.q.|*(1+cn)+cn))^2;
       A26: |.q.|<>0 by A23,TOPRNS_1:25;
       1+cn>=0 by A1,XREAL_1:150;
       then A27: q`1/|.q.|*(1+cn)<=0 by A23,XREAL_1:133;
       then A28: (q`1/|.q.|*(1+cn)+cn)<=0+cn by XREAL_1:9;
       A29: |.q.|>=0;
       A30: |.q.|^2>0 by A26,SQUARE_1:74;
       1-cn>0 by A1,XREAL_1:151;
       then A31: 1-cn+cn>= q`1/|.q.|*(1+cn)+cn by A27,XREAL_1:9;
       A32: 1+cn>0 by A1,XREAL_1:150;
       A33: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
       0<=(q`2)^2 by XREAL_1:65;
       then 0+(q`1)^2<=(q`1)^2+(q`2)^2 by XREAL_1:9;
       then (q`1)^2/(|.q.|)^2 <= (|.q.|)^2/(|.q.|)^2 by A30,A33,REAL_1:73;
       then (q`1)^2/(|.q.|)^2 <= 1 by A30,XCMPLX_1:60;
       then ((q`1)/|.q.|)^2 <= 1 by XCMPLX_1:77;
       then q`1/|.q.|>=-1 by Lm2;
       then q`1/|.q.|*(1+cn) >=(-1)*(1+cn) by A32,XREAL_1:66;
       then q`1/|.q.|*(1+cn)+cn-cn >=-1-cn;
       then (q`1/|.q.|*(1+cn)+cn) >=-1 by XREAL_1:11;
       then 1^2>=(q`1/|.q.|*(1+cn)+cn)^2 by A31,SQUARE_1:119;
       then A34: 1-(q`1/|.q.|*(1+cn)+cn)^2>=0 by XREAL_1:50;
       then A35: |.px.|^2=(|.q.|)^2*(1-(q`1/|.q.|*(1+cn)+cn)^2)
        +(|.q.|)^2*((q`1/|.q.|*(1+cn)+cn))^2 by A25,SQUARE_1:def 4
        .= (|.q.|)^2;
        A36: |.px.|=sqrt(|.q.|^2) by A35,SQUARE_1:89
        .=|.q.| by SQUARE_1:89;
        then A37: |.px.|<>0 by A23,TOPRNS_1:25;
        sqrt(1-(q`1/|.q.|*(1+cn)+cn)^2)>=0 by A34,SQUARE_1:def 4;
        then -sqrt(1-(q`1/|.q.|*(1+cn)+cn)^2)<=0 by XREAL_1:60;
       then (q`1/|.q.|*(1+cn)+cn)<=cn &
       (|.q.|)*(-sqrt(1-(q`1/|.q.|*(1+cn)+cn)^2))<=0 by A28,XREAL_1:133;
        then px`1/|.px.| <=cn & px`2<=0 & px<>0.REAL 2
                           by A24,A36,A37,TOPRNS_1:24,XCMPLX_1:90;
    then A38: (cn-FanMorphS).px
       =|[ |.px.|* ((px`1/|.px.|-cn)/(1+cn)),
         |.px.|*( -sqrt(1-((px`1/|.px.|-cn)/(1+cn))^2))]| by A1,Th122;
        A39: |.px.|* ((px`1/|.px.|-cn)/(1+cn))
        =|.q.|* (( ((q`1/|.q.|*(1+cn)+cn))-cn)/(1+cn)) by A24,A26,A36,
XCMPLX_1:90
        .=|.q.|* ( q`1/|.q.|) by A32,XCMPLX_1:90
        .= q`1 by A26,XCMPLX_1:88;
        then A40: |.px.|*( -sqrt(1-((px`1/|.px.|-cn)/(1+cn))^2))
           = |.px.|*( -sqrt(1-(q`1/|.px.|)^2)) by A37,XCMPLX_1:90
           .= |.px.|*( -sqrt(1-(q`1)^2/(|.px.|)^2)) by XCMPLX_1:77
           .= |.px.|*( -sqrt( (|.px.|)^2/(|.px.|)^2-(q`1)^2/(|.px.|)^2))
                            by A30,A35,XCMPLX_1:60
           .= |.px.|*( -sqrt( ((|.px.|)^2-(q`1)^2)/(|.px.|)^2))
                            by XCMPLX_1:121
           .= |.px.|*( -sqrt( ((q`1)^2+(q`2)^2-(q`1)^2)/(|.px.|)^2))
                            by A35,JGRAPH_3:10
           .= |.px.|*( -sqrt((q`2/|.q.|)^2)) by A36,XCMPLX_1:77;
         --q`2/|.q.|<=0 by A23,A26,A29,REAL_2:126;
         then A41: -q`2/|.q.|>=0 by XREAL_1:60;
         |.px.|*( -sqrt((q`2/|.q.|)^2))
          = |.px.|*( -sqrt((-q`2/|.q.|)^2))
         .=|.px.|*(--(q`2/|.q.|)) by A41,SQUARE_1:89
         .=q`2 by A26,A36,XCMPLX_1:88;
        then A42:q=(cn-FanMorphS).px by A38,A39,A40,EUCLID:57;
            dom (cn-FanMorphS)=the carrier of TOP-REAL 2 by FUNCT_2:def 1;
      hence ex x being set st x in dom (cn-FanMorphS) & y=(cn-FanMorphS).x
                               by A42;
     end;
     end;
    hence y in rng f by A2,FUNCT_1:def 5;
   end;
   hence rng (cn-FanMorphS)=the carrier of TOP-REAL 2 by A2,XBOOLE_0:def 10;
  end;
 hence thesis;
end;

theorem Th142: for cn being Real,p2 being Point of TOP-REAL 2
  st -1<cn & cn<1
  ex K being non empty compact Subset of TOP-REAL 2 st
  K = (cn-FanMorphS).:K &
 (ex V2 being Subset of TOP-REAL 2 st
  p2 in V2 & V2 is open & V2 c= K & (cn-FanMorphS).p2 in V2)
 proof let cn be Real,p2 be Point of TOP-REAL 2;
  assume A1: -1<cn & cn<1;
    reconsider O=0.REAL 2 as Point of Euclid 2;
    reconsider V0=Ball(O,|.p2.|+1) as Subset of TOP-REAL 2;
A2: |. p2.|<|.p2.|+1 by XREAL_1:31;
    A3: O in V0 by GOBOARD6:4;
A4: V0 c= cl_Ball(O,|.p2.|+1) by METRIC_1:15;
    reconsider K01=cl_Ball(O,|.p2.|+1) as Subset of TOP-REAL 2;
    K01 is compact by Th22;
    then reconsider K0=cl_Ball(O,|.p2.|+1)
      as non empty compact Subset of TOP-REAL 2 by A3,A4;
    reconsider u2=p2 as Point of Euclid 2;
A5: (cn-FanMorphS).:K0 c= K0
     proof let y be set;assume y in (cn-FanMorphS).:K0;
       then consider x being set such that
A6:    x in dom (cn-FanMorphS) & x in K0 & y=(cn-FanMorphS).x
                     by FUNCT_1:def 12;
       reconsider q=x as Point of TOP-REAL 2 by A6;
       reconsider uq=q as Point of Euclid 2;
A7:    y in rng (cn-FanMorphS) by A6,FUNCT_1:def 5;
       then reconsider u=y as Point of Euclid 2;
       reconsider q4=y as Point of TOP-REAL 2 by A7;
A8:   |.q4.|=|.q.| by A6,Th135;
       dist(O,uq)<= |.p2.|+1 by A6,METRIC_1:13;
       then |.0.REAL 2 - q.|<= |.p2.|+1 by JGRAPH_1:45;
       then |.0.REAL 2 +- q.|<= |.p2.|+1 by EUCLID:45;
       then |. -q.|<= |.p2.|+1 by EUCLID:31;
       then |.q.|<= |.p2.|+1 by TOPRNS_1:27;
       then |. -q4.|<= |.p2.|+1 by A8,TOPRNS_1:27;
       then |.0.REAL 2 +- q4.|<= |.p2.|+1 by EUCLID:31;
       then |.0.REAL 2 - q4.|<= |.p2.|+1 by EUCLID:45;
       then dist(O,u)<= |.p2.|+1 by JGRAPH_1:45;
      hence y in K0 by METRIC_1:13;
     end;
     K0 c= (cn-FanMorphS).:K0
     proof let y be set;assume A9: y in K0;
       then reconsider u=y as Point of Euclid 2;
       reconsider q4=y as Point of TOP-REAL 2 by A9;
       the carrier of TOP-REAL 2 c= rng (cn-FanMorphS) by A1,Th141;
       then q4 in rng (cn-FanMorphS) by TARSKI:def 3;
       then consider x being set such that
A10:   x in dom (cn-FanMorphS) & y=(cn-FanMorphS).x by FUNCT_1:def 5;
       reconsider q=x as Point of TOP-REAL 2 by A10;
       reconsider uq=q as Point of Euclid 2;
A11:   |.q4.|=|.q.| by A10,Th135;
       q in K0 by A9,A11,Lm13;
      hence y in (cn-FanMorphS).:K0 by A10,FUNCT_1:def 12;
     end;
    then A12: K0= (cn-FanMorphS).:K0 by A5,XBOOLE_0:def 10;
    |. -p2.|<|.p2.|+1 by A2,TOPRNS_1:27;
    then |.0.REAL 2 +- p2.|<|.p2.|+1 by EUCLID:31;
    then |.0.REAL 2 - p2.|<|.p2.|+1 by EUCLID:45;
    then dist(O,u2)<|.p2.|+1 by JGRAPH_1:45;
    then A13: p2 in V0 by METRIC_1:12;
A14: V0 is open by TOPMETR:21;
    set q3= (cn-FanMorphS).p2;
    reconsider u3=q3 as Point of Euclid 2;
    |.q3.|=|.p2.| by Th135;
    then |.-q3.|<|.p2.|+1 by A2,TOPRNS_1:27;
    then |.0.REAL 2 +- q3.|<|.p2.|+1 by EUCLID:31;
    then |.0.REAL 2 - q3.|<|.p2.|+1 by EUCLID:45;
    then dist(O,u3)< |.p2.|+1 by JGRAPH_1:45;
    then (cn-FanMorphS).p2 in V0 by METRIC_1:12;
   hence thesis by A4,A12,A13,A14;
 end;

theorem
  for cn being Real st -1<cn & cn<1
 ex f being Function of TOP-REAL 2,TOP-REAL 2 st f=cn-FanMorphS
   & f is_homeomorphism
proof let cn be Real;assume A1: -1<cn & cn<1;
  then A2: cn-FanMorphS is Function of TOP-REAL 2,TOP-REAL 2 &
  rng (cn-FanMorphS) = the carrier of TOP-REAL 2 by Th141;
  set f=cn-FanMorphS;
A3: cn-FanMorphS is continuous by A1,Th139;
A4: f is one-to-one by A1,Th140;
A5: rng f=[#](TOP-REAL 2) by A2;
  for p2 being Point of TOP-REAL 2
  ex K being non empty compact Subset of TOP-REAL 2 st K = f.:K &
 (ex V2 being Subset of TOP-REAL 2 st
  p2 in V2 & V2 is open & V2 c= K & f.p2 in V2) by A1,Th142;
  then f is_homeomorphism by A3,A4,A5,Th8;
 hence thesis;
end;

theorem Th144:
 for cn being Real,q being Point of TOP-REAL 2 st -1<cn & cn<1 & q`2<0
 & q`1/|.q.|>=cn holds (for p being Point of TOP-REAL 2 st
 p=(cn-FanMorphS).q holds p`2<0 & p`1>=0)
 proof let cn be Real,q be Point of TOP-REAL 2;
   assume A1: -1<cn & cn<1 & q`2<0 & q`1/|.q.|>=cn;
A2: |.q.|>=0;
   let p be Point of TOP-REAL 2;
    assume p=(cn-FanMorphS).q;
    then A3: p=|[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
     |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by A1,Th120;
      set qz=p;
      A4: |.q.|<>0 by A1,JGRAPH_2:11,TOPRNS_1:25;
      then A5: (|.q.|)^2>0 by SQUARE_1:74;
    A6: 1-cn>0 by A1,XREAL_1:151;
        A7: qz`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))&
        qz`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by A3,EUCLID:56;
        A8: (q`1/|.q.|-cn)>= 0 by A1,XREAL_1:50;
        A9: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
        0<(q`2)^2 by A1,SQUARE_1:74;
        then 0+(q`1)^2<(q`1)^2+(q`2)^2 by XREAL_1:10;
        then (q`1)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A5,A9,REAL_1:73;
        then (q`1)^2/(|.q.|)^2 < 1 by A5,XCMPLX_1:60;
        then ((q`1)/|.q.|)^2 < 1 by XCMPLX_1:77;
        then 1>q`1/|.q.| by Lm3;
        then A10: 1-cn>q`1/|.q.|-cn by XREAL_1:11;
  A11: -(1-cn)< -0 by A6,XREAL_1:26;
       -(1-cn)< -( q`1/|.q.|-cn) by A10,XREAL_1:26;
       then (-(1-cn))/(1-cn)<(-( q`1/|.q.|-cn))/(1-cn) by A6,REAL_1:73;
       then A12: -1<(-( q`1/|.q.|-cn))/(1-cn) by A6,XCMPLX_1:198;
       --(1-cn)> -(q`1/|.q.|-cn) by A8,A11,XREAL_1:26;
       then (-(q`1/|.q.|-cn))/(1-cn)<1 by A6,REAL_2:118;
       then ((-(q`1/|.q.|-cn))/(1-cn))^2<1^2 by A12,SQUARE_1:120;
       then A13: -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)< 0 by Lm14;
       ((q`1/|.q.|-cn)/(1-cn))>=0 by A6,A8,XREAL_1:138;
   hence thesis by A2,A4,A7,A13,XREAL_1:129,134;
 end;

theorem Th145:
 for cn being Real,q being Point of TOP-REAL 2 st -1<cn & cn<1 & q`2<0
 & q`1/|.q.|<cn holds (for p being Point of TOP-REAL 2 st
 p=(cn-FanMorphS).q holds p`2<0 & p`1<0)
 proof let cn be Real,q be Point of TOP-REAL 2;
  assume A1: -1<cn & cn<1 & q`2<0 & q`1/|.q.|<cn;
  A2: |.q.|>=0;
  let p be Point of TOP-REAL 2;
    assume p=(cn-FanMorphS).q;
    then A3: p=|[ |.q.|* ((q`1/|.q.|-cn)/(1+cn)),
      |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))]| by A1,Th121;
      set qz=p;
  A4: |.q.|<>0 by A1,JGRAPH_2:11,TOPRNS_1:25;
      then A5: (|.q.|)^2>0 by SQUARE_1:74;
  A6: (q`1/|.q.|-cn)< 0 by A1,REAL_2:105;
  A7: 1+cn>0 by A1,XREAL_1:150;
  A8: qz`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2))&
      qz`1= |.q.|* ((q`1/|.q.|-cn)/(1+cn)) by A3,EUCLID:56;
  A9: (|.q.|)^2 =(q`1)^2+(q`2)^2 by JGRAPH_3:10;
      0<(q`2)^2 by A1,SQUARE_1:74;
      then 0+(q`1)^2<(q`1)^2+(q`2)^2 by XREAL_1:10;
      then (q`1)^2/(|.q.|)^2 < (|.q.|)^2/(|.q.|)^2 by A5,A9,REAL_1:73;
      then (q`1)^2/(|.q.|)^2 < 1 by A5,XCMPLX_1:60;
      then ((q`1)/|.q.|)^2 < 1 by XCMPLX_1:77;
      then -1<q`1/|.q.| by Lm3;
      then -1-cn<q`1/|.q.|-cn by XREAL_1:11;
      then -(1+cn) < (q`1/|.q.|-cn);
      then A10: --(1+cn)> -(q`1/|.q.|-cn) by XREAL_1:26;
 A11: -( q`1/|.q.|-cn)>0 by A6,XREAL_1:60;
      -(1+cn)< -0 by A7,XREAL_1:26;
      then (-(1+cn))/(1+cn)<(-( q`1/|.q.|-cn))/(1+cn) by A11,A7,REAL_1:73;
      then A12: -1<(-( q`1/|.q.|-cn))/(1+cn) by A7,XCMPLX_1:198;
      (-(q`1/|.q.|-cn))/(1+cn)<1 by A7,A10,REAL_2:118;
      then ((-(q`1/|.q.|-cn))/(1+cn))^2<1^2 by A12,SQUARE_1:120;
      then 1-((-(q`1/|.q.|-cn))/(1+cn))^2>0 by XREAL_1:52;
      then sqrt(1-((-(q`1/|.q.|-cn))/(1+cn))^2)>0 by SQUARE_1:93;
      then sqrt(1-(-(q`1/|.q.|-cn))^2/(1+cn)^2)> 0 by XCMPLX_1:77;
      then sqrt(1-(q`1/|.q.|-cn)^2/(1+cn)^2)> 0;
      then --sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)> 0 by XCMPLX_1:77;
      then A13: -sqrt(1-((q`1/|.q.|-cn)/(1+cn))^2)< 0 by XREAL_1:60;
      ((q`1/|.q.|-cn)/(1+cn))<0 by A6,A7,REAL_2:128;
   hence thesis by A2,A4,A8,A13,XREAL_1:134;
 end;

theorem Th146:
 for cn being Real,q1,q2 being Point of TOP-REAL 2 st -1<cn & cn<1 & q1`2<0
 & q1`1/|.q1.|>=cn & q2`2<0 & q2`1/|.q2.|>=cn & q1`1/|.q1.|<q2`1/|.q2.|
 holds (for p1,p2 being Point of TOP-REAL 2 st
 p1=(cn-FanMorphS).q1 & p2=(cn-FanMorphS).q2 holds p1`1/|.p1.|<p2`1/|.p2.|)
 proof let cn be Real,q1,q2 be Point of TOP-REAL 2;
  assume A1: -1<cn & cn<1 & q1`2<0
   & q1`1/|.q1.|>=cn & q2`2<0 & q2`1/|.q2.|>=cn & q1`1/|.q1.|<q2`1/|.q2.|;
  let p1,p2 be Point of TOP-REAL 2;
   assume A2: p1=(cn-FanMorphS).q1 & p2=(cn-FanMorphS).q2;
    then p1=|[ |.q1.|* ((q1`1/|.q1.|-cn)/(1-cn)),
    |.q1.|*( -sqrt(1-((q1`1/|.q1.|-cn)/(1-cn))^2))]| by A1,Th120;
    then A3: p1`2= |.q1.|*( -sqrt(1-((q1`1/|.q1.|-cn)/(1-cn))^2))&
       p1`1= |.q1.|* ((q1`1/|.q1.|-cn)/(1-cn)) by EUCLID:56;
    p2=|[ |.q2.|* ((q2`1/|.q2.|-cn)/(1-cn)),
      |.q2.|*( -sqrt(1-((q2`1/|.q2.|-cn)/(1-cn))^2))]| by A1,A2,Th120;
    then A4: p2`2= |.q2.|*( -sqrt(1-((q2`1/|.q2.|-cn)/(1-cn))^2))&
    p2`1= |.q2.|* ((q2`1/|.q2.|-cn)/(1-cn)) by EUCLID:56;
    A5: |.q1.|>0 & |.q2.|>0 by A1,Lm1,JGRAPH_2:11;
    A6: |.p1.|=|.q1.| & |.p2.|=|.q2.| by A2,Th135;
    then A7: p1`1/|.p1.|= ((q1`1/|.q1.|-cn)/(1-cn)) by A3,A5,XCMPLX_1:90;
    A8: p2`1/|.p2.|= ((q2`1/|.q2.|-cn)/(1-cn)) by A4,A5,A6,XCMPLX_1:90;
    A9: q1`1/|.q1.|-cn< q2`1/|.q2.|-cn by A1,XREAL_1:11;
    1-cn>0 by A1,XREAL_1:151;
   hence thesis by A7,A8,A9,REAL_1:73;
 end;

theorem Th147:
 for cn being Real,q1,q2 being Point of TOP-REAL 2 st -1<cn & cn<1 & q1`2<0
 & q1`1/|.q1.|<cn & q2`2<0 & q2`1/|.q2.|<cn & q1`1/|.q1.|<q2`1/|.q2.|
 holds (for p1,p2 being Point of TOP-REAL 2 st
 p1=(cn-FanMorphS).q1 & p2=(cn-FanMorphS).q2 holds p1`1/|.p1.|<p2`1/|.p2.|)
 proof let cn be Real,q1,q2 be Point of TOP-REAL 2;
  assume A1: -1<cn & cn<1 & q1`2<0
   & q1`1/|.q1.|<cn & q2`2<0 & q2`1/|.q2.|<cn & q1`1/|.q1.|<q2`1/|.q2.|;
  let p1,p2 be Point of TOP-REAL 2;
   assume A2: p1=(cn-FanMorphS).q1 & p2=(cn-FanMorphS).q2;
    then p1=|[ |.q1.|* ((q1`1/|.q1.|-cn)/(1+cn)),
      |.q1.|*( -sqrt(1-((q1`1/|.q1.|-cn)/(1+cn))^2))]| by A1,Th121;
    then A3: p1`2= |.q1.|*( -sqrt(1-((q1`1/|.q1.|-cn)/(1+cn))^2))&
        p1`1= |.q1.|* ((q1`1/|.q1.|-cn)/(1+cn)) by EUCLID:56;
    p2=|[ |.q2.|* ((q2`1/|.q2.|-cn)/(1+cn)),
    |.q2.|*( -sqrt(1-((q2`1/|.q2.|-cn)/(1+cn))^2))]| by A1,A2,Th121;
    then A4: p2`2= |.q2.|*( -sqrt(1-((q2`1/|.q2.|-cn)/(1+cn))^2))&
        p2`1= |.q2.|* ((q2`1/|.q2.|-cn)/(1+cn)) by EUCLID:56;
    A5: |.q1.|>0 & |.q2.|>0 by A1,Lm1,JGRAPH_2:11;
    A6: |.p1.|=|.q1.| & |.p2.|=|.q2.| by A2,Th135;
    then A7: p1`1/|.p1.|= (q1`1/|.q1.|-cn)/(1+cn) by A3,A5,XCMPLX_1:90;
A8: p2`1/|.p2.|= (q2`1/|.q2.|-cn)/(1+cn) by A4,A5,A6,XCMPLX_1:90;
A9: q1`1/|.q1.|-cn< q2`1/|.q2.|-cn by A1,XREAL_1:11;
    1+cn>0 by A1,XREAL_1:150;
   hence p1`1/|.p1.|<p2`1/|.p2.| by A7,A8,A9,REAL_1:73;
 end;

theorem
  for cn being Real,q1,q2 being Point of TOP-REAL 2 st -1<cn & cn<1 & q1`2<0
 & q2`2<0 & q1`1/|.q1.|<q2`1/|.q2.|
 holds (for p1,p2 being Point of TOP-REAL 2 st
 p1=(cn-FanMorphS).q1 & p2=(cn-FanMorphS).q2 holds p1`1/|.p1.|<p2`1/|.p2.|)
 proof let cn be Real,q1,q2 be Point of TOP-REAL 2;
  assume A1: -1<cn & cn<1 & q1`2<0 & q2`2<0 & q1`1/|.q1.|<q2`1/|.q2.|;
  let p1,p2 be Point of TOP-REAL 2;
   assume A2: p1=(cn-FanMorphS).q1 & p2=(cn-FanMorphS).q2;
   per cases;
    suppose q1`1/|.q1.|>=cn & q2`1/|.q2.|>=cn;
     hence p1`1/|.p1.|<p2`1/|.p2.| by A1,A2,Th146;
    end;
    suppose q1`1/|.q1.|>=cn & q2`1/|.q2.|<cn;
     hence p1`1/|.p1.|<p2`1/|.p2.| by A1,XXREAL_0:2;
    end;
    suppose A3: q1`1/|.q1.|<cn & q2`1/|.q2.|>=cn;
     then A4: p1`2<0 & p1`1<0 by A1,A2,Th145;
     then A5: |.p1.|>0 by Lm1,JGRAPH_2:11;
 A6: p2`2<0 & p2`1>=0 by A1,A2,A3,Th144;
     p2`1/|.p2.|>=0 by A6,REAL_2:125;
     hence p1`1/|.p1.|<p2`1/|.p2.| by A4,A5,REAL_2:128;
    end;
    suppose q1`1/|.q1.|<cn & q2`1/|.q2.|<cn;
     hence p1`1/|.p1.|<p2`1/|.p2.| by A1,A2,Th147;
    end;
 end;

theorem
  for cn being Real,q being Point of TOP-REAL 2 st -1<cn & cn<1 & q`2<0
 & q`1/|.q.|=cn holds (for p being Point of TOP-REAL 2 st
 p=(cn-FanMorphS).q holds p`2<0 & p`1=0)
 proof let cn be Real,q be Point of TOP-REAL 2;
  assume A1: -1<cn & cn<1 & q`2<0 & q`1/|.q.|=cn;
A2: |.q.|>=0;
  let p be Point of TOP-REAL 2;
  assume p=(cn-FanMorphS).q;
  then A3: p=|[ |.q.|* ((q`1/|.q.|-cn)/(1-cn)),
  |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))]| by A1,Th120;
A4: |.q.|<>0 by A1,JGRAPH_2:11,TOPRNS_1:25;
A5: p`2= |.q.|*( -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2))&
    p`1= |.q.|* ((q`1/|.q.|-cn)/(1-cn)) by A3,EUCLID:56;
   ((-(q`1/|.q.|-cn))/(1-cn))^2<1^2 by A1;
   then -sqrt(1-((q`1/|.q.|-cn)/(1-cn))^2)< 0 by Lm14;
   hence thesis by A1,A2,A4,A5,XREAL_1:134;
 end;

theorem
  for cn being real number holds 0.REAL 2=(cn-FanMorphS).(0.REAL 2)
   by Th120,JGRAPH_2:11;
