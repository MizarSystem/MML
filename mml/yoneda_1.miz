:: Yoneda Embedding
::  by Miros{\l}aw Wojciechowski
::
:: Received June 12, 1997
:: Copyright (c) 1997 Association of Mizar Users

environ

 vocabularies CAT_1, ENS_1, FUNCT_1, RELAT_1, MCART_1, NATTRA_1, BOOLE,
      OPPCAT_1, CAT_2, FUNCT_2, YONEDA_1, ARYTM;
 notations TARSKI, XBOOLE_0, SUBSET_1, MCART_1, RELAT_1, FUNCT_1, BINOP_1,
      FUNCT_2, CAT_1, CAT_2, OPPCAT_1, ENS_1, NATTRA_1;
 constructors PARTFUN1, DOMAIN_1, NATTRA_1, ENS_1, VALUED_1, SEQ_1;
 registrations XBOOLE_0, FUNCT_1, RELSET_1, ENS_1, VALUED_1, FUNCT_2;
 requirements SUBSET, BOOLE;
 definitions TARSKI, BINOP_1, VALUED_1;
 theorems ZFMISC_1, MCART_1, FUNCT_1, FUNCT_2, CAT_1, CAT_2, OPPCAT_1, ENS_1,
      NATTRA_1, ISOCAT_1, RELSET_1, RELAT_1;
 schemes FUNCT_2;

begin

reserve y for set;
reserve A for Category, a,o for Object of A;
reserve f for Morphism of A;

definition let A;
 func EnsHom(A) -> Category equals
   Ens(Hom(A));
 correctness;
end;

theorem Th1:
 for f,g being Function, m1,m2 being Morphism of EnsHom A st
  cod m1 = dom m2 & [[dom m1,cod m1],f] = m1 & [[dom m2,cod m2],g] = m2
       holds [[dom m1,cod m2],g*f] = m2*m1
    proof
     let f,g be Function;
     let m1,m2 be Morphism of EnsHom A such that
A1:  cod m1 = dom m2 & [[dom m1,cod m1],f] = m1 &
               [[dom m2,cod m2],g] = m2;
A2:  EnsHom A =
 CatStr(# Hom A,Maps Hom A,fDom Hom A,fCod Hom A,fComp Hom A,fId Hom A
#)
          by ENS_1:def 14;
     then reconsider m1'=m1 as Element of Maps Hom A;
     reconsider m2'=m2 as Element of Maps Hom A by A2;
A3:  [m2,m1] in dom(the Comp of EnsHom A) by A1,CAT_1:40;
A4:  cod m1'= m1`1`2 by ENS_1:def 5
           .=[dom m1,cod m1]`2 by A1,MCART_1:7
           .=dom m2 by A1,MCART_1:7
           .=[dom m2,cod m2]`1 by MCART_1:7
           .=m2`1`1 by A1,MCART_1:7
           .= dom m2' by ENS_1:def 4;
A5:  dom m1'=dom m1 & cod m2'=cod m2
           proof
A6:          dom m1'= m1`1`1 by ENS_1:def 4
                   .=[dom m1,cod m1]`1 by A1,MCART_1:7
                   .=dom m1 by MCART_1:7;
              cod m2 =[dom m2,cod m2]`2 by MCART_1:7
                   .=m2`1`2 by A1,MCART_1:7
                   .= cod m2' by ENS_1:def 5;
             hence thesis by A6;
           end;
A7:   m2'`2= g & m1'`2=f
        proof
          A8: [[dom m2',cod m2'],m2'`2] =m2 by ENS_1:8;
              [[dom m1',cod m1'],m1'`2] =m1 by ENS_1:8;
          hence thesis by A1,A8,ZFMISC_1:33;
        end;
         m2*m1 = (fComp Hom A).(m2',m1') by A2,A3,CAT_1:def 4
          .= m2'*m1' by A4,ENS_1:def 12
          .= [[dom m1,cod m2],g*f] by A4,A5,A7,ENS_1:def 7;
     hence thesis;
    end;

definition let A,a;
  func <|a,?> -> Functor of A,EnsHom(A) equals
              hom?-(a);
coherence by ENS_1:49;
end;

canceled;

theorem Th3:
for f being Morphism of A holds
 <|cod f,?> is_naturally_transformable_to <|dom f,?>
proof
    let f;
    set F1=<|cod f,?> ,F2=<|dom f,?>;
A1: for a being Object of A holds
           [[Hom(cod f,a),Hom(dom f,a)],hom(f,a)] in Hom(F1.a,F2.a)
      proof
        let a be Object of A;
A2:     EnsHom A = CatStr(# Hom A,Maps Hom A,fDom Hom A,fCod Hom A,
                   fComp Hom A,fId Hom A #) by ENS_1:def 14;
        then reconsider m = [[Hom(cod f,a),Hom(dom f,a)],hom(f,a)]
                              as Morphism of EnsHom A by ENS_1:48;
        reconsider m'=m as Element of Maps Hom A by ENS_1:48;
A3:     dom(m)=(fDom Hom A).m by A2,CAT_1:def 2
             .= dom m' by ENS_1:def 10
             .= m`1`1 by ENS_1:def 4
             .= [Hom(cod f,a),Hom(dom f,a)]`1 by MCART_1:7
             .= Hom(cod f,a) by MCART_1:7
             .= (Obj (hom?-(Hom A,cod f))).a by ENS_1:60
             .= (hom?-(Hom A,cod f)).a by CAT_1:def 20
             .=F1.a by ENS_1:def 26;
           cod(m)= (fCod Hom A).m by A2,CAT_1:def 3
            .= cod m' by ENS_1:def 11
            .= m`1`2 by ENS_1:def 5
            .= [Hom(cod f,a),Hom(dom f,a)]`2 by MCART_1:7
            .= Hom(dom f,a) by MCART_1:7
            .= (Obj (hom?-(Hom A,dom f))).a by ENS_1:60
            .= (hom?-(Hom A,dom f)).a by CAT_1:def 20
            .= F2.a by ENS_1:def 26;
        hence thesis by A3,CAT_1:18;
      end;
then for a being Object of A holds Hom(F1.a,F2.a) <> {};
then A4: F1 is_transformable_to F2 by NATTRA_1:def 2;
    set B = EnsHom(A);
    deffunc F(Element of the Objects of A) =
     [[Hom(cod f,$1),Hom(dom f,$1)],hom(f,$1)];
A5:  for a being Element of the Objects of A holds F(a) in the Morphisms of B
       proof
         let a;
             [[Hom(cod f,a),Hom(dom f,a)],hom(f,a)] in Hom(F1.a,F2.a) by A1;
         hence thesis;
       end;
  consider t being Function of the Objects of A, the Morphisms of B such that
A6: for o being Element of the Objects of A holds
        t.o = F(o) from FUNCT_2:sch 8(A5);
    for a being Object of A holds t.a is Morphism of F1.a,F2.a
     proof
       let a;
           [[Hom(cod f,a),Hom(dom f,a)],hom(f,a)] in Hom(F1.a,F2.a) by A1;
       then [[Hom(cod f,a),Hom(dom f,a)],hom(f,a)] is Morphism of F1.a,F2.a
       by CAT_1:def 7;
       hence thesis by A6;
     end;
  then reconsider t as transformation of F1,F2 by A4,NATTRA_1:def 3;
      for a,b being Object of A st Hom(a,b) <> {}
   for g being Morphism of a,b holds t.b*F1.g = F2.g*t.a
    proof
      let a,b be Object of A such that
A7:    Hom(a,b) <> {};
      let g be Morphism of a,b;
A8:   EnsHom A = CatStr(# Hom A,Maps Hom A,fDom Hom A,fCod Hom A,
              fComp Hom A,fId Hom A #) by ENS_1:def 14;
      reconsider f1=t.b as Morphism of EnsHom A;
      reconsider f2=F1.g as Morphism of EnsHom A;
A9:    t.b= (t qua Function of the Objects of A, the Morphisms of B).b
             by A4,NATTRA_1:def 5
        .= [[Hom(cod f,b),Hom(dom f,b)],hom(f,b)] by A6;
      then reconsider f1'=f1 as Element of Maps Hom A by ENS_1:48;
A10:  dom f1 =Hom(cod f,b) & cod f1 =Hom(dom f,b)
        proof
A11:       dom(f1) =(fDom Hom A).f1 by A8,CAT_1:def 2
                 .= dom f1' by ENS_1:def 10
                 .= f1`1`1 by ENS_1:def 4
                 .=[Hom(cod f,b),Hom(dom f,b)]`1 by A9,MCART_1:7
                 .=Hom(cod f,b) by MCART_1:7;
           cod(f1) = (fCod Hom A).f1 by A8,CAT_1:def 3
                 .= cod f1' by ENS_1:def 11
                 .= f1`1`2 by ENS_1:def 5
                 .= [Hom(cod f,b),Hom(dom f,b)]`2 by A9,MCART_1:7
                 .= Hom(dom f,b) by MCART_1:7;
          hence thesis by A11;
        end;
A12:     f2 = (hom?-(cod f)).g by A7,NATTRA_1:def 1
          .=[[Hom(cod f,dom g),Hom(cod f,cod g)],hom(cod f,g)]
            by ENS_1:def 22;
        then reconsider f2'=f2 as Element of Maps Hom A by ENS_1:47;
A13:    dom f2=Hom(cod f,dom g) & cod f2=Hom(cod f,cod g)
          proof
A14:         dom(f2) = (fDom Hom A).f2 by A8,CAT_1:def 2
                   .= dom f2' by ENS_1:def 10
                   .= f2`1`1 by ENS_1:def 4
                   .= [Hom(cod f,dom g),Hom(cod f,cod g)]`1 by A12,MCART_1:7
                   .= Hom(cod f,dom g) by MCART_1:7;
             cod(f2) = (fCod Hom A).f2 by A8,CAT_1:def 3
                   .= cod f2' by ENS_1:def 11
                   .= f2`1`2 by ENS_1:def 5
                   .= [Hom(cod f,dom g),Hom(cod f,cod g)]`2 by A12,MCART_1:7
                   .= Hom(cod f,cod g) by MCART_1:7;
            hence thesis by A14;
         end;
then A15:     cod f2 = dom f1 by A7,A10,CAT_1:23;
      reconsider f3 = F2.g as Morphism of EnsHom A;
      reconsider f4 = t.a as Morphism of EnsHom A;
A16:   f3= (hom?-(dom f)).g by A7,NATTRA_1:def 1
       .=[[Hom(dom f,dom g),Hom(dom f,cod g)],hom(dom f,g)]
         by ENS_1:def 22;
      then reconsider f3'=f3 as Element of Maps Hom A by ENS_1:47;
A17:  dom f3=Hom(dom f,dom g) & cod f3=Hom(dom f,cod g)
        proof
A18:       dom(f3) =(fDom Hom A).f3 by A8,CAT_1:def 2
                 .= dom f3' by ENS_1:def 10
                 .= f3`1`1 by ENS_1:def 4
                 .= [Hom(dom f,dom g),Hom(dom f,cod g)]`1 by A16,MCART_1:7
                 .= Hom(dom f,dom g) by MCART_1:7;
           cod(f3) = (fCod Hom A).f3 by A8,CAT_1:def 3
                 .= cod f3' by ENS_1:def 11
                 .= f3`1`2 by ENS_1:def 5
                 .= [Hom(dom f,dom g),Hom(dom f,cod g)]`2 by A16,MCART_1:7
                 .= Hom(dom f,cod g) by MCART_1:7;
          hence thesis by A18;
        end;
A19:   t.a = (t qua Function of the Objects of A, the Morphisms of B).a
             by A4,NATTRA_1:def 5
        .= [[Hom(cod f,a),Hom(dom f,a)],hom(f,a)] by A6;
      then reconsider f4'=f4 as Element of Maps Hom A by ENS_1:48;
A20: dom f4 =Hom(cod f,a) & cod f4 =Hom(dom f,a)
        proof
A21:       dom(f4) = (fDom Hom A).f4 by A8,CAT_1:def 2
                 .= dom f4' by ENS_1:def 10
                 .= f4`1`1 by ENS_1:def 4
                 .= [Hom(cod f,a),Hom(dom f,a)]`1 by A19,MCART_1:7
                 .=Hom(cod f,a) by MCART_1:7;
           cod(f4) = (fCod Hom A).f4 by A8,CAT_1:def 3
                 .= cod f4' by ENS_1:def 11
                 .= f4`1`2 by ENS_1:def 5
                 .= [Hom(cod f,a),Hom(dom f,a)]`2 by A19,MCART_1:7
                 .= Hom(dom f,a) by MCART_1:7;
          hence thesis by A21;
        end;
then A22:  cod f4 = dom f3 by A7,A17,CAT_1:23;
A23:  rng hom(cod f,g) c= dom hom(f,b)
      proof
A24:    cod g =b by A7,CAT_1:23;
        per cases;
           suppose Hom(dom f,b) = {};
then A25:       Hom(cod f,b) = {} by ENS_1:42;
          rng hom(cod f,g) c= Hom(cod f,cod g) by RELSET_1:12;
              hence thesis by A24,A25,FUNCT_2:def 1;
           end;
           suppose
A26:            Hom(dom f,b) <> {};
              let e be set;
              assume
A27:           e in rng hom(cod f,g);
A28:           cod g = b by A7,CAT_1:23;
A29:       rng hom(cod f,g) c= Hom(cod f,cod g) by RELSET_1:12;
               Hom(cod f,cod g)=dom hom(f,b) by A26,A28,FUNCT_2:def 1;
              hence thesis by A27,A29;
         end;
         end;
A30:     rng hom(f,a) c= dom hom(dom f,g)
           proof
A31:           dom g =a by A7,CAT_1:23;
               per cases;
                 suppose
                        Hom(dom f,cod g) = {};
then A32:                 Hom(dom f,dom g) = {} by ENS_1:42;
              rng hom(f,a) c= Hom(dom f,a) by RELSET_1:12;
                    hence thesis by A31,A32,FUNCT_2:def 1;
                 end;
                 suppose
A33:                  Hom(dom f,cod g) <> {};
                    let e be set;
                    assume
A34:                 e in rng hom(f,a);
A35:           rng hom(f,a) c= Hom(dom f,a) by RELSET_1:12;
                     Hom(dom f,a) = dom hom(dom f,g) by A31,A33,FUNCT_2:def 1;
            hence thesis by A34,A35;
        end;
        end;
A36:      dom g =a & cod g =b by A7,CAT_1:23;
A37:      dom (hom(f,b)*hom(cod f,g)) = dom(hom(dom f,g)*hom(f,a))
         proof
           per cases;
            suppose
A38:          Hom(cod f,dom g)= {};
                 dom (hom(f,b)*hom(cod f,g))=dom (hom(cod f,g)) by A23,
RELAT_1:46
                         .=Hom(cod f,dom g) by A38,FUNCT_2:def 1
                         .=dom (hom(f,a)) by A36,A38,FUNCT_2:def 1
                         .=dom(hom(dom f,g)*hom(f,a)) by A30,RELAT_1:46;
            hence thesis;
          end;
          suppose
A39:         Hom(cod f,dom g) <> {};
then A40:        Hom(cod f,cod g) <> {} by ENS_1:42;
A41:        Hom(dom f,a) <> {} by A36,A39,ENS_1:42;
                dom (hom(f,b)*hom(cod f,g))=dom (hom(cod f,g)) by A23,
RELAT_1:46
                                      .=Hom(cod f,dom g) by A40,FUNCT_2:def 1
                                      .=Hom(cod f,a) by A7,CAT_1:23
                                      .=dom (hom(f,a)) by A41,FUNCT_2:def 1
                                      .=dom(hom(dom f,g)*hom(f,a))
                                       by A30,RELAT_1:46;
           hence thesis;
      end;
      end;
A42:  for x being set st x in dom (hom(f,b)*hom(cod f,g))
                  holds (hom(f,b)*hom(cod f,g)).x = (hom(dom f,g)*hom(f,a)).x
        proof
           let x be set such that
A43:         x in dom (hom(f,b)*hom(cod f,g));
             per cases;
              suppose
                    Hom(cod f,dom g) <> {};
then A44:              Hom(cod f,cod g) <> {} by ENS_1:42;
                    x in dom hom(cod f,g) by A43,FUNCT_1:21;
then A45:             x in Hom(cod f,dom g) by A44,FUNCT_2:def 1;
                then reconsider x as Morphism of A;
A46:             g*x in Hom(cod f,b)
                  proof
A47:                  dom(g) = cod(x) by A45,CAT_1:18;
then A48:                   dom(g*x) =dom x by CAT_1:42
                             .=cod f by A45,CAT_1:18;
                      cod(g*x)=cod(g) by A47,CAT_1:42
                            .=b by A7,CAT_1:23;
                     hence thesis by A48,CAT_1:18;
                  end;
A49:             hom(f,a).x in Hom(dom f,dom g)
                 proof
A50:                hom(f,a).x =x*f by A36,A45,ENS_1:def 21;
A51:                 dom(x) = cod(f) by A45,CAT_1:18;
then A52:                  dom(x*f) =dom f by CAT_1:42;
                     cod(x*f)=cod(x) by A51,CAT_1:42
                           .=dom g by A45,CAT_1:18;
                    hence thesis by A50,A52,CAT_1:18;
                 end;
                then reconsider h=hom(f,a).x as Morphism of A;
A53:             dom(g) = cod(x) by A45,CAT_1:18;
A54:             dom(x) = cod(f) by A45,CAT_1:18;
                    (hom(f,b)*hom(cod f,g)).x = hom(f,b).(hom(cod f,g).x)
                                          by A43,FUNCT_1:22
                                         .=hom(f,b).(g*x) by A45,ENS_1:def 20
                                         .=(g*x)*f by A46,ENS_1:def 21
                                         .= g*(x*f) by A53,A54,CAT_1:43
                                         .= g*(h) by A36,A45,ENS_1:def 21
                                         .= hom(dom f,g).(hom(f,a).x)
                                          by A49,ENS_1:def 20
                                         .= (hom(dom f,g)*hom(f,a)).x
                                          by A37,A43,FUNCT_1:22;
                hence thesis;
              end;
              suppose
A55:              Hom(cod f,dom g) = {};
                   x in dom hom(cod f,g) by A43,FUNCT_1:21;
              hence thesis by A55,FUNCT_2:def 1;
             end;
             end;
A56:     Hom(F1.b,F2.b)<>{} & Hom(F1.a,F1.b)<>{} by A1,A7,CAT_1:126;
A57:     Hom(F2.a,F2.b)<>{} & Hom(F1.a,F2.a)<>{} by A1,A7,CAT_1:126;
         t.b*F1.g = f1*f2 by A56,CAT_1:def 13
               .= [[Hom(cod f,dom g),Hom(dom f,b)],hom(f,b)*hom(cod f,g)]
                 by A9,A10,A12,A13,A15,Th1
               .= [[ Hom(cod f,a),Hom(dom f,cod g)],hom(dom f,g)*hom(f,a)]
                 by A36,A37,A42,FUNCT_1:9
               .= f3*f4 by A16,A17,A19,A20,A22,Th1
               .= F2.g*t.a by A57,CAT_1:def 13;
      hence thesis;
    end;
  hence thesis by A4,NATTRA_1:def 7;
end;

definition let A,f;
func <|f,?> -> natural_transformation of <|cod f,?>, <|dom f,?> means
:Def3:  for o be Object of A holds
       it.o = [[Hom(cod f,o),Hom(dom f,o)],hom(f,id o)];
existence
proof
    set F1=<|cod f,?> ,
        F2=<|dom f,?>;
A1: for o being Object of A holds
           [[Hom(cod f,o),Hom(dom f,o)],hom(f,id o)] in Hom(F1.o,F2.o)
     proof
        let o be Object of A;
A2:      hom(f,id o)=hom(f,o) by ENS_1:53;
A3:     EnsHom A = CatStr(# Hom A,Maps Hom A,fDom Hom A,fCod Hom A,
                   fComp Hom A,fId Hom A #) by ENS_1:def 14;
        then reconsider m = [[Hom(cod f,o),Hom(dom f,o)],hom(f,id o)]
                             as Morphism of EnsHom A by A2,ENS_1:48;
        reconsider m'=m as Element of Maps Hom A by A2,ENS_1:48;
A4:     dom(m) = (fDom Hom A).m by A3,CAT_1:def 2
              .= dom m' by ENS_1:def 10
              .= m`1`1 by ENS_1:def 4
              .= [Hom(cod f,o),Hom(dom f,o)]`1 by MCART_1:7
              .= Hom(cod f,o) by MCART_1:7
              .= (Obj (hom?-(Hom A,cod f))).o by ENS_1:60
              .= (hom?-(Hom A,cod f)).o by CAT_1:def 20
              .= F1.o by ENS_1:def 26;
            cod(m) = (fCod Hom A).m by A3,CAT_1:def 3
              .= cod m' by ENS_1:def 11
              .= m`1`2 by ENS_1:def 5
              .= [Hom(cod f,o),Hom(dom f,o)]`2 by MCART_1:7
              .= Hom(dom f,o) by MCART_1:7
              .= (Obj (hom?-(Hom A,dom f))).o by ENS_1:60
              .= (hom?-(Hom A,dom f)).o by CAT_1:def 20
              .=F2.o by ENS_1:def 26;
       hence thesis by A4,CAT_1:18;
     end;
     deffunc F(Element of the Objects of A) =
       [[Hom(cod f,$1),Hom(dom f,$1)],hom(f,id $1)];
A5:  for o being Element of the Objects of A holds
       F(o) in the Morphisms of EnsHom(A)
          proof
             let o;
                 [[Hom(cod f,o),Hom(dom f,o)],hom(f,id o)] in Hom(F1.o,F2.o)
              by A1;
             hence thesis;
          end;
    consider t being Function of the Objects of A, the Morphisms of EnsHom(A)
      such that
A6:  for o being Element of the Objects of A holds t.o = F(o)
      from FUNCT_2:sch 8(A5);
A7:  F1 is_naturally_transformable_to F2 by Th3;
      for o being Object of A holds Hom(F1.o,F2.o) <> {} by A1;
then A8: F1 is_transformable_to F2 by NATTRA_1:def 2;
    for o being Object of A holds t.o is Morphism of F1.o,F2.o
        proof
           let o;
               [[Hom(cod f,o),Hom(dom f,o)],hom(f,id o)] in Hom(F1.o,F2.o)
             by A1;
           then [[Hom(cod f,o),Hom(dom f,o)],hom(f,id o)]
                                    is Morphism of F1.o,F2.o by CAT_1:def 7;
           hence thesis by A6;
        end;
   then reconsider t as transformation of F1,F2 by A8,NATTRA_1:def 3;
   set B=EnsHom A;
    for a,b being Object of A st Hom(a,b) <> {}
     for g being Morphism of a,b holds t.b*F1.g = F2.g*t.a
     proof
       let a,b be Object of A such that
A9:     Hom(a,b) <> {};
       let g be Morphism of a,b;
A10:    EnsHom A = CatStr(# Hom A,Maps Hom A,fDom Hom A,fCod Hom A,
                  fComp Hom A,fId Hom A #) by ENS_1:def 14;
       reconsider f1=t.b as Morphism of EnsHom A;
       reconsider f2=F1.g as Morphism of EnsHom A;
A11:    t.b = (t qua Function of the Objects of A, the Morphisms of B).b
             by A8,NATTRA_1:def 5
          .= [[Hom(cod f,b),Hom(dom f,b)],hom(f,id b)] by A6
          .=[[Hom(cod f,b),Hom(dom f,b)],hom(f,b)] by ENS_1:53;
       then reconsider f1'=f1
            as Element of Maps Hom A by ENS_1:48;
A12:   dom f1 =Hom(cod f,b) & cod f1 =Hom(dom f,b)
         proof
A13:         dom(f1) = (fDom Hom A).f1 by A10,CAT_1:def 2
                   .= dom f1' by ENS_1:def 10
                   .= f1`1`1 by ENS_1:def 4
                   .= [Hom(cod f,b),Hom(dom f,b)]`1 by A11,MCART_1:7
                   .= Hom(cod f,b) by MCART_1:7;
             cod(f1) = (fCod Hom A).f1 by A10,CAT_1:def 3
                   .= cod f1' by ENS_1:def 11
                   .= f1`1`2 by ENS_1:def 5
                   .= [Hom(cod f,b),Hom(dom f,b)]`2 by A11,MCART_1:7
                   .= Hom(dom f,b) by MCART_1:7;
           hence thesis by A13;
        end;
A14:   f2 = (hom?-(cod f)).g by A9,NATTRA_1:def 1
        .=[[Hom(cod f,dom g),Hom(cod f,cod g)],hom(cod f,g)]
           by ENS_1:def 22;
      then reconsider f2'=f2
          as Element of Maps Hom A by ENS_1:47;
A15:  dom f2=Hom(cod f,dom g) & cod f2=Hom(cod f,cod g)
        proof
A16:        dom(f2) =(fDom Hom A).f2 by A10,CAT_1:def 2
                  .= dom f2' by ENS_1:def 10
                  .= f2`1`1 by ENS_1:def 4
                  .=[Hom(cod f,dom g),Hom(cod f,cod g)]`1 by A14,MCART_1:7
                  .=Hom(cod f,dom g) by MCART_1:7;
           cod(f2) = (fCod Hom A).f2 by A10,CAT_1:def 3
                 .= cod f2' by ENS_1:def 11
                 .= f2`1`2 by ENS_1:def 5
                 .= [Hom(cod f,dom g),Hom(cod f,cod g)]`2 by A14,MCART_1:7
                 .= Hom(cod f,cod g) by MCART_1:7;
          hence thesis by A16;
        end;
then A17:   cod f2 = dom f1 by A9,A12,CAT_1:23;
     reconsider f3=F2.g as Morphism of EnsHom A;
     reconsider f4=t.a as Morphism of EnsHom A;
A18:  f3 = (hom?-(dom f)).g by A9,NATTRA_1:def 1
       .=[[Hom(dom f,dom g),Hom(dom f,cod g)],hom(dom f,g)]
            by ENS_1:def 22;
     then reconsider f3'=f3
            as Element of Maps Hom A by ENS_1:47;
A19: dom f3=Hom(dom f,dom g) & cod f3=Hom(dom f,cod g)
        proof
A20:        dom(f3) =(fDom Hom A).f3 by A10,CAT_1:def 2
                  .= dom f3' by ENS_1:def 10
                  .= f3`1`1 by ENS_1:def 4
                  .=[Hom(dom f,dom g),Hom(dom f,cod g)]`1 by A18,MCART_1:7
                  .=Hom(dom f,dom g) by MCART_1:7;
           cod(f3) = (fCod Hom A).f3 by A10,CAT_1:def 3
                 .= cod f3' by ENS_1:def 11
                 .= f3`1`2 by ENS_1:def 5
                 .= [Hom(dom f,dom g),Hom(dom f,cod g)]`2 by A18,MCART_1:7
                 .= Hom(dom f,cod g) by MCART_1:7;
          hence thesis by A20;
        end;
      A21: t.a = (t qua Function of the Objects of A, the Morphisms of B).a
             by A8,NATTRA_1:def 5
         .= [[Hom(cod f,a),Hom(dom f,a)],hom(f,id a)] by A6
         .= [[Hom(cod f,a),Hom(dom f,a)],hom(f,a)] by ENS_1:53;
     then reconsider f4'=f4
          as Element of Maps Hom A by ENS_1:48;
A22: dom f4 =Hom(cod f,a) & cod f4 =Hom(dom f,a)
        proof
A23:        dom(f4) =(fDom Hom A).f4 by A10,CAT_1:def 2
                  .= dom f4' by ENS_1:def 10
                  .= f4`1`1 by ENS_1:def 4
                  .=[Hom(cod f,a),Hom(dom f,a)]`1 by A21,MCART_1:7
                  .=Hom(cod f,a) by MCART_1:7;
           cod(f4) = (fCod Hom A).f4 by A10,CAT_1:def 3
                 .= cod f4' by ENS_1:def 11
                 .= f4`1`2 by ENS_1:def 5
                 .= [Hom(cod f,a),Hom(dom f,a)]`2 by A21,MCART_1:7
                 .= Hom(dom f,a) by MCART_1:7;
          hence thesis by A23;
        end;
then A24:  cod f4 = dom f3 by A9,A19,CAT_1:23;
A25:  rng hom(cod f,g) c= dom hom(f,b)
      proof
A26:      cod g =b by A9,CAT_1:23;
           per cases;
             suppose
                   Hom(dom f,b) = {};
then A27:            Hom(cod f,b) = {} by ENS_1:42;
           rng hom(cod f,g) c= Hom(cod f,cod g) by RELSET_1:12;
               hence thesis by A26,A27,FUNCT_2:def 1;
            end;
            suppose
A28:             Hom(dom f,b) <> {};
               let e be set;
               assume
A29:            e in rng hom(cod f,g);
A30:            cod g =b by A9,CAT_1:23;
A31:        rng hom(cod f,g) c= Hom(cod f,cod g) by RELSET_1:12;
                Hom(cod f,cod g)=dom hom(f,b) by A28,A30,FUNCT_2:def 1;
              hence thesis by A29,A31;
        end;
        end;
A32:  rng hom(f,a) c= dom hom(dom f,g)
      proof
A33:      dom g =a by A9,CAT_1:23;
           per cases;
             suppose
                   Hom(dom f,cod g) = {};
then A34:            Hom(dom f,dom g) = {} by ENS_1:42;
           rng hom(f,a) c= Hom(dom f,a) by RELSET_1:12;
               hence thesis by A33,A34,FUNCT_2:def 1;
             end;
             suppose
A35:             Hom(dom f,cod g) <> {};
               let e be set;
               assume
A36:            e in rng hom(f,a);
A37:             rng hom(f,a) c= Hom(dom f,a) by RELSET_1:12;
                Hom(dom f,a)=dom hom(dom f,g) by A33,A35,FUNCT_2:def 1;
               hence thesis by A36,A37;
        end;
        end;
A38:   dom g =a & cod g =b by A9,CAT_1:23;
A39:   dom (hom(f,b)*hom(cod f,g)) = dom(hom(dom f,g)*hom(f,a))
       proof
          per cases;
            suppose
A40:          Hom(cod f,dom g)= {};
                  dom (hom(f,b)*hom(cod f,g)) = dom (hom(cod f,g)) by A25,
RELAT_1:46
                         .=Hom(cod f,a) by A38,A40,FUNCT_2:def 1
                         .=dom (hom(f,a)) by A38,A40,FUNCT_2:def 1
                         .=dom(hom(dom f,g)*hom(f,a)) by A32,RELAT_1:46;
             hence thesis;
           end;
           suppose
A41:          Hom(cod f,dom g) <> {};
then A42:         Hom(cod f,cod g) <> {} by ENS_1:42;
A43:         Hom(dom f,a) <> {} by A38,A41,ENS_1:42;
                dom (hom(f,b)*hom(cod f,g)) = dom (hom(cod f,g)) by A25,
RELAT_1:46
                                        .=Hom(cod f,a) by A38,A42,FUNCT_2:def 1
                                        .=dom (hom(f,a)) by A43,FUNCT_2:def 1
                                        .=dom(hom(dom f,g)*hom(f,a))
                                          by A32,RELAT_1:46;
            hence thesis;
        end;
        end;

A44:  for x being set st x in dom (hom(f,b)*hom(cod f,g))
                  holds (hom(f,b)*hom(cod f,g)).x = (hom(dom f,g)*hom(f,a)).x
         proof
            let x be set such that
A45:          x in dom (hom(f,b)*hom(cod f,g));
              per cases;
                suppose
                      Hom(cod f,dom g) <> {};
then A46:                Hom(cod f,cod g) <> {} by ENS_1:42;
                      x in dom hom(cod f,g) by A45,FUNCT_1:21;
then A47:               x in Hom(cod f,dom g) by A46,FUNCT_2:def 1;
                  then reconsider x as Morphism of A;
A48:               g*x in Hom(cod f,b)
                     proof
A49:                     dom(g) = cod(x) by A47,CAT_1:18;
A50:                    cod g =b by A9,CAT_1:23;
A51:                      dom(g*x) =dom x by A49,CAT_1:42
                                .=cod f by A47,CAT_1:18;
                         cod(g*x)=b by A49,A50,CAT_1:42;
                        hence thesis by A51,CAT_1:18;
                      end;
A52:              hom(f,a).x in Hom(dom f,dom g)
                   proof
A53:                  hom(f,a).x =x*f by A38,A47,ENS_1:def 21;
A54:                   dom(x) = cod(f) by A47,CAT_1:18;
then A55:                    dom(x*f) =dom f by CAT_1:42;
                       cod(x*f)=cod(x) by A54,CAT_1:42
                             .=dom g by A47,CAT_1:18;
                      hence thesis by A53,A55,CAT_1:18;
                   end;
                then reconsider h=hom(f,a).x as Morphism of A;
A56:             dom(g) = cod(x) by A47,CAT_1:18;
A57:             dom(x) = cod(f) by A47,CAT_1:18;
                    (hom(f,b)*hom(cod f,g)).x = hom(f,b).(hom(cod f,g).x)
                                           by A45,FUNCT_1:22
                                         .=hom(f,b).(g*x) by A47,ENS_1:def 20
                                         .=(g*x)*f by A48,ENS_1:def 21
                                         .= g*(x*f) by A56,A57,CAT_1:43
                                         .= g*(h) by A38,A47,ENS_1:def 21
                                         .= hom(dom f,g).(hom(f,a).x)
                                           by A52,ENS_1:def 20
                                         .= (hom(dom f,g)*hom(f,a)).x
                                           by A39,A45,FUNCT_1:22;
               hence thesis;
            end;
            suppose
A58:            Hom(cod f,dom g) = {};
                 x in dom hom(cod f,g) by A45,FUNCT_1:21;
           hence thesis by A58,FUNCT_2:def 1;
         end;
         end;
A59:      Hom(F1.b,F2.b)<>{} & Hom(F1.a,F1.b)<>{} by A1,A9,CAT_1:126;
A60:      Hom(F2.a,F2.b)<>{} & Hom(F1.a,F2.a)<>{} by A1,A9,CAT_1:126;
           t.b*F1.g = f1*f2 by A59,CAT_1:def 13
                 .=[[Hom(cod f,dom g),Hom(dom f,b)],hom(f,b)*hom(cod f,g)]
                   by A11,A12,A14,A15,A17,Th1
                 .=[[ Hom(cod f,a),Hom(dom f,cod g)],hom(dom f,g)*hom(f,a)]
                   by A38,A39,A44,FUNCT_1:9
                 .=f3*f4 by A18,A19,A21,A22,A24,Th1
                 .= F2.g*t.a by A60,CAT_1:def 13;
        hence thesis;
    end;
    then reconsider t as natural_transformation of F1,F2 by A7,NATTRA_1:def 8;
    for o be Element of the Objects of A
           holds t.o= [[Hom(cod f,o),Hom(dom f,o)],hom(f,id o)]
            proof
              let o;
                  t.o =(t qua Function).o by A8,NATTRA_1:def 5
                 .= [[Hom(cod f,o),Hom(dom f,o)],hom(f,id o)] by A6;
              hence thesis;
            end;
  hence thesis;
end;
uniqueness
  proof
     let h1,h2 be natural_transformation of <|cod f,?>, <|dom f,?>
     such that
A61:  for o be Object of A holds
     h1.o = [[Hom(cod f,o),Hom(dom f,o)],hom(f,id o)] and
A62:  for o be Object of A
             holds h2.o =[[Hom(cod f,o),Hom(dom f,o)],hom(f,id o)];
    for a being Object of A holds
     [[Hom(cod f,a),Hom(dom f,a)],hom(f,a)] in Hom(<|cod f,?>.a,<|dom f,?>.a)
       proof
          let a be Object of A;
A63:  EnsHom A = CatStr(# Hom A,Maps Hom A,fDom Hom A,fCod Hom A,
                fComp Hom A,fId Hom A #) by ENS_1:def 14;
     then reconsider m = [[Hom(cod f,a),Hom(dom f,a)],hom(f,a)]
                            as Morphism of EnsHom A by ENS_1:48;
     reconsider m'=m as Element of Maps Hom A by ENS_1:48;
A64:  dom(m) =(fDom Hom A).m by A63,CAT_1:def 2
           .= dom m' by ENS_1:def 10
           .= m`1`1 by ENS_1:def 4
           .=[Hom(cod f,a),Hom(dom f,a)]`1 by MCART_1:7
           .=Hom(cod f,a) by MCART_1:7
           .= (Obj (hom?-(Hom A,cod f))).a by ENS_1:60
           .= (hom?-(Hom A,cod f)).a by CAT_1:def 20
           .=<|cod f,?>.a by ENS_1:def 26;
         cod(m) = (fCod Hom A).m by A63,CAT_1:def 3
           .= cod m' by ENS_1:def 11
           .= m`1`2 by ENS_1:def 5
           .= [Hom(cod f,a),Hom(dom f,a)]`2 by MCART_1:7
           .= Hom(dom f,a) by MCART_1:7
           .= (Obj (hom?-(Hom A,dom f))).a by ENS_1:60
           .= (hom?-(Hom A,dom f)).a by CAT_1:def 20
           .=<|dom f,?>.a by ENS_1:def 26;
    hence thesis by A64,CAT_1:18;
  end;

then for a being Object of A holds Hom(<|cod f,?>.a,<|dom f,?>.a) <> {};
then A65:  <|cod f,?> is_transformable_to <|dom f,?> by NATTRA_1:def 2;
           now
         let o;
         thus h1.o =[[Hom(cod f,o),Hom(dom f,o)],hom(f,id o)] by A61
                   .= h2.o by A62;
       end;
     hence thesis by A65,NATTRA_1:20;
  end;
end;

theorem Th4: for f being Element of the Morphisms of A holds
  [[<|cod f,?>,<|dom f,?>],<|f,?>] is Element of the Morphisms of
                                                        Functors(A,EnsHom(A))
    proof
      let f be Element of the Morphisms of A;
          <|cod f,?> is_naturally_transformable_to <|dom f,?> by Th3;
      then [[<|cod f,?>,<|dom f,?>],<|f,?>] in NatTrans(A,EnsHom(A))
                                            by NATTRA_1:def 16;
      hence thesis by NATTRA_1:def 18;
    end;

definition let A;
func Yoneda(A) -> Contravariant_Functor of A,Functors(A,EnsHom(A)) means
:Def4:      for f being Morphism of A holds
              it.f = [[<|cod f,?>,<|dom f,?>],<|f,?>];
existence
  proof
    deffunc F(Element of the Morphisms of A)
      = [[<|cod $1,?>,<|dom $1,?>],<|$1,?>];
A1:   for f being Element of the Morphisms of A holds
       F(f) in the Morphisms of Functors(A,EnsHom(A))
        proof
          let f;
                [[<|cod f,?>,<|dom f,?>],<|f,?>] is
                      Morphism of Functors(A,EnsHom(A)) by Th4;
          hence thesis;
        end;
     consider F being
       Function of the Morphisms of A, the Morphisms of Functors(A,EnsHom(A))
       such that
A2:    for f being Element of the Morphisms of A holds
           F.f = F(f) from FUNCT_2:sch 8(A1);
A3:    for c being Object of A ex d being Object of Functors(A,EnsHom(A))
         st F.(id c)= id d
           proof
             let c be Object of A;
                 <|c,?> in Funct(A,EnsHom(A)) by CAT_2:def 2;
             then reconsider d=<|c,?> as Object of Functors(A,EnsHom(A)) by
NATTRA_1:def 18;
             take d;
             set X= dom <|id c,?>;
A4:          dom <|id c,?> = the Objects of A by FUNCT_2:def 1
                          .= dom id <|c,?> by FUNCT_2:def 1;
             for y st y in X holds
                   (<|id c,?>).y =(id <|c,?>).y
               proof
                 let y; assume y in X;
                 then reconsider z=y as Object of A by FUNCT_2:def 1;
                     <|cod id c,?> is_transformable_to <|c,?> by CAT_1:44;
then A5:              <|cod id c,?> is_transformable_to <|dom id c,?> by
CAT_1:44;
A6:             Hom(z,z) <> {} by CAT_1:56;
                 reconsider zz= id z as Morphism of z,z;
                 (<|id c,?>).z
                        = [[Hom(cod id c,z),Hom(dom id c,z)],hom(id c,id z)]
                        by Def3
                       .= [[Hom(c,z),Hom(dom id c,z)],hom(id c,id z)]
                        by CAT_1:44
                       .= [[Hom(c,z),Hom(c,z)],hom(id c,id z)] by CAT_1:44
                       .= [[Hom(c,z),Hom(c,z)],hom(c,id z)] by ENS_1:53
                       .= [[Hom(c,z),Hom(c,cod id z)],hom(c,id z)]
                        by CAT_1:44
                       .= [[Hom(c,dom id z),Hom(c,cod id z)],hom(c,id z)]
                        by CAT_1:44
                       .=(<|c,?> qua Function ).id z by ENS_1:def 22
                       .=(<|c,?>).zz by A6,NATTRA_1:def 1
                       .= id (<|c,?>.z) by NATTRA_1:15
                       .=(id <|c,?> ).z by NATTRA_1:21
                       .=(id <|c,?> qua Function).z by NATTRA_1:def 5;
                 hence thesis by A5,NATTRA_1:def 5;
              end;
then A7:    <|id c,?>= id <|c,?> by A4,FUNCT_1:9;
            F.(id c) = [[<|cod id c,?>,<|dom id c,?>],<|id c,?>] by A2
                  .=[[<|c,?>,<|dom id c,?>],<|id c,?>] by CAT_1:44
                  .= [[<|c,?>,<|c,?>],id <|c,?>] by A7,CAT_1:44
                  .=id d by NATTRA_1:def 18;
           hence thesis;
        end;
A8:     for f being Morphism of A
         holds F.(id dom f) = id cod (F.f) & F.(id cod f) = id dom (F.f)
           proof
             let f;
             set g =F.f;
A9:          g = [[<|cod f,?>,<|dom f,?>],<|f,?>] by A2;
then A10:          cod g =<|dom f,?> by NATTRA_1:39;
A11:         dom g =<|cod f,?> by A9,NATTRA_1:39;
A12:         F.(id dom f)
                 =[[<|cod (id dom f),?>,<|dom (id dom f),?>],<|(id dom f),?>]
                  by A2
                .=[[<|dom f,?>,<| dom (id dom f),?>],<|(id dom f),?>]
                  by CAT_1:44
                .=[[<|dom f,?>,<|dom f,?>],<|id dom f,?>] by CAT_1:44;
A13:         [[<|dom f,?>,<|dom f,?>],id <|dom f,?>]
                                  = id cod (F.f) by A10,NATTRA_1:def 18;
             set X= dom <|id dom f,?>;
A14:          dom <|id dom f,?> = the Objects of A by FUNCT_2:def 1
                              .= dom id <|dom f,?> by FUNCT_2:def 1;
A15:          for y st y in X holds
                     (<|id dom f,?>).y =(id <|dom f,?>).y
                proof
                  let y; assume y in X;
                  then reconsider z=y as Object of A by FUNCT_2:def 1;
                      <|cod id dom f,?> is_transformable_to <|dom f,?>
                     by CAT_1:44;
then A16:               <|cod id dom f,?> is_transformable_to <|dom id dom f,?>
by CAT_1:44;
A17:              Hom(z,z) <> {} by CAT_1:56;
                  reconsider zz= id z as Morphism of z,z;
                  (<|id dom f,?>).z
                               = [[Hom(cod id dom f,z),Hom(dom id dom f,z)]
                                 ,hom(id dom f,id z)] by Def3
                              .= [[Hom(dom f,z),Hom(dom id dom f,z)],
                                  hom(id dom f,id z)] by CAT_1:44
                              .= [[Hom(dom f,z),Hom(dom f,z)],
                                  hom(id dom f,id z)] by CAT_1:44
                              .= [[Hom(dom f,z),Hom(dom f,z)],
                                  hom(dom f,id z)] by ENS_1:53
                              .= [[Hom(dom f,z),Hom(dom f,cod id z)],
                                  hom(dom f,id z)] by CAT_1:44
                              .= [[Hom(dom f,dom id z),Hom(dom f,cod id z)],
                                  hom(dom f,id z)] by CAT_1:44
                              .= (<|dom f,?> qua Function ).id z by
ENS_1:def 22
                              .= (<|dom f,?>).zz by A17,NATTRA_1:def 1
                              .= id (<|dom f,?>.z) by NATTRA_1:15
                              .= (id <|dom f,?> ).z by NATTRA_1:21
                              .= (id <|dom f,?> qua Function).z
                               by NATTRA_1:def 5;
                  hence thesis by A16,NATTRA_1:def 5;
               end;
A18:       F.(id cod f) = [[<|cod (id cod f),?>,<|dom (id cod f),?>],
                             <|(id cod f),?>] by A2
                        .= [[<|cod f,?>,<| dom (id cod f),?>],<|(id cod f),?>]
                             by CAT_1:44
                        .= [[<|cod f,?>,<|cod f,?>],<|id cod f,?>] by CAT_1:44;
            set X= dom <|id cod f,?>;
A19:        dom <|id cod f,?> = the Objects of A by FUNCT_2:def 1
                             .= dom id <|cod f,?> by FUNCT_2:def 1;
           for y st y in X holds
                (<|id cod f,?>).y =(id <|cod f,?>).y
               proof
                 let y; assume y in X;
                 then reconsider z=y as Object of A by FUNCT_2:def 1;
                     <|cod id cod f,?> is_transformable_to <|cod f,?>
                   by CAT_1:44;
then A20:              <|cod id cod f,?> is_transformable_to <|dom id cod f,?>
                   by CAT_1:44;
A21:            Hom(z,z) <> {} by CAT_1:56;
                 (<|id cod f,?>).z
                                 = [[Hom(cod id cod f,z),Hom(dom id cod f,z)],
                                     hom(id cod f,id z)] by Def3
                                .= [[Hom(cod f,z),Hom(dom id cod f,z)],
                                     hom(id cod f,id z)] by CAT_1:44
                                .= [[Hom(cod f,z),Hom(cod f,z)],
                                     hom(id cod f,id z)] by CAT_1:44
                                .= [[Hom(cod f,z),Hom(cod f,z)],
                                     hom(cod f,id z)] by ENS_1:53
                                .= [[Hom(cod f,z),Hom(cod f,cod id z)],
                                     hom(cod f,id z)] by CAT_1:44
                                .= [[Hom(cod f,dom id z),Hom(cod f,cod id z)],
                                     hom(cod f,id z)] by CAT_1:44
                                .= (<|cod f,?> qua Function).id z by
ENS_1:def 22
                                .= (<|cod f,?>).id z by A21,NATTRA_1:def 1
                                .= id (<|cod f,?>.z) by NATTRA_1:15
                                .= (id <|cod f,?>).z by NATTRA_1:21
                                .= (id <|cod f,?> qua Function).z
                                  by NATTRA_1:def 5;
                 hence thesis by A20,NATTRA_1:def 5;
              end;
         then <|id cod f,?> =id <|cod f,?> by A19,FUNCT_1:9;
            hence thesis by A11,A12,A13,A14,A15,A18,FUNCT_1:9,NATTRA_1:def 18;
         end;
        for f,g being Morphism of A st dom g = cod f holds
           F.(g*f) = (F.f)*(F.g)
             proof
               let f,g be Morphism of A; assume
A22:           dom g = cod f;
               then reconsider t=<|f,?> as natural_transformation of
                                                <|dom g,?>,<|dom f,?>;
               reconsider t1=<|g,?> as natural_transformation of
                                                       <|cod g,?>,<|dom g,?>;
A23:            F.f =[[<|dom g,?>,<|dom f,?>],t] by A2,A22;
A24:            F.g =[[<|cod g,?>,<|dom g,?>],t1] by A2;
then A25:            [F.f,F.g] in dom (the Comp of Functors(A,EnsHom(A)))
                          by A23,NATTRA_1:41;
               then consider F',F1',F2' being Functor of A,EnsHom(A),
                        t' being natural_transformation of F',F1',
                        t1' being natural_transformation of F1',F2' such that
A26:                     F.g=[[F',F1'],t'] & F.f = [[F1',F2'],t1'] and
A27:                     (the Comp of Functors(A,EnsHom(A))).(F.f,F.g)
                    = [[F',F2'],t1'`*`t'] by NATTRA_1:def 18;
A28:            [F',F1'] = [<|cod g,?>,<|dom g,?>] &
               [F1',F2'] = [<|dom g,?>,<|dom f,?>] &
               <|g,?> = t' & <|f,?> = t1' by A23,A24,A26,ZFMISC_1:33;
               then <|cod g,?> = F' & <|dom g,?> = F1' & <|dom f,?> = F2'
                 by ZFMISC_1:33;
then A29:          F.f*F.g = [[<|cod g,?>,<|dom f,?>],t`*`t1] by A25,A27,A28,
CAT_1:def 4;
A30:             dom(g*f) = dom f & cod(g*f) = cod g by A22,CAT_1:42;
               then reconsider tt=t`*`t1
                   as natural_transformation of <|cod(g*f),?>,<|dom(g*f),?>;
A31:          <|cod(g*f),?> is_naturally_transformable_to
                                                    <|dom(g*f),?> by Th3;
             for o being Object of A holds (<|g*f,?>).o =tt.o
                 proof
                   let o be Object of A;
                   reconsider f1=t.o as Morphism of EnsHom(A);
                   reconsider f2=t1.o as Morphism of EnsHom(A);
                 A32: t.o = [[Hom(cod f,o),Hom(dom f,o)],hom(f,id o)]
                     by A22,Def3;
A33:                f2 = [[Hom(cod g,o),Hom(dom g,o)],hom(g,id o)] by Def3;
A34:                <|dom g,?> is_naturally_transformable_to
                                                         <|dom f,?> by A22,Th3;
A35:                EnsHom A = CatStr(# Hom A,Maps Hom A,fDom Hom A,fCod Hom A,
                                      fComp Hom A,fId Hom A #)
                                       by ENS_1:def 14;
                   then reconsider f1'=f1 as Element of Maps Hom A;
                   reconsider f2'=f2 as Element of Maps Hom A by A35;
A36:                cod f2 = dom f1
                     proof
A37:                    dom(f1) =(fDom Hom A).f1 by A35,CAT_1:def 2
                              .= dom f1' by ENS_1:def 10
                              .= f1`1`1 by ENS_1:def 4
                              .=[Hom(cod f,o),Hom(dom f,o)]`1 by A32,MCART_1:7
                              .=Hom(cod f,o) by MCART_1:7;
                        cod(f2) = (fCod Hom A).f2 by A35,CAT_1:def 3
                              .= cod f2' by ENS_1:def 11
                              .= f2`1`2 by ENS_1:def 5
                              .= [Hom(cod g,o),Hom(dom g,o)]`2 by A33,MCART_1:7
                              .= Hom(dom g,o) by MCART_1:7;
                       hence thesis by A22,A37;
                     end;
A38:                dom f2 =Hom(cod g,o) & cod f2 =Hom(dom g,o)
                     proof
A39:                    dom(f2) = (fDom Hom A).f2 by A35,CAT_1:def 2
                              .= dom f2' by ENS_1:def 10
                              .= f2`1`1 by ENS_1:def 4
                              .= [Hom(cod g,o),Hom(dom g,o)]`1 by A33,MCART_1:7
                              .= Hom(cod g,o) by MCART_1:7;
                        cod(f2) = (fCod Hom A).f2 by A35,CAT_1:def 3
                              .= cod f2' by ENS_1:def 11
                              .= f2`1`2 by ENS_1:def 5
                              .= [Hom(cod g,o),Hom(dom g,o)]`2 by A33,MCART_1:7
                              .= Hom(dom g,o) by MCART_1:7;
                       hence thesis by A39;
                     end;
A40:                cod f1 = Hom(dom f,o) & dom f1 =Hom(cod f,o)
                     proof
A41:                    cod(f1) = (fCod Hom A).f1 by A35,CAT_1:def 3
                              .= cod f1' by ENS_1:def 11
                              .= f1`1`2 by ENS_1:def 5
                              .= [Hom(cod f,o),Hom(dom f,o)]`2 by A32,MCART_1:7
                              .= Hom(dom f,o) by MCART_1:7;
                        dom(f1) = (fDom Hom A).f1 by A35,CAT_1:def 2
                              .= dom f1' by ENS_1:def 10
                              .= f1`1`1 by ENS_1:def 4
                              .= [Hom(cod f,o),Hom(dom f,o)]`1 by A32,MCART_1:7
                              .= Hom(cod f,o) by MCART_1:7;
                       hence thesis by A41;
                     end;
A42:                <|cod g,?> is_naturally_transformable_to <|dom g,?> by Th3
;
                   set F1=<|cod f,?> ,
                       F2=<|dom f,?>;
A43:                for a being Object of A holds
                       [[Hom(cod f,a),Hom(dom f,a)],hom(f,a)] in Hom(F1.a,F2.a)
                      proof
                        let a be Object of A;
A44:                     EnsHom A = CatStr(# Hom A,Maps Hom A,fDom Hom A,
                                           fCod Hom A,fComp Hom A,fId Hom A #)
                                            by ENS_1:def 14;
                        then reconsider m = [[Hom(cod f,a),Hom(dom f,a)],hom(f,
a)]
                                          as Morphism of EnsHom A by ENS_1:48;
                        reconsider m'=m as Element of Maps Hom A by ENS_1:48;
A45:                     dom(m) = (fDom Hom A).m by A44,CAT_1:def 2
                              .= dom m' by ENS_1:def 10
                              .= m`1`1 by ENS_1:def 4
                              .= [Hom(cod f,a),Hom(dom f,a)]`1 by MCART_1:7
                              .= Hom(cod f,a) by MCART_1:7
                              .= (Obj (hom?-(Hom A,cod f))).a by ENS_1:60
                              .= (hom?-(Hom A,cod f)).a by CAT_1:def 20
                              .=F1.a by ENS_1:def 26;
                         cod(m) = (fCod Hom A).m by A44,CAT_1:def 3
                              .= cod m' by ENS_1:def 11
                              .= m`1`2 by ENS_1:def 5
                              .= [Hom(cod f,a),Hom(dom f,a)]`2 by MCART_1:7
                              .= Hom(dom f,a) by MCART_1:7
                              .= (Obj (hom?-(Hom A,dom f))).a by ENS_1:60
                              .= (hom?-(Hom A,dom f)).a by CAT_1:def 20
                              .= F2.a by ENS_1:def 26;
                        hence thesis by A45,CAT_1:18;
                     end;
                  for a being Object of A holds
                       [[Hom(cod g,a),Hom(dom g,a)],hom(g,a)] in
                                      Hom(<|cod g,?>.a,<|dom g,?>.a)
                          proof
                            let a be Object of A;
A46:                         EnsHom A = CatStr(# Hom A,Maps Hom A,fDom Hom A,
                                            fCod Hom A,fComp Hom A,fId Hom A #)
                                             by ENS_1:def 14;
                            then reconsider m =
                                      [[Hom(cod g,a),Hom(dom g,a)],hom(g,a)]
                                          as Morphism of EnsHom A by ENS_1:48;
                            reconsider m'=m as Element of Maps Hom A
                                 by ENS_1:48;
A47:                         dom(m) = (fDom Hom A).m by A46,CAT_1:def 2
                                  .= dom m' by ENS_1:def 10
                                  .= m`1`1 by ENS_1:def 4
                                  .= [Hom(cod g,a),Hom(dom g,a)]`1
                                    by MCART_1:7
                                  .= Hom(cod g,a) by MCART_1:7
                                  .= (Obj (hom?-(Hom A,cod g))).a by ENS_1:60
                                  .= (hom?-(Hom A,cod g)).a by CAT_1:def 20
                                  .=<|cod g,?>.a by ENS_1:def 26;
                             cod(m) = (fCod Hom A).m by A46,CAT_1:def 3
                                  .= cod m' by ENS_1:def 11
                                  .= m`1`2 by ENS_1:def 5
                                  .= [Hom(cod g,a),Hom(dom g,a)]`2
                                   by MCART_1:7
                                  .= Hom(dom g,a) by MCART_1:7
                                  .= (Obj (hom?-(Hom A,dom g))).a by ENS_1:60
                                  .= (hom?-(Hom A,dom g)).a by CAT_1:def 20
                                  .= <|dom g,?>.a by ENS_1:def 26;
                            hence thesis by A47,CAT_1:18;
                          end;
then A48:                Hom(F1.o,F2.o)<> {}
                                & Hom(<|cod g,?>.o,<|dom g,?>.o)<> {}
 by A43;
A49:              (tt).o = (t.o)*(t1.o) by A30,A34,A42,NATTRA_1:27
                         .= f1 * f2 by A22,A48,CAT_1:def 13
                         .= [[Hom(cod g,o),Hom(dom f,o)],
                              hom(f,id o)*hom(g,id o)] by A32,A33,A36,A38,A40,
Th1
                         .= [[Hom(cod g,o),Hom(dom f,o)],hom(f,o)*hom(g,id o)]
                              by ENS_1:53
                         .= [[Hom(cod g,o),Hom(dom f,o)],hom(f,o)*hom(g,o)]
                              by ENS_1:53
                         .= [[Hom(cod g,o),Hom(dom f,o)],hom(g*f,o)]
                              by A22,ENS_1:46;
                  (<|g*f,?>).o = [[Hom(cod(g),o),Hom(dom(g*f),o)],
                                    hom(g*f,id o)] by A30,Def3
                               .= [[Hom(cod g,o),Hom(dom f,o)],hom(g*f,o)]
                                    by A30,ENS_1:53;
                   hence thesis by A49;
                 end;
then (<|g*f,?> )=tt by A31,ISOCAT_1:31;
              hence thesis by A2,A29,A30;
            end;
       then reconsider F as Contravariant_Functor of A,Functors(A,EnsHom(A))
                                                by A3,A8,OPPCAT_1:def 7;

        for f being Element of the Morphisms of A holds
                                F.f = [[<|cod f,?>,<|dom f,?>],<|f,?>] by A2;
       hence thesis;
  end;
uniqueness
  proof
    let h1,h2 be Contravariant_Functor of A,Functors(A,EnsHom(A))
    such that
A50: for f holds h1.f = [[<|cod f,?>,<|dom f,?>],<|f,?>] and
A51: for f holds h2.f = [[<|cod f,?>,<|dom f,?>],<|f,?>];
          now
        let f;
        thus h1.f = [[<|cod f,?>,<|dom f,?>],<|f,?>] by A50
                 .= h2.f by A51;
      end;
    hence thesis by FUNCT_2:113;
  end;
end;

definition let A,B be Category;
 let F be Contravariant_Functor of A,B;
 let c be Object of A;
func F.c -> Object of B equals
    (Obj F).c;
  correctness;
end;

theorem
     for F being Functor of A,Functors(A,EnsHom(A)) st
 Obj F is one-to-one & F is faithful holds F is one-to-one
  proof
     let F be Functor of A,Functors(A,EnsHom(A));
     assume
A1:  Obj F is one-to-one;
     assume
A2:  F is faithful;
         for x1,x2 be set st x1 in dom F & x2 in dom F & F.x1 = F.x2 holds x1 =
x2
        proof
          let x1,x2 be set;
          assume
A3:        x1 in dom F & x2 in dom F & F.x1 = F.x2;
          then reconsider m1=x1,m2=x2 as Morphism of A by FUNCT_2:def 1;
A4:      m1 is Morphism of dom m1,cod m1 by CAT_1:22;
          set o1=dom m1,o2=cod m1;
A5:      m2 is Morphism of dom m2,cod m2 by CAT_1:22;
          set o3=dom m2,o4=cod m2;
          reconsider m1'=m1 as Morphism of o1,o2 by CAT_1:22;
          reconsider m2'=m2 as Morphism of o3,o4 by CAT_1:22;
A6:      Hom(o1,o2) <> {} by CAT_1:19;
A7:      Hom(o3,o4) <> {} by CAT_1:19;
then A8:     Hom(F.o3,F.o4) <> {} by CAT_1:126;
A9:      F.m1'= F.m2 by A3,A6,NATTRA_1:def 1
              .= F.m2' by A7,NATTRA_1:def 1;

A10:     Hom(F.o1,F.o2) <> {} by A6,CAT_1:126;
A11:       (Obj F).o3 = F.o3 by CAT_1:def 20;
              (Obj F).o1 = F.o1 by CAT_1:def 20
                    .=dom (F.m2') by A9,A10,CAT_1:23
                    .= (Obj F).o3 by A8,A11,CAT_1:23;
then A12:       o1=o3 by A1,FUNCT_2:25;
A13:       (Obj F).o4=(F).o4 by CAT_1:def 20;
              (Obj F).o2 = F.o2 by CAT_1:def 20
                    .=cod(F.m2') by A9,A10,CAT_1:23
                    .=(Obj F).o4 by A8,A13,CAT_1:23;
          then m2 is Morphism of o1,o2 by A1,A5,A12,FUNCT_2:25;
          hence thesis by A2,A3,A4,A6,CAT_1:def 24;
       end;
       hence thesis by FUNCT_1:def 8;
   end;

definition let C,D be Category;
           let T be Contravariant_Functor of C,D;
  attr T is faithful means :Def6:
  for c,c' being Object of C st Hom(c,c') <> {}
   for f1,f2 being Morphism of c,c' holds T.f1 = T.f2 implies f1 = f2;
end;

theorem Th6:
 for F being Contravariant_Functor of A,Functors(A,EnsHom(A)) st
   Obj F is one-to-one & F is faithful holds F is one-to-one
    proof
       let F be Contravariant_Functor of A,Functors(A,EnsHom(A));
       assume
A1:    Obj F is one-to-one;
       assume
A2:    F is faithful;
           for x1,x2 be set st x1 in dom F & x2 in
 dom F & F.x1 = F.x2 holds x1 = x2
          proof
            let x1,x2 be set;
            assume
A3:          x1 in dom F & x2 in dom F & F.x1 = F.x2;
            then reconsider m1=x1,m2=x2 as Morphism of A by FUNCT_2:def 1;
A4:        m1 is Morphism of dom m1,cod m1 by CAT_1:22;
            set o1=dom m1,o2=cod m1;
A5:        m2 is Morphism of dom m2,cod m2 by CAT_1:22;
            set o3=dom m2,o4=cod m2;
            reconsider m2'=m2 as Morphism of o3,o4 by CAT_1:22;
A6:        Hom(o1,o2) <> {} by CAT_1:19;
                (Obj F).o1 = cod (F.m2') by A3,OPPCAT_1:33
                      .= (Obj F).o3 by OPPCAT_1:33;
then A7:         o1=o3 by A1,FUNCT_2:25;
                (Obj F).o2 =dom(F.m2') by A3,OPPCAT_1:33
                      .=(Obj F).o4 by OPPCAT_1:33;
            then m2 is Morphism of o1,o2 by A1,A5,A7,FUNCT_2:25;
            hence thesis by A2,A3,A4,A6,Def6;
          end;
          hence thesis by FUNCT_1:def 8;
       end;

theorem Th7:
  Yoneda A is faithful
   proof
      set F = Yoneda A;
      for o1,o2 being Object of A st Hom(o1,o2) <> {}
      for x1,x2 being Morphism of o1,o2 holds F.x1 = F.x2 implies x1 = x2
         proof
           let o1,o2 be Object of A;
           assume
A1:        Hom(o1,o2) <> {};
           let x1,x2 be Morphism of o1,o2;
           assume
A2:        F.x1 = F.x2;
A3:        x1 in Hom(o1,o2) by A1,CAT_1:def 7;
A4:        x2 in Hom(o1,o2) by A1,CAT_1:def 7;
           reconsider dd=(id o2 ) as Morphism of A;
               id o2 in Hom(o2,o2) by CAT_1:55;
           then id o2 in Hom(cod x1,o2) by A3,CAT_1:18;
           then A5: id o2 in Hom(cod x1,dom id o2) by CAT_1:44;
               id o2 in Hom(o2,o2) by CAT_1:55;
           then id o2 in Hom(cod x2,o2) by A4,CAT_1:18;
           then A6: id o2 in Hom(cod x2,dom id o2) by CAT_1:44;
A7:        Hom(o2,o2) <> {} by CAT_1:56;
then A8:        (id o2)*dd =(id o2)*(id o2) by CAT_1:def 13;
then A9:        hom(x1,id o2).dd =(id o2)*(id o2)*(x1 qua Morphism of A) by A5,
ENS_1:def 24
                           .=(id o2)*(x1 qua Morphism of A) by CAT_1:59
                           .=(id o2)*x1 by A1,A7,CAT_1:def 13
                           .=x1 by A1,CAT_1:57;
A10:        hom(x2,id o2).dd =(id o2)*(id o2)*(x2 qua Morphism of A) by A6,A8,
ENS_1:def 24
                           .=(id o2)*(x2 qua Morphism of A) by CAT_1:59
                           .=(id o2)*x2 by A1,A7,CAT_1:def 13
                           .=x2 by A1,CAT_1:57;
A11:        cod x1 = o2 by A3,CAT_1:18 .= cod x2 by A4,CAT_1:18;
A12:        dom x1 = o1 by A3,CAT_1:18 .= dom x2 by A4,CAT_1:18;
               [[<|cod x1,?>,<|dom x1,?>],<|x1,?>]=F.x2 by A2,Def4;
           then [[<|cod x1,?>,<|dom x1,?>],<|x1,?>]=
                [[<|cod x2,?>,<|dom x2,?>],<|x2,?>] by Def4;
           then [<|cod x1,?>,<|dom x1,?>,<|x1,?>]=
                [[<|cod x2,?>,<|dom x2,?>],<|x2,?>] by MCART_1:def 3;
           then [<|cod x1,?>,<|dom x1,?>,<|x1,?>] =
                [<|cod x2,?>,<|dom x2,?>,<|x2,?>] by MCART_1:def 3;
           then <|x1,?>= <|x2,?> by MCART_1:28;
           then [[Hom(cod x1,o2),Hom(dom x1,o2)],hom(x1,id o2)]=
                                                     <|x2,?>.o2 by A11,A12,Def3
;
           then [[Hom(cod x1,o2),Hom(dom x1,o2)],hom(x1,id o2)]=
                [[Hom(cod x2,o2),Hom(dom x2,o2)],hom(x2,id o2)] by Def3;
           then [[Hom(o2,o2),Hom(dom x1,o2)],hom(x1,id o2)]=
                [[Hom(cod x2,o2),Hom(dom x2,o2)],hom(x2,id o2)]
                 by A3,CAT_1:18;
           then [[Hom(o2,o2),Hom(o1,o2)],hom(x1,id o2)]=
                [[Hom(cod x2,o2),Hom(dom x2,o2)],hom(x2,id o2)]
                 by A3,CAT_1:18;
           then [[Hom(o2,o2),Hom(o1,o2)],hom(x1,id o2)]=
                [[Hom(o2,o2),Hom(dom x2,o2)],hom(x2,id o2)]
                 by A4,CAT_1:18;
           then [[Hom(o2,o2),Hom(o1,o2)],hom(x1,id o2)]=
                [[Hom(o2,o2),Hom(o1,o2)],hom(x2,id o2)] by A4,CAT_1:18;
           then [[Hom(o2,o2),Hom(o1,o2)],hom(x1,id o2)]=
                [Hom(o2,o2),Hom(o1,o2),hom(x2,id o2)] by MCART_1:def 3;
           then [Hom(o2,o2),Hom(o1,o2),hom(x1,id o2)]=
                [Hom(o2,o2),Hom(o1,o2),hom(x2,id o2)] by MCART_1:def 3;
           hence thesis by A9,A10,MCART_1:28;
        end;
      hence thesis by Def6;
   end;

theorem
    Yoneda A is one-to-one
  proof
     set F = Yoneda A;
A1:  Obj F is one-to-one
       proof
             for x1,x2 be set st x1 in dom (Obj F) & x2 in dom (Obj F)
                                     & (Obj F).x1 = (Obj F).x2 holds x1 = x2
            proof
              let x1,x2 be set;
              assume
A2:            x1 in dom (Obj F) & x2 in dom (Obj F) & (Obj F).x1 = (Obj F).x2;
              then reconsider c =x1,c1=x2 as Object of A by FUNCT_2:def 1;
                  <|c,?> in Funct(A,EnsHom(A)) by CAT_2:def 2;
              then reconsider d=<|c,?> as Object of Functors(A,EnsHom(A)) by
NATTRA_1:def 18;
              F.(id c)= id d
                proof
                  set X= dom <|id c,?>;
A3:               dom <|id c,?> = the Objects of A by FUNCT_2:def 1
                               .= dom id <|c,?> by FUNCT_2:def 1;
                  for y st y in X holds
                  (<|id c,?>).y =(id <|c,?>).y
                    proof
                      let y; assume y in X;
                      then reconsider z=y as Object of A by FUNCT_2:def 1;
                          <|cod id c,?> is_transformable_to <|c,?>
                        by CAT_1:44;
then A4:                   <|cod id c,?> is_transformable_to <|dom id c,?> by
CAT_1:44;
A5:                  Hom(z,z) <> {} by CAT_1:56;
                      reconsider zz= id z as Morphism of z,z;
                      (<|id c,?>).z
                          = [[Hom(cod id c,z),Hom(dom id c,z)],hom(id c,id z)]
                              by Def3
                         .= [[Hom(c,z),Hom(dom id c,z)],hom(id c,id z)]
                              by CAT_1:44
                         .= [[Hom(c,z),Hom(c,z)],hom(id c,id z)] by CAT_1:44
                         .= [[Hom(c,z),Hom(c,z)],hom(c,id z)] by ENS_1:53
                         .= [[Hom(c,z),Hom(c,cod id z)],hom(c,id z)]
                              by CAT_1:44
                         .= [[Hom(c,dom id z),Hom(c,cod id z)],hom(c,id z)]
                              by CAT_1:44
                         .=(<|c,?> qua Function ).id z by ENS_1:def 22
                         .=(<|c,?>).zz by A5,NATTRA_1:def 1
                         .= id (<|c,?>.z) by NATTRA_1:15
                         .=(id <|c,?> ).z by NATTRA_1:21
                         .=(id <|c,?> qua Function).z by NATTRA_1:def 5;
                     hence thesis by A4,NATTRA_1:def 5;
                   end;
then A6:           <|id c,?>= id <|c,?> by A3,FUNCT_1:9;
                F.(id c) = [[<|cod id c,?>,<|dom id c,?>],<|id c,?>] by Def4
                       .= [[<|c,?>,<|dom id c,?>],<|id c,?>] by CAT_1:44
                       .= [[<|c,?>,<|c,?>],id <|c,?>] by A6,CAT_1:44
                       .=id d by NATTRA_1:def 18;
               hence thesis;
             end;
then A7:        (Obj F).c = d by OPPCAT_1:31;
               <|c1,?> in Funct(A,EnsHom(A)) by CAT_2:def 2;
           then reconsider d1=<|c1,?> as Object of Functors(A,EnsHom(A)) by
NATTRA_1:def 18;
          F.(id c1)= id d1
             proof
               set X= dom <|id c1,?>;
A8:            dom <|id c1,?> = the Objects of A by FUNCT_2:def 1
                             .= dom id <|c1,?> by FUNCT_2:def 1;
               for y st y in X holds
                           (<|id c1,?>).y =(id <|c1,?>).y
                 proof
                   let y; assume y in X;
                   then reconsider z=y as Object of A by FUNCT_2:def 1;
                       <|cod id c1,?> is_transformable_to <|c1,?> by CAT_1:44;
then A9:                <|cod id c1,?> is_transformable_to <|dom id c1,?> by
CAT_1:44;
A10:               Hom(z,z) <> {} by CAT_1:56;
                   reconsider zz= id z as Morphism of z,z;
                   (<|id c1,?>).z
                       = [[Hom(cod id c1,z),Hom(dom id c1,z)],hom(id c1,id z)]
                         by Def3
                      .= [[Hom(c1,z),Hom(dom id c1,z)],hom(id c1,id z)]
                         by CAT_1:44
                      .= [[Hom(c1,z),Hom(c1,z)],hom(id c1,id z)] by CAT_1:44
                      .= [[Hom(c1,z),Hom(c1,z)],hom(c1,id z)] by ENS_1:53
                      .= [[Hom(c1,z),Hom(c1,cod id z)],hom(c1,id z)]
                         by CAT_1:44
                      .= [[Hom(c1,dom id z),Hom(c1,cod id z)],hom(c1,id z)]
                         by CAT_1:44
                      .= (<|c1,?> qua Function ).id z by ENS_1:def 22
                      .= (<|c1,?>).zz by A10,NATTRA_1:def 1
                      .= id (<|c1,?>.z) by NATTRA_1:15
                      .= (id <|c1,?> ).z by NATTRA_1:21
                      .= (id <|c1,?> qua Function).z by NATTRA_1:def 5;
                  hence thesis by A9,NATTRA_1:def 5;
               end;
then A11:        <|id c1,?>= id <|c1,?> by A8,FUNCT_1:9;
             F.(id c1) = [[<|cod id c1,?>,<|dom id c1,?>],<|id c1,?>] by Def4
                     .= [[<|c1,?>,<|dom id c1,?>],<|id c1,?>] by CAT_1:44
                     .= [[<|c1,?>,<|c1,?>],id <|c1,?>] by A11,CAT_1:44
                     .=id d1 by NATTRA_1:def 18;
            hence thesis;
          end;
then A12:     (Obj F).c1 = d1 by OPPCAT_1:31;
        reconsider f=id c1 as Morphism of c1,c1;
A13:     Hom(c1,c1) <> {} by CAT_1:56;
         [[Hom(c,dom f),Hom(c,cod f)],hom(c,f)]= (hom?-(c1)).f
            by A2,A7,A12,ENS_1:def 22;
        then [[Hom(c,dom f),Hom(c,cod f)],hom(c,f)]=
               [[Hom(c1,dom f),Hom(c1,cod f)],hom(c1,f)] by ENS_1:def 22;
        then [Hom(c,dom f),Hom(c,cod f),hom(c,f)]=
                  [[Hom(c1,dom f),Hom(c1,cod f)],hom(c1,f)] by MCART_1:def 3
;
        then [Hom(c,dom f),Hom(c,cod f),hom(c,f)]=
                    [Hom(c1,dom f),Hom(c1,cod f),hom(c1,f)] by MCART_1:def 3
;
        then Hom(c,dom f)=Hom(c1,dom f) by MCART_1:28;
        then Hom(c,dom f)=Hom(c1,c1) by A13,CAT_1:23;
then A14:      Hom(c,c1)=Hom(c1,c1) by A13,CAT_1:23;
         id c1 in Hom(c1,c1) by CAT_1:55;
        then reconsider h=id c1 as Morphism of c,c1 by A14,CAT_1:def 7;
            dom f = c1 & dom h = c by A13,A14,CAT_1:23;
        hence thesis;
      end;
     hence thesis by FUNCT_1:def 8;
    end;
     F is faithful by Th7;
    hence thesis by A1,Th6;
end;

definition let C,D be Category;
           let T be Contravariant_Functor of C,D;
attr T is full means :Def7:
 for c,c' being Object of C st Hom(T.c',T.c) <> {}
    for g being Morphism of T.c',T.c holds
    Hom(c,c') <> {} & ex f being Morphism of c,c' st g = T.f;
end;

theorem
    Yoneda A is full
  proof
     set F = Yoneda A;
     for c,c' being Object of A st Hom(F.c',F.c) <> {}
     for g being Morphism of F.c',F.c holds
     Hom(c,c') <> {} & ex f being Morphism of c,c' st g = F.f
       proof
         let c,c' be Object of A;
         assume
A1:      Hom(F.c',F.c) <> {};
         let g be Morphism of F.c',F.c;
             g in the Morphisms of Functors(A,EnsHom A);
         then g in NatTrans(A,EnsHom A) by NATTRA_1:def 18;
                  then consider F1,F2 being Functor of A,EnsHom A,
                             t being natural_transformation of F1,F2 such that
A2:      g = [[F1,F2],t] &
         F1 is_naturally_transformable_to F2 by NATTRA_1:def 16;

A3:      dom g =F1 & cod g = F2 by A2,NATTRA_1:39;
         A4: dom g =F.c' & cod g= F.c by A1,CAT_1:23;
A5:      F1=F.c' & F2=F.c by A1,A3,CAT_1:23;
             <|c,?> in Funct(A,EnsHom(A)) by CAT_2:def 2;
         then reconsider d=<|c,?> as Object of Functors(A,EnsHom(A)) by
NATTRA_1:def 18;
        A6: F.(id c)= id d
           proof
             set X= dom <|id c,?>;
A7:          dom <|id c,?> = the Objects of A by FUNCT_2:def 1
                          .= dom id <|c,?> by FUNCT_2:def 1;
             for y st y in X holds (<|id c,?>).y =(id <|c,?>).y
              proof
                let y; assume
               y in X;
                then reconsider z=y as Object of A by FUNCT_2:def 1;
                    <|cod id c,?> is_transformable_to <|c,?> by CAT_1:44;
                then A8:             <|cod id c,?> is_transformable_to <|dom id
c,?> by CAT_1:44;
A9:            Hom(z,z) <> {} by CAT_1:56;
                reconsider zz= id z as Morphism of z,z;
                (<|id c,?>).z
                  = [[Hom(cod id c,z),Hom(dom id c,z)],hom(id c,id z)] by Def3
                 .= [[Hom(c,z),Hom(dom id c,z)],hom(id c,id z)] by CAT_1:44
                 .= [[Hom(c,z),Hom(c,z)],hom(id c,id z)] by CAT_1:44
                 .= [[Hom(c,z),Hom(c,z)],hom(c,id z)] by ENS_1:53
                 .= [[Hom(c,z),Hom(c,cod id z)],hom(c,id z)] by CAT_1:44
                 .= [[Hom(c,dom id z),Hom(c,cod id z)],hom(c,id z)] by CAT_1:44
                 .=(<|c,?> qua Function ).id z by ENS_1:def 22
                 .=(<|c,?>).zz by A9,NATTRA_1:def 1
                 .= id (<|c,?>.z) by NATTRA_1:15
                 .=(id <|c,?> ).z by NATTRA_1:21
                 .=(id <|c,?> qua Function).z by NATTRA_1:def 5;
               hence thesis by A8,NATTRA_1:def 5;
             end;
then A10:       <|id c,?>= id <|c,?> by A7,FUNCT_1:9;
            F.(id c) = [[<|cod id c,?>,<|dom id c,?>],<|id c,?>] by Def4
                   .=[[<|c,?>,<|dom id c,?>],<|id c,?>] by CAT_1:44
                   .= [[<|c,?>,<|c,?>],id <|c,?>] by A10,CAT_1:44
                   .=id d by NATTRA_1:def 18;
           hence thesis;
        end;
then A11:     (Obj F).c = d by OPPCAT_1:31;
            <|c',?> in Funct(A,EnsHom(A)) by CAT_2:def 2;
        then reconsider d1=<|c',?> as Object of Functors(A,EnsHom(A)) by
NATTRA_1:def 18;
      A12: F.(id c')= id d1
          proof
            set X= dom <|id c',?>;
A13:         dom <|id c',?> = the Objects of A by FUNCT_2:def 1
                          .= dom id <|c',?> by FUNCT_2:def 1;
            for y st y in X holds (<|id c',?>).y =(id <|c',?>).y
              proof
                let y; assume y in X;
                then reconsider z=y as Object of A by FUNCT_2:def 1;
                    <|cod id c',?> is_transformable_to <|c',?> by CAT_1:44;
                then A14:             <|cod id c',?> is_transformable_to <|dom
id c',?> by CAT_1:44;
A15:            Hom(z,z) <> {} by CAT_1:56;
                reconsider zz= id z as Morphism of z,z;
                (<|id c',?>).z
                = [[Hom(cod id c',z),Hom(dom id c',z)],hom(id c',id z)] by Def3
               .= [[Hom(c',z),Hom(dom id c',z)],hom(id c',id z)] by CAT_1:44
               .= [[Hom(c',z),Hom(c',z)],hom(id c',id z)] by CAT_1:44
               .= [[Hom(c',z),Hom(c',z)],hom(c',id z)] by ENS_1:53
               .= [[Hom(c',z),Hom(c',cod id z)],hom(c',id z)] by CAT_1:44
               .=[[Hom(c',dom id z),Hom(c',cod id z)],hom(c',id z)] by CAT_1:44
               .=(<|c',?> qua Function ).id z by ENS_1:def 22
               .=(<|c',?>).zz by A15,NATTRA_1:def 1
               .= id (<|c',?>.z) by NATTRA_1:15
               .=(id <|c',?> ).z by NATTRA_1:21
               .=(id <|c',?> qua Function).z by NATTRA_1:def 5;
               hence thesis by A14,NATTRA_1:def 5;
            end;
then A16:        <|id c',?>= id <|c',?> by A13,FUNCT_1:9;
             F.(id c') = [[<|cod id c',?>,<|dom id c',?>],<|id c',?>] by Def4
                     .=[[<|c',?>,<|dom id c',?>],<|id c',?>] by CAT_1:44
                     .= [[<|c',?>,<|c',?>],id <|c',?>] by A16,CAT_1:44
                     .=id d1 by NATTRA_1:def 18;
            hence thesis;
         end;
then A17:       (Obj F).c' = d1 by OPPCAT_1:31;
A18:    <|c,?>.c' = (hom?-(Hom A,c)).c' by ENS_1:def 26
                .= (Obj (hom?-(Hom A,c))).c' by CAT_1:def 20
                .= Hom(c,c') by ENS_1:60;
A19:    <|c',?>.c' = (hom?-(Hom A,c')).c' by ENS_1:def 26
                 .= (Obj (hom?-(Hom A,c'))).c' by CAT_1:def 20
                 .= Hom(c',c') by ENS_1:60;
A20:    F.c'= d1 by A12,OPPCAT_1:31;
A21:    F.c = d by A6,OPPCAT_1:31;
A22:   <|c',?> is_transformable_to <|c,?> by A2,A3,A4,A11,A20,NATTRA_1:def 7;
       reconsider t as
                natural_transformation of <|c',?>,<|c,?> by A3,A4,A12,A21,
OPPCAT_1:31;
          Hom(<|c',?>.c',<|c,?>.c') <> {} by A22,NATTRA_1:def 2;
       then A23: (t.c') in Hom(<|c',?>.c',<|c,?>.c') by CAT_1:def 7;
then A24:   dom (t.c') =<|c',?>.c' & cod (t.c') =<|c,?>.c' by CAT_1:18;
A25:   EnsHom A =
 CatStr(# Hom A,Maps Hom A,fDom Hom A,fCod Hom A,fComp Hom A,fId Hom A
#)
          by ENS_1:def 14;
       then reconsider t1=t.c' as Element of Maps Hom A;
            <|c',?>.c' <> {} by A19,CAT_1:56;
        then (the Dom of EnsHom A).(t.c') <> {} by A24,CAT_1:def 2;
then A26:      dom t1 <> {} by A25,ENS_1:def 10;
           t1 in Maps (dom t1,cod t1) by ENS_1:19;
then A27:    t1`2 in Funcs(dom t1,cod t1) by ENS_1:20;
       then A28: cod t1 <> {} by A26,FUNCT_2:14;
       then A29: (fCod Hom A).t1 <> {} by ENS_1:def 11;
       A30: (the Cod of EnsHom A).t1 <> {} by A25,A28,ENS_1:def 11;
       A31: cod (t.c') <> {} by A25,A29,CAT_1:def 3;
       A32: <|c,?>.c' <> {} by A24,A30,CAT_1:def 3;
       thus
      Hom(c,c') <> {} by A18,A23,A31,CAT_1:18;
A33:     dom (t.c')
             =(fDom Hom A).(t.c') by A25,CAT_1:def 2
             .= dom t1 by ENS_1:def 10;
        cod (t.c')
             = (fCod Hom A).(t.c') by A25,CAT_1:def 3
            .= cod t1 by ENS_1:def 11;
     then t1`2 is Function of <|c',?>.c',<|c,?>.c' by A24,A27,A33,FUNCT_2:121;
then A34: dom t1`2 = Hom(c',c') & rng t1`2 c= Hom(c,c')
       by A18,A19,A24,A31,FUNCT_2:def 1,RELSET_1:12;
     then id c' in dom t1`2 by CAT_1:55;
    then t1`2.id c' in rng t1`2 by FUNCT_1:def 5;
     then t1`2.id c' in Hom(c,c') by A34;
     then reconsider f = t1`2.id c'
                as Morphism of c,c' by CAT_1:def 7;
     take f;
A35:  dom f = c & cod f = c' by A18,A32,CAT_1:23;
A36:  <|c',?> is_transformable_to <|c,?> by A2,A5,A17,A21,NATTRA_1:def 7;
         for a being Object of A holds <|f,?>.a =t.a
        proof
          let a be Object of A;
A37:        Hom(<|c',?>.a,<|c,?>.a) <> {} by A36,NATTRA_1:def 2;
then A38:       dom(t.a) =<|c',?>.a & cod (t.a) =<|c,?>.a by CAT_1:23;
          reconsider ta1=t.a as Element of Maps Hom A by A25;
A39:      dom (t.a)
              =(fDom Hom A).(t.a) by A25,CAT_1:def 2
             .= dom ta1 by ENS_1:def 10;
A40:     cod (t.a)
             = (fCod Hom A).(t.a) by A25,CAT_1:def 3
            .= cod ta1 by ENS_1:def 11;
A41:      <|c',?>.a = (hom?-(Hom A,c')).a by ENS_1:def 26
                     .= (Obj (hom?-(Hom A,c'))).a by CAT_1:def 20
                     .= Hom(c',a) by ENS_1:60;
A42:     <|c,?>.a = (hom?-(Hom A,c)).a by ENS_1:def 26
                     .= (Obj (hom?-(Hom A,c))).a by CAT_1:def 20
                     .= Hom(c,a) by ENS_1:60;
         A43: ta1 =[[<|c',?>.a,<|c,?>.a],ta1`2] by A38,A39,A40,ENS_1:8;
           ta1 in Maps (dom ta1,cod ta1) by ENS_1:19;
       then A44: ta1`2 in Funcs(dom ta1,cod ta1) by ENS_1:20;
       then A45: ta1`2 is Function of dom ta1,cod ta1 by FUNCT_2:121;
       A46: ta1`2 is Function of dom(t.a),cod(t.a) by A39,A40,A44,FUNCT_2:121;
A47:    dom ta1`2 = Hom(c',a)
           proof
               per cases;
                 suppose
                        Hom(c',a) = {};
                    hence thesis by A38,A39,A41,A45,FUNCT_2:def 1;
                 end;
                 suppose
                        Hom(c',a) <> {};
                    then Hom(dom f,a) <> {} by A35,ENS_1:42;
              hence thesis by A35,A38,A41,A42,A46,FUNCT_2:def 1;
           end;
           end;
         dom hom(f,a) = Hom(cod f,a)
            proof
               per cases;
                 suppose
                        Hom(cod f,a) = {};
                    hence thesis by FUNCT_2:def 1;
                 end;
                 suppose
                        Hom(cod f,a) <> {};
                    then Hom(c,a) <> {} by A35,ENS_1:42;
              hence thesis by A35,FUNCT_2:def 1;
            end;
            end;
then A48:       dom ta1`2 = dom hom(f,id a) by A35,A47,ENS_1:53;
         set X=dom ta1`2;
             for x be set st x in X holds hom(f,id a).x = ta1`2.x
            proof
              let x be set;assume
           A49: x in X;
              then reconsider y = x as Morphism of cod f,a by A35,A47,
CAT_1:def 7;
              reconsider h=y as Morphism of c',a by A18,A24,A31,CAT_1:23;
A50:          dom h = c' & cod h =a by A47,A49,CAT_1:23;
A51:          dom y =cod f & cod y = a by A35,A47,A49,CAT_1:23;
A52:          Hom(<|c',?>.c',<|c',?>.a ) <> {} by A47,A49,CAT_1:126;
A53:          Hom(<|c,?>.c',<|c,?>.a ) <> {} by A47,A49,CAT_1:126;
              reconsider tc'=<|c',?>.h as Element of Maps Hom A by A25;
              reconsider tch=<|c,?>.h as Element of Maps Hom A by A25;
              reconsider t1=t.c' as Element of Maps Hom A by A25;
A54:          Hom(<|c',?>.c',<|c,?>.c') <> {} by A36,NATTRA_1:def 2;
              then (t.c') in Hom(<|c',?>.c',<|c,?>.c') by CAT_1:def 7;
then A55:          dom (t.c') =<|c',?>.c' &
                         cod (t.c') = <|c,?>.c' by CAT_1:18;
A56:          cod (t.c') = (fCod Hom A).(t.c') by A25,CAT_1:def 3
             .= cod t1 by ENS_1:def 11;
A57:           tc' =[[dom tc',cod tc'],tc'`2] by ENS_1:8;
A58:          tch =[[dom tch,cod tch],tch`2] by ENS_1:8;
A59:         dom (<|c',?>.h)
                        =(fDom Hom A).(<|c',?>.h) by A25,CAT_1:def 2
                       .= dom tc' by ENS_1:def 10;
A60:         cod (<|c',?>.h)
                        = (fCod Hom A).(<|c',?>.h) by A25,CAT_1:def 3
                       .= cod tc' by ENS_1:def 11;
A61:         dom (<|c,?>.h)
                         =(fDom Hom A).(<|c,?>.h) by A25,CAT_1:def 2
                        .= dom tch by ENS_1:def 10;
A62:         [[Hom(c,dom h),Hom(c,cod h)],hom(c,h)]
                                        =(<|c,?> qua Function ).h by
ENS_1:def 22
                                       .=(<|c,?>).h by A47,A49,NATTRA_1:def 1;
         A63: [[Hom(c',dom h),Hom(c',cod h)],hom(c',h)]
                                        =(<|c',?> qua Function ).h by
ENS_1:def 22
                                       .=(<|c',?>).h by A47,A49,NATTRA_1:def 1;
             then [dom tc',cod tc',tc'`2]
               = [[Hom(c',dom h),Hom(c',cod h)],hom(c',h)] by A57,MCART_1:def 3
;
             then [dom tc',cod tc',tc'`2]
                 = [Hom(c',dom h),Hom(c',cod h),hom(c',h)] by MCART_1:def 3
;
then A64:         tc'`2=hom(c',h) by MCART_1:28;
A65:         dom (<|c',?>.h) = (tc')`1`1 by A59,ENS_1:def 4
                            .= [Hom(c',dom h),Hom(c',cod h)]`1
                               by A63,MCART_1:7
                            .=Hom(c',dom h) by MCART_1:7;
A66:         cod(<|c',?>.h) =(tc')`1`2 by A60,ENS_1:def 5
                           .= [Hom(c',dom h),Hom(c',cod h)]`2
                             by A63,MCART_1:7
                           .=Hom(c',cod h) by MCART_1:7;
                 [Hom(c,dom h),Hom(c,cod h),hom(c,h)]=
                                  [[dom tch,cod tch],tch`2] by A58,A62,
MCART_1:def 3
;
             then [Hom(c,dom h),Hom(c,cod h),hom(c,h)]=
                                    [dom tch,cod tch,tch`2] by MCART_1:def 3
;
then A67:         hom(c,h)=tch`2 by MCART_1:28;
         A68: dom (<|c,?>.h) = tch`1`1 by A61,ENS_1:def 4
                           .=[Hom(c,dom h),Hom(c,cod h)]`1
                             by A62,MCART_1:7
                           .=Hom(c,dom h) by MCART_1:7;
A69:        cod t1=[Hom(c,dom h),Hom(c,cod h)]`1 by A18,A50,A55,A56,MCART_1:7
                 .= tch`1`1 by A62,MCART_1:7
                 .=dom tch by ENS_1:def 4;
A70:         cod tc'=(tc')`1`2 by ENS_1:def 5
                  .= [Hom(c',dom h),Hom(c',cod h)]`2 by A63,MCART_1:7
                  .= dom ta1 by A38,A39,A41,A50,MCART_1:7;
A71:         [(t.a),(<|c',?>.h)] in dom(the Comp of EnsHom A) by A38,A41,A50
,A66,CAT_1:40;
A72:        (t.a)*(<|c',?>.h) = (t.a qua Morphism of EnsHom A)*(<|c',?>.h)
                                by A37,A52,CAT_1:def 13
                             .= (fComp Hom A).(ta1,tc') by A25,A71,CAT_1:def 4
                             .= ta1*tc' by A70,ENS_1:def 12
                             .= [[dom tc',cod ta1],ta1`2*tc'`2]
                                 by A70,ENS_1:def 7;
A73:        [(<|c,?>.h),(t.c')] in dom(the Comp of EnsHom A) by A18,A50,A55,A68
,CAT_1:40;
A74:        (<|c,?>.h)*(t.c') =(<|c,?>.h)*(t.c' qua Morphism of EnsHom A)
                               by A53,A54,CAT_1:def 13
                             .= (fComp Hom A).(tch,t1) by A25,A73,CAT_1:def 4
                             .= tch*t1 by A69,ENS_1:def 12
                             .= [[dom t1,cod tch],tch`2*t1`2]
                               by A69,ENS_1:def 7;
                (t.a)*(<|c',?>.h) =(<|c,?>.h)*(t.c') by A2,A5,A17,A21,A47,A49,
NATTRA_1:def 8;
            then [dom tc',cod ta1,(ta1`2*tc'`2)] =
                                [[dom t1,cod tch],(tch`2*t1`2)]
                                 by A72,A74,MCART_1:def 3;
            then [dom tc',cod ta1,(ta1`2*tc'`2)] =
                                [dom t1,cod tch,(tch`2*t1`2)]
                                by MCART_1:def 3;
then A75:         ta1`2*tc'`2=tch`2*t1`2 by MCART_1:28;
                tc' in Maps (dom tc',cod tc') by ENS_1:19;
            then tc'`2 in Funcs(dom tc',cod tc') by ENS_1:20;
            then tc'`2 is Function of Hom(c',dom h),Hom(c',cod h) by A59,A60
,A65,A66,FUNCT_2:121;
               then dom tc'`2 = Hom(c',c') by A47,A49,A50,FUNCT_2:def 1;
then A76:         id c' in dom tc'`2 by CAT_1:55;
A77:         id c' in dom t1`2 by A34,CAT_1:55;
            A78: f in Hom(c,cod f) by A35,CAT_1:18;
            A79: id c' in Hom(c',cod f) by A35,CAT_1:55;
                hom(f,id a).x =hom(f,a).y by ENS_1:53
                         .= y * f by A35,A47,A49,ENS_1:def 21
                         .= tch`2.(t1`2.id c') by A51,A67,A78,ENS_1:def 20
                         .= (ta1`2*tc'`2).(id c') by A75,A77,FUNCT_1:23
                         .= ta1`2.(hom(c',h).id c') by A64,A76,FUNCT_1:23
                         .= ta1`2.(y * id c') by A51,A79,ENS_1:def 20
                         .= ta1`2.x by A35,A51,CAT_1:47;
            hence thesis;
           end;
then hom(f,id a)=ta1`2 by A48,FUNCT_1:9;
       hence thesis by A35,A41,A42,A43,Def3;
     end;
then <|f,?> = t by A2,A5,A17,A21,A35,ISOCAT_1:31;
      hence g =F.f by A2,A3,A4,A17,A21,A35,Def4;
     end;
  hence thesis by Def7;
 end;

