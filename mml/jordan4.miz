:: Subsequences of Standard Special Circular Sequences in $ { \cal E
:: } ^2_ { \rm T } $
::  by Yatsuka Nakamura , Roman Matuszewski and Adam Grabowski
::
:: Received May 12, 1997
:: Copyright (c) 1997 Association of Mizar Users

environ

 vocabularies ARYTM_1, NAT_1, RELAT_1, ARYTM_3, FINSEQ_1, FINSEQ_6, FUNCT_1,
      FINSEQ_5, RFINSEQ, EUCLID, TOPREAL1, JORDAN3, SEQM_3, GOBOARD5, TARSKI,
      BOOLE, PRE_TOPC, TOPREAL4, TOPREAL2, MCART_1, JORDAN4, FINSEQ_4, ARYTM;
 notations TARSKI, XBOOLE_0, SUBSET_1, NUMBERS, XCMPLX_0, REAL_1, NAT_1, NAT_D,
      BINARITH, FUNCT_1, PARTFUN1, FINSEQ_1, FINSEQ_4, FINSEQ_5, STRUCT_0,
      TOPREAL1, TOPREAL2, TOPREAL4, GOBOARD5, PRE_TOPC, EUCLID, FINSEQ_6,
      RFINSEQ, JORDAN3, XXREAL_0;
 constructors PARTFUN1, XXREAL_0, REAL_1, NAT_1, NAT_D, FINSEQ_4, RFINSEQ,
      BINARITH, FINSEQ_5, TOPREAL2, TOPREAL4, GOBOARD5, JORDAN3, VALUED_1,
      SEQ_1;
 registrations XBOOLE_0, RELSET_1, XXREAL_0, XREAL_0, MEMBERED, STRUCT_0,
      EUCLID, SPPOL_2, GOBOARD5, NAT_1, VALUED_1, FUNCT_2;
 requirements REAL, NUMERALS, BOOLE, SUBSET, ARITHM;
 definitions TARSKI, VALUED_1;
 theorems TARSKI, JORDAN3, TOPREAL4, EUCLID, TOPREAL1, TOPREAL2, FUNCT_1,
      SPPOL_1, GOBOARD5, FINSEQ_1, GOBOARD7, NAT_1, SPPOL_2, REAL_1, BINARITH,
      REAL_2, FINSEQ_3, FINSEQ_2, FINSEQ_4, FINSEQ_5, RFINSEQ, FINSEQ_6,
      ENUMSET1, ZFMISC_1, TOPREAL3, XBOOLE_0, XBOOLE_1, XCMPLX_0, XCMPLX_1,
      XREAL_1, XXREAL_0, NAT_D, ORDINAL1;

begin :: Preliminaries

reserve i, i1, i2, i3, j, k, n for Element of NAT,
  r, r2, s for Real;

canceled 5;

theorem Th6:
  for i, j being Nat holds 0<j & j<i & i<j+j implies i mod j<>0
proof
  let i, j be Nat;
  assume
A1: 0<j & j<i & i<j+j;
  assume
A2: i mod j=0;
A3: i-j=i-'j by A1,BINARITH:50;
  i=i-j+j;
  then
A4: i mod j=(i-'j+j) mod j by A1,BINARITH:50
    .=((i-'j)+ (j mod j)) mod j by NAT_D:23
    .=(i-'j+0)mod j by NAT_D:25
    .=(i-'j)mod j;
  i-j<j+j-j by A1,XREAL_1:11;
  then (i-'j) mod j=i-'j by A3,NAT_D:24;
  hence contradiction by A1,A2,A4,BINARITH:54;
end;

theorem Th7:
  for i,j being Nat holds 0<j & j<=i & i<j+j implies i mod j=i-j & i mod j=i-'j
proof
  let i,j be Nat;
  assume
A1: 0<j & j<=i & i<j+j;
  then
A2: i-j=i-'j by BINARITH:50;
  i=i-j+j;
  then
A3: i mod j=(i-'j+j) mod j by A1,BINARITH:50
    .=((i-'j)+(j mod j))mod j by NAT_D:23
    .=((i-'j)+0)mod j by NAT_D:25
    .=(i-'j)mod j;
  i-j<j+j-j by A1,XREAL_1:11;
  hence thesis by A2,A3,NAT_D:24;
end;

theorem Th8:
  for i,j being Nat holds (j+j)mod j=0
proof
  let i, j be Nat;
  thus (j+j)mod j= (2*j) mod j
    .= 0 by NAT_D:13;
end;

theorem Th9:
  for j,k being Nat holds 0<k & k<=j & k mod j=0 implies k=j
proof
  let j,k be Nat;
  assume
A1: 0<k & k<=j & k mod j=0;
  then k >= j by NAT_D:24;
  hence k=j by A1,REAL_1:def 5;
end;

begin :: Some facts about cutting of finite sequences

reserve D for non empty set,
  f1 for FinSequence of D;

canceled 4;

theorem Th14:
  for f1 st f1 is circular & 1<=len f1 holds f1.1=f1.len f1
proof
  let f1;
  assume
A1: f1 is circular & 1<=len f1;
  then
A2: f1/.1=f1/.len f1 by FINSEQ_6:def 1;
  f1.1=f1/.1 by A1,FINSEQ_4:24;
  hence thesis by A1,A2,FINSEQ_4:24;
end;

canceled 3;

theorem Th18:
  for f1,k st k<len f1 holds
  (f1/^k).len (f1/^k)=f1.len f1 & (f1/^k)/.len (f1/^k)=f1/.len f1
proof
  let f1,k;
  assume
A1: k<len f1;
  then k+1<=len f1 by NAT_1:13;
  then
A2: k+1-k<=len f1-k by XREAL_1:11;
A3: 0+1<=len f1 by A1,NAT_1:13;
A4: 1<=len (f1/^k) by A1,A2,RFINSEQ:def 2;
  then len (f1/^k) in Seg len (f1/^k) by FINSEQ_1:3;
  then
A5: len (f1/^k) in dom (f1/^k) & k<=len f1 by A1,FINSEQ_1:def 3;
  len (f1/^k)+k=len f1-k+k by A1,RFINSEQ:def 2
    .=len f1;
  hence
A6: (f1/^k).len (f1/^k)=f1.len f1 by A5,RFINSEQ:def 2;
  (f1/^k)/.len (f1/^k)=(f1/^k).len (f1/^k) by A4,FINSEQ_4:24;
  hence thesis by A3,A6,FINSEQ_4:24;
end;

theorem Th19:
  for g being FinSequence of TOP-REAL 2,i
  st g is_S-Seq & i+1<len g holds g/^i is_S-Seq
proof
  let g be FinSequence of TOP-REAL 2,i;
  assume
A1: g is_S-Seq & i+1<len g;
A2: 1<=i+1 by NAT_1:11;
  then
A3: 1<len g by A1,XXREAL_0:2;
  mid(g,i+1,len g)=g/^(i+1-'1) by A1,JORDAN3:26
    .=g/^i by BINARITH:39;
  hence thesis by A1,A2,A3,JORDAN3:39;
end;

theorem Th20:
  for f1,i1,i2 st 1<=i2 & i2<=i1 & i1<=len f1 holds len mid(f1,i2,i1)=i1-'i2+1
proof
  let f1,i1,i2;
  assume
A1: 1<= i2 & i2<=i1 & i1<= len f1;
  then
A2: 1<=i1 by XXREAL_0:2;
  i2<=len f1 by A1,XXREAL_0:2;
  hence thesis by A1,A2,JORDAN3:27;
end;

theorem Th21:
  for f1,i1,i2 st 1<=i2 & i2<=i1 & i1<=len f1 holds len mid(f1,i1,i2)=i1-'i2+1
proof
  let f1,i1,i2;
  assume
A1: 1<= i2 & i2<=i1 & i1<= len f1;
  per cases by A1,REAL_1:def 5;
  suppose i1=i2;
    hence len mid(f1,i1,i2)=i1-'i2+1 by A1,JORDAN3:27;
  end;
  suppose
A2: i2<i1;
A3: 1<=i1 by A1,XXREAL_0:2;
    i2<=len f1 by A1,XXREAL_0:2;
    hence len mid(f1,i1,i2)=i1-'i2+1 by A1,A2,A3,JORDAN3:27;
  end;
end;

theorem Th22:
  for f1,i1,i2,j st 1<=i1 & i1<=i2 & i2<=len f1
  holds mid(f1,i1,i2).(len mid(f1,i1,i2))=f1.i2
proof
  let f1,i1,i2,j;
  assume
A1: 1<=i1 & i1<=i2 & i2<=len f1;
  then
A2: 1<=i2 by XXREAL_0:2;
A3: i1<=len f1 by A1,XXREAL_0:2;
  then len mid(f1,i1,i2)=i2-'i1+1 by A1,A2,JORDAN3:27;
  then 1<=len mid(f1,i1,i2) by NAT_1:11;
  then
A4: mid(f1,i1,i2).(len mid(f1,i1,i2))
  =f1.(len mid(f1,i1,i2)+i1-'1) by A1,A2,A3,JORDAN3:27
    .=f1.(i2-'i1+1+i1-'1) by A1,A2,A3,JORDAN3:27;
  i2-'i1+1+i1=i2-i1+1+i1 by A1,BINARITH:50
    .=i2+1;
  hence thesis by A4,BINARITH:39;
end;

theorem Th23:
  for f1,i1,i2,j st 1<=i1 & i1<=len f1 & 1<=i2 & i2<=len f1
  holds mid(f1,i1,i2).(len mid(f1,i1,i2))=f1.i2
proof
  let f1,i1,i2,j;
  assume
A1: 1<=i1 & i1<=len f1 & 1<=i2 & i2<=len f1;
  per cases;
  suppose i1<=i2;
    hence mid(f1,i1,i2).(len mid(f1,i1,i2))=f1.i2 by A1,Th22;
  end;
  suppose
A2: i1>i2;
    then len mid(f1,i1,i2)=i1-'i2+1 by A1,JORDAN3:27;
    then 1<=len mid(f1,i1,i2) by NAT_1:11;
    then
A3: mid(f1,i1,i2).(len mid(f1,i1,i2))
    =f1.(i1-'len mid(f1,i1,i2)+1) by A1,A2,JORDAN3:27
      .=f1.(i1-'(i1-'i2+1)+1) by A1,A2,JORDAN3:27;
    0<=i2-1 by A1,XREAL_1:50;
    then i1-0>=i1-(i2-1) by REAL_2:106;
    then i1>=i1-i2+1;
    then i1-'i2+1<=i1 by A2,BINARITH:50;
    then i1-'(i1-'i2+1)+1=i1-(i1-'i2+1)+1 by BINARITH:50
      .=i1-(i1-'i2)
      .=i1-(i1-i2) by A2,BINARITH:50
      .=i2;
    hence thesis by A3;
  end;
end;

theorem Th24:
  for f1,i1,i2,j st 1<=i2 & i2<=i1 & i1<=len f1 & 1<=j
  & j<=i1-'i2+1 holds mid(f1,i1,i2).j=f1.(i1-'j+1)
proof
  let f1,i1,i2,j;
  assume
A1: 1<= i2 & i2<=i1 & i1<= len f1 & 1<=j & j<=i1-'i2+1;
  then
A2: j<=len mid(f1,i1,i2) by Th21;
  per cases by A1,REAL_1:def 5;
  suppose
A3: i1=i2;
    then
A4: i1-'i2+1=0+1 by BINARITH:51
      .=1;
    then j+i1-'1=1+i1-'1 by A1,XXREAL_0:1
      .=1+i1-1 by BINARITH:55
      .=i1-1+1
      .=i1-'1+1 by A1,A3,BINARITH:50
      .=i1-'j+1 by A1,A4,XXREAL_0:1;
    hence mid(f1,i1,i2).j=f1.(i1-'j+1) by A1,A2,A3,JORDAN3:27;
  end;
  suppose
A5: i2<i1;
A6: 1<=i1 by A1,XXREAL_0:2;
    i2<=len f1 by A1,XXREAL_0:2;
    hence mid(f1,i1,i2).j=f1.(i1-'j+1) by A1,A2,A5,A6,JORDAN3:27;
  end;
end;

theorem Th25:
  for f1,i1,i2 st 1<=i2 & i2<=i1 & i1<=len f1 & 1<=j & j<=i1-'i2+1
  holds mid(f1,i1,i2).j=mid(f1,i2,i1).(i1-i2+1-j+1)
  & i1-i2+1-j+1=i1-'i2+1-'j+1
proof
  let f1,i1,i2;
  assume
A1: 1<=i2 & i2<=i1 & i1<=len f1 & 1<=j & j<=i1-'i2+1;
  then
A2: 1<=i1 by XXREAL_0:2;
A3: i2<=len f1 by A1,XXREAL_0:2;
A4: j-j<=i1-'i2+1-j by A1,XREAL_1:11;
  1-j<=j-j by A1,XREAL_1:11;
  then i1-'i2+(1-j)<=i1-'i2+0 by XREAL_1:9;
  then i1-'i2+1-'j<=i1-'i2 by A4,BINARITH:def 3;
  then
A5: i1-'i2+1-'j+1<=i1-'i2+1 by XREAL_1:8;
A6: i1-'i2+1=i1-i2+1 by A1,BINARITH:50;
  i2-1>=0 by A1,XREAL_1:50;
  then
A7: i1-(i2-1)<=i1-0 by REAL_2:106;
A8: (i1-'i2+1-'j+1) =i1-'i2+1-j+1 by A1,BINARITH:50
    .=i1-i2+1-j+1 by A1,BINARITH:50;
A9: 1<=(i1-'i2+1-'j+1) by NAT_1:11;
  now per cases by A1,REAL_1:def 5;
    case
A10:  i1>i2;
      len mid(f1,i2,i1)=i1-'i2+1 by A1,A2,A3,JORDAN3:27;
      then
A11:  mid(f1,i2,i1).(i1-'i2+1-'j+1)=f1.((i1-'i2+1-'j+1)+i2-'1)
      by A1,A2,A3,A5,A9,JORDAN3:27;
A12:  (i1-'i2+1-'j+1)+i2-'1 =(i1-'i2+1-'j+1)+i2-1 by A1,BINARITH:55
        .=i1-j+1 by A8
        .=i1-'j+1 by A1,A6,A7,BINARITH:50,XXREAL_0:2;
      len mid(f1,i1,i2)=i1-'i2+1 by A1,A2,A3,A10,JORDAN3:27;
      hence mid(f1,i1,i2).j=mid(f1,i2,i1).(i1-i2+1-j+1)
      & i1-i2+1-j+1=i1-'i2+1-'j+1 by A1,A2,A3,A8,A10,A11,A12,JORDAN3:27;
    end;
    case
A13:  i1=i2;
      then i1-'i2+1=0+1 by BINARITH:51
        .=1;
      then i1-i2+1-j+1=0+1-1+1 by A1,A13,XXREAL_0:1
        .=1;
      hence mid(f1,i1,i2).j=mid(f1,i2,i1).(i1-i2+1-j+1)
      & i1-i2+1-j+1=i1-'i2+1-'j+1 by A8,A13;
    end;
  end;
  hence thesis;
end;

theorem
  for f1,i1,i2 st 1<=i1 & i1<=i2 & i2<=len f1 & 1<=j & j<=i2-'i1+1
  holds mid(f1,i1,i2).j=mid(f1,i2,i1).(i2-i1+1-j+1)
  & i2-i1+1-j+1=i2-'i1+1-'j+1
proof
  let f1,i1,i2;
  assume
A1: 1<=i1 & i1<=i2 & i2<=len f1 & 1<=j & j<=i2-'i1+1;
  set k=i2-'i1+1-'j+1;
A2: 1<=k by NAT_1:11;
  j-1>=0 by A1,XREAL_1:50;
  then
A3: k+0<=k+(j-1) by XREAL_1:9;
A4: i2-'i1+1-j=i2-'i1+1-'j by A1,BINARITH:50;
  i2-i1+1-j+1=i2-'i1+1-j+1 by A1,BINARITH:50
    .=i2-'i1+1-'j+1 by A1,BINARITH:50;
  then i2-i1+1-k+1=j;
  hence thesis by A1,A2,A3,A4,Th25;
end;

theorem Th27:
  for f1,k st 1<=k & k<=len f1 holds mid(f1,k,k)=<*f1/.k*> & len mid(f1,k,k)=1
proof
  let f1,k;
  assume
A1: 1<=k & k<=len f1;
A2: len (f1/^(k-'1))=len f1-'(k-'1) by JORDAN3:19;
  k-'1+1=k by A1,BINARITH:53;
  then
A3: (f1/^(k-'1)).1=f1.k by A1,JORDAN3:23;
A4: f1/.k=f1.k by A1,FINSEQ_4:24;
  k-'1+1<=len f1 by A1,BINARITH:53;
  then k-'1+1-(k-'1)<=len f1-(k-'1) by XREAL_1:11;
  then
A5: 1<=1 & 1<=len (f1/^(k-'1)) by A2,BINARITH:57;
  then
A6: f1/^(k-'1) is non empty by FINSEQ_1:25;
  k-'k+1=k-k+1 by BINARITH:50
    .=1;
  then mid(f1,k,k)=(f1/^(k-'1))|1 by JORDAN3:def 1
    .=<*(f1/^(k-'1))/.1*> by A6,FINSEQ_5:23;
  hence thesis by A3,A4,A5,FINSEQ_1:56,FINSEQ_4:24;
end;

theorem Th28:
  mid(f1,0,0)=f1|1
proof
  0-'0+1=0-0+1 by BINARITH:50
    .=1;
  then
A1: mid(f1,0,0)=(f1/^(0-'1))|1 by JORDAN3:def 1;
  0-1<0;
  then 0-'1=0 by BINARITH:def 3;
  hence thesis by A1,FINSEQ_5:31;
end;

theorem Th29:
  for f1,k st len f1<k holds mid(f1,k,k)=<*>D
proof
  let f1,k;
  assume
A1: len f1<k;
  then
A2: 0+1<=k by NAT_1:13;
  k-'k+1=k-k+1 by BINARITH:50
    .=1;
  then
A3: mid(f1,k,k)=(f1/^(k-'1))|1 by JORDAN3:def 1;
  len f1+1<=k by A1,NAT_1:13;
  then len f1+1-1<=k-1 by XREAL_1:11;
  then len f1<=k-'1 by A2,BINARITH:50;
  then f1/^(k-'1)=<*>D by FINSEQ_5:35;
  hence thesis by A3,FINSEQ_5:81;
end;

theorem Th30:
  for f1,i1,i2 holds mid(f1,i1,i2)=Rev mid(f1,i2,i1)
proof
  let f1;
  let k1,k2 be Element of NAT;
  now per cases;
    case
A1:   k1<=k2;
      then
A2:   mid(f1,k1,k2)=(f1/^(k1-'1))|(k2-'k1+1) by JORDAN3:def 1;
      now per cases by A1,REAL_1:def 5;
        case k1<k2;
          then mid(f1,k2,k1)=Rev mid(f1,k1,k2) by A2,JORDAN3:def 1;
          hence mid(f1,k1,k2)=Rev mid(f1,k2,k1) by FINSEQ_6:29;
        end;
        case
A3:       k1=k2;
          k1=0 or k1>0;
          then
A4:       k1=0 or 0+1<=k1 by NAT_1:13;
          now per cases by A4;
            case k1=0;
              then
A5:           mid(f1,k1,k2)=f1|1 by A3,Th28;
              now per cases;
                case len f1=0;
                  then f1=<*>D by FINSEQ_1:32;
                  then f1|1=<*>D by FINSEQ_5:81;
                  hence mid(f1,k1,k2)=Rev mid(f1,k2,k1) by A3,A5,FINSEQ_5:82;
                end;
                case len f1<>0;
                  then f1 <> <*>D by FINSEQ_1:32;
                  then f1|1=<*f1/.1*> by FINSEQ_5:23;
                  hence mid(f1,k1,k2)=Rev mid(f1,k2,k1) by A3,A5,FINSEQ_5:63;
                end;
              end;
              hence mid(f1,k1,k2)=Rev mid(f1,k2,k1);
            end;
            case 1<=k1 & k1<= len f1;
              then mid(f1,k1,k1)=<*f1/.k1*> by Th27;
              hence mid(f1,k1,k2)=Rev mid(f1,k2,k1) by A3,FINSEQ_5:63;
            end;
            case len f1<k1;
              then mid(f1,k1,k1)=<*>D by Th29;
              hence mid(f1,k1,k2)=Rev mid(f1,k2,k1) by A3,FINSEQ_5:82;
            end;
          end;
          hence mid(f1,k1,k2)=Rev mid(f1,k2,k1);
        end;
      end;
      hence mid(f1,k1,k2)=Rev mid(f1,k2,k1);
    end;
    case
A6:   k1>k2;
      then mid(f1,k1,k2)=Rev ((f1/^(k2-'1))|(k1-'k2+1)) by JORDAN3:def 1;
      hence mid(f1,k1,k2)=Rev mid(f1,k2,k1) by A6,JORDAN3:def 1;
    end;
  end;
  hence thesis;
end;

theorem Th31:
  for f being FinSequence of TOP-REAL 2,i1,i2,i
  st 1<=i1 & i1<i2 & i2<=len f & 1<=i & i<i2-'i1+1
  holds LSeg(mid(f,i1,i2),i)=LSeg(f,i+i1-'1)
proof
  let f be FinSequence of TOP-REAL 2,i1,i2,i;
  assume
A1: 1<=i1 & i1<i2 & i2<=len f & 1<=i & i<i2-'i1+1;
  then
A2: i<len mid(f,i1,i2) by Th20;
  then
A3: i+1<=len mid(f,i1,i2) by NAT_1:13;
  i2-i1+1=i2-'i1+1 by A1,BINARITH:50;
  then i+i1<i2-i1+1+i1 by A1,XREAL_1:8;
  then i+i1+1-1<=i2+1-1 by NAT_1:13;
  then
A4: i+i1-1+1<=len f by A1,XXREAL_0:2;
  1+1<=i+i1 by A1,XREAL_1:9;
  then 1+1-1<=i+i1-1 by XREAL_1:11;
  then
A5: 1<=i+i1-'1 & i+i1-'1+1<=len f by A1,A4,BINARITH:55;
  then
A6: LSeg(f,i+i1-'1)=LSeg(f/.(i+i1-'1),f/.(i+i1-'1+1)) by TOPREAL1:def 5;
A7: 1<=i & i+1<=len mid(f,i1,i2) by A1,A2,NAT_1:13;
A8: 1<i+i1-'1+1 by A5,NAT_1:13;
A9: i+i1-'1<len f by A5,NAT_1:13;
A10: i+i1-'1+1<=len f by A1,A4,BINARITH:55;
A11: i+i1-'1+1=i+i1-1+1 by A1,BINARITH:55
    .=i+1+i1-1
    .=i+1+i1-'1 by A1,
  BINARITH:55;
A12: mid(f,i1,i2)/.i=mid(f,i1,i2).i by A1,A2,FINSEQ_4:24
    .=f.(i+i1-'1) by A1,JORDAN3:31
    .=f/.(i+i1-'1) by A5,A9,FINSEQ_4:24;
A13: i+1<=i2-'i1+1 by A1,NAT_1:13;
A14: 1<=1+i by NAT_1:11;
  mid(f,i1,i2)/.(i+1)=mid(f,i1,i2).(i+1) by A7,FINSEQ_4:24,NAT_1:11
    .=f.(i+1+i1-'1) by A1,A13,A14,JORDAN3:31
    .=f/.(i+1+i1-'1) by A8,A10,A11,FINSEQ_4:24;
  hence thesis by A1,A3,A6,A11,A12,TOPREAL1:def 5;
end;

theorem Th32:
  for f being FinSequence of TOP-REAL 2,i1,i2,i
  st 1<=i1 & i1<i2 & i2<=len f & 1<=i & i<i2-'i1+1
  holds LSeg(mid(f,i2,i1),i)=LSeg(f,i2-'i)
proof
  let f be FinSequence of TOP-REAL 2,i1,i2,i;
  assume
A1: 1<=i1 & i1<i2 & i2<=len f & 1<=i & i<i2-'i1+1;
  then
A2: len mid(f,i2,i1)=i2-'i1+1 by Th21;
A3: i<len mid(f,i2,i1) by A1,Th21;
A4: i+(len mid(f,i2,i1)-'i) =len mid(f,i2,i1) by A1,A2,BINARITH:53;
  i+1<=len mid(f,i2,i1) by A3,NAT_1:13;
  then
A5: i+1-i<=len mid(f,i2,i1)-i by XREAL_1:11;
  len mid(f,i2,i1)+1<=len mid(f,i2,i1)+i by A1,XREAL_1:8;
  then len mid(f,i2,i1)<len mid(f,i2,i1)+i by NAT_1:13;
  then len mid(f,i2,i1)-i<len mid(f,i2,i1)+i-i by XREAL_1:11;
  then
A6: 1<=len mid(f,i2,i1)-'i & len mid(f,i2,i1)-'i<i2-'i1+1
  by A2,A5,BINARITH:57;
  i2<=i2+(i1-'1) by NAT_1:11;
  then i2<=i2+(i1-1) by A1,BINARITH:50;
  then i2-(i1-1)<=i2+(i1-1)-(i1-1) by XREAL_1:11;
  then i2-i1+1<=i2;
  then
A7: i2-'i1+1<=i2 by A1,BINARITH:50;
A8: i2-'i1+1-'i+i1-'1 =i2-'i1+1-'i+i1-1 by A1,BINARITH:55
    .=i2-'i1+1-i+i1-1 by A1,BINARITH:50
    .=i2-'i1-i+i1
    .=i2-i1-i+i1 by A1,BINARITH:50
    .=i2-i
    .=i2-'i by A1,A7,BINARITH:50,XXREAL_0:2;
  thus LSeg(mid(f,i2,i1),i)
  =LSeg(Rev mid(f,i2,i1),len mid(f,i2,i1)-'i) by A4,SPPOL_2:2
    .=LSeg(mid(f,i1,i2),len mid(f,i2,i1)-'i) by Th30
    .=LSeg(f,len mid(f,i2,i1)-'i+i1-'1) by A1,A6,Th31
    .=LSeg(f,i2-'i) by A1,A8,Th21;
end;

begin :: Dividing of special circular sequences into parts

definition
  let n be Element of NAT, f be FinSequence;
  func S_Drop(n,f) -> Element of NAT equals
  :Def1:
  (n mod (len f -'1)) if n mod (len f -'1)<>0 otherwise len f -'1;
  correctness;
end;

theorem Th33:
  for f being FinSequence holds S_Drop(len f-'1,f)=len f-'1
proof
  let f be FinSequence;
  (len f-'1) mod (len f-'1)=0 by NAT_D:25;
  hence thesis by Def1;
end;

theorem Th34:
  for n being Element of NAT, f being FinSequence
  st 1<=n & n<=len f-'1 holds S_Drop(n,f)=n
proof
  let n be Element of NAT,f be FinSequence;
  assume
A1: 1<=n & n<=len f-'1;
  per cases by A1,REAL_1:def 5;
  suppose n<len f-'1;
    then n mod (len f-'1)=n by NAT_D:24;
    hence thesis by A1,Def1;
  end;
  suppose n=len f-'1;
    hence thesis by Th33;
  end;
end;

theorem Th35:
  for n being Element of NAT,f being FinSequence holds
  S_Drop(n,f)=S_Drop(n+(len f-'1),f) & S_Drop(n,f)=S_Drop(len f-'1+n,f)
proof
  let n be Element of NAT,f be FinSequence;
A1: (n+(len f-'1))mod (len f-'1) = (n+(len f-'1)*1)mod (len f-'1)
    .=n mod (len f-'1) by NAT_D:21;
  per cases;
  suppose
A2: n mod (len f-'1)<>0;
    then S_Drop(n,f)=n mod (len f-'1) by Def1;
    hence thesis by A1,A2,Def1;
  end;
  suppose
A3: n mod (len f-'1)=0;
    then S_Drop(n,f)=len f-'1 by Def1;
    hence thesis by A1,A3,Def1;
  end;
end;

definition
  let f be non constant standard special_circular_sequence,
  g be FinSequence of TOP-REAL 2,i1,i2 be Element of NAT;
  pred g is_a_part>_of f,i1,i2 means
  :Def2:
  1<=i1 & i1+1<=len f &
  1<=i2 & i2+1<=len f & g.len g=f.i2 & 1<=len g & len g<len f &
  (for i being Nat st 1<=i & i<=len g holds g.i=f.S_Drop((i1+i)-'1,f));
end;

definition
  let f be non constant standard special_circular_sequence,
  g be FinSequence of TOP-REAL 2,i1,i2 be Element of NAT;
  pred g is_a_part<_of f,i1,i2 means
  :Def3:
  1<=i1 & i1+1<=len f &
  1<=i2 & i2+1<=len f & g.len g=f.i2 & 1<=len g & len g<len f &
  (for i being Nat st 1<=i & i<=len g holds g.i=f.S_Drop(len f +i1-'i,f));
end;

definition
  let f be non constant standard special_circular_sequence,
  g be FinSequence of TOP-REAL 2,i1,i2 be Element of NAT;
  pred g is_a_part_of f,i1,i2 means
  :Def4:
  g is_a_part>_of f,i1,i2 or g is_a_part<_of f,i1,i2;
end;

theorem
  for f being non constant standard special_circular_sequence,
  g being FinSequence of TOP-REAL 2,i1,i2 being Element of NAT st
  g is_a_part_of f,i1,i2 holds 1<=i1 & i1+1<=len f &
  1<=i2 & i2+1<=len f & g.len g=f.i2 & 1<=len g & len g<len f &
  ((for i being Element of NAT st 1<=i & i<=len g
  holds g.i=f.S_Drop((i1+i)-'1,f))or
  (for i being Element of NAT st 1<=i & i<=len g
  holds g.i=f.S_Drop(len f +i1-'i,f)))
proof
  let f be non constant standard special_circular_sequence,
  g be FinSequence of TOP-REAL 2,i1,i2 be Element of NAT;
  assume
A1: g is_a_part_of f,i1,i2;
  now per cases by A1,Def4;
    case g is_a_part>_of f,i1,i2;
      hence 1<=i1 & i1+1<=len f &
      1<=i2 & i2+1<=len f & g.len g=f.i2 & 1<=len g & len g<len f &
      ((for i being Element of NAT st 1<=i & i<=len g
      holds g.i=f.S_Drop((i1+i)-'1,f))or
      (for i being Element of NAT st 1<=i & i<=len g
      holds g.i=f.S_Drop(len f +i1-'i,f))) by Def2;
    end;
    case g is_a_part<_of f,i1,i2;
      hence 1<=i1 & i1+1<=len f &
      1<=i2 & i2+1<=len f & g.len g=f.i2 & 1<=len g & len g<len f &
      ((for i being Element of NAT st 1<=i & i<=len g
      holds g.i=f.S_Drop((i1+i)-'1,f))or
      (for i being Element of NAT st 1<=i & i<=len g
      holds g.i=f.S_Drop(len f +i1-'i,f))) by Def3;
    end;
  end;
  hence thesis;
end;

theorem Th37:
  for f being non constant standard special_circular_sequence,
  g being FinSequence of TOP-REAL 2,i1,i2 being Element of NAT st
  g is_a_part>_of f,i1,i2 & i1<=i2 holds len g=i2-'i1+1 & g=mid(f,i1,i2)
proof
  let f be non constant standard special_circular_sequence,
  g be FinSequence of TOP-REAL 2,i1,i2 be Element of NAT;
  assume
A1: g is_a_part>_of f,i1,i2 & i1<=i2;
  then
A2: 1<=i1 & i1+1<=len f &
  1<=i2 & i2+1<=len f & g.len g=f.i2 & 1<=len g & len g<len f &
  (for i being Element of NAT st 1<=i & i<=len g
  holds g.i=f.S_Drop((i1+i)-'1,f)) by Def2;
  then
A3: i1+1-1<=len f-1 by XREAL_1:11;
  then
A4: 1<=len f-1 by A2,XXREAL_0:2;
  then
A5: len f-1=len f-'1 by BINARITH:57;
A6: 0<>len f-'1 by A4,BINARITH:57;
  i1<=i1+1 by NAT_1:11;
  then
A7: i1<=len f by A2,XXREAL_0:2;
  i2<=i2+1 by NAT_1:11;
  then
A8: i2<=len f by A2,XXREAL_0:2;
A9: f.i2=f.S_Drop((i1+len g)-'1,f) by A2;
A10: now per cases;
    case (i1+len g)-'1 mod (len f -'1)<>0;
      then 0<(i1+len g)-'1 mod (len f -'1);
      then 0+1<=(i1+len g)-'1 mod (len f -'1) by NAT_1:13;
      hence 1<=S_Drop((i1+len g)-'1,f) by Def1;
    end;
    case (i1+len g)-'1 mod (len f -'1)=0;
      then
A11:  S_Drop((i1+len g)-'1,f)=len f -'1 by Def1;
      i1<=len f -'1 by A2,BINARITH:67;
      hence 1<=S_Drop((i1+len g)-'1,f) by A2,A11,XXREAL_0:2;
    end;
  end;
A12: now per cases;
    case (i1+len g)-'1 mod (len f -'1)<>0;
      then
A13:  S_Drop((i1+len g)-'1,f)=((i1+len g)-'1 mod (len f -'1)) by Def1;
A14:  i1<=len f -'1 by A2,BINARITH:67;
      then
A15:  1<=len f -'1 by A2,XXREAL_0:2;
A16:  ((i1+len g)-'1 mod (len f -'1)) <len f-'1 by A2,A14,NAT_D:1;
      len f -'1<len f by A15,BINARITH:69;
      hence S_Drop((i1+len g)-'1,f)< len f by A13,A16,XXREAL_0:2;
    end;
    case (i1+len g)-'1 mod (len f -'1)=0;
      then
A17:  S_Drop((i1+len g)-'1,f)=len f -'1 by Def1;
      i1<=len f -'1 by A2,BINARITH:67;
      then 1<=len f -'1 by A2,XXREAL_0:2;
      hence S_Drop((i1+len g)-'1,f)< len f by A17,BINARITH:69;
    end;
  end;
A18: i2<=len f -'1 by A2,BINARITH:67;
  then 1<=len f -'1 by A2,XXREAL_0:2;
  then len f -'1<len f by BINARITH:69;
  then
A19: i2<len f by A18,XXREAL_0:2;
  now per cases by REAL_1:def 5;
    case
A20:  i2<S_Drop((i1+len g)-'1,f);
      then
A21:  f/.i2<>f/.(S_Drop((i1+len g)-'1,f)) by A2,A12,GOBOARD7:38;
      i2<=len f by A2,BINARITH:64;
      then
A22:  f/.i2=f.i2 by A2,FINSEQ_4:24;
      1<=S_Drop((i1+len g)-'1,f) by A2,A20,XXREAL_0:2;
      hence contradiction by A9,A12,A21,A22,FINSEQ_4:24;
    end;
    case i2>S_Drop((i1+len g)-'1,f);
      then
A23:  f/.i2<>f/.(S_Drop((i1+len g)-'1,f)) by A10,A19,GOBOARD7:38;
      i2<=len f by A2,BINARITH:64;
      then f/.i2=f.i2 by A2,FINSEQ_4:24;
      hence contradiction by A9,A10,A12,A23,FINSEQ_4:24;
    end;
    case
A24:  i2=S_Drop((i1+len g)-'1,f);
      now per cases;
        case
A25:      (i1+len g)-'1 mod (len f -'1)<>0;
          (ex n being Nat st i1+len g -'1
          =(len f-'1)*n+((i1+len g-'1) mod (len f -'1)) &
          ((i1+len g-'1) mod (len f -'1))<len f -'1) by A6,NAT_D:def 2;
          then consider n being Nat such that
A26:      i1+len g -'1 =(len f-'1)*n+((i1+len g)-'1 mod (len f -'1));
A27:      i1+len g -'1=(len f-'1)*n+i2 by A24,A25,A26,Def1;
          now per cases;
            case n=0;
              then
A28:          i2=i1+len g -'1 by A24,A25,A26,Def1;
              1<=i1+len g by A2,NAT_1:12;
              then
A29:          i1+len g-'1=i1+len g-1 by BINARITH:50;
              then
A30:          i2+1-i1 = len g by A28;
A31:          i2-i1+1=len g by A28,A29;
              then len g=i2-'i1+1 by A1,BINARITH:50;
              then
A32:          len g = len g & len mid(f,i1,i2) = len g
              by A1,A2,A7,A8,JORDAN3:27;
              for j be Nat st j in Seg len g holds g.j = mid(f,i1,i2).j
              proof
                let j be Nat;
                assume j in Seg len g;
                then
A33:            1<=j & j<=len g by FINSEQ_1:3;
                then
A34:            g.j=f.S_Drop((i1+j)-'1,f) by A1,Def2;
A35:            j in NAT by ORDINAL1:def 13;
A36:            i1+j-'1=i1+j-1 by A33,BINARITH:55;
                i1+j>=1+1 by A2,A33,XREAL_1:9;
                then
A37:            i1+j-'1<>0 by A36;
                j+i1<=i2-i1+1+i1 by A28,A29,A33,XREAL_1:8;
                then
A38:            i1+j<=len f by A2,XXREAL_0:2;
                now per cases;
                  case
A39:                i1+j=len f;
                    then (i1+j-'1) mod (len f-'1)=0 by NAT_D:25;
                    hence S_Drop(i1+j-'1,f)=i1+j-'1 by A39,Def1;
                  end;
                  case i1+j<>len f;
                    then i1+j<len f by A38,REAL_1:def 5;
                    then i1+j-1<len f-1 by XREAL_1:11;
                    then i1+j-'1<len f-'1 by A2,A5,BINARITH:55;
                    then (i1+j-'1)mod (len f-'1)=i1+j-'1 by NAT_D:24;
                    hence S_Drop((i1+j)-'1,f)=i1+j-'1 by A37,Def1;
                  end;
                end;
                hence g.j = mid(f,i1,i2).j
                by A1,A2,A8,A30,A33,A34,A35,JORDAN3:31;
              end;
              hence len g=i2-'i1+1 & g=mid(f,i1,i2)
              by A1,A31,A32,BINARITH:50,FINSEQ_2:10;
            end;
            case n<>0;
              then 0<n;
              then 0+1<=n by NAT_1:13;
              then
A40:          (len f-'1)*n>=(len f-'1)*1 by XREAL_1:66;
              len g+1<=len f by A2,NAT_1:13;
              then len g+1-1<=len f-1 by XREAL_1:11;
              then len g<=len f-'1 by BINARITH:def 3;
              then len g+i1<=len f-'1+i2 by A1,XREAL_1:9;
              then i1+len g<len f-'1+i2+1 by NAT_1:13;
              then
A41:          i1+len g-1<len f-'1+i2+1-1 by REAL_1:92;
              i1<=i1+len g by NAT_1:11;
              then 1<=i1+len g by A2,XXREAL_0:2;
              then i1+len g-1=i1+len g-'1 by BINARITH:50;
              then i1+len g-'1-i2<len f-'1+i2-i2 by A41,REAL_1:92;
              hence contradiction by A27,A40;
            end;
          end;
          hence len g=i2-'i1+1 & g=mid(f,i1,i2);
        end;
        case
A42:      (i1+len g)-'1 mod (len f -'1)=0;
          (ex n being Nat st i1+len g -'1
          =(len f-'1)*n+((i1+len g-'1) mod (len f -'1)) &
          ((i1+len g-'1) mod (len f -'1))<len f -'1) by A6,NAT_D:def 2;
          then consider n being Nat such that
A43:      i1+len g -'1 =(len f-'1)*n+((i1+len g-'1) mod (len f -'1));
A44:      i1+len g -'1=i2*n by A24,A42,A43,Def1;
          now
            assume n=0;
            then
A45:        i1+len g<=1 by A42,A43,BINARITH:54;
            i1+len g>=1+1 by A2,XREAL_1:9;
            hence contradiction by A45,XXREAL_0:2;
          end;
          then n>0;
          then
A46:      n>=0+1 by NAT_1:13;
          now
            assume n>1;
            then n>=1+1 by NAT_1:13;
            then
A47:        i1+len g -'1>=(len f-'1)*(1+1) by A42,A43,NAT_1:4;
            len g -1<len f-1 by A2,XREAL_1:11;
            then i1+(len g -1)<len f-'1+(len f-'1) by A3,A5,XREAL_1:10;
            then
A48:        i1+len g -1<len f-'1+(len f-'1);
            1<=len g+i1 by A2,NAT_1:12;
            hence contradiction by A47,A48,BINARITH:50;
          end;
          then n=1 by A46,XXREAL_0:1;
          then
A49:      i1+len g-1=i2 by A2,A44,BINARITH:57;
A50:      i2-i1=i2-'i1 by A1,BINARITH:50;
          then
A51:      len g=i2-'i1+1 by A49;
          then
A52:      len g = len g & len mid(f,i1,i2) = len g by A1,A2,A7, A8,JORDAN3:27;
          for j be Nat st j in Seg len g holds g.j = mid(f,i1,i2).j
          proof
            let j be Nat;
            assume j in Seg len g;
            then
A53:        1<=j & j<=len g by FINSEQ_1:3;
            then
A54:        g.j=f.S_Drop((i1+j)-'1,f) by A1,Def2;
A55:        j in NAT by ORDINAL1:def 13;
A56:        i1+j-'1=i1+j-1 by A53,BINARITH:55;
            i1+j>=1+1 by A2,A53,XREAL_1:9;
            then
A57:        i1+j-'1<>0 by A56;
            j+i1<=i2-i1+1+i1 by A49,A53,XREAL_1:8;
            then
A58:        i1+j<=len f by A2,XXREAL_0:2;
            now per cases;
              case
A59:            i1+j=len f;
                then (i1+j-'1) mod (len f-'1)=0 by NAT_D:25;
                hence S_Drop(i1+j-'1,f)=i1+j-'1 by A59,Def1;
              end;
              case i1+j<>len f;
                then i1+j<len f by A58,REAL_1:def 5;
                then i1+j-1<len f-1 by XREAL_1:11;
                then
A60:            i1+j-'1<len f-'1 by A2,A5,BINARITH:55;
                then (i1+j-'1) mod (len f-'1)<>0 by A57,NAT_D:24;
                then S_Drop((i1+j)-'1,f)=(i1+j-'1) mod (len f-'1) by Def1;
                hence S_Drop((i1+j)-'1,f)=i1+j-'1 by A60,NAT_D:24;
              end;
            end;
            hence g.j = mid(f,i1,i2).j by A1,A2,A8,A51,A53,A54,A55,JORDAN3:31;
          end;
          hence len g=i2-'i1+1 & g=mid(f,i1,i2) by A49,A50,A52,FINSEQ_2:10;
        end;
      end;
      hence len g=i2-'i1+1 & g=mid(f,i1,i2);
    end;
  end;
  hence thesis;
end;

theorem Th38:
  for f being non constant standard special_circular_sequence,
  g being FinSequence of TOP-REAL 2,i1,i2 being Element of NAT st
  g is_a_part>_of f,i1,i2 & i1>i2 holds len g=len f+i2-'i1
  & g=mid(f,i1,len f-'1)^(f|i2) & g=mid(f,i1,len f-'1)^mid(f,1,i2)
proof
  let f be non constant standard special_circular_sequence,
  g be FinSequence of TOP-REAL 2,i1,i2 be Element of NAT;
  assume
A1: g is_a_part>_of f,i1,i2 & i1>i2;
  then
A2: 1<=i1 & i1+1<=len f &
  1<=i2 & i2+1<=len f & g.len g=f.i2 & 1<=len g & len g<len f &
  (for i being Element of NAT st 1<=i & i<=len g
  holds g.i=f.S_Drop((i1+i)-'1,f)) by Def2;
A3: i1<=i1+1 by NAT_1:12;
  then
A4: i1<=len f by A2,XXREAL_0:2;
A5: i1+1-1<=len f-1 by A2,XREAL_1:11;
  then
A6: 1<=len f-1 by A2,XXREAL_0:2;
  then
A7: len f-1=len f-'1 by BINARITH:57;
A8: 0<len f-'1 by A6,BINARITH:57;
A9: 0<>len f-'1 by A6,BINARITH:57;
  i1<=len f -'1 by A2,BINARITH:67;
  then 1<=len f -'1 by A2,XXREAL_0:2;
  then
A10: len f -'1<len f by BINARITH:69;
  i2<=i2+1 by NAT_1:11;
  then
A11: i2<=len f by A2,XXREAL_0:2;
A12: f.i2=f.S_Drop((i1+len g)-'1,f) by A2;
A13: now per cases;
    case (i1+len g)-'1 mod (len f -'1)<>0;
      then 0<(i1+len g)-'1 mod (len f -'1);
      then 0+1<=(i1+len g)-'1 mod (len f -'1) by NAT_1:13;
      hence 1<=S_Drop((i1+len g)-'1,f) by Def1;
    end;
    case (i1+len g)-'1 mod (len f -'1)=0;
      then
A14:  S_Drop((i1+len g)-'1,f)=len f -'1 by Def1;
      i1<=len f -'1 by A2,BINARITH:67;
      hence 1<=S_Drop((i1+len g)-'1,f) by A2,A14,XXREAL_0:2;
    end;
  end;
A15: now per cases;
    case (i1+len g)-'1 mod (len f -'1)<>0;
      then
A16:  S_Drop((i1+len g)-'1,f)=((i1+len g)-'1 mod (len f -'1)) by Def1;
A17:  i1<=len f -'1 by A2,BINARITH:67;
      then
A18:  1<=len f -'1 by A2,XXREAL_0:2;
A19:  ((i1+len g)-'1 mod (len f -'1)) <len f-'1 by A2,A17,NAT_D:1;
      len f -'1<len f by A18,BINARITH:69;
      hence S_Drop((i1+len g)-'1,f)< len f by A16,A19,XXREAL_0:2;
    end;
    case (i1+len g)-'1 mod (len f -'1)=0;
      then
A20:  S_Drop((i1+len g)-'1,f)=len f -'1 by Def1;
      i1<=len f -'1 by A2,BINARITH:67;
      then 1<=len f -'1 by A2,XXREAL_0:2;
      hence S_Drop((i1+len g)-'1,f)< len f by A20,BINARITH:69;
    end;
  end;
A21: i2<=len f -'1 by A2,BINARITH:67;
  then
A22: 1<=len f -'1 by A2,XXREAL_0:2;
  then len f -'1<len f by BINARITH:69;
  then
A23: i2<len f by A21,XXREAL_0:2;
  now per cases by REAL_1:def 5;
    case
A24:  i2<S_Drop((i1+len g)-'1,f);
      then
A25:  f/.i2<>f/.(S_Drop((i1+len g)-'1,f)) by A2,A15,GOBOARD7:38;
      i2<=len f by A2,BINARITH:64;
      then
A26:  f/.i2=f.i2 by A2,FINSEQ_4:24;
      1<=S_Drop((i1+len g)-'1,f) by A2,A24,XXREAL_0:2;
      hence contradiction by A12,A15,A25,A26,FINSEQ_4:24;
    end;
    case i2>S_Drop((i1+len g)-'1,f);
      then
A27:  f/.i2<>f/.(S_Drop((i1+len g)-'1,f)) by A13,A23,GOBOARD7:38;
      i2<=len f by A2,BINARITH:64;
      then f/.i2=f.i2 by A2,FINSEQ_4:24;
      hence contradiction by A12,A13,A15,A27,FINSEQ_4:24;
    end;
    case
A28:  i2=S_Drop((i1+len g)-'1,f);
      now per cases;
        case
A29:      (i1+len g)-'1 mod (len f -'1)<>0;
          (ex n being Nat st i1+len g -'1
          =(len f-'1)*n+((i1+len g-'1) mod (len f -'1)) &
          ((i1+len g-'1) mod (len f -'1))<len f -'1)or
          ((i1+len g-'1) mod (len f -'1))=0 & len f-'1=0 by NAT_D:def 2;
          then consider n being Nat such that
A30:      i1+len g -'1 =(len f-'1)*n+((i1+len g)-'1 mod (len f -'1))
          by A6,BINARITH:57;
A31:      i1+len g -'1=(len f-'1)*n+i2 by A28,A29,A30,Def1;
          now per cases;
            case n=0;
              then i2=i1+len g -'1 by A28,A29,A30,Def1;
              then i2+1=i1+len g -1+1 by A2,BINARITH:57
                .=i1+len g;
              hence contradiction by A1,A2,XREAL_1:10;
            end;
            case n<>0;
              then 0<n;
              then
A32:          0+1<=n by NAT_1:13;
              now per cases by A32,REAL_1:def 5;
                case
A33:              1=n;
                  len f-'1=len f-1 by A22,BINARITH:57;
                  then
A34:              i1+len g-1=len f-1+i2 by A2,A31,A33, BINARITH:55;
                  then
A35:              len g=len f+i2-i1;
A36:              len (mid(f,i1,len f-'1)^(f|i2))
                  = len (mid(f,i1,len f-'1))+ len(f|i2) by FINSEQ_1:35;
A37:              1

<=i1 & i1<=len f & 1<=len f-'1 & len f-'1<=len f & i1<=len f-'1
                  by A2,A3,A5,A6,BINARITH:57,68,XXREAL_0:2;
                  then
A38:              len (mid(f,i1,len f-'1))=len f-'1-'i1+ 1 by JORDAN3:27;
A39:              len f-'1-'i1=len f-'1-i1 by A5,A7,BINARITH:50;
A40:              len f-'1-'i1+1 =len f-1-i1+1 by A5,A7,BINARITH:50
                    .=len f-i1;
                  then len (mid(f,i1,len f-'1)^(f|i2))=len f-i1+i2
                  by A11,A36,A38,FINSEQ_1:80
                    .=len f+i2-i1
                    .=len f+i2-'i1 by A4,BINARITH:55;
                  then
A41:              len g = len g & len (mid(f,i1,len f-'1 )^(f|i2))=len g
                  by A4,A35,BINARITH:55;
                  for j be Nat st j in Seg len g holds
                  g.j =(mid(f,i1,len f-'1)^(f|i2)).j
                  proof
                    let j be Nat;
                    assume
A42:                j in Seg len g;
                    then
A43:                1<=j & j<=len g by FINSEQ_1:3;
                    then
A44:                g.j=f.S_Drop((i1+j)-'1,f) by A1, Def2;
A45:                j in NAT by ORDINAL1:def 13;
A46:                i1+j-'1=i1+j-1 by A43,BINARITH:55;
                    i1+j>=1+1 by A2,A43,XREAL_1:9;
                    then
A47:                i1+j-'1<>0 by A46;
                    now per cases;
                      case
A48:                    j<=len mid(f,i1,len f-'1);
                        then j in dom mid(f,i1,len f-'1) by A43,FINSEQ_3:27;
                        then
A49:                    (mid(f,i1,len f-'1)^(f|i2) ).j =mid(f,i1,len f-'1).j
                        by FINSEQ_1:def 7;
A50:                    1<=i1 & i1<=len f-'1 & len f-'1<=len f & 1<=j & j<=
                        len f-'1-i1+1
                        by A37,A39,A42,A48,FINSEQ_1:3,JORDAN3:27;
A51:                    j+i1<=len f-'1-i1+1+i1 by A38,A39,A48,XREAL_1:8;
                        now per cases;
                          case
A52:                        i1+j=len f;
                            then (i1+j-'1) mod (len f-'1)=0 by NAT_D:25;
                            hence S_Drop(i1+j-'1,f)=i1+j-'1 by A52,Def1;
                          end;
                          case i1+j<>len f;
                            then i1+j<len f by A7,A51,REAL_1:def 5;
                            then i1+j-1<len f-1 by XREAL_1:11;
                            then
A53:                        i1+j-'1<len f-'1 by A2,A7,BINARITH:55;
                            then (i1+j-'1) mod (len f-'1)<>0 by A47,NAT_D:24;

then S_Drop((i1+j)-'1,f)=(i1+j-'1) mod (len f-'1) by Def1;
                            hence S_Drop((i1+j)-'1,f)=i1+j-'1 by A53,NAT_D:24;
                          end;
                        end;
                        hence g.j = (mid(f,i1,len f-'1)^(f|i2)).j
                        by A44,A45,A49,A50,JORDAN3:31;
                      end;
                      case
A54:                    j>len mid(f,i1,len f-'1);
                        then j+i1>len f-i1+i1 by A38,A40,XREAL_1:8;
                        then
A55:                    i1+j-len f>len f-len f by XREAL_1:11;
                        then
A56:                    i1+j-'len f=i1+j-len f by BINARITH:def 3;
A57:                    (mid(f,i1,len f-'1)^(f|i2)).j
                        =(f|i2).(j-len mid(f,i1,len f-'1))
                        by A41,A43,A54,JORDAN3:15;
A58:                    j

-len mid(f,i1,len f-'1)=j-(len f-i1) by A37,A40,JORDAN3:27
                          .=j+i1-len f;
                        j<=len f+i2-i1 by A34,A42,FINSEQ_1:3;
                        then j+i1<=len f+i2-i1+i1 by XREAL_1:8;
                        then j+i1-len f<=len f+i2-len f by XREAL_1:11;
                        then
A59:                    (f|i2).(j-len mid(f,i1,len f-'1))
                        =f.(i1+j-'len f) by A56,A58,FINSEQ_3:121;
                        len mid(f,i1,len f-'1)+1<=j by A54,NAT_1:13;
                        then
A60:                    len mid(f,i1,len f-'1)+1- len mid(f,i1,len f-'1)
                        <=j -len mid(f,i1,len f-'1) by XREAL_1:11;
A61:                    i1+j-1=i1+j-'1 by A2,BINARITH:55;
                        1+len f<=i1+j-len f+len f by A38,A40,A60,XREAL_1:8;
                        then 1+len f -1<=i1+j-1 by XREAL_1:11;
                        then
A62:                    len f-'1<i1+j-'1 by A10, A61,XXREAL_0:2;
A63:                    i1+1-1<=len f-1 by A2,XREAL_1:11;
                        j<len f by A2,A43,XXREAL_0:2;
                        then j<=len f-1 by SPPOL_1:6;
                        then
A64:                    i1+j<=(len f-'1)+(len f-'1 ) by A7,A63,XREAL_1:9;
                        i1+j<i1+j+1 by NAT_1:13;
                        then i1+j-1<i1+j+1-1 by XREAL_1:11;
                        then
A65:                    i1+j-'1<(len f-'1)+(len f -'1) by A61,A64,XXREAL_0:2;
                        now per cases;
                          case (i1+j-'1) mod (len f -'1)=0;
                            hence contradiction by A8,A62,A65,Th6;
                          end;
                          case (i1+j-'1) mod (len f -'1)<>0;
                            then
A66:                        S_Drop
                            (i1+j-'1,f)= (i1+j-'1) mod (len f -'1) by Def1;
                            i1+j-'len f+(len f-'1)=i1+j-'len f+(len f-1)
                            by A6,BINARITH:57
                              .=i1+j-len f+(len f-1) by A55,BINARITH:def 3
                              .=i1+j-1
                              .=i1+j-'1 by A43,BINARITH:55;
                            then
A67:                        (i1+j-'1) mod (len f-'1)
                            =(i1+j-'len f+((len f-'1)mod (len f-'1)))
                            mod (len f-'1) by NAT_D:23
                              .=(i1+j-'len f+0)
                            mod (len f-'1) by NAT_D:25
                              .=(i1+j-'len f) mod (len f-'1);
                            i1+j-(len f-'1)<=(len f-'1)+(len f-'1)-(len f-'1)
                            by A64,XREAL_1:11;
                            then i1+j-(len f-1)<=(len f-'1) by A6,BINARITH:57;
                            then i1+j-'len f+1<=(len f-'1) by A56;
                            then i1+j-'len f<(len f-'1) by NAT_1:13;
                            hence g.j = (mid(f,i1,len f-'1)^(f|i2)).j
                            by A44,A57,A59,A66,A67,NAT_D:24;
                          end;
                        end;
                        hence g.j = (mid(f,i1,len f-'1)^(f|i2)).j;
                      end;
                    end;
                    hence g.j = (mid(f,i1,len f-'1)^(f|i2)).j;
                  end;
                  hence len g=len f+i2-'i1 & g=mid(f,i1,len f-'1)^(f|i2)
                  by A4,A35,A41,BINARITH:55,FINSEQ_2:10;
                end;
                case 1<n;
                  then 1+1<=n by NAT_1:13;
                  then (len f-'1)*n>=(len f-'1)*(1+1) by XREAL_1:66;
                  then
A68:              i1+len g-'1>=(len f-'1)*(1+1)+i2 by A31,XREAL_1:8;
A69:              i1+1-1<=len f-1 by A2,XREAL_1:11;
                  len g-1<len f-'1 by A2,A7,XREAL_1:11;
                  then
A70:              i1+(len g-1)<len f-'1+(len f-'1) by A7,A69,XREAL_1:10;
A71:              i1+len g-1=i1+len g-'1 by A2,BINARITH:55;
                  (len f-'1)*(1+1)<=(len f-'1)*(1+1)+i2 by NAT_1:11;
                  hence contradiction by A68,A70,A71,XXREAL_0:2;
                end;
              end;
              hence len g=len f+i2-'i1 & g=mid(f,i1,len f-'1)^(f|i2);
            end;
          end;
          hence len g=len f+i2-'i1 & g=mid(f,i1,len f-'1)^(f|i2);
        end;
        case
A72:      (i1+len g)-'1 mod (len f -'1)=0;
          (ex n being Nat st i1+len g -'1
          =(len f-'1)*n+((i1+len g-'1) mod (len f -'1)) &
          ((i1+len g-'1) mod (len f -'1))<len f -'1) by A9,NAT_D:def 2;
          then consider n being Nat such that
A73:      i1+len g -'1 =(len f-'1)*n+((i1+len g-'1) mod (len f -'1));
          now
            assume n=0;
            then
A74:        i1+len g<=1 by A72,A73,BINARITH:54;
            i1+len g>=1+1 by A2,XREAL_1:9;
            hence contradiction by A74,XXREAL_0:2;
          end;
          then n>0;
          then
A75:      n>=0+1 by NAT_1:13;
          now
            assume n>1;
            then n>=1+1 by NAT_1:13;
            then
A76:        i1+len g -'1>=(len f-'1)*(1+1) by A72,A73,NAT_1:4;
            len g -1<len f-1 by A2,XREAL_1:11;
            then i1+(len g -1)<len f-'1+(len f-'1) by A5,A7,XREAL_1:10;
            then
A77:        i1+len g -1<len f-'1+(len f-'1);
            1<=len g+i1 by A2,NAT_1:12;
            hence contradiction by A76,A77,BINARITH:50;
          end;
          then n=1 by A75,XXREAL_0:1;
          then i1+len g-'1=i2 by A28,A72,A73,Def1;
          then
A78:      i1+len g-1=i2 by A2,BINARITH:57;
A79:      1-1<=len g-1 by A2,XREAL_1:11;
          i2-i2<i1-i2 by A1,XREAL_1:11;
          then -0>-(i1-i2) by XREAL_1:26;
          hence contradiction by A78,A79;
        end;
      end;
      hence len g=len f+i2-'i1 & g=mid(f,i1,len f-'1)^(f|i2);
    end;
  end;
  hence thesis by A2,JORDAN3:25;
end;

theorem Th39:
  for f being non constant standard special_circular_sequence,
  g being FinSequence of TOP-REAL 2,i1,i2 being Element of NAT st
  g is_a_part<_of f,i1,i2 & i1>=i2 holds len g=i1-'i2+1 & g=mid(f,i1,i2)
proof
  let f be non constant standard special_circular_sequence,
  g be FinSequence of TOP-REAL 2,i1,i2 be Element of NAT;
  assume
A1: g is_a_part<_of f,i1,i2 & i1>=i2;
  then
A2: 1<=i1 & i1+1<=len f &
  1<=i2 & i2+1<=len f & g.len g=f.i2 & 1<=len g & len g<len f &
  (for i being Element of NAT st 1<=i & i<=len g
  holds g.i=f.S_Drop((len f+i1-'i),f)) by Def3;
  then i2+1-1<=len f-1 by XREAL_1:11;
  then
A3: 1<=len f-1 by A2,XXREAL_0:2;
  then
A4: len f-1=len f-'1 by BINARITH:57;
A5: 0<len f-'1 by A3,BINARITH:57;
A6: 0<>len f-'1 by A3,BINARITH:57;
  i1<=i1+1 by NAT_1:11;
  then
A7: i1<=len f by A2,XXREAL_0:2;
A8: f.i2=f.S_Drop((len f+i1-'len g),f) by A2;
A9: now per cases;
    case (len f+i1-'len g) mod (len f -'1)<>0;
      then 0<(len f+i1-'len g) mod (len f -'1);
      then 0+1<=(len f+i1-'len g) mod (len f -'1) by NAT_1:13;
      hence 1<=S_Drop((len f+i1-'len g),f) by Def1;
    end;
    case (len f+i1-'len g) mod (len f -'1)=0;
      then
A10:  S_Drop((len f+i1-'len g),f)=len f -'1 by Def1;
      i2<=len f -'1 by A2,BINARITH:67;
      hence 1<=S_Drop((len f+i1-'len g),f) by A2,A10,XXREAL_0:2;
    end;
  end;
A11: now per cases;
    case (len f+i1-'len g) mod (len f -'1)<>0;
      then
A12:  S_Drop((len f+i1-'len g),f)
      =((len f+i1-'len g) mod (len f -'1)) by Def1;
A13:  i2<=len f -'1 by A2,BINARITH:67;
      then
A14:  1<=len f -'1 by A2,XXREAL_0:2;
A15:  ((len f+i1-'len g) mod (len f -'1)) <len f-'1 by A2,A13,NAT_D:1;
      len f -'1<len f by A14,BINARITH:69;
      hence S_Drop((len f+i1-'len g),f)< len f by A12,A15,XXREAL_0:2;
    end;
    case (len f+i1-'len g) mod (len f -'1)=0;
      then
A16:  S_Drop((len f+i1-'len g),f)=len f -'1 by Def1;
      i2<=len f -'1 by A2,BINARITH:67;
      then 1<=len f -'1 by A2,XXREAL_0:2;
      hence S_Drop((len f+i1-'len g),f)< len f by A16,BINARITH:69;
    end;
  end;
A17: i2<=len f -'1 by A2,BINARITH:67;
  then 1<=len f -'1 by A2,XXREAL_0:2;
  then len f -'1<len f by BINARITH:69;
  then
A18: i2<len f by A17,XXREAL_0:2;
  now per cases by REAL_1:def 5;
    case
A19:  i2<S_Drop((len f+i1-'len g),f);
      then
A20:  f/.i2<>f/.(S_Drop((len f+i1-'len g),f)) by A2,A11,GOBOARD7:38;
      i2<=len f by A2,NAT_1:13;
      then
A21:  f/.i2=f.i2 by A2,FINSEQ_4:24;
      1<=S_Drop((len f+i1-'len g),f) by A2,A19,XXREAL_0:2;
      hence contradiction by A8,A11,A20,A21,FINSEQ_4:24;
    end;
    case i2>S_Drop((len f+i1-'len g),f);
      then
A22:  f/.i2<>f/.(S_Drop((len f+i1-'len g),f)) by A9,A18,GOBOARD7:38;
      i2<=len f by A2,NAT_1:13;
      then f/.i2=f.i2 by A2,FINSEQ_4:24;
      hence contradiction by A8,A9,A11,A22,FINSEQ_4:24;
    end;
    case
A23:  i2=S_Drop((len f+i1-'len g),f);
      now per cases;
        case
A24:      (len f+i1-'len g) mod (len f -'1)<>0;
          (ex n being Nat st len f+i1-'len g
          =(len f-'1)*n+((len f+i1-'len g) mod (len f -'1)) &
          ((len f+i1-'len g) mod (len f -'1))<len f -'1) by A6,NAT_D:def 2;
          then consider n being Nat such that
A25:      len f+i1-'len g =(len f-'1)*n+((len f+i1-'len g) mod (len f -'1));
A26:      len f+i1-'len g=(len f-'1)*n+i2 by A23,A24,A25,Def1;
          n>=0;
          then
A27:      n=0 or n>=0+1 by NAT_1:13;
          now per cases by A27,REAL_1:def 5;
            case n=0;
              then i2=len f+i1-'len g by A23,A24,A25,Def1;
              then i2=len f+i1-len g by A2,BINARITH:55;
              then i2+len g=i1+len f;
              hence contradiction by A1,A2,XREAL_1:10;
            end;
            case n=1;
              then
A28:          len f-1+i2=len f+i1-'len g by A4,A23,A24,A25, Def1;
A29:          len f+i1-'len g=len f+i1-len g by A2,BINARITH:55;
              then
A30:          len g=i1-i2+1 by A28;
              then
A31:          len g=i1-'i2+1 by A1,BINARITH:50;
              then
A32:          len g = len g & len mid(f,i1,i2) = len g by A1,A2,A7,Th21;
              for j be Nat st j in Seg len g holds g.j =mid(f,i1,i2).j
              proof
                let j be Nat;
                assume j in Seg len g;
                then
A33:            1<=j & j<=len g by FINSEQ_1:3;
                then
A34:            g.j=f.S_Drop(len f+i1-'j,f) by A1,Def3;
A35:            j in NAT by ORDINAL1:def 13;
                1-1<=i2-1 by A2,XREAL_1:11;
                then
A36:            i1-0>=i1-(i2-1) by REAL_2:106;
                then
A37:            j<=i1 by A28,A29,A33,XXREAL_0:2;
A38:            i1-'j+1=i1-j+1 by A28,A29,A33,A36,BINARITH:50,XXREAL_0:2;
                now per cases;
                  case len f+i1-'j=len f-'1;
                    then len f+i1-j=len f-'1 by A28,A29,A33,A36,BINARITH:55,
                    XXREAL_0:2
                      .=len f-1 by A3, BINARITH:57;
                    then i1-j=-1;
                    hence contradiction by A37,XREAL_1:50;
                  end;
                  case len f+i1-'j<>len f-'1;
A39:                len f+i1-'j=len f+i1-j by A28,A29,A33,A36,BINARITH:55,
                    XXREAL_0:2;
                    now
                      i1+1+0<len f+j by A2,A33,XREAL_1:10;
                      then i1+1-j<len f+j-j by XREAL_1:11;
                      then i1+1-j-1<len f-1 by XREAL_1:11;
                      then i1-j<len f-1;

then i1-'j<len f-'1 by A4,A28,A29,A33,A36,BINARITH:50,XXREAL_0: 2;
                      then
A40:                  i1-'j+1<=len f-'1 by NAT_1:13;
                      now per cases by A40,REAL_1:def 5;
                        case
A41:                      i1-'j+1=len f-'1;

len f+i1-'j=len f-1+1+i1-j by A28,A29,A33,A36,BINARITH:55 ,XXREAL_0:2
                            .=len f-'1+(i1-j+1) by A4

.=len f-'1+(len f-'1) by A28,A29,A33,A36,A41,BINARITH:50, XXREAL_0:2;
                          then (len f+i1-'j)mod (len f-'1)=0 by Th8;
                          hence S_Drop(len f+i1-'j,f)=i1-'j+1 by A41,Def1;
                        end;
                        case
A42:                      i1-'j+1<len f-'1;
A43:                      len f=len f-1+1
                            .=len f-'1+1 by A3,BINARITH:57;
                          len f-'1+1+i1-'j=len f-'1+1+i1-j by A28,A29,A33,A36,
                          BINARITH:55,XXREAL_0:2
                            .=len f-'1+(1+(i1-j))

.=len f-'1+(1+(i1-'j)) by A28,A29,A33,A36,BINARITH:50, XXREAL_0:2;
                          then (len f+i1-'j)mod (len f-'1)

=(((len f-'1)mod (len f-'1))+(1+(i1-'j)))mod (len f-'1) by A43,NAT_D:22
                            .=(0+(1+(i1-'j)))mod (len f-'1) by NAT_D:25
                            .=(i1-'j+1) by A42,NAT_D:24;
                          then
A44:                      S_Drop(len f+i1-'j,f)= (len f+i1-'j)mod (len f-'1)
                          by Def1;
                          len f-1+1+i1-j=(len f-1)+(i1-j+1);
                          then
A45:                      len f+i1-'j=i1-'j+1+( len f-'1) by A3,A38,A39,
                          BINARITH:57;
                          (len f-'1)mod(len f-'1)=0 by NAT_D:25;
                          then S_Drop(len f+i1-'j,f)=(i1-'j+1+0)mod (len f-'1)
                          by A44,A45,NAT_D:22
                            .=(i1-'j+1)mod (len f-'1);
                          hence S_Drop(len f+i1-'j,f)=i1-'j+1 by A42,NAT_D:24;
                        end;
                      end;
                      hence S_Drop(len f+i1-'j,f)=i1-'j+1;
                    end;
                    hence S_Drop(len f+i1-'j,f)=i1-'j+1;
                  end;
                end;
                hence g.j = mid(f,i1,i2).j by A1,A2,A7,A31,A33,A34,A35,Th24;
              end;
              hence len g=i1-'i2+1 & g=mid(f,i1,i2) by A1,A30,A32,BINARITH:50
              ,FINSEQ_2:10;
            end;
            case n>1;
              then 1+1<=n by NAT_1:13;
              then
A46:          len f+i1-'len g-i2>=(len f-'1)*(1+1) by A26, XREAL_1:66;
              i1+1+0<i1+1+len g by A2,XREAL_1:10;
              then i1+1-len g<i1+1+len g-len g by REAL_1:92;
              then i1-len g+1-i2<i1+1-i2 by REAL_1:92;
              then
A47:          len f-1+(i1-len g-i2+1)<len f-1+(i1+1-i2) by XREAL_1:10;
A48:          i1+1-i2<=len f-i2 by A2,XREAL_1:11;
              len f-i2<=len f-1 by A2,REAL_2:106;
              then i1+1-i2<=len f-1 by A48,XXREAL_0:2;
              then len f-1+(i1+1-i2)<=len f-1+(len f-1) by XREAL_1:9;
              then len f+i1-len g-i2<len f-1+(len f-1) by A47,XXREAL_0:2;
              hence contradiction by A2,A4,A46,BINARITH:55;
            end;
          end;
          hence len g=i1-'i2+1 & g=mid(f,i1,i2);
        end;
        case
A49:      (len f+i1-'len g) mod (len f -'1)=0;
          (ex n being Nat st len f+i1-'len g
          =(len f-'1)*n+((len f+i1-'len g) mod (len f -'1)) &
          ((len f+i1-'len g) mod (len f -'1))<len f -'1)or
          ((len f+i1-'len g) mod (len f -'1))=0 & len f-'1=0 by NAT_D:def 2;
          then consider n being Nat such that
A50:      len f+i1-'len g =(len f-'1)*n+((len f+i1-'len g) mod (len f -'1))
          by A3,BINARITH:57;
A51:      len f+i1-'len g=i2*n by A23,A49,A50,Def1;
          now
            assume n=0;
            then
A52:        len g>=len f+i1 by A49,A50,BINARITH:54;
            len f<=len f +i1 by NAT_1:11;
            hence contradiction by A2,A52,XXREAL_0:2;
          end;
          then n>0;
          then
A53:      n>=0+1 by NAT_1:13;
A54:      now per cases by A53,REAL_1:def 5;
            case n>1;
              then
A55:          n>=1+1 by NAT_1:13;
              i1+1+1<=len f+len g by A2,XREAL_1:9;
              then 1+(i1+1)-len g<=len f+len g-len g by XREAL_1:11;
              then 1+((i1+1)-len g)-1<=len f-1 by XREAL_1:11;
              then len f-1+((i1+1)-len g)<=len f-1+(len f-1) by XREAL_1:8;
              then len f+i1-len g<=len f-1+(len f-1);
              then
A56:          len f+i1-'len g<=len f-'1+(len f-'1) by A2,A4, BINARITH:55;
A57:          len f-'1+(len f-'1)=(len f-'1)*(1+1);
              now per cases by A55,REAL_1:def 5;
                case n>1+1;
                  hence contradiction by A5,A49,A50,A56,A57,XREAL_1:70;
                end;
                case
A58:              n=1+1;
                  then
A59:              len f-1+(1+i1)-len g=len f-'1+(len f-' 1) by A2
                  ,A49,A50,BINARITH:55;

then 1+(len f-'1)<=(1+i1)-(len f-'1)+(len f-'1) by A2,A4,XREAL_1:8;
                  then 1+(len f-1)<=(1+i1) by A3,BINARITH:57;
                  then
A60:              len f=i1+1 by A2,XXREAL_0:1;
                  then i2=i1 by A49,A50,A51,A58,BINARITH:39;
                  then i1-'i2=0 by BINARITH:51;
                  hence len g=i1-'i2+1 by A4,A59,A60;
                end;
              end;
              hence len g=i1-'i2+1;
            end;
            case
A61:          n=1;
              len f+i1-'len g=len f+i1-len g by A2,BINARITH:55;
              then len f+i1=i2+len g by A51,A61;
              hence contradiction by A1,A2,XREAL_1:10;
            end;
          end;
          then
A62:      len g = len g & len mid(f,i1,i2) = len g by A1,A2,A7, Th21;
          for j be Nat st j in Seg len g holds g.j =mid(f,i1,i2).j
          proof
            let j be Nat;
            assume j in Seg len g;
            then
A63:        1<=j & j<=len g by FINSEQ_1:3;
            then
A64:        g.j=f.S_Drop(len f+i1-'j,f) by A1,Def3;
A65:        j in NAT by ORDINAL1:def 13;
A66:        i1-'i2+1=i1-i2+1 by A1,BINARITH:50
              .=i1-(i2-1);
            1-1<=i2-1 by A2,XREAL_1:11;
            then
A67:        i1-0>=i1-(i2-1) by REAL_2:106;
            then
A68:        j<=i1 by A54,A63,A66,XXREAL_0:2;
A69:        i1-'j+1=i1-j+1 by A54,A63,A66,A67,BINARITH:50,XXREAL_0:2;
            now per cases;
              case len f+i1-'j=len f-'1;
                then len f+i1-j=len f-'1 by A54,A63,A66,A67,BINARITH:55,
                XXREAL_0:2
                  .=len f-1 by A3, BINARITH:57;
                then i1-j=-1;
                hence contradiction by A68,XREAL_1:50;
              end;
              case len f+i1-'j<>len f-'1;
A70:            len f+i1-'j=len f+i1-j by A54,A63,A66,A67,BINARITH:55,
                XXREAL_0:2;
                now
                  i1+1+0<len f+j by A2,A63,XREAL_1:10;
                  then i1+1-j<len f+j-j by XREAL_1:11;
                  then i1+1-j-1<len f-1 by XREAL_1:11;
                  then i1-j<len f-1;

then i1-'j<len f-'1 by A4,A54,A63,A66,A67,BINARITH:50,XXREAL_0: 2;
                  then
A71:              i1-'j+1<=len f-'1 by NAT_1:13;
                  now per cases by A71,REAL_1:def 5;
                    case
A72:                  i1-'j+1=len f-'1;
                      len f+i1-'j=len f-1+1+i1-j by A54,A63,A66,A67,BINARITH:
                      55 ,XXREAL_0:2
                        .=len f-'1+(i1-j+1) by A4

.=len f-'1+(len f-'1) by A54,A63,A66,A67,A72,BINARITH:50, XXREAL_0:2;
                      then (len f+i1-'j)mod (len f-'1)=0 by Th8;
                      hence S_Drop(len f+i1-'j,f)=i1-'j+1 by A72,Def1;
                    end;
                    case
A73:                  i1-'j+1<len f-'1;
A74:                  len f=len f-1+1
                        .=len f-'1+1 by A3,BINARITH:57;
                      len f-'1+1+i1-'j=len f-'1+1+i1-j by A54,A63,A66,A67,
                      BINARITH:55,XXREAL_0:2
                        .=len f-'1+(1+(i1-j))
                        .=len f-'1+(1+(i1-'j)) by A54,A63,A66,A67,BINARITH:50,
                      XXREAL_0:2;
                      then (len f+i1-'j)mod (len f-'1)
                      =(((len f-'1)mod (len f-'1))+(1+(i1-'j)))mod (len f-'1)
                      by A74,NAT_D:22
                        .=(0+(1+(i1-'j)))mod (len f-'1) by NAT_D:25
                        .=(i1-'j+1) by A73,NAT_D:24;
                      then
A75:                  S_Drop(len f+i1-'j,f)=(len f+ i1-'j)mod (len f-'1)
                      by Def1;
                      len f-1+1+i1-j=(len f-1)+(i1-j+1);
                      then
A76:                  len f+i1-'j=i1-'j+1+(len f-'1) by A3,A69,A70,
                      BINARITH:57;
                      (len f-'1)mod(len f-'1)=0 by NAT_D:25;
                      then S_Drop(len f+i1-'j,f)=(i1-'j+1+0)mod (len f-'1)
                      by A75,A76,NAT_D:22
                        .=(i1-'j+1)mod (len f-'1);
                      hence S_Drop(len f+i1-'j,f)=i1-'j+1 by A73,NAT_D:24;
                    end;
                  end;
                  hence S_Drop(len f+i1-'j,f)=i1-'j+1;
                end;
                hence S_Drop(len f+i1-'j,f)=i1-'j+1;
              end;
            end;
            hence g.j = mid(f,i1,i2).j by A1,A2,A7,A54,A63,A64,A65,Th24;
          end;
          hence len g=i1-'i2+1 & g=mid(f,i1,i2) by A54,A62,FINSEQ_2:10;
        end;
      end;
      hence len g=i1-'i2+1 & g=mid(f,i1,i2);
    end;
  end;
  hence thesis;
end;

theorem Th40:
  for f being non constant standard special_circular_sequence,
  g being FinSequence of TOP-REAL 2,i1,i2 being Element of NAT st
  g is_a_part<_of f,i1,i2 & i1<i2 holds len g=len f+i1-'i2
  & g=mid(f,i1,1)^mid(f,len f-'1,i2)
proof
  let f be non constant standard special_circular_sequence,
  g be FinSequence of TOP-REAL 2,i1,i2 be Element of NAT;
  assume
A1: g is_a_part<_of f,i1,i2 & i1<i2;
  then
A2: 1<=i1 & i1+1<=len f &
  1<=i2 & i2+1<=len f & g.len g=f.i2 & 1<=len g & len g<len f &
  (for i being Element of NAT st 1<=i & i<=len g
  holds g.i=f.S_Drop((len f+i1-'i),f)) by Def3;
  i1<=i1+1 by NAT_1:12;
  then
A3: i1<=len f by A2,XXREAL_0:2;
A4: i1+1-1<=len f-1 by A2,XREAL_1:11;
  then
A5: 1<=len f-1 by A2,XXREAL_0:2;
  then
A6: len f-1=len f-'1 by BINARITH:57;
A7: 0<>len f-'1 by A5,BINARITH:57;
A8: i2+1-1<=len f-1 by A2,XREAL_1:11;
  i1<=len f -'1 by A2,BINARITH:67;
  then 1<=len f -'1 by A2,XXREAL_0:2;
  then
A9: len f -'1<len f by BINARITH:69;
  i1<=i1+1 by NAT_1:11;
  then
A10: i1<=len f by A2,XXREAL_0:2;
  i2<=i2+1 by NAT_1:11;
  then
A11: i2<=len f by A2,XXREAL_0:2;
A12: f.i2=f.S_Drop(len f+i1-'len g,f) by A2;
A13: now per cases;
    case len f+i1-'len g mod (len f -'1)<>0;
      then 0<len f+i1-'len g mod (len f -'1);
      then 0+1<=len f+i1-'len g mod (len f -'1) by NAT_1:13;
      hence 1<=S_Drop(len f+i1-'len g,f) by Def1;
    end;
    case len f+i1-'len g mod (len f -'1)=0;
      then
A14:  S_Drop(len f+i1-'len g,f)=len f -'1 by Def1;
      i1<=len f -'1 by A2,BINARITH:67;
      hence 1<=S_Drop(len f+i1-'len g,f) by A2,A14,XXREAL_0:2;
    end;
  end;
A15: now per cases;
    case len f+i1-'len g mod (len f -'1)<>0;
      then
A16:  S_Drop(len f+i1-'len g,f) =(len f+i1-'len g mod (len f -'1)) by Def1;
A17:  i1<=len f -'1 by A2,BINARITH:67;
      then
A18:  1<=len f -'1 by A2,XXREAL_0:2;
A19:  (len f+i1-'len g mod (len f -'1)) <len f-'1 by A2,A17,NAT_D:1;
      len f -'1<len f by A18,BINARITH:69;
      hence S_Drop(len f+i1-'len g,f)< len f by A16,A19,XXREAL_0:2;
    end;
    case len f+i1-'len g mod (len f -'1)=0;
      then
A20:  S_Drop(len f+i1-'len g,f)=len f -'1 by Def1;
      i1<=len f -'1 by A2,BINARITH:67;
      then 1<=len f -'1 by A2,XXREAL_0:2;
      hence S_Drop(len f+i1-'len g,f)< len f by A20,BINARITH:69;
    end;
  end;
A21: i2<=len f -'1 by A2,BINARITH:67;
  then 1<=len f -'1 by A2,XXREAL_0:2;
  then len f -'1<len f by BINARITH:69;
  then
A22: i2<len f by A21,XXREAL_0:2;
  now per cases by REAL_1:def 5;
    case
A23:  i2<S_Drop(len f+i1-'len g,f);
      then
A24:  f/.i2<>f/.(S_Drop(len f+i1-'len g,f)) by A2,A15,GOBOARD7:38;
      i2<=len f by A2,NAT_1:13;
      then
A25:  f/.i2=f.i2 by A2,FINSEQ_4:24;
      1<=S_Drop(len f+i1-'len g,f) by A2,A23,XXREAL_0:2;
      hence contradiction by A12,A15,A24,A25,FINSEQ_4:24;
    end;
    case i2>S_Drop(len f+i1-'len g,f);
      then
A26:  f/.i2<>f/.(S_Drop(len f+i1-'len g,f)) by A13,A22,GOBOARD7:38;
      i2<=len f by A2,NAT_1:13;
      then f/.i2=f.i2 by A2,FINSEQ_4:24;
      hence contradiction by A12,A13,A15,A26,FINSEQ_4:24;
    end;
    case
A27:  i2=S_Drop(len f+i1-'len g,f);
      now per cases;
        case
A28:      len f+i1-'len g mod (len f -'1)<>0;
          (ex n being Nat st len f+i1-'len g
          =(len f-'1)*n+((len f+i1-'len g) mod (len f -'1)) &
          ((len f+i1-'len g) mod (len f -'1))<len f -'1) by A7,NAT_D:def 2;
          then consider n being Nat such that
A29:      len f+i1-'len g =(len f-'1)*n+(len f+i1-'len g mod (len f -'1));
A30:      len f+i1-'len g=(len f-'1)*n+i2 by A27,A28,A29,Def1;
          now per cases;
            case n=0;
              then
A31:          i2=len f+i1-'len g by A27,A28,A29,Def1
                .=len f+i1-len g by
              A2,BINARITH:55
                .=len f-len g+i1;
              then
A32:          len g=len f+i1-i2;
A33:          len (mid(f,i1,1)^mid(f,len f-'1,i2))
              = len (mid(f,i1,1))+ len(mid(f,len f-'1,i2)) by FINSEQ_1:35;
A34:          len (mid(f,i1,1))=i1-'1+1 by A2,A3,Th21
                .=i1 by A2,BINARITH:53;
              len (mid(f,len f-'1,i2))=len f-'1-'i2+1 by A2,A6,A8,A9,Th21;
              then len (mid(f,len f-'1,i2))=len f-'1-i2+1 by A6,A8,BINARITH:50;
              then len (mid(f,i1,1)^mid(f,len f-'1,i2))=i1+len f-i2 by A6,A33,
              A34
                .=len f+i1-'i2 by A11,BINARITH:55;
              then
A35:          len g = len g

& len (mid(f,i1,1)^mid(f,len f-'1,i2))=len g by A11,A32,BINARITH:55;
              for j be Nat st j in Seg len g holds
              g.j = (mid(f,i1,1)^mid(f,len f-'1,i2)).j
              proof
                let j be Nat;
                assume
A36:            j in Seg len g;
                then
A37:            1<=j & j<=len g by FINSEQ_1:3;
                then
A38:            g.j=f.S_Drop(len f+i1-'j,f) by A1,Def3;
A39:            j in NAT by ORDINAL1:def 13;
A40:            j<len f by A2,A37,XXREAL_0:2;
                then
A41:            len f+i1-'j=len f+i1-j by BINARITH:55;
                now per cases;
                  case
A42:                j<=len mid(f,i1,1);
                    then j in dom mid(f,i1,1) by A37,FINSEQ_3:27;
                    then
A43:                (mid(f,i1,1)^mid(f,len f-'1,i2)).j =mid(f,i1,1).j
                    by FINSEQ_1:def 7;
A44:                len mid(f,i1,1)=i1-'1+1 by A2,A10,Th21;
                    1<=i1 & i1<=len f-'1 & len f-'1<=len f & 1<=j & j<=i1
                    by A1,A4,A5,A34,A36,A42,Def3,BINARITH:57,68,FINSEQ_1:3;
                    then len f-1+j<=len f+i1 by A6,XREAL_1:9;
                    then
A45:                len f-1+j-j<=len f+i1-j by XREAL_1 :11;
                    now per cases;
                      case len f+i1-'j=len f-'1;
                        then len f+i1-j=len f-1 by A6,A34,A42,BINARITH:55;
                        then i1+1=j;
                        hence g.j = (mid(f,i1,1)^mid(f,len f-'1,i2)).j
                        by A34,A42,NAT_1:13;
                      end;
                      case len f+i1-'j<>len f-'1;
                        then
A46:                    len f+i1-'j>len f-'1 by A6,A41,A45,REAL_1:def 5;
A47:                    j-1>=0 by A37,XREAL_1:50;
                        then j-1=j-'1 by BINARITH:def 3;
                        then
A48:                    len f<=len f+(j-1) by NAT_1:11;
                        now per cases;
                          case
A49:                        i1+1=len f & j-1=0;
                            then len f+i1-'j=len f-1+len f-1 by A2,BINARITH:55
                              .=len f-'1+(len f-'1) by A6;
                            then (len f+i1-'j)mod (len f-'1)=0 by Th8;
                            then S_Drop(len f+i1-'j,f) =j+i1-'1 by A49,Def1;
                            then
A50:                        S_Drop(len f+i1-'j,f) =1+i1-1 by A49,BINARITH:55
                              .=i1-j+1 by A49;
A51:                        i1-j+1=i1-'j+1 by A34,A42,BINARITH:50;
A52:                        1<=i1-'j+1 by NAT_1:11;
A53:                        j-1=j-'1 by A37,BINARITH:50;
                            i1<=i1+(j-'1) by NAT_1:11;
                            then
A54:                        i1-(j-'1)<=i1 by XREAL_1:22;
                            mid(f,i1,1).j=mid(f,1,i1).(i1-1+1-j+1)
                            by A2,A10,A37,A39,A42,A44,Th25
                              .=f.(i1-'j+1) by A10,A51,A52,A53,A54,JORDAN3:32;
                            hence g.j = (mid(f,i1,1)^mid(f,len f-'1,i2)).j
                            by A34,A38,A42,A43,A50,BINARITH:50;
                          end;
                          case
A55:                        i1+1<>len f or j-1<>0;
                            now per cases by A55;
                              case i1+1<>len f;
                                then i1+1<len f by A2,REAL_1:def 5;
                                hence i1+1<len f+(j-1) by A48,XXREAL_0:2;
                              end;
                              case j-1<>0;
                                then len f<len f+(j-1) by A47,XREAL_1:31;
                                hence i1+1<len f+(j-1) by A2,XXREAL_0:2;
                              end;
                            end;
                            then i1+1-j<len f-1+j-j by XREAL_1:11;
                            then
A56:                        len f-1+(i1+1-j)< len f-1+(len f-1) by XREAL_1:10;

then (len f+i1-'j) mod (len f-'1)<>0 by A2,A4,A6,A41,A46,Th6;
                            then
A57:                        S_Drop(len f+i1-'j,f)
                            =(len f+i1-'j) mod (len f-'1) by Def1

.=len f+i1-j-(len f-1) by A2,A4,A6,A41,A45,A56,Th7
                              .=(i1-j)+1;
A58:                        i1-j+1=i1-'j+1 by A34,A42,BINARITH:50;
A59:                        1<=i1-'j+1 by NAT_1:11;
A60:                        j-1=j-'1 by A37,BINARITH:50;
                            i1<=i1+(j-'1) by NAT_1:11;
                            then
A61:                        i1-(j-'1)<=i1 by XREAL_1:22;
                            mid(f,i1,1).j=mid(f,1,i1).(i1-1+1-j+1)
                            by A2,A10,A37,A39,A42,A44,Th25
                              .=f.(i1-'j+1) by A10,A58,A59,A60,A61,JORDAN3:32;
                            hence g.j = (mid(f,i1,1)^mid(f,len f-'1,i2)).j
                            by A34,A38,A42,A43,A57,BINARITH:50;
                          end;
                        end;
                        hence g.j = (mid(f,i1,1)^mid(f,len f-'1,i2)).j;
                      end;
                    end;
                    hence g.j = (mid(f,i1,1)^mid(f,len f-'1,i2)).j;
                  end;
                  case
A62:                j>len mid(f,i1,1);
                    then
A63:                i1+1<=j by A34,NAT_1:13;
A64:                (mid(f,i1,1)^(mid(f,len f-'1,i2))).j
                    =(mid(f,len f-'1,i2)).(j-len mid(f,i1,1))
                    by A35,A37,A62,JORDAN3:15;
A65:                j<=len f+i1-i2 by A31,A36,FINSEQ_1:3;
                    i2-i1>=0 by A1,XREAL_1:50;
                    then len f+0<=len f+(i2-i1) by XREAL_1:9;
                    then
A66:                len f-(i2-i1)<=len f+(i2-i1)-(i2- i1) by XREAL_1:11;
                    then
A67:                j<=len f by A65,XXREAL_0:2;
                    i1+1<=j by A34,A62,NAT_1:13;
                    then
A68:                i1+1-i1<=j-i1 by XREAL_1:11;
                    i2+1-1<=len f-1 by A2,XREAL_1:11;
                    then
A69:                i2-i2<=len f-1-i2 by XREAL_1:11;
A70:                j-i1<=len f+i1-i2-i1 by A31,A37,XREAL_1:11;
                    len f-i2<=len f-1 by A2,REAL_1:92;
                    then j-i1<=len f-'1 by A6,A70,XXREAL_0:2;
                    then
A71:                j-'i1<=len f-'1 by A34,A62, BINARITH:50;
A72:                len f-i2=len f-1-i2+1
                      .=len f-'1-'i2+1 by A6,A69,BINARITH:def 3;
A73:                j-i1 =j-'len mid(f,i1,1) by A34,A68,BINARITH:def 3;
                    len f-'1-'(j-'i1)+1=len f-'1-(j-'i1)+1 by A71,BINARITH:50
                      .=len f-1-(j-i1)+1 by A6,A34,A62,BINARITH:50
                      .=len f+i1-j
                      .=len f+i1-'j by A65,A66,BINARITH:55,XXREAL_0:2;
                    then
A74:                (mid(f,i1,1)^(mid(f,len f-'1,i2))) .j

=f.(len f+i1-'j) by A2,A6,A8,A9,A34,A64,A68,A70,A72,A73,Th24;
A75:                len f+i1-j=len f+i1-'j by A40,BINARITH:55;
                    len f+0<len f+i1 by A2,XREAL_1:10;
                    then j<len f+i1 by A67,XXREAL_0:2;
                    then j-j<len f+i1-j by XREAL_1:11;
                    then
A76:                0<len f+i1-'j by A65,A66,BINARITH: 55,XXREAL_0:2;
                    i1+1<=j by A34,A62,NAT_1:13;
                    then len f+(i1+1)<=len f+j by XREAL_1:8;
                    then len f+i1+1-1<=len f+j-1 by XREAL_1:11;
                    then len f+i1-j<=len f+j-1-j by XREAL_1:11;
                    then
A77:                len f-'1>=len f+i1-'j by A6,A65, A66,BINARITH:55,
                    XXREAL_0:2;
                    now per cases;
                      case
A78:                    (len f+i1-'j) mod (len f -'1)=0;
                        then len f+i1-'j=len f-'1 by A76,A77,Th9;
                        hence g.j = (mid(f,i1,1)^mid(f,len f-'1,i2)).j
                        by A38,A74,A78,Def1;
                      end;
                      case
A79:                    (len f+i1-'j) mod (len f -'1)<>0;
                        then
A80:                    S_Drop(len f+i1-'j,f)
                        = (len f+i1-'j) mod (len f -'1) by Def1;
                        len f+(i1+1)<=len f+j by A63,XREAL_1:9;
                        then len f+i1+1-j<=len f+j-j by XREAL_1:11;
                        then
A81:                    len f+i1+1-j-1<=len f-1 by XREAL_1:11;
                        len f+i1-j=len f-'1 implies
                        contradiction by A75,A79,NAT_D:25;
                        then len f+i1-'j<(len f-'1) by A6,A75,A81,REAL_1:def 5;
                        hence g.j = (mid(f,i1,1)^mid(f,len f-'1,i2)).j
                        by A38,A74,A80,NAT_D:24;
                      end;
                    end;
                    hence g.j = (mid(f,i1,1)^mid(f,len f-'1,i2)).j;
                  end;
                end;
                hence g.j = (mid(f,i1,1)^mid(f,len f-'1,i2)).j;
              end;
              hence len g=len f+i1-'i2 & g=mid(f,i1,1)^mid(f,len f-'1,i2)
              by A11,A32,A35,BINARITH:55,FINSEQ_2:10;
            end;
            case n<>0;
              then 0<n;
              then
A82:          0+1<=n by NAT_1:13;
              now per cases by A82,REAL_1:def 5;
                case
A83:              1=n;
A84:              len f+i1-'len g=len f+i1-len g by A2,BINARITH:55;
                  i1+1+0<i2+len g by A1,A2,XREAL_1:10;
                  hence contradiction by A6,A30,A83,A84;
                end;
                case 1<n;
                  then 1+1<=n by NAT_1:13;
                  then (len f-'1)*n>=(len f-'1)*(1+1) by XREAL_1:66;
                  then
A85:              len f+i1-'len g>=(len f-'1)*(1+1)+i2 by A30,XREAL_1:8;
                  i1+1-1<=len f-1 by A2,XREAL_1:11;
                  then 1+i1<=len g+(len f-'1) by A2,A6,XREAL_1:9;
                  then len f-1+(1+i1)<=len f-1+(len g+(len f-'1)) by XREAL_1:8;
                  then
A86:              len f+i1-len g<=len f-1+len g+(len f-' 1)-len g by
                  XREAL_1:11;
A87:              len f+i1-len g=len f+i1-'len g by A2,BINARITH:55;
                  (len f-'1)*(1+1)<(len f-'1)*(1+1)+i2 by A1,XREAL_1:31;
                  hence contradiction by A6,A85,A86,A87,XXREAL_0:2;
                end;
              end;
              hence contradiction;
            end;
          end;
          hence len g=len f+i1-'i2 & g=mid(f,i1,1)^mid(f,len f-'1,i2);
        end;
        case
A88:      len f+i1-'len g mod (len f -'1)=0;
          (ex n being Nat st len f+i1-'len g
          =(len f-'1)*n+((len f+i1-'len g) mod (len f -'1)) &
          ((len f+i1-'len g) mod (len f -'1))<len f -'1) by A7,NAT_D:def 2;
          then consider n being Nat such that
A89:      len f+i1-'len g =(len f-'1)*n+((len f+i1-'len g) mod (len f -'1));
A90:      len f+i1-'len g=i2*n by A27,A88,A89,Def1;
          now
            assume n=0;
            then
A91:        len f+i1<=len g by A88,A89,BINARITH:54;
            len f<=len f+i1 by NAT_1:11;
            hence contradiction by A2,A91,XXREAL_0:2;
          end;
          then n>0;
          then
A92:      n>=0+1 by NAT_1:13;
          now
            assume n>1;
            then n>=1+1 by NAT_1:13;
            then
A93:        len f+i1-'len g>=(len f-'1)*(1+1) by A88,A89,NAT_1 :4;
            now
              assume i1+1<len f;
              then i1+1+1<len f+len g by A2,XREAL_1:10;
              then i1+1+1-1<len f+len g-1 by XREAL_1:11;
              then i1+1-len g<len f+len g-1-len g by XREAL_1:11;
              then len f-1+(i1+1-len g)<len f-1+(len f-1) by XREAL_1:8;
              then len f+i1-len g<len f-1+(len f-1);
              hence contradiction by A2,A6,A93,BINARITH:55;
            end;
            then i1+1=len f by A2,REAL_1:def 5;
            then i2+1>len f-1+1 by A1,XREAL_1:8;
            hence contradiction by A1,Def3;
          end;
          then n=1 by A92,XXREAL_0:1;
          then
A94:      len f+i1-len g=i2 by A2,A90,BINARITH:55;
          then
A95:      len f+i1-i2=len g;
A96:      len (mid(f,i1,1))=i1-'1+1 by A2,A3,Th21
            .=i1 by A2,BINARITH:53;
          len (mid(f,len f-'1,i2))=len f-'1-'i2+1 by A2,A6,A8,A9,Th21;
          then len (mid(f,len f-'1,i2))=len f-1-i2+1 by A6,A8,BINARITH:50;
          then len (mid(f,i1,1)^mid(f,len f-'1,i2))=i1+(len f-i2) by A96,
          FINSEQ_1:35
            .=i1+len f-i2
            .=len f+i1-'i2 by A11,BINARITH:55;
          then
A97:      len g = len g
          & len (mid(f,i1,1)^mid(f,len f-'1,i2))=len g by A11,A95,BINARITH:55;
          for j be Nat st j in Seg len g holds
          g.j = (mid(f,i1,1)^mid(f,len f-'1,i2)).j
          proof
            let j be Nat;
            assume
A98:        j in Seg len g;
            then
A99:        1<=j & j<=len g by FINSEQ_1:3;
            then
A100:       g.j=f.S_Drop(len f+i1-'j,f) by A1,Def3;
A101:       j in NAT by ORDINAL1:def 13;
A102:       j<len f by A2,A99,XXREAL_0:2;
            then
A103:       len f+i1-'j=len f+i1-j by BINARITH:55;
            now per cases;
              case
A104:           j<=len mid(f,i1,1);
                then j in dom mid(f,i1,1) by A99,FINSEQ_3:27;
                then
A105:           (mid(f,i1,1)^mid(f,len f-'1,i2)).j =mid(f, i1,1).j
                by FINSEQ_1:def 7;
A106:           len mid(f,i1,1)=i1-'1+1 by A2,A10,Th21;
                len f-'1<=len f by BINARITH:68;
                then len f-1+j<=len f+i1 by A6,A96,A104,XREAL_1:9;
                then
A107:           len f-1+j-j<=len f+i1-j by XREAL_1:11;
                now per cases;
                  case len f+i1-'j=len f-'1;
                    then len f+i1-j=len f-1 by A6,A96,A104,BINARITH:55;
                    then i1+1=j;
                    hence g.j = (mid(f,i1,1)^mid(f,len f-'1,i2)).j
                    by A96,A104,NAT_1:13;
                  end;
                  case len f+i1-'j<>len f-'1;
                    then
A108:               len f+i1-'j>len f-'1 by A6,A103, A107,REAL_1:def 5;
A109:               j-1>=0 by A99,XREAL_1:50;
                    then j-1=j-'1 by BINARITH:def 3;
                    then
A110:               len f<=len f+(j-1) by NAT_1:11;
                    now per cases;
                      case
A111:                   i1+1=len f & j-1=0;
                        then len f+i1-'j=len f-1+len f-1 by A2,BINARITH:55
                          .=len f-'1+(len f-'1) by A6;
                        then (len f+i1-'j)mod (len f-'1)=0 by Th8;
                        then S_Drop(len f+i1-'j,f) =j+i1-'1 by A111,Def1;
                        then
A112:                   S_Drop(len f+i1-'j,f) =i1+ 1-1 by A111,BINARITH:55
                          .=i1-j+1 by A111;
A113:                   i1-j+1=i1-'j+1 by A96,A104,BINARITH:50;
A114:                   f.S_Drop(len f+i1-'j,f)=f.(i1-'j+1)
                        by A96,A104,A112,BINARITH:50;
A115:                   1<=i1-'j+1 by NAT_1:11;
A116:                   j-1=j-'1 by A99,BINARITH:50;
                        i1<=i1+(j-'1) by NAT_1:11;
                        then
A117:                   i1-(j-'1)<=i1 by XREAL_1: 22;
                        mid(f,i1,1).j=mid(f,1,i1).(i1-1+1-j+1)
                        by A2,A10,A99,A101,A104,A106,Th25
                          .=f.(i1-'j+1) by A10,A113,A115,A116,A117,
                        JORDAN3:32;
                        hence g.j = (mid(f,i1,1)^mid(f,len f-'1,i2)).j
                        by A1,A99,A105,A114,Def3;
                      end;
                      case
A118:                   i1+1<>len f or j-1<>0;
                        now per cases by A118;
                          case i1+1<>len f;
                            then i1+1<len f by A2,REAL_1:def 5;
                            hence i1+1<len f+(j-1) by A110,XXREAL_0:2;
                          end;
                          case j-1<>0;
                            then len f<len f+(j-1) by A109,XREAL_1:31;
                            hence i1+1<len f+(j-1) by A2,XXREAL_0:2;
                          end;
                        end;
                        then i1+1-j<len f-1+j-j by XREAL_1:11;
                        then
A119:                   len f-1+(i1+1-j)<len f-1+( len f-1) by XREAL_1:10;

then (len f+i1-'j) mod (len f-'1)<>0 by A2,A4,A6,A103,A108, Th6;
                        then
A120:                   S_Drop(len f+i1-'j,f)
                        =(len f+i1-'j) mod (len f-'1) by Def1

.=len f+(i1-j)-(len f-1) by A2,A4,A6,A103,A107,A119,Th7
                          .=(i1-j)+1;
A121:                   i1-j+1=i1-'j+1 by A96,A104,BINARITH:50;
A122:                   1<=i1-'j+1 by NAT_1:11;
A123:                   j-1=j-'1 by A99,BINARITH:50;
                        i1<=i1+(j-'1) by NAT_1:11;
                        then
A124:                   i1-(j-'1)<=i1 by XREAL_1: 22;
                        mid(f,i1,1).j=mid(f,1,i1).(i1-1+1-j+1)
                        by A2,A10,A99,A101,A104,A106,Th25
                          .=f.(i1-'j+1) by A10,A121,A122,A123,A124,JORDAN3:32;
                        hence g.j = (mid(f,i1,1)^mid(f,len f-'1,i2)).j
                        by A96,A100,A104,A105,A120,BINARITH:50;
                      end;
                    end;
                    hence g.j = (mid(f,i1,1)^mid(f,len f-'1,i2)).j;
                  end;
                end;
                hence g.j = (mid(f,i1,1)^mid(f,len f-'1,i2)).j;
              end;
              case
A125:           j>len mid(f,i1,1);
                then
A126:           i1+1<=j by A96,NAT_1:13;
A127:           (mid(f,i1,1)^(mid(f,len f-'1,i2))).j
                =(mid(f,len f-'1,i2)).(j-len mid(f,i1,1))
                by A97,A99,A125,JORDAN3:15;
A128:           j<=len f+i1-i2 by A94,A98,FINSEQ_1:3;
                i2-i1>=0 by A1,XREAL_1:50;
                then len f+0<=len f+(i2-i1) by XREAL_1:9;
                then
A129:           len f-(i2-i1)<=len f+(i2-i1)-(i2-i1) by XREAL_1:11;
                then
A130:           j<=len f by A128,XXREAL_0:2;
                i1+1<=j by A96,A125,NAT_1:13;
                then
A131:           i1+1-i1<=j-i1 by XREAL_1:11;
                i2+1-1<=len f-1 by A2,XREAL_1:11;
                then
A132:           i2-i2<=len f-1-i2 by XREAL_1:11;
A133:           j-i1<=len f+i1-i2-i1 by A94,A99,XREAL_1:11;
                len f-i2<=len f-1 by A2,REAL_1:92;
                then j-i1<=len f-'1 by A6,A133,XXREAL_0:2;
                then
A134:           j-'i1<=len f-'1 by A96,A125,BINARITH:50;
A135:           len f-i2=len f-1-i2+1
                  .=len f-'1-'i2+1 by A6,A132,BINARITH:def 3;
A136:           j-i1 =j-'len mid(f,i1,1) by A96,A131,BINARITH:def 3;
                len f-'1-'(j-'i1)+1=len f-'1-(j-'i1)+1 by A134,BINARITH:50
                  .=len f-1-(j-i1)+1 by A6,A96,A125,BINARITH:50
                  .=len f+i1-j
                  .=len f+i1-'j by A128,A129,BINARITH:55,XXREAL_0:2;
                then
A137:           (mid(f,i1,1)^(mid(f,len f-'1,i2))).j
                =f.(len f+i1-'j) by A2,A6,A8,A9,A96,A127,A131,A133,A135,A136,
                Th24;
A138:           len f+i1-j=len f+i1-'j by A102,BINARITH:55;
                len f+0<len f+i1 by A2,XREAL_1:10;
                then j<len f+i1 by A130,XXREAL_0:2;
                then j-j<len f+i1-j by XREAL_1:11;
                then
A139:           0<len f+i1-'j by A128,A129,BINARITH:55, XXREAL_0:2;
                i1+1<=j by A96,A125,NAT_1:13;
                then len f+(i1+1)<=len f+j by XREAL_1:8;
                then len f+i1+1-1<=len f+j-1 by XREAL_1:11;
                then len f+i1-j<=len f+j-1-j by XREAL_1:11;
                then
A140:           len f-'1>=len f+i1-'j by A6,A128,A129,
                BINARITH:55, XXREAL_0:2;
                now per cases;
                  case
A141:               (len f+i1-'j) mod (len f -'1)=0;
                    then len f+i1-'j=len f-'1 by A139,A140,Th9;
                    hence g.j = (mid(f,i1,1)^mid(f,len f-'1,i2)).j
                    by A100,A137,A141,Def1;
                  end;
                  case
A142:               (len f+i1-'j) mod (len f -'1)<>0;
                    then
A143:               S_Drop(len f+i1-'j,f)
                    = (len f+i1-'j) mod (len f -'1) by Def1;
                    len f+(i1+1)<=len f+j by A126,XREAL_1:9;
                    then len f+i1+1-j<=len f+j-j by XREAL_1:11;
                    then
A144:               len f+i1+1-j-1<=len f-1 by XREAL_1 :11;
                    len f+i1-j=len f-'1 implies
                    contradiction by A138,A142,NAT_D:25;
                    then len f+i1-'j<(len f-'1) by A6,A138,A144,REAL_1:def 5;
                    hence g.j = (mid(f,i1,1)^mid(f,len f-'1,i2)).j
                    by A100,A137,A143,NAT_D:24;
                  end;
                end;
                hence g.j = (mid(f,i1,1)^mid(f,len f-'1,i2)).j;
              end;
            end;
            hence g.j = (mid(f,i1,1)^mid(f,len f-'1,i2)).j;
          end;
          hence len g=len f+i1-'i2 & g=mid(f,i1,1)^mid(f,len f-'1,i2)
          by A11,A95,A97,BINARITH:55,FINSEQ_2:10;
        end;
      end;
      hence len g=len f+i1-'i2 & g=mid(f,i1,1)^mid(f,len f-'1,i2);
    end;
  end;
  hence thesis;
end;

theorem Th41:
  for f being non constant standard special_circular_sequence,
  g being FinSequence of TOP-REAL 2,i1,i2 being Element of NAT st
  g is_a_part>_of f,i1,i2 holds Rev g is_a_part<_of f,i2,i1
proof
  let f be non constant standard special_circular_sequence,
  g be FinSequence of TOP-REAL 2,i1,i2 be Element of NAT;
  assume
A1: g is_a_part>_of f,i1,i2;
  then
A2: 1<=i1 & i1+1<=len f &
  1<=i2 & i2+1<=len f & g.len g=f.i2 & 1<=len g & len g<len f &
  (for i being Element of NAT st 1<=i & i<=len g
  holds g.i=f.S_Drop((i1+i)-'1,f)) by Def2;
  then
A3: 1<len f by XXREAL_0:2;
A4: i1<len f by A2,NAT_1:13;
A5: len g=len (Rev g) by FINSEQ_5:def 3;
A6: (Rev g).len (Rev g)=(Rev g).len g by FINSEQ_5:def 3
    .=g.(len g-len g+1) by A2,JORDAN3:24
    .=f.S_Drop((i1+1-'1),f) by A2
    .=f.S_Drop(i1,f) by BINARITH:39;
  i1+1-1<=len f-1 by A2,XREAL_1:11;
  then
A7: i1<=len f-'1 by A3,BINARITH:50;
A8: now per cases;
    case
A9:   i1 mod (len f-'1)<>0;
      then
A10:  S_Drop(i1,f)=i1 mod (len f-'1) by Def1;
      i1 <> len f-'1 by A9,NAT_D:25;
      then i1<len f-'1 by A7,REAL_1:def 5;
      hence (Rev g).len (Rev g)=f.i1 by A6,A10,NAT_D:24;
    end;
    case
A11:  i1 mod (len f-'1)=0;
      then S_Drop(i1,f)=len f-'1 by Def1;
      hence (Rev g).len (Rev g)=f.i1 by A2,A6,A7,A11,Th9;
    end;
  end;
  for i being Nat st 1<=i & i<=len (Rev g) holds
  (Rev g).i=f.S_Drop(len f +i2-'i,f)
  proof
    let i be Nat;
    assume
A12: 1<=i & i<=len (Rev g);
A13: i in NAT by ORDINAL1:def 13;
    len g<=len g+(i-'1) by NAT_1:11;
    then len g<=len g+(i-1) by A12,BINARITH:50;
    then len g-(i-1)<=len g+(i-1)-(i-1) by XREAL_1:11;
    then len g-i+1<=len g;
    then
A14: 1<=len g-'i+1 & len g-'i+1<=len g by A5,A12,BINARITH:50,NAT_1:11;
A15: (Rev g).i=g.(len g-i+1) by A5,A12,A13,JORDAN3:24
      .=g.(len g-'i+1) by A5,A12,BINARITH:50
      .=f.S_Drop((i1+(len g-'i+1)-'1),f) by A1,A14,Def2;
A16: i<len f by A2,A5,A12,XXREAL_0:2;
    now per cases;
      case
A17:    i1<=i2;
        then len f-1+len g=len f-1+(i2-'i1+1) by A1,Th37;
        then len f-1+len g=len f+(i2-'i1);
        then len f-1+len g=len f+(i2-i1) by A17,BINARITH:50;
        then len f+i2-i=len f-1+(i1+len g)-i;
        then len f+i2-'i=len f-1+(i1+(len g-i)) by A16,BINARITH:55;
        then len f+i2-'i=len f-1+(i1+(len g-'i)+1-1) by A5,A12,BINARITH:50;
        then len f+i2-'i=len f-1+(i1+(len g-'i+1)-'1) by BINARITH:55;
        then len f+i2-'i=(i1+(len g-'i+1)-'1)+(len f-'1) by A3,BINARITH:50;
        hence (Rev g).i=f.S_Drop(len f +i2-'i,f) by A15,Th35;
      end;
      case i1>i2;
        then len g=len f+i2-'i1 by A1,Th38;
        then len g+i1=len f+i2-i1+i1 by A4,BINARITH:55;
        then len f+i2-'i=i1+len g-i by A5,A12,BINARITH:55;
        then len f+i2-'i=i1+(len g-i);
        then len f+i2-'i=i1+(len g-'i)+1-1 by A5,A12,BINARITH:50;
        hence (Rev g).i=f.S_Drop(len f +i2-'i,f) by A15,BINARITH:55;
      end;
    end;
    hence (Rev g).i=f.S_Drop(len f +i2-'i,f);
  end;
  hence thesis by A2,A5,A8,Def3;
end;

theorem Th42:
  for f being non constant standard special_circular_sequence,
  g being FinSequence of TOP-REAL 2,i1,i2 being Element of NAT st
  g is_a_part<_of f,i1,i2 holds Rev g is_a_part>_of f,i2,i1
proof
  let f be non constant standard special_circular_sequence,
  g be FinSequence of TOP-REAL 2,i1,i2 be Element of NAT;
  assume
A1: g is_a_part<_of f,i1,i2;
  then
A2: 1<=i1 & i1+1<=len f & 1<=i2 & i2+1<=len f & g.len g=f.i2
  & 1<=len g & len g<len f &
  (for i being Element of NAT st 1<=i & i<=len g holds
  g.i=f.S_Drop(len f+i1-'i,f)) by Def3;
  then
A3: 1<len f by XXREAL_0:2;
A4: i2<len f by A2,NAT_1:13;
A5: len g=len (Rev g) by FINSEQ_5:def 3;
A6: (Rev g).len (Rev g)=(Rev g).len g by FINSEQ_5:def 3
    .=g.(len g-len g+1) by A2,JORDAN3:24
    .=f.S_Drop(len f+i1-'1,f) by A2
    .=f.S_Drop(len f-'1+i1,f) by A3,BINARITH:56;
  i1+1-1<=len f-1 by A2,XREAL_1:11;
  then
A7: i1<=len f-'1 by A3,BINARITH:50;
A8: S_Drop(len f-'1+i1,f)=S_Drop(i1,f) by Th35;
A9: now per cases;
    case
A10:  i1 mod (len f-'1)<>0;
      then
A11:  S_Drop(i1,f)=i1 mod (len f-'1) by Def1;
      i1 <> len f-'1 by A10,NAT_D:25;
      then i1<len f-'1 by A7,REAL_1:def 5;
      hence (Rev g).len (Rev g)=f.i1 by A6,A8,A11,NAT_D:24;
    end;
    case
A12:  i1 mod (len f-'1)=0;
      then S_Drop(i1,f)=len f-'1 by Def1;
      hence (Rev g).len (Rev g)=f.i1 by A2,A6,A7,A8,A12,Th9;
    end;
  end;
  for i being Nat st 1<=i & i<=len (Rev g) holds
  (Rev g).i=f.S_Drop((i2+i)-'1,f)
  proof
    let i be Nat;
    assume
A13: 1<=i & i<=len (Rev g);
A14: i in NAT by ORDINAL1:def 13;
    len g<=len g+(i-'1) by NAT_1:11;
    then len g<=len g+(i-1) by A13,BINARITH:50;
    then len g-(i-1)<=len g+(i-1)-(i-1) by XREAL_1:11;
    then len g-i+1<=len g;
    then
A15: 1<=len g-'i+1 & len g-'i+1<=len g by A5,A13,BINARITH:50,NAT_1:11;
A16: (Rev g).i=g.(len g-i+1) by A5,A13,A14,JORDAN3:24
      .=g.(len g-'i+1) by A5,A13,BINARITH:50
      .=f.S_Drop(len f+i1-'(len g-'i+1),f) by A1,A15,Def3;
A17: len g+1<=len f by A2,NAT_1:13;
    len g+1<=len g+1+i by NAT_1:11;
    then len g+1-i<=len g+1+i-i by XREAL_1:11;
    then len g-i+1<=len g+1;
    then
A18: len g-'i+1<=len g+1 by A5,A13,BINARITH:50;
    now per cases;
      case i1<i2;
        then len g=len f+i1-'i2 by A1,Th40;
        then
A19:    len g=len f+i1-i2 by A4,BINARITH:55;
        len f=len f-'1+1 by A3,BINARITH:53;
        then -len f+i2+i=i2+i-1-(len f-'1);
        then i1-(len g-i)=i2+i-'1-(len f-'1) by A2,A19,BINARITH:55;
        then i1-(len g-'i)=i2+i-'1-(len f-'1) by A5,A13,BINARITH:50;
        then len f-'1+1+i1-(len g-'i+1)=len f-'1+(i2+i-'1)-(len f-'1);
        then len f+i1-(len g-'i+1)=len f-'1+(i2+i-'1)-(len f-'1)
        by A3,BINARITH:53;

hence (Rev g).i=f.S_Drop((i2+i)-'1,f) by A16,A17,A18,BINARITH:55,XXREAL_0 :2;
      end;
      case
A20:    i1>=i2;
        then len g=i1-'i2+1 by A1,Th39;
        then len g=i1-i2+1 by A20,BINARITH:50;
        then i1-(len g-i)=(i2+i)-1;
        then i1-(len g-i)=(i2+i)-'1 by A13,BINARITH:55;
        then i1-(len g-'i)=(i2+i)-'1 by A5,A13,BINARITH:50;
        then len f-1+(i1-(len g-'i))=(i2+i)-'1+(len f-'1) by A3,BINARITH:50;
        then len f+i1-(len g-'i+1)=(i2+i)-'1+(len f-'1);
        then (Rev g).i=f.S_Drop((i2+i)-'1+(len f-'1),f) by A16,A17,A18,
        BINARITH :55,XXREAL_0:2
          .=f.S_Drop((i2+i)-'1,f) by Th35;
        hence (Rev g).i=f.S_Drop((i2+i)-'1,f);
      end;
    end;
    hence (Rev g).i=f.S_Drop((i2+i)-'1,f);
  end;
  hence thesis by A2,A5,A9,Def2;
end;

theorem Th43:
  for f being non constant standard special_circular_sequence,
  i1,i2 being Element of NAT st 1<=i1 & i1<=i2 & i2<len f
  holds mid(f,i1,i2) is_a_part>_of f,i1,i2
proof
  let f be non constant standard special_circular_sequence,
  i1,i2 be Element of NAT;
  assume
A1: 1<=i1 & i1<=i2 & i2<len f;
  then
A2: 1<=i2 by XXREAL_0:2;
A3: i1<len f by A1,XXREAL_0:2;
  then
A4: i1+1<=len f by NAT_1:13;
A5: i2+1<=len f by A1,NAT_1:13;
A6: mid(f,i1,i2).len mid(f,i1,i2)=f.i2 by A1,Th22;
A7: len mid(f,i1,i2)=i2-'i1+1 by A1,A2,A3,JORDAN3:27;
  then
A8: 1<=len mid(f,i1,i2) by NAT_1:11;
A9: i2-'i1+1=i2-i1+1 by A1,BINARITH:50;
  i2+1<i2+1+i1 by A1,XREAL_1:31;
  then i2+1-i1<i2+1+i1-i1 by XREAL_1:11;
  then
A10: len mid(f,i1,i2)<len f by A5,A7,A9,XXREAL_0:2;
  for i being Nat st 1<=i & i<=len mid(f,i1,i2) holds
  mid(f,i1,i2).i=f.S_Drop((i1+i)-'1,f)
  proof
    let i be Nat;
    assume
A11: 1<=i & i<=len mid(f,i1,i2);
    then i+i1<=i2-i1+1+i1 by A7,A9,XREAL_1:8;
    then i1+i<=len f by A5,XXREAL_0:2;
    then i1+i-1<=len f-1 by XREAL_1:11;
    then i1+i-1<=len f-'1 by A1,A2,BINARITH:50,XXREAL_0:2;
    then
A12: i1+i-'1<=len f-'1 by A1,BINARITH:55;
A13: i in NAT by ORDINAL1:def 13;
    1+1<=i1+i by A1,A11,XREAL_1:9;
    then 1+1-1<=i1+i-1 by XREAL_1:11;
    then 1<=i1+i-'1 by A1,BINARITH:55;
    then S_Drop((i1+i)-'1,f)=(i1+i)-'1 by A12,Th34;
    hence mid(f,i1,i2).i=f.S_Drop((i1+i)-'1,f) by A1,A2,A3,A11,A13,JORDAN3:27;
  end;
  hence thesis by A1,A2,A4,A5,A6,A8,A10,Def2;
end;

theorem Th44:
  for f being non constant standard special_circular_sequence,
  i1,i2 being Element of NAT st 1<=i1 & i1<=i2 & i2<len f
  holds mid(f,i2,i1) is_a_part<_of f,i2,i1
proof
  let f be non constant standard special_circular_sequence,
  i1,i2 be Element of NAT;
  assume 1<=i1 & i1<=i2 & i2<len f;
  then Rev mid(f,i1,i2) is_a_part<_of f,i2,i1 by Th41,Th43;
  hence thesis by Th30;
end;

theorem Th45:
  for f being non constant standard special_circular_sequence,
  i1,i2 being Element of NAT st 1<=i2 & i1>i2 & i1<len f
  holds mid(f,i1,len f-'1)^mid(f,1,i2) is_a_part>_of f,i1,i2
proof
  let f be non constant standard special_circular_sequence,
  i1,i2 be Element of NAT;
  assume
A1: 1<=i2 & i1>i2 & i1<len f;
  then
A2: 1<=i1 by XXREAL_0:2;
A3: i2<len f by A1,XXREAL_0:2;
  then
A4: i2+1<=len f by NAT_1:13;
A5: i1+1<=len f by A1,NAT_1:13;
  then i1+1-1<=len f-1 by XREAL_1:11;
  then
A6: i1<=len f-'1 by A1,A2,BINARITH:50,XXREAL_0:2;
  then
A7: 1<=len f-'1 by A2,XXREAL_0:2;
  i2+1-1<=len f-1 by A4,XREAL_1:11;
  then
A8: i2<=len f-'1 by A1,A2,BINARITH:50,XXREAL_0:2;
  len f<len f+1 by NAT_1:13;
  then len f-1<len f+1-1 by XREAL_1:11;
  then
A9: len f-'1<len f by A1,A2,BINARITH:50,XXREAL_0:2;
A10: len (mid(f,i1,len f-'1)^mid(f,1,i2))
  =len mid(f,i1,len f-'1)+ len mid(f,1,i2) by FINSEQ_1:35;
A11: len mid(f,1,i2)=len (f|i2) by A1,JORDAN3:25
    .=i2 by A1,FINSEQ_1:80,
  XXREAL_0:2;
  then len mid(f,i1,len f-'1)< len mid(f,i1,len f-'1)+ len mid(f,1,i2)
  by A1,XREAL_1:31;
  then
A12: (mid(f,i1,len f-'1)^mid(f,1,i2)).len (mid(f,i1,len f-'1)^mid(f,1,i2 ) )
  =mid(f,1,i2).(len mid(f,i1,len f-'1)+ len mid(f,1,i2)
  -len mid(f,i1,len f-'1)) by A10,JORDAN3:15
    .=f.i2 by A1,A3,Th22;
  len mid(f,1,i2)<=len (mid(f,i1,len f-'1)^mid(f,1,i2)) by A10,NAT_1:11;
  then
A13: 1<=len (mid(f,i1,len f-'1)^mid(f,1,i2)) by A1,A11,XXREAL_0:2;
  len mid(f,i1,len f-'1)=len f-'1-'i1+1 by A1,A2,A6,A7,A9,JORDAN3:27
    .=len f-'1-i1+1 by A6,BINARITH:50
    .=len f-1-i1+1 by A1,A2,BINARITH:50,XXREAL_0:2
    .=len f-i1;
  then
A14: len (mid(f,i1,len f-'1)^mid(f,1,i2))=len f-i1 +i2 by A11,FINSEQ_1: 35
    .=len f-(i1-i2);
  i1-i2>0 by A1,XREAL_1:52;
  then len f<len f+(i1-i2) by XREAL_1:31;
  then
A15: len f-(i1-i2)<len f+(i1-i2)-(i1-i2) by XREAL_1:11;
  for i being Nat st 1<=i & i<=len (mid(f,i1,len f-'1)^mid(f,1,i2)) holds
  (mid(f,i1,len f-'1)^mid(f,1,i2)).i =f.S_Drop((i1+i)-'1,f)
  proof
    let i be Nat;
    assume
A16: 1<=i & i<=len (mid(f,i1,len f-'1)^mid(f,1,i2));
A17: len mid(f,i1,len f-'1)=len f-'1-'i1+1 by A1,A2,A6,A7,A9,JORDAN3:27;
A18: len f-'1-'i1+1=len f-'1-i1+1 by A6,BINARITH:50
      .=len f-1-i1+1 by A1,A2,BINARITH:50,XXREAL_0:2
      .=len f-i1;
A19: len f-i1=len f-'i1 by A1,BINARITH:50;
A20: i1+i-'1=i1+i-1 by A16,BINARITH:55;
A21: i in NAT by ORDINAL1:def 13;
    now per cases;
      case
A22:    i<=len mid(f,i1,len f-'1);
        then i in dom mid(f,i1,len f-'1) by A16,FINSEQ_3:27;
        then
A23:    (mid(f,i1,len f-'1)^mid(f,1,i2)).i=mid(f,i1,len f-'1).i
        by FINSEQ_1:def 7;
A24:    mid(f,i1,len f-'1).i=f.(i1+i-'1)
        by A1,A2,A6,A7,A9,A16,A21,A22,JORDAN3:27;
        0<=i-1 by A16,XREAL_1:50;
        then
A25:    1+0<=i1+(i-1) by A2,XREAL_1:9;
        i1+i<=i1+(len f-'1-'i1+1) by A17,A22,XREAL_1:8;
        then i1+i<=(len f-'1-i1+1)+i1 by A6,BINARITH:50;
        then i1+i<=len f-'1+1;
        then i1+i<=len f by A1,A2,BINARITH:53,XXREAL_0:2;
        then i1+i-'1<=len f-1 by A20,XREAL_1:11;
        then 1<=i1+i-'1 & i1+i-'1<=len f-'1
        by A1,A2,A20,A25,BINARITH:50,XXREAL_0:2;
        hence (mid(f,i1,len f-'1)^mid(f,1,i2)).i=f.S_Drop((i1+i)-'1,f)
        by A23,A24,Th34;
      end;
      case
A26:    i>len mid(f,i1,len f-'1);
A27:    len f-i1=len f-'i1 by A1,BINARITH:50;
        i>=len f-'i1+1 by A17,A18,A19,A26,NAT_1:13;
        then
A28:    i-(len f-'i1)>=len f-'i1+1-(len f-'i1) by XREAL_1:11;
        i-(len f-i1)<=len f-i1+i2-(len f-i1) by A14,A16,XREAL_1:11;
        then
A29:    1<=i-'(len f-'i1) & i-'(len f-'i1)<=i2 by A27,A28,BINARITH :57;
        then
A30:    i-'(len f-'i1)<=len f-'1 by A8,XXREAL_0:2;
A31:    (mid(f,i1,len f-'1)^mid(f,1,i2)).i
        =mid(f,1,i2).(i-len mid(f,i1,len f-'1)) by A16,A26,JORDAN3:15
          .=mid(f,1,i2).(i-'(len f-'i1)) by A17,A18,A19,A26,BINARITH:50
          .=f.(i-'(len f-'i1)) by A3,A29,JORDAN3:32;
        len f-'1+(i-'(len f-'i1))=len f-'1+(i-(len f-'i1))
        by A17,A18,A19,A26,BINARITH:50
          .=len f-'1+i-(len f-'i1)
          .=len f-1+i-(len f-'i1) by A1,A2,BINARITH:50,XXREAL_0:2
          .=len f-1+i-(len f-i1) by A1,BINARITH:50
          .=(i+i1)-1
          .=i1+i-'1 by A16,BINARITH:55;
        then S_Drop((i1+i)-'1,f) =S_Drop(i-'(len f-'i1),f) by Th35
          .=i-'(len f-'i1) by A29,A30,Th34;
        hence (mid(f,i1,len f-'1)^mid(f,1,i2)).i=f.S_Drop((i1+i)-'1,f) by A31;
      end;
    end;
    hence (mid(f,i1,len f-'1)^mid(f,1,i2)).i=f.S_Drop((i1+i)-'1,f);
  end;
  hence thesis by A1,A2,A4,A5,A12,A13,A14,A15,Def2;
end;

theorem Th46:
  for f being non constant standard special_circular_sequence,
  i1,i2 being Element of NAT st 1<=i1 & i1<i2 & i2<len f
  holds mid(f,i1,1)^mid(f,len f-'1,i2) is_a_part<_of f,i1,i2
proof
  let f be non constant standard special_circular_sequence,
  i1,i2 be Element of NAT;
  assume
A1: 1<=i1 & i1<i2 & i2<len f;
  Rev (mid(f,i2,len f-'1)^mid(f,1,i1))
  =Rev(mid(f,1,i1))^Rev(mid(f,i2,len f-'1)) by FINSEQ_5:67
    .=mid(f,i1,1)^Rev(mid(f,i2,len f-'1)) by Th30
    .=mid(f,i1,1)^mid(f,len f-'1,i2) by Th30;
  hence thesis by A1,Th41,Th45;
end;

theorem Th47:
  for h being FinSequence of TOP-REAL 2,i1,i2 st
  1<=i1 & i1<=len h & 1<=i2 & i2<=len h holds L~mid(h,i1,i2) c= L~h
proof
  let h be FinSequence of TOP-REAL 2,i1,i2;
  assume
A1: 1<=i1 & i1<=len h & 1<=i2 & i2<=len h;
  thus L~mid(h,i1,i2) c= L~h
  proof
    let x be set;
    assume
A2: x in L~mid(h,i1,i2);
    now per cases;
      case
A3:     i1<=i2;
        x in union { LSeg(mid(h,i1,i2),i) : 1 <= i & i+1 <= len mid(h,i1,i2) }
        by A2,TOPREAL1:def 6;
        then consider Y being set such that
A4:     x in Y
        & Y in { LSeg(mid(h,i1,i2),i) : 1 <= i & i+1 <= len mid(h,i1,i2) }
        by TARSKI:def 4;
        consider i such that
A5:     Y=LSeg(mid(h,i1,i2),i) & (1 <= i & i+1 <= len mid(h,i1,i2)) by A4;
A6:     LSeg(mid(h,i1,i2),i)=LSeg(mid(h,i1,i2)/.i,mid(h,i1,i2)/.(i+1))
        by A5,TOPREAL1:def 5;
        i<=i+1 by NAT_1:11;
        then
A7:     i<=len mid(h,i1,i2) by A5,XXREAL_0:2;
        then
A8:     mid(h,i1,i2).i=h.(i+i1-'1) by A1,A3,A5,JORDAN3:27;
A9:     len mid(h,i1,i2)=i2-'i1+1 by A1,A3,JORDAN3:27;
        1<=i+1 & i+1<=len mid(h,i1,i2) by A5,NAT_1:11;
        then
A10:    mid(h,i1,i2).(i+1)=h.(i+1+i1-'1) by A1,A3,JORDAN3:27;
A11:    mid(h,i1,i2)/.i=mid(h,i1,i2).i by A5,A7,FINSEQ_4:24;
A12:    mid(h,i1,i2)/.(i+1)=mid(h,i1,i2).(i+1) by A5,FINSEQ_4:24,NAT_1:11;
        1+1<=i+i1 by A1,A5,XREAL_1:9;
        then
A13:    1+1-1<=i+i1-1 by XREAL_1:11;
        i+1-1<=i2-'i1+1-1 by A5,A9,XREAL_1:11;
        then i<=i2-i1 by A3,BINARITH:50;
        then
A14:    i+i1<=i2-i1+i1 by XREAL_1:8;
        then
A15:    i+i1<=len h by A1,XXREAL_0:2;
        then
A16:    1<=i+i1-'1 & i+i1-'1<=len h by A1,A13,BINARITH:55,62;
        then
A17:    h/.(i+i1-'1)=h.(i+i1-'1) by FINSEQ_4:24;
A18:    i+1+i1-'1=i+1+i1-1 by A1,BINARITH:55
          .=i+i1;
        then
A19:    i+1+i1-'1=i+i1-1+1
          .=i+i1-'1+1 by A1,BINARITH:55;
        i+i1-'1<=i+i1-'1+1 by NAT_1:11;
        then i+i1-'1<=i+i1-1+1 by A1,BINARITH:55;
        then
A20:    1<=i+i1 & i+i1<=len h by A1,A14,A16,XXREAL_0:2;
        then LSeg(mid(h,i1,i2),i)=LSeg(h/.(i+i1-'1),h/.(i+1+i1-'1))
        by A6,A8,A10,A11,A12,A17,A18,FINSEQ_4:24
          .=LSeg(h,i+i1-'1) by A13,A15,A18,A19,TOPREAL1:def 5;
        then LSeg(mid(h,i1,i2),i) in { LSeg(h,j) : 1 <= j & j+1 <= len h}
        by A13,A18,A19,A20;

then x in union { LSeg(h,j) : 1 <= j & j+1 <= len h} by A4,A5,TARSKI:def 4;
        hence x in L~h by TOPREAL1:def 6;
      end;
      case
A21:    i1>i2;
        mid(h,i1,i2)=Rev mid(h,i2,i1) by Th30;
        then x in L~mid(h,i2,i1) by A2,SPPOL_2:22;

then x in union { LSeg(mid(h,i2,i1),i) : 1 <= i & i+1 <= len mid(h,i2,i1) }
        by TOPREAL1:def 6;
        then consider Y being set such that
A22:    x in Y
        & Y in { LSeg(mid(h,i2,i1),i) : 1 <= i & i+1 <= len mid(h,i2,i1) }
        by TARSKI:def 4;
        consider i such that
A23:    Y=LSeg(mid(h,i2,i1),i) & (1 <= i & i+1 <= len mid(h,i2,i1)) by A22;
A24:    LSeg(mid(h,i2,i1),i)=LSeg(mid(h,i2,i1)/.i,mid(h,i2,i1)/.(i+1))
        by A23,TOPREAL1:def 5;
        i<=i+1 by NAT_1:11;
        then
A25:    i<=len mid(h,i2,i1) by A23,XXREAL_0:2;
        then
A26:    mid(h,i2,i1).i=h.(i+i2-'1) by A1,A21,A23,JORDAN3:27;
A27:    len mid(h,i2,i1)=i1-'i2+1 by A1,A21,JORDAN3:27;
        1<=i+1 & i+1<=len mid(h,i2,i1) by A23,NAT_1:11;
        then
A28:    mid(h,i2,i1).(i+1)=h.(i+1+i2-'1) by A1,A21,JORDAN3:27;
A29:    mid(h,i2,i1)/.i=mid(h,i2,i1).i by A23,A25,FINSEQ_4:24;
A30:    mid(h,i2,i1)/.(i+1)=mid(h,i2,i1).(i+1) by A23,FINSEQ_4:24,NAT_1:11;
        1+1<=i+i2 by A1,A23,XREAL_1:9;
        then
A31:    1+1-1<=i+i2-1 by XREAL_1:11;
        then
A32:    1<=i+i2-'1 by A1,BINARITH:55;
        i+1-1<=i1-'i2+1-1 by A23,A27,XREAL_1:11;
        then i<=i1-i2 by A21,BINARITH:50;
        then
A33:    i+i2<=i1-i2+i2 by XREAL_1:8;
        then
A34:    i+i2<=len h by A1,XXREAL_0:2;
        then
A35:    h/.(i+i2-'1)=h.(i+i2-'1) by A32,BINARITH:62,FINSEQ_4:24;
A36:    i+1+i2-'1=i+1+i2-1 by A1,BINARITH:55
          .=i+i2;
        then
A37:    i+1+i2-'1=i+i2-1+1
          .=i+i2-'1+1 by A1,BINARITH:55;
        i+i2-'1<=i+i2-'1+1 by NAT_1:11;
        then i+i2-'1<=i+i2-1+1 by A1,BINARITH:55;
        then
A38:    1<=i+i2 & i+i2<=len h by A1,A32,A33,XXREAL_0:2;
        then LSeg(mid(h,i2,i1),i)=LSeg(h/.(i+i2-'1),h/.(i+1+i2-'1))
        by A24,A26,A28,A29,A30,A35,A36,FINSEQ_4:24
          .=LSeg(h,i+i2-'1) by A31,A34,A36,A37,TOPREAL1:def 5;
        then LSeg(mid(h,i2,i1),i) in { LSeg(h,j) : 1 <= j & j+1 <= len h}
        by A31,A36,A37,A38;
        then x in union { LSeg(h,j) : 1 <= j & j+1 <= len h} by A22,A23,
        TARSKI:def 4;
        hence x in L~h by TOPREAL1:def 6;
      end;
    end;
    hence x in L~h;
  end;
end;

theorem Th48:
  for g being FinSequence of D holds
  g is one-to-one iff for i1,i2 st 1<=i1 & i1<=len g & 1<=i2 & i2<=len g &
  (g.i1=g.i2 or g/.i1=g/.i2) holds i1=i2
proof
  let g be FinSequence of D;
A1: g is one-to-one implies
  for i1,i2 st 1<=i1 & i1<=len g & 1<=i2 & i2<=len g &
  (g.i1=g.i2 or g/.i1=g/.i2) holds i1=i2
  proof
    assume
A2: g is one-to-one;
    thus for i1,i2 st 1<=i1 & i1<=len g & 1<=i2 & i2<=len g &
    (g.i1=g.i2 or g/.i1=g/.i2) holds i1=i2
    proof
      let i1,i2;
      assume
A3:   1<=i1 & i1<=len g & 1<=i2 & i2<=len g & (g.i1=g.i2 or g/.i1=g/.i2);
      then
A4:   i1 in dom g by FINSEQ_3:27;
A5:   i2 in dom g by A3,FINSEQ_3:27;
A6:   g/.i1=g.i1 by A3,FINSEQ_4:24;
      g/.i2=g.i2 by A3,FINSEQ_4:24;
      hence i1=i2 by A2,A3,A4,A5,A6,FUNCT_1:def 8;
    end;
  end;
  (for i1,i2 st 1<=i1 & i1<=len g & 1<=i2 & i2<=len g &
  (g.i1=g.i2 or g/.i1=g/.i2) holds i1=i2) implies g is one-to-one
  proof
    assume
A7: (for i1,i2 st 1<=i1 & i1<=len g & 1<=i2 & i2<=len g &
    (g.i1=g.i2 or g/.i1=g/.i2) holds i1=i2);
    for x1,x2 being set st x1 in dom g & x2 in dom g & g.x1=g.x2 holds x1= x2
    proof
      let x1,x2 be set;
      assume
A8:   x1 in dom g & x2 in dom g & g.x1=g.x2;
      then reconsider n1=x1 as Element of NAT;
      reconsider n2=x2 as Element of NAT by A8;
A9:   1<=n1 & n1<=len g by A8,FINSEQ_3:27;
      1<=n2 & n2<=len g by A8,FINSEQ_3:27;
      hence x1=x2 by A7,A8,A9;
    end;
    hence g is one-to-one by FUNCT_1:def 8;
  end;
  hence thesis by A1;
end;

theorem Th49:
  for f being non constant standard special_circular_sequence,
  i2 st 1<i2 & i2+1<=len f holds f|i2 is_S-Seq
proof
  let f be non constant standard special_circular_sequence,i2;
  assume
A1: 1<i2 & i2+1<=len f;
  then i2<=len f by NAT_1:13;
  then
A2: len (f|i2)=i2 by FINSEQ_1:80;
  then
A3: 1+1<=len (f|i2) by A1,NAT_1:13;
  for i,j be Nat st i+1 < j holds LSeg(f|i2,i) misses LSeg(f|i2,j)
  proof
    let i,j be Nat;
    assume
A4: i+1 < j;
A5: i in NAT & j in NAT by ORDINAL1:def 13;
    now per cases;
      case
A6:     1<=i & j+1<=len (f|i2);
        then
A7:     LSeg(f|i2,j)=LSeg(f,j) by SPPOL_2:3;
        j<=len (f|i2) by A6,NAT_1:13;
        then
A8:     LSeg(f|i2,i) /\ LSeg(f|i2,j) = LSeg(f,i) /\ LSeg(f,j) by A4,A7,
        SPPOL_2:3,XXREAL_0:2;
        i2<=len f by A1,NAT_1:13;
        then len (f|i2)=i2 by FINSEQ_1:80;
        then j+1<i2+1 by A6,NAT_1:13;
        then j+1<len f by A1,XXREAL_0:2;
        then LSeg(f,i) misses LSeg(f,j) by A4,A5,GOBOARD5:def 4;
        then LSeg(f|i2,i) /\ LSeg(f|i2,j) = {} by A8,XBOOLE_0:def 7;
        hence LSeg(f|i2,i) misses LSeg(f|i2,j) by XBOOLE_0:def 7;
      end;
      case
A9:     1>i or j+1>len (f|i2);
        now per cases by A9;
          case 1>i;
            then LSeg(f|i2,i)={} by TOPREAL1:def 5;
            then LSeg(f|i2,i) /\ LSeg(f|i2,j) = {};
            hence LSeg(f|i2,i) misses LSeg(f|i2,j) by XBOOLE_0:def 7;
          end;
          case j+1>len (f|i2);
            then LSeg(f|i2,j)={} by TOPREAL1:def 5;
            then LSeg(f|i2,i) /\ LSeg(f|i2,j) = {};
            hence LSeg(f|i2,i) misses LSeg(f|i2,j) by XBOOLE_0:def 7;
          end;
        end;
        hence LSeg(f|i2,i) misses LSeg(f|i2,j);
      end;
    end;
    hence LSeg(f|i2,i) misses LSeg(f|i2,j);
  end;
  then
A10: f|i2 is s.n.c. by TOPREAL1:def 9;
  f|i2 is one-to-one
  proof
    for n1,n2 being Element of NAT
    st 1<=n1 & n1<=len (f|i2) & 1<=n2 & n2<=len (f|i2)
    &((f|i2).n1=(f|i2).n2 or (f|i2)/.n1=(f|i2)/.n2) holds n1=n2
    proof
      let n1,n2 be Element of NAT;
      assume
A11:  1<=n1 & n1<=len (f|i2) & 1<=n2 & n2<=
      len (f|i2) & ((f|i2).n1=(f|i2).n2 or (f|i2)/.n1=(f|i2)/.n2);
      then
A12:  n1 in dom (f|i2) by FINSEQ_3:27;
A13:  n2 in dom (f|i2) by A11,FINSEQ_3:27;
      now per cases by REAL_1:def 5;
        case
A14:      n1<n2;
          n2+1<=i2+1 by A2,A11,XREAL_1:8;
          then n2+1<=len f by A1,XXREAL_0:2;
          then
A15:      n2<len f by NAT_1:13;
          len f>4 by GOBOARD7:36;
          then
A16:      f/.n1<>f/.n2 by A11,A14,A15,GOBOARD7:37;
A17:      (f|i2)/.n1=f/.n1 by A12,FINSEQ_4:85;
A18:      (f|i2)/.n2=f/.n2 by A13,FINSEQ_4:85;
          (f|i2)/.n1=(f|i2).n1 by A11,FINSEQ_4:24;
          hence contradiction by A11,A16,A17,A18,FINSEQ_4:24;
        end;
        case n1=n2;
          hence n1=n2;
        end;
        case
A19:      n2<n1;
          n1+1<=i2+1 by A2,A11,XREAL_1:8;
          then n1+1<=len f by A1,XXREAL_0:2;
          then
A20:      n1<len f by NAT_1:13;
          len f>4 by GOBOARD7:36;
          then
A21:      f/.n2<>f/.n1 by A11,A19,A20,GOBOARD7:37;
A22:      (f|i2)/.n2=f/.n2 by A13,FINSEQ_4:85;
A23:      (f|i2)/.n1=f/.n1 by A12,FINSEQ_4:85;
          (f|i2)/.n2=(f|i2).n2 by A11,FINSEQ_4:24;
          hence contradiction by A11,A21,A22,A23,FINSEQ_4:24;
        end;
      end;
      hence n1=n2;
    end;
    hence thesis by Th48;
  end;
  hence thesis by A3,A10,TOPREAL1:def 10;
end;

theorem Th50:
  for f being non constant standard special_circular_sequence,
  i2 st 1<=i2 & i2+1<len f holds f/^i2 is_S-Seq
proof
  let f be non constant standard special_circular_sequence,i2;
  assume
A1: 1<=i2 & i2+1<len f;
  then
A2: i2<len f by NAT_1:13;
  then
A3: len (f/^i2)=len f-i2 by RFINSEQ:def 2;
  i2+1-i2<len f-i2 by A1,XREAL_1:11;
  then
A4: 1+1<=len (f/^i2) by A3,NAT_1:13;
  for i,j be Nat st i+1 < j holds LSeg(f/^i2,i) misses LSeg(f/^i2,j)
  proof
    let i,j be Nat;
    assume
A5: i+1 < j;
    then
A6: i<j by NAT_1:13;
    now per cases;
      case
A7:     1<=i & j<len (f/^i2);
        then 1<j by A6,XXREAL_0:2;
        then
A8:     LSeg(f/^i2,j)=LSeg(f,i2+j) by A2,SPPOL_2:4;
A9:     j<len f-i2 by A2,A7,RFINSEQ:def 2;
A10:    LSeg(f/^i2,i) /\ LSeg(f/^i2,j) = LSeg(f,i2+i) /\ LSeg(f,i2+j)
        by A2,A7,A8,SPPOL_2:4;
        i2+(i+1)<i2+j by A5,XREAL_1:8;
        then
A11:    i2+i+1<i2+j;
A12:    1+1<=i2+i by A1,A7,XREAL_1:9;
        j+i2<len f-i2+i2 by A9,XREAL_1:8;
        then 1<i2+i & i2+j<len f by A12,XXREAL_0:2;
        then LSeg(f,i2+i) misses LSeg(f,i2+j) by A11,GOBOARD5:def 4;
        then LSeg(f,i2+i) /\ LSeg(f,i2+j) = {} by XBOOLE_0:def 7;
        hence LSeg(f/^i2,i) misses LSeg(f/^i2,j) by A10,XBOOLE_0:def 7;
      end;
      case
A13:    1>i or j>=len (f/^i2);
        now per cases by A13;
          case 1>i;
            then LSeg(f/^i2,i)={} by TOPREAL1:def 5;
            then LSeg(f/^i2,i) /\ LSeg(f/^i2,j) = {};
            hence LSeg(f/^i2,i) misses LSeg(f/^i2,j) by XBOOLE_0:def 7;
          end;
          case j>=len (f/^i2);
            then j+1>len (f/^i2) by NAT_1:13;
            then LSeg(f/^i2,j)={} by TOPREAL1:def 5;
            then LSeg(f/^i2,i) /\ LSeg(f/^i2,j) = {};
            hence LSeg(f/^i2,i) misses LSeg(f/^i2,j) by XBOOLE_0:def 7;
          end;
        end;
        hence LSeg(f/^i2,i) misses LSeg(f/^i2,j);
      end;
    end;
    hence LSeg(f/^i2,i) misses LSeg(f/^i2,j);
  end;
  then
A14: f/^i2 is s.n.c. by TOPREAL1:def 9;
  f/^i2 is one-to-one
  proof
    for n1,n2 being Element of NAT
    st 1<=n1 & n1<=len (f/^i2) & 1<=n2 & n2<=len (f/^i2)
    &((f/^i2).n1=(f/^i2).n2 or (f/^i2)/.n1=(f/^i2)/.n2) holds n1=n2
    proof
      let n1,n2 be Element of NAT;
      assume
A15:  1<=n1 & n1<=len (f/^i2)
      & 1<=n2 & n2<=len (f/^i2) & ((f/^i2).n1=(f/^i2).n2 or
      (f/^i2)/.n1=(f/^i2)/.n2);
      then
A16:  n1 in dom (f/^i2) by FINSEQ_3:27;
A17:  n2 in dom (f/^i2) by A15,FINSEQ_3:27;
      now per cases by REAL_1:def 5;
        case
A18:      n1<n2;
A19:      n2+i2<=len f-i2+i2 by A3,A15,XREAL_1:8;
A20:      i2+1<=i2+n1 by A15,XREAL_1:8;
          1<i2+1 by A1,NAT_1:13;
          then
A21:      1<i2+n1 by A20,XXREAL_0:2;
          i2+n1<i2+n2 by A18,XREAL_1:8;
          then
A22:      f/.(i2+n1)<>f/.(i2+n2) by A19,A21,GOBOARD7:39;
A23:      (f/^i2)/.n1=f/.(i2+n1) by A16,FINSEQ_5:30;
A24:      (f/^i2)/.n2=f/.(i2+n2) by A17,FINSEQ_5:30;
          (f/^i2)/.n1=(f/^i2).(n1) by A15,FINSEQ_4:24;
          hence contradiction by A15,A22,A23,A24,FINSEQ_4:24;
        end;
        case n1=n2;
          hence n1=n2;
        end;
        case
A25:      n2<n1;
A26:      n1+i2<=len f-i2+i2 by A3,A15,XREAL_1:8;
A27:      i2+1<=i2+n2 by A15,XREAL_1:8;
          1<i2+1 by A1,NAT_1:13;
          then
A28:      1<i2+n2 by A27,XXREAL_0:2;
          i2+n2<i2+n1 by A25,XREAL_1:8;
          then
A29:      f/.(i2+n2)<>f/.(i2+n1) by A26,A28,GOBOARD7:39;
          n2 in dom (f/^i2) by A15,FINSEQ_3:27;
          then
A30:      (f/^i2)/.n2=f/.(i2+n2) by FINSEQ_5:30;
          n1 in dom (f/^i2) by A15,FINSEQ_3:27;
          then
A31:      (f/^i2)/.n1=f/.(i2+n1) by FINSEQ_5:30;
          (f/^i2)/.n2=(f/^i2).n2 by A15,FINSEQ_4:24;
          hence contradiction by A15,A29,A30,A31,FINSEQ_4:24;
        end;
      end;
      hence n1=n2;
    end;
    hence thesis by Th48;
  end;
  hence thesis by A4,A14,TOPREAL1:def 10;
end;

theorem Th51:
  for f being non constant standard special_circular_sequence,
  i1,i2 st 1<=i1 & i1<i2 & i2+1<=len f holds mid(f,i1,i2) is_S-Seq
proof
  let f be non constant standard special_circular_sequence, i1,i2;
  assume
A1: 1<=i1 & i1<i2 & i2+1<=len f;
  then
A2: 1<i2 by XXREAL_0:2;
A3: i2<len f by A1,NAT_1:13;
  i1<i1+1 by NAT_1:13;
  then i1-1<i1+1-1 by XREAL_1:11;
  then i1-1<i2 by A1, XXREAL_0:2;
  then
A4: i1-'1<i2 by A1,BINARITH:50;
A5: i2-'i1+1=i2-i1+1 by A1,BINARITH:50
    .=i2-(i1-1)
    .=i2-(i1-'1) by A1,BINARITH:50
    .=i2-'(i1-'1) by A4,BINARITH:50;
  mid(f,i1,i2)=(f/^(i1-'1))|(i2-'i1+1) by A1,JORDAN3:def 1;
  then
A6: mid(f,i1,i2)=(f|i2)/^(i1-'1) by A5,JORDAN3:21;
  i1-1+1<len (f|i2) by A1,A3,FINSEQ_1:80;
  then i1-'1+1<len (f|i2) by A1,BINARITH:50;
  hence thesis by A1,A2,A6,Th19,Th49;
end;

theorem Th52:
  for f being non constant standard special_circular_sequence,
  i1,i2 st 1<i1 & i1<i2 & i2<=len f holds mid(f,i1,i2) is_S-Seq
proof
  let f be non constant standard special_circular_sequence, i1,i2;
  assume
A1: 1<i1 & i1<i2 & i2<=len f;
  then
A2: i1<len f by XXREAL_0:2;
  i2-i1>0 by A1,XREAL_1:52;
  then i2-'i1>0 by BINARITH:def 3;
  then
A3: i2-'i1>=0+1 by NAT_1:13;
  1+1<=i1 by A1,NAT_1:13;
  then 1+1-1<=i1-1 by XREAL_1:11;
  then
A4: 1<=i1-'1 by BINARITH:57;
A5: i1-'1+1<len f by A1,A2,BINARITH:53;
  i1<i1+1 by NAT_1:13;
  then i1-1<i1+1-1 by XREAL_1:11;
  then i1-1<i2 by A1, XXREAL_0:2;
  then
A6: i1-'1<i2 by A1,BINARITH:50;
A7: mid(f,i1,i2)=(f/^(i1-'1))|(i2-'i1+1) by A1,JORDAN3:def 1;
A8: i1-'1+1<len f by A1,A2,BINARITH:53;
A9: i1-'1<len f by A1,A6,XXREAL_0:2;
  then
A10: len (f/^(i1-'1))=len f-(i1-'1) by RFINSEQ:def 2;
A11: i1-'1+1-(i1-'1)<len f-(i1-'1) by A8,XREAL_1:11;
  i2-(i1-'1)<=len f-(i1-'1) by A1,XREAL_1:11;
  then i2-(i1-1)<=len (f/^(i1-'1)) by A1,A10,BINARITH:50;
  then i2-i1+1<=len (f/^(i1-'1));
  then
A12: 1<=1 & 1<=len (f/^(i1-'1)) & 1<=i2-'i1+1
  & i2-'i1+1<=len (f/^(i1-'1)) & 1<>i2-'i1+1
  by A3,A9,A11,BINARITH:57,NAT_1:13,RFINSEQ:def 2;
  then mid(f/^(i1-'1),1,i2-'i1+1) is_S-Seq by A4,A5,Th50,JORDAN3:39;
  hence thesis by A7,A12,JORDAN3:25;
end;

theorem Th53:
  for p0,p,q1,q2 being Point of TOP-REAL 2 st
  p0 in LSeg(p,q1) & p0 in LSeg(p,q2) & p<>p0 holds
  q1 in LSeg(p,q2) or q2 in LSeg(p,q1)
proof
  let p0,p,q1,q2 be Point of TOP-REAL 2;
  assume
A1: p0 in LSeg(p,q1) & p0 in LSeg(p,q2) & p<>p0;
  then p0 in { (1-r)*p + r*q1: 0 <= r & r <= 1 } by TOPREAL1:def 3;
  then consider r such that
A2: p0=(1-r)*p + r*q1 &( 0 <= r & r <= 1);
  p0 in { (1-s)*p + s*q2: 0 <= s & s <= 1 } by A1,TOPREAL1:def 3;
  then consider s such that
A3: p0=(1-s)*p + s*q2 &( 0 <= s & s <= 1);
A4: 1-r>=0 by A2,XREAL_1:50;
A5: 1-s>=0 by A3,XREAL_1:50;
A6: p0-(1-r)*p=r*q1 by A2,EUCLID:52;
A7: p0-r*q1=(1-r)*p by A2,EUCLID:52;
A8: p0-(1-s)*p=s*q2 by A3,EUCLID:52;
A9: p0-s*q2=(1-s)*p by A3,EUCLID:52;
A10: now
    assume r=s;
    then r*q1+((1-r)*p-(1-r)*p) =r*q2+(1-r)*p-(1-r)*p by A2,A3,EUCLID:49;
    then r*q1+0.REAL 2 =r*q2+(1-r)*p-(1-r)*p by EUCLID:46;
    then r*q1+0.REAL 2 =r*q2 by EUCLID:52;
    then
A11: r*q1=r*q2 by EUCLID:31;
A12: q1 in LSeg(p,q1) by TOPREAL1:6;
    now per cases;
      case r<>0;
        hence q1 in LSeg(p,q2) or q2 in LSeg(p,q1) by A11,A12,EUCLID:38;
      end;
      case r=0;
        then p0=(1-0)*p+0.REAL 2 by A2,EUCLID:33;
        then p0=(1-0)*p by EUCLID:31;
        hence contradiction by A1,EUCLID:33;
      end;
    end;
    hence q1 in LSeg(p,q2) or q2 in LSeg(p,q1);
  end;
  now
    assume
A13: r<>s;
    now per cases by A13,REAL_1:def 5;
      case
A14:    r<s;
        (1-r)*p0-(1-r)*((1-s)*p)=(1-r)*(s*q2) by A8,EUCLID:53;
        then (1-r)*p0-((1-r)*(1-s))*p=(1-r)*(s*q2) by EUCLID:34;
        then (1-r)*p0-((1-r)*(1-s))*p=((1-r)*s)*q2 by EUCLID:34;
        then (1-r)*p0-(1-s)*((1-r)*p)=((1-r)*s)*q2 by EUCLID:34;
        then (1-r)*p0-((1-s)*p0-(1-s)*(r*q1))=((1-r)*s)*q2 by A7,EUCLID:53;
        then (1-r)*p0-(1-s)*p0+(1-s)*(r*q1)=((1-r)*s)*q2 by EUCLID:51;
        then
A15:    ((1-r)-(1-s))*p0+(1-s)*(r*q1)=((1-r)*s)*q2 by EUCLID:54;
A16:    now
          assume (1-r)*s=0;
          then
A17:      1-r+r=0+r or s=0 by XCMPLX_1:6;
          now per cases by A17;
            case r=1;
              hence contradiction by A3,A14;
            end;
            case s=0;
              hence contradiction by A2,A14;
            end;
          end;
          hence contradiction;
        end;
        then 1=((1-r)*s)/((1-r)*s) by XCMPLX_1:60;
        then 1=((1-r)*s)*((1-r)*s)" by XCMPLX_0:def 9;
        then (((1-r)*s)*((1-r)*s)")*((s-r)*p0+(1-s)*(r*q1))=((1-r)*s)*q2
        by A15,EUCLID:33;
        then ((1-r)*s)*(((1-r)*s)"*((s-r)*p0+(1-s)*(r*q1)))=((1-r)*s)*q2
        by EUCLID:34;
        then q2=((1-r)*s)"*((s-r)*p0+(1-s)*(r*q1)) by A16,EUCLID:38;
        then q2=((1-r)*s)"*((s-r)*p0+((1-s)*r)*q1) by EUCLID:34;
        then q2=((1-r)*s)"*((s-r)*p0)+((1-r)*s)"*(((1-s)*r)*q1) by EUCLID:36;
        then q2=(((1-r)*s)"*(s-r))*p0+((1-r)*s)"*(((1-s)*r)*q1) by EUCLID:34;
        then
A18:    q2=(((1-r)*s)"*(s-r))*p0+(((1-r)*s)"*((1-s)*r))*q1 by EUCLID:34;
        set s1=(((1-r)*s)"*((1-s)*r));
A19:    0<=(1-s)*r by A2,A5,REAL_2:121;
A20:    0<=(1-r)*s by A3,A4,REAL_2:121;
        then
A21:    0<((1-r)*s)" by A16,XREAL_1:124;
        r-s*r+s*r<=s-s*r+s*r by A14;
        then 1*r-s*r<=(1-r)*s by XREAL_1:8;
        then ((1-s)*r)/((1-r)*s)*((1-r)*s)<=1*((1-r)*s) by A16,XCMPLX_1:88;
        then ((1-s)*r)/((1-r)*s)<=1 by A16,A20,XREAL_1:70;
        then
A22:    0<=s1 & s1<=1 by A19,A21,REAL_2:121,XCMPLX_0:def 9;
        (((1-r)*s)"*(s-r))=(((1-r)*s)-((1-r)*s-(s-r)))/((1-r)*s) by
        XCMPLX_0:def 9
          .= ((1-r)*s)/((1-r)*s)-((1-r)*s-(s-r))/((1-r)*s)
        by XCMPLX_1:121
          .= 1-(r+(s-r*s)-s)/((1-r)*s) by A16,XCMPLX_1:60
          .=1-s1 by XCMPLX_0:def 9;
        then q2 in {(1-r2)*p0 + r2*q1: 0 <= r2 & r2 <= 1 } by A18,A22;
        then
A23:    q2 in LSeg(p0,q1) by TOPREAL1:def 3;
        q1 in LSeg(p,q1) by TOPREAL1:6;
        then LSeg(p0,q1) c= LSeg(p,q1) by A1,TOPREAL1:12;
        hence q1 in LSeg(p,q2) or q2 in LSeg(p,q1) by A23;
      end;
      case
A24:    s<r;
        (1-s)*p0-(1-s)*((1-r)*p)=(1-s)*(r*q1) by A6,EUCLID:53;
        then (1-s)*p0-((1-s)*(1-r))*p=(1-s)*(r*q1) by EUCLID:34;
        then (1-s)*p0-((1-s)*(1-r))*p=((1-s)*r)*q1 by EUCLID:34;
        then (1-s)*p0-(1-r)*((1-s)*p)=((1-s)*r)*q1 by EUCLID:34;
        then (1-s)*p0-((1-r)*p0-(1-r)*(s*q2))=((1-s)*r)*q1 by A9,EUCLID:53;
        then (1-s)*p0-(1-r)*p0+(1-r)*(s*q2)=((1-s)*r)*q1 by EUCLID:51;
        then
A25:    ((1-s)-(1-r))*p0+(1-r)*(s*q2)=((1-s)*r)*q1 by EUCLID:54;
A26:    now
          assume (1-s)*r=0;
          then
A27:      1-s+s=0+s or r=0 by XCMPLX_1:6;
          now per cases by A27;
            case s=1;
              hence contradiction by A2,A24;
            end;
            case r=0;
              hence contradiction by A3,A24;
            end;
          end;
          hence contradiction;
        end;
        then 1=((1-s)*r)/((1-s)*r) by XCMPLX_1:60;
        then 1=((1-s)*r)*((1-s)*r)" by XCMPLX_0:def 9;
        then (((1-s)*r)*((1-s)*r)")*((r-s)*p0+(1-r)*(s*q2))=((1-s)*r)*q1
        by A25,EUCLID:33;
        then ((1-s)*r)*(((1-s)*r)"*((r-s)*p0+(1-r)*(s*q2)))=((1-s)*r)*q1
        by EUCLID:34;
        then q1=((1-s)*r)"*((r-s)*p0+(1-r)*(s*q2)) by A26,EUCLID:38;
        then q1=((1-s)*r)"*((r-s)*p0+((1-r)*s)*q2) by EUCLID:34;
        then q1=((1-s)*r)"*((r-s)*p0)+((1-s)*r)"*(((1-r)*s)*q2) by EUCLID:36;
        then q1=(((1-s)*r)"*(r-s))*p0+((1-s)*r)"*(((1-r)*s)*q2) by EUCLID:34;
        then
A28:    q1=(((1-s)*r)"*(r-s))*p0+(((1-s)*r)"*((1-r)*s))*q2 by EUCLID:34;
        set s1=(((1-s)*r)"*((1-r)*s));
A29:    0<=(1-r)*s by A3,A4,REAL_2:121;
A30:    0<=(1-s)*r by A2,A5,REAL_2:121;
        then
A31:    0<((1-s)*r)" by A26,XREAL_1:124;
        s-r*s+r*s<=r-r*s+r*s by A24;
        then 1*s-r*s<=(1-s)*r by XREAL_1:8;
        then ((1-r)*s)/((1-s)*r)*((1-s)*r)<=1*((1-s)*r) by A26,XCMPLX_1:88;
        then ((1-r)*s)/((1-s)*r)<=1 by A26,A30,XREAL_1:70;
        then
A32:    0<=s1 & s1<=1 by A29,A31,REAL_2:121,XCMPLX_0:def 9;
        (((1-s)*r)"*(r-s))=(((1-s)*r)-((1-s)*r-(r-s)))/((1-s)*r) by
        XCMPLX_0:def 9
          .= ((1-s)*r)/((1-s)*r)-((1-s)*r-(r-s))/((1-s)*r)
        by XCMPLX_1:121
          .= 1-(s+(r-s*r)-r)/((1-s)*r) by A26,XCMPLX_1:60
          .=1-s1 by XCMPLX_0:def 9;
        then q1 in {(1-r2)*p0 + r2*q2: 0 <= r2 & r2 <= 1 } by A28,A32;
        then
A33:    q1 in LSeg(p0,q2) by TOPREAL1:def 3;
        q2 in LSeg(p,q2) by TOPREAL1:6;
        then LSeg(p0,q2) c= LSeg(p,q2) by A1,TOPREAL1:12;
        hence q1 in LSeg(p,q2) or q2 in LSeg(p,q1) by A33;
      end;
    end;
    hence q1 in LSeg(p,q2) or q2 in LSeg(p,q1);
  end;
  hence thesis by A10;
end;

theorem Th54:
  for f being non constant standard special_circular_sequence
  holds LSeg(f,1)/\ LSeg(f,len f-'1)={f.1}
proof
  let f be non constant standard special_circular_sequence;
A1: len f>4 by GOBOARD7:36;
A2: 2<len f by GOBOARD7:36,XXREAL_0:2;
A3: 3<len f by GOBOARD7:36,XXREAL_0:2;
A4: 3+1-1<len f-1 by A1,XREAL_1:11;
  1<=1 & 1+1<=len f by GOBOARD7:36,XXREAL_0:2;
  then
A5: f/.1 in LSeg(f,1) by TOPREAL1:27;
A6: 1<len f by GOBOARD7:36,XXREAL_0:2;
A7: len f-1=len f-'1 by A1,BINARITH:50,XXREAL_0:2;
A8: 1+1-1<=len f-1 by A2,XREAL_1:11;
  len f-1+1=len f;
  then
A9: f/.len f in LSeg(f,len f-'1) by A7,A8,TOPREAL1:27;
A10: f.1=f/.1 by A6,FINSEQ_4:24;
  f/.1=f/.len f by FINSEQ_6:def 1;
  then f.1 in LSeg(f,1)/\ LSeg(f,len f-'1) by A5,A9,A10,XBOOLE_0:def 3;
  then
A11: {f.1} c= LSeg(f,1)/\ LSeg(f,len f-'1) by ZFMISC_1:37;
  LSeg(f,1)/\ LSeg(f,len f-'1) c={f.1}
  proof
    let x be set;
    assume
A12: x in LSeg(f,1)/\ LSeg(f,len f-'1);
    then
A13: x in LSeg(f,1) & x in LSeg(f,len f-'1) by XBOOLE_0:def 3;
    reconsider p=x as Point of TOP-REAL 2 by A12;
A14: 1+1<=len f by GOBOARD7:36,XXREAL_0:2;
A15: LSeg(f/.1,f/.(1+1))=LSeg(f,1) by A2,TOPREAL1:def 5;
A16: LSeg(f/.(1+1),f/.(1+1+1))=LSeg(f,1+1) by A3,TOPREAL1:def 5;
A17: p in LSeg(f/.1,f/.(1+1)) by A13,A14,TOPREAL1:def 5;
    len f-'1+1=len f-1+1 by A1,BINARITH:50,XXREAL_0:2
      .=len f;
    then f/.(len f-'1+1)=f/.1 by FINSEQ_6:def 1;
    then
A18: p in LSeg(f/.1,f/.(len f-'1)) by A7,A8,A13,TOPREAL1:def 5;
    2+1-1<=len f-1 by A3,XREAL_1:11;
    then
A19: 1+1-1<=len f-'1 -1 by A7,XREAL_1:11;
    len f<len f+1 by NAT_1:13;
    then
A20: len f-1<len f+1-1 by XREAL_1:11;
    len f-'1-'1+1=len f-'1-1+1 by A7,A8,BINARITH:50
      .=len f-'1;
    then
A21: LSeg(f/.(len f-'1-'1),f/.(len f-'1))=LSeg(f,len f-'1-'1)
    by A7,A19,A20,TOPREAL1:def 5;
A22: LSeg(f/.(len f-'1),f/.(len f-'1+1))=LSeg(f,len f-'1)
    by A7,A8,TOPREAL1:def 5;
    now per cases;
      case
A23:    p<>f/.1;
        now per cases by A17,A18,A23,Th53;
          case
A24:        f/.(1+1) in LSeg(f/.1,f/.(len f-'1));
            len f-'1+1=len f-1+1 by A1,BINARITH:50,XXREAL_0:2
              .=len f;
            then
A25:        f/.(len f-'1+1)=f/.1 by FINSEQ_6:def 1;
            f/.(1+1) in LSeg(f/.(1+1),f/.(1+1+1)) by TOPREAL1:6;

then LSeg(f/.(1+1),f/.(1+1+1))/\ LSeg(f/.(len f-'1),f/.(len f-'1+1))
            <>{} by A24,A25,XBOOLE_0:def 3;
            then LSeg(f/.(1+1),f/.(1+1+1)) meets
            LSeg(f/.(len f-'1),f/.(len f-'1+1)) by XBOOLE_0:def 7;
            hence contradiction by A4,A7,A16,A20,A22,GOBOARD5:def 4;
          end;
          case
A26:        f/.(len f-'1) in LSeg(f/.1,f/.(1+1));
            f/.(len f-'1) in LSeg(f/.(len f-'1-'1),f/.(len f-'1))
            by TOPREAL1:6;

then LSeg(f,1)/\ LSeg(f,len f-'1-'1)<>{} by A15,A21,A26,XBOOLE_0:def 3;
            then
A27:        LSeg(f,1) meets LSeg(f,len f-'1-'1) by XBOOLE_0: def 7;
            3+1-1<len f-1 by A1,XREAL_1:11;
            then
A28:        2+1-1<len f-1-1 by XREAL_1:11;
            len f-1-1+1<len f by A20;

then 1+1<len f-'1-'1 & len f-'1-'1+1<len f by A7,A8,A28,BINARITH:50;
            hence contradiction by A27,GOBOARD5:def 4;
          end;
        end;
        hence contradiction;
      end;
      case p=f/.1;
        then x in {f/.1} by TARSKI:def 1;
        hence x in {f.1} by A6,FINSEQ_4:24;
      end;
    end;
    hence x in {f.1};
  end;
  hence thesis by A11,XBOOLE_0:def 10;
end;

theorem Th55:
  for f being non constant standard special_circular_sequence,
  i1,i2 being Element of NAT,g1,g2 being FinSequence of TOP-REAL 2
  st 1<=i1 & i1<i2 & i2<len f & g1=mid(f,i1,i2)
  & g2=mid(f,i1,1)^mid(f,len f-'1,i2)
  holds (L~g1)/\(L~g2)={f.i1,f.i2} & (L~g1) \/ (L~g2)=L~f
proof
  let f be non constant standard special_circular_sequence,
  i1,i2 be Element of NAT,g1,g2 be FinSequence of TOP-REAL 2;
  assume
A1: 1<=i1 & i1<i2 & i2<len f & g1=mid(f,i1,i2)
  & g2=mid(f,i1,1)^mid(f,len f-'1,i2);
  then
A2: 1<i2 by XXREAL_0:2;
A3: i1<len f by A1,XXREAL_0:2;
  then
A4: 1<len f by A1,XXREAL_0:2;
A5: i1+1<=len f by A3,NAT_1:13;
A6: i2+1<=len f by A1,NAT_1:13;
  then
A7: i2+1-1<=len f-1 by XREAL_1:11;
  then
A8: i2<=len f-'1 by A1,A3,BINARITH:50,XXREAL_0:2;
  then
A9: 1<len f-'1 by A2,XXREAL_0:2;
  i2+1-i2<=len f-i2 by A6,XREAL_1:11;
  then
A10: 1<=len f-'i2 by BINARITH:57;
A11: len f-'1+1=len f by A1,A3,BINARITH:53,XXREAL_0:2;
A12: len f-'1<len f-'1+1 by NAT_1:13;
  then
A13: len f-'1<len f by A1,A3,BINARITH:53,XXREAL_0:2;
A14: len mid(f,i1,i2)=i2-'i1+1 by A1,A2,A3,JORDAN3:27;
A15: 0<i2-i1 by A1,XREAL_1:52;
  then 0<i2-'i1 by A1,BINARITH:50;
  then 0+1<=i2-'i1 by NAT_1:13;
  then 1<len g1 by A1,A14,NAT_1:13;
  then
A16: 1+1<=len g1 by NAT_1:13;
A17: len mid(f,i1,1)=i1-'1+1 by A1,A3,Th21;
  then
A18: len mid(f,i1,1)=i1 by A1,BINARITH:53;
A19: mid(f,i1,1)<><*>(TOP-REAL 2) by A17,FINSEQ_1:32;
A20: 0+1<=len mid(f,i1,1) by A17,NAT_1:13;
A21: len mid(f,len f-'1,i2)=len f-'1-'i2+1 by A2,A8,A13,Th21;
A22: len f-'1-'i2+1=len f-'1-i2+1 by A8,BINARITH:50
    .=len f-1-i2+1
  by A1,A3,BINARITH:50,XXREAL_0:2
    .=len f-i2;
A23: mid(f,len f-'1,i2)<><*>(TOP-REAL 2) by A21,FINSEQ_1:32;
A24: 0+1<=len f-'1-'i2+1 by NAT_1:13;
A25: len g2 =len mid(f,i1,1) + len mid(f,len f-'1,i2) by A1,FINSEQ_1:35
    .=i1-'1+1+(len f-'1-'i2+1) by A1,A3,A21,Th21
    .=i1+(len f-'1-'i2+1) by A1,BINARITH:53;
  then
A26: 1+1<=len g2 by A1,A24,XREAL_1:9;
A27: L~(mid(f,i1,1)^mid(f,len f-'1,i2)) = L~mid(f,i1,1)
  \/ LSeg(mid(f,i1,1)/.len mid(f,i1,1),mid(f,len f-'1,i2)/.1)
  \/ L~mid(f,len f-'1,i2) by A19,A23,SPPOL_2:23;
A28: (L~g1)/\(L~g2) c= {f.i1,f.i2}
  proof
    let x be set;
    assume
A29: x in (L~g1)/\(L~g2);
    then
A30: x in L~g1 & x in L~g2 by XBOOLE_0:def 3;
    reconsider p=x as Point of TOP-REAL 2 by A29;
A31: x in L~mid(f,i1,i2) & x in L~(mid(f,i1,1)^mid(f,len f-'1,i2))
    by A1,A29,XBOOLE_0:def 3;
    consider i such that
A32: 1 <= i & i+1 <= len mid(f,i1,i2)
    & p in LSeg(mid(f,i1,i2),i) by A1,A30,SPPOL_2:13;
A33: i<i2-'i1+1 by A14,A32,NAT_1:13;
    then
A34: LSeg(mid(f,i1,i2),i)=LSeg(f,i+i1-'1) by A1,A32,Th31;
    i+1<=i2-'i1+1 by A1,A2,A3,A32,JORDAN3:27;
    then
A35: i+1-1<=i2-'i1+1-1 by XREAL_1:11;
A36: x in L~mid(f,i1,1)
    \/ LSeg(mid(f,i1,1)/.len mid(f,i1,1),mid(f,len f-'1,i2)/.1)
    or x in L~mid(f,len f-'1,i2) by A27,A31,XBOOLE_0:def 2;
    now per cases by A36,XBOOLE_0:def 2;
      case x in L~mid(f,i1,1);
        then consider k such that
A37:    1 <= k & k+1 <= len mid(f,i1,1)
        & p in LSeg(mid(f,i1,1),k) by SPPOL_2:13;
        now per cases;
          case i1<>1;
            then
A38:        1<=1 & 1<i1 & i1<=len f & 1<=k & k<i1-'1+1
            by A1,A17,A37,NAT_1:13,REAL_1:def 5,XXREAL_0:2;
            then
A39:        LSeg(mid(f,i1,1),k)=LSeg(f,i1-'k) by Th32;
            i1-'1+1=i1 by A1,BINARITH:53;
            then
A40:        i1-'k=i1-k by A38,BINARITH:50;
A41:        i+i1-'1=i+i1-1 by A1,BINARITH:55;
            set k3=i1-'k,i3=i+i1-'1;
A42:        x in LSeg(f,k3)/\ LSeg(f,i3) by A32,A34,A37,A39,XBOOLE_0:def 3;
A43:        LSeg(f,k3) meets LSeg(f,i3) by A32,A34,A37,A39,XBOOLE_0:3;
            1+1<=i+k by A32,A37,XREAL_1:9;
            then 1<i+k by XXREAL_0:2;
            then 1-k<i+k-k by XREAL_1:11;
            then 1-k-1<i-1 by XREAL_1:11;
            then i1+(1-k-1)<i1+(i-1) by XREAL_1:8;
            then
A44:        k3+1<=i3 by A40,A41,NAT_1:13;
A45:        now
              assume k3+1<>i3;
              then
A46:          k3+1<i3 by A44,REAL_1:def 5;
              i<i2-i1+1 by A1,A33,BINARITH:50;
              then
A47:          i+i1<i2-i1+1+i1 by XREAL_1:8;
              i2+1<=len f by A1,NAT_1:13;
              then i+i1-1+1<len f by A47,XXREAL_0:2;
              hence contradiction by A41,A43,A46,GOBOARD5:def 4;
            end;
            then
A48:        1+1=i+k-1+1 by A40,A41;
A49:        now
              assume
A50:          not(i=1 & k=1);
              now per cases by A50;
                case i<>1;
                  then 1<i by A32,REAL_1:def 5;
                  hence contradiction by A37,A48,XREAL_1:10;
                end;
                case k<>1;
                  then 1<k by A37,REAL_1:def 5;
                  hence contradiction by A32,A48,XREAL_1:10;
                end;
              end;
              hence contradiction;
            end;
            then
A51:        i3=i1 by BINARITH:39;
            1+1<=i1 by A38,NAT_1:13;
            then
A52:        1+1-1<=i1-1 by XREAL_1:11;
            k3+2=i1-'1+1+1 by A49
              .=i1+1 by A1,BINARITH:53;
            then x in {f/.(k3+1)} by A5,A42,A45,A52,TOPREAL1:def 8;
            then
A53:        x=f/.i1 by A45,A51,TARSKI:def 1;
            f/.i1=f.i1 by A1,A3,FINSEQ_4:24;
            hence x in {f.i1,f.i2} by A53,TARSKI:def 2;
          end;
          case
A54:        i1=1;
A55:        len mid(f,1,1)=1 by A4,Th27;
            1+1<=k+1 by A37,XREAL_1:8;
            hence contradiction by A37,A54,A55,XXREAL_0:2;
          end;
        end;
        hence x in {f.i1,f.i2};
      end;
      case
A56:    x in LSeg(mid(f,i1,1)/.len mid(f,i1,1),mid(f,len f-'1,i2)/.1);
A57:    mid(f,i1,1)/.len mid(f,i1,1)
        =mid(f,i1,1).len mid(f,i1,1) by A20,FINSEQ_4:24
          .=f.1 by A1,A3,A4,Th23
          .=f/.1 by A4,FINSEQ_4:24
          .=f/.len f by FINSEQ_6:def 1;
        i2+1-i2<=len f-i2 by A6,XREAL_1:11;
        then mid(f,len f-'1,i2)/.1=mid(f,len f-'1,i2).1 by A21,A22,FINSEQ_4:24
          .=f.(len f-'1) by A1,A2,A9,A13,JORDAN3:27
          .=f/.(len f-'1) by A9,A13,FINSEQ_4:24;
        then x in LSeg(f,len f-'1) by A9,A11,A56,A57,TOPREAL1:def 5;
        then
A58:    x in LSeg(f,i+i1-'1)/\ LSeg(f,len f-'1) by A32,A34, XBOOLE_0:def 3;
        then
A59:    LSeg(f,i+i1-'1) meets LSeg(f,len f-'1) by XBOOLE_0:4;
        now per cases;
          case
A60:        1<i1 or 1<i;
            i<=i2-i1 by A1,A35,BINARITH:50;
            then i+i1<=i2-i1+i1 by XREAL_1:8;
            then i+i1<len f by A1,XXREAL_0:2;
            then i+i1-1<len f-1 by XREAL_1:11;
            then i+i1-'1<len f-1 by A1,BINARITH:55;
            then i+i1-'1<len f-'1 by A1,A3,BINARITH:50,XXREAL_0:2;
            then
A61:        i+i1-'1+1<=len f-'1 by NAT_1:13;
A62:        now
              assume
A63:          i+i1-'1+1<len f-'1;
              1+1<i+i1 by A1,A32,A60,XREAL_1:10;
              then 1+1<i+i1-'1+1 by BINARITH:53,XXREAL_0:2;
              then 1+1-1<i+i1-'1+1-1 by XREAL_1:11;

then i+i1-'1>1 & len f-'1<len f by A1,A3,A12,BINARITH:53,XXREAL_0: 2;
              hence contradiction by A59,A63,GOBOARD5:def 4;
            end;
            then
A64:        i+i1-'1+1=len f-'1 by A61,REAL_1:def 5;
            set i3=i+i1-'1;
            1+1<=i+i1 by A1,A32,XREAL_1:9;
            then
A65:        1+1-1<=i+i1-1 by XREAL_1:11;
            len f-1+1<=len f;
            then len f-'1+1<=len f by A1,A3,BINARITH:50,XXREAL_0:2;
            then
A66:        1<=i3 & i3+2<=len f by A1,A64,A65,BINARITH:55;
A67:        i3+1=len f-'1 by A61,A62,REAL_1:def 5;
A68:        i+i1-'1=i+i1-1 by A1,BINARITH:55;
            now
              assume
A69:          i2<len f-'1;
              i+i1<=i2-'i1+i1 by A35,XREAL_1:8;
              then i+i1<=i2-i1+i1 by A15,BINARITH:def 3;
              hence contradiction by A61,A62,A68,A69,REAL_1:def 5;
            end;
            then
A70:        i3+1=i2 by A8,A67,XXREAL_0:1;
            x in {f/.(i3+1)} by A58,A66,A67,TOPREAL1:def 8;
            then
A71:        x=f/.i2 by A70,TARSKI:def 1;
            f/.i2=f.i2 by A1,A2,FINSEQ_4:24;
            hence x in {f.i1,f.i2} by A71,TARSKI:def 2;
          end;
          case
A72:        not(1<i1 or 1<i);
            then
A73:        i1=1 by A1,XXREAL_0:1;
            i=1 by A32,A72,XXREAL_0:1;
            then
A74:        i+i1-'1=1+1-'1 by A1,A72,XXREAL_0:1
              .=1 by BINARITH:39;
            LSeg(f,1)/\ LSeg(f,len f-'1)={f.1} by Th54;
            then x=f.1 by A58,A74,TARSKI:def 1;
            hence x in {f.i1,f.i2} by A73,TARSKI:def 2;
          end;
        end;
        hence x in {f.i1,f.i2};
      end;
      case x in L~mid(f,len f-'1,i2);
        then consider k such that
A75:    1 <= k & k+1 <= len mid(f,len f-'1,i2)
        & p in LSeg(mid(f,len f-'1,i2),k) by SPPOL_2:13;
A76:    k<len f-'1-'i2+1 by A21,A75,NAT_1:13;
A77:    k<len f-i2 by A21,A22,A75,NAT_1:13;
        k<len f-'i2 by A1,A22,A76,BINARITH:50;
        then k+1<=len f-'i2 by NAT_1:13;
        then k+1-1<=len f-'i2-1 by XREAL_1:11;
        then
A78:    k<=len f-'i2-'1 by A10,BINARITH:50;
A79:    len f-'i2-'1=len f-'i2-1 by A10,BINARITH:50
          .=len f-i2-1 by A1,BINARITH:50
          .=len f-1-i2
          .=len f-'1-i2 by A1,A3,BINARITH:50,XXREAL_0:2
          .=len f-'1-'i2 by A8,BINARITH:50;
        k+i2<len f-i2+i2 by A77,XREAL_1:8;
        then
A80:    k+i2-k<len f-k by XREAL_1:11;
        then
A81:    1<len f-k by A2,XXREAL_0:2;
        then 1+k<len f-k+k by XREAL_1:8;
        then 1+k-1<len f-1 by XREAL_1:11;
        then
A82:    k<len f-'1 by A1,A3,BINARITH:50,XXREAL_0:2;
        1<len f-'k by A81,BINARITH:def 3;
        then
A83:    len f-'k-'1=len f-'k-1 by BINARITH:50
          .=len f-k-1 by A80,BINARITH:def 3
          .=len f-1-k
          .=len f-'1-k by A1,A3,BINARITH:50,XXREAL_0:2
          .=len f-'1-'k by A82,BINARITH:50;
A84:    k<=len f-'1-'i2 by A76,NAT_1:13;
        now per cases;
          case i2<>len f-'1;

then 1<=i2 & i2<len f-'1 & len f-'1<=len f & 1<=k & k<len f-'1-'i2+1

by A1,A4,A8,A12,A21,A75,BINARITH:53,NAT_1:13,REAL_1:def 5,XXREAL_0:2;
            then
A85:        LSeg(mid(f,len f-'1,i2),k)=LSeg(f,len f-'1-'k) by Th32;
            k+(i2-1)<len f-i2+(i2-1) by A77,XREAL_1:8;
            then
A86:        k+(i2-'1)<len f-1 by A1,BINARITH:50,XXREAL_0:2;
            k<=k+(i2-'1) by NAT_1:11;
            then
A87:        k<len f-1 by A86,XXREAL_0:2;
            then k<len f-'1 by A1,A3,BINARITH:50,XXREAL_0:2;
            then
A88:        len f-'1-'k=len f-'1-k by BINARITH:50;
            k+1<len f-1+1 by A87,XREAL_1:8;
            then
A89:        k+1-k<len f-k by XREAL_1:11;
            len f<len f+1 by NAT_1:13;
            then len f-1<len f+1-1 by XREAL_1:11;
            then
A90:        len f-'k=len f-k by A87,BINARITH:50,XXREAL_0:2;
A91:        1<len f-'k by A89,BINARITH:57;
A92:        i+i1-'1=i+i1-1 by A1,BINARITH:55;
            set k3=len f-'1-'k,i3=i+i1-'1;
A93:        x in LSeg(f,i3)/\ LSeg(f,k3) by A32,A34,A75,A85,XBOOLE_0:def 3;
A94:        LSeg(f,i3) meets LSeg(f,k3) by A32,A34,A75,A85,XBOOLE_0:3;
            i2+(len f-'1-i2)<len f by A1,A3,A12,BINARITH:53,XXREAL_0:2;
            then i2-i1+i1+(len f-'1-'i2)<len f by A8,BINARITH:50;
            then
A95:        (i2-'i1)+i1+(len f-'1-'i2)<len f by A1,BINARITH:50;
            i+i1<=(i2-'i1)+i1 by A35,XREAL_1:8;
            then
A96:        i+i1+k<=(i2-'i1)+i1+k by XREAL_1:8;
            (i2-'i1)+i1+k<=(i2-'i1)+i1+(len f-'1-'i2) by A84,XREAL_1:8;
            then i+i1+k<=(i2-'i1)+i1+(len f-'1-'i2) by A96,XXREAL_0:2;
            then i+i1+k<len f by A95,XXREAL_0:2;
            then i+i1+k-k<len f-k by XREAL_1:11;
            then i+i1-1<len f-'k-1 by A90,XREAL_1:11;
            then i+i1-1<len f-'k-'1 by A91,BINARITH:50;
            then i+i1-'1<len f-'1-'k by A32,A83,BINARITH:55;
            then
A97:        i3+1<=k3 by NAT_1:13;
A98:        now
              assume not(i3+1=k3);
              then
A99:          i3+1<k3 by A97,REAL_1:def 5;
              len f-'1+1<=len f-'1+k by A75,XREAL_1:8;
              then len f-'1+1-k<=len f-'1+k-k by XREAL_1:11;
              then k3+1<len f by A13,A88,XXREAL_0:2;
              hence contradiction by A94,A99,GOBOARD5:def 4;
            end;
            then
A100:       len f-1-k=i1+i-1+1 by A1,A3,A88,A92,BINARITH:50, XXREAL_0:2;
A101:       now
              assume
A102:         not(i=i2-'i1 & k=len f-'1-'i2);
              now per cases by A102;
                case i<>i2-'i1;
                  then i<i2-'i1 by A35,REAL_1:def 5;
                  then i+k<i2-'i1+(len f-'i2-'1) by A78,XREAL_1:10;
                  then i+k<i2-i1+(len f-'i2-'1) by A1,BINARITH:50;
                  then i+k<i2-i1+(len f-'i2-1) by A10,BINARITH:50;
                  then i+k<i2-i1+(len f-i2-1) by A1,BINARITH:50;
                  hence contradiction by A100;
                end;
                case k<>len f-'1-'i2;
                  then k<len f-'1-'i2 by A84,REAL_1:def 5;
                  then i+k<i2-'i1+(len f-'i2-'1) by A35,A79,XREAL_1:10;
                  then i+k<i2-i1+(len f-'i2-'1) by A1,BINARITH:50;
                  then i+k<i2-i1+(len f-'i2-1) by A10,BINARITH:50;
                  then i+k<i2-i1+(len f-i2-1) by A1,BINARITH:50;
                  hence contradiction by A100;
                end;
              end;
              hence contradiction;
            end;
A103:       len f-'1=len f-1 by A1,A3,BINARITH:50,XXREAL_0:2;
            len f<=len f+i2 by NAT_1:11;
            then len f-'1+1<=len f+i2 by A1,A3,BINARITH:53,XXREAL_0:2;
            then len f-'1+1-i2<=len f+i2-i2 by XREAL_1:11;
            then len f-'1+1-i2-1<=len f-1 by XREAL_1:11;
            then len f-'1-i2<=len f-1;
            then len f-'1-'i2<=len f-'1 by A7,A103,BINARITH:50;
            then
A104:       k3 =len f-'1-(len f-'1-'i2) by A101,BINARITH:50
              .=len f-1-(len f-1-i2) by A7,A103,BINARITH:50
              .=i2;
            i3 =i2-'i1+i1-1 by A1,A101,BINARITH:55
              .=i2-i1+i1-1 by A1,BINARITH:50
              .=i2-1;
            then
A105:       i3+2=i2+1;
            1+1<=i2 by A2,NAT_1:13;
            then 1+1-1<=i2-1 by XREAL_1:11;
            then x in {f/.(i3+1)} by A6,A93,A98,A105,TOPREAL1:def 8;
            then x=f/.i2 by A98,A104,TARSKI:def 1;
            then x=f.i2 by A1,A2,FINSEQ_4:24;
            hence x in {f.i1,f.i2} by TARSKI:def 2;
          end;
          case
A106:       i2=len f-'1;
A107:       len mid(f,len f-'1,len f-'1)=1 by A9,A13,Th27;
            1+1<=k+1 by A75,XREAL_1:8;
            hence contradiction by A75,A106,A107,XXREAL_0:2;
          end;
        end;
        hence x in {f.i1,f.i2};
      end;
    end;
    hence x in {f.i1,f.i2};
  end;
A108: {f.i1} c= L~g1
  proof
    let x be set;
    assume x in {f.i1};
    then
A109: x=f.i1 by TARSKI:def 1;
    g1.1 =f.i1 by A1,A2,A3,JORDAN3:27;
    hence x in L~g1 by A16,A109,JORDAN3:34;
  end;
  {f.i2} c= L~g1
  proof
    let x be set;
    assume x in {f.i2};
    then
A110: x=f.i2 by TARSKI:def 1;
    g1.len g1=f.i2 by A1,A2,A3,Th23;
    hence x in L~g1 by A16,A110,JORDAN3:34;
  end;
  then {f.i1} \/ {f.i2} c= L~g1 by A108,XBOOLE_1:8;
  then
A111: {f.i1,f.i2} c= L~g1 by ENUMSET1:41;
A112: {f.i1} c= L~g2
  proof
    let x be set;
    assume x in {f.i1};
    then
A113: x=f.i1 by TARSKI:def 1;
    g2.1 =mid(f,i1,1).1 by A1,A20,FINSEQ_1:85
      .=f.i1 by A1,A3,A4,JORDAN3:27;
    hence x in L~g2 by A26,A113,JORDAN3:34;
  end;
  {f.i2} c= L~g2
  proof
    let x be set;
    assume x in {f.i2};
    then
A114: x=f.i2 by TARSKI:def 1;
    g2.len g2
    =mid(f,len f-'1,i2).(len f-'1-'i2+1) by A1,A18,A21,A24,A25,FINSEQ_1:86
      .=f.i2 by A1,A2,A9,A13,A21,Th23;
    hence x in L~g2 by A26,A114,JORDAN3:34;
  end;
  then {f.i1} \/ {f.i2} c= L~g2 by A112,XBOOLE_1:8;
  then {f.i1,f.i2} c= L~g2 by ENUMSET1:41;
  then
A115: {f.i1,f.i2} c= (L~g1)/\(L~g2) by A111,XBOOLE_1:19;
A116: L~g1 c= L~f by A1,A2,A3,Th47;
A117: L~mid(f,i1,1) c= L~f by A1,A3,A4,Th47;
A118: L~mid(f,len f-'1,i2) c= L~f by A1,A2,A9,A13,Th47;
  len f-'1+1=len f by A1,A3,BINARITH:53,XXREAL_0:2;
  then
A119: LSeg(f,len f-'1) =LSeg(f/.(len f-'1+1),f/.(len f-'1))
  by A9,TOPREAL1:def 5;
A120: f/.(len f-'1+1) =f/.len f by A1,A3,BINARITH:53,XXREAL_0:2
    .=f/.1 by FINSEQ_6:def 1
    .=f.1 by A4,FINSEQ_4:24
    .=mid(f,i1,1).len mid(f,i1,1) by A1,A3,A4,Th23
    .=mid(f,i1,1)/.len mid(f,i1,1) by A20,FINSEQ_4:24;
A121: 1<=len mid(f,len f-'1,i2) by A21,NAT_1:11;
A122: f/.(len f-'1) =f.(len f-'1) by A9,A13,FINSEQ_4:24
    .=mid(f,len f-'1,i2).1 by A1,A2,A9,A13,JORDAN3:27
    .=mid(f,len f-'1,i2)/.1 by A121,FINSEQ_4:24;
  then LSeg(mid(f,i1,1)/.len mid(f,i1,1),mid(f,len f-'1,i2)/.1)
  c= L~f by A119,A120,TOPREAL3:26;
  then L~mid(f,i1,1)
  \/ LSeg(mid(f,i1,1)/.len mid(f,i1,1),mid(f,len f-'1,i2)/.1)
  c= L~f by A117,XBOOLE_1:8;
  then L~g2 c= L~f by A1,A27,A118,XBOOLE_1:8;
  then
A123: (L~g1) \/ (L~g2) c= L~f by A116,XBOOLE_1:8;
  L~f c= (L~g1) \/ (L~g2)
  proof
    let x be set;
    assume
A124: x in L~f;
    then reconsider p=x as Point of TOP-REAL 2;
    consider i such that
A125: 1 <= i & i+1 <= len f & p in LSeg(f,i) by A124,SPPOL_2:13;
    now per cases;
      case
A126:   i1<=i & i<i2;
        then 0<=i-i1 by XREAL_1:50;
        then
A127:   0+1<=i-i1+1 by XREAL_1:8;
        i-i1<i2-i1 by A126,XREAL_1:11;
        then i-i1+1<i2-i1+1 by XREAL_1:8;
        then i-'i1+1<i2-i1+1 by A126,BINARITH:50;
        then
A128:   1<=i-'i1+1 & i-'i1+1<i2-'i1+1 by A1,A126,A127,BINARITH:50;
        i-'i1+1+i1-'1=i-'i1+1+i1-1 by A1,BINARITH:55
          .=i-'i1+i1
          .=i by A126,BINARITH:53;
        then x in LSeg(mid(f,i1,i2),i-'i1+1) by A1,A125,A128,Th31;
        then x in L~mid(f,i1,i2) by SPPOL_2:17;
        hence x in (L~g1) \/ (L~g2) by A1,XBOOLE_0:def 2;
      end;
      case
A129:   i<i1;
        then
A130:   1<i1 by A125,XXREAL_0:2;
        i1+1<=i1+i by A125,XREAL_1:8;
        then i1<i1+i by NAT_1:13;
        then i1-i<i1+i-i by XREAL_1:11;
        then i1-'i<i1-1+1 by A129,BINARITH:50;
        then
A131:   i1-'i<i1-'1+1 by A1,BINARITH:50;
        i+1<=i1 by A129,NAT_1:13;
        then i+1-i<=i1-i by XREAL_1:11;
        then
A132:   1<=i1-'i by BINARITH:57;
        i1<=i1+i by NAT_1:11;
        then i1-i<=i1+i-i by XREAL_1:11;
        then i1-'i <= i1 by A129,BINARITH:50;
        then i1-'(i1-'i)=i1-(i1-'i) by BINARITH:50
          .=i1-(i1-i) by A129,BINARITH:50
          .=i;
        then x in LSeg(mid(f,i1,1),i1-'i) by A3,A125,A130,A131,A132,Th32;
        then x in L~mid(f,i1,1) by SPPOL_2:17;
        then x in L~mid(f,i1,1)
        \/ LSeg(mid(f,i1,1)/.len mid(f,i1,1),mid(f,len f-'1,i2)/.1)
        by XBOOLE_0:def 2;
        then x in L~(mid(f,i1,1)^mid(f,len f-'1,i2)) by A27,XBOOLE_0:def 2;
        hence x in (L~g1) \/ (L~g2) by A1,XBOOLE_0:def 2;
      end;
      case
A133:   i2<=i;
        now per cases by A125,REAL_1:def 5;
          case i+1=len f;
            then i=len f-1;
            then i=len f-'1 by A1,A3,BINARITH:50,XXREAL_0:2;
            hence x in LSeg(mid(f,i1,1)/.len mid(f,i1,1),
            mid(f,len f-'1,i2)/.1)
            \/ L~mid(f,len f-'1,i2) by A119,A120,A122,A125,XBOOLE_0:def 2;
          end;
          case i+1<len f;
            then i+1+1<=len f by NAT_1:13;
            then i+1+1-1<=len f-1 by XREAL_1:11;
            then
A134:       i+1<=len f-'1 by A1,A3,BINARITH:50,XXREAL_0:2;
            then
A135:       i<len f-'1 by NAT_1:13;
            then
A136:       i2<len f-'1 by A133,XXREAL_0:2;
            i+1-i<=len f-'1-i by A134,XREAL_1:11;
            then
A137:       1<=len f-'1-'i by BINARITH:57;
            i2<i+1 by A133,NAT_1:13;
            then len f-'1+i2<len f-'1+(i+1) by XREAL_1:8;
            then len f-'1+i2-i2<len f-'1+(i+1)-i2 by XREAL_1:11;
            then len f-'1-i<len f-'1+1+i-i2-i by XREAL_1:11;
            then len f-'1-i<len f-'1-i2+1;
            then len f-'1-i<len f-'1-'i2+1 by A133,A135,BINARITH:50,XXREAL_0:2;
            then
A138:       len f-'1-'i<len f-'1-'i2+1 by A135,BINARITH:50;
            len f-'1-(len f-'1-'i) =len f-'1-(len f-'1-i) by A135,BINARITH:50
              .=i;
            then len f-'1-'(len f-'1-'i)=i by BINARITH:def 3;
            then x in LSeg(mid(f,len f-'1,i2),len f-'1-'i)
            by A2,A13,A125,A136,A137,A138,Th32;
            then x in L~mid(f,len f-'1,i2) by SPPOL_2:17;
            hence x in LSeg(mid(f,i1,1)/.len mid(f,i1,1),
            mid(f,len f-'1,i2)/.1) \/ L~mid(f,len f-'1,i2) by XBOOLE_0:def 2;
          end;
        end;
        then x in L~mid(f,i1,1)
        \/ (LSeg(mid(f,i1,1)/.len mid(f,i1,1),mid(f,len f-'1,i2)/.1)
        \/ L~mid(f,len f-'1,i2)) by XBOOLE_0:def 2;
        then x in L~(mid(f,i1,1)^mid(f,len f-'1,i2)) by A27,XBOOLE_1:4;
        hence x in (L~g1) \/ (L~g2) by A1,XBOOLE_0:def 2;
      end;
    end;
    hence x in (L~g1) \/ (L~g2);
  end;
  hence thesis by A28,A115,A123,XBOOLE_0:def 10;
end;

theorem Th56:
  for f being non constant standard special_circular_sequence,
  g being FinSequence of TOP-REAL 2,i1,i2 being Element of NAT st
  g is_a_part>_of f,i1,i2 & i1<i2 holds L~g is_S-P_arc_joining f/.i1,f/.i2
proof
  let f be non constant standard special_circular_sequence,
  g be FinSequence of TOP-REAL 2,i1,i2 be Element of NAT;
  assume
A1: g is_a_part>_of f,i1,i2 & i1<i2;
  then
A2: len g=i2-'i1+1 & g=mid(f,i1,i2) by Th37;
A3: 1<=i1 & i1+1<=len f &
  1<=i2 & i2+1<=len f & g.len g=f.i2 & 1<=len g & len g<len f &
  (for i being Element of NAT
  st 1<=i & i<=len g holds g.i=f.S_Drop((i1+i)-'1,f)) by A1,Def2;
  then
A4: g is_S-Seq by A1,A2,Th51;
A5: i1<len f by A3,NAT_1:13;
A6: i2<len f by A3,NAT_1:13;
  then
A7: g.1=f.i1 by A2,A3,A5,JORDAN3:27;
A8: f/.i1=f.i1 by A3,A5,FINSEQ_4:24;
  g/.len g=g.len g by A3,FINSEQ_4:24;
  then f/.i1=g/.1 & f/.i2=g/.len g by A3,A6,A7,A8,FINSEQ_4:24;
  hence thesis by A4,TOPREAL4:def 1;
end;

Lm1: for f being non constant standard special_circular_sequence,
g being FinSequence of TOP-REAL 2,i1,i2 being Element of NAT st
g is_a_part>_of f,i1,i2 & i1>i2 holds L~g is_S-P_arc_joining f/.i1,f/.i2
proof
  let f be non constant standard special_circular_sequence,
  g be FinSequence of TOP-REAL 2,i1,i2 be Element of NAT;
  assume
A1: g is_a_part>_of f,i1,i2 & i1>i2;
  then
A2: len g=len f+i2-'i1 & g=mid(f,i1,len f-'1)^(f|i2)
  & g=mid(f,i1,len f-'1)^mid(f,1,i2) by Th38;
A3: 1<=i1 & i1+1<=len f &
  1<=i2 & i2+1<=len f & g.len g=f.i2 & 1<=len g & len g<len f &
  (for i being Element of NAT
  st 1<=i & i<=len g holds g.i=f.S_Drop((i1+i)-'1,f)) by A1,Def2;
  then
A4: 1<len f by XXREAL_0:2;
  then
A5: len f-'1=len f-1 by BINARITH:50;
A6: i1-1=i1-'1 by A3,BINARITH:50;
A7: len f-'1+1=len f by A5;
A8: 1+1<=len f by A4,NAT_1:13;
A9: i1<len f by A3,NAT_1:13;
A10: i2<len f by A3,NAT_1:13;
  i1+1-i1<=len f-i1 by A3,XREAL_1:11;
  then
A11: 1<=len f-'i1 by BINARITH:57;
A12: i1+1-1<=len f-1 by A3,XREAL_1:11;
  then
A13: 1<=len f-'1 by A3,A5,XXREAL_0:2;
A14: len f-'1<len f-'1+1 by NAT_1:13;
  set f1=mid(f,i1,len f);
  1<i1 by A1,A3,XXREAL_0:2;
  then
A15: f1 is_S-Seq by A9,Th52;
A16: f1.len f1=f.(len f) by A3,A9,Th22;
A17: mid(f,1,i2).1=f.1 by A3,A4,A10,JORDAN3:27;
A18: f.(len f)=f/.len f by A4,FINSEQ_4:24;
A19: f/.1=f/.len f by FINSEQ_6:def 1;
  f.1=f/.1 by A4,FINSEQ_4:24;
  then
A20: f1.len f1=mid(f,1,i2).1 by A16,A17,A18,FINSEQ_6:def 1;
A21: len f1=len f-'i1+1 by A3,A4,A9,JORDAN3:27;
  then
A22: 1<=len f1 by NAT_1:11;
  len f1<len f1+1 by NAT_1:13;
  then
A23: len f1-1<len f1+1-1 by XREAL_1:11;
  i1+1-i1<=len f-i1 by A3,XREAL_1:11;
  then 1<=len f-'i1 by BINARITH:57;
  then
A24: 1<=len f1 & 1<=len f1-'1 & len f1-'1<=len f1
  by A21,A23,BINARITH:39,NAT_1:11;
  then
A25: len mid(f1,1,len f1-'1)=len f1-'1-'1+1 by JORDAN3:27
    .=len f-'i1+1-'1-'1+1 by A3,A4,A9,JORDAN3:27;
A26: len f-'i1-'1+1=len f-'i1-1+1 by A11,BINARITH:50
    .=len f-i1 by A9,BINARITH:50;
A27: len mid(f,i1,len f-'1)=len f-'1-'i1+1 by A3,A5,A9,A12,A13,A14,JORDAN3:27
    .=len f-1-i1+1 by A5,A12,BINARITH:50
    .=len f-i1;
  then
A28: len mid(f1,1,len f1-'1)=len mid(f,i1,len f-'1) by A25,A26, BINARITH :39;
  for k be Nat st 1<=k & k<=len mid(f,i1,len f-'1) holds
  mid(f1,1,len f1-'1).k=mid(f,i1,len f-'1).k
  proof
    let k be Nat;
    assume
A29: 1<=k & k<=len mid(f,i1,len f-'1);
    then
A30: k<=len f-'i1 by A9,A27,BINARITH:50;
A31: k in NAT by ORDINAL1:def 13;
    len mid(f,i1,len f)=len f-'i1+1 by A3,A4,A9,JORDAN3:27;
    then
A32: k<len mid(f,i1,len f) by A30,NAT_1:13;
    mid(f1,1,len f1-'1).k=f1.(k+1-'1) by A24,A28,A29,A31,JORDAN3:27
      .=f1.k by BINARITH:39
      .=f.(k+i1-'1) by A3,A4,A9,A29,A31,A32,JORDAN3:27;
    hence mid(f1,1,len f1-'1).k=mid(f,i1,len f-'1).k
    by A3,A5,A9,A12,A13,A14,A29,A31,JORDAN3:27;
  end;
  then
A33: mid(f1,1,len f1-'1)=mid(f,i1,len f-'1) by A28,FINSEQ_1:18;
A34: L~(f/^(i1-'1))
  = union { LSeg((f/^(i1-'1)),i) : 1 <= i & i+1 <= len (f/^(i1-'1)) }
  by TOPREAL1:def 6;
A35: L~(f|i2)= union { LSeg((f|i2),i) : 1 <= i & i+1 <= len (f|i2) }
  by TOPREAL1:def 6;
  now per cases by A3,REAL_1:def 5;
    case
A36:  i2>1;
      union { LSeg((f/^(i1-'1)),i) : 1 <= i & i+1 <= len (f/^(i1-'1)) }
      /\ union { LSeg((f|i2),j) : 1 <= j & j+1 <= len (f|i2) } ={f.1}
      proof
A37:    len (f/^(i1-'1))=len f-'(i1-'1) by JORDAN3:19;
        i1-i1<len f-i1 by A9,XREAL_1:11;
        then i1-i1+1<len f-i1+1 by XREAL_1:8;
        then 1<len f-(i1-1);
        then 1<len f-(i1-'1) by A3,BINARITH:50;
        then
A38:    1<len (f/^(i1-'1)) by A37,BINARITH:57;
        then 1+1<=len (f/^(i1-'1)) by NAT_1:13;
        then
A39:    1+1-1<=len (f/^(i1-'1))-1 by XREAL_1:11;
A40:    len (f/^(i1-'1))-'1+1=len (f/^(i1-'1))-1+1 by A38,BINARITH:50
          .=len (f/^(i1-'1));
        then
A41:    LSeg((f/^(i1-'1)),len (f/^(i1-'1))-'1)
        =LSeg((f/^(i1-'1))/.(len (f/^(i1-'1))-'1)
        ,(f/^(i1-'1))/.(len (f/^(i1-'1))-'1+1)) by A39,TOPREAL1:def 5;
A42:    i1-1<len f-1 by A9,XREAL_1:11;
        then i1-1<len f by A5,A14,XXREAL_0:2;
        then
A43:    i1-'1<len f by A3,BINARITH:50;
        then
A44:    (f/^(i1-'1))/.(len (f/^(i1-'1))-'1+1)=f/.len f by A40,Th18;
        i1-'1<=len f-1 by A3,A42,BINARITH:50;
        then
A45:    i1-'1<=len f-'1 by A4,BINARITH:50;
A46:    f/.len f in LSeg((f/^(i1-'1))/.(len (f/^(i1-'1))-'1), f/.len f)
        by TOPREAL1:6;
A47:    f.1=f/.1 by A4,FINSEQ_4:24;
        then f.1 in LSeg((f/^(i1-'1)),len (f/^(i1-'1))-'1) &
        LSeg((f/^(i1-'1)),len (f/^(i1-'1))-'1)
        in { LSeg((f/^(i1-'1)),i):1<=i & i+1 <= len (f/^(i1-'1))}
        by A39,A40,A41,A44,A46,FINSEQ_6:def 1;
        then
A48:    f.1 in union { LSeg((f/^(i1-'1)),i):1<=i & i+1 <= len (f/^ (i1-' 1))}
        by TARSKI:def 4;
A49:    len (f|2)=2 by A8,FINSEQ_1:80;
        then len (f|2)-'1=2-1 by BINARITH:57
          .=1;
        then
A50:    LSeg((f|2),len (f|2)-'1) = LSeg((f|2)/.(len (f|2)-'1)
        ,(f|2)/.(len (f|2)-'1+1)) by A49,TOPREAL1:def 5;
A51:    len (f|2)-'1=1+1-'1 by A8,FINSEQ_1:80
          .=1 by BINARITH:39;
A52:    (f|2)/.1=(f|2).1 by A49,FINSEQ_4:24;
A53:    (f|2).1=f.1 by FINSEQ_3:121;
A54:    (f|i2).1=f.1 by A3,FINSEQ_3:121;
A55:    len (f|i2)=i2 by A10,FINSEQ_1:80;
        then
A56:    (f|2)/.1=(f|i2)/.1 by A3,A52,A53,A54,FINSEQ_4:24;
A57:    1+1<=len (f|i2) by A36,A55,NAT_1:13;
A58:    (f|2).(1+1)=f.(1+1) by FINSEQ_3:121;
A59:    (f|2)/.(1+1)=(f|2).(1+1) by A49,FINSEQ_4:24;
        (f|i2).(1+1)=f.(1+1) by A55,A57,FINSEQ_3:121;
        then
A60:    (f|2)/.(1+1)=(f|i2)/.(1+1) by A57,A58,A59,FINSEQ_4:24;
A61:    LSeg(f|i2,1)=LSeg((f|i2)/.1,(f|i2)/.(1+1)) by A57,TOPREAL1:def 5;
A62:    (f|2)/.(len (f|2)-'1)=f/.1 by A47,A51,A52,FINSEQ_3:121;
        1<=1 & 1+1<=len (f|i2) by A36,A55,NAT_1:13;
        then f.1 in LSeg((f|2),len (f|2)-'1) & LSeg((f|2),len (f|2)-'1)
        in { LSeg((f|i2),i) : 1<=i & i+1 <= len (f|i2)}
        by A47,A50,A51,A56,A60,A61,A62,TOPREAL1:6;
        then f.1 in union { LSeg(f|i2,j) : 1 <= j & j+1 <= len (f|i2) }
        by TARSKI:def 4;
        then f.1 in union { LSeg((f/^(i1-'1)),i):1<=i & i+1 <= len (f/^(i1-'1)
        ) } /\ union { LSeg((f|i2),j) : 1 <= j & j+1 <= len (f|i2)}
        by A48,XBOOLE_0:def 3;
        then
A63:    {f.1} c= union { LSeg((f/^(i1-'1)),i):1<=i & i+1 <= len (f
        /^(i1-'1)) }

/\ union { LSeg((f|i2),j) : 1 <= j & j+1 <= len (f|i2) } by ZFMISC_1:37;
        union { LSeg((f/^(i1-'1)),i) : 1 <= i & i+1 <= len (f/^(i1-'1)) }
        /\ union { LSeg((f|i2),j) : 1 <= j & j+1 <= len (f|i2) } c= {f.1}
        proof
          let x be set;
          assume
A64:      x in
          union { LSeg((f/^(i1-'1)),i) : 1 <= i & i+1 <= len (f/^(i1-'1)) }
          /\ union { LSeg((f|i2),j) : 1 <= j & j+1 <= len (f|i2) };
          then x in union { LSeg((f/^(i1-'1)),i) :
          1 <= i & i+1 <= len (f/^(i1-'1)) } by XBOOLE_0:def 3;
          then consider Y1 being set such that
A65:      x in Y1 & Y1 in { LSeg(f/^(i1-'1),i):1<=i & i+1 <= len (f/^(i1-'1))}
          by TARSKI:def 4;
          consider j1 be Element of NAT such that
A66:      Y1=LSeg((f/^(i1-'1)),j1) &(1<=j1 & j1+1 <= len (f/^(i1-'1))) by A65;
          x in union { LSeg((f|i2),j) : 1 <= j & j+1 <= len (f|i2) }
          by A64,XBOOLE_0:def 3;
          then consider Y2 being set such that
A67:      x in Y2 &
          Y2 in { LSeg(f|i2,i):1<=i & i+1 <= len (f|i2)} by TARSKI:def 4;
          consider j2 be Element of NAT such that
A68:      Y2=LSeg((f|i2),j2) &(1<=j2 & j2+1 <= len (f|i2)) by A67;
A69:      LSeg(f/^(i1-'1),j1)=LSeg((f/^(i1-'1))/.j1,(f/^(i1-'1))/.(j1+1))
          by A66,TOPREAL1:def 5;
A70:      0+1<=(i1-'1)+j1 by A66,XREAL_1:9;
A71:      j1+1<=len f-'(i1-'1) by A66,JORDAN3:19;
          j1+1+(i1-'1)<=len f-'(i1-'1)+(i1-'1) by A37,A66,XREAL_1:8;
          then
A72:      j1+1+(i1-'1)<=len f by A43,BINARITH:53;
          then
A73:      LSeg(f,(i1-'1)+j1)=LSeg(f/.((i1-'1)+j1),f/.((i1-'1)+j1 +1))
          by A70,TOPREAL1:def 5;
          j1 <= len (f/^(i1-'1)) by A66,NAT_1:13;
          then
A74:      (f/^(i1-'1))/.j1=(f/^(i1-'1)).j1 by A66,FINSEQ_4:24;
          (i1-'1)+j1<=(i1-'1)+j1+1 by NAT_1:11;
          then
A75:      1<=j1 & j1+(i1-'1)<=len f by A66,A72,XXREAL_0:2;
          then (f/^(i1-'1)).j1=f.((i1-'1)+j1) by JORDAN3:23;
          then
A76:      (f/^(i1-'1))/.j1=f/.((i1-'1)+j1) by A70,A74,A75, FINSEQ_4:24;
          j1+1+(i1-'1)<=len f-'(i1-'1)+(i1-'1) by A71,XREAL_1:8;
          then j1+1+(i1-'1)<=len f by A43,BINARITH:53;
          then
A77:      (f/^(i1-'1)).(j1+1)=f.((i1-'1)+j1+1) by JORDAN3:23, NAT_1:11;
          (f/^(i1-'1))/.(j1+1)=(f/^(i1-'1)).(j1+1) by A66,FINSEQ_4:24,NAT_1:11;
          then
A78:      LSeg(f/^(i1-'1),j1)=LSeg(f,(i1-'1)+j1)
          by A69,A72,A73,A76,A77,FINSEQ_4:24,NAT_1:11;
A79:      len (f|i2)<=len f by FINSEQ_5:18;
          then
A80:      j2+1<=len f by A68,XXREAL_0:2;
A81:      j2<len (f|i2) by A68,NAT_1:13;
          then
A82:      j2<len f by A79,XXREAL_0:2;
A83:      (f|i2)/.j2=(f|i2).j2 by A68,A81,FINSEQ_4:24
            .= f.j2 by A55,A81,FINSEQ_3:121
            .= f/.j2 by A68,A82,FINSEQ_4:24;
A84:      (f|i2)/.(j2+1)=(f|i2).(j2+1) by A68,FINSEQ_4:24,NAT_1:11
            .=f.(j2+1) by A55,A68,FINSEQ_3:121
            .=f/.(j2+1) by A80,FINSEQ_4:24,NAT_1:11;
A85:      LSeg(f|i2,j2)=LSeg((f|i2)/.j2,
          (f|i2)/.(j2+1)) by A68,TOPREAL1:def 5;
          1<=j2 & j2+1<=len f by A68,A79,XXREAL_0:2;
          then
A86:      LSeg(f|i2,j2)=LSeg(f,j2) by A83,A84,A85,TOPREAL1:def 5;
A87:      now
            assume
A88:        not (j2=1 & i1-'1+j1=len f-'1);
            len (f/^(i1-'1))=len f-(i1-'1) by A9,A37,BINARITH:50,62;
            then
A89:        j1+1+(i1-'1) <= len f-(i1-'1)+(i1-'1) by A66, XREAL_1:8;
            then
A90:        (i1-'1)+j1+1 <= len f;
A91:        (i1-'1)+j1+1-1 <= len f-1 by A89,XREAL_1:11;
A92:        j2+1<i2+1 by A55,A68,NAT_1:13;
A93:        i2+1<=i1 by A1,NAT_1:13;
            i1-'1+1=i1 by A3,BINARITH:53;
            then
A94:        j2+1<i1-'1+1 by A92,A93,XXREAL_0:2;
            i1-'1+1<=i1-'1+j1 by A66,XREAL_1:8;
            then
A95:        j2+1<(i1-'1)+j1 & (i1-'1)+j1<len f by A90,A94, NAT_1:13
            ,XXREAL_0:2;
            now per cases by A5,A68,A88,A91,REAL_1:def 5;
              case j2>1;

then LSeg(f,(i1-'1)+j1) misses LSeg(f,j2) by A95,GOBOARD5:def 4;
                hence LSeg(f,(i1-'1)+j1) /\ LSeg(f,j2)={} by XBOOLE_0:def 7;
              end;
              case (i1-'1)+j1 < len f-'1;
                then (i1-'1)+j1+1 < len f-'1+1 by XREAL_1:8;

then LSeg(f,(i1-'1)+j1) misses LSeg(f,j2) by A5,A95,GOBOARD5:def 4;
                hence LSeg(f,(i1-'1)+j1) /\ LSeg(f,j2)={} by XBOOLE_0:def 7;
              end;
            end;
            hence contradiction by A65,A66,A67,A68,A78,A86,XBOOLE_0:def 3;
          end;
          then
A96:      j1=len f-'1-(i1-'1)
            .=len f-'1-'(i1-'1) by A45,BINARITH:50;
A97:      len f-'1-(i1-'1)+(i1-'1)<=len f by A5,A14;
          then
A98:      len f-'1-'(i1-'1)+(i1-'1)<=len f by A45,BINARITH:50;
          i1+1-1<=len f-1 by A3,XREAL_1:11;
          then
A99:      i1-(i1-1)<=len f-1-(i1-1) by XREAL_1:11;
          then
A100:     1<=len f-'1-'(i1-'1) by A5,A6,BINARITH:57;
A101:     1<=len f-'1-'(i1-'1) & len f-'1-'(i1-'1)+(i1-'1)<=len f
          by A5,A6,A97,A99,BINARITH:57;
A102:     len f-'1-(i1-'1)<len f-(i1-'1) by A5,A14,XREAL_1:11;
          len (f/^(i1-'1))=len f-(i1-'1) by A9,A37,BINARITH:50,62;
          then
A103:     len f-'1-'(i1-'1)<len (f/^(i1-'1)) by A45,A102, BINARITH:50;
          then
A104:     (f/^(i1-'1))/.(len f-'1-'(i1-'1))=(f/^(i1-'1)).(len f -'1-'(i1 -'1))
          by A100,FINSEQ_4:24
            .=f.(len f-'1-'(i1-'1)+(i1-'1)) by A98,A100,JORDAN3:23
            .=f.(len f-'1-(i1-'1)+(i1-'1)) by A45,BINARITH:50
            .=f/.(len f-'1) by A5,A13,A14,FINSEQ_4:24;
A105:     len f-'1-'(i1-'1)+1+(i1-'1)=
          len f-'1-(i1-'1)+1+(i1-'1) by A45,BINARITH:50
            .=len f-'1+1
            .=len f-1+1 by A4,BINARITH:50
            .=len f;
A106:     1<len f-'1-'(i1-'1)+1 by A100,NAT_1:13;
A107:     len f-'1-'(i1-'1)+1<=len (f/^(i1-'1)) by A103,NAT_1:13;
          then
A108:     (f/^(i1-'1))/.(len f-'1-'(i1-'1)+1)
          =(f/^(i1-'1)).(len f-'1-'(i1-'1)+1) by A106,FINSEQ_4:24
            .=f.(1+((len f-'1-'(i1-'1))+(i1-'1))) by A105,A106,JORDAN3:23
            .=f.(len f-'1-(i1-'1)+(i1-'1)+1) by A45,BINARITH:50
            .=f.len f by A4,BINARITH:53
            .=f/.len f by A4,FINSEQ_4:24;
A109:     LSeg(f/^(i1-'1),j1) =LSeg((f/^(i1-'1))/.(len f-'1-'(i1-'1)),
          (f/^(i1-'1))/.(len f-'1-'(i1-'1)+1)) by A96,A101,A107,TOPREAL1:def 5
            .=LSeg(f,len f-'1) by A7,A13,A104,A108,TOPREAL1:def 5;
          LSeg((f|i2),j2) = LSeg(f,1) by A57,A87,SPPOL_2:3;
          then LSeg((f/^(i1-'1)),j1) /\ LSeg((f|i2),j2) ={f.1} by A109,Th54;
          hence x in {f.1} by A65,A66,A67,A68,XBOOLE_0:def 3;
        end;
        hence thesis by A63,XBOOLE_0:def 10;
      end;
      then L~(f/^(i1-'1)) /\ L~mid(f,1,i2) ={f.1} by A3,A34,A35,JORDAN3:25;
      then
A110: L~f1 /\ L~mid(f,1,i2)={mid(f,1,i2).1} by A9,A17,JORDAN3:26;
      mid(f,1,i2) is_S-Seq by A3,A36,Th51;
      hence mid(f1,1,len f1-'1)^mid(f,1,i2) is_S-Seq
      by A15,A20,A110,JORDAN3:80;
    end;
    case i2=1;
      then
A111: mid(f,1,i2)=f|1 by JORDAN3:25
        .=<*f/.1*> by FINSEQ_5:23;
A112: <*f/.1*>=<*f1/.len f1*> by A16,A18,A19,A22,FINSEQ_4:24;
A113: mid(f1,1,len f1-'1)=f1|(len f1-'1) by A24,JORDAN3:25;
      len f1-'1+1=len f1 by A21,BINARITH:39;
      hence mid(f1,1,len f1-'1)^mid(f,1,i2) is_S-Seq
      by A15,A111,A112,A113,FINSEQ_5:24;
    end;
  end;
  then
A114: g is_S-Seq by A1,A33,Th38;
A115: i1<len f by A3,NAT_1:13;
  len mid(f,i1,len f-'1)=len f-'1-'i1+1 by A3,A5,A9,A12,A13,A14,JORDAN3: 27;
  then 1<=len mid(f,i1,len f-'1) by NAT_1:11;
  then 1 in Seg len mid(f,i1,len f-'1) by FINSEQ_1:3;
  then 1 in dom mid(f,i1,len f-'1) by FINSEQ_1:def 3;
  then g.1=mid(f,i1,len f-'1).1 by A2,FINSEQ_1:def 7;
  then
A116: g.1=f.i1 by A3,A5,A9,A13,A14,JORDAN3:27;
A117: g/.len g=g.len g by A3,FINSEQ_4:24;
  f/.i1=f.i1 by A3,A115,FINSEQ_4:24;
  then f/.i1=g/.1 & f/.i2=g/.len g by A3,A10,A116,A117,FINSEQ_4:24;
  hence thesis by A114,TOPREAL4:def 1;
end;

theorem
  for f being non constant standard special_circular_sequence,
  g being FinSequence of TOP-REAL 2,i1,i2 being Element of NAT st
  g is_a_part<_of f,i1,i2 & i1>i2 holds L~g is_S-P_arc_joining f/.i1,f/.i2
proof
  let f be non constant standard special_circular_sequence,
  g be FinSequence of TOP-REAL 2,i1,i2 be Element of NAT;
  assume g is_a_part<_of f,i1,i2 & i1>i2;
  then
A1: L~Rev g is_S-P_arc_joining f/.i2,f/.i1 by Th42,Th56;
  reconsider p2=f/.i2,p1=f/.i1 as Point of TOP-REAL 2;
  reconsider P=L~g as Subset of TOP-REAL 2;
  P is_S-P_arc_joining p2,p1 by A1,SPPOL_2:22;
  hence thesis by SPPOL_2:53;
end;

theorem Th58:
  for f being non constant standard special_circular_sequence,
  g being FinSequence of TOP-REAL 2,i1,i2 being Element of NAT st
  g is_a_part>_of f,i1,i2 & i1<>i2 holds L~g is_S-P_arc_joining f/.i1,f/.i2
proof
  let f be non constant standard special_circular_sequence,
  g be FinSequence of TOP-REAL 2,i1,i2 be Element of NAT;
  assume
A1: g is_a_part>_of f,i1,i2 & i1<>i2;
  now per cases;
    case i1<i2;
      hence L~g is_S-P_arc_joining f/.i1,f/.i2 by A1,Th56;
    end;
    case i1>=i2;
      then i1>i2 by A1,REAL_1:def 5;
      hence L~g is_S-P_arc_joining f/.i1,f/.i2 by A1,Lm1;
    end;
  end;
  hence L~g is_S-P_arc_joining f/.i1,f/.i2;
end;

theorem Th59:
  for f being non constant standard special_circular_sequence,
  g being FinSequence of TOP-REAL 2,i1,i2 being Element of NAT st
  g is_a_part<_of f,i1,i2 & i1<>i2 holds L~g is_S-P_arc_joining f/.i1,f/.i2
proof
  let f be non constant standard special_circular_sequence,
  g be FinSequence of TOP-REAL 2,i1,i2 be Element of NAT;
  assume
A1: g is_a_part<_of f,i1,i2 & i1<>i2;
  now per cases;
    case i1>i2;
      then
A2:   L~Rev g is_S-P_arc_joining f/.i2,f/.i1 by A1,Th42,Th56;
      reconsider p2=f/.i2,p1=f/.i1 as Point of TOP-REAL 2;
      reconsider P=L~g as Subset of TOP-REAL 2;
      P is_S-P_arc_joining p2,p1 by A2,SPPOL_2:22;
      hence L~g is_S-P_arc_joining f/.i1,f/.i2 by SPPOL_2:53;
    end;
    case i1<=i2;
      then i1<i2 by A1,REAL_1:def 5;
      then
A3:   L~(Rev g) is_S-P_arc_joining f/.i2,f/.i1 by A1,Lm1,Th42;
      reconsider p2=f/.i2,p1=f/.i1 as Point of TOP-REAL 2;
      reconsider P=L~g as Subset of TOP-REAL 2;
      P is_S-P_arc_joining p2,p1 by A3,SPPOL_2:22;
      hence L~g is_S-P_arc_joining f/.i1,f/.i2 by SPPOL_2:53;
    end;
  end;
  hence thesis;
end;

theorem Th60:
  for f being non constant standard special_circular_sequence,
  g being FinSequence of TOP-REAL 2,i1,i2 being Element of NAT
  st g is_a_part_of f,i1,i2 & i1<>i2 holds L~g is_S-P_arc_joining f/.i1,f/.i2
proof
  let f be non constant standard special_circular_sequence,
  g be FinSequence of TOP-REAL 2,i1,i2 be Element of NAT;
  assume
A1: g is_a_part_of f,i1,i2 & i1<>i2;
  now per cases by A1,Def4;
    case g is_a_part>_of f,i1,i2;
      hence L~g is_S-P_arc_joining f/.i1,f/.i2 by A1,Th58;
    end;
    case g is_a_part<_of f,i1,i2;
      hence L~g is_S-P_arc_joining f/.i1,f/.i2 by A1,Th59;
    end;
  end;
  hence thesis;
end;

theorem
  for f being non constant standard special_circular_sequence,
  g being FinSequence of TOP-REAL 2,i1,i2 being Element of NAT
  st g is_a_part_of f,i1,i2 & g.1<>g.len g
  holds L~g is_S-P_arc_joining f/.i1,f/.i2
proof
  let f be non constant standard special_circular_sequence,
  g be FinSequence of TOP-REAL 2,i1,i2 be Element of NAT;
  assume
A1: g is_a_part_of f,i1,i2 & g.1<>g.len g;
  now per cases by A1,Def4;
    case
A2:   g is_a_part>_of f,i1,i2;
      then
A3:   1<=i1 & i1+1<=len f &
      1<=i2 & i2+1<=len f & g.len g=f.i2 & 1<=len g & len g<len f &
      (for i being Element of NAT st 1<=i & i<=len g
      holds g.i=f.S_Drop((i1+i)-'1,f)) by Def2;
      then
A4:   1<len f by XXREAL_0:2;
      i1+1-1<=len f-1 by A3,XREAL_1:11;
      then
A5:   i1<=len f-'1 by A4,BINARITH:50;
      now
        assume
A6:     i1=i2;
        g.1=f.S_Drop((i1+1)-'1,f) by A3
          .=f.S_Drop(i1,f) by BINARITH:39
          .=f.i1 by A3,A5,Th34;
        hence contradiction by A1,A2,A6,Def2;
      end;
      hence L~g is_S-P_arc_joining f/.i1,f/.i2 by A1,Th60;
    end;
    case
A7:   g is_a_part<_of f,i1,i2;
      then
A8:   1<=i1 & i1+1<=len f &
      1<=i2 & i2+1<=len f & g.len g=f.i2 & 1<=len g & len g<len f &
      (for i being Element of NAT st 1<=i & i<=len g
      holds g.i=f.S_Drop(len f +i1-'i,f)) by Def3;
      then
A9:   1<len f by XXREAL_0:2;
      i1+1-1<=len f-1 by A8,XREAL_1:11;
      then
A10:  i1<=len f-'1 by A9,BINARITH:50;
      now
        assume
A11:    i1=i2;
        g.1=f.S_Drop(len f+i1-'1,f) by A8
          .=f.S_Drop(len f-'1+1+i1-'1,f) by A9,BINARITH:53
          .=f.S_Drop(len f-'1+i1+1-'1,f)
          .=f.S_Drop(len f-'1+i1,f) by BINARITH:39
          .=f.S_Drop(i1,f) by Th35
          .=f.i1 by A8,A10,Th34;
        hence contradiction by A1,A7,A11,Def3;
      end;
      hence L~g is_S-P_arc_joining f/.i1,f/.i2 by A1,Th60;
    end;
  end;
  hence thesis;
end;

theorem Th62:
  for f being non constant standard special_circular_sequence,
  i1,i2 being Element of NAT st
  1<=i1 & i1+1<=len f & 1<=i2 & i2+1<=len f & i1<>i2 holds
  ex g1,g2 being FinSequence of TOP-REAL 2 st
  g1 is_a_part_of f,i1,i2 & g2 is_a_part_of f,i1,i2
  & (L~g1)/\(L~g2)={f.i1,f.i2} & (L~g1) \/ (L~g2)=L~f &
  L~g1 is_S-P_arc_joining f/.i1,f/.i2 & L~g2 is_S-P_arc_joining f/.i1,f/.i2 &
  for g being FinSequence of TOP-REAL 2 st g is_a_part_of f,i1,i2 holds
  g=g1 or g=g2
proof
  let f be non constant standard special_circular_sequence,
  i1,i2 be Element of NAT;
  assume
A1: 1<=i1 & i1+1<=len f & 1<=i2 & i2+1<=len f & i1<>i2;
  now per cases;
    case
A2:   i1<=i2;
      then
A3:   i1<i2 by A1,REAL_1:def 5;
A4:   i2<len f by A1,NAT_1:13;
      set h1=mid(f,i1,i2),h2=mid(f,i1,1)^mid(f,len f-'1,i2);
A5:   mid(f,i1,i2) is_a_part>_of f,i1,i2 by A1,A2,A4,Th43;
      mid(f,i1,1)^mid(f,len f-'1,i2) is_a_part<_of f,i1,i2 by A1,A3,A4,Th46;
      then
A6:   h1 is_a_part_of f,i1,i2 & h2 is_a_part_of f,i1,i2 by A5,Def4;
A7:   (L~h1)/\(L~h2)={f.i1,f.i2} & (L~h1) \/ (L~h2)=L~f by A1,A3,A4,Th55;
A8:   L~h1 is_S-P_arc_joining f/.i1,f/.i2 by A3,A5,Th56;
A9:   L~h2 is_S-P_arc_joining f/.i1,f/.i2 by A1,A6,Th60;
      for g being FinSequence of TOP-REAL 2 st g is_a_part_of f,i1,i2 holds
      g=h1 or g=h2
      proof
        let g be FinSequence of TOP-REAL 2;
        assume
A10:    g is_a_part_of f,i1,i2;
        now per cases by A10,Def4;
          case g is_a_part>_of f,i1,i2;
            hence g=h1 or g=h2 by A2,Th37;
          end;
          case g is_a_part<_of f,i1,i2;
            hence g=h1 or g=h2 by A3,Th40;
          end;
        end;
        hence g=h1 or g=h2;
      end;
      hence ex g1,g2 being FinSequence of TOP-REAL 2 st
      g1 is_a_part_of f,i1,i2 & g2 is_a_part_of f,i1,i2
      & (L~g1)/\(L~g2)={f.i1,f.i2} & (L~g1) \/ (L~g2)=L~f &
      L~g1 is_S-P_arc_joining f/.i1,f/.i2 &
      L~g2 is_S-P_arc_joining f/.i1,f/.i2 &
      for g being FinSequence of TOP-REAL 2 st g is_a_part_of f,i1,i2 holds
      g=g1 or g=g2 by A6,A7,A8,A9;
    end;
    case
A11:  i1>i2;
A12:  i1<len f by A1,NAT_1:13;
      set h1=mid(f,i2,i1),h2=mid(f,i2,1)^mid(f,len f-'1,i1);
      set h3=Rev h1,h4=Rev h2;
A13:  (L~h1)/\(L~h2)={f.i2,f.i1} & (L~h1) \/ (L~h2)=L~f by A1,A11,A12,Th55;
A14:  L~h1=L~h3 by SPPOL_2:22;
A15:  mid(f,i2,i1) is_a_part>_of f,i2,i1 by A1,A11,A12,Th43;
A16:  Rev mid(f,i2,i1) is_a_part<_of f,i1,i2 by A1,A11,A12,Th41,Th43;
      Rev (mid(f,i2,1)^mid(f,len f-'1,i1))
      is_a_part>_of f,i1,i2 by A1,A11,A12,Th42,Th46;
      then
A17:  h3 is_a_part_of f,i1,i2 & h4 is_a_part_of f,i1,i2 by A16,Def4;
A18:  (L~h3)/\(L~h4)={f.i1,f.i2} & (L~h3) \/ (L~h4)=L~f by A13,A14,SPPOL_2:22;
A19:  L~h3 is_S-P_arc_joining f/.i1,f/.i2 by A11,A15,Th41,Th59;
A20:  L~h4 is_S-P_arc_joining f/.i1,f/.i2 by A1,A17,Th60;
      for g being FinSequence of TOP-REAL 2 st g is_a_part_of f,i1,i2 holds
      g=h3 or g=h4
      proof
        let g be FinSequence of TOP-REAL 2;
        assume
A21:    g is_a_part_of f,i1,i2;
        now per cases by A21,Def4;
          case g is_a_part>_of f,i1,i2;
            then Rev g is_a_part<_of f,i2,i1 by Th41;
            then Rev g= mid(f,i2,1)^mid(f,len f-'1,i1) by A11,Th40;
            hence g=h3 or g=h4 by FINSEQ_6:29;
          end;
          case g is_a_part<_of f,i1,i2;
            then Rev g is_a_part>_of f,i2,i1 by Th42;
            then Rev g= mid(f,i2,i1) by A11,Th37;
            hence g=h3 or g=h4 by FINSEQ_6:29;
          end;
        end;
        hence g=h3 or g=h4;
      end;
      hence ex g1,g2 being FinSequence of TOP-REAL 2 st
      g1 is_a_part_of f,i1,i2 & g2 is_a_part_of f,i1,i2
      & (L~g1)/\(L~g2)={f.i1,f.i2} & (L~g1) \/ (L~g2)=L~f &
      L~g1 is_S-P_arc_joining f/.i1,f/.i2 &
      L~g2 is_S-P_arc_joining f/.i1,f/.i2 &
      for g being FinSequence of TOP-REAL 2 st g is_a_part_of f,i1,i2 holds
      g=g1 or g=g2 by A17,A18,A19,A20;
    end;
  end;
  hence thesis;
end;

reserve g, g1, g2 for FinSequence of TOP-REAL 2;

theorem
  for f being non constant standard special_circular_sequence,
  P being non empty Subset of TOP-REAL 2 st P = L~f
  holds P is_simple_closed_curve
proof
  let f be non constant standard special_circular_sequence,
  P be non empty Subset of TOP-REAL 2 such that
A1: P = L~f;
A2: 1<=1 & 1<=1+1 & 1<=len f & 1+1<len f & 1+1+1<=len f & 1<>1+1
  by GOBOARD7:36,XXREAL_0:2;
  set i1=1,i2=1+1;
  consider g1,g2 being FinSequence of TOP-REAL 2 such that
A3: g1 is_a_part_of f,i1,i2 & g2 is_a_part_of f,i1,i2
  & (L~g1)/\(L~g2)={f.i1,f.i2} & (L~g1) \/ (L~g2)=L~f &
  L~g1 is_S-P_arc_joining f/.i1,f/.i2 & L~g2 is_S-P_arc_joining f/.i1,f/.i2 &
  for g being FinSequence of TOP-REAL 2 st g is_a_part_of f,i1,i2 holds
  g=g1 or g=g2 by A2,Th62;
  reconsider L1 = L~g1, L2 = L~g2 as non empty Subset of TOP-REAL 2 by A3;
A4: L1 is_an_arc_of f/.i1,f/.i2 by A3,TOPREAL4:3;
A5: L2 is_an_arc_of f/.i1,f/.i2 by A3,TOPREAL4:3;
A6: f.i1=f/.i1 by A2,FINSEQ_4:24;
A7: f.i2=f/.i2 by A2,FINSEQ_4:24;
A8: f/.i1<>f/.i2 by A2,GOBOARD7:38;
  f/.i1 in (L~g1)/\(L~g2) by A3,A6,TARSKI:def 2;
  then f/.i1 in (L~g1) by XBOOLE_0:def 3;
  then
A9: f/.i1 in P by A1,A3,XBOOLE_0:def 2;
  f/.i2 in (L~g1)/\(L~g2) by A3,A7,TARSKI:def 2;
  then f/.i2 in (L~g2) by XBOOLE_0:def 3;
  then f/.i2 in P by A1,A3,XBOOLE_0:def 2;
  hence thesis by A1,A3,A4,A5,A6,A7,A8,A9,TOPREAL2:6;
end;

theorem Th64:
  for f being non constant standard special_circular_sequence,
  g1,g2 st g1 is_a_part>_of f,i1,i2 & g2 is_a_part>_of f,i1,i2 holds g1=g2
proof
  let f be non constant standard special_circular_sequence, g1,g2;
  assume
A1: g1 is_a_part>_of f,i1,i2 & g2 is_a_part>_of f,i1,i2;
  now per cases;
    case
A2:   i1<=i2;
      then g1=mid(f,i1,i2) by A1,Th37;
      hence g1=g2 by A1,A2,Th37;
    end;
    case
A3:   i1>i2;
      then g1=mid(f,i1,len f-'1)^mid(f,1,i2) by A1,Th38;
      hence g1=g2 by A1,A3,Th38;
    end;
  end;
  hence g1=g2;
end;

theorem Th65:
  for f being non constant standard special_circular_sequence,
  g1,g2 st g1 is_a_part<_of f,i1,i2 & g2 is_a_part<_of f,i1,i2 holds g1=g2
proof
  let f be non constant standard special_circular_sequence, g1,g2;
  assume
A1: g1 is_a_part<_of f,i1,i2 & g2 is_a_part<_of f,i1,i2;
  per cases;
  suppose
A2: i1>=i2;
    then g1=mid(f,i1,i2) by A1,Th39;
    hence g1=g2 by A1,A2,Th39;
  end;
  suppose
A3: i1<i2;
    then g1=mid(f,i1,1)^mid(f,len f-'1,i2) by A1,Th40;
    hence g1=g2 by A1,A3,Th40;
  end;
end;

theorem Th66:
  for f being non constant standard special_circular_sequence,
  g1,g2 st i1<>i2 & g1 is_a_part>_of f,i1,i2 & g2 is_a_part<_of f,i1,i2
  holds g1.2<>g2.2
proof
  let f be non constant standard special_circular_sequence, g1,g2;
  assume
A1: i1<>i2 & g1 is_a_part>_of f,i1,i2 & g2 is_a_part<_of f,i1,i2;
  then
A2: 1<=i1 & i1+1<=len f & 1<=i2 & i2+1<=len f &
  g1 is_a_part>_of f,i1,i2 & g2 is_a_part<_of f,i1,i2 by Def2;
A3: 1<=1+i1 by NAT_1:11;
  then
A4: 1<=len f by A2,XXREAL_0:2;
A5: len f-'1=len f-1 by A2,A3,BINARITH:50,XXREAL_0:2;
A6: len f-'1<len f-'1+1 by NAT_1:13;
A7: i2<len f by A2,NAT_1:13;
A8: i1<len f by A2,NAT_1:13;
  now per cases;
    case
A9:   i1<=i2;
      now per cases by A9,REAL_1:def 5;
        case i1=i2;
          hence contradiction by A1;
        end;
        case
A10:      i1<i2;
          then
A11:      g2=mid(f,i1,1)^mid(f,len f-'1,i2) by A1,Th40;
          i1+1-1<=len f-1 by A2,XREAL_1:11;
          then
A12:      1<=len f-'1 by A2,A5,XXREAL_0:2;
A13:      len mid(f,i1,1)=i1-'1+1 by A2,A8,Th21;
          now per cases by A2,REAL_1:def 5;
            case
A14:          1<i1;
              then
A15:          1+1<=i1 by NAT_1:13;
              1+1<=i1-1+1 by A14,NAT_1:13;
              then
A16:          2<=len mid(f,i1,1) by A2,A13,BINARITH:50;
A17:          g2.2=(mid(f,i1,1)^mid(f,len f-'1,i2)).2 by A1,A10,Th40
                .=mid(f,i1,1).2 by A16,FINSEQ_1:85
                .=f.(i1-'2+1) by A4,A8,A14,A16,JORDAN3:27
                .=f.(i1-(1+1)+1) by A15,BINARITH:50
                .=f.(i1-1)
                .=f.(i1-'1) by A2,BINARITH:50;
              i1+1<=i2 by A10,NAT_1:13;
              then 1+i1-i1<=i2-i1 by XREAL_1:11;
              then 1<=i2-'i1 by BINARITH:57;
              then 1+1<=i2-'i1+1 by XREAL_1:8;
              then
A18:          2<=len mid(f,i1,i2) by A2,A7,A8,A10,JORDAN3:27;
A19:          g1.2=mid(f,i1,i2).2 by A1,A10,Th37
                .=f.(2+i1-'1) by A2,A7,A8,A10,A18,JORDAN3:27
                .=f.(1+1+i1-1) by BINARITH:55
                .=f.(i1+1);
              1+1<=i1 by A14,NAT_1:13;
              then
A20:          1+1-1<=i1-1 by XREAL_1:11;
              then
A21:          1<=i1-'1 by BINARITH:57;
A22:          now
                assume
A23:            1=i1-'1 & i1+1=len f;
                then 1=i1-1 by BINARITH:57;
                hence contradiction by A23,GOBOARD7:36;
              end;
              now per cases by A22;
                case
A24:              1<>i1-'1;
                  i1-'1<i1-'1+1 by NAT_1:13;
                  then i1-'1<i1 by A2,BINARITH:53;
                  then
A25:              1<i1-'1 & i1-'1<i1+1 & i1+1<=len f
                  by A1,A21,A24,Def2,NAT_1:13,REAL_1:def 5;
                  then
A26:              f/.(i1-'1)<>f/.(i1+1) by GOBOARD7:39;
                  i1-'1<len f by A25,XXREAL_0:2;
                  then
A27:              f.(i1-'1)=f/.(i1-'1) by A21,FINSEQ_4: 24;
                  1<i1+1 by A2,NAT_1:13;
                  hence thesis by A2,A17,A19,A26,A27,FINSEQ_4:24;
                end;
                case
A28:              i1+1<>len f;
                  i1-'1<i1-'1+1 by NAT_1:13;
                  then i1-'1<i1 by A2,BINARITH:53;
                  then
A29:              1<=i1-'1 & i1-'1<i1+1 & i1+1<len f
                  by A2,A20,A28,BINARITH:57,NAT_1:13,REAL_1:def 5;
                  then
A30:              f/.(i1-'1)<>f/.(i1+1) by GOBOARD7:38;
                  i1-'1<len f by A29,XXREAL_0:2;
                  then
A31:              f.(i1-'1)=f/.(i1-'1) by A29,FINSEQ_4: 24;
                  1<i1+1 by A2,NAT_1:13;
                  hence thesis by A2,A17,A19,A30,A31,FINSEQ_4:24;
                end;
              end;
              hence thesis;
            end;
            case
A32:          1=i1;
A33:          len mid(f,i1,1)=i1-'1+1 by A2,A8,Th21
                .=0+1 by A32,BINARITH:51
                .=1;
A34:          len g2=len f+i1-'i2 by A1,A10,Th40
                .=len f+1-i2 by A7,A32,BINARITH:55;
              i2+1+1<=len f+1 by A2,XREAL_1:8;
              then
A35:          1+i2+1-i2<=len f+1-i2 by XREAL_1:11;
A36:          len mid(f,i1,1)=i1-'1+1 by A2,A8,Th21
                .=0+1 by A32,BINARITH:51
                .=1;
A37:          g2.2 =mid(f,len f-'1,i2).(2-len mid(f,i1,1))
              by A11,A33,A34,A35,JORDAN3:15
                .=f.(len f-'1) by A2,A5,A6,A7,A12,A36,JORDAN3:27;
              i1+1<=i2 by A10,NAT_1:13;
              then 1+i1-i1<=i2-i1 by XREAL_1:11;
              then 1<=i2-'i1 by BINARITH:57;
              then 1+1<=i2-'i1+1 by XREAL_1:8;
              then
A38:          2<=len mid(f,i1,i2) by A2,A7,A8,A10,JORDAN3:27;
A39:          g1.2=mid(f,i1,i2).2 by A1,A10,Th37
                .=f.(2+i1-'1) by A2,A7,A8,A10,A38,JORDAN3:27
                .=f.(1+1+i1-1) by BINARITH:55
                .=f.(i1+1);
              len f>4 by GOBOARD7:36;
              then len f-1>3+1-1 by XREAL_1:11;
              then i1+1<len f-'1 by A5,A32,XXREAL_0:2;
              then
A40:          f/.(i1+1)<>f/.(len f-'1) by A5,A6,A32,GOBOARD7 :39;
A41:          f.(len f-'1)=f/.(len f-'1) by A5,A6,A12,FINSEQ_4:24;
              1<i1+1 by A2,NAT_1:13;
              hence thesis by A2,A37,A39,A40,A41,FINSEQ_4:24;
            end;
          end;
          hence thesis;
        end;
      end;
      hence thesis;
    end;
    case
A42:  i1>i2;
      then
A43:  g1=mid(f,i1,len f-'1)^mid(f,1,i2) by A1,Th38;
      1<i1 by A2,A42,XXREAL_0:2;
      then
A44:  1+1<=i1 by NAT_1:13;
A45:  i1+1-1<=len f-1 by A2,XREAL_1:11;
      then 1<=len f-'1 by A2,A5,XXREAL_0:2;
      then
A46:  len mid(f,i1,len f-'1)=len f-'1-'i1+1 by A2,A5,A6,A8,A45, JORDAN3:27;
A47:  i1+1-1<=len f-1 by A2,XREAL_1:11;
A48:  now per cases by A45,REAL_1:def 5;
        case i1<len f-1;
          then i1+1<=len f-'1 by A5,NAT_1:13;
          then
A49:      1+(i1+1)<=1+(len f-'1) by XREAL_1:8;
          then
A50:      1+(i1+1)-i1<=1+(len f-'1)-i1 by XREAL_1:11;
          1+1+i1-i1<=1+(len f-'1)-i1 by A49,XREAL_1:11;
          then 1+1<=1+((len f-'1)-i1);
          then
A51:      2<=len mid(f,i1,len f-'1) by A5,A46,A47,BINARITH:50;
          thus g1.2=(mid(f,i1,len f-'1)^mid(f,1,i2)).2 by A1,A42,Th38
            .=mid(f,i1,len f-'1).2 by A51,FINSEQ_1:85
            .=f.(1+1+i1-1) by A2,A5,A6,A47,A50,JORDAN3:31
            .=f.(i1+1);
        end;
        case
A52:      i1=len f-1;
          then
A53:      len mid(f,i1,len f-'1)=len f-'1-'(len f-'1)+1 by A2,A5
          ,A6,JORDAN3:27
            .=0+1 by BINARITH:51
            .=1;
A54:      len g1=len f-'1+1+i2-'(len f-'1) by A1,A5,A42,A52,Th38
            .=len f-'1+(1+i2)-'(len f-'1)
            .=1+i2 by BINARITH:39;
A55:      1+1<=i2+1 by A2,XREAL_1:8;
A56:      len mid(f,i1,len f-'1)=len f-'1-'(len f-'1)+1
          by A2,A5,A6,A52,JORDAN3:27
            .=0+1 by BINARITH:51
            .=1;
          thus g1.2 =mid(f,1,i2).(2-len mid(f,i1,len f-'1))
          by A43,A53,A54,A55,JORDAN3:15
            .=f.1 by A2,A4,A7,A56,JORDAN3:27
            .=f.(i1+1) by A52,Th14,NAT_1:11;
        end;
      end;
      i2+1<=i1 by A42,NAT_1:13;
      then 1+i2-i2<=i1-i2 by XREAL_1:11;
      then 1<=i1-'i2 by BINARITH:57;
      then 1+1<=i1-'i2+1 by XREAL_1:8;
      then
A57:  2<=len mid(f,i1,i2) by A2,A7,A8,A42,JORDAN3:27;
A58:  g2.2=mid(f,i1,i2).2 by A1,A42,Th39
        .=f.(i1-'2+1) by A2,A7,A8,A42,A57,JORDAN3:27
        .=f.(i1-(1+1)+1) by A44,BINARITH:50
        .=f.(i1-1)
        .=f.(i1-'1) by A2,BINARITH:50;
      1<i1 by A2,A42,XXREAL_0:2;
      then 1+1<=i1 by NAT_1:13;
      then
A59:  1+1-1<=i1-1 by XREAL_1:11;
      then
A60:  1<=i1-'1 by BINARITH:57;
A61:  now
        assume
A62:    1=i1-'1 & i1+1=len f;
        then 1=i1-1 by BINARITH:57;
        hence contradiction by A62,GOBOARD7:36;
      end;
      now per cases by A61;
        case
A63:      1<>i1-'1;
          i1-'1<i1-'1+1 by NAT_1:13;
          then i1-'1<i1 by A2,BINARITH:53;
          then
A64:      1<i1-'1 & i1-'1<i1+1 & i1+1<=len f
          by A1,A60,A63,Def2,NAT_1:13,REAL_1:def 5;
          then
A65:      f/.(i1-'1)<>f/.(i1+1) by GOBOARD7:39;
          i1-'1<len f by A64,XXREAL_0:2;
          then
A66:      f.(i1-'1)=f/.(i1-'1) by A60,FINSEQ_4:24;
          1<i1+1 by A2,NAT_1:13;
          hence thesis by A2,A48,A58,A65,A66,FINSEQ_4:24;
        end;
        case
A67:      i1+1<>len f;
          i1-'1<i1-'1+1 by NAT_1:13;
          then i1-'1<i1 by A2,BINARITH:53;
          then
A68:      1<=i1-'1 & i1-'1<i1+1 & i1+1<len f
          by A2,A59,A67,BINARITH:57,NAT_1:13,REAL_1:def 5;
          then
A69:      f/.(i1-'1)<>f/.(i1+1) by GOBOARD7:38;
          i1-'1<len f by A68,XXREAL_0:2;
          then
A70:      f.(i1-'1)=f/.(i1-'1) by A68,FINSEQ_4:24;
          1<i1+1 by A2,NAT_1:13;
          hence thesis by A2,A48,A58,A69,A70,FINSEQ_4:24;
        end;
      end;
      hence thesis;
    end;
  end;
  hence thesis;
end;

theorem Th67:
  for f being non constant standard special_circular_sequence,
  g1,g2 st i1<>i2 & g1 is_a_part_of f,i1,i2 & g2 is_a_part_of f,i1,i2
  & g1.2=g2.2 holds g1=g2
proof
  let f be non constant standard special_circular_sequence, g1,g2;
  assume
A1: i1<>i2 & g1 is_a_part_of f,i1,i2 & g2 is_a_part_of f,i1,i2 & g1.2=g2.2;
  per cases by A1,Def4;
  suppose
A2: g1 is_a_part>_of f,i1,i2;
    now per cases by A1,Def4;
      case g2 is_a_part>_of f,i1,i2;
        hence g1=g2 by A2,Th64;
      end;
      case g2 is_a_part<_of f,i1,i2;
        hence contradiction by A1,A2,Th66;
      end;
    end;
    hence g1=g2;
  end;
  suppose
A3: g1 is_a_part<_of f,i1,i2;
    now per cases by A1,Def4;
      case g2 is_a_part>_of f,i1,i2;
        hence contradiction by A1,A3,Th66;
      end;
      case g2 is_a_part<_of f,i1,i2;
        hence g1=g2 by A3,Th65;
      end;
    end;
    hence g1=g2;
  end;
end;

definition
  let f be non constant standard special_circular_sequence,
  i1,i2 be Element of NAT;
  assume
A1: 1<=i1 & i1+1<=len f & 1<=i2 & i2+1<=len f & i1<>i2;
  func Lower (f,i1,i2) -> FinSequence of TOP-REAL 2 means
  it is_a_part_of f,i1,i2 &
  ((f/.(i1+1))`1<(f/.i1)`1 or (f/.(i1+1))`2<(f/.i1)`2 implies it.2=f.(i1+1))&
  ((f/.(i1+1))`1>=(f/.i1)`1 & (f/.(i1+1))`2>=(f/.i1)`2
  implies it.2=f.S_Drop(i1-'1,f));
  correctness
  proof
A2: i1<len f by A1,NAT_1:13;
    then
A3: 1<len f by A1,XXREAL_0:2;
    then 1+1<=len f by NAT_1:13;
    then
A4: 1+1-1<=len f-1 by XREAL_1:11;
    then
A5: 1<=len f-'1 by BINARITH:57;
A6: i2<len f by A1,NAT_1:13;
A7: i1-'1=i1-1 by A1,BINARITH:50;
A8: len f-'1=len f-1 by A1,A2,BINARITH:50,XXREAL_0:2;
A9: i2+1-1<=len f-1 by A1,XREAL_1:11;
A10: i1+1-1<=len f-1 by A1,XREAL_1:11;
    len f<len f+1 by NAT_1:13;
    then
A11: len f-1<len f+1-1 by XREAL_1:11;
    now per cases;
      case
A12:    i1<=i2;
        then
A13:    i1<i2 by A1,REAL_1:def 5;
        now per cases;
          case
A14:        (f/.(i1+1))`1<(f/.i1)`1 or (f/.(i1+1))`2<(f/.i1)`2;
            set g=mid(f,i1,i2);
A15:        g is_a_part>_of f,i1,i2 by A1,A6,A12,Th43;
A16:        len mid(f,i1,i2)=i2-'i1+1 by A1,A2,A6,A12,JORDAN3:27;
            i1+1<=i2 by A13,NAT_1:13;
            then (1+i1)+1<=i2+1 by XREAL_1:8;
            then 2+i1-i1<=i2+1-i1 by XREAL_1:11;
            then 2+i1-i1<=i2-i1+1;
            then 1<2 & 2<=len mid(f,i1,i2) by A12,A16,BINARITH:50;
            then g.2=f.(2+i1-'1) by A1,A2,A6,A12,JORDAN3:27
              .=f.(i1+1+1-1) by BINARITH:55
              .=f.(i1+1);
            hence g is_a_part_of f,i1,i2 &
            ((f/.(i1+1))`1<(f/.i1)`1 or (f/.(i1+1))`2<(f/.i1)`2
            implies g.2=f.(i1+1))&
            ((f/.(i1+1))`1>=(f/.i1)`1 & (f/.(i1+1))`2>=(f/.i1)`2
            implies g.2=f.S_Drop(i1-'1,f)) by A14,A15,Def4;
          end;
          case
A17:        (f/.(i1+1))`1>=(f/.i1)`1 & (f/.(i1+1))`2>=(f/.i1)`2;
            set g=mid(f,i1,1)^mid(f,len f-'1,i2);
A18:        g is_a_part<_of f,i1,i2 by A1,A6,A13,Th46;
A19:        len mid(f,i1,1)=i1-'1+1 by A1,A2,Th21;
            now per cases;
              case
A20:            1<i1;
                then
A21:            1+1<=i1 by NAT_1:13;
                then
A22:            f.(i1-'(1+1)+1)=f.(i1-(1+1)+1) by BINARITH :50
                  .=f.(i1-1)
                  .=f.(i1-'1) by A1,BINARITH:50;
                1+1<=i1-1+1 by A20,NAT_1:13;
                then
A23:            2<=len mid(f,i1,1) by A1,A19,BINARITH:50;
A24:            g.2 =mid(f,i1,1).2 by A7,A19,A21,FINSEQ_1:85
                  .=f.(i1-'(1+1)+1) by A2,A3,A20,A23,JORDAN3:27;
                1+1-1<=i1-1 by A21,XREAL_1:11;
                then 1<=i1-'1 & i1-'1<=len f-'1 by A2,A7,A8,XREAL_1:11;
                hence g is_a_part_of f,i1,i2 &
                ((f/.(i1+1))`1<(f/.i1)`1 or (f/.(i1+1))`2<(f/.i1)`2
                implies g.2=f.(i1+1))&
                ((f/.(i1+1))`1>=(f/.i1)`1 & (f/.(i1+1))`2>=(f/.i1)`2
                implies g.2=f.S_Drop(i1-'1,f)) by A17,A18,A22,A24,Def4,Th34;
              end;
              case
A25:            1>=i1;
                then i1=1 by A1,XXREAL_0:1;
                then
A26:            i1-'1=0 by BINARITH:51;
A27:            len mid(f,i1,1)=len mid(f,1,1) by A1,A25,XXREAL_0:1
                  .=1 by A3,Th27;
A28:            len mid(f,len f-'1,i2)=len f-'1-'i2+1 by A1,A8,A9,A11,Th21
                  .=len f-1-i2+1 by A8,A9,BINARITH:50
                  .=len f-i2;
                len f-i2>=i2+1-i2 by A1,XREAL_1:11;
                then
A29:            1+1<=len mid(f,i1,1)+len mid(f,len f-'1,i2 )
                by A27,A28,XREAL_1:8;
A30:            1<=len f-'1-'i2+1 by NAT_1:11;
A31:            g

.2 =mid(f,len f-'1,i2).(2-len mid(f,i1,1)) by A27,A29,JORDAN3:15
                  .=mid(f,len f-'1,i2).(2-(i1-'1+1)) by A1,A2,Th21
                  .=mid(f,len f-'1,i2).(1+1-(1-'1+1)) by A1,A25,XXREAL_0:1
                  .=mid(f,len f-'1,i2).(1+1-(0+1)) by BINARITH:51
                  .=f.(len f-'1-'1+1) by A1,A8,A9,A11,A30,Th24
                  .=f.(len f-'1) by A5,BINARITH:53;
                S_Drop(i1-'1,f)=S_Drop(i1-'1+(len f-'1),f) by Th35
                  .=len f-'1 by A5,A26,Th34;
                hence g is_a_part_of f,i1,i2 &
                ((f/.(i1+1))`1<(f/.i1)`1 or (f/.(i1+1))`2<(f/.i1)`2
                implies g.2=f.(i1+1))&
                ((f/.(i1+1))`1>=(f/.i1)`1 & (f/.(i1+1))`2>=(f/.i1)`2
                implies g.2=f.S_Drop(i1-'1,f)) by A17,A18,A31,Def4;
              end;
            end;
            hence g is_a_part_of f,i1,i2 &
            ((f/.(i1+1))`1<(f/.i1)`1 or (f/.(i1+1))`2<(f/.i1)`2
            implies g.2=f.(i1+1))&
            ((f/.(i1+1))`1>=(f/.i1)`1 & (f/.(i1+1))`2>=(f/.i1)`2
            implies g.2=f.S_Drop(i1-'1,f));
          end;
        end;
        hence ex g st g is_a_part_of f,i1,i2 &
        ((f/.(i1+1))`1<(f/.i1)`1 or (f/.(i1+1))`2<(f/.i1)`2
        implies g.2=f.(i1+1))&
        ((f/.(i1+1))`1>=(f/.i1)`1 & (f/.(i1+1))`2>=(f/.i1)`2
        implies g.2=f.S_Drop(i1-'1,f));
      end;
      case
A32:    i1>i2;
        then i1>1 by A1,XXREAL_0:2;
        then
A33:    1+1<=i1 by NAT_1:13;
        then
A34:    1+1-1<=i1-1 by XREAL_1:11;
        now per cases;
          case
A35:        (f/.(i1+1))`1>=(f/.i1)`1 & (f/.(i1+1))`2>=(f/.i1)`2;
            set g=mid(f,i1,i2);
A36:        g is_a_part<_of f,i1,i2 by A1,A2,A32,Th44;
A37:        len mid(f,i1,i2)=i1-'i2+1 by A1,A2,A6,A32,JORDAN3:27;
            i2+1<=i1 by A32,NAT_1:13;
            then (1+i2)+1<=i1+1 by XREAL_1:8;
            then 2+i2-i2<=i1+1-i2 by XREAL_1:11;
            then 2+i2-i2<=i1-i2+1;
            then 1<2 & 2<=len mid(f,i1,i2) by A32,A37,BINARITH:50;
            then
A38:        g.2=f.(i1-'2+1) by A1,A2,A6,A32,JORDAN3:27
              .=f.(i1-(1+1)+1) by A33,BINARITH:50
              .=f.(i1-1)
              .=f.(i1-'1) by A1,BINARITH:50;
            i1-1<len f-1 by A2,XREAL_1:11;
            hence g is_a_part_of f,i1,i2 &
            ((f/.(i1+1))`1<(f/.i1)`1 or (f/.(i1+1))`2<(f/.i1)`2
            implies g.2=f.(i1+1))&
            ((f/.(i1+1))`1>=(f/.i1)`1 & (f/.(i1+1))`2>=(f/.i1)`2
            implies g.2=f.S_Drop(i1-'1,f)) by A7,A8,A34,A35,A36,A38,Def4,Th34;
          end;
          case
A39:        (f/.(i1+1))`1<(f/.i1)`1 or (f/.(i1+1))`2<(f/.i1)`2;
            set g=mid(f,i1,len f-'1)^mid(f,1,i2);
A40:        g is_a_part>_of f,i1,i2 by A1,A2,A32,Th45;
A41:        len mid(f,i1,len f-'1)=len f-'1-'i1+1
            by A1,A2,A4,A8,A10,A11,JORDAN3:27
              .=len f-1-i1+1 by A8,A10,BINARITH:50
              .=len f-i1;
            now per cases;
              case i1+1<len f;
                then i1+1+1<=len f by NAT_1:13;
                then
A42:            i1+2-i1<=len f-i1 by XREAL_1:11;
                then g.2 =mid(f,i1,len f-'1).2 by A41,FINSEQ_1:85
                  .=f.(2+i1-'1) by A1,A2,A4,A8,A10,A11,A41,A42,JORDAN3:27
                  .=f.(1+1+i1-1) by BINARITH:55
                  .=f.(i1+1);
                hence g is_a_part_of f,i1,i2 &
                ((f/.(i1+1))`1<(f/.i1)`1 or (f/.(i1+1))`2<(f/.i1)`2
                implies g.2=f.(i1+1))&
                ((f/.(i1+1))`1>=(f/.i1)`1 & (f/.(i1+1))`2>=(f/.i1)`2
                implies g.2=f.S_Drop(i1-'1,f)) by A39,A40,Def4;
              end;
              case
A43:            i1+1>=len f;
                then i1+1=len f by A1,XXREAL_0:1;
                then
A44:            len mid(f,i1,len f-'1)=1 by A4,A8,A11,Th27;
                len mid(f,1,i2)=i2-'1+1 by A1,A3,A6,JORDAN3:27
                  .=i2-1+1 by A1,BINARITH:50
                  .=i2;
                then 1+1<=len mid(f,i1,len f-'1)+len mid(f,1,i2)
                by A1,A44,XREAL_1:8;
                then g.2 =mid(f,1,i2).(2-(i1+1-i1)) by A44,JORDAN3:15
                  .=f.1 by A1,A3,A6,JORDAN3:27
                  .=f/.1 by A3,FINSEQ_4:24
                  .=f/.len f by FINSEQ_6:def 1
                  .=f.len f by A3,FINSEQ_4:24;
                hence g is_a_part_of f,i1,i2 &
                ((f/.(i1+1))`1<(f/.i1)`1 or (f/.(i1+1))`2<(f/.i1)`2
                implies g.2=f.(i1+1))&
                ((f/.(i1+1))`1>=(f/.i1)`1 & (f/.(i1+1))`2>=(f/.i1)`2
                implies g.2=f.S_Drop(i1-'1,f))
                by A1,A39,A40,A43,Def4,XXREAL_0:1;
              end;
            end;
            hence g is_a_part_of f,i1,i2 &
            ((f/.(i1+1))`1<(f/.i1)`1 or (f/.(i1+1))`2<(f/.i1)`2
            implies g.2=f.(i1+1))&
            ((f/.(i1+1))`1>=(f/.i1)`1 & (f/.(i1+1))`2>=(f/.i1)`2
            implies g.2=f.S_Drop(i1-'1,f));
          end;
        end;
        hence ex g st g is_a_part_of f,i1,i2 &
        ((f/.(i1+1))`1<(f/.i1)`1 or (f/.(i1+1))`2<(f/.i1)`2
        implies g.2=f.(i1+1))&
        ((f/.(i1+1))`1>=(f/.i1)`1 & (f/.(i1+1))`2>=(f/.i1)`2
        implies g.2=f.S_Drop(i1-'1,f));
      end;
    end;
    hence ex g st g is_a_part_of f,i1,i2 &
    ((f/.(i1+1))`1<(f/.i1)`1 or (f/.(i1+1))`2<(f/.i1)`2 implies g.2=f.(i1+1))&
    ((f/.(i1+1))`1>=(f/.i1)`1 & (f/.(i1+1))`2>=(f/.i1)`2
    implies g.2=f.S_Drop(i1-'1,f));
    thus thesis by A1,Th67;
  end;
  func Upper (f,i1,i2) -> FinSequence of TOP-REAL 2 means
  it is_a_part_of f,i1,i2 &
  ((f/.(i1+1))`1>(f/.i1)`1 or (f/.(i1+1))`2>(f/.i1)`2 implies it.2=f.(i1+1))&
  ((f/.(i1+1))`1<=(f/.i1)`1 & (f/.(i1+1))`2<=(f/.i1)`2
  implies it.2=f.S_Drop(i1-'1,f));
  correctness
  proof
A45: i1<len f by A1,NAT_1:13;
    then
A46: 1<len f by A1,XXREAL_0:2;
    then 1+1<=len f by NAT_1:13;
    then
A47: 1+1-1<=len f-1 by XREAL_1:11;
    then
A48: 1<=len f-'1 by BINARITH:57;
A49: i2<len f by A1,NAT_1:13;
A50: i1-'1=i1-1 by A1,BINARITH:50;
A51: len f-'1=len f-1 by A1,A45,BINARITH:50,XXREAL_0:2;
A52: i2+1-1<=len f-1 by A1,XREAL_1:11;
A53: i1+1-1<=len f-1 by A1,XREAL_1:11;
    len f<len f+1 by NAT_1:13;
    then
A54: len f-1<len f+1-1 by XREAL_1:11;
    now per cases;
      case
A55:    i1<=i2;
        then
A56:    i1<i2 by A1,REAL_1:def 5;
        now per cases;
          case
A57:        (f/.(i1+1))`1>(f/.i1)`1 or (f/.(i1+1))`2>(f/.i1)`2;
            set g=mid(f,i1,i2);
A58:        g is_a_part>_of f,i1,i2 by A1,A49,A55,Th43;
A59:        len mid(f,i1,i2)=i2-'i1+1 by A1,A45,A49,A55,JORDAN3:27;
            i1+1<=i2 by A56,NAT_1:13;
            then (1+i1)+1<=i2+1 by XREAL_1:8;
            then 2+i1-i1<=i2+1-i1 by XREAL_1:11;
            then 2+i1-i1<=i2-i1+1;
            then 1<2 & 2<=len mid(f,i1,i2) by A55,A59,BINARITH:50;
            then g.2=f.(2+i1-'1) by A1,A45,A49,A55,JORDAN3:27
              .=f.(i1+1+1-1) by BINARITH:55
              .=f.(i1+1);
            hence g is_a_part_of f,i1,i2 &
            ((f/.(i1+1))`1>(f/.i1)`1 or (f/.(i1+1))`2>(f/.i1)`2
            implies g.2=f.(i1+1))&
            ((f/.(i1+1))`1<=(f/.i1)`1 & (f/.(i1+1))`2<=(f/.i1)`2
            implies g.2=f.S_Drop(i1-'1,f)) by A57,A58,Def4;
          end;
          case
A60:        (f/.(i1+1))`1<=(f/.i1)`1 & (f/.(i1+1))`2<=(f/.i1)`2;
            set g=mid(f,i1,1)^mid(f,len f-'1,i2);
A61:        g is_a_part<_of f,i1,i2 by A1,A49,A56,Th46;
A62:        len mid(f,i1,1)=i1-'1+1 by A1,A45,Th21;
            now per cases;
              case
A63:            1<i1;
                then
A64:            1+1<=i1 by NAT_1:13;
                then
A65:            f.(i1-'(1+1)+1)=f.(i1-(1+1)+1) by BINARITH :50
                  .=f.(i1-1)
                  .=f.(i1-'1) by A1,BINARITH:50;
                1+1<=i1-1+1 by A63,NAT_1:13;
                then
A66:            2<=len mid(f,i1,1) by A1,A62,BINARITH:50;
A67:            g.2 =mid(f,i1,1).2 by A50,A62,A64,FINSEQ_1:85
                  .=f.(i1-'(1+1)+1) by A45,A46,A63,A66,JORDAN3:27;
                1+1-1<=i1-1 by A64,XREAL_1:11;
                then 1<=i1-'1 & i1-'1<=len f-'1 by A45,A50,A51,XREAL_1:11;
                hence g is_a_part_of f,i1,i2 &
                ((f/.(i1+1))`1>(f/.i1)`1 or (f/.(i1+1))`2>(f/.i1)`2
                implies g.2=f.(i1+1))&
                ((f/.(i1+1))`1<=(f/.i1)`1 & (f/.(i1+1))`2<=(f/.i1)`2
                implies g.2=f.S_Drop(i1-'1,f)) by A60,A61,A65,A67,Def4,Th34;
              end;
              case
A68:            1>=i1;
                then i1=1 by A1,XXREAL_0:1;
                then
A69:            i1-'1=0 by BINARITH:51;
A70:            len mid(f,i1,1)=len mid(f,1,1) by A1,A68,XXREAL_0:1
                  .=1 by A46,Th27;
A71:            len mid(f,len f-'1,i2)=len f-'1-'i2+1 by A1,A51,A52,A54,Th21
                  .=len f-1-i2+1 by A51,A52,BINARITH:50
                  .=len f-i2;
                len f-i2>=i2+1-i2 by A1,XREAL_1:11;
                then
A72:            1+1<=len mid(f,i1,1)+len mid(f,len f-'1,i2 )
                by A70,A71,XREAL_1:8;
A73:            i2+1-1<=len f-1 by A1,XREAL_1:11;
A74:            1<=len f-'1-'i2+1 by NAT_1:11;
A75:            g

.2 =mid(f,len f-'1,i2).(2-len mid(f,i1,1)) by A70,A72,JORDAN3:15
                  .=mid(f,len f-'1,i2).(2-(i1-'1+1)) by A1,A45,Th21
                  .=mid(f,len f-'1,i2).(1+1-(1-'1+1)) by A1,A68,XXREAL_0:1
                  .=mid(f,len f-'1,i2).(1+1-(0+1)) by BINARITH:51
                  .=f.(len f-'1-'1+1) by A1,A51,A54,A73,A74,Th24
                  .=f.(len f-'1) by A48,BINARITH:53;
                S_Drop(i1-'1,f)=S_Drop(i1-'1+(len f-'1),f) by Th35
                  .=len f-'1 by A48,A69,Th34;
                hence g is_a_part_of f,i1,i2 &
                ((f/.(i1+1))`1>(f/.i1)`1 or (f/.(i1+1))`2>(f/.i1)`2
                implies g.2=f.(i1+1))&
                ((f/.(i1+1))`1<=(f/.i1)`1 & (f/.(i1+1))`2<=(f/.i1)`2
                implies g.2=f.S_Drop(i1-'1,f)) by A60,A61,A75,Def4;
              end;
            end;
            hence g is_a_part_of f,i1,i2 &
            ((f/.(i1+1))`1>(f/.i1)`1 or (f/.(i1+1))`2>(f/.i1)`2
            implies g.2=f.(i1+1))&
            ((f/.(i1+1))`1<=(f/.i1)`1 & (f/.(i1+1))`2<=(f/.i1)`2
            implies g.2=f.S_Drop(i1-'1,f));
          end;
        end;
        hence ex g st g is_a_part_of f,i1,i2 &
        ((f/.(i1+1))`1>(f/.i1)`1 or (f/.(i1+1))`2>(f/.i1)`2
        implies g.2=f.(i1+1))&
        ((f/.(i1+1))`1<=(f/.i1)`1 & (f/.(i1+1))`2<=(f/.i1)`2
        implies g.2=f.S_Drop(i1-'1,f));
      end;
      case
A76:    i1>i2;
        then i1>1 by A1,XXREAL_0:2;
        then
A77:    1+1<=i1 by NAT_1:13;
        then
A78:    1+1-1<=i1-1 by XREAL_1:11;
        now per cases;
          case
A79:        (f/.(i1+1))`1<=(f/.i1)`1 & (f/.(i1+1))`2<=(f/.i1)`2;
            set g=mid(f,i1,i2);
A80:        g is_a_part<_of f,i1,i2 by A1,A45,A76,Th44;
A81:        len mid(f,i1,i2)=i1-'i2+1 by A1,A45,A49,A76,JORDAN3:27;
            i2+1<=i1 by A76,NAT_1:13;
            then (1+i2)+1<=i1+1 by XREAL_1:8;
            then 2+i2-i2<=i1+1-i2 by XREAL_1:11;
            then 2+i2-i2<=i1-i2+1;
            then 2<=len mid(f,i1,i2) by A76,A81,BINARITH:50;
            then
A82:        g.2=f.(i1-'2+1) by A1,A45,A49,A76,JORDAN3:27
              .=f.(i1-(1+1)+1) by A77,BINARITH:50
              .=f.(i1-1)
              .=f.(i1-'1) by A1,BINARITH:50;
            1<=i1-'1 & i1-'1<=len f-'1 by A45,A50,A51,A78,XREAL_1:11;
            hence g is_a_part_of f,i1,i2 &
            ((f/.(i1+1))`1>(f/.i1)`1 or (f/.(i1+1))`2>(f/.i1)`2
            implies g.2=f.(i1+1))&
            ((f/.(i1+1))`1<=(f/.i1)`1 & (f/.(i1+1))`2<=(f/.i1)`2
            implies g.2=f.S_Drop(i1-'1,f)) by A79,A80,A82,Def4,Th34;
          end;
          case
A83:        (f/.(i1+1))`1>(f/.i1)`1 or (f/.(i1+1))`2>(f/.i1)`2;
            set g=mid(f,i1,len f-'1)^mid(f,1,i2);
A84:        g is_a_part>_of f,i1,i2 by A1,A45,A76,Th45;
A85:        len mid(f,i1,len f-'1)=len f-'1-'i1+1
            by A1,A45,A47,A51,A53,A54,JORDAN3:27
              .=len f-1-i1+1 by A51,A53,BINARITH:50
              .=len f-i1;
            now per cases;
              case i1+1<len f;
                then i1+1+1<=len f by NAT_1:13;
                then
A86:            i1+2-i1<=len f-i1 by XREAL_1:11;
                then g.2 =mid(f,i1,len f-'1).2 by A85,FINSEQ_1:85
                  .=f.(2+i1-'1) by A1,A45,A47,A51,A53,A54,A85,A86,JORDAN3:27
                  .=f.(1+1+i1-1) by BINARITH:55
                  .=f.(1+i1);
                hence g is_a_part_of f,i1,i2 &
                ((f/.(i1+1))`1>(f/.i1)`1 or (f/.(i1+1))`2>(f/.i1)`2
                implies g.2=f.(i1+1)) &
                ((f/.(i1+1))`1<=(f/.i1)`1 & (f/.(i1+1))`2<=(f/.i1)`2
                implies g.2=f.S_Drop(i1-'1,f)) by A83,A84,Def4;
              end;
              case
A87:            i1+1>=len f;
                then i1+1=len f by A1,XXREAL_0:1;
                then
A88:            len mid(f,i1,len f-'1)=1 by A47,A51,A54, Th27;
                len mid(f,1,i2)=i2-'1+1 by A1,A46,A49,JORDAN3:27
                  .=i2-1+1 by A1,BINARITH:50
                  .=i2;
                then 1+1<=len mid(f,i1,len f-'1)+len mid(f,1,i2)
                by A1,A88,XREAL_1:8;
                then g.2 =mid(f,1,i2).(2-(i1+1-i1)) by A88,JORDAN3:15
                  .=f.1 by A1,A46,A49,JORDAN3:27
                  .=f/.1 by A46,FINSEQ_4:24
                  .=f/.len f by FINSEQ_6:def 1
                  .=f.len f by A46,FINSEQ_4:24;
                hence g is_a_part_of f,i1,i2 &
                ((f/.(i1+1))`1>(f/.i1)`1 or (f/.(i1+1))`2>(f/.i1)`2
                implies g.2=f.(i1+1)) &
                ((f/.(i1+1))`1<=(f/.i1)`1 & (f/.(i1+1))`2<=(f/.i1)`2
                implies g.2=f.S_Drop(i1-'1,f))
                by A1,A83,A84,A87,Def4,XXREAL_0:1;
              end;
            end;
            hence g is_a_part_of f,i1,i2 &
            ((f/.(i1+1))`1>(f/.i1)`1 or (f/.(i1+1))`2>(f/.i1)`2
            implies g.2=f.(i1+1))&
            ((f/.(i1+1))`1<=(f/.i1)`1 & (f/.(i1+1))`2<=(f/.i1)`2
            implies g.2=f.S_Drop(i1-'1,f));
          end;
        end;
        hence ex g st g is_a_part_of f,i1,i2 &
        ((f/.(i1+1))`1>(f/.i1)`1 or (f/.(i1+1))`2>(f/.i1)`2
        implies g.2=f.(i1+1))&
        ((f/.(i1+1))`1<=(f/.i1)`1 & (f/.(i1+1))`2<=(f/.i1)`2
        implies g.2=f.S_Drop(i1-'1,f));
      end;
    end;
    hence thesis by A1,Th67;
  end;
end;

