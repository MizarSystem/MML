:: Strong arithmetic of real numbers
::  by Andrzej Trybulec
::
:: Received January 1, 1989
:: Copyright (c) 1990 Association of Mizar Users

environ

 vocabularies BOOLE, ARYTM, ARYTM_2, ARYTM_3, ORDINAL2, ARYTM_1, ORDINAL1,
      COMPLEX1, OPPCAT_1, RELAT_1, FUNCOP_1;
 notations TARSKI, XBOOLE_0, ZFMISC_1, SUBSET_1, ORDINAL1, ORDINAL2, FUNCT_4,
      ARYTM_2, ARYTM_1, NUMBERS, ARYTM_0, XCMPLX_0, XREAL_0;
 constructors ARYTM_1, ARYTM_0, XREAL_0, XCMPLX_0, FUNCT_4, XBOOLE_0;
 registrations XREAL_0, ARYTM_2, ARYTM_3, ORDINAL2, NUMBERS, XCMPLX_0,
      ZFMISC_1, XBOOLE_0;
 requirements SUBSET, BOOLE, NUMERALS, ARITHM;
 definitions TARSKI, XBOOLE_0;
 theorems XBOOLE_0, ARYTM_0, ZFMISC_1, TARSKI, ARYTM_1, ARYTM_2, SUBSET_1,
      ORDINAL2, ORDINAL1, XBOOLE_1, XREAL_0, XCMPLX_0, NUMBERS, XREAL_1;

begin

reserve x,y,z for real number,
        k for natural number,
        i for Element of NAT;

canceled 18;

theorem
    ex y st x + y = 0
proof
 take y = -x;
 thus x + y = 0;
end;

theorem
    x <> 0 implies ex y st x * y = 1
proof
 assume
A1: x <> 0;
 take y = x";
 thus x * y = 1 by A1,XCMPLX_0:def 7;
end;

theorem Th21:
 x <= y & y <= x implies x = y by XREAL_1:1;

theorem
    x <= y & y <= z implies x <= z by XREAL_1:2;

Lm1: for x being real number, x1,x2 being Element of REAL st x = [*x1,x2*]
       holds x2 = 0 & x = x1
 proof let x be real number, x1,x2 being Element of REAL;
  assume
A1:  x = [*x1,x2*];
A2: x in REAL by XREAL_0:def 1;
  hereby assume x2 <> 0;
    then x = (0,one) --> (x1,x2) by A1,ARYTM_0:def 7;
   hence contradiction by A2,ARYTM_0:10;
  end;
  hence x = x1 by A1,ARYTM_0:def 7;
 end;

Lm2:
 for x',y' being Element of REAL, x,y st x' = x & y' = y
  holds +(x',y') = x + y
proof let x',y' be Element of REAL, x,y such that
A1: x' = x & y' = y;
  consider x1,x2,y1,y2 being Element of REAL such that
A2: x = [* x1,x2 *] and
A3: y = [*y1,y2*] and
A4: x+y = [*+(x1,y1),+(x2,y2)*] by XCMPLX_0:def 4;
A5: x = x1 & y = y1 by A2,A3,Lm1;
     x2 = 0 & y2 = 0 by A2,A3,Lm1;
  then +(x2,y2) = 0 by ARYTM_0:13;
 hence +(x',y') = x + y by A1,A4,A5,ARYTM_0:def 7;
end;

Lm3: {} in {{}} by TARSKI:def 1;

canceled;

theorem
    x <= y implies x + z <= y + z by XREAL_1:8;

 reconsider o = 0 as Element of REAL+ by ARYTM_2:21;

theorem
    x <= y & 0 <= z implies x * z <= y * z by XREAL_1:66;

reserve r,r1,r2 for Element of REAL+;

theorem
    for X,Y being Subset of REAL st for x,y st x in X & y in Y holds x <= y
  ex z st for x,y st x in X & y in Y holds x <= z & z <= y
proof let X,Y be Subset of REAL;
 assume
A1: for x,y st x in X & y in Y holds x <= y;
 per cases;
 suppose
A2: X = 0 or Y = 0;
  take 1;
 thus thesis by A2;
 end;
 suppose that
A3: X <> 0 and
A4: Y <> 0;
 consider x1 being Element of REAL such that
A5: x1 in X by A3,SUBSET_1:10;
 consider x2 being Element of REAL such that
A6: x2 in Y by A4,SUBSET_1:10;
A7:  REAL c= REAL+ \/ [:{0},REAL+:] by NUMBERS:def 1,XBOOLE_1:36;
then A8: X c= REAL+ \/ [:{0},REAL+:] by XBOOLE_1:1;
A9: Y c= REAL+ \/ [:{0},REAL+:] by A7,XBOOLE_1:1;
 thus thesis
 proof
 per cases;
 suppose that
A10: X misses REAL+ and
A11: Y misses [:{0},REAL+:];
A12: Y c= REAL+ by A9,A11,XBOOLE_1:73;
 take z = 0;
 let x,y such that
A13: x in X and
A14: y in Y;
      not z in [:{0},REAL+:] & not x in REAL+
     by A10,A13,ARYTM_0:5,ARYTM_2:21,XBOOLE_0:3;
  hence x <= z by XREAL_0:def 2;
   reconsider y' = y as Element of REAL+ by A12,A14;
      o <=' y' by ARYTM_1:6;
  hence z <= y by XREAL_0:def 2;
 end;
 suppose
       Y meets [:{0},REAL+:];
  then consider e being set such that
A15: e in Y and
A16: e in [:{0},REAL+:] by XBOOLE_0:3;
  consider u,y1 being set such that
A17: u in {0} and
A18: y1 in REAL+ and
A19: e = [u,y1] by A16,ZFMISC_1:103;
  reconsider y1 as Element of REAL+ by A18;
     e in REAL by A15;
  then A20:   [0,y1] in REAL by A17,A19,TARSKI:def 1;
  then reconsider y0 = [0,y1] as real number by XREAL_0:def 1;
     {r: [0,r] in Y} c= REAL+
   proof let u be set;
    assume u in {r: [0,r] in Y};
     then ex r st u = r & [0,r] in Y;
    hence thesis;
   end;
  then reconsider Y' = {r : [0,r] in Y} as Subset of REAL+;
A21: y0 in [:{0},REAL+:] by Lm3,ZFMISC_1:106;
A22: y0 in Y by A15,A17,A19,TARSKI:def 1;
then A23: y1 in Y';
A24: X c= [:{0},REAL+:]
   proof let u be set;
    assume
A25:  u in X;
     then reconsider x = u as real number by XREAL_0:def 1;
        now assume
A26:     x in REAL+;
A27:     x <= y0 by A1,A22,A25;
          not y0 in REAL+ & not x in
 [:{0},REAL+:] by A21,A26,ARYTM_0:5,XBOOLE_0:3;
      hence contradiction by A27,XREAL_0:def 2;
     end;
    hence u in [:{0},REAL+:] by A8,A25,XBOOLE_0:def 2;
   end;
  then consider e,x3 being set such that
A28: e in {0} and
A29: x3 in REAL+ and
A30: x1 = [e,x3] by A5,ZFMISC_1:103;
   reconsider x3 as Element of REAL+ by A29;
A31: x1 = [0,x3] by A28,A30,TARSKI:def 1;
     {r: [0,r] in X} c= REAL+
   proof let u be set;
    assume u in {r: [0,r] in X};
     then ex r st u = r & [0,r] in X;
    hence thesis;
   end;
  then reconsider X' = {r: [0,r] in X} as Subset of REAL+;
A32: x3 in X' by A5,A31;
    for y',x' being Element of REAL+ st y' in Y' & x' in X' holds y' <=' x'
  proof let y',x' be Element of REAL+;
   assume y' in Y';
    then consider r1 such that
A33:  y' = r1 and
A34: [0,r1] in Y;
   assume x' in X';
    then consider r2 such that
A35:  x' = r2 and
A36: [0,r2] in X;
    reconsider x = [0,x'], y = [0,y'] as real number
                by A33,A34,A35,A36,XREAL_0:def 1;
A37: x in [:{0},REAL+:] & y in [:{0},REAL+:] by Lm3,ZFMISC_1:106;
       x <= y by A1,A33,A34,A35,A36;
    then consider x'',y'' being Element of REAL+ such that
A38:  x = [0,x''] and
A39:  y = [0,y''] and
A40:  y'' <=' x'' by A37,XREAL_0:def 2;
       x' = x'' & y' = y'' by A38,A39,ZFMISC_1:33;
   hence y' <=' x' by A40;
  end;
 then consider z' being Element of REAL+ such that
A41: for y',x' being Element of REAL+ st y' in Y' & x' in X'
     holds y' <=' z' & z' <=' x' by A23,A32,ARYTM_2:9;
A42: y1 <> 0 by A20,ARYTM_0:3;
     y1 <=' z' by A23,A32,A41;
  then z' <> 0 by A42,ARYTM_1:5;
  then [0,z'] in REAL by ARYTM_0:2;
  then reconsider z = [0,z'] as real number by XREAL_0:def 1;
 take z;
A43: z in [:{0},REAL+:] by Lm3,ZFMISC_1:106;
 let x,y such that
A44: x in X and
A45: y in Y;
  consider e,x' being set such that
A46: e in {0} and
A47: x' in REAL+ and
A48: x = [e,x'] by A24,A44,ZFMISC_1:103;
  reconsider x' as Element of REAL+ by A47;
A49: x = [0,x'] by A46,A48,TARSKI:def 1;
then A50: x' in X' by A44;
    now
  per cases by A9,A45,XBOOLE_0:def 2;
  suppose
A51: y in REAL+;
     y1 <=' z' & z' <=' x' by A23,A41,A50;
 hence x <= z by A24,A43,A44,A49,XREAL_0:def 2;
     not z in REAL+ & not y in [:{0},REAL+:] by A43,A51,ARYTM_0:5,XBOOLE_0:3;
 hence z <= y by XREAL_0:def 2;
  end;
  suppose
A52: y in [:{0},REAL+:];
  then consider e,y' being set such that
A53: e in {0} and
A54: y' in REAL+ and
A55: y = [e,y'] by ZFMISC_1:103;
  reconsider y' as Element of REAL+ by A54;
A56: y = [0,y'] by A53,A55,TARSKI:def 1;
   then y' in Y' by A45;
  then y' <=' z' & z' <=' x' by A41,A50;
 hence x <= z & z <= y by A24,A43,A44,A49,A52,A56,XREAL_0:def 2;
 end;
 end;
 hence thesis;
 end;
 suppose
       X meets REAL+;
  then consider x1 being set such that
A57: x1 in X and
A58: x1 in REAL+ by XBOOLE_0:3;
  reconsider x1 as Element of REAL+ by A58;
     x1 in REAL+;
  then reconsider x0 = x1 as real number by ARYTM_0:1,XREAL_0:def 1;
  reconsider X' = X /\ REAL+ as Subset of REAL+ by XBOOLE_1:17;
A59: x0 in X' by A57,XBOOLE_0:def 3;
A60: Y c= REAL+
   proof let u be set;
    assume
A61:  u in Y;
     then reconsider y = u as real number by XREAL_0:def 1;
        now assume
A62:     y in [:{0},REAL+:];
A63:     x0 <= y by A1,A57,A61;
          not y in REAL+ & not x0 in [:{0},REAL+:] by A62,ARYTM_0:5,XBOOLE_0:3;
      hence contradiction by A63,XREAL_0:def 2;
     end;
    hence u in REAL+ by A9,A61,XBOOLE_0:def 2;
   end;
  then reconsider Y' = Y as Subset of REAL+;
    for x',y' being Element of REAL+ st x' in X' & y' in Y' holds x' <=' y'
  proof let x',y' be Element of REAL+;
   assume
A64: x' in X' & y' in Y';
       x' in REAL+ & y' in REAL+;
    then reconsider x = x', y = y' as real number by ARYTM_0:1,XREAL_0:def 1;
       X' c= X by XBOOLE_1:17;
    then x <= y by A1,A64;
    then ex x',y' being Element of REAL+ st x = x' & y = y' & x' <=' y'
                                 by XREAL_0:def 2;
   hence x' <=' y';
  end;
 then consider z' being Element of REAL+ such that
A65: for x',y' being Element of REAL+ st x' in X' & y' in Y'
     holds x' <=' z' & z' <=' y' by A6,A59,ARYTM_2:9;
      z' in REAL+;
  then reconsider z = z' as real number by ARYTM_0:1,XREAL_0:def 1;
 take z;
 let x,y such that
A66: x in X and
A67: y in Y;
  reconsider y' = y as Element of REAL+ by A60,A67;
    now
  per cases by A8,A66,XBOOLE_0:def 2;
  suppose
      x in REAL+;
  then reconsider x' = x as Element of REAL+;
     x' in X' & y' in Y' by A66,A67,XBOOLE_0:def 3;
  then x' <=' z' & z' <=' y' by A65;
 hence x <= z & z <= y by XREAL_0:def 2;
  end;
  suppose
    x in [:{0},REAL+:];
  then not x in REAL+ & not z in [:{0},REAL+:] by ARYTM_0:5,XBOOLE_0:3;
 hence x <= z by XREAL_0:def 2;
     x1 <=' z' & z' <=' y' by A59,A65,A67;
 hence z <= y by XREAL_0:def 2;
 end;
 end;
 hence thesis;
 end;
 end;
end;
end;

canceled;

theorem
    x in NAT & y in NAT implies x + y in NAT
proof
 reconsider x1 = x, y1 = y as Element of REAL by XREAL_0:def 1;
A1: +(x1,y1) = x + y by Lm2;
 assume
A2: x in NAT & y in NAT;
  then ex x',y' being Element of REAL+ st
     x1 = x' & y1 = y' & +(x1,y1) = x' + y' by ARYTM_0:def 2,ARYTM_2:2;
 hence x + y in NAT by A1,A2,ARYTM_2:17;
end;

Lm5:  one = succ 0 by ORDINAL2:def 4 .= 1;

theorem
    for A being Subset of REAL
   st 0 in A & for x st x in A holds x + 1 in A
 holds NAT c= A
proof
 let A be Subset of REAL such that
A1: 0 in A and
A2: for x st x in A holds x + 1 in A;
  reconsider B = A /\ REAL+ as Subset of REAL+ by XBOOLE_1:17;
A3: 0 in B by A1,ARYTM_2:21,XBOOLE_0:def 3;
A4: B c= A by XBOOLE_1:17;
     for x',y' being Element of REAL+ st x' in B & y' = 1 holds x' + y' in B
   proof let x',y' be Element of REAL+ such that
A5: x' in B and
A6: y' = 1;
        x' in REAL+;
     then reconsider x = x' as Element of REAL by ARYTM_0:1;
     reconsider xx = x as real number by XREAL_0:def 1;
     consider x'',y'' being Element of REAL+ such that
A7:   x = x'' and
A8:   1 = y'' and
A9:   +(x,1) = x'' + y'' by Lm5,ARYTM_0:def 2,ARYTM_2:21;
        xx+1 in A by A2,A4,A5;
     then +(x,1) in A by Lm2;
    hence x' + y' in B by A6,A7,A8,A9,XBOOLE_0:def 3;
   end;
  then NAT c= B by A3,Lm5,ARYTM_2:18;
 hence NAT c= A by A4,XBOOLE_1:1;
end;

theorem
    k = { i: i < k }
proof
 thus k c= { i: i < k }
  proof let e be set;
   reconsider k' = k as Element of NAT by ORDINAL2:def 21;
A1:  k' c= NAT by ORDINAL1:def 2;
   assume
A2:   e in k;
    then reconsider j = e as Element of NAT by A1;
       k' in NAT;
    then reconsider x' = k' as Element of REAL+ by ARYTM_2:2;
       e in NAT by A1,A2;
    then reconsider y' = e as Element of REAL+ by ARYTM_2:2;
       y' in x' by A2;
then A3:  y' in NAT & y' <> x' & y' <=' x' by ARYTM_2:19;
    then j <= k by XREAL_0:def 2;
    then j < k by A3,Th21;
   hence e in { i: i < k };
  end;
 let e be set;
 assume e in { i: i < k };
  then consider i be Element of NAT such that
A4: e = i and
A5: not k <= i;
A6: k in NAT & i in NAT by ORDINAL2:def 21;
  then reconsider x' = e, y' = k as Element of REAL+ by A4,ARYTM_2:2;
   not y' <=' x' by A4,A5,XREAL_0:def 2;
 hence e in k by A4,A5,A6,ARYTM_2:19;
end;
