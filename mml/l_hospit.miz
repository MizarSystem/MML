:: The de l'Hospital Theorem
::  by Ma{\l}gorzata Korolkiewicz
::
:: Received February 20, 1992
:: Copyright (c) 1992 Association of Mizar Users

environ

 vocabularies PARTFUN1, SEQ_1, FCONT_1, RELAT_1, LIMFUNC3, SEQ_2, ORDINAL2,
      BOOLE, FUNCT_1, LIMFUNC2, LIMFUNC1, RCOMP_1, ARYTM_1, FDIFF_1, ARYTM_3,
      SEQM_3, ARYTM, FUNCOP_1;
 notations TARSKI, XBOOLE_0, SUBSET_1, ORDINAL1, NUMBERS, XCMPLX_0, XREAL_0,
      REAL_1, NAT_1, FUNCOP_1, VALUED_1, SEQ_1, SEQ_2, SEQM_3, RELSET_1,
      PARTFUN1, RFUNCT_1, RCOMP_1, RFUNCT_2, FCONT_1, FDIFF_1, LIMFUNC1,
      LIMFUNC2, LIMFUNC3, XXREAL_0;
 constructors PARTFUN1, FUNCOP_1, REAL_1, NAT_1, SEQ_2, SEQM_3, PROB_1,
      RCOMP_1, RFUNCT_1, RFUNCT_2, FCONT_1, LIMFUNC1, FDIFF_1, LIMFUNC2,
      LIMFUNC3, VALUED_1, SEQ_1;
 registrations ORDINAL1, RELSET_1, NUMBERS, XREAL_0, MEMBERED, SEQM_3, RCOMP_1,
      VALUED_0, VALUED_1, FUNCT_2;
 requirements NUMERALS, SUBSET, BOOLE, ARITHM;
 definitions TARSKI, VALUED_1, PROB_1, LIMFUNC1;
 theorems TARSKI, REAL_1, NAT_1, RFUNCT_1, RCOMP_1, FCONT_1, FDIFF_1, REAL_2,
      ROLLE, SEQ_2, SEQ_4, LIMFUNC2, LIMFUNC1, RFUNCT_2, SEQM_3, LIMFUNC3,
      ZFMISC_1, FUNCT_1, SEQ_1, XREAL_0, XBOOLE_0, XBOOLE_1, XCMPLX_0,
      XCMPLX_1, FUNCOP_1, XREAL_1, XXREAL_0, VALUED_1;
 schemes RCOMP_1;

begin

 reserve f,g for PartFunc of REAL,REAL,
         r,r1,r2,g1,g2,g3,g4,g5,g6,x,x0,t,c for Real,
         a,b,s for Real_Sequence,
         n,k for Element of NAT;

theorem
    f is_continuous_in x0 &
(for r1,r2 st r1<x0 & x0<r2
  ex g1,g2 st r1<g1 & g1<x0 & g1 in dom f &
  g2<r2 & x0<g2 & g2 in dom f) implies
f is_convergent_in x0
 proof
  assume A1: f is_continuous_in x0 &
   for r1,r2 st r1<x0 & x0<r2 ex g1,g2 st r1<g1 &
   g1<x0 & g1 in dom f & g2<r2 &
   x0<g2 & g2 in dom f;
      now
   let s such that A2: s is convergent & lim s=x0 & rng s c= dom f \ {x0};
         dom f \ {x0} c= dom f by XBOOLE_1:36;
     then rng s c= dom f by A2,XBOOLE_1:1;
     hence f*s is convergent & lim (f*s) = f.x0 by A1,A2,FCONT_1:def 1;
  end;
  hence thesis by A1,LIMFUNC3:def 1;
 end;

theorem Th2:
f is_right_convergent_in x0 & lim_right(f,x0) = t iff
(for r st x0<r ex t st t<r & x0<t & t in dom f) &
for a st a is convergent & lim a = x0 &
rng a c= dom f /\ right_open_halfline(x0) holds
f*a is convergent & lim(f*a) = t
 proof
  thus f is_right_convergent_in x0 & lim_right(f,x0) = t implies
   (for r st x0<r ex t st t<r & x0<t & t in dom f) &
   for a st a is convergent & lim a = x0 &
   rng a c= dom f /\ right_open_halfline(x0) holds
   f*a is convergent & lim(f*a) = t by LIMFUNC2:def 4,def 8;
  thus (for r st x0<r ex t st t<r & x0<t & t in dom f) &
   (for a st a is convergent & lim a = x0 &
   rng a c= dom f /\ right_open_halfline(x0) holds
   f*a is convergent & lim(f*a) = t) implies
   f is_right_convergent_in x0 & lim_right(f,x0) = t
   proof
    assume A1: (for r st x0<r ex t st t<r & x0<t & t in dom f) &
     for a st a is convergent & lim a = x0 &
      rng a c= dom f /\ right_open_halfline(x0) holds
      f*a is convergent & lim(f*a) = t;
    hence f is_right_convergent_in x0 by LIMFUNC2:def 4;
    hence thesis by A1,LIMFUNC2:def 8;
   end;
 end;

theorem Th3:
f is_left_convergent_in x0 & lim_left(f,x0) = t iff
(for r st r<x0 ex t st r<t & t<x0 & t in dom f) &
for a st a is convergent & lim a = x0 &
rng a c= dom f /\ left_open_halfline(x0) holds
f*a is convergent & lim(f*a) = t
 proof
  thus f is_left_convergent_in x0 & lim_left(f,x0) = t implies
   (for r st r<x0 ex t st r<t & t<x0 & t in dom f) &
   for a st a is convergent & lim a = x0 &
   rng a c= dom f /\ left_open_halfline(x0) holds
   f*a is convergent & lim(f*a) = t by LIMFUNC2:def 1,def 7;
  thus (for r st r<x0 ex t st r<t & t<x0 & t in dom f) &
   (for a st a is convergent & lim a = x0 &
   rng a c= dom f /\ left_open_halfline(x0) holds
   f*a is convergent & lim(f*a) = t) implies
   f is_left_convergent_in x0 & lim_left(f,x0) = t
   proof
    assume A1: (for r st r<x0 ex t st r<t & t<x0 & t in dom f) &
     for a st a is convergent & lim a = x0 &
      rng a c= dom f /\ left_open_halfline(x0) holds
      f*a is convergent & lim(f*a) = t;
    hence f is_left_convergent_in x0 by LIMFUNC2:def 1;
    hence thesis by A1,LIMFUNC2:def 7;
   end;
 end;

theorem Th4:
(ex N being Neighbourhood of x0 st N\{x0} c=dom f) implies
(for r1,r2 st r1<x0 & x0<r2
  ex g1,g2 st r1<g1 & g1<x0 & g1 in dom f & g2<r2 & x0<g2 & g2 in dom f)
 proof
  given N being Neighbourhood of x0 such that
  A1: N\{x0} c= dom f;
  consider r be real number such that
  A2: 0<r & N=].x0-r,x0+r.[ by RCOMP_1:def 7;
A3: r is Real by XREAL_0:def 1;
  then N\{x0}=].x0-r,x0.[ \/ ].x0,x0+r.[ by A2,LIMFUNC3:4;
  hence thesis by A1,A2,A3,LIMFUNC3:5;
 end;

theorem
    (ex N being Neighbourhood of x0 st f is_differentiable_on N &
g is_differentiable_on N & N \ {x0} c= dom (f/g) &
N c= dom ((f`|N)/(g`|N)) & f.x0 = 0 & g.x0 = 0 &
(f`|N)/(g`|N) is_divergent_to+infty_in x0)
implies f/g is_divergent_to+infty_in x0
 proof
  given N being Neighbourhood of x0 such that
  A1: f is_differentiable_on N & g is_differentiable_on N &
     N \ {x0} c= dom (f/g) & N c= dom ((f`|N)/(g`|N)) &
     f.x0 = 0 & g.x0 = 0 & (f`|N)/(g`|N) is_divergent_to+infty_in x0;
  consider r be real number such that
  A2: 0<r & N = ].x0-r,x0+r.[ by RCOMP_1:def 7;
A3: r is Real by XREAL_0:def 1;
  A4: for x st x0<x & x<x0+r ex c st c in ].x0,x.[ & (f/g).x=((f`|N)/(g`|N)).c
   proof
    let x such that
    A5: x0<x & x<x0+r;
    A6: f is_continuous_on N by A1,FDIFF_1:33;
    A7: g is_continuous_on N by A1,FDIFF_1:33;
    A8: x0-r<x0 by A2,XREAL_1:46;
        x0+0<x0+r by A2,XREAL_1:10;
    then x0 in {g1: x0-r<g1 & g1<x0+r} by A8;
    then A9: x0 in ].x0-r,x0+r.[ by RCOMP_1:def 2;
        x0-r<x by A5,A8,XXREAL_0:2;
    then x in {g1: x0-r<g1 & g1<x0+r} by A5;
    then x in ].x0-r,x0+r.[ by RCOMP_1:def 2;
    then A10: [.x0,x.] c= N by A2,A9,RCOMP_1:17;
    then f is_continuous_on [.x0,x.] by A6,FCONT_1:17;
    then A11: (g.x)(#)f is_continuous_on [.x0,x.] by FCONT_1:21;
        g is_continuous_on [.x0,x.] by A7,A10,FCONT_1:17;
    then (f.x)(#)g is_continuous_on [.x0,x.] by FCONT_1:21;
    then A12: (f.x)(#)g - (g.x)(#)f is_continuous_on [.x0,x.] by A11,FCONT_1:19
;
    A13: dom ((g.x)(#)f) = dom f by VALUED_1:7,def 5;
    A14: dom ((f.x)(#)g) = dom g by VALUED_1:7,def 5;
    A15: N c= dom ((g.x)(#)f) by A6,A13,FCONT_1:14;
    A16: N c= dom ((f.x)(#)g) by A7,A14,FCONT_1:14;
    A17: ].x0,x.[ c= [.x0,x.] by RCOMP_1:15;
    then A18: ].x0,x.[ c= N by A10,XBOOLE_1:1;
    then A19: f is_differentiable_on ].x0,x.[ by A1,FDIFF_1:34;
    A20: ].x0,x.[ c= dom ((g.x)(#)f) by A15,A18,XBOOLE_1:1;
    then A21: (g.x)(#)f is_differentiable_on ].x0,x.[ by A19,FDIFF_1:28;
    A22: ].x0,x.[ c= dom ((f.x)(#)g) by A16,A18,XBOOLE_1:1;
    then ].x0,x.[ c= dom ((f.x)(#)g) /\ dom ((g.x)(#)f) by A20,XBOOLE_1:19
;
    then A23: ].x0,x.[ c= dom ((f.x)(#)g - (g.x)(#)f) by VALUED_1:12,13,14,15;
     g is_differentiable_on ].x0,x.[ by A1,A18,FDIFF_1:34;
    then A24: (f.x)(#)g is_differentiable_on ].x0,x.[ by A22,FDIFF_1:28;
    then A25: (f.x)(#)g-(g.x)(#)
f is_differentiable_on ].x0,x.[ by A21,A23,FDIFF_1:27;
    set f1 = (f.x)(#)g - (g.x)(#)f;
    A26: [.x0,x.] c= dom f1 by A12,FCONT_1:def 2;
    A27: x0 in [.x0,x.] & x in [.x0,x.] by A5,RCOMP_1:15;
    then x0 in dom f1 & x in dom f1 by A26;
    then x0 in dom ((f.x)(#)g) /\ dom ((g.x)(#)f) & x in dom ((f.x)(#)g) /\
 dom ((g.x)
(#)f)
     by VALUED_1:12,13,14,15;
    then A28: x0 in dom ((f.x)(#)g) & x0 in dom ((g.x)(#)f) & x in dom ((f.x)
(#)g) &
    x in dom ((g.x)(#)f) by XBOOLE_0:def 3;
    A29: f1.x0 = ((f.x)(#)g).x0 - ((g.x)(#)f).x0 by A26,A27,VALUED_1:12,13,14
,15
         .= (f.x)*(g.x0) - ((g.x)(#)f).x0 by A28,VALUED_1:7,def 5
         .= 0 - (g.x)*0 by A1,A28,VALUED_1:7,def 5
         .= 0;
        f1.x = ((f.x)(#)g).x - ((g.x)(#)f).x by A26,A27,VALUED_1:12,13,14,15
         .= (f.x)*(g.x) - ((g.x)(#)f).x by A28,VALUED_1:7,def 5
         .= (g.x)*(f.x) - (g.x)*(f.x) by A28,VALUED_1:7,def 5
         .= 0;
    then consider t such that
    A30: t in ].x0,x.[ & diff(f1,t)=0 by A5,A12,A25,A29,ROLLE:1;
    take t;
    A31: (f.x)(#)g is_differentiable_in t by A24,A30,FDIFF_1:16;
        (g.x)(#)f is_differentiable_in t by A21,A30,FDIFF_1:16;
    then A32: 0=diff((f.x)(#)g,t) - diff((g.x)(#)f,t) by A30,A31,FDIFF_1:22;
    A33: g is_differentiable_in t by A1,A18,A30,FDIFF_1:16;
        f is_differentiable_in t by A1,A18,A30,FDIFF_1:16;
    then 0=diff((f.x)(#)g,t) - (g.x)*diff(f,t) by A32,FDIFF_1:23;
    then A34: 0=(f.x)*diff(g,t) - (g.x)*diff(f,t) by A33,FDIFF_1:23;
        [.x0,x.]\{x0} c= N\{x0} by A10,XBOOLE_1:33;
    then A35: [.x0,x.]\{x0} c= dom(f/g) by A1,XBOOLE_1:1;
    then A36: [.x0,x.]\{x0} c= dom f /\ (dom g\g"{0}) by RFUNCT_1:def 4;
        dom f /\ (dom g\g"{0}) c= dom g\g"{0} by XBOOLE_1:17;
    then A37: [.x0,x.]\{x0} c= dom g\g"{0} by A36,XBOOLE_1:1;
        not x in {x0} by A5,TARSKI:def 1;
    then A38: x in [.x0,x.]\{x0} by A27,XBOOLE_0:def 4;
    then A39: x in dom g & not x in g"{0} by A37,XBOOLE_0:def 4;
    A40: now assume g.x=0;
         then g.x in {0} by TARSKI:def 1;
         hence contradiction by A39,FUNCT_1:def 13;
        end;
    A41: [.x0,x.] c= dom ((f`|N)/(g`|N)) by A1,A10,XBOOLE_1:1;
    then A42: [.x0,x.] c= dom (f`|N) /\ (dom (g`|N)\(g`|N)"{0}) by
RFUNCT_1:def 4;
        dom (f`|N) /\ (dom (g`|N) \ (g`|N)"{0}) c= dom (g`|N)\(g`|N)"{0}
     by XBOOLE_1:17;
    then A43: [.x0,x.] c= dom (g`|N)\(g`|N)"{0} by A42,XBOOLE_1:1;
    A44: t in [.x0,x.] by A17,A30;
    then A45: t in dom (g`|N) & not t in (g`|N)"{0} by A43,XBOOLE_0:def 4;
         now assume diff(g,t)=0;
         then (g`|N).t=0 by A1,A10,A44,FDIFF_1:def 8;
         then (g`|N).t in {0} by TARSKI:def 1;
         hence contradiction by A45,FUNCT_1:def 13;
        end;
    then (f.x)/(g.x) = diff(f,t)/diff(g,t) by A34,A40,XCMPLX_1:95;
    then (f.x)*(g.x)" = diff(f,t)/diff(g,t) by XCMPLX_0:def 9;
    then (f.x)*(g.x)" = diff(f,t)*diff(g,t)" by XCMPLX_0:def 9;
    then (f/g).x = diff(f,t)*diff(g,t)" by A35,A38,RFUNCT_1:def 4;
    then (f/g).x = ((f`|N).t)*diff(g,t)" by A1,A10,A44,FDIFF_1:def 8;
    then (f/g).x = ((f`|N).t)*((g`|N).t)" by A1,A10,A44,FDIFF_1:def 8;
    hence thesis by A30,A41,A44,RFUNCT_1:def 4;
   end;
      for r1,r2 st r1<x0 & x0<r2
  ex g1,g2 st r1<g1 & g1<x0 & g1 in dom (f/g) & g2<r2 &
   x0<g2 & g2 in dom (f/g) by A1,Th4;
  then A46: (for r1 st x0<r1 ex t st t<r1 & x0<t & t in dom (f/g)) &
      for r1 st r1<x0 ex t st r1<t & t<x0 & t in dom (f/g) by LIMFUNC3:8;
      for a st a is convergent & lim a = x0 &
  rng a c= dom (f/g) /\ right_open_halfline(x0) holds
  (f/g)*a is divergent_to+infty
   proof
    let a;
    assume A47: a is convergent & lim a = x0 &
               rng a c= dom (f/g) /\ right_open_halfline(x0);
    then consider k such that
    A48: for n st k<=n holds x0-r<a.n & a.n<x0+r by A2,A3,LIMFUNC3:7;
    set a1 = a^\k;
     A49: now let n;
          A50: a1.n = a.(n+k) by SEQM_3:def 9;
              a.(n+k) in rng a by RFUNCT_2:10;
          then a.(n+k) in right_open_halfline(x0) by A47,XBOOLE_0:def 3;
          then a.(n+k) in {g1:x0<g1} by LIMFUNC1:152;
          then ex g1 st a.(n+k)=g1 & x0<g1;
          hence x0<a1.n by SEQM_3:def 9;
              k<=n+k by NAT_1:12;
          hence a1.n<x0+r by A48,A50;
         end;
     defpred X[Element of NAT,real number] means
        $2 in ].x0,a1.$1.[ & (((f/g)*a)^\k).$1=((f`|N)/(g`|N)).$2;
    A51: for n ex c be real number st X[n,c]
         proof
          let n;
              x0<a1.n & a1.n<x0+r by A49;
          then consider c such that
          A52: c in ].x0,a1.n.[ & (f/g).(a1.n)=((f`|N)/(g`|N)).c by A4;
          take c;
              dom (f/g) /\ right_open_halfline(x0) c= dom (f/g) by XBOOLE_1:17
;
          then A53: rng a c= dom (f/g) by A47,XBOOLE_1:1;
              rng a1 c= rng a by RFUNCT_2:7;
          then rng a1 c= dom (f/g) by A53,XBOOLE_1:1;
          then ((f/g)*(a^\k)).n=((f`|N)/(g`|N)).c by A52,RFUNCT_2:21;
          hence thesis by A52,A53,RFUNCT_2:22;
         end;
    consider b such that
    A54: for n holds X[n,b.n] from RCOMP_1:sch 1(A51);
    reconsider d = NAT --> x0 as Real_Sequence by FUNCOP_1:57;
    A55: d is convergent by SEQ_4:39;
    A56: lim d=d.0 by SEQ_4:41
            .=x0 by FUNCOP_1:13;
    A57: a1 is convergent & lim a1=x0 by A47,SEQ_4:33;
     A58: now
          let n;
              b.n in ].x0,a1.n.[ by A54;
          then b.n in {g1:x0<g1 & g1<a1.n} by RCOMP_1:def 2;
          then ex g1 st g1=b.n & x0<g1 & g1<a1.n; hence d.n<=b.n & b.n<=a1.n
by FUNCOP_1:13;
         end;
    then A59: b is convergent by A55,A56,A57,SEQ_2:33;
    A60: lim b=x0 by A55,A56,A57,A58,SEQ_2:34;
    A61: x0-r<x0 by A2,XREAL_1:46;
        x0<x0+r by A2,REAL_2:174;
    then x0 in {g2: x0-r<g2 & g2<x0+r} by A61;
    then A62: x0 in ].x0-r,x0+r.[ by RCOMP_1:def 2;
    A63: rng b c= dom ((f`|N)/(g`|N)) \{x0}
     proof
      let x be set;
      assume x in rng b;
      then consider n such that A64: x=b.n by RFUNCT_2:9;
      A65: x0<a1.n & a1.n<x0+r by A49;
      A66: x in ].x0,a1.n.[ by A54,A64;
      then x in {g1:x0<g1 & g1<a1.n} by RCOMP_1:def 2; then A67: ex g1 st
 g1 = x & x0<g1 & g1<a1.n;
      A68: ].x0,a1.n.[ c= [.x0,a1.n.] by RCOMP_1:15;
          x0-r<a1.n by A61,A65,XXREAL_0:2;
      then a1.n in {g3: x0-r<g3 & g3<x0+r} by A65;
      then a1.n in ].x0-r,x0+r.[ by RCOMP_1:def 2;
      then [.x0,a1.n.] c= ].x0-r,x0+r.[ by A62,RCOMP_1:17;
      then ].x0,a1.n.[ c= ].x0-r,x0+r.[ by A68,XBOOLE_1:1;
      then A69: ].x0,a1.n.[ c= dom ((f`|N)/(g`|N)) by A1,A2,XBOOLE_1:1;
          not x in {x0} by A67,TARSKI:def 1;
      hence x in dom ((f`|N)/(g`|N))\{x0} by A66,A69,XBOOLE_0:def 4;
     end;
        dom ((f`|N)/(g`|N)) \{x0} c= dom ((f`|N)/(g`|N)) by XBOOLE_1:36;
    then A70: rng b c= dom ((f`|N)/(g`|N)) by A63,XBOOLE_1:1;
    A71: ((f`|N)/(g`|N))*b is divergent_to+infty by A1,A59,A60,A63,
LIMFUNC3:def 2;
         now
      let n;
          (((f/g)*a)^\k).n=((f`|N)/(g`|N)).(b.n) by A54;
      hence (((f`|N)/(g`|N))*b).n <= (((f/g)*a)^\k).n by A70,RFUNCT_2:21;
     end;
     then ((f/g)*a)^\k is divergent_to+infty by A71,LIMFUNC1:69;
    hence thesis by LIMFUNC1:34;
   end;
  then A72: f/g is_right_divergent_to+infty_in x0 by A46,LIMFUNC2:def 5;
  A73: for x st x0-r<x & x<x0 ex c st c in ].x,x0.[ & (f/g).x=((f`|N)/(g`|N)).c
   proof
    let x such that
    A74: x0-r<x & x<x0;
    A75: f is_continuous_on N by A1,FDIFF_1:33;
    A76: g is_continuous_on N by A1,FDIFF_1:33;
    A77: x0-r<x0 by A2,XREAL_1:46;
    A78: x0+0<x0+r by A2,XREAL_1:10;
    then x0 in {g1: x0-r<g1 & g1<x0+r} by A77;
    then A79: x0 in ].x0-r,x0+r.[ by RCOMP_1:def 2;
        x<x0+r by A74,A78,XXREAL_0:2;
    then x in {g1: x0-r<g1 & g1<x0+r} by A74;
    then x in ].x0-r,x0+r.[ by RCOMP_1:def 2;
    then A80: [.x,x0.] c= N by A2,A79,RCOMP_1:17;
    then f is_continuous_on [.x,x0.] by A75,FCONT_1:17;
    then A81: (g.x)(#)f is_continuous_on [.x,x0.] by FCONT_1:21;
        g is_continuous_on [.x,x0.] by A76,A80,FCONT_1:17;
    then (f.x)(#)g is_continuous_on [.x,x0.] by FCONT_1:21;
    then A82: (f.x)(#)g - (g.x)(#)f is_continuous_on [.x,x0.] by A81,FCONT_1:19
;
    A83: dom ((g.x)(#)f) = dom f by VALUED_1:7,def 5;
    A84: dom ((f.x)(#)g) = dom g by VALUED_1:7,def 5;
    A85: N c= dom ((g.x)(#)f) by A75,A83,FCONT_1:14;
    A86: N c= dom ((f.x)(#)g) by A76,A84,FCONT_1:14;
    A87: ].x,x0.[ c= [.x,x0.] by RCOMP_1:15;
    then A88: ].x,x0.[ c= N by A80,XBOOLE_1:1;
    then A89: f is_differentiable_on ].x,x0.[ by A1,FDIFF_1:34;
    A90: ].x,x0.[ c= dom ((g.x)(#)f) by A85,A88,XBOOLE_1:1;
    then A91: (g.x)(#)f is_differentiable_on ].x,x0.[ by A89,FDIFF_1:28;
    A92: ].x,x0.[ c= dom ((f.x)(#)g) by A86,A88,XBOOLE_1:1;
    then ].x,x0.[ c= dom ((f.x)(#)g) /\ dom ((g.x)(#)f) by A90,XBOOLE_1:19
;
    then A93: ].x,x0.[ c= dom ((f.x)(#)g - (g.x)(#)f) by VALUED_1:12,13,14,15;
     g is_differentiable_on ].x,x0.[ by A1,A88,FDIFF_1:34;
    then A94: (f.x)(#)g is_differentiable_on ].x,x0.[ by A92,FDIFF_1:28;
    then A95: (f.x)(#)g-(g.x)(#)
f is_differentiable_on ].x,x0.[ by A91,A93,FDIFF_1:27;
    set f1 = (f.x)(#)g - (g.x)(#)f;
    A96: [.x,x0.] c= dom f1 by A82,FCONT_1:def 2;
    A97: x0 in [.x,x0.] & x in [.x,x0.] by A74,RCOMP_1:15;
    then x0 in dom f1 & x in dom f1 by A96;
    then x0 in dom ((f.x)(#)g) /\ dom ((g.x)(#)f) & x in dom ((f.x)(#)g) /\
 dom ((g.x)
(#)f)
     by VALUED_1:12,13,14,15;
    then A98: x0 in dom ((f.x)(#)g) & x0 in dom ((g.x)(#)f) & x in dom ((f.x)
(#)
g) &
    x in dom ((g.x)(#)f) by XBOOLE_0:def 3;
    A99: f1.x0 = ((f.x)(#)g).x0 - ((g.x)(#)f).x0 by A96,A97,VALUED_1:12,13,14
,15
         .= (f.x)*(g.x0) - ((g.x)(#)f).x0 by A98,VALUED_1:7,def 5
         .= 0 - (g.x)*0 by A1,A98,VALUED_1:7,def 5
         .= 0;
        f1.x = ((f.x)(#)g).x - ((g.x)(#)f).x by A96,A97,VALUED_1:12,13,14,15
         .= (f.x)*(g.x) - ((g.x)(#)f).x by A98,VALUED_1:7,def 5
         .= (g.x)*(f.x) - (g.x)*(f.x) by A98,VALUED_1:7,def 5
         .= 0;
    then consider t such that
    A100: t in ].x,x0.[ & diff(f1,t)=0 by A74,A82,A95,A99,ROLLE:1;
    take t;
    A101: (f.x)(#)g is_differentiable_in t by A94,A100,FDIFF_1:16;
        (g.x)(#)f is_differentiable_in t by A91,A100,FDIFF_1:16;
    then A102: 0=diff((f.x)(#)g,t) - diff((g.x)(#)f,t) by A100,A101,FDIFF_1:22;
    A103: g is_differentiable_in t by A1,A88,A100,FDIFF_1:16;
        f is_differentiable_in t by A1,A88,A100,FDIFF_1:16;
    then 0=diff((f.x)(#)g,t) - (g.x)*diff(f,t) by A102,FDIFF_1:23;
    then A104: 0=(f.x)*diff(g,t) - (g.x)*diff(f,t) by A103,FDIFF_1:23;
        [.x,x0.]\{x0} c= N\{x0} by A80,XBOOLE_1:33;
    then A105: [.x,x0.]\{x0} c= dom(f/g) by A1,XBOOLE_1:1;
    then A106: [.x,x0.]\{x0} c= dom f /\ (dom g\g"{0}) by RFUNCT_1:def 4;
        dom f /\ (dom g\g"{0}) c= dom g\g"{0} by XBOOLE_1:17;
    then A107: [.x,x0.]\{x0} c= dom g\g"{0} by A106,XBOOLE_1:1;
        not x in {x0} by A74,TARSKI:def 1;
    then A108: x in [.x,x0.]\{x0} by A97,XBOOLE_0:def 4;
    then A109: x in dom g & not x in g"{0} by A107,XBOOLE_0:def 4;
    A110: now assume g.x=0;
         then g.x in {0} by TARSKI:def 1;
         hence contradiction by A109,FUNCT_1:def 13;
        end;
    A111: [.x,x0.] c= dom ((f`|N)/(g`|N)) by A1,A80,XBOOLE_1:1;
    then A112: [.x,x0.] c= dom (f`|N) /\ (dom (g`|N)\(g`|N)"{0}) by
RFUNCT_1:def 4;
        dom (f`|N) /\ (dom (g`|N) \ (g`|N)"{0}) c= dom (g`|N)\(g`|N)"{0}
     by XBOOLE_1:17;
    then A113: [.x,x0.] c= dom (g`|N)\(g`|N)"{0} by A112,XBOOLE_1:1;
    A114: t in [.x,x0.] by A87,A100;
    then A115: t in dom (g`|N) & not t in (g`|N)"{0} by A113,XBOOLE_0:def 4;
         now assume diff(g,t)=0;
         then (g`|N).t=0 by A1,A80,A114,FDIFF_1:def 8;
         then (g`|N).t in {0} by TARSKI:def 1;
         hence contradiction by A115,FUNCT_1:def 13;
        end;
    then (f.x)/(g.x) = diff(f,t)/diff(g,t) by A104,A110,XCMPLX_1:95;
    then (f.x)*(g.x)" = diff(f,t)/diff(g,t) by XCMPLX_0:def 9;
    then (f.x)*(g.x)" = diff(f,t)*diff(g,t)" by XCMPLX_0:def 9;
    then (f/g).x = diff(f,t)*diff(g,t)" by A105,A108,RFUNCT_1:def 4;
    then (f/g).x = ((f`|N).t)*diff(g,t)" by A1,A80,A114,FDIFF_1:def 8;
    then (f/g).x = ((f`|N).t)*((g`|N).t)" by A1,A80,A114,FDIFF_1:def 8;
    hence thesis by A100,A111,A114,RFUNCT_1:def 4;
   end;
      for a st a is convergent & lim a = x0 &
  rng a c= dom (f/g) /\ left_open_halfline(x0) holds
   (f/g)*a is divergent_to+infty
   proof
    let a;
    assume A116: a is convergent & lim a = x0 &
               rng a c= dom (f/g) /\ left_open_halfline(x0);
    then consider k such that
    A117: for n st k<=n holds x0-r<a.n & a.n<x0+r by A2,A3,LIMFUNC3:7;
    set a1 = a^\k;
     A118: now let n;
          A119: a1.n = a.(n+k) by SEQM_3:def 9;
              a.(n+k) in rng a by RFUNCT_2:10;
          then a.(n+k) in left_open_halfline(x0) by A116,XBOOLE_0:def 3;
          then a.(n+k) in {g1:g1<x0} by LIMFUNC1:151;
          then ex g1 st a.(n+k)=g1 & g1<x0;
          hence a1.n<x0 by SEQM_3:def 9;
              k<=n+k by NAT_1:12;
          hence x0-r<a1.n by A117,A119;
         end;
        defpred X[Element of NAT, real number] means
          $2 in ].a1.$1,x0.[ & (((f/g)*a)^\k).$1=((f`|N)/(g`|N)).$2;
    A120: for n ex c be real number st X[n,c]
         proof
          let n;
              x0-r<a1.n & a1.n<x0 by A118;
          then consider c such that
          A121: c in ].a1.n,x0.[ & (f/g).(a1.n)=((f`|N)/(g`|N)).c by A73;
          take c;
              dom (f/g) /\ left_open_halfline(x0) c= dom (f/g) by XBOOLE_1:17;
          then A122: rng a c= dom (f/g) by A116,XBOOLE_1:1;
              rng a1 c= rng a by RFUNCT_2:7;
          then rng a1 c= dom (f/g) by A122,XBOOLE_1:1;
          then ((f/g)*(a^\k)).n=((f`|N)/(g`|N)).c by A121,RFUNCT_2:21;
          hence thesis by A121,A122,RFUNCT_2:22;
         end;
    consider b such that
    A123: for n holds X[n,b.n] from RCOMP_1:sch 1(A120);
    reconsider d = NAT --> x0 as Real_Sequence by FUNCOP_1:57;
    A124: d is convergent by SEQ_4:39;
    A125: lim d=d.0 by SEQ_4:41
            .=x0 by FUNCOP_1:13;
    A126: a1 is convergent & lim a1=x0 by A116,SEQ_4:33;
     A127: now
          let n;
              b.n in ].a1.n,x0.[ by A123;
          then b.n in {g1:a1.n<g1 & g1<x0} by RCOMP_1:def 2;
          then ex g1 st g1=b.n & a1.n<g1 & g1<x0; hence a1.n<=b.n & b.n<=
d.n by FUNCOP_1:13;
         end;
    then A128: b is convergent by A124,A125,A126,SEQ_2:33;
    A129: lim b=x0 by A124,A125,A126,A127,SEQ_2:34;
    A130: x0-r<x0 by A2,XREAL_1:46;
    A131: x0<x0+r by A2,REAL_2:174;
    then x0 in {g2: x0-r<g2 & g2<x0+r} by A130;
    then A132: x0 in ].x0-r,x0+r.[ by RCOMP_1:def 2;
    A133: rng b c= dom ((f`|N)/(g`|N)) \{x0}
     proof
      let x be set;
      assume x in rng b;
      then consider n such that A134: x=b.n by RFUNCT_2:9;
      A135: x0-r<a1.n & a1.n<x0 by A118;
      A136: x in ].a1.n,x0.[ by A123,A134;
      then x in {g1:a1.n<g1 & g1<x0} by RCOMP_1:def 2; then A137: ex g1 st
 g1 = x & a1.n<g1 & g1<x0;
      A138: ].a1.n,x0.[ c= [.a1.n,x0.] by RCOMP_1:15;
          a1.n<x0+r by A131,A135,XXREAL_0:2;
      then a1.n in {g3: x0-r<g3 & g3<x0+r} by A135;
      then a1.n in ].x0-r,x0+r.[ by RCOMP_1:def 2;
      then [.a1.n,x0.] c= ].x0-r,x0+r.[ by A132,RCOMP_1:17;
      then ].a1.n,x0.[ c= ].x0-r,x0+r.[ by A138,XBOOLE_1:1;
      then A139: ].a1.n,x0.[ c= dom ((f`|N)/(g`|N)) by A1,A2,XBOOLE_1:1;
          not x in {x0} by A137,TARSKI:def 1;
      hence x in dom ((f`|N)/(g`|N))\{x0} by A136,A139,XBOOLE_0:def 4;
     end;
        dom ((f`|N)/(g`|N)) \{x0} c= dom ((f`|N)/(g`|N)) by XBOOLE_1:36;
    then A140: rng b c= dom ((f`|N)/(g`|N)) by A133,XBOOLE_1:1;
    A141: ((f`|N)/(g`|N))*b is divergent_to+infty by A1,A128,A129,A133,
LIMFUNC3:def 2;
         now
      let n;
          (((f/g)*a)^\k).n=((f`|N)/(g`|N)).(b.n) by A123;
      hence (((f`|N)/(g`|N))*b).n <= (((f/g)*a)^\k).n by A140,RFUNCT_2:21;
     end;
    then ((f/g)*a)^\k is divergent_to+infty by A141,LIMFUNC1:69;
    hence thesis by LIMFUNC1:34;
   end;
  then f/g is_left_divergent_to+infty_in x0 by A46,LIMFUNC2:def 2;
  hence thesis by A72,LIMFUNC3:15;
 end;

theorem
    (ex N being Neighbourhood of x0 st f is_differentiable_on N &
g is_differentiable_on N & N \ {x0} c= dom (f/g) &
N c= dom ((f`|N)/(g`|N)) & f.x0 = 0 & g.x0 = 0 &
(f`|N)/(g`|N) is_divergent_to-infty_in x0)
implies f/g is_divergent_to-infty_in x0
 proof
  given N being Neighbourhood of x0 such that
  A1: f is_differentiable_on N & g is_differentiable_on N &
     N \ {x0} c= dom (f/g) & N c= dom ((f`|N)/(g`|N)) &
     f.x0 = 0 & g.x0 = 0 &
     (f`|N)/(g`|N) is_divergent_to-infty_in x0;
  consider r be real number such that
  A2: 0<r & N = ].x0-r,x0+r.[ by RCOMP_1:def 7;
A3: r is Real by XREAL_0:def 1;
  A4: for x st x0<x & x<x0+r ex c st c in ].x0,x.[ & (f/g).x=((f`|N)/(g`|N)).c
   proof
    let x such that
    A5: x0<x & x<x0+r;
    A6: f is_continuous_on N by A1,FDIFF_1:33;
    A7: g is_continuous_on N by A1,FDIFF_1:33;
    A8: x0-r<x0 by A2,XREAL_1:46;
        x0+0<x0+r by A2,XREAL_1:10;
    then x0 in {g1: x0-r<g1 & g1<x0+r} by A8;
    then A9: x0 in ].x0-r,x0+r.[ by RCOMP_1:def 2;
        x0-r<x by A5,A8,XXREAL_0:2;
    then x in {g1: x0-r<g1 & g1<x0+r} by A5;
    then x in ].x0-r,x0+r.[ by RCOMP_1:def 2;
    then A10: [.x0,x.] c= N by A2,A9,RCOMP_1:17;
    then f is_continuous_on [.x0,x.] by A6,FCONT_1:17;
    then A11: (g.x)(#)f is_continuous_on [.x0,x.] by FCONT_1:21;
        g is_continuous_on [.x0,x.] by A7,A10,FCONT_1:17;
    then (f.x)(#)g is_continuous_on [.x0,x.] by FCONT_1:21;
    then A12: (f.x)(#)g - (g.x)(#)f is_continuous_on [.x0,x.] by A11,FCONT_1:19
;
    A13: dom ((g.x)(#)f) = dom f by VALUED_1:7,def 5;
    A14: dom ((f.x)(#)g) = dom g by VALUED_1:7,def 5;
    A15: N c= dom ((g.x)(#)f) by A6,A13,FCONT_1:14;
    A16: N c= dom ((f.x)(#)g) by A7,A14,FCONT_1:14;
    A17: ].x0,x.[ c= [.x0,x.] by RCOMP_1:15;
    then A18: ].x0,x.[ c= N by A10,XBOOLE_1:1;
    then A19: f is_differentiable_on ].x0,x.[ by A1,FDIFF_1:34;
    A20: ].x0,x.[ c= dom ((g.x)(#)f) by A15,A18,XBOOLE_1:1;
    then A21: (g.x)(#)f is_differentiable_on ].x0,x.[ by A19,FDIFF_1:28;
    A22: ].x0,x.[ c= dom ((f.x)(#)g) by A16,A18,XBOOLE_1:1;
    then ].x0,x.[ c= dom ((f.x)(#)g) /\ dom ((g.x)(#)f) by A20,XBOOLE_1:19
;
    then A23: ].x0,x.[ c= dom ((f.x)(#)g - (g.x)(#)f) by VALUED_1:12,13,14,15;
     g is_differentiable_on ].x0,x.[ by A1,A18,FDIFF_1:34;
    then A24: (f.x)(#)g is_differentiable_on ].x0,x.[ by A22,FDIFF_1:28;
    then A25: (f.x)(#)g-(g.x)(#)
f is_differentiable_on ].x0,x.[ by A21,A23,FDIFF_1:27;
    set f1 = (f.x)(#)g - (g.x)(#)f;
    A26: [.x0,x.] c= dom f1 by A12,FCONT_1:def 2;
    A27: x0 in [.x0,x.] & x in [.x0,x.] by A5,RCOMP_1:15;
    then x0 in dom f1 & x in dom f1 by A26;
    then x0 in dom ((f.x)(#)g) /\ dom ((g.x)(#)f) & x in dom ((f.x)(#)g) /\
 dom ((g.x)
(#)f)
     by VALUED_1:12,13,14,15;
    then A28: x0 in dom ((f.x)(#)g) & x0 in dom ((g.x)(#)f) & x in dom ((f.x)
(#)g) &
    x in dom ((g.x)(#)f) by XBOOLE_0:def 3;
    A29: f1.x0 = ((f.x)(#)g).x0 - ((g.x)(#)f).x0 by A26,A27,VALUED_1:12,13,14
,15
         .= (f.x)*(g.x0) - ((g.x)(#)f).x0 by A28,VALUED_1:7,def 5
         .= 0 - (g.x)*0 by A1,A28,VALUED_1:7,def 5
         .= 0;
        f1.x = ((f.x)(#)g).x - ((g.x)(#)f).x by A26,A27,VALUED_1:12,13,14,15
         .= (f.x)*(g.x) - ((g.x)(#)f).x by A28,VALUED_1:7,def 5
         .= (g.x)*(f.x) - (g.x)*(f.x) by A28,VALUED_1:7,def 5
         .= 0;
    then consider t such that
    A30: t in ].x0,x.[ & diff(f1,t)=0 by A5,A12,A25,A29,ROLLE:1;
    take t;
    A31: (f.x)(#)g is_differentiable_in t by A24,A30,FDIFF_1:16;
        (g.x)(#)f is_differentiable_in t by A21,A30,FDIFF_1:16;
    then A32: 0=diff((f.x)(#)g,t) - diff((g.x)(#)f,t) by A30,A31,FDIFF_1:22;
    A33: g is_differentiable_in t by A1,A18,A30,FDIFF_1:16;
        f is_differentiable_in t by A1,A18,A30,FDIFF_1:16;
    then 0=diff((f.x)(#)g,t) - (g.x)*diff(f,t) by A32,FDIFF_1:23;
    then A34: 0=(f.x)*diff(g,t) - (g.x)*diff(f,t) by A33,FDIFF_1:23;
        [.x0,x.]\{x0} c= N\{x0} by A10,XBOOLE_1:33;
    then A35: [.x0,x.]\{x0} c= dom(f/g) by A1,XBOOLE_1:1;
    then A36: [.x0,x.]\{x0} c= dom f /\ (dom g\g"{0}) by RFUNCT_1:def 4;
        dom f /\ (dom g\g"{0}) c= dom g\g"{0} by XBOOLE_1:17;
    then A37: [.x0,x.]\{x0} c= dom g\g"{0} by A36,XBOOLE_1:1;
        not x in {x0} by A5,TARSKI:def 1;
    then A38: x in [.x0,x.]\{x0} by A27,XBOOLE_0:def 4;
    then A39: x in dom g & not x in g"{0} by A37,XBOOLE_0:def 4;
    A40: now assume g.x=0;
         then g.x in {0} by TARSKI:def 1;
         hence contradiction by A39,FUNCT_1:def 13;
        end;
    A41: [.x0,x.] c= dom ((f`|N)/(g`|N)) by A1,A10,XBOOLE_1:1;
    then A42: [.x0,x.] c= dom (f`|N) /\ (dom (g`|N)\(g`|N)"{0}) by
RFUNCT_1:def 4;
        dom (f`|N) /\ (dom (g`|N) \ (g`|N)"{0}) c= dom (g`|N)\(g`|N)"{0}
     by XBOOLE_1:17;
    then A43: [.x0,x.] c= dom (g`|N)\(g`|N)"{0} by A42,XBOOLE_1:1;
    A44: t in [.x0,x.] by A17,A30;
    then A45: t in dom (g`|N) & not t in (g`|N)"{0} by A43,XBOOLE_0:def 4;
         now assume diff(g,t)=0;
         then (g`|N).t=0 by A1,A10,A44,FDIFF_1:def 8;
         then (g`|N).t in {0} by TARSKI:def 1;
         hence contradiction by A45,FUNCT_1:def 13;
        end;
    then (f.x)/(g.x) = diff(f,t)/diff(g,t) by A34,A40,XCMPLX_1:95;
    then (f.x)*(g.x)" = diff(f,t)/diff(g,t) by XCMPLX_0:def 9;
    then (f.x)*(g.x)" = diff(f,t)*diff(g,t)" by XCMPLX_0:def 9;
    then (f/g).x = diff(f,t)*diff(g,t)" by A35,A38,RFUNCT_1:def 4;
    then (f/g).x = ((f`|N).t)*diff(g,t)" by A1,A10,A44,FDIFF_1:def 8;
    then (f/g).x = ((f`|N).t)*((g`|N).t)" by A1,A10,A44,FDIFF_1:def 8;
    hence thesis by A30,A41,A44,RFUNCT_1:def 4;
   end;
      for r1,r2 st r1<x0 & x0<r2
  ex g1,g2 st r1<g1 & g1<x0 & g1 in dom (f/g) & g2<r2 &
   x0<g2 & g2 in dom (f/g) by A1,Th4;
  then A46: (for r1 st x0<r1 ex t st t<r1 & x0<t & t in dom (f/g)) &
      for r1 st r1<x0 ex t st r1<t & t<x0 & t in dom (f/g) by LIMFUNC3:8;
      for a st a is convergent & lim a = x0 &
  rng a c= dom (f/g) /\ right_open_halfline(x0) holds
  (f/g)*a is divergent_to-infty
   proof
    let a;
    assume A47: a is convergent & lim a = x0 &
               rng a c= dom (f/g) /\ right_open_halfline(x0);
    then consider k such that
    A48: for n st k<=n holds x0-r<a.n & a.n<x0+r by A2,A3,LIMFUNC3:7;
    set a1 = a^\k;
     A49: now let n;
          A50: a1.n = a.(n+k) by SEQM_3:def 9;
              a.(n+k) in rng a by RFUNCT_2:10;
          then a.(n+k) in right_open_halfline(x0) by A47,XBOOLE_0:def 3;
          then a.(n+k) in {g1:x0<g1} by LIMFUNC1:152;
          then ex g1 st a.(n+k)=g1 & x0<g1;
          hence x0<a1.n by SEQM_3:def 9;
              k<=n+k by NAT_1:12;
          hence a1.n<x0+r by A48,A50;
         end;
        defpred X[Element of NAT,real number] means
            $2 in ].x0,a1.$1.[ & (((f/g)*a)^\k).$1=((f`|N)/(g`|N)).$2;
    A51: for n ex c be real number st X[n,c]
         proof
          let n;
              x0<a1.n & a1.n<x0+r by A49;
          then consider c such that
          A52: c in ].x0,a1.n.[ & (f/g).(a1.n)=((f`|N)/(g`|N)).c by A4;
          take c;
              dom (f/g) /\ right_open_halfline(x0) c= dom (f/g) by XBOOLE_1:17
;
          then A53: rng a c= dom (f/g) by A47,XBOOLE_1:1;
              rng a1 c= rng a by RFUNCT_2:7;
          then rng a1 c= dom (f/g) by A53,XBOOLE_1:1;
          then ((f/g)*(a^\k)).n=((f`|N)/(g`|N)).c by A52,RFUNCT_2:21;
          hence thesis by A52,A53,RFUNCT_2:22;
         end;
    consider b such that
    A54: for n holds X[n,b.n] from RCOMP_1:sch 1(A51);
    reconsider d = NAT --> x0 as Real_Sequence by FUNCOP_1:57;
    A55: d is convergent by SEQ_4:39;
    A56: lim d=d.0 by SEQ_4:41
            .=x0 by FUNCOP_1:13;
    A57: a1 is convergent & lim a1=x0 by A47,SEQ_4:33;
     A58: now
          let n;
              b.n in ].x0,a1.n.[ by A54;
          then b.n in {g1:x0<g1 & g1<a1.n} by RCOMP_1:def 2;
          then ex g1 st g1=b.n & x0<g1 & g1<a1.n; hence d.n<=b.n & b.n<=a1.n
by FUNCOP_1:13;
         end;
    then A59: b is convergent by A55,A56,A57,SEQ_2:33;
    A60: lim b=x0 by A55,A56,A57,A58,SEQ_2:34;
    A61: x0-r<x0 by A2,XREAL_1:46;
        x0<x0+r by A2,REAL_2:174;
    then x0 in {g2: x0-r<g2 & g2<x0+r} by A61;
    then A62: x0 in ].x0-r,x0+r.[ by RCOMP_1:def 2;
    A63: rng b c= dom ((f`|N)/(g`|N)) \{x0}
     proof
      let x be set;
      assume x in rng b;
      then consider n such that A64: x=b.n by RFUNCT_2:9;
      A65: x0<a1.n & a1.n<x0+r by A49;
      A66: x in ].x0,a1.n.[ by A54,A64;
      then x in {g1:x0<g1 & g1<a1.n} by RCOMP_1:def 2; then A67: ex g1 st
 g1 = x & x0<g1 & g1<a1.n;
      A68: ].x0,a1.n.[ c= [.x0,a1.n.] by RCOMP_1:15;
          x0-r<a1.n by A61,A65,XXREAL_0:2;
      then a1.n in {g3: x0-r<g3 & g3<x0+r} by A65;
      then a1.n in ].x0-r,x0+r.[ by RCOMP_1:def 2;
      then [.x0,a1.n.] c= ].x0-r,x0+r.[ by A62,RCOMP_1:17;
      then ].x0,a1.n.[ c= ].x0-r,x0+r.[ by A68,XBOOLE_1:1;
      then A69: ].x0,a1.n.[ c= dom ((f`|N)/(g`|N)) by A1,A2,XBOOLE_1:1;
          not x in {x0} by A67,TARSKI:def 1;
      hence x in dom ((f`|N)/(g`|N))\{x0} by A66,A69,XBOOLE_0:def 4;
     end;
        dom ((f`|N)/(g`|N)) \{x0} c= dom ((f`|N)/(g`|N)) by XBOOLE_1:36;
    then A70: rng b c= dom ((f`|N)/(g`|N)) by A63,XBOOLE_1:1;
    A71: ((f`|N)/(g`|N))*b is divergent_to-infty by A1,A59,A60,A63,
LIMFUNC3:def 3;
         now
      let n;
          (((f/g)*a)^\k).n=((f`|N)/(g`|N)).(b.n) by A54;
      hence (((f/g)*a)^\k).n <= (((f`|N)/(g`|N))*b).n by A70,RFUNCT_2:21;
     end;
    then ((f/g)*a)^\k is divergent_to-infty by A71,LIMFUNC1:70;
    hence thesis by LIMFUNC1:34;
   end;
  then A72: f/g is_right_divergent_to-infty_in x0 by A46,LIMFUNC2:def 6;
  A73: for x st x0-r<x & x<x0 ex c st c in ].x,x0.[ & (f/g).x=((f`|N)/(g`|N)).c
   proof
    let x such that
    A74: x0-r<x & x<x0;
    A75: f is_continuous_on N by A1,FDIFF_1:33;
    A76: g is_continuous_on N by A1,FDIFF_1:33;
    A77: x0-r<x0 by A2,XREAL_1:46;
    A78: x0+0<x0+r by A2,XREAL_1:10;
    then x0 in {g1: x0-r<g1 & g1<x0+r} by A77;
    then A79: x0 in ].x0-r,x0+r.[ by RCOMP_1:def 2;
        x<x0+r by A74,A78,XXREAL_0:2;
    then x in {g1: x0-r<g1 & g1<x0+r} by A74;
    then x in ].x0-r,x0+r.[ by RCOMP_1:def 2;
    then A80: [.x,x0.] c= N by A2,A79,RCOMP_1:17;
    then f is_continuous_on [.x,x0.] by A75,FCONT_1:17;
    then A81: (g.x)(#)f is_continuous_on [.x,x0.] by FCONT_1:21;
        g is_continuous_on [.x,x0.] by A76,A80,FCONT_1:17;
    then (f.x)(#)g is_continuous_on [.x,x0.] by FCONT_1:21;
    then A82: (f.x)(#)g - (g.x)(#)f is_continuous_on [.x,x0.] by A81,FCONT_1:19
;
    A83: dom ((g.x)(#)f) = dom f by VALUED_1:7,def 5;
    A84: dom ((f.x)(#)g) = dom g by VALUED_1:7,def 5;
    A85: N c= dom ((g.x)(#)f) by A75,A83,FCONT_1:14;
    A86: N c= dom ((f.x)(#)g) by A76,A84,FCONT_1:14;
    A87: ].x,x0.[ c= [.x,x0.] by RCOMP_1:15;
    then A88: ].x,x0.[ c= N by A80,XBOOLE_1:1;
    then A89: f is_differentiable_on ].x,x0.[ by A1,FDIFF_1:34;
    A90: ].x,x0.[ c= dom ((g.x)(#)f) by A85,A88,XBOOLE_1:1;
    then A91: (g.x)(#)f is_differentiable_on ].x,x0.[ by A89,FDIFF_1:28;
    A92: ].x,x0.[ c= dom ((f.x)(#)g) by A86,A88,XBOOLE_1:1;
    then ].x,x0.[ c= dom ((f.x)(#)g) /\ dom ((g.x)(#)f) by A90,XBOOLE_1:19
;
    then A93: ].x,x0.[ c= dom ((f.x)(#)g - (g.x)(#)f) by VALUED_1:12,13,14,15;
     g is_differentiable_on ].x,x0.[ by A1,A88,FDIFF_1:34;
    then A94: (f.x)(#)g is_differentiable_on ].x,x0.[ by A92,FDIFF_1:28;
    then A95: (f.x)(#)g-(g.x)(#)
f is_differentiable_on ].x,x0.[ by A91,A93,FDIFF_1:27;
    set f1 = (f.x)(#)g - (g.x)(#)f;
    A96: [.x,x0.] c= dom f1 by A82,FCONT_1:def 2;
    A97: x0 in [.x,x0.] & x in [.x,x0.] by A74,RCOMP_1:15;
    then x0 in dom f1 & x in dom f1 by A96;
    then x0 in dom ((f.x)(#)g) /\ dom ((g.x)(#)f) & x in dom ((f.x)(#)g) /\
 dom ((g.x)
(#)f)
     by VALUED_1:12,13,14,15;
    then A98: x0 in dom ((f.x)(#)g) & x0 in dom ((g.x)(#)f) & x in dom ((f.x)
(#)
g) &
    x in dom ((g.x)(#)f) by XBOOLE_0:def 3;
    A99: f1.x0 = ((f.x)(#)g).x0 - ((g.x)(#)f).x0 by A96,A97,VALUED_1:12,13,14
,15
         .= (f.x)*(g.x0) - ((g.x)(#)f).x0 by A98,VALUED_1:7,def 5
         .= 0 - (g.x)*0 by A1,A98,VALUED_1:7,def 5
         .= 0;
        f1.x = ((f.x)(#)g).x - ((g.x)(#)f).x by A96,A97,VALUED_1:12,13,14,15
         .= (f.x)*(g.x) - ((g.x)(#)f).x by A98,VALUED_1:7,def 5
         .= (g.x)*(f.x) - (g.x)*(f.x) by A98,VALUED_1:7,def 5
         .= 0;
    then consider t such that
    A100: t in ].x,x0.[ & diff(f1,t)=0 by A74,A82,A95,A99,ROLLE:1;
    take t;
    A101: (f.x)(#)g is_differentiable_in t by A94,A100,FDIFF_1:16;
        (g.x)(#)f is_differentiable_in t by A91,A100,FDIFF_1:16;
    then A102: 0=diff((f.x)(#)g,t) - diff((g.x)(#)f,t) by A100,A101,FDIFF_1:22;
    A103: g is_differentiable_in t by A1,A88,A100,FDIFF_1:16;
        f is_differentiable_in t by A1,A88,A100,FDIFF_1:16;
    then 0=diff((f.x)(#)g,t) - (g.x)*diff(f,t) by A102,FDIFF_1:23;
    then A104: 0=(f.x)*diff(g,t) - (g.x)*diff(f,t) by A103,FDIFF_1:23;
        [.x,x0.]\{x0} c= N\{x0} by A80,XBOOLE_1:33;
    then A105: [.x,x0.]\{x0} c= dom(f/g) by A1,XBOOLE_1:1;
    then A106: [.x,x0.]\{x0} c= dom f /\ (dom g\g"{0}) by RFUNCT_1:def 4;
        dom f /\ (dom g\g"{0}) c= dom g\g"{0} by XBOOLE_1:17;
    then A107: [.x,x0.]\{x0} c= dom g\g"{0} by A106,XBOOLE_1:1;
        not x in {x0} by A74,TARSKI:def 1;
    then A108: x in [.x,x0.]\{x0} by A97,XBOOLE_0:def 4;
    then A109: x in dom g & not x in g"{0} by A107,XBOOLE_0:def 4;
    A110: now assume g.x=0;
         then g.x in {0} by TARSKI:def 1;
         hence contradiction by A109,FUNCT_1:def 13;
        end;
    A111: [.x,x0.] c= dom ((f`|N)/(g`|N)) by A1,A80,XBOOLE_1:1;
    then A112: [.x,x0.] c= dom (f`|N) /\ (dom (g`|N)\(g`|N)"{0}) by
RFUNCT_1:def 4;
        dom (f`|N) /\ (dom (g`|N) \ (g`|N)"{0}) c= dom (g`|N)\(g`|N)"{0}
     by XBOOLE_1:17;
    then A113: [.x,x0.] c= dom (g`|N)\(g`|N)"{0} by A112,XBOOLE_1:1;
    A114: t in [.x,x0.] by A87,A100;
    then A115: t in dom (g`|N) & not t in (g`|N)"{0} by A113,XBOOLE_0:def 4;
         now assume diff(g,t)=0;
         then (g`|N).t=0 by A1,A80,A114,FDIFF_1:def 8;
         then (g`|N).t in {0} by TARSKI:def 1;
         hence contradiction by A115,FUNCT_1:def 13;
        end;
    then (f.x)/(g.x) = diff(f,t)/diff(g,t) by A104,A110,XCMPLX_1:95;
    then (f.x)*(g.x)" = diff(f,t)/diff(g,t) by XCMPLX_0:def 9;
    then (f.x)*(g.x)" = diff(f,t)*diff(g,t)" by XCMPLX_0:def 9;
    then (f/g).x = diff(f,t)*diff(g,t)" by A105,A108,RFUNCT_1:def 4;
    then (f/g).x = ((f`|N).t)*diff(g,t)" by A1,A80,A114,FDIFF_1:def 8;
    then (f/g).x = ((f`|N).t)*((g`|N).t)" by A1,A80,A114,FDIFF_1:def 8;
    hence thesis by A100,A111,A114,RFUNCT_1:def 4;
   end;
      for a st a is convergent & lim a = x0 &
  rng a c= dom (f/g) /\ left_open_halfline(x0) holds
  (f/g)*a is divergent_to-infty
   proof
    let a;
    assume A116: a is convergent & lim a = x0 &
               rng a c= dom (f/g) /\ left_open_halfline(x0);
    then consider k such that
    A117: for n st k<=n holds x0-r<a.n & a.n<x0+r by A2,A3,LIMFUNC3:7;
    set a1 = a^\k;
     A118: now let n;
          A119: a1.n = a.(n+k) by SEQM_3:def 9;
              a.(n+k) in rng a by RFUNCT_2:10;
          then a.(n+k) in left_open_halfline(x0) by A116,XBOOLE_0:def 3;
          then a.(n+k) in {g1:g1<x0} by LIMFUNC1:151;
          then ex g1 st a.(n+k)=g1 & g1<x0;
          hence a1.n<x0 by SEQM_3:def 9;
              k<=n+k by NAT_1:12;
          hence x0-r<a1.n by A117,A119;
         end;
        defpred X[Element of NAT,real number] means
          $2 in ].a1.$1,x0.[ & (((f/g)*a)^\k).$1=((f`|N)/(g`|N)).$2;
    A120: for n ex c be real number st X[n,c]
         proof
          let n;
              x0-r<a1.n & a1.n<x0 by A118;
          then consider c such that
          A121: c in ].a1.n,x0.[ & (f/g).(a1.n)=((f`|N)/(g`|N)).c by A73;
          take c;
              dom (f/g) /\ left_open_halfline(x0) c= dom (f/g) by XBOOLE_1:17;
          then A122: rng a c= dom (f/g) by A116,XBOOLE_1:1;
              rng a1 c= rng a by RFUNCT_2:7;
          then rng a1 c= dom (f/g) by A122,XBOOLE_1:1;
          then ((f/g)*(a^\k)).n=((f`|N)/(g`|N)).c by A121,RFUNCT_2:21;
          hence thesis by A121,A122,RFUNCT_2:22;
         end;
    consider b such that
    A123: for n holds X[n,b.n] from RCOMP_1:sch 1(A120);
    reconsider d = NAT --> x0 as Real_Sequence by FUNCOP_1:57;
    A124: d is convergent by SEQ_4:39;
    A125: lim d=d.0 by SEQ_4:41
            .=x0 by FUNCOP_1:13;
    A126: a1 is convergent & lim a1=x0 by A116,SEQ_4:33;
    A127: now
          let n;
              b.n in ].a1.n,x0.[ by A123;
          then b.n in {g1:a1.n<g1 & g1<x0} by RCOMP_1:def 2;
          then ex g1 st g1=b.n & a1.n<g1 & g1<x0; hence a1.n<=b.n & b.n<=
d.n by FUNCOP_1:13;
        end;
    then A128: b is convergent by A124,A125,A126,SEQ_2:33;
    A129: lim b=x0 by A124,A125,A126,A127,SEQ_2:34;
    A130: x0-r<x0 by A2,XREAL_1:46;
    A131: x0<x0+r by A2,REAL_2:174;
    then x0 in {g2: x0-r<g2 & g2<x0+r} by A130;
    then A132: x0 in ].x0-r,x0+r.[ by RCOMP_1:def 2;
    A133: rng b c= dom ((f`|N)/(g`|N)) \{x0}
     proof
      let x be set;
      assume x in rng b;
      then consider n such that A134: x=b.n by RFUNCT_2:9;
      A135: x0-r<a1.n & a1.n<x0 by A118;
      A136: x in ].a1.n,x0.[ by A123,A134;
      then x in {g1:a1.n<g1 & g1<x0} by RCOMP_1:def 2; then A137: ex g1 st
 g1 = x & a1.n<g1 & g1<x0;
      A138: ].a1.n,x0.[ c= [.a1.n,x0.] by RCOMP_1:15;
          a1.n<x0+r by A131,A135,XXREAL_0:2;
      then a1.n in {g3: x0-r<g3 & g3<x0+r} by A135;
      then a1.n in ].x0-r,x0+r.[ by RCOMP_1:def 2;
      then [.a1.n,x0.] c= ].x0-r,x0+r.[ by A132,RCOMP_1:17;
      then ].a1.n,x0.[ c= ].x0-r,x0+r.[ by A138,XBOOLE_1:1;
      then A139: ].a1.n,x0.[ c= dom ((f`|N)/(g`|N)) by A1,A2,XBOOLE_1:1;
          not x in {x0} by A137,TARSKI:def 1;
      hence x in dom ((f`|N)/(g`|N))\{x0} by A136,A139,XBOOLE_0:def 4;
     end;
        dom ((f`|N)/(g`|N)) \{x0} c= dom ((f`|N)/(g`|N)) by XBOOLE_1:36;
    then A140: rng b c= dom ((f`|N)/(g`|N)) by A133,XBOOLE_1:1;
    A141: ((f`|N)/(g`|N))*b is divergent_to-infty by A1,A128,A129,A133,
LIMFUNC3:def 3;
         now
      let n;
          (((f/g)*a)^\k).n=((f`|N)/(g`|N)).(b.n) by A123;
      hence (((f/g)*a)^\k).n <= (((f`|N)/(g`|N))*b).n by A140,RFUNCT_2:21;
     end;
    then ((f/g)*a)^\k is divergent_to-infty by A141,LIMFUNC1:70;
    hence thesis by LIMFUNC1:34;
   end;
  then f/g is_left_divergent_to-infty_in x0 by A46,LIMFUNC2:def 3;
  hence thesis by A72,LIMFUNC3:16;
 end;

theorem
    (ex r st r>0 & f is_differentiable_on ].x0,x0+r.[ &
g is_differentiable_on ].x0,x0+r.[ & ].x0,x0+r.[ c= dom (f/g) &
[.x0,x0+r.] c= dom ((f`|(].x0,x0+r.[))/(g`|(].x0,x0+r.[))) &
f.x0 = 0 & g.x0 = 0 &
f is_continuous_in x0 & g is_continuous_in x0 &
(f`|(].x0,x0+r.[))/(g`|(].x0,x0+r.[)) is_right_convergent_in x0) implies
f/g is_right_convergent_in x0 & ex r st r>0 &
lim_right(f/g,x0) = lim_right(((f`|(].x0,x0+r.[))/(g`|(].x0,x0+r.[))),x0)
 proof
  given r such that
  A1: r>0 & f is_differentiable_on ].x0,x0+r.[ &
     g is_differentiable_on ].x0,x0+r.[ & ].x0,x0+r.[ c= dom (f/g) &
     [.x0,x0+r.] c= dom ((f`|(].x0,x0+r.[))/(g`|(].x0,x0+r.[))) &
     f.x0 = 0 & g.x0 = 0 & f is_continuous_in x0 & g is_continuous_in x0 &
    (f`|(].x0,x0+r.[))/(g`|(].x0,x0+r.[)) is_right_convergent_in x0;
  A2: for x st x0<x & x<x0+r ex c st c in ].x0,x.[ &
  (f/g).x=((f`|].x0,x0+r.[)/(g`|].x0,x0+r.[)).c
   proof
    let x; assume
    A3: x0<x & x<x0+r;
    then x in {g1:x0<g1 & g1<x0+r};
    then A4: x in ].x0,x0+r.[ by RCOMP_1:def 2;
    A5: f is_continuous_on ].x0,x0+r.[ by A1,FDIFF_1:33;
    A6: g is_continuous_on ].x0,x0+r.[ by A1,FDIFF_1:33;
    A7: ].x0,x.[ c= ].x0,x0+r.[
       proof
         let y be set;
         assume y in ].x0,x.[;
         then y in {g2:x0<g2 & g2<x} by RCOMP_1:def 2;
         then consider g2 such that A8: g2=y & x0<g2 & g2<x;
             g2<x0+r by A3,A8,XXREAL_0:2;
         then y in {g3:x0<g3 & g3<x0+r} by A8;
         hence y in ].x0,x0+r.[ by RCOMP_1:def 2;
        end;
    then A9: f is_differentiable_on ].x0,x.[ by A1,FDIFF_1:34;
    A10: g is_differentiable_on ].x0,x.[ by A1,A7,FDIFF_1:34;
        f is_differentiable_in x by A1,A4,FDIFF_1:16;
    then A11: f is_continuous_in x by FDIFF_1:32;
        g is_differentiable_in x by A1,A4,FDIFF_1:16;
    then A12: g is_continuous_in x by FDIFF_1:32;
    A13: f is_continuous_on [.x0,x.] & g is_continuous_on [.x0,x.]
        proof
        A14: [.x0,x.] c= dom f
             proof
                  ].x0,x0+r.[ c= dom f by A5,FCONT_1:14;
              then A15: ].x0,x.[ c= dom f by A7,XBOOLE_1:1;
              A16: x0 in dom f by A1,FCONT_1:2;
                  x in dom f by A11,FCONT_1:2;
              then {x0,x} c= dom f by A16,ZFMISC_1:38;
              then ].x0,x.[ \/ {x0,x} c= dom f by A15,XBOOLE_1:8;
              hence thesis by A3,RCOMP_1:11;
             end;
            for s st rng s c= [.x0,x.] & s is convergent & lim s in [.x0,x.]
             holds f*s is convergent & f.(lim s) = lim (f*s)
         proof
          let s;
          assume A17: rng s c= [.x0,x.] & s is convergent & lim s in [.x0,x.];
          set z = lim s;
          A18: rng s c= dom f by A14,A17,XBOOLE_1:1;
A19:          z in ].x0,x.[ \/ {x0,x} by A3,A17,RCOMP_1:11;
              now per cases by A19,XBOOLE_0:def 2;
          suppose z in ].x0,x.[;
           then f is_differentiable_in z by A1,A7,FDIFF_1:16;
           then f is_continuous_in z by FDIFF_1:32;
           hence thesis by A17,A18,FCONT_1:def 1;
          end;
          suppose A20: z in {x0,x};
                now per cases by A20,TARSKI:def 2;
             suppose z = x0;
              hence thesis by A1,A17,A18,FCONT_1:def 1;
             end;
             suppose z = x;
              hence thesis by A11,A17,A18,FCONT_1:def 1;
             end;
             end;
            hence thesis;
           end;
           end;
          hence thesis;
         end;
        hence f is_continuous_on [.x0,x.] by A14,FCONT_1:14;
        A21: [.x0,x.] c= dom g
             proof
                  ].x0,x0+r.[ c= dom g by A6,FCONT_1:14;
              then A22: ].x0,x.[ c= dom g by A7,XBOOLE_1:1;
              A23: x0 in dom g by A1,FCONT_1:2;
                  x in dom g by A12,FCONT_1:2;
              then {x0,x} c= dom g by A23,ZFMISC_1:38;
              then ].x0,x.[ \/ {x0,x} c= dom g by A22,XBOOLE_1:8;
              hence thesis by A3,RCOMP_1:11;
             end;
            for s st rng s c= [.x0,x.] & s is convergent & lim s in [.x0,x.]
             holds g*s is convergent & g.(lim s) = lim (g*s)
         proof let s such that
          A24: rng s c= [.x0,x.] & s is convergent & lim s in [.x0,x.];
          set z = lim s;
          A25: rng s c= dom g by A21,A24,XBOOLE_1:1;
A26:          z in ].x0,x.[ \/ {x0,x} by A3,A24,RCOMP_1:11;
              now per cases by A26,XBOOLE_0:def 2;
          suppose z in ].x0,x.[;
           then g is_differentiable_in z by A1,A7,FDIFF_1:16;
           then g is_continuous_in z by FDIFF_1:32;
           hence thesis by A24,A25,FCONT_1:def 1;
          end;
          suppose A27: z in {x0,x};
                now per cases by A27,TARSKI:def 2;
             suppose z = x0;
              hence thesis by A1,A24,A25,FCONT_1:def 1;
             end;
             suppose z = x;
              hence thesis by A12,A24,A25,FCONT_1:def 1;
             end;
             end;
            hence thesis;
           end;
           end;
          hence thesis;
         end;
        hence thesis by A21,FCONT_1:14;
      end;
    then A28: (g.x)(#)f is_continuous_on [.x0,x.] by FCONT_1:21;
        (f.x)(#)g is_continuous_on [.x0,x.] by A13,FCONT_1:21;
    then A29: (f.x)(#)g - (g.x)(#)f is_continuous_on [.x0,x.] by A28,FCONT_1:19
;
    A30: dom ((g.x)(#)f) = dom f by VALUED_1:7,def 5;
    A31: dom ((f.x)(#)g) = dom g by VALUED_1:7,def 5;
    A32: ].x0,x0+r.[ c= dom ((g.x)(#)f) by A5,A30,FCONT_1:14;
    A33: ].x0,x0+r.[ c= dom ((f.x)(#)g) by A6,A31,FCONT_1:14;
    A34: ].x0,x.[ c= dom ((g.x)(#)f) by A7,A32,XBOOLE_1:1;
    then A35: (g.x)(#)f is_differentiable_on ].x0,x.[ by A9,FDIFF_1:28;
    A36: ].x0,x.[ c= dom ((f.x)(#)g) by A7,A33,XBOOLE_1:1;
    then ].x0,x.[ c= dom ((f.x)(#)g) /\ dom ((g.x)(#)f) by A34,XBOOLE_1:19;
    then A37: ].x0,x.[ c= dom ((f.x)(#)g - (g.x)(#)f) by VALUED_1:12,13,14,15;
    A38: (f.x)(#)g is_differentiable_on ].x0,x.[ by A10,A36,FDIFF_1:28;
    then A39: (f.x)(#)g-(g.x)(#)
f is_differentiable_on ].x0,x.[ by A35,A37,FDIFF_1:27;
    set f1 = (f.x)(#)g - (g.x)(#)f;
    A40: [.x0,x.] c= dom f1 by A29,FCONT_1:def 2;
    A41: x0 in [.x0,x.] & x in [.x0,x.] by A3,RCOMP_1:15;
    then x0 in dom f1 & x in dom f1 by A40;
    then x0 in dom ((f.x)(#)g) /\ dom ((g.x)(#)f) & x in dom ((f.x)(#)g) /\
 dom ((g.x)
(#)f)
     by VALUED_1:12,13,14,15;
    then A42: x0 in dom ((f.x)(#)g) & x0 in dom ((g.x)(#)f) & x in dom ((f.x)
(#)g) &
    x in dom ((g.x)(#)f) by XBOOLE_0:def 3;
    A43: f1.x0 = ((f.x)(#)g).x0 - ((g.x)(#)f).x0 by A40,A41,VALUED_1:12,13,14
,15
         .= (f.x)*(g.x0) - ((g.x)(#)f).x0 by A42,VALUED_1:7,def 5
         .= 0 - (g.x)*0 by A1,A42,VALUED_1:7,def 5
         .= 0;
        f1.x = ((f.x)(#)g).x - ((g.x)(#)f).x by A40,A41,VALUED_1:12,13,14,15
         .= (f.x)*(g.x) - ((g.x)(#)f).x by A42,VALUED_1:7,def 5
         .= (g.x)*(f.x) - (g.x)*(f.x) by A42,VALUED_1:7,def 5
         .= 0;
    then consider t such that
    A44: t in ].x0,x.[ & diff(f1,t)=0 by A3,A29,A39,A43,ROLLE:1;
    take t;
    A45: (f.x)(#)g is_differentiable_in t by A38,A44,FDIFF_1:16;
        (g.x)(#)f is_differentiable_in t by A35,A44,FDIFF_1:16;
    then A46: 0=diff((f.x)(#)g,t) - diff((g.x)(#)f,t) by A44,A45,FDIFF_1:22;
    A47: g is_differentiable_in t by A1,A7,A44,FDIFF_1:16;
        f is_differentiable_in t by A1,A7,A44,FDIFF_1:16;
    then 0=diff((f.x)(#)g,t) - (g.x)*diff(f,t) by A46,FDIFF_1:23;
    then A48: 0=(f.x)*diff(g,t) - (g.x)*diff(f,t) by A47,FDIFF_1:23;
         now
      let y be set;
      assume y in [.x0,x.]\{x0};
      then A49: y in [.x0,x.] & not y in {x0} by XBOOLE_0:def 4;
      then y in {g4: x0<=g4 & g4<=x} by RCOMP_1:def 1;
      then consider g4 such that A50: g4=y & x0<=g4 & g4<=x;
      A51: g4<x0+r by A3,A50,XXREAL_0:2;
          x0<>g4 by A49,A50,TARSKI:def 1;
      then x0<g4 by A50,REAL_1:def 5;
      then y in {g5: x0<g5 & g5<x0+r} by A50,A51;
      hence y in ].x0,x0+r.[ by RCOMP_1:def 2;
     end;
    then [.x0,x.]\{x0} c= ].x0,x0+r.[ by TARSKI:def 3;
    then A52: [.x0,x.]\{x0} c= dom(f/g) by A1,XBOOLE_1:1;
    then A53: [.x0,x.]\{x0} c= dom f /\ (dom g\g"{0}) by RFUNCT_1:def 4;
        dom f /\ (dom g\g"{0}) c= dom g\g"{0} by XBOOLE_1:17;
    then A54: [.x0,x.]\{x0} c= dom g\g"{0} by A53,XBOOLE_1:1;
        not x in {x0} by A3,TARSKI:def 1;
    then A55: x in [.x0,x.]\{x0} by A41,XBOOLE_0:def 4;
    then A56: x in dom g & not x in g"{0} by A54,XBOOLE_0:def 4;
    A57: now assume g.x=0;
         then g.x in {0} by TARSKI:def 1;
         hence contradiction by A56,FUNCT_1:def 13;
        end;
    A58: x0<=x0+r by A1,REAL_2:174;
    A59: ].x0,x0+r.[ c= [.x0,x0+r.] by RCOMP_1:15;
        x0 in {g6: x0<=g6 & g6<=x0+r} by A58;
    then x0 in [.x0,x0+r.] by RCOMP_1:def 1;
    then [.x0,x.] c= [.x0,x0+r.] by A4,A59,RCOMP_1:16;
    then A60: [.x0,x.] c= dom ((f`|].x0,x0+r.[)/(g`|].x0,x0+r.[)) by A1,
XBOOLE_1:1
;
    then A61: [.x0,x.] c= dom (f`|].x0,x0+r.[) /\
    (dom (g`|].x0,x0+r.[)\(g`|].x0,x0+r.[)"{0})
    by RFUNCT_1:def 4;
        dom (f`|].x0,x0+r.[) /\ (dom (g`|].x0,x0+r.[) \ (g`|].x0,x0+r.[)"{0})
c=
    dom (g`|].x0,x0+r.[)\(g`|].x0,x0+r.[)"{0}
     by XBOOLE_1:17;
    then A62: [.x0,x.] c= dom (g`|].x0,x0+r.[)\(g`|].x0,x0+r.[)"{0} by A61,
XBOOLE_1:1
;
        ].x0,x.[ c= [.x0,x.] by RCOMP_1:15;
    then A63: t in [.x0,x.] by A44;
    then A64: t in dom (g`|].x0,x0+r.[) &
    not t in (g`|].x0,x0+r.[)"{0} by A62,XBOOLE_0:def 4;
         now assume diff(g,t)=0;
         then (g`|].x0,x0+r.[).t=0 by A1,A7,A44,FDIFF_1:def 8;
         then (g`|].x0,x0+r.[).t in {0} by TARSKI:def 1;
         hence contradiction by A64,FUNCT_1:def 13;
        end;
    then (f.x)/(g.x) = diff(f,t)/diff(g,t) by A48,A57,XCMPLX_1:95;
    then (f.x)*(g.x)" = diff(f,t)/diff(g,t) by XCMPLX_0:def 9;
    then (f.x)*(g.x)" = diff(f,t)*diff(g,t)" by XCMPLX_0:def 9;
    then (f/g).x = diff(f,t)*diff(g,t)" by A52,A55,RFUNCT_1:def 4;
    then (f/g).x = ((f`|].x0,x0+r.[).t)*diff(g,t)" by A1,A7,A44,FDIFF_1:def 8;
    then (f/g).x = ((f`|].x0,x0+r.[).t)*((g`|].x0,x0+r.[).t)" by A1,A7,A44,
FDIFF_1:def 8;
    hence thesis by A44,A60,A63,RFUNCT_1:def 4;
   end;
  A65: for r1 st x0<r1 ex t st t<r1 & x0<t & t in dom (f/g) by A1,LIMFUNC2:4;
  A66: for a st a is convergent & lim a = x0 &
   rng a c= dom (f/g) /\ right_open_halfline(x0) holds
   (f/g)*a is convergent &
   lim((f/g)*a) = lim_right(((f`|].x0,x0+r.[)/(g`|].x0,x0+r.[)),x0)
   proof
    let a;
    assume A67: a is convergent & lim a = x0 &
               rng a c= dom (f/g) /\ right_open_halfline(x0);
    then consider k such that
    A68: for n st k<=n holds x0-r<a.n & a.n<x0+r by A1,LIMFUNC3:7;
    set a1 = a^\k;
     A69: now let n;
          A70: a1.n = a.(n+k) by SEQM_3:def 9;
              a.(n+k) in rng a by RFUNCT_2:10;
          then a.(n+k) in right_open_halfline(x0) by A67,XBOOLE_0:def 3;
          then a.(n+k) in {g1:x0<g1} by LIMFUNC1:152;
          then ex g1 st a.(n+k)=g1 & x0<g1;
          hence x0<a1.n by SEQM_3:def 9;
              k<=n+k by NAT_1:12;
          hence a1.n<x0+r by A68,A70;
         end;
        defpred X[Element of NAT,real number] means
            $2 in ].x0,a1.$1.[ &
    (((f/g)*a)^\k).$1=((f`|].x0,x0+r.[)/(g`|].x0,x0+r.[)).$2;
    A71: for n ex c be real number st X[n,c]
         proof
          let n;
              x0<a1.n & a1.n<x0+r by A69;
          then consider c such that
          A72: c in ].x0,a1.n.[ &
          (f/g).(a1.n)=((f`|].x0,x0+r.[)/(g`|].x0,x0+r.[)).c by A2;
          take c;
              dom (f/g) /\ right_open_halfline(x0) c= dom (f/g) by XBOOLE_1:17
;
          then A73: rng a c= dom (f/g) by A67,XBOOLE_1:1;
              rng a1 c= rng a by RFUNCT_2:7;
          then rng a1 c= dom (f/g) by A73,XBOOLE_1:1;
          then ((f/g)*(a^\k)).n=((f`|].x0,x0+r.[)/(g`|].x0,x0+r.[)).c
          by A72,RFUNCT_2:21;
          hence thesis by A72,A73,RFUNCT_2:22;
         end;
    consider b such that
    A74: for n holds X[n,b.n] from RCOMP_1:sch 1(A71);
    reconsider d = NAT --> x0 as Real_Sequence by FUNCOP_1:57;
    A75: d is convergent by SEQ_4:39;
    A76: lim d=d.0 by SEQ_4:41
            .=x0 by FUNCOP_1:13;
    A77: a1 is convergent & lim a1=x0 by A67,SEQ_4:33;
     A78: now
          let n;
              b.n in ].x0,a1.n.[ by A74;
          then b.n in {g1:x0<g1 & g1<a1.n} by RCOMP_1:def 2;
          then ex g1 st g1=b.n & x0<g1 & g1<a1.n; hence d.n<=b.n & b.n<=a1.n
by FUNCOP_1:13;
         end;
    then A79: b is convergent by A75,A76,A77,SEQ_2:33;
    A80: lim b=x0 by A75,A76,A77,A78,SEQ_2:34;
    A81: rng b c=
    dom ((f`|].x0,x0+r.[)/(g`|].x0,x0+r.[)) /\ right_open_halfline(x0)
     proof
      let x be set;
      assume x in rng b;
      then consider n such that A82: x=b.n by RFUNCT_2:9;
      A83: x0<a1.n & a1.n<x0+r by A69;
      A84: x in ].x0,a1.n.[ by A74,A82;
      then x in {g1:x0<g1 & g1<a1.n} by RCOMP_1:def 2; then ex g1 st
 g1 = x & x0<g1 & g1<a1.n;
      then x in {g2: x0<g2};
      then A85: x in right_open_halfline(x0) by LIMFUNC1:152;
      A86: ].x0,a1.n.[ c= [.x0,a1.n.] by RCOMP_1:15;
          x0<=x0+r by A1,REAL_2:174;
      then x0 in {g3: x0<=g3 & g3<=x0+r};
      then A87: x0 in [.x0,x0+r.] by RCOMP_1:def 1;
          a1.n in {g4: x0<=g4 & g4<=x0+r} by A83;
      then a1.n in [.x0,x0+r.] by RCOMP_1:def 1;
      then [.x0,a1.n.] c= [.x0,x0+r.] by A87,RCOMP_1:16;
      then ].x0,a1.n.[ c= [.x0,x0+r.] by A86,XBOOLE_1:1;
      then ].x0,a1.n.[ c= dom ((f`|].x0,x0+r.[)/(g`|].x0,x0+r.[))
      by A1,XBOOLE_1:1; hence x in dom ((f`|].x0,x0+r.[)/(g`|].x0,x0+r.[)) /\
      right_open_halfline(x0) by A84,A85,XBOOLE_0:def 3;
     end;
        dom ((f`|].x0,x0+r.[)/(g`|].x0,x0+r.[)) /\ right_open_halfline(x0) c=
    dom ((f`|].x0,x0+r.[)/(g`|].x0,x0+r.[)) by XBOOLE_1:17;
    then A88: rng b c= dom ((f`|].x0,x0+r.[)/(g`|].x0,x0+r.[)) by A81,
XBOOLE_1:1;
        lim_right(((f`|].x0,x0+r.[)/(g`|].x0,x0+r.[)),x0)=
    lim_right(((f`|].x0,x0+r.[)/(g`|].x0,x0+r.[)),x0);
    then A89: ((f`|].x0,x0+r.[)/(g`|].x0,x0+r.[))*b is convergent &
    lim (((f`|].x0,x0+r.[)/(g`|].x0,x0+r.[))*b) =
    lim_right(((f`|].x0,x0+r.[)/(g`|].x0,x0+r.[)),x0)
      by A1,A79,A80,A81,LIMFUNC2:def 8;
    A90: now take m = 0; let n such that m <=n;
             (((f/g)*a)^\k).n=((f`|].x0,x0+r.[)/(g`|].x0,x0+r.[)).(b.n) by A74;
         hence (((f/g)*a)^\k).n = (((f`|].x0,x0+r.[)/(g`|].x0,x0+r.[))*b).n
         by A88,RFUNCT_2:21;
        end;
    then A91: ((f/g)*a)^\k is convergent by A89,SEQ_4:31;
         lim (((f/g)*a)^\k) =
    lim_right(((f`|].x0,x0+r.[)/(g`|].x0,x0+r.[)),x0) by A89,A90,SEQ_4:32;
    hence thesis by A91,SEQ_4:35,36;
   end;
  hence f/g is_right_convergent_in x0 by A65,Th2;
  take r; thus r>0 by A1;
  thus thesis by A65,A66,Th2;
 end;

theorem
    (ex r st r>0 & f is_differentiable_on ].x0-r,x0.[ &
g is_differentiable_on ].x0-r,x0.[ & ].x0-r,x0.[ c= dom (f/g) &
[.x0-r,x0.] c= dom ((f`|(].x0-r,x0.[))/(g`|(].x0-r,x0.[))) &
f.x0 = 0 & g.x0 = 0 &
f is_continuous_in x0 & g is_continuous_in x0 &
(f`|(].x0-r,x0.[))/(g`|(].x0-r,x0.[)) is_left_convergent_in x0) implies
f/g is_left_convergent_in x0 & ex r st r>0 &
lim_left(f/g,x0) = lim_left(((f`|(].x0-r,x0.[))/(g`|(].x0-r,x0.[))),x0)
 proof
  given r such that
  A1: r>0 & f is_differentiable_on ].x0-r,x0.[ &
     g is_differentiable_on ].x0-r,x0.[ & ].x0-r,x0.[ c= dom (f/g) &
     [.x0-r,x0.] c= dom ((f`|(].x0-r,x0.[))/(g`|(].x0-r,x0.[))) &
     f.x0 = 0 & g.x0 = 0 &
     f is_continuous_in x0 & g is_continuous_in x0 &
     (f`|(].x0-r,x0.[))/(g`|(].x0-r,x0.[)) is_left_convergent_in x0;
  A2: for x st x0-r<x & x<x0 ex c st c in ].x,x0.[ &
  (f/g).x=((f`|].x0-r,x0.[)/(g`|].x0-r,x0.[)).c
   proof
    let x; assume
    A3: x0-r<x & x<x0;
    then x in {g1:x0-r<g1 & g1<x0};
    then A4: x in ].x0-r,x0.[ by RCOMP_1:def 2;
    A5: f is_continuous_on ].x0-r,x0.[ by A1,FDIFF_1:33;
    A6: g is_continuous_on ].x0-r,x0.[ by A1,FDIFF_1:33;
    A7: ].x,x0.[ c= ].x0-r,x0.[
       proof
         let y be set;
         assume y in ].x,x0.[;
         then y in {g2:x<g2 & g2<x0} by RCOMP_1:def 2;
         then consider g2 such that A8: g2=y & x<g2 & g2<x0;
             x0-r<g2 by A3,A8,XXREAL_0:2;
         then y in {g3:x0-r<g3 & g3<x0} by A8;
         hence y in ].x0-r,x0.[ by RCOMP_1:def 2;
        end;
    then A9: f is_differentiable_on ].x,x0.[ by A1,FDIFF_1:34;
    A10: g is_differentiable_on ].x,x0.[ by A1,A7,FDIFF_1:34;
        f is_differentiable_in x by A1,A4,FDIFF_1:16;
    then A11: f is_continuous_in x by FDIFF_1:32;
        g is_differentiable_in x by A1,A4,FDIFF_1:16;
    then A12: g is_continuous_in x by FDIFF_1:32;
    A13: f is_continuous_on [.x,x0.] & g is_continuous_on [.x,x0.]
        proof
        A14: [.x,x0.] c= dom f
             proof
                  ].x0-r,x0.[ c= dom f by A5,FCONT_1:14;
              then A15: ].x,x0.[ c= dom f by A7,XBOOLE_1:1;
              A16: x0 in dom f by A1,FCONT_1:2;
                  x in dom f by A11,FCONT_1:2;
              then {x,x0} c= dom f by A16,ZFMISC_1:38;
              then ].x,x0.[ \/ {x,x0} c= dom f by A15,XBOOLE_1:8;
              hence thesis by A3,RCOMP_1:11;
             end;
            for s st rng s c= [.x,x0.] & s is convergent & lim s in [.x,x0.]
             holds f*s is convergent & f.(lim s) = lim (f*s)
         proof
          let s;
          assume A17: rng s c= [.x,x0.] & s is convergent & lim s in [.x,x0.];
          set z = lim s;
          A18: rng s c= dom f by A14,A17,XBOOLE_1:1;
A19:          z in ].x,x0.[ \/ {x,x0} by A3,A17,RCOMP_1:11;
              now per cases by A19,XBOOLE_0:def 2;
          suppose z in ].x,x0.[;
           then f is_differentiable_in z by A1,A7,FDIFF_1:16;
           then f is_continuous_in z by FDIFF_1:32;
           hence thesis by A17,A18,FCONT_1:def 1;
          end;
          suppose A20: z in {x,x0};
                now per cases by A20,TARSKI:def 2;
             suppose z = x0;
              hence thesis by A1,A17,A18,FCONT_1:def 1;
             end;
             suppose z = x;
              hence thesis by A11,A17,A18,FCONT_1:def 1;
             end;
             end;
            hence thesis;
           end;
           end;
          hence thesis;
         end;
        hence f is_continuous_on [.x,x0.] by A14,FCONT_1:14;
        A21: [.x,x0.] c= dom g
             proof
                  ].x0-r,x0.[ c= dom g by A6,FCONT_1:14;
              then A22: ].x,x0.[ c= dom g by A7,XBOOLE_1:1;
              A23: x0 in dom g by A1,FCONT_1:2;
                  x in dom g by A12,FCONT_1:2;
              then {x,x0} c= dom g by A23,ZFMISC_1:38;
              then ].x,x0.[ \/ {x,x0} c= dom g by A22,XBOOLE_1:8;
              hence thesis by A3,RCOMP_1:11;
             end;
            for s st rng s c= [.x,x0.] & s is convergent & lim s in [.x,x0.]
             holds g*s is convergent & g.(lim s) = lim (g*s)
         proof let s such that
          A24: rng s c= [.x,x0.] & s is convergent & lim s in [.x,x0.];
          set z = lim s;
          A25: rng s c= dom g by A21,A24,XBOOLE_1:1;
A26:          z in ].x,x0.[ \/ {x,x0} by A3,A24,RCOMP_1:11;
              now per cases by A26,XBOOLE_0:def 2;
          suppose z in ].x,x0.[;
           then g is_differentiable_in z by A1,A7,FDIFF_1:16;
           then g is_continuous_in z by FDIFF_1:32;
           hence thesis by A24,A25,FCONT_1:def 1;
          end;
          suppose A27: z in {x,x0};
                now per cases by A27,TARSKI:def 2;
             suppose z = x0;
              hence thesis by A1,A24,A25,FCONT_1:def 1;
             end;
             suppose z = x;
              hence thesis by A12,A24,A25,FCONT_1:def 1;
             end;
             end;
            hence thesis;
           end;
           end;
          hence thesis;
         end;
        hence thesis by A21,FCONT_1:14;
      end;
    then A28: (g.x)(#)f is_continuous_on [.x,x0.] by FCONT_1:21;
        (f.x)(#)g is_continuous_on [.x,x0.] by A13,FCONT_1:21;
    then A29: (f.x)(#)g - (g.x)(#)f is_continuous_on [.x,x0.] by A28,FCONT_1:19
;
    A30: dom ((g.x)(#)f) = dom f by VALUED_1:7,def 5;
    A31: dom ((f.x)(#)g) = dom g by VALUED_1:7,def 5;
    A32: ].x0-r,x0.[ c= dom ((g.x)(#)f) by A5,A30,FCONT_1:14;
    A33: ].x0-r,x0.[ c= dom ((f.x)(#)g) by A6,A31,FCONT_1:14;
    A34: ].x,x0.[ c= dom ((g.x)(#)f) by A7,A32,XBOOLE_1:1;
    then A35: (g.x)(#)f is_differentiable_on ].x,x0.[ by A9,FDIFF_1:28;
    A36: ].x,x0.[ c= dom ((f.x)(#)g) by A7,A33,XBOOLE_1:1;
    then ].x,x0.[ c= dom ((f.x)(#)g) /\ dom ((g.x)(#)f) by A34,XBOOLE_1:19;
    then A37: ].x,x0.[ c= dom ((f.x)(#)g - (g.x)(#)f) by VALUED_1:12,13,14,15;
    A38: (f.x)(#)g is_differentiable_on ].x,x0.[ by A10,A36,FDIFF_1:28;
    then A39: (f.x)(#)g-(g.x)(#)
f is_differentiable_on ].x,x0.[ by A35,A37,FDIFF_1:27;
    set f1 = (f.x)(#)g - (g.x)(#)f;
    A40: [.x,x0.] c= dom f1 by A29,FCONT_1:def 2;
    A41: x0 in [.x,x0.] & x in [.x,x0.] by A3,RCOMP_1:15;
    then x0 in dom f1 & x in dom f1 by A40;
    then x0 in dom ((f.x)(#)g) /\ dom ((g.x)(#)f) & x in dom ((f.x)(#)g) /\
 dom ((g.x)
(#)f)
     by VALUED_1:12,13,14,15;
    then A42: x0 in dom ((f.x)(#)g) & x0 in dom ((g.x)(#)f) & x in dom ((f.x)
(#)g) &
    x in dom ((g.x)(#)f) by XBOOLE_0:def 3;
    A43: f1.x0 = ((f.x)(#)g).x0 - ((g.x)(#)f).x0 by A40,A41,VALUED_1:12,13,14
,15
         .= (f.x)*(g.x0) - ((g.x)(#)f).x0 by A42,VALUED_1:7,def 5
         .= 0 - (g.x)*0 by A1,A42,VALUED_1:7,def 5
         .= 0;
        f1.x = ((f.x)(#)g).x - ((g.x)(#)f).x by A40,A41,VALUED_1:12,13,14,15
         .= (f.x)*(g.x) - ((g.x)(#)f).x by A42,VALUED_1:7,def 5
         .= (g.x)*(f.x) - (g.x)*(f.x) by A42,VALUED_1:7,def 5
         .= 0;
    then consider t such that
    A44: t in ].x,x0.[ & diff(f1,t)=0 by A3,A29,A39,A43,ROLLE:1;
    take t;
    A45: (f.x)(#)g is_differentiable_in t by A38,A44,FDIFF_1:16;
        (g.x)(#)f is_differentiable_in t by A35,A44,FDIFF_1:16;
    then A46: 0=diff((f.x)(#)g,t) - diff((g.x)(#)f,t) by A44,A45,FDIFF_1:22;
    A47: g is_differentiable_in t by A1,A7,A44,FDIFF_1:16;
        f is_differentiable_in t by A1,A7,A44,FDIFF_1:16;
    then 0=diff((f.x)(#)g,t) - (g.x)*diff(f,t) by A46,FDIFF_1:23;
    then A48: 0=(f.x)*diff(g,t) - (g.x)*diff(f,t) by A47,FDIFF_1:23;
         now
      let y be set;
      assume y in [.x,x0.]\{x0};
      then A49: y in [.x,x0.] & not y in {x0} by XBOOLE_0:def 4;
      then y in {g4: x<=g4 & g4<=x0} by RCOMP_1:def 1;
      then consider g4 such that A50: g4=y & x<=g4 & g4<=x0;
      A51: x0-r<g4 by A3,A50,XXREAL_0:2;
          x0<>g4 by A49,A50,TARSKI:def 1;
      then g4<x0 by A50,REAL_1:def 5;
      then y in {g5: x0-r<g5 & g5<x0} by A50,A51;
      hence y in ].x0-r,x0.[ by RCOMP_1:def 2;
     end;
    then [.x,x0.]\{x0} c= ].x0-r,x0.[ by TARSKI:def 3;
    then A52: [.x,x0.]\{x0} c= dom(f/g) by A1,XBOOLE_1:1;
    then A53: [.x,x0.]\{x0} c= dom f /\ (dom g\g"{0}) by RFUNCT_1:def 4;
        dom f /\ (dom g\g"{0}) c= dom g\g"{0} by XBOOLE_1:17;
    then A54: [.x,x0.]\{x0} c= dom g\g"{0} by A53,XBOOLE_1:1;
        not x in {x0} by A3,TARSKI:def 1;
    then A55: x in [.x,x0.]\{x0} by A41,XBOOLE_0:def 4;
    then A56: x in dom g & not x in g"{0} by A54,XBOOLE_0:def 4;
    A57: now assume g.x=0;
         then g.x in {0} by TARSKI:def 1;
         hence contradiction by A56,FUNCT_1:def 13;
        end;
    A58: x0-r<=x0 by A1,REAL_2:174;
    A59: ].x0-r,x0.[ c= [.x0-r,x0.] by RCOMP_1:15;
        x0 in {g6: x0-r<=g6 & g6<=x0} by A58;
    then x0 in [.x0-r,x0.] by RCOMP_1:def 1;
    then [.x,x0.] c= [.x0-r,x0.] by A4,A59,RCOMP_1:16;
    then A60: [.x,x0.] c= dom ((f`|].x0-r,x0.[)/(g`|].x0-r,x0.[)) by A1,
XBOOLE_1:1
;
    then A61: [.x,x0.] c= dom (f`|].x0-r,x0.[) /\
    (dom (g`|].x0-r,x0.[)\(g`|].x0-r,x0.[)"{0})
    by RFUNCT_1:def 4;
        dom (f`|].x0-r,x0.[) /\ (dom (g`|].x0-r,x0.[) \ (g`|].x0-r,x0.[)"{0})
c=
    dom (g`|].x0-r,x0.[)\(g`|].x0-r,x0.[)"{0}
     by XBOOLE_1:17;
    then A62: [.x,x0.] c= dom (g`|].x0-r,x0.[)\(g`|].x0-r,x0.[)"{0} by A61,
XBOOLE_1:1
;
        ].x,x0.[ c= [.x,x0.] by RCOMP_1:15;
    then A63: t in [.x,x0.] by A44;
    then A64: t in dom (g`|].x0-r,x0.[) &
    not t in (g`|].x0-r,x0.[)"{0} by A62,XBOOLE_0:def 4;
         now assume diff(g,t)=0;
         then (g`|].x0-r,x0.[).t=0 by A1,A7,A44,FDIFF_1:def 8;
         then (g`|].x0-r,x0.[).t in {0} by TARSKI:def 1;
         hence contradiction by A64,FUNCT_1:def 13;
        end;
    then (f.x)/(g.x) = diff(f,t)/diff(g,t) by A48,A57,XCMPLX_1:95;
    then (f.x)*(g.x)" = diff(f,t)/diff(g,t) by XCMPLX_0:def 9;
    then (f.x)*(g.x)" = diff(f,t)*diff(g,t)" by XCMPLX_0:def 9;
    then (f/g).x = diff(f,t)*diff(g,t)" by A52,A55,RFUNCT_1:def 4;
    then (f/g).x = ((f`|].x0-r,x0.[).t)*diff(g,t)" by A1,A7,A44,FDIFF_1:def 8;
    then (f/g).x = ((f`|].x0-r,x0.[).t)*((g`|].x0-r,x0.[).t)" by A1,A7,A44,
FDIFF_1:def 8;
    hence thesis by A44,A60,A63,RFUNCT_1:def 4;
   end;
  A65: for r1 st r1<x0 ex t st r1<t & t<x0 & t in dom (f/g) by A1,LIMFUNC2:3;
  A66: for a st a is convergent & lim a = x0 &
  rng a c= dom (f/g) /\ left_open_halfline(x0) holds
  (f/g)*a is convergent &
  lim((f/g)*a) = lim_left (((f`|].x0-r,x0.[)/(g`|].x0-r,x0.[)),x0)
   proof
    let a;
    assume A67: a is convergent & lim a = x0 &
               rng a c= dom (f/g) /\ left_open_halfline(x0);
    then consider k such that
    A68: for n st k<=n holds x0-r<a.n & a.n<x0+r by A1,LIMFUNC3:7;
    set a1 = a^\k;
     A69: now let n;
          A70: a1.n = a.(n+k) by SEQM_3:def 9;
              a.(n+k) in rng a by RFUNCT_2:10;
          then a.(n+k) in left_open_halfline(x0) by A67,XBOOLE_0:def 3;
          then a.(n+k) in {g1:g1<x0} by LIMFUNC1:151;
          then ex g1 st a.(n+k)=g1 & g1<x0;
          hence a1.n<x0 by SEQM_3:def 9;
              k<=n+k by NAT_1:12;
          hence x0-r<a1.n by A68,A70;
         end;
        defpred X[Element of NAT,real number] means
          $2 in ].a1.$1,x0.[ &
    (((f/g)*a)^\k).$1=((f`|].x0-r,x0.[)/(g`|].x0-r,x0.[)).$2;
    A71: for n ex c be real number st X[n,c]
         proof
          let n;
              x0-r<a1.n & a1.n<x0 by A69;
          then consider c such that
          A72: c in ].a1.n,x0.[ & (f/g).(a1.n)=
          ((f`|].x0-r,x0.[)/(g`|].x0-r,x0.[)).c by A2;
          take c;
              dom (f/g) /\ left_open_halfline(x0) c= dom (f/g) by XBOOLE_1:17;
          then A73: rng a c= dom (f/g) by A67,XBOOLE_1:1;
              rng a1 c= rng a by RFUNCT_2:7;
          then rng a1 c= dom (f/g) by A73,XBOOLE_1:1;
          then ((f/g)*(a^\k)).n=((f`|].x0-r,x0.[)/(g`|].x0-r,x0.[)).c
          by A72,RFUNCT_2:21;
          hence thesis by A72,A73,RFUNCT_2:22;
         end;
    consider b such that
    A74: for n holds X[n,b.n] from RCOMP_1:sch 1(A71);
    reconsider d = NAT --> x0 as Real_Sequence by FUNCOP_1:57;
    A75: d is convergent by SEQ_4:39;
    A76: lim d=d.0 by SEQ_4:41
            .=x0 by FUNCOP_1:13;
    A77: a1 is convergent & lim a1=x0 by A67,SEQ_4:33;
     A78: now
          let n;
              b.n in ].a1.n,x0.[ by A74;
          then b.n in {g1:a1.n<g1 & g1<x0} by RCOMP_1:def 2;
          then ex g1 st g1=b.n & a1.n<g1 & g1<x0; hence a1.n<=b.n & b.n<=d.n
by FUNCOP_1:13;
         end;
    then A79: b is convergent by A75,A76,A77,SEQ_2:33;
    A80: lim b=x0 by A75,A76,A77,A78,SEQ_2:34;
    A81: rng b c=
    dom ((f`|].x0-r,x0.[)/(g`|].x0-r,x0.[)) /\ left_open_halfline(x0)
     proof
      let x be set;
      assume x in rng b;
      then consider n such that A82: x=b.n by RFUNCT_2:9;
      A83: x0-r<a1.n & a1.n<x0 by A69;
      A84: x in ].a1.n,x0.[ by A74,A82;
      then x in {g1:a1.n<g1 & g1<x0} by RCOMP_1:def 2; then ex g1 st
 g1 = x & a1.n<g1 & g1<x0;
      then x in {g2: g2<x0};
      then A85: x in left_open_halfline(x0) by LIMFUNC1:151;
      A86: ].a1.n,x0.[ c= [.a1.n,x0.] by RCOMP_1:15;
          x0-r<=x0 by A1,REAL_2:174;
      then x0 in {g3: x0-r<=g3 & g3<=x0};
      then A87: x0 in [.x0-r,x0.] by RCOMP_1:def 1;
          a1.n in {g4: x0-r<=g4 & g4<=x0} by A83;
      then a1.n in [.x0-r,x0.] by RCOMP_1:def 1;
      then [.a1.n,x0.] c= [.x0-r,x0.] by A87,RCOMP_1:16;
      then ].a1.n,x0.[ c= [.x0-r,x0.] by A86,XBOOLE_1:1;
      then ].a1.n,x0.[ c= dom ((f`|].x0-r,x0.[)/(g`|].x0-r,x0.[)) by A1,
XBOOLE_1:1;
hence x in dom ((f`|].x0-r,x0.[)/(g`|].x0-r,x0.[)) /\
      left_open_halfline(x0) by A84,A85,XBOOLE_0:def 3;
     end;
        dom ((f`|].x0-r,x0.[)/(g`|].x0-r,x0.[)) /\ left_open_halfline(x0) c=
    dom ((f`|].x0-r,x0.[)/(g`|].x0-r,x0.[)) by XBOOLE_1:17;
    then A88: rng b c= dom ((f`|].x0-r,x0.[)/(g`|].x0-r,x0.[)) by A81,
XBOOLE_1:1;
        lim_left(((f`|].x0-r,x0.[)/(g`|].x0-r,x0.[)),x0)=
    lim_left(((f`|].x0-r,x0.[)/(g`|].x0-r,x0.[)),x0);
    then A89: ((f`|].x0-r,x0.[)/(g`|].x0-r,x0.[))*b is convergent &
    lim (((f`|].x0-r,x0.[)/(g`|].x0-r,x0.[))*b) =
    lim_left(((f`|].x0-r,x0.[)/(g`|].x0-r,x0.[)),x0)
      by A1,A79,A80,A81,LIMFUNC2:def 7;
    A90: now take m = 0; let n such that m <=n;
             (((f/g)*a)^\k).n=((f`|].x0-r,x0.[)/(g`|].x0-r,x0.[)).(b.n) by A74;
         hence (((f/g)*a)^\k).n = (((f`|].x0-r,x0.[)/(g`|].x0-r,x0.[))*b).n
         by A88,RFUNCT_2:21;
        end;
    then A91: ((f/g)*a)^\k is convergent by A89,SEQ_4:31;
         lim (((f/g)*a)^\k) =
    lim_left(((f`|].x0-r,x0.[)/(g`|].x0-r,x0.[)),x0) by A89,A90,SEQ_4:32;
    hence thesis by A91,SEQ_4:35,36;
   end;
  hence f/g is_left_convergent_in x0 by A65,Th3;
  take r; thus r>0 by A1;
  thus thesis by A65,A66,Th3;
 end;

theorem
    (ex N being Neighbourhood of x0 st f is_differentiable_on N &
g is_differentiable_on N & N \ {x0} c= dom (f/g) &
N c= dom ((f`|N)/(g`|N)) & f.x0 = 0 & g.x0 = 0 &
(f`|N)/(g`|N) is_convergent_in x0) implies
f/g is_convergent_in x0 &
(ex N being Neighbourhood of x0 st lim(f/g,x0) = lim(((f`|N)/(g`|N)),x0))
 proof
  given N being Neighbourhood of x0 such that
  A1: f is_differentiable_on N & g is_differentiable_on N &
     N \ {x0} c= dom (f/g) & N c= dom ((f`|N)/(g`|N)) &
     f.x0 = 0 & g.x0 = 0 & (f`|N)/(g`|N) is_convergent_in x0;
  consider r be real number such that
  A2: 0<r & N = ].x0-r,x0+r.[ by RCOMP_1:def 7;
A3: r is Real by XREAL_0:def 1;
  A4: for x st x0<x & x<x0+r ex c st c in ].x0,x.[ & (f/g).x=((f`|N)/(g`|N)).c
   proof
    let x such that
    A5: x0<x & x<x0+r;
    A6: f is_continuous_on N by A1,FDIFF_1:33;
    A7: g is_continuous_on N by A1,FDIFF_1:33;
    A8: x0-r<x0 by A2,XREAL_1:46;
        x0+0<x0+r by A2,XREAL_1:10;
    then x0 in {g1: x0-r<g1 & g1<x0+r} by A8;
    then A9: x0 in ].x0-r,x0+r.[ by RCOMP_1:def 2;
        x0-r<x by A5,A8,XXREAL_0:2;
    then x in {g1: x0-r<g1 & g1<x0+r} by A5;
    then x in ].x0-r,x0+r.[ by RCOMP_1:def 2;
    then A10: [.x0,x.] c= N by A2,A9,RCOMP_1:17;
    then f is_continuous_on [.x0,x.] by A6,FCONT_1:17;
    then A11: (g.x)(#)f is_continuous_on [.x0,x.] by FCONT_1:21;
        g is_continuous_on [.x0,x.] by A7,A10,FCONT_1:17;
    then (f.x)(#)g is_continuous_on [.x0,x.] by FCONT_1:21;
    then A12: (f.x)(#)g - (g.x)(#)f is_continuous_on [.x0,x.] by A11,FCONT_1:19
;
    A13: dom ((g.x)(#)f) = dom f by VALUED_1:7,def 5;
    A14: dom ((f.x)(#)g) = dom g by VALUED_1:7,def 5;
    A15: N c= dom ((g.x)(#)f) by A6,A13,FCONT_1:14;
    A16: N c= dom ((f.x)(#)g) by A7,A14,FCONT_1:14;
    A17: ].x0,x.[ c= [.x0,x.] by RCOMP_1:15;
    then A18: ].x0,x.[ c= N by A10,XBOOLE_1:1;
    then A19: f is_differentiable_on ].x0,x.[ by A1,FDIFF_1:34;
    A20: ].x0,x.[ c= dom ((g.x)(#)f) by A15,A18,XBOOLE_1:1;
    then A21: (g.x)(#)f is_differentiable_on ].x0,x.[ by A19,FDIFF_1:28;
    A22: ].x0,x.[ c= dom ((f.x)(#)g) by A16,A18,XBOOLE_1:1;
    then ].x0,x.[ c= dom ((f.x)(#)g) /\ dom ((g.x)(#)f) by A20,XBOOLE_1:19
;
    then A23: ].x0,x.[ c= dom ((f.x)(#)g - (g.x)(#)f) by VALUED_1:12,13,14,15;
     g is_differentiable_on ].x0,x.[ by A1,A18,FDIFF_1:34;
    then A24: (f.x)(#)g is_differentiable_on ].x0,x.[ by A22,FDIFF_1:28;
    then A25: (f.x)(#)g-(g.x)(#)
f is_differentiable_on ].x0,x.[ by A21,A23,FDIFF_1:27;
    set f1 = (f.x)(#)g - (g.x)(#)f;
    A26: [.x0,x.] c= dom f1 by A12,FCONT_1:def 2;
    A27: x0 in [.x0,x.] & x in [.x0,x.] by A5,RCOMP_1:15;
    then x0 in dom f1 & x in dom f1 by A26;
    then x0 in dom ((f.x)(#)g) /\ dom ((g.x)(#)f) & x in dom ((f.x)(#)g) /\
 dom ((g.x)
(#)f)
     by VALUED_1:12,13,14,15;
    then A28: x0 in dom ((f.x)(#)g) & x0 in dom ((g.x)(#)f) & x in dom ((f.x)
(#)g) &
    x in dom ((g.x)(#)f) by XBOOLE_0:def 3;
    A29: f1.x0 = ((f.x)(#)g).x0 - ((g.x)(#)f).x0 by A26,A27,VALUED_1:12,13,14
,15
         .= (f.x)*(g.x0) - ((g.x)(#)f).x0 by A28,VALUED_1:7,def 5
         .= 0 - (g.x)*0 by A1,A28,VALUED_1:7,def 5
         .= 0;
        f1.x = ((f.x)(#)g).x - ((g.x)(#)f).x by A26,A27,VALUED_1:12,13,14,15
         .= (f.x)*(g.x) - ((g.x)(#)f).x by A28,VALUED_1:7,def 5
         .= (g.x)*(f.x) - (g.x)*(f.x) by A28,VALUED_1:7,def 5
         .= 0;
    then consider t such that
    A30: t in ].x0,x.[ & diff(f1,t)=0 by A5,A12,A25,A29,ROLLE:1;
    take t;
    A31: (f.x)(#)g is_differentiable_in t by A24,A30,FDIFF_1:16;
        (g.x)(#)f is_differentiable_in t by A21,A30,FDIFF_1:16;
    then A32: 0=diff((f.x)(#)g,t) - diff((g.x)(#)f,t) by A30,A31,FDIFF_1:22;
    A33: g is_differentiable_in t by A1,A18,A30,FDIFF_1:16;
        f is_differentiable_in t by A1,A18,A30,FDIFF_1:16;
    then 0=diff((f.x)(#)g,t) - (g.x)*diff(f,t) by A32,FDIFF_1:23;
    then A34: 0=(f.x)*diff(g,t) - (g.x)*diff(f,t) by A33,FDIFF_1:23;
        [.x0,x.]\{x0} c= N\{x0} by A10,XBOOLE_1:33;
    then A35: [.x0,x.]\{x0} c= dom(f/g) by A1,XBOOLE_1:1;
    then A36: [.x0,x.]\{x0} c= dom f /\ (dom g\g"{0}) by RFUNCT_1:def 4;
        dom f /\ (dom g\g"{0}) c= dom g\g"{0} by XBOOLE_1:17;
    then A37: [.x0,x.]\{x0} c= dom g\g"{0} by A36,XBOOLE_1:1;
        not x in {x0} by A5,TARSKI:def 1;
    then A38: x in [.x0,x.]\{x0} by A27,XBOOLE_0:def 4;
    then A39: x in dom g & not x in g"{0} by A37,XBOOLE_0:def 4;
    A40: now assume g.x=0;
         then g.x in {0} by TARSKI:def 1;
         hence contradiction by A39,FUNCT_1:def 13;
        end;
    A41: [.x0,x.] c= dom ((f`|N)/(g`|N)) by A1,A10,XBOOLE_1:1;
    then A42: [.x0,x.] c= dom (f`|N) /\ (dom (g`|N)\(g`|N)"{0}) by
RFUNCT_1:def 4;
        dom (f`|N) /\ (dom (g`|N) \ (g`|N)"{0}) c= dom (g`|N)\(g`|N)"{0}
     by XBOOLE_1:17;
    then A43: [.x0,x.] c= dom (g`|N)\(g`|N)"{0} by A42,XBOOLE_1:1;
    A44: t in [.x0,x.] by A17,A30;
    then A45: t in dom (g`|N) & not t in (g`|N)"{0} by A43,XBOOLE_0:def 4;
         now assume diff(g,t)=0;
         then (g`|N).t=0 by A1,A10,A44,FDIFF_1:def 8;
         then (g`|N).t in {0} by TARSKI:def 1;
         hence contradiction by A45,FUNCT_1:def 13;
        end;
    then (f.x)/(g.x) = diff(f,t)/diff(g,t) by A34,A40,XCMPLX_1:95;
    then (f.x)*(g.x)" = diff(f,t)/diff(g,t) by XCMPLX_0:def 9;
    then (f.x)*(g.x)" = diff(f,t)*diff(g,t)" by XCMPLX_0:def 9;
    then (f/g).x = diff(f,t)*diff(g,t)" by A35,A38,RFUNCT_1:def 4;
    then (f/g).x = ((f`|N).t)*diff(g,t)" by A1,A10,A44,FDIFF_1:def 8;
    then (f/g).x = ((f`|N).t)*((g`|N).t)" by A1,A10,A44,FDIFF_1:def 8;
    hence thesis by A30,A41,A44,RFUNCT_1:def 4;
   end;
      for r1,r2 st r1<x0 & x0<r2
  ex g1,g2 st r1<g1 & g1<x0 & g1 in dom (f/g) & g2<r2 &
   x0<g2 & g2 in dom (f/g) by A1,Th4;
  then A46: (for r1 st x0<r1 ex t st t<r1 & x0<t & t in dom (f/g)) &
      for r1 st r1<x0 ex t st r1<t & t<x0 & t in dom (f/g) by LIMFUNC3:8;
      for a st a is convergent & lim a = x0 &
  rng a c= dom (f/g) /\ right_open_halfline(x0) holds
  (f/g)*a is convergent & lim((f/g)*a) = lim(((f`|N)/(g`|N)),x0)
   proof
    let a;
    assume A47: a is convergent & lim a = x0 &
               rng a c= dom (f/g) /\ right_open_halfline(x0);
    then consider k such that
    A48: for n st k<=n holds x0-r<a.n & a.n<x0+r by A2,A3,LIMFUNC3:7;
    set a1 = a^\k;
     A49: now let n;
          A50: a1.n = a.(n+k) by SEQM_3:def 9;
              a.(n+k) in rng a by RFUNCT_2:10;
          then a.(n+k) in right_open_halfline(x0) by A47,XBOOLE_0:def 3;
          then a.(n+k) in {g1:x0<g1} by LIMFUNC1:152;
          then ex g1 st a.(n+k)=g1 & x0<g1;
          hence x0<a1.n by SEQM_3:def 9;
              k<=n+k by NAT_1:12;
          hence a1.n<x0+r by A48,A50;
         end;
        defpred X[Element of NAT,real number] means
         $2 in ].x0,a1.$1.[ & (((f/g)*a)^\k).$1=((f`|N)/(g`|N)).$2;
    A51: for n ex c be real number st X[n,c]
         proof
          let n;
              x0<a1.n & a1.n<x0+r by A49;
          then consider c such that
          A52: c in ].x0,a1.n.[ & (f/g).(a1.n)=((f`|N)/(g`|N)).c by A4;
          take c;
              dom (f/g) /\ right_open_halfline(x0) c= dom (f/g) by XBOOLE_1:17
;
          then A53: rng a c= dom (f/g) by A47,XBOOLE_1:1;
              rng a1 c= rng a by RFUNCT_2:7;
          then rng a1 c= dom (f/g) by A53,XBOOLE_1:1;
          then ((f/g)*(a^\k)).n=((f`|N)/(g`|N)).c by A52,RFUNCT_2:21;
          hence thesis by A52,A53,RFUNCT_2:22;
         end;
    consider b such that
    A54: for n holds X[n,b.n] from RCOMP_1:sch 1(A51);
    reconsider d = NAT --> x0 as Real_Sequence by FUNCOP_1:57;
    A55: d is convergent by SEQ_4:39;
    A56: lim d=d.0 by SEQ_4:41
            .=x0 by FUNCOP_1:13;
    A57: a1 is convergent & lim a1=x0 by A47,SEQ_4:33;
     A58: now
          let n;
              b.n in ].x0,a1.n.[ by A54;
          then b.n in {g1:x0<g1 & g1<a1.n} by RCOMP_1:def 2;
          then ex g1 st g1=b.n & x0<g1 & g1<a1.n; hence d.n<=b.n & b.n<=a1.n
by FUNCOP_1:13;
         end;
    then A59: b is convergent by A55,A56,A57,SEQ_2:33;
    A60: lim b=x0 by A55,A56,A57,A58,SEQ_2:34;
    A61: x0-r<x0 by A2,XREAL_1:46;
        x0<x0+r by A2,REAL_2:174;
    then x0 in {g2: x0-r<g2 & g2<x0+r} by A61;
    then A62: x0 in ].x0-r,x0+r.[ by RCOMP_1:def 2;
    A63: rng b c= dom ((f`|N)/(g`|N)) \{x0}
     proof
      let x be set;
      assume x in rng b;
      then consider n such that A64: x=b.n by RFUNCT_2:9;
      A65: x0<a1.n & a1.n<x0+r by A49;
      A66: x in ].x0,a1.n.[ by A54,A64;
      then x in {g1:x0<g1 & g1<a1.n} by RCOMP_1:def 2; then A67: ex g1 st
 g1 = x & x0<g1 & g1<a1.n;
      A68: ].x0,a1.n.[ c= [.x0,a1.n.] by RCOMP_1:15;
          x0-r<a1.n by A61,A65,XXREAL_0:2;
      then a1.n in {g3: x0-r<g3 & g3<x0+r} by A65;
      then a1.n in ].x0-r,x0+r.[ by RCOMP_1:def 2;
      then [.x0,a1.n.] c= ].x0-r,x0+r.[ by A62,RCOMP_1:17;
      then ].x0,a1.n.[ c= ].x0-r,x0+r.[ by A68,XBOOLE_1:1;
      then A69: ].x0,a1.n.[ c= dom ((f`|N)/(g`|N)) by A1,A2,XBOOLE_1:1;
          not x in {x0} by A67,TARSKI:def 1;
      hence x in dom ((f`|N)/(g`|N))\{x0} by A66,A69,XBOOLE_0:def 4;
     end;
        dom ((f`|N)/(g`|N)) \{x0} c= dom ((f`|N)/(g`|N)) by XBOOLE_1:36;
    then A70: rng b c= dom ((f`|N)/(g`|N)) by A63,XBOOLE_1:1;
        lim(((f`|N)/(g`|N)),x0)=lim(((f`|N)/(g`|N)),x0);
    then A71: ((f`|N)/(g`|N))*b is convergent &
    lim (((f`|N)/(g`|N))*b) = lim(((f`|N)/(g`|N)),x0)
      by A1,A59,A60,A63,LIMFUNC3:def 4;
    A72: now take m = 0; let n such that m <=n;
             (((f/g)*a)^\k).n=((f`|N)/(g`|N)).(b.n) by A54;
         hence (((f/g)*a)^\k).n = (((f`|N)/(g`|N))*b).n by A70,RFUNCT_2:21;
        end;
    then A73: ((f/g)*a)^\k is convergent by A71,SEQ_4:31;
         lim (((f/g)*a)^\k) = lim(((f`|N)/(g`|N)),x0) by A71,A72,SEQ_4:32;
    hence thesis by A73,SEQ_4:35,36;
   end;
  then A74: f/g is_right_convergent_in x0 & lim_right(f/g,x0)=lim(((f`|N)/(g`|N
)),x0)
      by A46,Th2;
  A75: for x st x0-r<x & x<x0 ex c st c in ].x,x0.[ & (f/g).x=((f`|N)/(g`|N)).c
   proof
    let x such that
    A76: x0-r<x & x<x0;
    A77: f is_continuous_on N by A1,FDIFF_1:33;
    A78: g is_continuous_on N by A1,FDIFF_1:33;
    A79: x0-r<x0 by A2,XREAL_1:46;
    A80: x0+0<x0+r by A2,XREAL_1:10;
    then x0 in {g1: x0-r<g1 & g1<x0+r} by A79;
    then A81: x0 in ].x0-r,x0+r.[ by RCOMP_1:def 2;
        x<x0+r by A76,A80,XXREAL_0:2;
    then x in {g1: x0-r<g1 & g1<x0+r} by A76;
    then x in ].x0-r,x0+r.[ by RCOMP_1:def 2;
    then A82: [.x,x0.] c= N by A2,A81,RCOMP_1:17;
    then f is_continuous_on [.x,x0.] by A77,FCONT_1:17;
    then A83: (g.x)(#)f is_continuous_on [.x,x0.] by FCONT_1:21;
        g is_continuous_on [.x,x0.] by A78,A82,FCONT_1:17;
    then (f.x)(#)g is_continuous_on [.x,x0.] by FCONT_1:21;
    then A84: (f.x)(#)g - (g.x)(#)f is_continuous_on [.x,x0.] by A83,FCONT_1:19
;
    A85: dom ((g.x)(#)f) = dom f by VALUED_1:7,def 5;
    A86: dom ((f.x)(#)g) = dom g by VALUED_1:7,def 5;
    A87: N c= dom ((g.x)(#)f) by A77,A85,FCONT_1:14;
    A88: N c= dom ((f.x)(#)g) by A78,A86,FCONT_1:14;
    A89: ].x,x0.[ c= [.x,x0.] by RCOMP_1:15;
    then A90: ].x,x0.[ c= N by A82,XBOOLE_1:1;
    then A91: f is_differentiable_on ].x,x0.[ by A1,FDIFF_1:34;
    A92: ].x,x0.[ c= dom ((g.x)(#)f) by A87,A90,XBOOLE_1:1;
    then A93: (g.x)(#)f is_differentiable_on ].x,x0.[ by A91,FDIFF_1:28;
    A94: ].x,x0.[ c= dom ((f.x)(#)g) by A88,A90,XBOOLE_1:1;
    then ].x,x0.[ c= dom ((f.x)(#)g) /\ dom ((g.x)(#)f) by A92,XBOOLE_1:19
;
    then A95: ].x,x0.[ c= dom ((f.x)(#)g - (g.x)(#)f) by VALUED_1:12,13,14,15;
     g is_differentiable_on ].x,x0.[ by A1,A90,FDIFF_1:34;
    then A96: (f.x)(#)g is_differentiable_on ].x,x0.[ by A94,FDIFF_1:28;
    then A97: (f.x)(#)g-(g.x)(#)
f is_differentiable_on ].x,x0.[ by A93,A95,FDIFF_1:27
;
    set f1 = (f.x)(#)g - (g.x)(#)f;
    A98: [.x,x0.] c= dom f1 by A84,FCONT_1:def 2;
    A99: x0 in [.x,x0.] & x in [.x,x0.] by A76,RCOMP_1:15;
    then x0 in dom f1 & x in dom f1 by A98;
    then x0 in dom ((f.x)(#)g) /\ dom ((g.x)(#)f) & x in dom ((f.x)(#)g) /\
 dom ((g.x)
(#)f)
     by VALUED_1:12,13,14,15;
    then A100: x0 in dom ((f.x)(#)g) & x0 in dom ((g.x)(#)f) & x in dom ((f.x)
(#)
g) &
    x in dom ((g.x)(#)f) by XBOOLE_0:def 3;
    A101: f1.x0 = ((f.x)(#)g).x0 - ((g.x)(#)f).x0 by A98,A99,VALUED_1:12,13,14
,15
         .= (f.x)*(g.x0) - ((g.x)(#)f).x0 by A100,VALUED_1:7,def 5
         .= 0 - (g.x)*0 by A1,A100,VALUED_1:7,def 5
         .= 0;
        f1.x = ((f.x)(#)g).x - ((g.x)(#)f).x by A98,A99,VALUED_1:12,13,14,15
         .= (f.x)*(g.x) - ((g.x)(#)f).x by A100,VALUED_1:7,def 5
         .= (g.x)*(f.x) - (g.x)*(f.x) by A100,VALUED_1:7,def 5
         .= 0;
    then consider t such that
    A102: t in ].x,x0.[ & diff(f1,t)=0 by A76,A84,A97,A101,ROLLE:1;
    take t;
    A103: (f.x)(#)g is_differentiable_in t by A96,A102,FDIFF_1:16;
        (g.x)(#)f is_differentiable_in t by A93,A102,FDIFF_1:16;
    then A104: 0=diff((f.x)(#)g,t) - diff((g.x)(#)f,t) by A102,A103,FDIFF_1:22;
    A105: g is_differentiable_in t by A1,A90,A102,FDIFF_1:16;
        f is_differentiable_in t by A1,A90,A102,FDIFF_1:16;
    then 0=diff((f.x)(#)g,t) - (g.x)*diff(f,t) by A104,FDIFF_1:23;
    then A106: 0=(f.x)*diff(g,t) - (g.x)*diff(f,t) by A105,FDIFF_1:23;
        [.x,x0.]\{x0} c= N\{x0} by A82,XBOOLE_1:33;
    then A107: [.x,x0.]\{x0} c= dom(f/g) by A1,XBOOLE_1:1;
    then A108: [.x,x0.]\{x0} c= dom f /\ (dom g\g"{0}) by RFUNCT_1:def 4;
        dom f /\ (dom g\g"{0}) c= dom g\g"{0} by XBOOLE_1:17;
    then A109: [.x,x0.]\{x0} c= dom g\g"{0} by A108,XBOOLE_1:1;
        not x in {x0} by A76,TARSKI:def 1;
    then A110: x in [.x,x0.]\{x0} by A99,XBOOLE_0:def 4;
    then A111: x in dom g & not x in g"{0} by A109,XBOOLE_0:def 4;
    A112: now assume g.x=0;
         then g.x in {0} by TARSKI:def 1;
         hence contradiction by A111,FUNCT_1:def 13;
        end;
    A113: [.x,x0.] c= dom ((f`|N)/(g`|N)) by A1,A82,XBOOLE_1:1;
    then A114: [.x,x0.] c= dom (f`|N) /\ (dom (g`|N)\(g`|N)"{0}) by
RFUNCT_1:def 4;
        dom (f`|N) /\ (dom (g`|N) \ (g`|N)"{0}) c= dom (g`|N)\(g`|N)"{0}
     by XBOOLE_1:17;
    then A115: [.x,x0.] c= dom (g`|N)\(g`|N)"{0} by A114,XBOOLE_1:1;
    A116: t in [.x,x0.] by A89,A102;
    then A117: t in dom (g`|N) & not t in (g`|N)"{0} by A115,XBOOLE_0:def 4;
         now assume diff(g,t)=0;
         then (g`|N).t=0 by A1,A82,A116,FDIFF_1:def 8;
         then (g`|N).t in {0} by TARSKI:def 1;
         hence contradiction by A117,FUNCT_1:def 13;
        end;
    then (f.x)/(g.x) = diff(f,t)/diff(g,t) by A106,A112,XCMPLX_1:95;
    then (f.x)*(g.x)" = diff(f,t)/diff(g,t) by XCMPLX_0:def 9;
    then (f.x)*(g.x)" = diff(f,t)*diff(g,t)" by XCMPLX_0:def 9;
    then (f/g).x = diff(f,t)*diff(g,t)" by A107,A110,RFUNCT_1:def 4;
    then (f/g).x = ((f`|N).t)*diff(g,t)" by A1,A82,A116,FDIFF_1:def 8;
    then (f/g).x = ((f`|N).t)*((g`|N).t)" by A1,A82,A116,FDIFF_1:def 8;
    hence thesis by A102,A113,A116,RFUNCT_1:def 4;
   end;
      for a st a is convergent & lim a = x0 &
  rng a c= dom (f/g) /\ left_open_halfline(x0) holds
  (f/g)*a is convergent & lim((f/g)*a) = lim(((f`|N)/(g`|N)),x0)
   proof
    let a;
    assume A118: a is convergent & lim a = x0 &
               rng a c= dom (f/g) /\ left_open_halfline(x0);
    then consider k such that
    A119: for n st k<=n holds x0-r<a.n & a.n<x0+r by A2,A3,LIMFUNC3:7;
    set a1 = a^\k;
     A120: now let n;
          A121: a1.n = a.(n+k) by SEQM_3:def 9;
              a.(n+k) in rng a by RFUNCT_2:10;
          then a.(n+k) in left_open_halfline(x0) by A118,XBOOLE_0:def 3;
          then a.(n+k) in {g1:g1<x0} by LIMFUNC1:151;
          then ex g1 st a.(n+k)=g1 & g1<x0;
          hence a1.n<x0 by SEQM_3:def 9;
              k<=n+k by NAT_1:12;
          hence x0-r<a1.n by A119,A121;
         end;
        defpred X[Element of NAT,real number] means
        $2 in ].a1.$1,x0.[ & (((f/g)*a)^\k).$1=((f`|N)/(g`|N)).$2;
    A122: for n ex c be real number st X[n,c]
         proof
          let n;
              x0-r<a1.n & a1.n<x0 by A120;
          then consider c such that
          A123: c in ].a1.n,x0.[ & (f/g).(a1.n)=((f`|N)/(g`|N)).c by A75;
          take c;
              dom (f/g) /\ left_open_halfline(x0) c= dom (f/g) by XBOOLE_1:17;
          then A124: rng a c= dom (f/g) by A118,XBOOLE_1:1;
              rng a1 c= rng a by RFUNCT_2:7;
          then rng a1 c= dom (f/g) by A124,XBOOLE_1:1;
          then ((f/g)*(a^\k)).n=((f`|N)/(g`|N)).c by A123,RFUNCT_2:21;
          hence thesis by A123,A124,RFUNCT_2:22;
         end;
    consider b such that
    A125: for n holds X[n,b.n] from RCOMP_1:sch 1(A122);
    reconsider d = NAT --> x0 as Real_Sequence by FUNCOP_1:57;
    A126: d is convergent by SEQ_4:39;
    A127: lim d=d.0 by SEQ_4:41
            .=x0 by FUNCOP_1:13;
    A128: a1 is convergent & lim a1=x0 by A118,SEQ_4:33;
     A129: now
          let n;
              b.n in ].a1.n,x0.[ by A125;
          then b.n in {g1:a1.n<g1 & g1<x0} by RCOMP_1:def 2;
          then ex g1 st g1=b.n & a1.n<g1 & g1<x0; hence a1.n<=b.n & b.n<=
d.n by FUNCOP_1:13;
         end;
    then A130: b is convergent by A126,A127,A128,SEQ_2:33;
    A131: lim b=x0 by A126,A127,A128,A129,SEQ_2:34;
    A132: x0-r<x0 by A2,XREAL_1:46;
    A133: x0<x0+r by A2,REAL_2:174;
    then x0 in {g2: x0-r<g2 & g2<x0+r} by A132;
    then A134: x0 in ].x0-r,x0+r.[ by RCOMP_1:def 2;
    A135: rng b c= dom ((f`|N)/(g`|N)) \{x0}
     proof
      let x be set;
      assume x in rng b;
      then consider n such that A136: x=b.n by RFUNCT_2:9;
      A137: x0-r<a1.n & a1.n<x0 by A120;
      A138: x in ].a1.n,x0.[ by A125,A136;
      then x in {g1:a1.n<g1 & g1<x0} by RCOMP_1:def 2; then A139: ex g1 st
 g1 = x & a1.n<g1 & g1<x0;
      A140: ].a1.n,x0.[ c= [.a1.n,x0.] by RCOMP_1:15;
          a1.n<x0+r by A133,A137,XXREAL_0:2;
      then a1.n in {g3: x0-r<g3 & g3<x0+r} by A137;
      then a1.n in ].x0-r,x0+r.[ by RCOMP_1:def 2;
      then [.a1.n,x0.] c= ].x0-r,x0+r.[ by A134,RCOMP_1:17;
      then ].a1.n,x0.[ c= ].x0-r,x0+r.[ by A140,XBOOLE_1:1;
      then A141: ].a1.n,x0.[ c= dom ((f`|N)/(g`|N)) by A1,A2,XBOOLE_1:1;
          not x in {x0} by A139,TARSKI:def 1;
      hence x in dom ((f`|N)/(g`|N))\{x0} by A138,A141,XBOOLE_0:def 4;
     end;
        dom ((f`|N)/(g`|N)) \{x0} c= dom ((f`|N)/(g`|N)) by XBOOLE_1:36;
    then A142: rng b c= dom ((f`|N)/(g`|N)) by A135,XBOOLE_1:1;
        lim(((f`|N)/(g`|N)),x0)=lim(((f`|N)/(g`|N)),x0);
    then A143: ((f`|N)/(g`|N))*b is convergent &
    lim (((f`|N)/(g`|N))*b) = lim(((f`|N)/(g`|N)),x0)
    by A1,A130,A131,A135,LIMFUNC3:def 4;
    A144: now take m = 0; let n such that m <=n;
             (((f/g)*a)^\k).n=((f`|N)/(g`|N)).(b.n) by A125;
         hence (((f/g)*a)^\k).n = (((f`|N)/(g`|N))*b).n by A142,RFUNCT_2:21;
        end;
    then A145: ((f/g)*a)^\k is convergent by A143,SEQ_4:31;
         lim (((f/g)*a)^\k) = lim(((f`|N)/(g`|N)),x0) by A143,A144,SEQ_4:32;
    hence thesis by A145,SEQ_4:35,36;
   end;
  then A146: f/g is_left_convergent_in x0 & lim_left(f/g,x0)=lim(((f`|N)/(g`|N)
),x0)
      by A46,Th3;
  hence f/g is_convergent_in x0 by A74,LIMFUNC3:34;
  take N;
  thus thesis by A74,A146,LIMFUNC3:34;
 end;

theorem
    (ex N being Neighbourhood of x0 st f is_differentiable_on N &
g is_differentiable_on N & N \ {x0} c= dom (f/g) &
N c= dom ((f`|N)/(g`|N)) & f.x0 = 0 & g.x0 = 0 &
(f`|N)/(g`|N) is_continuous_in x0)
implies f/g is_convergent_in x0 & lim(f/g,x0) = diff(f,x0)/diff(g,x0)
 proof
  given N being Neighbourhood of x0 such that
  A1: f is_differentiable_on N & g is_differentiable_on N &
     N \ {x0} c= dom (f/g) & N c= dom ((f`|N)/(g`|N)) &
     f.x0 = 0 & g.x0 = 0 &
     (f`|N)/(g`|N) is_continuous_in x0;
  consider r be real number such that
  A2: 0<r & N = ].x0-r,x0+r.[ by RCOMP_1:def 7;
  A3: r is Real by XREAL_0:def 1;
  A4: for x st x0<x & x<x0+r ex c st c in ].x0,x.[ & (f/g).x=((f`|N)/(g`|N)).c
   proof
    let x such that
    A5: x0<x & x<x0+r;
    A6: f is_continuous_on N by A1,FDIFF_1:33;
    A7: g is_continuous_on N by A1,FDIFF_1:33;
    A8: x0-r<x0 by A2,XREAL_1:46;
        x0+0<x0+r by A2,XREAL_1:10;
    then x0 in {g1: x0-r<g1 & g1<x0+r} by A8;
    then A9: x0 in ].x0-r,x0+r.[ by RCOMP_1:def 2;
        x0-r<x by A5,A8,XXREAL_0:2;
    then x in {g1: x0-r<g1 & g1<x0+r} by A5;
    then x in ].x0-r,x0+r.[ by RCOMP_1:def 2;
    then A10: [.x0,x.] c= N by A2,A9,RCOMP_1:17;
    then f is_continuous_on [.x0,x.] by A6,FCONT_1:17;
    then A11: (g.x)(#)f is_continuous_on [.x0,x.] by FCONT_1:21;
        g is_continuous_on [.x0,x.] by A7,A10,FCONT_1:17;
    then (f.x)(#)g is_continuous_on [.x0,x.] by FCONT_1:21;
    then A12: (f.x)(#)g - (g.x)(#)f is_continuous_on [.x0,x.] by A11,FCONT_1:19
;
    A13: dom ((g.x)(#)f) = dom f by VALUED_1:7,def 5;
    A14: dom ((f.x)(#)g) = dom g by VALUED_1:7,def 5;
    A15: N c= dom ((g.x)(#)f) by A6,A13,FCONT_1:14;
    A16: N c= dom ((f.x)(#)g) by A7,A14,FCONT_1:14;
    A17: ].x0,x.[ c= [.x0,x.] by RCOMP_1:15;
    then A18: ].x0,x.[ c= N by A10,XBOOLE_1:1;
    then A19: f is_differentiable_on ].x0,x.[ by A1,FDIFF_1:34;
    A20: ].x0,x.[ c= dom ((g.x)(#)f) by A15,A18,XBOOLE_1:1;
    then A21: (g.x)(#)f is_differentiable_on ].x0,x.[ by A19,FDIFF_1:28;
    A22: ].x0,x.[ c= dom ((f.x)(#)g) by A16,A18,XBOOLE_1:1;
    then ].x0,x.[ c= dom ((f.x)(#)g) /\ dom ((g.x)(#)f) by A20,XBOOLE_1:19
;
    then A23: ].x0,x.[ c= dom ((f.x)(#)g - (g.x)(#)f) by VALUED_1:12,13,14,15;
     g is_differentiable_on ].x0,x.[ by A1,A18,FDIFF_1:34;
    then A24: (f.x)(#)g is_differentiable_on ].x0,x.[ by A22,FDIFF_1:28;
    then A25: (f.x)(#)g-(g.x)(#)
f is_differentiable_on ].x0,x.[ by A21,A23,FDIFF_1:27;
    set f1 = (f.x)(#)g - (g.x)(#)f;
    A26: [.x0,x.] c= dom f1 by A12,FCONT_1:def 2;
    A27: x0 in [.x0,x.] & x in [.x0,x.] by A5,RCOMP_1:15;
    then x0 in dom f1 & x in dom f1 by A26;
    then x0 in dom ((f.x)(#)g) /\ dom ((g.x)(#)f) & x in dom ((f.x)(#)g) /\
 dom ((g.x)
(#)f)
     by VALUED_1:12,13,14,15;
    then A28: x0 in dom ((f.x)(#)g) & x0 in dom ((g.x)(#)f) & x in dom ((f.x)
(#)g) &
    x in dom ((g.x)(#)f) by XBOOLE_0:def 3;
    A29: f1.x0 = ((f.x)(#)g).x0 - ((g.x)(#)f).x0 by A26,A27,VALUED_1:12,13,14
,15
         .= (f.x)*(g.x0) - ((g.x)(#)f).x0 by A28,VALUED_1:7,def 5
         .= 0 - (g.x)*0 by A1,A28,VALUED_1:7,def 5
         .= 0;
        f1.x = ((f.x)(#)g).x - ((g.x)(#)f).x by A26,A27,VALUED_1:12,13,14,15
         .= (f.x)*(g.x) - ((g.x)(#)f).x by A28,VALUED_1:7,def 5
         .= (g.x)*(f.x) - (g.x)*(f.x) by A28,VALUED_1:7,def 5
         .= 0;
    then consider t such that
    A30: t in ].x0,x.[ & diff(f1,t)=0 by A5,A12,A25,A29,ROLLE:1;
    take t;
    A31: (f.x)(#)g is_differentiable_in t by A24,A30,FDIFF_1:16;
        (g.x)(#)f is_differentiable_in t by A21,A30,FDIFF_1:16;
    then A32: 0=diff((f.x)(#)g,t) - diff((g.x)(#)f,t) by A30,A31,FDIFF_1:22;
    A33: g is_differentiable_in t by A1,A18,A30,FDIFF_1:16;
        f is_differentiable_in t by A1,A18,A30,FDIFF_1:16;
    then 0=diff((f.x)(#)g,t) - (g.x)*diff(f,t) by A32,FDIFF_1:23;
    then A34: 0=(f.x)*diff(g,t) - (g.x)*diff(f,t) by A33,FDIFF_1:23;
        [.x0,x.]\{x0} c= N\{x0} by A10,XBOOLE_1:33;
    then A35: [.x0,x.]\{x0} c= dom(f/g) by A1,XBOOLE_1:1;
    then A36: [.x0,x.]\{x0} c= dom f /\ (dom g\g"{0}) by RFUNCT_1:def 4;
        dom f /\ (dom g\g"{0}) c= dom g\g"{0} by XBOOLE_1:17;
    then A37: [.x0,x.]\{x0} c= dom g\g"{0} by A36,XBOOLE_1:1;
        not x in {x0} by A5,TARSKI:def 1;
    then A38: x in [.x0,x.]\{x0} by A27,XBOOLE_0:def 4;
    then A39: x in dom g & not x in g"{0} by A37,XBOOLE_0:def 4;
    A40: now assume g.x=0;
         then g.x in {0} by TARSKI:def 1;
         hence contradiction by A39,FUNCT_1:def 13;
        end;
    A41: [.x0,x.] c= dom ((f`|N)/(g`|N)) by A1,A10,XBOOLE_1:1;
    then A42: [.x0,x.] c= dom (f`|N) /\ (dom (g`|N)\(g`|N)"{0}) by
RFUNCT_1:def 4;
        dom (f`|N) /\ (dom (g`|N) \ (g`|N)"{0}) c= dom (g`|N)\(g`|N)"{0}
     by XBOOLE_1:17;
    then A43: [.x0,x.] c= dom (g`|N)\(g`|N)"{0} by A42,XBOOLE_1:1;
    A44: t in [.x0,x.] by A17,A30;
    then A45: t in dom (g`|N) & not t in (g`|N)"{0} by A43,XBOOLE_0:def 4;
         now assume diff(g,t)=0;
         then (g`|N).t=0 by A1,A10,A44,FDIFF_1:def 8;
         then (g`|N).t in {0} by TARSKI:def 1;
         hence contradiction by A45,FUNCT_1:def 13;
        end;
    then (f.x)/(g.x) = diff(f,t)/diff(g,t) by A34,A40,XCMPLX_1:95;
    then (f.x)*(g.x)" = diff(f,t)/diff(g,t) by XCMPLX_0:def 9;
    then (f.x)*(g.x)" = diff(f,t)*diff(g,t)" by XCMPLX_0:def 9;
    then (f/g).x = diff(f,t)*diff(g,t)" by A35,A38,RFUNCT_1:def 4;
    then (f/g).x = ((f`|N).t)*diff(g,t)" by A1,A10,A44,FDIFF_1:def 8;
    then (f/g).x = ((f`|N).t)*((g`|N).t)" by A1,A10,A44,FDIFF_1:def 8;
    hence thesis by A30,A41,A44,RFUNCT_1:def 4;
   end;
      for r1,r2 st r1<x0 & x0<r2
  ex g1,g2 st r1<g1 & g1<x0 & g1 in dom (f/g) & g2<r2 &
    x0<g2 & g2 in dom (f/g) by A1,Th4;
  then A46: (for r1 st x0<r1 ex t st t<r1 & x0<t & t in dom (f/g)) &
       for r1 st r1<x0 ex t st r1<t & t<x0 & t in dom (f/g) by LIMFUNC3:8;
      for a st a is convergent & lim a = x0 &
  rng a c= dom (f/g) /\ right_open_halfline(x0) holds
  (f/g)*a is convergent & lim((f/g)*a) = diff(f,x0)/diff(g,x0)
   proof
    let a;
    assume A47: a is convergent & lim a = x0 &
               rng a c= dom (f/g) /\ right_open_halfline(x0);
    then consider k such that
    A48: for n st k<=n holds x0-r<a.n & a.n<x0+r by A2,A3,LIMFUNC3:7;
    set a1 = a^\k;
     A49: now let n;
          A50: a1.n = a.(n+k) by SEQM_3:def 9;
              a.(n+k) in rng a by RFUNCT_2:10;
          then a.(n+k) in right_open_halfline(x0) by A47,XBOOLE_0:def 3;
          then a.(n+k) in {g1:x0<g1} by LIMFUNC1:152;
          then ex g1 st a.(n+k)=g1 & x0<g1;
          hence x0<a1.n by SEQM_3:def 9;
              k<=n+k by NAT_1:12;
          hence a1.n<x0+r by A48,A50;
         end;
        defpred X[Element of NAT,real number] means
         $2 in ].x0,a1.$1.[ & (((f/g)*a)^\k).$1=((f`|N)/(g`|N)).$2;
    A51: for n ex c be real number st X[n,c]
         proof
          let n;
              x0<a1.n & a1.n<x0+r by A49;
          then consider c such that
          A52: c in ].x0,a1.n.[ & (f/g).(a1.n)=((f`|N)/(g`|N)).c by A4;
          take c;
              dom (f/g) /\ right_open_halfline(x0) c= dom (f/g) by XBOOLE_1:17
;
          then A53: rng a c= dom (f/g) by A47,XBOOLE_1:1;
              rng a1 c= rng a by RFUNCT_2:7;
          then rng a1 c= dom (f/g) by A53,XBOOLE_1:1;
          then ((f/g)*(a^\k)).n=((f`|N)/(g`|N)).c by A52,RFUNCT_2:21;
          hence thesis by A52,A53,RFUNCT_2:22;
         end;
    consider b such that
    A54: for n holds X[n,b.n] from RCOMP_1:sch 1(A51);
    reconsider d = NAT --> x0 as Real_Sequence by FUNCOP_1:57;
    A55: d is convergent by SEQ_4:39;
    A56: lim d=d.0 by SEQ_4:41
            .=x0 by FUNCOP_1:13;
    A57: a1 is convergent & lim a1=x0 by A47,SEQ_4:33;
     A58: now
          let n;
              b.n in ].x0,a1.n.[ by A54;
          then b.n in {g1:x0<g1 & g1<a1.n} by RCOMP_1:def 2;
          then ex g1 st g1=b.n & x0<g1 & g1<a1.n; hence d.n<=b.n & b.n<=a1.n
by FUNCOP_1:13;
         end;
    then A59: b is convergent by A55,A56,A57,SEQ_2:33;
    A60: lim b=x0 by A55,A56,A57,A58,SEQ_2:34;
    A61: x0-r<x0 by A2,XREAL_1:46;
        x0<x0+r by A2,REAL_2:174;
    then x0 in {g2: x0-r<g2 & g2<x0+r} by A61;
    then A62: x0 in ].x0-r,x0+r.[ by RCOMP_1:def 2;
    A63: rng b c= dom ((f`|N)/(g`|N)) /\ right_open_halfline(x0)
     proof
      let x be set;
      assume x in rng b;
      then consider n such that A64: x=b.n by RFUNCT_2:9;
      A65: x0<a1.n & a1.n<x0+r by A49;
      A66: x in ].x0,a1.n.[ by A54,A64;
      then x in {g1:x0<g1 & g1<a1.n} by RCOMP_1:def 2;
      then ex g1 st g1=x & x0<g1 & g1<a1.n;
      then x in {g2:x0<g2};
      then A67: x in right_open_halfline(x0) by LIMFUNC1:152;
       A68: ].x0,a1.n.[ c= [.x0,a1.n.] by RCOMP_1:15;
          x0-r<a1.n by A61,A65,XXREAL_0:2;
      then a1.n in {g3: x0-r<g3 & g3<x0+r} by A65;
      then a1.n in ].x0-r,x0+r.[ by RCOMP_1:def 2;
      then [.x0,a1.n.] c= ].x0-r,x0+r.[ by A62,RCOMP_1:17;
      then ].x0,a1.n.[ c= ].x0-r,x0+r.[ by A68,XBOOLE_1:1;
      then ].x0,a1.n.[ c= dom ((f`|N)/(g`|N)) by A1,A2,XBOOLE_1:1;
hence x in dom ((f`|N)/(g`|N)) /\
right_open_halfline(x0) by A66,A67,XBOOLE_0:def 3;
     end;
        dom ((f`|N)/(g`|N)) /\ right_open_halfline(x0) c= dom ((f`|N)/(g`|N))
    by XBOOLE_1:17;
    then A69: rng b c= dom ((f`|N)/(g`|N)) by A63,XBOOLE_1:1;
     then ((f`|N)/(g`|N))*b is convergent &
    lim (((f`|N)/(g`|N))*b) = ((f`|N)/(g`|N)).x0
    by A1,A59,A60,FCONT_1:def 1;
    then lim (((f`|N)/(g`|N))*b) = ((f`|N).x0)*((g`|N).x0)" by A1,A2,A62,
RFUNCT_1:def 4
                           .= diff(f,x0)*((g`|N).x0)" by A1,A2,A62,
FDIFF_1:def 8
                           .= diff(f,x0)*diff(g,x0)" by A1,A2,A62,FDIFF_1:def 8
;
    then A70: ((f`|N)/(g`|N))*b is convergent &
        lim (((f`|N)/(g`|N))*b) = diff(f,x0)*diff(g,x0)" by A1,A59,A60,A69,
FCONT_1:def 1;
    A71: now take m = 0; let n such that m <=n;
             (((f/g)*a)^\k).n=((f`|N)/(g`|N)).(b.n) by A54;
         hence (((f/g)*a)^\k).n = (((f`|N)/(g`|N))*b).n by A69,RFUNCT_2:21;
        end;
    then A72: ((f/g)*a)^\k is convergent by A70,SEQ_4:31;
         lim (((f/g)*a)^\k) = diff(f,x0)*diff(g,x0)" by A70,A71,SEQ_4:32;
    then lim(((f/g)*a)^\k) = diff(f,x0)/diff(g,x0) by XCMPLX_0:def 9;
    hence thesis by A72,SEQ_4:35,36;
   end;
  then A73: f/g is_right_convergent_in x0 & lim_right(f/g,x0)=diff(f,x0)/diff(g
,x0)
      by A46,Th2;
  A74: for x st x0-r<x & x<x0 ex c st c in ].x,x0.[ & (f/g).x=((f`|N)/(g`|N)).c
   proof
    let x such that
    A75: x0-r<x & x<x0;
    A76: f is_continuous_on N by A1,FDIFF_1:33;
    A77: g is_continuous_on N by A1,FDIFF_1:33;
    A78: x0-r<x0 by A2,XREAL_1:46;
    A79: x0+0<x0+r by A2,XREAL_1:10;
    then x0 in {g1: x0-r<g1 & g1<x0+r} by A78;
    then A80: x0 in ].x0-r,x0+r.[ by RCOMP_1:def 2;
        x<x0+r by A75,A79,XXREAL_0:2;
    then x in {g1: x0-r<g1 & g1<x0+r} by A75;
    then x in ].x0-r,x0+r.[ by RCOMP_1:def 2;
    then A81: [.x,x0.] c= N by A2,A80,RCOMP_1:17;
    then f is_continuous_on [.x,x0.] by A76,FCONT_1:17;
    then A82: (g.x)(#)f is_continuous_on [.x,x0.] by FCONT_1:21;
        g is_continuous_on [.x,x0.] by A77,A81,FCONT_1:17;
    then (f.x)(#)g is_continuous_on [.x,x0.] by FCONT_1:21;
    then A83: (f.x)(#)g - (g.x)(#)f is_continuous_on [.x,x0.] by A82,FCONT_1:19
;
    A84: dom ((g.x)(#)f) = dom f by VALUED_1:7,def 5;
    A85: dom ((f.x)(#)g) = dom g by VALUED_1:7,def 5;
    A86: N c= dom ((g.x)(#)f) by A76,A84,FCONT_1:14;
    A87: N c= dom ((f.x)(#)g) by A77,A85,FCONT_1:14;
    A88: ].x,x0.[ c= [.x,x0.] by RCOMP_1:15;
    then A89: ].x,x0.[ c= N by A81,XBOOLE_1:1;
    then A90: f is_differentiable_on ].x,x0.[ by A1,FDIFF_1:34;
    A91: ].x,x0.[ c= dom ((g.x)(#)f) by A86,A89,XBOOLE_1:1;
    then A92: (g.x)(#)f is_differentiable_on ].x,x0.[ by A90,FDIFF_1:28;
    A93: ].x,x0.[ c= dom ((f.x)(#)g) by A87,A89,XBOOLE_1:1;
    then ].x,x0.[ c= dom ((f.x)(#)g) /\ dom ((g.x)(#)f) by A91,XBOOLE_1:19
;
    then A94: ].x,x0.[ c= dom ((f.x)(#)g - (g.x)(#)f) by VALUED_1:12,13,14,15;
     g is_differentiable_on ].x,x0.[ by A1,A89,FDIFF_1:34;
    then A95: (f.x)(#)g is_differentiable_on ].x,x0.[ by A93,FDIFF_1:28;
    then A96: (f.x)(#)g-(g.x)(#)
f is_differentiable_on ].x,x0.[ by A92,A94,FDIFF_1:27
;
    set f1 = (f.x)(#)g - (g.x)(#)f;
    A97: [.x,x0.] c= dom f1 by A83,FCONT_1:def 2;
    A98: x0 in [.x,x0.] & x in [.x,x0.] by A75,RCOMP_1:15;
    then x0 in dom f1 & x in dom f1 by A97;
    then x0 in dom ((f.x)(#)g) /\ dom ((g.x)(#)f) & x in dom ((f.x)(#)g) /\
 dom ((g.x)
(#)f)
     by VALUED_1:12,13,14,15;
    then A99: x0 in dom ((f.x)(#)g) & x0 in dom ((g.x)(#)f) & x in dom ((f.x)
(#)
g) &
    x in dom ((g.x)(#)f) by XBOOLE_0:def 3;
    A100: f1.x0 = ((f.x)(#)g).x0 - ((g.x)(#)f).x0 by A97,A98,VALUED_1:12,13,14
,15
         .= (f.x)*(g.x0) - ((g.x)(#)f).x0 by A99,VALUED_1:7,def 5
         .= 0 - (g.x)*0 by A1,A99,VALUED_1:7,def 5
         .= 0;
        f1.x = ((f.x)(#)g).x - ((g.x)(#)f).x by A97,A98,VALUED_1:12,13,14,15
         .= (f.x)*(g.x) - ((g.x)(#)f).x by A99,VALUED_1:7,def 5
         .= (g.x)*(f.x) - (g.x)*(f.x) by A99,VALUED_1:7,def 5
         .= 0;
    then consider t such that
    A101: t in ].x,x0.[ & diff(f1,t)=0 by A75,A83,A96,A100,ROLLE:1;
    take t;
    A102: (f.x)(#)g is_differentiable_in t by A95,A101,FDIFF_1:16;
        (g.x)(#)f is_differentiable_in t by A92,A101,FDIFF_1:16;
    then A103: 0=diff((f.x)(#)g,t) - diff((g.x)(#)f,t) by A101,A102,FDIFF_1:22;
    A104: g is_differentiable_in t by A1,A89,A101,FDIFF_1:16;
        f is_differentiable_in t by A1,A89,A101,FDIFF_1:16;
    then 0=diff((f.x)(#)g,t) - (g.x)*diff(f,t) by A103,FDIFF_1:23;
    then A105: 0=(f.x)*diff(g,t) - (g.x)*diff(f,t) by A104,FDIFF_1:23;
        [.x,x0.]\{x0} c= N\{x0} by A81,XBOOLE_1:33;
    then A106: [.x,x0.]\{x0} c= dom(f/g) by A1,XBOOLE_1:1;
    then A107: [.x,x0.]\{x0} c= dom f /\ (dom g\g"{0}) by RFUNCT_1:def 4;
        dom f /\ (dom g\g"{0}) c= dom g\g"{0} by XBOOLE_1:17;
    then A108: [.x,x0.]\{x0} c= dom g\g"{0} by A107,XBOOLE_1:1;
        not x in {x0} by A75,TARSKI:def 1;
    then A109: x in [.x,x0.]\{x0} by A98,XBOOLE_0:def 4;
    then A110: x in dom g & not x in g"{0} by A108,XBOOLE_0:def 4;
    A111: now assume g.x=0;
         then g.x in {0} by TARSKI:def 1;
         hence contradiction by A110,FUNCT_1:def 13;
        end;
    A112: [.x,x0.] c= dom ((f`|N)/(g`|N)) by A1,A81,XBOOLE_1:1;
    then A113: [.x,x0.] c= dom (f`|N) /\ (dom (g`|N)\(g`|N)"{0}) by
RFUNCT_1:def 4;
        dom (f`|N) /\ (dom (g`|N) \ (g`|N)"{0}) c= dom (g`|N)\(g`|N)"{0}
     by XBOOLE_1:17;
    then A114: [.x,x0.] c= dom (g`|N)\(g`|N)"{0} by A113,XBOOLE_1:1;
    A115: t in [.x,x0.] by A88,A101;
    then A116: t in dom (g`|N) & not t in (g`|N)"{0} by A114,XBOOLE_0:def 4;
         now assume diff(g,t)=0;
         then (g`|N).t=0 by A1,A81,A115,FDIFF_1:def 8;
         then (g`|N).t in {0} by TARSKI:def 1;
         hence contradiction by A116,FUNCT_1:def 13;
        end;
    then (f.x)/(g.x) = diff(f,t)/diff(g,t) by A105,A111,XCMPLX_1:95;
    then (f.x)*(g.x)" = diff(f,t)/diff(g,t) by XCMPLX_0:def 9;
    then (f.x)*(g.x)" = diff(f,t)*diff(g,t)" by XCMPLX_0:def 9;
    then (f/g).x = diff(f,t)*diff(g,t)" by A106,A109,RFUNCT_1:def 4;
    then (f/g).x = ((f`|N).t)*diff(g,t)" by A1,A81,A115,FDIFF_1:def 8;
    then (f/g).x = ((f`|N).t)*((g`|N).t)" by A1,A81,A115,FDIFF_1:def 8;
    hence thesis by A101,A112,A115,RFUNCT_1:def 4;
   end;
      for a st a is convergent & lim a = x0 &
  rng a c= dom (f/g) /\ left_open_halfline(x0) holds
  (f/g)*a is convergent & lim((f/g)*a) = diff(f,x0)/diff(g,x0)
   proof
    let a;
    assume A117: a is convergent & lim a = x0 &
               rng a c= dom (f/g) /\ left_open_halfline(x0);
    then consider k such that
    A118: for n st k<=n holds x0-r<a.n & a.n<x0+r by A2,A3,LIMFUNC3:7;
    set a1 = a^\k;
     A119: now let n;
          A120: a1.n = a.(n+k) by SEQM_3:def 9;
              a.(n+k) in rng a by RFUNCT_2:10;
          then a.(n+k) in left_open_halfline(x0) by A117,XBOOLE_0:def 3;
          then a.(n+k) in {g1:g1<x0} by LIMFUNC1:151;
          then ex g1 st a.(n+k)=g1 & g1<x0;
          hence a1.n<x0 by SEQM_3:def 9;
              k<=n+k by NAT_1:12;
          hence x0-r<a1.n by A118,A120;
         end;
        defpred X[Element of NAT,real number] means
          $2 in ].a1.$1,x0.[ & (((f/g)*a)^\k).$1=((f`|N)/(g`|N)).$2;
    A121: for n ex c be real number st X[n,c]
         proof
          let n;
              x0-r<a1.n & a1.n<x0 by A119;
          then consider c such that
          A122: c in ].a1.n,x0.[ & (f/g).(a1.n)=((f`|N)/(g`|N)).c by A74;
          take c;
              dom (f/g) /\ left_open_halfline(x0) c= dom (f/g) by XBOOLE_1:17;
          then A123: rng a c= dom (f/g) by A117,XBOOLE_1:1;
              rng a1 c= rng a by RFUNCT_2:7;
          then rng a1 c= dom (f/g) by A123,XBOOLE_1:1;
          then ((f/g)*(a^\k)).n=((f`|N)/(g`|N)).c by A122,RFUNCT_2:21;
          hence thesis by A122,A123,RFUNCT_2:22;
         end;
    consider b such that
    A124: for n holds X[n,b.n] from RCOMP_1:sch 1(A121);
    reconsider d = NAT --> x0 as Real_Sequence by FUNCOP_1:57;
    A125: d is convergent by SEQ_4:39;
    A126: lim d=d.0 by SEQ_4:41
            .=x0 by FUNCOP_1:13;
    A127: a1 is convergent & lim a1=x0 by A117,SEQ_4:33;
     A128: now
          let n;
              b.n in ].a1.n,x0.[ by A124;
          then b.n in {g1:a1.n<g1 & g1<x0} by RCOMP_1:def 2;
          then ex g1 st g1=b.n & a1.n<g1 & g1<x0; hence a1.n<=b.n & b.n<=
d.n by FUNCOP_1:13;
         end;
    then A129: b is convergent by A125,A126,A127,SEQ_2:33;
    A130: lim b=x0 by A125,A126,A127,A128,SEQ_2:34;
    A131: x0-r<x0 by A2,XREAL_1:46;
    A132: x0<x0+r by A2,REAL_2:174;
    then x0 in {g2: x0-r<g2 & g2<x0+r} by A131;
    then A133: x0 in ].x0-r,x0+r.[ by RCOMP_1:def 2;
    A134: rng b c= dom ((f`|N)/(g`|N)) /\ left_open_halfline(x0)
     proof
      let x be set;
      assume x in rng b;
      then consider n such that A135: x=b.n by RFUNCT_2:9;
      A136: x0-r<a1.n & a1.n<x0 by A119;
      A137: x in ].a1.n,x0.[ by A124,A135;
      then x in {g1:a1.n<g1 & g1<x0} by RCOMP_1:def 2;
      then ex g1 st g1=x & a1.n<g1 & g1<x0;
      then x in {g2:g2<x0};
      then A138: x in left_open_halfline(x0) by LIMFUNC1:151;
       A139: ].a1.n,x0.[ c= [.a1.n,x0.] by RCOMP_1:15;
          a1.n<x0+r by A132,A136,XXREAL_0:2;
      then a1.n in {g3: x0-r<g3 & g3<x0+r} by A136;
      then a1.n in ].x0-r,x0+r.[ by RCOMP_1:def 2;
      then [.a1.n,x0.] c= ].x0-r,x0+r.[ by A133,RCOMP_1:17;
      then ].a1.n,x0.[ c= ].x0-r,x0+r.[ by A139,XBOOLE_1:1;
      then ].a1.n,x0.[ c= dom ((f`|N)/(g`|N)) by A1,A2,XBOOLE_1:1;
hence x in dom ((f`|N)/(g`|N)) /\
left_open_halfline(x0) by A137,A138,XBOOLE_0:def 3;
     end;
        dom ((f`|N)/(g`|N)) /\ left_open_halfline(x0) c= dom ((f`|N)/(g`|N))
    by XBOOLE_1:17;
    then A140: rng b c= dom ((f`|N)/(g`|N)) by A134,XBOOLE_1:1;
     then ((f`|N)/(g`|N))*b is convergent &
    lim (((f`|N)/(g`|N))*b) = ((f`|N)/(g`|N)).x0
    by A1,A129,A130,FCONT_1:def 1;
    then lim (((f`|N)/(g`|N))*b) = ((f`|N).x0)*((g`|N).x0)" by A1,A2,A133,
RFUNCT_1:def 4
                           .= diff(f,x0)*((g`|N).x0)" by A1,A2,A133,
FDIFF_1:def 8
                           .= diff(f,x0)*diff(g,x0)" by A1,A2,A133,
FDIFF_1:def 8;
    then A141: ((f`|N)/(g`|N))*b is convergent &
        lim (((f`|N)/(g`|N))*b) = diff(f,x0)*diff(g,x0)" by A1,A129,A130,A140,
FCONT_1:def 1;
    A142: now take m = 0; let n such that m <=n;
             (((f/g)*a)^\k).n=((f`|N)/(g`|N)).(b.n) by A124;
         hence (((f/g)*a)^\k).n = (((f`|N)/(g`|N))*b).n by A140,RFUNCT_2:21;
        end;
    then A143: ((f/g)*a)^\k is convergent by A141,SEQ_4:31;
         lim (((f/g)*a)^\k) = diff(f,x0)*diff(g,x0)" by A141,A142,SEQ_4:32;
    then lim(((f/g)*a)^\k) = diff(f,x0)/diff(g,x0) by XCMPLX_0:def 9;
    hence thesis by A143,SEQ_4:35,36;
   end;
  then f/g is_left_convergent_in x0 & lim_left(f/g,x0)=diff(f,x0)/diff(g,x0)
      by A46,Th3;
  hence thesis by A73,LIMFUNC3:34;
 end;
