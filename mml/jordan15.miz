:: Properties of the Upper and Lower Sequence on the Cage
::  by Robert Milewski
::
:: Received August 1, 2002
:: Copyright (c) 2002 Association of Mizar Users
 
environ

 vocabularies NUMBERS, SUBSET_1, EUCLID, XBOOLE_0, RELAT_1, PRE_TOPC, MCART_1,
      FUNCT_1, XREAL_0, ORDINAL1, TARSKI, JORDAN6, REAL_1, RCOMP_1, JORDAN2C,
      GOBOARD1, XXREAL_0, FINSEQ_1, TREES_1, RLTOPSP1, SPPOL_1, JORDAN1A,
      RELAT_2, JORDAN8, TOPREAL1, JORDAN1E, MATRIX_1, SEQ_4, PSCOMP_1,
      XXREAL_2, ORDINAL2, TOPREAL2, ARYTM_3, CARD_1, JORDAN9, JORDAN3,
      PARTFUN1, GOBOARD5, ARYTM_1, FINSEQ_4, GRAPH_2, FINSEQ_6, ZFMISC_1,
      GOBOARD9, GOBOARD2, FINSEQ_5, SPRECT_2, GROUP_2, NAT_1, CONNSP_1;
 notations TARSKI, XBOOLE_0, ENUMSET1, SUBSET_1, ORDINAL1, NUMBERS, XXREAL_0,
      XREAL_0, REAL_1, NAT_1, NAT_D, FUNCT_1, RELSET_1, PARTFUN1, FINSEQ_1,
      FINSEQ_4, FINSEQ_5, XXREAL_2, SEQ_4, MATRIX_1, REALSET1, FINSEQ_6,
      GRAPH_2, STRUCT_0, PRE_TOPC, RCOMP_1, TOPREAL2, CONNSP_1, COMPTS_1,
      RLTOPSP1, EUCLID, MEASURE6, PSCOMP_1, SPRECT_2, GOBOARD1, TOPREAL1,
      GOBOARD2, GOBOARD5, GOBOARD9, GOBRD13, SPPOL_1, JORDAN3, JORDAN8,
      JORDAN2C, JORDAN6, JORDAN9, JORDAN1A, JORDAN1E;
 constructors PARTFUN1, REAL_1, NAT_1, RCOMP_1, FINSEQ_4, NEWTON, BINARITH,
      CONNSP_1, REALSET2, GOBOARD2, JORDAN1, PSCOMP_1, GRAPH_2, GOBOARD9,
      JORDAN3, JORDAN5C, JORDAN6, JORDAN2C, JORDAN8, GOBRD13, JORDAN9,
      JORDAN1A, JORDAN1E, SEQ_1, XXREAL_2, NAT_D, SEQ_4, RELSET_1, CONVEX1,
      MEASURE6;
 registrations XBOOLE_0, RELSET_1, NUMBERS, XXREAL_0, NAT_1, MEMBERED,
      FINSEQ_1, FINSEQ_6, STRUCT_0, COMPTS_1, TOPREAL1, TOPREAL2, GOBOARD2,
      JORDAN1, SPPOL_2, PSCOMP_1, GOBRD11, TOPREAL5, SPRECT_1, SPRECT_2,
      REVROT_1, TOPREAL6, JORDAN8, JORDAN1E, JORDAN1J, FUNCT_1, EUCLID,
      RLTOPSP1, MEASURE6;
 requirements NUMERALS, BOOLE, SUBSET, REAL, ARITHM;
 definitions TARSKI, XBOOLE_0, PSCOMP_1, MEASURE6;
 theorems NAT_1, FINSEQ_1, GOBOARD1, FINSEQ_4, EUCLID, FINSEQ_3, SPPOL_2,
      TARSKI, JORDAN3, PSCOMP_1, FINSEQ_5, FINSEQ_6, GOBOARD7, TOPREAL1,
      GOBOARD5, SPRECT_2, SPPOL_1, FUNCT_2, GOBOARD9, FINSEQ_2, SUBSET_1,
      JORDAN4, SPRECT_3, TOPREAL3, JORDAN8, PARTFUN2, SPRECT_1, XBOOLE_0,
      XBOOLE_1, ZFMISC_1, SEQ_4, GOBRD14, TOPREAL6, JORDAN2C, PRE_TOPC,
      JORDAN6, JORDAN9, JORDAN1H, JORDAN1A, JORDAN1C, JORDAN1E, JORDAN10,
      JGRAPH_1, REVROT_1, RCOMP_1, COMPTS_1, ENUMSET1, JORDAN1B, JORDAN1F,
      JORDAN1G, JORDAN1I, JORDAN1J, GOBOARD3, TOPREAL8, GRAPH_2, SPRECT_5,
      JORDAN1D, REALSET1, XREAL_1, XXREAL_0, JCT_MISC, PARTFUN1, MATRIX_1,
      XXREAL_2, NAT_D, XREAL_0, RLTOPSP1;

begin

reserve n for Element of NAT;

theorem
  for A,B be Subset of TOP-REAL 2 st A meets B holds proj1.:A meets proj1.:B
proof
  let A,B be Subset of TOP-REAL 2;
  assume A meets B;
  then consider e be set such that
A1: e in A and
A2: e in B by XBOOLE_0:3;
  reconsider e as Point of TOP-REAL 2 by A1;
A3: e`1 = proj1.e by PSCOMP_1:def 28;
  then
A4: e`1 in proj1.:B by A2,FUNCT_2:43;
  e`1 in proj1.:A by A1,A3,FUNCT_2:43;
  hence thesis by A4,XBOOLE_0:3;
end;

theorem
  for A,B be Subset of TOP-REAL 2 for s be real number st A misses B & A
  c= Horizontal_Line s & B c= Horizontal_Line s holds proj1.:A misses proj1.:B
proof
  let A,B be Subset of TOP-REAL 2;
  let s be real number such that
A1: A misses B and
A2: A c= Horizontal_Line s and
A3: B c= Horizontal_Line s;
  assume proj1.:A meets proj1.:B;
  then consider e be set such that
A4: e in proj1.:A and
A5: e in proj1.:B by XBOOLE_0:3;
  reconsider e as Real by A4;
  consider d be Point of TOP-REAL 2 such that
A6: d in B and
A7: e = proj1.d by A5,FUNCT_2:116;
A8: d`2 = s by A3,A6,JORDAN6:35;
  consider c being Point of TOP-REAL 2 such that
A9: c in A and
A10: e = proj1.c by A4,FUNCT_2:116;
  c`2 = s by A2,A9,JORDAN6:35;
  then c = |[c`1,d`2]| by A8,EUCLID:57
    .= |[e,d`2]| by A10,PSCOMP_1:def 28
    .= |[d`1,d`2]| by A7,PSCOMP_1:def 28
    .= d by EUCLID:57;
  hence contradiction by A1,A9,A6,XBOOLE_0:3;
end;

theorem Th3:
  for S be closed Subset of TOP-REAL 2 st S is Bounded holds proj1
  .:S is closed
proof
  let S be closed Subset of TOP-REAL 2;
  assume S is Bounded;
  then Cl(proj1.:S) = proj1.:Cl S by TOPREAL6:92
    .= proj1.:S by PRE_TOPC:52;
  hence thesis;
end;

theorem Th4:
  for S be compact Subset of TOP-REAL 2 holds proj1.:S is compact
proof
  let S being compact Subset of TOP-REAL 2;
A1: S is Bounded closed by JORDAN2C:73;
  then proj1.:S is closed by Th3;
  hence thesis by A1,JORDAN1C:4,RCOMP_1:29;
end;

canceled 2;

theorem Th7:
  for G be Go-board for i,j,k,j1,k1 be Element of NAT st 1 <= i & i
<= len G & 1 <= j & j <= j1 & j1 <= k1 & k1 <= k & k <= width G holds LSeg(G*(i
  ,j1),G*(i,k1)) c= LSeg(G*(i,j),G*(i,k))
proof
  let G be Go-board;
  let i,j,k,j1,k1 be Element of NAT;
  assume that
A1: 1 <= i and
A2: i <= len G and
A3: 1 <= j and
A4: j <= j1 and
A5: j1 <= k1 and
A6: k1 <= k and
A7: k <= width G;
A8: j1 <= k by A5,A6,XXREAL_0:2;
  j <= k1 by A4,A5,XXREAL_0:2;
  then
A9: 1 <= k1 by A3,XXREAL_0:2;
  then
A10: G*(i,k1)`2 <= G*(i,k)`2 by A1,A2,A6,A7,SPRECT_3:24;
A11: 1 <= j1 by A3,A4,XXREAL_0:2;
  1 <= j1 by A3,A4,XXREAL_0:2;
  then
A12: 1 <= k by A8,XXREAL_0:2;
A13: k1 <= width G by A6,A7,XXREAL_0:2;
  j <= k1 by A4,A5,XXREAL_0:2;
  then
A14: j <= width G by A13,XXREAL_0:2;
  then G*(i,j)`1 = G*(i,1)`1 by A1,A2,A3,GOBOARD5:3
    .= G*(i,k)`1 by A1,A2,A7,A12,GOBOARD5:3;
  then
A15: LSeg(G*(i,j),G*(i,k)) is vertical by SPPOL_1:37;
  j1 <= k by A5,A6,XXREAL_0:2;
  then
A16: j1 <= width G by A7,XXREAL_0:2;
  then
A17: G*(i,j)`2 <= G*(i,j1)`2 by A1,A2,A3,A4,SPRECT_3:24;
A18: k1 <= width G by A6,A7,XXREAL_0:2;
  then
A19: G*(i,j1)`2 <= G*(i,k1)`2 by A1,A2,A5,A11,SPRECT_3:24;
  G*(i,j1)`1 = G*(i,1)`1 by A1,A2,A11,A16,GOBOARD5:3
    .= G*(i,k1)`1 by A1,A2,A9,A18,GOBOARD5:3;
  then
A20: LSeg(G*(i,j1),G*(i,k1)) is vertical by SPPOL_1:37;
  G*(i,j)`1 = G*(i,1)`1 by A1,A2,A3,A14,GOBOARD5:3
    .= G*(i,j1)`1 by A1,A2,A11,A16,GOBOARD5:3;
  hence thesis by A15,A20,A17,A19,A10,GOBOARD7:65;
end;

theorem Th8:
  for G be Go-board for i,j,k,j1,k1 be Element of NAT st 1 <= i & i
<= width G & 1 <= j & j <= j1 & j1 <= k1 & k1 <= k & k <= len G holds LSeg(G*(
  j1,i),G*(k1,i)) c= LSeg(G*(j,i),G*(k,i))
proof
  let G be Go-board;
  let i,j,k,j1,k1 be Element of NAT;
  assume that
A1: 1 <= i and
A2: i <= width G and
A3: 1 <= j and
A4: j <= j1 and
A5: j1 <= k1 and
A6: k1 <= k and
A7: k <= len G;
A8: j1 <= k by A5,A6,XXREAL_0:2;
  j <= k1 by A4,A5,XXREAL_0:2;
  then
A9: 1 <= k1 by A3,XXREAL_0:2;
  then
A10: G*(k1,i)`1 <= G*(k,i)`1 by A1,A2,A6,A7,SPRECT_3:25;
A11: 1 <= j1 by A3,A4,XXREAL_0:2;
  1 <= j1 by A3,A4,XXREAL_0:2;
  then
A12: 1 <= k by A8,XXREAL_0:2;
A13: k1 <= len G by A6,A7,XXREAL_0:2;
  j <= k1 by A4,A5,XXREAL_0:2;
  then
A14: j <= len G by A13,XXREAL_0:2;
  then G*(j,i)`2 = G*(1,i)`2 by A1,A2,A3,GOBOARD5:2
    .= G*(k,i)`2 by A1,A2,A7,A12,GOBOARD5:2;
  then
A15: LSeg(G*(j,i),G*(k,i)) is horizontal by SPPOL_1:36;
  j1 <= k by A5,A6,XXREAL_0:2;
  then
A16: j1 <= len G by A7,XXREAL_0:2;
  then
A17: G*(j,i)`1 <= G*(j1,i)`1 by A1,A2,A3,A4,SPRECT_3:25;
A18: k1 <= len G by A6,A7,XXREAL_0:2;
  then
A19: G*(j1,i)`1 <= G*(k1,i)`1 by A1,A2,A5,A11,SPRECT_3:25;
  G*(j1,i)`2 = G*(1,i)`2 by A1,A2,A11,A16,GOBOARD5:2
    .= G*(k1,i)`2 by A1,A2,A9,A18,GOBOARD5:2;
  then
A20: LSeg(G*(j1,i),G*(k1,i)) is horizontal by SPPOL_1:36;
  G*(j,i)`2 = G*(1,i)`2 by A1,A2,A3,A14,GOBOARD5:2
    .= G*(j1,i)`2 by A1,A2,A11,A16,GOBOARD5:2;
  hence thesis by A15,A20,A17,A19,A10,GOBOARD7:66;
end;

theorem
  for G be Go-board for j,k,j1,k1 be Element of NAT st 1 <= j & j <= j1
& j1 <= k1 & k1 <= k & k <= width G holds LSeg(G*(Center G,j1),G*(Center G,k1))
  c= LSeg(G*(Center G,j),G*(Center G,k))
proof
  let G be Go-board;
  let j,k,j1,k1 be Element of NAT;
  assume that
A1: 1 <= j and
A2: j <= j1 and
A3: j1 <= k1 and
A4: k1 <= k and
A5: k <= width G;
A6: Center G <= len G by JORDAN1B:14;
  1 <= Center G by JORDAN1B:12;
  hence thesis by A1,A2,A3,A4,A5,A6,Th7;
end;

theorem
  for G be Go-board st len G = width G for j,k,j1,k1 be Element of NAT
st 1 <= j & j <= j1 & j1 <= k1 & k1 <= k & k <= len G holds LSeg(G*(j1,Center G
  ),G*(k1,Center G)) c= LSeg(G*(j,Center G),G*(k,Center G))
proof
  let G be Go-board;
  assume len G = width G;
  then
A1: Center G <= width G by JORDAN1B:14;
  let j,k,j1,k1 be Element of NAT;
  assume that
A2: 1 <= j and
A3: j <= j1 and
A4: j1 <= k1 and
A5: k1 <= k and
A6: k <= len G;
  1 <= Center G by JORDAN1B:12;
  hence thesis by A2,A3,A4,A5,A6,A1,Th8;
end;

theorem Th11:
  for C be compact connected non vertical non horizontal Subset of
TOP-REAL 2 for i,j,k be Element of NAT st 1 <= i & i <= len Gauge(C,n) & 1 <= j
  & j <= k & k <= width Gauge(C,n) & Gauge(C,n)*(i,j) in L~Lower_Seq(C,n) ex j1
be Element of NAT st j <= j1 & j1 <= k & LSeg(Gauge(C,n)*(i,j1),Gauge(C,n)*(i,k
  )) /\ L~Lower_Seq(C,n) = {Gauge(C,n)*(i,j1)}
proof
  let C be compact connected non vertical non horizontal Subset of TOP-REAL 2;
  let i,j,k be Element of NAT;
  assume that
A1: 1 <= i and
A2: i <= len Gauge(C,n) and
A3: 1 <= j and
A4: j <= k and
A5: k <= width Gauge(C,n) and
A6: Gauge(C,n)*(i,j) in L~Lower_Seq(C,n);
  set G = Gauge(C,n);
A7: k >= 1 by A3,A4,XXREAL_0:2;
  then
A8: [i,k] in Indices G by A1,A2,A5,MATRIX_1:37;
  set X = LSeg(G*(i,j),G*(i,k)) /\ L~Lower_Seq(C,n);
A9: G*(i,j) in LSeg(G*(i,j),G*(i,k)) by RLTOPSP1:69;
  then reconsider X1=X as non empty compact Subset of TOP-REAL 2 by A6,
XBOOLE_0:def 4;
A10: LSeg(G*(i,j),G*(i,k)) meets L~Lower_Seq(C,n) by A6,A9,XBOOLE_0:3;
  set s = G*(i,1)`1;
  set e = G*(i,k);
  set f = G*(i,j);
  set w2 = upper_bound(proj2.:(LSeg(f,e) /\ L~Lower_Seq(C,n)));
A11: j <= width G by A4,A5,XXREAL_0:2;
  then [i,j] in Indices G by A1,A2,A3,MATRIX_1:37;
  then consider j1 be Element of NAT such that
A12: j <= j1 and
A13: j1 <= k and
A14: G*(i,j1)`2 = w2 by A4,A10,A8,JORDAN1F:2,JORDAN1G:5;
  set q = |[s,w2]|;
A15: j1 <= width G by A5,A13,XXREAL_0:2;
A16: G*(i,k)`1 = s by A1,A2,A5,A7,GOBOARD5:3;
  then f`1 = e`1 by A1,A2,A3,A11,GOBOARD5:3;
  then
A17: LSeg(f,e) is vertical by SPPOL_1:37;
  take j1;
  thus j <= j1 & j1 <= k by A12,A13;
  consider pp be set such that
A18: pp in N-most X1 by XBOOLE_0:def 1;
  reconsider pp as Point of TOP-REAL 2 by A18;
A19: pp in X by A18,XBOOLE_0:def 4;
  then
A20: pp in L~Lower_Seq(C,n) by XBOOLE_0:def 4;
A21: 1 <= j1 by A3,A12,XXREAL_0:2;
  then
A22: G*(i,j1)`1 = s by A1,A2,A15,GOBOARD5:3;
  then
A23: q = G*(i,j1) by A14,EUCLID:57;
  then
A24: q`2 <= e`2 by A1,A2,A5,A13,A21,SPRECT_3:24;
A25: q`2 = N-bound X by A14,A23,SPRECT_1:50
    .= (N-min X)`2 by EUCLID:56
    .= pp`2 by A18,PSCOMP_1:98;
  pp in LSeg(G*(i,j),G*(i,k)) by A19,XBOOLE_0:def 4;
  then pp`1 = q`1 by A16,A22,A23,A17,SPPOL_1:64;
  then
A26: q in L~Lower_Seq(C,n) by A20,A25,TOPREAL3:11;
  for x be set holds x in LSeg(e,q) /\ L~Lower_Seq(C,n) iff x = q
  proof
    let x be set;
    thus x in LSeg(e,q) /\ L~Lower_Seq(C,n) implies x = q
    proof
      reconsider EE = LSeg(f,e) /\ L~Lower_Seq(C,n) as compact Subset of
      TOP-REAL 2;
      reconsider E0 = proj2.:EE as compact Subset of REAL by JCT_MISC:24;
A27:  e in LSeg(f,e) by RLTOPSP1:69;
A28:  f`2 <= q`2 by A1,A2,A3,A12,A15,A23,SPRECT_3:24;
      f`1 = q`1 by A1,A2,A3,A11,A22,A23,GOBOARD5:3;
      then q in LSeg(e,f) by A16,A22,A23,A24,A28,GOBOARD7:8;
      then
A29:  LSeg(e,q) c= LSeg(f,e) by A27,TOPREAL1:12;
      assume
A30:  x in LSeg(e,q) /\ L~Lower_Seq(C,n);
      then reconsider pp = x as Point of TOP-REAL 2;
A31:  pp in LSeg(e,q) by A30,XBOOLE_0:def 4;
      then
A32:  pp`2 >= q`2 by A24,TOPREAL1:10;
      pp in L~Lower_Seq(C,n) by A30,XBOOLE_0:def 4;
      then pp in EE by A31,A29,XBOOLE_0:def 4;
      then proj2.pp in E0 by FUNCT_2:43;
      then
A33:  pp`2 in E0 by PSCOMP_1:def 29;
      E0 is bounded by RCOMP_1:28;
      then E0 is bounded_above by XXREAL_2:def 11;
      then q`2 >= pp`2 by A14,A23,A33,SEQ_4:def 4;
      then
A34:  pp`2 = q`2 by A32,XXREAL_0:1;
      pp`1 = q`1 by A16,A22,A23,A31,GOBOARD7:5;
      hence thesis by A34,TOPREAL3:11;
    end;
    assume
A35: x = q;
    then x in LSeg(e,q) by RLTOPSP1:69;
    hence thesis by A26,A35,XBOOLE_0:def 4;
  end;
  hence thesis by A23,TARSKI:def 1;
end;

theorem
  for C be compact connected non vertical non horizontal Subset of
TOP-REAL 2 for i,j,k be Element of NAT st 1 <= i & i <= len Gauge(C,n) & 1 <= j
  & j <= k & k <= width Gauge(C,n) & Gauge(C,n)*(i,k) in L~Upper_Seq(C,n) ex k1
be Element of NAT st j <= k1 & k1 <= k & LSeg(Gauge(C,n)*(i,j),Gauge(C,n)*(i,k1
  )) /\ L~Upper_Seq(C,n) = {Gauge(C,n)*(i,k1)}
proof
  let C be compact connected non vertical non horizontal Subset of TOP-REAL 2;
  let i,j,k be Element of NAT;
  assume that
A1: 1 <= i and
A2: i <= len Gauge(C,n) and
A3: 1 <= j and
A4: j <= k and
A5: k <= width Gauge(C,n) and
A6: Gauge(C,n)*(i,k) in L~Upper_Seq(C,n);
  set G = Gauge(C,n);
A7: k >= 1 by A3,A4,XXREAL_0:2;
  then
A8: [i,k] in Indices G by A1,A2,A5,MATRIX_1:37;
  set X = LSeg(G*(i,j),G*(i,k)) /\ L~Upper_Seq(C,n);
A9: G*(i,k) in LSeg(G*(i,j),G*(i,k)) by RLTOPSP1:69;
  then reconsider X1=X as non empty compact Subset of TOP-REAL 2 by A6,
XBOOLE_0:def 4;
A10: LSeg(G*(i,j),G*(i,k)) meets L~Upper_Seq(C,n) by A6,A9,XBOOLE_0:3;
  set s = G*(i,1)`1;
  set e = G*(i,k);
  set f = G*(i,j);
  set w1 = lower_bound(proj2.:(LSeg(f,e) /\ L~Upper_Seq(C,n)));
A11: j <= width G by A4,A5,XXREAL_0:2;
  then [i,j] in Indices G by A1,A2,A3,MATRIX_1:37;
  then consider k1 be Element of NAT such that
A12: j <= k1 and
A13: k1 <= k and
A14: G*(i,k1)`2 = w1 by A4,A10,A8,JORDAN1F:1,JORDAN1G:4;
  set p = |[s,w1]|;
A15: k1 <= width G by A5,A13,XXREAL_0:2;
  f`1 = s by A1,A2,A3,A11,GOBOARD5:3
    .= e`1 by A1,A2,A5,A7,GOBOARD5:3;
  then
A16: LSeg(f,e) is vertical by SPPOL_1:37;
  take k1;
  thus j <= k1 & k1 <= k by A12,A13;
  consider pp be set such that
A17: pp in S-most X1 by XBOOLE_0:def 1;
A18: 1 <= k1 by A3,A12,XXREAL_0:2;
  then
A19: G*(i,k1)`1 = s by A1,A2,A15,GOBOARD5:3;
  then
A20: p = G*(i,k1) by A14,EUCLID:57;
  then
A21: f`2 <= p`2 by A1,A2,A3,A12,A15,SPRECT_3:24;
A22: f`1 = p`1 by A1,A2,A3,A11,A19,A20,GOBOARD5:3;
  reconsider pp as Point of TOP-REAL 2 by A17;
A23: pp in X by A17,XBOOLE_0:def 4;
  then
A24: pp in L~Upper_Seq(C,n) by XBOOLE_0:def 4;
A25: p`2 = S-bound X by A14,A20,SPRECT_1:49
    .= (S-min X)`2 by EUCLID:56
    .= pp`2 by A17,PSCOMP_1:118;
  pp in LSeg(G*(i,j),G*(i,k)) by A23,XBOOLE_0:def 4;
  then pp`1 = p`1 by A22,A16,SPPOL_1:64;
  then
A26: p in L~Upper_Seq(C,n) by A24,A25,TOPREAL3:11;
  for x be set holds x in LSeg(p,f) /\ L~Upper_Seq(C,n) iff x = p
  proof
    let x be set;
    thus x in LSeg(p,f) /\ L~Upper_Seq(C,n) implies x = p
    proof
      reconsider EE = LSeg(f,e) /\ L~Upper_Seq(C,n) as compact Subset of
      TOP-REAL 2;
      reconsider E0 = proj2.:EE as compact Subset of REAL by JCT_MISC:24;
A27:  f in LSeg(f,e) by RLTOPSP1:69;
A28:  e`1 = p`1 by A1,A2,A5,A7,A19,A20,GOBOARD5:3;
A29:  p`2 <= e`2 by A1,A2,A5,A13,A18,A20,SPRECT_3:24;
A30:  f`2 <= p`2 by A1,A2,A3,A12,A15,A20,SPRECT_3:24;
      f`1 = p`1 by A1,A2,A3,A11,A19,A20,GOBOARD5:3;
      then p in LSeg(f,e) by A28,A30,A29,GOBOARD7:8;
      then
A31:  LSeg(p,f) c= LSeg(f,e) by A27,TOPREAL1:12;
      assume
A32:  x in LSeg(p,f) /\ L~Upper_Seq(C,n);
      then reconsider pp = x as Point of TOP-REAL 2;
A33:  pp in LSeg(p,f) by A32,XBOOLE_0:def 4;
      then
A34:  pp`2 <= p`2 by A21,TOPREAL1:10;
      pp in L~Upper_Seq(C,n) by A32,XBOOLE_0:def 4;
      then pp in EE by A33,A31,XBOOLE_0:def 4;
      then proj2.pp in E0 by FUNCT_2:43;
      then
A35:  pp`2 in E0 by PSCOMP_1:def 29;
      E0 is bounded by RCOMP_1:28;
      then E0 is bounded_below by XXREAL_2:def 11;
      then p`2 <= pp`2 by A14,A20,A35,SEQ_4:def 5;
      then
A36:  pp`2 = p`2 by A34,XXREAL_0:1;
      pp`1 = p`1 by A22,A33,GOBOARD7:5;
      hence thesis by A36,TOPREAL3:11;
    end;
    assume
A37: x = p;
    then x in LSeg(p,f) by RLTOPSP1:69;
    hence thesis by A26,A37,XBOOLE_0:def 4;
  end;
  hence thesis by A20,TARSKI:def 1;
end;

theorem Th13:
  for C be compact connected non vertical non horizontal Subset of
TOP-REAL 2 for i,j,k be Element of NAT st 1 <= i & i <= len Gauge(C,n) & 1 <= j
& j <= k & k <= width Gauge(C,n) & Gauge(C,n)*(i,j) in L~Lower_Seq(C,n) & Gauge
  (C,n)*(i,k) in L~Upper_Seq(C,n) ex j1,k1 be Element of NAT st j <= j1 & j1 <=
k1 & k1 <= k & LSeg(Gauge(C,n)*(i,j1),Gauge(C,n)*(i,k1)) /\ L~Lower_Seq(C,n) =
{Gauge(C,n)*(i,j1)} & LSeg(Gauge(C,n)*(i,j1),Gauge(C,n)*(i,k1)) /\ L~Upper_Seq(
  C,n) = {Gauge(C,n)*(i,k1)}
proof
  let C be compact connected non vertical non horizontal Subset of TOP-REAL 2;
  let i,j,k be Element of NAT;
  assume that
A1: 1 <= i and
A2: i <= len Gauge(C,n) and
A3: 1 <= j and
A4: j <= k and
A5: k <= width Gauge(C,n) and
A6: Gauge(C,n)*(i,j) in L~Lower_Seq(C,n) and
A7: Gauge(C,n)*(i,k) in L~Upper_Seq(C,n);
  set G = Gauge(C,n);
A8: j <= width G by A4,A5,XXREAL_0:2;
  then
A9: [i,j] in Indices G by A1,A2,A3,MATRIX_1:37;
  set s = G*(i,1)`1;
  set e = G*(i,k);
  set f = G*(i,j);
  set w1 = lower_bound(proj2.:(LSeg(f,e) /\ L~Upper_Seq(C,n)));
A10: G*(i,k) in LSeg(G*(i,j),G*(i,k)) by RLTOPSP1:69;
  then
A11: LSeg(G*(i,j),G*(i,k)) meets L~Upper_Seq(C,n) by A7,XBOOLE_0:3;
A12: k >= 1 by A3,A4,XXREAL_0:2;
  then [i,k] in Indices G by A1,A2,A5,MATRIX_1:37;
  then consider k1 be Element of NAT such that
A13: j <= k1 and
A14: k1 <= k and
A15: G*(i,k1)`2 = w1 by A4,A11,A9,JORDAN1F:1,JORDAN1G:4;
A16: k1 <= width G by A5,A14,XXREAL_0:2;
A17: G*(i,j) in LSeg(G*(i,j),G*(i,k1)) by RLTOPSP1:69;
  then
A18: LSeg(G*(i,j),G*(i,k1)) meets L~Lower_Seq(C,n) by A6,XBOOLE_0:3;
  set X = LSeg(G*(i,j),G*(i,k1)) /\ L~Lower_Seq(C,n);
  reconsider X1=X as non empty compact Subset of TOP-REAL 2 by A6,A17,
XBOOLE_0:def 4;
  consider pp be set such that
A19: pp in N-most X1 by XBOOLE_0:def 1;
  reconsider pp as Point of TOP-REAL 2 by A19;
A20: pp in X by A19,XBOOLE_0:def 4;
  then
A21: pp in L~Lower_Seq(C,n) by XBOOLE_0:def 4;
  set p = |[s,w1]|;
  set w2 = upper_bound(proj2.:(LSeg(f,p) /\ L~Lower_Seq(C,n)));
  set q = |[s,w2]|;
A22: pp in LSeg(G*(i,j),G*(i,k1)) by A20,XBOOLE_0:def 4;
A23: 1 <= k1 by A3,A13,XXREAL_0:2;
  then
A24: G*(i,k1)`1 = s by A1,A2,A16,GOBOARD5:3;
  then
A25: p = G*(i,k1) by A15,EUCLID:57;
  [i,k1] in Indices G by A1,A2,A23,A16,MATRIX_1:37;
  then consider j1 be Element of NAT such that
A26: j <= j1 and
A27: j1 <= k1 and
A28: G*(i,j1)`2 = w2 by A9,A13,A25,A18,JORDAN1F:2,JORDAN1G:5;
  take j1,k1;
  thus j <= j1 & j1 <= k1 & k1 <= k by A14,A26,A27;
A29: j1 <= width G by A16,A27,XXREAL_0:2;
A30: 1 <= j1 by A3,A26,XXREAL_0:2;
  then
A31: G*(i,j1)`1 = s by A1,A2,A29,GOBOARD5:3;
  then
A32: q = G*(i,j1) by A28,EUCLID:57;
  then
A33: q`2 <= p`2 by A1,A2,A16,A25,A27,A30,SPRECT_3:24;
A34: q`2 = N-bound X by A25,A28,A32,SPRECT_1:50
    .= (N-min X)`2 by EUCLID:56
    .= pp`2 by A19,PSCOMP_1:98;
A35: f`1 = p`1 by A1,A2,A3,A8,A24,A25,GOBOARD5:3;
  then LSeg(f,p) is vertical by SPPOL_1:37;
  then pp`1 = q`1 by A24,A25,A31,A32,A22,SPPOL_1:64;
  then
A36: q in L~Lower_Seq(C,n) by A21,A34,TOPREAL3:11;
  for x be set holds x in LSeg(p,q) /\ L~Lower_Seq(C,n) iff x = q
  proof
    let x be set;
    thus x in LSeg(p,q) /\ L~Lower_Seq(C,n) implies x = q
    proof
      reconsider EE = LSeg(f,p) /\ L~Lower_Seq(C,n) as compact Subset of
      TOP-REAL 2;
      reconsider E0 = proj2.:EE as compact Subset of REAL by JCT_MISC:24;
A37:  p in LSeg(f,p) by RLTOPSP1:69;
A38:  f`2 <= q`2 by A1,A2,A3,A26,A29,A32,SPRECT_3:24;
      f`1 = q`1 by A1,A2,A3,A8,A31,A32,GOBOARD5:3;
      then q in LSeg(p,f) by A24,A25,A31,A32,A33,A38,GOBOARD7:8;
      then
A39:  LSeg(p,q) c= LSeg(f,p) by A37,TOPREAL1:12;
      assume
A40:  x in LSeg(p,q) /\ L~Lower_Seq(C,n);
      then reconsider pp = x as Point of TOP-REAL 2;
A41:  pp in LSeg(p,q) by A40,XBOOLE_0:def 4;
      then
A42:  pp`2 >= q`2 by A33,TOPREAL1:10;
      pp in L~Lower_Seq(C,n) by A40,XBOOLE_0:def 4;
      then pp in EE by A41,A39,XBOOLE_0:def 4;
      then proj2.pp in E0 by FUNCT_2:43;
      then
A43:  pp`2 in E0 by PSCOMP_1:def 29;
      E0 is bounded by RCOMP_1:28;
      then E0 is bounded_above by XXREAL_2:def 11;
      then q`2 >= pp`2 by A28,A32,A43,SEQ_4:def 4;
      then
A44:  pp`2 = q`2 by A42,XXREAL_0:1;
      pp`1 = q`1 by A24,A25,A31,A32,A41,GOBOARD7:5;
      hence thesis by A44,TOPREAL3:11;
    end;
    assume
A45: x = q;
    then x in LSeg(p,q) by RLTOPSP1:69;
    hence thesis by A36,A45,XBOOLE_0:def 4;
  end;
  hence
  LSeg(Gauge(C,n)*(i,j1), Gauge(C,n)*(i,k1)) /\ L~Lower_Seq(C,n) = {Gauge
  (C,n)*(i,j1)} by A25,A32,TARSKI:def 1;
  set X = LSeg(G*(i,j),G*(i,k)) /\ L~Upper_Seq(C,n);
  reconsider X1=X as non empty compact Subset of TOP-REAL 2 by A7,A10,
XBOOLE_0:def 4;
  consider pp be set such that
A46: pp in S-most X1 by XBOOLE_0:def 1;
  reconsider pp as Point of TOP-REAL 2 by A46;
A47: pp in X by A46,XBOOLE_0:def 4;
  then
A48: pp in L~Upper_Seq(C,n) by XBOOLE_0:def 4;
  f`1 = s by A1,A2,A3,A8,GOBOARD5:3
    .= e`1 by A1,A2,A5,A12,GOBOARD5:3;
  then
A49: LSeg(f,e) is vertical by SPPOL_1:37;
  pp in LSeg(G*(i,j),G*(i,k)) by A47,XBOOLE_0:def 4;
  then
A50: pp`1 = p`1 by A35,A49,SPPOL_1:64;
  p`2 = S-bound X by A15,A25,SPRECT_1:49
    .= (S-min X)`2 by EUCLID:56
    .= pp`2 by A46,PSCOMP_1:118;
  then
A51: p in L~Upper_Seq(C,n) by A48,A50,TOPREAL3:11;
  for x be set holds x in LSeg(p,q) /\ L~Upper_Seq(C,n) iff x = p
  proof
    let x be set;
    thus x in LSeg(p,q) /\ L~Upper_Seq(C,n) implies x = p
    proof
A52:  p`2 <= e`2 by A1,A2,A5,A14,A23,A25,SPRECT_3:24;
A53:  f`2 <= p`2 by A1,A2,A3,A13,A16,A25,SPRECT_3:24;
A54:  e`1 = p`1 by A1,A2,A5,A12,A24,A25,GOBOARD5:3;
      f`1 = p`1 by A1,A2,A3,A8,A24,A25,GOBOARD5:3;
      then
A55:  p in LSeg(f,e) by A54,A53,A52,GOBOARD7:8;
A56:  e`1 = q`1 by A1,A2,A5,A12,A31,A32,GOBOARD5:3;
      j1 <= k by A14,A27,XXREAL_0:2;
      then
A57:  q`2 <= e`2 by A1,A2,A5,A30,A32,SPRECT_3:24;
A58:  f`2 <= q`2 by A1,A2,A3,A26,A29,A32,SPRECT_3:24;
      f`1 = q`1 by A1,A2,A3,A8,A31,A32,GOBOARD5:3;
      then q in LSeg(f,e) by A56,A58,A57,GOBOARD7:8;
      then
A59:  LSeg(p,q) c= LSeg(f,e) by A55,TOPREAL1:12;
      reconsider EE = LSeg(f,e) /\ L~Upper_Seq(C,n) as compact Subset of
      TOP-REAL 2;
      reconsider E0 = proj2.:EE as compact Subset of REAL by JCT_MISC:24;
      assume
A60:  x in LSeg(p,q) /\ L~Upper_Seq(C,n);
      then reconsider pp = x as Point of TOP-REAL 2;
A61:  pp in LSeg(p,q) by A60,XBOOLE_0:def 4;
      then
A62:  pp`2 <= p`2 by A33,TOPREAL1:10;
      pp in L~Upper_Seq(C,n) by A60,XBOOLE_0:def 4;
      then pp in EE by A61,A59,XBOOLE_0:def 4;
      then proj2.pp in E0 by FUNCT_2:43;
      then
A63:  pp`2 in E0 by PSCOMP_1:def 29;
      E0 is bounded by RCOMP_1:28;
      then E0 is bounded_below by XXREAL_2:def 11;
      then p`2 <= pp`2 by A15,A25,A63,SEQ_4:def 5;
      then
A64:  pp`2 = p`2 by A62,XXREAL_0:1;
      pp`1 = p`1 by A24,A25,A31,A32,A61,GOBOARD7:5;
      hence thesis by A64,TOPREAL3:11;
    end;
    assume
A65: x = p;
    then x in LSeg(p,q) by RLTOPSP1:69;
    hence thesis by A51,A65,XBOOLE_0:def 4;
  end;
  hence thesis by A25,A32,TARSKI:def 1;
end;

theorem
  for C be compact connected non vertical non horizontal Subset of
TOP-REAL 2 for i,j,k be Element of NAT st 1 <= j & j <= k & k <= len Gauge(C,n)
  & 1 <= i & i <= width Gauge(C,n) & Gauge(C,n)*(j,i) in L~Lower_Seq(C,n) ex j1
be Element of NAT st j <= j1 & j1 <= k & LSeg(Gauge(C,n)*(j1,i),Gauge(C,n)*(k,i
  )) /\ L~Lower_Seq(C,n) = {Gauge(C,n)*(j1,i)}
proof
  let C be compact connected non vertical non horizontal Subset of TOP-REAL 2;
  let i,j,k be Element of NAT;
  assume that
A1: 1 <= j and
A2: j <= k and
A3: k <= len Gauge(C,n) and
A4: 1 <= i and
A5: i <= width Gauge(C,n) and
A6: Gauge(C,n)*(j,i) in L~Lower_Seq(C,n);
  set G = Gauge(C,n);
A7: k >= 1 by A1,A2,XXREAL_0:2;
  then
A8: [k,i] in Indices G by A3,A4,A5,MATRIX_1:37;
  set X = LSeg(G*(j,i),G*(k,i)) /\ L~Lower_Seq(C,n);
A9: G*(j,i) in LSeg(G*(j,i),G*(k,i)) by RLTOPSP1:69;
  then reconsider X1=X as non empty compact Subset of TOP-REAL 2 by A6,
XBOOLE_0:def 4;
A10: LSeg(G*(j,i),G*(k,i)) meets L~Lower_Seq(C,n) by A6,A9,XBOOLE_0:3;
  set s = G*(1,i)`2;
  set e = G*(k,i);
  set f = G*(j,i);
  set w2 = upper_bound(proj1.:(LSeg(f,e) /\ L~Lower_Seq(C,n)));
A11: len G = width G by JORDAN8:def 1;
  then
A12: j <= width G by A2,A3,XXREAL_0:2;
  then [j,i] in Indices G by A1,A4,A5,A11,MATRIX_1:37;
  then consider j1 be Element of NAT such that
A13: j <= j1 and
A14: j1 <= k and
A15: G*(j1,i)`1 = w2 by A2,A10,A8,JORDAN1F:4,JORDAN1G:5;
  set q = |[w2,s]|;
A16: 1 <= j1 by A1,A13,XXREAL_0:2;
  take j1;
  thus j <= j1 & j1 <= k by A13,A14;
  consider pp be set such that
A17: pp in E-most X1 by XBOOLE_0:def 1;
  reconsider pp as Point of TOP-REAL 2 by A17;
A18: pp in X by A17,XBOOLE_0:def 4;
  then
A19: pp in L~Lower_Seq(C,n) by XBOOLE_0:def 4;
A20: j1 <= width G by A3,A11,A14,XXREAL_0:2;
  then
A21: G*(j1,i)`2 = s by A4,A5,A11,A16,GOBOARD5:2;
  then
A22: q = G*(j1,i) by A15,EUCLID:57;
  then
A23: q`1 <= e`1 by A3,A4,A5,A14,A16,SPRECT_3:25;
A24: G*(k,i)`2 = s by A3,A4,A5,A7,GOBOARD5:2;
  then f`2 = e`2 by A1,A4,A5,A11,A12,GOBOARD5:2;
  then
A25: LSeg(f,e) is horizontal by SPPOL_1:36;
A26: q`1 = E-bound X by A15,A22,SPRECT_1:51
    .= (E-min X)`1 by EUCLID:56
    .= pp`1 by A17,PSCOMP_1:108;
  pp in LSeg(G*(j,i),G*(k,i)) by A18,XBOOLE_0:def 4;
  then pp`2 = q`2 by A24,A21,A22,A25,SPPOL_1:63;
  then
A27: q in L~Lower_Seq(C,n) by A19,A26,TOPREAL3:11;
  for x be set holds x in LSeg(e,q) /\ L~Lower_Seq(C,n) iff x = q
  proof
    let x be set;
    thus x in LSeg(e,q) /\ L~Lower_Seq(C,n) implies x = q
    proof
A28:  f`1 <= q`1 by A1,A4,A5,A11,A13,A20,A22,SPRECT_3:25;
      f`2 = q`2 by A1,A4,A5,A11,A12,A21,A22,GOBOARD5:2;
      then
A29:  q in LSeg(e,f) by A24,A21,A22,A23,A28,GOBOARD7:9;
      e in LSeg(f,e) by RLTOPSP1:69;
      then
A30:  LSeg(e,q) c= LSeg(f,e) by A29,TOPREAL1:12;
      reconsider EE = LSeg(f,e) /\ L~Lower_Seq(C,n) as compact Subset of
      TOP-REAL 2;
      reconsider E0 = proj1.:EE as compact Subset of REAL by Th4;
      assume
A31:  x in LSeg(e,q) /\ L~Lower_Seq(C,n);
      then reconsider pp = x as Point of TOP-REAL 2;
A32:  pp in LSeg(e,q) by A31,XBOOLE_0:def 4;
      then
A33:  pp`1 >= q`1 by A23,TOPREAL1:9;
      pp in L~Lower_Seq(C,n) by A31,XBOOLE_0:def 4;
      then pp in EE by A32,A30,XBOOLE_0:def 4;
      then proj1.pp in E0 by FUNCT_2:43;
      then
A34:  pp`1 in E0 by PSCOMP_1:def 28;
      E0 is bounded by RCOMP_1:28;
      then E0 is bounded_above by XXREAL_2:def 11;
      then q`1 >= pp`1 by A15,A22,A34,SEQ_4:def 4;
      then
A35:  pp`1 = q`1 by A33,XXREAL_0:1;
      pp`2 = q`2 by A24,A21,A22,A32,GOBOARD7:6;
      hence thesis by A35,TOPREAL3:11;
    end;
    assume
A36: x = q;
    then x in LSeg(e,q) by RLTOPSP1:69;
    hence thesis by A27,A36,XBOOLE_0:def 4;
  end;
  hence thesis by A22,TARSKI:def 1;
end;

theorem Th15:
  for C be compact connected non vertical non horizontal Subset of
TOP-REAL 2 for i,j,k be Element of NAT st 1 <= j & j <= k & k <= len Gauge(C,n)
  & 1 <= i & i <= width Gauge(C,n) & Gauge(C,n)*(k,i) in L~Upper_Seq(C,n) ex k1
be Element of NAT st j <= k1 & k1 <= k & LSeg(Gauge(C,n)*(j,i),Gauge(C,n)*(k1,i
  )) /\ L~Upper_Seq(C,n) = {Gauge(C,n)*(k1,i)}
proof
  let C be compact connected non vertical non horizontal Subset of TOP-REAL 2;
  let i,j,k be Element of NAT;
  assume that
A1: 1 <= j and
A2: j <= k and
A3: k <= len Gauge(C,n) and
A4: 1 <= i and
A5: i <= width Gauge(C,n) and
A6: Gauge(C,n)*(k,i) in L~Upper_Seq(C,n);
  set G = Gauge(C,n);
A7: k >= 1 by A1,A2,XXREAL_0:2;
  then
A8: [k,i] in Indices G by A3,A4,A5,MATRIX_1:37;
  set X = LSeg(G*(j,i),G*(k,i)) /\ L~Upper_Seq(C,n);
A9: G*(k,i) in LSeg(G*(j,i),G*(k,i)) by RLTOPSP1:69;
  then reconsider X1=X as non empty compact Subset of TOP-REAL 2 by A6,
XBOOLE_0:def 4;
A10: LSeg(G*(j,i),G*(k,i)) meets L~Upper_Seq(C,n) by A6,A9,XBOOLE_0:3;
  set s = G*(1,i)`2;
  set e = G*(k,i);
  set f = G*(j,i);
  set w1 = lower_bound(proj1.:(LSeg(f,e) /\ L~Upper_Seq(C,n)));
A11: len G = width G by JORDAN8:def 1;
  then
A12: j <= width G by A2,A3,XXREAL_0:2;
  then [j,i] in Indices G by A1,A4,A5,A11,MATRIX_1:37;
  then consider k1 be Element of NAT such that
A13: j <= k1 and
A14: k1 <= k and
A15: G*(k1,i)`1 = w1 by A2,A10,A8,JORDAN1F:3,JORDAN1G:4;
  set p = |[w1,s]|;
A16: k1 <= width G by A3,A11,A14,XXREAL_0:2;
  f`2 = s by A1,A4,A5,A11,A12,GOBOARD5:2
    .= e`2 by A3,A4,A5,A7,GOBOARD5:2;
  then
A17: LSeg(f,e) is horizontal by SPPOL_1:36;
  take k1;
  thus j <= k1 & k1 <= k by A13,A14;
  consider pp be set such that
A18: pp in W-most X1 by XBOOLE_0:def 1;
A19: 1 <= k1 by A1,A13,XXREAL_0:2;
  then
A20: G*(k1,i)`2 = s by A4,A5,A11,A16,GOBOARD5:2;
  then
A21: p = G*(k1,i) by A15,EUCLID:57;
  then
A22: f`1 <= p`1 by A1,A4,A5,A11,A13,A16,SPRECT_3:25;
A23: f`2 = p`2 by A1,A4,A5,A11,A12,A20,A21,GOBOARD5:2;
  reconsider pp as Point of TOP-REAL 2 by A18;
A24: pp in X by A18,XBOOLE_0:def 4;
  then
A25: pp in L~Upper_Seq(C,n) by XBOOLE_0:def 4;
A26: p`1 = W-bound X by A15,A21,SPRECT_1:48
    .= (W-min X)`1 by EUCLID:56
    .= pp`1 by A18,PSCOMP_1:88;
  pp in LSeg(G*(j,i),G*(k,i)) by A24,XBOOLE_0:def 4;
  then pp`2 = p`2 by A23,A17,SPPOL_1:63;
  then
A27: p in L~Upper_Seq(C,n) by A25,A26,TOPREAL3:11;
  for x be set holds x in LSeg(p,f) /\ L~Upper_Seq(C,n) iff x = p
  proof
    let x be set;
    thus x in LSeg(p,f) /\ L~Upper_Seq(C,n) implies x = p
    proof
      reconsider EE = LSeg(f,e) /\ L~Upper_Seq(C,n) as compact Subset of
      TOP-REAL 2;
      assume
A28:  x in LSeg(p,f) /\ L~Upper_Seq(C,n);
      then reconsider pp = x as Point of TOP-REAL 2;
A29:  pp in LSeg(p,f) by A28,XBOOLE_0:def 4;
      then
A30:  pp`1 <= p`1 by A22,TOPREAL1:9;
A31:  p`1 <= e`1 by A3,A4,A5,A14,A19,A21,SPRECT_3:25;
A32:  f`1 <= p`1 by A1,A4,A5,A11,A13,A16,A21,SPRECT_3:25;
A33:  e`2 = p`2 by A3,A4,A5,A7,A20,A21,GOBOARD5:2;
      reconsider E0 = proj1.:EE as compact Subset of REAL by Th4;
A34:  f in LSeg(f,e) by RLTOPSP1:69;
      f`2 = p`2 by A1,A4,A5,A11,A12,A20,A21,GOBOARD5:2;
      then p in LSeg(f,e) by A33,A32,A31,GOBOARD7:9;
      then
A35:  LSeg(p,f) c= LSeg(f,e) by A34,TOPREAL1:12;
      pp in L~Upper_Seq(C,n) by A28,XBOOLE_0:def 4;
      then pp in EE by A29,A35,XBOOLE_0:def 4;
      then proj1.pp in E0 by FUNCT_2:43;
      then
A36:  pp`1 in E0 by PSCOMP_1:def 28;
      E0 is bounded by RCOMP_1:28;
      then E0 is bounded_below by XXREAL_2:def 11;
      then p`1 <= pp`1 by A15,A21,A36,SEQ_4:def 5;
      then
A37:  pp`1 = p`1 by A30,XXREAL_0:1;
      pp`2 = p`2 by A23,A29,GOBOARD7:6;
      hence thesis by A37,TOPREAL3:11;
    end;
    assume
A38: x = p;
    then x in LSeg(p,f) by RLTOPSP1:69;
    hence thesis by A27,A38,XBOOLE_0:def 4;
  end;
  hence thesis by A21,TARSKI:def 1;
end;

theorem Th16:
  for C be compact connected non vertical non horizontal Subset of
TOP-REAL 2 for i,j,k be Element of NAT st 1 <= j & j <= k & k <= len Gauge(C,n)
& 1 <= i & i <= width Gauge(C,n) & Gauge(C,n)*(j,i) in L~Lower_Seq(C,n) & Gauge
  (C,n)*(k,i) in L~Upper_Seq(C,n) ex j1,k1 be Element of NAT st j <= j1 & j1 <=
k1 & k1 <= k & LSeg(Gauge(C,n)*(j1,i),Gauge(C,n)*(k1,i)) /\ L~Lower_Seq(C,n) =
{Gauge(C,n)*(j1,i)} & LSeg(Gauge(C,n)*(j1,i),Gauge(C,n)*(k1,i)) /\ L~Upper_Seq(
  C,n) = {Gauge(C,n)*(k1,i)}
proof
  let C be compact connected non vertical non horizontal Subset of TOP-REAL 2;
  let i,j,k be Element of NAT;
  assume that
A1: 1 <= j and
A2: j <= k and
A3: k <= len Gauge(C,n) and
A4: 1 <= i and
A5: i <= width Gauge(C,n) and
A6: Gauge(C,n)*(j,i) in L~Lower_Seq(C,n) and
A7: Gauge(C,n)*(k,i) in L~Upper_Seq(C,n);
  set G = Gauge(C,n);
A8: len G = width G by JORDAN8:def 1;
  then
A9: j <= width G by A2,A3,XXREAL_0:2;
  then
A10: [j,i] in Indices G by A1,A4,A5,A8,MATRIX_1:37;
  set s = G*(1,i)`2;
  set e = G*(k,i);
  set f = G*(j,i);
  set w1 = lower_bound(proj1.:(LSeg(f,e) /\ L~Upper_Seq(C,n)));
A11: G*(k,i) in LSeg(G*(j,i),G*(k,i)) by RLTOPSP1:69;
  then
A12: LSeg(G*(j,i),G*(k,i)) meets L~Upper_Seq(C,n) by A7,XBOOLE_0:3;
A13: k >= 1 by A1,A2,XXREAL_0:2;
  then [k,i] in Indices G by A3,A4,A5,MATRIX_1:37;
  then consider k1 be Element of NAT such that
A14: j <= k1 and
A15: k1 <= k and
A16: G*(k1,i)`1 = w1 by A2,A12,A10,JORDAN1F:3,JORDAN1G:4;
A17: k1 <= width G by A3,A8,A15,XXREAL_0:2;
  set p = |[w1,s]|;
  set w2 = upper_bound(proj1.:(LSeg(f,p) /\ L~Lower_Seq(C,n)));
  set q = |[w2,s]|;
A18: G*(j,i) in LSeg(G*(j,i),G*(k1,i)) by RLTOPSP1:69;
  then
A19: LSeg(G*(j,i),G*(k1,i)) meets L~Lower_Seq(C,n) by A6,XBOOLE_0:3;
A20: 1 <= k1 by A1,A14,XXREAL_0:2;
  then
A21: G*(k1,i)`2 = s by A4,A5,A8,A17,GOBOARD5:2;
  then
A22: p = G*(k1,i) by A16,EUCLID:57;
  f`2 = s by A1,A4,A5,A8,A9,GOBOARD5:2
    .= e`2 by A3,A4,A5,A13,GOBOARD5:2;
  then
A23: LSeg(f,e) is horizontal by SPPOL_1:36;
  set X = LSeg(G*(j,i),G*(k1,i)) /\ L~Lower_Seq(C,n);
  reconsider X1=X as non empty compact Subset of TOP-REAL 2 by A6,A18,
XBOOLE_0:def 4;
  consider pp be set such that
A24: pp in E-most X1 by XBOOLE_0:def 1;
  [k1,i] in Indices G by A4,A5,A8,A20,A17,MATRIX_1:37;
  then consider j1 be Element of NAT such that
A25: j <= j1 and
A26: j1 <= k1 and
A27: G*(j1,i)`1 = w2 by A10,A14,A22,A19,JORDAN1F:4,JORDAN1G:5;
A28: j1 <= width G by A17,A26,XXREAL_0:2;
  reconsider pp as Point of TOP-REAL 2 by A24;
A29: pp in X by A24,XBOOLE_0:def 4;
  then
A30: pp in L~Lower_Seq(C,n) by XBOOLE_0:def 4;
  take j1,k1;
  thus j <= j1 & j1 <= k1 & k1 <= k by A15,A25,A26;
A31: pp in LSeg(G*(j,i),G*(k1,i)) by A29,XBOOLE_0:def 4;
A32: 1 <= j1 by A1,A25,XXREAL_0:2;
  then
A33: G*(j1,i)`2 = s by A4,A5,A8,A28,GOBOARD5:2;
  then
A34: q = G*(j1,i) by A27,EUCLID:57;
  then
A35: q`1 <= p`1 by A4,A5,A8,A17,A22,A26,A32,SPRECT_3:25;
A36: q`1 = E-bound X by A22,A27,A34,SPRECT_1:51
    .= (E-min X)`1 by EUCLID:56
    .= pp`1 by A24,PSCOMP_1:108;
A37: f`2 = p`2 by A1,A4,A5,A8,A9,A21,A22,GOBOARD5:2;
  then LSeg(f,p) is horizontal by SPPOL_1:36;
  then pp`2 = q`2 by A21,A22,A33,A34,A31,SPPOL_1:63;
  then
A38: q in L~Lower_Seq(C,n) by A30,A36,TOPREAL3:11;
  for x be set holds x in LSeg(p,q) /\ L~Lower_Seq(C,n) iff x = q
  proof
    let x be set;
    thus x in LSeg(p,q) /\ L~Lower_Seq(C,n) implies x = q
    proof
      reconsider EE = LSeg(f,p) /\ L~Lower_Seq(C,n) as compact Subset of
      TOP-REAL 2;
      assume
A39:  x in LSeg(p,q) /\ L~Lower_Seq(C,n);
      then reconsider pp = x as Point of TOP-REAL 2;
A40:  pp in LSeg(p,q) by A39,XBOOLE_0:def 4;
      then
A41:  pp`1 >= q`1 by A35,TOPREAL1:9;
A42:  f`1 <= q`1 by A1,A4,A5,A8,A25,A28,A34,SPRECT_3:25;
      reconsider E0 = proj1.:EE as compact Subset of REAL by Th4;
A43:  p in LSeg(f,p) by RLTOPSP1:69;
      f`2 = q`2 by A1,A4,A5,A8,A9,A33,A34,GOBOARD5:2;
      then q in LSeg(p,f) by A21,A22,A33,A34,A35,A42,GOBOARD7:9;
      then
A44:  LSeg(p,q) c= LSeg(f,p) by A43,TOPREAL1:12;
      pp in L~Lower_Seq(C,n) by A39,XBOOLE_0:def 4;
      then pp in EE by A40,A44,XBOOLE_0:def 4;
      then proj1.pp in E0 by FUNCT_2:43;
      then
A45:  pp`1 in E0 by PSCOMP_1:def 28;
      E0 is bounded by RCOMP_1:28;
      then E0 is bounded_above by XXREAL_2:def 11;
      then q`1 >= pp`1 by A27,A34,A45,SEQ_4:def 4;
      then
A46:  pp`1 = q`1 by A41,XXREAL_0:1;
      pp`2 = q`2 by A21,A22,A33,A34,A40,GOBOARD7:6;
      hence thesis by A46,TOPREAL3:11;
    end;
    assume
A47: x = q;
    then x in LSeg(p,q) by RLTOPSP1:69;
    hence thesis by A38,A47,XBOOLE_0:def 4;
  end;
  hence
  LSeg(Gauge(C,n)*(j1,i),Gauge(C,n)*(k1,i)) /\ L~Lower_Seq(C,n) = {Gauge(
  C,n)*(j1,i)} by A22,A34,TARSKI:def 1;
  set X = LSeg(G*(j,i),G*(k,i)) /\ L~Upper_Seq(C,n);
  reconsider X1=X as non empty compact Subset of TOP-REAL 2 by A7,A11,
XBOOLE_0:def 4;
  consider pp be set such that
A48: pp in W-most X1 by XBOOLE_0:def 1;
  reconsider pp as Point of TOP-REAL 2 by A48;
A49: pp in X by A48,XBOOLE_0:def 4;
  then
A50: pp in L~Upper_Seq(C,n) by XBOOLE_0:def 4;
  pp in LSeg(G*(j,i),G*(k,i)) by A49,XBOOLE_0:def 4;
  then
A51: pp`2 = p`2 by A37,A23,SPPOL_1:63;
  p`1 = W-bound X by A16,A22,SPRECT_1:48
    .= (W-min X)`1 by EUCLID:56
    .= pp`1 by A48,PSCOMP_1:88;
  then
A52: p in L~Upper_Seq(C,n) by A50,A51,TOPREAL3:11;
  for x be set holds x in LSeg(p,q) /\ L~Upper_Seq(C,n) iff x = p
  proof
    let x be set;
    thus x in LSeg(p,q) /\ L~Upper_Seq(C,n) implies x = p
    proof
      j1 <= k by A15,A26,XXREAL_0:2;
      then
A53:  q`1 <= e`1 by A3,A4,A5,A32,A34,SPRECT_3:25;
A54:  e`2 = p`2 by A3,A4,A5,A13,A21,A22,GOBOARD5:2;
A55:  f`1 <= p`1 by A1,A4,A5,A8,A14,A17,A22,SPRECT_3:25;
A56:  f`1 <= q`1 by A1,A4,A5,A8,A25,A28,A34,SPRECT_3:25;
A57:  p`1 <= e`1 by A3,A4,A5,A15,A20,A22,SPRECT_3:25;
      f`2 = p`2 by A1,A4,A5,A8,A9,A21,A22,GOBOARD5:2;
      then
A58:  p in LSeg(f,e) by A54,A55,A57,GOBOARD7:9;
A59:  e`2 = q`2 by A3,A4,A5,A13,A33,A34,GOBOARD5:2;
      f`2 = q`2 by A1,A4,A5,A8,A9,A33,A34,GOBOARD5:2;
      then q in LSeg(f,e) by A59,A56,A53,GOBOARD7:9;
      then
A60:  LSeg(p,q) c= LSeg(f,e) by A58,TOPREAL1:12;
      reconsider EE = LSeg(f,e) /\ L~Upper_Seq(C,n) as compact Subset of
      TOP-REAL 2;
      reconsider E0 = proj1.:EE as compact Subset of REAL by Th4;
      assume
A61:  x in LSeg(p,q) /\ L~Upper_Seq(C,n);
      then reconsider pp = x as Point of TOP-REAL 2;
A62:  pp in LSeg(p,q) by A61,XBOOLE_0:def 4;
      then
A63:  pp`1 <= p`1 by A35,TOPREAL1:9;
      pp in L~Upper_Seq(C,n) by A61,XBOOLE_0:def 4;
      then pp in EE by A62,A60,XBOOLE_0:def 4;
      then proj1.pp in E0 by FUNCT_2:43;
      then
A64:  pp`1 in E0 by PSCOMP_1:def 28;
      E0 is bounded by RCOMP_1:28;
      then E0 is bounded_below by XXREAL_2:def 11;
      then p`1 <= pp`1 by A16,A22,A64,SEQ_4:def 5;
      then
A65:  pp`1 = p`1 by A63,XXREAL_0:1;
      pp`2 = p`2 by A21,A22,A33,A34,A62,GOBOARD7:6;
      hence thesis by A65,TOPREAL3:11;
    end;
    assume
A66: x = p;
    then x in LSeg(p,q) by RLTOPSP1:69;
    hence thesis by A52,A66,XBOOLE_0:def 4;
  end;
  hence thesis by A22,A34,TARSKI:def 1;
end;

theorem
  for C be compact connected non vertical non horizontal Subset of
TOP-REAL 2 for i,j,k be Element of NAT st 1 <= i & i <= len Gauge(C,n) & 1 <= j
  & j <= k & k <= width Gauge(C,n) & Gauge(C,n)*(i,j) in L~Upper_Seq(C,n) ex j1
be Element of NAT st j <= j1 & j1 <= k & LSeg(Gauge(C,n)*(i,j1),Gauge(C,n)*(i,k
  )) /\ L~Upper_Seq(C,n) = {Gauge(C,n)*(i,j1)}
proof
  let C be compact connected non vertical non horizontal Subset of TOP-REAL 2;
  let i,j,k be Element of NAT;
  assume that
A1: 1 <= i and
A2: i <= len Gauge(C,n) and
A3: 1 <= j and
A4: j <= k and
A5: k <= width Gauge(C,n) and
A6: Gauge(C,n)*(i,j) in L~Upper_Seq(C,n);
  set G = Gauge(C,n);
A7: k >= 1 by A3,A4,XXREAL_0:2;
  then
A8: [i,k] in Indices G by A1,A2,A5,MATRIX_1:37;
  set X = LSeg(G*(i,j),G*(i,k)) /\ L~Upper_Seq(C,n);
A9: G*(i,j) in LSeg(G*(i,j),G*(i,k)) by RLTOPSP1:69;
  then reconsider X1=X as non empty compact Subset of TOP-REAL 2 by A6,
XBOOLE_0:def 4;
A10: LSeg(G*(i,j),G*(i,k)) meets L~Upper_Seq(C,n) by A6,A9,XBOOLE_0:3;
  set s = G*(i,1)`1;
  set e = G*(i,k);
  set f = G*(i,j);
  set w2 = upper_bound(proj2.:(LSeg(f,e) /\ L~Upper_Seq(C,n)));
A11: j <= width G by A4,A5,XXREAL_0:2;
  then [i,j] in Indices G by A1,A2,A3,MATRIX_1:37;
  then consider j1 be Element of NAT such that
A12: j <= j1 and
A13: j1 <= k and
A14: G*(i,j1)`2 = w2 by A4,A10,A8,JORDAN1F:2,JORDAN1G:4;
  set q = |[s,w2]|;
A15: j1 <= width G by A5,A13,XXREAL_0:2;
A16: G*(i,k)`1 = s by A1,A2,A5,A7,GOBOARD5:3;
  then f`1 = e`1 by A1,A2,A3,A11,GOBOARD5:3;
  then
A17: LSeg(f,e) is vertical by SPPOL_1:37;
  take j1;
  thus j <= j1 & j1 <= k by A12,A13;
  consider pp be set such that
A18: pp in N-most X1 by XBOOLE_0:def 1;
  reconsider pp as Point of TOP-REAL 2 by A18;
A19: pp in X by A18,XBOOLE_0:def 4;
  then
A20: pp in L~Upper_Seq(C,n) by XBOOLE_0:def 4;
A21: 1 <= j1 by A3,A12,XXREAL_0:2;
  then
A22: G*(i,j1)`1 = s by A1,A2,A15,GOBOARD5:3;
  then
A23: q = G*(i,j1) by A14,EUCLID:57;
  then
A24: q`2 <= e`2 by A1,A2,A5,A13,A21,SPRECT_3:24;
A25: q`2 = N-bound X by A14,A23,SPRECT_1:50
    .= (N-min X)`2 by EUCLID:56
    .= pp`2 by A18,PSCOMP_1:98;
  pp in LSeg(G*(i,j),G*(i,k)) by A19,XBOOLE_0:def 4;
  then pp`1 = q`1 by A16,A22,A23,A17,SPPOL_1:64;
  then
A26: q in L~Upper_Seq(C,n) by A20,A25,TOPREAL3:11;
  for x be set holds x in LSeg(e,q) /\ L~Upper_Seq(C,n) iff x = q
  proof
    let x be set;
    thus x in LSeg(e,q) /\ L~Upper_Seq(C,n) implies x = q
    proof
      reconsider EE = LSeg(f,e) /\ L~Upper_Seq(C,n) as compact Subset of
      TOP-REAL 2;
      reconsider E0 = proj2.:EE as compact Subset of REAL by JCT_MISC:24;
A27:  e in LSeg(f,e) by RLTOPSP1:69;
A28:  f`2 <= q`2 by A1,A2,A3,A12,A15,A23,SPRECT_3:24;
      f`1 = q`1 by A1,A2,A3,A11,A22,A23,GOBOARD5:3;
      then q in LSeg(e,f) by A16,A22,A23,A24,A28,GOBOARD7:8;
      then
A29:  LSeg(e,q) c= LSeg(f,e) by A27,TOPREAL1:12;
      assume
A30:  x in LSeg(e,q) /\ L~Upper_Seq(C,n);
      then reconsider pp = x as Point of TOP-REAL 2;
A31:  pp in LSeg(e,q) by A30,XBOOLE_0:def 4;
      then
A32:  pp`2 >= q`2 by A24,TOPREAL1:10;
      pp in L~Upper_Seq(C,n) by A30,XBOOLE_0:def 4;
      then pp in EE by A31,A29,XBOOLE_0:def 4;
      then proj2.pp in E0 by FUNCT_2:43;
      then
A33:  pp`2 in E0 by PSCOMP_1:def 29;
      E0 is bounded by RCOMP_1:28;
      then E0 is bounded_above by XXREAL_2:def 11;
      then q`2 >= pp`2 by A14,A23,A33,SEQ_4:def 4;
      then
A34:  pp`2 = q`2 by A32,XXREAL_0:1;
      pp`1 = q`1 by A16,A22,A23,A31,GOBOARD7:5;
      hence thesis by A34,TOPREAL3:11;
    end;
    assume
A35: x = q;
    then x in LSeg(e,q) by RLTOPSP1:69;
    hence thesis by A26,A35,XBOOLE_0:def 4;
  end;
  hence thesis by A23,TARSKI:def 1;
end;

theorem
  for C be compact connected non vertical non horizontal Subset of
TOP-REAL 2 for i,j,k be Element of NAT st 1 <= i & i <= len Gauge(C,n) & 1 <= j
  & j <= k & k <= width Gauge(C,n) & Gauge(C,n)*(i,k) in L~Lower_Seq(C,n) ex k1
be Element of NAT st j <= k1 & k1 <= k & LSeg(Gauge(C,n)*(i,j),Gauge(C,n)*(i,k1
  )) /\ L~Lower_Seq(C,n) = {Gauge(C,n)*(i,k1)}
proof
  let C be compact connected non vertical non horizontal Subset of TOP-REAL 2;
  let i,j,k be Element of NAT;
  assume that
A1: 1 <= i and
A2: i <= len Gauge(C,n) and
A3: 1 <= j and
A4: j <= k and
A5: k <= width Gauge(C,n) and
A6: Gauge(C,n)*(i,k) in L~Lower_Seq(C,n);
  set G = Gauge(C,n);
A7: k >= 1 by A3,A4,XXREAL_0:2;
  then
A8: [i,k] in Indices G by A1,A2,A5,MATRIX_1:37;
  set X = LSeg(G*(i,j),G*(i,k)) /\ L~Lower_Seq(C,n);
A9: G*(i,k) in LSeg(G*(i,j),G*(i,k)) by RLTOPSP1:69;
  then reconsider X1=X as non empty compact Subset of TOP-REAL 2 by A6,
XBOOLE_0:def 4;
A10: LSeg(G*(i,j),G*(i,k)) meets L~Lower_Seq(C,n) by A6,A9,XBOOLE_0:3;
  set s = G*(i,1)`1;
  set e = G*(i,k);
  set f = G*(i,j);
  set w1 = lower_bound(proj2.:(LSeg(f,e) /\ L~Lower_Seq(C,n)));
A11: j <= width G by A4,A5,XXREAL_0:2;
  then [i,j] in Indices G by A1,A2,A3,MATRIX_1:37;
  then consider k1 be Element of NAT such that
A12: j <= k1 and
A13: k1 <= k and
A14: G*(i,k1)`2 = w1 by A4,A10,A8,JORDAN1F:1,JORDAN1G:5;
  set p = |[s,w1]|;
A15: k1 <= width G by A5,A13,XXREAL_0:2;
  f`1 = s by A1,A2,A3,A11,GOBOARD5:3
    .= e`1 by A1,A2,A5,A7,GOBOARD5:3;
  then
A16: LSeg(f,e) is vertical by SPPOL_1:37;
  take k1;
  thus j <= k1 & k1 <= k by A12,A13;
  consider pp be set such that
A17: pp in S-most X1 by XBOOLE_0:def 1;
A18: 1 <= k1 by A3,A12,XXREAL_0:2;
  then
A19: G*(i,k1)`1 = s by A1,A2,A15,GOBOARD5:3;
  then
A20: p = G*(i,k1) by A14,EUCLID:57;
  then
A21: f`2 <= p`2 by A1,A2,A3,A12,A15,SPRECT_3:24;
A22: f`1 = p`1 by A1,A2,A3,A11,A19,A20,GOBOARD5:3;
  reconsider pp as Point of TOP-REAL 2 by A17;
A23: pp in X by A17,XBOOLE_0:def 4;
  then
A24: pp in L~Lower_Seq(C,n) by XBOOLE_0:def 4;
A25: p`2 = S-bound X by A14,A20,SPRECT_1:49
    .= (S-min X)`2 by EUCLID:56
    .= pp`2 by A17,PSCOMP_1:118;
  pp in LSeg(G*(i,j),G*(i,k)) by A23,XBOOLE_0:def 4;
  then pp`1 = p`1 by A22,A16,SPPOL_1:64;
  then
A26: p in L~Lower_Seq(C,n) by A24,A25,TOPREAL3:11;
  for x be set holds x in LSeg(p,f) /\ L~Lower_Seq(C,n) iff x = p
  proof
    let x be set;
    thus x in LSeg(p,f) /\ L~Lower_Seq(C,n) implies x = p
    proof
      reconsider EE = LSeg(f,e) /\ L~Lower_Seq(C,n) as compact Subset of
      TOP-REAL 2;
      reconsider E0 = proj2.:EE as compact Subset of REAL by JCT_MISC:24;
A27:  f in LSeg(f,e) by RLTOPSP1:69;
A28:  e`1 = p`1 by A1,A2,A5,A7,A19,A20,GOBOARD5:3;
A29:  p`2 <= e`2 by A1,A2,A5,A13,A18,A20,SPRECT_3:24;
A30:  f`2 <= p`2 by A1,A2,A3,A12,A15,A20,SPRECT_3:24;
      f`1 = p`1 by A1,A2,A3,A11,A19,A20,GOBOARD5:3;
      then p in LSeg(f,e) by A28,A30,A29,GOBOARD7:8;
      then
A31:  LSeg(p,f) c= LSeg(f,e) by A27,TOPREAL1:12;
      assume
A32:  x in LSeg(p,f) /\ L~Lower_Seq(C,n);
      then reconsider pp = x as Point of TOP-REAL 2;
A33:  pp in LSeg(p,f) by A32,XBOOLE_0:def 4;
      then
A34:  pp`2 <= p`2 by A21,TOPREAL1:10;
      pp in L~Lower_Seq(C,n) by A32,XBOOLE_0:def 4;
      then pp in EE by A33,A31,XBOOLE_0:def 4;
      then proj2.pp in E0 by FUNCT_2:43;
      then
A35:  pp`2 in E0 by PSCOMP_1:def 29;
      E0 is bounded by RCOMP_1:28;
      then E0 is bounded_below by XXREAL_2:def 11;
      then p`2 <= pp`2 by A14,A20,A35,SEQ_4:def 5;
      then
A36:  pp`2 = p`2 by A34,XXREAL_0:1;
      pp`1 = p`1 by A22,A33,GOBOARD7:5;
      hence thesis by A36,TOPREAL3:11;
    end;
    assume
A37: x = p;
    then x in LSeg(p,f) by RLTOPSP1:69;
    hence thesis by A26,A37,XBOOLE_0:def 4;
  end;
  hence thesis by A20,TARSKI:def 1;
end;

theorem
  for C be compact connected non vertical non horizontal Subset of
TOP-REAL 2 for i,j,k be Element of NAT st 1 <= i & i <= len Gauge(C,n) & 1 <= j
& j <= k & k <= width Gauge(C,n) & Gauge(C,n)*(i,j) in L~Upper_Seq(C,n) & Gauge
  (C,n)*(i,k) in L~Lower_Seq(C,n) ex j1,k1 be Element of NAT st j <= j1 & j1 <=
k1 & k1 <= k & LSeg(Gauge(C,n)*(i,j1),Gauge(C,n)*(i,k1)) /\ L~Upper_Seq(C,n) =
{Gauge(C,n)*(i,j1)} & LSeg(Gauge(C,n)*(i,j1),Gauge(C,n)*(i,k1)) /\ L~Lower_Seq(
  C,n) = {Gauge(C,n)*(i,k1)}
proof
  let C be compact connected non vertical non horizontal Subset of TOP-REAL 2;
  let i,j,k be Element of NAT;
  assume that
A1: 1 <= i and
A2: i <= len Gauge(C,n) and
A3: 1 <= j and
A4: j <= k and
A5: k <= width Gauge(C,n) and
A6: Gauge(C,n)*(i,j) in L~Upper_Seq(C,n) and
A7: Gauge(C,n)*(i,k) in L~Lower_Seq(C,n);
  set G = Gauge(C,n);
A8: j <= width G by A4,A5,XXREAL_0:2;
  then
A9: [i,j] in Indices G by A1,A2,A3,MATRIX_1:37;
  set s = G*(i,1)`1;
  set e = G*(i,k);
  set f = G*(i,j);
  set w1 = lower_bound(proj2.:(LSeg(f,e) /\ L~Lower_Seq(C,n)));
A10: G*(i,k) in LSeg(G*(i,j),G*(i,k)) by RLTOPSP1:69;
  then
A11: LSeg(G*(i,j),G*(i,k)) meets L~Lower_Seq(C,n) by A7,XBOOLE_0:3;
A12: k >= 1 by A3,A4,XXREAL_0:2;
  then [i,k] in Indices G by A1,A2,A5,MATRIX_1:37;
  then consider k1 be Element of NAT such that
A13: j <= k1 and
A14: k1 <= k and
A15: G*(i,k1)`2 = w1 by A4,A11,A9,JORDAN1F:1,JORDAN1G:5;
A16: k1 <= width G by A5,A14,XXREAL_0:2;
A17: G*(i,j) in LSeg(G*(i,j),G*(i,k1)) by RLTOPSP1:69;
  then
A18: LSeg(G*(i,j),G*(i,k1)) meets L~Upper_Seq(C,n) by A6,XBOOLE_0:3;
  set X = LSeg(G*(i,j),G*(i,k1)) /\ L~Upper_Seq(C,n);
  reconsider X1=X as non empty compact Subset of TOP-REAL 2 by A6,A17,
XBOOLE_0:def 4;
  consider pp be set such that
A19: pp in N-most X1 by XBOOLE_0:def 1;
  reconsider pp as Point of TOP-REAL 2 by A19;
A20: pp in X by A19,XBOOLE_0:def 4;
  then
A21: pp in L~Upper_Seq(C,n) by XBOOLE_0:def 4;
  set p = |[s,w1]|;
  set w2 = upper_bound(proj2.:(LSeg(f,p) /\ L~Upper_Seq(C,n)));
  set q = |[s,w2]|;
A22: pp in LSeg(G*(i,j),G*(i,k1)) by A20,XBOOLE_0:def 4;
A23: 1 <= k1 by A3,A13,XXREAL_0:2;
  then
A24: G*(i,k1)`1 = s by A1,A2,A16,GOBOARD5:3;
  then
A25: p = G*(i,k1) by A15,EUCLID:57;
  [i,k1] in Indices G by A1,A2,A23,A16,MATRIX_1:37;
  then consider j1 be Element of NAT such that
A26: j <= j1 and
A27: j1 <= k1 and
A28: G*(i,j1)`2 = w2 by A9,A13,A25,A18,JORDAN1F:2,JORDAN1G:4;
  take j1,k1;
  thus j <= j1 & j1 <= k1 & k1 <= k by A14,A26,A27;
A29: j1 <= width G by A16,A27,XXREAL_0:2;
A30: 1 <= j1 by A3,A26,XXREAL_0:2;
  then
A31: G*(i,j1)`1 = s by A1,A2,A29,GOBOARD5:3;
  then
A32: q = G*(i,j1) by A28,EUCLID:57;
  then
A33: q`2 <= p`2 by A1,A2,A16,A25,A27,A30,SPRECT_3:24;
A34: q`2 = N-bound X by A25,A28,A32,SPRECT_1:50
    .= (N-min X)`2 by EUCLID:56
    .= pp`2 by A19,PSCOMP_1:98;
A35: f`1 = p`1 by A1,A2,A3,A8,A24,A25,GOBOARD5:3;
  then LSeg(f,p) is vertical by SPPOL_1:37;
  then pp`1 = q`1 by A24,A25,A31,A32,A22,SPPOL_1:64;
  then
A36: q in L~Upper_Seq(C,n) by A21,A34,TOPREAL3:11;
  for x be set holds x in LSeg(p,q) /\ L~Upper_Seq(C,n) iff x = q
  proof
    let x be set;
    thus x in LSeg(p,q) /\ L~Upper_Seq(C,n) implies x = q
    proof
      reconsider EE = LSeg(f,p) /\ L~Upper_Seq(C,n) as compact Subset of
      TOP-REAL 2;
      reconsider E0 = proj2.:EE as compact Subset of REAL by JCT_MISC:24;
A37:  p in LSeg(f,p) by RLTOPSP1:69;
A38:  f`2 <= q`2 by A1,A2,A3,A26,A29,A32,SPRECT_3:24;
      f`1 = q`1 by A1,A2,A3,A8,A31,A32,GOBOARD5:3;
      then q in LSeg(p,f) by A24,A25,A31,A32,A33,A38,GOBOARD7:8;
      then
A39:  LSeg(p,q) c= LSeg(f,p) by A37,TOPREAL1:12;
      assume
A40:  x in LSeg(p,q) /\ L~Upper_Seq(C,n);
      then reconsider pp = x as Point of TOP-REAL 2;
A41:  pp in LSeg(p,q) by A40,XBOOLE_0:def 4;
      then
A42:  pp`2 >= q`2 by A33,TOPREAL1:10;
      pp in L~Upper_Seq(C,n) by A40,XBOOLE_0:def 4;
      then pp in EE by A41,A39,XBOOLE_0:def 4;
      then proj2.pp in E0 by FUNCT_2:43;
      then
A43:  pp`2 in E0 by PSCOMP_1:def 29;
      E0 is bounded by RCOMP_1:28;
      then E0 is bounded_above by XXREAL_2:def 11;
      then q`2 >= pp`2 by A28,A32,A43,SEQ_4:def 4;
      then
A44:  pp`2 = q`2 by A42,XXREAL_0:1;
      pp`1 = q`1 by A24,A25,A31,A32,A41,GOBOARD7:5;
      hence thesis by A44,TOPREAL3:11;
    end;
    assume
A45: x = q;
    then x in LSeg(p,q) by RLTOPSP1:69;
    hence thesis by A36,A45,XBOOLE_0:def 4;
  end;
  hence
  LSeg(Gauge(C,n)*(i,j1), Gauge(C,n)*(i,k1)) /\ L~Upper_Seq(C,n) = {Gauge
  (C,n)*(i,j1)} by A25,A32,TARSKI:def 1;
  set X = LSeg(G*(i,j),G*(i,k)) /\ L~Lower_Seq(C,n);
  reconsider X1=X as non empty compact Subset of TOP-REAL 2 by A7,A10,
XBOOLE_0:def 4;
  consider pp be set such that
A46: pp in S-most X1 by XBOOLE_0:def 1;
  reconsider pp as Point of TOP-REAL 2 by A46;
A47: pp in X by A46,XBOOLE_0:def 4;
  then
A48: pp in L~Lower_Seq(C,n) by XBOOLE_0:def 4;
  f`1 = s by A1,A2,A3,A8,GOBOARD5:3
    .= e`1 by A1,A2,A5,A12,GOBOARD5:3;
  then
A49: LSeg(f,e) is vertical by SPPOL_1:37;
  pp in LSeg(G*(i,j),G*(i,k)) by A47,XBOOLE_0:def 4;
  then
A50: pp`1 = p`1 by A35,A49,SPPOL_1:64;
  p`2 = S-bound X by A15,A25,SPRECT_1:49
    .= (S-min X)`2 by EUCLID:56
    .= pp`2 by A46,PSCOMP_1:118;
  then
A51: p in L~Lower_Seq(C,n) by A48,A50,TOPREAL3:11;
  for x be set holds x in LSeg(p,q) /\ L~Lower_Seq(C,n) iff x = p
  proof
    let x be set;
    thus x in LSeg(p,q) /\ L~Lower_Seq(C,n) implies x = p
    proof
A52:  p`2 <= e`2 by A1,A2,A5,A14,A23,A25,SPRECT_3:24;
A53:  f`2 <= p`2 by A1,A2,A3,A13,A16,A25,SPRECT_3:24;
A54:  e`1 = p`1 by A1,A2,A5,A12,A24,A25,GOBOARD5:3;
      f`1 = p`1 by A1,A2,A3,A8,A24,A25,GOBOARD5:3;
      then
A55:  p in LSeg(f,e) by A54,A53,A52,GOBOARD7:8;
A56:  e`1 = q`1 by A1,A2,A5,A12,A31,A32,GOBOARD5:3;
      j1 <= k by A14,A27,XXREAL_0:2;
      then
A57:  q`2 <= e`2 by A1,A2,A5,A30,A32,SPRECT_3:24;
A58:  f`2 <= q`2 by A1,A2,A3,A26,A29,A32,SPRECT_3:24;
      f`1 = q`1 by A1,A2,A3,A8,A31,A32,GOBOARD5:3;
      then q in LSeg(f,e) by A56,A58,A57,GOBOARD7:8;
      then
A59:  LSeg(p,q) c= LSeg(f,e) by A55,TOPREAL1:12;
      reconsider EE = LSeg(f,e) /\ L~Lower_Seq(C,n) as compact Subset of
      TOP-REAL 2;
      reconsider E0 = proj2.:EE as compact Subset of REAL by JCT_MISC:24;
      assume
A60:  x in LSeg(p,q) /\ L~Lower_Seq(C,n);
      then reconsider pp = x as Point of TOP-REAL 2;
A61:  pp in LSeg(p,q) by A60,XBOOLE_0:def 4;
      then
A62:  pp`2 <= p`2 by A33,TOPREAL1:10;
      pp in L~Lower_Seq(C,n) by A60,XBOOLE_0:def 4;
      then pp in EE by A61,A59,XBOOLE_0:def 4;
      then proj2.pp in E0 by FUNCT_2:43;
      then
A63:  pp`2 in E0 by PSCOMP_1:def 29;
      E0 is bounded by RCOMP_1:28;
      then E0 is bounded_below by XXREAL_2:def 11;
      then p`2 <= pp`2 by A15,A25,A63,SEQ_4:def 5;
      then
A64:  pp`2 = p`2 by A62,XXREAL_0:1;
      pp`1 = p`1 by A24,A25,A31,A32,A61,GOBOARD7:5;
      hence thesis by A64,TOPREAL3:11;
    end;
    assume
A65: x = p;
    then x in LSeg(p,q) by RLTOPSP1:69;
    hence thesis by A51,A65,XBOOLE_0:def 4;
  end;
  hence thesis by A25,A32,TARSKI:def 1;
end;

theorem Th20:
  for C be compact connected non vertical non horizontal Subset of
TOP-REAL 2 for i,j,k be Element of NAT st 1 <= j & j <= k & k <= len Gauge(C,n)
  & 1 <= i & i <= width Gauge(C,n) & Gauge(C,n)*(j,i) in L~Upper_Seq(C,n) ex j1
be Element of NAT st j <= j1 & j1 <= k & LSeg(Gauge(C,n)*(j1,i),Gauge(C,n)*(k,i
  )) /\ L~Upper_Seq(C,n) = {Gauge(C,n)*(j1,i)}
proof
  let C be compact connected non vertical non horizontal Subset of TOP-REAL 2;
  let i,j,k be Element of NAT;
  assume that
A1: 1 <= j and
A2: j <= k and
A3: k <= len Gauge(C,n) and
A4: 1 <= i and
A5: i <= width Gauge(C,n) and
A6: Gauge(C,n)*(j,i) in L~Upper_Seq(C,n);
  set G = Gauge(C,n);
A7: k >= 1 by A1,A2,XXREAL_0:2;
  then
A8: [k,i] in Indices G by A3,A4,A5,MATRIX_1:37;
  set X = LSeg(G*(j,i),G*(k,i)) /\ L~Upper_Seq(C,n);
A9: G*(j,i) in LSeg(G*(j,i),G*(k,i)) by RLTOPSP1:69;
  then reconsider X1=X as non empty compact Subset of TOP-REAL 2 by A6,
XBOOLE_0:def 4;
A10: LSeg(G*(j,i),G*(k,i)) meets L~Upper_Seq(C,n) by A6,A9,XBOOLE_0:3;
  set s = G*(1,i)`2;
  set e = G*(k,i);
  set f = G*(j,i);
  set w2 = upper_bound(proj1.:(LSeg(f,e) /\ L~Upper_Seq(C,n)));
A11: len G = width G by JORDAN8:def 1;
  then
A12: j <= width G by A2,A3,XXREAL_0:2;
  then [j,i] in Indices G by A1,A4,A5,A11,MATRIX_1:37;
  then consider j1 be Element of NAT such that
A13: j <= j1 and
A14: j1 <= k and
A15: G*(j1,i)`1 = w2 by A2,A10,A8,JORDAN1F:4,JORDAN1G:4;
  set q = |[w2,s]|;
A16: 1 <= j1 by A1,A13,XXREAL_0:2;
  take j1;
  thus j <= j1 & j1 <= k by A13,A14;
  consider pp be set such that
A17: pp in E-most X1 by XBOOLE_0:def 1;
  reconsider pp as Point of TOP-REAL 2 by A17;
A18: pp in X by A17,XBOOLE_0:def 4;
  then
A19: pp in L~Upper_Seq(C,n) by XBOOLE_0:def 4;
A20: j1 <= width G by A3,A11,A14,XXREAL_0:2;
  then
A21: G*(j1,i)`2 = s by A4,A5,A11,A16,GOBOARD5:2;
  then
A22: q = G*(j1,i) by A15,EUCLID:57;
  then
A23: q`1 <= e`1 by A3,A4,A5,A14,A16,SPRECT_3:25;
A24: G*(k,i)`2 = s by A3,A4,A5,A7,GOBOARD5:2;
  then f`2 = e`2 by A1,A4,A5,A11,A12,GOBOARD5:2;
  then
A25: LSeg(f,e) is horizontal by SPPOL_1:36;
A26: q`1 = E-bound X by A15,A22,SPRECT_1:51
    .= (E-min X)`1 by EUCLID:56
    .= pp`1 by A17,PSCOMP_1:108;
  pp in LSeg(G*(j,i),G*(k,i)) by A18,XBOOLE_0:def 4;
  then pp`2 = q`2 by A24,A21,A22,A25,SPPOL_1:63;
  then
A27: q in L~Upper_Seq(C,n) by A19,A26,TOPREAL3:11;
  for x be set holds x in LSeg(e,q) /\ L~Upper_Seq(C,n) iff x = q
  proof
    let x be set;
    thus x in LSeg(e,q) /\ L~Upper_Seq(C,n) implies x = q
    proof
A28:  f`1 <= q`1 by A1,A4,A5,A11,A13,A20,A22,SPRECT_3:25;
      f`2 = q`2 by A1,A4,A5,A11,A12,A21,A22,GOBOARD5:2;
      then
A29:  q in LSeg(e,f) by A24,A21,A22,A23,A28,GOBOARD7:9;
      e in LSeg(f,e) by RLTOPSP1:69;
      then
A30:  LSeg(e,q) c= LSeg(f,e) by A29,TOPREAL1:12;
      reconsider EE = LSeg(f,e) /\ L~Upper_Seq(C,n) as compact Subset of
      TOP-REAL 2;
      reconsider E0 = proj1.:EE as compact Subset of REAL by Th4;
      assume
A31:  x in LSeg(e,q) /\ L~Upper_Seq(C,n);
      then reconsider pp = x as Point of TOP-REAL 2;
A32:  pp in LSeg(e,q) by A31,XBOOLE_0:def 4;
      then
A33:  pp`1 >= q`1 by A23,TOPREAL1:9;
      pp in L~Upper_Seq(C,n) by A31,XBOOLE_0:def 4;
      then pp in EE by A32,A30,XBOOLE_0:def 4;
      then proj1.pp in E0 by FUNCT_2:43;
      then
A34:  pp`1 in E0 by PSCOMP_1:def 28;
      E0 is bounded by RCOMP_1:28;
      then E0 is bounded_above by XXREAL_2:def 11;
      then q`1 >= pp`1 by A15,A22,A34,SEQ_4:def 4;
      then
A35:  pp`1 = q`1 by A33,XXREAL_0:1;
      pp`2 = q`2 by A24,A21,A22,A32,GOBOARD7:6;
      hence thesis by A35,TOPREAL3:11;
    end;
    assume
A36: x = q;
    then x in LSeg(e,q) by RLTOPSP1:69;
    hence thesis by A27,A36,XBOOLE_0:def 4;
  end;
  hence thesis by A22,TARSKI:def 1;
end;

theorem
  for C be compact connected non vertical non horizontal Subset of
TOP-REAL 2 for i,j,k be Element of NAT st 1 <= j & j <= k & k <= len Gauge(C,n)
  & 1 <= i & i <= width Gauge(C,n) & Gauge(C,n)*(k,i) in L~Lower_Seq(C,n) ex k1
be Element of NAT st j <= k1 & k1 <= k & LSeg(Gauge(C,n)*(j,i),Gauge(C,n)*(k1,i
  )) /\ L~Lower_Seq(C,n) = {Gauge(C,n)*(k1,i)}
proof
  let C be compact connected non vertical non horizontal Subset of TOP-REAL 2;
  let i,j,k be Element of NAT;
  assume that
A1: 1 <= j and
A2: j <= k and
A3: k <= len Gauge(C,n) and
A4: 1 <= i and
A5: i <= width Gauge(C,n) and
A6: Gauge(C,n)*(k,i) in L~Lower_Seq(C,n);
  set G = Gauge(C,n);
A7: k >= 1 by A1,A2,XXREAL_0:2;
  then
A8: [k,i] in Indices G by A3,A4,A5,MATRIX_1:37;
  set X = LSeg(G*(j,i),G*(k,i)) /\ L~Lower_Seq(C,n);
A9: G*(k,i) in LSeg(G*(j,i),G*(k,i)) by RLTOPSP1:69;
  then reconsider X1=X as non empty compact Subset of TOP-REAL 2 by A6,
XBOOLE_0:def 4;
A10: LSeg(G*(j,i),G*(k,i)) meets L~Lower_Seq(C,n) by A6,A9,XBOOLE_0:3;
  set s = G*(1,i)`2;
  set e = G*(k,i);
  set f = G*(j,i);
  set w1 = lower_bound(proj1.:(LSeg(f,e) /\ L~Lower_Seq(C,n)));
A11: len G = width G by JORDAN8:def 1;
  then
A12: j <= width G by A2,A3,XXREAL_0:2;
  then [j,i] in Indices G by A1,A4,A5,A11,MATRIX_1:37;
  then consider k1 be Element of NAT such that
A13: j <= k1 and
A14: k1 <= k and
A15: G*(k1,i)`1 = w1 by A2,A10,A8,JORDAN1F:3,JORDAN1G:5;
  set p = |[w1,s]|;
A16: k1 <= width G by A3,A11,A14,XXREAL_0:2;
  f`2 = s by A1,A4,A5,A11,A12,GOBOARD5:2
    .= e`2 by A3,A4,A5,A7,GOBOARD5:2;
  then
A17: LSeg(f,e) is horizontal by SPPOL_1:36;
  take k1;
  thus j <= k1 & k1 <= k by A13,A14;
  consider pp be set such that
A18: pp in W-most X1 by XBOOLE_0:def 1;
A19: 1 <= k1 by A1,A13,XXREAL_0:2;
  then
A20: G*(k1,i)`2 = s by A4,A5,A11,A16,GOBOARD5:2;
  then
A21: p = G*(k1,i) by A15,EUCLID:57;
  then
A22: f`1 <= p`1 by A1,A4,A5,A11,A13,A16,SPRECT_3:25;
A23: f`2 = p`2 by A1,A4,A5,A11,A12,A20,A21,GOBOARD5:2;
  reconsider pp as Point of TOP-REAL 2 by A18;
A24: pp in X by A18,XBOOLE_0:def 4;
  then
A25: pp in L~Lower_Seq(C,n) by XBOOLE_0:def 4;
A26: p`1 = W-bound X by A15,A21,SPRECT_1:48
    .= (W-min X)`1 by EUCLID:56
    .= pp`1 by A18,PSCOMP_1:88;
  pp in LSeg(G*(j,i),G*(k,i)) by A24,XBOOLE_0:def 4;
  then pp`2 = p`2 by A23,A17,SPPOL_1:63;
  then
A27: p in L~Lower_Seq(C,n) by A25,A26,TOPREAL3:11;
  for x be set holds x in LSeg(p,f) /\ L~Lower_Seq(C,n) iff x = p
  proof
    let x be set;
    thus x in LSeg(p,f) /\ L~Lower_Seq(C,n) implies x = p
    proof
      reconsider EE = LSeg(f,e) /\ L~Lower_Seq(C,n) as compact Subset of
      TOP-REAL 2;
      assume
A28:  x in LSeg(p,f) /\ L~Lower_Seq(C,n);
      then reconsider pp = x as Point of TOP-REAL 2;
A29:  pp in LSeg(p,f) by A28,XBOOLE_0:def 4;
      then
A30:  pp`1 <= p`1 by A22,TOPREAL1:9;
A31:  p`1 <= e`1 by A3,A4,A5,A14,A19,A21,SPRECT_3:25;
A32:  f`1 <= p`1 by A1,A4,A5,A11,A13,A16,A21,SPRECT_3:25;
A33:  e`2 = p`2 by A3,A4,A5,A7,A20,A21,GOBOARD5:2;
      reconsider E0 = proj1.:EE as compact Subset of REAL by Th4;
A34:  f in LSeg(f,e) by RLTOPSP1:69;
      f`2 = p`2 by A1,A4,A5,A11,A12,A20,A21,GOBOARD5:2;
      then p in LSeg(f,e) by A33,A32,A31,GOBOARD7:9;
      then
A35:  LSeg(p,f) c= LSeg(f,e) by A34,TOPREAL1:12;
      pp in L~Lower_Seq(C,n) by A28,XBOOLE_0:def 4;
      then pp in EE by A29,A35,XBOOLE_0:def 4;
      then proj1.pp in E0 by FUNCT_2:43;
      then
A36:  pp`1 in E0 by PSCOMP_1:def 28;
      E0 is bounded by RCOMP_1:28;
      then E0 is bounded_below by XXREAL_2:def 11;
      then p`1 <= pp`1 by A15,A21,A36,SEQ_4:def 5;
      then
A37:  pp`1 = p`1 by A30,XXREAL_0:1;
      pp`2 = p`2 by A23,A29,GOBOARD7:6;
      hence thesis by A37,TOPREAL3:11;
    end;
    assume
A38: x = p;
    then x in LSeg(p,f) by RLTOPSP1:69;
    hence thesis by A27,A38,XBOOLE_0:def 4;
  end;
  hence thesis by A21,TARSKI:def 1;
end;

theorem Th22:
  for C be compact connected non vertical non horizontal Subset of
TOP-REAL 2 for i,j,k be Element of NAT st 1 <= j & j <= k & k <= len Gauge(C,n)
& 1 <= i & i <= width Gauge(C,n) & Gauge(C,n)*(j,i) in L~Upper_Seq(C,n) & Gauge
  (C,n)*(k,i) in L~Lower_Seq(C,n) ex j1,k1 be Element of NAT st j <= j1 & j1 <=
k1 & k1 <= k & LSeg(Gauge(C,n)*(j1,i),Gauge(C,n)*(k1,i)) /\ L~Upper_Seq(C,n) =
{Gauge(C,n)*(j1,i)} & LSeg(Gauge(C,n)*(j1,i),Gauge(C,n)*(k1,i)) /\ L~Lower_Seq(
  C,n) = {Gauge(C,n)*(k1,i)}
proof
  let C be compact connected non vertical non horizontal Subset of TOP-REAL 2;
  let i,j,k be Element of NAT;
  assume that
A1: 1 <= j and
A2: j <= k and
A3: k <= len Gauge(C,n) and
A4: 1 <= i and
A5: i <= width Gauge(C,n) and
A6: Gauge(C,n)*(j,i) in L~Upper_Seq(C,n) and
A7: Gauge(C,n)*(k,i) in L~Lower_Seq(C,n);
  set G = Gauge(C,n);
A8: len G = width G by JORDAN8:def 1;
  then
A9: j <= width G by A2,A3,XXREAL_0:2;
  then
A10: [j,i] in Indices G by A1,A4,A5,A8,MATRIX_1:37;
  set s = G*(1,i)`2;
  set e = G*(k,i);
  set f = G*(j,i);
  set w1 = lower_bound(proj1.:(LSeg(f,e) /\ L~Lower_Seq(C,n)));
A11: G*(k,i) in LSeg(G*(j,i),G*(k,i)) by RLTOPSP1:69;
  then
A12: LSeg(G*(j,i),G*(k,i)) meets L~Lower_Seq(C,n) by A7,XBOOLE_0:3;
A13: k >= 1 by A1,A2,XXREAL_0:2;
  then [k,i] in Indices G by A3,A4,A5,MATRIX_1:37;
  then consider k1 be Element of NAT such that
A14: j <= k1 and
A15: k1 <= k and
A16: G*(k1,i)`1 = w1 by A2,A12,A10,JORDAN1F:3,JORDAN1G:5;
A17: k1 <= width G by A3,A8,A15,XXREAL_0:2;
  set p = |[w1,s]|;
  set w2 = upper_bound(proj1.:(LSeg(f,p) /\ L~Upper_Seq(C,n)));
  set q = |[w2,s]|;
A18: G*(j,i) in LSeg(G*(j,i),G*(k1,i)) by RLTOPSP1:69;
  then
A19: LSeg(G*(j,i),G*(k1,i)) meets L~Upper_Seq(C,n) by A6,XBOOLE_0:3;
A20: 1 <= k1 by A1,A14,XXREAL_0:2;
  then
A21: G*(k1,i)`2 = s by A4,A5,A8,A17,GOBOARD5:2;
  then
A22: p = G*(k1,i) by A16,EUCLID:57;
  f`2 = s by A1,A4,A5,A8,A9,GOBOARD5:2
    .= e`2 by A3,A4,A5,A13,GOBOARD5:2;
  then
A23: LSeg(f,e) is horizontal by SPPOL_1:36;
  set X = LSeg(G*(j,i),G*(k1,i)) /\ L~Upper_Seq(C,n);
  reconsider X1=X as non empty compact Subset of TOP-REAL 2 by A6,A18,
XBOOLE_0:def 4;
  consider pp be set such that
A24: pp in E-most X1 by XBOOLE_0:def 1;
  [k1,i] in Indices G by A4,A5,A8,A20,A17,MATRIX_1:37;
  then consider j1 be Element of NAT such that
A25: j <= j1 and
A26: j1 <= k1 and
A27: G*(j1,i)`1 = w2 by A10,A14,A22,A19,JORDAN1F:4,JORDAN1G:4;
A28: j1 <= width G by A17,A26,XXREAL_0:2;
  reconsider pp as Point of TOP-REAL 2 by A24;
A29: pp in X by A24,XBOOLE_0:def 4;
  then
A30: pp in L~Upper_Seq(C,n) by XBOOLE_0:def 4;
  take j1,k1;
  thus j <= j1 & j1 <= k1 & k1 <= k by A15,A25,A26;
A31: pp in LSeg(G*(j,i),G*(k1,i)) by A29,XBOOLE_0:def 4;
A32: 1 <= j1 by A1,A25,XXREAL_0:2;
  then
A33: G*(j1,i)`2 = s by A4,A5,A8,A28,GOBOARD5:2;
  then
A34: q = G*(j1,i) by A27,EUCLID:57;
  then
A35: q`1 <= p`1 by A4,A5,A8,A17,A22,A26,A32,SPRECT_3:25;
A36: q`1 = E-bound X by A22,A27,A34,SPRECT_1:51
    .= (E-min X)`1 by EUCLID:56
    .= pp`1 by A24,PSCOMP_1:108;
A37: f`2 = p`2 by A1,A4,A5,A8,A9,A21,A22,GOBOARD5:2;
  then LSeg(f,p) is horizontal by SPPOL_1:36;
  then pp`2 = q`2 by A21,A22,A33,A34,A31,SPPOL_1:63;
  then
A38: q in L~Upper_Seq(C,n) by A30,A36,TOPREAL3:11;
  for x be set holds x in LSeg(p,q) /\ L~Upper_Seq(C,n) iff x = q
  proof
    let x be set;
    thus x in LSeg(p,q) /\ L~Upper_Seq(C,n) implies x = q
    proof
      reconsider EE = LSeg(f,p) /\ L~Upper_Seq(C,n) as compact Subset of
      TOP-REAL 2;
      assume
A39:  x in LSeg(p,q) /\ L~Upper_Seq(C,n);
      then reconsider pp = x as Point of TOP-REAL 2;
A40:  pp in LSeg(p,q) by A39,XBOOLE_0:def 4;
      then
A41:  pp`1 >= q`1 by A35,TOPREAL1:9;
A42:  f`1 <= q`1 by A1,A4,A5,A8,A25,A28,A34,SPRECT_3:25;
      reconsider E0 = proj1.:EE as compact Subset of REAL by Th4;
A43:  p in LSeg(f,p) by RLTOPSP1:69;
      f`2 = q`2 by A1,A4,A5,A8,A9,A33,A34,GOBOARD5:2;
      then q in LSeg(p,f) by A21,A22,A33,A34,A35,A42,GOBOARD7:9;
      then
A44:  LSeg(p,q) c= LSeg(f,p) by A43,TOPREAL1:12;
      pp in L~Upper_Seq(C,n) by A39,XBOOLE_0:def 4;
      then pp in EE by A40,A44,XBOOLE_0:def 4;
      then proj1.pp in E0 by FUNCT_2:43;
      then
A45:  pp`1 in E0 by PSCOMP_1:def 28;
      E0 is bounded by RCOMP_1:28;
      then E0 is bounded_above by XXREAL_2:def 11;
      then q`1 >= pp`1 by A27,A34,A45,SEQ_4:def 4;
      then
A46:  pp`1 = q`1 by A41,XXREAL_0:1;
      pp`2 = q`2 by A21,A22,A33,A34,A40,GOBOARD7:6;
      hence thesis by A46,TOPREAL3:11;
    end;
    assume
A47: x = q;
    then x in LSeg(p,q) by RLTOPSP1:69;
    hence thesis by A38,A47,XBOOLE_0:def 4;
  end;
  hence
  LSeg(Gauge(C,n)*(j1,i),Gauge(C,n)*(k1,i)) /\ L~Upper_Seq(C,n) = {Gauge(
  C,n)*(j1,i)} by A22,A34,TARSKI:def 1;
  set X = LSeg(G*(j,i),G*(k,i)) /\ L~Lower_Seq(C,n);
  reconsider X1=X as non empty compact Subset of TOP-REAL 2 by A7,A11,
XBOOLE_0:def 4;
  consider pp be set such that
A48: pp in W-most X1 by XBOOLE_0:def 1;
  reconsider pp as Point of TOP-REAL 2 by A48;
A49: pp in X by A48,XBOOLE_0:def 4;
  then
A50: pp in L~Lower_Seq(C,n) by XBOOLE_0:def 4;
  pp in LSeg(G*(j,i),G*(k,i)) by A49,XBOOLE_0:def 4;
  then
A51: pp`2 = p`2 by A37,A23,SPPOL_1:63;
  p`1 = W-bound X by A16,A22,SPRECT_1:48
    .= (W-min X)`1 by EUCLID:56
    .= pp`1 by A48,PSCOMP_1:88;
  then
A52: p in L~Lower_Seq(C,n) by A50,A51,TOPREAL3:11;
  for x be set holds x in LSeg(p,q) /\ L~Lower_Seq(C,n) iff x = p
  proof
    let x be set;
    thus x in LSeg(p,q) /\ L~Lower_Seq(C,n) implies x = p
    proof
      j1 <= k by A15,A26,XXREAL_0:2;
      then
A53:  q`1 <= e`1 by A3,A4,A5,A32,A34,SPRECT_3:25;
A54:  e`2 = p`2 by A3,A4,A5,A13,A21,A22,GOBOARD5:2;
A55:  f`1 <= p`1 by A1,A4,A5,A8,A14,A17,A22,SPRECT_3:25;
A56:  f`1 <= q`1 by A1,A4,A5,A8,A25,A28,A34,SPRECT_3:25;
A57:  p`1 <= e`1 by A3,A4,A5,A15,A20,A22,SPRECT_3:25;
      f`2 = p`2 by A1,A4,A5,A8,A9,A21,A22,GOBOARD5:2;
      then
A58:  p in LSeg(f,e) by A54,A55,A57,GOBOARD7:9;
A59:  e`2 = q`2 by A3,A4,A5,A13,A33,A34,GOBOARD5:2;
      f`2 = q`2 by A1,A4,A5,A8,A9,A33,A34,GOBOARD5:2;
      then q in LSeg(f,e) by A59,A56,A53,GOBOARD7:9;
      then
A60:  LSeg(p,q) c= LSeg(f,e) by A58,TOPREAL1:12;
      reconsider EE = LSeg(f,e) /\ L~Lower_Seq(C,n) as compact Subset of
      TOP-REAL 2;
      reconsider E0 = proj1.:EE as compact Subset of REAL by Th4;
      assume
A61:  x in LSeg(p,q) /\ L~Lower_Seq(C,n);
      then reconsider pp = x as Point of TOP-REAL 2;
A62:  pp in LSeg(p,q) by A61,XBOOLE_0:def 4;
      then
A63:  pp`1 <= p`1 by A35,TOPREAL1:9;
      pp in L~Lower_Seq(C,n) by A61,XBOOLE_0:def 4;
      then pp in EE by A62,A60,XBOOLE_0:def 4;
      then proj1.pp in E0 by FUNCT_2:43;
      then
A64:  pp`1 in E0 by PSCOMP_1:def 28;
      E0 is bounded by RCOMP_1:28;
      then E0 is bounded_below by XXREAL_2:def 11;
      then p`1 <= pp`1 by A16,A22,A64,SEQ_4:def 5;
      then
A65:  pp`1 = p`1 by A63,XXREAL_0:1;
      pp`2 = p`2 by A21,A22,A33,A34,A62,GOBOARD7:6;
      hence thesis by A65,TOPREAL3:11;
    end;
    assume
A66: x = p;
    then x in LSeg(p,q) by RLTOPSP1:69;
    hence thesis by A52,A66,XBOOLE_0:def 4;
  end;
  hence thesis by A22,A34,TARSKI:def 1;
end;

theorem Th23:
  for C be Simple_closed_curve for i,j,k be Element of NAT st 1 <
i & i < len Gauge(C,n) & 1 <= j & j <= k & k <= width Gauge(C,n) & Gauge(C,n)*(
  i,k) in L~Upper_Seq(C,n) & Gauge(C,n)*(i,j) in L~Lower_Seq(C,n) holds LSeg(
  Gauge(C,n)*(i,j),Gauge(C,n)*(i,k)) meets Lower_Arc C
proof
  let C be Simple_closed_curve;
  let i,j,k be Element of NAT;
  assume that
A1: 1 < i and
A2: i < len Gauge(C,n) and
A3: 1 <= j and
A4: j <= k and
A5: k <= width Gauge(C,n) and
A6: Gauge(C,n)*(i,k) in L~Upper_Seq(C,n) and
A7: Gauge(C,n)*(i,j) in L~Lower_Seq(C,n);
  consider j1,k1 be Element of NAT such that
A8: j <= j1 and
A9: j1 <= k1 and
A10: k1 <= k and
A11: LSeg(Gauge(C,n)*(i,j1),Gauge(C,n)*(i,k1)) /\ L~Lower_Seq(C,n) = {
  Gauge(C,n)*(i,j1)} and
A12: LSeg(Gauge(C,n)*(i,j1),Gauge(C,n)*(i,k1)) /\ L~Upper_Seq(C,n) = {
  Gauge(C,n)*(i,k1)} by A1,A2,A3,A4,A5,A6,A7,Th13;
A13: k1 <= width Gauge(C,n) by A5,A10,XXREAL_0:2;
  1 <= j1 by A3,A8,XXREAL_0:2;
  then
  LSeg(Gauge(C,n)*(i,j1),Gauge(C,n)*(i,k1)) meets Lower_Arc C by A1,A2,A9,A11
,A12,A13,JORDAN1J:58;
  hence thesis by A1,A2,A3,A5,A8,A9,A10,Th7,XBOOLE_1:63;
end;

theorem Th24:
  for C be Simple_closed_curve for i,j,k be Element of NAT st 1 <
i & i < len Gauge(C,n) & 1 <= j & j <= k & k <= width Gauge(C,n) & Gauge(C,n)*(
  i,k) in L~Upper_Seq(C,n) & Gauge(C,n)*(i,j) in L~Lower_Seq(C,n) holds LSeg(
  Gauge(C,n)*(i,j),Gauge(C,n)*(i,k)) meets Upper_Arc C
proof
  let C be Simple_closed_curve;
  let i,j,k be Element of NAT;
  assume that
A1: 1 < i and
A2: i < len Gauge(C,n) and
A3: 1 <= j and
A4: j <= k and
A5: k <= width Gauge(C,n) and
A6: Gauge(C,n)*(i,k) in L~Upper_Seq(C,n) and
A7: Gauge(C,n)*(i,j) in L~Lower_Seq(C,n);
  consider j1,k1 be Element of NAT such that
A8: j <= j1 and
A9: j1 <= k1 and
A10: k1 <= k and
A11: LSeg(Gauge(C,n)*(i,j1),Gauge(C,n)*(i,k1)) /\ L~Lower_Seq(C,n) = {
  Gauge(C,n)*(i,j1)} and
A12: LSeg(Gauge(C,n)*(i,j1),Gauge(C,n)*(i,k1)) /\ L~Upper_Seq(C,n) = {
  Gauge(C,n)*(i,k1)} by A1,A2,A3,A4,A5,A6,A7,Th13;
A13: k1 <= width Gauge(C,n) by A5,A10,XXREAL_0:2;
  1 <= j1 by A3,A8,XXREAL_0:2;
  then
  LSeg(Gauge(C,n)*(i,j1),Gauge(C,n)*(i,k1)) meets Upper_Arc C by A1,A2,A9,A11
,A12,A13,JORDAN1J:59;
  hence thesis by A1,A2,A3,A5,A8,A9,A10,Th7,XBOOLE_1:63;
end;

theorem Th25:
  for C be Simple_closed_curve for i,j,k be Element of NAT st 1 <
  i & i < len Gauge(C,n) & 1 <= j & j <= k & k <= width Gauge(C,n) & n > 0 &
  Gauge(C,n)*(i,k) in Upper_Arc L~Cage(C,n) & Gauge(C,n)*(i,j) in Lower_Arc L~
  Cage(C,n) holds LSeg(Gauge(C,n)*(i,j),Gauge(C,n)*(i,k)) meets Lower_Arc C
proof
  let C be Simple_closed_curve;
  let i,j,k be Element of NAT;
  assume that
A1: 1 < i and
A2: i < len Gauge(C,n) and
A3: 1 <= j and
A4: j <= k and
A5: k <= width Gauge(C,n) and
A6: n > 0 and
A7: Gauge(C,n)*(i,k) in Upper_Arc L~Cage(C,n) and
A8: Gauge(C,n)*(i,j) in Lower_Arc L~Cage(C,n);
A9: L~Lower_Seq(C,n) = Lower_Arc L~Cage(C,n) by A6,JORDAN1G:64;
  L~Upper_Seq(C,n) = Upper_Arc L~Cage(C,n) by A6,JORDAN1G:63;
  hence thesis by A1,A2,A3,A4,A5,A7,A8,A9,Th23;
end;

theorem Th26:
  for C be Simple_closed_curve for i,j,k be Element of NAT st 1 <
  i & i < len Gauge(C,n) & 1 <= j & j <= k & k <= width Gauge(C,n) & n > 0 &
  Gauge(C,n)*(i,k) in Upper_Arc L~Cage(C,n) & Gauge(C,n)*(i,j) in Lower_Arc L~
  Cage(C,n) holds LSeg(Gauge(C,n)*(i,j),Gauge(C,n)*(i,k)) meets Upper_Arc C
proof
  let C be Simple_closed_curve;
  let i,j,k be Element of NAT;
  assume that
A1: 1 < i and
A2: i < len Gauge(C,n) and
A3: 1 <= j and
A4: j <= k and
A5: k <= width Gauge(C,n) and
A6: n > 0 and
A7: Gauge(C,n)*(i,k) in Upper_Arc L~Cage(C,n) and
A8: Gauge(C,n)*(i,j) in Lower_Arc L~Cage(C,n);
A9: L~Lower_Seq(C,n) = Lower_Arc L~Cage(C,n) by A6,JORDAN1G:64;
  L~Upper_Seq(C,n) = Upper_Arc L~Cage(C,n) by A6,JORDAN1G:63;
  hence thesis by A1,A2,A3,A4,A5,A7,A8,A9,Th24;
end;

theorem
  for C be Simple_closed_curve for j,k be Element of NAT holds 1 <= j &
  j <= k & k <= width Gauge(C,n+1) & Gauge(C,n+1)*(Center Gauge(C,n+1),k) in
Upper_Arc L~Cage(C,n+1) & Gauge(C,n+1)*(Center Gauge(C,n+1),j) in Lower_Arc L~
  Cage(C,n+1) implies LSeg(Gauge(C,n+1)*(Center Gauge(C,n+1),j), Gauge(C,n+1)*(
  Center Gauge(C,n+1),k)) meets Lower_Arc C
proof
  let C be Simple_closed_curve;
  let j,k be Element of NAT;
  assume that
A1: 1 <= j and
A2: j <= k and
A3: k <= width Gauge(C,n+1) and
A4: Gauge(C,n+1)*(Center Gauge(C,n+1),k) in Upper_Arc L~Cage(C,n+1) and
A5: Gauge(C,n+1)*(Center Gauge(C,n+1),j) in Lower_Arc L~Cage(C,n+1);
A6: len Gauge(C,n+1) >= 4 by JORDAN8:13;
  then len Gauge(C,n+1) >= 2 by XXREAL_0:2;
  then
A7: 1 < Center Gauge(C,n+1) by JORDAN1B:15;
  len Gauge(C,n+1) >= 3 by A6,XXREAL_0:2;
  hence thesis by A1,A2,A3,A4,A5,A7,Th25,JORDAN1B:16;
end;

theorem
  for C be Simple_closed_curve for j,k be Element of NAT holds 1 <= j &
  j <= k & k <= width Gauge(C,n+1) & Gauge(C,n+1)*(Center Gauge(C,n+1),k) in
Upper_Arc L~Cage(C,n+1) & Gauge(C,n+1)*(Center Gauge(C,n+1),j) in Lower_Arc L~
  Cage(C,n+1) implies LSeg(Gauge(C,n+1)*(Center Gauge(C,n+1),j), Gauge(C,n+1)*(
  Center Gauge(C,n+1),k)) meets Upper_Arc C
proof
  let C be Simple_closed_curve;
  let j,k be Element of NAT;
  assume that
A1: 1 <= j and
A2: j <= k and
A3: k <= width Gauge(C,n+1) and
A4: Gauge(C,n+1)*(Center Gauge(C,n+1),k) in Upper_Arc L~Cage(C,n+1) and
A5: Gauge(C,n+1)*(Center Gauge(C,n+1),j) in Lower_Arc L~Cage(C,n+1);
A6: len Gauge(C,n+1) >= 4 by JORDAN8:13;
  then len Gauge(C,n+1) >= 2 by XXREAL_0:2;
  then
A7: 1 < Center Gauge(C,n+1) by JORDAN1B:15;
  len Gauge(C,n+1) >= 3 by A6,XXREAL_0:2;
  hence thesis by A1,A2,A3,A4,A5,A7,Th26,JORDAN1B:16;
end;

theorem Th29:
  for C be compact connected non vertical non horizontal Subset of
TOP-REAL 2 for i,j,k be Element of NAT st 1 < j & k < len Gauge(C,n) & 1 <= i &
i <= width Gauge(C,n) & Gauge(C,n)*(k,i) in L~Upper_Seq(C,n) & Gauge(C,n)*(j,i)
  in L~Lower_Seq(C,n) holds j <> k
proof
  let C be compact connected non vertical non horizontal Subset of TOP-REAL 2;
  let i,j,k be Element of NAT;
  assume that
A1: 1 < j and
A2: k < len Gauge(C,n) and
A3: 1 <= i and
A4: i <= width Gauge(C,n) and
A5: Gauge(C,n)*(k,i) in L~Upper_Seq(C,n) and
A6: Gauge(C,n)*(j,i) in L~Lower_Seq(C,n) and
A7: j = k;
A8: [j,i] in Indices Gauge(C,n) by A1,A2,A3,A4,A7,MATRIX_1:37;
  Gauge(C,n)*(k,i) in L~Upper_Seq(C,n) /\ L~Lower_Seq(C,n) by A5,A6,A7,
XBOOLE_0:def 4;
  then
A9: Gauge(C,n)*(k,i) in {W-min L~Cage(C,n),E-max L~Cage(C,n)} by JORDAN1E:20;
A10: len Gauge(C,n) = width Gauge(C,n) by JORDAN8:def 1;
  len Gauge(C,n) >= 4 by JORDAN8:13;
  then
A11: len Gauge(C,n) >= 1 by XXREAL_0:2;
  then
A12: [len Gauge(C,n),i] in Indices Gauge(C,n) by A3,A4,MATRIX_1:37;
A13: [1,i] in Indices Gauge(C,n) by A3,A4,A11,MATRIX_1:37;
  per cases by A9,TARSKI:def 2;
  suppose
A14: Gauge(C,n)*(k,i) = W-min L~Cage(C,n);
    Gauge(C,n)*(1,i)`1 = W-bound L~Cage(C,n) by A3,A4,A10,JORDAN1A:94;
    then
(W-min L~Cage(C,n))`1 <> W-bound L~Cage(C,n) by A1,A7,A8,A13,A14,JORDAN1G:7;
    hence contradiction by EUCLID:56;
  end;
  suppose
A15: Gauge(C,n)*(k,i) = E-max L~Cage(C,n);
    Gauge(C,n)*(len Gauge(C,n),i)`1 = E-bound L~Cage(C,n) by A3,A4,A10,
JORDAN1A:92;
    then
(E-max L~Cage(C,n))`1 <> E-bound L~Cage(C,n) by A2,A7,A8,A12,A15,JORDAN1G:7;
    hence contradiction by EUCLID:56;
  end;
end;

theorem Th30:
  for C be Simple_closed_curve for i,j,k be Element of NAT st 1 <
j & j <= k & k < len Gauge(C,n) & 1 <= i & i <= width Gauge(C,n) & LSeg(Gauge(C
  ,n)*(j,i),Gauge(C,n)*(k,i)) /\ L~Upper_Seq(C,n) = {Gauge(C,n)*(k,i)} & LSeg(
  Gauge(C,n)*(j,i),Gauge(C,n)*(k,i)) /\ L~Lower_Seq(C,n) = {Gauge(C,n)*(j,i)}
  holds LSeg(Gauge(C,n)*(j,i),Gauge(C,n)*(k,i)) meets Lower_Arc C
proof
  let C be Simple_closed_curve;
  let i,j,k be Element of NAT;
  set Ga = Gauge(C,n);
  set US = Upper_Seq(C,n);
  set LS = Lower_Seq(C,n);
  set LA = Lower_Arc C;
  set Wmin = W-min L~Cage(C,n);
  set Emax = E-max L~Cage(C,n);
  set Wbo = W-bound L~Cage(C,n);
  set Ebo = E-bound L~Cage(C,n);
  set Gij = Ga*(j,i);
  set Gik = Ga*(k,i);
  assume that
A1: 1 < j and
A2: j <= k and
A3: k < len Ga and
A4: 1 <= i and
A5: i <= width Ga and
A6: LSeg(Gij,Gik) /\ L~US = {Gik} and
A7: LSeg(Gij,Gik) /\ L~LS = {Gij} and
A8: LSeg(Gij,Gik) misses LA;
  Gij in {Gij} by TARSKI:def 1;
  then
A9: Gij in L~LS by A7,XBOOLE_0:def 4;
  Gik in {Gik} by TARSKI:def 1;
  then
A10: Gik in L~US by A6,XBOOLE_0:def 4;
A11: len Ga = width Ga by JORDAN8:def 1;
A12: j <> k by A1,A3,A4,A5,A9,A10,Th29;
A13: j <= width Ga by A2,A3,A11,XXREAL_0:2;
A14: 1 <= k by A1,A2,XXREAL_0:2;
A15: k <= width Ga by A3,JORDAN8:def 1;
A16: [j,i] in Indices Ga by A1,A4,A5,A11,A13,MATRIX_1:37;
A17: [k,i] in Indices Ga by A3,A4,A5,A14,MATRIX_1:37;
  set go = R_Cut(US,Gik);
  set do = L_Cut(LS,Gij);
A18: len US >= 3 by JORDAN1E:19;
  then len US >= 1 by XXREAL_0:2;
  then 1 in dom US by FINSEQ_3:27;
  then
A19: US.1 = US/.1 by PARTFUN1:def 8
    .= Wmin by JORDAN1F:5;
A20: Wmin`1 = Wbo by EUCLID:56
    .= Ga*(1,k)`1 by A3,A14,JORDAN1A:94;
  len Ga >= 4 by JORDAN8:13;
  then
A21: len Ga >= 1 by XXREAL_0:2;
  then
A22: [1,k] in Indices Ga by A14,A15,MATRIX_1:37;
  then
A23: Gik <> US.1 by A1,A2,A17,A19,A20,JORDAN1G:7;
  then reconsider go as being_S-Seq FinSequence of TOP-REAL 2 by A10,JORDAN3:70
;
A24: [1,j] in Indices Ga by A1,A13,A21,MATRIX_1:37;
A25: len LS >= 1+2 by JORDAN1E:19;
  then
A26: len LS >= 1 by XXREAL_0:2;
  then
A27: 1 in dom LS by FINSEQ_3:27;
  len LS in dom LS by A26,FINSEQ_3:27;
  then
A28: LS.len LS = LS/.len LS by PARTFUN1:def 8
    .= Wmin by JORDAN1F:8;
A29: Wmin`1 = Wbo by EUCLID:56
    .= Ga*(1,k)`1 by A3,A14,JORDAN1A:94;
A30: [j,i] in Indices Ga by A1,A4,A5,A11,A13,MATRIX_1:37;
  then
A31: Gij <> LS.len LS by A1,A22,A28,A29,JORDAN1G:7;
  then reconsider do as being_S-Seq FinSequence of TOP-REAL 2 by A9,JORDAN3:69;
A32: [len Ga,k] in Indices Ga by A14,A15,A21,MATRIX_1:37;
A33: LS.1 = LS/.1 by A27,PARTFUN1:def 8
    .= Emax by JORDAN1F:6;
  Emax`1 = Ebo by EUCLID:56
    .= Ga*(len Ga,k)`1 by A3,A14,JORDAN1A:92;
  then
A34: Gij <> LS.1 by A2,A3,A30,A32,A33,JORDAN1G:7;
A35: len go >= 1+1 by TOPREAL1:def 10;
A36: Gik in rng US by A4,A5,A10,A11,A14,A15,JORDAN1G:4,JORDAN1J:40;
  then
A37: go is_sequence_on Ga by JORDAN1G:4,JORDAN1J:38;
A38: len do >= 1+1 by TOPREAL1:def 10;
A39: Gij in rng LS by A1,A4,A5,A9,A11,A13,JORDAN1G:5,JORDAN1J:40;
  then
A40: do is_sequence_on Ga by JORDAN1G:5,JORDAN1J:39;
  reconsider go as non constant s.c.c. (being_S-Seq FinSequence of TOP-REAL 2)
  by A35,A37,JGRAPH_1:16,JORDAN8:8;
  reconsider do as non constant s.c.c. (being_S-Seq FinSequence of TOP-REAL 2)
  by A38,A40,JGRAPH_1:16,JORDAN8:8;
A41: len go > 1 by A35,NAT_1:13;
  then
A42: len go in dom go by FINSEQ_3:27;
  then
A43: go/.len go = go.len go by PARTFUN1:def 8
    .= Gik by A10,JORDAN3:59;
  len do >= 1 by A38,XXREAL_0:2;
  then 1 in dom do by FINSEQ_3:27;
  then
A44: do/.1 = do.1 by PARTFUN1:def 8
    .= Gij by A9,JORDAN3:58;
  reconsider m = len go - 1 as Element of NAT by A42,FINSEQ_3:28;
A45: m+1 = len go;
  then
A46: len go-'1 = m by NAT_D:34;
A47: LSeg(go,m) c= L~go by TOPREAL3:26;
A48: L~go c= L~US by A10,JORDAN3:76;
  then LSeg(go,m) c= L~US by A47,XBOOLE_1:1;
  then
A49: LSeg(go,m) /\ LSeg(Gik,Gij) c= {Gik} by A6,XBOOLE_1:26;
  m >= 1 by A35,XREAL_1:21;
  then
A50: LSeg(go,m) = LSeg(go/.m,Gik) by A43,A45,TOPREAL1:def 5;
  {Gik} c= LSeg(go,m) /\ LSeg(Gik,Gij)
  proof
    let x be set;
A51: Gik in LSeg(Gik,Gij) by RLTOPSP1:69;
    assume x in {Gik};
    then
A52: x = Gik by TARSKI:def 1;
    Gik in LSeg(go,m) by A50,RLTOPSP1:69;
    hence thesis by A52,A51,XBOOLE_0:def 4;
  end;
  then
A53: LSeg(go,m) /\ LSeg(Gik,Gij) = {Gik} by A49,XBOOLE_0:def 10;
A54: LSeg(do,1) c= L~do by TOPREAL3:26;
A55: L~do c= L~LS by A9,JORDAN3:77;
  then LSeg(do,1) c= L~LS by A54,XBOOLE_1:1;
  then
A56: LSeg(do,1) /\ LSeg(Gik,Gij) c= {Gij} by A7,XBOOLE_1:26;
A57: LSeg(do,1) = LSeg(Gij,do/.(1+1)) by A38,A44,TOPREAL1:def 5;
  {Gij} c= LSeg(do,1) /\ LSeg(Gik,Gij)
  proof
    let x be set;
A58: Gij in LSeg(Gik,Gij) by RLTOPSP1:69;
    assume x in {Gij};
    then
A59: x = Gij by TARSKI:def 1;
    Gij in LSeg(do,1) by A57,RLTOPSP1:69;
    hence thesis by A59,A58,XBOOLE_0:def 4;
  end;
  then
A60: LSeg(Gik,Gij) /\ LSeg(do,1) = {Gij} by A56,XBOOLE_0:def 10;
A61: go/.1 = US/.1 by A10,SPRECT_3:39
    .= Wmin by JORDAN1F:5;
  then
A62: go/.1 = LS/.len LS by JORDAN1F:8
    .= do/.len do by A9,JORDAN1J:35;
A63: rng go c= L~go by A35,SPPOL_2:18;
A64: rng do c= L~do by A38,SPPOL_2:18;
A65: {go/.1} c= L~go /\ L~do
  proof
    let x be set;
    assume x in {go/.1};
    then
A66: x = go/.1 by TARSKI:def 1;
    then
A67: x in rng go by FINSEQ_6:46;
    x in rng do by A62,A66,REVROT_1:3;
    hence thesis by A63,A64,A67,XBOOLE_0:def 4;
  end;
A68: LS.1 = LS/.1 by A27,PARTFUN1:def 8
    .= Emax by JORDAN1F:6;
A69: [len Ga,j] in Indices Ga by A1,A13,A21,MATRIX_1:37;
  L~go /\ L~do c= {go/.1}
  proof
    let x be set;
    assume
A70: x in L~go /\ L~do;
    then
A71: x in L~do by XBOOLE_0:def 4;
A72: now
      assume x = Emax;
      then
A73:  Emax = Gij by A9,A68,A71,JORDAN1E:11;
      Ga*(len Ga,j)`1 = Ebo by A1,A11,A13,JORDAN1A:92;
      then Emax`1 <> Ebo by A2,A3,A16,A69,A73,JORDAN1G:7;
      hence contradiction by EUCLID:56;
    end;
    x in L~go by A70,XBOOLE_0:def 4;
    then x in L~US /\ L~LS by A48,A55,A71,XBOOLE_0:def 4;
    then x in {Wmin,Emax} by JORDAN1E:20;
    then x = Wmin or x = Emax by TARSKI:def 2;
    hence thesis by A61,A72,TARSKI:def 1;
  end;
  then
A74: L~go /\ L~do = {go/.1} by A65,XBOOLE_0:def 10;
  set W2 = go/.2;
A75: 2 in dom go by A35,FINSEQ_3:27;
A76: now
    assume Gij`1 = Wbo;
    then Ga*(1,j)`1 = Ga*(j,i)`1 by A1,A11,A13,JORDAN1A:94;
    hence contradiction by A1,A16,A24,JORDAN1G:7;
  end;
  go = mid(US,1,Gik..US) by A36,JORDAN1G:57
    .= US|(Gik..US) by A36,FINSEQ_4:31,FINSEQ_6:122;
  then
A77: W2 = US/.2 by A75,FINSEQ_4:85;
A78: Wmin in rng go by A61,FINSEQ_6:46;
  set pion = <*Gik,Gij*>;
A79: now
    let n be Element of NAT;
    assume n in dom pion;
    then n in {1,2} by FINSEQ_1:4,FINSEQ_3:29;
    then n = 1 or n = 2 by TARSKI:def 2;
    hence ex j,i be Element of NAT st [j,i] in Indices Ga & pion/.n = Ga*(j,i)
    by A16,A17,FINSEQ_4:26;
  end;
A80: Gik <> Gij by A12,A16,A17,GOBOARD1:21;
  Gik`2 = Ga*(1,i)`2 by A3,A4,A5,A14,GOBOARD5:2
    .= Gij`2 by A1,A4,A5,A11,A13,GOBOARD5:2;
  then LSeg(Gik,Gij) is horizontal by SPPOL_1:36;
  then pion is being_S-Seq by A80,JORDAN1B:9;
  then consider pion1 be FinSequence of TOP-REAL 2 such that
A81: pion1 is_sequence_on Ga and
A82: pion1 is being_S-Seq and
A83: L~pion = L~pion1 and
A84: pion/.1 = pion1/.1 and
A85: pion/.len pion = pion1/.len pion1 and
A86: len pion <= len pion1 by A79,GOBOARD3:2;
  reconsider pion1 as being_S-Seq FinSequence of TOP-REAL 2 by A82;
  set godo = go^'pion1^'do;
A87: 1+1 <= len Cage(C,n) by GOBOARD7:36,XXREAL_0:2;
A88: 1+1 <= len Rotate(Cage(C,n),Wmin) by GOBOARD7:36,XXREAL_0:2;
  len (go^'pion1) >= len go by TOPREAL8:7;
  then
A89: len (go^'pion1) >= 1+1 by A35,XXREAL_0:2;
  then
A90: len (go^'pion1) > 1+0 by NAT_1:13;
A91: len godo >= len (go^'pion1) by TOPREAL8:7;
  then
A92: 1+1 <= len godo by A89,XXREAL_0:2;
A93: US is_sequence_on Ga by JORDAN1G:4;
A94: go/.len go = pion1/.1 by A43,A84,FINSEQ_4:26;
  then
A95: go^'pion1 is_sequence_on Ga by A37,A81,TOPREAL8:12;
A96: (go^'pion1)/.len (go^'pion1) = pion/.len pion by A85,GRAPH_2:58
    .= pion/.2 by FINSEQ_1:61
    .= do/.1 by A44,FINSEQ_4:26;
  then
A97: godo is_sequence_on Ga by A40,A95,TOPREAL8:12;
  LSeg(pion1,1) c= L~<*Gik,Gij*> by A83,TOPREAL3:26;
  then LSeg(pion1,1) c= LSeg(Gik,Gij) by SPPOL_2:21;
  then
A98: LSeg(go,len go-'1) /\ LSeg(pion1,1) c= {Gik} by A46,A53,XBOOLE_1:27;
A99: len pion1 >= 1+1 by A86,FINSEQ_1:61;
  {Gik} c= LSeg(go,m) /\ LSeg(pion1,1)
  proof
    let x be set;
    assume x in {Gik};
    then
A100: x = Gik by TARSKI:def 1;
A101: Gik in LSeg(go,m) by A50,RLTOPSP1:69;
    Gik in LSeg(pion1,1) by A43,A94,A99,TOPREAL1:27;
    hence thesis by A100,A101,XBOOLE_0:def 4;
  end;
  then LSeg(go,len go-'1) /\ LSeg(pion1,1) = { go/.len go } by A43,A46,A98,
XBOOLE_0:def 10;
  then
A102: go^'pion1 is unfolded by A94,TOPREAL8:34;
  len pion1 >= 2+0 by A86,FINSEQ_1:61;
  then
A103: len pion1-2 >= 0 by XREAL_1:21;
  len (go^'pion1)+1-1 = len go+len pion1-1 by GRAPH_2:13;
  then len (go^'pion1)-1 = len go + (len pion1-2)
    .= len go + (len pion1-'2) by A103,XREAL_0:def 2;
  then
A104: len (go^'pion1)-'1 = len go + (len pion1-'2) by XREAL_0:def 2;
A105: len pion1-1 >= 1 by A99,XREAL_1:21;
  then
A106: len pion1-'1 = len pion1-1 by XREAL_0:def 2;
A107: len pion1-'2+1 = len pion1-2+1 by A103,XREAL_0:def 2
    .= len pion1-'1 by A105,XREAL_0:def 2;
  len pion1-1+1 <= len pion1;
  then
A108: len pion1-'1 < len pion1 by A106,NAT_1:13;
  LSeg(pion1,len pion1-'1) c= L~<*Gik,Gij*> by A83,TOPREAL3:26;
  then LSeg(pion1,len pion1-'1) c= LSeg(Gik,Gij) by SPPOL_2:21;
  then
A109: LSeg(pion1,len pion1-'1) /\ LSeg(do,1) c= {Gij} by A60,XBOOLE_1:27;
  {Gij} c= LSeg(pion1,len pion1-'1) /\ LSeg(do,1)
  proof
    let x be set;
    assume x in {Gij};
    then
A110: x = Gij by TARSKI:def 1;
    pion1/.(len pion1-'1+1) = pion/.2 by A85,A106,FINSEQ_1:61
      .= Gij by FINSEQ_4:26;
    then
A111: Gij in LSeg(pion1,len pion1-'1) by A105,A106,TOPREAL1:27;
    Gij in LSeg(do,1) by A57,RLTOPSP1:69;
    hence thesis by A110,A111,XBOOLE_0:def 4;
  end;
  then LSeg(pion1,len pion1-'1) /\ LSeg(do,1) = {Gij} by A109,XBOOLE_0:def 10;
  then
A112: LSeg(go^'pion1,len go+(len pion1-'2)) /\ LSeg(do,1) = {(go^'pion1)/.
  len (go^'pion1)} by A44,A94,A96,A107,A108,TOPREAL8:31;
A113: (go^'pion1) is non trivial by A89,REALSET1:13;
A114: rng pion1 c= L~pion1 by A99,SPPOL_2:18;
A115: {pion1/.1} c= L~go /\ L~pion1
  proof
    let x be set;
    assume x in {pion1/.1};
    then
A116: x = pion1/.1 by TARSKI:def 1;
    then
A117: x in rng pion1 by FINSEQ_6:46;
    x in rng go by A94,A116,REVROT_1:3;
    hence thesis by A63,A114,A117,XBOOLE_0:def 4;
  end;
  L~go /\ L~pion1 c= {pion1/.1}
  proof
    let x be set;
    assume
A118: x in L~go /\ L~pion1;
    then
A119: x in L~pion1 by XBOOLE_0:def 4;
    x in L~go by A118,XBOOLE_0:def 4;
    then x in L~pion1 /\ L~US by A48,A119,XBOOLE_0:def 4;
    hence thesis by A6,A43,A83,A94,SPPOL_2:21;
  end;
  then
A120: L~go /\ L~pion1 = {pion1/.1} by A115,XBOOLE_0:def 10;
  then
A121: (go^'pion1) is s.n.c. by A94,JORDAN1J:54;
  rng go /\ rng pion1 c= {pion1/.1} by A63,A114,A120,XBOOLE_1:27;
  then
A122: go^'pion1 is one-to-one by JORDAN1J:55;
A123: pion/.len pion = pion/.2 by FINSEQ_1:61
    .= do/.1 by A44,FINSEQ_4:26;
A124: {pion1/.len pion1} c= L~do /\ L~pion1
  proof
    let x be set;
    assume x in {pion1/.len pion1};
    then
A125: x = pion1/.len pion1 by TARSKI:def 1;
    then
A126: x in rng pion1 by REVROT_1:3;
    x in rng do by A85,A123,A125,FINSEQ_6:46;
    hence thesis by A64,A114,A126,XBOOLE_0:def 4;
  end;
  L~do /\ L~pion1 c= {pion1/.len pion1}
  proof
    let x be set;
    assume
A127: x in L~do /\ L~pion1;
    then
A128: x in L~pion1 by XBOOLE_0:def 4;
    x in L~do by A127,XBOOLE_0:def 4;
    then x in L~pion1 /\ L~LS by A55,A128,XBOOLE_0:def 4;
    hence thesis by A7,A44,A83,A85,A123,SPPOL_2:21;
  end;
  then
A129: L~do /\ L~pion1 = {pion1/.len pion1} by A124,XBOOLE_0:def 10;
A130: L~(go^'pion1) /\ L~do = (L~go \/ L~pion1) /\ L~do by A94,TOPREAL8:35
    .= {go/.1} \/ {do/.1} by A74,A85,A123,A129,XBOOLE_1:23
    .= {(go^'pion1)/.1} \/ {do/.1} by GRAPH_2:57
    .= {(go^'pion1)/.1,do/.1} by ENUMSET1:41;
  do/.len do = (go^'pion1)/.1 by A62,GRAPH_2:57;
  then reconsider
  godo as non constant standard special_circular_sequence by A92,A96,A97,A102
,A104,A112,A113,A121,A122,A130,JORDAN8:7,8,TOPREAL8:11,33,34;
A131: LA is_an_arc_of E-max C,W-min C by JORDAN6:def 9;
  then
A132: LA is connected by JORDAN6:11;
A133: W-min C in LA by A131,TOPREAL1:4;
A134: E-max C in LA by A131,TOPREAL1:4;
  set ff = Rotate(Cage(C,n),Wmin);
  Wmin in rng Cage(C,n) by SPRECT_2:47;
  then
A135: ff/.1 = Wmin by FINSEQ_6:98;
A136: L~ff = L~Cage(C,n) by REVROT_1:33;
  then (W-max L~ff)..ff > 1 by A135,SPRECT_5:23;
  then (N-min L~ff)..ff > 1 by A135,A136,SPRECT_5:24,XXREAL_0:2;
  then (N-max L~ff)..ff > 1 by A135,A136,SPRECT_5:25,XXREAL_0:2;
  then
A137: Emax..ff > 1 by A135,A136,SPRECT_5:26,XXREAL_0:2;
A138: now
    assume
A139: Gik..US <= 1;
    Gik..US >= 1 by A36,FINSEQ_4:31;
    then Gik..US = 1 by A139,XXREAL_0:1;
    then Gik = US/.1 by A36,FINSEQ_5:41;
    hence contradiction by A19,A23,JORDAN1F:5;
  end;
A140: Cage(C,n) is_sequence_on Ga by JORDAN9:def 1;
  then
A141: ff is_sequence_on Ga by REVROT_1:34;
A142: right_cell(godo,1,Ga)\L~godo c= RightComp godo by A92,A97,JORDAN9:29;
A143: L~godo = L~(go^'pion1) \/ L~do by A96,TOPREAL8:35
    .= L~go \/ L~pion1 \/ L~do by A94,TOPREAL8:35;
A144: L~Cage(C,n) = L~US \/ L~LS by JORDAN1E:17;
  then
A145: L~US c= L~Cage(C,n) by XBOOLE_1:7;
A146: L~LS c= L~Cage(C,n) by A144,XBOOLE_1:7;
A147: L~go c= L~Cage(C,n) by A48,A145,XBOOLE_1:1;
A148: L~do c= L~Cage(C,n) by A55,A146,XBOOLE_1:1;
A149: W-min C in C by SPRECT_1:15;
A150: L~pion = LSeg(Gik,Gij) by SPPOL_2:21;
A151: now
    assume W-min C in L~godo;
    then
A152: W-min C in L~go \/ L~pion1 or W-min C in L~do by A143,XBOOLE_0:def 3;
    per cases by A152,XBOOLE_0:def 3;
    suppose
      W-min C in L~go;
      then C meets L~Cage(C,n) by A147,A149,XBOOLE_0:3;
      hence contradiction by JORDAN10:5;
    end;
    suppose
      W-min C in L~pion1;
      hence contradiction by A8,A83,A133,A150,XBOOLE_0:3;
    end;
    suppose
      W-min C in L~do;
      then C meets L~Cage(C,n) by A148,A149,XBOOLE_0:3;
      hence contradiction by JORDAN10:5;
    end;
  end;
  right_cell(Rotate(Cage(C,n),Wmin),1) = right_cell(ff,1,GoB ff) by A88,
JORDAN1H:29
    .= right_cell(ff,1,GoB Cage(C,n)) by REVROT_1:28
    .= right_cell(ff,1,Ga) by JORDAN1H:52
    .= right_cell(ff-:Emax,1,Ga) by A137,A141,JORDAN1J:53
    .= right_cell(US,1,Ga) by JORDAN1E:def 1
    .= right_cell(R_Cut(US,Gik),1,Ga) by A36,A93,A138,JORDAN1J:52
    .= right_cell(go^'pion1,1,Ga) by A41,A95,JORDAN1J:51
    .= right_cell(godo,1,Ga) by A90,A97,JORDAN1J:51;
  then W-min C in right_cell(godo,1,Ga) by JORDAN1I:8;
  then
A153: W-min C in right_cell(godo,1,Ga)\L~godo by A151,XBOOLE_0:def 5;
A154: godo/.1 = (go^'pion1)/.1 by GRAPH_2:57
    .= Wmin by A61,GRAPH_2:57;
A155: len US >= 2 by A18,XXREAL_0:2;
A156: godo/.2 = (go^'pion1)/.2 by A89,GRAPH_2:61
    .= US/.2 by A35,A77,GRAPH_2:61
    .= (US^'LS)/.2 by A155,GRAPH_2:61
    .= Rotate(Cage(C,n),Wmin)/.2 by JORDAN1E:15;
A157: L~go \/ L~do is compact by COMPTS_1:19;
  Wmin in L~go \/ L~do by A63,A78,XBOOLE_0:def 3;
  then
A158: W-min (L~go \/ L~do) = Wmin by A147,A148,A157,JORDAN1J:21,XBOOLE_1:8;
A159: (W-min (L~go \/ L~do))`1 = W-bound (L~go \/ L~do) by EUCLID:56;
A160: Wmin`1 = Wbo by EUCLID:56;
A161: Gij`1 <= Gik`1 by A1,A2,A3,A4,A5,SPRECT_3:25;
  then W-bound LSeg(Gik,Gij) = Gij`1 by SPRECT_1:62;
  then
A162: W-bound L~pion1 = Gij`1 by A83,SPPOL_2:21;
  Gij`1 >= Wbo by A9,A146,PSCOMP_1:71;
  then Gij`1 > Wbo by A76,XXREAL_0:1;
  then W-min (L~go\/L~do\/L~pion1) = W-min (L~go \/ L~do) by A157,A158,A159
,A160,A162,JORDAN1J:33;
  then
A163: W-min L~godo = Wmin by A143,A158,XBOOLE_1:4;
A164: rng godo c= L~godo by A89,A91,SPPOL_2:18,XXREAL_0:2;
  2 in dom godo by A92,FINSEQ_3:27;
  then
A165: godo/.2 in rng godo by PARTFUN2:4;
  godo/.2 in W-most L~Cage(C,n) by A156,JORDAN1I:27;
  then (godo/.2)`1 = (W-min L~godo)`1 by A163,PSCOMP_1:88
    .= W-bound L~godo by EUCLID:56;
  then godo/.2 in W-most L~godo by A164,A165,SPRECT_2:16;
  then Rotate(godo,W-min L~godo)/.2 in W-most L~godo by A154,A163,FINSEQ_6:95;
  then reconsider godo as clockwise_oriented non constant standard
  special_circular_sequence by JORDAN1I:27;
  len US in dom US by FINSEQ_5:6;
  then
A166: US.len US = US/.len US by PARTFUN1:def 8
    .= Emax by JORDAN1F:7;
A167: east_halfline E-max C misses L~go
  proof
    assume east_halfline E-max C meets L~go;
    then consider p be set such that
A168: p in east_halfline E-max C and
A169: p in L~go by XBOOLE_0:3;
    reconsider p as Point of TOP-REAL 2 by A168;
    p in L~US by A48,A169;
    then p in east_halfline E-max C /\ L~Cage(C,n) by A145,A168,XBOOLE_0:def 4;
    then
A170: p`1 = Ebo by JORDAN1A:104,PSCOMP_1:111;
    then
A171: p = Emax by A48,A169,JORDAN1J:46;
    then Emax = Gik by A10,A166,A169,JORDAN1J:43;
    then Gik`1 = Ga*(len Ga,k)`1 by A3,A14,A170,A171,JORDAN1A:92;
    hence contradiction by A3,A17,A32,JORDAN1G:7;
  end;
  now
    assume east_halfline E-max C meets L~godo;
    then
A172: east_halfline E-max C meets (L~go \/ L~pion1) or east_halfline E-max
    C meets L~do by A143,XBOOLE_1:70;
    per cases by A172,XBOOLE_1:70;
    suppose
      east_halfline E-max C meets L~go;
      hence contradiction by A167;
    end;
    suppose
      east_halfline E-max C meets L~pion1;
      then consider p be set such that
A173: p in east_halfline E-max C and
A174: p in L~pion1 by XBOOLE_0:3;
      reconsider p as Point of TOP-REAL 2 by A173;
A175: p`2 = (E-max C)`2 by A173,TOPREAL1:def 13;
      k+1 <= len Ga by A3,NAT_1:13;
      then k+1-1 <= len Ga-1 by XREAL_1:11;
      then
A176: k <= len Ga-'1 by XREAL_0:def 2;
      len Ga-'1 <= len Ga by NAT_D:35;
      then
A177: Gik`1 <= Ga*(len Ga-'1,1)`1 by A4,A5,A11,A14,A21,A176,JORDAN1A:39;
      p`1 <= Gik`1 by A83,A150,A161,A174,TOPREAL1:9;
      then p`1 <= Ga*(len Ga-'1,1)`1 by A177,XXREAL_0:2;
      then p`1 <= E-bound C by A21,JORDAN8:15;
      then
A178: p`1 <= (E-max C)`1 by EUCLID:56;
      p`1 >= (E-max C)`1 by A173,TOPREAL1:def 13;
      then p`1 = (E-max C)`1 by A178,XXREAL_0:1;
      then p = E-max C by A175,TOPREAL3:11;
      hence contradiction by A8,A83,A134,A150,A174,XBOOLE_0:3;
    end;
    suppose
      east_halfline E-max C meets L~do;
      then consider p be set such that
A179: p in east_halfline E-max C and
A180: p in L~do by XBOOLE_0:3;
      reconsider p as Point of TOP-REAL 2 by A179;
A181: p in LSeg(do,Index(p,do)) by A180,JORDAN3:42;
      consider t be Nat such that
A182: t in dom LS and
A183: LS.t = Gij by A39,FINSEQ_2:11;
      1 <= t by A182,FINSEQ_3:27;
      then
A184: 1 < t by A34,A183,XXREAL_0:1;
      t <= len LS by A182,FINSEQ_3:27;
      then Index(Gij,LS)+1 = t by A183,A184,JORDAN3:45;
      then
A185: len L_Cut(LS,Gij) = len LS-Index(Gij,LS) by A9,A183,JORDAN3:61;
      Index(p,do) < len do by A180,JORDAN3:41;
      then Index(p,do) < len LS-'Index(Gij,LS) by A185,XREAL_0:def 2;
      then Index(p,do)+1 <= len LS-'Index(Gij,LS) by NAT_1:13;
      then
A186: Index(p,do) <= len LS-'Index(Gij,LS)-1 by XREAL_1:21;
A187: do = mid(LS,Gij..LS,len LS) by A39,JORDAN1J:37;
      p in L~LS by A55,A180;
      then p in east_halfline E-max C /\ L~Cage(C,n) by A146,A179,
XBOOLE_0:def 4;
      then
A188: p`1 = Ebo by JORDAN1A:104,PSCOMP_1:111;
A189: Index(Gij,LS)+1 = Gij..LS by A34,A39,JORDAN1J:56;
      0+Index(Gij,LS) < len LS by A9,JORDAN3:41;
      then len LS-Index(Gij,LS) > 0 by XREAL_1:22;
      then Index(p,do) <= len LS-Index(Gij,LS)-1 by A186,XREAL_0:def 2;
      then Index(p,do) <= len LS-Gij..LS by A189;
      then Index(p,do) <= len LS-'Gij..LS by XREAL_0:def 2;
      then
A190: Index(p,do) < len LS-'(Gij..LS)+1 by NAT_1:13;
A191: 1<=Index(p,do) by A180,JORDAN3:41;
A192: Gij..LS<=len LS by A39,FINSEQ_4:31;
      Gij..LS <> len LS by A31,A39,FINSEQ_4:29;
      then
A193: Gij..LS < len LS by A192,XXREAL_0:1;
A194: 1+1 <= len LS by A25,XXREAL_0:2;
      then
A195: 2 in dom LS by FINSEQ_3:27;
      set tt = Index(p,do)+(Gij..LS)-'1;
      set RC = Rotate(Cage(C,n),Emax);
A196: E-max C in right_cell(RC,1) by JORDAN1I:9;
A197: GoB RC = GoB Cage(C,n) by REVROT_1:28
        .= Ga by JORDAN1H:52;
A198: L~RC = L~Cage(C,n) by REVROT_1:33;
      consider jj2 be Element of NAT such that
A199: 1 <= jj2 and
A200: jj2 <= width Ga and
A201: Emax = Ga*(len Ga,jj2) by JORDAN1D:29;
A202: len Ga >= 4 by JORDAN8:13;
      then len Ga >= 1 by XXREAL_0:2;
      then
A203: [len Ga,jj2] in Indices Ga by A199,A200,MATRIX_1:37;
A204: len RC = len Cage(C,n) by REVROT_1:14;
      LS = RC-:Wmin by JORDAN1G:26;
      then
A205: LSeg(LS,1) = LSeg(RC,1) by A194,SPPOL_2:9;
A206: Emax in rng Cage(C,n) by SPRECT_2:50;
      RC is_sequence_on Ga by A140,REVROT_1:34;
      then consider ii,jj be Element of NAT such that
A207: [ii,jj+1] in Indices Ga and
A208: [ii,jj] in Indices Ga and
A209: RC/.1 = Ga*(ii,jj+1) and
A210: RC/.(1+1) = Ga*(ii,jj) by A87,A198,A204,A206,FINSEQ_6:98,JORDAN1I:25;
A211: jj+1+1 <> jj;
A212: 1 <= jj by A208,MATRIX_1:39;
      RC/.1 = E-max L~RC by A198,A206,FINSEQ_6:98;
      then
A213: ii = len Ga by A198,A207,A209,A201,A203,GOBOARD1:21;
      then ii-1 >= 4-1 by A202,XREAL_1:11;
      then
A214: ii-1 >= 1 by XXREAL_0:2;
      then
A215: 1 <= ii-'1 by XREAL_0:def 2;
A216: jj <= width Ga by A208,MATRIX_1:39;
      then
A217: Ga*(len Ga,jj)`1 = Ebo by A11,A212,JORDAN1A:92;
A218: jj+1 <= width Ga by A207,MATRIX_1:39;
      ii+1 <> ii;
      then
A219: right_cell(RC,1) = cell(Ga,ii-'1,jj) by A87,A204,A197,A207,A208,A209,A210
,A211,GOBOARD5:def 6;
A220: ii <= len Ga by A208,MATRIX_1:39;
A221: 1 <= ii by A208,MATRIX_1:39;
A222: ii <= len Ga by A207,MATRIX_1:39;
A223: 1 <= jj+1 by A207,MATRIX_1:39;
      then
A224: Ebo = Ga*(len Ga,jj+1)`1 by A11,A218,JORDAN1A:92;
A225: 1 <= ii by A207,MATRIX_1:39;
      then
A226: ii-'1+1 = ii by XREAL_1:237;
      then
A227: ii-'1 < len Ga by A222,NAT_1:13;
      then
A228: Ga*(ii-'1,jj+1)`2 = Ga*(1,jj+1)`2 by A223,A218,A215,GOBOARD5:2
        .= Ga*(ii,jj+1)`2 by A225,A222,A223,A218,GOBOARD5:2;
A229: (E-max C)`2 = p`2 by A179,TOPREAL1:def 13;
      then
A230: p`2 <= Ga*(ii-'1,jj+1)`2 by A196,A222,A218,A212,A219,A226,A214,JORDAN9:19
;
A231: Ga*(ii-'1,jj)`2 = Ga*(1,jj)`2 by A212,A216,A215,A227,GOBOARD5:2
        .= Ga*(ii,jj)`2 by A221,A220,A212,A216,GOBOARD5:2;
      Ga*(ii-'1,jj)`2 <= p`2 by A229,A196,A222,A218,A212,A219,A226,A214,
JORDAN9:19;
      then p in LSeg(RC/.1,RC/.(1+1)) by A188,A209,A210,A213,A230,A231,A228
,A217,A224,GOBOARD7:8;
      then
A232: p in LSeg(LS,1) by A87,A205,A204,TOPREAL1:def 5;
      1<=Gij..LS by A39,FINSEQ_4:31;
      then
A233: LSeg(mid(LS,Gij..LS,len LS),Index(p,do)) = LSeg(LS,Index(p,do)+(
      Gij..LS)-'1) by A193,A191,A190,JORDAN4:31;
      1<=Index(Gij,LS) by A9,JORDAN3:41;
      then
A234: 1+1 <= Gij..LS by A189,XREAL_1:9;
      then Index(p,do)+Gij..LS >= 1+1+1 by A191,XREAL_1:9;
      then Index(p,do)+Gij..LS-1 >= 1+1+1-1 by XREAL_1:11;
      then
A235: tt >= 1+1 by XREAL_0:def 2;
      now
        per cases by A235,XXREAL_0:1;
        suppose
          tt > 1+1;
          then LSeg(LS,1) misses LSeg(LS,tt) by TOPREAL1:def 9;
          hence contradiction by A232,A181,A187,A233,XBOOLE_0:3;
        end;
        suppose
A236:     tt = 1+1;
          then 1+1 = Index(p,do)+(Gij..LS)-1 by XREAL_0:def 2;
          then 1+1+1 = Index(p,do)+(Gij..LS);
          then
A237:     Gij..LS = 2 by A191,A234,JORDAN1E:10;
          LSeg(LS,1) /\ LSeg(LS,tt) = {LS/.2} by A25,A236,TOPREAL1:def 8;
          then p in {LS/.2} by A232,A181,A187,A233,XBOOLE_0:def 4;
          then
A238:     p = LS/.2 by TARSKI:def 1;
          then
A239:     p in rng LS by A195,PARTFUN2:4;
          p..LS = 2 by A195,A238,FINSEQ_5:44;
          then p = Gij by A39,A237,A239,FINSEQ_5:10;
          then Gij`1 = Ebo by A238,JORDAN1G:40;
          then Gij`1 = Ga*(len Ga,j)`1 by A1,A11,A13,JORDAN1A:92;
          hence contradiction by A2,A3,A16,A69,JORDAN1G:7;
        end;
      end;
      hence contradiction;
    end;
  end;
  then east_halfline E-max C c= (L~godo)` by SUBSET_1:43;
  then consider W be Subset of TOP-REAL 2 such that
A240: W is_a_component_of (L~godo)` and
A241: east_halfline E-max C c= W by GOBOARD9:5;
  W is not Bounded by A241,JORDAN2C:16,129;
  then W is_outside_component_of L~godo by A240,JORDAN2C:def 4;
  then W c= UBD L~godo by JORDAN2C:27;
  then
A242: east_halfline E-max C c= UBD L~godo by A241,XBOOLE_1:1;
  E-max C in east_halfline E-max C by TOPREAL1:45;
  then E-max C in UBD L~godo by A242;
  then E-max C in LeftComp godo by GOBRD14:46;
  then LA meets L~godo by A132,A133,A134,A142,A153,JORDAN1J:36;
  then
A243: LA meets (L~go \/ L~pion1) or LA meets L~do by A143,XBOOLE_1:70;
A244: LA c= C by JORDAN6:76;
  per cases by A243,XBOOLE_1:70;
  suppose
    LA meets L~go;
    then LA meets L~Cage(C,n) by A48,A145,XBOOLE_1:1,63;
    hence contradiction by A244,JORDAN10:5,XBOOLE_1:63;
  end;
  suppose
    LA meets L~pion1;
    hence contradiction by A8,A83,A150;
  end;
  suppose
    LA meets L~do;
    then LA meets L~Cage(C,n) by A55,A146,XBOOLE_1:1,63;
    hence contradiction by A244,JORDAN10:5,XBOOLE_1:63;
  end;
end;

theorem Th31:
  for C be Simple_closed_curve for i,j,k be Element of NAT st 1 <
j & j <= k & k < len Gauge(C,n) & 1 <= i & i <= width Gauge(C,n) & LSeg(Gauge(C
  ,n)*(j,i),Gauge(C,n)*(k,i)) /\ L~Upper_Seq(C,n) = {Gauge(C,n)*(k,i)} & LSeg(
  Gauge(C,n)*(j,i),Gauge(C,n)*(k,i)) /\ L~Lower_Seq(C,n) = {Gauge(C,n)*(j,i)}
  holds LSeg(Gauge(C,n)*(j,i),Gauge(C,n)*(k,i)) meets Upper_Arc C
proof
  let C be Simple_closed_curve;
  let i,j,k be Element of NAT;
  set Ga = Gauge(C,n);
  set US = Upper_Seq(C,n);
  set LS = Lower_Seq(C,n);
  set UA = Upper_Arc C;
  set Wmin = W-min L~Cage(C,n);
  set Emax = E-max L~Cage(C,n);
  set Wbo = W-bound L~Cage(C,n);
  set Ebo = E-bound L~Cage(C,n);
  set Gij = Ga*(j,i);
  set Gik = Ga*(k,i);
  assume that
A1: 1 < j and
A2: j <= k and
A3: k < len Ga and
A4: 1 <= i and
A5: i <= width Ga and
A6: LSeg(Gij,Gik) /\ L~US = {Gik} and
A7: LSeg(Gij,Gik) /\ L~LS = {Gij} and
A8: LSeg(Gij,Gik) misses UA;
  Gij in {Gij} by TARSKI:def 1;
  then
A9: Gij in L~LS by A7,XBOOLE_0:def 4;
  Gik in {Gik} by TARSKI:def 1;
  then
A10: Gik in L~US by A6,XBOOLE_0:def 4;
A11: len Ga = width Ga by JORDAN8:def 1;
A12: j <> k by A1,A3,A4,A5,A9,A10,Th29;
A13: j <= width Ga by A2,A3,A11,XXREAL_0:2;
A14: 1 <= k by A1,A2,XXREAL_0:2;
A15: k <= width Ga by A3,JORDAN8:def 1;
A16: [j,i] in Indices Ga by A1,A4,A5,A11,A13,MATRIX_1:37;
A17: [k,i] in Indices Ga by A3,A4,A5,A14,MATRIX_1:37;
  set go = R_Cut(US,Gik);
  set do = L_Cut(LS,Gij);
A18: len US >= 3 by JORDAN1E:19;
  then len US >= 1 by XXREAL_0:2;
  then 1 in dom US by FINSEQ_3:27;
  then
A19: US.1 = US/.1 by PARTFUN1:def 8
    .= Wmin by JORDAN1F:5;
A20: Wmin`1 = Wbo by EUCLID:56
    .= Ga*(1,k)`1 by A3,A14,JORDAN1A:94;
  len Ga >= 4 by JORDAN8:13;
  then
A21: len Ga >= 1 by XXREAL_0:2;
  then
A22: [1,k] in Indices Ga by A14,A15,MATRIX_1:37;
  then
A23: Gik <> US.1 by A1,A2,A17,A19,A20,JORDAN1G:7;
  then reconsider go as being_S-Seq FinSequence of TOP-REAL 2 by A10,JORDAN3:70
;
A24: [1,j] in Indices Ga by A1,A13,A21,MATRIX_1:37;
A25: len LS >= 1+2 by JORDAN1E:19;
  then
A26: len LS >= 1 by XXREAL_0:2;
  then
A27: 1 in dom LS by FINSEQ_3:27;
  len LS in dom LS by A26,FINSEQ_3:27;
  then
A28: LS.len LS = LS/.len LS by PARTFUN1:def 8
    .= Wmin by JORDAN1F:8;
A29: Wmin`1 = Wbo by EUCLID:56
    .= Ga*(1,k)`1 by A3,A14,JORDAN1A:94;
A30: [j,i] in Indices Ga by A1,A4,A5,A11,A13,MATRIX_1:37;
  then
A31: Gij <> LS.len LS by A1,A22,A28,A29,JORDAN1G:7;
  then reconsider do as being_S-Seq FinSequence of TOP-REAL 2 by A9,JORDAN3:69;
A32: [len Ga,k] in Indices Ga by A14,A15,A21,MATRIX_1:37;
A33: LS.1 = LS/.1 by A27,PARTFUN1:def 8
    .= Emax by JORDAN1F:6;
  Emax`1 = Ebo by EUCLID:56
    .= Ga*(len Ga,k)`1 by A3,A14,JORDAN1A:92;
  then
A34: Gij <> LS.1 by A2,A3,A30,A32,A33,JORDAN1G:7;
A35: len go >= 1+1 by TOPREAL1:def 10;
A36: Gik in rng US by A4,A5,A10,A11,A14,A15,JORDAN1G:4,JORDAN1J:40;
  then
A37: go is_sequence_on Ga by JORDAN1G:4,JORDAN1J:38;
A38: len do >= 1+1 by TOPREAL1:def 10;
A39: Gij in rng LS by A1,A4,A5,A9,A11,A13,JORDAN1G:5,JORDAN1J:40;
  then
A40: do is_sequence_on Ga by JORDAN1G:5,JORDAN1J:39;
  reconsider go as non constant s.c.c. (being_S-Seq FinSequence of TOP-REAL 2)
  by A35,A37,JGRAPH_1:16,JORDAN8:8;
  reconsider do as non constant s.c.c. (being_S-Seq FinSequence of TOP-REAL 2)
  by A38,A40,JGRAPH_1:16,JORDAN8:8;
A41: len go > 1 by A35,NAT_1:13;
  then
A42: len go in dom go by FINSEQ_3:27;
  then
A43: go/.len go = go.len go by PARTFUN1:def 8
    .= Gik by A10,JORDAN3:59;
  len do >= 1 by A38,XXREAL_0:2;
  then 1 in dom do by FINSEQ_3:27;
  then
A44: do/.1 = do.1 by PARTFUN1:def 8
    .= Gij by A9,JORDAN3:58;
  reconsider m = len go - 1 as Element of NAT by A42,FINSEQ_3:28;
A45: m+1 = len go;
  then
A46: len go-'1 = m by NAT_D:34;
A47: LSeg(go,m) c= L~go by TOPREAL3:26;
A48: L~go c= L~US by A10,JORDAN3:76;
  then LSeg(go,m) c= L~US by A47,XBOOLE_1:1;
  then
A49: LSeg(go,m) /\ LSeg(Gik,Gij) c= {Gik} by A6,XBOOLE_1:26;
  m >= 1 by A35,XREAL_1:21;
  then
A50: LSeg(go,m) = LSeg(go/.m,Gik) by A43,A45,TOPREAL1:def 5;
  {Gik} c= LSeg(go,m) /\ LSeg(Gik,Gij)
  proof
    let x be set;
A51: Gik in LSeg(Gik,Gij) by RLTOPSP1:69;
    assume x in {Gik};
    then
A52: x = Gik by TARSKI:def 1;
    Gik in LSeg(go,m) by A50,RLTOPSP1:69;
    hence thesis by A52,A51,XBOOLE_0:def 4;
  end;
  then
A53: LSeg(go,m) /\ LSeg(Gik,Gij) = {Gik} by A49,XBOOLE_0:def 10;
A54: LSeg(do,1) c= L~do by TOPREAL3:26;
A55: L~do c= L~LS by A9,JORDAN3:77;
  then LSeg(do,1) c= L~LS by A54,XBOOLE_1:1;
  then
A56: LSeg(do,1) /\ LSeg(Gik,Gij) c= {Gij} by A7,XBOOLE_1:26;
A57: LSeg(do,1) = LSeg(Gij,do/.(1+1)) by A38,A44,TOPREAL1:def 5;
  {Gij} c= LSeg(do,1) /\ LSeg(Gik,Gij)
  proof
    let x be set;
A58: Gij in LSeg(Gik,Gij) by RLTOPSP1:69;
    assume x in {Gij};
    then
A59: x = Gij by TARSKI:def 1;
    Gij in LSeg(do,1) by A57,RLTOPSP1:69;
    hence thesis by A59,A58,XBOOLE_0:def 4;
  end;
  then
A60: LSeg(Gik,Gij) /\ LSeg(do,1) = {Gij} by A56,XBOOLE_0:def 10;
A61: go/.1 = US/.1 by A10,SPRECT_3:39
    .= Wmin by JORDAN1F:5;
  then
A62: go/.1 = LS/.len LS by JORDAN1F:8
    .= do/.len do by A9,JORDAN1J:35;
A63: rng go c= L~go by A35,SPPOL_2:18;
A64: rng do c= L~do by A38,SPPOL_2:18;
A65: {go/.1} c= L~go /\ L~do
  proof
    let x be set;
    assume x in {go/.1};
    then
A66: x = go/.1 by TARSKI:def 1;
    then
A67: x in rng go by FINSEQ_6:46;
    x in rng do by A62,A66,REVROT_1:3;
    hence thesis by A63,A64,A67,XBOOLE_0:def 4;
  end;
A68: LS.1 = LS/.1 by A27,PARTFUN1:def 8
    .= Emax by JORDAN1F:6;
A69: [len Ga,j] in Indices Ga by A1,A13,A21,MATRIX_1:37;
  L~go /\ L~do c= {go/.1}
  proof
    let x be set;
    assume
A70: x in L~go /\ L~do;
    then
A71: x in L~do by XBOOLE_0:def 4;
A72: now
      assume x = Emax;
      then
A73:  Emax = Gij by A9,A68,A71,JORDAN1E:11;
      Ga*(len Ga,j)`1 = Ebo by A1,A11,A13,JORDAN1A:92;
      then Emax`1 <> Ebo by A2,A3,A16,A69,A73,JORDAN1G:7;
      hence contradiction by EUCLID:56;
    end;
    x in L~go by A70,XBOOLE_0:def 4;
    then x in L~US /\ L~LS by A48,A55,A71,XBOOLE_0:def 4;
    then x in {Wmin,Emax} by JORDAN1E:20;
    then x = Wmin or x = Emax by TARSKI:def 2;
    hence thesis by A61,A72,TARSKI:def 1;
  end;
  then
A74: L~go /\ L~do = {go/.1} by A65,XBOOLE_0:def 10;
  set W2 = go/.2;
A75: 2 in dom go by A35,FINSEQ_3:27;
A76: now
    assume Gij`1 = Wbo;
    then Ga*(1,j)`1 = Ga*(j,i)`1 by A1,A11,A13,JORDAN1A:94;
    hence contradiction by A1,A16,A24,JORDAN1G:7;
  end;
  go = mid(US,1,Gik..US) by A36,JORDAN1G:57
    .= US|(Gik..US) by A36,FINSEQ_4:31,FINSEQ_6:122;
  then
A77: W2 = US/.2 by A75,FINSEQ_4:85;
A78: Wmin in rng go by A61,FINSEQ_6:46;
  set pion = <*Gik,Gij*>;
A79: now
    let n be Element of NAT;
    assume n in dom pion;
    then n in {1,2} by FINSEQ_1:4,FINSEQ_3:29;
    then n = 1 or n = 2 by TARSKI:def 2;
    hence ex j,i be Element of NAT st [j,i] in Indices Ga & pion/.n = Ga*(j,i)
    by A16,A17,FINSEQ_4:26;
  end;
A80: Gik <> Gij by A12,A16,A17,GOBOARD1:21;
  Gik`2 = Ga*(1,i)`2 by A3,A4,A5,A14,GOBOARD5:2
    .= Gij`2 by A1,A4,A5,A11,A13,GOBOARD5:2;
  then LSeg(Gik,Gij) is horizontal by SPPOL_1:36;
  then pion is being_S-Seq by A80,JORDAN1B:9;
  then consider pion1 be FinSequence of TOP-REAL 2 such that
A81: pion1 is_sequence_on Ga and
A82: pion1 is being_S-Seq and
A83: L~pion = L~pion1 and
A84: pion/.1 = pion1/.1 and
A85: pion/.len pion = pion1/.len pion1 and
A86: len pion <= len pion1 by A79,GOBOARD3:2;
  reconsider pion1 as being_S-Seq FinSequence of TOP-REAL 2 by A82;
  set godo = go^'pion1^'do;
A87: 1+1 <= len Cage(C,n) by GOBOARD7:36,XXREAL_0:2;
A88: 1+1 <= len Rotate(Cage(C,n),Wmin) by GOBOARD7:36,XXREAL_0:2;
  len (go^'pion1) >= len go by TOPREAL8:7;
  then
A89: len (go^'pion1) >= 1+1 by A35,XXREAL_0:2;
  then
A90: len (go^'pion1) > 1+0 by NAT_1:13;
A91: len godo >= len (go^'pion1) by TOPREAL8:7;
  then
A92: 1+1 <= len godo by A89,XXREAL_0:2;
A93: US is_sequence_on Ga by JORDAN1G:4;
A94: go/.len go = pion1/.1 by A43,A84,FINSEQ_4:26;
  then
A95: go^'pion1 is_sequence_on Ga by A37,A81,TOPREAL8:12;
A96: (go^'pion1)/.len (go^'pion1) = pion/.len pion by A85,GRAPH_2:58
    .= pion/.2 by FINSEQ_1:61
    .= do/.1 by A44,FINSEQ_4:26;
  then
A97: godo is_sequence_on Ga by A40,A95,TOPREAL8:12;
  LSeg(pion1,1) c= L~<*Gik,Gij*> by A83,TOPREAL3:26;
  then LSeg(pion1,1) c= LSeg(Gik,Gij) by SPPOL_2:21;
  then
A98: LSeg(go,len go-'1) /\ LSeg(pion1,1) c= {Gik} by A46,A53,XBOOLE_1:27;
A99: len pion1 >= 1+1 by A86,FINSEQ_1:61;
  {Gik} c= LSeg(go,m) /\ LSeg(pion1,1)
  proof
    let x be set;
    assume x in {Gik};
    then
A100: x = Gik by TARSKI:def 1;
A101: Gik in LSeg(go,m) by A50,RLTOPSP1:69;
    Gik in LSeg(pion1,1) by A43,A94,A99,TOPREAL1:27;
    hence thesis by A100,A101,XBOOLE_0:def 4;
  end;
  then LSeg(go,len go-'1) /\ LSeg(pion1,1) = { go/.len go } by A43,A46,A98,
XBOOLE_0:def 10;
  then
A102: go^'pion1 is unfolded by A94,TOPREAL8:34;
  len pion1 >= 2+0 by A86,FINSEQ_1:61;
  then
A103: len pion1-2 >= 0 by XREAL_1:21;
  len (go^'pion1)+1-1 = len go+len pion1-1 by GRAPH_2:13;
  then len (go^'pion1)-1 = len go + (len pion1-2)
    .= len go + (len pion1-'2) by A103,XREAL_0:def 2;
  then
A104: len (go^'pion1)-'1 = len go + (len pion1-'2) by XREAL_0:def 2;
A105: len pion1-1 >= 1 by A99,XREAL_1:21;
  then
A106: len pion1-'1 = len pion1-1 by XREAL_0:def 2;
A107: len pion1-'2+1 = len pion1-2+1 by A103,XREAL_0:def 2
    .= len pion1-'1 by A105,XREAL_0:def 2;
  len pion1-1+1 <= len pion1;
  then
A108: len pion1-'1 < len pion1 by A106,NAT_1:13;
  LSeg(pion1,len pion1-'1) c= L~<*Gik,Gij*> by A83,TOPREAL3:26;
  then LSeg(pion1,len pion1-'1) c= LSeg(Gik,Gij) by SPPOL_2:21;
  then
A109: LSeg(pion1,len pion1-'1) /\ LSeg(do,1) c= {Gij} by A60,XBOOLE_1:27;
  {Gij} c= LSeg(pion1,len pion1-'1) /\ LSeg(do,1)
  proof
    let x be set;
    assume x in {Gij};
    then
A110: x = Gij by TARSKI:def 1;
    pion1/.(len pion1-'1+1) = pion/.2 by A85,A106,FINSEQ_1:61
      .= Gij by FINSEQ_4:26;
    then
A111: Gij in LSeg(pion1,len pion1-'1) by A105,A106,TOPREAL1:27;
    Gij in LSeg(do,1) by A57,RLTOPSP1:69;
    hence thesis by A110,A111,XBOOLE_0:def 4;
  end;
  then LSeg(pion1,len pion1-'1) /\ LSeg(do,1) = {Gij} by A109,XBOOLE_0:def 10;
  then
A112: LSeg(go^'pion1,len go+(len pion1-'2)) /\ LSeg(do,1) = {(go^'pion1)/.
  len (go^'pion1)} by A44,A94,A96,A107,A108,TOPREAL8:31;
A113: (go^'pion1) is non trivial by A89,REALSET1:13;
A114: rng pion1 c= L~pion1 by A99,SPPOL_2:18;
A115: {pion1/.1} c= L~go /\ L~pion1
  proof
    let x be set;
    assume x in {pion1/.1};
    then
A116: x = pion1/.1 by TARSKI:def 1;
    then
A117: x in rng pion1 by FINSEQ_6:46;
    x in rng go by A94,A116,REVROT_1:3;
    hence thesis by A63,A114,A117,XBOOLE_0:def 4;
  end;
  L~go /\ L~pion1 c= {pion1/.1}
  proof
    let x be set;
    assume
A118: x in L~go /\ L~pion1;
    then
A119: x in L~pion1 by XBOOLE_0:def 4;
    x in L~go by A118,XBOOLE_0:def 4;
    then x in L~pion1 /\ L~US by A48,A119,XBOOLE_0:def 4;
    hence thesis by A6,A43,A83,A94,SPPOL_2:21;
  end;
  then
A120: L~go /\ L~pion1 = {pion1/.1} by A115,XBOOLE_0:def 10;
  then
A121: (go^'pion1) is s.n.c. by A94,JORDAN1J:54;
  rng go /\ rng pion1 c= {pion1/.1} by A63,A114,A120,XBOOLE_1:27;
  then
A122: go^'pion1 is one-to-one by JORDAN1J:55;
A123: pion/.len pion = pion/.2 by FINSEQ_1:61
    .= do/.1 by A44,FINSEQ_4:26;
A124: {pion1/.len pion1} c= L~do /\ L~pion1
  proof
    let x be set;
    assume x in {pion1/.len pion1};
    then
A125: x = pion1/.len pion1 by TARSKI:def 1;
    then
A126: x in rng pion1 by REVROT_1:3;
    x in rng do by A85,A123,A125,FINSEQ_6:46;
    hence thesis by A64,A114,A126,XBOOLE_0:def 4;
  end;
  L~do /\ L~pion1 c= {pion1/.len pion1}
  proof
    let x be set;
    assume
A127: x in L~do /\ L~pion1;
    then
A128: x in L~pion1 by XBOOLE_0:def 4;
    x in L~do by A127,XBOOLE_0:def 4;
    then x in L~pion1 /\ L~LS by A55,A128,XBOOLE_0:def 4;
    hence thesis by A7,A44,A83,A85,A123,SPPOL_2:21;
  end;
  then
A129: L~do /\ L~pion1 = {pion1/.len pion1} by A124,XBOOLE_0:def 10;
A130: L~(go^'pion1) /\ L~do = (L~go \/ L~pion1) /\ L~do by A94,TOPREAL8:35
    .= {go/.1} \/ {do/.1} by A74,A85,A123,A129,XBOOLE_1:23
    .= {(go^'pion1)/.1} \/ {do/.1} by GRAPH_2:57
    .= {(go^'pion1)/.1,do/.1} by ENUMSET1:41;
  do/.len do = (go^'pion1)/.1 by A62,GRAPH_2:57;
  then reconsider
  godo as non constant standard special_circular_sequence by A92,A96,A97,A102
,A104,A112,A113,A121,A122,A130,JORDAN8:7,8,TOPREAL8:11,33,34;
A131: UA is_an_arc_of W-min C,E-max C by JORDAN6:def 8;
  then
A132: UA is connected by JORDAN6:11;
A133: W-min C in UA by A131,TOPREAL1:4;
A134: E-max C in UA by A131,TOPREAL1:4;
  set ff = Rotate(Cage(C,n),Wmin);
  Wmin in rng Cage(C,n) by SPRECT_2:47;
  then
A135: ff/.1 = Wmin by FINSEQ_6:98;
A136: L~ff = L~Cage(C,n) by REVROT_1:33;
  then (W-max L~ff)..ff > 1 by A135,SPRECT_5:23;
  then (N-min L~ff)..ff > 1 by A135,A136,SPRECT_5:24,XXREAL_0:2;
  then (N-max L~ff)..ff > 1 by A135,A136,SPRECT_5:25,XXREAL_0:2;
  then
A137: Emax..ff > 1 by A135,A136,SPRECT_5:26,XXREAL_0:2;
A138: now
    assume
A139: Gik..US <= 1;
    Gik..US >= 1 by A36,FINSEQ_4:31;
    then Gik..US = 1 by A139,XXREAL_0:1;
    then Gik = US/.1 by A36,FINSEQ_5:41;
    hence contradiction by A19,A23,JORDAN1F:5;
  end;
A140: Cage(C,n) is_sequence_on Ga by JORDAN9:def 1;
  then
A141: ff is_sequence_on Ga by REVROT_1:34;
A142: right_cell(godo,1,Ga)\L~godo c= RightComp godo by A92,A97,JORDAN9:29;
A143: L~godo = L~(go^'pion1) \/ L~do by A96,TOPREAL8:35
    .= L~go \/ L~pion1 \/ L~do by A94,TOPREAL8:35;
A144: L~Cage(C,n) = L~US \/ L~LS by JORDAN1E:17;
  then
A145: L~US c= L~Cage(C,n) by XBOOLE_1:7;
A146: L~LS c= L~Cage(C,n) by A144,XBOOLE_1:7;
A147: L~go c= L~Cage(C,n) by A48,A145,XBOOLE_1:1;
A148: L~do c= L~Cage(C,n) by A55,A146,XBOOLE_1:1;
A149: W-min C in C by SPRECT_1:15;
A150: L~pion = LSeg(Gik,Gij) by SPPOL_2:21;
A151: now
    assume W-min C in L~godo;
    then
A152: W-min C in L~go \/ L~pion1 or W-min C in L~do by A143,XBOOLE_0:def 3;
    per cases by A152,XBOOLE_0:def 3;
    suppose
      W-min C in L~go;
      then C meets L~Cage(C,n) by A147,A149,XBOOLE_0:3;
      hence contradiction by JORDAN10:5;
    end;
    suppose
      W-min C in L~pion1;
      hence contradiction by A8,A83,A133,A150,XBOOLE_0:3;
    end;
    suppose
      W-min C in L~do;
      then C meets L~Cage(C,n) by A148,A149,XBOOLE_0:3;
      hence contradiction by JORDAN10:5;
    end;
  end;
  right_cell(Rotate(Cage(C,n),Wmin),1) = right_cell(ff,1,GoB ff) by A88,
JORDAN1H:29
    .= right_cell(ff,1,GoB Cage(C,n)) by REVROT_1:28
    .= right_cell(ff,1,Ga) by JORDAN1H:52
    .= right_cell(ff-:Emax,1,Ga) by A137,A141,JORDAN1J:53
    .= right_cell(US,1,Ga) by JORDAN1E:def 1
    .= right_cell(R_Cut(US,Gik),1,Ga) by A36,A93,A138,JORDAN1J:52
    .= right_cell(go^'pion1,1,Ga) by A41,A95,JORDAN1J:51
    .= right_cell(godo,1,Ga) by A90,A97,JORDAN1J:51;
  then W-min C in right_cell(godo,1,Ga) by JORDAN1I:8;
  then
A153: W-min C in right_cell(godo,1,Ga)\L~godo by A151,XBOOLE_0:def 5;
A154: godo/.1 = (go^'pion1)/.1 by GRAPH_2:57
    .= Wmin by A61,GRAPH_2:57;
A155: len US >= 2 by A18,XXREAL_0:2;
A156: godo/.2 = (go^'pion1)/.2 by A89,GRAPH_2:61
    .= US/.2 by A35,A77,GRAPH_2:61
    .= (US^'LS)/.2 by A155,GRAPH_2:61
    .= Rotate(Cage(C,n),Wmin)/.2 by JORDAN1E:15;
A157: L~go \/ L~do is compact by COMPTS_1:19;
  Wmin in L~go \/ L~do by A63,A78,XBOOLE_0:def 3;
  then
A158: W-min (L~go \/ L~do) = Wmin by A147,A148,A157,JORDAN1J:21,XBOOLE_1:8;
A159: (W-min (L~go \/ L~do))`1 = W-bound (L~go \/ L~do) by EUCLID:56;
A160: Wmin`1 = Wbo by EUCLID:56;
A161: Gij`1 <= Gik`1 by A1,A2,A3,A4,A5,SPRECT_3:25;
  then W-bound LSeg(Gik,Gij) = Gij`1 by SPRECT_1:62;
  then
A162: W-bound L~pion1 = Gij`1 by A83,SPPOL_2:21;
  Gij`1 >= Wbo by A9,A146,PSCOMP_1:71;
  then Gij`1 > Wbo by A76,XXREAL_0:1;
  then W-min (L~go\/L~do\/L~pion1) = W-min (L~go \/ L~do) by A157,A158,A159
,A160,A162,JORDAN1J:33;
  then
A163: W-min L~godo = Wmin by A143,A158,XBOOLE_1:4;
A164: rng godo c= L~godo by A89,A91,SPPOL_2:18,XXREAL_0:2;
  2 in dom godo by A92,FINSEQ_3:27;
  then
A165: godo/.2 in rng godo by PARTFUN2:4;
  godo/.2 in W-most L~Cage(C,n) by A156,JORDAN1I:27;
  then (godo/.2)`1 = (W-min L~godo)`1 by A163,PSCOMP_1:88
    .= W-bound L~godo by EUCLID:56;
  then godo/.2 in W-most L~godo by A164,A165,SPRECT_2:16;
  then Rotate(godo,W-min L~godo)/.2 in W-most L~godo by A154,A163,FINSEQ_6:95;
  then reconsider godo as clockwise_oriented non constant standard
  special_circular_sequence by JORDAN1I:27;
  len US in dom US by FINSEQ_5:6;
  then
A166: US.len US = US/.len US by PARTFUN1:def 8
    .= Emax by JORDAN1F:7;
A167: east_halfline E-max C misses L~go
  proof
    assume east_halfline E-max C meets L~go;
    then consider p be set such that
A168: p in east_halfline E-max C and
A169: p in L~go by XBOOLE_0:3;
    reconsider p as Point of TOP-REAL 2 by A168;
    p in L~US by A48,A169;
    then p in east_halfline E-max C /\ L~Cage(C,n) by A145,A168,XBOOLE_0:def 4;
    then
A170: p`1 = Ebo by JORDAN1A:104,PSCOMP_1:111;
    then
A171: p = Emax by A48,A169,JORDAN1J:46;
    then Emax = Gik by A10,A166,A169,JORDAN1J:43;
    then Gik`1 = Ga*(len Ga,k)`1 by A3,A14,A170,A171,JORDAN1A:92;
    hence contradiction by A3,A17,A32,JORDAN1G:7;
  end;
  now
    assume east_halfline E-max C meets L~godo;
    then
A172: east_halfline E-max C meets (L~go \/ L~pion1) or east_halfline E-max
    C meets L~do by A143,XBOOLE_1:70;
    per cases by A172,XBOOLE_1:70;
    suppose
      east_halfline E-max C meets L~go;
      hence contradiction by A167;
    end;
    suppose
      east_halfline E-max C meets L~pion1;
      then consider p be set such that
A173: p in east_halfline E-max C and
A174: p in L~pion1 by XBOOLE_0:3;
      reconsider p as Point of TOP-REAL 2 by A173;
A175: p`2 = (E-max C)`2 by A173,TOPREAL1:def 13;
      k+1 <= len Ga by A3,NAT_1:13;
      then k+1-1 <= len Ga-1 by XREAL_1:11;
      then
A176: k <= len Ga-'1 by XREAL_0:def 2;
      len Ga-'1 <= len Ga by NAT_D:35;
      then
A177: Gik`1 <= Ga*(len Ga-'1,1)`1 by A4,A5,A11,A14,A21,A176,JORDAN1A:39;
      p`1 <= Gik`1 by A83,A150,A161,A174,TOPREAL1:9;
      then p`1 <= Ga*(len Ga-'1,1)`1 by A177,XXREAL_0:2;
      then p`1 <= E-bound C by A21,JORDAN8:15;
      then
A178: p`1 <= (E-max C)`1 by EUCLID:56;
      p`1 >= (E-max C)`1 by A173,TOPREAL1:def 13;
      then p`1 = (E-max C)`1 by A178,XXREAL_0:1;
      then p = E-max C by A175,TOPREAL3:11;
      hence contradiction by A8,A83,A134,A150,A174,XBOOLE_0:3;
    end;
    suppose
      east_halfline E-max C meets L~do;
      then consider p be set such that
A179: p in east_halfline E-max C and
A180: p in L~do by XBOOLE_0:3;
      reconsider p as Point of TOP-REAL 2 by A179;
A181: p in LSeg(do,Index(p,do)) by A180,JORDAN3:42;
      consider t be Nat such that
A182: t in dom LS and
A183: LS.t = Gij by A39,FINSEQ_2:11;
      1 <= t by A182,FINSEQ_3:27;
      then
A184: 1 < t by A34,A183,XXREAL_0:1;
      t <= len LS by A182,FINSEQ_3:27;
      then Index(Gij,LS)+1 = t by A183,A184,JORDAN3:45;
      then
A185: len L_Cut(LS,Gij) = len LS-Index(Gij,LS) by A9,A183,JORDAN3:61;
      Index(p,do) < len do by A180,JORDAN3:41;
      then Index(p,do) < len LS-'Index(Gij,LS) by A185,XREAL_0:def 2;
      then Index(p,do)+1 <= len LS-'Index(Gij,LS) by NAT_1:13;
      then
A186: Index(p,do) <= len LS-'Index(Gij,LS)-1 by XREAL_1:21;
A187: do = mid(LS,Gij..LS,len LS) by A39,JORDAN1J:37;
      p in L~LS by A55,A180;
      then p in east_halfline E-max C /\ L~Cage(C,n) by A146,A179,
XBOOLE_0:def 4;
      then
A188: p`1 = Ebo by JORDAN1A:104,PSCOMP_1:111;
A189: Index(Gij,LS)+1 = Gij..LS by A34,A39,JORDAN1J:56;
      0+Index(Gij,LS) < len LS by A9,JORDAN3:41;
      then len LS-Index(Gij,LS) > 0 by XREAL_1:22;
      then Index(p,do) <= len LS-Index(Gij,LS)-1 by A186,XREAL_0:def 2;
      then Index(p,do) <= len LS-Gij..LS by A189;
      then Index(p,do) <= len LS-'Gij..LS by XREAL_0:def 2;
      then
A190: Index(p,do) < len LS-'(Gij..LS)+1 by NAT_1:13;
A191: 1<=Index(p,do) by A180,JORDAN3:41;
A192: Gij..LS<=len LS by A39,FINSEQ_4:31;
      Gij..LS <> len LS by A31,A39,FINSEQ_4:29;
      then
A193: Gij..LS < len LS by A192,XXREAL_0:1;
A194: 1+1 <= len LS by A25,XXREAL_0:2;
      then
A195: 2 in dom LS by FINSEQ_3:27;
      set tt = Index(p,do)+(Gij..LS)-'1;
      set RC = Rotate(Cage(C,n),Emax);
A196: E-max C in right_cell(RC,1) by JORDAN1I:9;
A197: GoB RC = GoB Cage(C,n) by REVROT_1:28
        .= Ga by JORDAN1H:52;
A198: L~RC = L~Cage(C,n) by REVROT_1:33;
      consider jj2 be Element of NAT such that
A199: 1 <= jj2 and
A200: jj2 <= width Ga and
A201: Emax = Ga*(len Ga,jj2) by JORDAN1D:29;
A202: len Ga >= 4 by JORDAN8:13;
      then len Ga >= 1 by XXREAL_0:2;
      then
A203: [len Ga,jj2] in Indices Ga by A199,A200,MATRIX_1:37;
A204: len RC = len Cage(C,n) by REVROT_1:14;
      LS = RC-:Wmin by JORDAN1G:26;
      then
A205: LSeg(LS,1) = LSeg(RC,1) by A194,SPPOL_2:9;
A206: Emax in rng Cage(C,n) by SPRECT_2:50;
      RC is_sequence_on Ga by A140,REVROT_1:34;
      then consider ii,jj be Element of NAT such that
A207: [ii,jj+1] in Indices Ga and
A208: [ii,jj] in Indices Ga and
A209: RC/.1 = Ga*(ii,jj+1) and
A210: RC/.(1+1) = Ga*(ii,jj) by A87,A198,A204,A206,FINSEQ_6:98,JORDAN1I:25;
A211: jj+1+1 <> jj;
A212: 1 <= jj by A208,MATRIX_1:39;
      RC/.1 = E-max L~RC by A198,A206,FINSEQ_6:98;
      then
A213: ii = len Ga by A198,A207,A209,A201,A203,GOBOARD1:21;
      then ii-1 >= 4-1 by A202,XREAL_1:11;
      then
A214: ii-1 >= 1 by XXREAL_0:2;
      then
A215: 1 <= ii-'1 by XREAL_0:def 2;
A216: jj <= width Ga by A208,MATRIX_1:39;
      then
A217: Ga*(len Ga,jj)`1 = Ebo by A11,A212,JORDAN1A:92;
A218: jj+1 <= width Ga by A207,MATRIX_1:39;
      ii+1 <> ii;
      then
A219: right_cell(RC,1) = cell(Ga,ii-'1,jj) by A87,A204,A197,A207,A208,A209,A210
,A211,GOBOARD5:def 6;
A220: ii <= len Ga by A208,MATRIX_1:39;
A221: 1 <= ii by A208,MATRIX_1:39;
A222: ii <= len Ga by A207,MATRIX_1:39;
A223: 1 <= jj+1 by A207,MATRIX_1:39;
      then
A224: Ebo = Ga*(len Ga,jj+1)`1 by A11,A218,JORDAN1A:92;
A225: 1 <= ii by A207,MATRIX_1:39;
      then
A226: ii-'1+1 = ii by XREAL_1:237;
      then
A227: ii-'1 < len Ga by A222,NAT_1:13;
      then
A228: Ga*(ii-'1,jj+1)`2 = Ga*(1,jj+1)`2 by A223,A218,A215,GOBOARD5:2
        .= Ga*(ii,jj+1)`2 by A225,A222,A223,A218,GOBOARD5:2;
A229: (E-max C)`2 = p`2 by A179,TOPREAL1:def 13;
      then
A230: p`2 <= Ga*(ii-'1,jj+1)`2 by A196,A222,A218,A212,A219,A226,A214,JORDAN9:19
;
A231: Ga*(ii-'1,jj)`2 = Ga*(1,jj)`2 by A212,A216,A215,A227,GOBOARD5:2
        .= Ga*(ii,jj)`2 by A221,A220,A212,A216,GOBOARD5:2;
      Ga*(ii-'1,jj)`2 <= p`2 by A229,A196,A222,A218,A212,A219,A226,A214,
JORDAN9:19;
      then p in LSeg(RC/.1,RC/.(1+1)) by A188,A209,A210,A213,A230,A231,A228
,A217,A224,GOBOARD7:8;
      then
A232: p in LSeg(LS,1) by A87,A205,A204,TOPREAL1:def 5;
      1<=Gij..LS by A39,FINSEQ_4:31;
      then
A233: LSeg(mid(LS,Gij..LS,len LS),Index(p,do)) = LSeg(LS,Index(p,do)+(
      Gij..LS)-'1) by A193,A191,A190,JORDAN4:31;
      1<=Index(Gij,LS) by A9,JORDAN3:41;
      then
A234: 1+1 <= Gij..LS by A189,XREAL_1:9;
      then Index(p,do)+Gij..LS >= 1+1+1 by A191,XREAL_1:9;
      then Index(p,do)+Gij..LS-1 >= 1+1+1-1 by XREAL_1:11;
      then
A235: tt >= 1+1 by XREAL_0:def 2;
      now
        per cases by A235,XXREAL_0:1;
        suppose
          tt > 1+1;
          then LSeg(LS,1) misses LSeg(LS,tt) by TOPREAL1:def 9;
          hence contradiction by A232,A181,A187,A233,XBOOLE_0:3;
        end;
        suppose
A236:     tt = 1+1;
          then 1+1 = Index(p,do)+(Gij..LS)-1 by XREAL_0:def 2;
          then 1+1+1 = Index(p,do)+(Gij..LS);
          then
A237:     Gij..LS = 2 by A191,A234,JORDAN1E:10;
          LSeg(LS,1) /\ LSeg(LS,tt) = {LS/.2} by A25,A236,TOPREAL1:def 8;
          then p in {LS/.2} by A232,A181,A187,A233,XBOOLE_0:def 4;
          then
A238:     p = LS/.2 by TARSKI:def 1;
          then
A239:     p in rng LS by A195,PARTFUN2:4;
          p..LS = 2 by A195,A238,FINSEQ_5:44;
          then p = Gij by A39,A237,A239,FINSEQ_5:10;
          then Gij`1 = Ebo by A238,JORDAN1G:40;
          then Gij`1 = Ga*(len Ga,j)`1 by A1,A11,A13,JORDAN1A:92;
          hence contradiction by A2,A3,A16,A69,JORDAN1G:7;
        end;
      end;
      hence contradiction;
    end;
  end;
  then east_halfline E-max C c= (L~godo)` by SUBSET_1:43;
  then consider W be Subset of TOP-REAL 2 such that
A240: W is_a_component_of (L~godo)` and
A241: east_halfline E-max C c= W by GOBOARD9:5;
  W is not Bounded by A241,JORDAN2C:16,129;
  then W is_outside_component_of L~godo by A240,JORDAN2C:def 4;
  then W c= UBD L~godo by JORDAN2C:27;
  then
A242: east_halfline E-max C c= UBD L~godo by A241,XBOOLE_1:1;
  E-max C in east_halfline E-max C by TOPREAL1:45;
  then E-max C in UBD L~godo by A242;
  then E-max C in LeftComp godo by GOBRD14:46;
  then UA meets L~godo by A132,A133,A134,A142,A153,JORDAN1J:36;
  then
A243: UA meets (L~go \/ L~pion1) or UA meets L~do by A143,XBOOLE_1:70;
A244: UA c= C by JORDAN6:76;
  per cases by A243,XBOOLE_1:70;
  suppose
    UA meets L~go;
    then UA meets L~Cage(C,n) by A48,A145,XBOOLE_1:1,63;
    hence contradiction by A244,JORDAN10:5,XBOOLE_1:63;
  end;
  suppose
    UA meets L~pion1;
    hence contradiction by A8,A83,A150;
  end;
  suppose
    UA meets L~do;
    then UA meets L~Cage(C,n) by A55,A146,XBOOLE_1:1,63;
    hence contradiction by A244,JORDAN10:5,XBOOLE_1:63;
  end;
end;

theorem Th32:
  for C be Simple_closed_curve for i,j,k be Element of NAT st 1 <
j & j <= k & k < len Gauge(C,n) & 1 <= i & i <= width Gauge(C,n) & Gauge(C,n)*(
  k,i) in L~Upper_Seq(C,n) & Gauge(C,n)*(j,i) in L~Lower_Seq(C,n) holds LSeg(
  Gauge(C,n)*(j,i),Gauge(C,n)*(k,i)) meets Lower_Arc C
proof
  let C be Simple_closed_curve;
  let i,j,k be Element of NAT;
  assume that
A1: 1 < j and
A2: j <= k and
A3: k < len Gauge(C,n) and
A4: 1 <= i and
A5: i <= width Gauge(C,n) and
A6: Gauge(C,n)*(k,i) in L~Upper_Seq(C,n) and
A7: Gauge(C,n)*(j,i) in L~Lower_Seq(C,n);
  consider j1,k1 be Element of NAT such that
A8: j <= j1 and
A9: j1 <= k1 and
A10: k1 <= k and
A11: LSeg(Gauge(C,n)*(j1,i),Gauge(C,n)*(k1,i)) /\ L~Lower_Seq(C,n) = {
  Gauge(C,n)*(j1,i)} and
A12: LSeg(Gauge(C,n)*(j1,i),Gauge(C,n)*(k1,i)) /\ L~Upper_Seq(C,n) = {
  Gauge(C,n)*(k1,i)} by A1,A2,A3,A4,A5,A6,A7,Th16;
A13: k1 < len Gauge(C,n) by A3,A10,XXREAL_0:2;
  1 < j1 by A1,A8,XXREAL_0:2;
  then
  LSeg(Gauge(C,n)*(j1,i),Gauge(C,n)*(k1,i)) meets Lower_Arc C by A4,A5,A9,A11
,A12,A13,Th30;
  hence thesis by A1,A3,A4,A5,A8,A9,A10,Th8,XBOOLE_1:63;
end;

theorem Th33:
  for C be Simple_closed_curve for i,j,k be Element of NAT st 1 <
j & j <= k & k < len Gauge(C,n) & 1 <= i & i <= width Gauge(C,n) & Gauge(C,n)*(
  k,i) in L~Upper_Seq(C,n) & Gauge(C,n)*(j,i) in L~Lower_Seq(C,n) holds LSeg(
  Gauge(C,n)*(j,i),Gauge(C,n)*(k,i)) meets Upper_Arc C
proof
  let C be Simple_closed_curve;
  let i,j,k be Element of NAT;
  assume that
A1: 1 < j and
A2: j <= k and
A3: k < len Gauge(C,n) and
A4: 1 <= i and
A5: i <= width Gauge(C,n) and
A6: Gauge(C,n)*(k,i) in L~Upper_Seq(C,n) and
A7: Gauge(C,n)*(j,i) in L~Lower_Seq(C,n);
  consider j1,k1 be Element of NAT such that
A8: j <= j1 and
A9: j1 <= k1 and
A10: k1 <= k and
A11: LSeg(Gauge(C,n)*(j1,i),Gauge(C,n)*(k1,i)) /\ L~Lower_Seq(C,n) = {
  Gauge(C,n)*(j1,i)} and
A12: LSeg(Gauge(C,n)*(j1,i),Gauge(C,n)*(k1,i)) /\ L~Upper_Seq(C,n) = {
  Gauge(C,n)*(k1,i)} by A1,A2,A3,A4,A5,A6,A7,Th16;
A13: k1 < len Gauge(C,n) by A3,A10,XXREAL_0:2;
  1 < j1 by A1,A8,XXREAL_0:2;
  then
  LSeg(Gauge(C,n)*(j1,i),Gauge(C,n)*(k1,i)) meets Upper_Arc C by A4,A5,A9,A11
,A12,A13,Th31;
  hence thesis by A1,A3,A4,A5,A8,A9,A10,Th8,XBOOLE_1:63;
end;

theorem Th34:
  for C be Simple_closed_curve for i,j,k be Element of NAT st 1 <
  j & j <= k & k < len Gauge(C,n) & 1 <= i & i <= width Gauge(C,n) & n > 0 &
  Gauge(C,n)*(k,i) in Upper_Arc L~Cage(C,n) & Gauge(C,n)*(j,i) in Lower_Arc L~
  Cage(C,n) holds LSeg(Gauge(C,n)*(j,i),Gauge(C,n)*(k,i)) meets Lower_Arc C
proof
  let C be Simple_closed_curve;
  let i,j,k be Element of NAT;
  assume that
A1: 1 < j and
A2: j <= k and
A3: k < len Gauge(C,n) and
A4: 1 <= i and
A5: i <= width Gauge(C,n) and
A6: n > 0 and
A7: Gauge(C,n)*(k,i) in Upper_Arc L~Cage(C,n) and
A8: Gauge(C,n)*(j,i) in Lower_Arc L~Cage(C,n);
A9: L~Lower_Seq(C,n) = Lower_Arc L~Cage(C,n) by A6,JORDAN1G:64;
  L~Upper_Seq(C,n) = Upper_Arc L~Cage(C,n) by A6,JORDAN1G:63;
  hence thesis by A1,A2,A3,A4,A5,A7,A8,A9,Th32;
end;

theorem Th35:
  for C be Simple_closed_curve for i,j,k be Element of NAT st 1 <
  j & j <= k & k < len Gauge(C,n) & 1 <= i & i <= width Gauge(C,n) & n > 0 &
  Gauge(C,n)*(k,i) in Upper_Arc L~Cage(C,n) & Gauge(C,n)*(j,i) in Lower_Arc L~
  Cage(C,n) holds LSeg(Gauge(C,n)*(j,i),Gauge(C,n)*(k,i)) meets Upper_Arc C
proof
  let C be Simple_closed_curve;
  let i,j,k be Element of NAT;
  assume that
A1: 1 < j and
A2: j <= k and
A3: k < len Gauge(C,n) and
A4: 1 <= i and
A5: i <= width Gauge(C,n) and
A6: n > 0 and
A7: Gauge(C,n)*(k,i) in Upper_Arc L~Cage(C,n) and
A8: Gauge(C,n)*(j,i) in Lower_Arc L~Cage(C,n);
A9: L~Lower_Seq(C,n) = Lower_Arc L~Cage(C,n) by A6,JORDAN1G:64;
  L~Upper_Seq(C,n) = Upper_Arc L~Cage(C,n) by A6,JORDAN1G:63;
  hence thesis by A1,A2,A3,A4,A5,A7,A8,A9,Th33;
end;

theorem
  for C be Simple_closed_curve for j,k be Element of NAT holds 1 < j & j
<= k & k < len Gauge(C,n+1) & Gauge(C,n+1)*(k,Center Gauge(C,n+1)) in Upper_Arc
L~Cage(C,n+1) & Gauge(C,n+1)*(j,Center Gauge(C,n+1)) in Lower_Arc L~Cage(C,n+1)
implies LSeg(Gauge(C,n+1)*(j,Center Gauge(C,n+1)), Gauge(C,n+1)*(k,Center Gauge
  (C,n+1))) meets Lower_Arc C
proof
  let C be Simple_closed_curve;
  let j,k be Element of NAT;
  assume that
A1: 1 < j and
A2: j <= k and
A3: k < len Gauge(C,n+1) and
A4: Gauge(C,n+1)*(k,Center Gauge(C,n+1)) in Upper_Arc L~Cage(C,n+1) and
A5: Gauge(C,n+1)*(j,Center Gauge(C,n+1)) in Lower_Arc L~Cage(C,n+1);
A6: len Gauge(C,n+1) >= 4 by JORDAN8:13;
  then len Gauge(C,n+1) >= 3 by XXREAL_0:2;
  then Center Gauge(C,n+1) < len Gauge(C,n+1) by JORDAN1B:16;
  then
A7: Center Gauge(C,n+1) < width Gauge(C,n+1) by JORDAN8:def 1;
  len Gauge(C,n+1) >= 2 by A6,XXREAL_0:2;
  then 1 < Center Gauge(C,n+1) by JORDAN1B:15;
  hence thesis by A1,A2,A3,A4,A5,A7,Th34;
end;

theorem
  for C be Simple_closed_curve for j,k be Element of NAT holds 1 < j & j
<= k & k < len Gauge(C,n+1) & Gauge(C,n+1)*(k,Center Gauge(C,n+1)) in Upper_Arc
L~Cage(C,n+1) & Gauge(C,n+1)*(j,Center Gauge(C,n+1)) in Lower_Arc L~Cage(C,n+1)
implies LSeg(Gauge(C,n+1)*(j,Center Gauge(C,n+1)), Gauge(C,n+1)*(k,Center Gauge
  (C,n+1))) meets Upper_Arc C
proof
  let C be Simple_closed_curve;
  let j,k be Element of NAT;
  assume that
A1: 1 < j and
A2: j <= k and
A3: k < len Gauge(C,n+1) and
A4: Gauge(C,n+1)*(k,Center Gauge(C,n+1)) in Upper_Arc L~Cage(C,n+1) and
A5: Gauge(C,n+1)*(j,Center Gauge(C,n+1)) in Lower_Arc L~Cage(C,n+1);
A6: len Gauge(C,n+1) >= 4 by JORDAN8:13;
  then len Gauge(C,n+1) >= 3 by XXREAL_0:2;
  then Center Gauge(C,n+1) < len Gauge(C,n+1) by JORDAN1B:16;
  then
A7: Center Gauge(C,n+1) < width Gauge(C,n+1) by JORDAN8:def 1;
  len Gauge(C,n+1) >= 2 by A6,XXREAL_0:2;
  then 1 < Center Gauge(C,n+1) by JORDAN1B:15;
  hence thesis by A1,A2,A3,A4,A5,A7,Th35;
end;

theorem Th38:
  for C be Simple_closed_curve for i,j,k be Element of NAT st 1 <
j & j <= k & k < len Gauge(C,n) & 1 <= i & i <= width Gauge(C,n) & LSeg(Gauge(C
  ,n)*(j,i),Gauge(C,n)*(k,i)) /\ L~Upper_Seq(C,n) = {Gauge(C,n)*(j,i)} & LSeg(
  Gauge(C,n)*(j,i),Gauge(C,n)*(k,i)) /\ L~Lower_Seq(C,n) = {Gauge(C,n)*(k,i)}
  holds LSeg(Gauge(C,n)*(j,i),Gauge(C,n)*(k,i)) meets Lower_Arc C
proof
  let C be Simple_closed_curve;
  let i,j,k be Element of NAT;
  set Ga = Gauge(C,n);
  set US = Upper_Seq(C,n);
  set LS = Lower_Seq(C,n);
  set LA = Lower_Arc C;
  set Wmin = W-min L~Cage(C,n);
  set Emax = E-max L~Cage(C,n);
  set Wbo = W-bound L~Cage(C,n);
  set Ebo = E-bound L~Cage(C,n);
  set Gij = Ga*(j,i);
  set Gik = Ga*(k,i);
  assume that
A1: 1 < j and
A2: j <= k and
A3: k < len Ga and
A4: 1 <= i and
A5: i <= width Ga and
A6: LSeg(Gij,Gik) /\ L~US = {Gij} and
A7: LSeg(Gij,Gik) /\ L~LS = {Gik} and
A8: LSeg(Gij,Gik) misses LA;
  Gik in {Gik} by TARSKI:def 1;
  then
A9: Gik in L~LS by A7,XBOOLE_0:def 4;
  Gij in {Gij} by TARSKI:def 1;
  then
A10: Gij in L~US by A6,XBOOLE_0:def 4;
A11: len Ga = width Ga by JORDAN8:def 1;
A12: j <> k by A1,A3,A4,A5,A9,A10,Th29;
A13: j < width Ga by A2,A3,A11,XXREAL_0:2;
A14: 1 < k by A1,A2,XXREAL_0:2;
A15: k < width Ga by A3,JORDAN8:def 1;
A16: [j,i] in Indices Ga by A1,A4,A5,A11,A13,MATRIX_1:37;
A17: [k,i] in Indices Ga by A3,A4,A5,A14,MATRIX_1:37;
  set go = R_Cut(US,Gij);
  set do = L_Cut(LS,Gik);
A18: len US >= 3 by JORDAN1E:19;
  then len US >= 1 by XXREAL_0:2;
  then 1 in dom US by FINSEQ_3:27;
  then
A19: US.1 = US/.1 by PARTFUN1:def 8
    .= Wmin by JORDAN1F:5;
A20: Wmin`1 = Wbo by EUCLID:56
    .= Ga*(1,i)`1 by A4,A5,A11,JORDAN1A:94;
  len Ga >= 4 by JORDAN8:13;
  then
A21: len Ga >= 1 by XXREAL_0:2;
  then
A22: [1,k] in Indices Ga by A14,A15,MATRIX_1:37;
A23: [1,i] in Indices Ga by A4,A5,A21,MATRIX_1:37;
  then
A24: Gij <> US.1 by A1,A16,A19,A20,JORDAN1G:7;
  then reconsider go as being_S-Seq FinSequence of TOP-REAL 2 by A10,JORDAN3:70
;
A25: len LS >= 1+2 by JORDAN1E:19;
  then
A26: len LS >= 1 by XXREAL_0:2;
  then
A27: 1 in dom LS by FINSEQ_3:27;
  len LS in dom LS by A26,FINSEQ_3:27;
  then
A28: LS.len LS = LS/.len LS by PARTFUN1:def 8
    .= Wmin by JORDAN1F:8;
  Wmin`1 = Wbo by EUCLID:56
    .= Ga*(1,i)`1 by A4,A5,A11,JORDAN1A:94;
  then
A29: Gik <> LS.len LS by A1,A2,A17,A23,A28,JORDAN1G:7;
  then reconsider do as being_S-Seq FinSequence of TOP-REAL 2 by A9,JORDAN3:69;
A30: [len Ga,k] in Indices Ga by A14,A15,A21,MATRIX_1:37;
A31: LS.1 = LS/.1 by A27,PARTFUN1:def 8
    .= Emax by JORDAN1F:6;
  Emax`1 = Ebo by EUCLID:56
    .= Ga*(len Ga,k)`1 by A3,A14,JORDAN1A:92;
  then
A32: Gik <> LS.1 by A3,A17,A30,A31,JORDAN1G:7;
A33: len go >= 1+1 by TOPREAL1:def 10;
A34: Gij in rng US by A1,A4,A5,A10,A11,A13,JORDAN1G:4,JORDAN1J:40;
  then
A35: go is_sequence_on Ga by JORDAN1G:4,JORDAN1J:38;
A36: len do >= 1+1 by TOPREAL1:def 10;
A37: Gik in rng LS by A4,A5,A9,A11,A14,A15,JORDAN1G:5,JORDAN1J:40;
  then
A38: do is_sequence_on Ga by JORDAN1G:5,JORDAN1J:39;
  reconsider go as non constant s.c.c. (being_S-Seq FinSequence of TOP-REAL 2)
  by A33,A35,JGRAPH_1:16,JORDAN8:8;
  reconsider do as non constant s.c.c. (being_S-Seq FinSequence of TOP-REAL 2)
  by A36,A38,JGRAPH_1:16,JORDAN8:8;
A39: len go > 1 by A33,NAT_1:13;
  then
A40: len go in dom go by FINSEQ_3:27;
  then
A41: go/.len go = go.len go by PARTFUN1:def 8
    .= Gij by A10,JORDAN3:59;
  len do >= 1 by A36,XXREAL_0:2;
  then 1 in dom do by FINSEQ_3:27;
  then
A42: do/.1 = do.1 by PARTFUN1:def 8
    .= Gik by A9,JORDAN3:58;
  reconsider m = len go - 1 as Element of NAT by A40,FINSEQ_3:28;
A43: m+1 = len go;
  then
A44: len go-'1 = m by NAT_D:34;
A45: LSeg(go,m) c= L~go by TOPREAL3:26;
A46: L~go c= L~US by A10,JORDAN3:76;
  then LSeg(go,m) c= L~US by A45,XBOOLE_1:1;
  then
A47: LSeg(go,m) /\ LSeg(Gik,Gij) c= {Gij} by A6,XBOOLE_1:26;
  m >= 1 by A33,XREAL_1:21;
  then
A48: LSeg(go,m) = LSeg(go/.m,Gij) by A41,A43,TOPREAL1:def 5;
  {Gij} c= LSeg(go,m) /\ LSeg(Gik,Gij)
  proof
    let x be set;
A49: Gij in LSeg(Gik,Gij) by RLTOPSP1:69;
    assume x in {Gij};
    then
A50: x = Gij by TARSKI:def 1;
    Gij in LSeg(go,m) by A48,RLTOPSP1:69;
    hence thesis by A50,A49,XBOOLE_0:def 4;
  end;
  then
A51: LSeg(go,m) /\ LSeg(Gik,Gij) = {Gij} by A47,XBOOLE_0:def 10;
A52: LSeg(do,1) c= L~do by TOPREAL3:26;
A53: L~do c= L~LS by A9,JORDAN3:77;
  then LSeg(do,1) c= L~LS by A52,XBOOLE_1:1;
  then
A54: LSeg(do,1) /\ LSeg(Gik,Gij) c= {Gik} by A7,XBOOLE_1:26;
A55: LSeg(do,1) = LSeg(Gik,do/.(1+1)) by A36,A42,TOPREAL1:def 5;
  {Gik} c= LSeg(do,1) /\ LSeg(Gik,Gij)
  proof
    let x be set;
A56: Gik in LSeg(Gik,Gij) by RLTOPSP1:69;
    assume x in {Gik};
    then
A57: x = Gik by TARSKI:def 1;
    Gik in LSeg(do,1) by A55,RLTOPSP1:69;
    hence thesis by A57,A56,XBOOLE_0:def 4;
  end;
  then
A58: LSeg(Gik,Gij) /\ LSeg(do,1) = {Gik} by A54,XBOOLE_0:def 10;
A59: go/.1 = US/.1 by A10,SPRECT_3:39
    .= Wmin by JORDAN1F:5;
  then
A60: go/.1 = LS/.len LS by JORDAN1F:8
    .= do/.len do by A9,JORDAN1J:35;
A61: rng go c= L~go by A33,SPPOL_2:18;
A62: rng do c= L~do by A36,SPPOL_2:18;
A63: {go/.1} c= L~go /\ L~do
  proof
    let x be set;
    assume x in {go/.1};
    then
A64: x = go/.1 by TARSKI:def 1;
    then
A65: x in rng go by FINSEQ_6:46;
    x in rng do by A60,A64,REVROT_1:3;
    hence thesis by A61,A62,A65,XBOOLE_0:def 4;
  end;
A66: LS.1 = LS/.1 by A27,PARTFUN1:def 8
    .= Emax by JORDAN1F:6;
A67: [len Ga,j] in Indices Ga by A1,A13,A21,MATRIX_1:37;
  L~go /\ L~do c= {go/.1}
  proof
    let x be set;
    assume
A68: x in L~go /\ L~do;
    then
A69: x in L~do by XBOOLE_0:def 4;
A70: now
      assume x = Emax;
      then
A71:  Emax = Gik by A9,A66,A69,JORDAN1E:11;
      Ga*(len Ga,j)`1 = Ebo by A1,A11,A13,JORDAN1A:92;
      then Emax`1 <> Ebo by A3,A17,A67,A71,JORDAN1G:7;
      hence contradiction by EUCLID:56;
    end;
    x in L~go by A68,XBOOLE_0:def 4;
    then x in L~US /\ L~LS by A46,A53,A69,XBOOLE_0:def 4;
    then x in {Wmin,Emax} by JORDAN1E:20;
    then x = Wmin or x = Emax by TARSKI:def 2;
    hence thesis by A59,A70,TARSKI:def 1;
  end;
  then
A72: L~go /\ L~do = {go/.1} by A63,XBOOLE_0:def 10;
  set W2 = go/.2;
A73: 2 in dom go by A33,FINSEQ_3:27;
A74: now
    assume Gij`1 = Wbo;
    then Ga*(1,k)`1 = Ga*(j,i)`1 by A3,A14,JORDAN1A:94;
    hence contradiction by A1,A16,A22,JORDAN1G:7;
  end;
  go = mid(US,1,Gij..US) by A34,JORDAN1G:57
    .= US|(Gij..US) by A34,FINSEQ_4:31,FINSEQ_6:122;
  then
A75: W2 = US/.2 by A73,FINSEQ_4:85;
A76: Wmin in rng go by A59,FINSEQ_6:46;
  set pion = <*Gij,Gik*>;
A77: now
    let n be Element of NAT;
    assume n in dom pion;
    then n in {1,2} by FINSEQ_1:4,FINSEQ_3:29;
    then n = 1 or n = 2 by TARSKI:def 2;
    hence ex j,i be Element of NAT st [j,i] in Indices Ga & pion/.n = Ga*(j,i)
    by A16,A17,FINSEQ_4:26;
  end;
A78: Gik <> Gij by A12,A16,A17,GOBOARD1:21;
  Gik`2 = Ga*(1,i)`2 by A3,A4,A5,A14,GOBOARD5:2
    .= Gij`2 by A1,A4,A5,A11,A13,GOBOARD5:2;
  then LSeg(Gik,Gij) is horizontal by SPPOL_1:36;
  then pion is being_S-Seq by A78,JORDAN1B:9;
  then consider pion1 be FinSequence of TOP-REAL 2 such that
A79: pion1 is_sequence_on Ga and
A80: pion1 is being_S-Seq and
A81: L~pion = L~pion1 and
A82: pion/.1 = pion1/.1 and
A83: pion/.len pion = pion1/.len pion1 and
A84: len pion <= len pion1 by A77,GOBOARD3:2;
  reconsider pion1 as being_S-Seq FinSequence of TOP-REAL 2 by A80;
  set godo = go^'pion1^'do;
A85: 1+1 <= len Cage(C,n) by GOBOARD7:36,XXREAL_0:2;
A86: 1+1 <= len Rotate(Cage(C,n),Wmin) by GOBOARD7:36,XXREAL_0:2;
  len (go^'pion1) >= len go by TOPREAL8:7;
  then
A87: len (go^'pion1) >= 1+1 by A33,XXREAL_0:2;
  then
A88: len (go^'pion1) > 1+0 by NAT_1:13;
A89: len godo >= len (go^'pion1) by TOPREAL8:7;
  then
A90: 1+1 <= len godo by A87,XXREAL_0:2;
A91: US is_sequence_on Ga by JORDAN1G:4;
A92: go/.len go = pion1/.1 by A41,A82,FINSEQ_4:26;
  then
A93: go^'pion1 is_sequence_on Ga by A35,A79,TOPREAL8:12;
A94: (go^'pion1)/.len (go^'pion1) = pion/.len pion by A83,GRAPH_2:58
    .= pion/.2 by FINSEQ_1:61
    .= do/.1 by A42,FINSEQ_4:26;
  then
A95: godo is_sequence_on Ga by A38,A93,TOPREAL8:12;
  LSeg(pion1,1) c= L~<*Gij,Gik*> by A81,TOPREAL3:26;
  then LSeg(pion1,1) c= LSeg(Gij,Gik) by SPPOL_2:21;
  then
A96: LSeg(go,len go-'1) /\ LSeg(pion1,1) c= {Gij} by A44,A51,XBOOLE_1:27;
A97: len pion1 >= 1+1 by A84,FINSEQ_1:61;
  {Gij} c= LSeg(go,m) /\ LSeg(pion1,1)
  proof
    let x be set;
    assume x in {Gij};
    then
A98: x = Gij by TARSKI:def 1;
A99: Gij in LSeg(go,m) by A48,RLTOPSP1:69;
    Gij in LSeg(pion1,1) by A41,A92,A97,TOPREAL1:27;
    hence thesis by A98,A99,XBOOLE_0:def 4;
  end;
  then LSeg(go,len go-'1) /\ LSeg(pion1,1) = { go/.len go } by A41,A44,A96,
XBOOLE_0:def 10;
  then
A100: go^'pion1 is unfolded by A92,TOPREAL8:34;
  len pion1 >= 2+0 by A84,FINSEQ_1:61;
  then
A101: len pion1-2 >= 0 by XREAL_1:21;
  len (go^'pion1)+1-1 = len go+len pion1-1 by GRAPH_2:13;
  then len (go^'pion1)-1 = len go + (len pion1-2)
    .= len go + (len pion1-'2) by A101,XREAL_0:def 2;
  then
A102: len (go^'pion1)-'1 = len go + (len pion1-'2) by XREAL_0:def 2;
A103: len pion1-1 >= 1 by A97,XREAL_1:21;
  then
A104: len pion1-'1 = len pion1-1 by XREAL_0:def 2;
A105: len pion1-'2+1 = len pion1-2+1 by A101,XREAL_0:def 2
    .= len pion1-'1 by A103,XREAL_0:def 2;
  len pion1-1+1 <= len pion1;
  then
A106: len pion1-'1 < len pion1 by A104,NAT_1:13;
  LSeg(pion1,len pion1-'1) c= L~<*Gij,Gik*> by A81,TOPREAL3:26;
  then LSeg(pion1,len pion1-'1) c= LSeg(Gij,Gik) by SPPOL_2:21;
  then
A107: LSeg(pion1,len pion1-'1) /\ LSeg(do,1) c= {Gik} by A58,XBOOLE_1:27;
  {Gik} c= LSeg(pion1,len pion1-'1) /\ LSeg(do,1)
  proof
    let x be set;
    assume x in {Gik};
    then
A108: x = Gik by TARSKI:def 1;
    pion1/.(len pion1-'1+1) = pion/.2 by A83,A104,FINSEQ_1:61
      .= Gik by FINSEQ_4:26;
    then
A109: Gik in LSeg(pion1,len pion1-'1) by A103,A104,TOPREAL1:27;
    Gik in LSeg(do,1) by A55,RLTOPSP1:69;
    hence thesis by A108,A109,XBOOLE_0:def 4;
  end;
  then LSeg(pion1,len pion1-'1) /\ LSeg(do,1) = {Gik} by A107,XBOOLE_0:def 10;
  then
A110: LSeg(go^'pion1,len go+(len pion1-'2)) /\ LSeg(do,1) = {(go^'pion1)/.
  len (go^'pion1)} by A42,A92,A94,A105,A106,TOPREAL8:31;
A111: (go^'pion1) is non trivial by A87,REALSET1:13;
A112: rng pion1 c= L~pion1 by A97,SPPOL_2:18;
A113: {pion1/.1} c= L~go /\ L~pion1
  proof
    let x be set;
    assume x in {pion1/.1};
    then
A114: x = pion1/.1 by TARSKI:def 1;
    then
A115: x in rng pion1 by FINSEQ_6:46;
    x in rng go by A92,A114,REVROT_1:3;
    hence thesis by A61,A112,A115,XBOOLE_0:def 4;
  end;
  L~go /\ L~pion1 c= {pion1/.1}
  proof
    let x be set;
    assume
A116: x in L~go /\ L~pion1;
    then
A117: x in L~pion1 by XBOOLE_0:def 4;
    x in L~go by A116,XBOOLE_0:def 4;
    then x in L~pion1 /\ L~US by A46,A117,XBOOLE_0:def 4;
    hence thesis by A6,A41,A81,A92,SPPOL_2:21;
  end;
  then
A118: L~go /\ L~pion1 = {pion1/.1} by A113,XBOOLE_0:def 10;
  then
A119: (go^'pion1) is s.n.c. by A92,JORDAN1J:54;
  rng go /\ rng pion1 c= {pion1/.1} by A61,A112,A118,XBOOLE_1:27;
  then
A120: go^'pion1 is one-to-one by JORDAN1J:55;
A121: pion/.len pion = pion/.2 by FINSEQ_1:61
    .= do/.1 by A42,FINSEQ_4:26;
A122: {pion1/.len pion1} c= L~do /\ L~pion1
  proof
    let x be set;
    assume x in {pion1/.len pion1};
    then
A123: x = pion1/.len pion1 by TARSKI:def 1;
    then
A124: x in rng pion1 by REVROT_1:3;
    x in rng do by A83,A121,A123,FINSEQ_6:46;
    hence thesis by A62,A112,A124,XBOOLE_0:def 4;
  end;
  L~do /\ L~pion1 c= {pion1/.len pion1}
  proof
    let x be set;
    assume
A125: x in L~do /\ L~pion1;
    then
A126: x in L~pion1 by XBOOLE_0:def 4;
    x in L~do by A125,XBOOLE_0:def 4;
    then x in L~pion1 /\ L~LS by A53,A126,XBOOLE_0:def 4;
    hence thesis by A7,A42,A81,A83,A121,SPPOL_2:21;
  end;
  then
A127: L~do /\ L~pion1 = {pion1/.len pion1} by A122,XBOOLE_0:def 10;
A128: L~(go^'pion1) /\ L~do = (L~go \/ L~pion1) /\ L~do by A92,TOPREAL8:35
    .= {go/.1} \/ {do/.1} by A72,A83,A121,A127,XBOOLE_1:23
    .= {(go^'pion1)/.1} \/ {do/.1} by GRAPH_2:57
    .= {(go^'pion1)/.1,do/.1} by ENUMSET1:41;
  do/.len do = (go^'pion1)/.1 by A60,GRAPH_2:57;
  then reconsider
  godo as non constant standard special_circular_sequence by A90,A94,A95,A100
,A102,A110,A111,A119,A120,A128,JORDAN8:7,8,TOPREAL8:11,33,34;
A129: LA is_an_arc_of E-max C,W-min C by JORDAN6:def 9;
  then
A130: LA is connected by JORDAN6:11;
A131: W-min C in LA by A129,TOPREAL1:4;
A132: E-max C in LA by A129,TOPREAL1:4;
  set ff = Rotate(Cage(C,n),Wmin);
  Wmin in rng Cage(C,n) by SPRECT_2:47;
  then
A133: ff/.1 = Wmin by FINSEQ_6:98;
A134: L~ff = L~Cage(C,n) by REVROT_1:33;
  then (W-max L~ff)..ff > 1 by A133,SPRECT_5:23;
  then (N-min L~ff)..ff > 1 by A133,A134,SPRECT_5:24,XXREAL_0:2;
  then (N-max L~ff)..ff > 1 by A133,A134,SPRECT_5:25,XXREAL_0:2;
  then
A135: Emax..ff > 1 by A133,A134,SPRECT_5:26,XXREAL_0:2;
A136: now
    assume
A137: Gij..US <= 1;
    Gij..US >= 1 by A34,FINSEQ_4:31;
    then Gij..US = 1 by A137,XXREAL_0:1;
    then Gij = US/.1 by A34,FINSEQ_5:41;
    hence contradiction by A19,A24,JORDAN1F:5;
  end;
A138: Cage(C,n) is_sequence_on Ga by JORDAN9:def 1;
  then
A139: ff is_sequence_on Ga by REVROT_1:34;
A140: right_cell(godo,1,Ga)\L~godo c= RightComp godo by A90,A95,JORDAN9:29;
A141: L~godo = L~(go^'pion1) \/ L~do by A94,TOPREAL8:35
    .= L~go \/ L~pion1 \/ L~do by A92,TOPREAL8:35;
A142: L~Cage(C,n) = L~US \/ L~LS by JORDAN1E:17;
  then
A143: L~US c= L~Cage(C,n) by XBOOLE_1:7;
A144: L~LS c= L~Cage(C,n) by A142,XBOOLE_1:7;
A145: L~go c= L~Cage(C,n) by A46,A143,XBOOLE_1:1;
A146: L~do c= L~Cage(C,n) by A53,A144,XBOOLE_1:1;
A147: W-min C in C by SPRECT_1:15;
A148: L~pion = LSeg(Gik,Gij) by SPPOL_2:21;
A149: now
    assume W-min C in L~godo;
    then
A150: W-min C in L~go \/ L~pion1 or W-min C in L~do by A141,XBOOLE_0:def 3;
    per cases by A150,XBOOLE_0:def 3;
    suppose
      W-min C in L~go;
      then C meets L~Cage(C,n) by A145,A147,XBOOLE_0:3;
      hence contradiction by JORDAN10:5;
    end;
    suppose
      W-min C in L~pion1;
      hence contradiction by A8,A81,A131,A148,XBOOLE_0:3;
    end;
    suppose
      W-min C in L~do;
      then C meets L~Cage(C,n) by A146,A147,XBOOLE_0:3;
      hence contradiction by JORDAN10:5;
    end;
  end;
  right_cell(Rotate(Cage(C,n),Wmin),1) = right_cell(ff,1,GoB ff) by A86,
JORDAN1H:29
    .= right_cell(ff,1,GoB Cage(C,n)) by REVROT_1:28
    .= right_cell(ff,1,Ga) by JORDAN1H:52
    .= right_cell(ff-:Emax,1,Ga) by A135,A139,JORDAN1J:53
    .= right_cell(US,1,Ga) by JORDAN1E:def 1
    .= right_cell(R_Cut(US,Gij),1,Ga) by A34,A91,A136,JORDAN1J:52
    .= right_cell(go^'pion1,1,Ga) by A39,A93,JORDAN1J:51
    .= right_cell(godo,1,Ga) by A88,A95,JORDAN1J:51;
  then W-min C in right_cell(godo,1,Ga) by JORDAN1I:8;
  then
A151: W-min C in right_cell(godo,1,Ga)\L~godo by A149,XBOOLE_0:def 5;
A152: godo/.1 = (go^'pion1)/.1 by GRAPH_2:57
    .= Wmin by A59,GRAPH_2:57;
A153: len US >= 2 by A18,XXREAL_0:2;
A154: godo/.2 = (go^'pion1)/.2 by A87,GRAPH_2:61
    .= US/.2 by A33,A75,GRAPH_2:61
    .= (US^'LS)/.2 by A153,GRAPH_2:61
    .= Rotate(Cage(C,n),Wmin)/.2 by JORDAN1E:15;
A155: L~go \/ L~do is compact by COMPTS_1:19;
  Wmin in L~go \/ L~do by A61,A76,XBOOLE_0:def 3;
  then
A156: W-min (L~go \/ L~do) = Wmin by A145,A146,A155,JORDAN1J:21,XBOOLE_1:8;
A157: (W-min (L~go \/ L~do))`1 = W-bound (L~go \/ L~do) by EUCLID:56;
A158: Wmin`1 = Wbo by EUCLID:56;
A159: Gij`1 <= Gik`1 by A1,A2,A3,A4,A5,SPRECT_3:25;
  then W-bound LSeg(Gik,Gij) = Gij`1 by SPRECT_1:62;
  then
A160: W-bound L~pion1 = Gij`1 by A81,SPPOL_2:21;
  Gij`1 >= Wbo by A10,A143,PSCOMP_1:71;
  then Gij`1 > Wbo by A74,XXREAL_0:1;
  then W-min (L~go\/L~do\/L~pion1) = W-min (L~go \/ L~do) by A155,A156,A157
,A158,A160,JORDAN1J:33;
  then
A161: W-min L~godo = Wmin by A141,A156,XBOOLE_1:4;
A162: rng godo c= L~godo by A87,A89,SPPOL_2:18,XXREAL_0:2;
  2 in dom godo by A90,FINSEQ_3:27;
  then
A163: godo/.2 in rng godo by PARTFUN2:4;
  godo/.2 in W-most L~Cage(C,n) by A154,JORDAN1I:27;
  then (godo/.2)`1 = (W-min L~godo)`1 by A161,PSCOMP_1:88
    .= W-bound L~godo by EUCLID:56;
  then godo/.2 in W-most L~godo by A162,A163,SPRECT_2:16;
  then Rotate(godo,W-min L~godo)/.2 in W-most L~godo by A152,A161,FINSEQ_6:95;
  then reconsider godo as clockwise_oriented non constant standard
  special_circular_sequence by JORDAN1I:27;
  len US in dom US by FINSEQ_5:6;
  then
A164: US.len US = US/.len US by PARTFUN1:def 8
    .= Emax by JORDAN1F:7;
A165: east_halfline E-max C misses L~go
  proof
    assume east_halfline E-max C meets L~go;
    then consider p be set such that
A166: p in east_halfline E-max C and
A167: p in L~go by XBOOLE_0:3;
    reconsider p as Point of TOP-REAL 2 by A166;
    p in L~US by A46,A167;
    then p in east_halfline E-max C /\ L~Cage(C,n) by A143,A166,XBOOLE_0:def 4;
    then
A168: p`1 = Ebo by JORDAN1A:104,PSCOMP_1:111;
    then
A169: p = Emax by A46,A167,JORDAN1J:46;
    then Emax = Gij by A10,A164,A167,JORDAN1J:43;
    then Gij`1 = Ga*(len Ga,k)`1 by A3,A14,A168,A169,JORDAN1A:92;
    hence contradiction by A2,A3,A16,A30,JORDAN1G:7;
  end;
  now
    assume east_halfline E-max C meets L~godo;
    then
A170: east_halfline E-max C meets (L~go \/ L~pion1) or east_halfline E-max
    C meets L~do by A141,XBOOLE_1:70;
    per cases by A170,XBOOLE_1:70;
    suppose
      east_halfline E-max C meets L~go;
      hence contradiction by A165;
    end;
    suppose
      east_halfline E-max C meets L~pion1;
      then consider p be set such that
A171: p in east_halfline E-max C and
A172: p in L~pion1 by XBOOLE_0:3;
      reconsider p as Point of TOP-REAL 2 by A171;
A173: p`2 = (E-max C)`2 by A171,TOPREAL1:def 13;
      k+1 <= len Ga by A3,NAT_1:13;
      then k+1-1 <= len Ga-1 by XREAL_1:11;
      then
A174: k <= len Ga-'1 by XREAL_0:def 2;
      len Ga-'1 <= len Ga by NAT_D:35;
      then
A175: Gik`1 <= Ga*(len Ga-'1,1)`1 by A4,A5,A11,A14,A21,A174,JORDAN1A:39;
      p`1 <= Gik`1 by A81,A148,A159,A172,TOPREAL1:9;
      then p`1 <= Ga*(len Ga-'1,1)`1 by A175,XXREAL_0:2;
      then p`1 <= E-bound C by A21,JORDAN8:15;
      then
A176: p`1 <= (E-max C)`1 by EUCLID:56;
      p`1 >= (E-max C)`1 by A171,TOPREAL1:def 13;
      then p`1 = (E-max C)`1 by A176,XXREAL_0:1;
      then p = E-max C by A173,TOPREAL3:11;
      hence contradiction by A8,A81,A132,A148,A172,XBOOLE_0:3;
    end;
    suppose
      east_halfline E-max C meets L~do;
      then consider p be set such that
A177: p in east_halfline E-max C and
A178: p in L~do by XBOOLE_0:3;
      reconsider p as Point of TOP-REAL 2 by A177;
A179: p in LSeg(do,Index(p,do)) by A178,JORDAN3:42;
      consider t be Nat such that
A180: t in dom LS and
A181: LS.t = Gik by A37,FINSEQ_2:11;
      1 <= t by A180,FINSEQ_3:27;
      then
A182: 1 < t by A32,A181,XXREAL_0:1;
      t <= len LS by A180,FINSEQ_3:27;
      then Index(Gik,LS)+1 = t by A181,A182,JORDAN3:45;
      then
A183: len L_Cut(LS,Gik) = len LS-Index(Gik,LS) by A9,A181,JORDAN3:61;
      Index(p,do) < len do by A178,JORDAN3:41;
      then Index(p,do) < len LS-'Index(Gik,LS) by A183,XREAL_0:def 2;
      then Index(p,do)+1 <= len LS-'Index(Gik,LS) by NAT_1:13;
      then
A184: Index(p,do) <= len LS-'Index(Gik,LS)-1 by XREAL_1:21;
A185: do = mid(LS,Gik..LS,len LS) by A37,JORDAN1J:37;
      p in L~LS by A53,A178;
      then p in east_halfline E-max C /\ L~Cage(C,n) by A144,A177,
XBOOLE_0:def 4;
      then
A186: p`1 = Ebo by JORDAN1A:104,PSCOMP_1:111;
A187: Index(Gik,LS)+1 = Gik..LS by A32,A37,JORDAN1J:56;
      0+Index(Gik,LS) < len LS by A9,JORDAN3:41;
      then len LS-Index(Gik,LS) > 0 by XREAL_1:22;
      then Index(p,do) <= len LS-Index(Gik,LS)-1 by A184,XREAL_0:def 2;
      then Index(p,do) <= len LS-Gik..LS by A187;
      then Index(p,do) <= len LS-'Gik..LS by XREAL_0:def 2;
      then
A188: Index(p,do) < len LS-'(Gik..LS)+1 by NAT_1:13;
A189: 1<=Index(p,do) by A178,JORDAN3:41;
A190: Gik..LS<=len LS by A37,FINSEQ_4:31;
      Gik..LS <> len LS by A29,A37,FINSEQ_4:29;
      then
A191: Gik..LS < len LS by A190,XXREAL_0:1;
A192: 1+1 <= len LS by A25,XXREAL_0:2;
      then
A193: 2 in dom LS by FINSEQ_3:27;
      set tt = Index(p,do)+(Gik..LS)-'1;
      set RC = Rotate(Cage(C,n),Emax);
A194: E-max C in right_cell(RC,1) by JORDAN1I:9;
A195: GoB RC = GoB Cage(C,n) by REVROT_1:28
        .= Ga by JORDAN1H:52;
A196: L~RC = L~Cage(C,n) by REVROT_1:33;
      consider g2 be Element of NAT such that
A197: 1 <= g2 and
A198: g2 <= width Ga and
A199: Emax = Ga*(len Ga,g2) by JORDAN1D:29;
A200: len Ga >= 4 by JORDAN8:13;
      then len Ga >= 1 by XXREAL_0:2;
      then
A201: [len Ga,g2] in Indices Ga by A197,A198,MATRIX_1:37;
A202: len RC = len Cage(C,n) by REVROT_1:14;
      LS = RC-:Wmin by JORDAN1G:26;
      then
A203: LSeg(LS,1) = LSeg(RC,1) by A192,SPPOL_2:9;
A204: Emax in rng Cage(C,n) by SPRECT_2:50;
      RC is_sequence_on Ga by A138,REVROT_1:34;
      then consider ii,g be Element of NAT such that
A205: [ii,g+1] in Indices Ga and
A206: [ii,g] in Indices Ga and
A207: RC/.1 = Ga*(ii,g+1) and
A208: RC/.(1+1) = Ga*(ii,g) by A85,A196,A202,A204,FINSEQ_6:98,JORDAN1I:25;
A209: g+1+1 <> g;
A210: 1 <= g by A206,MATRIX_1:39;
      RC/.1 = E-max L~RC by A196,A204,FINSEQ_6:98;
      then
A211: ii = len Ga by A196,A205,A207,A199,A201,GOBOARD1:21;
      then ii-1 >= 4-1 by A200,XREAL_1:11;
      then
A212: ii-1 >= 1 by XXREAL_0:2;
      then
A213: 1 <= ii-'1 by XREAL_0:def 2;
A214: g <= width Ga by A206,MATRIX_1:39;
      then
A215: Ga*(len Ga,g)`1 = Ebo by A11,A210,JORDAN1A:92;
A216: g+1 <= width Ga by A205,MATRIX_1:39;
      ii+1 <> ii;
      then
A217: right_cell(RC,1) = cell(Ga,ii-'1,g) by A85,A202,A195,A205,A206,A207,A208
,A209,GOBOARD5:def 6;
A218: ii <= len Ga by A206,MATRIX_1:39;
A219: 1 <= ii by A206,MATRIX_1:39;
A220: ii <= len Ga by A205,MATRIX_1:39;
A221: 1 <= g+1 by A205,MATRIX_1:39;
      then
A222: Ebo = Ga*(len Ga,g+1)`1 by A11,A216,JORDAN1A:92;
A223: 1 <= ii by A205,MATRIX_1:39;
      then
A224: ii-'1+1 = ii by XREAL_1:237;
      then
A225: ii-'1 < len Ga by A220,NAT_1:13;
      then
A226: Ga*(ii-'1,g+1)`2 = Ga*(1,g+1)`2 by A221,A216,A213,GOBOARD5:2
        .= Ga*(ii,g+1)`2 by A223,A220,A221,A216,GOBOARD5:2;
A227: (E-max C)`2 = p`2 by A177,TOPREAL1:def 13;
      then
A228: p`2 <= Ga*(ii-'1,g+1)`2 by A194,A220,A216,A210,A217,A224,A212,JORDAN9:19;
A229: Ga*(ii-'1,g)`2 = Ga*(1,g)`2 by A210,A214,A213,A225,GOBOARD5:2
        .= Ga*(ii,g)`2 by A219,A218,A210,A214,GOBOARD5:2;
      Ga*(ii-'1,g)`2 <= p`2 by A227,A194,A220,A216,A210,A217,A224,A212,
JORDAN9:19;
      then p in LSeg(RC/.1,RC/.(1+1)) by A186,A207,A208,A211,A228,A229,A226
,A215,A222,GOBOARD7:8;
      then
A230: p in LSeg(LS,1) by A85,A203,A202,TOPREAL1:def 5;
      1<=Gik..LS by A37,FINSEQ_4:31;
      then
A231: LSeg(mid(LS,Gik..LS,len LS),Index(p,do)) = LSeg(LS,Index(p,do)+(
      Gik..LS)-'1) by A191,A189,A188,JORDAN4:31;
      1<=Index(Gik,LS) by A9,JORDAN3:41;
      then
A232: 1+1 <= Gik..LS by A187,XREAL_1:9;
      then Index(p,do)+Gik..LS >= 1+1+1 by A189,XREAL_1:9;
      then Index(p,do)+Gik..LS-1 >= 1+1+1-1 by XREAL_1:11;
      then
A233: tt >= 1+1 by XREAL_0:def 2;
      now
        per cases by A233,XXREAL_0:1;
        suppose
          tt > 1+1;
          then LSeg(LS,1) misses LSeg(LS,tt) by TOPREAL1:def 9;
          hence contradiction by A230,A179,A185,A231,XBOOLE_0:3;
        end;
        suppose
A234:     tt = 1+1;
          then 1+1 = Index(p,do)+(Gik..LS)-1 by XREAL_0:def 2;
          then 1+1+1 = Index(p,do)+(Gik..LS);
          then
A235:     Gik..LS = 2 by A189,A232,JORDAN1E:10;
          LSeg(LS,1) /\ LSeg(LS,tt) = {LS/.2} by A25,A234,TOPREAL1:def 8;
          then p in {LS/.2} by A230,A179,A185,A231,XBOOLE_0:def 4;
          then
A236:     p = LS/.2 by TARSKI:def 1;
          then
A237:     p in rng LS by A193,PARTFUN2:4;
          p..LS = 2 by A193,A236,FINSEQ_5:44;
          then p = Gik by A37,A235,A237,FINSEQ_5:10;
          then Gik`1 = Ebo by A236,JORDAN1G:40;
          then Gik`1 = Ga*(len Ga,j)`1 by A1,A11,A13,JORDAN1A:92;
          hence contradiction by A3,A17,A67,JORDAN1G:7;
        end;
      end;
      hence contradiction;
    end;
  end;
  then east_halfline E-max C c= (L~godo)` by SUBSET_1:43;
  then consider W be Subset of TOP-REAL 2 such that
A238: W is_a_component_of (L~godo)` and
A239: east_halfline E-max C c= W by GOBOARD9:5;
  W is not Bounded by A239,JORDAN2C:16,129;
  then W is_outside_component_of L~godo by A238,JORDAN2C:def 4;
  then W c= UBD L~godo by JORDAN2C:27;
  then
A240: east_halfline E-max C c= UBD L~godo by A239,XBOOLE_1:1;
  E-max C in east_halfline E-max C by TOPREAL1:45;
  then E-max C in UBD L~godo by A240;
  then E-max C in LeftComp godo by GOBRD14:46;
  then LA meets L~godo by A130,A131,A132,A140,A151,JORDAN1J:36;
  then
A241: LA meets (L~go \/ L~pion1) or LA meets L~do by A141,XBOOLE_1:70;
A242: LA c= C by JORDAN6:76;
  per cases by A241,XBOOLE_1:70;
  suppose
    LA meets L~go;
    then LA meets L~Cage(C,n) by A46,A143,XBOOLE_1:1,63;
    hence contradiction by A242,JORDAN10:5,XBOOLE_1:63;
  end;
  suppose
    LA meets L~pion1;
    hence contradiction by A8,A81,A148;
  end;
  suppose
    LA meets L~do;
    then LA meets L~Cage(C,n) by A53,A144,XBOOLE_1:1,63;
    hence contradiction by A242,JORDAN10:5,XBOOLE_1:63;
  end;
end;

theorem Th39:
  for C be Simple_closed_curve for i,j,k be Element of NAT st 1 <
j & j <= k & k < len Gauge(C,n) & 1 <= i & i <= width Gauge(C,n) & LSeg(Gauge(C
  ,n)*(j,i),Gauge(C,n)*(k,i)) /\ L~Upper_Seq(C,n) = {Gauge(C,n)*(j,i)} & LSeg(
  Gauge(C,n)*(j,i),Gauge(C,n)*(k,i)) /\ L~Lower_Seq(C,n) = {Gauge(C,n)*(k,i)}
  holds LSeg(Gauge(C,n)*(j,i),Gauge(C,n)*(k,i)) meets Upper_Arc C
proof
  let C be Simple_closed_curve;
  let i,j,k be Element of NAT;
  set Ga = Gauge(C,n);
  set US = Upper_Seq(C,n);
  set LS = Lower_Seq(C,n);
  set UA = Upper_Arc C;
  set Wmin = W-min L~Cage(C,n);
  set Emax = E-max L~Cage(C,n);
  set Wbo = W-bound L~Cage(C,n);
  set Ebo = E-bound L~Cage(C,n);
  set Gij = Ga*(j,i);
  set Gik = Ga*(k,i);
  assume that
A1: 1 < j and
A2: j <= k and
A3: k < len Ga and
A4: 1 <= i and
A5: i <= width Ga and
A6: LSeg(Gij,Gik) /\ L~US = {Gij} and
A7: LSeg(Gij,Gik) /\ L~LS = {Gik} and
A8: LSeg(Gij,Gik) misses UA;
  Gik in {Gik} by TARSKI:def 1;
  then
A9: Gik in L~LS by A7,XBOOLE_0:def 4;
  Gij in {Gij} by TARSKI:def 1;
  then
A10: Gij in L~US by A6,XBOOLE_0:def 4;
A11: len Ga = width Ga by JORDAN8:def 1;
A12: j <> k by A1,A3,A4,A5,A9,A10,Th29;
A13: j < width Ga by A2,A3,A11,XXREAL_0:2;
A14: 1 < k by A1,A2,XXREAL_0:2;
A15: k < width Ga by A3,JORDAN8:def 1;
A16: [j,i] in Indices Ga by A1,A4,A5,A11,A13,MATRIX_1:37;
A17: [k,i] in Indices Ga by A3,A4,A5,A14,MATRIX_1:37;
  set go = R_Cut(US,Gij);
  set do = L_Cut(LS,Gik);
A18: len US >= 3 by JORDAN1E:19;
  then len US >= 1 by XXREAL_0:2;
  then 1 in dom US by FINSEQ_3:27;
  then
A19: US.1 = US/.1 by PARTFUN1:def 8
    .= Wmin by JORDAN1F:5;
A20: Wmin`1 = Wbo by EUCLID:56
    .= Ga*(1,i)`1 by A4,A5,A11,JORDAN1A:94;
  len Ga >= 4 by JORDAN8:13;
  then
A21: len Ga >= 1 by XXREAL_0:2;
  then
A22: [1,k] in Indices Ga by A14,A15,MATRIX_1:37;
A23: [1,i] in Indices Ga by A4,A5,A21,MATRIX_1:37;
  then
A24: Gij <> US.1 by A1,A16,A19,A20,JORDAN1G:7;
  then reconsider go as being_S-Seq FinSequence of TOP-REAL 2 by A10,JORDAN3:70
;
A25: len LS >= 1+2 by JORDAN1E:19;
  then
A26: len LS >= 1 by XXREAL_0:2;
  then
A27: 1 in dom LS by FINSEQ_3:27;
  len LS in dom LS by A26,FINSEQ_3:27;
  then
A28: LS.len LS = LS/.len LS by PARTFUN1:def 8
    .= Wmin by JORDAN1F:8;
  Wmin`1 = Wbo by EUCLID:56
    .= Ga*(1,i)`1 by A4,A5,A11,JORDAN1A:94;
  then
A29: Gik <> LS.len LS by A1,A2,A17,A23,A28,JORDAN1G:7;
  then reconsider do as being_S-Seq FinSequence of TOP-REAL 2 by A9,JORDAN3:69;
A30: [len Ga,k] in Indices Ga by A14,A15,A21,MATRIX_1:37;
A31: LS.1 = LS/.1 by A27,PARTFUN1:def 8
    .= Emax by JORDAN1F:6;
  Emax`1 = Ebo by EUCLID:56
    .= Ga*(len Ga,k)`1 by A3,A14,JORDAN1A:92;
  then
A32: Gik <> LS.1 by A3,A17,A30,A31,JORDAN1G:7;
A33: len go >= 1+1 by TOPREAL1:def 10;
A34: Gij in rng US by A1,A4,A5,A10,A11,A13,JORDAN1G:4,JORDAN1J:40;
  then
A35: go is_sequence_on Ga by JORDAN1G:4,JORDAN1J:38;
A36: len do >= 1+1 by TOPREAL1:def 10;
A37: Gik in rng LS by A4,A5,A9,A11,A14,A15,JORDAN1G:5,JORDAN1J:40;
  then
A38: do is_sequence_on Ga by JORDAN1G:5,JORDAN1J:39;
  reconsider go as non constant s.c.c. (being_S-Seq FinSequence of TOP-REAL 2)
  by A33,A35,JGRAPH_1:16,JORDAN8:8;
  reconsider do as non constant s.c.c. (being_S-Seq FinSequence of TOP-REAL 2)
  by A36,A38,JGRAPH_1:16,JORDAN8:8;
A39: len go > 1 by A33,NAT_1:13;
  then
A40: len go in dom go by FINSEQ_3:27;
  then
A41: go/.len go = go.len go by PARTFUN1:def 8
    .= Gij by A10,JORDAN3:59;
  len do >= 1 by A36,XXREAL_0:2;
  then 1 in dom do by FINSEQ_3:27;
  then
A42: do/.1 = do.1 by PARTFUN1:def 8
    .= Gik by A9,JORDAN3:58;
  reconsider m = len go - 1 as Element of NAT by A40,FINSEQ_3:28;
A43: m+1 = len go;
  then
A44: len go-'1 = m by NAT_D:34;
A45: LSeg(go,m) c= L~go by TOPREAL3:26;
A46: L~go c= L~US by A10,JORDAN3:76;
  then LSeg(go,m) c= L~US by A45,XBOOLE_1:1;
  then
A47: LSeg(go,m) /\ LSeg(Gik,Gij) c= {Gij} by A6,XBOOLE_1:26;
  m >= 1 by A33,XREAL_1:21;
  then
A48: LSeg(go,m) = LSeg(go/.m,Gij) by A41,A43,TOPREAL1:def 5;
  {Gij} c= LSeg(go,m) /\ LSeg(Gik,Gij)
  proof
    let x be set;
A49: Gij in LSeg(Gik,Gij) by RLTOPSP1:69;
    assume x in {Gij};
    then
A50: x = Gij by TARSKI:def 1;
    Gij in LSeg(go,m) by A48,RLTOPSP1:69;
    hence thesis by A50,A49,XBOOLE_0:def 4;
  end;
  then
A51: LSeg(go,m) /\ LSeg(Gik,Gij) = {Gij} by A47,XBOOLE_0:def 10;
A52: LSeg(do,1) c= L~do by TOPREAL3:26;
A53: L~do c= L~LS by A9,JORDAN3:77;
  then LSeg(do,1) c= L~LS by A52,XBOOLE_1:1;
  then
A54: LSeg(do,1) /\ LSeg(Gik,Gij) c= {Gik} by A7,XBOOLE_1:26;
A55: LSeg(do,1) = LSeg(Gik,do/.(1+1)) by A36,A42,TOPREAL1:def 5;
  {Gik} c= LSeg(do,1) /\ LSeg(Gik,Gij)
  proof
    let x be set;
A56: Gik in LSeg(Gik,Gij) by RLTOPSP1:69;
    assume x in {Gik};
    then
A57: x = Gik by TARSKI:def 1;
    Gik in LSeg(do,1) by A55,RLTOPSP1:69;
    hence thesis by A57,A56,XBOOLE_0:def 4;
  end;
  then
A58: LSeg(Gik,Gij) /\ LSeg(do,1) = {Gik} by A54,XBOOLE_0:def 10;
A59: go/.1 = US/.1 by A10,SPRECT_3:39
    .= Wmin by JORDAN1F:5;
  then
A60: go/.1 = LS/.len LS by JORDAN1F:8
    .= do/.len do by A9,JORDAN1J:35;
A61: rng go c= L~go by A33,SPPOL_2:18;
A62: rng do c= L~do by A36,SPPOL_2:18;
A63: {go/.1} c= L~go /\ L~do
  proof
    let x be set;
    assume x in {go/.1};
    then
A64: x = go/.1 by TARSKI:def 1;
    then
A65: x in rng go by FINSEQ_6:46;
    x in rng do by A60,A64,REVROT_1:3;
    hence thesis by A61,A62,A65,XBOOLE_0:def 4;
  end;
A66: LS.1 = LS/.1 by A27,PARTFUN1:def 8
    .= Emax by JORDAN1F:6;
A67: [len Ga,j] in Indices Ga by A1,A13,A21,MATRIX_1:37;
  L~go /\ L~do c= {go/.1}
  proof
    let x be set;
    assume
A68: x in L~go /\ L~do;
    then
A69: x in L~do by XBOOLE_0:def 4;
A70: now
      assume x = Emax;
      then
A71:  Emax = Gik by A9,A66,A69,JORDAN1E:11;
      Ga*(len Ga,j)`1 = Ebo by A1,A11,A13,JORDAN1A:92;
      then Emax`1 <> Ebo by A3,A17,A67,A71,JORDAN1G:7;
      hence contradiction by EUCLID:56;
    end;
    x in L~go by A68,XBOOLE_0:def 4;
    then x in L~US /\ L~LS by A46,A53,A69,XBOOLE_0:def 4;
    then x in {Wmin,Emax} by JORDAN1E:20;
    then x = Wmin or x = Emax by TARSKI:def 2;
    hence thesis by A59,A70,TARSKI:def 1;
  end;
  then
A72: L~go /\ L~do = {go/.1} by A63,XBOOLE_0:def 10;
  set W2 = go/.2;
A73: 2 in dom go by A33,FINSEQ_3:27;
A74: now
    assume Gij`1 = Wbo;
    then Ga*(1,k)`1 = Ga*(j,i)`1 by A3,A14,JORDAN1A:94;
    hence contradiction by A1,A16,A22,JORDAN1G:7;
  end;
  go = mid(US,1,Gij..US) by A34,JORDAN1G:57
    .= US|(Gij..US) by A34,FINSEQ_4:31,FINSEQ_6:122;
  then
A75: W2 = US/.2 by A73,FINSEQ_4:85;
A76: Wmin in rng go by A59,FINSEQ_6:46;
  set pion = <*Gij,Gik*>;
A77: now
    let n be Element of NAT;
    assume n in dom pion;
    then n in {1,2} by FINSEQ_1:4,FINSEQ_3:29;
    then n = 1 or n = 2 by TARSKI:def 2;
    hence ex j,i be Element of NAT st [j,i] in Indices Ga & pion/.n = Ga*(j,i)
    by A16,A17,FINSEQ_4:26;
  end;
A78: Gik <> Gij by A12,A16,A17,GOBOARD1:21;
  Gik`2 = Ga*(1,i)`2 by A3,A4,A5,A14,GOBOARD5:2
    .= Gij`2 by A1,A4,A5,A11,A13,GOBOARD5:2;
  then LSeg(Gik,Gij) is horizontal by SPPOL_1:36;
  then pion is being_S-Seq by A78,JORDAN1B:9;
  then consider pion1 be FinSequence of TOP-REAL 2 such that
A79: pion1 is_sequence_on Ga and
A80: pion1 is being_S-Seq and
A81: L~pion = L~pion1 and
A82: pion/.1 = pion1/.1 and
A83: pion/.len pion = pion1/.len pion1 and
A84: len pion <= len pion1 by A77,GOBOARD3:2;
  reconsider pion1 as being_S-Seq FinSequence of TOP-REAL 2 by A80;
  set godo = go^'pion1^'do;
A85: 1+1 <= len Cage(C,n) by GOBOARD7:36,XXREAL_0:2;
A86: 1+1 <= len Rotate(Cage(C,n),Wmin) by GOBOARD7:36,XXREAL_0:2;
  len (go^'pion1) >= len go by TOPREAL8:7;
  then
A87: len (go^'pion1) >= 1+1 by A33,XXREAL_0:2;
  then
A88: len (go^'pion1) > 1+0 by NAT_1:13;
A89: len godo >= len (go^'pion1) by TOPREAL8:7;
  then
A90: 1+1 <= len godo by A87,XXREAL_0:2;
A91: US is_sequence_on Ga by JORDAN1G:4;
A92: go/.len go = pion1/.1 by A41,A82,FINSEQ_4:26;
  then
A93: go^'pion1 is_sequence_on Ga by A35,A79,TOPREAL8:12;
A94: (go^'pion1)/.len (go^'pion1) = pion/.len pion by A83,GRAPH_2:58
    .= pion/.2 by FINSEQ_1:61
    .= do/.1 by A42,FINSEQ_4:26;
  then
A95: godo is_sequence_on Ga by A38,A93,TOPREAL8:12;
  LSeg(pion1,1) c= L~<*Gij,Gik*> by A81,TOPREAL3:26;
  then LSeg(pion1,1) c= LSeg(Gij,Gik) by SPPOL_2:21;
  then
A96: LSeg(go,len go-'1) /\ LSeg(pion1,1) c= {Gij} by A44,A51,XBOOLE_1:27;
A97: len pion1 >= 1+1 by A84,FINSEQ_1:61;
  {Gij} c= LSeg(go,m) /\ LSeg(pion1,1)
  proof
    let x be set;
    assume x in {Gij};
    then
A98: x = Gij by TARSKI:def 1;
A99: Gij in LSeg(go,m) by A48,RLTOPSP1:69;
    Gij in LSeg(pion1,1) by A41,A92,A97,TOPREAL1:27;
    hence thesis by A98,A99,XBOOLE_0:def 4;
  end;
  then LSeg(go,len go-'1) /\ LSeg(pion1,1) = { go/.len go } by A41,A44,A96,
XBOOLE_0:def 10;
  then
A100: go^'pion1 is unfolded by A92,TOPREAL8:34;
  len pion1 >= 2+0 by A84,FINSEQ_1:61;
  then
A101: len pion1-2 >= 0 by XREAL_1:21;
  len (go^'pion1)+1-1 = len go+len pion1-1 by GRAPH_2:13;
  then len (go^'pion1)-1 = len go + (len pion1-2)
    .= len go + (len pion1-'2) by A101,XREAL_0:def 2;
  then
A102: len (go^'pion1)-'1 = len go + (len pion1-'2) by XREAL_0:def 2;
A103: len pion1-1 >= 1 by A97,XREAL_1:21;
  then
A104: len pion1-'1 = len pion1-1 by XREAL_0:def 2;
A105: len pion1-'2+1 = len pion1-2+1 by A101,XREAL_0:def 2
    .= len pion1-'1 by A103,XREAL_0:def 2;
  len pion1-1+1 <= len pion1;
  then
A106: len pion1-'1 < len pion1 by A104,NAT_1:13;
  LSeg(pion1,len pion1-'1) c= L~<*Gij,Gik*> by A81,TOPREAL3:26;
  then LSeg(pion1,len pion1-'1) c= LSeg(Gij,Gik) by SPPOL_2:21;
  then
A107: LSeg(pion1,len pion1-'1) /\ LSeg(do,1) c= {Gik} by A58,XBOOLE_1:27;
  {Gik} c= LSeg(pion1,len pion1-'1) /\ LSeg(do,1)
  proof
    let x be set;
    assume x in {Gik};
    then
A108: x = Gik by TARSKI:def 1;
    pion1/.(len pion1-'1+1) = pion/.2 by A83,A104,FINSEQ_1:61
      .= Gik by FINSEQ_4:26;
    then
A109: Gik in LSeg(pion1,len pion1-'1) by A103,A104,TOPREAL1:27;
    Gik in LSeg(do,1) by A55,RLTOPSP1:69;
    hence thesis by A108,A109,XBOOLE_0:def 4;
  end;
  then LSeg(pion1,len pion1-'1) /\ LSeg(do,1) = {Gik} by A107,XBOOLE_0:def 10;
  then
A110: LSeg(go^'pion1,len go+(len pion1-'2)) /\ LSeg(do,1) = {(go^'pion1)/.
  len (go^'pion1)} by A42,A92,A94,A105,A106,TOPREAL8:31;
A111: (go^'pion1) is non trivial by A87,REALSET1:13;
A112: rng pion1 c= L~pion1 by A97,SPPOL_2:18;
A113: {pion1/.1} c= L~go /\ L~pion1
  proof
    let x be set;
    assume x in {pion1/.1};
    then
A114: x = pion1/.1 by TARSKI:def 1;
    then
A115: x in rng pion1 by FINSEQ_6:46;
    x in rng go by A92,A114,REVROT_1:3;
    hence thesis by A61,A112,A115,XBOOLE_0:def 4;
  end;
  L~go /\ L~pion1 c= {pion1/.1}
  proof
    let x be set;
    assume
A116: x in L~go /\ L~pion1;
    then
A117: x in L~pion1 by XBOOLE_0:def 4;
    x in L~go by A116,XBOOLE_0:def 4;
    then x in L~pion1 /\ L~US by A46,A117,XBOOLE_0:def 4;
    hence thesis by A6,A41,A81,A92,SPPOL_2:21;
  end;
  then
A118: L~go /\ L~pion1 = {pion1/.1} by A113,XBOOLE_0:def 10;
  then
A119: (go^'pion1) is s.n.c. by A92,JORDAN1J:54;
  rng go /\ rng pion1 c= {pion1/.1} by A61,A112,A118,XBOOLE_1:27;
  then
A120: go^'pion1 is one-to-one by JORDAN1J:55;
A121: pion/.len pion = pion/.2 by FINSEQ_1:61
    .= do/.1 by A42,FINSEQ_4:26;
A122: {pion1/.len pion1} c= L~do /\ L~pion1
  proof
    let x be set;
    assume x in {pion1/.len pion1};
    then
A123: x = pion1/.len pion1 by TARSKI:def 1;
    then
A124: x in rng pion1 by REVROT_1:3;
    x in rng do by A83,A121,A123,FINSEQ_6:46;
    hence thesis by A62,A112,A124,XBOOLE_0:def 4;
  end;
  L~do /\ L~pion1 c= {pion1/.len pion1}
  proof
    let x be set;
    assume
A125: x in L~do /\ L~pion1;
    then
A126: x in L~pion1 by XBOOLE_0:def 4;
    x in L~do by A125,XBOOLE_0:def 4;
    then x in L~pion1 /\ L~LS by A53,A126,XBOOLE_0:def 4;
    hence thesis by A7,A42,A81,A83,A121,SPPOL_2:21;
  end;
  then
A127: L~do /\ L~pion1 = {pion1/.len pion1} by A122,XBOOLE_0:def 10;
A128: L~(go^'pion1) /\ L~do = (L~go \/ L~pion1) /\ L~do by A92,TOPREAL8:35
    .= {go/.1} \/ {do/.1} by A72,A83,A121,A127,XBOOLE_1:23
    .= {(go^'pion1)/.1} \/ {do/.1} by GRAPH_2:57
    .= {(go^'pion1)/.1,do/.1} by ENUMSET1:41;
  do/.len do = (go^'pion1)/.1 by A60,GRAPH_2:57;
  then reconsider
  godo as non constant standard special_circular_sequence by A90,A94,A95,A100
,A102,A110,A111,A119,A120,A128,JORDAN8:7,8,TOPREAL8:11,33,34;
A129: UA is_an_arc_of W-min C,E-max C by JORDAN6:def 8;
  then
A130: UA is connected by JORDAN6:11;
A131: W-min C in UA by A129,TOPREAL1:4;
A132: E-max C in UA by A129,TOPREAL1:4;
  set ff = Rotate(Cage(C,n),Wmin);
  Wmin in rng Cage(C,n) by SPRECT_2:47;
  then
A133: ff/.1 = Wmin by FINSEQ_6:98;
A134: L~ff = L~Cage(C,n) by REVROT_1:33;
  then (W-max L~ff)..ff > 1 by A133,SPRECT_5:23;
  then (N-min L~ff)..ff > 1 by A133,A134,SPRECT_5:24,XXREAL_0:2;
  then (N-max L~ff)..ff > 1 by A133,A134,SPRECT_5:25,XXREAL_0:2;
  then
A135: Emax..ff > 1 by A133,A134,SPRECT_5:26,XXREAL_0:2;
A136: now
    assume
A137: Gij..US <= 1;
    Gij..US >= 1 by A34,FINSEQ_4:31;
    then Gij..US = 1 by A137,XXREAL_0:1;
    then Gij = US/.1 by A34,FINSEQ_5:41;
    hence contradiction by A19,A24,JORDAN1F:5;
  end;
A138: Cage(C,n) is_sequence_on Ga by JORDAN9:def 1;
  then
A139: ff is_sequence_on Ga by REVROT_1:34;
A140: right_cell(godo,1,Ga)\L~godo c= RightComp godo by A90,A95,JORDAN9:29;
A141: L~godo = L~(go^'pion1) \/ L~do by A94,TOPREAL8:35
    .= L~go \/ L~pion1 \/ L~do by A92,TOPREAL8:35;
A142: L~Cage(C,n) = L~US \/ L~LS by JORDAN1E:17;
  then
A143: L~US c= L~Cage(C,n) by XBOOLE_1:7;
A144: L~LS c= L~Cage(C,n) by A142,XBOOLE_1:7;
A145: L~go c= L~Cage(C,n) by A46,A143,XBOOLE_1:1;
A146: L~do c= L~Cage(C,n) by A53,A144,XBOOLE_1:1;
A147: W-min C in C by SPRECT_1:15;
A148: L~pion = LSeg(Gik,Gij) by SPPOL_2:21;
A149: now
    assume W-min C in L~godo;
    then
A150: W-min C in L~go \/ L~pion1 or W-min C in L~do by A141,XBOOLE_0:def 3;
    per cases by A150,XBOOLE_0:def 3;
    suppose
      W-min C in L~go;
      then C meets L~Cage(C,n) by A145,A147,XBOOLE_0:3;
      hence contradiction by JORDAN10:5;
    end;
    suppose
      W-min C in L~pion1;
      hence contradiction by A8,A81,A131,A148,XBOOLE_0:3;
    end;
    suppose
      W-min C in L~do;
      then C meets L~Cage(C,n) by A146,A147,XBOOLE_0:3;
      hence contradiction by JORDAN10:5;
    end;
  end;
  right_cell(Rotate(Cage(C,n),Wmin),1) = right_cell(ff,1,GoB ff) by A86,
JORDAN1H:29
    .= right_cell(ff,1,GoB Cage(C,n)) by REVROT_1:28
    .= right_cell(ff,1,Ga) by JORDAN1H:52
    .= right_cell(ff-:Emax,1,Ga) by A135,A139,JORDAN1J:53
    .= right_cell(US,1,Ga) by JORDAN1E:def 1
    .= right_cell(R_Cut(US,Gij),1,Ga) by A34,A91,A136,JORDAN1J:52
    .= right_cell(go^'pion1,1,Ga) by A39,A93,JORDAN1J:51
    .= right_cell(godo,1,Ga) by A88,A95,JORDAN1J:51;
  then W-min C in right_cell(godo,1,Ga) by JORDAN1I:8;
  then
A151: W-min C in right_cell(godo,1,Ga)\L~godo by A149,XBOOLE_0:def 5;
A152: godo/.1 = (go^'pion1)/.1 by GRAPH_2:57
    .= Wmin by A59,GRAPH_2:57;
A153: len US >= 2 by A18,XXREAL_0:2;
A154: godo/.2 = (go^'pion1)/.2 by A87,GRAPH_2:61
    .= US/.2 by A33,A75,GRAPH_2:61
    .= (US^'LS)/.2 by A153,GRAPH_2:61
    .= Rotate(Cage(C,n),Wmin)/.2 by JORDAN1E:15;
A155: L~go \/ L~do is compact by COMPTS_1:19;
  Wmin in L~go \/ L~do by A61,A76,XBOOLE_0:def 3;
  then
A156: W-min (L~go \/ L~do) = Wmin by A145,A146,A155,JORDAN1J:21,XBOOLE_1:8;
A157: (W-min (L~go \/ L~do))`1 = W-bound (L~go \/ L~do) by EUCLID:56;
A158: Wmin`1 = Wbo by EUCLID:56;
A159: Gij`1 <= Gik`1 by A1,A2,A3,A4,A5,SPRECT_3:25;
  then W-bound LSeg(Gik,Gij) = Gij`1 by SPRECT_1:62;
  then
A160: W-bound L~pion1 = Gij`1 by A81,SPPOL_2:21;
  Gij`1 >= Wbo by A10,A143,PSCOMP_1:71;
  then Gij`1 > Wbo by A74,XXREAL_0:1;
  then W-min (L~go\/L~do\/L~pion1) = W-min (L~go \/ L~do) by A155,A156,A157
,A158,A160,JORDAN1J:33;
  then
A161: W-min L~godo = Wmin by A141,A156,XBOOLE_1:4;
A162: rng godo c= L~godo by A87,A89,SPPOL_2:18,XXREAL_0:2;
  2 in dom godo by A90,FINSEQ_3:27;
  then
A163: godo/.2 in rng godo by PARTFUN2:4;
  godo/.2 in W-most L~Cage(C,n) by A154,JORDAN1I:27;
  then (godo/.2)`1 = (W-min L~godo)`1 by A161,PSCOMP_1:88
    .= W-bound L~godo by EUCLID:56;
  then godo/.2 in W-most L~godo by A162,A163,SPRECT_2:16;
  then Rotate(godo,W-min L~godo)/.2 in W-most L~godo by A152,A161,FINSEQ_6:95;
  then reconsider godo as clockwise_oriented non constant standard
  special_circular_sequence by JORDAN1I:27;
  len US in dom US by FINSEQ_5:6;
  then
A164: US.len US = US/.len US by PARTFUN1:def 8
    .= Emax by JORDAN1F:7;
A165: east_halfline E-max C misses L~go
  proof
    assume east_halfline E-max C meets L~go;
    then consider p be set such that
A166: p in east_halfline E-max C and
A167: p in L~go by XBOOLE_0:3;
    reconsider p as Point of TOP-REAL 2 by A166;
    p in L~US by A46,A167;
    then p in east_halfline E-max C /\ L~Cage(C,n) by A143,A166,XBOOLE_0:def 4;
    then
A168: p`1 = Ebo by JORDAN1A:104,PSCOMP_1:111;
    then
A169: p = Emax by A46,A167,JORDAN1J:46;
    then Emax = Gij by A10,A164,A167,JORDAN1J:43;
    then Gij`1 = Ga*(len Ga,k)`1 by A3,A14,A168,A169,JORDAN1A:92;
    hence contradiction by A2,A3,A16,A30,JORDAN1G:7;
  end;
  now
    assume east_halfline E-max C meets L~godo;
    then
A170: east_halfline E-max C meets (L~go \/ L~pion1) or east_halfline E-max
    C meets L~do by A141,XBOOLE_1:70;
    per cases by A170,XBOOLE_1:70;
    suppose
      east_halfline E-max C meets L~go;
      hence contradiction by A165;
    end;
    suppose
      east_halfline E-max C meets L~pion1;
      then consider p be set such that
A171: p in east_halfline E-max C and
A172: p in L~pion1 by XBOOLE_0:3;
      reconsider p as Point of TOP-REAL 2 by A171;
A173: p`2 = (E-max C)`2 by A171,TOPREAL1:def 13;
      k+1 <= len Ga by A3,NAT_1:13;
      then k+1-1 <= len Ga-1 by XREAL_1:11;
      then
A174: k <= len Ga-'1 by XREAL_0:def 2;
      len Ga-'1 <= len Ga by NAT_D:35;
      then
A175: Gik`1 <= Ga*(len Ga-'1,1)`1 by A4,A5,A11,A14,A21,A174,JORDAN1A:39;
      p`1 <= Gik`1 by A81,A148,A159,A172,TOPREAL1:9;
      then p`1 <= Ga*(len Ga-'1,1)`1 by A175,XXREAL_0:2;
      then p`1 <= E-bound C by A21,JORDAN8:15;
      then
A176: p`1 <= (E-max C)`1 by EUCLID:56;
      p`1 >= (E-max C)`1 by A171,TOPREAL1:def 13;
      then p`1 = (E-max C)`1 by A176,XXREAL_0:1;
      then p = E-max C by A173,TOPREAL3:11;
      hence contradiction by A8,A81,A132,A148,A172,XBOOLE_0:3;
    end;
    suppose
      east_halfline E-max C meets L~do;
      then consider p be set such that
A177: p in east_halfline E-max C and
A178: p in L~do by XBOOLE_0:3;
      reconsider p as Point of TOP-REAL 2 by A177;
A179: p in LSeg(do,Index(p,do)) by A178,JORDAN3:42;
      consider t be Nat such that
A180: t in dom LS and
A181: LS.t = Gik by A37,FINSEQ_2:11;
      1 <= t by A180,FINSEQ_3:27;
      then
A182: 1 < t by A32,A181,XXREAL_0:1;
      t <= len LS by A180,FINSEQ_3:27;
      then Index(Gik,LS)+1 = t by A181,A182,JORDAN3:45;
      then
A183: len L_Cut(LS,Gik) = len LS-Index(Gik,LS) by A9,A181,JORDAN3:61;
      Index(p,do) < len do by A178,JORDAN3:41;
      then Index(p,do) < len LS-'Index(Gik,LS) by A183,XREAL_0:def 2;
      then Index(p,do)+1 <= len LS-'Index(Gik,LS) by NAT_1:13;
      then
A184: Index(p,do) <= len LS-'Index(Gik,LS)-1 by XREAL_1:21;
A185: do = mid(LS,Gik..LS,len LS) by A37,JORDAN1J:37;
      p in L~LS by A53,A178;
      then p in east_halfline E-max C /\ L~Cage(C,n) by A144,A177,
XBOOLE_0:def 4;
      then
A186: p`1 = Ebo by JORDAN1A:104,PSCOMP_1:111;
A187: Index(Gik,LS)+1 = Gik..LS by A32,A37,JORDAN1J:56;
      0+Index(Gik,LS) < len LS by A9,JORDAN3:41;
      then len LS-Index(Gik,LS) > 0 by XREAL_1:22;
      then Index(p,do) <= len LS-Index(Gik,LS)-1 by A184,XREAL_0:def 2;
      then Index(p,do) <= len LS-Gik..LS by A187;
      then Index(p,do) <= len LS-'Gik..LS by XREAL_0:def 2;
      then
A188: Index(p,do) < len LS-'(Gik..LS)+1 by NAT_1:13;
A189: 1<=Index(p,do) by A178,JORDAN3:41;
A190: Gik..LS<=len LS by A37,FINSEQ_4:31;
      Gik..LS <> len LS by A29,A37,FINSEQ_4:29;
      then
A191: Gik..LS < len LS by A190,XXREAL_0:1;
A192: 1+1 <= len LS by A25,XXREAL_0:2;
      then
A193: 2 in dom LS by FINSEQ_3:27;
      set tt = Index(p,do)+(Gik..LS)-'1;
      set RC = Rotate(Cage(C,n),Emax);
A194: E-max C in right_cell(RC,1) by JORDAN1I:9;
A195: GoB RC = GoB Cage(C,n) by REVROT_1:28
        .= Ga by JORDAN1H:52;
A196: L~RC = L~Cage(C,n) by REVROT_1:33;
      consider g2 be Element of NAT such that
A197: 1 <= g2 and
A198: g2 <= width Ga and
A199: Emax = Ga*(len Ga,g2) by JORDAN1D:29;
A200: len Ga >= 4 by JORDAN8:13;
      then len Ga >= 1 by XXREAL_0:2;
      then
A201: [len Ga,g2] in Indices Ga by A197,A198,MATRIX_1:37;
A202: len RC = len Cage(C,n) by REVROT_1:14;
      LS = RC-:Wmin by JORDAN1G:26;
      then
A203: LSeg(LS,1) = LSeg(RC,1) by A192,SPPOL_2:9;
A204: Emax in rng Cage(C,n) by SPRECT_2:50;
      RC is_sequence_on Ga by A138,REVROT_1:34;
      then consider ii,g be Element of NAT such that
A205: [ii,g+1] in Indices Ga and
A206: [ii,g] in Indices Ga and
A207: RC/.1 = Ga*(ii,g+1) and
A208: RC/.(1+1) = Ga*(ii,g) by A85,A196,A202,A204,FINSEQ_6:98,JORDAN1I:25;
A209: g+1+1 <> g;
A210: 1 <= g by A206,MATRIX_1:39;
      RC/.1 = E-max L~RC by A196,A204,FINSEQ_6:98;
      then
A211: ii = len Ga by A196,A205,A207,A199,A201,GOBOARD1:21;
      then ii-1 >= 4-1 by A200,XREAL_1:11;
      then
A212: ii-1 >= 1 by XXREAL_0:2;
      then
A213: 1 <= ii-'1 by XREAL_0:def 2;
A214: g <= width Ga by A206,MATRIX_1:39;
      then
A215: Ga*(len Ga,g)`1 = Ebo by A11,A210,JORDAN1A:92;
A216: g+1 <= width Ga by A205,MATRIX_1:39;
      ii+1 <> ii;
      then
A217: right_cell(RC,1) = cell(Ga,ii-'1,g) by A85,A202,A195,A205,A206,A207,A208
,A209,GOBOARD5:def 6;
A218: ii <= len Ga by A206,MATRIX_1:39;
A219: 1 <= ii by A206,MATRIX_1:39;
A220: ii <= len Ga by A205,MATRIX_1:39;
A221: 1 <= g+1 by A205,MATRIX_1:39;
      then
A222: Ebo = Ga*(len Ga,g+1)`1 by A11,A216,JORDAN1A:92;
A223: 1 <= ii by A205,MATRIX_1:39;
      then
A224: ii-'1+1 = ii by XREAL_1:237;
      then
A225: ii-'1 < len Ga by A220,NAT_1:13;
      then
A226: Ga*(ii-'1,g+1)`2 = Ga*(1,g+1)`2 by A221,A216,A213,GOBOARD5:2
        .= Ga*(ii,g+1)`2 by A223,A220,A221,A216,GOBOARD5:2;
A227: (E-max C)`2 = p`2 by A177,TOPREAL1:def 13;
      then
A228: p`2 <= Ga*(ii-'1,g+1)`2 by A194,A220,A216,A210,A217,A224,A212,JORDAN9:19;
A229: Ga*(ii-'1,g)`2 = Ga*(1,g)`2 by A210,A214,A213,A225,GOBOARD5:2
        .= Ga*(ii,g)`2 by A219,A218,A210,A214,GOBOARD5:2;
      Ga*(ii-'1,g)`2 <= p`2 by A227,A194,A220,A216,A210,A217,A224,A212,
JORDAN9:19;
      then p in LSeg(RC/.1,RC/.(1+1)) by A186,A207,A208,A211,A228,A229,A226
,A215,A222,GOBOARD7:8;
      then
A230: p in LSeg(LS,1) by A85,A203,A202,TOPREAL1:def 5;
      1<=Gik..LS by A37,FINSEQ_4:31;
      then
A231: LSeg(mid(LS,Gik..LS,len LS),Index(p,do)) = LSeg(LS,Index(p,do)+(
      Gik..LS)-'1) by A191,A189,A188,JORDAN4:31;
      1<=Index(Gik,LS) by A9,JORDAN3:41;
      then
A232: 1+1 <= Gik..LS by A187,XREAL_1:9;
      then Index(p,do)+Gik..LS >= 1+1+1 by A189,XREAL_1:9;
      then Index(p,do)+Gik..LS-1 >= 1+1+1-1 by XREAL_1:11;
      then
A233: tt >= 1+1 by XREAL_0:def 2;
      now
        per cases by A233,XXREAL_0:1;
        suppose
          tt > 1+1;
          then LSeg(LS,1) misses LSeg(LS,tt) by TOPREAL1:def 9;
          hence contradiction by A230,A179,A185,A231,XBOOLE_0:3;
        end;
        suppose
A234:     tt = 1+1;
          then 1+1 = Index(p,do)+(Gik..LS)-1 by XREAL_0:def 2;
          then 1+1+1 = Index(p,do)+(Gik..LS);
          then
A235:     Gik..LS = 2 by A189,A232,JORDAN1E:10;
          LSeg(LS,1) /\ LSeg(LS,tt) = {LS/.2} by A25,A234,TOPREAL1:def 8;
          then p in {LS/.2} by A230,A179,A185,A231,XBOOLE_0:def 4;
          then
A236:     p = LS/.2 by TARSKI:def 1;
          then
A237:     p in rng LS by A193,PARTFUN2:4;
          p..LS = 2 by A193,A236,FINSEQ_5:44;
          then p = Gik by A37,A235,A237,FINSEQ_5:10;
          then Gik`1 = Ebo by A236,JORDAN1G:40;
          then Gik`1 = Ga*(len Ga,j)`1 by A1,A11,A13,JORDAN1A:92;
          hence contradiction by A3,A17,A67,JORDAN1G:7;
        end;
      end;
      hence contradiction;
    end;
  end;
  then east_halfline E-max C c= (L~godo)` by SUBSET_1:43;
  then consider W be Subset of TOP-REAL 2 such that
A238: W is_a_component_of (L~godo)` and
A239: east_halfline E-max C c= W by GOBOARD9:5;
  W is not Bounded by A239,JORDAN2C:16,129;
  then W is_outside_component_of L~godo by A238,JORDAN2C:def 4;
  then W c= UBD L~godo by JORDAN2C:27;
  then
A240: east_halfline E-max C c= UBD L~godo by A239,XBOOLE_1:1;
  E-max C in east_halfline E-max C by TOPREAL1:45;
  then E-max C in UBD L~godo by A240;
  then E-max C in LeftComp godo by GOBRD14:46;
  then UA meets L~godo by A130,A131,A132,A140,A151,JORDAN1J:36;
  then
A241: UA meets (L~go \/ L~pion1) or UA meets L~do by A141,XBOOLE_1:70;
A242: UA c= C by JORDAN6:76;
  per cases by A241,XBOOLE_1:70;
  suppose
    UA meets L~go;
    then UA meets L~Cage(C,n) by A46,A143,XBOOLE_1:1,63;
    hence contradiction by A242,JORDAN10:5,XBOOLE_1:63;
  end;
  suppose
    UA meets L~pion1;
    hence contradiction by A8,A81,A148;
  end;
  suppose
    UA meets L~do;
    then UA meets L~Cage(C,n) by A53,A144,XBOOLE_1:1,63;
    hence contradiction by A242,JORDAN10:5,XBOOLE_1:63;
  end;
end;

theorem Th40:
  for C be Simple_closed_curve for i,j,k be Element of NAT st 1 <
j & j <= k & k < len Gauge(C,n) & 1 <= i & i <= width Gauge(C,n) & Gauge(C,n)*(
  j,i) in L~Upper_Seq(C,n) & Gauge(C,n)*(k,i) in L~Lower_Seq(C,n) holds LSeg(
  Gauge(C,n)*(j,i),Gauge(C,n)*(k,i)) meets Lower_Arc C
proof
  let C be Simple_closed_curve;
  let i,j,k be Element of NAT;
  assume that
A1: 1 < j and
A2: j <= k and
A3: k < len Gauge(C,n) and
A4: 1 <= i and
A5: i <= width Gauge(C,n) and
A6: Gauge(C,n)*(j,i) in L~Upper_Seq(C,n) and
A7: Gauge(C,n)*(k,i) in L~Lower_Seq(C,n);
  consider j1,k1 be Element of NAT such that
A8: j <= j1 and
A9: j1 <= k1 and
A10: k1 <= k and
A11: LSeg(Gauge(C,n)*(j1,i),Gauge(C,n)*(k1,i)) /\ L~Upper_Seq(C,n) = {
  Gauge(C,n)*(j1,i)} and
A12: LSeg(Gauge(C,n)*(j1,i),Gauge(C,n)*(k1,i)) /\ L~Lower_Seq(C,n) = {
  Gauge(C,n)*(k1,i)} by A1,A2,A3,A4,A5,A6,A7,Th22;
A13: k1 < len Gauge(C,n) by A3,A10,XXREAL_0:2;
  1 < j1 by A1,A8,XXREAL_0:2;
  then
  LSeg(Gauge(C,n)*(j1,i),Gauge(C,n)*(k1,i)) meets Lower_Arc C by A4,A5,A9,A11
,A12,A13,Th38;
  hence thesis by A1,A3,A4,A5,A8,A9,A10,Th8,XBOOLE_1:63;
end;

theorem Th41:
  for C be Simple_closed_curve for i,j,k be Element of NAT st 1 <
j & j <= k & k < len Gauge(C,n) & 1 <= i & i <= width Gauge(C,n) & Gauge(C,n)*(
  j,i) in L~Upper_Seq(C,n) & Gauge(C,n)*(k,i) in L~Lower_Seq(C,n) holds LSeg(
  Gauge(C,n)*(j,i),Gauge(C,n)*(k,i)) meets Upper_Arc C
proof
  let C be Simple_closed_curve;
  let i,j,k be Element of NAT;
  assume that
A1: 1 < j and
A2: j <= k and
A3: k < len Gauge(C,n) and
A4: 1 <= i and
A5: i <= width Gauge(C,n) and
A6: Gauge(C,n)*(j,i) in L~Upper_Seq(C,n) and
A7: Gauge(C,n)*(k,i) in L~Lower_Seq(C,n);
  consider j1,k1 be Element of NAT such that
A8: j <= j1 and
A9: j1 <= k1 and
A10: k1 <= k and
A11: LSeg(Gauge(C,n)*(j1,i),Gauge(C,n)*(k1,i)) /\ L~Upper_Seq(C,n) = {
  Gauge(C,n)*(j1,i)} and
A12: LSeg(Gauge(C,n)*(j1,i),Gauge(C,n)*(k1,i)) /\ L~Lower_Seq(C,n) = {
  Gauge(C,n)*(k1,i)} by A1,A2,A3,A4,A5,A6,A7,Th22;
A13: k1 < len Gauge(C,n) by A3,A10,XXREAL_0:2;
  1 < j1 by A1,A8,XXREAL_0:2;
  then
  LSeg(Gauge(C,n)*(j1,i),Gauge(C,n)*(k1,i)) meets Upper_Arc C by A4,A5,A9,A11
,A12,A13,Th39;
  hence thesis by A1,A3,A4,A5,A8,A9,A10,Th8,XBOOLE_1:63;
end;

theorem Th42:
  for C be Simple_closed_curve for i,j,k be Element of NAT st 1 <
  j & j <= k & k < len Gauge(C,n) & 1 <= i & i <= width Gauge(C,n) & n > 0 &
  Gauge(C,n)*(j,i) in Upper_Arc L~Cage(C,n) & Gauge(C,n)*(k,i) in Lower_Arc L~
  Cage(C,n) holds LSeg(Gauge(C,n)*(j,i),Gauge(C,n)*(k,i)) meets Lower_Arc C
proof
  let C be Simple_closed_curve;
  let i,j,k be Element of NAT;
  assume that
A1: 1 < j and
A2: j <= k and
A3: k < len Gauge(C,n) and
A4: 1 <= i and
A5: i <= width Gauge(C,n) and
A6: n > 0 and
A7: Gauge(C,n)*(j,i) in Upper_Arc L~Cage(C,n) and
A8: Gauge(C,n)*(k,i) in Lower_Arc L~Cage(C,n);
A9: L~Lower_Seq(C,n) = Lower_Arc L~Cage(C,n) by A6,JORDAN1G:64;
  L~Upper_Seq(C,n) = Upper_Arc L~Cage(C,n) by A6,JORDAN1G:63;
  hence thesis by A1,A2,A3,A4,A5,A7,A8,A9,Th40;
end;

theorem Th43:
  for C be Simple_closed_curve for i,j,k be Element of NAT st 1 <
  j & j <= k & k < len Gauge(C,n) & 1 <= i & i <= width Gauge(C,n) & n > 0 &
  Gauge(C,n)*(j,i) in Upper_Arc L~Cage(C,n) & Gauge(C,n)*(k,i) in Lower_Arc L~
  Cage(C,n) holds LSeg(Gauge(C,n)*(j,i),Gauge(C,n)*(k,i)) meets Upper_Arc C
proof
  let C be Simple_closed_curve;
  let i,j,k be Element of NAT;
  assume that
A1: 1 < j and
A2: j <= k and
A3: k < len Gauge(C,n) and
A4: 1 <= i and
A5: i <= width Gauge(C,n) and
A6: n > 0 and
A7: Gauge(C,n)*(j,i) in Upper_Arc L~Cage(C,n) and
A8: Gauge(C,n)*(k,i) in Lower_Arc L~Cage(C,n);
A9: L~Lower_Seq(C,n) = Lower_Arc L~Cage(C,n) by A6,JORDAN1G:64;
  L~Upper_Seq(C,n) = Upper_Arc L~Cage(C,n) by A6,JORDAN1G:63;
  hence thesis by A1,A2,A3,A4,A5,A7,A8,A9,Th41;
end;

theorem
  for C be Simple_closed_curve for j,k be Element of NAT holds 1 < j & j
<= k & k < len Gauge(C,n+1) & Gauge(C,n+1)*(j,Center Gauge(C,n+1)) in Upper_Arc
L~Cage(C,n+1) & Gauge(C,n+1)*(k,Center Gauge(C,n+1)) in Lower_Arc L~Cage(C,n+1)
implies LSeg(Gauge(C,n+1)*(j,Center Gauge(C,n+1)), Gauge(C,n+1)*(k,Center Gauge
  (C,n+1))) meets Lower_Arc C
proof
  let C be Simple_closed_curve;
  let j,k be Element of NAT;
  assume that
A1: 1 < j and
A2: j <= k and
A3: k < len Gauge(C,n+1) and
A4: Gauge(C,n+1)*(j,Center Gauge(C,n+1)) in Upper_Arc L~Cage(C,n+1) and
A5: Gauge(C,n+1)*(k,Center Gauge(C,n+1)) in Lower_Arc L~Cage(C,n+1);
A6: len Gauge(C,n+1) >= 4 by JORDAN8:13;
  then len Gauge(C,n+1) >= 3 by XXREAL_0:2;
  then Center Gauge(C,n+1) < len Gauge(C,n+1) by JORDAN1B:16;
  then
A7: Center Gauge(C,n+1) < width Gauge(C,n+1) by JORDAN8:def 1;
  len Gauge(C,n+1) >= 2 by A6,XXREAL_0:2;
  then 1 < Center Gauge(C,n+1) by JORDAN1B:15;
  hence thesis by A1,A2,A3,A4,A5,A7,Th42;
end;

theorem
  for C be Simple_closed_curve for j,k be Element of NAT holds 1 < j & j
<= k & k < len Gauge(C,n+1) & Gauge(C,n+1)*(j,Center Gauge(C,n+1)) in Upper_Arc
L~Cage(C,n+1) & Gauge(C,n+1)*(k,Center Gauge(C,n+1)) in Lower_Arc L~Cage(C,n+1)
implies LSeg(Gauge(C,n+1)*(j,Center Gauge(C,n+1)), Gauge(C,n+1)*(k,Center Gauge
  (C,n+1))) meets Upper_Arc C
proof
  let C be Simple_closed_curve;
  let j,k be Element of NAT;
  assume that
A1: 1 < j and
A2: j <= k and
A3: k < len Gauge(C,n+1) and
A4: Gauge(C,n+1)*(j,Center Gauge(C,n+1)) in Upper_Arc L~Cage(C,n+1) and
A5: Gauge(C,n+1)*(k,Center Gauge(C,n+1)) in Lower_Arc L~Cage(C,n+1);
A6: len Gauge(C,n+1) >= 4 by JORDAN8:13;
  then len Gauge(C,n+1) >= 3 by XXREAL_0:2;
  then Center Gauge(C,n+1) < len Gauge(C,n+1) by JORDAN1B:16;
  then
A7: Center Gauge(C,n+1) < width Gauge(C,n+1) by JORDAN8:def 1;
  len Gauge(C,n+1) >= 2 by A6,XXREAL_0:2;
  then 1 < Center Gauge(C,n+1) by JORDAN1B:15;
  hence thesis by A1,A2,A3,A4,A5,A7,Th43;
end;

theorem Th46:
  for C be Simple_closed_curve for i1,i2,j,k be Element of NAT st
1 < i1 & i1 <= i2 & i2 < len Gauge(C,n) & 1 <= j & j <= k & k <= width Gauge(C,
n) & (LSeg(Gauge(C,n)*(i1,j),Gauge(C,n)*(i1,k)) \/ LSeg(Gauge(C,n)*(i1,k),Gauge
(C,n)*(i2,k))) /\ L~Upper_Seq(C,n) = {Gauge(C,n)*(i2,k)} & (LSeg(Gauge(C,n)*(i1
  ,j),Gauge(C,n)*(i1,k)) \/ LSeg(Gauge(C,n)*(i1,k),Gauge(C,n)*(i2,k))) /\ L~
Lower_Seq(C,n) = {Gauge(C,n)*(i1,j)} holds (LSeg(Gauge(C,n)*(i1,j),Gauge(C,n)*(
  i1,k)) \/ LSeg(Gauge(C,n)*(i1,k),Gauge(C,n)*(i2,k))) meets Upper_Arc C
proof
  let C be Simple_closed_curve;
  let i1,i2,j,k be Element of NAT;
  set G = Gauge(C,n);
  set pio = LSeg(G*(i1,j),G*(i1,k));
  set poz = LSeg(G*(i1,k),G*(i2,k));
  set US = Upper_Seq(C,n);
  set LS = Lower_Seq(C,n);
  assume that
A1: 1 < i1 and
A2: i1 <= i2 and
A3: i2 < len G and
A4: 1 <= j and
A5: j <= k and
A6: k <= width G and
A7: (pio \/ poz) /\ L~US = {G*(i2,k)} and
A8: (pio \/ poz) /\ L~LS = {G*(i1,j)} and
A9: (pio \/ poz) misses Upper_Arc C;
  set Gij = G*(i1,j);
A10: j <= width G by A5,A6,XXREAL_0:2;
A11: i1 < len G by A2,A3,XXREAL_0:2;
  then
A12: [i1,j] in Indices G by A1,A4,A10,MATRIX_1:37;
  set Gi1k = G*(i1,k);
  set Gik = G*(i2,k);
A13: L~<*Gik,Gi1k,Gij*> = poz \/ pio by TOPREAL3:23;
  len G >= 4 by JORDAN8:13;
  then
A14: len G >= 1 by XXREAL_0:2;
  then
A15: [len G,j] in Indices G by A4,A10,MATRIX_1:37;
A16: 1 <= k by A4,A5,XXREAL_0:2;
  then
A17: [1,k] in Indices G by A6,A14,MATRIX_1:37;
A18: 1 < i2 by A1,A2,XXREAL_0:2;
  then
A19: [i2,k] in Indices G by A3,A6,A16,MATRIX_1:37;
A20: Gi1k`2 = G*(1,k)`2 by A1,A6,A11,A16,GOBOARD5:2
    .= Gik`2 by A3,A6,A18,A16,GOBOARD5:2;
  Gi1k`1 = G*(i1,1)`1 by A1,A6,A11,A16,GOBOARD5:3
    .= Gij`1 by A1,A4,A11,A10,GOBOARD5:3;
  then
A21: Gi1k = |[Gij`1,Gik`2]| by A20,EUCLID:57;
A22: [len G,k] in Indices G by A6,A16,A14,MATRIX_1:37;
A23: [i1,j] in Indices G by A1,A4,A11,A10,MATRIX_1:37;
  set Wbo = W-bound L~Cage(C,n);
  set Wmin = W-min L~Cage(C,n);
A24: len G = width G by JORDAN8:def 1;
  set Ebo = E-bound L~Cage(C,n);
  set Emax = E-max L~Cage(C,n);
A25: len LS >= 1+2 by JORDAN1E:19;
  then
A26: len LS >= 1 by XXREAL_0:2;
  then
A27: 1 in dom LS by FINSEQ_3:27;
  then
A28: LS.1 = LS/.1 by PARTFUN1:def 8
    .= Emax by JORDAN1F:6;
  len LS in dom LS by A26,FINSEQ_3:27;
  then
A29: LS.len LS = LS/.len LS by PARTFUN1:def 8
    .= Wmin by JORDAN1F:8;
  set do = L_Cut(LS,Gij);
  Gij in {Gij} by TARSKI:def 1;
  then
A30: Gij in L~LS by A8,XBOOLE_0:def 4;
  Wmin`1 = Wbo by EUCLID:56
    .= G*(1,k)`1 by A6,A16,A24,JORDAN1A:94;
  then
A31: Gij <> LS.len LS by A1,A17,A29,A12,JORDAN1G:7;
  then reconsider do as being_S-Seq FinSequence of TOP-REAL 2 by A30,JORDAN3:69
;
A32: Gij in rng LS by A1,A4,A11,A30,A10,JORDAN1G:5,JORDAN1J:40;
  then
A33: do is_sequence_on G by JORDAN1G:5,JORDAN1J:39;
  Emax`1 = Ebo by EUCLID:56
    .= G*(len G,k)`1 by A6,A16,A24,JORDAN1A:92;
  then
A34: Gij <> LS.1 by A2,A3,A12,A22,A28,JORDAN1G:7;
A35: len do >= 1+1 by TOPREAL1:def 10;
  then reconsider
  do as non constant s.c.c. (being_S-Seq FinSequence of TOP-REAL 2)
  by A33,JGRAPH_1:16,JORDAN8:8;
A36: L~do c= L~LS by A30,JORDAN3:77;
A37: [1,j] in Indices G by A4,A10,A14,MATRIX_1:37;
A38: now
    assume Gij`1 = Wbo;
    then G*(1,j)`1 = G*(i1,j)`1 by A4,A10,A24,JORDAN1A:94;
    hence contradiction by A1,A23,A37,JORDAN1G:7;
  end;
  set pion = <*Gik,Gi1k,Gij*>;
A39: Gi1k in poz by RLTOPSP1:69;
  set UA = Upper_Arc C;
A40: Gi1k in pio by RLTOPSP1:69;
  set go = R_Cut(US,Gik);
A41: len US >= 3 by JORDAN1E:19;
  then len US >= 1 by XXREAL_0:2;
  then 1 in dom US by FINSEQ_3:27;
  then
A42: US.1 = US/.1 by PARTFUN1:def 8
    .= Wmin by JORDAN1F:5;
A43: [i1,k] in Indices G by A1,A6,A11,A16,MATRIX_1:37;
A44: now
    let n be Element of NAT;
    assume n in dom pion;
    then n in {1,2,3} by FINSEQ_3:1,30;
    then n = 1 or n = 2 or n = 3 by ENUMSET1:def 1;
    hence
    ex i,j be Element of NAT st [i,j] in Indices G & pion/.n = G*(i,j) by A23
,A19,A43,FINSEQ_4:27;
  end;
  Gik in {Gik} by TARSKI:def 1;
  then
A45: Gik in L~US by A7,XBOOLE_0:def 4;
  Wmin`1 = Wbo by EUCLID:56
    .= G*(1,k)`1 by A6,A16,A24,JORDAN1A:94;
  then
A46: Gik <> US.1 by A1,A2,A19,A42,A17,JORDAN1G:7;
  then reconsider go as being_S-Seq FinSequence of TOP-REAL 2 by A45,JORDAN3:70
;
A47: Gik in rng US by A3,A6,A18,A45,A16,JORDAN1G:4,JORDAN1J:40;
  then
A48: go is_sequence_on G by JORDAN1G:4,JORDAN1J:38;
  len do >= 1 by A35,XXREAL_0:2;
  then 1 in dom do by FINSEQ_3:27;
  then
A49: do/.1 = do.1 by PARTFUN1:def 8
    .= Gij by A30,JORDAN3:58;
  then
A50: LSeg(do,1) = LSeg(Gij,do/.(1+1)) by A35,TOPREAL1:def 5;
A51: {Gij} c= LSeg(do,1) /\ L~<*Gik,Gi1k,Gij*>
  proof
    let x be set;
    assume x in {Gij};
    then
A52: x = Gij by TARSKI:def 1;
    Gij in LSeg(Gi1k,Gij) by RLTOPSP1:69;
    then Gij in LSeg(Gik,Gi1k) \/ LSeg(Gi1k,Gij) by XBOOLE_0:def 3;
    then
A53: Gij in L~<*Gik,Gi1k,Gij*> by SPRECT_1:10;
    Gij in LSeg(do,1) by A50,RLTOPSP1:69;
    hence thesis by A52,A53,XBOOLE_0:def 4;
  end;
  LSeg(do,1) c= L~do by TOPREAL3:26;
  then LSeg(do,1) c= L~LS by A36,XBOOLE_1:1;
  then LSeg(do,1) /\ L~<*Gik,Gi1k,Gij*> c= {Gij} by A8,A13,XBOOLE_1:26;
  then
A54: L~<*Gik,Gi1k,Gij*> /\ LSeg(do,1) = {Gij} by A51,XBOOLE_0:def 10;
A55: rng do c= L~do by A35,SPPOL_2:18;
A56: len go >= 1+1 by TOPREAL1:def 10;
  then reconsider
  go as non constant s.c.c. (being_S-Seq FinSequence of TOP-REAL 2)
  by A48,JGRAPH_1:16,JORDAN8:8;
A57: L~go c= L~US by A45,JORDAN3:76;
A58: len go > 1 by A56,NAT_1:13;
  then
A59: len go in dom go by FINSEQ_3:27;
  then
A60: go/.len go = go.len go by PARTFUN1:def 8
    .= Gik by A45,JORDAN3:59;
  reconsider m = len go - 1 as Element of NAT by A59,FINSEQ_3:28;
A61: m+1 = len go;
  then
A62: len go-'1 = m by NAT_D:34;
  m >= 1 by A56,XREAL_1:21;
  then
A63: LSeg(go,m) = LSeg(go/.m,Gik) by A60,A61,TOPREAL1:def 5;
A64: {Gik} c= LSeg(go,m) /\ L~<*Gik,Gi1k,Gij*>
  proof
    let x be set;
    assume x in {Gik};
    then
A65: x = Gik by TARSKI:def 1;
    Gik in LSeg(Gik,Gi1k) by RLTOPSP1:69;
    then Gik in LSeg(Gik,Gi1k) \/ LSeg(Gi1k,Gij) by XBOOLE_0:def 3;
    then
A66: Gik in L~<*Gik,Gi1k,Gij*> by SPRECT_1:10;
    Gik in LSeg(go,m) by A63,RLTOPSP1:69;
    hence thesis by A65,A66,XBOOLE_0:def 4;
  end;
  LSeg(go,m) c= L~go by TOPREAL3:26;
  then LSeg(go,m) c= L~US by A57,XBOOLE_1:1;
  then LSeg(go,m) /\ L~<*Gik,Gi1k,Gij*> c= {Gik} by A7,A13,XBOOLE_1:26;
  then
A67: LSeg(go,m) /\ L~<*Gik,Gi1k,Gij*> = {Gik} by A64,XBOOLE_0:def 10;
A68: go/.1 = US/.1 by A45,SPRECT_3:39
    .= Wmin by JORDAN1F:5;
A69: LS.1 = LS/.1 by A27,PARTFUN1:def 8
    .= Emax by JORDAN1F:6;
A70: L~go /\ L~do c= {go/.1}
  proof
    let x be set;
    assume
A71: x in L~go /\ L~do;
    then
A72: x in L~do by XBOOLE_0:def 4;
A73: now
      assume x = Emax;
      then
A74:  Emax = Gij by A30,A69,A72,JORDAN1E:11;
      G*(len G,j)`1 = Ebo by A4,A10,A24,JORDAN1A:92;
      then Emax`1 <> Ebo by A2,A3,A23,A15,A74,JORDAN1G:7;
      hence contradiction by EUCLID:56;
    end;
    x in L~go by A71,XBOOLE_0:def 4;
    then x in L~US /\ L~LS by A57,A36,A72,XBOOLE_0:def 4;
    then x in {Wmin,Emax} by JORDAN1E:20;
    then x = Wmin or x = Emax by TARSKI:def 2;
    hence thesis by A68,A73,TARSKI:def 1;
  end;
  set W2 = go/.2;
A75: 2 in dom go by A56,FINSEQ_3:27;
  go = mid(US,1,Gik..US) by A47,JORDAN1G:57
    .= US|(Gik..US) by A47,FINSEQ_4:31,FINSEQ_6:122;
  then
A76: W2 = US/.2 by A75,FINSEQ_4:85;
A77: rng go c= L~go by A56,SPPOL_2:18;
A78: go/.1 = LS/.len LS by A68,JORDAN1F:8
    .= do/.len do by A30,JORDAN1J:35;
  {go/.1} c= L~go /\ L~do
  proof
    let x be set;
    assume x in {go/.1};
    then
A79: x = go/.1 by TARSKI:def 1;
    then
A80: x in rng go by FINSEQ_6:46;
    x in rng do by A78,A79,REVROT_1:3;
    hence thesis by A77,A55,A80,XBOOLE_0:def 4;
  end;
  then
A81: L~go /\ L~do = {go/.1} by A70,XBOOLE_0:def 10;
  now
    per cases;
    suppose
      Gij`1 <> Gik`1 & Gij`2 <> Gik`2;
      then pion is being_S-Seq by A21,TOPREAL3:42;
      then consider pion1 be FinSequence of TOP-REAL 2 such that
A82:  pion1 is_sequence_on G and
A83:  pion1 is being_S-Seq and
A84:  L~pion = L~pion1 and
A85:  pion/.1 = pion1/.1 and
A86:  pion/.len pion = pion1/.len pion1 and
A87:  len pion <= len pion1 by A44,GOBOARD3:2;
      reconsider pion1 as being_S-Seq FinSequence of TOP-REAL 2 by A83;
A88:  (go^'pion1)/.len (go^'pion1) = pion/.len pion by A86,GRAPH_2:58
        .= pion/.3 by FINSEQ_1:62
        .= do/.1 by A49,FINSEQ_4:27;
A89:  go/.len go = pion1/.1 by A60,A85,FINSEQ_4:27;
A90:  L~go /\ L~pion1 c= {pion1/.1}
      proof
        let x be set;
        assume
A91:    x in L~go /\ L~pion1;
        then
A92:    x in L~pion1 by XBOOLE_0:def 4;
        x in L~go by A91,XBOOLE_0:def 4;
        hence thesis by A7,A13,A60,A57,A84,A89,A92,XBOOLE_0:def 4;
      end;
      len pion1 >= 2+1 by A87,FINSEQ_1:62;
      then
A93:  len pion1 > 1+1 by NAT_1:13;
      then
A94:  rng pion1 c= L~pion1 by SPPOL_2:18;
      {pion1/.1} c= L~go /\ L~pion1
      proof
        let x be set;
        assume x in {pion1/.1};
        then
A95:    x = pion1/.1 by TARSKI:def 1;
        then
A96:    x in rng pion1 by FINSEQ_6:46;
        x in rng go by A89,A95,REVROT_1:3;
        hence thesis by A77,A94,A96,XBOOLE_0:def 4;
      end;
      then
A97:  L~go /\ L~pion1 = {pion1/.1} by A90,XBOOLE_0:def 10;
      then
A98:  (go^'pion1) is s.n.c. by A89,JORDAN1J:54;
A99:  pion/.len pion = pion/.3 by FINSEQ_1:62
        .= do/.1 by A49,FINSEQ_4:27;
A100: {pion1/.len pion1} c= L~do /\ L~pion1
      proof
        let x be set;
        assume x in {pion1/.len pion1};
        then
A101:   x = pion1/.len pion1 by TARSKI:def 1;
        then
A102:   x in rng pion1 by REVROT_1:3;
        x in rng do by A86,A99,A101,FINSEQ_6:46;
        hence thesis by A55,A94,A102,XBOOLE_0:def 4;
      end;
      L~do /\ L~pion1 c= {pion1/.len pion1}
      proof
        let x be set;
        assume
A103:   x in L~do /\ L~pion1;
        then
A104:   x in L~pion1 by XBOOLE_0:def 4;
        x in L~do by A103,XBOOLE_0:def 4;
        hence thesis by A8,A13,A49,A36,A84,A86,A99,A104,XBOOLE_0:def 4;
      end;
      then
A105: L~do /\ L~pion1 = {pion1/.len pion1} by A100,XBOOLE_0:def 10;
A106: L~(go^'pion1) /\ L~do = (L~go \/ L~pion1) /\ L~do by A89,TOPREAL8:35
        .= {go/.1} \/ {do/.1} by A81,A86,A99,A105,XBOOLE_1:23
        .= {(go^'pion1)/.1} \/ {do/.1} by GRAPH_2:57
        .= {(go^'pion1)/.1,do/.1} by ENUMSET1:41;
A107: UA is_an_arc_of W-min C,E-max C by JORDAN6:def 8;
      then
A108: UA is connected by JORDAN6:11;
      set godo = go^'pion1^'do;
A109: do/.len do = (go^'pion1)/.1 by A78,GRAPH_2:57;
A110: go^'pion1 is_sequence_on G by A48,A82,A89,TOPREAL8:12;
      then
A111: godo is_sequence_on G by A33,A88,TOPREAL8:12;
A112: len pion1-1 >= 1 by A93,XREAL_1:21;
      then
A113: len pion1-'1 = len pion1-1 by XREAL_0:def 2;
A114: {Gij} c= LSeg(pion1,len pion1-'1) /\ LSeg(do,1)
      proof
        let x be set;
        assume x in {Gij};
        then
A115:   x = Gij by TARSKI:def 1;
        pion1/.(len pion1-'1+1) = pion/.3 by A86,A113,FINSEQ_1:62
          .= Gij by FINSEQ_4:27;
        then
A116:   Gij in LSeg(pion1,len pion1-'1) by A112,A113,TOPREAL1:27;
        Gij in LSeg(do,1) by A50,RLTOPSP1:69;
        hence thesis by A115,A116,XBOOLE_0:def 4;
      end;
      LSeg(pion1,len pion1-'1) c= L~pion by A84,TOPREAL3:26;
      then LSeg(pion1,len pion1-'1) /\ LSeg(do,1) c= {Gij} by A54,XBOOLE_1:27;
      then
A117: LSeg(pion1,len pion1-'1) /\ LSeg(do,1) = {Gij} by A114,XBOOLE_0:def 10;
      len pion1-1+1 <= len pion1;
      then
A118: len pion1-'1 < len pion1 by A113,NAT_1:13;
      len pion1 >= 2+1 by A87,FINSEQ_1:62;
      then
A119: len pion1-2 >= 0 by XREAL_1:21;
      then len pion1-'2+1 = len pion1-2+1 by XREAL_0:def 2
        .= len pion1-'1 by A112,XREAL_0:def 2;
      then
A120: LSeg(go^'pion1,len go+(len pion1-'2)) /\ LSeg(do,1) = {(go^'pion1)
      /.len (go^'pion1)} by A49,A89,A88,A118,A117,TOPREAL8:31;
      rng go /\ rng pion1 c= {pion1/.1} by A77,A94,A97,XBOOLE_1:27;
      then
A121: go^'pion1 is one-to-one by JORDAN1J:55;
      len (go^'pion1)+1-1 = len go+len pion1-1 by GRAPH_2:13;
      then len (go^'pion1)-1 = len go + (len pion1-2)
        .= len go + (len pion1-'2) by A119,XREAL_0:def 2;
      then
A122: len (go^'pion1)-'1 = len go + (len pion1-'2) by XREAL_0:def 2;
A123: L~Cage(C,n) = L~US \/ L~LS by JORDAN1E:17;
      then
A124: L~US c= L~Cage(C,n) by XBOOLE_1:7;
      then
A125: L~go c=L~Cage(C,n) by A57,XBOOLE_1:1;
A126: {Gik} c= LSeg(go,m) /\ LSeg(pion1,1)
      proof
        let x be set;
        assume x in {Gik};
        then
A127:   x = Gik by TARSKI:def 1;
A128:   Gik in LSeg(go,m) by A63,RLTOPSP1:69;
        Gik in LSeg(pion1,1) by A60,A89,A93,TOPREAL1:27;
        hence thesis by A127,A128,XBOOLE_0:def 4;
      end;
      LSeg(pion1,1) c= L~pion by A84,TOPREAL3:26;
      then LSeg(go,len go-'1) /\ LSeg(pion1,1) c={Gik} by A62,A67,XBOOLE_1:27;
      then LSeg(go,len go-'1) /\ LSeg(pion1,1) = { go/.len go } by A60,A62,A126
,XBOOLE_0:def 10;
      then
A129: go^'pion1 is unfolded by A89,TOPREAL8:34;
      len (go^'pion1) >= len go by TOPREAL8:7;
      then
A130: len (go^'pion1) >= 1+1 by A56,XXREAL_0:2;
      then
A131: len (go^'pion1) > 1+0 by NAT_1:13;
A132: now
        assume
A133:   Gik..US <= 1;
        Gik..US >= 1 by A47,FINSEQ_4:31;
        then Gik..US = 1 by A133,XXREAL_0:1;
        then Gik = US/.1 by A47,FINSEQ_5:41;
        hence contradiction by A42,A46,JORDAN1F:5;
      end;
A134: US is_sequence_on G by JORDAN1G:4;
A135: Wmin`1 = Wbo by EUCLID:56;
      set ff = Rotate(Cage(C,n),Wmin);
A136: 1+1 <= len Cage(C,n) by GOBOARD7:36,XXREAL_0:2;
A137: len godo >= len (go^'pion1) by TOPREAL8:7;
      then
A138: 1+1 <= len godo by A130,XXREAL_0:2;
      (go^'pion1) is non trivial by A130,REALSET1:13;
      then reconsider
      godo as non constant standard special_circular_sequence by A138,A88,A111
,A129,A122,A120,A98,A121,A106,A109,JORDAN8:7,8,TOPREAL8:11,33,34;
A139: L~godo = L~(go^'pion1) \/ L~do by A88,TOPREAL8:35
        .= L~go \/ L~pion1 \/ L~do by A89,TOPREAL8:35;
A140: right_cell(godo,1,G)\L~godo c= RightComp godo by A138,A111,JORDAN9:29;
      2 in dom godo by A138,FINSEQ_3:27;
      then
A141: godo/.2 in rng godo by PARTFUN2:4;
A142: W-min C in UA by A107,TOPREAL1:4;
      Wmin in rng Cage(C,n) by SPRECT_2:47;
      then
A143: ff/.1 = Wmin by FINSEQ_6:98;
A144: L~ff = L~Cage(C,n) by REVROT_1:33;
      then (W-max L~ff)..ff > 1 by A143,SPRECT_5:23;
      then (N-min L~ff)..ff > 1 by A143,A144,SPRECT_5:24,XXREAL_0:2;
      then (N-max L~ff)..ff > 1 by A143,A144,SPRECT_5:25,XXREAL_0:2;
      then
A145: Emax..ff > 1 by A143,A144,SPRECT_5:26,XXREAL_0:2;
A146: Cage(C,n) is_sequence_on G by JORDAN9:def 1;
      then
A147: ff is_sequence_on G by REVROT_1:34;
A148: Gi1k`1 = G*(i1,1)`1 by A1,A6,A11,A16,GOBOARD5:3
        .= Gij`1 by A1,A4,A11,A10,GOBOARD5:3;
      then
A149: W-bound pio = Gij`1 by SPRECT_1:62;
A150: L~LS c= L~Cage(C,n) by A123,XBOOLE_1:7;
      then
A151: L~do c=L~Cage(C,n) by A36,XBOOLE_1:1;
A152: W-min C in C by SPRECT_1:15;
A153: now
        assume W-min C in L~godo;
        then
A154:   W-min C in L~go \/ L~pion1 or W-min C in L~do by A139,XBOOLE_0:def 3;
        per cases by A154,XBOOLE_0:def 3;
        suppose
          W-min C in L~go;
          then C meets L~Cage(C,n) by A125,A152,XBOOLE_0:3;
          hence contradiction by JORDAN10:5;
        end;
        suppose
          W-min C in L~pion1;
          hence contradiction by A9,A13,A84,A142,XBOOLE_0:3;
        end;
        suppose
          W-min C in L~do;
          then C meets L~Cage(C,n) by A151,A152,XBOOLE_0:3;
          hence contradiction by JORDAN10:5;
        end;
      end;
A155: len US >= 2 by A41,XXREAL_0:2;
A156: L~go \/ L~do is compact by COMPTS_1:19;
      1+1 <= len Rotate(Cage(C,n),Wmin) by GOBOARD7:36,XXREAL_0:2;
      then right_cell(Rotate(Cage(C,n),Wmin),1) = right_cell(ff,1,GoB ff) by
JORDAN1H:29
        .= right_cell(ff,1,GoB Cage(C,n)) by REVROT_1:28
        .= right_cell(ff,1,G) by JORDAN1H:52
        .= right_cell(ff-:Emax,1,G) by A145,A147,JORDAN1J:53
        .= right_cell(US,1,G) by JORDAN1E:def 1
        .= right_cell(R_Cut(US,Gik),1,G) by A47,A134,A132,JORDAN1J:52
        .= right_cell(go^'pion1,1,G) by A58,A110,JORDAN1J:51
        .= right_cell(godo,1,G) by A131,A111,JORDAN1J:51;
      then W-min C in right_cell(godo,1,G) by JORDAN1I:8;
      then
A157: W-min C in right_cell(godo,1,G)\L~godo by A153,XBOOLE_0:def 5;
A158: rng godo c= L~godo by A130,A137,SPPOL_2:18,XXREAL_0:2;
A159: godo/.1 = (go^'pion1)/.1 by GRAPH_2:57
        .= Wmin by A68,GRAPH_2:57;
A160: Gi1k`1 <= Gik`1 by A1,A2,A3,A6,A16,JORDAN1A:39;
      then
A161: W-bound poz = Gi1k`1 by SPRECT_1:62;
      W-bound (poz \/ pio) = min(W-bound poz, W-bound pio) by SPRECT_1:54
        .= Gij`1 by A148,A161,A149;
      then
A162: W-bound L~pion1 = Gij`1 by A84,TOPREAL3:23;
A163: UA c= C by JORDAN6:76;
      Gij`1 >= Wbo by A30,A150,PSCOMP_1:71;
      then
A164: Gij`1 > Wbo by A38,XXREAL_0:1;
A165: E-max C in UA by A107,TOPREAL1:4;
      Wmin in rng go by A68,FINSEQ_6:46;
      then Wmin in L~go \/ L~do by A77,XBOOLE_0:def 3;
      then
A166: W-min (L~go \/ L~do) = Wmin by A125,A151,A156,JORDAN1J:21,XBOOLE_1:8;
      (W-min (L~go \/ L~do))`1 = W-bound (L~go \/ L~do) by EUCLID:56;
      then W-min (L~go\/L~do\/L~pion1) = W-min (L~go \/ L~do) by A162,A156,A166
,A135,A164,JORDAN1J:33;
      then
A167: W-min L~godo = Wmin by A139,A166,XBOOLE_1:4;
      godo/.2 = (go^'pion1)/.2 by A130,GRAPH_2:61
        .= US/.2 by A56,A76,GRAPH_2:61
        .= (US^'LS)/.2 by A155,GRAPH_2:61
        .= Rotate(Cage(C,n),Wmin)/.2 by JORDAN1E:15;
      then godo/.2 in W-most L~Cage(C,n) by JORDAN1I:27;
      then (godo/.2)`1 = (W-min L~godo)`1 by A167,PSCOMP_1:88
        .= W-bound L~godo by EUCLID:56;
      then godo/.2 in W-most L~godo by A158,A141,SPRECT_2:16;
      then Rotate(godo,W-min L~godo)/.2 in W-most L~godo by A159,A167,
FINSEQ_6:95;
      then reconsider godo as clockwise_oriented non constant standard
      special_circular_sequence by JORDAN1I:27;
      len US in dom US by FINSEQ_5:6;
      then
A168: US.len US = US/.len US by PARTFUN1:def 8
        .= Emax by JORDAN1F:7;
A169: east_halfline E-max C misses L~go
      proof
        assume east_halfline E-max C meets L~go;
        then consider p be set such that
A170:   p in east_halfline E-max C and
A171:   p in L~go by XBOOLE_0:3;
        reconsider p as Point of TOP-REAL 2 by A170;
        p in L~US by A57,A171;
        then p in east_halfline E-max C /\ L~Cage(C,n) by A124,A170,
XBOOLE_0:def 4;
        then
A172:   p`1 = Ebo by JORDAN1A:104,PSCOMP_1:111;
        then
A173:   p = Emax by A57,A171,JORDAN1J:46;
        then Emax = Gik by A45,A168,A171,JORDAN1J:43;
        then Gik`1 = G*(len G,k)`1 by A6,A16,A24,A172,A173,JORDAN1A:92;
        hence contradiction by A3,A19,A22,JORDAN1G:7;
      end;
      now
        assume east_halfline E-max C meets L~godo;
        then
A174:   east_halfline E-max C meets (L~go \/ L~pion1) or east_halfline
        E-max C meets L~do by A139,XBOOLE_1:70;
        per cases by A174,XBOOLE_1:70;
        suppose
          east_halfline E-max C meets L~go;
          hence contradiction by A169;
        end;
        suppose
          east_halfline E-max C meets L~pion1;
          then consider p be set such that
A175:     p in east_halfline E-max C and
A176:     p in L~pion1 by XBOOLE_0:3;
          reconsider p as Point of TOP-REAL 2 by A175;
A177:     p`2 = (E-max C)`2 by A175,TOPREAL1:def 13;
A178:     now
            per cases by A13,A84,A176,XBOOLE_0:def 3;
            suppose
              p in poz;
              hence p`1 <= Gik`1 by A160,TOPREAL1:9;
            end;
            suppose
              p in pio;
              hence p`1 <= Gik`1 by A148,A160,GOBOARD7:5;
            end;
          end;
          i2+1 <= len G by A3,NAT_1:13;
          then i2+1-1 <= len G-1 by XREAL_1:11;
          then
A179:     i2 <= len G-'1 by XREAL_0:def 2;
          len G-'1 <= len G by NAT_D:35;
          then Gik`1 <= G*(len G-'1,1)`1 by A6,A18,A16,A24,A14,A179,JORDAN1A:39
;
          then p`1 <= G*(len G-'1,1)`1 by A178,XXREAL_0:2;
          then p`1 <= E-bound C by A14,JORDAN8:15;
          then
A180:     p`1 <= (E-max C)`1 by EUCLID:56;
          p`1 >= (E-max C)`1 by A175,TOPREAL1:def 13;
          then p`1 = (E-max C)`1 by A180,XXREAL_0:1;
          then p = E-max C by A177,TOPREAL3:11;
          hence contradiction by A9,A13,A84,A165,A176,XBOOLE_0:3;
        end;
        suppose
          east_halfline E-max C meets L~do;
          then consider p be set such that
A181:     p in east_halfline E-max C and
A182:     p in L~do by XBOOLE_0:3;
          reconsider p as Point of TOP-REAL 2 by A181;
A183:     p in LSeg(do,Index(p,do)) by A182,JORDAN3:42;
          consider t be Nat such that
A184:     t in dom LS and
A185:     LS.t = Gij by A32,FINSEQ_2:11;
          1 <= t by A184,FINSEQ_3:27;
          then
A186:     1 < t by A34,A185,XXREAL_0:1;
          t <= len LS by A184,FINSEQ_3:27;
          then Index(Gij,LS)+1 = t by A185,A186,JORDAN3:45;
          then
A187:     len L_Cut(LS,Gij) = len LS-Index(Gij,LS) by A30,A185,JORDAN3:61;
          Index(p,do) < len do by A182,JORDAN3:41;
          then Index(p,do) < len LS-'Index(Gij,LS) by A187,XREAL_0:def 2;
          then Index(p,do)+1 <= len LS-'Index(Gij,LS) by NAT_1:13;
          then
A188:     Index(p,do) <= len LS-'Index(Gij,LS)-1 by XREAL_1:21;
A189:     do = mid(LS,Gij..LS,len LS) by A32,JORDAN1J:37;
          p in L~LS by A36,A182;
          then p in east_halfline E-max C /\ L~Cage(C,n) by A150,A181,
XBOOLE_0:def 4;
          then
A190:     p`1 = Ebo by JORDAN1A:104,PSCOMP_1:111;
A191:     Index(Gij,LS)+1 = Gij..LS by A34,A32,JORDAN1J:56;
          0+Index(Gij,LS) < len LS by A30,JORDAN3:41;
          then len LS-Index(Gij,LS) > 0 by XREAL_1:22;
          then Index(p,do) <= len LS-Index(Gij,LS)-1 by A188,XREAL_0:def 2;
          then Index(p,do) <= len LS-Gij..LS by A191;
          then Index(p,do) <= len LS-'Gij..LS by XREAL_0:def 2;
          then
A192:     Index(p,do) < len LS-'(Gij..LS)+1 by NAT_1:13;
A193:     1<=Index(p,do) by A182,JORDAN3:41;
A194:     Gij..LS<=len LS by A32,FINSEQ_4:31;
          Gij..LS <> len LS by A31,A32,FINSEQ_4:29;
          then
A195:     Gij..LS < len LS by A194,XXREAL_0:1;
A196:     1+1 <= len LS by A25,XXREAL_0:2;
          then
A197:     2 in dom LS by FINSEQ_3:27;
          set tt = Index(p,do)+(Gij..LS)-'1;
          set RC = Rotate(Cage(C,n),Emax);
A198:     E-max C in right_cell(RC,1) by JORDAN1I:9;
A199:     GoB RC = GoB Cage(C,n) by REVROT_1:28
            .= G by JORDAN1H:52;
A200:     L~RC = L~Cage(C,n) by REVROT_1:33;
          consider jj2 be Element of NAT such that
A201:     1 <= jj2 and
A202:     jj2 <= width G and
A203:     Emax = G*(len G,jj2) by JORDAN1D:29;
A204:     len G >= 4 by JORDAN8:13;
          then len G >= 1 by XXREAL_0:2;
          then
A205:     [len G,jj2] in Indices G by A201,A202,MATRIX_1:37;
A206:     len RC = len Cage(C,n) by REVROT_1:14;
          LS = RC-:Wmin by JORDAN1G:26;
          then
A207:     LSeg(LS,1) = LSeg(RC,1) by A196,SPPOL_2:9;
A208:     Emax in rng Cage(C,n) by SPRECT_2:50;
          RC is_sequence_on G by A146,REVROT_1:34;
          then consider ii,jj be Element of NAT such that
A209:     [ii,jj+1] in Indices G and
A210:     [ii,jj] in Indices G and
A211:     RC/.1 = G*(ii,jj+1) and
A212:     RC/.(1+1) = G*(ii,jj) by A136,A200,A206,A208,FINSEQ_6:98,JORDAN1I:25;
A213:     jj+1+1 <> jj;
A214:     1 <= jj by A210,MATRIX_1:39;
          RC/.1 = E-max L~RC by A200,A208,FINSEQ_6:98;
          then
A215:     ii = len G by A200,A209,A211,A203,A205,GOBOARD1:21;
          then ii-1 >= 4-1 by A204,XREAL_1:11;
          then
A216:     ii-1 >= 1 by XXREAL_0:2;
          then
A217:     1 <= ii-'1 by XREAL_0:def 2;
A218:     jj <= width G by A210,MATRIX_1:39;
          then
A219:     G*(len G,jj)`1 = Ebo by A24,A214,JORDAN1A:92;
A220:     jj+1 <= width G by A209,MATRIX_1:39;
          ii+1 <> ii;
          then
A221:     right_cell(RC,1) = cell(G,ii-'1,jj) by A136,A206,A199,A209,A210,A211
,A212,A213,GOBOARD5:def 6;
A222:     ii <= len G by A210,MATRIX_1:39;
A223:     1 <= ii by A210,MATRIX_1:39;
A224:     ii <= len G by A209,MATRIX_1:39;
A225:     1 <= jj+1 by A209,MATRIX_1:39;
          then
A226:     Ebo = G*(len G,jj+1)`1 by A24,A220,JORDAN1A:92;
A227:     1 <= ii by A209,MATRIX_1:39;
          then
A228:     ii-'1+1 = ii by XREAL_1:237;
          then
A229:     ii-'1 < len G by A224,NAT_1:13;
          then
A230:     G*(ii-'1,jj+1)`2 = G*(1,jj+1)`2 by A225,A220,A217,GOBOARD5:2
            .= G*(ii,jj+1)`2 by A227,A224,A225,A220,GOBOARD5:2;
A231:     (E-max C)`2 = p`2 by A181,TOPREAL1:def 13;
          then
A232:     p`2 <= G*(ii-'1,jj+1)`2 by A198,A224,A220,A214,A221,A228,A216,
JORDAN9:19;
A233:     G*(ii-'1,jj)`2 = G*(1,jj)`2 by A214,A218,A217,A229,GOBOARD5:2
            .= G*(ii,jj)`2 by A223,A222,A214,A218,GOBOARD5:2;
          G*(ii-'1,jj)`2 <= p`2 by A231,A198,A224,A220,A214,A221,A228,A216,
JORDAN9:19;
          then p in LSeg(RC/.1,RC/.(1+1)) by A190,A211,A212,A215,A232,A233,A230
,A219,A226,GOBOARD7:8;
          then
A234:     p in LSeg(LS,1) by A136,A207,A206,TOPREAL1:def 5;
          1<=Gij..LS by A32,FINSEQ_4:31;
          then
A235:     LSeg(mid(LS,Gij..LS,len LS),Index(p,do)) = LSeg(LS,Index(p,do)
          +(Gij..LS)-'1) by A195,A193,A192,JORDAN4:31;
          1<=Index(Gij,LS) by A30,JORDAN3:41;
          then
A236:     1+1 <= Gij..LS by A191,XREAL_1:9;
          then Index(p,do)+Gij..LS >= 1+1+1 by A193,XREAL_1:9;
          then Index(p,do)+Gij..LS-1 >= 1+1+1-1 by XREAL_1:11;
          then
A237:     tt >= 1+1 by XREAL_0:def 2;
          now
            per cases by A237,XXREAL_0:1;
            suppose
              tt > 1+1;
              then LSeg(LS,1) misses LSeg(LS,tt) by TOPREAL1:def 9;
              hence contradiction by A234,A183,A189,A235,XBOOLE_0:3;
            end;
            suppose
A238:         tt = 1+1;
              then 1+1 = Index(p,do)+(Gij..LS)-1 by XREAL_0:def 2;
              then 1+1+1 = Index(p,do)+(Gij..LS);
              then
A239:         Gij..LS = 2 by A193,A236,JORDAN1E:10;
              LSeg(LS,1) /\ LSeg(LS,tt) = {LS/.2} by A25,A238,TOPREAL1:def 8;
              then p in {LS/.2} by A234,A183,A189,A235,XBOOLE_0:def 4;
              then
A240:         p = LS/.2 by TARSKI:def 1;
              then
A241:         p in rng LS by A197,PARTFUN2:4;
              p..LS = 2 by A197,A240,FINSEQ_5:44;
              then p = Gij by A32,A239,A241,FINSEQ_5:10;
              then Gij`1 = Ebo by A240,JORDAN1G:40;
              then Gij`1 = G*(len G,j)`1 by A4,A10,A24,JORDAN1A:92;
              hence contradiction by A2,A3,A23,A15,JORDAN1G:7;
            end;
          end;
          hence contradiction;
        end;
      end;
      then east_halfline E-max C c= (L~godo)` by SUBSET_1:43;
      then consider W be Subset of TOP-REAL 2 such that
A242: W is_a_component_of (L~godo)` and
A243: east_halfline E-max C c= W by GOBOARD9:5;
      W is not Bounded by A243,JORDAN2C:16,129;
      then W is_outside_component_of L~godo by A242,JORDAN2C:def 4;
      then W c= UBD L~godo by JORDAN2C:27;
      then
A244: east_halfline E-max C c= UBD L~godo by A243,XBOOLE_1:1;
      E-max C in east_halfline E-max C by TOPREAL1:45;
      then E-max C in UBD L~godo by A244;
      then E-max C in LeftComp godo by GOBRD14:46;
      then UA meets L~godo by A108,A142,A165,A140,A157,JORDAN1J:36;
      then
A245: UA meets (L~go \/ L~pion1) or UA meets L~do by A139,XBOOLE_1:70;
      now
        per cases by A245,XBOOLE_1:70;
        suppose
          UA meets L~go;
          then UA meets L~Cage(C,n) by A57,A124,XBOOLE_1:1,63;
          hence contradiction by A163,JORDAN10:5,XBOOLE_1:63;
        end;
        suppose
          UA meets L~pion1;
          hence contradiction by A9,A13,A84;
        end;
        suppose
          UA meets L~do;
          then UA meets L~Cage(C,n) by A36,A150,XBOOLE_1:1,63;
          hence contradiction by A163,JORDAN10:5,XBOOLE_1:63;
        end;
      end;
      hence contradiction;
    end;
    suppose
      Gij`1 = Gik`1;
      then
A246: i1 = i2 by A23,A19,JORDAN1G:7;
      then poz = {Gi1k} by RLTOPSP1:71;
      then poz c= pio by A40,ZFMISC_1:37;
      then pio \/ poz = pio by XBOOLE_1:12;
      hence contradiction by A1,A3,A4,A5,A6,A7,A8,A9,A246,JORDAN1J:59;
    end;
    suppose
      Gij`2 = Gik`2;
      then
A247: j = k by A23,A19,JORDAN1G:6;
      then pio = {Gi1k} by RLTOPSP1:71;
      then pio c= poz by A39,ZFMISC_1:37;
      then pio \/ poz = poz by XBOOLE_1:12;
      hence contradiction by A1,A2,A3,A4,A6,A7,A8,A9,A247,Th31;
    end;
  end;
  hence contradiction;
end;

theorem Th47:
  for C be Simple_closed_curve for i1,i2,j,k be Element of NAT st
1 < i1 & i1 <= i2 & i2 < len Gauge(C,n) & 1 <= j & j <= k & k <= width Gauge(C,
n) & (LSeg(Gauge(C,n)*(i1,j),Gauge(C,n)*(i1,k)) \/ LSeg(Gauge(C,n)*(i1,k),Gauge
(C,n)*(i2,k))) /\ L~Upper_Seq(C,n) = {Gauge(C,n)*(i2,k)} & (LSeg(Gauge(C,n)*(i1
  ,j),Gauge(C,n)*(i1,k)) \/ LSeg(Gauge(C,n)*(i1,k),Gauge(C,n)*(i2,k))) /\ L~
Lower_Seq(C,n) = {Gauge(C,n)*(i1,j)} holds (LSeg(Gauge(C,n)*(i1,j),Gauge(C,n)*(
  i1,k)) \/ LSeg(Gauge(C,n)*(i1,k),Gauge(C,n)*(i2,k))) meets Lower_Arc C
proof
  let C be Simple_closed_curve;
  let i1,i2,j,k be Element of NAT;
  set G = Gauge(C,n);
  set pio = LSeg(G*(i1,j),G*(i1,k));
  set poz = LSeg(G*(i1,k),G*(i2,k));
  set US = Upper_Seq(C,n);
  set LS = Lower_Seq(C,n);
  assume that
A1: 1 < i1 and
A2: i1 <= i2 and
A3: i2 < len G and
A4: 1 <= j and
A5: j <= k and
A6: k <= width G and
A7: (pio \/ poz) /\ L~US = {G*(i2,k)} and
A8: (pio \/ poz) /\ L~LS = {G*(i1,j)} and
A9: (pio \/ poz) misses Lower_Arc C;
  set Gij = G*(i1,j);
A10: j <= width G by A5,A6,XXREAL_0:2;
A11: i1 < len G by A2,A3,XXREAL_0:2;
  then
A12: [i1,j] in Indices G by A1,A4,A10,MATRIX_1:37;
  set Gi1k = G*(i1,k);
  set Gik = G*(i2,k);
A13: L~<*Gik,Gi1k,Gij*> = poz \/ pio by TOPREAL3:23;
  len G >= 4 by JORDAN8:13;
  then
A14: len G >= 1 by XXREAL_0:2;
  then
A15: [len G,j] in Indices G by A4,A10,MATRIX_1:37;
A16: 1 <= k by A4,A5,XXREAL_0:2;
  then
A17: [1,k] in Indices G by A6,A14,MATRIX_1:37;
A18: 1 < i2 by A1,A2,XXREAL_0:2;
  then
A19: [i2,k] in Indices G by A3,A6,A16,MATRIX_1:37;
A20: Gi1k`2 = G*(1,k)`2 by A1,A6,A11,A16,GOBOARD5:2
    .= Gik`2 by A3,A6,A18,A16,GOBOARD5:2;
  Gi1k`1 = G*(i1,1)`1 by A1,A6,A11,A16,GOBOARD5:3
    .= Gij`1 by A1,A4,A11,A10,GOBOARD5:3;
  then
A21: Gi1k = |[Gij`1,Gik`2]| by A20,EUCLID:57;
A22: [len G,k] in Indices G by A6,A16,A14,MATRIX_1:37;
A23: [i1,j] in Indices G by A1,A4,A11,A10,MATRIX_1:37;
  set Wbo = W-bound L~Cage(C,n);
  set Wmin = W-min L~Cage(C,n);
A24: len G = width G by JORDAN8:def 1;
  set Ebo = E-bound L~Cage(C,n);
  set Emax = E-max L~Cage(C,n);
A25: len LS >= 1+2 by JORDAN1E:19;
  then
A26: len LS >= 1 by XXREAL_0:2;
  then
A27: 1 in dom LS by FINSEQ_3:27;
  then
A28: LS.1 = LS/.1 by PARTFUN1:def 8
    .= Emax by JORDAN1F:6;
  len LS in dom LS by A26,FINSEQ_3:27;
  then
A29: LS.len LS = LS/.len LS by PARTFUN1:def 8
    .= Wmin by JORDAN1F:8;
  set do = L_Cut(LS,Gij);
  Gij in {Gij} by TARSKI:def 1;
  then
A30: Gij in L~LS by A8,XBOOLE_0:def 4;
  Wmin`1 = Wbo by EUCLID:56
    .= G*(1,k)`1 by A6,A16,A24,JORDAN1A:94;
  then
A31: Gij <> LS.len LS by A1,A17,A29,A12,JORDAN1G:7;
  then reconsider do as being_S-Seq FinSequence of TOP-REAL 2 by A30,JORDAN3:69
;
A32: Gij in rng LS by A1,A4,A11,A30,A10,JORDAN1G:5,JORDAN1J:40;
  then
A33: do is_sequence_on G by JORDAN1G:5,JORDAN1J:39;
  Emax`1 = Ebo by EUCLID:56
    .= G*(len G,k)`1 by A6,A16,A24,JORDAN1A:92;
  then
A34: Gij <> LS.1 by A2,A3,A12,A22,A28,JORDAN1G:7;
A35: len do >= 1+1 by TOPREAL1:def 10;
  then reconsider
  do as non constant s.c.c. (being_S-Seq FinSequence of TOP-REAL 2)
  by A33,JGRAPH_1:16,JORDAN8:8;
A36: L~do c= L~LS by A30,JORDAN3:77;
A37: [1,j] in Indices G by A4,A10,A14,MATRIX_1:37;
A38: now
    assume Gij`1 = Wbo;
    then G*(1,j)`1 = G*(i1,j)`1 by A4,A10,A24,JORDAN1A:94;
    hence contradiction by A1,A23,A37,JORDAN1G:7;
  end;
  set pion = <*Gik,Gi1k,Gij*>;
A39: Gi1k in poz by RLTOPSP1:69;
  set LA = Lower_Arc C;
A40: Gi1k in pio by RLTOPSP1:69;
  set go = R_Cut(US,Gik);
A41: len US >= 3 by JORDAN1E:19;
  then len US >= 1 by XXREAL_0:2;
  then 1 in dom US by FINSEQ_3:27;
  then
A42: US.1 = US/.1 by PARTFUN1:def 8
    .= Wmin by JORDAN1F:5;
A43: [i1,k] in Indices G by A1,A6,A11,A16,MATRIX_1:37;
A44: now
    let n be Element of NAT;
    assume n in dom pion;
    then n in {1,2,3} by FINSEQ_3:1,30;
    then n = 1 or n = 2 or n = 3 by ENUMSET1:def 1;
    hence
    ex i,j be Element of NAT st [i,j] in Indices G & pion/.n = G*(i,j) by A23
,A19,A43,FINSEQ_4:27;
  end;
  Gik in {Gik} by TARSKI:def 1;
  then
A45: Gik in L~US by A7,XBOOLE_0:def 4;
  Wmin`1 = Wbo by EUCLID:56
    .= G*(1,k)`1 by A6,A16,A24,JORDAN1A:94;
  then
A46: Gik <> US.1 by A1,A2,A19,A42,A17,JORDAN1G:7;
  then reconsider go as being_S-Seq FinSequence of TOP-REAL 2 by A45,JORDAN3:70
;
A47: Gik in rng US by A3,A6,A18,A45,A16,JORDAN1G:4,JORDAN1J:40;
  then
A48: go is_sequence_on G by JORDAN1G:4,JORDAN1J:38;
  len do >= 1 by A35,XXREAL_0:2;
  then 1 in dom do by FINSEQ_3:27;
  then
A49: do/.1 = do.1 by PARTFUN1:def 8
    .= Gij by A30,JORDAN3:58;
  then
A50: LSeg(do,1) = LSeg(Gij,do/.(1+1)) by A35,TOPREAL1:def 5;
A51: {Gij} c= LSeg(do,1) /\ L~<*Gik,Gi1k,Gij*>
  proof
    let x be set;
    assume x in {Gij};
    then
A52: x = Gij by TARSKI:def 1;
    Gij in LSeg(Gi1k,Gij) by RLTOPSP1:69;
    then Gij in LSeg(Gik,Gi1k) \/ LSeg(Gi1k,Gij) by XBOOLE_0:def 3;
    then
A53: Gij in L~<*Gik,Gi1k,Gij*> by SPRECT_1:10;
    Gij in LSeg(do,1) by A50,RLTOPSP1:69;
    hence thesis by A52,A53,XBOOLE_0:def 4;
  end;
  LSeg(do,1) c= L~do by TOPREAL3:26;
  then LSeg(do,1) c= L~LS by A36,XBOOLE_1:1;
  then LSeg(do,1) /\ L~<*Gik,Gi1k,Gij*> c= {Gij} by A8,A13,XBOOLE_1:26;
  then
A54: L~<*Gik,Gi1k,Gij*> /\ LSeg(do,1) = {Gij} by A51,XBOOLE_0:def 10;
A55: rng do c= L~do by A35,SPPOL_2:18;
A56: len go >= 1+1 by TOPREAL1:def 10;
  then reconsider
  go as non constant s.c.c. (being_S-Seq FinSequence of TOP-REAL 2)
  by A48,JGRAPH_1:16,JORDAN8:8;
A57: L~go c= L~US by A45,JORDAN3:76;
A58: len go > 1 by A56,NAT_1:13;
  then
A59: len go in dom go by FINSEQ_3:27;
  then
A60: go/.len go = go.len go by PARTFUN1:def 8
    .= Gik by A45,JORDAN3:59;
  reconsider m = len go - 1 as Element of NAT by A59,FINSEQ_3:28;
A61: m+1 = len go;
  then
A62: len go-'1 = m by NAT_D:34;
  m >= 1 by A56,XREAL_1:21;
  then
A63: LSeg(go,m) = LSeg(go/.m,Gik) by A60,A61,TOPREAL1:def 5;
A64: {Gik} c= LSeg(go,m) /\ L~<*Gik,Gi1k,Gij*>
  proof
    let x be set;
    assume x in {Gik};
    then
A65: x = Gik by TARSKI:def 1;
    Gik in LSeg(Gik,Gi1k) by RLTOPSP1:69;
    then Gik in LSeg(Gik,Gi1k) \/ LSeg(Gi1k,Gij) by XBOOLE_0:def 3;
    then
A66: Gik in L~<*Gik,Gi1k,Gij*> by SPRECT_1:10;
    Gik in LSeg(go,m) by A63,RLTOPSP1:69;
    hence thesis by A65,A66,XBOOLE_0:def 4;
  end;
  LSeg(go,m) c= L~go by TOPREAL3:26;
  then LSeg(go,m) c= L~US by A57,XBOOLE_1:1;
  then LSeg(go,m) /\ L~<*Gik,Gi1k,Gij*> c= {Gik} by A7,A13,XBOOLE_1:26;
  then
A67: LSeg(go,m) /\ L~<*Gik,Gi1k,Gij*> = {Gik} by A64,XBOOLE_0:def 10;
A68: go/.1 = US/.1 by A45,SPRECT_3:39
    .= Wmin by JORDAN1F:5;
  then
A69: Wmin in rng go by FINSEQ_6:46;
A70: LS.1 = LS/.1 by A27,PARTFUN1:def 8
    .= Emax by JORDAN1F:6;
A71: L~go /\ L~do c= {go/.1}
  proof
    let x be set;
    assume
A72: x in L~go /\ L~do;
    then
A73: x in L~do by XBOOLE_0:def 4;
A74: now
      assume x = Emax;
      then
A75:  Emax = Gij by A30,A70,A73,JORDAN1E:11;
      G*(len G,j)`1 = Ebo by A4,A10,A24,JORDAN1A:92;
      then Emax`1 <> Ebo by A2,A3,A23,A15,A75,JORDAN1G:7;
      hence contradiction by EUCLID:56;
    end;
    x in L~go by A72,XBOOLE_0:def 4;
    then x in L~US /\ L~LS by A57,A36,A73,XBOOLE_0:def 4;
    then x in {Wmin,Emax} by JORDAN1E:20;
    then x = Wmin or x = Emax by TARSKI:def 2;
    hence thesis by A68,A74,TARSKI:def 1;
  end;
  set W2 = go/.2;
A76: 2 in dom go by A56,FINSEQ_3:27;
  go = mid(US,1,Gik..US) by A47,JORDAN1G:57
    .= US|(Gik..US) by A47,FINSEQ_4:31,FINSEQ_6:122;
  then
A77: W2 = US/.2 by A76,FINSEQ_4:85;
A78: rng go c= L~go by A56,SPPOL_2:18;
A79: go/.1 = LS/.len LS by A68,JORDAN1F:8
    .= do/.len do by A30,JORDAN1J:35;
  {go/.1} c= L~go /\ L~do
  proof
    let x be set;
    assume x in {go/.1};
    then
A80: x = go/.1 by TARSKI:def 1;
    then
A81: x in rng go by FINSEQ_6:46;
    x in rng do by A79,A80,REVROT_1:3;
    hence thesis by A78,A55,A81,XBOOLE_0:def 4;
  end;
  then
A82: L~go /\ L~do = {go/.1} by A71,XBOOLE_0:def 10;
  now
    per cases;
    suppose
      Gij`1 <> Gik`1 & Gij`2 <> Gik`2;
      then pion is being_S-Seq by A21,TOPREAL3:42;
      then consider pion1 be FinSequence of TOP-REAL 2 such that
A83:  pion1 is_sequence_on G and
A84:  pion1 is being_S-Seq and
A85:  L~pion = L~pion1 and
A86:  pion/.1 = pion1/.1 and
A87:  pion/.len pion = pion1/.len pion1 and
A88:  len pion <= len pion1 by A44,GOBOARD3:2;
      reconsider pion1 as being_S-Seq FinSequence of TOP-REAL 2 by A84;
A89:  (go^'pion1)/.len (go^'pion1) = pion/.len pion by A87,GRAPH_2:58
        .= pion/.3 by FINSEQ_1:62
        .= do/.1 by A49,FINSEQ_4:27;
A90:  go/.len go = pion1/.1 by A60,A86,FINSEQ_4:27;
A91:  L~go /\ L~pion1 c= {pion1/.1}
      proof
        let x be set;
        assume
A92:    x in L~go /\ L~pion1;
        then
A93:    x in L~pion1 by XBOOLE_0:def 4;
        x in L~go by A92,XBOOLE_0:def 4;
        hence thesis by A7,A13,A60,A57,A85,A90,A93,XBOOLE_0:def 4;
      end;
      len pion1 >= 2+1 by A88,FINSEQ_1:62;
      then
A94:  len pion1 > 1+1 by NAT_1:13;
      then
A95:  rng pion1 c= L~pion1 by SPPOL_2:18;
      {pion1/.1} c= L~go /\ L~pion1
      proof
        let x be set;
        assume x in {pion1/.1};
        then
A96:    x = pion1/.1 by TARSKI:def 1;
        then
A97:    x in rng pion1 by FINSEQ_6:46;
        x in rng go by A90,A96,REVROT_1:3;
        hence thesis by A78,A95,A97,XBOOLE_0:def 4;
      end;
      then
A98:  L~go /\ L~pion1 = {pion1/.1} by A91,XBOOLE_0:def 10;
      then
A99:  (go^'pion1) is s.n.c. by A90,JORDAN1J:54;
A100: pion/.len pion = pion/.3 by FINSEQ_1:62
        .= do/.1 by A49,FINSEQ_4:27;
A101: {pion1/.len pion1} c= L~do /\ L~pion1
      proof
        let x be set;
        assume x in {pion1/.len pion1};
        then
A102:   x = pion1/.len pion1 by TARSKI:def 1;
        then
A103:   x in rng pion1 by REVROT_1:3;
        x in rng do by A87,A100,A102,FINSEQ_6:46;
        hence thesis by A55,A95,A103,XBOOLE_0:def 4;
      end;
      L~do /\ L~pion1 c= {pion1/.len pion1}
      proof
        let x be set;
        assume
A104:   x in L~do /\ L~pion1;
        then
A105:   x in L~pion1 by XBOOLE_0:def 4;
        x in L~do by A104,XBOOLE_0:def 4;
        hence thesis by A8,A13,A49,A36,A85,A87,A100,A105,XBOOLE_0:def 4;
      end;
      then
A106: L~do /\ L~pion1 = {pion1/.len pion1} by A101,XBOOLE_0:def 10;
A107: L~(go^'pion1) /\ L~do = (L~go \/ L~pion1) /\ L~do by A90,TOPREAL8:35
        .= {go/.1} \/ {do/.1} by A82,A87,A100,A106,XBOOLE_1:23
        .= {(go^'pion1)/.1} \/ {do/.1} by GRAPH_2:57
        .= {(go^'pion1)/.1,do/.1} by ENUMSET1:41;
A108: LA is_an_arc_of E-max C,W-min C by JORDAN6:def 9;
      then
A109: LA is connected by JORDAN6:11;
      set godo = go^'pion1^'do;
A110: do/.len do = (go^'pion1)/.1 by A79,GRAPH_2:57;
A111: go^'pion1 is_sequence_on G by A48,A83,A90,TOPREAL8:12;
      then
A112: godo is_sequence_on G by A33,A89,TOPREAL8:12;
A113: len pion1-1 >= 1 by A94,XREAL_1:21;
      then
A114: len pion1-'1 = len pion1-1 by XREAL_0:def 2;
A115: {Gij} c= LSeg(pion1,len pion1-'1) /\ LSeg(do,1)
      proof
        let x be set;
        assume x in {Gij};
        then
A116:   x = Gij by TARSKI:def 1;
        pion1/.(len pion1-'1+1) = pion/.3 by A87,A114,FINSEQ_1:62
          .= Gij by FINSEQ_4:27;
        then
A117:   Gij in LSeg(pion1,len pion1-'1) by A113,A114,TOPREAL1:27;
        Gij in LSeg(do,1) by A50,RLTOPSP1:69;
        hence thesis by A116,A117,XBOOLE_0:def 4;
      end;
      LSeg(pion1,len pion1-'1) c= L~pion by A85,TOPREAL3:26;
      then LSeg(pion1,len pion1-'1) /\ LSeg(do,1) c= {Gij} by A54,XBOOLE_1:27;
      then
A118: LSeg(pion1,len pion1-'1) /\ LSeg(do,1) = {Gij} by A115,XBOOLE_0:def 10;
      len pion1-1+1 <= len pion1;
      then
A119: len pion1-'1 < len pion1 by A114,NAT_1:13;
      len pion1 >= 2+1 by A88,FINSEQ_1:62;
      then
A120: len pion1-2 >= 0 by XREAL_1:21;
      then len pion1-'2+1 = len pion1-2+1 by XREAL_0:def 2
        .= len pion1-'1 by A113,XREAL_0:def 2;
      then
A121: LSeg(go^'pion1,len go+(len pion1-'2)) /\ LSeg(do,1) = {(go^'pion1)
      /.len (go^'pion1)} by A49,A90,A89,A119,A118,TOPREAL8:31;
      rng go /\ rng pion1 c= {pion1/.1} by A78,A95,A98,XBOOLE_1:27;
      then
A122: go^'pion1 is one-to-one by JORDAN1J:55;
      len (go^'pion1)+1-1 = len go+len pion1-1 by GRAPH_2:13;
      then len (go^'pion1)-1 = len go + (len pion1-2)
        .= len go + (len pion1-'2) by A120,XREAL_0:def 2;
      then
A123: len (go^'pion1)-'1 = len go + (len pion1-'2) by XREAL_0:def 2;
A124: L~Cage(C,n) = L~US \/ L~LS by JORDAN1E:17;
      then
A125: L~US c= L~Cage(C,n) by XBOOLE_1:7;
      then
A126: L~go c=L~Cage(C,n) by A57,XBOOLE_1:1;
A127: {Gik} c= LSeg(go,m) /\ LSeg(pion1,1)
      proof
        let x be set;
        assume x in {Gik};
        then
A128:   x = Gik by TARSKI:def 1;
A129:   Gik in LSeg(go,m) by A63,RLTOPSP1:69;
        Gik in LSeg(pion1,1) by A60,A90,A94,TOPREAL1:27;
        hence thesis by A128,A129,XBOOLE_0:def 4;
      end;
      LSeg(pion1,1) c= L~pion by A85,TOPREAL3:26;
      then LSeg(go,len go-'1) /\ LSeg(pion1,1) c={Gik} by A62,A67,XBOOLE_1:27;
      then LSeg(go,len go-'1) /\ LSeg(pion1,1) = { go/.len go } by A60,A62,A127
,XBOOLE_0:def 10;
      then
A130: go^'pion1 is unfolded by A90,TOPREAL8:34;
      len (go^'pion1) >= len go by TOPREAL8:7;
      then
A131: len (go^'pion1) >= 1+1 by A56,XXREAL_0:2;
      then
A132: len (go^'pion1) > 1+0 by NAT_1:13;
A133: now
        assume
A134:   Gik..US <= 1;
        Gik..US >= 1 by A47,FINSEQ_4:31;
        then Gik..US = 1 by A134,XXREAL_0:1;
        then Gik = US/.1 by A47,FINSEQ_5:41;
        hence contradiction by A42,A46,JORDAN1F:5;
      end;
A135: US is_sequence_on G by JORDAN1G:4;
A136: Wmin`1 = Wbo by EUCLID:56;
      set ff = Rotate(Cage(C,n),Wmin);
A137: 1+1 <= len Cage(C,n) by GOBOARD7:36,XXREAL_0:2;
A138: len godo >= len (go^'pion1) by TOPREAL8:7;
      then
A139: 1+1 <= len godo by A131,XXREAL_0:2;
      (go^'pion1) is non trivial by A131,REALSET1:13;
      then reconsider
      godo as non constant standard special_circular_sequence by A139,A89,A112
,A130,A123,A121,A99,A122,A107,A110,JORDAN8:7,8,TOPREAL8:11,33,34;
A140: L~godo = L~(go^'pion1) \/ L~do by A89,TOPREAL8:35
        .= L~go \/ L~pion1 \/ L~do by A90,TOPREAL8:35;
A141: right_cell(godo,1,G)\L~godo c= RightComp godo by A139,A112,JORDAN9:29;
      2 in dom godo by A139,FINSEQ_3:27;
      then
A142: godo/.2 in rng godo by PARTFUN2:4;
A143: W-min C in LA by A108,TOPREAL1:4;
      Wmin in rng Cage(C,n) by SPRECT_2:47;
      then
A144: ff/.1 = Wmin by FINSEQ_6:98;
A145: L~ff = L~Cage(C,n) by REVROT_1:33;
      then (W-max L~ff)..ff > 1 by A144,SPRECT_5:23;
      then (N-min L~ff)..ff > 1 by A144,A145,SPRECT_5:24,XXREAL_0:2;
      then (N-max L~ff)..ff > 1 by A144,A145,SPRECT_5:25,XXREAL_0:2;
      then
A146: Emax..ff > 1 by A144,A145,SPRECT_5:26,XXREAL_0:2;
A147: Cage(C,n) is_sequence_on G by JORDAN9:def 1;
      then
A148: ff is_sequence_on G by REVROT_1:34;
A149: Gi1k`1 = G*(i1,1)`1 by A1,A6,A11,A16,GOBOARD5:3
        .= Gij`1 by A1,A4,A11,A10,GOBOARD5:3;
      then
A150: W-bound pio = Gij`1 by SPRECT_1:62;
A151: L~LS c= L~Cage(C,n) by A124,XBOOLE_1:7;
      then
A152: L~do c=L~Cage(C,n) by A36,XBOOLE_1:1;
A153: W-min C in C by SPRECT_1:15;
A154: now
        assume W-min C in L~godo;
        then
A155:   W-min C in L~go \/ L~pion1 or W-min C in L~do by A140,XBOOLE_0:def 3;
        per cases by A155,XBOOLE_0:def 3;
        suppose
          W-min C in L~go;
          then C meets L~Cage(C,n) by A126,A153,XBOOLE_0:3;
          hence contradiction by JORDAN10:5;
        end;
        suppose
          W-min C in L~pion1;
          hence contradiction by A9,A13,A85,A143,XBOOLE_0:3;
        end;
        suppose
          W-min C in L~do;
          then C meets L~Cage(C,n) by A152,A153,XBOOLE_0:3;
          hence contradiction by JORDAN10:5;
        end;
      end;
A156: len US >= 2 by A41,XXREAL_0:2;
A157: L~go \/ L~do is compact by COMPTS_1:19;
      1+1 <= len Rotate(Cage(C,n),Wmin) by GOBOARD7:36,XXREAL_0:2;
      then right_cell(Rotate(Cage(C,n),Wmin),1) = right_cell(ff,1,GoB ff) by
JORDAN1H:29
        .= right_cell(ff,1,GoB Cage(C,n)) by REVROT_1:28
        .= right_cell(ff,1,G) by JORDAN1H:52
        .= right_cell(ff-:Emax,1,G) by A146,A148,JORDAN1J:53
        .= right_cell(US,1,G) by JORDAN1E:def 1
        .= right_cell(R_Cut(US,Gik),1,G) by A47,A135,A133,JORDAN1J:52
        .= right_cell(go^'pion1,1,G) by A58,A111,JORDAN1J:51
        .= right_cell(godo,1,G) by A132,A112,JORDAN1J:51;
      then W-min C in right_cell(godo,1,G) by JORDAN1I:8;
      then
A158: W-min C in right_cell(godo,1,G)\L~godo by A154,XBOOLE_0:def 5;
A159: rng godo c= L~godo by A131,A138,SPPOL_2:18,XXREAL_0:2;
A160: godo/.1 = (go^'pion1)/.1 by GRAPH_2:57
        .= Wmin by A68,GRAPH_2:57;
A161: Gi1k`1 <= Gik`1 by A1,A2,A3,A6,A16,JORDAN1A:39;
      then
A162: W-bound poz = Gi1k`1 by SPRECT_1:62;
      W-bound (poz \/ pio) = min(W-bound poz, W-bound pio) by SPRECT_1:54
        .= Gij`1 by A149,A162,A150;
      then
A163: W-bound L~pion1 = Gij`1 by A85,TOPREAL3:23;
A164: LA c= C by JORDAN6:76;
      Gij`1 >= Wbo by A30,A151,PSCOMP_1:71;
      then
A165: Gij`1 > Wbo by A38,XXREAL_0:1;
A166: E-max C in LA by A108,TOPREAL1:4;
      Wmin in L~go \/ L~do by A78,A69,XBOOLE_0:def 3;
      then
A167: W-min (L~go \/ L~do) = Wmin by A126,A152,A157,JORDAN1J:21,XBOOLE_1:8;
      (W-min (L~go \/ L~do))`1 = W-bound (L~go \/ L~do) by EUCLID:56;
      then W-min (L~go\/L~do\/L~pion1) = W-min (L~go \/ L~do) by A163,A157,A167
,A136,A165,JORDAN1J:33;
      then
A168: W-min L~godo = Wmin by A140,A167,XBOOLE_1:4;
      godo/.2 = (go^'pion1)/.2 by A131,GRAPH_2:61
        .= US/.2 by A56,A77,GRAPH_2:61
        .= (US^'LS)/.2 by A156,GRAPH_2:61
        .= Rotate(Cage(C,n),Wmin)/.2 by JORDAN1E:15;
      then godo/.2 in W-most L~Cage(C,n) by JORDAN1I:27;
      then (godo/.2)`1 = (W-min L~godo)`1 by A168,PSCOMP_1:88
        .= W-bound L~godo by EUCLID:56;
      then godo/.2 in W-most L~godo by A159,A142,SPRECT_2:16;
      then Rotate(godo,W-min L~godo)/.2 in W-most L~godo by A160,A168,
FINSEQ_6:95;
      then reconsider godo as clockwise_oriented non constant standard
      special_circular_sequence by JORDAN1I:27;
      len US in dom US by FINSEQ_5:6;
      then
A169: US.len US = US/.len US by PARTFUN1:def 8
        .= Emax by JORDAN1F:7;
A170: east_halfline E-max C misses L~go
      proof
        assume east_halfline E-max C meets L~go;
        then consider p be set such that
A171:   p in east_halfline E-max C and
A172:   p in L~go by XBOOLE_0:3;
        reconsider p as Point of TOP-REAL 2 by A171;
        p in L~US by A57,A172;
        then p in east_halfline E-max C /\ L~Cage(C,n) by A125,A171,
XBOOLE_0:def 4;
        then
A173:   p`1 = Ebo by JORDAN1A:104,PSCOMP_1:111;
        then
A174:   p = Emax by A57,A172,JORDAN1J:46;
        then Emax = Gik by A45,A169,A172,JORDAN1J:43;
        then Gik`1 = G*(len G,k)`1 by A6,A16,A24,A173,A174,JORDAN1A:92;
        hence contradiction by A3,A19,A22,JORDAN1G:7;
      end;
      now
        assume east_halfline E-max C meets L~godo;
        then
A175:   east_halfline E-max C meets (L~go \/ L~pion1) or east_halfline
        E-max C meets L~do by A140,XBOOLE_1:70;
        per cases by A175,XBOOLE_1:70;
        suppose
          east_halfline E-max C meets L~go;
          hence contradiction by A170;
        end;
        suppose
          east_halfline E-max C meets L~pion1;
          then consider p be set such that
A176:     p in east_halfline E-max C and
A177:     p in L~pion1 by XBOOLE_0:3;
          reconsider p as Point of TOP-REAL 2 by A176;
A178:     p`2 = (E-max C)`2 by A176,TOPREAL1:def 13;
A179:     now
            per cases by A13,A85,A177,XBOOLE_0:def 3;
            suppose
              p in poz;
              hence p`1 <= Gik`1 by A161,TOPREAL1:9;
            end;
            suppose
              p in pio;
              hence p`1 <= Gik`1 by A149,A161,GOBOARD7:5;
            end;
          end;
          i2+1 <= len G by A3,NAT_1:13;
          then i2+1-1 <= len G-1 by XREAL_1:11;
          then
A180:     i2 <= len G-'1 by XREAL_0:def 2;
          len G-'1 <= len G by NAT_D:35;
          then Gik`1 <= G*(len G-'1,1)`1 by A6,A18,A16,A24,A14,A180,JORDAN1A:39
;
          then p`1 <= G*(len G-'1,1)`1 by A179,XXREAL_0:2;
          then p`1 <= E-bound C by A14,JORDAN8:15;
          then
A181:     p`1 <= (E-max C)`1 by EUCLID:56;
          p`1 >= (E-max C)`1 by A176,TOPREAL1:def 13;
          then p`1 = (E-max C)`1 by A181,XXREAL_0:1;
          then p = E-max C by A178,TOPREAL3:11;
          hence contradiction by A9,A13,A85,A166,A177,XBOOLE_0:3;
        end;
        suppose
          east_halfline E-max C meets L~do;
          then consider p be set such that
A182:     p in east_halfline E-max C and
A183:     p in L~do by XBOOLE_0:3;
          reconsider p as Point of TOP-REAL 2 by A182;
A184:     p in LSeg(do,Index(p,do)) by A183,JORDAN3:42;
          consider t be Nat such that
A185:     t in dom LS and
A186:     LS.t = Gij by A32,FINSEQ_2:11;
          1 <= t by A185,FINSEQ_3:27;
          then
A187:     1 < t by A34,A186,XXREAL_0:1;
          t <= len LS by A185,FINSEQ_3:27;
          then Index(Gij,LS)+1 = t by A186,A187,JORDAN3:45;
          then
A188:     len L_Cut(LS,Gij) = len LS-Index(Gij,LS) by A30,A186,JORDAN3:61;
          Index(p,do) < len do by A183,JORDAN3:41;
          then Index(p,do) < len LS-'Index(Gij,LS) by A188,XREAL_0:def 2;
          then Index(p,do)+1 <= len LS-'Index(Gij,LS) by NAT_1:13;
          then
A189:     Index(p,do) <= len LS-'Index(Gij,LS)-1 by XREAL_1:21;
A190:     do = mid(LS,Gij..LS,len LS) by A32,JORDAN1J:37;
          p in L~LS by A36,A183;
          then p in east_halfline E-max C /\ L~Cage(C,n) by A151,A182,
XBOOLE_0:def 4;
          then
A191:     p`1 = Ebo by JORDAN1A:104,PSCOMP_1:111;
A192:     Index(Gij,LS)+1 = Gij..LS by A34,A32,JORDAN1J:56;
          0+Index(Gij,LS) < len LS by A30,JORDAN3:41;
          then len LS-Index(Gij,LS) > 0 by XREAL_1:22;
          then Index(p,do) <= len LS-Index(Gij,LS)-1 by A189,XREAL_0:def 2;
          then Index(p,do) <= len LS-Gij..LS by A192;
          then Index(p,do) <= len LS-'Gij..LS by XREAL_0:def 2;
          then
A193:     Index(p,do) < len LS-'(Gij..LS)+1 by NAT_1:13;
A194:     1<=Index(p,do) by A183,JORDAN3:41;
A195:     Gij..LS<=len LS by A32,FINSEQ_4:31;
          Gij..LS <> len LS by A31,A32,FINSEQ_4:29;
          then
A196:     Gij..LS < len LS by A195,XXREAL_0:1;
A197:     1+1 <= len LS by A25,XXREAL_0:2;
          then
A198:     2 in dom LS by FINSEQ_3:27;
          set tt = Index(p,do)+(Gij..LS)-'1;
          set RC = Rotate(Cage(C,n),Emax);
A199:     E-max C in right_cell(RC,1) by JORDAN1I:9;
A200:     GoB RC = GoB Cage(C,n) by REVROT_1:28
            .= G by JORDAN1H:52;
A201:     L~RC = L~Cage(C,n) by REVROT_1:33;
          consider jj2 be Element of NAT such that
A202:     1 <= jj2 and
A203:     jj2 <= width G and
A204:     Emax = G*(len G,jj2) by JORDAN1D:29;
A205:     len G >= 4 by JORDAN8:13;
          then len G >= 1 by XXREAL_0:2;
          then
A206:     [len G,jj2] in Indices G by A202,A203,MATRIX_1:37;
A207:     len RC = len Cage(C,n) by REVROT_1:14;
          LS = RC-:Wmin by JORDAN1G:26;
          then
A208:     LSeg(LS,1) = LSeg(RC,1) by A197,SPPOL_2:9;
A209:     Emax in rng Cage(C,n) by SPRECT_2:50;
          RC is_sequence_on G by A147,REVROT_1:34;
          then consider ii,jj be Element of NAT such that
A210:     [ii,jj+1] in Indices G and
A211:     [ii,jj] in Indices G and
A212:     RC/.1 = G*(ii,jj+1) and
A213:     RC/.(1+1) = G*(ii,jj) by A137,A201,A207,A209,FINSEQ_6:98,JORDAN1I:25;
A214:     jj+1+1 <> jj;
A215:     1 <= jj by A211,MATRIX_1:39;
          RC/.1 = E-max L~RC by A201,A209,FINSEQ_6:98;
          then
A216:     ii = len G by A201,A210,A212,A204,A206,GOBOARD1:21;
          then ii-1 >= 4-1 by A205,XREAL_1:11;
          then
A217:     ii-1 >= 1 by XXREAL_0:2;
          then
A218:     1 <= ii-'1 by XREAL_0:def 2;
A219:     jj <= width G by A211,MATRIX_1:39;
          then
A220:     G*(len G,jj)`1 = Ebo by A24,A215,JORDAN1A:92;
A221:     jj+1 <= width G by A210,MATRIX_1:39;
          ii+1 <> ii;
          then
A222:     right_cell(RC,1) = cell(G,ii-'1,jj) by A137,A207,A200,A210,A211,A212
,A213,A214,GOBOARD5:def 6;
A223:     ii <= len G by A211,MATRIX_1:39;
A224:     1 <= ii by A211,MATRIX_1:39;
A225:     ii <= len G by A210,MATRIX_1:39;
A226:     1 <= jj+1 by A210,MATRIX_1:39;
          then
A227:     Ebo = G*(len G,jj+1)`1 by A24,A221,JORDAN1A:92;
A228:     1 <= ii by A210,MATRIX_1:39;
          then
A229:     ii-'1+1 = ii by XREAL_1:237;
          then
A230:     ii-'1 < len G by A225,NAT_1:13;
          then
A231:     G*(ii-'1,jj+1)`2 = G*(1,jj+1)`2 by A226,A221,A218,GOBOARD5:2
            .= G*(ii,jj+1)`2 by A228,A225,A226,A221,GOBOARD5:2;
A232:     (E-max C)`2 = p`2 by A182,TOPREAL1:def 13;
          then
A233:     p`2 <= G*(ii-'1,jj+1)`2 by A199,A225,A221,A215,A222,A229,A217,
JORDAN9:19;
A234:     G*(ii-'1,jj)`2 = G*(1,jj)`2 by A215,A219,A218,A230,GOBOARD5:2
            .= G*(ii,jj)`2 by A224,A223,A215,A219,GOBOARD5:2;
          G*(ii-'1,jj)`2 <= p`2 by A232,A199,A225,A221,A215,A222,A229,A217,
JORDAN9:19;
          then p in LSeg(RC/.1,RC/.(1+1)) by A191,A212,A213,A216,A233,A234,A231
,A220,A227,GOBOARD7:8;
          then
A235:     p in LSeg(LS,1) by A137,A208,A207,TOPREAL1:def 5;
          1<=Gij..LS by A32,FINSEQ_4:31;
          then
A236:     LSeg(mid(LS,Gij..LS,len LS),Index(p,do)) = LSeg(LS,Index(p,do)
          +(Gij..LS)-'1) by A196,A194,A193,JORDAN4:31;
          1<=Index(Gij,LS) by A30,JORDAN3:41;
          then
A237:     1+1 <= Gij..LS by A192,XREAL_1:9;
          then Index(p,do)+Gij..LS >= 1+1+1 by A194,XREAL_1:9;
          then Index(p,do)+Gij..LS-1 >= 1+1+1-1 by XREAL_1:11;
          then
A238:     tt >= 1+1 by XREAL_0:def 2;
          now
            per cases by A238,XXREAL_0:1;
            suppose
              tt > 1+1;
              then LSeg(LS,1) misses LSeg(LS,tt) by TOPREAL1:def 9;
              hence contradiction by A235,A184,A190,A236,XBOOLE_0:3;
            end;
            suppose
A239:         tt = 1+1;
              then 1+1 = Index(p,do)+(Gij..LS)-1 by XREAL_0:def 2;
              then 1+1+1 = Index(p,do)+(Gij..LS);
              then
A240:         Gij..LS = 2 by A194,A237,JORDAN1E:10;
              LSeg(LS,1) /\ LSeg(LS,tt) = {LS/.2} by A25,A239,TOPREAL1:def 8;
              then p in {LS/.2} by A235,A184,A190,A236,XBOOLE_0:def 4;
              then
A241:         p = LS/.2 by TARSKI:def 1;
              then
A242:         p in rng LS by A198,PARTFUN2:4;
              p..LS = 2 by A198,A241,FINSEQ_5:44;
              then p = Gij by A32,A240,A242,FINSEQ_5:10;
              then Gij`1 = Ebo by A241,JORDAN1G:40;
              then Gij`1 = G*(len G,j)`1 by A4,A10,A24,JORDAN1A:92;
              hence contradiction by A2,A3,A23,A15,JORDAN1G:7;
            end;
          end;
          hence contradiction;
        end;
      end;
      then east_halfline E-max C c= (L~godo)` by SUBSET_1:43;
      then consider W be Subset of TOP-REAL 2 such that
A243: W is_a_component_of (L~godo)` and
A244: east_halfline E-max C c= W by GOBOARD9:5;
      W is not Bounded by A244,JORDAN2C:16,129;
      then W is_outside_component_of L~godo by A243,JORDAN2C:def 4;
      then W c= UBD L~godo by JORDAN2C:27;
      then
A245: east_halfline E-max C c= UBD L~godo by A244,XBOOLE_1:1;
      E-max C in east_halfline E-max C by TOPREAL1:45;
      then E-max C in UBD L~godo by A245;
      then E-max C in LeftComp godo by GOBRD14:46;
      then LA meets L~godo by A109,A143,A166,A141,A158,JORDAN1J:36;
      then
A246: LA meets (L~go \/ L~pion1) or LA meets L~do by A140,XBOOLE_1:70;
      now
        per cases by A246,XBOOLE_1:70;
        suppose
          LA meets L~go;
          then LA meets L~Cage(C,n) by A57,A125,XBOOLE_1:1,63;
          hence contradiction by A164,JORDAN10:5,XBOOLE_1:63;
        end;
        suppose
          LA meets L~pion1;
          hence contradiction by A9,A13,A85;
        end;
        suppose
          LA meets L~do;
          then LA meets L~Cage(C,n) by A36,A151,XBOOLE_1:1,63;
          hence contradiction by A164,JORDAN10:5,XBOOLE_1:63;
        end;
      end;
      hence contradiction;
    end;
    suppose
      Gij`1 = Gik`1;
      then
A247: i1 = i2 by A23,A19,JORDAN1G:7;
      then poz = {Gi1k} by RLTOPSP1:71;
      then poz c= pio by A40,ZFMISC_1:37;
      then pio \/ poz = pio by XBOOLE_1:12;
      hence contradiction by A1,A3,A4,A5,A6,A7,A8,A9,A247,JORDAN1J:58;
    end;
    suppose
      Gij`2 = Gik`2;
      then
A248: j = k by A23,A19,JORDAN1G:6;
      then pio = {Gi1k} by RLTOPSP1:71;
      then pio c= poz by A39,ZFMISC_1:37;
      then pio \/ poz = poz by XBOOLE_1:12;
      hence contradiction by A1,A2,A3,A4,A6,A7,A8,A9,A248,Th30;
    end;
  end;
  hence contradiction;
end;

theorem Th48:
  for C be Simple_closed_curve for i1,i2,j,k be Element of NAT st
1 < i2 & i2 <= i1 & i1 < len Gauge(C,n) & 1 <= j & j <= k & k <= width Gauge(C,
n) & (LSeg(Gauge(C,n)*(i1,j),Gauge(C,n)*(i1,k)) \/ LSeg(Gauge(C,n)*(i1,k),Gauge
(C,n)*(i2,k))) /\ L~Upper_Seq(C,n) = {Gauge(C,n)*(i2,k)} & (LSeg(Gauge(C,n)*(i1
  ,j),Gauge(C,n)*(i1,k)) \/ LSeg(Gauge(C,n)*(i1,k),Gauge(C,n)*(i2,k))) /\ L~
Lower_Seq(C,n) = {Gauge(C,n)*(i1,j)} holds (LSeg(Gauge(C,n)*(i1,j),Gauge(C,n)*(
  i1,k)) \/ LSeg(Gauge(C,n)*(i1,k),Gauge(C,n)*(i2,k))) meets Upper_Arc C
proof
  let C be Simple_closed_curve;
  let i1,i2,j,k be Element of NAT;
  set G = Gauge(C,n);
  set pio = LSeg(G*(i1,j),G*(i1,k));
  set poz = LSeg(G*(i1,k),G*(i2,k));
  set US = Upper_Seq(C,n);
  set LS = Lower_Seq(C,n);
  assume that
A1: 1 < i2 and
A2: i2 <= i1 and
A3: i1 < len G and
A4: 1 <= j and
A5: j <= k and
A6: k <= width G and
A7: (pio \/ poz) /\ L~US = {G*(i2,k)} and
A8: (pio \/ poz) /\ L~LS = {G*(i1,j)} and
A9: (pio \/ poz) misses Upper_Arc C;
  set Gi1k = G*(i1,k);
  set Gik = G*(i2,k);
A10: 1 <= k by A4,A5,XXREAL_0:2;
A11: i2 < len G by A2,A3,XXREAL_0:2;
  then
A12: [i2,k] in Indices G by A1,A6,A10,MATRIX_1:37;
  set Wmin = W-min L~Cage(C,n);
  set Wbo = W-bound L~Cage(C,n);
A13: len G = width G by JORDAN8:def 1;
  set go = R_Cut(US,Gik);
A14: len US >= 3 by JORDAN1E:19;
  then len US >= 1 by XXREAL_0:2;
  then 1 in dom US by FINSEQ_3:27;
  then
A15: US.1 = US/.1 by PARTFUN1:def 8
    .= Wmin by JORDAN1F:5;
  set Gij = G*(i1,j);
  set do = L_Cut(LS,Gij);
  Gij in {Gij} by TARSKI:def 1;
  then
A16: Gij in L~LS by A8,XBOOLE_0:def 4;
A17: 1 < i1 by A1,A2,XXREAL_0:2;
  then
A18: Gi1k`2 = G*(1,k)`2 by A3,A6,A10,GOBOARD5:2
    .= Gik`2 by A1,A6,A11,A10,GOBOARD5:2;
A19: j <= width G by A5,A6,XXREAL_0:2;
  then
A20: [i1,j] in Indices G by A3,A4,A17,MATRIX_1:37;
  len G >= 4 by JORDAN8:13;
  then
A21: len G >= 1 by XXREAL_0:2;
  then
A22: [len G,j] in Indices G by A4,A19,MATRIX_1:37;
A23: [1,k] in Indices G by A6,A10,A21,MATRIX_1:37;
A24: now
    assume Gik`1 = Wbo;
    then G*(1,k)`1 = G*(i2,k)`1 by A6,A10,A13,JORDAN1A:94;
    hence contradiction by A1,A12,A23,JORDAN1G:7;
  end;
A25: [i1,j] in Indices G by A3,A4,A17,A19,MATRIX_1:37;
  set pion = <*Gik,Gi1k,Gij*>;
A26: Gi1k in poz by RLTOPSP1:69;
  set UA = Upper_Arc C;
A27: Gi1k in pio by RLTOPSP1:69;
A28: [i1,k] in Indices G by A3,A6,A17,A10,MATRIX_1:37;
A29: now
    let n be Element of NAT;
    assume n in dom pion;
    then n in {1,2,3} by FINSEQ_3:1,30;
    then n = 1 or n = 2 or n = 3 by ENUMSET1:def 1;
    hence
    ex i,j be Element of NAT st [i,j] in Indices G & pion/.n = G*(i,j) by A25
,A12,A28,FINSEQ_4:27;
  end;
  Gik in {Gik} by TARSKI:def 1;
  then
A30: Gik in L~US by A7,XBOOLE_0:def 4;
  set Emax = E-max L~Cage(C,n);
A31: len LS >= 1+2 by JORDAN1E:19;
  then
A32: len LS >= 1 by XXREAL_0:2;
  then
A33: 1 in dom LS by FINSEQ_3:27;
  then
A34: LS.1 = LS/.1 by PARTFUN1:def 8
    .= Emax by JORDAN1F:6;
  len LS in dom LS by A32,FINSEQ_3:27;
  then
A35: LS.len LS = LS/.len LS by PARTFUN1:def 8
    .= Wmin by JORDAN1F:8;
  set Ebo = E-bound L~Cage(C,n);
A36: L~<*Gik,Gi1k,Gij*> = poz \/ pio by TOPREAL3:23;
  Wmin`1 = Wbo by EUCLID:56
    .= G*(1,k)`1 by A6,A10,A13,JORDAN1A:94;
  then
A37: Gik <> US.1 by A1,A12,A15,A23,JORDAN1G:7;
  then reconsider go as being_S-Seq FinSequence of TOP-REAL 2 by A30,JORDAN3:70
;
A38: Gik in rng US by A1,A6,A11,A30,A10,JORDAN1G:4,JORDAN1J:40;
  then
A39: go is_sequence_on G by JORDAN1G:4,JORDAN1J:38;
  Gi1k`1 = G*(i1,1)`1 by A3,A6,A17,A10,GOBOARD5:3
    .= Gij`1 by A3,A4,A17,A19,GOBOARD5:3;
  then
A40: Gi1k = |[Gij`1,Gik`2]| by A18,EUCLID:57;
A41: [len G,k] in Indices G by A6,A10,A21,MATRIX_1:37;
A42: len go >= 1+1 by TOPREAL1:def 10;
  Wmin`1 = Wbo by EUCLID:56
    .= G*(1,k)`1 by A6,A10,A13,JORDAN1A:94;
  then
A43: Gij <> LS.len LS by A1,A2,A23,A35,A20,JORDAN1G:7;
  then reconsider do as being_S-Seq FinSequence of TOP-REAL 2 by A16,JORDAN3:69
;
A44: Gij in rng LS by A3,A4,A17,A16,A19,JORDAN1G:5,JORDAN1J:40;
  then
A45: do is_sequence_on G by JORDAN1G:5,JORDAN1J:39;
  Emax`1 = Ebo by EUCLID:56
    .= G*(len G,k)`1 by A6,A10,A13,JORDAN1A:92;
  then
A46: Gij <> LS.1 by A3,A20,A41,A34,JORDAN1G:7;
A47: len do >= 1+1 by TOPREAL1:def 10;
  then reconsider
  do as non constant s.c.c. (being_S-Seq FinSequence of TOP-REAL 2)
  by A45,JGRAPH_1:16,JORDAN8:8;
A48: L~do c= L~LS by A16,JORDAN3:77;
  len do >= 1 by A47,XXREAL_0:2;
  then 1 in dom do by FINSEQ_3:27;
  then
A49: do/.1 = do.1 by PARTFUN1:def 8
    .= Gij by A16,JORDAN3:58;
  then
A50: LSeg(do,1) = LSeg(Gij,do/.(1+1)) by A47,TOPREAL1:def 5;
A51: {Gij} c= LSeg(do,1) /\ L~<*Gik,Gi1k,Gij*>
  proof
    let x be set;
    assume x in {Gij};
    then
A52: x = Gij by TARSKI:def 1;
    Gij in LSeg(Gi1k,Gij) by RLTOPSP1:69;
    then Gij in LSeg(Gik,Gi1k) \/ LSeg(Gi1k,Gij) by XBOOLE_0:def 3;
    then
A53: Gij in L~<*Gik,Gi1k,Gij*> by SPRECT_1:10;
    Gij in LSeg(do,1) by A50,RLTOPSP1:69;
    hence thesis by A52,A53,XBOOLE_0:def 4;
  end;
  LSeg(do,1) c= L~do by TOPREAL3:26;
  then LSeg(do,1) c= L~LS by A48,XBOOLE_1:1;
  then LSeg(do,1) /\ L~<*Gik,Gi1k,Gij*> c= {Gij} by A8,A36,XBOOLE_1:26;
  then
A54: L~<*Gik,Gi1k,Gij*> /\ LSeg(do,1) = {Gij} by A51,XBOOLE_0:def 10;
A55: rng do c= L~do by A47,SPPOL_2:18;
  reconsider go as non constant s.c.c. (being_S-Seq FinSequence of TOP-REAL 2)
  by A42,A39,JGRAPH_1:16,JORDAN8:8;
A56: L~go c= L~US by A30,JORDAN3:76;
A57: len go > 1 by A42,NAT_1:13;
  then
A58: len go in dom go by FINSEQ_3:27;
  then
A59: go/.len go = go.len go by PARTFUN1:def 8
    .= Gik by A30,JORDAN3:59;
  reconsider m = len go - 1 as Element of NAT by A58,FINSEQ_3:28;
A60: m+1 = len go;
  then
A61: len go-'1 = m by NAT_D:34;
  m >= 1 by A42,XREAL_1:21;
  then
A62: LSeg(go,m) = LSeg(go/.m,Gik) by A59,A60,TOPREAL1:def 5;
A63: {Gik} c= LSeg(go,m) /\ L~<*Gik,Gi1k,Gij*>
  proof
    let x be set;
    assume x in {Gik};
    then
A64: x = Gik by TARSKI:def 1;
    Gik in LSeg(Gik,Gi1k) by RLTOPSP1:69;
    then Gik in LSeg(Gik,Gi1k) \/ LSeg(Gi1k,Gij) by XBOOLE_0:def 3;
    then
A65: Gik in L~<*Gik,Gi1k,Gij*> by SPRECT_1:10;
    Gik in LSeg(go,m) by A62,RLTOPSP1:69;
    hence thesis by A64,A65,XBOOLE_0:def 4;
  end;
  LSeg(go,m) c= L~go by TOPREAL3:26;
  then LSeg(go,m) c= L~US by A56,XBOOLE_1:1;
  then LSeg(go,m) /\ L~<*Gik,Gi1k,Gij*> c= {Gik} by A7,A36,XBOOLE_1:26;
  then
A66: LSeg(go,m) /\ L~<*Gik,Gi1k,Gij*> = {Gik} by A63,XBOOLE_0:def 10;
A67: go/.1 = US/.1 by A30,SPRECT_3:39
    .= Wmin by JORDAN1F:5;
  then
A68: Wmin in rng go by FINSEQ_6:46;
A69: LS.1 = LS/.1 by A33,PARTFUN1:def 8
    .= Emax by JORDAN1F:6;
A70: L~go /\ L~do c= {go/.1}
  proof
    let x be set;
    assume
A71: x in L~go /\ L~do;
    then
A72: x in L~do by XBOOLE_0:def 4;
A73: now
      assume x = Emax;
      then
A74:  Emax = Gij by A16,A69,A72,JORDAN1E:11;
      G*(len G,j)`1 = Ebo by A4,A19,A13,JORDAN1A:92;
      then Emax`1 <> Ebo by A3,A25,A22,A74,JORDAN1G:7;
      hence contradiction by EUCLID:56;
    end;
    x in L~go by A71,XBOOLE_0:def 4;
    then x in L~US /\ L~LS by A56,A48,A72,XBOOLE_0:def 4;
    then x in {Wmin,Emax} by JORDAN1E:20;
    then x = Wmin or x = Emax by TARSKI:def 2;
    hence thesis by A67,A73,TARSKI:def 1;
  end;
  set W2 = go/.2;
A75: 2 in dom go by A42,FINSEQ_3:27;
  go = mid(US,1,Gik..US) by A38,JORDAN1G:57
    .= US|(Gik..US) by A38,FINSEQ_4:31,FINSEQ_6:122;
  then
A76: W2 = US/.2 by A75,FINSEQ_4:85;
A77: rng go c= L~go by A42,SPPOL_2:18;
A78: go/.1 = LS/.len LS by A67,JORDAN1F:8
    .= do/.len do by A16,JORDAN1J:35;
  {go/.1} c= L~go /\ L~do
  proof
    let x be set;
    assume x in {go/.1};
    then
A79: x = go/.1 by TARSKI:def 1;
    then
A80: x in rng go by FINSEQ_6:46;
    x in rng do by A78,A79,REVROT_1:3;
    hence thesis by A77,A55,A80,XBOOLE_0:def 4;
  end;
  then
A81: L~go /\ L~do = {go/.1} by A70,XBOOLE_0:def 10;
  now
    per cases;
    suppose
      Gij`1 <> Gik`1 & Gij`2 <> Gik`2;
      then pion is being_S-Seq by A40,TOPREAL3:42;
      then consider pion1 be FinSequence of TOP-REAL 2 such that
A82:  pion1 is_sequence_on G and
A83:  pion1 is being_S-Seq and
A84:  L~pion = L~pion1 and
A85:  pion/.1 = pion1/.1 and
A86:  pion/.len pion = pion1/.len pion1 and
A87:  len pion <= len pion1 by A29,GOBOARD3:2;
      reconsider pion1 as being_S-Seq FinSequence of TOP-REAL 2 by A83;
A88:  (go^'pion1)/.len (go^'pion1) = pion/.len pion by A86,GRAPH_2:58
        .= pion/.3 by FINSEQ_1:62
        .= do/.1 by A49,FINSEQ_4:27;
A89:  go/.len go = pion1/.1 by A59,A85,FINSEQ_4:27;
A90:  L~go /\ L~pion1 c= {pion1/.1}
      proof
        let x be set;
        assume
A91:    x in L~go /\ L~pion1;
        then
A92:    x in L~pion1 by XBOOLE_0:def 4;
        x in L~go by A91,XBOOLE_0:def 4;
        hence thesis by A7,A36,A59,A56,A84,A89,A92,XBOOLE_0:def 4;
      end;
      len pion1 >= 2+1 by A87,FINSEQ_1:62;
      then
A93:  len pion1 > 1+1 by NAT_1:13;
      then
A94:  rng pion1 c= L~pion1 by SPPOL_2:18;
      {pion1/.1} c= L~go /\ L~pion1
      proof
        let x be set;
        assume x in {pion1/.1};
        then
A95:    x = pion1/.1 by TARSKI:def 1;
        then
A96:    x in rng pion1 by FINSEQ_6:46;
        x in rng go by A89,A95,REVROT_1:3;
        hence thesis by A77,A94,A96,XBOOLE_0:def 4;
      end;
      then
A97:  L~go /\ L~pion1 = {pion1/.1} by A90,XBOOLE_0:def 10;
      then
A98:  (go^'pion1) is s.n.c. by A89,JORDAN1J:54;
A99:  {Gik} c= LSeg(go,m) /\ LSeg(pion1,1)
      proof
        let x be set;
        assume x in {Gik};
        then
A100:   x = Gik by TARSKI:def 1;
A101:   Gik in LSeg(go,m) by A62,RLTOPSP1:69;
        Gik in LSeg(pion1,1) by A59,A89,A93,TOPREAL1:27;
        hence thesis by A100,A101,XBOOLE_0:def 4;
      end;
      LSeg(pion1,1) c= L~pion by A84,TOPREAL3:26;
      then LSeg(go,len go-'1) /\ LSeg(pion1,1) c={Gik} by A61,A66,XBOOLE_1:27;
      then LSeg(go,len go-'1) /\ LSeg(pion1,1) = { go/.len go } by A59,A61,A99,
XBOOLE_0:def 10;
      then
A102: go^'pion1 is unfolded by A89,TOPREAL8:34;
      len (go^'pion1) >= len go by TOPREAL8:7;
      then
A103: len (go^'pion1) >= 1+1 by A42,XXREAL_0:2;
      then
A104: len (go^'pion1) > 1+0 by NAT_1:13;
A105: pion/.len pion = pion/.3 by FINSEQ_1:62
        .= do/.1 by A49,FINSEQ_4:27;
A106: {pion1/.len pion1} c= L~do /\ L~pion1
      proof
        let x be set;
        assume x in {pion1/.len pion1};
        then
A107:   x = pion1/.len pion1 by TARSKI:def 1;
        then
A108:   x in rng pion1 by REVROT_1:3;
        x in rng do by A86,A105,A107,FINSEQ_6:46;
        hence thesis by A55,A94,A108,XBOOLE_0:def 4;
      end;
      L~do /\ L~pion1 c= {pion1/.len pion1}
      proof
        let x be set;
        assume
A109:   x in L~do /\ L~pion1;
        then
A110:   x in L~pion1 by XBOOLE_0:def 4;
        x in L~do by A109,XBOOLE_0:def 4;
        hence thesis by A8,A36,A49,A48,A84,A86,A105,A110,XBOOLE_0:def 4;
      end;
      then
A111: L~do /\ L~pion1 = {pion1/.len pion1} by A106,XBOOLE_0:def 10;
A112: L~(go^'pion1) /\ L~do = (L~go \/ L~pion1) /\ L~do by A89,TOPREAL8:35
        .= {go/.1} \/ {do/.1} by A81,A86,A105,A111,XBOOLE_1:23
        .= {(go^'pion1)/.1} \/ {do/.1} by GRAPH_2:57
        .= {(go^'pion1)/.1,do/.1} by ENUMSET1:41;
A113: UA is_an_arc_of W-min C,E-max C by JORDAN6:def 8;
      then
A114: UA is connected by JORDAN6:11;
      set godo = go^'pion1^'do;
A115: do/.len do = (go^'pion1)/.1 by A78,GRAPH_2:57;
A116: go^'pion1 is_sequence_on G by A39,A82,A89,TOPREAL8:12;
      then
A117: godo is_sequence_on G by A45,A88,TOPREAL8:12;
A118: len pion1-1 >= 1 by A93,XREAL_1:21;
      then
A119: len pion1-'1 = len pion1-1 by XREAL_0:def 2;
A120: {Gij} c= LSeg(pion1,len pion1-'1) /\ LSeg(do,1)
      proof
        let x be set;
        assume x in {Gij};
        then
A121:   x = Gij by TARSKI:def 1;
        pion1/.(len pion1-'1+1) = pion/.3 by A86,A119,FINSEQ_1:62
          .= Gij by FINSEQ_4:27;
        then
A122:   Gij in LSeg(pion1,len pion1-'1) by A118,A119,TOPREAL1:27;
        Gij in LSeg(do,1) by A50,RLTOPSP1:69;
        hence thesis by A121,A122,XBOOLE_0:def 4;
      end;
      LSeg(pion1,len pion1-'1) c= L~pion by A84,TOPREAL3:26;
      then LSeg(pion1,len pion1-'1) /\ LSeg(do,1) c= {Gij} by A54,XBOOLE_1:27;
      then
A123: LSeg(pion1,len pion1-'1) /\ LSeg(do,1) = {Gij} by A120,XBOOLE_0:def 10;
      len pion1-1+1 <= len pion1;
      then
A124: len pion1-'1 < len pion1 by A119,NAT_1:13;
      len pion1 >= 2+1 by A87,FINSEQ_1:62;
      then
A125: len pion1-2 >= 0 by XREAL_1:21;
      then len pion1-'2+1 = len pion1-2+1 by XREAL_0:def 2
        .= len pion1-'1 by A118,XREAL_0:def 2;
      then
A126: LSeg(go^'pion1,len go+(len pion1-'2)) /\ LSeg(do,1) = {(go^'pion1)
      /.len (go^'pion1)} by A49,A89,A88,A124,A123,TOPREAL8:31;
      rng go /\ rng pion1 c= {pion1/.1} by A77,A94,A97,XBOOLE_1:27;
      then
A127: go^'pion1 is one-to-one by JORDAN1J:55;
      len (go^'pion1)+1-1 = len go+len pion1-1 by GRAPH_2:13;
      then len (go^'pion1)-1 = len go + (len pion1-2)
        .= len go + (len pion1-'2) by A125,XREAL_0:def 2;
      then
A128: len (go^'pion1)-'1 = len go + (len pion1-'2) by XREAL_0:def 2;
A129: L~Cage(C,n) = L~US \/ L~LS by JORDAN1E:17;
      then
A130: L~US c= L~Cage(C,n) by XBOOLE_1:7;
      then
A131: L~go c=L~Cage(C,n) by A56,XBOOLE_1:1;
A132: len godo >= len (go^'pion1) by TOPREAL8:7;
      then
A133: 1+1 <= len godo by A103,XXREAL_0:2;
      (go^'pion1) is non trivial by A103,REALSET1:13;
      then reconsider
      godo as non constant standard special_circular_sequence by A133,A88,A117
,A102,A128,A126,A98,A127,A112,A115,JORDAN8:7,8,TOPREAL8:11,33,34;
A134: L~godo = L~(go^'pion1) \/ L~do by A88,TOPREAL8:35
        .= L~go \/ L~pion1 \/ L~do by A89,TOPREAL8:35;
A135: now
        assume
A136:   Gik..US <= 1;
        Gik..US >= 1 by A38,FINSEQ_4:31;
        then Gik..US = 1 by A136,XXREAL_0:1;
        then Gik = US/.1 by A38,FINSEQ_5:41;
        hence contradiction by A15,A37,JORDAN1F:5;
      end;
A137: US is_sequence_on G by JORDAN1G:4;
A138: Gik`1 <= Gi1k`1 by A1,A2,A3,A6,A10,JORDAN1A:39;
      then
A139: W-bound poz = Gik`1 by SPRECT_1:62;
A140: Gi1k`1 = G*(i1,1)`1 by A3,A6,A17,A10,GOBOARD5:3
        .= Gij`1 by A3,A4,A17,A19,GOBOARD5:3;
      then
A141: W-bound pio = Gij`1 by SPRECT_1:62;
      W-bound (poz \/ pio) = min(W-bound poz, W-bound pio) by SPRECT_1:54
        .= Gik`1 by A140,A138,A139,A141,XXREAL_0:def 9;
      then
A142: W-bound L~pion1 = Gik`1 by A84,TOPREAL3:23;
A143: UA c= C by JORDAN6:76;
      Gik`1 >= Wbo by A30,A130,PSCOMP_1:71;
      then
A144: Gik`1 > Wbo by A24,XXREAL_0:1;
A145: len US >= 2 by A14,XXREAL_0:2;
A146: L~go \/ L~do is compact by COMPTS_1:19;
A147: L~LS c= L~Cage(C,n) by A129,XBOOLE_1:7;
      then
A148: L~do c=L~Cage(C,n) by A48,XBOOLE_1:1;
A149: right_cell(godo,1,G)\L~godo c= RightComp godo by A133,A117,JORDAN9:29;
      2 in dom godo by A133,FINSEQ_3:27;
      then
A150: godo/.2 in rng godo by PARTFUN2:4;
A151: rng godo c= L~godo by A103,A132,SPPOL_2:18,XXREAL_0:2;
A152: godo/.1 = (go^'pion1)/.1 by GRAPH_2:57
        .= Wmin by A67,GRAPH_2:57;
A153: W-min C in UA by A113,TOPREAL1:4;
A154: W-min C in C by SPRECT_1:15;
A155: now
        assume W-min C in L~godo;
        then
A156:   W-min C in L~go \/ L~pion1 or W-min C in L~do by A134,XBOOLE_0:def 3;
        per cases by A156,XBOOLE_0:def 3;
        suppose
          W-min C in L~go;
          then C meets L~Cage(C,n) by A131,A154,XBOOLE_0:3;
          hence contradiction by JORDAN10:5;
        end;
        suppose
          W-min C in L~pion1;
          hence contradiction by A9,A36,A84,A153,XBOOLE_0:3;
        end;
        suppose
          W-min C in L~do;
          then C meets L~Cage(C,n) by A148,A154,XBOOLE_0:3;
          hence contradiction by JORDAN10:5;
        end;
      end;
A157: Wmin`1 = Wbo by EUCLID:56;
      set ff = Rotate(Cage(C,n),Wmin);
A158: 1+1 <= len Cage(C,n) by GOBOARD7:36,XXREAL_0:2;
      Wmin in rng Cage(C,n) by SPRECT_2:47;
      then
A159: ff/.1 = Wmin by FINSEQ_6:98;
A160: L~ff = L~Cage(C,n) by REVROT_1:33;
      then (W-max L~ff)..ff > 1 by A159,SPRECT_5:23;
      then (N-min L~ff)..ff > 1 by A159,A160,SPRECT_5:24,XXREAL_0:2;
      then (N-max L~ff)..ff > 1 by A159,A160,SPRECT_5:25,XXREAL_0:2;
      then
A161: Emax..ff > 1 by A159,A160,SPRECT_5:26,XXREAL_0:2;
A162: Cage(C,n) is_sequence_on G by JORDAN9:def 1;
      then
A163: ff is_sequence_on G by REVROT_1:34;
      1+1 <= len Rotate(Cage(C,n),Wmin) by GOBOARD7:36,XXREAL_0:2;
      then right_cell(Rotate(Cage(C,n),Wmin),1) = right_cell(ff,1,GoB ff) by
JORDAN1H:29
        .= right_cell(ff,1,GoB Cage(C,n)) by REVROT_1:28
        .= right_cell(ff,1,G) by JORDAN1H:52
        .= right_cell(ff-:Emax,1,G) by A161,A163,JORDAN1J:53
        .= right_cell(US,1,G) by JORDAN1E:def 1
        .= right_cell(R_Cut(US,Gik),1,G) by A38,A137,A135,JORDAN1J:52
        .= right_cell(go^'pion1,1,G) by A57,A116,JORDAN1J:51
        .= right_cell(godo,1,G) by A104,A117,JORDAN1J:51;
      then W-min C in right_cell(godo,1,G) by JORDAN1I:8;
      then
A164: W-min C in right_cell(godo,1,G)\L~godo by A155,XBOOLE_0:def 5;
A165: E-max C in UA by A113,TOPREAL1:4;
      Wmin in L~go \/ L~do by A77,A68,XBOOLE_0:def 3;
      then
A166: W-min (L~go \/ L~do) = Wmin by A131,A148,A146,JORDAN1J:21,XBOOLE_1:8;
      (W-min (L~go \/ L~do))`1 = W-bound (L~go \/ L~do) by EUCLID:56;
      then W-min (L~go\/L~do\/L~pion1) = W-min (L~go \/ L~do) by A142,A146,A166
,A157,A144,JORDAN1J:33;
      then
A167: W-min L~godo = Wmin by A134,A166,XBOOLE_1:4;
      godo/.2 = (go^'pion1)/.2 by A103,GRAPH_2:61
        .= US/.2 by A42,A76,GRAPH_2:61
        .= (US^'LS)/.2 by A145,GRAPH_2:61
        .= Rotate(Cage(C,n),Wmin)/.2 by JORDAN1E:15;
      then godo/.2 in W-most L~Cage(C,n) by JORDAN1I:27;
      then (godo/.2)`1 = (W-min L~godo)`1 by A167,PSCOMP_1:88
        .= W-bound L~godo by EUCLID:56;
      then godo/.2 in W-most L~godo by A151,A150,SPRECT_2:16;
      then Rotate(godo,W-min L~godo)/.2 in W-most L~godo by A152,A167,
FINSEQ_6:95;
      then reconsider godo as clockwise_oriented non constant standard
      special_circular_sequence by JORDAN1I:27;
      len US in dom US by FINSEQ_5:6;
      then
A168: US.len US = US/.len US by PARTFUN1:def 8
        .= Emax by JORDAN1F:7;
A169: east_halfline E-max C misses L~go
      proof
        assume east_halfline E-max C meets L~go;
        then consider p be set such that
A170:   p in east_halfline E-max C and
A171:   p in L~go by XBOOLE_0:3;
        reconsider p as Point of TOP-REAL 2 by A170;
        p in L~US by A56,A171;
        then p in east_halfline E-max C /\ L~Cage(C,n) by A130,A170,
XBOOLE_0:def 4;
        then
A172:   p`1 = Ebo by JORDAN1A:104,PSCOMP_1:111;
        then
A173:   p = Emax by A56,A171,JORDAN1J:46;
        then Emax = Gik by A30,A168,A171,JORDAN1J:43;
        then Gik`1 = G*(len G,k)`1 by A6,A10,A13,A172,A173,JORDAN1A:92;
        hence contradiction by A2,A3,A12,A41,JORDAN1G:7;
      end;
      now
        assume east_halfline E-max C meets L~godo;
        then
A174:   east_halfline E-max C meets (L~go \/ L~pion1) or east_halfline
        E-max C meets L~do by A134,XBOOLE_1:70;
        per cases by A174,XBOOLE_1:70;
        suppose
          east_halfline E-max C meets L~go;
          hence contradiction by A169;
        end;
        suppose
          east_halfline E-max C meets L~pion1;
          then consider p be set such that
A175:     p in east_halfline E-max C and
A176:     p in L~pion1 by XBOOLE_0:3;
          reconsider p as Point of TOP-REAL 2 by A175;
A177:     p`2 = (E-max C)`2 by A175,TOPREAL1:def 13;
A178:     now
            per cases by A36,A84,A176,XBOOLE_0:def 3;
            suppose
              p in poz;
              hence p`1 <= Gi1k`1 by A138,TOPREAL1:9;
            end;
            suppose
              p in pio;
              hence p`1 <= Gi1k`1 by A140,GOBOARD7:5;
            end;
          end;
          i1+1 <= len G by A3,NAT_1:13;
          then i1+1-1 <= len G-1 by XREAL_1:11;
          then
A179:     i1 <= len G-'1 by XREAL_0:def 2;
          len G-'1 <= len G by NAT_D:35;
          then Gi1k`1 <= G*(len G-'1,1)`1 by A6,A17,A10,A13,A21,A179,
JORDAN1A:39;
          then p`1 <= G*(len G-'1,1)`1 by A178,XXREAL_0:2;
          then p`1 <= E-bound C by A21,JORDAN8:15;
          then
A180:     p`1 <= (E-max C)`1 by EUCLID:56;
          p`1 >= (E-max C)`1 by A175,TOPREAL1:def 13;
          then p`1 = (E-max C)`1 by A180,XXREAL_0:1;
          then p = E-max C by A177,TOPREAL3:11;
          hence contradiction by A9,A36,A84,A165,A176,XBOOLE_0:3;
        end;
        suppose
          east_halfline E-max C meets L~do;
          then consider p be set such that
A181:     p in east_halfline E-max C and
A182:     p in L~do by XBOOLE_0:3;
          reconsider p as Point of TOP-REAL 2 by A181;
A183:     p in LSeg(do,Index(p,do)) by A182,JORDAN3:42;
          consider t be Nat such that
A184:     t in dom LS and
A185:     LS.t = Gij by A44,FINSEQ_2:11;
          1 <= t by A184,FINSEQ_3:27;
          then
A186:     1 < t by A46,A185,XXREAL_0:1;
          t <= len LS by A184,FINSEQ_3:27;
          then Index(Gij,LS)+1 = t by A185,A186,JORDAN3:45;
          then
A187:     len L_Cut(LS,Gij) = len LS-Index(Gij,LS) by A16,A185,JORDAN3:61;
          Index(p,do) < len do by A182,JORDAN3:41;
          then Index(p,do) < len LS-'Index(Gij,LS) by A187,XREAL_0:def 2;
          then Index(p,do)+1 <= len LS-'Index(Gij,LS) by NAT_1:13;
          then
A188:     Index(p,do) <= len LS-'Index(Gij,LS)-1 by XREAL_1:21;
A189:     do = mid(LS,Gij..LS,len LS) by A44,JORDAN1J:37;
          p in L~LS by A48,A182;
          then p in east_halfline E-max C /\ L~Cage(C,n) by A147,A181,
XBOOLE_0:def 4;
          then
A190:     p`1 = Ebo by JORDAN1A:104,PSCOMP_1:111;
A191:     Index(Gij,LS)+1 = Gij..LS by A46,A44,JORDAN1J:56;
          0+Index(Gij,LS) < len LS by A16,JORDAN3:41;
          then len LS-Index(Gij,LS) > 0 by XREAL_1:22;
          then Index(p,do) <= len LS-Index(Gij,LS)-1 by A188,XREAL_0:def 2;
          then Index(p,do) <= len LS-Gij..LS by A191;
          then Index(p,do) <= len LS-'Gij..LS by XREAL_0:def 2;
          then
A192:     Index(p,do) < len LS-'(Gij..LS)+1 by NAT_1:13;
A193:     1<=Index(p,do) by A182,JORDAN3:41;
A194:     Gij..LS<=len LS by A44,FINSEQ_4:31;
          Gij..LS <> len LS by A43,A44,FINSEQ_4:29;
          then
A195:     Gij..LS < len LS by A194,XXREAL_0:1;
A196:     1+1 <= len LS by A31,XXREAL_0:2;
          then
A197:     2 in dom LS by FINSEQ_3:27;
          set tt = Index(p,do)+(Gij..LS)-'1;
          set RC = Rotate(Cage(C,n),Emax);
A198:     E-max C in right_cell(RC,1) by JORDAN1I:9;
A199:     GoB RC = GoB Cage(C,n) by REVROT_1:28
            .= G by JORDAN1H:52;
A200:     L~RC = L~Cage(C,n) by REVROT_1:33;
          consider jj2 be Element of NAT such that
A201:     1 <= jj2 and
A202:     jj2 <= width G and
A203:     Emax = G*(len G,jj2) by JORDAN1D:29;
A204:     len G >= 4 by JORDAN8:13;
          then len G >= 1 by XXREAL_0:2;
          then
A205:     [len G,jj2] in Indices G by A201,A202,MATRIX_1:37;
A206:     len RC = len Cage(C,n) by REVROT_1:14;
          LS = RC-:Wmin by JORDAN1G:26;
          then
A207:     LSeg(LS,1) = LSeg(RC,1) by A196,SPPOL_2:9;
A208:     Emax in rng Cage(C,n) by SPRECT_2:50;
          RC is_sequence_on G by A162,REVROT_1:34;
          then consider ii,jj be Element of NAT such that
A209:     [ii,jj+1] in Indices G and
A210:     [ii,jj] in Indices G and
A211:     RC/.1 = G*(ii,jj+1) and
A212:     RC/.(1+1) = G*(ii,jj) by A158,A200,A206,A208,FINSEQ_6:98,JORDAN1I:25;
A213:     jj+1+1 <> jj;
A214:     1 <= jj by A210,MATRIX_1:39;
          RC/.1 = E-max L~RC by A200,A208,FINSEQ_6:98;
          then
A215:     ii = len G by A200,A209,A211,A203,A205,GOBOARD1:21;
          then ii-1 >= 4-1 by A204,XREAL_1:11;
          then
A216:     ii-1 >= 1 by XXREAL_0:2;
          then
A217:     1 <= ii-'1 by XREAL_0:def 2;
A218:     jj <= width G by A210,MATRIX_1:39;
          then
A219:     G*(len G,jj)`1 = Ebo by A13,A214,JORDAN1A:92;
A220:     jj+1 <= width G by A209,MATRIX_1:39;
          ii+1 <> ii;
          then
A221:     right_cell(RC,1) = cell(G,ii-'1,jj) by A158,A206,A199,A209,A210,A211
,A212,A213,GOBOARD5:def 6;
A222:     ii <= len G by A210,MATRIX_1:39;
A223:     1 <= ii by A210,MATRIX_1:39;
A224:     ii <= len G by A209,MATRIX_1:39;
A225:     1 <= jj+1 by A209,MATRIX_1:39;
          then
A226:     Ebo = G*(len G,jj+1)`1 by A13,A220,JORDAN1A:92;
A227:     1 <= ii by A209,MATRIX_1:39;
          then
A228:     ii-'1+1 = ii by XREAL_1:237;
          then
A229:     ii-'1 < len G by A224,NAT_1:13;
          then
A230:     G*(ii-'1,jj+1)`2 = G*(1,jj+1)`2 by A225,A220,A217,GOBOARD5:2
            .= G*(ii,jj+1)`2 by A227,A224,A225,A220,GOBOARD5:2;
A231:     (E-max C)`2 = p`2 by A181,TOPREAL1:def 13;
          then
A232:     p`2 <= G*(ii-'1,jj+1)`2 by A198,A224,A220,A214,A221,A228,A216,
JORDAN9:19;
A233:     G*(ii-'1,jj)`2 = G*(1,jj)`2 by A214,A218,A217,A229,GOBOARD5:2
            .= G*(ii,jj)`2 by A223,A222,A214,A218,GOBOARD5:2;
          G*(ii-'1,jj)`2 <= p`2 by A231,A198,A224,A220,A214,A221,A228,A216,
JORDAN9:19;
          then p in LSeg(RC/.1,RC/.(1+1)) by A190,A211,A212,A215,A232,A233,A230
,A219,A226,GOBOARD7:8;
          then
A234:     p in LSeg(LS,1) by A158,A207,A206,TOPREAL1:def 5;
          1<=Gij..LS by A44,FINSEQ_4:31;
          then
A235:     LSeg(mid(LS,Gij..LS,len LS),Index(p,do)) = LSeg(LS,Index(p,do)
          +(Gij..LS)-'1) by A195,A193,A192,JORDAN4:31;
          1<=Index(Gij,LS) by A16,JORDAN3:41;
          then
A236:     1+1 <= Gij..LS by A191,XREAL_1:9;
          then Index(p,do)+Gij..LS >= 1+1+1 by A193,XREAL_1:9;
          then Index(p,do)+Gij..LS-1 >= 1+1+1-1 by XREAL_1:11;
          then
A237:     tt >= 1+1 by XREAL_0:def 2;
          now
            per cases by A237,XXREAL_0:1;
            suppose
              tt > 1+1;
              then LSeg(LS,1) misses LSeg(LS,tt) by TOPREAL1:def 9;
              hence contradiction by A234,A183,A189,A235,XBOOLE_0:3;
            end;
            suppose
A238:         tt = 1+1;
              then 1+1 = Index(p,do)+(Gij..LS)-1 by XREAL_0:def 2;
              then 1+1+1 = Index(p,do)+(Gij..LS);
              then
A239:         Gij..LS = 2 by A193,A236,JORDAN1E:10;
              LSeg(LS,1) /\ LSeg(LS,tt) = {LS/.2} by A31,A238,TOPREAL1:def 8;
              then p in {LS/.2} by A234,A183,A189,A235,XBOOLE_0:def 4;
              then
A240:         p = LS/.2 by TARSKI:def 1;
              then
A241:         p in rng LS by A197,PARTFUN2:4;
              p..LS = 2 by A197,A240,FINSEQ_5:44;
              then p = Gij by A44,A239,A241,FINSEQ_5:10;
              then Gij`1 = Ebo by A240,JORDAN1G:40;
              then Gij`1 = G*(len G,j)`1 by A4,A19,A13,JORDAN1A:92;
              hence contradiction by A3,A25,A22,JORDAN1G:7;
            end;
          end;
          hence contradiction;
        end;
      end;
      then east_halfline E-max C c= (L~godo)` by SUBSET_1:43;
      then consider W be Subset of TOP-REAL 2 such that
A242: W is_a_component_of (L~godo)` and
A243: east_halfline E-max C c= W by GOBOARD9:5;
      W is not Bounded by A243,JORDAN2C:16,129;
      then W is_outside_component_of L~godo by A242,JORDAN2C:def 4;
      then W c= UBD L~godo by JORDAN2C:27;
      then
A244: east_halfline E-max C c= UBD L~godo by A243,XBOOLE_1:1;
      E-max C in east_halfline E-max C by TOPREAL1:45;
      then E-max C in UBD L~godo by A244;
      then E-max C in LeftComp godo by GOBRD14:46;
      then UA meets L~godo by A114,A153,A165,A149,A164,JORDAN1J:36;
      then
A245: UA meets (L~go \/ L~pion1) or UA meets L~do by A134,XBOOLE_1:70;
      now
        per cases by A245,XBOOLE_1:70;
        suppose
          UA meets L~go;
          then UA meets L~Cage(C,n) by A56,A130,XBOOLE_1:1,63;
          hence contradiction by A143,JORDAN10:5,XBOOLE_1:63;
        end;
        suppose
          UA meets L~pion1;
          hence contradiction by A9,A36,A84;
        end;
        suppose
          UA meets L~do;
          then UA meets L~Cage(C,n) by A48,A147,XBOOLE_1:1,63;
          hence contradiction by A143,JORDAN10:5,XBOOLE_1:63;
        end;
      end;
      hence contradiction;
    end;
    suppose
      Gij`1 = Gik`1;
      then
A246: i1 = i2 by A25,A12,JORDAN1G:7;
      then poz = {Gi1k} by RLTOPSP1:71;
      then poz c= pio by A27,ZFMISC_1:37;
      then pio \/ poz = pio by XBOOLE_1:12;
      hence contradiction by A1,A3,A4,A5,A6,A7,A8,A9,A246,JORDAN1J:59;
    end;
    suppose
      Gij`2 = Gik`2;
      then
A247: j = k by A25,A12,JORDAN1G:6;
      then pio = {Gi1k} by RLTOPSP1:71;
      then pio c= poz by A26,ZFMISC_1:37;
      then pio \/ poz = poz by XBOOLE_1:12;
      hence contradiction by A1,A2,A3,A4,A6,A7,A8,A9,A247,Th39;
    end;
  end;
  hence contradiction;
end;

theorem Th49:
  for C be Simple_closed_curve for i1,i2,j,k be Element of NAT st
1 < i2 & i2 <= i1 & i1 < len Gauge(C,n) & 1 <= j & j <= k & k <= width Gauge(C,
n) & (LSeg(Gauge(C,n)*(i1,j),Gauge(C,n)*(i1,k)) \/ LSeg(Gauge(C,n)*(i1,k),Gauge
(C,n)*(i2,k))) /\ L~Upper_Seq(C,n) = {Gauge(C,n)*(i2,k)} & (LSeg(Gauge(C,n)*(i1
  ,j),Gauge(C,n)*(i1,k)) \/ LSeg(Gauge(C,n)*(i1,k),Gauge(C,n)*(i2,k))) /\ L~
Lower_Seq(C,n) = {Gauge(C,n)*(i1,j)} holds (LSeg(Gauge(C,n)*(i1,j),Gauge(C,n)*(
  i1,k)) \/ LSeg(Gauge(C,n)*(i1,k),Gauge(C,n)*(i2,k))) meets Lower_Arc C
proof
  let C be Simple_closed_curve;
  let i1,i2,j,k be Element of NAT;
  set G = Gauge(C,n);
  set pio = LSeg(G*(i1,j),G*(i1,k));
  set poz = LSeg(G*(i1,k),G*(i2,k));
  set US = Upper_Seq(C,n);
  set LS = Lower_Seq(C,n);
  assume that
A1: 1 < i2 and
A2: i2 <= i1 and
A3: i1 < len G and
A4: 1 <= j and
A5: j <= k and
A6: k <= width G and
A7: (pio \/ poz) /\ L~US = {G*(i2,k)} and
A8: (pio \/ poz) /\ L~LS = {G*(i1,j)} and
A9: (pio \/ poz) misses Lower_Arc C;
  set Gi1k = G*(i1,k);
  set Gik = G*(i2,k);
A10: 1 <= k by A4,A5,XXREAL_0:2;
A11: i2 < len G by A2,A3,XXREAL_0:2;
  then
A12: [i2,k] in Indices G by A1,A6,A10,MATRIX_1:37;
  set Wmin = W-min L~Cage(C,n);
  set Wbo = W-bound L~Cage(C,n);
A13: len G = width G by JORDAN8:def 1;
  set go = R_Cut(US,Gik);
A14: len US >= 3 by JORDAN1E:19;
  then len US >= 1 by XXREAL_0:2;
  then 1 in dom US by FINSEQ_3:27;
  then
A15: US.1 = US/.1 by PARTFUN1:def 8
    .= Wmin by JORDAN1F:5;
  set Gij = G*(i1,j);
  set do = L_Cut(LS,Gij);
  Gij in {Gij} by TARSKI:def 1;
  then
A16: Gij in L~LS by A8,XBOOLE_0:def 4;
A17: 1 < i1 by A1,A2,XXREAL_0:2;
  then
A18: Gi1k`2 = G*(1,k)`2 by A3,A6,A10,GOBOARD5:2
    .= Gik`2 by A1,A6,A11,A10,GOBOARD5:2;
A19: j <= width G by A5,A6,XXREAL_0:2;
  then
A20: [i1,j] in Indices G by A3,A4,A17,MATRIX_1:37;
  len G >= 4 by JORDAN8:13;
  then
A21: len G >= 1 by XXREAL_0:2;
  then
A22: [len G,j] in Indices G by A4,A19,MATRIX_1:37;
A23: [1,k] in Indices G by A6,A10,A21,MATRIX_1:37;
A24: now
    assume Gik`1 = Wbo;
    then G*(1,k)`1 = G*(i2,k)`1 by A6,A10,A13,JORDAN1A:94;
    hence contradiction by A1,A12,A23,JORDAN1G:7;
  end;
A25: [i1,j] in Indices G by A3,A4,A17,A19,MATRIX_1:37;
  set pion = <*Gik,Gi1k,Gij*>;
A26: Gi1k in poz by RLTOPSP1:69;
  set LA = Lower_Arc C;
A27: Gi1k in pio by RLTOPSP1:69;
A28: [i1,k] in Indices G by A3,A6,A17,A10,MATRIX_1:37;
A29: now
    let n be Element of NAT;
    assume n in dom pion;
    then n in {1,2,3} by FINSEQ_3:1,30;
    then n = 1 or n = 2 or n = 3 by ENUMSET1:def 1;
    hence
    ex i,j be Element of NAT st [i,j] in Indices G & pion/.n = G*(i,j) by A25
,A12,A28,FINSEQ_4:27;
  end;
  Gik in {Gik} by TARSKI:def 1;
  then
A30: Gik in L~US by A7,XBOOLE_0:def 4;
  set Emax = E-max L~Cage(C,n);
A31: len LS >= 1+2 by JORDAN1E:19;
  then
A32: len LS >= 1 by XXREAL_0:2;
  then
A33: 1 in dom LS by FINSEQ_3:27;
  then
A34: LS.1 = LS/.1 by PARTFUN1:def 8
    .= Emax by JORDAN1F:6;
  len LS in dom LS by A32,FINSEQ_3:27;
  then
A35: LS.len LS = LS/.len LS by PARTFUN1:def 8
    .= Wmin by JORDAN1F:8;
  set Ebo = E-bound L~Cage(C,n);
A36: L~<*Gik,Gi1k,Gij*> = poz \/ pio by TOPREAL3:23;
  Wmin`1 = Wbo by EUCLID:56
    .= G*(1,k)`1 by A6,A10,A13,JORDAN1A:94;
  then
A37: Gik <> US.1 by A1,A12,A15,A23,JORDAN1G:7;
  then reconsider go as being_S-Seq FinSequence of TOP-REAL 2 by A30,JORDAN3:70
;
A38: Gik in rng US by A1,A6,A11,A30,A10,JORDAN1G:4,JORDAN1J:40;
  then
A39: go is_sequence_on G by JORDAN1G:4,JORDAN1J:38;
  Gi1k`1 = G*(i1,1)`1 by A3,A6,A17,A10,GOBOARD5:3
    .= Gij`1 by A3,A4,A17,A19,GOBOARD5:3;
  then
A40: Gi1k = |[Gij`1,Gik`2]| by A18,EUCLID:57;
A41: [len G,k] in Indices G by A6,A10,A21,MATRIX_1:37;
A42: len go >= 1+1 by TOPREAL1:def 10;
  Wmin`1 = Wbo by EUCLID:56
    .= G*(1,k)`1 by A6,A10,A13,JORDAN1A:94;
  then
A43: Gij <> LS.len LS by A1,A2,A23,A35,A20,JORDAN1G:7;
  then reconsider do as being_S-Seq FinSequence of TOP-REAL 2 by A16,JORDAN3:69
;
A44: Gij in rng LS by A3,A4,A17,A16,A19,JORDAN1G:5,JORDAN1J:40;
  then
A45: do is_sequence_on G by JORDAN1G:5,JORDAN1J:39;
  Emax`1 = Ebo by EUCLID:56
    .= G*(len G,k)`1 by A6,A10,A13,JORDAN1A:92;
  then
A46: Gij <> LS.1 by A3,A20,A41,A34,JORDAN1G:7;
A47: len do >= 1+1 by TOPREAL1:def 10;
  then reconsider
  do as non constant s.c.c. (being_S-Seq FinSequence of TOP-REAL 2)
  by A45,JGRAPH_1:16,JORDAN8:8;
A48: L~do c= L~LS by A16,JORDAN3:77;
  len do >= 1 by A47,XXREAL_0:2;
  then 1 in dom do by FINSEQ_3:27;
  then
A49: do/.1 = do.1 by PARTFUN1:def 8
    .= Gij by A16,JORDAN3:58;
  then
A50: LSeg(do,1) = LSeg(Gij,do/.(1+1)) by A47,TOPREAL1:def 5;
A51: {Gij} c= LSeg(do,1) /\ L~<*Gik,Gi1k,Gij*>
  proof
    let x be set;
    assume x in {Gij};
    then
A52: x = Gij by TARSKI:def 1;
    Gij in LSeg(Gi1k,Gij) by RLTOPSP1:69;
    then Gij in LSeg(Gik,Gi1k) \/ LSeg(Gi1k,Gij) by XBOOLE_0:def 3;
    then
A53: Gij in L~<*Gik,Gi1k,Gij*> by SPRECT_1:10;
    Gij in LSeg(do,1) by A50,RLTOPSP1:69;
    hence thesis by A52,A53,XBOOLE_0:def 4;
  end;
  LSeg(do,1) c= L~do by TOPREAL3:26;
  then LSeg(do,1) c= L~LS by A48,XBOOLE_1:1;
  then LSeg(do,1) /\ L~<*Gik,Gi1k,Gij*> c= {Gij} by A8,A36,XBOOLE_1:26;
  then
A54: L~<*Gik,Gi1k,Gij*> /\ LSeg(do,1) = {Gij} by A51,XBOOLE_0:def 10;
A55: rng do c= L~do by A47,SPPOL_2:18;
  reconsider go as non constant s.c.c. (being_S-Seq FinSequence of TOP-REAL 2)
  by A42,A39,JGRAPH_1:16,JORDAN8:8;
A56: L~go c= L~US by A30,JORDAN3:76;
A57: len go > 1 by A42,NAT_1:13;
  then
A58: len go in dom go by FINSEQ_3:27;
  then
A59: go/.len go = go.len go by PARTFUN1:def 8
    .= Gik by A30,JORDAN3:59;
  reconsider m = len go - 1 as Element of NAT by A58,FINSEQ_3:28;
A60: m+1 = len go;
  then
A61: len go-'1 = m by NAT_D:34;
  m >= 1 by A42,XREAL_1:21;
  then
A62: LSeg(go,m) = LSeg(go/.m,Gik) by A59,A60,TOPREAL1:def 5;
A63: {Gik} c= LSeg(go,m) /\ L~<*Gik,Gi1k,Gij*>
  proof
    let x be set;
    assume x in {Gik};
    then
A64: x = Gik by TARSKI:def 1;
    Gik in LSeg(Gik,Gi1k) by RLTOPSP1:69;
    then Gik in LSeg(Gik,Gi1k) \/ LSeg(Gi1k,Gij) by XBOOLE_0:def 3;
    then
A65: Gik in L~<*Gik,Gi1k,Gij*> by SPRECT_1:10;
    Gik in LSeg(go,m) by A62,RLTOPSP1:69;
    hence thesis by A64,A65,XBOOLE_0:def 4;
  end;
  LSeg(go,m) c= L~go by TOPREAL3:26;
  then LSeg(go,m) c= L~US by A56,XBOOLE_1:1;
  then LSeg(go,m) /\ L~<*Gik,Gi1k,Gij*> c= {Gik} by A7,A36,XBOOLE_1:26;
  then
A66: LSeg(go,m) /\ L~<*Gik,Gi1k,Gij*> = {Gik} by A63,XBOOLE_0:def 10;
A67: go/.1 = US/.1 by A30,SPRECT_3:39
    .= Wmin by JORDAN1F:5;
  then
A68: Wmin in rng go by FINSEQ_6:46;
A69: LS.1 = LS/.1 by A33,PARTFUN1:def 8
    .= Emax by JORDAN1F:6;
A70: L~go /\ L~do c= {go/.1}
  proof
    let x be set;
    assume
A71: x in L~go /\ L~do;
    then
A72: x in L~do by XBOOLE_0:def 4;
A73: now
      assume x = Emax;
      then
A74:  Emax = Gij by A16,A69,A72,JORDAN1E:11;
      G*(len G,j)`1 = Ebo by A4,A19,A13,JORDAN1A:92;
      then Emax`1 <> Ebo by A3,A25,A22,A74,JORDAN1G:7;
      hence contradiction by EUCLID:56;
    end;
    x in L~go by A71,XBOOLE_0:def 4;
    then x in L~US /\ L~LS by A56,A48,A72,XBOOLE_0:def 4;
    then x in {Wmin,Emax} by JORDAN1E:20;
    then x = Wmin or x = Emax by TARSKI:def 2;
    hence thesis by A67,A73,TARSKI:def 1;
  end;
  set W2 = go/.2;
A75: 2 in dom go by A42,FINSEQ_3:27;
  go = mid(US,1,Gik..US) by A38,JORDAN1G:57
    .= US|(Gik..US) by A38,FINSEQ_4:31,FINSEQ_6:122;
  then
A76: W2 = US/.2 by A75,FINSEQ_4:85;
A77: rng go c= L~go by A42,SPPOL_2:18;
A78: go/.1 = LS/.len LS by A67,JORDAN1F:8
    .= do/.len do by A16,JORDAN1J:35;
  {go/.1} c= L~go /\ L~do
  proof
    let x be set;
    assume x in {go/.1};
    then
A79: x = go/.1 by TARSKI:def 1;
    then
A80: x in rng go by FINSEQ_6:46;
    x in rng do by A78,A79,REVROT_1:3;
    hence thesis by A77,A55,A80,XBOOLE_0:def 4;
  end;
  then
A81: L~go /\ L~do = {go/.1} by A70,XBOOLE_0:def 10;
  now
    per cases;
    suppose
      Gij`1 <> Gik`1 & Gij`2 <> Gik`2;
      then pion is being_S-Seq by A40,TOPREAL3:42;
      then consider pion1 be FinSequence of TOP-REAL 2 such that
A82:  pion1 is_sequence_on G and
A83:  pion1 is being_S-Seq and
A84:  L~pion = L~pion1 and
A85:  pion/.1 = pion1/.1 and
A86:  pion/.len pion = pion1/.len pion1 and
A87:  len pion <= len pion1 by A29,GOBOARD3:2;
      reconsider pion1 as being_S-Seq FinSequence of TOP-REAL 2 by A83;
A88:  (go^'pion1)/.len (go^'pion1) = pion/.len pion by A86,GRAPH_2:58
        .= pion/.3 by FINSEQ_1:62
        .= do/.1 by A49,FINSEQ_4:27;
A89:  go/.len go = pion1/.1 by A59,A85,FINSEQ_4:27;
A90:  L~go /\ L~pion1 c= {pion1/.1}
      proof
        let x be set;
        assume
A91:    x in L~go /\ L~pion1;
        then
A92:    x in L~pion1 by XBOOLE_0:def 4;
        x in L~go by A91,XBOOLE_0:def 4;
        hence thesis by A7,A36,A59,A56,A84,A89,A92,XBOOLE_0:def 4;
      end;
      len pion1 >= 2+1 by A87,FINSEQ_1:62;
      then
A93:  len pion1 > 1+1 by NAT_1:13;
      then
A94:  rng pion1 c= L~pion1 by SPPOL_2:18;
      {pion1/.1} c= L~go /\ L~pion1
      proof
        let x be set;
        assume x in {pion1/.1};
        then
A95:    x = pion1/.1 by TARSKI:def 1;
        then
A96:    x in rng pion1 by FINSEQ_6:46;
        x in rng go by A89,A95,REVROT_1:3;
        hence thesis by A77,A94,A96,XBOOLE_0:def 4;
      end;
      then
A97:  L~go /\ L~pion1 = {pion1/.1} by A90,XBOOLE_0:def 10;
      then
A98:  (go^'pion1) is s.n.c. by A89,JORDAN1J:54;
A99:  {Gik} c= LSeg(go,m) /\ LSeg(pion1,1)
      proof
        let x be set;
        assume x in {Gik};
        then
A100:   x = Gik by TARSKI:def 1;
A101:   Gik in LSeg(go,m) by A62,RLTOPSP1:69;
        Gik in LSeg(pion1,1) by A59,A89,A93,TOPREAL1:27;
        hence thesis by A100,A101,XBOOLE_0:def 4;
      end;
      LSeg(pion1,1) c= L~pion by A84,TOPREAL3:26;
      then LSeg(go,len go-'1) /\ LSeg(pion1,1) c={Gik} by A61,A66,XBOOLE_1:27;
      then LSeg(go,len go-'1) /\ LSeg(pion1,1) = { go/.len go } by A59,A61,A99,
XBOOLE_0:def 10;
      then
A102: go^'pion1 is unfolded by A89,TOPREAL8:34;
      len (go^'pion1) >= len go by TOPREAL8:7;
      then
A103: len (go^'pion1) >= 1+1 by A42,XXREAL_0:2;
      then
A104: len (go^'pion1) > 1+0 by NAT_1:13;
A105: pion/.len pion = pion/.3 by FINSEQ_1:62
        .= do/.1 by A49,FINSEQ_4:27;
A106: {pion1/.len pion1} c= L~do /\ L~pion1
      proof
        let x be set;
        assume x in {pion1/.len pion1};
        then
A107:   x = pion1/.len pion1 by TARSKI:def 1;
        then
A108:   x in rng pion1 by REVROT_1:3;
        x in rng do by A86,A105,A107,FINSEQ_6:46;
        hence thesis by A55,A94,A108,XBOOLE_0:def 4;
      end;
      L~do /\ L~pion1 c= {pion1/.len pion1}
      proof
        let x be set;
        assume
A109:   x in L~do /\ L~pion1;
        then
A110:   x in L~pion1 by XBOOLE_0:def 4;
        x in L~do by A109,XBOOLE_0:def 4;
        hence thesis by A8,A36,A49,A48,A84,A86,A105,A110,XBOOLE_0:def 4;
      end;
      then
A111: L~do /\ L~pion1 = {pion1/.len pion1} by A106,XBOOLE_0:def 10;
A112: L~(go^'pion1) /\ L~do = (L~go \/ L~pion1) /\ L~do by A89,TOPREAL8:35
        .= {go/.1} \/ {do/.1} by A81,A86,A105,A111,XBOOLE_1:23
        .= {(go^'pion1)/.1} \/ {do/.1} by GRAPH_2:57
        .= {(go^'pion1)/.1,do/.1} by ENUMSET1:41;
A113: LA is_an_arc_of E-max C,W-min C by JORDAN6:def 9;
      then
A114: LA is connected by JORDAN6:11;
      set godo = go^'pion1^'do;
A115: do/.len do = (go^'pion1)/.1 by A78,GRAPH_2:57;
A116: go^'pion1 is_sequence_on G by A39,A82,A89,TOPREAL8:12;
      then
A117: godo is_sequence_on G by A45,A88,TOPREAL8:12;
A118: len pion1-1 >= 1 by A93,XREAL_1:21;
      then
A119: len pion1-'1 = len pion1-1 by XREAL_0:def 2;
A120: {Gij} c= LSeg(pion1,len pion1-'1) /\ LSeg(do,1)
      proof
        let x be set;
        assume x in {Gij};
        then
A121:   x = Gij by TARSKI:def 1;
        pion1/.(len pion1-'1+1) = pion/.3 by A86,A119,FINSEQ_1:62
          .= Gij by FINSEQ_4:27;
        then
A122:   Gij in LSeg(pion1,len pion1-'1) by A118,A119,TOPREAL1:27;
        Gij in LSeg(do,1) by A50,RLTOPSP1:69;
        hence thesis by A121,A122,XBOOLE_0:def 4;
      end;
      LSeg(pion1,len pion1-'1) c= L~pion by A84,TOPREAL3:26;
      then LSeg(pion1,len pion1-'1) /\ LSeg(do,1) c= {Gij} by A54,XBOOLE_1:27;
      then
A123: LSeg(pion1,len pion1-'1) /\ LSeg(do,1) = {Gij} by A120,XBOOLE_0:def 10;
      len pion1-1+1 <= len pion1;
      then
A124: len pion1-'1 < len pion1 by A119,NAT_1:13;
      len pion1 >= 2+1 by A87,FINSEQ_1:62;
      then
A125: len pion1-2 >= 0 by XREAL_1:21;
      then len pion1-'2+1 = len pion1-2+1 by XREAL_0:def 2
        .= len pion1-'1 by A118,XREAL_0:def 2;
      then
A126: LSeg(go^'pion1,len go+(len pion1-'2)) /\ LSeg(do,1) = {(go^'pion1)
      /.len (go^'pion1)} by A49,A89,A88,A124,A123,TOPREAL8:31;
      rng go /\ rng pion1 c= {pion1/.1} by A77,A94,A97,XBOOLE_1:27;
      then
A127: go^'pion1 is one-to-one by JORDAN1J:55;
      len (go^'pion1)+1-1 = len go+len pion1-1 by GRAPH_2:13;
      then len (go^'pion1)-1 = len go + (len pion1-2)
        .= len go + (len pion1-'2) by A125,XREAL_0:def 2;
      then
A128: len (go^'pion1)-'1 = len go + (len pion1-'2) by XREAL_0:def 2;
A129: L~Cage(C,n) = L~US \/ L~LS by JORDAN1E:17;
      then
A130: L~US c= L~Cage(C,n) by XBOOLE_1:7;
      then
A131: L~go c=L~Cage(C,n) by A56,XBOOLE_1:1;
A132: len godo >= len (go^'pion1) by TOPREAL8:7;
      then
A133: 1+1 <= len godo by A103,XXREAL_0:2;
      (go^'pion1) is non trivial by A103,REALSET1:13;
      then reconsider
      godo as non constant standard special_circular_sequence by A133,A88,A117
,A102,A128,A126,A98,A127,A112,A115,JORDAN8:7,8,TOPREAL8:11,33,34;
A134: L~godo = L~(go^'pion1) \/ L~do by A88,TOPREAL8:35
        .= L~go \/ L~pion1 \/ L~do by A89,TOPREAL8:35;
A135: now
        assume
A136:   Gik..US <= 1;
        Gik..US >= 1 by A38,FINSEQ_4:31;
        then Gik..US = 1 by A136,XXREAL_0:1;
        then Gik = US/.1 by A38,FINSEQ_5:41;
        hence contradiction by A15,A37,JORDAN1F:5;
      end;
A137: US is_sequence_on G by JORDAN1G:4;
A138: Gik`1 <= Gi1k`1 by A1,A2,A3,A6,A10,JORDAN1A:39;
      then
A139: W-bound poz = Gik`1 by SPRECT_1:62;
A140: Gi1k`1 = G*(i1,1)`1 by A3,A6,A17,A10,GOBOARD5:3
        .= Gij`1 by A3,A4,A17,A19,GOBOARD5:3;
      then
A141: W-bound pio = Gij`1 by SPRECT_1:62;
      W-bound (poz \/ pio) = min(W-bound poz, W-bound pio) by SPRECT_1:54
        .= Gik`1 by A140,A138,A139,A141,XXREAL_0:def 9;
      then
A142: W-bound L~pion1 = Gik`1 by A84,TOPREAL3:23;
A143: LA c= C by JORDAN6:76;
      Gik`1 >= Wbo by A30,A130,PSCOMP_1:71;
      then
A144: Gik`1 > Wbo by A24,XXREAL_0:1;
A145: len US >= 2 by A14,XXREAL_0:2;
A146: L~go \/ L~do is compact by COMPTS_1:19;
A147: L~LS c= L~Cage(C,n) by A129,XBOOLE_1:7;
      then
A148: L~do c=L~Cage(C,n) by A48,XBOOLE_1:1;
A149: right_cell(godo,1,G)\L~godo c= RightComp godo by A133,A117,JORDAN9:29;
      2 in dom godo by A133,FINSEQ_3:27;
      then
A150: godo/.2 in rng godo by PARTFUN2:4;
A151: rng godo c= L~godo by A103,A132,SPPOL_2:18,XXREAL_0:2;
A152: godo/.1 = (go^'pion1)/.1 by GRAPH_2:57
        .= Wmin by A67,GRAPH_2:57;
A153: W-min C in LA by A113,TOPREAL1:4;
A154: W-min C in C by SPRECT_1:15;
A155: now
        assume W-min C in L~godo;
        then
A156:   W-min C in L~go \/ L~pion1 or W-min C in L~do by A134,XBOOLE_0:def 3;
        per cases by A156,XBOOLE_0:def 3;
        suppose
          W-min C in L~go;
          then C meets L~Cage(C,n) by A131,A154,XBOOLE_0:3;
          hence contradiction by JORDAN10:5;
        end;
        suppose
          W-min C in L~pion1;
          hence contradiction by A9,A36,A84,A153,XBOOLE_0:3;
        end;
        suppose
          W-min C in L~do;
          then C meets L~Cage(C,n) by A148,A154,XBOOLE_0:3;
          hence contradiction by JORDAN10:5;
        end;
      end;
A157: Wmin`1 = Wbo by EUCLID:56;
      set ff = Rotate(Cage(C,n),Wmin);
A158: 1+1 <= len Cage(C,n) by GOBOARD7:36,XXREAL_0:2;
      Wmin in rng Cage(C,n) by SPRECT_2:47;
      then
A159: ff/.1 = Wmin by FINSEQ_6:98;
A160: L~ff = L~Cage(C,n) by REVROT_1:33;
      then (W-max L~ff)..ff > 1 by A159,SPRECT_5:23;
      then (N-min L~ff)..ff > 1 by A159,A160,SPRECT_5:24,XXREAL_0:2;
      then (N-max L~ff)..ff > 1 by A159,A160,SPRECT_5:25,XXREAL_0:2;
      then
A161: Emax..ff > 1 by A159,A160,SPRECT_5:26,XXREAL_0:2;
A162: Cage(C,n) is_sequence_on G by JORDAN9:def 1;
      then
A163: ff is_sequence_on G by REVROT_1:34;
      1+1 <= len Rotate(Cage(C,n),Wmin) by GOBOARD7:36,XXREAL_0:2;
      then right_cell(Rotate(Cage(C,n),Wmin),1) = right_cell(ff,1,GoB ff) by
JORDAN1H:29
        .= right_cell(ff,1,GoB Cage(C,n)) by REVROT_1:28
        .= right_cell(ff,1,G) by JORDAN1H:52
        .= right_cell(ff-:Emax,1,G) by A161,A163,JORDAN1J:53
        .= right_cell(US,1,G) by JORDAN1E:def 1
        .= right_cell(R_Cut(US,Gik),1,G) by A38,A137,A135,JORDAN1J:52
        .= right_cell(go^'pion1,1,G) by A57,A116,JORDAN1J:51
        .= right_cell(godo,1,G) by A104,A117,JORDAN1J:51;
      then W-min C in right_cell(godo,1,G) by JORDAN1I:8;
      then
A164: W-min C in right_cell(godo,1,G)\L~godo by A155,XBOOLE_0:def 5;
A165: E-max C in LA by A113,TOPREAL1:4;
      Wmin in L~go \/ L~do by A77,A68,XBOOLE_0:def 3;
      then
A166: W-min (L~go \/ L~do) = Wmin by A131,A148,A146,JORDAN1J:21,XBOOLE_1:8;
      (W-min (L~go \/ L~do))`1 = W-bound (L~go \/ L~do) by EUCLID:56;
      then W-min (L~go\/L~do\/L~pion1) = W-min (L~go \/ L~do) by A142,A146,A166
,A157,A144,JORDAN1J:33;
      then
A167: W-min L~godo = Wmin by A134,A166,XBOOLE_1:4;
      godo/.2 = (go^'pion1)/.2 by A103,GRAPH_2:61
        .= US/.2 by A42,A76,GRAPH_2:61
        .= (US^'LS)/.2 by A145,GRAPH_2:61
        .= Rotate(Cage(C,n),Wmin)/.2 by JORDAN1E:15;
      then godo/.2 in W-most L~Cage(C,n) by JORDAN1I:27;
      then (godo/.2)`1 = (W-min L~godo)`1 by A167,PSCOMP_1:88
        .= W-bound L~godo by EUCLID:56;
      then godo/.2 in W-most L~godo by A151,A150,SPRECT_2:16;
      then Rotate(godo,W-min L~godo)/.2 in W-most L~godo by A152,A167,
FINSEQ_6:95;
      then reconsider godo as clockwise_oriented non constant standard
      special_circular_sequence by JORDAN1I:27;
      len US in dom US by FINSEQ_5:6;
      then
A168: US.len US = US/.len US by PARTFUN1:def 8
        .= Emax by JORDAN1F:7;
A169: east_halfline E-max C misses L~go
      proof
        assume east_halfline E-max C meets L~go;
        then consider p be set such that
A170:   p in east_halfline E-max C and
A171:   p in L~go by XBOOLE_0:3;
        reconsider p as Point of TOP-REAL 2 by A170;
        p in L~US by A56,A171;
        then p in east_halfline E-max C /\ L~Cage(C,n) by A130,A170,
XBOOLE_0:def 4;
        then
A172:   p`1 = Ebo by JORDAN1A:104,PSCOMP_1:111;
        then
A173:   p = Emax by A56,A171,JORDAN1J:46;
        then Emax = Gik by A30,A168,A171,JORDAN1J:43;
        then Gik`1 = G*(len G,k)`1 by A6,A10,A13,A172,A173,JORDAN1A:92;
        hence contradiction by A2,A3,A12,A41,JORDAN1G:7;
      end;
      now
        assume east_halfline E-max C meets L~godo;
        then
A174:   east_halfline E-max C meets (L~go \/ L~pion1) or east_halfline
        E-max C meets L~do by A134,XBOOLE_1:70;
        per cases by A174,XBOOLE_1:70;
        suppose
          east_halfline E-max C meets L~go;
          hence contradiction by A169;
        end;
        suppose
          east_halfline E-max C meets L~pion1;
          then consider p be set such that
A175:     p in east_halfline E-max C and
A176:     p in L~pion1 by XBOOLE_0:3;
          reconsider p as Point of TOP-REAL 2 by A175;
A177:     p`2 = (E-max C)`2 by A175,TOPREAL1:def 13;
A178:     now
            per cases by A36,A84,A176,XBOOLE_0:def 3;
            suppose
              p in poz;
              hence p`1 <= Gi1k`1 by A138,TOPREAL1:9;
            end;
            suppose
              p in pio;
              hence p`1 <= Gi1k`1 by A140,GOBOARD7:5;
            end;
          end;
          i1+1 <= len G by A3,NAT_1:13;
          then i1+1-1 <= len G-1 by XREAL_1:11;
          then
A179:     i1 <= len G-'1 by XREAL_0:def 2;
          len G-'1 <= len G by NAT_D:35;
          then Gi1k`1 <= G*(len G-'1,1)`1 by A6,A17,A10,A13,A21,A179,
JORDAN1A:39;
          then p`1 <= G*(len G-'1,1)`1 by A178,XXREAL_0:2;
          then p`1 <= E-bound C by A21,JORDAN8:15;
          then
A180:     p`1 <= (E-max C)`1 by EUCLID:56;
          p`1 >= (E-max C)`1 by A175,TOPREAL1:def 13;
          then p`1 = (E-max C)`1 by A180,XXREAL_0:1;
          then p = E-max C by A177,TOPREAL3:11;
          hence contradiction by A9,A36,A84,A165,A176,XBOOLE_0:3;
        end;
        suppose
          east_halfline E-max C meets L~do;
          then consider p be set such that
A181:     p in east_halfline E-max C and
A182:     p in L~do by XBOOLE_0:3;
          reconsider p as Point of TOP-REAL 2 by A181;
A183:     p in LSeg(do,Index(p,do)) by A182,JORDAN3:42;
          consider t be Nat such that
A184:     t in dom LS and
A185:     LS.t = Gij by A44,FINSEQ_2:11;
          1 <= t by A184,FINSEQ_3:27;
          then
A186:     1 < t by A46,A185,XXREAL_0:1;
          t <= len LS by A184,FINSEQ_3:27;
          then Index(Gij,LS)+1 = t by A185,A186,JORDAN3:45;
          then
A187:     len L_Cut(LS,Gij) = len LS-Index(Gij,LS) by A16,A185,JORDAN3:61;
          Index(p,do) < len do by A182,JORDAN3:41;
          then Index(p,do) < len LS-'Index(Gij,LS) by A187,XREAL_0:def 2;
          then Index(p,do)+1 <= len LS-'Index(Gij,LS) by NAT_1:13;
          then
A188:     Index(p,do) <= len LS-'Index(Gij,LS)-1 by XREAL_1:21;
A189:     do = mid(LS,Gij..LS,len LS) by A44,JORDAN1J:37;
          p in L~LS by A48,A182;
          then p in east_halfline E-max C /\ L~Cage(C,n) by A147,A181,
XBOOLE_0:def 4;
          then
A190:     p`1 = Ebo by JORDAN1A:104,PSCOMP_1:111;
A191:     Index(Gij,LS)+1 = Gij..LS by A46,A44,JORDAN1J:56;
          0+Index(Gij,LS) < len LS by A16,JORDAN3:41;
          then len LS-Index(Gij,LS) > 0 by XREAL_1:22;
          then Index(p,do) <= len LS-Index(Gij,LS)-1 by A188,XREAL_0:def 2;
          then Index(p,do) <= len LS-Gij..LS by A191;
          then Index(p,do) <= len LS-'Gij..LS by XREAL_0:def 2;
          then
A192:     Index(p,do) < len LS-'(Gij..LS)+1 by NAT_1:13;
A193:     1<=Index(p,do) by A182,JORDAN3:41;
A194:     Gij..LS<=len LS by A44,FINSEQ_4:31;
          Gij..LS <> len LS by A43,A44,FINSEQ_4:29;
          then
A195:     Gij..LS < len LS by A194,XXREAL_0:1;
A196:     1+1 <= len LS by A31,XXREAL_0:2;
          then
A197:     2 in dom LS by FINSEQ_3:27;
          set tt = Index(p,do)+(Gij..LS)-'1;
          set RC = Rotate(Cage(C,n),Emax);
A198:     E-max C in right_cell(RC,1) by JORDAN1I:9;
A199:     GoB RC = GoB Cage(C,n) by REVROT_1:28
            .= G by JORDAN1H:52;
A200:     L~RC = L~Cage(C,n) by REVROT_1:33;
          consider jj2 be Element of NAT such that
A201:     1 <= jj2 and
A202:     jj2 <= width G and
A203:     Emax = G*(len G,jj2) by JORDAN1D:29;
A204:     len G >= 4 by JORDAN8:13;
          then len G >= 1 by XXREAL_0:2;
          then
A205:     [len G,jj2] in Indices G by A201,A202,MATRIX_1:37;
A206:     len RC = len Cage(C,n) by REVROT_1:14;
          LS = RC-:Wmin by JORDAN1G:26;
          then
A207:     LSeg(LS,1) = LSeg(RC,1) by A196,SPPOL_2:9;
A208:     Emax in rng Cage(C,n) by SPRECT_2:50;
          RC is_sequence_on G by A162,REVROT_1:34;
          then consider ii,jj be Element of NAT such that
A209:     [ii,jj+1] in Indices G and
A210:     [ii,jj] in Indices G and
A211:     RC/.1 = G*(ii,jj+1) and
A212:     RC/.(1+1) = G*(ii,jj) by A158,A200,A206,A208,FINSEQ_6:98,JORDAN1I:25;
A213:     jj+1+1 <> jj;
A214:     1 <= jj by A210,MATRIX_1:39;
          RC/.1 = E-max L~RC by A200,A208,FINSEQ_6:98;
          then
A215:     ii = len G by A200,A209,A211,A203,A205,GOBOARD1:21;
          then ii-1 >= 4-1 by A204,XREAL_1:11;
          then
A216:     ii-1 >= 1 by XXREAL_0:2;
          then
A217:     1 <= ii-'1 by XREAL_0:def 2;
A218:     jj <= width G by A210,MATRIX_1:39;
          then
A219:     G*(len G,jj)`1 = Ebo by A13,A214,JORDAN1A:92;
A220:     jj+1 <= width G by A209,MATRIX_1:39;
          ii+1 <> ii;
          then
A221:     right_cell(RC,1) = cell(G,ii-'1,jj) by A158,A206,A199,A209,A210,A211
,A212,A213,GOBOARD5:def 6;
A222:     ii <= len G by A210,MATRIX_1:39;
A223:     1 <= ii by A210,MATRIX_1:39;
A224:     ii <= len G by A209,MATRIX_1:39;
A225:     1 <= jj+1 by A209,MATRIX_1:39;
          then
A226:     Ebo = G*(len G,jj+1)`1 by A13,A220,JORDAN1A:92;
A227:     1 <= ii by A209,MATRIX_1:39;
          then
A228:     ii-'1+1 = ii by XREAL_1:237;
          then
A229:     ii-'1 < len G by A224,NAT_1:13;
          then
A230:     G*(ii-'1,jj+1)`2 = G*(1,jj+1)`2 by A225,A220,A217,GOBOARD5:2
            .= G*(ii,jj+1)`2 by A227,A224,A225,A220,GOBOARD5:2;
A231:     (E-max C)`2 = p`2 by A181,TOPREAL1:def 13;
          then
A232:     p`2 <= G*(ii-'1,jj+1)`2 by A198,A224,A220,A214,A221,A228,A216,
JORDAN9:19;
A233:     G*(ii-'1,jj)`2 = G*(1,jj)`2 by A214,A218,A217,A229,GOBOARD5:2
            .= G*(ii,jj)`2 by A223,A222,A214,A218,GOBOARD5:2;
          G*(ii-'1,jj)`2 <= p`2 by A231,A198,A224,A220,A214,A221,A228,A216,
JORDAN9:19;
          then p in LSeg(RC/.1,RC/.(1+1)) by A190,A211,A212,A215,A232,A233,A230
,A219,A226,GOBOARD7:8;
          then
A234:     p in LSeg(LS,1) by A158,A207,A206,TOPREAL1:def 5;
          1<=Gij..LS by A44,FINSEQ_4:31;
          then
A235:     LSeg(mid(LS,Gij..LS,len LS),Index(p,do)) = LSeg(LS,Index(p,do)
          +(Gij..LS)-'1) by A195,A193,A192,JORDAN4:31;
          1<=Index(Gij,LS) by A16,JORDAN3:41;
          then
A236:     1+1 <= Gij..LS by A191,XREAL_1:9;
          then Index(p,do)+Gij..LS >= 1+1+1 by A193,XREAL_1:9;
          then Index(p,do)+Gij..LS-1 >= 1+1+1-1 by XREAL_1:11;
          then
A237:     tt >= 1+1 by XREAL_0:def 2;
          now
            per cases by A237,XXREAL_0:1;
            suppose
              tt > 1+1;
              then LSeg(LS,1) misses LSeg(LS,tt) by TOPREAL1:def 9;
              hence contradiction by A234,A183,A189,A235,XBOOLE_0:3;
            end;
            suppose
A238:         tt = 1+1;
              then 1+1 = Index(p,do)+(Gij..LS)-1 by XREAL_0:def 2;
              then 1+1+1 = Index(p,do)+(Gij..LS);
              then
A239:         Gij..LS = 2 by A193,A236,JORDAN1E:10;
              LSeg(LS,1) /\ LSeg(LS,tt) = {LS/.2} by A31,A238,TOPREAL1:def 8;
              then p in {LS/.2} by A234,A183,A189,A235,XBOOLE_0:def 4;
              then
A240:         p = LS/.2 by TARSKI:def 1;
              then
A241:         p in rng LS by A197,PARTFUN2:4;
              p..LS = 2 by A197,A240,FINSEQ_5:44;
              then p = Gij by A44,A239,A241,FINSEQ_5:10;
              then Gij`1 = Ebo by A240,JORDAN1G:40;
              then Gij`1 = G*(len G,j)`1 by A4,A19,A13,JORDAN1A:92;
              hence contradiction by A3,A25,A22,JORDAN1G:7;
            end;
          end;
          hence contradiction;
        end;
      end;
      then east_halfline E-max C c= (L~godo)` by SUBSET_1:43;
      then consider W be Subset of TOP-REAL 2 such that
A242: W is_a_component_of (L~godo)` and
A243: east_halfline E-max C c= W by GOBOARD9:5;
      W is not Bounded by A243,JORDAN2C:16,129;
      then W is_outside_component_of L~godo by A242,JORDAN2C:def 4;
      then W c= UBD L~godo by JORDAN2C:27;
      then
A244: east_halfline E-max C c= UBD L~godo by A243,XBOOLE_1:1;
      E-max C in east_halfline E-max C by TOPREAL1:45;
      then E-max C in UBD L~godo by A244;
      then E-max C in LeftComp godo by GOBRD14:46;
      then LA meets L~godo by A114,A153,A165,A149,A164,JORDAN1J:36;
      then
A245: LA meets (L~go \/ L~pion1) or LA meets L~do by A134,XBOOLE_1:70;
      now
        per cases by A245,XBOOLE_1:70;
        suppose
          LA meets L~go;
          then LA meets L~Cage(C,n) by A56,A130,XBOOLE_1:1,63;
          hence contradiction by A143,JORDAN10:5,XBOOLE_1:63;
        end;
        suppose
          LA meets L~pion1;
          hence contradiction by A9,A36,A84;
        end;
        suppose
          LA meets L~do;
          then LA meets L~Cage(C,n) by A48,A147,XBOOLE_1:1,63;
          hence contradiction by A143,JORDAN10:5,XBOOLE_1:63;
        end;
      end;
      hence contradiction;
    end;
    suppose
      Gij`1 = Gik`1;
      then
A246: i1 = i2 by A25,A12,JORDAN1G:7;
      then poz = {Gi1k} by RLTOPSP1:71;
      then poz c= pio by A27,ZFMISC_1:37;
      then pio \/ poz = pio by XBOOLE_1:12;
      hence contradiction by A1,A3,A4,A5,A6,A7,A8,A9,A246,JORDAN1J:58;
    end;
    suppose
      Gij`2 = Gik`2;
      then
A247: j = k by A25,A12,JORDAN1G:6;
      then pio = {Gi1k} by RLTOPSP1:71;
      then pio c= poz by A26,ZFMISC_1:37;
      then pio \/ poz = poz by XBOOLE_1:12;
      hence contradiction by A1,A2,A3,A4,A6,A7,A8,A9,A247,Th38;
    end;
  end;
  hence contradiction;
end;

theorem Th50:
  for C be Simple_closed_curve for i1,i2,j,k be Element of NAT
holds 1 < i1 & i1 < len Gauge(C,n+1) & 1 < i2 & i2 < len Gauge(C,n+1) & 1 <= j
& j <= k & k <= width Gauge(C,n+1) & Gauge(C,n+1)*(i1,k) in Upper_Arc L~Cage(C,
n+1) & Gauge(C,n+1)*(i2,j) in Lower_Arc L~Cage(C,n+1) implies LSeg(Gauge(C,n+1)
  *(i2,j),Gauge(C,n+1)*(i2,k)) \/ LSeg(Gauge(C,n+1)*(i2,k),Gauge(C,n+1)*(i1,k))
  meets Upper_Arc C
proof
  let C be Simple_closed_curve;
  let i1,i2,j,k be Element of NAT;
  set G=Gauge(C,n+1);
  assume that
A1: 1 < i1 and
A2: i1 < len G and
A3: 1 < i2 and
A4: i2 < len G and
A5: 1 <= j and
A6: j <= k and
A7: k <= width G and
A8: G*(i1,k) in Upper_Arc L~Cage(C,n+1) and
A9: G*(i2,j) in Lower_Arc L~Cage(C,n+1);
A10: 1 <= k by A5,A6,XXREAL_0:2;
  then
A11: [i2,k] in Indices G by A3,A4,A7,MATRIX_1:37;
A12: [i1,k] in Indices G by A1,A2,A7,A10,MATRIX_1:37;
  G*(i2,k)`2 = G*(1,k)`2 by A3,A4,A7,A10,GOBOARD5:2
    .= G*(i1,k)`2 by A1,A2,A7,A10,GOBOARD5:2;
  then
A13: LSeg(G*(i2,k),G*(i1,k)) is horizontal by SPPOL_1:36;
A14: Lower_Arc L~Cage(C,n+1) = L~Lower_Seq(C,n+1) by JORDAN1G:64;
A15: j <= width G by A6,A7,XXREAL_0:2;
  then
A16: [i2,j] in Indices G by A3,A4,A5,MATRIX_1:37;
  G*(i2,j)`1 = G*(i2,1)`1 by A3,A4,A5,A15,GOBOARD5:3
    .= G*(i2,k)`1 by A3,A4,A7,A10,GOBOARD5:3;
  then
A17: LSeg(G*(i2,j),G*(i2,k)) is vertical by SPPOL_1:37;
A18: Upper_Arc L~Cage(C,n+1) = L~Upper_Seq(C,n+1) by JORDAN1G:63;
A19: [i2,k] in Indices G by A3,A4,A7,A10,MATRIX_1:37;
  now
    per cases;
    suppose
A20:  LSeg(G*(i2,j),G*(i2,k)) meets Upper_Arc L~Cage(C,n+1);
      set X = LSeg(G*(i2,j),G*(i2,k)) /\ L~Upper_Seq(C,n+1);
      ex x be set st x in LSeg(G*(i2,j),G*(i2,k)) & x in L~Upper_Seq(C,n+
      1) by A18,A20,XBOOLE_0:3;
      then reconsider X1=X as non empty compact Subset of TOP-REAL 2 by
XBOOLE_0:def 4;
      consider pp be set such that
A21:  pp in S-most X1 by XBOOLE_0:def 1;
      reconsider pp as Point of TOP-REAL 2 by A21;
A22:  pp in X by A21,XBOOLE_0:def 4;
      then
A23:  pp in L~Upper_Seq(C,n+1) by XBOOLE_0:def 4;
A24:  pp in LSeg(G*(i2,j),G*(i2,k)) by A22,XBOOLE_0:def 4;
      consider m be Element of NAT such that
A25:  j <= m and
A26:  m <= k and
A27:  G*(i2,m)`2 = lower_bound(proj2.:(LSeg(G*(i2,j),G*(i2,k)) /\ L~Upper_Seq
      (C,n+1))) by A6,A18,A16,A19,A20,JORDAN1F:1,JORDAN1G:4;
A28:  m <= width G by A7,A26,XXREAL_0:2;
      1 <= m by A5,A25,XXREAL_0:2;
      then
A29:  G*(i2,m)`1 = G*(i2,1)`1 by A3,A4,A28,GOBOARD5:3;
      then
A30:  |[G*(i2,1)`1,lower_bound(proj2.:X)]| = G*(i2,m) by A27,EUCLID:57;
      then
G*(i2,j)`1 = |[G*(i2,1)`1,lower_bound(proj2.:X)]|`1
by A3,A4,A5,A15,A29,GOBOARD5:3;
      then
A31:  pp`1 = |[G*(i2,1)`1,lower_bound(proj2.:X)]|`1 by A17,A24,SPPOL_1:64;
      |[G*(i2,1)`1,lower_bound(proj2.:X)]|`2 = S-bound X by A27,A30,SPRECT_1:49
        .= (S-min X)`2 by EUCLID:56
        .= pp`2 by A21,PSCOMP_1:118;
      then G*(i2,m) in Upper_Arc L~Cage(C,n+1) by A18,A30,A23,A31,TOPREAL3:11;
      then LSeg(G*(i2,j),G*(i2,m)) meets Upper_Arc C by A3,A4,A5,A9,A25,A28
,Th26;
      then LSeg(G*(i2,j),G*(i2,k)) meets Upper_Arc C by A3,A4,A5,A7,A25,A26,Th7
,XBOOLE_1:63;
      hence thesis by XBOOLE_1:70;
    end;
    suppose
A32:  LSeg(G*(i2,k),G*(i1,k)) meets Lower_Arc L~Cage(C,n+1) & i2 <= i1;
      set X = LSeg(G*(i2,k),G*(i1,k)) /\ L~Lower_Seq(C,n+1);
      ex x be set st x in LSeg(G*(i2,k),G*(i1,k)) & x in L~Lower_Seq(C,n+
      1) by A14,A32,XBOOLE_0:3;
      then reconsider X1=X as non empty compact Subset of TOP-REAL 2 by
XBOOLE_0:def 4;
      consider pp be set such that
A33:  pp in E-most X1 by XBOOLE_0:def 1;
      reconsider pp as Point of TOP-REAL 2 by A33;
A34:  pp in X by A33,XBOOLE_0:def 4;
      then
A35:  pp in L~Lower_Seq(C,n+1) by XBOOLE_0:def 4;
A36:  pp in LSeg(G*(i2,k),G*(i1,k)) by A34,XBOOLE_0:def 4;
      consider m be Element of NAT such that
A37:  i2 <= m and
A38:  m <= i1 and
A39:  G*(m,k)`1 = upper_bound(proj1.:(LSeg(G*(i2,k),G*(i1,k)) /\ L~Lower_Seq(
      C,n+1))) by A14,A11,A12,A32,JORDAN1F:4,JORDAN1G:5;
A40:  1 < m by A3,A37,XXREAL_0:2;
      m < len G by A2,A38,XXREAL_0:2;
      then
A41:  G*(m,k)`2 = G*(1,k)`2 by A7,A10,A40,GOBOARD5:2;
      then
A42:  |[upper_bound(proj1.:X),G*(1,k)`2]| = G*(m,k) by A39,EUCLID:57;
      then G*(i2,k)`2 = |[upper_bound(proj1.:X),G*(1,k)`2]|`2
      by A3,A4,A7,A10,A41,
GOBOARD5:2;
      then
A43:  pp`2 = |[upper_bound(proj1.:X),G*(1,k)`2]|`2 by A13,A36,SPPOL_1:63;
      |[upper_bound(proj1.:X),G*(1,k)`2]|`1 = E-bound X by A39,A42,SPRECT_1:51
        .= (E-min X)`1 by EUCLID:56
        .= pp`1 by A33,PSCOMP_1:108;
      then G*(m,k) in Lower_Arc L~Cage(C,n+1) by A14,A42,A35,A43,TOPREAL3:11;
      then LSeg(G*(m,k),G*(i1,k)) meets Upper_Arc C by A2,A7,A8,A10,A38,A40
,Th35;
      then
      LSeg(G*(i2,k),G*(i1,k)) meets Upper_Arc C by A2,A3,A7,A10,A37,A38,Th8,
XBOOLE_1:63;
      hence thesis by XBOOLE_1:70;
    end;
    suppose
A44:  LSeg(G*(i2,k),G*(i1,k)) meets Lower_Arc L~Cage(C,n+1) & i1 < i2;
      set X = LSeg(G*(i1,k),G*(i2,k)) /\ L~Lower_Seq(C,n+1);
      ex x be set st x in LSeg(G*(i1,k),G*(i2,k)) & x in L~Lower_Seq(C,n+
      1) by A14,A44,XBOOLE_0:3;
      then reconsider X1=X as non empty compact Subset of TOP-REAL 2 by
XBOOLE_0:def 4;
      consider pp be set such that
A45:  pp in W-most X1 by XBOOLE_0:def 1;
      reconsider pp as Point of TOP-REAL 2 by A45;
A46:  pp in X by A45,XBOOLE_0:def 4;
      then
A47:  pp in L~Lower_Seq(C,n+1) by XBOOLE_0:def 4;
A48:  pp in LSeg(G*(i1,k),G*(i2,k)) by A46,XBOOLE_0:def 4;
      consider m be Element of NAT such that
A49:  i1 <= m and
A50:  m <= i2 and
A51:  G*(m,k)`1 = lower_bound(proj1.:(LSeg(G*(i1,k),G*(i2,k)) /\ L~Lower_Seq(
      C,n+1))) by A14,A11,A12,A44,JORDAN1F:3,JORDAN1G:5;
A52:  m < len G by A4,A50,XXREAL_0:2;
      1 < m by A1,A49,XXREAL_0:2;
      then
A53:  G*(m,k)`2 = G*(1,k)`2 by A7,A10,A52,GOBOARD5:2;
      then
A54:  |[lower_bound(proj1.:X),G*(1,k)`2]| = G*(m,k) by A51,EUCLID:57;
      then G*(i1,k)`2 = |[lower_bound(proj1.:X),G*(1,k)`2]|`2
      by A1,A2,A7,A10,A53,
GOBOARD5:2;
      then
A55:  pp`2 = |[lower_bound(proj1.:X),G*(1,k)`2]|`2 by A13,A48,SPPOL_1:63;
      |[lower_bound(proj1.:X),G*(1,k)`2]|`1 = W-bound X by A51,A54,SPRECT_1:48
        .= (W-min X)`1 by EUCLID:56
        .= pp`1 by A45,PSCOMP_1:88;
      then G*(m,k) in Lower_Arc L~Cage(C,n+1) by A14,A54,A47,A55,TOPREAL3:11;
      then LSeg(G*(i1,k),G*(m,k)) meets Upper_Arc C by A1,A7,A8,A10,A49,A52
,Th43;
      then
      LSeg(G*(i1,k),G*(i2,k)) meets Upper_Arc C by A1,A4,A7,A10,A49,A50,Th8,
XBOOLE_1:63;
      hence thesis by XBOOLE_1:70;
    end;
    suppose
A56:  LSeg(G*(i2,j),G*(i2,k)) misses Upper_Arc L~Cage(C,n+1) & LSeg(
      Gauge(C,n+1)*(i2,k),Gauge(C,n+1)*(i1,k)) misses Lower_Arc L~Cage(C,n+1);
      consider j1 be Element of NAT such that
A57:  j <= j1 and
A58:  j1 <= k and
A59:  LSeg(G*(i2,j1),G*(i2,k)) /\ L~Lower_Seq(C,n+1) = {G*(i2,j1)} by A3,A4,A5
,A6,A7,A9,A14,Th11;
      G*(i2,j1) in LSeg(G*(i2,j1),G*(i2,k)) /\ L~Lower_Seq(C,n+1) by A59,
TARSKI:def 1;
      then
A60:  G*(i2,j1) in L~Lower_Seq(C,n+1) by XBOOLE_0:def 4;
A61:  1 <= j1 by A5,A57,XXREAL_0:2;
      now
        per cases;
        suppose
A62:      i2 <= i1;
A63:      LSeg(G*(i2,j1),G*(i2,k)) c= LSeg(G*(i2,j),G*(i2,k)) by A3,A4,A5,A7
,A57,A58,Th7;
          consider i3 be Element of NAT such that
A64:      i2 <= i3 and
A65:      i3 <= i1 and
A66:      LSeg(G*(i2,k),G*(i3,k)) /\ L~Upper_Seq(C,n+1) = {G*(i3,k)}
          by A2,A3,A7,A8,A18,A10,A62,Th15;
A67:      LSeg(G*(i2,k),G*(i3,k)) c= LSeg(G*(i2,k),G*(i1,k)) by A2,A3,A7,A10
,A64,A65,Th8;
          then
A68:      LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,k)) c= LSeg(G*
          (i2,j),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i1,k)) by A63,XBOOLE_1:13;
          G*(i3,k) in LSeg(G*(i2,k),G*(i3,k)) /\ L~Upper_Seq(C,n+1) by A66,
TARSKI:def 1;
          then
A69:      G*(i3,k) in L~Upper_Seq(C,n+1) by XBOOLE_0:def 4;
A70:      (LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,k))) /\ L~
          Upper_Seq(C,n+1) = {G*(i3,k)}
          proof
            thus (LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,k))) /\ L~
            Upper_Seq(C,n+1) c= {G*(i3,k)}
            proof
              let x be set;
              assume
A71:          x in (LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,
              k))) /\ L~Upper_Seq(C,n+1);
              then x in LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,k))
              by XBOOLE_0:def 4;
              then
A72:          x in LSeg(G*(i2,j1),G*(i2,k)) or x in LSeg(G*(i2,k),G*(i3,
              k)) by XBOOLE_0:def 3;
              x in L~Upper_Seq(C,n+1) by A71,XBOOLE_0:def 4;
              hence thesis by A18,A56,A66,A63,A72,XBOOLE_0:3,def 4;
            end;
            let x be set;
            G*(i3,k) in LSeg(G*(i2,k),G*(i3,k)) by RLTOPSP1:69;
            then
A73:        G*(i3,k) in LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,
            k)) by XBOOLE_0:def 3;
            assume x in {G*(i3,k)};
            then x = G*(i3,k) by TARSKI:def 1;
            hence thesis by A69,A73,XBOOLE_0:def 4;
          end;
A74:      (LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,k))) /\ L~
          Lower_Seq(C,n+1) = {G*(i2,j1)}
          proof
            thus (LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,k))) /\ L~
            Lower_Seq(C,n+1) c= {G*(i2,j1)}
            proof
              let x be set;
              assume
A75:          x in (LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,
              k))) /\ L~Lower_Seq(C,n+1);
              then x in LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,k))
              by XBOOLE_0:def 4;
              then
A76:          x in LSeg(G*(i2,j1),G*(i2,k)) or x in LSeg(G*(i2,k),G*(i3,
              k)) by XBOOLE_0:def 3;
              x in L~Lower_Seq(C,n+1) by A75,XBOOLE_0:def 4;
              hence thesis by A14,A56,A59,A67,A76,XBOOLE_0:3,def 4;
            end;
            let x be set;
            G*(i2,j1) in LSeg(G*(i2,j1),G*(i2,k)) by RLTOPSP1:69;
            then
A77:        G*(i2,j1) in LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3
            ,k)) by XBOOLE_0:def 3;
            assume x in {G*(i2,j1)};
            then x = G*(i2,j1) by TARSKI:def 1;
            hence thesis by A60,A77,XBOOLE_0:def 4;
          end;
          i3 < len G by A2,A65,XXREAL_0:2;
          hence thesis by A3,A7,A58,A61,A64,A68,A70,A74,Th46,XBOOLE_1:63;
        end;
        suppose
A78:      i1 < i2;
A79:      LSeg(G*(i2,j1),G*(i2,k)) c= LSeg(G*(i2,j),G*(i2,k)) by A3,A4,A5,A7
,A57,A58,Th7;
          consider i3 be Element of NAT such that
A80:      i1 <= i3 and
A81:      i3 <= i2 and
A82:      LSeg(G*(i3,k),G*(i2,k)) /\ L~Upper_Seq(C,n+1) = {G*(i3,k)}
          by A1,A4,A7,A8,A18,A10,A78,Th20;
A83:      LSeg(G*(i2,k),G*(i3,k)) c= LSeg(G*(i2,k),G*(i1,k)) by A1,A4,A7,A10
,A80,A81,Th8;
          then
A84:      LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,k)) c= LSeg(G*
          (i2,j),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i1,k)) by A79,XBOOLE_1:13;
          G*(i3,k) in LSeg(G*(i2,k),G*(i3,k)) /\ L~Upper_Seq(C,n+1) by A82,
TARSKI:def 1;
          then
A85:      G*(i3,k) in L~Upper_Seq(C,n+1) by XBOOLE_0:def 4;
A86:      (LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,k))) /\ L~
          Upper_Seq(C,n+1) = {G*(i3,k)}
          proof
            thus (LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,k))) /\ L~
            Upper_Seq(C,n+1) c= {G*(i3,k)}
            proof
              let x be set;
              assume
A87:          x in (LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,
              k))) /\ L~Upper_Seq(C,n+1);
              then x in LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,k))
              by XBOOLE_0:def 4;
              then
A88:          x in LSeg(G*(i2,j1),G*(i2,k)) or x in LSeg(G*(i2,k),G*(i3,
              k)) by XBOOLE_0:def 3;
              x in L~Upper_Seq(C,n+1) by A87,XBOOLE_0:def 4;
              hence thesis by A18,A56,A82,A79,A88,XBOOLE_0:3,def 4;
            end;
            let x be set;
            G*(i3,k) in LSeg(G*(i2,k),G*(i3,k)) by RLTOPSP1:69;
            then
A89:        G*(i3,k) in LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,
            k)) by XBOOLE_0:def 3;
            assume x in {G*(i3,k)};
            then x = G*(i3,k) by TARSKI:def 1;
            hence thesis by A85,A89,XBOOLE_0:def 4;
          end;
A90:      (LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,k))) /\ L~
          Lower_Seq(C,n+1) = {G*(i2,j1)}
          proof
            thus (LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,k))) /\ L~
            Lower_Seq(C,n+1) c= {G*(i2,j1)}
            proof
              let x be set;
              assume
A91:          x in (LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,
              k))) /\ L~Lower_Seq(C,n+1);
              then x in LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,k))
              by XBOOLE_0:def 4;
              then
A92:          x in LSeg(G*(i2,j1),G*(i2,k)) or x in LSeg(G*(i2,k),G*(i3,
              k)) by XBOOLE_0:def 3;
              x in L~Lower_Seq(C,n+1) by A91,XBOOLE_0:def 4;
              hence thesis by A14,A56,A59,A83,A92,XBOOLE_0:3,def 4;
            end;
            let x be set;
            G*(i2,j1) in LSeg(G*(i2,j1),G*(i2,k)) by RLTOPSP1:69;
            then
A93:        G*(i2,j1) in LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3
            ,k)) by XBOOLE_0:def 3;
            assume x in {G*(i2,j1)};
            then x = G*(i2,j1) by TARSKI:def 1;
            hence thesis by A60,A93,XBOOLE_0:def 4;
          end;
          1 < i3 by A1,A80,XXREAL_0:2;
          hence thesis by A4,A7,A58,A61,A81,A84,A86,A90,Th48,XBOOLE_1:63;
        end;
      end;
      hence thesis;
    end;
  end;
  hence thesis;
end;

theorem Th51:
  for C be Simple_closed_curve for i1,i2,j,k be Element of NAT
holds 1 < i1 & i1 < len Gauge(C,n+1) & 1 < i2 & i2 < len Gauge(C,n+1) & 1 <= j
& j <= k & k <= width Gauge(C,n+1) & Gauge(C,n+1)*(i1,k) in Upper_Arc L~Cage(C,
n+1) & Gauge(C,n+1)*(i2,j) in Lower_Arc L~Cage(C,n+1) implies LSeg(Gauge(C,n+1)
  *(i2,j),Gauge(C,n+1)*(i2,k)) \/ LSeg(Gauge(C,n+1)*(i2,k),Gauge(C,n+1)*(i1,k))
  meets Lower_Arc C
proof
  let C be Simple_closed_curve;
  let i1,i2,j,k be Element of NAT;
  set G=Gauge(C,n+1);
  assume that
A1: 1 < i1 and
A2: i1 < len G and
A3: 1 < i2 and
A4: i2 < len G and
A5: 1 <= j and
A6: j <= k and
A7: k <= width G and
A8: G*(i1,k) in Upper_Arc L~Cage(C,n+1) and
A9: G*(i2,j) in Lower_Arc L~Cage(C,n+1);
A10: 1 <= k by A5,A6,XXREAL_0:2;
  then
A11: [i2,k] in Indices G by A3,A4,A7,MATRIX_1:37;
A12: [i1,k] in Indices G by A1,A2,A7,A10,MATRIX_1:37;
  G*(i2,k)`2 = G*(1,k)`2 by A3,A4,A7,A10,GOBOARD5:2
    .= G*(i1,k)`2 by A1,A2,A7,A10,GOBOARD5:2;
  then
A13: LSeg(G*(i2,k),G*(i1,k)) is horizontal by SPPOL_1:36;
A14: Lower_Arc L~Cage(C,n+1) = L~Lower_Seq(C,n+1) by JORDAN1G:64;
A15: j <= width G by A6,A7,XXREAL_0:2;
  then
A16: [i2,j] in Indices G by A3,A4,A5,MATRIX_1:37;
  G*(i2,j)`1 = G*(i2,1)`1 by A3,A4,A5,A15,GOBOARD5:3
    .= G*(i2,k)`1 by A3,A4,A7,A10,GOBOARD5:3;
  then
A17: LSeg(G*(i2,j),G*(i2,k)) is vertical by SPPOL_1:37;
A18: Upper_Arc L~Cage(C,n+1) = L~Upper_Seq(C,n+1) by JORDAN1G:63;
A19: [i2,k] in Indices G by A3,A4,A7,A10,MATRIX_1:37;
  now
    per cases;
    suppose
A20:  LSeg(G*(i2,j),G*(i2,k)) meets Upper_Arc L~Cage(C,n+1);
      set X = LSeg(G*(i2,j),G*(i2,k)) /\ L~Upper_Seq(C,n+1);
      ex x be set st x in LSeg(G*(i2,j),G*(i2,k)) & x in L~Upper_Seq(C,n+
      1) by A18,A20,XBOOLE_0:3;
      then reconsider X1=X as non empty compact Subset of TOP-REAL 2 by
XBOOLE_0:def 4;
      consider pp be set such that
A21:  pp in S-most X1 by XBOOLE_0:def 1;
      reconsider pp as Point of TOP-REAL 2 by A21;
A22:  pp in X by A21,XBOOLE_0:def 4;
      then
A23:  pp in L~Upper_Seq(C,n+1) by XBOOLE_0:def 4;
A24:  pp in LSeg(G*(i2,j),G*(i2,k)) by A22,XBOOLE_0:def 4;
      consider m be Element of NAT such that
A25:  j <= m and
A26:  m <= k and
A27:  G*(i2,m)`2 = lower_bound(proj2.:(LSeg(G*(i2,j),G*(i2,k)) /\ L~Upper_Seq
      (C,n+1))) by A6,A18,A16,A19,A20,JORDAN1F:1,JORDAN1G:4;
A28:  m <= width G by A7,A26,XXREAL_0:2;
      1 <= m by A5,A25,XXREAL_0:2;
      then
A29:  G*(i2,m)`1 = G*(i2,1)`1 by A3,A4,A28,GOBOARD5:3;
      then
A30:  |[G*(i2,1)`1,lower_bound(proj2.:X)]| = G*(i2,m) by A27,EUCLID:57;
      then
G*(i2,j)`1 = |[G*(i2,1)`1,lower_bound(proj2.:X)]|`1
by A3,A4,A5,A15,A29,GOBOARD5:3;
      then
A31:  pp`1 = |[G*(i2,1)`1,lower_bound(proj2.:X)]|`1 by A17,A24,SPPOL_1:64;
      |[G*(i2,1)`1,lower_bound(proj2.:X)]|`2 = S-bound X by A27,A30,SPRECT_1:49
        .= (S-min X)`2 by EUCLID:56
        .= pp`2 by A21,PSCOMP_1:118;
      then G*(i2,m) in Upper_Arc L~Cage(C,n+1) by A18,A30,A23,A31,TOPREAL3:11;
      then LSeg(G*(i2,j),G*(i2,m)) meets Lower_Arc C by A3,A4,A5,A9,A25,A28
,Th25;
      then LSeg(G*(i2,j),G*(i2,k)) meets Lower_Arc C by A3,A4,A5,A7,A25,A26,Th7
,XBOOLE_1:63;
      hence thesis by XBOOLE_1:70;
    end;
    suppose
A32:  LSeg(G*(i2,k),G*(i1,k)) meets Lower_Arc L~Cage(C,n+1) & i2 <= i1;
      set X = LSeg(G*(i2,k),G*(i1,k)) /\ L~Lower_Seq(C,n+1);
      ex x be set st x in LSeg(G*(i2,k),G*(i1,k)) & x in L~Lower_Seq(C,n+
      1) by A14,A32,XBOOLE_0:3;
      then reconsider X1=X as non empty compact Subset of TOP-REAL 2 by
XBOOLE_0:def 4;
      consider pp be set such that
A33:  pp in E-most X1 by XBOOLE_0:def 1;
      reconsider pp as Point of TOP-REAL 2 by A33;
A34:  pp in X by A33,XBOOLE_0:def 4;
      then
A35:  pp in L~Lower_Seq(C,n+1) by XBOOLE_0:def 4;
A36:  pp in LSeg(G*(i2,k),G*(i1,k)) by A34,XBOOLE_0:def 4;
      consider m be Element of NAT such that
A37:  i2 <= m and
A38:  m <= i1 and
A39:  G*(m,k)`1 = upper_bound(proj1.:(LSeg(G*(i2,k),G*(i1,k)) /\ L~Lower_Seq(
      C,n+1))) by A14,A11,A12,A32,JORDAN1F:4,JORDAN1G:5;
A40:  1 < m by A3,A37,XXREAL_0:2;
      m < len G by A2,A38,XXREAL_0:2;
      then
A41:  G*(m,k)`2 = G*(1,k)`2 by A7,A10,A40,GOBOARD5:2;
      then
A42:  |[upper_bound(proj1.:X),G*(1,k)`2]| = G*(m,k) by A39,EUCLID:57;
      then G*(i2,k)`2 = |[upper_bound(proj1.:X),G*(1,k)`2]|`2
      by A3,A4,A7,A10,A41,
GOBOARD5:2;
      then
A43:  pp`2 = |[upper_bound(proj1.:X),G*(1,k)`2]|`2 by A13,A36,SPPOL_1:63;
      |[upper_bound(proj1.:X),G*(1,k)`2]|`1 = E-bound X by A39,A42,SPRECT_1:51
        .= (E-min X)`1 by EUCLID:56
        .= pp`1 by A33,PSCOMP_1:108;
      then G*(m,k) in Lower_Arc L~Cage(C,n+1) by A14,A42,A35,A43,TOPREAL3:11;
      then LSeg(G*(m,k),G*(i1,k)) meets Lower_Arc C by A2,A7,A8,A10,A38,A40
,Th34;
      then
      LSeg(G*(i2,k),G*(i1,k)) meets Lower_Arc C by A2,A3,A7,A10,A37,A38,Th8,
XBOOLE_1:63;
      hence thesis by XBOOLE_1:70;
    end;
    suppose
A44:  LSeg(G*(i2,k),G*(i1,k)) meets Lower_Arc L~Cage(C,n+1) & i1 < i2;
      set X = LSeg(G*(i1,k),G*(i2,k)) /\ L~Lower_Seq(C,n+1);
      ex x be set st x in LSeg(G*(i1,k),G*(i2,k)) & x in L~Lower_Seq(C,n+
      1) by A14,A44,XBOOLE_0:3;
      then reconsider X1=X as non empty compact Subset of TOP-REAL 2 by
XBOOLE_0:def 4;
      consider pp be set such that
A45:  pp in W-most X1 by XBOOLE_0:def 1;
      reconsider pp as Point of TOP-REAL 2 by A45;
A46:  pp in X by A45,XBOOLE_0:def 4;
      then
A47:  pp in L~Lower_Seq(C,n+1) by XBOOLE_0:def 4;
A48:  pp in LSeg(G*(i1,k),G*(i2,k)) by A46,XBOOLE_0:def 4;
      consider m be Element of NAT such that
A49:  i1 <= m and
A50:  m <= i2 and
A51:  G*(m,k)`1 = lower_bound(proj1.:(LSeg(G*(i1,k),G*(i2,k)) /\ L~Lower_Seq(
      C,n+1))) by A14,A11,A12,A44,JORDAN1F:3,JORDAN1G:5;
A52:  m < len G by A4,A50,XXREAL_0:2;
      1 < m by A1,A49,XXREAL_0:2;
      then
A53:  G*(m,k)`2 = G*(1,k)`2 by A7,A10,A52,GOBOARD5:2;
      then
A54:  |[lower_bound(proj1.:X),G*(1,k)`2]| = G*(m,k) by A51,EUCLID:57;
      then G*(i1,k)`2 = |[lower_bound(proj1.:X),G*(1,k)`2]|`2
      by A1,A2,A7,A10,A53,
GOBOARD5:2;
      then
A55:  pp`2 = |[lower_bound(proj1.:X),G*(1,k)`2]|`2 by A13,A48,SPPOL_1:63;
      |[lower_bound(proj1.:X),G*(1,k)`2]|`1 = W-bound X by A51,A54,SPRECT_1:48
        .= (W-min X)`1 by EUCLID:56
        .= pp`1 by A45,PSCOMP_1:88;
      then G*(m,k) in Lower_Arc L~Cage(C,n+1) by A14,A54,A47,A55,TOPREAL3:11;
      then LSeg(G*(i1,k),G*(m,k)) meets Lower_Arc C by A1,A7,A8,A10,A49,A52
,Th42;
      then
      LSeg(G*(i1,k),G*(i2,k)) meets Lower_Arc C by A1,A4,A7,A10,A49,A50,Th8,
XBOOLE_1:63;
      hence thesis by XBOOLE_1:70;
    end;
    suppose
A56:  LSeg(G*(i2,j),G*(i2,k)) misses Upper_Arc L~Cage(C,n+1) & LSeg(
      Gauge(C,n+1)*(i2,k),Gauge(C,n+1)*(i1,k)) misses Lower_Arc L~Cage(C,n+1);
      consider j1 be Element of NAT such that
A57:  j <= j1 and
A58:  j1 <= k and
A59:  LSeg(G*(i2,j1),G*(i2,k)) /\ L~Lower_Seq(C,n+1) = {G*(i2,j1)} by A3,A4,A5
,A6,A7,A9,A14,Th11;
      G*(i2,j1) in LSeg(G*(i2,j1),G*(i2,k)) /\ L~Lower_Seq(C,n+1) by A59,
TARSKI:def 1;
      then
A60:  G*(i2,j1) in L~Lower_Seq(C,n+1) by XBOOLE_0:def 4;
A61:  1 <= j1 by A5,A57,XXREAL_0:2;
      now
        per cases;
        suppose
A62:      i2 <= i1;
A63:      LSeg(G*(i2,j1),G*(i2,k)) c= LSeg(G*(i2,j),G*(i2,k)) by A3,A4,A5,A7
,A57,A58,Th7;
          consider i3 be Element of NAT such that
A64:      i2 <= i3 and
A65:      i3 <= i1 and
A66:      LSeg(G*(i2,k),G*(i3,k)) /\ L~Upper_Seq(C,n+1) = {G*(i3,k)}
          by A2,A3,A7,A8,A18,A10,A62,Th15;
A67:      LSeg(G*(i2,k),G*(i3,k)) c= LSeg(G*(i2,k),G*(i1,k)) by A2,A3,A7,A10
,A64,A65,Th8;
          then
A68:      LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,k)) c= LSeg(G*
          (i2,j),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i1,k)) by A63,XBOOLE_1:13;
          G*(i3,k) in LSeg(G*(i2,k),G*(i3,k)) /\ L~Upper_Seq(C,n+1) by A66,
TARSKI:def 1;
          then
A69:      G*(i3,k) in L~Upper_Seq(C,n+1) by XBOOLE_0:def 4;
A70:      (LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,k))) /\ L~
          Upper_Seq(C,n+1) = {G*(i3,k)}
          proof
            thus (LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,k))) /\ L~
            Upper_Seq(C,n+1) c= {G*(i3,k)}
            proof
              let x be set;
              assume
A71:          x in (LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,
              k))) /\ L~Upper_Seq(C,n+1);
              then x in LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,k))
              by XBOOLE_0:def 4;
              then
A72:          x in LSeg(G*(i2,j1),G*(i2,k)) or x in LSeg(G*(i2,k),G*(i3,
              k)) by XBOOLE_0:def 3;
              x in L~Upper_Seq(C,n+1) by A71,XBOOLE_0:def 4;
              hence thesis by A18,A56,A66,A63,A72,XBOOLE_0:3,def 4;
            end;
            let x be set;
            G*(i3,k) in LSeg(G*(i2,k),G*(i3,k)) by RLTOPSP1:69;
            then
A73:        G*(i3,k) in LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,
            k)) by XBOOLE_0:def 3;
            assume x in {G*(i3,k)};
            then x = G*(i3,k) by TARSKI:def 1;
            hence thesis by A69,A73,XBOOLE_0:def 4;
          end;
A74:      (LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,k))) /\ L~
          Lower_Seq(C,n+1) = {G*(i2,j1)}
          proof
            thus (LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,k))) /\ L~
            Lower_Seq(C,n+1) c= {G*(i2,j1)}
            proof
              let x be set;
              assume
A75:          x in (LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,
              k))) /\ L~Lower_Seq(C,n+1);
              then x in LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,k))
              by XBOOLE_0:def 4;
              then
A76:          x in LSeg(G*(i2,j1),G*(i2,k)) or x in LSeg(G*(i2,k),G*(i3,
              k)) by XBOOLE_0:def 3;
              x in L~Lower_Seq(C,n+1) by A75,XBOOLE_0:def 4;
              hence thesis by A14,A56,A59,A67,A76,XBOOLE_0:3,def 4;
            end;
            let x be set;
            G*(i2,j1) in LSeg(G*(i2,j1),G*(i2,k)) by RLTOPSP1:69;
            then
A77:        G*(i2,j1) in LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3
            ,k)) by XBOOLE_0:def 3;
            assume x in {G*(i2,j1)};
            then x = G*(i2,j1) by TARSKI:def 1;
            hence thesis by A60,A77,XBOOLE_0:def 4;
          end;
          i3 < len G by A2,A65,XXREAL_0:2;
          hence thesis by A3,A7,A58,A61,A64,A68,A70,A74,Th47,XBOOLE_1:63;
        end;
        suppose
A78:      i1 < i2;
A79:      LSeg(G*(i2,j1),G*(i2,k)) c= LSeg(G*(i2,j),G*(i2,k)) by A3,A4,A5,A7
,A57,A58,Th7;
          consider i3 be Element of NAT such that
A80:      i1 <= i3 and
A81:      i3 <= i2 and
A82:      LSeg(G*(i3,k),G*(i2,k)) /\ L~Upper_Seq(C,n+1) = {G*(i3,k)}
          by A1,A4,A7,A8,A18,A10,A78,Th20;
A83:      LSeg(G*(i2,k),G*(i3,k)) c= LSeg(G*(i2,k),G*(i1,k)) by A1,A4,A7,A10
,A80,A81,Th8;
          then
A84:      LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,k)) c= LSeg(G*
          (i2,j),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i1,k)) by A79,XBOOLE_1:13;
          G*(i3,k) in LSeg(G*(i2,k),G*(i3,k)) /\ L~Upper_Seq(C,n+1) by A82,
TARSKI:def 1;
          then
A85:      G*(i3,k) in L~Upper_Seq(C,n+1) by XBOOLE_0:def 4;
A86:      (LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,k))) /\ L~
          Upper_Seq(C,n+1) = {G*(i3,k)}
          proof
            thus (LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,k))) /\ L~
            Upper_Seq(C,n+1) c= {G*(i3,k)}
            proof
              let x be set;
              assume
A87:          x in (LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,
              k))) /\ L~Upper_Seq(C,n+1);
              then x in LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,k))
              by XBOOLE_0:def 4;
              then
A88:          x in LSeg(G*(i2,j1),G*(i2,k)) or x in LSeg(G*(i2,k),G*(i3,
              k)) by XBOOLE_0:def 3;
              x in L~Upper_Seq(C,n+1) by A87,XBOOLE_0:def 4;
              hence thesis by A18,A56,A82,A79,A88,XBOOLE_0:3,def 4;
            end;
            let x be set;
            G*(i3,k) in LSeg(G*(i2,k),G*(i3,k)) by RLTOPSP1:69;
            then
A89:        G*(i3,k) in LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,
            k)) by XBOOLE_0:def 3;
            assume x in {G*(i3,k)};
            then x = G*(i3,k) by TARSKI:def 1;
            hence thesis by A85,A89,XBOOLE_0:def 4;
          end;
A90:      (LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,k))) /\ L~
          Lower_Seq(C,n+1) = {G*(i2,j1)}
          proof
            thus (LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,k))) /\ L~
            Lower_Seq(C,n+1) c= {G*(i2,j1)}
            proof
              let x be set;
              assume
A91:          x in (LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,
              k))) /\ L~Lower_Seq(C,n+1);
              then x in LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3,k))
              by XBOOLE_0:def 4;
              then
A92:          x in LSeg(G*(i2,j1),G*(i2,k)) or x in LSeg(G*(i2,k),G*(i3,
              k)) by XBOOLE_0:def 3;
              x in L~Lower_Seq(C,n+1) by A91,XBOOLE_0:def 4;
              hence thesis by A14,A56,A59,A83,A92,XBOOLE_0:3,def 4;
            end;
            let x be set;
            G*(i2,j1) in LSeg(G*(i2,j1),G*(i2,k)) by RLTOPSP1:69;
            then
A93:        G*(i2,j1) in LSeg(G*(i2,j1),G*(i2,k)) \/ LSeg(G*(i2,k),G*(i3
            ,k)) by XBOOLE_0:def 3;
            assume x in {G*(i2,j1)};
            then x = G*(i2,j1) by TARSKI:def 1;
            hence thesis by A60,A93,XBOOLE_0:def 4;
          end;
          1 < i3 by A1,A80,XXREAL_0:2;
          hence thesis by A4,A7,A58,A61,A81,A84,A86,A90,Th49,XBOOLE_1:63;
        end;
      end;
      hence thesis;
    end;
  end;
  hence thesis;
end;

theorem
  for C be Simple_closed_curve for i,j,k be Element of NAT holds 1 < i &
i < len Gauge(C,n+1) & 1 <= j & j <= k & k <= width Gauge(C,n+1) & Gauge(C,n+1)
  *(i,k) in Upper_Arc L~Cage(C,n+1) & Gauge(C,n+1)*(Center Gauge(C,n+1),j) in
  Lower_Arc L~Cage(C,n+1) implies LSeg(Gauge(C,n+1)*(Center Gauge(C,n+1),j),
Gauge(C,n+1)*(Center Gauge(C,n+1),k)) \/ LSeg(Gauge(C,n+1)*(Center Gauge(C,n+1)
  ,k),Gauge(C,n+1)*(i,k)) meets Upper_Arc C
proof
  let C be Simple_closed_curve;
  let i,j,k be Element of NAT;
  assume that
A1: 1 < i and
A2: i < len Gauge(C,n+1) and
A3: 1 <= j and
A4: j <= k and
A5: k <= width Gauge(C,n+1) and
A6: Gauge(C,n+1)*(i,k) in Upper_Arc L~Cage(C,n+1) and
A7: Gauge(C,n+1)*(Center Gauge(C,n+1),j) in Lower_Arc L~Cage(C,n+1);
A8: len Gauge(C,n+1) >= 4 by JORDAN8:13;
  then len Gauge(C,n+1) >= 3 by XXREAL_0:2;
  then
A9: Center Gauge(C,n+1) < len Gauge(C,n+1) by JORDAN1B:16;
  len Gauge(C,n+1) >= 2 by A8,XXREAL_0:2;
  then 1 < Center Gauge(C,n+1) by JORDAN1B:15;
  hence thesis by A1,A2,A3,A4,A5,A6,A7,A9,Th50;
end;

theorem
  for C be Simple_closed_curve for i,j,k be Element of NAT holds 1 < i &
i < len Gauge(C,n+1) & 1 <= j & j <= k & k <= width Gauge(C,n+1) & Gauge(C,n+1)
  *(i,k) in Upper_Arc L~Cage(C,n+1) & Gauge(C,n+1)*(Center Gauge(C,n+1),j) in
  Lower_Arc L~Cage(C,n+1) implies LSeg(Gauge(C,n+1)*(Center Gauge(C,n+1),j),
Gauge(C,n+1)*(Center Gauge(C,n+1),k)) \/ LSeg(Gauge(C,n+1)*(Center Gauge(C,n+1)
  ,k),Gauge(C,n+1)*(i,k)) meets Lower_Arc C
proof
  let C be Simple_closed_curve;
  let i,j,k be Element of NAT;
  assume that
A1: 1 < i and
A2: i < len Gauge(C,n+1) and
A3: 1 <= j and
A4: j <= k and
A5: k <= width Gauge(C,n+1) and
A6: Gauge(C,n+1)*(i,k) in Upper_Arc L~Cage(C,n+1) and
A7: Gauge(C,n+1)*(Center Gauge(C,n+1),j) in Lower_Arc L~Cage(C,n+1);
A8: len Gauge(C,n+1) >= 4 by JORDAN8:13;
  then len Gauge(C,n+1) >= 3 by XXREAL_0:2;
  then
A9: Center Gauge(C,n+1) < len Gauge(C,n+1) by JORDAN1B:16;
  len Gauge(C,n+1) >= 2 by A8,XXREAL_0:2;
  then 1 < Center Gauge(C,n+1) by JORDAN1B:15;
  hence thesis by A1,A2,A3,A4,A5,A6,A7,A9,Th51;
end;
